{"id": "batch_req_68f81356015881908a37c07d19af4efe", "custom_id": "17-2", "response": {"status_code": 200, "request_id": "a88b7fbdc22b9cb1d515c9d6b2bc0609", "body": {"id": "chatcmpl-CTFn4nwBv6ojVupzZCRwna4O2GA1G", "object": "chat.completion", "created": 1761088246, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- FINAL QUERY: Return all features for objects classified as AGN (ranking=1, classifier_name='lc_classifier')\n-- that show variability in the r band (Std > 0 OR ExcessVar > 0 OR Amplitude > 0, fid=2)\n-- and have no detections or show no variability in the g band (no feature rows with fid=1 and Std>0 OR ExcessVar>0 OR Amplitude>0)\n-- Order features by value ascending, and by oid\n\nSELECT f.*\nFROM feature f\nINNER JOIN (\n    -- Subquery: oids classified as AGN, with r band variability, and no g band variability\n    SELECT DISTINCT rvar.oid\n    FROM (\n        -- AGN objects with r band variability\n        SELECT p.oid\n        FROM probability p\n        INNER JOIN feature fr ON p.oid = fr.oid\n        WHERE p.class_name = 'AGN'\n          AND p.ranking = 1\n          AND p.classifier_name = 'lc_classifier'\n          AND fr.fid = 2\n          AND (\n                (fr.name = 'Std' AND fr.value > 0)\n             OR (fr.name = 'ExcessVar' AND fr.value > 0)\n             OR (fr.name = 'Amplitude' AND fr.value > 0)\n          )\n    ) rvar\n    WHERE NOT EXISTS (\n        -- Exclude if there is g band variability\n        SELECT 1\n        FROM feature fg\n        WHERE fg.oid = rvar.oid\n          AND fg.fid = 1\n          AND (\n                (fg.name = 'Std' AND fg.value > 0)\n             OR (fg.name = 'ExcessVar' AND fg.value > 0)\n             OR (fg.name = 'Amplitude' AND fg.value > 0)\n          )\n    )\n) filtered_oids\nON f.oid = filtered_oids.oid\nORDER BY f.value ASC, f.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4721, "completion_tokens": 411, "total_tokens": 5132, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f813561528819095c0e9dc29e1d8fe", "custom_id": "17-3", "response": {"status_code": 200, "request_id": "8db472d523393edd00b0ce073550b4c9", "body": {"id": "chatcmpl-CTFo2v0ZfGDAUBNqyDDCxebgTmVsP", "object": "chat.completion", "created": 1761088306, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Get AGN oids from probability table with default conditions\nWITH agn_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND class_name = 'AGN'\n),\n\n-- Step 2: Get oids with r band (fid=2) variability (Std > 0 OR ExcessVar > 0 OR Amplitude > 0)\nr_var_oids AS (\n    SELECT oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE ( (f.name = 'Std' AND f.fid = 2 AND f.value > 0)\n         OR (f.name = 'ExcessVar' AND f.fid = 2 AND f.value > 0)\n         OR (f.name = 'Amplitude' AND f.fid = 2 AND f.value > 0) )\n    GROUP BY oid\n),\n\n-- Step 3: Get oids with g band (fid=1) n_det = 0 or NULL\ng_nodet_oids AS (\n    SELECT oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.name = 'n_det' AND f.fid = 1 AND (f.value = 0 OR f.value IS NULL)\n    GROUP BY oid\n),\n\n-- Step 4: Get oids with g band (fid=1) no variability (Std = 0 or NULL AND ExcessVar = 0 or NULL AND Amplitude = 0 or NULL)\ng_novar_oids AS (\n    SELECT oid\n    FROM (\n        SELECT f.oid,\n            MAX(CASE WHEN f.name = 'Std' AND f.fid = 1 THEN f.value ELSE NULL END) AS std_val,\n            MAX(CASE WHEN f.name = 'ExcessVar' AND f.fid = 1 THEN f.value ELSE NULL END) AS excessvar_val,\n            MAX(CASE WHEN f.name = 'Amplitude' AND f.fid = 1 THEN f.value ELSE NULL END) AS amplitude_val\n        FROM feature f\n        INNER JOIN agn_oids a ON f.oid = a.oid\n        WHERE ( (f.name = 'Std' AND f.fid = 1)\n             OR (f.name = 'ExcessVar' AND f.fid = 1)\n             OR (f.name = 'Amplitude' AND f.fid = 1) )\n        GROUP BY f.oid\n    ) t\n    WHERE (std_val = 0 OR std_val IS NULL)\n      AND (excessvar_val = 0 OR excessvar_val IS NULL)\n      AND (amplitude_val = 0 OR amplitude_val IS NULL)\n),\n\n-- Step 5: Combine g band no detection and no variability oids\ng_nodet_or_novar_oids AS (\n    SELECT oid FROM g_nodet_oids\n    UNION\n    SELECT oid FROM g_novar_oids\n),\n\n-- Step 6: Final oids that are AGN, variable in r, and have no detection or no variability in g\nfinal_oids AS (\n    SELECT oid\n    FROM r_var_oids\n    INTERSECT\n    SELECT oid\n    FROM g_nodet_or_novar_oids\n)\n\n-- Step 7: Return all features for these oids, ordered by value and oid\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM final_oids)\nORDER BY value ASC, oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4617, "completion_tokens": 747, "total_tokens": 5364, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_36221e1176"}}, "error": null}
{"id": "batch_req_68f813560e1481908bb5af905eaf704d", "custom_id": "17-4", "response": {"status_code": 200, "request_id": "3d2e9a02e8d6564656f188161d05e7b2", "body": {"id": "chatcmpl-CTFo2GunGBnONjS5fexS6LgERULdS", "object": "chat.completion", "created": 1761088306, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Get oids classified as AGN (ranking=1, classifier_name='lc_classifier')\nWITH agn_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: AGN oids with r-band (fid=2) variability (Std > 0 OR ExcessVar > 0 OR Amplitude > 0)\nrband_variable AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 2\n      AND (\n            (f.name = 'Std' AND f.value > 0)\n         OR (f.name = 'ExcessVar' AND f.value > 0)\n         OR (f.name = 'Amplitude' AND f.value > 0)\n      )\n),\n\n-- Step 3: AGN oids with g-band (fid=1) variability (Std > 0 OR ExcessVar > 0 OR Amplitude > 0)\ngband_variable AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 1\n      AND (\n            (f.name = 'Std' AND f.value > 0)\n         OR (f.name = 'ExcessVar' AND f.value > 0)\n         OR (f.name = 'Amplitude' AND f.value > 0)\n      )\n),\n\n-- Step 4: AGN oids with at least one g-band detection (any feature in g band)\ngband_detected AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 1\n),\n\n-- Step 5: AGN oids with NO g-band variability (i.e., not in gband_variable)\nno_gband_variability AS (\n    SELECT a.oid\n    FROM agn_oids a\n    LEFT JOIN gband_variable gv ON a.oid = gv.oid\n    WHERE gv.oid IS NULL\n),\n\n-- Step 6: AGN oids with NO g-band detections (i.e., not in gband_detected)\nno_gband_detection AS (\n    SELECT a.oid\n    FROM agn_oids a\n    LEFT JOIN gband_detected gd ON a.oid = gd.oid\n    WHERE gd.oid IS NULL\n),\n\n-- Step 7: AGN oids with r-band variability AND (no g-band detection OR no g-band variability)\nfinal_oids AS (\n    SELECT oid FROM rband_variable\n    INTERSECT\n    (\n        SELECT oid FROM no_gband_detection\n        UNION\n        SELECT oid FROM no_gband_variability\n    )\n)\n\n-- Step 8: Return all features for these oids, ordered by value ascending, then by oid\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM final_oids)\nORDER BY value ASC, oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4692, "completion_tokens": 661, "total_tokens": 5353, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81355fd6081908c1ad1480686b09a", "custom_id": "1-2", "response": {"status_code": 200, "request_id": "881f72959dcd8574c78d60f409240b19", "body": {"id": "chatcmpl-CTFo2EVGGckuA0qZZL3TqgzweOekJ", "object": "chat.completion", "created": 1761088306, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Select AGN objects with probability > 0.6, classifier_name='lc_classifier', ranking=1\nWITH agn_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\n\n-- Step 2: Filter objects with light curves covering at least one year (deltajd >= 365)\nlong_lc_oids AS (\n    SELECT oid\n    FROM object\n    WHERE deltajd >= 365\n      AND oid IN (SELECT oid FROM agn_oids)\n),\n\n-- Step 3: Objects with at least 20 detections in at least one band (feature: n_det >= 20)\nn_det_oids AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'n_det'\n      AND value >= 20\n      AND oid IN (SELECT oid FROM long_lc_oids)\n),\n\n-- Step 4.1: Objects with variation > 1 mag in g band (fid=1, corrected)\ng_band_var AS (\n    SELECT f_max.oid,\n           f_max.fid AS feature_fid,\n           f_max.value AS max_mag,\n           f_min.value AS min_mag,\n           (f_max.value - f_min.value) AS delta_mag\n    FROM feature f_max\n    INNER JOIN feature f_min\n        ON f_max.oid = f_min.oid\n        AND f_max.fid = f_min.fid\n        AND f_max.name = 'max_mag_corr'\n        AND f_min.name = 'min_mag_corr'\n        AND f_max.fid = 1\n        AND f_min.fid = 1\n    WHERE (f_max.value - f_min.value) > 1\n      AND f_max.oid IN (SELECT oid FROM n_det_oids)\n),\n\n-- Step 4.2: Objects with variation > 0.5 mag in r band (fid=2, corrected)\nr_band_var AS (\n    SELECT f_max.oid,\n           f_max.fid AS feature_fid,\n           f_max.value AS max_mag,\n           f_min.value AS min_mag,\n           (f_max.value - f_min.value) AS delta_mag\n    FROM feature f_max\n    INNER JOIN feature f_min\n        ON f_max.oid = f_min.oid\n        AND f_max.fid = f_min.fid\n        AND f_max.name = 'max_mag_corr'\n        AND f_min.name = 'min_mag_corr'\n        AND f_max.fid = 2\n        AND f_min.fid = 2\n    WHERE (f_max.value - f_min.value) > 0.5\n      AND f_max.oid IN (SELECT oid FROM n_det_oids)\n),\n\n-- Step 5: Only keep oids that satisfy both g and r band variation conditions\nfinal_oids AS (\n    SELECT g.oid\n    FROM g_band_var g\n    INNER JOIN r_band_var r ON g.oid = r.oid\n)\n\n-- Step 6: Gather all required feature rows for the selected oids\nSELECT\n    f.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- For g band (fid=1)\n    g.max_mag AS g_max_mag,\n    g.min_mag AS g_min_mag,\n    g.delta_mag AS g_delta_mag,\n    g.feature_fid AS g_band_fid,\n    -- For r band (fid=2)\n    r.max_mag AS r_max_mag,\n    r.min_mag AS r_min_mag,\n    r.delta_mag AS r_delta_mag,\n    r.feature_fid AS r_band_fid\nFROM feature f\nINNER JOIN object o ON f.oid = o.oid\nINNER JOIN g_band_var g ON f.oid = g.oid\nINNER JOIN r_band_var r ON f.oid = r.oid\nWHERE f.oid IN (SELECT oid FROM final_oids)\nORDER BY f.oid, f.fid, f.name\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5152, "completion_tokens": 876, "total_tokens": 6028, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_36221e1176"}}, "error": null}
{"id": "batch_req_68f813563a488190b44cb9b851bbf7b5", "custom_id": "1-3", "response": {"status_code": 200, "request_id": "466a4e65a283bb1450b24485a7970e17", "body": {"id": "chatcmpl-CTFoA1LiAsdW88TAinFaIrs4lCHKf", "object": "chat.completion", "created": 1761088314, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY]\nWITH agn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.6\n),\none_year_oids AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN agn_oids a ON o.oid = a.oid\n    WHERE o.deltajd >= 365\n),\nn_det_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN one_year_oids o ON f.oid = o.oid\n    WHERE f.name = 'n_det'\n      AND f.value >= 20\n),\ng_band_var_oids AS (\n    SELECT f.oid\n    FROM feature f\n    INNER JOIN n_det_oids n ON f.oid = n.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 1\n      AND f.value > 1\n),\nr_band_var_oids AS (\n    SELECT f.oid\n    FROM feature f\n    INNER JOIN n_det_oids n ON f.oid = n.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 2\n      AND f.value > 0.5\n),\nfinal_oids AS (\n    SELECT g.oid\n    FROM g_band_var_oids g\n    INNER JOIN r_band_var_oids r ON g.oid = r.oid\n)\nSELECT\n    f.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    min_g.value AS min_mag_g,\n    max_g.value AS max_mag_g,\n    (max_g.value - min_g.value) AS delta_mag_g,\n    min_r.value AS min_mag_r,\n    max_r.value AS max_mag_r,\n    (max_r.value - min_r.value) AS delta_mag_r,\n    min_g.fid AS feature_min_g_fid,\n    max_g.fid AS feature_max_g_fid,\n    min_r.fid AS feature_min_r_fid,\n    max_r.fid AS feature_max_r_fid\nFROM feature f\nINNER JOIN final_oids fo ON f.oid = fo.oid\nINNER JOIN object o ON f.oid = o.oid\n-- Join for g band min/max corrected magnitude\nLEFT JOIN feature min_g ON min_g.oid = f.oid AND min_g.name = 'min_mag_corr' AND min_g.fid = 1\nLEFT JOIN feature max_g ON max_g.oid = f.oid AND max_g.name = 'max_mag_corr' AND max_g.fid = 1\n-- Join for r band min/max corrected magnitude\nLEFT JOIN feature min_r ON min_r.oid = f.oid AND min_r.name = 'min_mag_corr' AND min_r.fid = 2\nLEFT JOIN feature max_r ON max_r.oid = f.oid AND max_r.name = 'max_mag_corr' AND max_r.fid = 2\nORDER BY f.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5256, "completion_tokens": 685, "total_tokens": 5941, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81355f4108190900945fcf1fda87b", "custom_id": "1-4", "response": {"status_code": 200, "request_id": "268996fd613765c6ad0db857f9c7aa43", "body": {"id": "chatcmpl-CTFo2U4qUgyiFio23B4X4Cmm7bVSW", "object": "chat.completion", "created": 1761088306, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY]\nSELECT\n    o.oid,\n    f.name,\n    f.value,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    gband.max_mag_corr AS gband_max_mag,\n    gband.min_mag_corr AS gband_min_mag,\n    (gband.max_mag_corr - gband.min_mag_corr) AS gband_delta_mag,\n    gband.fid AS gband_feature_fid,\n    rband.max_mag_corr AS rband_max_mag,\n    rband.min_mag_corr AS rband_min_mag,\n    (rband.max_mag_corr - rband.min_mag_corr) AS rband_delta_mag,\n    rband.fid AS rband_feature_fid\nFROM\n    -- Step 1: AGN objects with probability > 0.6, ranking=1, classifier_name='lc_classifier'\n    (\n        SELECT oid\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND ranking = 1\n          AND probability > 0.6\n    ) AS agn\n    -- Step 2: Join with object table for deltajd >= 365\n    INNER JOIN object o ON agn.oid = o.oid\n        AND o.deltajd >= 365\n    -- Step 3: At least 20 detections in at least one band (feature: n_det >= 20)\n    INNER JOIN (\n        SELECT DISTINCT oid\n        FROM feature\n        WHERE name = 'n_det'\n          AND value >= 20\n    ) AS det20 ON o.oid = det20.oid\n    -- Step 4: Large variations in g band (fid=1, max_mag_corr - min_mag_corr > 1)\n    INNER JOIN (\n        SELECT\n            oid,\n            fid,\n            MAX(CASE WHEN name = 'max_mag_corr' THEN value END) AS max_mag_corr,\n            MAX(CASE WHEN name = 'min_mag_corr' THEN value END) AS min_mag_corr\n        FROM feature\n        WHERE (name = 'max_mag_corr' OR name = 'min_mag_corr')\n          AND fid = 1\n        GROUP BY oid, fid\n        HAVING (MAX(CASE WHEN name = 'max_mag_corr' THEN value END) - \n                MAX(CASE WHEN name = 'min_mag_corr' THEN value END)) > 1\n    ) AS gband ON o.oid = gband.oid\n    -- Step 5: Large variations in r band (fid=2, max_mag_corr - min_mag_corr > 0.5)\n    INNER JOIN (\n        SELECT\n            oid,\n            fid,\n            MAX(CASE WHEN name = 'max_mag_corr' THEN value END) AS max_mag_corr,\n            MAX(CASE WHEN name = 'min_mag_corr' THEN value END) AS min_mag_corr\n        FROM feature\n        WHERE (name = 'max_mag_corr' OR name = 'min_mag_corr')\n          AND fid = 2\n        GROUP BY oid, fid\n        HAVING (MAX(CASE WHEN name = 'max_mag_corr' THEN value END) - \n                MAX(CASE WHEN name = 'min_mag_corr' THEN value END)) > 0.5\n    ) AS rband ON o.oid = rband.oid\n    -- Step 6: Return all features for the selected oids\n    INNER JOIN feature f ON o.oid = f.oid\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5222, "completion_tokens": 738, "total_tokens": 5960, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81355f2888190bd46523a3d5904e7", "custom_id": "16-2", "response": {"status_code": 200, "request_id": "d1f579ffd41f1988acb6d429c6e47560", "body": {"id": "chatcmpl-CTFn42TyjGhuC89YHcMmw3BDzya3A", "object": "chat.completion", "created": 1761088246, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- FINAL QUERY: Get oids, probabilities in stamp and lc classifiers, non-detection info, magstat filter and initial rise for fast risers with SN as top stamp class, first detection in first 2 days of September\nSELECT\n    o.oid,\n    stamp_prob.probability AS stamp_prob,\n    lc_prob.probability AS lc_prob,\n    nd.fid,\n    nd.diffmaglim,\n    ms.fid AS magstat_fid,\n    ms.dmdt_first\nFROM\n    -- Objects with first detection in first 2 days of September\n    object o\n    -- Join: Only objects with highest probability for 'SN' in stamp_classifier\n    INNER JOIN probability stamp_prob\n        ON o.oid = stamp_prob.oid\n        AND stamp_prob.classifier_name = 'stamp_classifier'\n        AND stamp_prob.class_name = 'SN'\n        AND stamp_prob.ranking = 1\n    -- Join: Most likely class in lc_classifier\n    INNER JOIN probability lc_prob\n        ON o.oid = lc_prob.oid\n        AND lc_prob.classifier_name = 'lc_classifier'\n        AND lc_prob.ranking = 1\n    -- Join: magstat for fast risers (dmdt_first >= 0.25)\n    INNER JOIN magstat ms\n        ON o.oid = ms.oid\n        AND ms.dmdt_first >= 0.25\n    -- Join: non_detection in same filter as magstat\n    INNER JOIN non_detection nd\n        ON o.oid = nd.oid\n        AND ms.fid = nd.fid\n        AND nd.mjd < o.firstmjd\n        -- Only the last non-detection before first detection\n        AND nd.mjd = (\n            SELECT MAX(nd2.mjd)\n            FROM non_detection nd2\n            WHERE nd2.oid = o.oid\n              AND nd2.fid = ms.fid\n              AND nd2.mjd < o.firstmjd\n        )\nWHERE\n    o.firstmjd >= 60188.0\n    AND o.firstmjd < 60190.0\nORDER BY\n    o.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4907, "completion_tokens": 455, "total_tokens": 5362, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81355e260819083518b454fccb376", "custom_id": "16-3", "response": {"status_code": 200, "request_id": "6064120f0652fc211511fdf6f645d0f5", "body": {"id": "chatcmpl-CTFn4eCl0pqHLdY8yjBsa3FjTRHyh", "object": "chat.completion", "created": 1761088246, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY HERE]\nSELECT\n    o.oid,\n    p_stamp.probability AS stamp_classifier_probability,\n    p_lc.probability AS lc_classifier_probability,\n    nd.fid,\n    nd.mjd,\n    nd.diffmaglim,\n    ms.fid AS magstat_fid,\n    ms.dmdt_first\nFROM\n    (\n        -- Step 1 & 2: Objects with first detection in first 2 days of September and highest SN probability in stamp classifier\n        SELECT o.oid, o.firstmjd\n        FROM object o\n        INNER JOIN probability p\n            ON o.oid = p.oid\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'SN'\n            AND p.ranking = 1\n        WHERE o.firstmjd >= 60188.0 AND o.firstmjd < 60190.0\n    ) o\n    -- Step 3: Join to first detection per filter for each object\n    INNER JOIN LATERAL (\n        SELECT d1.fid, d1.mjd, d1.magpsf\n        FROM detection d1\n        WHERE d1.oid = o.oid\n        AND d1.mjd = (\n            SELECT MIN(d2.mjd)\n            FROM detection d2\n            WHERE d2.oid = o.oid AND d2.fid = d1.fid\n        )\n    ) fd ON TRUE\n    -- Step 4: Join to last non-detection before first detection in same filter\n    INNER JOIN LATERAL (\n        SELECT n1.fid, n1.mjd, n1.diffmaglim\n        FROM non_detection n1\n        WHERE n1.oid = o.oid\n        AND n1.fid = fd.fid\n        AND n1.mjd = (\n            SELECT MAX(n2.mjd)\n            FROM non_detection n2\n            WHERE n2.oid = o.oid AND n2.fid = fd.fid AND n2.mjd < fd.mjd\n        )\n    ) lnd ON TRUE\n    -- Step 5: Fast riser criterion\n    -- (diffmaglim - magpsf) / (detection.mjd - non_detection.mjd) >= 0.25\n    -- Only keep if criterion is met\n    INNER JOIN magstat ms\n        ON ms.oid = o.oid AND ms.fid = fd.fid\n    INNER JOIN probability p_stamp\n        ON p_stamp.oid = o.oid\n        AND p_stamp.classifier_name = 'stamp_classifier'\n        AND p_stamp.class_name = 'SN'\n        AND p_stamp.ranking = 1\n    INNER JOIN probability p_lc\n        ON p_lc.oid = o.oid\n        AND p_lc.classifier_name = 'lc_classifier'\n        AND p_lc.ranking = 1\n    -- Step 6: Join to all non-detections for the object (including only non-detections)\n    INNER JOIN non_detection nd\n        ON nd.oid = o.oid\n    WHERE\n        ((lnd.diffmaglim - fd.magpsf) / (fd.mjd - lnd.mjd)) >= 0.25\nORDER BY o.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5124, "completion_tokens": 689, "total_tokens": 5813, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135623d08190b1d113ceb9143571", "custom_id": "16-4", "response": {"status_code": 200, "request_id": "0c65a9812b1c972e7cca9e436c8bb1c3", "body": {"id": "chatcmpl-CTFoC75WBX8tDnxNcM2NiXjLja2I6", "object": "chat.completion", "created": 1761088316, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY HERE]\nSELECT\n    o.oid,\n    p_stamp.probability AS stamp_classifier_probability,\n    p_lc.probability AS lc_classifier_probability,\n    nd.fid,\n    nd.mjd,\n    nd.diffmaglim,\n    ms.fid AS magstat_fid,\n    ms.dmdt_first\nFROM\n    (\n        -- Subquery: Find oids with first detection in first 2 days of September and are fast risers\n        SELECT DISTINCT o.oid, d.fid\n        FROM object o\n        INNER JOIN (\n            -- For each oid and fid, get first detection\n            SELECT d1.oid, d1.fid, d1.mjd, d1.magpsf\n            FROM detection d1\n            INNER JOIN (\n                SELECT oid, fid, MIN(mjd) AS first_mjd\n                FROM detection\n                GROUP BY oid, fid\n            ) d2 ON d1.oid = d2.oid AND d1.fid = d2.fid AND d1.mjd = d2.first_mjd\n        ) d ON o.oid = d.oid\n        INNER JOIN (\n            -- For each oid and fid, get last non-detection before first detection\n            SELECT n1.oid, n1.fid, n1.mjd, n1.diffmaglim\n            FROM non_detection n1\n            INNER JOIN (\n                SELECT n.oid, n.fid, MAX(n.mjd) AS last_non_det_mjd, d_min.first_det_mjd\n                FROM non_detection n\n                INNER JOIN (\n                    SELECT oid, fid, MIN(mjd) AS first_det_mjd\n                    FROM detection\n                    GROUP BY oid, fid\n                ) d_min ON n.oid = d_min.oid AND n.fid = d_min.fid\n                WHERE n.mjd < d_min.first_det_mjd\n                GROUP BY n.oid, n.fid, d_min.first_det_mjd\n            ) n2 ON n1.oid = n2.oid AND n1.fid = n2.fid AND n1.mjd = n2.last_non_det_mjd\n        ) nd ON d.oid = nd.oid AND d.fid = nd.fid\n        WHERE\n            o.firstmjd >= 60188.0 AND o.firstmjd < 60190.0\n            -- Fast riser: (diffmaglim - magpsf) / (detection.mjd - non_detection.mjd) >= 0.25\n            AND ((nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd)) >= 0.25\n    ) fast_risers\nINNER JOIN object o ON fast_risers.oid = o.oid\n-- Stamp classifier: highest probability for class 'SN'\nINNER JOIN probability p_stamp\n    ON o.oid = p_stamp.oid\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.class_name = 'SN'\n    AND p_stamp.ranking = 1\n-- Light curve classifier: highest probability (any class)\nINNER JOIN probability p_lc\n    ON o.oid = p_lc.oid\n    AND p_lc.classifier_name = 'lc_classifier'\n    AND p_lc.ranking = 1\n-- All non-detections for the object (light curve)\nINNER JOIN non_detection nd\n    ON o.oid = nd.oid\n    AND nd.fid = fast_risers.fid\n-- magstat for initial rise estimate\nLEFT JOIN magstat ms\n    ON o.oid = ms.oid\n    AND ms.fid = fast_risers.fid\nORDER BY o.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5252, "completion_tokens": 783, "total_tokens": 6035, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81355f4288190a9bbcc9772e5bb48", "custom_id": "14-2", "response": {"status_code": 200, "request_id": "198372878c28aeefebd8072509951664", "body": {"id": "chatcmpl-CTFn5XQ19z7605efw7nu29xH3RyLE", "object": "chat.completion", "created": 1761088247, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT\n    detection.oid,\n    detection.candid,\n    detection.fid,\n    detection.mjd,\n    detection.magpsf,\n    detection.sigmapsf,\n    detection.has_stamp,\n    detection.drb,\n    ps1_ztf.sgscore1,\n    ps1_ztf.distpsnr1\nFROM\n    detection\nINNER JOIN\n    ps1_ztf\n    ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid\nWHERE\n    detection.oid IN (\n        'ZTF23aavzgjg',\n        'ZTF23aaynzyk',\n        'ZTF23aavqxos',\n        'ZTF23aaknyni',\n        'ZTF23aavsdtc',\n        'ZTF18aandkua',\n        'ZTF23aaxfewt',\n        'ZTF23aavshwi',\n        'ZTF22aawasao',\n        'ZTF23aaxgvnt'\n    )\n    AND detection.drb > 0.5\n    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4454, "completion_tokens": 258, "total_tokens": 4712, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81357394481909166fda06f7468fc", "custom_id": "14-3", "response": {"status_code": 200, "request_id": "26d1e0e399c560b0b3f1d6f74c061950", "body": {"id": "chatcmpl-CTFn4MjeRcjwOb7vuGwO9vDEYuBF2", "object": "chat.completion", "created": 1761088246, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select required columns for the given list of oids, with drb > 0.5 and (sgscore1 < 0.5 OR distpsnr1 < 1)\nSELECT\n    detection.oid,\n    detection.candid,\n    detection.fid,\n    detection.mjd,\n    detection.magpsf,\n    detection.sigmapsf,\n    detection.has_stamp,\n    detection.drb,\n    ps1_ztf.sgscore1,\n    ps1_ztf.distpsnr1\nFROM\n    detection\nINNER JOIN\n    ps1_ztf\n    ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid\nWHERE\n    detection.oid IN (\n        'ZTF23aavzgjg',\n        'ZTF23aaynzyk',\n        'ZTF23aavqxos',\n        'ZTF23aaknyni',\n        'ZTF23aavsdtc',\n        'ZTF18aandkua',\n        'ZTF23aaxfewt',\n        'ZTF23aavshwi',\n        'ZTF22aawasao',\n        'ZTF23aaxgvnt'\n    )\n    AND detection.drb > 0.5\n    AND (\n        ps1_ztf.sgscore1 < 0.5\n        OR ps1_ztf.distpsnr1 < 1\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4295, "completion_tokens": 302, "total_tokens": 4597, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f813576f208190a83b1885e080a413", "custom_id": "14-4", "response": {"status_code": 200, "request_id": "65e39dc1e72fbb75f6a0dc20d8f38952", "body": {"id": "chatcmpl-CTFnAXzCc6aqntiX6PUcWKFUZUxnJ", "object": "chat.completion", "created": 1761088252, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    detection.oid,\n    detection.candid,\n    detection.fid,\n    detection.mjd,\n    detection.magpsf,\n    detection.sigmapsf,\n    detection.has_stamp,\n    detection.drb,\n    ps1_ztf.sgscore1,\n    ps1_ztf.distpsnr1\nFROM detection\nINNER JOIN ps1_ztf\n    ON detection.oid = ps1_ztf.oid\n    AND detection.candid = ps1_ztf.candid\nWHERE detection.oid IN (\n    'ZTF23aavzgjg',\n    'ZTF23aaynzyk',\n    'ZTF23aavqxos',\n    'ZTF23aaknyni',\n    'ZTF23aavsdtc',\n    'ZTF18aandkua',\n    'ZTF23aaxfewt',\n    'ZTF23aavshwi',\n    'ZTF22aawasao',\n    'ZTF23aaxgvnt'\n)\nAND detection.drb > 0.5\nAND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4502, "completion_tokens": 251, "total_tokens": 4753, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135740848190a208d2db757c162e", "custom_id": "12-4", "response": {"status_code": 200, "request_id": "9b610d7688c4da18f12937c0f1d1b0e5", "body": {"id": "chatcmpl-CTFn5mAGEfYyh6TLf726QuKTaTW59", "object": "chat.completion", "created": 1761088247, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT object.oid, object.meanra, object.meandec\nFROM probability\nINNER JOIN object ON probability.oid = object.oid\nWHERE probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND probability.ranking = 1\n  AND probability.classifier_name = 'lc_classifier'\n  AND object.firstmjd BETWEEN 59988.0 AND 60197.0\n  AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4117, "completion_tokens": 142, "total_tokens": 4259, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f813574dd08190be03a65874c875cb", "custom_id": "103-2", "response": {"status_code": 200, "request_id": "4d712384016aec45f63fcd296d8994c5", "body": {"id": "chatcmpl-CTFnAtvRJMVHNSDrJntUYj93E61xQ", "object": "chat.completion", "created": 1761088252, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from object, probability, and ps1_ztf for ZTF objects\n-- with distpsnr1 > 5, probability > 0.7 for non-supernova classes in lc_classifier,\n-- ordered by distpsnr1, limited to 200 results\n\nSELECT\n    object.*,\n    probability.*,\n    ps1_ztf.*\nFROM\n    object\nINNER JOIN probability\n    ON object.oid = probability.oid\nINNER JOIN ps1_ztf\n    ON object.oid = ps1_ztf.oid\nWHERE\n    probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.7\n    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND ps1_ztf.distpsnr1 > 5\nORDER BY\n    ps1_ztf.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4640, "completion_tokens": 213, "total_tokens": 4853, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135772e48190b8c4db6ec767af8d", "custom_id": "103-3", "response": {"status_code": 200, "request_id": "e536a072a728ec942b968fffb21d762d", "body": {"id": "chatcmpl-CTFn4nks9lcTsjceTbT4YTtrPGdBm", "object": "chat.completion", "created": 1761088246, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT object.*, probability.*, ps1_ztf.*\nFROM object\nINNER JOIN (\n    SELECT *\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.7\n      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n) AS probability ON object.oid = probability.oid\nINNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid\nWHERE ps1_ztf.distpsnr1 > 5\nORDER BY ps1_ztf.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4767, "completion_tokens": 141, "total_tokens": 4908, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135769448190b110cbbfb99326e2", "custom_id": "103-4", "response": {"status_code": 200, "request_id": "47f8e55add54540c550f327ebe422b25", "body": {"id": "chatcmpl-CTFnBiHFu2O65mDlS8BujEE6u11wy", "object": "chat.completion", "created": 1761088253, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.*, \n    probability.*, \n    ps1_ztf.*\nFROM \n    object\nINNER JOIN \n    probability \n    ON object.oid = probability.oid\nINNER JOIN \n    ps1_ztf \n    ON object.oid = ps1_ztf.oid\nWHERE \n    probability.ranking = 1\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.probability > 0.7\n    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND ps1_ztf.distpsnr1 > 5\nORDER BY \n    ps1_ztf.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4081, "completion_tokens": 159, "total_tokens": 4240, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135789808190b2a213e5e8f53eeb", "custom_id": "102-2", "response": {"status_code": 200, "request_id": "148ea9d46903ffd45e050eb382462ed7", "body": {"id": "chatcmpl-CTFnDEzb5esvJDYv2GwKYsP9b8H4y", "object": "chat.completion", "created": 1761088255, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from magstat for ZTF objects with AGN probability > 0.6 (lc_classifier, ranking=1)\n-- and WISE W1 magnitude (w1mpro) between 12 and 13, limit to 50 results.\nSELECT magstat.*\nFROM magstat\nINNER JOIN probability\n    ON magstat.oid = probability.oid\n-- Assuming a cross-match table 'xmatch' exists to relate ZTF oids to allwise oids\nINNER JOIN xmatch\n    ON magstat.oid = xmatch.oid\nINNER JOIN allwise\n    ON xmatch.oid_allwise = allwise.oid_catalog\nWHERE probability.class_name = 'AGN'\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\n  AND probability.probability > 0.6\n  AND allwise.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4257, "completion_tokens": 200, "total_tokens": 4457, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135755c081909d10481233909417", "custom_id": "102-3", "response": {"status_code": 200, "request_id": "35b72ee5d29f40bc36f8a4f1e9ac1424", "body": {"id": "chatcmpl-CTFn4MUVq2Ss3iKzryl5ZB2DZDEph", "object": "chat.completion", "created": 1761088246, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from magstat for ZTF objects with AGN probability > 0.6 (lc_classifier, ranking=1)\n-- and WISE W1 magnitude (w1mpro) between 12 and 13, limit to 50 results\n\nSELECT magstat.*\nFROM magstat\nINNER JOIN probability\n    ON magstat.oid = probability.oid\n    AND probability.class_name = 'AGN'\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.6\nINNER JOIN xmatch\n    ON magstat.oid = xmatch.oid\nINNER JOIN allwise\n    ON xmatch.oid_catalog = allwise.oid_catalog\n    AND allwise.w1mpro >= 12\n    AND allwise.w1mpro <= 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4264, "completion_tokens": 186, "total_tokens": 4450, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135789748190b66ab2d9d0c54fee", "custom_id": "102-4", "response": {"status_code": 200, "request_id": "de43788b77eb304809567555a629d833", "body": {"id": "chatcmpl-CTFnCf33qW6kXFnkAYu3RbuhEA3zW", "object": "chat.completion", "created": 1761088254, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from magstat for ZTF objects classified as AGN (probability > 0.6, ranking=1, classifier_name='lc_classifier')\n-- and cross-matched to a WISE source with w1mpro between 12 and 13 (within 2 arcsec)\nSELECT magstat.*\nFROM probability\nINNER JOIN magstat ON probability.oid = magstat.oid\nINNER JOIN object ON probability.oid = object.oid\nINNER JOIN allwise\n    ON q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 2.0/3600.0) -- 2 arcsec radius\nWHERE probability.class_name = 'AGN'\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\n  AND probability.probability > 0.6\n  AND allwise.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4443, "completion_tokens": 203, "total_tokens": 4646, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f813579c908190ada32ae197789797", "custom_id": "104-2", "response": {"status_code": 200, "request_id": "195a5d76b98343dbdd9b7f2658fabc7d", "body": {"id": "chatcmpl-CTFn4OqOntUfpKfEfN2jakLn9LUl5", "object": "chat.completion", "created": 1761088246, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find at most 30 ZTF objects classified as asteroid by the stamp classifier with probability > 0.9\n-- Return: oid, candid, ssdistnr, ssmagnr, ssnamenr, fid, FWHM (not available), PS1 calibrators (not available), exposure time (not available)\nSELECT\n    o.oid,\n    d.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    d.fid\n    -- FWHM from SExtractor, number of PS1 calibrators, and exposure time are not present in the available schema\nFROM\n    probability p\n    INNER JOIN object o ON p.oid = o.oid\n    INNER JOIN ss_ztf s ON o.oid = s.oid\n    INNER JOIN detection d ON o.oid = d.oid\nWHERE\n    p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4384, "completion_tokens": 243, "total_tokens": 4627, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f813589a78819098cb67309773ac29", "custom_id": "104-3", "response": {"status_code": 200, "request_id": "6166abab527255fdf9d237dbe542f79a", "body": {"id": "chatcmpl-CTFnFPVnQn6hYAtKIW1kH2pWa08a4", "object": "chat.completion", "created": 1761088257, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find at most 30 ZTF objects classified as 'asteroid' by the stamp classifier with probability > 0.9\n-- Return ZTF object and candidate identifiers, Solar System object info, filter id\n-- FWHM from SExtractor, number of PS1 calibrators, and exposure time are not present in the provided schema\n\nSELECT\n    object.oid,\n    detection.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssmagnr,\n    ss_ztf.ssnamenr,\n    detection.fid\n    -- FWHM from SExtractor, number of PS1 calibrators, and exposure time are not available in the provided schema\nFROM\n    probability\n    INNER JOIN object ON probability.oid = object.oid\n    INNER JOIN detection ON object.oid = detection.oid\n    INNER JOIN ss_ztf ON object.oid = ss_ztf.oid\nWHERE\n    probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.9\n    AND probability.ranking = 1\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4319, "completion_tokens": 262, "total_tokens": 4581, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81358c0208190a2ca8dd2ab170094", "custom_id": "104-4", "response": {"status_code": 200, "request_id": "4c344191c78e22c0baaab8704d8e905a", "body": {"id": "chatcmpl-CTFnFzuDIWQytrLidAbqPXiS3XQCQ", "object": "chat.completion", "created": 1761088257, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- The following query retrieves up to 30 ZTF objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4'\n-- with probability > 0.9, including the requested columns. Note: FWHM from SExtractor, number of PS1 calibrators, and exposure time\n-- are not present in the provided schema and thus cannot be included.\n\nSELECT\n    object.oid,                -- ZTF object identifier\n    detection.candid,          -- Candidate identifier\n    ss_ztf.ssdistnr,           -- Distance from nearest Solar System object\n    ss_ztf.ssmagnr,            -- MPC archive magnitude\n    ss_ztf.ssnamenr,           -- Name of nearest Solar System object\n    detection.fid              -- Filter identifier\n    -- FWHM from SExtractor, number of PS1 calibrators, and exposure time are not available in the provided schema\nFROM\n    probability\nINNER JOIN object ON probability.oid = object.oid\nINNER JOIN ss_ztf ON object.oid = ss_ztf.oid\nINNER JOIN detection ON object.oid = detection.oid\nWHERE\n    probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.9\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4494, "completion_tokens": 301, "total_tokens": 4795, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81358dc488190ba62bfa9106beff8", "custom_id": "107-2", "response": {"status_code": 200, "request_id": "b12c1c8b6f8b10281faacd18f7208643", "body": {"id": "chatcmpl-CTFnA7tBqWRImhIwQyuuxHRgBPjWm", "object": "chat.completion", "created": 1761088252, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve up to 10 ZTF objects with >500 detections, asteroid probability >0.5 in stamp_classifier_1.0.4,\n-- and Solar System object match within 2 arcsec. Return requested columns, ordered by first detection date.\nSELECT\n    object.oid,\n    object.ndet,\n    object.firstmjd,\n    object.lastmjd,\n    probability.probability,\n    ss_ztf.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssnamenr,\n    detection.mjd,\n    detection.fid\nFROM object\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.5\nINNER JOIN ss_ztf\n    ON object.oid = ss_ztf.oid\n    AND ss_ztf.ssdistnr < 2\nINNER JOIN detection\n    ON ss_ztf.oid = detection.oid\n    AND ss_ztf.candid = detection.candid\nWHERE object.ndet > 500\nORDER BY object.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4834, "completion_tokens": 275, "total_tokens": 5109, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135895ac8190b7f69db6bf5c41a5", "custom_id": "107-3", "response": {"status_code": 200, "request_id": "e822a051c8cfa4e4f3856a5770b70c53", "body": {"id": "chatcmpl-CTFnFVDcgfqR0DNlbeXJXqtsrUAjm", "object": "chat.completion", "created": 1761088257, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid,\n    object.ndet,\n    object.firstmjd,\n    object.lastmjd,\n    probability.probability,\n    ss_ztf.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssnamenr,\n    detection.mjd,\n    detection.fid\nFROM object\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.5\nINNER JOIN ss_ztf\n    ON object.oid = ss_ztf.oid\n    AND ss_ztf.ssdistnr < 2\nINNER JOIN detection\n    ON ss_ztf.oid = detection.oid\n    AND ss_ztf.candid = detection.candid\nWHERE object.ndet > 500\nORDER BY object.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4917, "completion_tokens": 222, "total_tokens": 5139, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81358e2788190acac064f3337f8c8", "custom_id": "107-4", "response": {"status_code": 200, "request_id": "7bfb0feaa3477a510bdeefcaa8475418", "body": {"id": "chatcmpl-CTFnAGTZB26bCWDk5TA9JQHnp1Qlo", "object": "chat.completion", "created": 1761088252, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve at most 10 ZTF objects with >500 detections, asteroid probability >0.5 in stamp_classifier_1.0.4,\n-- and Solar System object match within 2 arcsec. Return requested columns, ordered by first detection date.\nSELECT\n    object.oid,\n    object.ndet,\n    object.firstmjd,\n    object.lastmjd,\n    probability.probability,\n    ss_ztf.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssnamenr,\n    detection.mjd,\n    detection.fid\nFROM object\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.5\nINNER JOIN ss_ztf\n    ON object.oid = ss_ztf.oid\n    AND ss_ztf.ssdistnr < 2\nINNER JOIN detection\n    ON ss_ztf.oid = detection.oid\n    AND ss_ztf.candid = detection.candid\nWHERE object.ndet > 500\nORDER BY object.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4883, "completion_tokens": 275, "total_tokens": 5158, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81358e85481909d93e1f5ff46d79d", "custom_id": "84-2", "response": {"status_code": 200, "request_id": "faf7c00c8639aa83eec5d4e88ebd8d0d", "body": {"id": "chatcmpl-CTFnLA2HeRbEBUHkIlUJcYcWBUgKY", "object": "chat.completion", "created": 1761088263, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get ALLWISE matches for ZTF object 'ZTF19aascdol' within 3 arcseconds\nSELECT\n    object.oid AS ztf_oid,\n    allwise.oid_catalog AS allwise_oid,\n    q3c_dist(object.meanra, object.meandec, allwise.ra, allwise.dec) AS distance,\n    allwise.w1mpro,\n    allwise.w2mpro,\n    allwise.w3mpro,\n    allwise.w4mpro\nFROM\n    object\nINNER JOIN allwise\n    ON q3c_dist(object.meanra, object.meandec, allwise.ra, allwise.dec) < 0.0008333\nWHERE\n    object.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4128, "completion_tokens": 162, "total_tokens": 4290, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81358d67c81909d420adfd50fe79e", "custom_id": "84-3", "response": {"status_code": 200, "request_id": "0622edeefc8a65efd2701d2d1364b285", "body": {"id": "chatcmpl-CTFnGFRiE03I7oKTN8LsunNNnlx76", "object": "chat.completion", "created": 1761088258, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve ALLWISE matches for ZTF object 'ZTF19aascdol', including identifiers, distance, and W1-W4 magnitudes\nSELECT\n    o.oid AS ztf_oid,\n    a.oid_catalog AS allwise_oid,\n    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS distance_arcsec,\n    a.w1mpro,\n    a.w2mpro,\n    a.w3mpro,\n    a.w4mpro\nFROM\n    object o\nJOIN\n    allwise a\n    ON q3c_radial_query(o.meanra, o.meandec, a.ra, a.dec, 3.0/3600.0) -- 3 arcsec radius\nWHERE\n    o.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4133, "completion_tokens": 176, "total_tokens": 4309, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81358e55c8190b8ba68e8b939c1f8", "custom_id": "84-4", "response": {"status_code": 200, "request_id": "af42b2be696b1d22f1550e5fdee54fc8", "body": {"id": "chatcmpl-CTFnREGuYKipQUWvPwRdzNPhfi9Bj", "object": "chat.completion", "created": 1761088269, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve ALLWISE matches for ZTF object 'ZTF19aascdol', with angular distance and WISE magnitudes\nSELECT\n    object.oid,\n    allwise.oid_catalog,\n    q3c_dist(object.meanra, object.meandec, allwise.ra, allwise.dec) AS angular_distance_deg,\n    allwise.w1mpro,\n    allwise.w2mpro,\n    allwise.w3mpro,\n    allwise.w4mpro\nFROM\n    object\n    INNER JOIN allwise\n        ON q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 0.0008333) -- 3 arcsec radius\nWHERE\n    object.oid = 'ZTF19aascdol'\nORDER BY\n    angular_distance_deg ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4185, "completion_tokens": 175, "total_tokens": 4360, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81358d9148190b41d4a7c1de62406", "custom_id": "96-2", "response": {"status_code": 200, "request_id": "4e38237735749173f26fd6d68939c05b", "body": {"id": "chatcmpl-CTFnLMiFgcli65HgOXq5rzI5CPNeA", "object": "chat.completion", "created": 1761088263, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the coordinates for the Solar System objects of interest\nWITH catalog(ssnamenr, ra, dec) AS (\n    VALUES\n        ('2003FP134', 163.1234, 5.6789),  -- <-- Replace with actual RA/Dec for 2003FP134\n        ('2009UK56', 210.9876, -12.3456)  -- <-- Replace with actual RA/Dec for 2009UK56\n),\n-- Find all ss_ztf entries for these objects\nmatched_ss_ztf AS (\n    SELECT s.*\n    FROM ss_ztf s\n    INNER JOIN catalog c ON s.ssnamenr = c.ssnamenr\n),\n-- Find all detections within 2 arcsec of the Solar System object positions\nmatched_detections AS (\n    SELECT\n        s.*,\n        d.mjd,\n        d.fid,\n        d.isdiffpos,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf\n    FROM matched_ss_ztf s\n    INNER JOIN catalog c ON s.ssnamenr = c.ssnamenr\n    INNER JOIN detection d ON s.oid = d.oid\n    WHERE q3c_radial_query(d.ra, d.dec, c.ra, c.dec, 2.0/3600.0)  -- 2 arcsec in degrees\n)\nSELECT *\nFROM matched_detections\nORDER BY ssnamenr, mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4252, "completion_tokens": 317, "total_tokens": 4569, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f81358e7c481909138041c0d265f6c", "custom_id": "96-3", "response": {"status_code": 200, "request_id": "714f6c9cea3095547ffb876a8aa52c10", "body": {"id": "chatcmpl-CTFnZGjobD53yknpCJwqzRBzaI7v8", "object": "chat.completion", "created": 1761088277, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all detections for ZTF objects within 2 arcsec of any detection of '2003FP134' or '2009UK56'\nWITH ss_positions AS (\n    SELECT DISTINCT ssnamenr, ra, dec\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n),\nmatched_objects AS (\n    SELECT DISTINCT o.oid, s.ssnamenr, s.ra AS ss_ra, s.dec AS ss_dec\n    FROM ss_positions s\n    JOIN object o\n      ON q3c_radial_query(o.meanra, o.meandec, s.ra, s.dec, 2.0/3600.0)\n)\nSELECT\n    ss.*,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM matched_objects mo\nJOIN detection d ON d.oid = mo.oid\nJOIN ss_ztf ss ON ss.oid = d.oid AND ss.candid = d.candid\nORDER BY ss.ssnamenr, d.mjd ASC\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4318, "completion_tokens": 246, "total_tokens": 4564, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a12608190850b15fd33520534", "custom_id": "96-4", "response": {"status_code": 200, "request_id": "7f232d23a9e9fbdb32e6210102dcb404", "body": {"id": "chatcmpl-CTFnWzHpsR5iA1MCccSNntaO9MPma", "object": "chat.completion", "created": 1761088274, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Replace the RA/Dec values below with the actual coordinates for '2003FP134' and '2009UK56'\nWITH catalog AS (\n    SELECT '2003FP134' AS source_id, <RA_2003FP134> AS ra, <DEC_2003FP134> AS dec\n    UNION ALL\n    SELECT '2009UK56' AS source_id, <RA_2009UK56> AS ra, <DEC_2009UK56> AS dec\n)\nSELECT\n    ss_ztf.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra,\n    detection.dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM\n    catalog\n    INNER JOIN detection\n        ON q3c_radial_query(detection.ra, detection.dec, catalog.ra, catalog.dec, 2.0/3600.0)\n    INNER JOIN ss_ztf\n        ON detection.oid = ss_ztf.oid AND detection.candid = ss_ztf.candid\nWHERE\n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\nORDER BY\n    ss_ztf.ssnamenr,\n    detection.mjd\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4242, "completion_tokens": 268, "total_tokens": 4510, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a091c819081e3e9c64c4d94ce", "custom_id": "94-2", "response": {"status_code": 200, "request_id": "18a63d5af93c78c24899a351213d030b", "body": {"id": "chatcmpl-CTFnfxMI26YRrqQWySlpusmp6ilYF", "object": "chat.completion", "created": 1761088283, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' for objects with a reference change, limit to 50 rows\nSELECT object.*, reference.*\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3863, "completion_tokens": 60, "total_tokens": 3923, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a29908190b2b95482b2e90bd9", "custom_id": "94-3", "response": {"status_code": 200, "request_id": "186fdcca6fdef4eb7012647a1eff42e5", "body": {"id": "chatcmpl-CTFndSgiXndDFO8pShpE0G1Ij6CtC", "object": "chat.completion", "created": 1761088281, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' for objects with a reference change, limit to 50 rows\nSELECT object.*, reference.*\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3844, "completion_tokens": 60, "total_tokens": 3904, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a1ac481908a1980414c0289ec", "custom_id": "94-4", "response": {"status_code": 200, "request_id": "01957585dad7b546ed920fe4eae6fc2a", "body": {"id": "chatcmpl-CTFnmep5qoQcTJKyBsUS8gKAxc7iF", "object": "chat.completion", "created": 1761088290, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' for objects with a reference change\nSELECT object.*, reference.*\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3942, "completion_tokens": 54, "total_tokens": 3996, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a258081908bb118c83ecf3700", "custom_id": "90-2", "response": {"status_code": 200, "request_id": "34a0eb6c6618603bc1f7812a24198c96", "body": {"id": "chatcmpl-CTFnk2nJmDUWbk3ELREBDQx8xMDLB", "object": "chat.completion", "created": 1761088288, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from the probability table for up to 100 objects\n-- with Multiband_period < 5 in feature version 'lc_classifier_1.2.1-P',\n-- for the light curve classifier and rankings 1 or 2\n\nSELECT p.*\nFROM probability p\nINNER JOIN (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n) oids ON p.oid = oids.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4050, "completion_tokens": 154, "total_tokens": 4204, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a31508190b10b6aa5e172164a", "custom_id": "90-3", "response": {"status_code": 200, "request_id": "10dda656944399e320f7eae81b473728", "body": {"id": "chatcmpl-CTFnsVSaAg92YhN8Rzk1WlmrH3UM8", "object": "chat.completion", "created": 1761088296, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability for objects with Multiband_period < 5 (lc_classifier_1.2.1-P), classifier_name='lc_classifier', ranking 1 or 2, limit 100 rows\nSELECT probability.*\nFROM probability\nINNER JOIN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n) AS filtered_features\nON probability.oid = filtered_features.oid\nWHERE probability.classifier_name = 'lc_classifier'\n  AND probability.ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4092, "completion_tokens": 139, "total_tokens": 4231, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a3c54819081872585d0828c00", "custom_id": "90-4", "response": {"status_code": 200, "request_id": "9cec6cd3d3602ca956dd63e4f3dde191", "body": {"id": "chatcmpl-CTFnqP7ImKnnNxx24nxepRFWDP8k0", "object": "chat.completion", "created": 1761088294, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from the probability table for up to 100 objects\n-- with Multiband_period < 5 in feature version 'lc_classifier_1.2.1-P',\n-- only for classifier_name 'lc_classifier' and ranking 1 or 2\n\nSELECT probability.*\nFROM probability\nINNER JOIN (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n) AS filtered_oids\nON probability.oid = filtered_oids.oid\nWHERE probability.classifier_name = 'lc_classifier'\n  AND probability.ranking IN (1, 2)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4097, "completion_tokens": 154, "total_tokens": 4251, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a83548190be99534f37222ace", "custom_id": "100-2", "response": {"status_code": 200, "request_id": "1a7cdad79c6fdb4f65744c33847490a7", "body": {"id": "chatcmpl-CTFnxalqC2hGw3QjOM90hedJhmaAn", "object": "chat.completion", "created": 1761088301, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\nSELECT\n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    magpsf AS \"detection difference magnitude\",\n    sigmapsf AS \"detection magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced magnitude uncertainty\",\n    'detection' AS \"table\"\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    NULL AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"detection magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced magnitude uncertainty\",\n    'non_detection' AS \"table\"\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"detection magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    mag AS \"forced difference magnitude\",\n    e_mag AS \"forced magnitude uncertainty\",\n    'forced_photometry' AS \"table\"\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY \"epoch date\", \"filter identifier\";\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4702, "completion_tokens": 379, "total_tokens": 5081, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a340c8190a1fbfa95bea4cac6", "custom_id": "100-3", "response": {"status_code": 200, "request_id": "2b7c1358d77a40a917e13db171870965", "body": {"id": "chatcmpl-CTFo2HgKYrsHoyx6wONstP6xXrQQG", "object": "chat.completion", "created": 1761088306, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\n-- Return all epochs in a single output table with the specified columns and a 'table' column indicating the source\n\nSELECT\n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    magpsf AS \"detection difference magnitude\",\n    sigmapsf AS \"detection difference magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL::DOUBLE PRECISION AS \"forced difference magnitude\",\n    NULL::DOUBLE PRECISION AS \"forced difference magnitude uncertainty\",\n    'detection' AS \"table\"\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    NULL::INTEGER AS \"isdiffpos flag\",\n    NULL::DOUBLE PRECISION AS \"detection difference magnitude\",\n    NULL::DOUBLE PRECISION AS \"detection difference magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL::DOUBLE PRECISION AS \"forced difference magnitude\",\n    NULL::DOUBLE PRECISION AS \"forced difference magnitude uncertainty\",\n    'non_detection' AS \"table\"\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    NULL::DOUBLE PRECISION AS \"detection difference magnitude\",\n    NULL::DOUBLE PRECISION AS \"detection difference magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    mag AS \"forced difference magnitude\",\n    e_mag AS \"forced difference magnitude uncertainty\",\n    'forced_photometry' AS \"table\"\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY \"epoch date\", \"filter identifier\";\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4711, "completion_tokens": 442, "total_tokens": 5153, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135a55008190978ec84586bb8cea", "custom_id": "100-4", "response": {"status_code": 200, "request_id": "16e656481d3ba2b22d02deaee1d23ce6", "body": {"id": "chatcmpl-CTFnypWCnQ6yRiCwGeIJMF1MvOYDA", "object": "chat.completion", "created": 1761088302, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\nSELECT\n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    magpsf AS \"detection difference magnitude\",\n    sigmapsf AS \"detection magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL::DOUBLE PRECISION AS \"forced difference magnitude\",\n    NULL::DOUBLE PRECISION AS \"forced magnitude uncertainty\",\n    'detection' AS \"table\"\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    NULL::INTEGER AS \"isdiffpos flag\",\n    NULL::DOUBLE PRECISION AS \"detection difference magnitude\",\n    NULL::DOUBLE PRECISION AS \"detection magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL::DOUBLE PRECISION AS \"forced difference magnitude\",\n    NULL::DOUBLE PRECISION AS \"forced magnitude uncertainty\",\n    'non_detection' AS \"table\"\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    NULL::DOUBLE PRECISION AS \"detection difference magnitude\",\n    NULL::DOUBLE PRECISION AS \"detection magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    mag AS \"forced difference magnitude\",\n    e_mag AS \"forced magnitude uncertainty\",\n    'forced_photometry' AS \"table\"\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY \"epoch date\", \"filter identifier\";\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4685, "completion_tokens": 413, "total_tokens": 5098, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135b56108190b0a8562630eedcc6", "custom_id": "106-2", "response": {"status_code": 200, "request_id": "dc7c7268cbd130edc0a85283ed0def10", "body": {"id": "chatcmpl-CTFo9ZKC5z3MxZ4fSBtVZkyTxFMdu", "object": "chat.completion", "created": 1761088313, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p_stamp.probability AS prob_stamp_bogus,\n    p_lc.probability AS prob_lc_transient\nFROM object o\nINNER JOIN (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'bogus'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n) p_stamp ON o.oid = p_stamp.oid\nINNER JOIN (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n) p_lc ON o.oid = p_lc.oid\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4564, "completion_tokens": 194, "total_tokens": 4758, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135bb4d48190a3e11520a378ce7c", "custom_id": "106-3", "response": {"status_code": 200, "request_id": "61faf47e2c1ad8f5b821baae4d5b7391", "body": {"id": "chatcmpl-CTFo4wSez5FsSt5uCgHiU5gweHVmb", "object": "chat.completion", "created": 1761088308, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with >10 detections, high bogus probability in stamp classifier, and high transient probability in lc_classifier_top\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p_stamp.probability AS prob_stamp_bogus,\n    p_lc.probability AS prob_lc_transient\nFROM\n    object o\n    INNER JOIN (\n        SELECT\n            oid,\n            probability\n        FROM\n            probability\n        WHERE\n            classifier_name = 'stamp_classifier'\n            AND classifier_version = 'stamp_classifier_1.0.4'\n            AND class_name = 'bogus'\n            AND probability > 0.7\n    ) p_stamp ON o.oid = p_stamp.oid\n    INNER JOIN (\n        SELECT\n            oid,\n            probability\n        FROM\n            probability\n        WHERE\n            classifier_name = 'lc_classifier_top'\n            AND class_name = 'Transient'\n            AND probability > 0.9\n    ) p_lc ON o.oid = p_lc.oid\nWHERE\n    o.ndet > 10\nORDER BY\n    o.oid ASC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4748, "completion_tokens": 246, "total_tokens": 4994, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135bc62c8190abd26e18dd0148dd", "custom_id": "106-4", "response": {"status_code": 200, "request_id": "bc58f6def4d2211100ab832df5fe3ef8", "body": {"id": "chatcmpl-CTFoEouqfwOpygqrJBO21I11x7ZJJ", "object": "chat.completion", "created": 1761088318, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p_bogus.probability AS prob_stamp_bogus,\n    p_transient.probability AS prob_lc_transient\nFROM object o\nINNER JOIN (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'bogus'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n      AND ranking = 1\n) p_bogus ON o.oid = p_bogus.oid\nINNER JOIN (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n      AND ranking = 1\n) p_transient ON o.oid = p_transient.oid\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4560, "completion_tokens": 214, "total_tokens": 4774, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135f0d5881909427ed239e2d8cff", "custom_id": "58-2", "response": {"status_code": 200, "request_id": "864bc8d222f13cab05dbb0116b89c05c", "body": {"id": "chatcmpl-CTFoBBv4BhnTxoWMCT1EMXO3Jryhq", "object": "chat.completion", "created": 1761088315, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT object.*\nFROM object\nINNER JOIN magstat AS mg ON object.oid = mg.oid AND mg.fid = 1  -- g-band\nINNER JOIN magstat AS mr ON object.oid = mr.oid AND mr.fid = 2  -- r-band\nWHERE object.ndet >= 30\n  AND (object.lastmjd - object.firstmjd) > 20\n  AND ABS(mg.magmin_corr - mr.magmin_corr) > 3.5\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4149, "completion_tokens": 111, "total_tokens": 4260, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135b965c8190bce13d260a786c9d", "custom_id": "58-3", "response": {"status_code": 200, "request_id": "04a0259cec818caac3ef29337454d398", "body": {"id": "chatcmpl-CTFoNXN5YLHW3FgaGeo1sGX5J82cl", "object": "chat.completion", "created": 1761088327, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT object.*\nFROM object\nINNER JOIN (\n    SELECT \n        mg.oid,\n        mg.magmin_corr AS magmin_corr_g,\n        mr.magmin_corr AS magmin_corr_r\n    FROM \n        magstat mg\n    INNER JOIN \n        magstat mr\n        ON mg.oid = mr.oid\n    WHERE \n        mg.fid = 1  -- g-band\n        AND mr.fid = 2  -- r-band\n) AS magdiff\nON object.oid = magdiff.oid\nWHERE \n    object.ndet >= 30\n    AND object.deltajd > 20\n    AND (magdiff.magmin_corr_g - magdiff.magmin_corr_r) > 3.5\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4023, "completion_tokens": 161, "total_tokens": 4184, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135b7fd88190a3a3e3f3aac5c572", "custom_id": "58-4", "response": {"status_code": 200, "request_id": "11a352f5bc3a025772fc0142326a6c17", "body": {"id": "chatcmpl-CTFoGf6ua5fcTzbN6qLN4LOHBfnNe", "object": "chat.completion", "created": 1761088320, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN (\n    SELECT \n        mg.oid,\n        mg.magmin_corr AS g_magmin_corr,\n        mr.magmin_corr AS r_magmin_corr\n    FROM \n        magstat mg\n    INNER JOIN \n        magstat mr\n        ON mg.oid = mr.oid\n    WHERE \n        mg.fid = 1  -- g-band\n        AND mr.fid = 2  -- r-band\n) m ON o.oid = m.oid\nWHERE \n    o.ndet >= 30\n    AND o.deltajd > 20\n    AND (m.g_magmin_corr - m.r_magmin_corr) > 3.5\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4040, "completion_tokens": 156, "total_tokens": 4196, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135ba2588190a2770c75aa4cb4c5", "custom_id": "39-2", "response": {"status_code": 200, "request_id": "ef7b205a905f8d12768b02c56449901e", "body": {"id": "chatcmpl-CTFnAaERCk0nFmqkQJpnEiSDupdZm", "object": "chat.completion", "created": 1761088252, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get required columns for CV/Nova objects classified by the stochastic light curve classifier,\n-- with ndet <= 50, only r-band detections, and include the maximum rise from minimum magpsf_corr per object.\nSELECT\n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    maxmin_rise.max_rise_from_min\nFROM\n    probability p\n    INNER JOIN object o ON p.oid = o.oid\n    INNER JOIN detection d ON o.oid = d.oid\n    INNER JOIN (\n        -- Subquery to compute max rise from min magpsf_corr in r-band per object\n        SELECT\n            oid,\n            MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise_from_min\n        FROM\n            detection\n        WHERE\n            fid = 2\n        GROUP BY\n            oid\n    ) AS maxmin_rise ON o.oid = maxmin_rise.oid\nWHERE\n    p.class_name = 'CV/Nova'\n    AND p.classifier_name = 'lc_classifier_stochastic'\n    AND p.ranking = 1\n    AND o.ndet <= 50\n    AND d.fid = 2\nORDER BY\n    o.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4819, "completion_tokens": 300, "total_tokens": 5119, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135b81cc8190967031d325571220", "custom_id": "39-3", "response": {"status_code": 200, "request_id": "3d64c0fcc5b3aa02ee9eae3b1c7b68c4", "body": {"id": "chatcmpl-CTFoTd1m5DjwosDGN45MizLQyPYf2", "object": "chat.completion", "created": 1761088333, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY HERE]\nSELECT\n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    mr.max_rise_from_min\nFROM\n    (\n        SELECT\n            p.oid\n        FROM\n            probability p\n        WHERE\n            p.class_name = 'CV/Nova'\n            AND p.classifier_name = 'lc_classifier_stochastic'\n            AND p.ranking = 1\n    ) AS prob\n    INNER JOIN object o ON prob.oid = o.oid\n    INNER JOIN detection d ON o.oid = d.oid\n    INNER JOIN (\n        -- Subquery to compute the maximum rise from minimum magpsf_corr in r-band for each object\n        SELECT\n            d2.oid,\n            MAX(d2.magpsf_corr) - MIN(d2.magpsf_corr) AS max_rise_from_min\n        FROM\n            detection d2\n        WHERE\n            d2.fid = 2\n        GROUP BY\n            d2.oid\n    ) AS mr ON o.oid = mr.oid\nWHERE\n    o.ndet <= 50\n    AND d.fid = 2\nORDER BY\n    o.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4586, "completion_tokens": 287, "total_tokens": 4873, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
{"id": "batch_req_68f8135ba6d88190b9b1de5d105a231f", "custom_id": "39-4", "response": {"status_code": 200, "request_id": "736b9486c2cb6db626643adcd3b13be5", "body": {"id": "chatcmpl-CTFoNDF37BroK2j1ZhlOVPySwQWwS", "object": "chat.completion", "created": 1761088327, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get required columns for CV/Nova objects (by stochastic classifier, rank 1), with ndet <= 50,\n-- only r-band, corrected detections, and attach the maximum rise from minimum (max - min magpsf_corr) per object.\nSELECT\n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    agg.max_rise_from_min\nFROM\n    -- Subquery: get oids of CV/Nova, stochastic classifier, rank 1, with ndet <= 50\n    (\n        SELECT p.oid\n        FROM probability p\n        INNER JOIN object o ON p.oid = o.oid\n        WHERE\n            p.class_name = 'CV/Nova'\n            AND p.classifier_name = 'lc_classifier_stochastic'\n            AND p.ranking = 1\n            AND o.ndet <= 50\n    ) AS filtered_oids\n    INNER JOIN object o ON filtered_oids.oid = o.oid\n    INNER JOIN detection d ON o.oid = d.oid\n    -- Only r-band and corrected detections\n    INNER JOIN (\n        -- Aggregate: for each oid, get max and min magpsf_corr in r-band, corrected, and their difference\n        SELECT\n            oid,\n            MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise_from_min\n        FROM detection\n        WHERE fid = 2 AND corrected = TRUE\n        GROUP BY oid\n    ) AS agg ON d.oid = agg.oid\nWHERE\n    d.fid = 2\n    AND d.corrected = TRUE\nORDER BY\n    o.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4803, "completion_tokens": 377, "total_tokens": 5180, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_e24a1fec47"}}, "error": null}
