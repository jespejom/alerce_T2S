{"id": "batch_req_690e113fb34481909ab70ab5e2f6a4c5", "custom_id": "17-5", "response": {"status_code": 200, "request_id": "a17a20ddfabd2a10829a4b028ebff397", "body": {"id": "chatcmpl-CZIjeEGyghidq3Ux1RbpCtOagJ8v6", "object": "chat.completion", "created": 1762529534, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery 1: Get all AGN oids from probability table with default conditions\nWITH agn_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND class_name = 'AGN'\n),\n\n-- Subquery 2: Get oids with r band (fid=2) variability (Std > 0 OR ExcessVar > 0 OR Amplitude > 0)\nr_var_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 2\n      AND (\n            (f.name = 'Std' AND f.value > 0)\n         OR (f.name = 'ExcessVar' AND f.value > 0)\n         OR (f.name = 'Amplitude' AND f.value > 0)\n      )\n),\n\n-- Subquery 3a: AGN oids with NO detections in g band (fid=1)\ng_no_det_oids AS (\n    SELECT a.oid\n    FROM agn_oids a\n    WHERE NOT EXISTS (\n        SELECT 1 FROM feature f WHERE f.oid = a.oid AND f.fid = 1\n    )\n),\n\n-- Subquery 3b: AGN oids with g band detections but NO variability (Std <= 0 AND ExcessVar <= 0 AND Amplitude <= 0)\ng_no_var_oids AS (\n    SELECT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 1\n      AND f.name IN ('Std', 'ExcessVar', 'Amplitude')\n    GROUP BY f.oid\n    HAVING\n        SUM(CASE WHEN f.name = 'Std' AND f.value > 0 THEN 1 ELSE 0 END) = 0\n        AND SUM(CASE WHEN f.name = 'ExcessVar' AND f.value > 0 THEN 1 ELSE 0 END) = 0\n        AND SUM(CASE WHEN f.name = 'Amplitude' AND f.value > 0 THEN 1 ELSE 0 END) = 0\n),\n\n-- Subquery 3: Union of oids with no g band detections or no g band variability\ng_no_det_or_no_var_oids AS (\n    SELECT oid FROM g_no_det_oids\n    UNION\n    SELECT oid FROM g_no_var_oids\n),\n\n-- Subquery 4: Final oids that are AGN, variable in r, and not variable (or not detected) in g\nfinal_oids AS (\n    SELECT oid\n    FROM r_var_oids\n    INTERSECT\n    SELECT oid\n    FROM g_no_det_or_no_var_oids\n)\n\n-- Final query: Return all features for these oids, ordered by value and oid\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM final_oids)\nORDER BY value ASC, oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4752, "completion_tokens": 637, "total_tokens": 5389, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e113fb5b08190a4c08e6fff99f8fb", "custom_id": "17-6", "response": {"status_code": 200, "request_id": "66fb8a853bf72c56db4b93ef5f481472", "body": {"id": "chatcmpl-CZIkcOBOCWnq0KSHBM79fbEzfqbLB", "object": "chat.completion", "created": 1762529594, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Select oids classified as AGN (ranking=1, classifier_name='lc_classifier')\nWITH agn_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Select oids with r-band (fid=2) variability (Std > 0)\nr_band_variable AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 2\n      AND f.name = 'Std'\n      AND f.value > 0\n),\n\n-- Step 3a: oids with NO detections in the g band (fid=1)\nno_gband_detection AS (\n    SELECT a.oid\n    FROM agn_oids a\n    LEFT JOIN detection d ON a.oid = d.oid AND d.fid = 1\n    WHERE d.oid IS NULL\n),\n\n-- Step 3b: oids with g-band (fid=1) Std <= 0 (no variability)\nno_gband_variability AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 1\n      AND f.name = 'Std'\n      AND f.value <= 0\n),\n\n-- Step 3: Union of oids with no g-band detection or no g-band variability\nno_gband_var_or_det AS (\n    SELECT oid FROM no_gband_detection\n    UNION\n    SELECT oid FROM no_gband_variability\n),\n\n-- Step 4: oids that are AGN, variable in r, and not variable or not detected in g\nfinal_oids AS (\n    SELECT oid\n    FROM r_band_variable\n    INTERSECT\n    SELECT oid\n    FROM no_gband_var_or_det\n)\n\n-- Step 5: Retrieve all features for these oids, order by value ascending, then by oid\nSELECT f.*\nFROM feature f\nINNER JOIN final_oids o ON f.oid = o.oid\nORDER BY f.oid ASC, f.value ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4701, "completion_tokens": 472, "total_tokens": 5173, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e113fb25c8190b366038009dbd2f2", "custom_id": "17-7", "response": {"status_code": 200, "request_id": "c507402483a060e325c9dca8c4d7b460", "body": {"id": "chatcmpl-CZIkcDOwMiIvraPBHjmLS0SDu1H1C", "object": "chat.completion", "created": 1762529594, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Select AGN oids from probability table with default conditions\nWITH agn_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n),\n\n-- Step 2: Select oids with r band (fid=2) variability (Std > 0 OR ExcessVar > 0 OR Amplitude > 0)\nr_var_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 2\n      AND (\n            (f.name = 'Std' AND f.value > 0)\n         OR (f.name = 'ExcessVar' AND f.value > 0)\n         OR (f.name = 'Amplitude' AND f.value > 0)\n      )\n),\n\n-- Step 3: Select oids with NO g band (fid=1) detections OR NO g band variability (Std <= 0 AND ExcessVar <= 0 AND Amplitude <= 0)\ng_nonvar_oids AS (\n    -- oids with NO g band detections\n    SELECT a.oid\n    FROM agn_oids a\n    WHERE NOT EXISTS (\n        SELECT 1 FROM feature f\n        WHERE f.oid = a.oid AND f.fid = 1\n    )\n    UNION\n    -- oids with g band detections but NO variability\n    SELECT f1.oid\n    FROM (\n        SELECT oid\n        FROM feature\n        WHERE fid = 1\n          AND name IN ('Std', 'ExcessVar', 'Amplitude')\n        GROUP BY oid\n        HAVING MAX(CASE WHEN name = 'Std' THEN value ELSE 0 END) <= 0\n           AND MAX(CASE WHEN name = 'ExcessVar' THEN value ELSE 0 END) <= 0\n           AND MAX(CASE WHEN name = 'Amplitude' THEN value ELSE 0 END) <= 0\n    ) f1\n),\n\n-- Step 4: Final oids that satisfy both r band variability and g band non-variability/no detection\nfinal_oids AS (\n    SELECT oid\n    FROM r_var_oids\n    INTERSECT\n    SELECT oid\n    FROM g_nonvar_oids\n)\n\n-- Step 5: Retrieve all features for these oids, order by value ascending, then by oid\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM final_oids)\nORDER BY value ASC, oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4755, "completion_tokens": 541, "total_tokens": 5296, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e113fc058819099774dac243ddea3", "custom_id": "17-8", "response": {"status_code": 200, "request_id": "203753a727b4cebf2ea277b82cf59577", "body": {"id": "chatcmpl-CZIkctwaMITFFq23RAncrlhxABM1K", "object": "chat.completion", "created": 1762529594, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Select oids classified as AGN (ranking=1, classifier_name='lc_classifier')\nWITH agn_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Select oids with r-band variability (Std > 0 or ExcessVar > 0 in fid=2)\nr_band_variable AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 2\n      AND f.name IN ('Std', 'ExcessVar')\n      AND f.value > 0\n),\n\n-- Step 3: Exclude oids with g-band detections or g-band variability\n-- 3a: oids with NO g-band detections\nno_gband_detection AS (\n    SELECT a.oid\n    FROM agn_oids a\n    WHERE NOT EXISTS (\n        SELECT 1 FROM detection d WHERE d.oid = a.oid AND d.fid = 1\n    )\n),\n\n-- 3b: oids with g-band variability feature (Std or ExcessVar) == 0\nno_gband_variability AS (\n    SELECT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 1\n      AND f.name IN ('Std', 'ExcessVar')\n      AND f.value = 0\n),\n\n-- 3c: Union of oids with no g-band detection or no g-band variability\ngband_exclusion AS (\n    SELECT oid FROM no_gband_detection\n    UNION\n    SELECT oid FROM no_gband_variability\n),\n\n-- Step 4: Final oids = AGN, variable in r, and not detected or not variable in g\nfinal_oids AS (\n    SELECT oid\n    FROM r_band_variable\n    INTERSECT\n    SELECT oid\n    FROM gband_exclusion\n)\n\n-- Step 5: Retrieve all features for these oids, order by value ascending, then by oid\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM final_oids)\nORDER BY oid ASC, value ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4914, "completion_tokens": 484, "total_tokens": 5398, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e113fb434819080f3e5a4317995a7", "custom_id": "17-9", "response": {"status_code": 200, "request_id": "670e0ddf39e8a5afb0355419cd60776d", "body": {"id": "chatcmpl-CZIjeFPZYrDgbNB8rdkydq41e6UA5", "object": "chat.completion", "created": 1762529534, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Select oids classified as AGN (ranking=1, classifier_name='lc_classifier')\nWITH agn_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Select oids with r-band (fid=2) variability (Std > 0 OR ExcessVar > 0 OR Amplitude > 0)\nr_band_variable AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_oids a ON f.oid = a.oid\n    WHERE f.fid = 2\n      AND (\n            (f.name = 'Std' AND f.value > 0)\n         OR (f.name = 'ExcessVar' AND f.value > 0)\n         OR (f.name = 'Amplitude' AND f.value > 0)\n      )\n),\n\n-- Step 3: Select oids with NO g-band (fid=1) detections OR all g-band variability features zero or NULL\ng_band_no_var AS (\n    -- OIDs with NO g-band features at all\n    SELECT a.oid\n    FROM agn_oids a\n    LEFT JOIN feature f ON a.oid = f.oid AND f.fid = 1\n    WHERE f.oid IS NULL\n\n    UNION\n\n    -- OIDs with g-band features, but all relevant variability features are zero or NULL\n    SELECT f1.oid\n    FROM (\n        SELECT f.oid\n        FROM feature f\n        INNER JOIN agn_oids a ON f.oid = a.oid\n        WHERE f.fid = 1\n        GROUP BY f.oid\n        HAVING\n            SUM(CASE WHEN f.name = 'Std' AND COALESCE(f.value,0) > 0 THEN 1 ELSE 0 END) = 0\n            AND SUM(CASE WHEN f.name = 'ExcessVar' AND COALESCE(f.value,0) > 0 THEN 1 ELSE 0 END) = 0\n            AND SUM(CASE WHEN f.name = 'Amplitude' AND COALESCE(f.value,0) > 0 THEN 1 ELSE 0 END) = 0\n    ) f1\n)\n\n-- Step 4: Intersect r-band variable and g-band no-var oids, then get all features for those oids\nSELECT feat.*\nFROM feature feat\nINNER JOIN (\n    SELECT rv.oid\n    FROM r_band_variable rv\n    INNER JOIN g_band_no_var gv ON rv.oid = gv.oid\n) filtered_oids ON feat.oid = filtered_oids.oid\nORDER BY feat.oid, feat.value ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4749, "completion_tokens": 577, "total_tokens": 5326, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e113fb50c8190b0e5007fa076c190", "custom_id": "1-5", "response": {"status_code": 200, "request_id": "8f9079a853c5dd8f3c77ccc68c25f1b9", "body": {"id": "chatcmpl-CZIjeBN6G3hdOoGhc1Vj2WrnKxVVu", "object": "chat.completion", "created": 1762529534, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Select AGN objects with probability > 0.6, ranking=1, classifier_name='lc_classifier'\nWITH agn_candidates AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND probability > 0.6\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Filter objects with light curves covering at least one year (deltajd >= 365)\none_year_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN agn_candidates ac ON o.oid = ac.oid\n    WHERE o.deltajd >= 365\n),\n\n-- Step 3: Filter objects with at least 20 detections in at least one band (feature: n_det >= 20)\nat_least_20_detections AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN one_year_objects o ON f.oid = o.oid\n    WHERE f.name = 'n_det'\n      AND f.value >= 20\n),\n\n-- Step 4: Filter objects with delta_mag_fid > 1 in g (fid=1) and > 0.5 in r (fid=2), using corrected magnitudes\ndelta_mag_g AS (\n    SELECT f.oid\n    FROM feature f\n    INNER JOIN at_least_20_detections a ON f.oid = a.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 1\n      AND f.value > 1\n),\ndelta_mag_r AS (\n    SELECT f.oid\n    FROM feature f\n    INNER JOIN at_least_20_detections a ON f.oid = a.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 2\n      AND f.value > 0.5\n),\nqualified_oids AS (\n    SELECT oid FROM delta_mag_g\n    INTERSECT\n    SELECT oid FROM delta_mag_r\n),\n\n-- Step 5: Get all features for the qualified oids\nselected_features AS (\n    SELECT f.oid, f.name, f.value, f.version, f.fid AS feature_fid\n    FROM feature f\n    INNER JOIN qualified_oids q ON f.oid = q.oid\n),\n\n-- Step 6: Get meanra, meandec, ndet from object for qualified oids\nobject_stats AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    INNER JOIN qualified_oids q ON o.oid = q.oid\n),\n\n-- Step 7: Get max_mag and min_mag (corrected) for g and r bands\nmax_min_mag AS (\n    SELECT\n        f.oid,\n        f.fid AS feature_fid,\n        MAX(CASE WHEN f.name = 'max_mag' THEN f.value END) AS max_mag,\n        MAX(CASE WHEN f.name = 'min_mag' THEN f.value END) AS min_mag\n    FROM feature f\n    INNER JOIN qualified_oids q ON f.oid = q.oid\n    WHERE f.name IN ('max_mag', 'min_mag')\n    GROUP BY f.oid, f.fid\n),\n\n-- Step 8: Calculate delta_mag for g and r bands\ndelta_mag AS (\n    SELECT\n        m.oid,\n        m.feature_fid,\n        m.max_mag,\n        m.min_mag,\n        (m.max_mag - m.min_mag) AS delta_mag\n    FROM max_min_mag m\n    WHERE m.feature_fid IN (1,2)\n)\n\n-- Step 9: Assemble the final output\nSELECT\n    sf.oid,\n    sf.name,\n    sf.value,\n    sf.version,\n    sf.feature_fid,\n    os.meanra,\n    os.meandec,\n    os.ndet,\n    dm.max_mag,\n    dm.min_mag,\n    dm.delta_mag\nFROM selected_features sf\nINNER JOIN object_stats os ON sf.oid = os.oid\nLEFT JOIN delta_mag dm ON sf.oid = dm.oid AND sf.feature_fid = dm.feature_fid\nORDER BY sf.oid, sf.feature_fid, sf.name\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5080, "completion_tokens": 893, "total_tokens": 5973, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e113fb86c8190995f098c8ce5c622", "custom_id": "1-6", "response": {"status_code": 200, "request_id": "8daed926fe9b752c47b1e3b04a3002a0", "body": {"id": "chatcmpl-CZIjechOTLsIi5dGUoimjjl2Od3ZT", "object": "chat.completion", "created": 1762529534, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Get oids classified as AGN with probability > 0.6, using default classifier and ranking\nWITH agn_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\n-- Step 2: Filter objects with light curves covering at least one year\none_year_oids AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN agn_oids a ON o.oid = a.oid\n    WHERE o.deltajd >= 365.0\n),\n-- Step 3: Filter objects with at least 20 detections in at least one band (using feature table, n_det)\ndet_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN one_year_oids o ON f.oid = o.oid\n    WHERE f.name = 'n_det'\n      AND f.value >= 20\n),\n-- Step 4a: Filter objects with delta_mag_g > 1.0 (g band, fid=1, using corrected magnitudes)\ngband_delta AS (\n    SELECT mg.oid\n    FROM\n        (SELECT f1.oid,\n                MAX(CASE WHEN f1.name = 'max_mag_corr' AND f1.fid = 1 THEN f1.value END) AS max_mag_corr_g,\n                MAX(CASE WHEN f1.name = 'min_mag_corr' AND f1.fid = 1 THEN f1.value END) AS min_mag_corr_g\n         FROM feature f1\n         INNER JOIN det_oids d ON f1.oid = d.oid\n         WHERE (f1.name = 'max_mag_corr' OR f1.name = 'min_mag_corr')\n           AND f1.fid = 1\n         GROUP BY f1.oid\n        ) mg\n    WHERE (mg.max_mag_corr_g - mg.min_mag_corr_g) > 1.0\n),\n-- Step 4b: Filter objects with delta_mag_r > 0.5 (r band, fid=2, using corrected magnitudes)\nrband_delta AS (\n    SELECT mr.oid\n    FROM\n        (SELECT f2.oid,\n                MAX(CASE WHEN f2.name = 'max_mag_corr' AND f2.fid = 2 THEN f2.value END) AS max_mag_corr_r,\n                MAX(CASE WHEN f2.name = 'min_mag_corr' AND f2.fid = 2 THEN f2.value END) AS min_mag_corr_r\n         FROM feature f2\n         INNER JOIN det_oids d ON f2.oid = d.oid\n         WHERE (f2.name = 'max_mag_corr' OR f2.name = 'min_mag_corr')\n           AND f2.fid = 2\n         GROUP BY f2.oid\n        ) mr\n    WHERE (mr.max_mag_corr_r - mr.min_mag_corr_r) > 0.5\n),\n-- Step 5: Get final oids that satisfy all conditions (intersection of gband_delta and rband_delta)\nfinal_oids AS (\n    SELECT g.oid\n    FROM gband_delta g\n    INNER JOIN rband_delta r ON g.oid = r.oid\n)\n-- Step 6: Retrieve all required output columns for the final oids\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Get max and min corrected magnitudes for g and r bands\n    mg.max_mag_corr_g,\n    mg.min_mag_corr_g,\n    (mg.max_mag_corr_g - mg.min_mag_corr_g) AS delta_mag_g,\n    mr.max_mag_corr_r,\n    mr.min_mag_corr_r,\n    (mr.max_mag_corr_r - mr.min_mag_corr_r) AS delta_mag_r\nFROM object o\nINNER JOIN final_oids fo ON o.oid = fo.oid\nINNER JOIN feature f ON o.oid = f.oid\n-- Join for g band max/min corrected magnitudes\nLEFT JOIN (\n    SELECT\n        oid,\n        MAX(CASE WHEN name = 'max_mag_corr' AND fid = 1 THEN value END) AS max_mag_corr_g,\n        MAX(CASE WHEN name = 'min_mag_corr' AND fid = 1 THEN value END) AS min_mag_corr_g\n    FROM feature\n    WHERE (name = 'max_mag_corr' OR name = 'min_mag_corr')\n      AND fid = 1\n    GROUP BY oid\n) mg ON o.oid = mg.oid\n-- Join for r band max/min corrected magnitudes\nLEFT JOIN (\n    SELECT\n        oid,\n        MAX(CASE WHEN name = 'max_mag_corr' AND fid = 2 THEN value END) AS max_mag_corr_r,\n        MAX(CASE WHEN name = 'min_mag_corr' AND fid = 2 THEN value END) AS min_mag_corr_r\n    FROM feature\n    WHERE (name = 'max_mag_corr' OR name = 'min_mag_corr')\n      AND fid = 2\n    GROUP BY oid\n) mr ON o.oid = mr.oid\nORDER BY o.oid, f.name, f.fid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5073, "completion_tokens": 1123, "total_tokens": 6196, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e113fc18481909aeadcb4e9fbeef1", "custom_id": "1-7", "response": {"status_code": 200, "request_id": "138230e7da9d572d80b79eab068a60af", "body": {"id": "chatcmpl-CZIjikCmxDp2siMVfCO1jgg9ME6aR", "object": "chat.completion", "created": 1762529538, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY]\nWITH agn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.6\n      AND o.deltajd >= 365\n),\nn_det_oids AS (\n    SELECT DISTINCT f.oid, f.fid AS feature_fid, f.value, f.name, f.version\n    FROM feature f\n    INNER JOIN agn_oids ao ON f.oid = ao.oid\n    WHERE f.name = 'n_det'\n      AND f.value >= 20\n),\ndelta_mag_g_oids AS (\n    SELECT DISTINCT f.oid, f.fid AS feature_fid, f.value, f.name, f.version\n    FROM feature f\n    INNER JOIN agn_oids ao ON f.oid = ao.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 1\n      AND f.value > 1\n),\ndelta_mag_r_oids AS (\n    SELECT DISTINCT f.oid, f.fid AS feature_fid, f.value, f.name, f.version\n    FROM feature f\n    INNER JOIN agn_oids ao ON f.oid = ao.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 2\n      AND f.value > 0.5\n),\noids_all_criteria AS (\n    SELECT oid\n    FROM n_det_oids\n    INTERSECT\n    SELECT oid\n    FROM delta_mag_g_oids\n    INTERSECT\n    SELECT oid\n    FROM delta_mag_r_oids\n),\nfeature_union AS (\n    SELECT * FROM n_det_oids\n    UNION\n    SELECT * FROM delta_mag_g_oids\n    UNION\n    SELECT * FROM delta_mag_r_oids\n),\nfinal_features AS (\n    SELECT fu.*\n    FROM feature_union fu\n    INNER JOIN oids_all_criteria oa ON fu.oid = oa.oid\n),\nmag_g AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmax_corr AS max_mag_g,\n        m.magmin_corr AS min_mag_g,\n        (m.magmax_corr - m.magmin_corr) AS delta_mag_g\n    FROM magstat m\n    WHERE m.fid = 1\n),\nmag_r AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmax_corr AS max_mag_r,\n        m.magmin_corr AS min_mag_r,\n        (m.magmax_corr - m.magmin_corr) AS delta_mag_r\n    FROM magstat m\n    WHERE m.fid = 2\n)\nSELECT\n    ff.oid,\n    ff.value,\n    ff.name,\n    ff.version,\n    ff.feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    mg.max_mag_g,\n    mg.min_mag_g,\n    mg.delta_mag_g,\n    mr.max_mag_r,\n    mr.min_mag_r,\n    mr.delta_mag_r\nFROM final_features ff\nINNER JOIN object o ON ff.oid = o.oid\nLEFT JOIN mag_g mg ON ff.oid = mg.oid\nLEFT JOIN mag_r mr ON ff.oid = mr.oid\nORDER BY ff.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5065, "completion_tokens": 734, "total_tokens": 5799, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e113fb900819082ff8bc4775dde05", "custom_id": "1-8", "response": {"status_code": 200, "request_id": "3a8caea2eab43fe8a85524d6fe06f1bc", "body": {"id": "chatcmpl-CZIjjcnbfrCVCLciYHKfyo9geaEQt", "object": "chat.completion", "created": 1762529539, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Select AGN objects with probability > 0.6, classifier_name='lc_classifier', ranking=1\nWITH agn_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.6\n),\n-- Step 2: Filter objects with light curves covering at least one year\none_year_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    INNER JOIN agn_candidates ac ON o.oid = ac.oid\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n),\n-- Step 3: Filter objects with at least 20 detections in at least one band (using feature table, corrected)\nat_least_20_detections AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN one_year_objects o ON f.oid = o.oid\n    WHERE f.name = 'n_det'\n      AND f.value >= 20\n      AND f.corrected = TRUE\n),\n-- Step 4: Filter objects with delta_mag_fid > 1.0 in g band (fid=1, corrected)\ndelta_mag_g AS (\n    SELECT f.oid\n    FROM feature f\n    INNER JOIN at_least_20_detections d ON f.oid = d.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 1\n      AND f.value > 1.0\n      AND f.corrected = TRUE\n),\n-- Step 5: Filter objects with delta_mag_fid > 0.5 in r band (fid=2, corrected)\ndelta_mag_r AS (\n    SELECT f.oid\n    FROM feature f\n    INNER JOIN at_least_20_detections d ON f.oid = d.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 2\n      AND f.value > 0.5\n      AND f.corrected = TRUE\n),\n-- Step 6: Get the intersection of oids that satisfy both g and r band variation\nfinal_oids AS (\n    SELECT oid FROM delta_mag_g\n    INTERSECT\n    SELECT oid FROM delta_mag_r\n),\n-- Step 7: Get max and min corrected magnitudes for g and r bands\nband_mags AS (\n    SELECT\n        f.oid,\n        f.fid AS feature_fid,\n        MAX(CASE WHEN f.name = 'max_mag' AND f.corrected = TRUE THEN f.value END) AS max_mag,\n        MAX(CASE WHEN f.name = 'min_mag' AND f.corrected = TRUE THEN f.value END) AS min_mag\n    FROM feature f\n    WHERE f.name IN ('max_mag', 'min_mag')\n      AND f.fid IN (1,2)\n      AND f.corrected = TRUE\n      AND f.oid IN (SELECT oid FROM final_oids)\n    GROUP BY f.oid, f.fid\n),\n-- Step 8: Calculate delta_mag for each band\nband_mags_with_delta AS (\n    SELECT\n        bm.oid,\n        bm.feature_fid,\n        bm.max_mag,\n        bm.min_mag,\n        (bm.max_mag - bm.min_mag) AS delta_mag\n    FROM band_mags bm\n)\n-- Step 9: Assemble the final output\nSELECT\n    f.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    bm.max_mag,\n    bm.min_mag,\n    bm.delta_mag\nFROM feature f\nINNER JOIN final_oids fo ON f.oid = fo.oid\nINNER JOIN one_year_objects o ON f.oid = o.oid\nINNER JOIN band_mags_with_delta bm ON f.oid = bm.oid AND f.fid = bm.feature_fid\nWHERE f.corrected = TRUE\n  AND f.fid IN (1,2)\n  AND f.name IN ('max_mag', 'min_mag', 'delta_mag_fid', 'n_det')\nORDER BY f.oid, f.fid, f.name\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4969, "completion_tokens": 921, "total_tokens": 5890, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e113fb174819095c6caee8a2a59c1", "custom_id": "1-9", "response": {"status_code": 200, "request_id": "8b7a1d7b30bce77999aa6fd828aafc38", "body": {"id": "chatcmpl-CZIjj7XHzAasZiSkvnvcRpdHVBxuH", "object": "chat.completion", "created": 1762529539, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Get AGN objects with probability > 0.6, ranking=1, classifier_name='lc_classifier'\nWITH agn_prob AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\n-- Step 2: Filter objects with deltajd >= 365 (at least one year coverage)\nagn_long_lc AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN agn_prob ap ON o.oid = ap.oid\n    WHERE o.deltajd >= 365\n),\n-- Step 3: Objects with at least 20 detections in at least one band (using magstat)\nagn_20det AS (\n    SELECT DISTINCT m.oid\n    FROM magstat m\n    INNER JOIN agn_long_lc a ON m.oid = a.oid\n    WHERE m.ndet >= 20\n),\n-- Step 4: Objects with delta_mag (max-min) > 1.0 in g band (fid=1, corrected)\ngband_var AS (\n    SELECT m.oid\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM agn_20det)\n      AND m.fid = 1\n      AND (m.magmax_corr - m.magmin_corr) > 1.0\n),\n-- Step 5: Objects with delta_mag (max-min) > 0.5 in r band (fid=2, corrected)\nrband_var AS (\n    SELECT m.oid\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM agn_20det)\n      AND m.fid = 2\n      AND (m.magmax_corr - m.magmin_corr) > 0.5\n),\n-- Step 6: Only objects that satisfy both g and r band variability\nfinal_oids AS (\n    SELECT oid\n    FROM gband_var\n    INTERSECT\n    SELECT oid\n    FROM rband_var\n),\n-- Step 7: Get all features for the selected objects\nselected_features AS (\n    SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM final_oids)\n),\n-- Step 8: Get mean coordinates and ndet from object table\nobject_info AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM final_oids)\n),\n-- Step 9: Get max and min corrected magnitudes for g and r bands from magstat\nmagstats_g AS (\n    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag, fid AS magstat_fid\n    FROM magstat\n    WHERE oid IN (SELECT oid FROM final_oids) AND fid = 1\n),\nmagstats_r AS (\n    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag, fid AS magstat_fid\n    FROM magstat\n    WHERE oid IN (SELECT oid FROM final_oids) AND fid = 2\n)\n-- Step 10: Assemble the final output\nSELECT\n    sf.oid,\n    sf.value,\n    sf.name,\n    sf.version,\n    sf.feature_fid,\n    oi.meanra,\n    oi.meandec,\n    oi.ndet,\n    mg.magmax_corr AS g_magmax_corr,\n    mg.magmin_corr AS g_magmin_corr,\n    mg.delta_mag AS g_delta_mag,\n    mg.magstat_fid AS g_magstat_fid,\n    mr.magmax_corr AS r_magmax_corr,\n    mr.magmin_corr AS r_magmin_corr,\n    mr.delta_mag AS r_delta_mag,\n    mr.magstat_fid AS r_magstat_fid\nFROM selected_features sf\nINNER JOIN object_info oi ON sf.oid = oi.oid\nINNER JOIN magstats_g mg ON sf.oid = mg.oid\nINNER JOIN magstats_r mr ON sf.oid = mr.oid\nORDER BY sf.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4848, "completion_tokens": 897, "total_tokens": 5745, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114015548190a3345e6be662b3c9", "custom_id": "16-5", "response": {"status_code": 200, "request_id": "5acdad8848c78bdd8f04dda2e8a8a154", "body": {"id": "chatcmpl-CZIjkJxxvl0Shlo3FyIjeEsKJOv6f", "object": "chat.completion", "created": 1762529540, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- CTE to get objects with first detection in the first two days of September\nWITH first_sept_objects AS (\n    SELECT oid, firstmjd\n    FROM object\n    WHERE firstmjd BETWEEN 60188.0 AND 60189.99999\n),\n-- CTE to get objects whose highest probability in the stamp classifier is for class 'SN'\nstamp_sn_objects AS (\n    SELECT p.oid, p.probability AS stamp_sn_probability\n    FROM probability p\n    INNER JOIN first_sept_objects o ON p.oid = o.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n),\n-- CTE to find fast risers: for each oid and filter, get first detection and last non-detection before it, and require dm/dt >= 0.25\nfast_risers AS (\n    SELECT\n        d.oid,\n        d.fid,\n        d.candid,\n        d.magpsf,\n        d.mjd AS detection_mjd,\n        nd.diffmaglim,\n        nd.mjd AS nondet_mjd,\n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) AS dmdt\n    FROM (\n        -- For each oid and fid, get the first detection\n        SELECT oid, fid, MIN(mjd) AS first_mjd\n        FROM detection\n        GROUP BY oid, fid\n    ) fd\n    INNER JOIN detection d\n        ON d.oid = fd.oid AND d.fid = fd.fid AND d.mjd = fd.first_mjd\n    INNER JOIN non_detection nd\n        ON nd.oid = d.oid AND nd.fid = d.fid AND nd.mjd = (\n            SELECT MAX(mjd)\n            FROM non_detection\n            WHERE oid = d.oid AND fid = d.fid AND mjd < d.mjd\n        )\n    WHERE (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) >= 0.25\n),\n-- CTE to get the most likely probability for each object in the light curve classifier\nlc_probabilities AS (\n    SELECT oid, class_name AS lc_class_name, probability AS lc_probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n),\n-- CTE to get magstat info for the relevant objects and filters\nmagstat_info AS (\n    SELECT oid, fid AS magstat_fid, dmdt_first\n    FROM magstat\n)\n-- Final selection and join of all relevant information\nSELECT\n    sso.oid,\n    sso.stamp_sn_probability,\n    lcp.lc_class_name,\n    lcp.lc_probability,\n    fr.fid,\n    fr.candid,\n    fr.magpsf AS image_difference,\n    nd.oid AS nondet_oid,\n    nd.fid AS nondet_fid,\n    nd.diffmaglim,\n    nd.mjd AS nondet_mjd,\n    ms.magstat_fid,\n    ms.dmdt_first AS initial_rise_estimate\nFROM stamp_sn_objects sso\nINNER JOIN fast_risers fr ON sso.oid = fr.oid\nINNER JOIN lc_probabilities lcp ON sso.oid = lcp.oid\nINNER JOIN magstat_info ms ON fr.oid = ms.oid AND fr.fid = ms.magstat_fid\nINNER JOIN non_detection nd ON fr.oid = nd.oid AND fr.fid = nd.fid\nORDER BY sso.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5063, "completion_tokens": 758, "total_tokens": 5821, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1140166481908aa1871e667a8de4", "custom_id": "16-6", "response": {"status_code": 200, "request_id": "630f002a0ce70a9e426d5083ef89060e", "body": {"id": "chatcmpl-CZIjlwBeaQEiS413U2T0AGCbcCqLL", "object": "chat.completion", "created": 1762529541, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get oids, probabilities in the stamp classifier, and non-detection light curves for objects\n-- whose highest probability in the stamp classifier is for class 'SN', had their first detection\n-- in the first 2 days of September (MJD 60188.0 to 60189.999...), and qualify as fast risers\n-- (dmdt_first >= 0.25 in magstat for the same filter). Also return the filter IDs and initial rise estimate.\n\nSELECT\n    o.oid,\n    p.probability,\n    nd.fid,\n    nd.diffmaglim,\n    ms.fid AS magstat_fid,\n    ms.dmdt_first\nFROM\n    object o\n    INNER JOIN probability p\n        ON o.oid = p.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n    INNER JOIN magstat ms\n        ON o.oid = ms.oid\n        AND ms.dmdt_first >= 0.25\n    INNER JOIN non_detection nd\n        ON o.oid = nd.oid\n        AND ms.fid = nd.fid\nWHERE\n    o.firstmjd >= 60188.0\n    AND o.firstmjd < 60190.0\nORDER BY\n    o.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5028, "completion_tokens": 291, "total_tokens": 5319, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114016788190943f76f2b81f0915", "custom_id": "16-7", "response": {"status_code": 200, "request_id": "60cdc7a7ea38c09ec81d937fd3563058", "body": {"id": "chatcmpl-CZIjng7fL7AWWKdLS3X04qXDi8E5N", "object": "chat.completion", "created": 1762529543, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- FINAL QUERY\nSELECT\n    o.oid,\n    prob_stamp.probability AS probability_stamp_classifier,\n    prob_lc.probability AS probability_lc_classifier,\n    nd.fid,\n    nd.diffmaglim,\n    ms.fid AS magstat_fid,\n    ms.dmdt_first AS initial_rise_estimate\nFROM\n    object o\n    -- Join: Only objects with first detection in first two days of September\n    INNER JOIN (\n        SELECT oid, firstmjd\n        FROM object\n        WHERE firstmjd >= 60188.0 AND firstmjd < 60190.0\n    ) o_first ON o.oid = o_first.oid\n    -- Join: Only objects with highest probability for 'SN' in stamp classifier\n    INNER JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE classifier_name = 'stamp_classifier'\n          AND class_name = 'SN'\n          AND ranking = 1\n    ) prob_stamp ON o.oid = prob_stamp.oid\n    -- Join: Only objects that are fast risers (dmdt_first >= 0.25)\n    INNER JOIN (\n        SELECT oid, fid, dmdt_first\n        FROM magstat\n        WHERE dmdt_first >= 0.25\n    ) ms ON o.oid = ms.oid\n    -- Join: Only non-detections in the same filter as fast rise\n    INNER JOIN non_detection nd ON o.oid = nd.oid AND ms.fid = nd.fid\n    -- Join: Probability in light curve classifier (most likely class)\n    INNER JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE classifier_name = 'lc_classifier'\n          AND ranking = 1\n    ) prob_lc ON o.oid = prob_lc.oid\nORDER BY\n    o.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4897, "completion_tokens": 394, "total_tokens": 5291, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114011dc81909d579773c5140104", "custom_id": "16-8", "response": {"status_code": 200, "request_id": "158f0589b5c9d5887589307043124a0f", "body": {"id": "chatcmpl-CZIjoFlRy4eZfdZxxv2dhN6tJy2rS", "object": "chat.completion", "created": 1762529544, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH first_detections AS (\n    -- Step 1 & 2: Get objects with first detection in first 2 days of September, and the filter of the first detection\n    SELECT\n        o.oid,\n        o.firstmjd,\n        d.candid AS first_candid,\n        d.fid AS first_fid,\n        d.magpsf AS first_magpsf,\n        d.mjd AS det_mjd\n    FROM object o\n    INNER JOIN detection d\n        ON o.oid = d.oid AND o.firstmjd = d.mjd\n    WHERE o.firstmjd >= 60188.0 AND o.firstmjd < 60190.0\n),\nlast_non_detections AS (\n    -- Step 3: For each object, get the last non-detection before the first detection in the same filter\n    SELECT\n        nd.oid,\n        nd.fid,\n        nd.mjd AS nd_mjd,\n        nd.diffmaglim,\n        ROW_NUMBER() OVER (PARTITION BY nd.oid ORDER BY nd.mjd DESC) AS rn\n    FROM non_detection nd\n    INNER JOIN first_detections fd\n        ON nd.oid = fd.oid AND nd.fid = fd.first_fid AND nd.mjd < fd.det_mjd\n),\nfast_risers AS (\n    -- Step 4: Calculate the rise rate and filter for fast risers\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.first_fid,\n        fd.first_magpsf,\n        fd.det_mjd,\n        lnd.diffmaglim,\n        lnd.nd_mjd,\n        (lnd.diffmaglim - fd.first_magpsf) / (fd.det_mjd - lnd.nd_mjd) AS initial_rise\n    FROM first_detections fd\n    INNER JOIN last_non_detections lnd\n        ON fd.oid = lnd.oid AND fd.first_fid = lnd.fid AND lnd.rn = 1\n    WHERE (lnd.diffmaglim - fd.first_magpsf) / (fd.det_mjd - lnd.nd_mjd) >= 0.25\n),\nstamp_prob AS (\n    -- Step 5: Get probability for class 'SN' in stamp_classifier, ranking 1\n    SELECT\n        p.oid,\n        p.probability AS stamp_sn_probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n),\nlc_prob AS (\n    -- Step 6: Get highest probability in lc_classifier (ranking 1)\n    SELECT\n        p.oid,\n        p.class_name AS lc_class_name,\n        p.probability AS lc_probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nmagstat_info AS (\n    -- Step 8: Get magstat info for the first detection filter\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid\n    FROM magstat m\n),\nall_non_detections AS (\n    -- Step 7: Get all non-detections for each object\n    SELECT\n        nd.oid,\n        nd.fid,\n        nd.mjd,\n        nd.diffmaglim\n    FROM non_detection nd\n)\nSELECT\n    fr.oid,\n    sp.stamp_sn_probability,\n    lp.lc_probability,\n    andt.fid,\n    andt.diffmaglim,\n    mi.magstat_fid,\n    fr.initial_rise\nFROM fast_risers fr\nINNER JOIN stamp_prob sp ON fr.oid = sp.oid\nINNER JOIN lc_prob lp ON fr.oid = lp.oid\nINNER JOIN all_non_detections andt ON fr.oid = andt.oid\nLEFT JOIN magstat_info mi ON fr.oid = mi.oid AND fr.first_fid = mi.magstat_fid\nORDER BY fr.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5057, "completion_tokens": 844, "total_tokens": 5901, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114017388190aeff076f03376103", "custom_id": "16-9", "response": {"status_code": 200, "request_id": "14dd8a252f92e03db52f4f8d126875f8", "body": {"id": "chatcmpl-CZIjo4MK4SGKVwZdFA8KTt8g5n0yv", "object": "chat.completion", "created": 1762529544, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY HERE]\nWITH filtered_objects AS (\n    -- Step 1: Objects with first detection in first 2 days of September\n    SELECT oid, firstmjd\n    FROM object\n    WHERE firstmjd BETWEEN 60188.0 AND 60190.0\n),\nsn_stamp_prob AS (\n    -- Step 2: Highest probability in stamp classifier for class 'SN'\n    SELECT p.oid, p.probability\n    FROM probability p\n    INNER JOIN filtered_objects fo ON p.oid = fo.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n),\nfirst_detection AS (\n    -- Step 3: For each oid, fid, get the first detection (min mjd)\n    SELECT d.oid, d.fid, MIN(d.mjd) AS first_det_mjd\n    FROM detection d\n    INNER JOIN sn_stamp_prob ssp ON d.oid = ssp.oid\n    GROUP BY d.oid, d.fid\n),\nlast_non_detection AS (\n    -- Step 4: For each oid, fid, get the last non-detection before the first detection\n    SELECT nd.oid, nd.fid, MAX(nd.mjd) AS last_non_det_mjd\n    FROM non_detection nd\n    INNER JOIN first_detection fd ON nd.oid = fd.oid AND nd.fid = fd.fid\n    WHERE nd.mjd < fd.first_det_mjd\n    GROUP BY nd.oid, nd.fid\n),\nfast_risers AS (\n    -- Step 5: Calculate rise rate and filter for fast risers\n    SELECT\n        fd.oid,\n        fd.fid,\n        fd.first_det_mjd,\n        lnd.last_non_det_mjd,\n        d.magpsf AS first_det_magpsf,\n        nd.diffmaglim AS last_non_det_diffmaglim,\n        (nd.diffmaglim - d.magpsf) / (fd.first_det_mjd - lnd.last_non_det_mjd) AS rise_rate\n    FROM first_detection fd\n    INNER JOIN last_non_detection lnd ON fd.oid = lnd.oid AND fd.fid = lnd.fid\n    INNER JOIN detection d ON fd.oid = d.oid AND fd.fid = d.fid AND fd.first_det_mjd = d.mjd\n    INNER JOIN non_detection nd ON lnd.oid = nd.oid AND lnd.fid = nd.fid AND lnd.last_non_det_mjd = nd.mjd\n    WHERE (nd.diffmaglim - d.magpsf) / (fd.first_det_mjd - lnd.last_non_det_mjd) >= 0.25\n),\nall_non_detections AS (\n    -- Step 6: Get all non-detections for qualifying oids and fids\n    SELECT\n        fr.oid,\n        fr.fid,\n        nd.mjd,\n        nd.diffmaglim\n    FROM fast_risers fr\n    INNER JOIN non_detection nd ON fr.oid = nd.oid AND fr.fid = nd.fid\n),\nmagstat_info AS (\n    -- Step 7: Get magstat info for qualifying oids and fids\n    SELECT\n        ms.oid,\n        ms.fid AS magstat_fid\n    FROM magstat ms\n    INNER JOIN fast_risers fr ON ms.oid = fr.oid AND ms.fid = fr.fid\n)\nSELECT\n    ands.oid,\n    ssp.probability,\n    ands.fid,\n    ands.diffmaglim,\n    mi.magstat_fid,\n    fr.rise_rate\nFROM all_non_detections ands\nINNER JOIN sn_stamp_prob ssp ON ands.oid = ssp.oid\nINNER JOIN fast_risers fr ON ands.oid = fr.oid AND ands.fid = fr.fid\nLEFT JOIN magstat_info mi ON ands.oid = mi.oid AND ands.fid = mi.magstat_fid\nORDER BY ands.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5125, "completion_tokens": 860, "total_tokens": 5985, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11402510819087ad2072bf053e8a", "custom_id": "14-5", "response": {"status_code": 200, "request_id": "417a871eaa7000284f3d175ced4ac5ce", "body": {"id": "chatcmpl-CZIjoFpxjsLZsVeofnxtd7IpV8c3B", "object": "chat.completion", "created": 1762529544, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM\n    detection d\nINNER JOIN\n    ps1_ztf p\n    ON d.oid = p.oid AND d.candid = p.candid\nWHERE\n    d.oid IN (\n        'ZTF23aavzgjg',\n        'ZTF23aaynzyk',\n        'ZTF23aavqxos',\n        'ZTF23aaknyni',\n        'ZTF23aavsdtc',\n        'ZTF18aandkua',\n        'ZTF23aaxfewt',\n        'ZTF23aavshwi',\n        'ZTF22aawasao',\n        'ZTF23aaxgvnt'\n    )\n    AND d.drb > 0.5\n    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4202, "completion_tokens": 237, "total_tokens": 4439, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114023608190a62f0ff9764bdced", "custom_id": "14-6", "response": {"status_code": 200, "request_id": "c31ac7ae50f17a06074b82d1479f5b55", "body": {"id": "chatcmpl-CZIjvKrgJ3NfJysshtlTlIEEkZ8Xe", "object": "chat.completion", "created": 1762529551, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of oids as a CTE\nWITH input_oids AS (\n    SELECT unnest(ARRAY[\n        'ZTF23aavzgjg',\n        'ZTF23aaynzyk',\n        'ZTF23aavqxos',\n        'ZTF23aaknyni',\n        'ZTF23aavsdtc',\n        'ZTF18aandkua',\n        'ZTF23aaxfewt',\n        'ZTF23aavshwi',\n        'ZTF22aawasao',\n        'ZTF23aaxgvnt'\n    ]) AS oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM\n    detection d\n    INNER JOIN ps1_ztf p ON d.oid = p.oid AND d.candid = p.candid\n    INNER JOIN input_oids io ON d.oid = io.oid\nWHERE\n    d.drb > 0.5\n    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n-- Optional: Remove duplicates if any\n-- GROUP BY d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n-- Optional: Order by oid and mjd\nORDER BY d.oid, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4407, "completion_tokens": 347, "total_tokens": 4754, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1140180c8190814d304341b4e68f", "custom_id": "14-7", "response": {"status_code": 200, "request_id": "0c86daca224aa7f0856b91e1c34b320a", "body": {"id": "chatcmpl-CZIjvE2r6TTDwzkvt1TjeYQBIuyGt", "object": "chat.completion", "created": 1762529551, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    detection.oid,\n    detection.candid,\n    detection.fid,\n    detection.mjd,\n    detection.magpsf,\n    detection.sigmapsf,\n    detection.has_stamp,\n    detection.drb,\n    ps1_ztf.sgscore1,\n    ps1_ztf.distpsnr1\nFROM detection\nINNER JOIN ps1_ztf\n    ON detection.oid = ps1_ztf.oid\n    AND detection.candid = ps1_ztf.candid\nWHERE detection.oid IN (\n    'ZTF23aavzgjg',\n    'ZTF23aaynzyk',\n    'ZTF23aavqxos',\n    'ZTF23aaknyni',\n    'ZTF23aavsdtc',\n    'ZTF18aandkua',\n    'ZTF23aaxfewt',\n    'ZTF23aavshwi',\n    'ZTF22aawasao',\n    'ZTF23aaxgvnt'\n)\nAND detection.drb > 0.5\nAND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4454, "completion_tokens": 251, "total_tokens": 4705, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11401c0c8190b782fa58fd32a919", "custom_id": "14-8", "response": {"status_code": 200, "request_id": "736a77923369948a694cace2dd0ee45f", "body": {"id": "chatcmpl-CZIjsDvPXhyjET1v0FlDPH4sIXqqh", "object": "chat.completion", "created": 1762529548, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return detection and Pan-STARRS info for given oids, with drb > 0.5 and (sgscore1 < 0.5 or distpsnr1 < 1)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM\n    detection d\nINNER JOIN\n    ps1_ztf p\n    ON d.oid = p.oid AND d.candid = p.candid\nWHERE\n    d.oid IN (\n        'ZTF23aavzgjg',\n        'ZTF23aaynzyk',\n        'ZTF23aavqxos',\n        'ZTF23aaknyni',\n        'ZTF23aavsdtc',\n        'ZTF18aandkua',\n        'ZTF23aaxfewt',\n        'ZTF23aavshwi',\n        'ZTF22aawasao',\n        'ZTF23aaxgvnt'\n    )\n    AND d.drb > 0.5\n    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4270, "completion_tokens": 278, "total_tokens": 4548, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1140398c8190800ec535243b9912", "custom_id": "14-9", "response": {"status_code": 200, "request_id": "84d0ac2d6e0aab45cfd183377fe21f2b", "body": {"id": "chatcmpl-CZIjfglZOIxF4BKifo3uO4K6gZEL9", "object": "chat.completion", "created": 1762529535, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of oids using a CTE\nWITH input_oids AS (\n    SELECT unnest(ARRAY[\n        'ZTF23aavzgjg',\n        'ZTF23aaynzyk',\n        'ZTF23aavqxos',\n        'ZTF23aaknyni',\n        'ZTF23aavsdtc',\n        'ZTF18aandkua',\n        'ZTF23aaxfewt',\n        'ZTF23aavshwi',\n        'ZTF22aawasao',\n        'ZTF23aaxgvnt'\n    ]) AS oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM\n    detection d\n    INNER JOIN input_oids io ON d.oid = io.oid\n    INNER JOIN ps1_ztf p ON d.oid = p.oid AND d.candid = p.candid\nWHERE\n    d.drb > 0.5\n    AND (\n        p.sgscore1 < 0.5\n        OR p.distpsnr1 < 1\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4310, "completion_tokens": 276, "total_tokens": 4586, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114083908190a3e71261aee3ab4a", "custom_id": "103-5", "response": {"status_code": 200, "request_id": "bd63495fa10fcebc640ef892781c92c1", "body": {"id": "chatcmpl-CZIjfTkwEtr4UEkdMVt0cUzDeDnTp", "object": "chat.completion", "created": 1762529535, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.*, \n    probability.*, \n    ps1_ztf.*\nFROM \n    object\nINNER JOIN \n    probability \n    ON object.oid = probability.oid\nINNER JOIN \n    ps1_ztf \n    ON object.oid = ps1_ztf.oid\nWHERE \n    probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.7\n    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND ps1_ztf.distpsnr1 > 5\nORDER BY \n    ps1_ztf.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4645, "completion_tokens": 159, "total_tokens": 4804, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11407aa08190b420c305d32afb61", "custom_id": "103-6", "response": {"status_code": 200, "request_id": "732577f12507274ab3a0a48fb64e70bd", "body": {"id": "chatcmpl-CZIjf2Vt8dxIM68hg4YI31eQaUPcN", "object": "chat.completion", "created": 1762529535, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.*, \n    probability.*, \n    ps1_ztf.*\nFROM \n    object\nINNER JOIN \n    probability \n    ON object.oid = probability.oid\nINNER JOIN \n    ps1_ztf \n    ON object.oid = ps1_ztf.oid\nWHERE \n    probability.ranking = 1\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.probability > 0.7\n    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND ps1_ztf.distpsnr1 > 5\nORDER BY \n    ps1_ztf.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4750, "completion_tokens": 158, "total_tokens": 4908, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11406f488190a8ea777da41488b2", "custom_id": "103-7", "response": {"status_code": 200, "request_id": "47efc3615a3ccf65364cd392bf93c94a", "body": {"id": "chatcmpl-CZIjfz6cMGBuhWO2MXaSP86IN4NVW", "object": "chat.completion", "created": 1762529535, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from object, probability, and ps1_ztf for ZTF objects\n-- with distance to nearest PS1 source > 5 arcsec,\n-- probability > 0.7 for a non-supernova class (not in 'SNIa', 'SNIbc', 'SNII', 'SLSN')\n-- using the light curve classifier (lc_classifier), ranking=1,\n-- and order by nearest PS1 source distance (distpsnr1), limit 200 results.\n\nSELECT\n    object.*,\n    probability.*,\n    ps1_ztf.*\nFROM\n    object\nINNER JOIN probability\n    ON object.oid = probability.oid\nINNER JOIN (\n    -- For each oid, select the ps1_ztf row with the minimum distpsnr1 (i.e., the closest PS1 source)\n    SELECT DISTINCT ON (oid) *\n    FROM ps1_ztf\n    ORDER BY oid, distpsnr1 ASC\n) ps1_ztf\n    ON object.oid = ps1_ztf.oid\nWHERE\n    ps1_ztf.distpsnr1 > 5\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.7\n    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\nORDER BY\n    ps1_ztf.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4782, "completion_tokens": 318, "total_tokens": 5100, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114072ec81908992819a7e6ee539", "custom_id": "103-8", "response": {"status_code": 200, "request_id": "1ea5072150160a9688da0b21cfcf499a", "body": {"id": "chatcmpl-CZIjfNb7DqTqQCk0kyc2UnH4vp6eR", "object": "chat.completion", "created": 1762529535, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.*, \n    probability.*, \n    ps1_ztf.*\nFROM \n    object\nINNER JOIN \n    ps1_ztf ON object.oid = ps1_ztf.oid\nINNER JOIN \n    probability ON object.oid = probability.oid\nWHERE \n    ps1_ztf.distpsnr1 > 5\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.7\n    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\nORDER BY \n    ps1_ztf.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4711, "completion_tokens": 154, "total_tokens": 4865, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11407ab48190b5c604758dc6a2f8", "custom_id": "103-9", "response": {"status_code": 200, "request_id": "9f0478ba02ff8d33e9093f3d0c8770a1", "body": {"id": "chatcmpl-CZIjiB7cnVxzoGbiMuUfMRW7KDUGE", "object": "chat.completion", "created": 1762529538, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.*, \n    probability.*, \n    ps1_ztf.*\nFROM \n    object\nINNER JOIN \n    probability \n    ON object.oid = probability.oid\n        AND probability.classifier_name = 'lc_classifier'\n        AND probability.ranking = 1\n        AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND probability.probability > 0.7\nINNER JOIN \n    ps1_ztf \n    ON object.oid = ps1_ztf.oid\nWHERE \n    ps1_ztf.distpsnr1 > 5\nORDER BY \n    ps1_ztf.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4706, "completion_tokens": 159, "total_tokens": 4865, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11407cb88190a98a0209e2caf2c1", "custom_id": "92-7", "response": {"status_code": 200, "request_id": "fa7cd0480d5cd3c0896d84261e6b231d", "body": {"id": "chatcmpl-CZIjhKZ4yA1oLrrZLMY0ASqL1B2Fz", "object": "chat.completion", "created": 1762529537, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    magstat.oid, \n    probability.classifier_version, \n    probability.class_name, \n    probability.probability\nFROM \n    magstat\nINNER JOIN \n    probability \n    ON magstat.oid = probability.oid\nWHERE \n    magstat.fid = 1 -- g band\n    AND magstat.ndet >= 10 -- at least 10 detections\n    AND magstat.ndubious = 0 -- no dubious corrections\n    AND probability.ranking = 1 -- most likely class\n    AND probability.classifier_name = 'lc_classifier' -- light curve classifier\nORDER BY \n    magstat.oid ASC\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 144, "total_tokens": 4101, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1140821c819081ad2f0e299ef7d9", "custom_id": "102-5", "response": {"status_code": 200, "request_id": "0517b2dbc45dc26f00eb26e39cd4ba6b", "body": {"id": "chatcmpl-CZIjhTwree6yCtQRQ5KrfZigdJhk3", "object": "chat.completion", "created": 1762529537, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT magstat.*\nFROM magstat\nINNER JOIN probability\n    ON magstat.oid = probability.oid\nINNER JOIN allwise\n    ON magstat.oid = allwise.oid_catalog  -- Assuming direct join; if not, a cross-match table is needed\nWHERE probability.class_name = 'AGN'\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\n  AND probability.probability > 0.6\n  AND allwise.w1mpro >= 12\n  AND allwise.w1mpro <= 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4241, "completion_tokens": 128, "total_tokens": 4369, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1140898481908dae6ec1640ce024", "custom_id": "102-6", "response": {"status_code": 200, "request_id": "845c842225d9cb9985ade9c60ce87d7e", "body": {"id": "chatcmpl-CZIjiFCGReeypyQLITChs71ffOQwK", "object": "chat.completion", "created": 1762529538, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT magstat.*\nFROM magstat\nINNER JOIN probability\n    ON magstat.oid = probability.oid\n    AND probability.class_name = 'AGN'\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.6\nINNER JOIN allwise\n    ON magstat.oid = allwise.oid  -- Assumes a direct join is possible via oid\nWHERE allwise.w1mpro >= 12\n  AND allwise.w1mpro <= 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4159, "completion_tokens": 123, "total_tokens": 4282, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1140899881908f84e0d3541698a4", "custom_id": "102-7", "response": {"status_code": 200, "request_id": "0307882ff63919a0af8ac79ed1d3dce6", "body": {"id": "chatcmpl-CZIjjrYokxs0PakTbu5K2wq2ueIMl", "object": "chat.completion", "created": 1762529539, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from magstat for ZTF objects with AGN probability > 0.6 (lc_classifier, ranking=1)\n-- and WISE W1 magnitude (w1mpro) between 12 and 13, limit to 50 results.\nSELECT magstat.*\nFROM magstat\nINNER JOIN probability\n    ON magstat.oid = probability.oid\nINNER JOIN allwise\n    ON magstat.oid = allwise.oid -- Assumes direct join is possible; if not, a cross-match table is needed\nWHERE probability.class_name = 'AGN'\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\n  AND probability.probability > 0.6\n  AND allwise.w1mpro >= 12\n  AND allwise.w1mpro <= 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4237, "completion_tokens": 183, "total_tokens": 4420, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1140f21081908a6e429a9352f52b", "custom_id": "102-8", "response": {"status_code": 200, "request_id": "2f3e95d13473119535514e87a8285a78", "body": {"id": "chatcmpl-CZIjkbMldM1yFL1gL2InpsG5HPaUX", "object": "chat.completion", "created": 1762529540, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT magstat.*\nFROM magstat\nINNER JOIN probability\n    ON magstat.oid = probability.oid\n    AND probability.class_name = 'AGN'\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.6\nINNER JOIN allwise\n    ON magstat.oid = allwise.oid_catalog\n    AND allwise.w1mpro >= 12\n    AND allwise.w1mpro <= 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4087, "completion_tokens": 114, "total_tokens": 4201, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114102808190bdbffea05d467b27", "custom_id": "102-9", "response": {"status_code": 200, "request_id": "fdd7aa04b1a42576f99c2f7fa1e5aba6", "body": {"id": "chatcmpl-CZIjkiGaszWhC2tx5jjDXAECJ6qQ8", "object": "chat.completion", "created": 1762529540, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from magstat for ZTF objects most likely classified as AGN (probability > 0.6)\n-- by the light curve classifier, and with WISE W1 magnitude between 12 and 13.\nSELECT magstat.*\nFROM magstat\nINNER JOIN probability\n    ON magstat.oid = probability.oid\n    AND probability.class_name = 'AGN'\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.6\nINNER JOIN allwise\n    ON magstat.oid = allwise.oid\n    AND allwise.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4377, "completion_tokens": 151, "total_tokens": 4528, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114103f88190926e86fc0bb7b24a", "custom_id": "104-5", "response": {"status_code": 200, "request_id": "600c0dcd115c1191f4b4e34168742b52", "body": {"id": "chatcmpl-CZIjkwrJ34SWcXG7Kg4cBfJyIPhh8", "object": "chat.completion", "created": 1762529540, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find at most 30 ZTF objects with high asteroid probability in stamp_classifier_1.0.4\n-- Return requested columns; FWHM, number of PS1 calibrators, and exposure time are omitted as they are not present in the schema\n\nSELECT\n    object.oid,                -- ZTF object identifier\n    detection.candid,          -- Candidate identifier\n    ss_ztf.ssdistnr,           -- Distance from nearest Solar System object\n    ss_ztf.ssmagnr,            -- MPC archive magnitude\n    ss_ztf.ssnamenr,           -- Name of nearest Solar System object\n    detection.fid              -- Filter identifier\n    -- FWHM from SExtractor, number of PS1 calibrators used, and exposure time are not available in the provided schema\nFROM\n    probability\n    INNER JOIN object ON probability.oid = object.oid\n    INNER JOIN detection ON object.oid = detection.oid\n    INNER JOIN ss_ztf ON object.oid = ss_ztf.oid\nWHERE\n    probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.9\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4460, "completion_tokens": 277, "total_tokens": 4737, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114115e081909e54f844e151e849", "custom_id": "104-6", "response": {"status_code": 200, "request_id": "9efd89f934a65fef9fd94ec0c02d766c", "body": {"id": "chatcmpl-CZIjlckMyj03nqvyTeVuy4Zo2oUyo", "object": "chat.completion", "created": 1762529541, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 30 ZTF objects classified as 'asteroid' by the stamp classifier v1.0.4 with probability > 0.9\n-- Return object and candidate identifiers, Solar System object info, filter id\n-- Note: FWHM from SExtractor, number of PS1 calibrators used, and exposure time are not available in the provided schema\n\nSELECT\n    object.oid,\n    detection.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssmagnr,\n    ss_ztf.ssnamenr,\n    detection.fid\n    -- FWHM from SExtractor, number of PS1 calibrators used, and exposure time are not present in the schema\nFROM\n    probability\nINNER JOIN object ON probability.oid = object.oid\nINNER JOIN ss_ztf ON object.oid = ss_ztf.oid\nINNER JOIN detection ON object.oid = detection.oid\nWHERE\n    probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.9\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4392, "completion_tokens": 257, "total_tokens": 4649, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11411cc081908134c91e2e65f319", "custom_id": "104-7", "response": {"status_code": 200, "request_id": "576d69aa4c7b3980d88f2253850b2aa6", "body": {"id": "chatcmpl-CZIjmpgMWrhqHYpg4FgebCGSI6cRd", "object": "chat.completion", "created": 1762529542, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find at most 30 ZTF objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4'\n-- with probability > 0.9. Return object and candidate identifiers, Solar System object info, filter id,\n-- and (if available) FWHM from SExtractor, number of PS1 calibrators, and exposure time.\n-- NOTE: FWHM from SExtractor, number of PS1 calibrators, and exposure time are not present in the provided schema.\n\nSELECT\n    object.oid,\n    detection.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssmagnr,\n    ss_ztf.ssnamenr,\n    detection.fid\n    -- FWHM from SExtractor, number of PS1 calibrators, and exposure time columns are not included\n    -- as they are not present in the provided schema.\nFROM\n    probability\nINNER JOIN object ON probability.oid = object.oid\nINNER JOIN ss_ztf ON object.oid = ss_ztf.oid\nINNER JOIN detection ON object.oid = detection.oid\nWHERE\n    probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.9\n    AND probability.ranking = 1\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4455, "completion_tokens": 303, "total_tokens": 4758, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141185881908db9c40692343414", "custom_id": "104-8", "response": {"status_code": 200, "request_id": "568343f3e860cc0aaa0aa7e1a4c241ca", "body": {"id": "chatcmpl-CZIjmo9xImcGQDpTfzx6e2PmOF2s9", "object": "chat.completion", "created": 1762529542, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find at most 30 ZTF objects classified as 'asteroid' by the stamp_classifier v1.0.4 with probability > 0.9\n-- Return: oid, candid, ssdistnr, ssmagnr, ssnamenr, fid, FWHM from SExtractor, number of PS1 calibrators used, exposure time\n-- Note: FWHM from SExtractor, number of PS1 calibrators used, and exposure time are not present in the provided schema and are omitted\n\nSELECT\n    p.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    d.fid\n    -- FWHM from SExtractor, number of PS1 calibrators used, and exposure time columns are omitted as they are not present in the schema\nFROM\n    probability p\n    INNER JOIN ss_ztf s ON p.oid = s.oid\n    INNER JOIN detection d ON s.oid = d.oid AND s.candid = d.candid\nWHERE\n    p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4327, "completion_tokens": 280, "total_tokens": 4607, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11411f6c8190a2f7667186d473c2", "custom_id": "104-9", "response": {"status_code": 200, "request_id": "d09a9e8225ab3b69814ef6d1a75ee627", "body": {"id": "chatcmpl-CZIjmcBR8I2RarKjdCkUUfPoTkg3o", "object": "chat.completion", "created": 1762529542, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid,\n    detection.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssmagnr,\n    ss_ztf.ssnamenr,\n    detection.fid,\n    detection.fwhmsex,      -- assumed to exist in detection\n    detection.ncalib,       -- assumed to exist in detection\n    detection.exptime       -- assumed to exist in detection\nFROM probability\nINNER JOIN object ON probability.oid = object.oid\nINNER JOIN detection ON probability.oid = detection.oid\nINNER JOIN ss_ztf ON probability.oid = ss_ztf.oid\nWHERE probability.class_name = 'asteroid'\n  AND probability.classifier_name = 'stamp_classifier'\n  AND probability.classifier_version = 'stamp_classifier_1.0.4'\n  AND probability.probability > 0.9\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4387, "completion_tokens": 190, "total_tokens": 4577, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11411e308190a8d3de73fffba041", "custom_id": "107-5", "response": {"status_code": 200, "request_id": "b0c032002e88f7e2a08426092b12e6fe", "body": {"id": "chatcmpl-CZIjnfnemDiQ4bYNSLvOLrAy913fO", "object": "chat.completion", "created": 1762529543, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find at most 10 ZTF objects with >500 detections, asteroid probability >0.5 in stamp_classifier_1.0.4,\n-- and distance to nearest Solar System object <2 arcsec (2/3600 deg).\n-- Return requested columns, ordered by first detection date.\n\nSELECT\n    o.oid,                        -- ZTF identifier\n    o.ndet,                       -- number of detections\n    o.firstmjd,                   -- first detection date\n    o.lastmjd,                    -- last detection date\n    p.probability,                -- probability of being asteroid\n    s.candid,                     -- candidate identifier\n    s.ssdistnr,                   -- distance to MPC object (in degrees)\n    s.ssnamenr,                   -- MPC name\n    d.mjd,                        -- detection date\n    d.fid                         -- filter identifier\nFROM\n    object o\nINNER JOIN probability p\n    ON o.oid = p.oid\n    AND p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.5\nINNER JOIN ss_ztf s\n    ON o.oid = s.oid\n    AND s.ssdistnr < (2.0/3600.0)\nINNER JOIN detection d\n    ON o.oid = d.oid\n    AND s.candid = d.candid\nWHERE\n    o.ndet > 500\nORDER BY\n    o.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4763, "completion_tokens": 341, "total_tokens": 5104, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114129dc819089ab488a052fcb6d", "custom_id": "107-6", "response": {"status_code": 200, "request_id": "358ec96a43e72dd801f0363f523d86f4", "body": {"id": "chatcmpl-CZIjnD6VgK8efvyFvDgctYLPXKVX0", "object": "chat.completion", "created": 1762529543, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve at most 10 ZTF objects with >500 detections, asteroid probability >0.5 in stamp_classifier_1.0.4,\n-- and distance to nearest Solar System object <2 arcsec, including requested columns, ordered by first detection date.\nSELECT\n    object.oid,\n    object.ndet,\n    object.firstmjd,\n    object.lastmjd,\n    probability.probability,\n    ss_ztf.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssnamenr,\n    detection.mjd,\n    detection.fid\nFROM object\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.5\nINNER JOIN ss_ztf\n    ON object.oid = ss_ztf.oid\n    AND ss_ztf.ssdistnr < 2\nINNER JOIN detection\n    ON ss_ztf.oid = detection.oid\n    AND ss_ztf.candid = detection.candid\nWHERE object.ndet > 500\nORDER BY object.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4848, "completion_tokens": 277, "total_tokens": 5125, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11412ab88190991ef14e0ca433a0", "custom_id": "107-7", "response": {"status_code": 200, "request_id": "91a7c4bd04e56487a484db76a805ba37", "body": {"id": "chatcmpl-CZIjpNUFDkMh5pbjqoGCqwpbLiO6t", "object": "chat.completion", "created": 1762529545, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve up to 10 ZTF objects with >500 detections, asteroid probability >0.5 in stamp_classifier_1.0.4,\n-- and Solar System object match within 2 arcsec. Return requested columns, ordered by first detection date.\n\nSELECT\n    object.oid,\n    object.ndet,\n    object.firstmjd,\n    object.lastmjd,\n    probability.probability,\n    ss_ztf.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssnamenr,\n    detection.mjd,\n    detection.fid\nFROM\n    object\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.5\nINNER JOIN ss_ztf\n    ON object.oid = ss_ztf.oid\n    AND ss_ztf.ssdistnr < 2\nINNER JOIN detection\n    ON ss_ztf.candid = detection.candid\nWHERE\n    object.ndet > 500\nORDER BY\n    object.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5006, "completion_tokens": 268, "total_tokens": 5274, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11415d4c8190b0bab12e188774fa", "custom_id": "107-8", "response": {"status_code": 200, "request_id": "2a58c309a043bd48ad5dac89b2d79204", "body": {"id": "chatcmpl-CZIjgOYFMHA0FZye6BoMNjuHjbid5", "object": "chat.completion", "created": 1762529536, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid,\n    object.ndet,\n    object.firstmjd,\n    object.lastmjd,\n    probability.probability,\n    ss_ztf.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssnamenr,\n    detection.mjd,\n    detection.fid\nFROM object\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.5\nINNER JOIN ss_ztf\n    ON object.oid = ss_ztf.oid\n    AND ss_ztf.ssdistnr < 2\nINNER JOIN detection\n    ON ss_ztf.oid = detection.oid\n    AND ss_ztf.candid = detection.candid\nWHERE object.ndet > 500\nORDER BY object.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4991, "completion_tokens": 222, "total_tokens": 5213, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114168e88190841b9e555550fb59", "custom_id": "107-9", "response": {"status_code": 200, "request_id": "4015630dd1541e3b60e363c06a295f45", "body": {"id": "chatcmpl-CZIjglruI81u7wqKVjd4i6unzcXE2", "object": "chat.completion", "created": 1762529536, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve at most 10 ZTF objects with >500 detections, asteroid probability >0.5 in stamp_classifier_1.0.4,\n-- and Solar System object match within 2 arcsec. Return requested columns, ordered by first detection date.\nSELECT\n    object.oid,\n    object.ndet,\n    object.firstmjd,\n    object.lastmjd,\n    probability.probability,\n    ss_ztf.candid,\n    ss_ztf.ssdistnr,\n    ss_ztf.ssnamenr,\n    detection.mjd,\n    detection.fid\nFROM\n    object\nINNER JOIN probability\n    ON object.oid = probability.oid\nINNER JOIN ss_ztf\n    ON object.oid = ss_ztf.oid\nINNER JOIN detection\n    ON ss_ztf.oid = detection.oid AND ss_ztf.candid = detection.candid\nWHERE\n    object.ndet > 500\n    AND probability.class_name = 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.probability > 0.5\n    AND ss_ztf.ssdistnr < 2\nORDER BY\n    object.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4931, "completion_tokens": 279, "total_tokens": 5210, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114165d8819084864111b4181ac1", "custom_id": "84-5", "response": {"status_code": 200, "request_id": "0ed71e2721267975b7add0999e21d778", "body": {"id": "chatcmpl-CZIjg0QKhFwUxyDjUW1FxFIp8UJcM", "object": "chat.completion", "created": 1762529536, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get ALLWISE matches for ZTF object 'ZTF19aascdol' within 3 arcseconds\nSELECT\n    o.oid AS ztf_oid,\n    a.oid_catalog AS allwise_oid,\n    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance_deg,\n    a.w1mpro,\n    a.w2mpro,\n    a.w3mpro,\n    a.w4mpro\nFROM\n    object o\nJOIN\n    allwise a\n    ON q3c_join(o.meanra, o.meandec, a.ra, a.dec, 0.0008333) -- 3 arcseconds in degrees\nWHERE\n    o.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4037, "completion_tokens": 165, "total_tokens": 4202, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114183588190a2e0804a0b62583f", "custom_id": "84-6", "response": {"status_code": 200, "request_id": "e7af5ce07962cc2fc41c3ee85eea5a60", "body": {"id": "chatcmpl-CZIjgui8KGIB4SRgRopn3zpMw63Ss", "object": "chat.completion", "created": 1762529536, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get ALLWISE matches for ZTF object 'ZTF19aascdol' within 5 arcseconds\nSELECT\n    o.oid AS ztf_oid,\n    a.oid_catalog AS allwise_oid,\n    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) * 3600 AS distance_arcsec, -- distance in arcseconds\n    a.w1mpro,\n    a.w2mpro,\n    a.w3mpro,\n    a.w4mpro\nFROM\n    object o\nINNER JOIN\n    allwise a\n    ON q3c_join(o.meanra, o.meandec, a.ra, a.dec, 5.0/3600.0) -- 5 arcseconds in degrees\nWHERE\n    o.oid = 'ZTF19aascdol'\nORDER BY\n    distance_arcsec ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4071, "completion_tokens": 188, "total_tokens": 4259, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114185d08190932a07da42c393d9", "custom_id": "84-7", "response": {"status_code": 200, "request_id": "f7185e7bd23733e63a02e1b5c5f5b1bb", "body": {"id": "chatcmpl-CZIjgjDPYv1coi8ibomanbXJr95kL", "object": "chat.completion", "created": 1762529536, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Cross-match ZTF object 'ZTF19aascdol' with ALLWISE sources within 3 arcseconds\nSELECT\n    o.oid AS ztf_oid,\n    a.oid_catalog AS allwise_oid,\n    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS distance_deg,\n    a.w1mpro,\n    a.w2mpro,\n    a.w3mpro,\n    a.w4mpro\nFROM\n    object o\nINNER JOIN\n    allwise a\n    ON q3c_join(o.meanra, o.meandec, a.ra, a.dec, 0.000833) -- 3 arcseconds in degrees\nWHERE\n    o.oid = 'ZTF19aascdol'\nORDER BY\n    distance_deg ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4047, "completion_tokens": 173, "total_tokens": 4220, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11417eb081909bb5065e0c072a4b", "custom_id": "84-8", "response": {"status_code": 200, "request_id": "80c11583dab1c1e6cd344b0f909ad244", "body": {"id": "chatcmpl-CZIjieYRzYXMIIKU08wlcRRZXF1yl", "object": "chat.completion", "created": 1762529538, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get ALLWISE matches for ZTF object 'ZTF19aascdol' within 3 arcseconds\nSELECT\n    o.oid AS ztf_oid,\n    a.oid_catalog AS allwise_oid,\n    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS distance_deg,\n    a.w1mpro,\n    a.w2mpro,\n    a.w3mpro,\n    a.w4mpro\nFROM\n    object o\nJOIN\n    allwise a\n    ON q3c_join(o.meanra, o.meandec, a.ra, a.dec, 0.000833) -- 3 arcseconds in degrees\nWHERE\n    o.oid = 'ZTF19aascdol'\nORDER BY\n    distance_deg ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4184, "completion_tokens": 171, "total_tokens": 4355, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114184248190a4488b0a56267781", "custom_id": "84-9", "response": {"status_code": 200, "request_id": "6b7b608e8adc5a6ab8f85ceb8749f65f", "body": {"id": "chatcmpl-CZIji1kMWDvDAsg2xlUlahNynGMtk", "object": "chat.completion", "created": 1762529538, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve ALLWISE matches for ZTF object 'ZTF19aascdol' within 3 arcseconds\nSELECT\n    object.oid AS ztf_oid,\n    allwise.oid_catalog AS allwise_oid,\n    q3c_dist(object.meanra, object.meandec, allwise.ra, allwise.dec) AS distance_deg,\n    allwise.w1mpro,\n    allwise.w2mpro,\n    allwise.w3mpro,\n    allwise.w4mpro\nFROM\n    object\nINNER JOIN\n    allwise\n    ON q3c_radial_query(object.meanra, object.meandec, allwise.ra, allwise.dec, 0.000833)\nWHERE\n    object.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4120, "completion_tokens": 165, "total_tokens": 4285, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114182648190ae53bc6b4131dba7", "custom_id": "96-5", "response": {"status_code": 200, "request_id": "a4b91a00a0ea73b07de519a8d81b5c8a", "body": {"id": "chatcmpl-CZIjiXMZDO6XyErTj9kPKoLzM3lhZ", "object": "chat.completion", "created": 1762529538, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the coordinates for the two Solar System objects (replace with actual RA/Dec as needed)\nWITH catalog AS (\n    SELECT '2003FP134'::VARCHAR AS ssnamenr, 150.123456 AS ra, 2.345678 AS dec\n    UNION ALL\n    SELECT '2009UK56', 210.654321, -5.432198\n),\n-- Find all detections within 2 arcsec of either Solar System object\nnearby_detections AS (\n    SELECT\n        c.ssnamenr,\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.isdiffpos,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf\n    FROM\n        catalog c\n        JOIN detection d\n            ON q3c_radial_query(d.ra, d.dec, c.ra, c.dec, 2.0/3600.0)\n),\n-- Get all ss_ztf rows for these oids and the two Solar System object names\nmatched_ss_ztf AS (\n    SELECT\n        s.*\n    FROM\n        ss_ztf s\n    WHERE\n        s.ssnamenr IN ('2003FP134', '2009UK56')\n)\n-- Final join and selection\nSELECT\n    s.*,\n    nd.mjd,\n    nd.fid,\n    nd.isdiffpos,\n    nd.ra,\n    nd.dec,\n    nd.magpsf,\n    nd.sigmapsf\nFROM\n    matched_ss_ztf s\n    INNER JOIN nearby_detections nd ON s.oid = nd.oid AND s.ssnamenr = nd.ssnamenr\nORDER BY\n    s.ssnamenr ASC,\n    nd.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4415, "completion_tokens": 376, "total_tokens": 4791, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114181d48190a213d59d11d35ef1", "custom_id": "96-6", "response": {"status_code": 200, "request_id": "4bdd372305ac85b2e57fabb18ea7f061", "body": {"id": "chatcmpl-CZIjiIksBV4vYS1Tk9t1xTOjKnuXT", "object": "chat.completion", "created": 1762529538, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the coordinates for the Solar System objects (replace RA/Dec with actual values)\nWITH catalog AS (\n    SELECT '2003FP134' AS ssnamenr, 150.123456 AS ra, 2.345678 AS dec\n    UNION ALL\n    SELECT '2009UK56', 210.654321, -5.432198\n)\nSELECT\n    ss_ztf.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra,\n    detection.dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM\n    catalog\n    JOIN detection\n        ON q3c_radial_query(detection.ra, detection.dec, catalog.ra, catalog.dec, 2.0/3600.0)\n    JOIN ss_ztf\n        ON detection.oid = ss_ztf.oid AND ss_ztf.ssnamenr = catalog.ssnamenr\nORDER BY\n    ss_ztf.ssnamenr ASC,\n    detection.mjd ASC\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4364, "completion_tokens": 220, "total_tokens": 4584, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11418c5c8190a9db1e58c264b542", "custom_id": "96-7", "response": {"status_code": 200, "request_id": "e45fc6ed2a21adefcab6257b4ab760af", "body": {"id": "chatcmpl-CZIjiaiim210ZvtV3TO4tl6eSaw34", "object": "chat.completion", "created": 1762529538, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Create a catalog of positions for the two Solar System objects of interest\nWITH ss_catalog AS (\n    SELECT\n        ss_ztf.ssnamenr,\n        ss_ztf.oid,\n        ss_ztf.candid,\n        detection.ra,\n        detection.dec\n    FROM ss_ztf\n    INNER JOIN detection ON ss_ztf.oid = detection.oid AND ss_ztf.candid = detection.candid\n    WHERE ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\n),\n-- Step 2: Find all detections within 2 arcsec of any Solar System object position\nmatched_detections AS (\n    SELECT\n        ss_catalog.ssnamenr,\n        detection.oid\n    FROM ss_catalog\n    INNER JOIN detection\n        ON q3c_join(ss_catalog.ra, ss_catalog.dec, detection.ra, detection.dec, 2/3600.0)\n)\n-- Step 3: Get all detections for these ZTF objects, join with ss_ztf, and select required columns\nSELECT\n    ss_ztf.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra,\n    detection.dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM matched_detections\nINNER JOIN detection ON matched_detections.oid = detection.oid\nINNER JOIN ss_ztf ON detection.oid = ss_ztf.oid\nWHERE ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\nORDER BY ss_ztf.ssnamenr, detection.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4214, "completion_tokens": 353, "total_tokens": 4567, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141c0e08190aea61d038a6ff173", "custom_id": "96-8", "response": {"status_code": 200, "request_id": "f0cb0a86286f4e3e248f13b56e6ec75e", "body": {"id": "chatcmpl-CZIjkCVeSDE8gOX9w0jh484x2J94i", "object": "chat.completion", "created": 1762529540, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the catalog of Solar System objects with their positions\nWITH catalog (ssnamenr, ra, dec) AS (\n    VALUES\n        ('2003FP134', /* INSERT_RA_2003FP134 */ , /* INSERT_DEC_2003FP134 */),\n        ('2009UK56',  /* INSERT_RA_2009UK56  */ , /* INSERT_DEC_2009UK56  */)\n)\nSELECT\n    ss_ztf.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra AS detection_ra,\n    detection.dec AS detection_dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM\n    catalog\n    INNER JOIN ss_ztf\n        ON ss_ztf.ssnamenr = catalog.ssnamenr\n        AND q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 2.0/3600.0) -- 2 arcsec in degrees\n    INNER JOIN detection\n        ON ss_ztf.oid = detection.oid\nORDER BY\n    ss_ztf.ssnamenr,\n    detection.mjd\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4136, "completion_tokens": 252, "total_tokens": 4388, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141cf1481908a23ca5664917e4d", "custom_id": "96-9", "response": {"status_code": 200, "request_id": "56b6cea7a74bb535a4c2761df7360b99", "body": {"id": "chatcmpl-CZIjlD8mOI9HM1D2ekHsU4AmtfepF", "object": "chat.completion", "created": 1762529541, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all detections for ZTF objects within 2 arcsec of Solar System objects '2003FP134' and '2009UK56'\nWITH ss_objects AS (\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n),\nss_positions AS (\n    SELECT s.*, o.meanra AS ss_ra, o.meandec AS ss_dec\n    FROM ss_objects s\n    INNER JOIN object o ON s.oid = o.oid\n),\nmatched_objects AS (\n    -- Find all ZTF objects within 2 arcsec (2/3600 deg) of any Solar System object position\n    SELECT DISTINCT o.oid, s.*\n    FROM object o\n    INNER JOIN ss_positions s\n        ON q3c_radial_query(o.meanra, o.meandec, s.ss_ra, s.ss_dec, 2.0/3600.0)\n)\nSELECT\n    m.*,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM matched_objects m\nINNER JOIN detection d ON m.oid = d.oid\nORDER BY m.ssnamenr, d.mjd\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4292, "completion_tokens": 272, "total_tokens": 4564, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141c7808190abeb973caa95b37e", "custom_id": "94-6", "response": {"status_code": 200, "request_id": "63e0a54c35030d6e284695f4fbed3974", "body": {"id": "chatcmpl-CZIjlnn9QK5GJydD8EYGXorpNGBuV", "object": "chat.completion", "created": 1762529541, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from object and reference for objects with a reference change, limit to 50 rows\nSELECT object.*, reference.*\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3825, "completion_tokens": 56, "total_tokens": 3881, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141e87c8190b86ce85a90f2a9ed", "custom_id": "94-7", "response": {"status_code": 200, "request_id": "bfed73c43f877364c61bdc424ed01ede", "body": {"id": "chatcmpl-CZIjlIp5e8OktucFVRwL3Ah1ZcE2z", "object": "chat.completion", "created": 1762529541, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' for objects with a reference change, limit to 50 rows\nSELECT object.*, reference.*\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3929, "completion_tokens": 60, "total_tokens": 3989, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141e2c4819092a6108b2184df92", "custom_id": "94-8", "response": {"status_code": 200, "request_id": "238cf7ba85632d6ced86c4f731a8fc9d", "body": {"id": "chatcmpl-CZIjmL9Ne6F12nw48KyXV1qzc6eDR", "object": "chat.completion", "created": 1762529542, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' for objects with a reference change, limit to 50 rows\nSELECT object.*, reference.*\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3863, "completion_tokens": 60, "total_tokens": 3923, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141f52c81908b10e8e1a53077be", "custom_id": "94-9", "response": {"status_code": 200, "request_id": "e54c91342edfca8c9be3b910cb60fa64", "body": {"id": "chatcmpl-CZIjnH1tRZPIZzToGCiqNg8kgvbla", "object": "chat.completion", "created": 1762529543, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from object and reference for objects with a reference change, limit to 50 rows\nSELECT object.*, reference.*\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3884, "completion_tokens": 56, "total_tokens": 3940, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_36221e1176"}}, "error": null}
{"id": "batch_req_690e1141e3408190b0319b9cf34e1d5e", "custom_id": "90-5", "response": {"status_code": 200, "request_id": "3d28bd6571b61c8c098147c133814327", "body": {"id": "chatcmpl-CZIjnHzsL03vkvsID68raCrPGx242", "object": "chat.completion", "created": 1762529543, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability for up to 100 objects with Multiband_period < 5 (feature version 'lc_classifier_1.2.1-P'),\n-- only for classifier_name='lc_classifier' and ranking 1 or 2\nSELECT probability.*\nFROM probability\nINNER JOIN (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n) AS filtered_oids\nON probability.oid = filtered_oids.oid\nWHERE probability.classifier_name = 'lc_classifier'\n  AND probability.ranking IN (1, 2)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4042, "completion_tokens": 150, "total_tokens": 4192, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141e9fc819086503ae248939374", "custom_id": "90-6", "response": {"status_code": 200, "request_id": "9d7935a1f54f29287692c5f04bb2c399", "body": {"id": "chatcmpl-CZIjoSWhjN3pFmpavzdvkU7wkTcVk", "object": "chat.completion", "created": 1762529544, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability for up to 100 unique objects\n-- with Multiband_period < 5 in the specified feature version,\n-- classifier_name = 'lc_classifier', and ranking in (1,2)\nSELECT p.*\nFROM probability p\nINNER JOIN (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n) f ON p.oid = f.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4081, "completion_tokens": 139, "total_tokens": 4220, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141ef248190a9dadb25d2a4367f", "custom_id": "90-7", "response": {"status_code": 200, "request_id": "4d429f20a9dd36f20fc28ab8e9bf8674", "body": {"id": "chatcmpl-CZIjolsIPQ3P2o8L5Sye3NRh3tPsg", "object": "chat.completion", "created": 1762529544, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT probability.*\nFROM feature\nINNER JOIN probability ON feature.oid = probability.oid\nWHERE feature.name = 'Multiband_period'\n  AND feature.value < 5\n  AND feature.version = 'lc_classifier_1.2.1-P'\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4052, "completion_tokens": 83, "total_tokens": 4135, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1141fed8819083e6fdb75432a45a", "custom_id": "90-8", "response": {"status_code": 200, "request_id": "32c710442fd481053e5a4fa6cba1710f", "body": {"id": "chatcmpl-CZIjoEF5ySZtX7CGtXZXAMvRDPkOJ", "object": "chat.completion", "created": 1762529544, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 100 ZTF objects with Multiband_period < 5 in the specified feature version,\n-- then return all columns from the probability table for those objects,\n-- only for the light curve classifier and rankings 1 or 2.\n\nWITH selected_oids AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n)\nSELECT probability.*\nFROM probability\nINNER JOIN selected_oids ON probability.oid = selected_oids.oid\nWHERE probability.classifier_name = 'lc_classifier'\n  AND probability.ranking IN (1, 2)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4076, "completion_tokens": 153, "total_tokens": 4229, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11424b008190b991d1433831ec48", "custom_id": "90-9", "response": {"status_code": 200, "request_id": "95b7ee17f927c5c47cd638f7b8f5ee34", "body": {"id": "chatcmpl-CZIjgENJO3nJVwhQheShnwOCWHPnj", "object": "chat.completion", "created": 1762529536, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from the probability table for up to 100 unique objects\n-- with Multiband_period < 5 (from feature table, version 'lc_classifier_1.2.1-P'),\n-- only for classifier_name 'lc_classifier' and ranking 1 or 2\n\nSELECT probability.*\nFROM probability\nINNER JOIN (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n) AS filtered_oids\nON probability.oid = filtered_oids.oid\nWHERE probability.classifier_name = 'lc_classifier'\n  AND probability.ranking IN (1, 2)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4143, "completion_tokens": 158, "total_tokens": 4301, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11422bf4819088e29240b3e1bbaa", "custom_id": "100-5", "response": {"status_code": 200, "request_id": "77bea1b8cb6ecc40bc95b9fc9c80e5d9", "body": {"id": "chatcmpl-CZIjgtXRhzKaQ32oVOTmV6d6Xz6TP", "object": "chat.completion", "created": 1762529536, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Combine detections, non-detections, and forced photometry for ZTF24aamtvxb\nSELECT\n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    magpsf,\n    sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'detection' AS table\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid,\n    mjd,\n    fid,\n    NULL AS isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'non_detection' AS table\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    diffmaglim,\n    mag,\n    e_mag,\n    'forced_photometry' AS table\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4582, "completion_tokens": 250, "total_tokens": 4832, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142392c8190906b8473d58f6a10", "custom_id": "100-6", "response": {"status_code": 200, "request_id": "6f182d2c94edc085911d7982b5d0214b", "body": {"id": "chatcmpl-CZIjgwpNUvUWVuYo3nUuEIN5m65xY", "object": "chat.completion", "created": 1762529536, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Combine detections, non-detections, and forced photometry for ZTF24aamtvxb into a single table\nSELECT\n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    magpsf,\n    sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'detection' AS table\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid,\n    mjd,\n    fid,\n    NULL AS isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'non_detection' AS table\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    diffmaglim,\n    mag,\n    e_mag,\n    'forced_photometry' AS table\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4783, "completion_tokens": 255, "total_tokens": 5038, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114243e08190a4d6a7f4edef5912", "custom_id": "100-7", "response": {"status_code": 200, "request_id": "08b349825d1e3d83eca6a722fb28a06c", "body": {"id": "chatcmpl-CZIjgwKZNLbWueAXNDk48cTtYZyNC", "object": "chat.completion", "created": 1762529536, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Combine detections, non-detections, and forced photometry for the object 'ZTF24aamtvxb'\nSELECT\n    oid AS ztf_oid,\n    mjd AS epoch,\n    fid,\n    isdiffpos,\n    magpsf AS detection_mag,\n    sigmapsf AS detection_mag_unc,\n    diffmaglim,\n    NULL::DOUBLE PRECISION AS forced_mag,\n    NULL::DOUBLE PRECISION AS forced_mag_unc,\n    'detection' AS table\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid AS ztf_oid,\n    mjd AS epoch,\n    fid,\n    NULL::INTEGER AS isdiffpos,\n    NULL::DOUBLE PRECISION AS detection_mag,\n    NULL::DOUBLE PRECISION AS detection_mag_unc,\n    diffmaglim,\n    NULL::DOUBLE PRECISION AS forced_mag,\n    NULL::DOUBLE PRECISION AS forced_mag_unc,\n    'non_detection' AS table\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid AS ztf_oid,\n    mjd AS epoch,\n    fid,\n    isdiffpos,\n    NULL::DOUBLE PRECISION AS detection_mag,\n    NULL::DOUBLE PRECISION AS detection_mag_unc,\n    diffmaglim,\n    mag AS forced_mag,\n    e_mag AS forced_mag_unc,\n    'forced_photometry' AS table\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY epoch ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4612, "completion_tokens": 321, "total_tokens": 4933, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11424d7c8190a18b1ed72f16f2a4", "custom_id": "100-8", "response": {"status_code": 200, "request_id": "75401d9e89134d42a014755ce0b4574a", "body": {"id": "chatcmpl-CZIjhiXlh984bRmDke4z4pMMDe0x8", "object": "chat.completion", "created": 1762529537, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Combine detections, non-detections, and forced photometry for the specified ZTF object\nSELECT\n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    magpsf,\n    sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'detection' AS table\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid,\n    mjd,\n    fid,\n    NULL AS isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'non_detection' AS table\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    diffmaglim,\n    mag,\n    e_mag,\n    'forced_photometry' AS table\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4453, "completion_tokens": 249, "total_tokens": 4702, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114247fc819086a203d7f53c6cd1", "custom_id": "100-9", "response": {"status_code": 200, "request_id": "25ad2da7cf33ceaf13f8ec771af0184a", "body": {"id": "chatcmpl-CZIjj3DtyaCmqSO1jMvhsILG3c0cZ", "object": "chat.completion", "created": 1762529539, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Combine detections, non-detections, and forced photometry for the object 'ZTF24aamtvxb'\nSELECT\n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    magpsf,\n    sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'detection' AS table\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid,\n    mjd,\n    fid,\n    NULL AS isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'non_detection' AS table\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT\n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    diffmaglim,\n    mag,\n    e_mag,\n    'forced_photometry' AS table\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4706, "completion_tokens": 254, "total_tokens": 4960, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142512081909445219c3b48cc35", "custom_id": "106-5", "response": {"status_code": 200, "request_id": "2a7582aa30784937ab73f045692c1faf", "body": {"id": "chatcmpl-CZIjjJASPk2ewbi2C4z24lDZWU8Ou", "object": "chat.completion", "created": 1762529539, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with >10 detections, high bogus probability in stamp classifier, and high transient probability in lc_classifier_top\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p_stamp.probability AS prob_stamp_bogus,\n    p_lc.probability AS prob_lc_transient\nFROM\n    object o\n    INNER JOIN probability p_stamp\n        ON o.oid = p_stamp.oid\n        AND p_stamp.classifier_name = 'stamp_classifier'\n        AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n        AND p_stamp.class_name = 'bogus'\n        AND p_stamp.probability > 0.7\n    INNER JOIN probability p_lc\n        ON o.oid = p_lc.oid\n        AND p_lc.classifier_name = 'lc_classifier_top'\n        AND p_lc.class_name = 'Transient'\n        AND p_lc.probability > 0.9\nWHERE\n    o.ndet > 10\nORDER BY\n    o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4674, "completion_tokens": 235, "total_tokens": 4909, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114259888190bfcc96fc66c6cf3a", "custom_id": "106-6", "response": {"status_code": 200, "request_id": "6bd0a1fbfa2cfde5091b0f054a0dfcdb", "body": {"id": "chatcmpl-CZIjj3cAHPI5fc3uZuzpdJ6W7uLdO", "object": "chat.completion", "created": 1762529539, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with >10 detections, high bogus probability in stamp classifier, and high transient probability in lc_classifier_top\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p_stamp.probability AS prob_stamp_bogus,\n    p_lc.probability AS prob_lc_transient\nFROM\n    object o\n    INNER JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE\n            classifier_name = 'stamp_classifier'\n            AND classifier_version = 'stamp_classifier_1.0.4'\n            AND class_name = 'bogus'\n            AND probability > 0.7\n    ) p_stamp ON o.oid = p_stamp.oid\n    INNER JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE\n            classifier_name = 'lc_classifier_top'\n            AND class_name = 'Transient'\n            AND probability > 0.9\n    ) p_lc ON o.oid = p_lc.oid\nWHERE\n    o.ndet > 10\nORDER BY\n    o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4657, "completion_tokens": 235, "total_tokens": 4892, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11425b408190b30c421735b82fb2", "custom_id": "106-7", "response": {"status_code": 200, "request_id": "6c47bd78087602c4c9298431e1155422", "body": {"id": "chatcmpl-CZIjjcH44Slw3FhWryLFndUUCbWjM", "object": "chat.completion", "created": 1762529539, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with >10 detections, high bogus probability in stamp classifier, and high transient probability in lc_classifier_top\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    sc.probability AS prob_stamp_bogus,\n    lc.probability AS prob_lc_transient\nFROM\n    object o\n    INNER JOIN (\n        SELECT\n            oid,\n            probability\n        FROM\n            probability\n        WHERE\n            class_name = 'bogus'\n            AND classifier_name = 'stamp_classifier'\n            AND classifier_version = 'stamp_classifier_1.0.4'\n            AND probability > 0.7\n    ) sc ON o.oid = sc.oid\n    INNER JOIN (\n        SELECT\n            oid,\n            probability\n        FROM\n            probability\n        WHERE\n            class_name = 'Transient'\n            AND classifier_name = 'lc_classifier_top'\n            AND probability > 0.9\n            AND ranking = 1\n    ) lc ON o.oid = lc.oid\nWHERE\n    o.ndet > 10\nORDER BY\n    o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4787, "completion_tokens": 243, "total_tokens": 5030, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114274c88190989b31d7f6a75bce", "custom_id": "106-8", "response": {"status_code": 200, "request_id": "d30a9bc9e8948fb1e61bb59781120a6c", "body": {"id": "chatcmpl-CZIjkllDmIMQ7D0qMwqRV8pjc0Yau", "object": "chat.completion", "created": 1762529540, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with >10 detections, high bogus probability in stamp classifier, and high transient probability in lc_classifier_top\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    ps.probability AS prob_stamp_bogus,\n    pl.probability AS prob_lc_transient\nFROM\n    object o\n    INNER JOIN (\n        SELECT\n            oid,\n            probability\n        FROM\n            probability\n        WHERE\n            class_name = 'bogus'\n            AND classifier_name = 'stamp_classifier'\n            AND classifier_version = 'stamp_classifier_1.0.4'\n            AND probability > 0.7\n    ) ps ON o.oid = ps.oid\n    INNER JOIN (\n        SELECT\n            oid,\n            probability\n        FROM\n            probability\n        WHERE\n            class_name = 'Transient'\n            AND classifier_name = 'lc_classifier_top'\n            AND probability > 0.9\n    ) pl ON o.oid = pl.oid\nWHERE\n    o.ndet > 10\nORDER BY\n    o.oid ASC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4647, "completion_tokens": 237, "total_tokens": 4884, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e114286f481909cd25c17fae790f7", "custom_id": "106-9", "response": {"status_code": 200, "request_id": "387126f08835eddc7bf4e30a91e2bd42", "body": {"id": "chatcmpl-CZIjl9BjgUIj5JkVRPxv7aoBGle95", "object": "chat.completion", "created": 1762529541, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with >10 detections, high bogus probability in stamp classifier, and high transient probability in lc_classifier_top\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    ps.probability AS prob_stamp_bogus,\n    pl.probability AS prob_lc_transient\nFROM\n    object o\n    INNER JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE\n            classifier_name = 'stamp_classifier'\n            AND class_name = 'bogus'\n            AND classifier_version = 'stamp_classifier_1.0.4'\n            AND probability > 0.7\n    ) ps ON o.oid = ps.oid\n    INNER JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE\n            classifier_name = 'lc_classifier_top'\n            AND class_name = 'Transient'\n            AND probability > 0.9\n    ) pl ON o.oid = pl.oid\nWHERE\n    o.ndet > 10\nORDER BY\n    o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4537, "completion_tokens": 226, "total_tokens": 4763, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e11429e408190bf57a93cd330ad4e", "custom_id": "58-5", "response": {"status_code": 200, "request_id": "09795540a312c655170ff5d0d1e181ce", "body": {"id": "chatcmpl-CZIjlFwMmZwAnepI2WKTQheirNjFc", "object": "chat.completion", "created": 1762529541, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT object.*\nFROM object\nINNER JOIN magstat AS mg ON object.oid = mg.oid AND mg.fid = 1  -- g-band\nINNER JOIN magstat AS mr ON object.oid = mr.oid AND mr.fid = 2  -- r-band\nWHERE object.ndet >= 30\n  AND object.deltajd > 20\n  AND (mg.magmin_corr - mr.magmin_corr) > 3.5\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4128, "completion_tokens": 104, "total_tokens": 4232, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142aaa48190b8dd5726b11648cb", "custom_id": "58-6", "response": {"status_code": 200, "request_id": "0507630cd268f2a99af497cbb3d2971a", "body": {"id": "chatcmpl-CZIjm88zbMLwotBXutycR4gAsEcxG", "object": "chat.completion", "created": 1762529542, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT object.*\nFROM object\nINNER JOIN magstat AS g_magstat\n    ON object.oid = g_magstat.oid AND g_magstat.fid = 1\nINNER JOIN magstat AS r_magstat\n    ON object.oid = r_magstat.oid AND r_magstat.fid = 2\nWHERE object.ndet >= 30\n  AND object.deltajd > 20\n  AND ABS(g_magstat.magmin_corr - r_magstat.magmin_corr) > 3.5\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4062, "completion_tokens": 116, "total_tokens": 4178, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142b12481909df79e924beae68c", "custom_id": "58-7", "response": {"status_code": 200, "request_id": "debf0a409ed03865048d94f7667b9ef4", "body": {"id": "chatcmpl-CZIjmnDAHyg1JJQxGYLug6UvcSccn", "object": "chat.completion", "created": 1762529542, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get at most 20 ZTF objects with ndet >= 30, deltajd > 20, and (magmin_corr_g - magmin_corr_r) > 3.5\nSELECT object.*\nFROM object\nINNER JOIN magstat AS magstat_g ON object.oid = magstat_g.oid AND magstat_g.fid = 1\nINNER JOIN magstat AS magstat_r ON object.oid = magstat_r.oid AND magstat_r.fid = 2\nWHERE object.ndet >= 30\n  AND object.deltajd > 20\n  AND (magstat_g.magmin_corr - magstat_r.magmin_corr) > 3.5\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4170, "completion_tokens": 153, "total_tokens": 4323, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142b0048190ae793fa20b200b1f", "custom_id": "58-8", "response": {"status_code": 200, "request_id": "d2ce1f30bced7831a394f335a9dd19f0", "body": {"id": "chatcmpl-CZIjnKWw4XAiK292wkR3O2npiVboe", "object": "chat.completion", "created": 1762529543, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT object.*\nFROM object\nINNER JOIN magstat AS g_magstat\n    ON object.oid = g_magstat.oid AND g_magstat.fid = 1\nINNER JOIN magstat AS r_magstat\n    ON object.oid = r_magstat.oid AND r_magstat.fid = 2\nWHERE object.ndet >= 30\n  AND ABS(g_magstat.magmin_corr - r_magstat.magmin_corr) > 3.5\n  AND (object.lastmjd - object.firstmjd) > 20\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4128, "completion_tokens": 122, "total_tokens": 4250, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142c554819092a377941229a73f", "custom_id": "58-9", "response": {"status_code": 200, "request_id": "55158053b9fff9b52cf01e83701bf62f", "body": {"id": "chatcmpl-CZIjn8zmiRMmTGxVyMcYh3bxtEizk", "object": "chat.completion", "created": 1762529543, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT object.*\nFROM object\nINNER JOIN magstat AS mg ON object.oid = mg.oid AND mg.fid = 1  -- g-band\nINNER JOIN magstat AS mr ON object.oid = mr.oid AND mr.fid = 2  -- r-band\nWHERE object.ndet >= 30\n  AND (object.lastmjd - object.firstmjd) > 20\n  AND (mg.magmin_corr - mr.magmin_corr) > 3.5\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4094, "completion_tokens": 110, "total_tokens": 4204, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142c36c8190b239e2e2c94cf0fb", "custom_id": "39-5", "response": {"status_code": 200, "request_id": "ecca094a6651d1924f94ef74dd46711c", "body": {"id": "chatcmpl-CZIjn6TkG6nn618OI3OXxX0Y5YGWY", "object": "chat.completion", "created": 1762529543, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY]\nSELECT\n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    mr.max_rise_from_min\nFROM\n    (\n        -- Step 1: Filter probability for CV/Nova, stochastic classifier, ranking=1\n        SELECT oid\n        FROM probability\n        WHERE class_name = 'CV/Nova'\n          AND classifier_name = 'lc_classifier_stochastic'\n          AND ranking = 1\n    ) p\n    INNER JOIN object o ON o.oid = p.oid\n    -- Step 2: Filter for ndet <= 50\n    INNER JOIN detection d ON d.oid = o.oid AND d.fid = 2\n    -- Step 3: Join with subquery for max rise from min per object in r-band\n    INNER JOIN (\n        SELECT\n            oid,\n            MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise_from_min\n        FROM detection\n        WHERE fid = 2\n        GROUP BY oid\n    ) mr ON mr.oid = o.oid\nWHERE\n    o.ndet <= 50\nORDER BY\n    o.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4640, "completion_tokens": 282, "total_tokens": 4922, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142c2c08190a165dfbdf24c8686", "custom_id": "39-6", "response": {"status_code": 200, "request_id": "e2f2e40c475770354019d500b9c83d2d", "body": {"id": "chatcmpl-CZIjoCDQbLBI7oQ4Lkgc42adkH2NI", "object": "chat.completion", "created": 1762529544, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- FINAL QUERY\nSELECT\n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr, -- corrected difference magnitude in r-band\n    mr.max_rise_from_min -- maximum rise from minimum in corrected magnitude for the object in r-band\nFROM\n    (\n        -- Subquery: Get oids classified as CV/Nova by the stochastic classifier with ranking 1\n        SELECT\n            p.oid\n        FROM\n            probability p\n        WHERE\n            p.class_name = 'CV/Nova'\n            AND p.classifier_name = 'lc_classifier_stochastic'\n            AND p.ranking = 1\n    ) AS cvnova\n    INNER JOIN object o ON o.oid = cvnova.oid\n    INNER JOIN (\n        -- Subquery: For each object, count r-band detections between discovery and last detection, keep only those with count <= 50\n        SELECT\n            d.oid,\n            COUNT(*) AS rband_det_count\n        FROM\n            detection d\n            INNER JOIN object o2 ON d.oid = o2.oid\n        WHERE\n            d.fid = 2\n            AND d.mjd BETWEEN o2.firstmjd AND o2.lastmjd\n        GROUP BY\n            d.oid\n        HAVING\n            COUNT(*) <= 50\n    ) AS detcount ON o.oid = detcount.oid\n    INNER JOIN (\n        -- Subquery: For each object, compute max(magpsf_corr) - min(magpsf_corr) in r-band\n        SELECT\n            d.oid,\n            MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS max_rise_from_min\n        FROM\n            detection d\n            INNER JOIN object o3 ON d.oid = o3.oid\n        WHERE\n            d.fid = 2\n            AND d.mjd BETWEEN o3.firstmjd AND o3.lastmjd\n        GROUP BY\n            d.oid\n    ) AS mr ON o.oid = mr.oid\n    INNER JOIN detection d ON o.oid = d.oid\n        AND d.fid = 2\n        AND d.mjd BETWEEN o.firstmjd AND o.lastmjd\nORDER BY\n    o.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4963, "completion_tokens": 509, "total_tokens": 5472, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142d924819081e7bebc8bccc0bf", "custom_id": "39-7", "response": {"status_code": 200, "request_id": "ab7d65b8c90b9419056465e4fda42b6f", "body": {"id": "chatcmpl-CZIjo5jrdC55U4jwQA6y9WQRpvI1R", "object": "chat.completion", "created": 1762529544, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY HERE]\nSELECT\n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    maxmin_rise.max_rise_from_min\nFROM\n    (\n        SELECT\n            p.oid\n        FROM\n            probability p\n        WHERE\n            p.class_name = 'CV/Nova'\n            AND p.classifier_name = 'lc_classifier_stochastic'\n            AND p.ranking = 1\n    ) AS prob\n    INNER JOIN object o ON prob.oid = o.oid\n    INNER JOIN detection d ON o.oid = d.oid\n    INNER JOIN (\n        -- Subquery to compute the maximum rise from minimum magpsf_corr in r-band for each object\n        SELECT\n            oid,\n            MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise_from_min\n        FROM\n            detection\n        WHERE\n            fid = 2\n            AND magpsf_corr IS NOT NULL\n        GROUP BY\n            oid\n    ) AS maxmin_rise ON o.oid = maxmin_rise.oid\nWHERE\n    o.ndet <= 50\n    AND d.fid = 2\nORDER BY\n    o.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4554, "completion_tokens": 293, "total_tokens": 4847, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142e39081908430364dae86a41b", "custom_id": "39-8", "response": {"status_code": 200, "request_id": "37118ec636b2e3fadb8adb75c5c577ff", "body": {"id": "chatcmpl-CZIjpiOpZ76WsVkurip0dBrxCiKwj", "object": "chat.completion", "created": 1762529545, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get required columns for objects classified as CV/Nova by the stochastic light curve classifier,\n-- with at most 50 r-band detections between discovery and last detection,\n-- and compute the maximum rise from minimum in PSF corrected magnitude in r-band for each object.\n\nWITH cvnova_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'CV/Nova'\n      AND classifier_name = 'lc_classifier_stochastic'\n      AND ranking = 1\n),\nrband_detections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.magpsf_corr,\n        o.firstmjd,\n        o.lastmjd\n    FROM detection d\n    INNER JOIN object o ON d.oid = o.oid\n    WHERE d.oid IN (SELECT oid FROM cvnova_oids)\n      AND d.fid = 2\n      AND d.mjd BETWEEN o.firstmjd AND o.lastmjd\n),\nfiltered_oids AS (\n    SELECT oid\n    FROM rband_detections\n    GROUP BY oid\n    HAVING COUNT(*) <= 50\n),\nmag_rise AS (\n    SELECT\n        oid,\n        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise_from_min\n    FROM rband_detections\n    WHERE oid IN (SELECT oid FROM filtered_oids)\n    GROUP BY oid\n)\nSELECT\n    r.oid,\n    r.candid,\n    r.fid AS f_id,\n    r.ra,\n    r.dec,\n    r.magpsf,\n    r.sigmapsf,\n    r.magpsf_corr,\n    m.max_rise_from_min\nFROM rband_detections r\nINNER JOIN filtered_oids f ON r.oid = f.oid\nINNER JOIN mag_rise m ON r.oid = m.oid\nORDER BY r.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4821, "completion_tokens": 422, "total_tokens": 5243, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
{"id": "batch_req_690e1142e12c8190b495bd2b24aa3d41", "custom_id": "39-9", "response": {"status_code": 200, "request_id": "6a0ef015b3aa71f8ab86317d9a5a3f5d", "body": {"id": "chatcmpl-CZIjiTKluCPOnTgDRbUp5s93p3C8I", "object": "chat.completion", "created": 1762529538, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select required columns for objects classified as CV/Nova by the stochastic light curve classifier,\n-- with ndet <= 50, only r-band detections, and include the maximum rise from minimum magpsf_corr per object.\nSELECT\n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    max_rise.max_rise\nFROM\n    object o\n    INNER JOIN (\n        SELECT\n            p.oid\n        FROM\n            probability p\n        WHERE\n            p.class_name = 'CV/Nova'\n            AND p.classifier_name = 'lc_classifier_stochastic'\n            AND p.ranking = 1\n    ) p1 ON o.oid = p1.oid\n    INNER JOIN detection d ON o.oid = d.oid\n    INNER JOIN (\n        -- Compute the maximum rise (max - min magpsf_corr) in r-band for each object\n        SELECT\n            oid,\n            MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise\n        FROM\n            detection\n        WHERE\n            fid = 2\n        GROUP BY\n            oid\n    ) max_rise ON o.oid = max_rise.oid\nWHERE\n    o.ndet <= 50\n    AND d.fid = 2\nORDER BY\n    o.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4803, "completion_tokens": 316, "total_tokens": 5119, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_d38c7f4fa7"}}, "error": null}
