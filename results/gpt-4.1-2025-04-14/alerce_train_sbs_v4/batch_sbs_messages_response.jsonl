{"id": "batch_req_68491bc5a3708190960ab988286d4b70", "custom_id": "15-0", "response": {"status_code": 200, "request_id": "328aaa1c6f0ba9716be8d6b7e9429fa2", "body": {"id": "chatcmpl-Bh8nNduEmKeK5OKhQ5uNGpoBvOUQ9", "object": "chat.completion", "created": 1749621613, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with first detection in the first two days of September (MJD 60188.0 to 60190.0)\n-- that are fast risers (dm_first/dt_first >= 0.25 in magstat), and whose highest stamp classifier probability is for class 'SN'\n-- Return object id, stamp classifier probability, light curve classifier probability, all detection info, detection filter id, detection candid, magstat filter id as magstat_fid, and initial rise estimate\nSELECT\n    o.oid,\n    p_stamp.probability AS stamp_sn_probability,\n    p_lc.probability AS lc_classifier_probability,\n    d.*,\n    d.fid AS detection_fid,\n    d.candid,\n    m.fid AS magstat_fid,\n    (m.dm_first / m.dt_first) AS initial_rise_estimate\nFROM\n    object o\n    -- Join magstat for fast riser calculation\n    INNER JOIN magstat m\n        ON o.oid = m.oid\n        AND m.dt_first > 0\n        AND (m.dm_first / m.dt_first) >= 0.25\n    -- Join probability for stamp classifier (class 'SN', ranking=1)\n    INNER JOIN probability p_stamp\n        ON o.oid = p_stamp.oid\n        AND p_stamp.classifier_name = 'stamp_classifier'\n        AND p_stamp.class_name = 'SN'\n        AND p_stamp.ranking = 1\n    -- Join probability for light curve classifier (ranking=1, default)\n    INNER JOIN probability p_lc\n        ON o.oid = p_lc.oid\n        AND p_lc.classifier_name = 'lc_classifier'\n        AND p_lc.ranking = 1\n    -- Join detection for all detections of the selected objects\n    INNER JOIN detection d\n        ON o.oid = d.oid\n        AND d.fid = m.fid -- Only detections in the same filter as the fast riser filter\nWHERE\n    o.firstmjd >= 60188.0\n    AND o.firstmjd < 60190.0\nORDER BY\n    o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2963, "completion_tokens": 453, "total_tokens": 3416, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc5b45c81909e58bbd19c960ca3", "custom_id": "15-1", "response": {"status_code": 200, "request_id": "0373b6e1ad329bf5e43841159ee1cea7", "body": {"id": "chatcmpl-Bh8nG5WUmKcTFh4lGGPjgGAL84KPp", "object": "chat.completion", "created": 1749621606, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT\n    object.oid,\n    probability.probability,\n    detection.fid,\n    detection.candid,\n    magstat.fid AS magstat_fid,\n    magstat.dmdt_first\nFROM\n    object\nINNER JOIN magstat\n    ON object.oid = magstat.oid\nINNER JOIN probability\n    ON object.oid = probability.oid\n        AND probability.classifier_name = 'stamp_classifier'\n        AND probability.class_name = 'SN'\n        AND probability.ranking = 1\nINNER JOIN detection\n    ON object.oid = detection.oid\nWHERE\n    object.firstmjd >= 60188.0\n    AND object.firstmjd < 60190.0\n    AND magstat.dmdt_first >= 0.25\nORDER BY\n    object.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3038, "completion_tokens": 173, "total_tokens": 3211, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc5c56881908041bda94329a407", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "0e93acab984584682fc64450994ca8e8", "body": {"id": "chatcmpl-Bh8nHmEnZ5gK66Sgteygd9kqWoL7k", "object": "chat.completion", "created": 1749621607, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get object and detection info for SNII objects with high probability, high initial rise in g and r, and >50 detections, for detections in 2019-2022\nSELECT\n    object.oid,\n    detection.candid,\n    detection.magpsf,\n    detection.sigmapsf,\n    detection.magap,\n    detection.sigmagap,\n    detection.magpsf_corr,\n    detection.sigmapsf_corr,\n    detection.sigmapsf_corr_ext,\n    detection.magapbig,\n    detection.sigmagapbig,\n    detection.fid,\n    detection.mjd,\n    g_magstat.dmdt_first AS g_dmdt_first,\n    r_magstat.dmdt_first AS r_dmdt_first\nFROM\n    object\n    INNER JOIN probability\n        ON object.oid = probability.oid\n        AND probability.class_name = 'SNII'\n        AND probability.classifier_name = 'lc_classifier'\n        AND probability.ranking = 1\n        AND probability.probability > 0.6\n    -- Join to magstat for g-band (fid=1)\n    INNER JOIN magstat AS g_magstat\n        ON object.oid = g_magstat.oid\n        AND g_magstat.fid = 1\n        AND g_magstat.dmdt_first > 0.5\n    -- Join to magstat for r-band (fid=2)\n    INNER JOIN magstat AS r_magstat\n        ON object.oid = r_magstat.oid\n        AND r_magstat.fid = 2\n        AND r_magstat.dmdt_first > 0.5\n    -- Join to detection for time-resolved photometry\n    INNER JOIN detection\n        ON object.oid = detection.oid\n        AND detection.mjd BETWEEN 58484 AND 59948 -- 2019-01-01 to 2022-12-31\nWHERE\n    object.ndet > 50\nORDER BY\n    object.oid,\n    detection.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3079, "completion_tokens": 419, "total_tokens": 3498, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc5d494819092d31d3741f51371", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "942617186306970f197dcd48ac11d5a2", "body": {"id": "chatcmpl-Bh8nJ7CZjFTvE14gZtcHnEzFqiXom", "object": "chat.completion", "created": 1749621609, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get detections for objects classified as SN II (probability > 0.6, ranking=1, classifier_name='lc_classifier')\n-- with ndet > 50, first/last detection in 2019-2022, and initial rise rate > 0.5 mag/day in BOTH g and r bands\n\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid,\n    ms_g.dmdt_first AS dmdt_first_g,\n    ms_r.dmdt_first AS dmdt_first_r\nFROM\n    -- Subquery: select oids that satisfy all object, probability, and magstat conditions\n    (\n        SELECT\n            o.oid\n        FROM\n            object o\n            INNER JOIN probability p ON o.oid = p.oid\n            -- Join magstat twice: once for g-band, once for r-band\n            INNER JOIN magstat ms_g ON o.oid = ms_g.oid AND ms_g.fid = 1 AND ms_g.dmdt_first > 0.5\n            INNER JOIN magstat ms_r ON o.oid = ms_r.oid AND ms_r.fid = 2 AND ms_r.dmdt_first > 0.5\n        WHERE\n            p.class_name = 'SNII'\n            AND p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.probability > 0.6\n            AND o.ndet > 50\n            AND o.lastmjd >= 58484   -- 2019-01-01\n            AND o.firstmjd <= 59948  -- 2022-12-31\n    ) qualified_oids\n    INNER JOIN detection d ON qualified_oids.oid = d.oid\n    -- Join magstat for g and r bands to get dmdt_first values for output\n    LEFT JOIN magstat ms_g ON d.oid = ms_g.oid AND ms_g.fid = 1\n    LEFT JOIN magstat ms_r ON d.oid = ms_r.oid AND ms_r.fid = 2\nORDER BY\n    d.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3073, "completion_tokens": 475, "total_tokens": 3548, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc5e2ac8190a66fa788aa19fe9e", "custom_id": "25-0", "response": {"status_code": 200, "request_id": "f1f2731735696ef00a93cc9c67796a3f", "body": {"id": "chatcmpl-Bh8nOCHjzaJ70HumelqNTiT9uDfR2", "object": "chat.completion", "created": 1749621614, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all objects within 10 degrees of each catalog position,\n-- with first detection in the first 7 days of February (MJD 59976.0 to 59982.0),\n-- and classified as SN by the stamp classifier with probability > 0.4 and ranking=1\n\nWITH catalog AS (\n    SELECT 'source_1' AS source_id, 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 'source_2', 174.21524897555543, 44.83789535222221\n)\nSELECT\n    catalog.source_id,\n    object.*,\n    probability.*\nFROM\n    catalog\n    INNER JOIN object\n        ON q3c_radial_query(object.meanra, object.meandec, catalog.ra, catalog.dec, 10.0)\n    INNER JOIN probability\n        ON object.oid = probability.oid\nWHERE\n    object.firstmjd BETWEEN 59976.0 AND 59982.0\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.class_name = 'SN'\n    AND probability.probability > 0.4\n    AND probability.ranking = 1\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2846, "completion_tokens": 261, "total_tokens": 3107, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc5f1b08190a7a30a018139eb59", "custom_id": "25-1", "response": {"status_code": 200, "request_id": "430e2c77cdbde806171846dc112efbc7", "body": {"id": "chatcmpl-Bh8nIju5TZ6MhSv5jUOXY9VkHHhut", "object": "chat.completion", "created": 1749621608, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the input catalog of positions\nWITH catalog AS (\n    SELECT 'source_1' AS source_id, 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 'source_2', 174.21524897555543, 44.83789535222221\n)\nSELECT \n    catalog.source_id,\n    object.*,\n    probability.*\nFROM \n    object\nINNER JOIN catalog\n    ON q3c_join(object.meanra, object.meandec, catalog.ra, catalog.dec, 10.0)\nINNER JOIN probability\n    ON object.oid = probability.oid\nWHERE\n    object.firstmjd BETWEEN 59976.0 AND 59982.0\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.class_name = 'SN'\n    AND probability.ranking = 1\n    AND probability.probability > 0.4\nORDER BY\n    catalog.source_id,\n    probability.probability DESC,\n    object.firstmjd\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2741, "completion_tokens": 224, "total_tokens": 2965, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc602dc819086783acecef03808", "custom_id": "18-0", "response": {"status_code": 200, "request_id": "00459eb5306f86b236530b103e339091", "body": {"id": "chatcmpl-Bh8nIkhP0GnXfdPdAWJE2IneANwRY", "object": "chat.completion", "created": 1749621608, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve all probabilities for sources classified as AGN, QSO, or Blazar\n-- by the light curve classifier, with specific detection and probability thresholds\n\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_mean_corr,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.probability <= 0.95\n\nUNION\n\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_mean_corr,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'QSO'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.probability <= 0.95\n\nUNION\n\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_mean_corr,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'Blazar'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.probability <= 0.8;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2840, "completion_tokens": 451, "total_tokens": 3291, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc612c481909927330d455f12d3", "custom_id": "18-1", "response": {"status_code": 200, "request_id": "a647561660744da891da7331889ee262", "body": {"id": "chatcmpl-Bh8nOjrwgVcT1qw5zmS30l9zd1drw", "object": "chat.completion", "created": 1749621614, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve all probabilities for sources classified as AGN, QSO, or Blazar\n-- by the light curve classifier, with specific detection and probability thresholds\n\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_mean_corr,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.probability <= 0.95\n\nUNION\n\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_mean_corr,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.probability <= 0.95\n\nUNION\n\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_mean_corr,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.probability <= 0.8;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2776, "completion_tokens": 451, "total_tokens": 3227, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc6210c8190b946dc2d4510bb30", "custom_id": "11-0", "response": {"status_code": 200, "request_id": "1687c12804b77b1217f550b78610fb20", "body": {"id": "chatcmpl-Bh8nJAozmn0EBTivnQLHlzebUbQe6", "object": "chat.completion", "created": 1749621609, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.g_r_max, \n    magstat.magmax, \n    magstat.fid\nFROM \n    probability\nINNER JOIN object ON probability.oid = object.oid\nINNER JOIN magstat ON object.oid = magstat.oid\nWHERE \n    probability.class_name = 'SNIa'\n    AND probability.ranking = 1\n    AND probability.classifier_name = 'lc_classifier'\n    AND object.firstmjd >= 60188.0\n    AND object.firstmjd <= 60217.0\n    AND object.g_r_max < 1\n    AND magstat.magmax > 19\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2653, "completion_tokens": 142, "total_tokens": 2795, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc634208190a4e5b2574131062c", "custom_id": "11-1", "response": {"status_code": 200, "request_id": "ad28d3a51f6b8609511c83b80b0377ff", "body": {"id": "chatcmpl-Bh8nT93bKGp14janQjvgrFBsKCaU3", "object": "chat.completion", "created": 1749621619, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.g_r_max, \n    magstat.magmax, \n    magstat.fid\nFROM \n    object\nINNER JOIN probability \n    ON object.oid = probability.oid\nINNER JOIN magstat \n    ON object.oid = magstat.oid\nWHERE \n    probability.class_name = 'SNIa'\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND object.firstmjd >= 60188.0\n    AND object.firstmjd <= 60217.0\n    AND object.g_r_max < 1\n    AND magstat.magmax > 19\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2780, "completion_tokens": 146, "total_tokens": 2926, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc76e80819083031f2dbe2013bf", "custom_id": "9-0", "response": {"status_code": 200, "request_id": "2ee1acfc98819042daf211950d3f810d", "body": {"id": "chatcmpl-Bh8nKblFvyedwemZoWvnrPxRW9vkG", "object": "chat.completion", "created": 1749621610, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT\n    object.oid,\n    feature.value,\n    feature.name,\n    feature.version,\n    object.meanra,\n    object.meandec,\n    probability.oid AS source_identifier,\n    q3c_dist(object.meanra, object.meandec, 39.97, -1.5768) AS dist\nFROM\n    object\nINNER JOIN feature\n    ON object.oid = feature.oid\n    AND feature.name = 'sgscore1'\n    AND feature.value < 0.3\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.ranking = 1\n    AND probability.class_name NOT IN ('asteroid', 'bogus')\nWHERE\n    object.firstmjd >= 60126.0\n    AND object.firstmjd < 60156.0\n    AND q3c_radial_query(object.meanra, object.meandec, 39.97, -1.5768, 16.16667)\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3516, "completion_tokens": 220, "total_tokens": 3736, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc781d081909d8858d78763696c", "custom_id": "9-1", "response": {"status_code": 200, "request_id": "0faee638e6f3650baf31ae2da397cdff", "body": {"id": "chatcmpl-Bh8nOCwJCcdSAA9c10Qi6zj0mmqLJ", "object": "chat.completion", "created": 1749621614, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid,\n    feature.value,\n    feature.name,\n    probability.version,\n    object.meanra,\n    object.meandec,\n    object.oid AS source_identifier,\n    q3c_dist(object.meanra, object.meandec, 39.97, -1.5768) AS dist\nFROM \n    object\nINNER JOIN feature\n    ON object.oid = feature.oid\n    AND feature.name = 'sgscore1'\n    AND feature.value < 0.3\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.ranking = 1\n    AND probability.class_name NOT IN ('asteroid', 'bogus')\nWHERE\n    object.firstmjd >= 60126.0\n    AND object.firstmjd < 60156.0\n    AND q3c_radial_query(object.meanra, object.meandec, 39.97, -1.5768, 16.16667)\nORDER BY\n    dist ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3503, "completion_tokens": 226, "total_tokens": 3729, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc792b48190bb1b73bd80babacf", "custom_id": "5-0", "response": {"status_code": 200, "request_id": "b781f320e80df9add9fc327da5c91b05", "body": {"id": "chatcmpl-Bh8nUgElUurnCRvHI1MVzFJPRSHFq", "object": "chat.completion", "created": 1749621620, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY]\nSELECT\n    o.oid,\n    d.candid,\n    f.name,\n    f.value,\n    d.magpsf,\n    d.sigmapsf,\n    f.fid AS feature_fid,\n    d.mjd\nFROM\n    (\n        -- Subquery: Get oids of SNII with prob > 0.6, ranking=1, classifier_name='lc_classifier', ndet>50\n        SELECT\n            obj.oid\n        FROM\n            object obj\n            INNER JOIN probability p ON obj.oid = p.oid\n        WHERE\n            p.class_name = 'SNII'\n            AND p.probability > 0.6\n            AND p.ranking = 1\n            AND p.classifier_name = 'lc_classifier'\n            AND obj.ndet > 50\n            AND obj.oid IN (\n                -- Subquery: oids with delta_mag_fid > 2 in g-band (fid=1)\n                SELECT\n                    f1.oid\n                FROM\n                    feature f1\n                WHERE\n                    f1.name = 'delta_mag_fid'\n                    AND f1.fid = 1\n                    AND f1.value > 2\n            )\n    ) filtered_oids\n    INNER JOIN object o ON filtered_oids.oid = o.oid\n    INNER JOIN detection d ON o.oid = d.oid\n    INNER JOIN feature f ON o.oid = f.oid\nORDER BY\n    o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3363, "completion_tokens": 315, "total_tokens": 3678, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc7a28c81908f5d079ea3276344", "custom_id": "5-1", "response": {"status_code": 200, "request_id": "24b2597554781d77ffac1fc901f6ec09", "body": {"id": "chatcmpl-Bh8nMeCSdJEZtYeQoCGnZSdjcu3ib", "object": "chat.completion", "created": 1749621612, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery 1: Get oids of objects classified as SNII with probability > 0.6, ranking=1, classifier_name='lc_classifier', and ndet > 50\nWITH sn2_oids AS (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'SNII'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND o.ndet > 50\n),\n-- Subquery 2: Get oids with delta_mag_fid > 2 in g-band (fid=1)\ngband_delta_oids AS (\n    SELECT f.oid\n    FROM feature f\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 1\n      AND f.value > 2\n),\n-- INTERSECT: Only oids that satisfy both conditions\nselected_oids AS (\n    SELECT oid FROM sn2_oids\n    INTERSECT\n    SELECT oid FROM gband_delta_oids\n)\n-- Final selection: Join with feature and detection tables, output required columns\nSELECT\n    o.oid,\n    d.candid,\n    f.name,\n    f.value,\n    f.fid AS feature_fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf\nFROM selected_oids o\nINNER JOIN feature f ON o.oid = f.oid\nINNER JOIN detection d ON o.oid = d.oid\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3413, "completion_tokens": 342, "total_tokens": 3755, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc7b2ac819087d2009f1535725c", "custom_id": "0-0", "response": {"status_code": 200, "request_id": "8e4825cd3c50e651541e6709e2db0ed1", "body": {"id": "chatcmpl-Bh8nPfEHzVt8zL1imsfXevtMgxYg0", "object": "chat.completion", "created": 1749621615, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter probability for YSO, probability > 0.7, ranking = 1, classifier_name = 'lc_classifier'\nWITH yso_prob AS (\n    SELECT oid, probability, class_name, classifier_name, classifier_version\n    FROM probability\n    WHERE class_name = 'YSO'\n      AND probability > 0.7\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Filter feature for 'Period_band', value between 3 and 10, INNER JOIN with yso_prob oids\nperiod_feature AS (\n    SELECT f.oid, f.name, f.value, f.fid, f.version\n    FROM feature f\n    INNER JOIN yso_prob yp ON f.oid = yp.oid\n    WHERE f.name = 'Period_band'\n      AND f.value BETWEEN 3 AND 10\n),\n\n-- Step 3: Filter feature for 'Amplitude', value > 0.5, INNER JOIN with yso_prob oids\namplitude_feature AS (\n    SELECT f.oid, f.name, f.value, f.fid, f.version\n    FROM feature f\n    INNER JOIN yso_prob yp ON f.oid = yp.oid\n    WHERE f.name = 'Amplitude'\n      AND f.value > 0.5\n),\n\n-- Step 4: INTERSECT oids from period_feature and amplitude_feature to get objects satisfying both feature conditions\noids_both_features AS (\n    SELECT oid FROM period_feature\n    INTERSECT\n    SELECT oid FROM amplitude_feature\n),\n\n-- Step 5: UNION the feature rows for 'Period_band' and 'Amplitude' for the INTERSECT oids\nselected_features AS (\n    SELECT * FROM period_feature WHERE oid IN (SELECT oid FROM oids_both_features)\n    UNION ALL\n    SELECT * FROM amplitude_feature WHERE oid IN (SELECT oid FROM oids_both_features)\n)\n\n-- Step 6: INNER JOIN the feature rows with the probability information from yso_prob\nSELECT\n    sf.oid,\n    yp.probability,\n    sf.name,\n    sf.value,\n    sf.fid,\n    sf.version\nFROM selected_features sf\nINNER JOIN yso_prob yp ON sf.oid = yp.oid\nORDER BY yp.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3213, "completion_tokens": 479, "total_tokens": 3692, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc7c0e48190a75afb948f245f48", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "c4728711415866930dc93af29ea9e278", "body": {"id": "chatcmpl-Bh8nL2ntqqm8yY6iP5LMyQoaNnCYD", "object": "chat.completion", "created": 1749621611, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step I: Sub-query for probability table with YSO, ranking=1, classifier_name='lc_classifier', probability>0.7\nWITH prob_ysos AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'YSO'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.7\n),\n\n-- Step II: Sub-query for Period_band feature\nperiod_feature AS (\n    SELECT f.oid, f.value, f.name, f.fid, f.version\n    FROM feature f\n    INNER JOIN prob_ysos p ON f.oid = p.oid\n    WHERE f.name = 'Period_band'\n      AND f.value BETWEEN 3 AND 10\n),\n\n-- Step II: Sub-query for Amplitude feature\namplitude_feature AS (\n    SELECT f.oid, f.value, f.name, f.fid, f.version\n    FROM feature f\n    INNER JOIN prob_ysos p ON f.oid = p.oid\n    WHERE f.name = 'Amplitude'\n      AND f.value > 0.5\n),\n\n-- Step III: UNION of both features\nunion_features AS (\n    SELECT * FROM period_feature\n    UNION\n    SELECT * FROM amplitude_feature\n),\n\n-- Step IV: INTERSECT to get oids that satisfy both feature conditions\nintersect_oids AS (\n    SELECT oid FROM period_feature\n    INTERSECT\n    SELECT oid FROM amplitude_feature\n)\n\n-- Step V, VI, VII, VIII, IX: Final selection, join with probability, select required columns, order by probability\nSELECT\n    uf.oid,\n    p.probability,\n    uf.value,\n    uf.name,\n    uf.fid,\n    uf.version\nFROM union_features uf\nINNER JOIN intersect_oids io ON uf.oid = io.oid\nINNER JOIN prob_ysos p ON uf.oid = p.oid\nORDER BY p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3129, "completion_tokens": 413, "total_tokens": 3542, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc7d14c81908891f11e1aa6d30c", "custom_id": "38-1", "response": {"status_code": 200, "request_id": "1d7b3c09dbfc21671ed93174b978a019", "body": {"id": "chatcmpl-Bh8nMDO0aDyF4STSGciab6173BOHR", "object": "chat.completion", "created": 1749621612, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select top 1000 AGN and top 1000 QSO candidates by probability, join with object table, and filter by ndet between 30 and 200\nSELECT *\nFROM (\n    -- Top 1000 AGN candidates\n    SELECT p.*, o.*\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n\n    UNION ALL\n\n    -- Top 1000 QSO candidates\n    SELECT p.*, o.*\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.probability > 0.5\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n) AS combined\nWHERE combined.ndet BETWEEN 30 AND 200\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2734, "completion_tokens": 246, "total_tokens": 2980, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc7e36c8190b0654fdb4a5da7aa", "custom_id": "31-0", "response": {"status_code": 200, "request_id": "8bd169288d1342cfeb31ccc89f483892", "body": {"id": "chatcmpl-Bh8nNTfQKOOH4Q0tDYRnIuL4DQKSK", "object": "chat.completion", "created": 1749621613, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to return galactic coordinates, all feature columns, class name, and object identifiers\n-- for objects classified by the light curve classifier and first detected between Feb 1 and 2, 2023\n\nSELECT\n    object.oid,\n    probability.class_name,\n    feature.name AS feature_name,\n    feature.value AS feature_value\nFROM\n    object\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\nINNER JOIN feature\n    ON object.oid = feature.oid\nWHERE\n    object.firstmjd >= 59976.0\n    AND object.firstmjd < 59978.0\n-- This will include all features (including 'gal_l' and 'gal_b') for each object\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2859, "completion_tokens": 175, "total_tokens": 3034, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc7f0588190bc3317f9bb07ad3f", "custom_id": "31-1", "response": {"status_code": 200, "request_id": "7dd89243ea4838fd0e2f27ed89eac6ea", "body": {"id": "chatcmpl-Bh8nSxYvZkJhaqzLDiBVoOxlnrNJ1", "object": "chat.completion", "created": 1749621618, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to return galactic coordinates, all feature columns, class name, and object identifiers\nSELECT\n    o.oid,\n    -- Galactic longitude and latitude as separate columns using filtered aggregation\n    MAX(CASE WHEN f.name = 'gal_l' THEN f.value END) AS gal_l,\n    MAX(CASE WHEN f.name = 'gal_b' THEN f.value END) AS gal_b,\n    f.name,\n    f.value,\n    f.fid,\n    f.version,\n    p.class_name\nFROM\n    object o\nINNER JOIN probability p\n    ON o.oid = p.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\nINNER JOIN feature f\n    ON o.oid = f.oid\nWHERE\n    o.firstmjd >= 59976.0\n    AND o.firstmjd < 59978.0\nGROUP BY\n    o.oid, f.name, f.value, f.fid, f.version, p.class_name\nORDER BY\n    o.oid, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2825, "completion_tokens": 226, "total_tokens": 3051, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc7ffc88190b14b17ef4cda6d4a", "custom_id": "6-0", "response": {"status_code": 200, "request_id": "89d5eafead2245216acea7fd2aefc560", "body": {"id": "chatcmpl-Bh8nnfonI5C8jkHr7j4H0bf1GRiAK", "object": "chat.completion", "created": 1749621639, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select SN II objects (probability > 0.6, ranking=1, lc_classifier) with required rise rates, duration, and ndet, and get their detections in 2019-2022\nSELECT\n    object.oid,\n    detection.candid,\n    detection.magpsf,\n    detection.sigmapsf,\n    detection.fid AS f_id,\n    detection.mjd\nFROM\n    object\n    INNER JOIN probability\n        ON object.oid = probability.oid\n        AND probability.class_name = 'SNII'\n        AND probability.classifier_name = 'lc_classifier'\n        AND probability.ranking = 1\n        AND probability.probability > 0.6\n    -- Ensure ndet > 30\n    INNER JOIN (\n        -- Subquery to get oids with dmdt_first > 0.5 in both g and r, and r-band duration >= 100 days\n        SELECT\n            ms_g.oid\n        FROM\n            magstat ms_g\n            INNER JOIN magstat ms_r\n                ON ms_g.oid = ms_r.oid\n        WHERE\n            ms_g.fid = 1\n            AND ms_g.dmdt_first > 0.5\n            AND ms_r.fid = 2\n            AND ms_r.dmdt_first > 0.5\n            AND (ms_r.lastmjd - ms_r.firstmjd) >= 100\n        GROUP BY\n            ms_g.oid\n    ) AS valid_oids\n        ON object.oid = valid_oids.oid\n    INNER JOIN detection\n        ON object.oid = detection.oid\n        AND detection.mjd >= 58484.0\n        AND detection.mjd <= 59944.0\nWHERE\n    object.ndet > 30\nORDER BY\n    object.oid,\n    detection.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3010, "completion_tokens": 392, "total_tokens": 3402, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc8105c81909d467b5d65152b3b", "custom_id": "6-1", "response": {"status_code": 200, "request_id": "fbaf8ce0f4fe1162cd922c912b8de065", "body": {"id": "chatcmpl-Bh8nirAhdv4DR2rqeAqMBWrv5PSwr", "object": "chat.completion", "created": 1749621634, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select required columns for SN II objects with specified conditions\nSELECT\n    object.oid,\n    detection.candid,\n    detection.magpsf,\n    detection.magap,\n    detection.magapbig,\n    detection.magpsf_corr,\n    detection.sigmapsf,\n    detection.sigmagap,\n    detection.sigmagapbig,\n    detection.sigmapsf_corr,\n    detection.sigmapsf_corr_ext,\n    detection.fid AS f_id,\n    detection.mjd\nFROM\n    object\n    INNER JOIN probability\n        ON object.oid = probability.oid\n    -- Only select objects classified as SNII with probability > 0.6, using default classifier and ranking\n    INNER JOIN (\n        -- Subquery to select oids that satisfy magstat conditions in both g and r bands\n        SELECT\n            ms_r.oid\n        FROM\n            magstat ms_g\n            INNER JOIN magstat ms_r\n                ON ms_g.oid = ms_r.oid\n        WHERE\n            ms_g.fid = 1\n            AND ms_r.fid = 2\n            AND ms_g.dmdt_first > 0.5\n            AND ms_r.dmdt_first > 0.5\n            AND (ms_r.lastmjd - ms_r.firstmjd) >= 100\n            AND ms_r.ndet > 30\n        GROUP BY\n            ms_r.oid\n    ) AS magstat_filter\n        ON object.oid = magstat_filter.oid\n    INNER JOIN detection\n        ON object.oid = detection.oid\nWHERE\n    probability.class_name = 'SNII'\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.6\n    AND object.firstmjd >= 58484.0\n    AND object.lastmjd <= 59944.0\nORDER BY\n    detection.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3068, "completion_tokens": 404, "total_tokens": 3472, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc82008819080ec16a8e2a62ded", "custom_id": "109-0", "response": {"status_code": 200, "request_id": "de7b61db0b1e20acbce8c59243d1a3fc", "body": {"id": "chatcmpl-Bh8nimXsHnm9CpXEvAnmCoQoTXE5M", "object": "chat.completion", "created": 1749621634, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 10 ZTF objects with 'LinearTrend' > 5 and deltajd > 1,\n-- returning requested columns from object, probability, and feature tables\nSELECT\n    object.oid,\n    object.ndet,\n    probability.classifier_version,\n    probability.class_name,\n    probability.probability,\n    feature.value,\n    feature.fid\nFROM\n    feature\nINNER JOIN object ON feature.oid = object.oid\nINNER JOIN probability ON object.oid = probability.oid\nWHERE\n    feature.name = 'LinearTrend'\n    AND feature.value > 5\n    AND object.deltajd > 1\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2826, "completion_tokens": 162, "total_tokens": 2988, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc82f64819090db213d277e9027", "custom_id": "109-1", "response": {"status_code": 200, "request_id": "8ba234850b43c0bbc98647fe6cd68de1", "body": {"id": "chatcmpl-Bh8nk8w3UgSYOWKoa6IU9xogZHplG", "object": "chat.completion", "created": 1749621636, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT\n    object.oid,\n    object.ndet,\n    probability.classifier_version,\n    probability.class_name,\n    probability.probability,\n    feature.value,\n    feature.fid\nFROM feature\nINNER JOIN object ON feature.oid = object.oid\nINNER JOIN probability ON object.oid = probability.oid\nWHERE feature.name = 'LinearTrend'\n  AND feature.value > 5\n  AND object.deltajd > 1\n  AND probability.ranking = 1\n  AND probability.classifier_name = 'lc_classifier'\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2770, "completion_tokens": 120, "total_tokens": 2890, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc8423481908cf9614318a99467", "custom_id": "95-0", "response": {"status_code": 200, "request_id": "cc611bdc78d5b543954536204d493e03", "body": {"id": "chatcmpl-Bh8ngAwe6OuFlZkoSfw5fhYZtBLTW", "object": "chat.completion", "created": 1749621632, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH ztf_ids AS (\n    SELECT unnest(ARRAY['ZTF19aazhdoy', 'ZTF17aaaqqtd']) AS oid\n),\nxmatch_filtered AS (\n    SELECT x.oid, x.oid_catalog, x.dist\n    FROM xmatch x\n    INNER JOIN ztf_ids z ON x.oid = z.oid\n),\nfeature_filtered AS (\n    SELECT f.oid, f.name, f.value\n    FROM feature f\n    INNER JOIN ztf_ids z ON f.oid = z.oid\n    WHERE f.name IN ('W1-W2', 'g-W2', 'r-W2')\n      AND f.version = 'lc_classifier_1.2.1-P'\n)\nSELECT\n    x.oid,\n    x.oid_catalog,\n    x.dist,\n    f.name,\n    f.value\nFROM xmatch_filtered x\nINNER JOIN feature_filtered f ON x.oid = f.oid\nORDER BY x.oid_catalog, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3145, "completion_tokens": 209, "total_tokens": 3354, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc853148190afd383b2810243fd", "custom_id": "95-1", "response": {"status_code": 200, "request_id": "350efa866c5777bdea8c4481eb495fe7", "body": {"id": "chatcmpl-Bh8nlhNpWXzY6AzkyUteZ9eZjwSuc", "object": "chat.completion", "created": 1749621637, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve xmatch and feature information for the specified ZTF objects and features\nSELECT\n    x.oid,                -- ZTF identifier\n    x.oid_catalog,        -- Catalog object identifier\n    x.dist,               -- Distance between counterparts\n    f.name,               -- Feature name\n    f.value               -- Feature value\nFROM\n    xmatch x\nINNER JOIN\n    feature f\n    ON x.oid = f.oid\nWHERE\n    x.oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n    AND f.oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n    AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY\n    x.oid_catalog,\n    f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2730, "completion_tokens": 193, "total_tokens": 2923, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc861d88190abfe0a1e410281c4", "custom_id": "85-0", "response": {"status_code": 200, "request_id": "cbac3c643acc2a5bcf5d48c4769c913c", "body": {"id": "chatcmpl-Bh8nlrGofvyLJX9R2UhfXP8U4Yb6D", "object": "chat.completion", "created": 1749621637, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT\n    detection.mjd,\n    detection.isdiffpos,\n    detection.magpsf,\n    detection.sigmapsf,\n    dataquality.*\nFROM\n    detection\nINNER JOIN\n    dataquality\n    ON detection.candid = dataquality.candid AND detection.oid = dataquality.oid\nWHERE\n    detection.oid = 'ZTF20actqnhg'\nORDER BY\n    detection.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2541, "completion_tokens": 90, "total_tokens": 2631, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc873b8819096716d08e127ada3", "custom_id": "85-1", "response": {"status_code": 200, "request_id": "f59b7c8ffb760e36ba367b9679035573", "body": {"id": "chatcmpl-Bh8nmMCdDxnhl2iY3bv5HU6aXNEEP", "object": "chat.completion", "created": 1749621638, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT\n    detection.mjd,\n    detection.isdiffpos,\n    detection.magpsf,\n    detection.sigmapsf,\n    dataquality.*\nFROM\n    detection\nINNER JOIN\n    dataquality\n    ON detection.candid = dataquality.candid\n    AND detection.oid = dataquality.oid\nWHERE\n    detection.oid = 'ZTF20actqnhg'\nORDER BY\n    detection.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2663, "completion_tokens": 92, "total_tokens": 2755, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc88414819093a0425183923ec4", "custom_id": "98-0", "response": {"status_code": 200, "request_id": "5d3bbb5058d133905f0e5e8a7be58f5d", "body": {"id": "chatcmpl-Bh8ngASDV4gVyEcdM5E20Ys2RYICK", "object": "chat.completion", "created": 1749621632, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 200 distinct ZTF objects classified as QSO with probability > 0.7 by the light curve classifier,\n-- and return all columns from the xmatch and allwise tables for those objects.\n\nSELECT xmatch.*, allwise.*\nFROM (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE class_name = 'QSO'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.7\n    LIMIT 200\n) AS selected_oids\nINNER JOIN xmatch ON xmatch.oid = selected_oids.oid\nINNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2653, "completion_tokens": 144, "total_tokens": 2797, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc8952c819095139b41f0bac73f", "custom_id": "98-1", "response": {"status_code": 200, "request_id": "2b8f8a951d99703a67452bb1f4b71400", "body": {"id": "chatcmpl-Bh8nmBhVXXnUe5CnX57rkSp8Xpkhm", "object": "chat.completion", "created": 1749621638, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from xmatch and allwise for up to 200 distinct ZTF objects\nSELECT xmatch.*, allwise.*\nFROM (\n    SELECT DISTINCT ON (probability.oid) probability.oid\n    FROM probability\n    WHERE probability.class_name = 'QSO'\n      AND probability.classifier_name = 'lc_classifier'\n      AND probability.ranking = 1\n      AND probability.probability > 0.7\n    ORDER BY probability.oid\n    LIMIT 200\n) AS filtered\nINNER JOIN xmatch ON xmatch.oid = filtered.oid\nINNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2607, "completion_tokens": 140, "total_tokens": 2747, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc8a39c81908c2a335b08378916", "custom_id": "87-0", "response": {"status_code": 200, "request_id": "ee9f69fbd6403b847bc7913e4d37259a", "body": {"id": "chatcmpl-Bh8nnZy5KcIQFFLUxtUsQI2NkUHGr", "object": "chat.completion", "created": 1749621639, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    probability.*, \n    gaia_ztf.*\nFROM \n    probability\nINNER JOIN \n    gaia_ztf\nON \n    probability.oid = gaia_ztf.oid\nWHERE \n    probability.ranking = 1\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.classifier_version = 'hierarchical_rf_1.1.0'\n    AND probability.class_name IN ('LPV', 'E')\n    AND probability.probability > 0.7\n    AND gaia_ztf.unique1 = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2593, "completion_tokens": 127, "total_tokens": 2720, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc8b4a4819096c29ee920de3ebc", "custom_id": "87-1", "response": {"status_code": 200, "request_id": "d001d6f30a7731a73de7dd84616b7f4e", "body": {"id": "chatcmpl-Bh8npIYT9O8ieQd7fGpbpAKzhlnPq", "object": "chat.completion", "created": 1749621641, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    probability.*, \n    gaia_ztf.*\nFROM \n    probability\nINNER JOIN \n    gaia_ztf ON probability.oid = gaia_ztf.oid\nWHERE \n    probability.class_name IN ('LPV', 'E')\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.classifier_version = 'hierarchical_rf_1.1.0'\n    AND probability.probability > 0.7\n    AND probability.ranking = 1\n    AND gaia_ztf.unique1 = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2638, "completion_tokens": 124, "total_tokens": 2762, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc8c2fc8190ae3f53c0351887a3", "custom_id": "101-0", "response": {"status_code": 200, "request_id": "5bb753100c276e11483903d1862f4cdd", "body": {"id": "chatcmpl-Bh8nipVNL98fk1J2JGXOJLcAa2uAX", "object": "chat.completion", "created": 1749621634, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with LPV probability > 0.5 and WISE W1 magnitude between 7 and 8\nSELECT \n    probability.*, \n    xmatch.*, \n    allwise.*\nFROM \n    probability\nINNER JOIN \n    xmatch ON probability.oid = xmatch.oid\nINNER JOIN \n    allwise ON xmatch.oid_catalog = allwise.oid_catalog\nWHERE \n    probability.class_name = 'LPV'\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.5\n    AND xmatch.catid = 'ALLWISE'\n    AND allwise.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2786, "completion_tokens": 159, "total_tokens": 2945, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc8d458819086a3e79e4b0946f2", "custom_id": "101-1", "response": {"status_code": 200, "request_id": "80d96cf93c3aba90f6a3b422986f5a79", "body": {"id": "chatcmpl-Bh8njrasjHYMohVbhNlBFQtjIItlz", "object": "chat.completion", "created": 1749621635, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects classified as LPV with probability > 0.5 (lc_classifier, ranking=1)\n-- Cross-matched to ALLWISE, with W1 magnitude between 7 and 8\n-- Return all columns from probability, xmatch, and allwise, limit 100 rows\n\nSELECT\n    probability.*,\n    xmatch.*,\n    allwise.*\nFROM\n    probability\nINNER JOIN xmatch\n    ON probability.oid = xmatch.oid\n    AND xmatch.catid = 'ALLWISE'\nINNER JOIN allwise\n    ON xmatch.oid_catalog = allwise.oid_catalog\nWHERE\n    probability.class_name = 'LPV'\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.probability > 0.5\n    AND allwise.w1mpro >= 7\n    AND allwise.w1mpro <= 8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3102, "completion_tokens": 203, "total_tokens": 3305, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc8e3c48190825aa4d9c63eed5a", "custom_id": "105-0", "response": {"status_code": 200, "request_id": "773009339e1feb98b9da6d5530dc7198", "body": {"id": "chatcmpl-Bh8nmXrhKwkhIl6Yx0mtzjUm4Sf4u", "object": "chat.completion", "created": 1749621638, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 50 unique ZTF objects with AGN probability > 0.7, PS1 distance < 2 arcsec,\n-- and PS1/SExtractor star/galaxy score difference < 0.5, returning required columns for each detection\nWITH selected_objects AS (\n    SELECT\n        p.oid,\n        p.probability\n    FROM\n        probability p\n        INNER JOIN ps1_ztf ps1 ON p.oid = ps1.oid\n    WHERE\n        p.class_name = 'AGN'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.classifier_version = 'hierarchical_rf_1.1.0'\n        AND p.probability > 0.7\n        AND p.ranking = 1\n        AND ps1.distpsnr1 < 2\n    LIMIT 50\n)\nSELECT\n    so.oid,                        -- ZTF identifier\n    so.probability,                -- AGN probability\n    d.candid,                      -- candidate identifier\n    d.fid,                         -- filter identifier\n    d.sextractor_chi2,             -- reduced chi-square (from SExtractor)\n    d.sextractor_sgscore,          -- SExtractor star/galaxy score\n    ps1.objectidps1,               -- PS1 source identifier\n    ps1.sgscore1,                  -- PS1 star/galaxy score\n    ps1.distpsnr1                  -- PS1 distance\nFROM\n    selected_objects so\n    INNER JOIN detection d ON so.oid = d.oid\n    INNER JOIN ps1_ztf ps1 ON so.oid = ps1.oid\nWHERE\n    ABS(ps1.sgscore1 - d.sextractor_sgscore) < 0.5\nORDER BY\n    so.probability DESC, so.oid, d.candid\n;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3090, "completion_tokens": 392, "total_tokens": 3482, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc8f0048190814536f9a8da55c5", "custom_id": "105-1", "response": {"status_code": 200, "request_id": "a6dab368467b5794503dbc61fcc3097e", "body": {"id": "chatcmpl-Bh8nsEHOIoQIj2wSU5zrSnJfKi1Zh", "object": "chat.completion", "created": 1749621644, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [Step 1] Subquery: Select oids with AGN probability > 0.7, classifier version 'hierarchical_rf_1.1.0', ranking=1, classifier_name='lc_classifier'\nWITH agn_prob AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n      AND probability > 0.7\n      AND ranking = 1\n),\n\n-- [Step 2] Join with ps1_ztf for distance and sgscore1, filter distpsnr1 < 2\nagn_ps1 AS (\n    SELECT ap.oid, ap.probability, pz.objectidps1, pz.sgscore1, pz.distpsnr1\n    FROM agn_prob ap\n    INNER JOIN ps1_ztf pz ON ap.oid = pz.oid\n    WHERE pz.distpsnr1 < 2\n),\n\n-- [Step 3] Limit to 50 unique oids\nlimited_agn_ps1 AS (\n    SELECT *\n    FROM agn_ps1\n    ORDER BY probability DESC\n    LIMIT 50\n),\n\n-- [Step 4] For each detection, get chi2red and sgscore from feature table\ndetection_features AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        -- chi2red feature\n        MAX(CASE WHEN f.feature = 'chi2red' THEN f.value::DOUBLE PRECISION END) AS chi2red,\n        -- sgscore feature\n        MAX(CASE WHEN f.feature = 'sgscore' THEN f.value::DOUBLE PRECISION END) AS sgscore\n    FROM detection d\n    INNER JOIN feature f ON d.candid = f.candid\n    WHERE f.feature IN ('chi2red', 'sgscore')\n    GROUP BY d.oid, d.candid, d.fid\n)\n\n-- [Step 5] Final selection: join all, filter on |sgscore1 - sgscore| < 0.5\nSELECT\n    lap.oid,                -- ZTF identifier\n    lap.probability,        -- AGN probability\n    df.candid,              -- candidate identifier\n    df.fid,                 -- filter identifier\n    df.chi2red,             -- reduced chi-square\n    df.sgscore,             -- SExtractor star/galaxy score\n    lap.objectidps1,        -- PS1 object identifier\n    lap.sgscore1,           -- PS1 star/galaxy score\n    lap.distpsnr1           -- distance to nearest PS1 source\nFROM limited_agn_ps1 lap\nINNER JOIN detection_features df ON lap.oid = df.oid\nWHERE ABS(lap.sgscore1 - df.sgscore) < 0.5\nORDER BY lap.probability DESC, lap.oid, df.candid\n```\n", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3405, "completion_tokens": 624, "total_tokens": 4029, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc900a88190808d45c10a110f66", "custom_id": "86-0", "response": {"status_code": 200, "request_id": "b31b95f06032f1bb3baf1e42b3f03136", "body": {"id": "chatcmpl-Bh8no8eoGkeDKElaSdNOpT7kEAVRb", "object": "chat.completion", "created": 1749621640, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    probability.*, \n    ps1_ztf.*\nFROM \n    probability\nINNER JOIN \n    ps1_ztf ON probability.oid = ps1_ztf.oid\nWHERE \n    probability.ranking = 1 -- only the most likely probability per object\n    AND probability.classifier_name = 'lc_classifier' -- light curve classifier\n    AND probability.classifier_version = 'hierarchical_rf_1.1.0' -- specific classifier version\n    AND probability.class_name IN ('CEP', 'DSCT', 'RRL') -- Cepheid, delta Scuti, RR Lyra\n    AND probability.probability > 0.6 -- probability threshold\n    AND ps1_ztf.sgscore1 > 0.8 -- PS1 star/galaxy score threshold\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2655, "completion_tokens": 174, "total_tokens": 2829, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc90e3c81908707e2d2a2036cab", "custom_id": "86-1", "response": {"status_code": 200, "request_id": "524f139ce080a15e44e2ed48e71fc0ed", "body": {"id": "chatcmpl-Bh8ntDqX12VYz23qS7rGpovhPjpsi", "object": "chat.completion", "created": 1749621645, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    probability.*, \n    ps1_ztf.*\nFROM \n    probability\nINNER JOIN \n    ps1_ztf ON probability.oid = ps1_ztf.oid\nWHERE \n    probability.ranking = 1\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.classifier_version = 'hierarchical_rf_1.1.0'\n    AND probability.class_name IN ('CEP', 'DSCT', 'RRL')\n    AND probability.probability > 0.6\n    AND ps1_ztf.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2600, "completion_tokens": 132, "total_tokens": 2732, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc91e748190bed5efb3361fa6f2", "custom_id": "97-0", "response": {"status_code": 200, "request_id": "8cca718f14b262a1046483268c264464", "body": {"id": "chatcmpl-Bh8npeGyd9XWcm8tULM0n6h1tYhm0", "object": "chat.completion", "created": 1749621641, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 50 ZTF objects with high AGN probability in the stamp classifier and high LPV probability in the light curve classifier\nWITH stamp_agn AS (\n    SELECT\n        oid,\n        probability AS prob_stamp_agn\n    FROM probability\n    WHERE\n        class_name = 'AGN'\n        AND classifier_name = 'stamp_classifier'\n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND probability > 0.6\n),\nlc_lpv AS (\n    SELECT\n        oid,\n        probability AS prob_lc_lpv\n    FROM probability\n    WHERE\n        class_name = 'LPV'\n        AND classifier_name = 'lc_classifier'\n        AND ranking = 1\n        AND probability > 0.7\n)\nSELECT\n    s.oid,\n    s.prob_stamp_agn,\n    l.prob_lc_lpv\nFROM stamp_agn s\nINNER JOIN lc_lpv l ON s.oid = l.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2873, "completion_tokens": 211, "total_tokens": 3084, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc92c1c8190a6f4c4906b90d197", "custom_id": "97-1", "response": {"status_code": 200, "request_id": "3bde9071cc79932169314c89c92de324", "body": {"id": "chatcmpl-Bh8nsSGF0Tmlg4lC4Hfxy11KV5fqO", "object": "chat.completion", "created": 1749621644, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery for AGN probability in stamp classifier version 'stamp_classifier_1.0.4'\nWITH stamp_agn AS (\n    SELECT\n        oid,\n        probability AS prob_stamp_agn\n    FROM probability\n    WHERE\n        classifier_name = 'stamp_classifier'\n        AND class_name = 'AGN'\n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND probability > 0.6\n),\n-- Subquery for LPV probability in light curve classifier (ranking=1 by default)\nlc_lpv AS (\n    SELECT\n        oid,\n        probability AS prob_lc_lpv\n    FROM probability\n    WHERE\n        classifier_name = 'lc_classifier'\n        AND class_name = 'LPV'\n        AND probability > 0.7\n        AND ranking = 1\n)\n-- Join the two subqueries on oid to get objects satisfying both conditions\nSELECT\n    s.oid,\n    s.prob_stamp_agn,\n    l.prob_lc_lpv\nFROM stamp_agn s\nINNER JOIN lc_lpv l ON s.oid = l.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3259, "completion_tokens": 236, "total_tokens": 3495, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc93a8c8190b66680a195a37cf2", "custom_id": "91-0", "response": {"status_code": 200, "request_id": "a01ab2c8b8f10ac47ea6cf6fcf4c2b54", "body": {"id": "chatcmpl-Bh8o0Gf7hxMi0c8EonSe92PByDqXt", "object": "chat.completion", "created": 1749621652, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with 'W1-W2' color lower than 1, returning requested columns\nSELECT\n    o.oid,\n    o.ndet,\n    (g.value - r.value) AS delta_mag_fid_g_r,\n    w1w2.value AS w1_w2,\n    w1w2.version\nFROM\n    object o\n    INNER JOIN feature w1w2\n        ON o.oid = w1w2.oid\n        AND w1w2.name = 'W1-W2'\n        AND w1w2.value < 1\n    INNER JOIN feature g\n        ON o.oid = g.oid\n        AND g.name = 'delta_mag_fid'\n        AND g.fid = 1  -- g-band\n    INNER JOIN feature r\n        ON o.oid = r.oid\n        AND r.name = 'delta_mag_fid'\n        AND r.fid = 2  -- r-band\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2913, "completion_tokens": 210, "total_tokens": 3123, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc947e48190b4638dc1e8526c39", "custom_id": "91-1", "response": {"status_code": 200, "request_id": "3a6b76fc8a490f585d719b8a55689727", "body": {"id": "chatcmpl-Bh8nsaebZanZyYg9VieWGEhobYFb8", "object": "chat.completion", "created": 1749621644, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with 'W1-W2' color lower than 1, returning required columns and at most 100 rows\nWITH w1w2_feature AS (\n    SELECT\n        oid,\n        value AS w1_w2,\n        version\n    FROM feature\n    WHERE name = 'W1-W2'\n      AND value < 1\n),\nmin_mag_g AS (\n    SELECT\n        oid,\n        value AS min_mag_g,\n        version\n    FROM feature\n    WHERE name = 'min_mag'\n      AND fid = 1\n),\nmin_mag_r AS (\n    SELECT\n        oid,\n        value AS min_mag_r,\n        version\n    FROM feature\n    WHERE name = 'min_mag'\n      AND fid = 2\n)\nSELECT\n    o.oid,\n    o.ndet,\n    (g.min_mag_g - r.min_mag_r) AS min_mag_g_minus_min_mag_r,\n    w.w1_w2,\n    w.version\nFROM object o\nINNER JOIN w1w2_feature w ON o.oid = w.oid\nINNER JOIN min_mag_g g ON o.oid = g.oid AND w.version = g.version\nINNER JOIN min_mag_r r ON o.oid = r.oid AND w.version = r.version\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2799, "completion_tokens": 272, "total_tokens": 3071, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
{"id": "batch_req_68491bc958fc8190901f51540afe51ca", "custom_id": "76-0", "response": {"status_code": 200, "request_id": "5de1f0e186d0188292b2626455fbd195", "body": {"id": "chatcmpl-Bh8o4qFkomfCPUeCU90NEjGANpM8j", "object": "chat.completion", "created": 1749621656, "model": "gpt-4.1-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid,         -- ZTF identifier\n    ssmagnr,     -- MPC archive magnitude\n    ssdistnr     -- Distance between ZTF object detection and MPC object (arcsec)\nFROM \n    ss_ztf\nWHERE \n    ssnamenr = '115185'\n    AND ssdistnr <= 1.5\nORDER BY \n    ssdistnr ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2691, "completion_tokens": 88, "total_tokens": 2779, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_51e1070cf2"}}, "error": null}
