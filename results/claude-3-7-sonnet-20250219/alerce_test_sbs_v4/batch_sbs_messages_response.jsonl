{"custom_id": "27-0", "response": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_max, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 100\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'CEP'\n    AND p.ranking = 1\n    AND p.probability > 0.76\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2844, "cache_read_input_tokens": 0, "input_tokens": 117, "output_tokens": 191, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "27-1", "response": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_max, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 100\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'CEP'\n    AND p.ranking = 1\n    AND p.probability > 0.76\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2834, "cache_read_input_tokens": 0, "input_tokens": 117, "output_tokens": 191, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "17-0", "response": "```sql\nWITH agn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n),\nband_detections AS (\n    SELECT \n        d.oid,\n        SUM(CASE WHEN d.fid = 1 THEN 1 ELSE 0 END) AS g_band_detections,\n        SUM(CASE WHEN d.fid = 2 THEN 1 ELSE 0 END) AS r_band_detections,\n        STDDEV(CASE WHEN d.fid = 1 THEN d.magpsf_corr ELSE NULL END) AS g_band_stddev,\n        STDDEV(CASE WHEN d.fid = 2 THEN d.magpsf_corr ELSE NULL END) AS r_band_stddev\n    FROM detection d\n    GROUP BY d.oid\n)\nSELECT \n    o.*,\n    p.class_name,\n    p.probability,\n    bd.g_band_detections,\n    bd.r_band_detections,\n    bd.g_band_stddev,\n    bd.r_band_stddev\nFROM object o\nJOIN agn_objects a ON o.oid = a.oid\nJOIN probability p ON o.oid = p.oid AND p.ranking = 1 AND p.classifier_name = 'lc_classifier'\nJOIN band_detections bd ON o.oid = bd.oid\nWHERE \n    -- Has r band detections with variability (stddev > 0)\n    bd.r_band_detections > 0 \n    AND bd.r_band_stddev > 0\n    AND (\n        -- No g band detections\n        bd.g_band_detections = 0\n        OR \n        -- Or no significant variability in g band\n        bd.g_band_stddev IS NULL \n        OR bd.g_band_stddev = 0\n    )\nORDER BY o.oid ASC;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2850, "cache_read_input_tokens": 0, "input_tokens": 82, "output_tokens": 524, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "17-1", "response": "```sql\n-- Get AGN objects with r-band variability but no g-band detections or variability\nWITH agn_objects AS (\n    -- Get objects classified as AGN\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n),\nr_band_detections AS (\n    -- Get objects with r-band detections\n    SELECT DISTINCT d.oid\n    FROM detection d\n    WHERE d.fid = 2 -- r band\n    AND d.oid IN (SELECT oid FROM agn_objects)\n),\ng_band_detections AS (\n    -- Get objects with g-band detections\n    SELECT DISTINCT d.oid\n    FROM detection d\n    WHERE d.fid = 1 -- g band\n),\nr_band_variability AS (\n    -- Check for r-band variability by looking at multiple detections\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 2 -- r band\n    GROUP BY d.oid\n    HAVING COUNT(*) > 1 AND STDDEV(d.magpsf_corr) > 0.1 -- Threshold for variability\n    AND d.oid IN (SELECT oid FROM agn_objects)\n),\ng_band_variability AS (\n    -- Check for g-band variability\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1 -- g band\n    GROUP BY d.oid\n    HAVING COUNT(*) > 1 AND STDDEV(d.magpsf_corr) > 0.1 -- Threshold for variability\n)\n-- Final selection\nSELECT o.*, p.class_name, p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE o.oid IN (SELECT oid FROM r_band_variability) -- Has r-band variability\nAND (\n    o.oid NOT IN (SELECT oid FROM g_band_detections) -- No g-band detections\n    OR \n    o.oid NOT IN (SELECT oid FROM g_band_variability) -- No g-band variability\n)\nAND p.class_name = 'AGN'\nAND p.ranking = 1\nAND p.classifier_name = 'lc_classifier'\nORDER BY o.oid ASC;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2875, "cache_read_input_tokens": 0, "input_tokens": 82, "output_tokens": 596, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "34-0", "response": "```sql\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', \n              'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', \n              'ZTF17aabwtky', 'ZTF18abwjpfy')\nAND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2733, "cache_read_input_tokens": 0, "input_tokens": 186, "output_tokens": 161, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "34-1", "response": "```sql\nWITH object_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi', \n        'ZTF19aaduncs', \n        'ZTF18abnvehl', \n        'ZTF19abrqsxy', \n        'ZTF19aaduodl', \n        'ZTF19aadovdv', \n        'ZTF18aammkke', \n        'ZTF18abtriul', \n        'ZTF17aabwtky', \n        'ZTF18abwjpfy'\n    ]) AS oid\n)\nSELECT f.*\nFROM feature f\nJOIN object_list ol ON f.oid = ol.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period')\nORDER BY f.oid, f.name;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2797, "cache_read_input_tokens": 0, "input_tokens": 186, "output_tokens": 218, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "1-0", "response": "```sql\nWITH agn_objects AS (\n    -- Step 1: Identify AGN objects with high probability\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n),\nfiltered_objects AS (\n    -- Step 2: Filter objects with sufficient light curve coverage\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    INNER JOIN agn_objects a ON o.oid = a.oid\n    WHERE o.deltajd >= 365.25\n),\nband_detections AS (\n    -- Step 3: Count detections per band\n    SELECT d.oid, d.fid, COUNT(*) AS det_count\n    FROM detection d\n    INNER JOIN filtered_objects fo ON d.oid = fo.oid\n    GROUP BY d.oid, d.fid\n    HAVING COUNT(*) >= 20\n),\nmag_variations AS (\n    -- Step 4: Calculate magnitude variations per band\n    SELECT \n        d.oid,\n        d.fid AS detection_fid,\n        MAX(d.magpsf_corr) AS max_mag,\n        MIN(d.magpsf_corr) AS min_mag,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag\n    FROM detection d\n    INNER JOIN band_detections bd ON d.oid = bd.oid AND d.fid = bd.fid\n    WHERE d.corrected = TRUE\n    GROUP BY d.oid, d.fid\n),\ng_band_variations AS (\n    -- Objects with g-band variations > 1.0\n    SELECT oid\n    FROM mag_variations\n    WHERE detection_fid = 1 AND delta_mag > 1.0\n),\nr_band_variations AS (\n    -- Objects with r-band variations > 0.5\n    SELECT oid\n    FROM mag_variations\n    WHERE detection_fid = 2 AND delta_mag > 0.5\n)\n-- Step 6: Final result combining all filters\nSELECT \n    fo.oid,\n    fo.meanra,\n    fo.meandec,\n    fo.ndet,\n    mv.detection_fid,\n    mv.max_mag,\n    mv.min_mag,\n    mv.delta_mag\nFROM filtered_objects fo\nINNER JOIN mag_variations mv ON fo.oid = mv.oid\nINNER JOIN g_band_variations g ON fo.oid = g.oid\nINNER JOIN r_band_variations r ON fo.oid = r.oid\nORDER BY fo.oid, mv.detection_fid;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3253, "cache_read_input_tokens": 0, "input_tokens": 197, "output_tokens": 694, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "1-1", "response": "```sql\nWITH agn_objects AS (\n    -- Step 1: Identify AGN objects with high probability\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    -- Step 2: Filter objects with sufficient light curve coverage\n    AND o.deltajd >= 365.25\n),\n\ndetections_per_band AS (\n    -- Step 3: Identify objects with sufficient detections in at least one band\n    SELECT d.oid, d.fid, COUNT(*) AS det_count\n    FROM detection d\n    INNER JOIN agn_objects a ON d.oid = a.oid\n    GROUP BY d.oid, d.fid\n    HAVING COUNT(*) >= 20\n),\n\nmag_variations AS (\n    -- Step 4: Calculate magnitude variations per band\n    SELECT \n        d.oid,\n        d.fid,\n        MAX(d.magpsf_corr) AS max_mag,\n        MIN(d.magpsf_corr) AS min_mag,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag\n    FROM detection d\n    INNER JOIN detections_per_band dpb ON d.oid = dpb.oid AND d.fid = dpb.fid\n    WHERE d.corrected = TRUE\n    GROUP BY d.oid, d.fid\n),\n\nfiltered_objects AS (\n    -- Combine objects that meet all criteria\n    SELECT DISTINCT mv_g.oid\n    FROM mag_variations mv_g\n    INNER JOIN mag_variations mv_r ON mv_g.oid = mv_r.oid\n    WHERE (mv_g.fid = 1 AND mv_g.delta_mag > 1.0)\n    AND (mv_r.fid = 2 AND mv_r.delta_mag > 0.5)\n)\n\n-- Final result with all requested information\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    mv_g.max_mag AS g_max_mag,\n    mv_g.min_mag AS g_min_mag,\n    mv_g.delta_mag AS g_delta_mag,\n    mv_g.fid AS detection_fid,\n    mv_r.max_mag AS r_max_mag,\n    mv_r.min_mag AS r_min_mag,\n    mv_r.delta_mag AS r_delta_mag,\n    mv_r.fid AS detection_fid\nFROM filtered_objects fo\nINNER JOIN object o ON fo.oid = o.oid\nINNER JOIN mag_variations mv_g ON fo.oid = mv_g.oid AND mv_g.fid = 1\nINNER JOIN mag_variations mv_r ON fo.oid = mv_r.oid AND mv_r.fid = 2\nORDER BY o.oid;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3246, "cache_read_input_tokens": 0, "input_tokens": 197, "output_tokens": 777, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "16-0", "response": "```sql\nWITH sn_objects AS (\n    -- Get objects with highest probability for SN in stamp classifier\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n),\nfiltered_objects AS (\n    -- Filter objects with first detection in first 2 days of September\n    SELECT s.oid, s.probability, o.firstmjd\n    FROM sn_objects s\n    INNER JOIN object o ON s.oid = o.oid\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    -- Get objects that qualify as fast risers (rate of magnitude change \u2265 0.25 magnitudes/day)\n    SELECT \n        f.oid, \n        f.probability,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.magpsf_corr,\n        d.isdiffpos,\n        d.candid\n    FROM filtered_objects f\n    INNER JOIN detection d ON f.oid = d.oid\n    -- We'll calculate the rise rate in the main query by comparing with non-detections\n)\n\n-- Final query joining with non-detections and calculating rise rate\nSELECT \n    o.oid,\n    p.probability,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.magpsf_corr,\n    d.isdiffpos AS image_difference,\n    d.fid AS magstat_fid,\n    -- Calculate initial rise estimate (magnitude change per day)\n    CASE \n        WHEN d.mjd = o.firstmjd THEN \n            (d.magpsf_corr - LAG(d.magpsf_corr) OVER (PARTITION BY o.oid, d.fid ORDER BY d.mjd)) / \n            (d.mjd - LAG(d.mjd) OVER (PARTITION BY o.oid, d.fid ORDER BY d.mjd))\n        ELSE NULL\n    END AS initial_rise_estimate\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN detection d ON o.oid = d.oid\nWHERE p.classifier_name = 'stamp_classifier'\nAND p.class_name = 'SN'\nAND p.ranking = 1\nAND o.firstmjd BETWEEN 60188.0 AND 60189.0\n-- Filter for fast risers (rate \u2265 0.25 mag/day)\nAND EXISTS (\n    SELECT 1\n    FROM detection d1\n    WHERE d1.oid = o.oid\n    AND d1.mjd = o.firstmjd\n    AND EXISTS (\n        SELECT 1\n        FROM detection d2\n        WHERE d2.oid = o.oid\n        AND d2.mjd < o.firstmjd\n        AND d2.fid = d1.fid\n        AND (d1.magpsf_corr - d2.magpsf_corr) / (d1.mjd - d2.mjd) >= 0.25\n    )\n)\nORDER BY o.oid\nLIMIT 100;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3145, "cache_read_input_tokens": 0, "input_tokens": 239, "output_tokens": 826, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "16-1", "response": "```sql\nWITH sn_objects AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n),\nseptember_objects AS (\n    SELECT s.oid, s.probability, o.firstmjd\n    FROM sn_objects s\n    INNER JOIN object o ON s.oid = o.oid\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT \n        so.oid,\n        so.probability,\n        ms.fid AS magstat_fid,\n        nd.fid,\n        ms.dm_first,\n        ms.dt_first,\n        (ms.dm_first / ms.dt_first) AS initial_rise_estimate\n    FROM september_objects so\n    INNER JOIN magstats ms ON so.oid = ms.oid\n    INNER JOIN non_detection nd ON so.oid = nd.oid AND ms.fid = nd.fid\n    WHERE (ms.dm_first / ms.dt_first) >= 0.25\n      AND nd.mjd < so.firstmjd\n      AND nd.mjd = (\n          SELECT MAX(nd2.mjd)\n          FROM non_detection nd2\n          WHERE nd2.oid = so.oid\n            AND nd2.fid = ms.fid\n            AND nd2.mjd < so.firstmjd\n      )\n)\nSELECT \n    fr.oid,\n    fr.probability,\n    fr.magstat_fid,\n    fr.fid,\n    fr.dm_first,\n    fr.dt_first,\n    fr.initial_rise_estimate,\n    nd.mjd AS non_detection_mjd,\n    d.mjd AS detection_mjd,\n    d.magpsf_corr,\n    d.fid AS detection_fid\nFROM fast_risers fr\nLEFT JOIN detection d ON fr.oid = d.oid\nLEFT JOIN non_detection nd ON fr.oid = nd.oid\nORDER BY fr.oid, d.mjd, nd.mjd\nLIMIT 100;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3141, "cache_read_input_tokens": 0, "input_tokens": 239, "output_tokens": 559, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "19-0", "response": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.firstmjd >= 59274.0 AND o.firstmjd <= 59305.0  -- Between March 1st and April 1st, 2021\n    AND o.ndet <= 1  -- At most one detection (asteroids move and appear only once)\n    AND p.class_name = 'asteroid'  -- Classified as asteroid\n    AND p.classifier_name = 'stamp_classifier'  -- Using the stamp classifier\n    AND p.probability > 0.7  -- With probability greater than 0.7\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2802, "cache_read_input_tokens": 0, "input_tokens": 171, "output_tokens": 226, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "19-1", "response": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.firstmjd >= 59274.0 AND o.firstmjd <= 59305.0  -- Objects that appeared between March 1st and April 1st 2021\n    AND o.ndet <= 1  -- Objects with at most one detection (typical for asteroids)\n    AND p.class_name = 'asteroid'  -- Objects classified as asteroids\n    AND p.classifier_name = 'stamp_classifier'  -- Using the stamp classifier\n    AND p.probability > 0.7  -- With probability greater than 0.7\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2836, "cache_read_input_tokens": 0, "input_tokens": 171, "output_tokens": 228, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "14-0", "response": "```sql\nWITH target_oids AS (\n    SELECT unnest(ARRAY[\n        'ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',\n        'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',\n        'ZTF22aawasao', 'ZTF23aaxgvnt'\n    ]) AS oid\n)\nSELECT \n    d.oid,           -- unique object identifier\n    d.candid,        -- candidate identifier\n    d.fid,           -- filter identifier\n    d.mjd,           -- modified julian date\n    d.magpsf,        -- magnitude (point spread function difference magnitude)\n    d.sigmapsf,      -- magnitude error\n    d.has_stamp,     -- whether the object has stamps\n    d.drb,           -- deep learning real bogus score\n    p.sgscore1,      -- star galaxy score of the nearest object\n    p.distpsnr1      -- distance to the nearest source in panstarrs\nFROM \n    detection d\nJOIN \n    ps1_ztf p ON d.candid = p.candid\nWHERE \n    d.oid IN (SELECT oid FROM target_oids)\n    AND d.drb > 0.5\n    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3005, "cache_read_input_tokens": 0, "input_tokens": 267, "output_tokens": 391, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "14-1", "response": "```sql\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',\n        'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',\n        'ZTF22aawasao', 'ZTF23aaxgvnt'\n    ]) AS oid\n)\nSELECT \n    d.oid,           -- unique object identifier\n    d.candid,        -- candidate identifier\n    d.fid,           -- filter identifier\n    d.mjd,           -- modified julian date\n    d.magpsf,        -- magnitude\n    d.sigmapsf,      -- magnitude error\n    d.has_stamp,     -- whether the object has stamps\n    d.drb,           -- deep learning real bogus score\n    p.sgscore1,      -- star galaxy score of the nearest object\n    p.distpsnr1      -- distance to the nearest source in panstarrs\nFROM \n    detection d\nJOIN \n    ps1_ztf p ON d.candid = p.candid\nJOIN \n    oid_list ol ON d.oid = ol.oid\nWHERE \n    d.drb > 0.5\n    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3017, "cache_read_input_tokens": 0, "input_tokens": 267, "output_tokens": 386, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "22-0", "response": "```sql\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.firstmjd >= 58239.0 \n  AND o.firstmjd <= 58270.0\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2782, "cache_read_input_tokens": 0, "input_tokens": 97, "output_tokens": 89, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "22-1", "response": "```sql\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2803, "cache_read_input_tokens": 0, "input_tokens": 97, "output_tokens": 81, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "12-0", "response": "```sql\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    -- Time range filter for first detection\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    \n    -- Spatial filter using polygon\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))')\n    \n    -- Classification filter for supernovae\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2800, "cache_read_input_tokens": 0, "input_tokens": 145, "output_tokens": 219, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "12-1", "response": "```sql\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    -- Time range condition\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    -- Spatial condition using polygon\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    -- Classification condition for supernovae\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2822, "cache_read_input_tokens": 0, "input_tokens": 145, "output_tokens": 215, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "89-0", "response": "```sql\n/* \nThis query finds ZTF objects classified as supernovae by the stamp classifier\nwith probability > 0.7 and returns their data quality information.\nNote: The 'dataquality' table is not in the provided schema, so this query\nwill need to be adjusted once that table is available.\n*/\n\nSELECT dq.*\nFROM probability p\nJOIN dataquality dq ON p.oid = dq.oid\nWHERE p.class_name = 'SN'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability > 0.7\nORDER BY p.probability DESC\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2770, "cache_read_input_tokens": 0, "input_tokens": 79, "output_tokens": 157, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "89-1", "response": "```sql\n/* This query retrieves data quality information for objects classified as supernovae\n   by the stamp classifier with probability > 0.7, limited to 50 results */\n\nSELECT p.oid, p.probability\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.probability > 0.7\nORDER BY p.probability DESC\nLIMIT 50;\n\n/* Note: The query returns only oid and probability because the 'dataquality' table \n   mentioned in the request does not exist in the provided database schema.\n   If the dataquality table existed, the query would join with it using the oid field\n   and return all columns from that table. */\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2751, "cache_read_input_tokens": 0, "input_tokens": 79, "output_tokens": 179, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "103-0", "response": "```sql\nSELECT o.*, p.*, ps.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN ps1_ztf ps ON o.oid = ps.oid\nWHERE ps.distpsnr1 > 5\n  AND p.probability > 0.7\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\nORDER BY ps.distpsnr1 DESC\nLIMIT 200;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2838, "cache_read_input_tokens": 0, "input_tokens": 136, "output_tokens": 159, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "103-1", "response": "```sql\nSELECT o.*, p.*, ps1.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN ps1_ztf ps1 ON o.oid = ps1.oid\nWHERE ps1.distpsnr1 > 5\n  AND p.probability > 0.7\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\nORDER BY ps1.distpsnr1 DESC\nLIMIT 200;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2825, "cache_read_input_tokens": 0, "input_tokens": 136, "output_tokens": 165, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "99-0", "response": "```sql\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability = 1\n  AND p.ranking = 1\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2761, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 125, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "99-1", "response": "```sql\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability = 1\n  AND p.ranking = 1\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2765, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 125, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "92-0", "response": "```sql\nSELECT \n    d.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM \n    (SELECT \n        oid\n     FROM \n        detection\n     WHERE \n        fid = 1 -- g band\n        AND dubious = FALSE\n     GROUP BY \n        oid\n     HAVING \n        COUNT(*) >= 10\n    ) d\nINNER JOIN \n    probability p ON d.oid = p.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\nORDER BY \n    d.oid\nLIMIT 500;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2699, "cache_read_input_tokens": 0, "input_tokens": 110, "output_tokens": 173, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "92-1", "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND o.oid IN (\n        SELECT \n            oid\n        FROM \n            detection\n        WHERE \n            fid = 1 -- g band\n            AND dubious = FALSE\n        GROUP BY \n            oid\n        HAVING \n            COUNT(*) >= 10\n    )\nORDER BY \n    o.oid\nLIMIT 500;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2720, "cache_read_input_tokens": 0, "input_tokens": 110, "output_tokens": 184, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "102-0", "response": "```sql\nSELECT m.*\nFROM probability p\nINNER JOIN xmatch x ON p.oid = x.oid\nINNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\nINNER JOIN magstat m ON p.oid = m.oid\nWHERE p.class_name = 'AGN'\n  AND p.probability > 0.6\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND a.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2885, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 143, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "102-1", "response": "```sql\nSELECT m.*\nFROM magstat m\nINNER JOIN (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN xmatch x ON p.oid = x.oid\n    INNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\n    WHERE p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND a.w1mpro BETWEEN 12 AND 13\n) filtered_objects ON m.oid = filtered_objects.oid\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2880, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 164, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "104-0", "response": "```sql\nSELECT \n    p.oid,\n    d.candid,\n    d.ssdistnr,\n    d.ssmagnr,\n    d.ssnamenr,\n    d.fid AS filter_identifier,\n    d.fwhm AS fwhm_sextractor,\n    d.nmc AS num_ps1_calibrators,\n    d.exptime AS exposure_time\nFROM \n    probability p\nINNER JOIN \n    detection d ON p.oid = d.oid\nWHERE \n    p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\nLIMIT 30\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2882, "cache_read_input_tokens": 0, "input_tokens": 142, "output_tokens": 197, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "104-1", "response": "```sql\nSELECT \n    p.oid,\n    d.candid,\n    d.ssdistnr,\n    d.ssmagnr,\n    d.ssnamenr,\n    d.fid AS filter_id,\n    d.fwhm,\n    d.ncalps1,\n    d.exptime\nFROM \n    probability p\nINNER JOIN \n    detection d ON p.oid = d.oid\nWHERE \n    p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\n    AND p.ranking = 1\nLIMIT 30;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3038, "cache_read_input_tokens": 0, "input_tokens": 142, "output_tokens": 189, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "107-0", "response": "```sql\n-- Find ZTF objects matching specific criteria\nWITH asteroid_candidates AS (\n    SELECT \n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability\n    FROM \n        object o\n    INNER JOIN \n        probability p ON o.oid = p.oid\n    WHERE \n        o.ndet > 500\n        AND p.class_name = 'asteroid'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.probability > 0.5\n)\n\nSELECT \n    ac.oid AS \"ZTF identifier\",\n    ac.ndet AS \"number of detections\",\n    ac.firstmjd AS \"first detection date\",\n    ac.lastmjd AS \"last detection date\",\n    ac.probability,\n    d.candid AS \"candidate identifier\",\n    ss.ssdistnr AS \"distance between ZTF object and MPC object\",\n    ss.ssnamenr AS \"MPC name\",\n    d.mjd AS \"detection date\",\n    d.fid AS \"filter identifier\"\nFROM \n    asteroid_candidates ac\nINNER JOIN \n    detection d ON ac.oid = d.oid\nINNER JOIN \n    ss_ztf ss ON ac.oid = ss.oid\nWHERE \n    ss.ssdistnr < 2\nORDER BY \n    ac.firstmjd\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3360, "cache_read_input_tokens": 0, "input_tokens": 161, "output_tokens": 384, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "107-1", "response": "```sql\n-- Query to find ZTF objects matching specific asteroid criteria\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.lastmjd AS \"last detection date\",\n    p.probability AS \"probability\",\n    d.candid AS \"candidate identifier\",\n    d.ssdistnr AS \"distance between ZTF object and MPC object\",\n    d.ssnamenr AS \"MPC name\",\n    d.mjd AS \"detection date\",\n    d.fid AS \"filter identifier\"\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    o.ndet > 500\n    AND p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.5\n    AND p.ranking = 1\n    AND d.ssdistnr < 2\nORDER BY \n    o.firstmjd\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3366, "cache_read_input_tokens": 0, "input_tokens": 161, "output_tokens": 312, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "84-0", "response": "```sql\nSELECT \n    x.oid AS ztf_identifier,\n    x.oid_catalog AS allwise_identifier,\n    x.dist AS distance,\n    a.w1mpro AS w1_magnitude,\n    a.w2mpro AS w2_magnitude,\n    a.w3mpro AS w3_magnitude,\n    a.w4mpro AS w4_magnitude\nFROM \n    xmatch x\nJOIN \n    allwise a ON x.oid_catalog = a.oid_catalog\nWHERE \n    x.oid = 'ZTF19aascdol'\n    AND x.catid = 'ALLWISE';\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2824, "cache_read_input_tokens": 0, "input_tokens": 113, "output_tokens": 166, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "84-1", "response": "```sql\nSELECT \n    xm.oid AS ztf_id,\n    xm.oid_catalog AS allwise_id,\n    xm.dist AS distance,\n    aw.w1mpro AS w1_magnitude,\n    aw.w2mpro AS w2_magnitude,\n    aw.w3mpro AS w3_magnitude,\n    aw.w4mpro AS w4_magnitude\nFROM \n    xmatch xm\nJOIN \n    allwise aw ON xm.oid_catalog = aw.oid_catalog\nWHERE \n    xm.oid = 'ZTF19aascdol'\n    AND xm.catid = 'ALLWISE'\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2872, "cache_read_input_tokens": 0, "input_tokens": 113, "output_tokens": 179, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "96-0", "response": "```sql\nSELECT \n    ss.*, \n    d.mjd, \n    d.fid, \n    d.isdiffpos, \n    d.ra, \n    d.dec, \n    d.magpsf, \n    d.sigmapsf\nFROM \n    ss_ztf ss\nJOIN \n    detection d ON ss.candid = d.candid\nWHERE \n    ss.ssnamenr IN ('2003FP134', '2009UK56')\n    AND q3c_join(ss.ra, ss.dec, d.ra, d.dec, 0.0005556) -- 2 arcsec = 0.0005556 degrees\nORDER BY \n    ss.ssnamenr, \n    d.mjd\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2850, "cache_read_input_tokens": 0, "input_tokens": 130, "output_tokens": 193, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "96-1", "response": "```sql\nWITH solar_system_objects AS (\n    SELECT '2003FP134' AS ssnamenr\n    UNION ALL\n    SELECT '2009UK56' AS ssnamenr\n)\n\nSELECT \n    ss.*, -- All columns from ss_ztf\n    d.mjd, -- Detection date\n    d.fid, -- Filter identifier\n    d.isdiffpos, -- Flag\n    d.ra, d.dec, -- Coordinates\n    d.magpsf, -- Difference magnitude\n    d.sigmapsf -- Uncertainty of difference magnitude\nFROM \n    ss_ztf ss\nJOIN \n    detection d ON ss.oid = d.oid\nWHERE \n    ss.ssnamenr IN (SELECT ssnamenr FROM solar_system_objects)\n    AND ss.ssdistnr <= 2 -- Distance in arcsec\nORDER BY \n    ss.ssnamenr, -- MPC name\n    d.mjd -- Detection date\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2820, "cache_read_input_tokens": 0, "input_tokens": 130, "output_tokens": 237, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "94-0", "response": "```sql\nSELECT o.*\nFROM object o\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2706, "cache_read_input_tokens": 0, "input_tokens": 72, "output_tokens": 30, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "94-1", "response": "```sql\n/* Query to retrieve objects with reference changes */\nSELECT o.*\nFROM object o\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2734, "cache_read_input_tokens": 0, "input_tokens": 72, "output_tokens": 40, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "90-0", "response": "```sql\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (\n    SELECT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n    AND f.version = 'lc_classifier_1.2.1-P'\n    AND f.value < 5\n)\nAND p.classifier_name = 'lc_classifier'\nAND p.ranking IN (1, 2)\nLIMIT 100;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2784, "cache_read_input_tokens": 0, "input_tokens": 107, "output_tokens": 116, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "90-1", "response": "```sql\nWITH periodic_objects AS (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nINNER JOIN periodic_objects po ON p.oid = po.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2821, "cache_read_input_tokens": 0, "input_tokens": 107, "output_tokens": 125, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "100-0", "response": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    magpsf AS \"detection difference magnitude\",\n    sigmapsf AS \"uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced magnitude uncertainty\",\n    'detection' AS \"table\"\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    NULL AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced magnitude uncertainty\",\n    'non_detection' AS \"table\"\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    mag AS \"forced difference magnitude\",\n    e_mag AS \"forced magnitude uncertainty\",\n    'forced_photometry' AS \"table\"\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    \"epoch date\";\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3019, "cache_read_input_tokens": 0, "input_tokens": 139, "output_tokens": 425, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "100-1", "response": "```sql\n/* \n   Query to retrieve all detections, non-detections and forced photometry points \n   for ZTF object 'ZTF24aamtvxb' with requested columns\n*/\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    magpsf AS \"detection difference magnitude\",\n    sigmapsf AS \"uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced uncertainty\",\n    'detection' AS \"table\"\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    NULL AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced uncertainty\",\n    'non_detection' AS \"table\"\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    mag AS \"forced difference magnitude\",\n    e_mag AS \"forced uncertainty\",\n    'forced_photometry' AS \"table\"\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    \"epoch date\";\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2925, "cache_read_input_tokens": 0, "input_tokens": 139, "output_tokens": 468, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "106-0", "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    p1.probability AS \"prob_stamp_bogus\",\n    p2.probability AS \"prob_lc_transient\"\nFROM \n    object o\n    INNER JOIN probability p1 ON o.oid = p1.oid\n    INNER JOIN probability p2 ON o.oid = p2.oid\nWHERE \n    o.ndet > 10\n    AND p1.class_name = 'bogus'\n    AND p1.classifier_name = 'stamp_classifier'\n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.probability > 0.7\n    AND p2.class_name = 'Transient'\n    AND p2.classifier_name = 'lc_classifier_top'\n    AND p2.probability > 0.9\nORDER BY \n    o.oid\nLIMIT 30;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2836, "cache_read_input_tokens": 0, "input_tokens": 195, "output_tokens": 268, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "106-1", "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    p_stamp.probability AS \"prob_stamp_bogus\",\n    p_lc.probability AS \"prob_lc_transient\"\nFROM \n    object o\nINNER JOIN \n    probability p_stamp ON o.oid = p_stamp.oid\nINNER JOIN \n    probability p_lc ON o.oid = p_lc.oid\nWHERE \n    o.ndet > 10\n    AND p_stamp.class_name = 'bogus'\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.7\n    AND p_lc.class_name = 'Transient'\n    AND p_lc.classifier_name = 'lc_classifier_top'\n    AND p_lc.probability > 0.9\n    AND p_stamp.ranking = 1\n    AND p_lc.ranking = 1\nORDER BY \n    o.oid\nLIMIT 30;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2823, "cache_read_input_tokens": 0, "input_tokens": 195, "output_tokens": 312, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "58-0", "response": "```sql\nSELECT o.*\nFROM object o\nWHERE o.ndet >= 30\n  AND o.deltajd > 20\n  AND EXISTS (\n    SELECT 1\n    FROM (\n      SELECT d1.oid,\n             MIN(CASE WHEN d1.fid = 1 THEN d1.magpsf_corr END) AS min_g_mag,\n             MIN(CASE WHEN d1.fid = 2 THEN d1.magpsf_corr END) AS min_r_mag\n      FROM detection d1\n      WHERE d1.corrected = TRUE\n        AND d1.fid IN (1, 2)\n      GROUP BY d1.oid\n    ) AS mag_diff\n    WHERE mag_diff.oid = o.oid\n      AND mag_diff.min_g_mag - mag_diff.min_r_mag > 3.5\n      AND mag_diff.min_g_mag IS NOT NULL\n      AND mag_diff.min_r_mag IS NOT NULL\n  )\nLIMIT 20;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2832, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 258, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "58-1", "response": "```sql\nWITH min_magnitudes AS (\n    SELECT \n        oid,\n        MIN(CASE WHEN fid = 1 THEN magpsf_corr END) AS min_g_mag,\n        MIN(CASE WHEN fid = 2 THEN magpsf_corr END) AS min_r_mag\n    FROM \n        detection\n    WHERE \n        magpsf_corr IS NOT NULL\n    GROUP BY \n        oid\n)\n\nSELECT \n    o.*\nFROM \n    object o\nJOIN \n    min_magnitudes m ON o.oid = m.oid\nWHERE \n    o.ndet >= 30\n    AND o.deltajd > 20\n    AND (m.min_g_mag - m.min_r_mag) > 3.5\nLIMIT 20;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2828, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 206, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "39-0", "response": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf_corr AS magnitude,\n    d.sigmapsf_corr AS magnitude_error,\n    (MAX(d.magpsf_corr) OVER (PARTITION BY o.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY o.oid)) AS max_rise_from_min\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    p.class_name = 'CV/Nova'\n    AND p.classifier_name = 'lc_classifier_stochastic'\n    AND p.ranking = 1\n    AND o.ndet <= 50\n    AND d.fid = 2 -- r-band filter\n    AND d.corrected = TRUE\nORDER BY \n    o.oid\nLIMIT 1000;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2907, "cache_read_input_tokens": 0, "input_tokens": 166, "output_tokens": 274, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "39-1", "response": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf_corr AS magnitude,\n    d.sigmapsf_corr AS magnitude_error,\n    MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS max_rise_from_min\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    p.class_name = 'CV/Nova'\n    AND p.classifier_name = 'lc_classifier_stochastic'\n    AND p.ranking = 1\n    AND o.ndet <= 50\n    AND d.fid = 2 -- r-band filter\n    AND d.corrected = TRUE\nGROUP BY \n    o.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf_corr, d.sigmapsf_corr\nORDER BY \n    o.oid\nLIMIT 1000;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2900, "cache_read_input_tokens": 0, "input_tokens": 166, "output_tokens": 297, "server_tool_use": null, "service_tier": "batch"}}
