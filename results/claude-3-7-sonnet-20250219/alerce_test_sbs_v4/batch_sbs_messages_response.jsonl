{"custom_id": "8-2", "response": "```sql\nSELECT object.*, probability.*\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE object.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND probability.class_name = 'SN'\n  AND probability.classifier_name = 'stamp_classifier'\n  AND probability.ranking = 1\n  AND (probability.probability > 0.5 OR object.ndet >= 2)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2856, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 114, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2856, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "8-3", "response": "```sql\nSELECT object.*, probability.*\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE object.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND probability.class_name = 'SN'\n  AND probability.classifier_name = 'stamp_classifier'\n  AND probability.ranking = 1\n  AND (probability.probability > 0.5 OR object.ndet >= 2)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2856, "input_tokens": 105, "output_tokens": 114, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "8-4", "response": "```sql\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.firstmjd >= 60173.0 \n  AND o.firstmjd <= 60177.0\n  AND p.class_name = 'SN'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND (p.probability > 0.5 OR o.ndet >= 2)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2895, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 124, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2895, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "27-2", "response": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_max, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 100\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'CEP'\n    AND p.ranking = 1\n    AND p.probability > 0.76\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2863, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 191, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2863, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "27-3", "response": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_max, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 100\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'CEP'\n    AND p.probability > 0.76\n    AND p.ranking = 1\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2910, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 191, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2910, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "27-4", "response": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_max, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 100\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'CEP'\n    AND p.ranking = 1\n    AND p.probability > 0.76\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2829, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 191, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2829, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "17-2", "response": "```sql\n-- Query to find AGN objects with r-band variability but no g-band detections or variability\nWITH r_band_variable AS (\n    -- Objects with variability in r band (fid=2)\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 2\n    GROUP BY d.oid\n    HAVING COUNT(d.candid) > 0 \n    AND STDDEV(d.magpsf_corr) > 0\n),\ng_band_check AS (\n    -- Objects with no detections or no variability in g band (fid=1)\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(d.candid) = 0 OR STDDEV(d.magpsf_corr) = 0 OR STDDEV(d.magpsf_corr) IS NULL\n)\nSELECT o.*, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN r_band_variable r ON o.oid = r.oid\nINNER JOIN g_band_check g ON o.oid = g.oid\nWHERE p.class_name = 'AGN'\nAND p.ranking = 1\nAND p.classifier_name = 'lc_classifier'\nORDER BY o.oid ASC\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2799, "cache_read_input_tokens": 0, "input_tokens": 81, "output_tokens": 367, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2799, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "17-3", "response": "```sql\nSELECT o.*, p.class_name, p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'AGN'\nAND p.ranking = 1\nAND p.classifier_name = 'lc_classifier'\nAND EXISTS (\n    -- Objects with r-band detections showing variability\n    SELECT 1 \n    FROM detection d1\n    WHERE d1.oid = o.oid\n    AND d1.fid = 2 -- r band\n    AND d1.sigmapsf_corr > 0\n    GROUP BY d1.oid\n    HAVING COUNT(*) > 0\n)\nAND (\n    -- Objects with no g-band detections\n    NOT EXISTS (\n        SELECT 1 \n        FROM detection d2\n        WHERE d2.oid = o.oid\n        AND d2.fid = 1 -- g band\n    )\n    OR\n    -- Objects with g-band detections but no variability\n    NOT EXISTS (\n        SELECT 1 \n        FROM detection d3\n        WHERE d3.oid = o.oid\n        AND d3.fid = 1 -- g band\n        AND d3.sigmapsf_corr > 0\n    )\n)\nORDER BY o.oid ASC\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2782, "cache_read_input_tokens": 0, "input_tokens": 81, "output_tokens": 323, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2782, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "17-4", "response": "```sql\n-- Query to find AGN objects with r-band variability but no g-band detections or variability\nWITH r_band_variable AS (\n    -- Objects with variability in r band (fid=2)\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 2\n    GROUP BY d.oid\n    HAVING COUNT(*) > 0 AND STDDEV(d.magpsf_corr) > 0\n),\ng_band_criteria AS (\n    -- Objects with no detections in g band (fid=1) or no variability in g band\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(*) = 0 OR STDDEV(d.magpsf_corr) = 0\n)\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN r_band_variable r ON o.oid = r.oid\nINNER JOIN g_band_criteria g ON o.oid = g.oid\nWHERE p.class_name = 'AGN'\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\nORDER BY o.oid ASC;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2784, "cache_read_input_tokens": 0, "input_tokens": 81, "output_tokens": 320, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2784, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "34-2", "response": "```sql\nWITH object_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi', \n        'ZTF19aaduncs', \n        'ZTF18abnvehl', \n        'ZTF19abrqsxy', \n        'ZTF19aaduodl', \n        'ZTF19aadovdv', \n        'ZTF18aammkke', \n        'ZTF18abtriul', \n        'ZTF17aabwtky', \n        'ZTF18abwjpfy'\n    ]) AS oid\n)\nSELECT f.*\nFROM feature f\nJOIN object_list ol ON f.oid = ol.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period')\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2818, "cache_read_input_tokens": 0, "input_tokens": 185, "output_tokens": 206, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2818, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "34-3", "response": "```sql\nWITH object_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', \n        'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', \n        'ZTF17aabwtky', 'ZTF18abwjpfy'\n    ]) AS oid\n)\nSELECT f.*\nFROM feature f\nJOIN object_list ol ON f.oid = ol.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period')\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2814, "cache_read_input_tokens": 0, "input_tokens": 185, "output_tokens": 192, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2814, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "34-4", "response": "```sql\nWITH object_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi', \n        'ZTF19aaduncs', \n        'ZTF18abnvehl', \n        'ZTF19abrqsxy', \n        'ZTF19aaduodl', \n        'ZTF19aadovdv', \n        'ZTF18aammkke', \n        'ZTF18abtriul', \n        'ZTF17aabwtky', \n        'ZTF18abwjpfy'\n    ]) AS oid\n)\nSELECT o.oid, p.class_name, p.probability, p.classifier_name, p.classifier_version, p.ranking\nFROM object_list o\nJOIN object ON o.oid = object.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.ranking = 1\nAND p.classifier_name = 'lc_classifier'\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2826, "input_tokens": 185, "output_tokens": 252, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "1-2", "response": "```sql\nWITH agn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND o.deltajd >= 365.25\n    AND o.corrected = TRUE\n),\nband_detections AS (\n    SELECT \n        oid,\n        fid,\n        COUNT(*) AS det_count,\n        MAX(magpsf_corr) AS max_mag,\n        MIN(magpsf_corr) AS min_mag,\n        MAX(magpsf_corr) - MIN(magpsf_corr) AS delta_mag\n    FROM detection\n    WHERE corrected = TRUE\n    GROUP BY oid, fid\n),\nfiltered_objects AS (\n    SELECT \n        a.oid\n    FROM agn_objects a\n    WHERE EXISTS (\n        SELECT 1 \n        FROM band_detections bd\n        WHERE bd.oid = a.oid\n        AND bd.det_count >= 20\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM band_detections bd\n        WHERE bd.oid = a.oid\n        AND bd.fid = 1\n        AND bd.delta_mag > 1.0\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM band_detections bd\n        WHERE bd.oid = a.oid\n        AND bd.fid = 2\n        AND bd.delta_mag > 0.5\n    )\n)\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    bd_g.max_mag AS g_max_mag,\n    bd_g.min_mag AS g_min_mag,\n    bd_g.delta_mag AS g_delta_mag,\n    bd_r.max_mag AS r_max_mag,\n    bd_r.min_mag AS r_min_mag,\n    bd_r.delta_mag AS r_delta_mag,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid\nFROM filtered_objects fo\nINNER JOIN object o ON fo.oid = o.oid\nINNER JOIN band_detections bd_g ON fo.oid = bd_g.oid AND bd_g.fid = 1\nINNER JOIN band_detections bd_r ON fo.oid = bd_r.oid AND bd_r.fid = 2\nLEFT JOIN feature f ON fo.oid = f.oid\nORDER BY o.oid;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3321, "cache_read_input_tokens": 0, "input_tokens": 196, "output_tokens": 679, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3321, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "1-3", "response": "```sql\nWITH agn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND o.deltajd >= 365.25\n),\ndetections_per_band AS (\n    SELECT oid, fid, COUNT(*) AS det_count\n    FROM detection\n    WHERE oid IN (SELECT oid FROM agn_objects)\n    GROUP BY oid, fid\n    HAVING COUNT(*) >= 20\n),\ng_band_variations AS (\n    SELECT d.oid,\n           MAX(d.magpsf_corr) AS max_mag_g,\n           MIN(d.magpsf_corr) AS min_mag_g,\n           MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_g\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n      AND d.fid = 1 -- g band\n      AND d.corrected = TRUE\n    GROUP BY d.oid\n    HAVING MAX(d.magpsf_corr) - MIN(d.magpsf_corr) > 1.0\n),\nr_band_variations AS (\n    SELECT d.oid,\n           MAX(d.magpsf_corr) AS max_mag_r,\n           MIN(d.magpsf_corr) AS min_mag_r,\n           MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n      AND d.fid = 2 -- r band\n      AND d.corrected = TRUE\n    GROUP BY d.oid\n    HAVING MAX(d.magpsf_corr) - MIN(d.magpsf_corr) > 0.5\n),\nfiltered_objects AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    INNER JOIN detections_per_band dpb ON o.oid = dpb.oid\n    INNER JOIN g_band_variations g ON o.oid = g.oid\n    INNER JOIN r_band_variations r ON o.oid = r.oid\n)\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    g.max_mag_g,\n    g.min_mag_g,\n    g.delta_mag_g AS delta_mag,\n    r.max_mag_r,\n    r.min_mag_r,\n    r.delta_mag_r AS delta_mag\nFROM filtered_objects fo\nINNER JOIN object o ON fo.oid = o.oid\nINNER JOIN g_band_variations g ON fo.oid = g.oid\nINNER JOIN r_band_variations r ON fo.oid = r.oid\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3236, "cache_read_input_tokens": 0, "input_tokens": 196, "output_tokens": 774, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3236, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "1-4", "response": "```sql\nWITH agn_objects AS (\n    -- Step 1: Identify AGN objects with high probability\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND o.deltajd >= 365.25  -- At least one year of coverage\n),\n\ndetections_per_band AS (\n    -- Step 2: Count detections per band for each object\n    SELECT oid, fid, COUNT(*) AS det_count\n    FROM detection\n    WHERE oid IN (SELECT oid FROM agn_objects)\n    GROUP BY oid, fid\n    HAVING COUNT(*) >= 20  -- At least 20 detections in this band\n),\n\nobjects_with_sufficient_detections AS (\n    -- Step 3: Objects with at least 20 detections in at least one band\n    SELECT DISTINCT oid\n    FROM detections_per_band\n),\n\ng_band_variations AS (\n    -- Step 4a: Objects with significant variations in g band (fid=1)\n    SELECT d.oid,\n           MAX(d.magpsf_corr) AS max_g,\n           MIN(d.magpsf_corr) AS min_g,\n           MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_g\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM objects_with_sufficient_detections)\n      AND d.fid = 1\n      AND d.corrected = TRUE\n    GROUP BY d.oid\n    HAVING MAX(d.magpsf_corr) - MIN(d.magpsf_corr) > 1.0\n),\n\nr_band_variations AS (\n    -- Step 4b: Objects with significant variations in r band (fid=2)\n    SELECT d.oid,\n           MAX(d.magpsf_corr) AS max_r,\n           MIN(d.magpsf_corr) AS min_r,\n           MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM objects_with_sufficient_detections)\n      AND d.fid = 2\n      AND d.corrected = TRUE\n    GROUP BY d.oid\n    HAVING MAX(d.magpsf_corr) - MIN(d.magpsf_corr) > 0.5\n)\n\n-- Final query combining all results\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    g.max_g,\n    g.min_g,\n    g.delta_mag_g AS delta_mag,\n    r.max_r,\n    r.min_r,\n    r.delta_mag_r AS delta_mag,\n    d.fid AS detection_fid\nFROM object o\nINNER JOIN g_band_variations g ON o.oid = g.oid\nINNER JOIN r_band_variations r ON o.oid = r.oid\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN detection d ON o.oid = d.oid\nWHERE p.class_name = 'AGN'\n  AND p.probability > 0.6\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\nORDER BY o.oid;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3301, "cache_read_input_tokens": 0, "input_tokens": 196, "output_tokens": 902, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3301, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "16-2", "response": "```sql\nWITH sn_objects AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n),\nearly_sept_objects AS (\n    SELECT s.oid, s.probability, o.firstmjd\n    FROM sn_objects s\n    INNER JOIN object o ON s.oid = o.oid\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections_with_nondetections AS (\n    SELECT \n        e.oid,\n        e.probability,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.fid,\n        d.isdiffpos,\n        NULL AS diffmaglim,\n        'detection' AS type\n    FROM early_sept_objects e\n    INNER JOIN detection d ON e.oid = d.oid\n    \n    UNION ALL\n    \n    SELECT \n        e.oid,\n        e.probability,\n        nd.mjd,\n        NULL AS magpsf,\n        NULL AS sigmapsf,\n        nd.fid,\n        NULL AS isdiffpos,\n        nd.diffmaglim,\n        'non_detection' AS type\n    FROM early_sept_objects e\n    INNER JOIN non_detection nd ON e.oid = nd.oid\n),\nfast_risers AS (\n    SELECT \n        e.oid,\n        e.probability,\n        e.firstmjd,\n        ms.fid AS magstat_fid,\n        ms.dmdt_first\n    FROM early_sept_objects e\n    INNER JOIN magstat ms ON e.oid = ms.oid\n    WHERE ms.dmdt_first >= 0.25\n)\nSELECT \n    d.oid,\n    d.probability,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid,\n    d.isdiffpos,\n    d.diffmaglim,\n    d.type,\n    f.magstat_fid,\n    f.dmdt_first\nFROM detections_with_nondetections d\nINNER JOIN fast_risers f ON d.oid = f.oid\nORDER BY d.oid, d.mjd\nLIMIT 100;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3109, "cache_read_input_tokens": 0, "input_tokens": 238, "output_tokens": 602, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3109, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "16-3", "response": "```sql\nWITH sn_objects AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n),\nearly_sept_objects AS (\n    SELECT s.oid, s.probability, o.firstmjd\n    FROM sn_objects s\n    INNER JOIN object o ON s.oid = o.oid\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT \n        e.oid, \n        e.probability,\n        d.fid,\n        d.isdiffpos,\n        d.magpsf_corr,\n        d.mjd AS detection_mjd,\n        nd.mjd AS non_detection_mjd,\n        nd.diffmaglim,\n        d.fid AS magstat_fid,\n        -- Calculate rise rate (magnitudes per day)\n        CASE \n            WHEN nd.mjd IS NOT NULL AND d.mjd > nd.mjd \n            THEN (nd.diffmaglim - d.magpsf_corr) / (d.mjd - nd.mjd)\n            ELSE NULL\n        END AS dmdt_first\n    FROM early_sept_objects e\n    INNER JOIN detection d ON e.oid = d.oid AND d.mjd = e.firstmjd\n    LEFT JOIN detection nd ON e.oid = nd.oid \n        AND nd.mjd < e.firstmjd \n        AND nd.fid = d.fid\n        AND nd.isdiffpos = 0  -- Non-detection\n    WHERE nd.mjd IS NOT NULL  -- Ensure there is a prior non-detection\n)\n\nSELECT \n    fr.oid,\n    fr.probability,\n    fr.fid,\n    fr.isdiffpos,\n    fr.magpsf_corr,\n    fr.detection_mjd,\n    fr.non_detection_mjd,\n    fr.diffmaglim,\n    fr.magstat_fid,\n    fr.dmdt_first\nFROM fast_risers fr\nWHERE fr.dmdt_first >= 0.25  -- Fast riser definition\nORDER BY fr.oid\nLIMIT 100;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3110, "cache_read_input_tokens": 0, "input_tokens": 238, "output_tokens": 583, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3110, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "16-4", "response": "```sql\nWITH sn_objects AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n),\nearly_sept_objects AS (\n    SELECT s.oid, s.probability, o.firstmjd\n    FROM sn_objects s\n    INNER JOIN object o ON s.oid = o.oid\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT \n        e.oid, \n        e.probability,\n        d.fid,\n        d.isdiffpos,\n        d.mjd AS detection_mjd,\n        d.magpsf,\n        d.sigmapsf,\n        nd.mjd AS non_detection_mjd,\n        nd.diffmaglim,\n        ms.fid AS magstat_fid,\n        ms.dmdt_first\n    FROM early_sept_objects e\n    INNER JOIN detection d ON e.oid = d.oid\n    LEFT JOIN non_detection nd ON e.oid = nd.oid\n    INNER JOIN magstat ms ON e.oid = ms.oid AND d.fid = ms.fid\n    WHERE ms.dmdt_first >= 0.25\n      AND nd.mjd < d.mjd  -- Non-detection before detection\n      AND d.fid = nd.fid  -- Same filter\n)\nSELECT *\nFROM fast_risers\nORDER BY oid\nLIMIT 100;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3114, "cache_read_input_tokens": 0, "input_tokens": 238, "output_tokens": 403, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3114, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "19-2", "response": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.firstmjd >= 59274.0 AND o.firstmjd <= 59305.0\n    AND o.ndet <= 1\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'asteroid'\n    AND p.probability > 0.7\n    AND p.ranking = 1\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2773, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 182, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2773, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "19-3", "response": "```sql\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.firstmjd >= 59274.0 AND o.firstmjd <= 59305.0  -- Between March 1st and April 1st, 2021\n    AND o.ndet <= 1  -- At most one detection\n    AND p.class_name = 'asteroid'  -- Classified as asteroid\n    AND p.classifier_name = 'stamp_classifier'  -- Using stamp classifier, not the default lc_classifier\n    AND p.probability > 0.7  -- Probability greater than 0.7\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2820, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 218, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2820, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "19-4", "response": "```sql\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.firstmjd >= 59274.0 AND o.firstmjd <= 59305.0  -- Between March 1st and April 1st, 2021\n    AND o.ndet <= 1  -- At most one detection (asteroids typically appear once as they move)\n    AND p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'  -- Using stamp classifier instead of default lc_classifier\n    AND p.probability > 0.7\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2815, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 211, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2815, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "14-2", "response": "```sql\nWITH target_objects AS (\n    SELECT unnest(ARRAY[\n        'ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',\n        'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',\n        'ZTF22aawasao', 'ZTF23aaxgvnt'\n    ]) AS oid\n)\nSELECT \n    d.oid,           -- unique object identifier\n    d.candid,        -- candidate identifier\n    d.fid,           -- filter identifier\n    d.mjd,           -- modified julian date\n    d.magpsf,        -- magnitude (point spread function difference magnitude)\n    d.sigmapsf,      -- magnitude error\n    d.has_stamp,     -- whether the object has stamps\n    d.drb,           -- deep learning real bogus score\n    ps.sgscore1,     -- star galaxy score of the nearest object\n    ps.distpsnr1     -- distance to the nearest source in panstarrs\nFROM \n    detection d\nJOIN \n    ps1_ztf ps ON d.candid = ps.candid\nJOIN \n    target_objects t ON d.oid = t.oid\nWHERE \n    d.drb > 0.5\n    AND (ps.sgscore1 < 0.5 OR ps.distpsnr1 < 1)\nORDER BY \n    d.oid, d.candid;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3005, "cache_read_input_tokens": 0, "input_tokens": 266, "output_tokens": 407, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3005, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "14-3", "response": "```sql\nWITH target_objects AS (\n    SELECT unnest(ARRAY[\n        'ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',\n        'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',\n        'ZTF22aawasao', 'ZTF23aaxgvnt'\n    ]) AS oid\n)\nSELECT \n    d.oid,                -- unique object identifier\n    d.candid,             -- candidate identifier\n    d.fid,                -- filter identifier\n    d.mjd,                -- modified julian date\n    d.magpsf_corr,        -- magnitude\n    d.sigmapsf_corr,      -- magnitude error\n    d.has_stamp,          -- whether the object has stamps\n    d.drb,                -- deep learning real bogus score\n    ps1.sgscore1,         -- star galaxy score of the nearest object\n    ps1.distpsnr1         -- distance to the nearest source in panstarrs\nFROM \n    detection d\nJOIN \n    ps1_ztf ps1 ON d.candid = ps1.candid\nWHERE \n    d.oid IN (SELECT oid FROM target_objects)\n    AND d.drb > 0.5\n    AND (ps1.sgscore1 < 0.5 OR ps1.distpsnr1 < 1)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2917, "cache_read_input_tokens": 0, "input_tokens": 266, "output_tokens": 395, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2917, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "14-4", "response": "```sql\nWITH target_oids AS (\n    SELECT unnest(ARRAY['ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',\n                         'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',\n                         'ZTF22aawasao', 'ZTF23aaxgvnt']) AS oid\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    d.has_stamp,\n    d.drb,\n    d.sgscore1,\n    d.distnr\nFROM \n    detection d\nJOIN \n    target_oids t ON d.oid = t.oid\nWHERE \n    d.drb > 0.5\n    AND (d.sgscore1 < 0.5 OR d.distnr < 1)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2815, "cache_read_input_tokens": 0, "input_tokens": 266, "output_tokens": 300, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2815, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "22-2", "response": "```sql\nSELECT object.*, probability.*\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE object.firstmjd >= 58239.0 \n  AND object.firstmjd <= 58270.0\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\nORDER BY object.firstmjd\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2717, "cache_read_input_tokens": 0, "input_tokens": 96, "output_tokens": 96, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2717, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "22-3", "response": "```sql\nSELECT object.*, probability.*\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE object.firstmjd >= 58239.0 \n  AND object.firstmjd <= 58270.0\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\nORDER BY object.firstmjd\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2735, "cache_read_input_tokens": 0, "input_tokens": 96, "output_tokens": 96, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2735, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "22-4", "response": "```sql\nSELECT object.*, probability.*\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE object.firstmjd >= 58239.0 \n  AND object.firstmjd <= 58270.0\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\nORDER BY object.firstmjd\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2735, "cache_read_input_tokens": 0, "input_tokens": 96, "output_tokens": 96, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2735, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "12-2", "response": "```sql\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2842, "cache_read_input_tokens": 0, "input_tokens": 144, "output_tokens": 192, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2842, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "12-3", "response": "```sql\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    -- Time range condition\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    -- Spatial condition using q3c polygon query\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    -- Classification condition for supernovae\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2850, "cache_read_input_tokens": 0, "input_tokens": 144, "output_tokens": 219, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2850, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "12-4", "response": "```sql\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    -- Time filter for first detection between Feb 13 and Sep 10, 2023\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    -- Spatial filter using polygon\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    -- Classification filter for all types of supernovae\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2821, "cache_read_input_tokens": 0, "input_tokens": 144, "output_tokens": 231, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2821, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "89-2", "response": "```sql\n-- Find at most 50 ZTF objects that have a probability larger than 0.7 of being supernovae in the stamp classifier\n-- Note: There is no 'dataquality' table in the provided schema, so I'm returning data from the available tables\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'  -- Supernovae class\n  AND p.probability > 0.7\n  AND p.ranking = 1  -- Most likely classification\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2754, "cache_read_input_tokens": 0, "input_tokens": 78, "output_tokens": 160, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2754, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "89-3", "response": "```sql\n/* Find at most 50 ZTF objects with probability > 0.7 of being supernovae in the stamp classifier */\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'SN'\nAND p.classifier_name = 'stamp_classifier'\nAND p.probability > 0.7\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2745, "cache_read_input_tokens": 0, "input_tokens": 78, "output_tokens": 104, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2745, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "89-4", "response": "```sql\n-- Find ZTF objects with high probability of being supernovae using stamp classifier\n-- Note: The dataquality table is not in the provided schema, so this query assumes\n-- it exists and has an oid column that can be joined with the probability table\n\nSELECT dq.*\nFROM dataquality dq\nINNER JOIN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND class_name = 'SN'\n    AND probability > 0.7\n    AND ranking = 1\n) p ON dq.oid = p.oid\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2835, "cache_read_input_tokens": 0, "input_tokens": 78, "output_tokens": 150, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2835, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "103-2", "response": "```sql\nWITH ps1_distances AS (\n    SELECT \n        oid,\n        MIN(distpsnr1) AS min_distpsnr1\n    FROM \n        ps1_ztf\n    WHERE \n        distpsnr1 > 5\n    GROUP BY \n        oid\n)\n\nSELECT \n    o.*,\n    p.*,\n    ps1.*\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    ps1_ztf ps1 ON o.oid = ps1.oid\nINNER JOIN \n    ps1_distances pd ON o.oid = pd.oid AND ps1.distpsnr1 = pd.min_distpsnr1\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.7\n    AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\nORDER BY \n    ps1.distpsnr1 ASC\nLIMIT 200;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2979, "cache_read_input_tokens": 0, "input_tokens": 135, "output_tokens": 288, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2979, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "103-3", "response": "```sql\nSELECT o.*, p.*, ps.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN ps1_ztf ps ON o.oid = ps.oid\nWHERE ps.distpsnr1 > 5\n  AND p.probability > 0.7\n  AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\nORDER BY ps.distpsnr1\nLIMIT 200\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2936, "cache_read_input_tokens": 0, "input_tokens": 135, "output_tokens": 156, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2936, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "103-4", "response": "```sql\nSELECT o.*, p.*, ps.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN ps1_ztf ps ON o.oid = ps.oid\nWHERE ps.distpsnr1 > 5\n  AND p.probability > 0.7\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\nORDER BY ps.distpsnr1\nLIMIT 200;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2839, "cache_read_input_tokens": 0, "input_tokens": 135, "output_tokens": 157, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2839, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "99-2", "response": "```sql\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability = 1\n  AND p.ranking = 1\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2777, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 125, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2777, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "99-3", "response": "```sql\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability = 1\n  AND p.ranking = 1\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2776, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 125, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2776, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "99-4", "response": "```sql\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability = 1\n  AND p.ranking = 1\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2800, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 125, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2800, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "92-2", "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND o.oid IN (\n        SELECT \n            oid\n        FROM \n            detection\n        WHERE \n            fid = 1 -- g band\n            AND dubious = FALSE\n        GROUP BY \n            oid\n        HAVING \n            COUNT(*) >= 10\n    )\nORDER BY \n    o.oid\nLIMIT 500;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2684, "cache_read_input_tokens": 0, "input_tokens": 109, "output_tokens": 184, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2684, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "92-3", "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND o.oid IN (\n        SELECT \n            oid\n        FROM \n            detection\n        WHERE \n            fid = 1 -- g band\n            AND dubious = FALSE\n        GROUP BY \n            oid\n        HAVING \n            COUNT(*) >= 10\n    )\nORDER BY \n    o.oid\nLIMIT 500;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2707, "cache_read_input_tokens": 0, "input_tokens": 109, "output_tokens": 184, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2707, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "92-4", "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND o.oid IN (\n        SELECT \n            oid\n        FROM \n            detection\n        WHERE \n            fid = 1 -- g band\n            AND dubious = FALSE\n        GROUP BY \n            oid\n        HAVING \n            COUNT(*) >= 10\n    )\nORDER BY \n    o.oid\nLIMIT 500;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2703, "cache_read_input_tokens": 0, "input_tokens": 109, "output_tokens": 184, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2703, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "102-2", "response": "```sql\nSELECT m.*\nFROM magstat m\nINNER JOIN (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN xmatch x ON p.oid = x.oid\n    INNER JOIN allwise w ON x.oid_catalog = w.oid_catalog\n    WHERE p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND w.w1mpro BETWEEN 12 AND 13\n) filtered_objects ON m.oid = filtered_objects.oid\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2861, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 164, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2861, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "102-3", "response": "```sql\nSELECT m.*\nFROM probability p\nJOIN xmatch x ON p.oid = x.oid\nJOIN allwise w ON x.catid = w.cntr\nJOIN magstat m ON p.oid = m.oid\nWHERE p.class_name = 'AGN'\n  AND p.probability > 0.6\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND w.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2817, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 133, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2817, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "102-4", "response": "```sql\nSELECT m.*\nFROM probability p\nJOIN xmatch x ON p.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nJOIN magstat m ON p.oid = m.oid\nWHERE p.class_name = 'AGN'\n  AND p.probability > 0.6\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND w.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2823, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 137, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2823, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "104-2", "response": "```sql\nSELECT \n    p.oid,\n    d.candid,\n    d.ssdistnr,\n    d.ssmagnr,\n    d.ssnamenr,\n    d.fid AS filter_id,\n    d.fwhm,\n    d.nid AS ps1_calibrators,\n    d.exptime\nFROM \n    probability p\nINNER JOIN \n    detection d ON p.oid = d.oid\nWHERE \n    p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\nLIMIT 30;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2900, "cache_read_input_tokens": 0, "input_tokens": 141, "output_tokens": 184, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2900, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "104-3", "response": "```sql\nSELECT \n    p.oid,\n    d.candid,\n    d.ssdistnr,\n    d.ssmagnr,\n    d.ssnamenr,\n    d.fid AS filter_id,\n    d.fwhm,\n    d.nmc AS num_ps1_calibrators,\n    d.exptime\nFROM \n    probability p\nINNER JOIN \n    detection d ON p.oid = d.oid\nWHERE \n    p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\nLIMIT 30;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2903, "cache_read_input_tokens": 0, "input_tokens": 141, "output_tokens": 186, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2903, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "104-4", "response": "```sql\nSELECT \n    p.oid,\n    d.candid,\n    d.ssdistnr,\n    d.ssmagnr,\n    d.ssnamenr,\n    d.fid AS filter_identifier,\n    d.fwhm AS fwhm_sextractor,\n    d.nmc AS num_ps1_calibrators,\n    d.exptime AS exposure_time\nFROM \n    probability p\nINNER JOIN \n    detection d ON p.oid = d.oid\nWHERE \n    p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\nLIMIT 30\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2885, "cache_read_input_tokens": 0, "input_tokens": 141, "output_tokens": 197, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2885, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "107-2", "response": "```sql\n-- Query to find ZTF objects that are likely asteroids with specific conditions\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.lastmjd AS \"last detection date\",\n    p.probability AS \"probability\",\n    d.candid AS \"candidate identifier\",\n    d.distnr AS \"distance between ZTF object and MPC object\",\n    d.rb AS \"MPC name\", -- Using rb as a placeholder for MPC name as it's not in the schema\n    d.mjd AS \"detection date\",\n    d.fid AS \"filter identifier\"\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    o.ndet > 500\n    AND p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.5\n    AND d.distnr < 2 -- Using distnr as the distance to nearest source\nORDER BY \n    o.firstmjd\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3236, "cache_read_input_tokens": 0, "input_tokens": 160, "output_tokens": 329, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3236, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "107-3", "response": "```sql\n-- Query to find ZTF objects that are likely asteroids with specific conditions\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.lastmjd AS \"last detection date\",\n    p.probability AS \"probability\",\n    d.candid AS \"candidate identifier\",\n    d.distnr AS \"distance between ZTF object and MPC object\",\n    d.ra AS \"MPC name\", -- Note: Using ra as placeholder since MPC name isn't in the schema\n    d.mjd AS \"detection date\",\n    d.fid AS \"filter identifier\"\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    o.ndet > 500\n    AND p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.5\n    AND d.distnr < 2 -- Using distnr as the distance to nearest object in reference image\nORDER BY \n    o.firstmjd\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3281, "cache_read_input_tokens": 0, "input_tokens": 160, "output_tokens": 331, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3281, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "107-4", "response": "```sql\n-- Find ZTF objects that are likely asteroids with specific conditions\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.lastmjd AS \"last detection date\",\n    p.probability AS \"probability\",\n    d.candid AS \"candidate identifier\",\n    d.distnr AS \"distance between ZTF object and MPC object\",\n    d.ra AS \"MPC name\", -- Note: Using ra as placeholder since MPC name isn't in schema\n    d.mjd AS \"detection date\",\n    d.fid AS \"filter identifier\"\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    o.ndet > 500\n    AND p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.5\n    AND d.distnr < 2 -- Using distnr as the distance to nearest object\nORDER BY \n    o.firstmjd\nLIMIT 10;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3254, "cache_read_input_tokens": 0, "input_tokens": 160, "output_tokens": 325, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3254, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "83-2", "response": "```sql\n/* \nThis query retrieves all columns from the allwise table for the ZTF object 'ZTF21aazqwxv'.\nSince the allwise table is not provided in the schema, this query assumes:\n1. An allwise table exists in the database\n2. There's a spatial match between ZTF objects and ALLWISE catalog using coordinates\n3. The q3c_join function is available for spatial matching\n*/\n\nSELECT a.*\nFROM allwise a\nJOIN object o ON q3c_join(a.ra, a.dec, o.meanra, o.meandec, 0.0003)\nWHERE o.oid = 'ZTF21aazqwxv';\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2936, "cache_read_input_tokens": 0, "input_tokens": 61, "output_tokens": 171, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2936, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "83-3", "response": "```sql\n/* \n   This query retrieves all columns from the allwise table for ZTF object 'ZTF21aazqwxv'.\n   Since the allwise table isn't directly provided in the schema, we need to join through\n   a cross-match table that would connect ZTF objects to ALLWISE catalog entries.\n*/\n\nSELECT a.*\nFROM object o\nJOIN xmatch x ON o.oid = x.oid\nJOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE o.oid = 'ZTF21aazqwxv';\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2872, "cache_read_input_tokens": 0, "input_tokens": 61, "output_tokens": 147, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2872, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "83-4", "response": "```sql\n/* This query retrieves all columns from the allwise table for ZTF object 'ZTF21aazqwxv' */\n/* Note: Since the allwise table is not provided in the schema, this query assumes:\n   1. An allwise table exists in the database\n   2. There's a spatial match between object coordinates and allwise coordinates\n   3. Using q3c_join for spatial matching with a 3 arcsec radius (0.00083 degrees) */\n\nWITH ztf_object AS (\n    SELECT meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21aazqwxv'\n)\n\nSELECT allwise.*\nFROM allwise\nJOIN ztf_object ON q3c_join(allwise.ra, allwise.dec, ztf_object.meanra, ztf_object.meandec, 0.00083)\nORDER BY q3c_dist(allwise.ra, allwise.dec, ztf_object.meanra, ztf_object.meandec) ASC\nLIMIT 1;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2929, "cache_read_input_tokens": 0, "input_tokens": 61, "output_tokens": 265, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2929, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "84-2", "response": "```sql\nSELECT \n    xm.oid AS ztf_id,\n    xm.oid_catalog AS allwise_id,\n    xm.dist AS distance,\n    aw.w1mpro AS w1_magnitude,\n    aw.w2mpro AS w2_magnitude,\n    aw.w3mpro AS w3_magnitude,\n    aw.w4mpro AS w4_magnitude\nFROM \n    xmatch xm\nJOIN \n    allwise aw ON xm.oid_catalog = aw.oid_catalog\nWHERE \n    xm.oid = 'ZTF19aascdol'\n    AND xm.catid = 'ALLWISE'\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2804, "cache_read_input_tokens": 0, "input_tokens": 112, "output_tokens": 179, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2804, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "84-3", "response": "```sql\nSELECT \n    xmatch.oid AS ztf_identifier,\n    xmatch.oid_catalog AS allwise_identifier,\n    xmatch.dist AS distance_arcsec,\n    allwise.w1mpro AS w1_magnitude,\n    allwise.w2mpro AS w2_magnitude,\n    allwise.w3mpro AS w3_magnitude,\n    allwise.w4mpro AS w4_magnitude\nFROM \n    xmatch\nJOIN \n    allwise ON xmatch.oid_catalog = allwise.oid_catalog\nWHERE \n    xmatch.oid = 'ZTF19aascdol'\n    AND xmatch.catalog_name = 'ALLWISE'\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2771, "cache_read_input_tokens": 0, "input_tokens": 112, "output_tokens": 186, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2771, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "84-4", "response": "```sql\n-- Query to retrieve ALLWISE match information for ZTF object ZTF19aascdol\nSELECT \n    x.oid AS ztf_id,           -- ZTF identifier\n    x.oid_catalog AS allwise_id, -- ALLWISE catalog identifier\n    x.dist AS distance,         -- Distance between counterparts\n    a.w1mpro AS w1_magnitude,   -- WISE W1 filter magnitude\n    a.w2mpro AS w2_magnitude,   -- WISE W2 filter magnitude\n    a.w3mpro AS w3_magnitude,   -- WISE W3 filter magnitude\n    a.w4mpro AS w4_magnitude    -- WISE W4 filter magnitude\nFROM \n    xmatch x\nJOIN \n    allwise a ON x.oid_catalog = a.oid_catalog\nWHERE \n    x.oid = 'ZTF19aascdol' \n    AND x.catid = 'ALLWISE'\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2763, "cache_read_input_tokens": 0, "input_tokens": 112, "output_tokens": 244, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2763, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "96-2", "response": "```sql\nWITH solar_system_objects AS (\n    SELECT '2003FP134' AS ssnamenr\n    UNION ALL\n    SELECT '2009UK56' AS ssnamenr\n)\n\nSELECT \n    ss.*, -- All columns from ss_ztf\n    d.mjd, -- Detection date\n    d.fid, -- Filter identifier\n    d.isdiffpos, -- Flag\n    d.ra, d.dec, -- Coordinates\n    d.magpsf, -- Difference magnitude\n    d.sigmapsf -- Difference magnitude uncertainty\nFROM \n    ss_ztf ss\nJOIN \n    detection d ON ss.oid = d.oid\nJOIN \n    solar_system_objects sso ON ss.ssnamenr = sso.ssnamenr\nWHERE \n    -- Within 2 arcseconds (2/3600 = 0.0005556 degrees)\n    q3c_join(ss.ra, ss.dec, d.ra, d.dec, 0.0005556)\nORDER BY \n    ss.ssnamenr, -- Sort by MPC name\n    d.mjd ASC -- Sort by detection date\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2815, "cache_read_input_tokens": 0, "input_tokens": 129, "output_tokens": 284, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2815, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "96-3", "response": "```sql\nWITH target_ss_objects AS (\n    SELECT '2003FP134' AS ssnamenr\n    UNION ALL\n    SELECT '2009UK56' AS ssnamenr\n)\n\nSELECT \n    ss.oid, \n    ss.candid, \n    ss.ssdistnr, \n    ss.ssmagnr, \n    ss.ssnamenr,\n    d.mjd, \n    d.fid, \n    d.isdiffpos, \n    d.ra, \n    d.dec, \n    d.magpsf, \n    d.sigmapsf\nFROM \n    ss_ztf ss\nINNER JOIN \n    detection d ON ss.oid = d.oid\nWHERE \n    ss.ssnamenr IN (SELECT ssnamenr FROM target_ss_objects)\n    AND ss.ssdistnr < 2 -- distance less than 2 arcsec\nORDER BY \n    ss.ssnamenr, \n    d.mjd\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2837, "cache_read_input_tokens": 0, "input_tokens": 129, "output_tokens": 256, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2837, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "96-4", "response": "```sql\nWITH solar_system_objects AS (\n    SELECT '2003FP134' AS ssnamenr\n    UNION ALL\n    SELECT '2009UK56' AS ssnamenr\n)\n\nSELECT \n    ss.*, -- All columns from ss_ztf\n    d.mjd, -- Detection date\n    d.fid, -- Filter identifier\n    d.isdiffpos, -- isdiffpos flag\n    d.ra, -- RA coordinate\n    d.dec, -- Dec coordinate\n    d.magpsf, -- Difference magnitude\n    d.sigmapsf -- Difference magnitude uncertainty\nFROM \n    ss_ztf ss\nJOIN \n    detection d ON ss.oid = d.oid\nWHERE \n    ss.ssnamenr IN (SELECT ssnamenr FROM solar_system_objects)\n    AND ss.ssdistnr <= 2 -- Within 2 arcsec\nORDER BY \n    ss.ssnamenr, -- Sort by MPC name\n    d.mjd -- Sort by detection date\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2764, "cache_read_input_tokens": 0, "input_tokens": 129, "output_tokens": 252, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2764, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "94-2", "response": "```sql\n-- Query to retrieve all columns from object table for objects with reference changes\n-- Note: There is no 'reference' table in the provided schema, so we're only querying the object table\nSELECT *\nFROM object\nWHERE reference_change = TRUE\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2719, "cache_read_input_tokens": 0, "input_tokens": 71, "output_tokens": 67, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2719, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "94-3", "response": "```sql\nSELECT o.*\nFROM object o\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2708, "cache_read_input_tokens": 0, "input_tokens": 71, "output_tokens": 30, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2708, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "94-4", "response": "```sql\nSELECT object.*, reference.*\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2754, "cache_read_input_tokens": 0, "input_tokens": 71, "output_tokens": 47, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2754, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "90-2", "response": "```sql\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (\n    SELECT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n    AND f.value < 5\n    AND f.version = 'lc_classifier_1.2.1-P'\n)\nAND p.classifier_name = 'lc_classifier'\nAND p.ranking IN (1, 2)\nLIMIT 100;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2738, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 116, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2738, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "90-3", "response": "```sql\n-- Find objects with multiband period < 5 days and their top 2 probability rankings\nSELECT p.*\nFROM probability p\nJOIN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n) f ON p.oid = f.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2748, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 135, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2748, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "90-4", "response": "```sql\nWITH period_objects AS (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nJOIN period_objects po ON p.oid = po.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2783, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 123, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2783, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "100-2", "response": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    magpsf AS \"detection difference magnitude\",\n    sigmapsf AS \"uncertainty\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    'detection' AS \"table\"\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    NULL AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"uncertainty\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    'non_detection' AS \"table\"\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"uncertainty\",\n    mag AS \"forced difference magnitude\",\n    e_mag AS \"forced uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    'forced_photometry' AS \"table\"\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    \"epoch date\";\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2961, "cache_read_input_tokens": 0, "input_tokens": 138, "output_tokens": 422, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2961, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "100-3", "response": "```sql\n-- Query to retrieve all detections, non-detections and forced photometry points for ZTF24aamtvxb\n-- Note: This query assumes the existence of non_detection and forced_photometry tables\n-- which were not included in the provided schema\n\n-- Get detections\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diff_mag,\n    sigmapsf AS diff_mag_err,\n    NULL AS forced_mag,\n    NULL AS forced_mag_err,\n    diffmaglim AS mag_limit,\n    'detection' AS \"table\"\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Get non-detections (assuming this table exists)\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diff_mag,\n    NULL AS diff_mag_err,\n    NULL AS forced_mag,\n    NULL AS forced_mag_err,\n    diffmaglim AS mag_limit,\n    'non_detection' AS \"table\"\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Get forced photometry (assuming this table exists)\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    NULL AS diff_mag,\n    NULL AS diff_mag_err,\n    mag AS forced_mag,\n    e_mag AS forced_mag_err,\n    diffmaglim AS mag_limit,\n    'forced_photometry' AS \"table\"\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    epoch_date;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3016, "cache_read_input_tokens": 0, "input_tokens": 138, "output_tokens": 493, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3016, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "100-4", "response": "```sql\n-- Query to retrieve all detections, non-detections and forced photometry points for ZTF24aamtvxb\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    isdiffpos,\n    magpsf AS detection_diff_mag,\n    sigmapsf AS detection_mag_uncertainty,\n    diffmaglim AS five_sigma_mag_limit,\n    NULL AS forced_diff_mag,\n    NULL AS forced_mag_uncertainty,\n    'detection' AS \"table\"\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    NULL AS isdiffpos,\n    NULL AS detection_diff_mag,\n    NULL AS detection_mag_uncertainty,\n    diffmaglim AS five_sigma_mag_limit,\n    NULL AS forced_diff_mag,\n    NULL AS forced_mag_uncertainty,\n    'non_detection' AS \"table\"\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    isdiffpos,\n    NULL AS detection_diff_mag,\n    NULL AS detection_mag_uncertainty,\n    diffmaglim AS five_sigma_mag_limit,\n    mag AS forced_diff_mag,\n    e_mag AS forced_mag_uncertainty,\n    'forced_photometry' AS \"table\"\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    epoch_date;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 3045, "cache_read_input_tokens": 0, "input_tokens": 138, "output_tokens": 458, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3045, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "106-2", "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    p_stamp.probability AS \"prob_stamp_bogus\",\n    p_lc.probability AS \"prob_lc_transient\"\nFROM \n    object o\nINNER JOIN \n    probability p_stamp ON o.oid = p_stamp.oid\nINNER JOIN \n    probability p_lc ON o.oid = p_lc.oid\nWHERE \n    o.ndet > 10\n    AND p_stamp.class_name = 'bogus'\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.7\n    AND p_lc.class_name = 'Transient'\n    AND p_lc.classifier_name = 'lc_classifier_top'\n    AND p_lc.probability > 0.9\nORDER BY \n    o.oid\nLIMIT 30;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2797, "cache_read_input_tokens": 0, "input_tokens": 194, "output_tokens": 289, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2797, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "106-3", "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    p_stamp.probability AS \"prob_stamp_bogus\",\n    p_lc.probability AS \"prob_lc_transient\"\nFROM \n    object o\nINNER JOIN \n    probability p_stamp ON o.oid = p_stamp.oid\nINNER JOIN \n    probability p_lc ON o.oid = p_lc.oid\nWHERE \n    o.ndet > 10\n    AND p_stamp.class_name = 'bogus'\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.7\n    AND p_lc.class_name = 'Transient'\n    AND p_lc.classifier_name = 'lc_classifier_top'\n    AND p_lc.ranking = 1\n    AND p_lc.probability > 0.9\nORDER BY \n    o.oid\nLIMIT 30;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2815, "cache_read_input_tokens": 0, "input_tokens": 194, "output_tokens": 301, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2815, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "106-4", "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    p_stamp.probability AS \"prob_stamp_bogus\",\n    p_lc.probability AS \"prob_lc_transient\"\nFROM \n    object o\nJOIN \n    probability p_stamp ON o.oid = p_stamp.oid\nJOIN \n    probability p_lc ON o.oid = p_lc.oid\nWHERE \n    o.ndet > 10\n    AND p_stamp.class_name = 'bogus'\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.7\n    AND p_stamp.ranking = 1\n    AND p_lc.class_name = 'Transient'\n    AND p_lc.classifier_name = 'lc_classifier_top'\n    AND p_lc.probability > 0.9\n    AND p_lc.ranking = 1\nORDER BY \n    o.oid\nLIMIT 30;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2797, "cache_read_input_tokens": 0, "input_tokens": 194, "output_tokens": 308, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2797, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "58-2", "response": "```sql\nWITH min_magnitudes AS (\n    SELECT \n        oid,\n        MIN(CASE WHEN fid = 1 THEN magpsf_corr END) AS min_g_mag,\n        MIN(CASE WHEN fid = 2 THEN magpsf_corr END) AS min_r_mag\n    FROM \n        detection\n    WHERE \n        magpsf_corr IS NOT NULL\n    GROUP BY \n        oid\n    HAVING \n        MIN(CASE WHEN fid = 1 THEN magpsf_corr END) IS NOT NULL AND\n        MIN(CASE WHEN fid = 2 THEN magpsf_corr END) IS NOT NULL\n)\n\nSELECT \n    o.*\nFROM \n    object o\nINNER JOIN \n    min_magnitudes m ON o.oid = m.oid\nWHERE \n    o.ndet >= 30 AND\n    o.deltajd > 20 AND\n    (m.min_g_mag - m.min_r_mag) > 3.5\nLIMIT 20;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2843, "cache_read_input_tokens": 0, "input_tokens": 104, "output_tokens": 270, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2843, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "58-3", "response": "```sql\nWITH min_magnitudes AS (\n    SELECT \n        oid,\n        MIN(CASE WHEN fid = 1 THEN magpsf_corr END) AS min_g_mag,\n        MIN(CASE WHEN fid = 2 THEN magpsf_corr END) AS min_r_mag\n    FROM \n        detection\n    WHERE \n        magpsf_corr IS NOT NULL\n    GROUP BY \n        oid\n    HAVING \n        MIN(CASE WHEN fid = 1 THEN magpsf_corr END) IS NOT NULL AND\n        MIN(CASE WHEN fid = 2 THEN magpsf_corr END) IS NOT NULL\n)\n\nSELECT \n    o.*\nFROM \n    object o\nINNER JOIN \n    min_magnitudes m ON o.oid = m.oid\nWHERE \n    o.ndet >= 30 AND\n    o.deltajd > 20 AND\n    (m.min_g_mag - m.min_r_mag) > 3.5\nLIMIT 20;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2861, "cache_read_input_tokens": 0, "input_tokens": 104, "output_tokens": 270, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2861, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "58-4", "response": "```sql\nWITH min_magnitudes AS (\n    SELECT \n        oid,\n        MIN(CASE WHEN fid = 1 THEN magpsf_corr END) AS min_g_mag,\n        MIN(CASE WHEN fid = 2 THEN magpsf_corr END) AS min_r_mag\n    FROM \n        detection\n    WHERE \n        magpsf_corr IS NOT NULL\n    GROUP BY \n        oid\n    HAVING \n        MIN(CASE WHEN fid = 1 THEN magpsf_corr END) IS NOT NULL AND\n        MIN(CASE WHEN fid = 2 THEN magpsf_corr END) IS NOT NULL\n)\n\nSELECT \n    o.*\nFROM \n    object o\nINNER JOIN \n    min_magnitudes m ON o.oid = m.oid\nWHERE \n    o.ndet >= 30 AND\n    o.deltajd > 20 AND\n    (m.min_g_mag - m.min_r_mag) > 3.5\nLIMIT 20;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2863, "cache_read_input_tokens": 0, "input_tokens": 104, "output_tokens": 270, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2863, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "39-2", "response": "```sql\nSELECT \n    d.oid, \n    d.candid, \n    d.fid AS f_id, \n    d.ra, \n    d.dec, \n    d.magpsf_corr AS magnitude, \n    d.sigmapsf_corr AS magnitude_error,\n    MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS max_rise_from_min\nFROM \n    detection d\nINNER JOIN \n    object o ON d.oid = o.oid\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'CV/Nova'\n    AND p.classifier_name = 'lc_classifier_stochastic'\n    AND p.ranking = 1\n    AND o.ndet <= 50\n    AND d.fid = 2  -- r-band filter\nGROUP BY \n    d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf_corr, d.sigmapsf_corr\nORDER BY \n    d.oid\nLIMIT 1000;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2885, "cache_read_input_tokens": 0, "input_tokens": 165, "output_tokens": 294, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2885, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "39-3", "response": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf_corr AS magnitude,\n    d.sigmapsf_corr AS magnitude_error,\n    (MAX(d.magpsf_corr) OVER (PARTITION BY o.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY o.oid)) AS max_rise_from_min\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    p.class_name = 'CV/Nova' \n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier_stochastic'\n    AND o.ndet <= 50\n    AND d.fid = 2 -- r-band filter\nORDER BY \n    o.oid\nLIMIT 1000;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2885, "cache_read_input_tokens": 0, "input_tokens": 165, "output_tokens": 266, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2885, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "39-4", "response": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    o.meanra, o.meandec,\n    d.ra, d.dec,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    MAX(d.magpsf_corr) OVER (PARTITION BY o.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY o.oid) AS max_rise_from_min\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    p.class_name = 'CV/Nova'\n    AND p.classifier_name = 'lc_classifier_stochastic'\n    AND p.ranking = 1\n    AND o.ndet <= 50\n    AND d.fid = 2 -- r-band filter\nORDER BY \n    o.oid\nLIMIT 1000;\n```", "model": "claude-3-7-sonnet-20250219", "usage": {"cache_creation_input_tokens": 2976, "cache_read_input_tokens": 0, "input_tokens": 165, "output_tokens": 269, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2976, "ephemeral_1h_input_tokens": 0}}}
