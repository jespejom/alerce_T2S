{"id": "batch_req_690f283f75c88190a7838cbf9b47f653", "custom_id": "8-5", "response": {"status_code": 200, "request_id": "d33cd299a8ace0e9812d5924a0ffee46", "body": {"id": "chatcmpl-CZawcs9vFktoX4gDLd3k6KSYWhEev", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects first detected (and thus first stamp-classified) between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0)\n-- Classified as 'SN' by the stamp classifier (ranking=1), with probability > 0.5 OR at least 2 detections\nSELECT\n    *\nFROM\n    object o\nINNER JOIN\n    probability p\n    ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND (p.probability > 0.5 OR o.ndet >= 2);\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3037, "completion_tokens": 2169, "total_tokens": 5206, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1984, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2840e470819081ba12e531ca5cb5", "custom_id": "8-9", "response": {"status_code": 200, "request_id": "f64fd017aeb519853fe275ff92c8da0f", "body": {"id": "chatcmpl-CZb4PRHjRaurSed0lWa31kKiYQcTV", "object": "chat.completion", "created": 1762600013, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects first classified as SN by the stamp classifier between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0)\n-- Include if probability > 0.5 OR at least two detections\nSELECT\n  p.*,\n  o.*\nFROM probability AS p\nINNER JOIN object AS o\n  ON o.oid = p.oid\nWHERE\n  p.classifier_name = 'stamp_classifier' -- override default lc_classifier\n  AND p.class_name = 'SN'\n  AND p.ranking = 1 -- keep only the top-ranked class\n  AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND (p.probability > 0.5 OR o.ndet >= 2);\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3111, "completion_tokens": 1593, "total_tokens": 4704, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283f722c8190ae25d9de060aeed6", "custom_id": "27-6", "response": {"status_code": 200, "request_id": "755df7691c5a9bebc3cbcb9c445278c6", "body": {"id": "chatcmpl-CZb31NJmVaHoNyaveacsa5BMj4wAB", "object": "chat.completion", "created": 1762599927, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects with ndet >= 100 whose top lc_classifier class is 'CEP' with probability > 0.76,\n-- and return all lc_classifier class probabilities for those objects (latest classifier_version).\nWITH latest AS (\n    SELECT MAX(classifier_version) AS latest_version\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n),\ntopcep AS (\n    SELECT p.oid\n    FROM probability p\n    JOIN latest v ON p.classifier_version = v.latest_version\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name = 'CEP'\n      AND p.probability > 0.76\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_max,\n    pr.classifier_name,\n    pr.class_name,\n    pr.ranking,\n    pr.probability\nFROM topcep t\nJOIN object o ON o.oid = t.oid\nJOIN probability pr ON pr.oid = o.oid\nJOIN latest v ON pr.classifier_version = v.latest_version\nWHERE o.ndet >= 100\n  AND pr.classifier_name = 'lc_classifier'\nORDER BY o.oid ASC, pr.ranking ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3439, "completion_tokens": 2403, "total_tokens": 5842, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2112, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283f61e08190ba8dcc6e0b1a0db8", "custom_id": "27-7", "response": {"status_code": 200, "request_id": "65dfe5f8bfa75b56ab1f95b218a1c7c9", "body": {"id": "chatcmpl-CZazWLlJIIo1WX5GtODyByv9G6gGL", "object": "chat.completion", "created": 1762599710, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all lc_classifier class probabilities for objects whose rank-1 lc_classifier class is 'CEP' with probability > 0.76\n-- and have at least 100 detections. Include specified columns from object and probability.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_max,\n    p_all.classifier_name,\n    p_all.class_name,\n    p_all.ranking,\n    p_all.probability\nFROM object AS o\nINNER JOIN (\n    SELECT\n        oid,\n        classifier_version,\n        probability\n    FROM probability\n    WHERE\n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n        AND class_name = 'CEP'\n        AND probability > 0.76\n) AS p_top\n    ON p_top.oid = o.oid\nINNER JOIN probability AS p_all\n    ON p_all.oid = o.oid\n    AND p_all.classifier_name = 'lc_classifier'\n    AND p_all.classifier_version = p_top.classifier_version\nWHERE\n    o.ndet >= 100\nORDER BY\n    p_top.probability DESC,\n    o.oid ASC,\n    p_all.ranking ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3210, "completion_tokens": 1369, "total_tokens": 4579, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283f65d48190ab59a7317bcefff7", "custom_id": "27-8", "response": {"status_code": 200, "request_id": "ff98778cd778c25f59039b65f898a184", "body": {"id": "chatcmpl-CZb8d4IpqxUEWrbwqQSjiVqWOHK63", "object": "chat.completion", "created": 1762600275, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects with ndet >= 100 whose top lc_classifier class is 'CEP' with probability > 0.76,\n-- returning all lc_classifier class probabilities per qualifying object.\nSELECT\n  o.oid,\n  o.meanra,\n  o.meandec,\n  o.ndet,\n  o.firstmjd,\n  o.deltajd,\n  o.g_r_max,\n  p.classifier_name,\n  p.class_name,\n  p.ranking,\n  p.probability\nFROM object AS o\nINNER JOIN probability AS p\n  ON p.oid = o.oid\nWHERE\n  o.ndet >= 100\n  AND p.classifier_name = 'lc_classifier'\n  AND EXISTS (\n    SELECT 1\n    FROM probability AS pr\n    WHERE\n      pr.oid = o.oid\n      AND pr.classifier_name = 'lc_classifier'\n      AND pr.ranking = 1\n      AND pr.class_name = 'CEP'\n      AND pr.probability > 0.76\n  )\nORDER BY o.oid ASC, p.ranking ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3244, "completion_tokens": 1773, "total_tokens": 5017, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1536, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283f64b48190816b92c1d6878486", "custom_id": "27-9", "response": {"status_code": 200, "request_id": "5a2def946d7afe4a58e7be9472fbeb98", "body": {"id": "chatcmpl-CZb4P36HI4wWyVoUbvPohsU6xaike", "object": "chat.completion", "created": 1762600013, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects most likely classified as Cepheid (CEP) by lc_classifier with probability > 0.76 and ndet >= 100,\n-- listing all lc_classifier classes (all rankings) per selected object.\nWITH cep_candidates AS (\n    SELECT p.oid\n    FROM probability AS p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name = 'CEP'\n      AND p.probability > 0.76\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_max,\n    p_all.classifier_name,\n    p_all.class_name,\n    p_all.ranking,\n    p_all.probability\nFROM cep_candidates AS c\nINNER JOIN object AS o\n    ON o.oid = c.oid\nINNER JOIN probability AS p_all\n    ON p_all.oid = o.oid\nWHERE o.ndet >= 100\n  AND p_all.classifier_name = 'lc_classifier'\nORDER BY o.oid ASC, p_all.ranking ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3272, "completion_tokens": 1215, "total_tokens": 4487, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28409b6481909f51a24e2a6ee57d", "custom_id": "17-5", "response": {"status_code": 200, "request_id": "eb695be12517a0e743c6c30dc04d22e1", "body": {"id": "chatcmpl-CZb3Q3qcrTnwxud2FyPKm1n3EEFTN", "object": "chat.completion", "created": 1762599952, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 4000, "total_tokens": 7016, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283fac6c81909ca3969a9bbadef9", "custom_id": "17-6", "response": {"status_code": 200, "request_id": "9e5d504d7df96eece95d01de2446e1f5", "body": {"id": "chatcmpl-CZb1WtndQPH4MtYYUWnMtrVDPGJy0", "object": "chat.completion", "created": 1762599834, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* AGN objects with variability in r band and no detections or no variability in g band */\n/* Default conditions for probability: ranking=1 and classifier_name='lc_classifier' */\n\nWITH agn AS (\n    SELECT o.*, p.*\n    FROM object o\n    INNER JOIN probability p\n        ON p.oid = o.oid\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n),\ndet_stats AS (\n    SELECT\n        d.oid,\n        COUNT(d.magpsf_corr) FILTER (WHERE d.fid = 2 AND d.corrected AND NOT d.dubious) AS r_n,\n        VAR_SAMP(d.magpsf_corr) FILTER (WHERE d.fid = 2 AND d.corrected AND NOT d.dubious) AS r_var,\n        COUNT(d.magpsf_corr) FILTER (WHERE d.fid = 1 AND d.corrected AND NOT d.dubious) AS g_n,\n        VAR_SAMP(d.magpsf_corr) FILTER (WHERE d.fid = 1 AND d.corrected AND NOT d.dubious) AS g_var\n    FROM detection d\n    INNER JOIN agn a ON a.oid = d.oid  -- restrict aggregation to AGN objects only\n    GROUP BY d.oid\n)\nSELECT\n    a.*,\n    ds.*\nFROM agn a\nLEFT JOIN det_stats ds ON ds.oid = a.oid\nWHERE\n    /* Variability in r band: at least 2 corrected, non-dubious detections and variance > 0 */\n    COALESCE(ds.r_n, 0) >= 2\n    AND COALESCE(ds.r_var, 0) > 0\n    /* No detections in g or no variability in g (variance = 0 or only 1 detection -> NULL) */\n    AND (\n        COALESCE(ds.g_n, 0) = 0\n        OR COALESCE(ds.g_var, 0) = 0\n    )\n/* Order \"features\" (r_var) by ascending value, and then by oid */\nORDER BY ds.r_var ASC, a.oid ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 3929, "total_tokens": 6945, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3456, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283f7a3081909e90f6c495892c05", "custom_id": "17-7", "response": {"status_code": 200, "request_id": "9603ea07d05755bb4d818ca79108a141", "body": {"id": "chatcmpl-CZb3BZcPCeqUs8dfn1I9rA0J6cpco", "object": "chat.completion", "created": 1762599937, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects classified as AGN (lc_classifier, rank=1)\n-- Variable in r band (fid=2): at least 2 corrected, non-dubious detections with non-zero scatter\n-- No detections or no variability in g band (fid=1): zero or <2 valid detections, or zero scatter\nWITH agn AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p\n        ON p.oid = o.oid\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n),\nr_stats AS (\n    SELECT\n        d.oid,\n        COUNT(d.magpsf_corr) AS r_n,\n        stddev_samp(d.magpsf_corr) AS r_std,\n        MAX(d.magpsf_corr) AS r_max,\n        MIN(d.magpsf_corr) AS r_min\n    FROM detection d\n    INNER JOIN agn a ON a.oid = d.oid\n    WHERE d.fid = 2\n      AND d.corrected = TRUE\n      AND d.dubious = FALSE\n      AND d.magpsf_corr IS NOT NULL\n    GROUP BY d.oid\n),\ng_stats AS (\n    SELECT\n        d.oid,\n        COUNT(d.magpsf_corr) AS g_n,\n        stddev_samp(d.magpsf_corr) AS g_std,\n        MAX(d.magpsf_corr) AS g_max,\n        MIN(d.magpsf_corr) AS g_min\n    FROM detection d\n    INNER JOIN agn a ON a.oid = d.oid\n    WHERE d.fid = 1\n      AND d.corrected = TRUE\n      AND d.dubious = FALSE\n      AND d.magpsf_corr IS NOT NULL\n    GROUP BY d.oid\n)\nSELECT\n    o.*,\n    p.*,\n    r_stats.*,\n    g_stats.*\nFROM object o\nINNER JOIN probability p\n    ON p.oid = o.oid\nINNER JOIN r_stats\n    ON r_stats.oid = o.oid\nLEFT JOIN g_stats\n    ON g_stats.oid = o.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'AGN'\n  AND r_stats.r_n >= 2\n  AND COALESCE(r_stats.r_std, 0) > 0\n  AND (\n        g_stats.oid IS NULL           -- no g-band detections\n        OR g_stats.g_n < 2            -- not enough g-band detections to show variability\n        OR COALESCE(g_stats.g_std, 0) = 0  -- no g-band variability\n      )\nORDER BY\n    r_stats.r_std ASC NULLS LAST,   -- order features (variability measure) ascending\n    o.oid ASC;                      -- then order final result by oid\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 3763, "total_tokens": 6779, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3136, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283f5d7081909a6fdaaf69cee261", "custom_id": "17-8", "response": {"status_code": 200, "request_id": "e71a2bf74379ef50944cc02ef22efc9b", "body": {"id": "chatcmpl-CZawc98hcTgYC4PHVsTDNq0dCiMHQ", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 4000, "total_tokens": 7016, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284023c0819098d322207ff87896", "custom_id": "17-9", "response": {"status_code": 200, "request_id": "104b2d3355ea09bad2a096ff2043abe3", "body": {"id": "chatcmpl-CZb3QefMynBHUxokx0jAezbYbOoYm", "object": "chat.completion", "created": 1762599952, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* AGN objects (lc_classifier, rank=1) with variability in r-band (fid=2) \n   and no detections or no variability in g-band (fid=1).\n   Variability proxy = amplitude = max(mag) - min(mag).\n   Order by the feature (r-band amplitude) ascending, then by oid. */\n\nWITH det AS (\n  SELECT\n    oid,\n    COUNT(*) FILTER (WHERE fid = 2) AS ndet_r,\n    MAX(coalesce(magpsf_corr, magpsf)) FILTER (WHERE fid = 2) \n      - MIN(coalesce(magpsf_corr, magpsf)) FILTER (WHERE fid = 2) AS amp_r,\n    STDDEV_SAMP(coalesce(magpsf_corr, magpsf)) FILTER (WHERE fid = 2) AS std_r,\n    COUNT(*) FILTER (WHERE fid = 1) AS ndet_g,\n    MAX(coalesce(magpsf_corr, magpsf)) FILTER (WHERE fid = 1) \n      - MIN(coalesce(magpsf_corr, magpsf)) FILTER (WHERE fid = 1) AS amp_g,\n    STDDEV_SAMP(coalesce(magpsf_corr, magpsf)) FILTER (WHERE fid = 1) AS std_g\n  FROM detection\n  GROUP BY oid\n)\nSELECT\n  /* return all columns from the used tables and subquery */\n  o.*,\n  p.*,\n  det.*\nFROM object o\nINNER JOIN probability p\n  ON p.oid = o.oid\nINNER JOIN det\n  ON det.oid = o.oid\nWHERE\n  /* default probability conditions */\n  p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  /* AGN class */\n  AND p.class_name = 'AGN'\n  /* r-band shows variability */\n  AND det.amp_r IS NOT NULL\n  AND det.amp_r > 0\n  /* g-band has no detections or shows no variability */\n  AND (det.ndet_g = 0 OR coalesce(det.amp_g, 0) = 0)\nORDER BY\n  det.amp_r ASC,\n  o.oid ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 3421, "total_tokens": 6437, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2944, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283ff4688190816a0173c971aa5f", "custom_id": "1-5", "response": {"status_code": 200, "request_id": "3355b536f36bf4f0dd4ebc3a3edf7ed1", "body": {"id": "chatcmpl-CZb1WjCZL3RqiqLFXOoYNpwnFo276", "object": "chat.completion", "created": 1762599834, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3124, "completion_tokens": 4000, "total_tokens": 7124, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28403a3c8190aa5e4d0f88d213dc", "custom_id": "1-6", "response": {"status_code": 200, "request_id": "3ddd2b222cce9c7ba301cf31e6a88670", "body": {"id": "chatcmpl-CZb3Q4xoXf42wWGvWUAtcE5frWmtV", "object": "chat.completion", "created": 1762599952, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3124, "completion_tokens": 4000, "total_tokens": 7124, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284122748190947e38e0e95b252e", "custom_id": "1-7", "response": {"status_code": 200, "request_id": "fa6dcc7c7fb55a44f74a8bc50db90582", "body": {"id": "chatcmpl-CZawckMmv9v9Zj72qdN4BeIdFi24o", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3124, "completion_tokens": 4000, "total_tokens": 7124, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283ffef8819081fbb200a5fc960e", "custom_id": "1-8", "response": {"status_code": 200, "request_id": "e248faf09e02b2edd94a02089a915643", "body": {"id": "chatcmpl-CZawc3xVATym6KGGzPlT2CY2ZuxCp", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3124, "completion_tokens": 4000, "total_tokens": 7124, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2840025881908b2f94e6c15efc40", "custom_id": "1-9", "response": {"status_code": 200, "request_id": "87b748d737a037ff5b02c73940cd41bb", "body": {"id": "chatcmpl-CZb3QiT74ol1SN6vn2LzDKkPD8rDL", "object": "chat.completion", "created": 1762599952, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3124, "completion_tokens": 4000, "total_tokens": 7124, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f283ffe608190a6b653a810bf33c5", "custom_id": "16-5", "response": {"status_code": 200, "request_id": "5fbdb4b97b269d6c6fabf9cd4667815b", "body": {"id": "chatcmpl-CZb1WKbLZGUdIFFqL2KlvBME6ryFT", "object": "chat.completion", "created": 1762599834, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3159, "completion_tokens": 4000, "total_tokens": 7159, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284064c08190be55de7990ffe8a4", "custom_id": "16-6", "response": {"status_code": 200, "request_id": "5ebbc7279a7d6e02451a06a6331d1750", "body": {"id": "chatcmpl-CZaxyOI7ayC1vEq2tUBvb1hqfhDo6", "object": "chat.completion", "created": 1762599614, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3159, "completion_tokens": 4000, "total_tokens": 7159, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28409ecc8190945c66542294bc9f", "custom_id": "16-7", "response": {"status_code": 200, "request_id": "1372e10f673a2b14bcfb30dc30ed4a7c", "body": {"id": "chatcmpl-CZb3eVKLrOXLF5gHrWloPUyp0LiAe", "object": "chat.completion", "created": 1762599966, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3159, "completion_tokens": 4000, "total_tokens": 7159, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2840878c81909f7d8e287513c95b", "custom_id": "16-8", "response": {"status_code": 200, "request_id": "96f98024d1e341e1f46cd8ba85735488", "body": {"id": "chatcmpl-CZawcdeeUbsEGhor8qOChqHNJdAPz", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3159, "completion_tokens": 4000, "total_tokens": 7159, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2840948c8190b4f8076d29020be2", "custom_id": "16-9", "response": {"status_code": 200, "request_id": "b5a62f6c3f04381f1cbfed027c81e33c", "body": {"id": "chatcmpl-CZay11poC5yD7CZc7eB5Csv4WS1da", "object": "chat.completion", "created": 1762599617, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3159, "completion_tokens": 4000, "total_tokens": 7159, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284090f88190bc1dc49e75643fa0", "custom_id": "14-5", "response": {"status_code": 200, "request_id": "8f3c4eec357c99c2b1b8e81e750ef96c", "body": {"id": "chatcmpl-CZb4Bi3uNcfC1vYTHBSTdxtV5Rape", "object": "chat.completion", "created": 1762599999, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return detections for given oids with drb > 0.5 and either sgscore1 < 0.5 or distpsnr1 < 1 arcsec\nWITH det AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf_corr,\n        d.sigmapsf_corr,\n        d.has_stamp,\n        d.drb\n    FROM detection d\n    WHERE d.oid IN (\n        'ZTF23aavzgjg',\n        'ZTF23aaynzyk',\n        'ZTF23aavqxos',\n        'ZTF23aaknyni',\n        'ZTF23aavsdtc',\n        'ZTF18aandkua',\n        'ZTF23aaxfewt',\n        'ZTF23aavshwi',\n        'ZTF22aawasao',\n        'ZTF23aaxgvnt'\n    )\n      AND d.drb > 0.5\n)\nSELECT\n    det.oid,\n    det.candid,\n    det.fid,\n    det.mjd,\n    det.magpsf_corr,\n    det.sigmapsf_corr,\n    det.has_stamp,\n    det.drb,\n    ps.sgscore1,\n    ps.distpsnr1\nFROM det\nINNER JOIN ps1_ztf ps\n    ON ps.oid = det.oid\n   AND ps.candid = det.candid\nWHERE (ps.sgscore1 < 0.5 OR ps.distpsnr1 < 1)\nORDER BY det.oid, det.mjd, det.candid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3196, "completion_tokens": 1694, "total_tokens": 4890, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2840b63c8190947a2f860759310e", "custom_id": "14-6", "response": {"status_code": 200, "request_id": "7dda72972f1216cd0e9a3e1a25ce83b5", "body": {"id": "chatcmpl-CZawc1QsqN7ymQAGHcRkLcoNrp4y1", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return per-candidate detections for the specified oids, preferring corrected magnitudes when available.\n-- Apply filters: drb > 0.5 AND (sgscore1 < 0.5 OR distpsnr1 < 1.0)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    COALESCE(d.magpsf_corr, d.magpsf) AS magnitud,           -- preferred magnitude\n    COALESCE(d.sigmapsf_corr, d.sigmapsf) AS magnitud_error, -- preferred magnitude error\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM detection AS d\nINNER JOIN ps1_ztf AS p\n    ON d.oid = p.oid\n   AND d.candid = p.candid\nWHERE\n    d.oid IN (\n        'ZTF23aavzgjg',\n        'ZTF23aaynzyk',\n        'ZTF23aavqxos',\n        'ZTF23aaknyni',\n        'ZTF23aavsdtc',\n        'ZTF18aandkua',\n        'ZTF23aaxfewt',\n        'ZTF23aavshwi',\n        'ZTF22aawasao',\n        'ZTF23aaxgvnt'\n    )\n    AND d.drb > 0.5\n    AND (\n        p.sgscore1 < 0.5\n        OR p.distpsnr1 < 1.0\n    )\nORDER BY d.oid ASC, d.mjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 2402, "total_tokens": 5602, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2840d2d881909ca57b6969038967", "custom_id": "14-7", "response": {"status_code": 200, "request_id": "21c1e73da1c51582c6cf49ebf0a45a7d", "body": {"id": "chatcmpl-CZawcI8o1XmbnlLPHj74uVPnN2esU", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return detections for given oids with DRB > 0.5 and PS1 constraints:\n-- sgscore1 < 0.5 OR distpsnr1 < 1 arcsec.\nWITH d AS (\n  SELECT\n    oid,\n    candid,\n    fid,\n    mjd,\n    magpsf,\n    sigmapsf,\n    has_stamp,\n    drb\n  FROM detection\n  WHERE oid IN (\n    'ZTF23aavzgjg',\n    'ZTF23aaynzyk',\n    'ZTF23aavqxos',\n    'ZTF23aaknyni',\n    'ZTF23aavsdtc',\n    'ZTF18aandkua',\n    'ZTF23aaxfewt',\n    'ZTF23aavshwi',\n    'ZTF22aawasao',\n    'ZTF23aaxgvnt'\n  )\n)\nSELECT\n  d.oid,\n  d.candid,\n  d.fid,\n  d.mjd,\n  d.magpsf,\n  d.sigmapsf,\n  d.has_stamp,\n  d.drb,\n  p.sgscore1,\n  p.distpsnr1\nFROM d\nINNER JOIN ps1_ztf p\n  ON p.oid = d.oid\n AND p.candid = d.candid\nWHERE d.drb > 0.5\n  AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\nORDER BY d.oid ASC, d.mjd ASC, d.candid ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3260, "completion_tokens": 1682, "total_tokens": 4942, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28410ac08190909784247fe687d8", "custom_id": "14-8", "response": {"status_code": 200, "request_id": "4a799449022a181162e7c9e90395b8a6", "body": {"id": "chatcmpl-CZaweYSHF9aSRvWxp1EldEl8WdKQk", "object": "chat.completion", "created": 1762599532, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return detections for the given oids with drb > 0.5 and (sgscore1 < 0.5 OR distpsnr1 < 1.0)\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM target_oids t\nINNER JOIN detection d\n    ON d.oid = t.oid\nINNER JOIN ps1_ztf p\n    ON p.oid = d.oid\n   AND p.candid = d.candid\nWHERE\n    d.drb > 0.5\n    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1.0)\nORDER BY d.oid, d.mjd ASC, d.fid ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3392, "completion_tokens": 1600, "total_tokens": 4992, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1280, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284111348190849a209d775e8cd3", "custom_id": "14-9", "response": {"status_code": 200, "request_id": "d0c6baabc84e749d9488f734cd3db62f", "body": {"id": "chatcmpl-CZb00seVZ2wbBz9QwK9cDTDlBow3A", "object": "chat.completion", "created": 1762599740, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Detections for the specified oids with DRB > 0.5 and PS1 proximity/sgscore conditions\nSELECT\n  d.oid,\n  d.candid,\n  d.fid,\n  d.mjd,\n  d.magpsf,\n  d.sigmapsf,\n  d.has_stamp,\n  d.drb,\n  p.sgscore1,\n  p.distpsnr1\nFROM detection AS d\nINNER JOIN ps1_ztf AS p\n  ON d.oid = p.oid\n AND d.candid = p.candid\nWHERE d.oid IN (\n  'ZTF23aavzgjg',\n  'ZTF23aaynzyk',\n  'ZTF23aavqxos',\n  'ZTF23aaknyni',\n  'ZTF23aavsdtc',\n  'ZTF18aandkua',\n  'ZTF23aaxfewt',\n  'ZTF23aavshwi',\n  'ZTF22aawasao',\n  'ZTF23aaxgvnt'\n)\n  AND d.drb > 0.5\n  AND (\n    p.sgscore1 < 0.5\n    OR p.distpsnr1 < 1\n  )\nORDER BY d.oid ASC, d.mjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3327, "completion_tokens": 1564, "total_tokens": 4891, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1280, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284166c08190a47edd90249acd98", "custom_id": "89-5", "response": {"status_code": 200, "request_id": "fa25de8a353a24fe5c38dd4706827c6d", "body": {"id": "chatcmpl-CZawcu2BBhXYplaLPpvualWWCvGTI", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all rows from dataquality for at most 50 ZTF objects whose top-ranked\n-- stamp classifier label is 'SN' with probability > 0.7.\n-- Default conditions applied for probability: ranking = 1.\nWITH selected_oids AS (\n    SELECT\n        p.oid,\n        MAX(p.probability) AS p_sn_max\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier' -- override default lc_classifier\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n    GROUP BY p.oid\n    ORDER BY p_sn_max DESC, p.oid ASC\n    LIMIT 50\n)\nSELECT\n    d.*\nFROM dataquality d\nINNER JOIN selected_oids s\n    ON d.oid = s.oid\nORDER BY s.p_sn_max DESC, d.oid ASC, d.candid ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3308, "completion_tokens": 1171, "total_tokens": 4479, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28412b708190a845c226677adbda", "custom_id": "89-6", "response": {"status_code": 200, "request_id": "e2a3d037e2d021d1af2b8e656365a90c", "body": {"id": "chatcmpl-CZb4aNdEldgTzuvE8CsN5XLafoGKe", "object": "chat.completion", "created": 1762600024, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all rows from dataquality for up to 50 ZTF objects with SN probability > 0.7\n-- according to the stamp classifier, considering only top-ranked class per classifier output.\nWITH sn50 AS (\n    SELECT\n        p.oid,\n        MAX(p.probability) AS sn_prob\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n        AND p.oid LIKE 'ZTF%'\n    GROUP BY p.oid\n    ORDER BY sn_prob DESC\n    LIMIT 50\n)\nSELECT\n    dq.*\nFROM dataquality dq\nINNER JOIN sn50 ON dq.oid = sn50.oid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2943, "completion_tokens": 1779, "total_tokens": 4722, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28411e2c8190a2cbba04b79f879c", "custom_id": "89-7", "response": {"status_code": 200, "request_id": "7962b45d741cb50ba75078c9d34c9164", "body": {"id": "chatcmpl-CZaxQM1jU0IFXkVzEL0mjiCYG2ssP", "object": "chat.completion", "created": 1762599580, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all dataquality rows for up to 50 ZTF objects that have SN probability > 0.7 in the stamp classifier (ranking = 1)\nWITH ranked_oids AS (\n  SELECT DISTINCT ON (p.oid) p.oid, p.probability\n  FROM probability p\n  WHERE p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.probability > 0.7\n    AND p.ranking = 1\n  ORDER BY p.oid, p.probability DESC\n),\ntop_oids AS (\n  SELECT oid\n  FROM ranked_oids\n  ORDER BY probability DESC\n  LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nINNER JOIN top_oids t ON t.oid = dq.oid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2803, "completion_tokens": 2868, "total_tokens": 5671, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2688, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2841275c81908a0060c3b63ca994", "custom_id": "89-8", "response": {"status_code": 200, "request_id": "3e3cebdc4462eb0f640e50a50a990241", "body": {"id": "chatcmpl-CZb4ajmZolIJR9y0qAk4mMAGCHPDH", "object": "chat.completion", "created": 1762600024, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all columns from the dataquality table for at most 50 ZTF objects\n-- whose top-ranked ('ranking' = 1) stamp_classifier class is 'SN' with probability > 0.7\nWITH top_sn AS (\n  SELECT\n    p.oid,\n    MAX(p.probability) AS sn_prob\n  FROM probability p\n  WHERE\n    p.classifier_name = 'stamp_classifier'  -- explicitly use the stamp classifier\n    AND p.class_name = 'SN'                 -- supernovae class\n    AND p.ranking = 1                       -- default condition: only top-ranked class per object\n    AND p.probability > 0.7\n    AND p.oid LIKE 'ZTF%'                   -- restrict to ZTF objects\n  GROUP BY p.oid\n  ORDER BY sn_prob DESC\n  LIMIT 50                                   -- at most 50 distinct objects\n)\nSELECT\n  dq.*                                        -- all columns from dataquality\nFROM dataquality dq\nINNER JOIN top_sn t\n  ON dq.oid = t.oid\nORDER BY\n  t.sn_prob DESC,\n  dq.oid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2981, "completion_tokens": 1785, "total_tokens": 4766, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1536, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284281c881909a1c679b1fbf0720", "custom_id": "89-9", "response": {"status_code": 200, "request_id": "45a0efeb1cb14963581ba32a9693e509", "body": {"id": "chatcmpl-CZaxO1pbOmbrYsM4BfcVvDypf0VFV", "object": "chat.completion", "created": 1762599578, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all columns from the 'dataquality' table for up to 50 objects\n-- with stamp classifier ('stamp_classifier') probability > 0.7 for class 'SN'\n-- Assumes 'dataquality' has an 'oid' column referencing object(oid)\nWITH top_sn AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier' -- user-specified classifier\n      AND p.class_name = 'SN'                    -- supernovae in stamp classifier\n      AND p.probability > 0.7\n      AND p.ranking = 1                          -- default condition for ranking\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nINNER JOIN top_sn t ON t.oid = dq.oid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3012, "completion_tokens": 1647, "total_tokens": 4659, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2841afb08190bbe77e22fe83ba00", "custom_id": "103-5", "response": {"status_code": 200, "request_id": "024ea928a369185891f0b4724f1c9fbe", "body": {"id": "chatcmpl-CZay9ieS3t4KKMGqjw19lg6BwixGc", "object": "chat.completion", "created": 1762599625, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return up to 200 objects whose nearest PS1 source is > 5 arcsec away\n-- and whose top light curve classifier class (lc_classifier, ranking=1)\n-- is NOT a supernova class with probability > 0.7.\n-- Assumes ps1_ztf has a column 'distpsnr1' in arcseconds; adjust the column\n-- name or units if your schema differs.\nSELECT\n    o.*,\n    p.*,\n    ps.*\nFROM object AS o\nINNER JOIN probability AS p\n    ON p.oid = o.oid\nINNER JOIN ps1_ztf AS ps\n    ON ps.oid = o.oid\nWHERE\n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND p.probability > 0.7\n    AND ps.distpsnr1 > 5  -- arcseconds\nORDER BY\n    ps.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3062, "completion_tokens": 2225, "total_tokens": 5287, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1984, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28417e7c8190857afd59323c34db", "custom_id": "103-6", "response": {"status_code": 200, "request_id": "c7795410bad11280fd74fd60b9560935", "body": {"id": "chatcmpl-CZazz9mudOLrfBGrM2vCHKRaQ08qn", "object": "chat.completion", "created": 1762599739, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 200 ZTF objects whose nearest PS1 source is farther than 5 arcsec\n-- and whose top lc_classifier class (ranking=1) is non-supernova with probability > 0.7.\n-- Return all columns from object, probability, and ps1_ztf, ordered by the nearest PS1 distance.\nSELECT\n    o.*,\n    p.*,\n    ps1.*\nFROM object AS o\nINNER JOIN probability AS p\n    ON p.oid = o.oid\nINNER JOIN ps1_ztf AS ps1\n    ON ps1.oid = o.oid\nWHERE\n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND p.probability > 0.7\n    AND ps1.dist > 5  -- assumes 'dist' (in arcsec) is the nearest PS1 source separation\nORDER BY\n    ps1.dist ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3062, "completion_tokens": 1711, "total_tokens": 4773, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284198a08190ab9263e4766eeadd", "custom_id": "103-7", "response": {"status_code": 200, "request_id": "bfddce9033588a76b3d0479c61e45c7d", "body": {"id": "chatcmpl-CZaySQvpsqflUbDem9yLL6TadKQGf", "object": "chat.completion", "created": 1762599644, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 200 unique ZTF objects whose nearest PS1 source is > 5 arcsec away\n-- and whose most likely lc_classifier class (ranking=1) is NOT a supernova\n-- with probability > 0.7. Return all columns from object, probability, and ps1_ztf.\n-- Note: Assuming ps1_ztf has columns (oid, distpsnr1) where distpsnr1 is in arcsec.\n\nSELECT *\nFROM (\n    SELECT DISTINCT ON (o.oid) o.*, p.*, ps1.*\n    FROM object AS o\n    INNER JOIN probability AS p\n        ON p.oid = o.oid\n    INNER JOIN ps1_ztf AS ps1\n        ON ps1.oid = o.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'  -- default classifier\n        AND p.ranking = 1                    -- default: only most likely class\n        AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- exclude supernovae\n        AND p.probability > 0.7\n        AND ps1.distpsnr1 > 5  -- arcsec\n    ORDER BY o.oid, ps1.distpsnr1 ASC\n) AS s\nORDER BY distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3062, "completion_tokens": 3501, "total_tokens": 6563, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3200, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284197f48190a9b62d2703434004", "custom_id": "103-8", "response": {"status_code": 200, "request_id": "1197c0658de3e677a7dc92b935606c79", "body": {"id": "chatcmpl-CZaxyect3O3fnOadIRS2Nypq03hbK", "object": "chat.completion", "created": 1762599614, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 200 ZTF objects with nearest PS1 source distance > 5 arcsec\n-- and lc_classifier non-supernova class probability > 0.7.\n-- Returns all columns from object, probability, and a per-object PS1 distance CTE named ps1_ztf.\nWITH ps1_ztf AS (\n    SELECT\n        d.oid,\n        MIN(d.distnr) AS distnr  -- nearest PS1/reference catalog source distance (arcsec) per object\n    FROM detection d\n    GROUP BY d.oid\n)\nSELECT\n    o.*,\n    p.*,\n    ps1_ztf.*\nFROM ps1_ztf\nINNER JOIN object o\n    ON o.oid = ps1_ztf.oid\nINNER JOIN probability p\n    ON p.oid = o.oid\nWHERE\n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND p.probability > 0.7\n    AND ps1_ztf.distnr > 5\nORDER BY\n    ps1_ztf.distnr\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3062, "completion_tokens": 2387, "total_tokens": 5449, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2112, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2841aa8081908b6b3d95614000ae", "custom_id": "103-9", "response": {"status_code": 200, "request_id": "a641aa5c3a1761ddd6f0debf654cf2a5", "body": {"id": "chatcmpl-CZay1O7980sjRSQvtZSpFze3Pfxf2", "object": "chat.completion", "created": 1762599617, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects with nearest PS1 source farther than 5 arcsec\n-- and top-ranked lc_classifier class (non-SN) with probability > 0.7\nSELECT\n    o.*,\n    p.*,\n    ps.*\nFROM object AS o\nINNER JOIN probability AS p\n    ON p.oid = o.oid\nINNER JOIN ps1_ztf AS ps\n    ON ps.oid = o.oid\nWHERE\n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND p.probability > 0.7\n    AND ps.distpsnr1 > 5  -- distance to nearest PS1 source in arcsec\nORDER BY\n    ps.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3062, "completion_tokens": 2117, "total_tokens": 5179, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1920, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2842010c8190974198faf9cd7c94", "custom_id": "99-5", "response": {"status_code": 200, "request_id": "366939b2733950d5d843792e3512841d", "body": {"id": "chatcmpl-CZb1EMZeM6KEkp7IgyX4dZyP1KiQJ", "object": "chat.completion", "created": 1762599816, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 10 objects with first detection after MJD 60310\n-- and with probability 1 of being 'asteroid' in the stamp classifier,\n-- then return all forced photometry rows for those objects.\nWITH selected_oids AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    INNER JOIN probability p ON p.oid = o.oid\n    WHERE o.firstmjd > 60310\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability = 1\n      AND p.ranking = 1\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nINNER JOIN selected_oids s ON fp.oid = s.oid\nORDER BY s.firstmjd;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 1792, "total_tokens": 4825, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2841d520819081468660c6c27b03", "custom_id": "99-6", "response": {"status_code": 200, "request_id": "d67ec85462afcde66bdf938a30d4a52b", "body": {"id": "chatcmpl-CZayl83tBznBFqNV54OTrrM2iSD1S", "object": "chat.completion", "created": 1762599663, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all forced_photometry rows for up to 10 ZTF objects\n-- with first detection later than MJD 60310 and classified as 'asteroid'\n-- by the stamp_classifier with probability 1 (and ranking=1).\nWITH top_oids AS (\n  SELECT o.oid, o.firstmjd\n  FROM object o\n  WHERE o.firstmjd > 60310\n    AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n        AND p.ranking = 1\n    )\n  ORDER BY o.firstmjd\n  LIMIT 10\n)\nSELECT f.*\nFROM forced_photometry f\nINNER JOIN top_oids t ON t.oid = f.oid\nORDER BY t.firstmjd;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 2512, "total_tokens": 5545, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2841bd8c8190881a37e0c05594ed", "custom_id": "99-7", "response": {"status_code": 200, "request_id": "eec0d24f7f28483a7ed5681ae14bd9fa", "body": {"id": "chatcmpl-CZayeOlJZx2Xm4YBMADOGrKDpB4Ib", "object": "chat.completion", "created": 1762599656, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all forced photometry rows for at most 10 objects whose first detection (firstmjd) is > 60310\n-- and whose most likely stamp_classifier class is 'asteroid' with probability 1.\nWITH selected AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    INNER JOIN probability p\n        ON p.oid = o.oid\n    WHERE o.firstmjd > 60310\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability = 1\n      AND p.ranking = 1\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nINNER JOIN selected s USING (oid)\nORDER BY s.firstmjd ASC, fp.oid ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 1919, "total_tokens": 4952, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2841ee6c819083090d7b3fc82980", "custom_id": "99-8", "response": {"status_code": 200, "request_id": "6fdb21b38c35a0a9e1ffb990fcd938e6", "body": {"id": "chatcmpl-CZb0Eryxw2HTPjXMVu7KfhDAAwvO8", "object": "chat.completion", "created": 1762599754, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all forced_photometry rows for up to 10 objects with firstmjd > 60310\n-- and stamp_classifier probability 1 for class 'asteroid', ordered by firstmjd\nWITH selected AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM object o\n    INNER JOIN probability p\n        ON p.oid = o.oid\n    WHERE\n        o.firstmjd > 60310\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n        AND p.ranking = 1  -- keep only the top-ranked stamp classification\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT\n    fp.*\nFROM forced_photometry fp\nINNER JOIN selected s\n    ON s.oid = fp.oid\nORDER BY s.firstmjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 2062, "total_tokens": 5095, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1856, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28420b5c8190b4f2cafc3115d196", "custom_id": "99-9", "response": {"status_code": 200, "request_id": "a5c311f25696e6626df31bd48c541fc9", "body": {"id": "chatcmpl-CZaziouKaxJSX5MSrUniPY4XXuqbB", "object": "chat.completion", "created": 1762599722, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 10 ZTF objects with first detection date later than MJD=60310\n-- and a stamp classifier probability of 1 for class 'asteroid'.\n-- Then return all columns from the forced_photometry table for those objects,\n-- ordering rows by the object's first detection date.\n-- Note: This assumes a table 'forced_photometry' exists and has a column 'oid'.\nWITH top_objects AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM object o\n    INNER JOIN probability p\n        ON p.oid = o.oid\n    WHERE\n        o.firstmjd > 60310\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n        AND p.ranking = 1\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT\n    fp.*\nFROM forced_photometry fp\nINNER JOIN top_objects t\n    ON t.oid = fp.oid\nORDER BY t.firstmjd, fp.oid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 2226, "total_tokens": 5259, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1984, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28423c18819099eec2b595344ebb", "custom_id": "92-6", "response": {"status_code": 200, "request_id": "7e612f17899edda80032f24d02cbd1a9", "body": {"id": "chatcmpl-CZb1nmPt3wfyGL5ysiuaZlWQduL5c", "object": "chat.completion", "created": 1762599851, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 500 objects with >=10 g-band detections and no dubious g-band detections,\n-- returning oid, classifier_version, class_name, and probability for lc_classifier with ranking=1\nWITH lc_rank1 AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        p.probability,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\ng_stats AS (\n    SELECT\n        d.oid,\n        COUNT(*) FILTER (WHERE d.fid = 1) AS g_det_count,\n        COUNT(*) FILTER (WHERE d.fid = 1 AND d.dubious) AS g_dubious_count\n    FROM detection d\n    INNER JOIN lc_rank1 p ON p.oid = d.oid\n    GROUP BY d.oid\n    HAVING COUNT(*) FILTER (WHERE d.fid = 1) >= 10\n       AND COUNT(*) FILTER (WHERE d.fid = 1 AND d.dubious) = 0\n)\nSELECT\n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM lc_rank1 p\nINNER JOIN g_stats g ON g.oid = p.oid\nORDER BY p.oid ASC\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3230, "completion_tokens": 1328, "total_tokens": 4558, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284229088190886a772792102eca", "custom_id": "92-7", "response": {"status_code": 200, "request_id": "066aff58484fa05c7e906f1fb41265a7", "body": {"id": "chatcmpl-CZaze2lvwD8TG8B3Vj232QKqNnpTy", "object": "chat.completion", "created": 1762599718, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 500 ZTF objects (ordered by oid) with at least 10 g-band detections\n-- and zero dubious detections in g, then return their top lc_classifier probabilities.\nWITH g_candidates AS (\n    SELECT\n        d.oid\n    FROM detection d\n    WHERE d.fid = 1  -- g band\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n       AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0  -- no dubious in g\n),\ntop_oids AS (\n    SELECT oid\n    FROM g_candidates\n    ORDER BY oid\n    LIMIT 500\n)\nSELECT\n    p.oid,                 -- ZTF identifier\n    p.classifier_version,  -- classifier version\n    p.class_name,          -- class name\n    p.probability          -- probability\nFROM probability p\nINNER JOIN top_oids t ON p.oid = t.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\nORDER BY p.oid, p.classifier_version;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3041, "completion_tokens": 2551, "total_tokens": 5592, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28423ae48190945beaeec06d5ba7", "custom_id": "92-8", "response": {"status_code": 200, "request_id": "da51e6eaeaa173807a6ae815257b7f60", "body": {"id": "chatcmpl-CZazKf4rAyNkkqGGiXn20HQLBUFrf", "object": "chat.completion", "created": 1762599698, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 500 ZTF objects with at least 10 g-band detections and no dubious g-band detections,\n-- returning oid, classifier_version, class_name, and probability for the lc_classifier with ranking=1.\nWITH g_ok AS (\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1 -- g band\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n       AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0 -- no dubious detections in g\n)\nSELECT o.oid, p.classifier_version, p.class_name, p.probability\nFROM g_ok g\nINNER JOIN object o ON o.oid = g.oid\nINNER JOIN probability p ON p.oid = o.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\nORDER BY o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3041, "completion_tokens": 2709, "total_tokens": 5750, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284232ec8190a560df366b23ee6f", "custom_id": "102-5", "response": {"status_code": 200, "request_id": "90dad2bf67fe3aaecc23de69bc87ae76", "body": {"id": "chatcmpl-CZb0YWx4195IVBtAKhkk3FlZpTlcX", "object": "chat.completion", "created": 1762599774, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 50 objects with lc_classifier rank-1 AGN probability > 0.6\n-- and WISE W1 magnitude between 12 and 13.\n-- Assumes the time-independent stats table is named 'magstats' and the W1 column is 'w1mag'.\nSELECT\n    ms.*\nFROM\n    magstats AS ms\nINNER JOIN\n    probability AS p\n    ON p.oid = ms.oid\nWHERE\n    p.classifier_name = 'lc_classifier'  -- default condition\n    AND p.ranking = 1                    -- default condition\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND ms.w1mag BETWEEN 12 AND 13\nORDER BY\n    p.probability DESC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3032, "completion_tokens": 2423, "total_tokens": 5455, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2843ac9081909a72c7a2ed2ddc25", "custom_id": "102-6", "response": {"status_code": 200, "request_id": "c11f46e078d0feddc5cc340520318559", "body": {"id": "chatcmpl-CZazUpkFx8PCEO06kHIa3COzmHW2D", "object": "chat.completion", "created": 1762599708, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all columns from the magstats table for up to 50 objects\n-- satisfying: lc_classifier rank-1 AGN with probability > 0.6\n-- and WISE W1 magnitude between 12 and 13.\n-- Note: Replace ms.w1 with the correct W1 column name if different (e.g., w1mpro).\nSELECT ms.*\nFROM magstats ms\nINNER JOIN probability p ON p.oid = ms.oid\nWHERE p.classifier_name = 'lc_classifier'  -- default classifier\n  AND p.ranking = 1                         -- default to most likely class\n  AND p.class_name = 'AGN'\n  AND p.probability > 0.6\n  AND ms.w1 BETWEEN 12 AND 13\nORDER BY p.probability DESC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3032, "completion_tokens": 2807, "total_tokens": 5839, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2624, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284270c08190a707441a56c756ba", "custom_id": "102-7", "response": {"status_code": 200, "request_id": "1dac3c622d06b33de4c43718c112e288", "body": {"id": "chatcmpl-CZb04fuIv0VPHEQdco8jOQ9Y3quRc", "object": "chat.completion", "created": 1762599744, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return up to 50 objects with top-ranked AGN classification (lc_classifier) and WISE W1 magnitude between 12 and 13\n-- NOTE: This assumes the time-independent table name is 'magstats' and that the W1 magnitude column is 'w1'.\n-- If your schema uses a different column name for W1 (e.g., 'w1mag' or 'w1mpro'), replace ms.w1 accordingly.\n\nSELECT DISTINCT ON (ms.oid) ms.*\nFROM magstats ms\nINNER JOIN probability p\n    ON p.oid = ms.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'AGN'\n  AND p.probability > 0.6\n  AND ms.w1 BETWEEN 12 AND 13\nORDER BY ms.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3032, "completion_tokens": 3268, "total_tokens": 6300, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3072, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2842b38481909021cee726085faf", "custom_id": "102-8", "response": {"status_code": 200, "request_id": "f53091e459a849606384d9be8ed5696d", "body": {"id": "chatcmpl-CZb0D6PomSUMlAGQESru1SuvIyNgJ", "object": "chat.completion", "created": 1762599753, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 50 objects classified as AGN by the light curve classifier with rank=1 and probability > 0.6,\n-- and having WISE W1 magnitude between 12 and 13.\n-- Note: This query assumes the table is named 'magstats' (time-independent stats) and that the W1 column is 'w1mpro'.\n-- If your schema uses a different table/column name (e.g., 'magstat' or 'w1'), adjust accordingly.\n\nSELECT\n    ms.*\nFROM\n    magstats ms\nINNER JOIN\n    probability p\n    ON p.oid = ms.oid\nWHERE\n    p.classifier_name = 'lc_classifier' -- default condition: use light curve classifier\n    AND p.ranking = 1                   -- default condition: top-ranked class\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND ms.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3032, "completion_tokens": 2397, "total_tokens": 5429, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2176, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284291bc8190b1492f3ea12578c3", "custom_id": "102-9", "response": {"status_code": 200, "request_id": "fb64f8916b1a27c8ce4206848afe18e8", "body": {"id": "chatcmpl-CZb0Gl9ZYEKXehcF2zWUwxjvkejsb", "object": "chat.completion", "created": 1762599756, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3032, "completion_tokens": 4000, "total_tokens": 7032, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2842987c8190bc505678b7b8b650", "custom_id": "104-5", "response": {"status_code": 200, "request_id": "9b2688b753573158b0c500d6052fa6c4", "body": {"id": "chatcmpl-CZb0RbKjFr4GdX5F5QFdOFEfpx3vZ", "object": "chat.completion", "created": 1762599767, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 4000, "total_tokens": 7070, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2842bdc88190bd4291b69805c600", "custom_id": "104-6", "response": {"status_code": 200, "request_id": "2559178f1b0d13a9441b9cb74df1bb42", "body": {"id": "chatcmpl-CZb0gcQlgRSDl6hgBR16rHZ7J6d1l", "object": "chat.completion", "created": 1762599782, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Top 30 ZTF objects with high asteroid probability from the specified stamp classifier version\nWITH top_asteroid AS (\n    SELECT\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.ranking = 1 -- keep only the most likely class per object\n        AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n),\n-- One (latest) candidate per object to retrieve candidate-level fields\nlatest_detection AS (\n    SELECT DISTINCT ON (d.oid)\n        d.*\n    FROM detection d\n    INNER JOIN top_asteroid ta ON ta.oid = d.oid\n    ORDER BY d.oid, d.mjd DESC\n)\nSELECT\n    ta.oid,                 -- ZTF object identifier\n    ld.candid,              -- ZTF candidate identifier\n    ld.ssdistnr,            -- distance to nearest Solar System object (arcsec)\n    ld.ssmagnr,             -- MPC archive magnitude\n    ld.ssnamenr,            -- MPC name of the Solar System object\n    ld.fid,                 -- filter identifier (1=g, 2=r, 3=i)\n    ld.fwhm,                -- FWHM from SExtractor (arcsec)\n    ld.ncalib,              -- number of PS1 calibrators used\n    ld.exptime              -- exposure time (seconds)\nFROM top_asteroid ta\nINNER JOIN latest_detection ld ON ld.oid = ta.oid\nORDER BY ta.probability DESC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3449, "total_tokens": 6519, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3072, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2842d6f4819099dc3771cb0f7783", "custom_id": "104-7", "response": {"status_code": 200, "request_id": "8f09c4b725997005046d173c24e3b32e", "body": {"id": "chatcmpl-CZb13fKY2Vo6D9iPDCCv0awurfLrl", "object": "chat.completion", "created": 1762599805, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 4000, "total_tokens": 7070, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2842ce688190a893af86815316ca", "custom_id": "104-8", "response": {"status_code": 200, "request_id": "6c0423f5a4202345fb967a47311ae40e", "body": {"id": "chatcmpl-CZb19igCjB4NNsDTfEjiUkSuu0IDb", "object": "chat.completion", "created": 1762599811, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 30 ZTF objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4'\n-- with probability > 0.9, returning one (latest) candidate per object.\n-- Note: The provided schema does not include columns for Solar System distance, MPC magnitude/name,\n-- FWHM, number of PS1 calibrators, or exposure time. If those exist in another deployment\n-- (e.g., as ssdistnr, ssmagnr, ssnamenr, fwhm, ncalib, exptime), replace or add them accordingly.\n\nSELECT\n    o.oid,               -- ZTF object identifier\n    d.candid,            -- candidate identifier\n    d.fid,               -- filter identifier\n    p.*,\n    o.*,\n    d.*\nFROM probability p\nINNER JOIN object o\n    ON o.oid = p.oid\n-- pick the latest detection per object to attach candidate-level info\nINNER JOIN LATERAL (\n    SELECT *\n    FROM detection d\n    WHERE d.oid = o.oid\n    ORDER BY d.mjd DESC\n    LIMIT 1\n) d ON TRUE\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.9\n  AND p.ranking = 1\nORDER BY p.probability DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3145, "total_tokens": 6215, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2816, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2842c23c8190ab5dca1d4d665526", "custom_id": "104-9", "response": {"status_code": 200, "request_id": "408db651a4112929315765a3d9615751", "body": {"id": "chatcmpl-CZb1XMLwvNpCz3Xa8PC6q3tj4a8QM", "object": "chat.completion", "created": 1762599835, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 30 ZTF objects whose most likely stamp classifier label is 'asteroid'\n-- with probability > 0.9 in version 'stamp_classifier_1.0.4'.\n-- Return per-object the most recent detection (candidate) and requested columns.\n-- Note: The ALeRCE detection schema provided does not include the following ZTF alert fields:\n--   distance to nearest Solar System object (ssdistnr),\n--   MPC archive magnitude (ssmagnr),\n--   MPC object name (ssnamenr),\n--   SExtractor FWHM (fwhm),\n--   number of PS1 calibrators (nps1),\n--   exposure time (exptime).\n-- These are returned as NULL placeholders with conventional ZTF field names.\n\nWITH asteroid_objs AS (\n  SELECT\n    p.oid,\n    p.probability\n  FROM probability p\n  WHERE p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'asteroid'\n    AND p.probability > 0.9\n    AND p.ranking = 1  -- keep only the top-ranked class per object\n),\nbest_det AS (\n  SELECT DISTINCT ON (d.oid)\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd\n  FROM detection d\n  INNER JOIN asteroid_objs a USING (oid)\n  ORDER BY d.oid, d.mjd DESC  -- most recent detection per object\n)\nSELECT\n  b.oid,                        -- ZTF object identifier\n  b.candid,                     -- candidate identifier\n  NULL::double precision AS ssdistnr,  -- distance to nearest Solar System object (not available)\n  NULL::double precision AS ssmagnr,   -- MPC archive magnitude (not available)\n  NULL::varchar AS ssnamenr,           -- MPC object name (not available)\n  b.fid,                        -- filter identifier\n  NULL::double precision AS fwhm,      -- SExtractor FWHM (not available)\n  NULL::integer AS nps1,               -- number of PS1 calibrators used (not available)\n  NULL::double precision AS exptime    -- exposure time (not available)\nFROM best_det b\nINNER JOIN asteroid_objs a ON a.oid = b.oid\nORDER BY a.probability DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3716, "total_tokens": 6786, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3200, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2843417481909634733474b2ec71", "custom_id": "107-5", "response": {"status_code": 200, "request_id": "576fb0f2f73314d5329fb9d7f5c2a431", "body": {"id": "chatcmpl-CZawcipIhug03d9YPdmbyclqKROBm", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find ZTF objects with >500 detections, asteroid probability >0.5 (stamp_classifier_1.0.4),\n-- and within 2 arcsec of the nearest Solar System object (MPC). Returns up to 10 rows.\n-- NOTE: Replace the 'mpc' CTE with your actual Solar System/MPC catalog table or a VALUES list.\nWITH mpc (mpc_name, ra, dec) AS (\n    VALUES\n    -- ('MPC_object_name', ra_in_deg, dec_in_deg)\n    -- Add rows or replace this CTE with your real MPC/Solar System object table\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    p.probability,\n    d.candid,\n    mnear.dist_deg * 3600.0 AS dist_arcsec,  -- distance in arcsec\n    mnear.mpc_name,\n    d.mjd,\n    d.fid\nFROM object o\nINNER JOIN probability p\n    ON p.oid = o.oid\n   AND p.classifier_name = 'stamp_classifier'\n   AND p.classifier_version = 'stamp_classifier_1.0.4'\n   AND p.class_name = 'asteroid'\n   AND p.probability > 0.5\n-- earliest detection per object\nINNER JOIN LATERAL (\n    SELECT d1.*\n    FROM detection d1\n    WHERE d1.oid = o.oid\n    ORDER BY d1.mjd ASC\n    LIMIT 1\n) d ON TRUE\n-- nearest MPC object within 2 arcsec\nINNER JOIN LATERAL (\n    SELECT\n        m.mpc_name,\n        q3c_dist(o.meanra, o.meandec, m.ra, m.dec) AS dist_deg\n    FROM mpc m\n    WHERE q3c_join(o.meanra, o.meandec, m.ra, m.dec, 2.0/3600.0)\n    ORDER BY dist_deg ASC\n    LIMIT 1\n) mnear ON TRUE\nWHERE o.ndet > 500\nORDER BY o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3086, "completion_tokens": 3854, "total_tokens": 6940, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3392, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28439e208190916867d5370944c0", "custom_id": "107-6", "response": {"status_code": 200, "request_id": "e80a0ca5eb3a0c3fca78c82723b5e14e", "body": {"id": "chatcmpl-CZawcXIbZ4f38qYyBcuIfRemH1wMG", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3086, "completion_tokens": 4000, "total_tokens": 7086, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2843539c819082bdd28f8f6bc0d8", "custom_id": "107-7", "response": {"status_code": 200, "request_id": "a3d27bb3691d37411489fdaf4e38bf95", "body": {"id": "chatcmpl-CZawcF3mdst4ackfhJ9t751kKwhka", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3086, "completion_tokens": 4000, "total_tokens": 7086, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28438ea88190b34d95863bea2df3", "custom_id": "107-8", "response": {"status_code": 200, "request_id": "c45feab2e28514d7740fedc787a26801", "body": {"id": "chatcmpl-CZawcM3OBWqLr5jyedw94w6OCqOI3", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3086, "completion_tokens": 4000, "total_tokens": 7086, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284347e88190a40487783cbe4a41", "custom_id": "107-9", "response": {"status_code": 200, "request_id": "08702b1df0d0d64ec4fa07e88bc40ff4", "body": {"id": "chatcmpl-CZawc208vYeoq6QCnxKEi2Ih3yjCo", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* Find up to 10 ZTF objects with >500 detections, asteroid probability > 0.5\n   from stamp_classifier_1.0.4, and a nearest Solar System (MPC) object within 2 arcsec.\n   Replace the 'mpc' CTE with the MPC sources (ra,dec in degrees) you want to match. */\nWITH mpc (name, ra, dec) AS (\n    /* Provide MPC objects here (one row per source), e.g.:\n       VALUES\n         ('(101955) Bennu',  101.234567, -12.345678),\n         ('(99942) Apophis', 250.123456,  36.543210)\n       The following creates an empty MPC set; replace it with the VALUES above. */\n    SELECT NULL::varchar AS name, NULL::double precision AS ra, NULL::double precision AS dec\n    WHERE false\n),\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability\n    FROM object o\n    INNER JOIN probability p\n        ON p.oid = o.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.5\n)\nSELECT\n    fo.oid,                 -- ZTF identifier\n    fo.ndet,                -- number of detections\n    fo.firstmjd,            -- first detection date\n    fo.lastmjd,             -- last detection date\n    fo.probability,         -- asteroid probability (stamp classifier)\n    best.candid,            -- candidate identifier\n    best.distance_arcsec,   -- distance between ZTF detection and MPC object (arcsec)\n    best.name,              -- MPC name\n    best.mjd,               -- detection date\n    best.fid                -- filter identifier\nFROM filtered_objects fo\nJOIN LATERAL (\n    SELECT\n        d.candid,\n        d.mjd,\n        d.fid,\n        m.name,\n        q3c_dist(d.ra, d.dec, m.ra, m.dec) * 3600.0 AS distance_arcsec\n    FROM detection d\n    JOIN mpc m\n        ON q3c_join(d.ra, d.dec, m.ra, m.dec, 2.0/3600.0)  -- within 2 arcsec\n    WHERE d.oid = fo.oid\n    ORDER BY q3c_dist(d.ra, d.dec, m.ra, m.dec) ASC\n    LIMIT 1\n) AS best ON true\nORDER BY fo.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3086, "completion_tokens": 3936, "total_tokens": 7022, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3328, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28436aa881909700e733d3266d73", "custom_id": "83-5", "response": {"status_code": 200, "request_id": "4c8fe18bf39981ea967369d72d35ead6", "body": {"id": "chatcmpl-CZawcC7ll8aDUJrYznw3vIa3eyq5t", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all columns from the 'allwise' table for the ZTF object by sky-position crossmatch\n-- Uses a 2 arcsec radius; adjust if needed\nSELECT\n  a.*\nFROM object o\nINNER JOIN allwise a\n  ON q3c_join(a.ra, a.dec, o.meanra, o.meandec, 2.0/3600.0)\nWHERE o.oid = 'ZTF21aazqwxv'\nORDER BY q3c_dist(a.ra, a.dec, o.meanra, o.meandec);\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2995, "completion_tokens": 1858, "total_tokens": 4853, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2843602881909cfc9a93f0a8c854", "custom_id": "83-6", "response": {"status_code": 200, "request_id": "4469651202b7d48bee5177a43d5568d0", "body": {"id": "chatcmpl-CZaxtJ47vhGwsgCrFv1WzCx9gqQTI", "object": "chat.completion", "created": 1762599609, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all columns from the AllWISE table matched to the ZTF object 'ZTF21aazqwxv'\n-- using a 3 arcsec radius crossmatch via Q3C, returning the nearest source.\nWITH target AS (\n  SELECT oid, meanra, meandec\n  FROM object\n  WHERE oid = 'ZTF21aazqwxv'\n)\nSELECT a.*\nFROM allwise a\nJOIN target t\n  ON q3c_radial_query(a.ra, a.dec, t.meanra, t.meandec, 3.0/3600.0)\nORDER BY q3c_dist(a.ra, a.dec, t.meanra, t.meandec) ASC\nLIMIT 1;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2938, "completion_tokens": 1508, "total_tokens": 4446, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28435e108190b6f67f71f7cca648", "custom_id": "83-7", "response": {"status_code": 200, "request_id": "dec7b7d87d506e0350ee657c55628013", "body": {"id": "chatcmpl-CZawc79R2uttjr8UHAA7kcafEam0g", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all columns from the AllWISE crossmatch table for the specified ZTF object\nSELECT *\nFROM allwise\nWHERE oid = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2995, "completion_tokens": 626, "total_tokens": 3621, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284381e08190948edd5316ef5dd2", "custom_id": "83-8", "response": {"status_code": 200, "request_id": "79517b48ddcb05c169efab8f78e865b8", "body": {"id": "chatcmpl-CZawcRcI5UrUZeWUUqEgvQwvV8Tum", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all columns from ALLWISE entries matched to the ZTF object by a 2.5 arcsec cone using Q3C\nWITH target_obj AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21aazqwxv'\n)\nSELECT aw.*\nFROM allwise AS aw\nJOIN target_obj AS t\n    ON q3c_radial_query(aw.ra, aw.dec, t.meanra, t.meandec, 2.5/3600.0)\nORDER BY q3c_dist(aw.ra, aw.dec, t.meanra, t.meandec) ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2912, "completion_tokens": 1301, "total_tokens": 4213, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2843d300819091f420d41f954a4d", "custom_id": "83-9", "response": {"status_code": 200, "request_id": "eeb39fa51b397f3d0c2e36f63f34f32e", "body": {"id": "chatcmpl-CZaxvjriE63AU75zS2DESrecE9uFQ", "object": "chat.completion", "created": 1762599611, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all columns in the 'allwise' table for the ZTF object 'ZTF21aazqwxv'\nSELECT aw.*\nFROM xmatch AS xm\nINNER JOIN allwise AS aw\n    ON aw.oid_catalog = xm.oid_catalog\nWHERE xm.oid = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2969, "completion_tokens": 1426, "total_tokens": 4395, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2843d2688190b837da2f2d25c071", "custom_id": "84-5", "response": {"status_code": 200, "request_id": "d3e221b69695b223213d6be6cc471fd2", "body": {"id": "chatcmpl-CZawcuWfg54ZFZW06D1PWxHWKmLPa", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- ALLWISE cross-matches for the ZTF object 'ZTF19aascdol'\n-- Returns: ZTF identifier (oid), ALLWISE identifier (oid_catalog), angular separation (dist, arcsec),\n-- and WISE magnitudes in W1\u2013W4 (w1mpro, w2mpro, w3mpro, w4mpro)\nSELECT\n    xm.oid,\n    xm.oid_catalog,\n    xm.dist,\n    aw.w1mpro,\n    aw.w2mpro,\n    aw.w3mpro,\n    aw.w4mpro\nFROM xmatch AS xm\nINNER JOIN allwise AS aw\n    ON xm.oid_catalog = aw.oid_catalog\nWHERE xm.oid = 'ZTF19aascdol'\nORDER BY xm.dist ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2861, "completion_tokens": 1010, "total_tokens": 3871, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28444ca481909dc5fee5f5b494f8", "custom_id": "84-6", "response": {"status_code": 200, "request_id": "1828782a389d1b08b0014a27e7831a38", "body": {"id": "chatcmpl-CZaxzNhzKhpHfLU1E4A9S439RVjzh", "object": "chat.completion", "created": 1762599615, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- ALLWISE matches for a given ZTF object, with angular distance and W1\u2013W4 magnitudes\nSELECT\n    xm.oid,              -- ZTF identifier\n    xm.oid_catalog,      -- AllWISE catalog identifier\n    xm.dist,             -- angular distance (arcseconds)\n    aw.w1mpro,           -- W1 magnitude\n    aw.w2mpro,           -- W2 magnitude\n    aw.w3mpro,           -- W3 magnitude\n    aw.w4mpro            -- W4 magnitude\nFROM xmatch AS xm\nINNER JOIN allwise AS aw\n    ON xm.oid_catalog = aw.oid_catalog  -- ensures only AllWISE counterparts are returned\nWHERE xm.oid = 'ZTF19aascdol'\nORDER BY xm.dist ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2833, "completion_tokens": 1138, "total_tokens": 3971, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2843efd48190be40cc2b1b7890f4", "custom_id": "84-7", "response": {"status_code": 200, "request_id": "63bed51703b58525ce5a1fe6329fb61e", "body": {"id": "chatcmpl-CZawc4YFVbdS9W3a5OrGc3NB9rOYI", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return ALLWISE cross-match information for the specified ZTF object\nSELECT\n    xmatch.oid,              -- ZTF identifier\n    xmatch.oid_catalog,      -- ALLWISE catalog identifier\n    xmatch.dist,             -- angular distance (arcseconds)\n    allwise.w1mpro,          -- WISE W1 magnitude\n    allwise.w2mpro,          -- WISE W2 magnitude\n    allwise.w3mpro,          -- WISE W3 magnitude\n    allwise.w4mpro           -- WISE W4 magnitude\nFROM xmatch\nINNER JOIN allwise\n    ON allwise.oid_catalog = xmatch.oid_catalog\nWHERE xmatch.oid = 'ZTF19aascdol'\n  AND xmatch.catid = 'ALLWISE'\nORDER BY xmatch.dist ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2906, "completion_tokens": 954, "total_tokens": 3860, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28441c2081908a6b4aa9136e5912", "custom_id": "84-8", "response": {"status_code": 200, "request_id": "35cf941f0d347f41ca7b79d2619bac93", "body": {"id": "chatcmpl-CZay0ACAZcgjcFKpBgNgvpEeGvBt5", "object": "chat.completion", "created": 1762599616, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- ALLWISE matches for a specific ZTF object with requested fields\nSELECT\n  xmatch.oid,               -- ZTF identifier\n  xmatch.oid_catalog,       -- AllWISE catalog identifier\n  xmatch.dist,              -- angular separation in arcseconds\n  allwise.w1mpro,           -- WISE W1 magnitude\n  allwise.w2mpro,           -- WISE W2 magnitude\n  allwise.w3mpro,           -- WISE W3 magnitude\n  allwise.w4mpro            -- WISE W4 magnitude\nFROM xmatch\nINNER JOIN allwise\n  ON allwise.oid_catalog = xmatch.oid_catalog\nWHERE xmatch.oid = 'ZTF19aascdol'\nORDER BY xmatch.dist ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2901, "completion_tokens": 943, "total_tokens": 3844, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284423e48190a3c768317363010e", "custom_id": "84-9", "response": {"status_code": 200, "request_id": "b45b3269a54c9644af73e4c3106108cc", "body": {"id": "chatcmpl-CZawtqIN657ypIn0WoFAvBrYcslS8", "object": "chat.completion", "created": 1762599547, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- ALLWISE counterparts (with photometry) for the given ZTF object\nSELECT\n    o.oid,              -- ZTF identifier\n    a.oid_catalog,      -- ALLWISE catalog identifier\n    x.dist,             -- distance between counterparts (arcsec)\n    a.w1mpro,           -- WISE W1 magnitude\n    a.w2mpro,           -- WISE W2 magnitude\n    a.w3mpro,           -- WISE W3 magnitude\n    a.w4mpro            -- WISE W4 magnitude\nFROM object AS o\nINNER JOIN xmatch AS x\n    ON x.oid = o.oid\nINNER JOIN allwise AS a\n    ON a.oid_catalog = x.oid_catalog  -- restricts to AllWISE matches\nWHERE o.oid = 'ZTF19aascdol'\nORDER BY x.dist ASC;  -- nearest counterpart first\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2753, "completion_tokens": 905, "total_tokens": 3658, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284416b0819088b88f1921d50350", "custom_id": "96-5", "response": {"status_code": 200, "request_id": "c5fec107a5f07ccc0b1efb1a3bba9d67", "body": {"id": "chatcmpl-CZay1JxlPf7RMuBBe4WdwM1J9fhMU", "object": "chat.completion", "created": 1762599617, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all detections for ZTF objects within 2 arcsec of the specified Solar System identifiers,\n-- returning all ss_ztf columns and selected detection fields; sorted by MPC name and detection date.\nSELECT\n    ss_ztf.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra,\n    detection.dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM ss_ztf\nINNER JOIN detection\n    ON detection.oid = ss_ztf.oid\nWHERE\n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\n    AND ss_ztf.ssdistnr <= 2\nORDER BY\n    ss_ztf.ssnamenr ASC,\n    detection.mjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2935, "completion_tokens": 1653, "total_tokens": 4588, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284413fc8190b552e6274894752e", "custom_id": "96-6", "response": {"status_code": 200, "request_id": "15e0a7917dda25d25463eb237743a30b", "body": {"id": "chatcmpl-CZawwfZbeE1NKhz6Ft0rMU4ol2sYu", "object": "chat.completion", "created": 1762599550, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3058, "completion_tokens": 4000, "total_tokens": 7058, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2844447c8190a24bd2e68cd5c84a", "custom_id": "96-7", "response": {"status_code": 200, "request_id": "32f9fdce72204b9f31c47e7933410978", "body": {"id": "chatcmpl-CZayK5McZ8SOnC4BgCtFYg3NYpjeh", "object": "chat.completion", "created": 1762599636, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all detections for ZTF objects associated within 2 arcsec of the specified Solar System objects\nWITH ss AS (\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n      AND ssdistnr <= 2 -- arcseconds\n)\nSELECT\n    ss.*,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM ss\nINNER JOIN detection d\n    ON d.oid = ss.oid -- join by object to retrieve all detections for each matched object\nORDER BY ss.ssnamenr ASC, d.mjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3225, "completion_tokens": 1448, "total_tokens": 4673, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1280, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284445bc8190b2dde5b307e64e02", "custom_id": "96-8", "response": {"status_code": 200, "request_id": "79c5d502324e5303d0a36a222efcfd1b", "body": {"id": "chatcmpl-CZawylkRXDORpnMeNkLpUh5TDAhc2", "object": "chat.completion", "created": 1762599552, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all detections for ZTF objects within 2 arcsec of specified Solar System identifiers\nWITH ss_matches AS (\n    SELECT\n        *\n    FROM\n        ss_ztf\n    WHERE\n        ssnamenr IN ('2003FP134', '2009UK56')\n        AND ssdistnr <= 2\n)\nSELECT\n    ss_matches.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra,\n    detection.dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM\n    ss_matches\nINNER JOIN\n    detection\nON\n    detection.oid = ss_matches.oid\nORDER BY\n    ss_matches.ssnamenr ASC,\n    detection.mjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2965, "completion_tokens": 1256, "total_tokens": 4221, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284466e08190be6aec658ac16447", "custom_id": "96-9", "response": {"status_code": 200, "request_id": "abdaa16f33c103700022761021878d5e", "body": {"id": "chatcmpl-CZax43aVczSZbflsycSVmPDOyKyXf", "object": "chat.completion", "created": 1762599558, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- All ss_ztf columns plus selected detection fields for objects matched to MPC names within 2 arcsec\nSELECT\n    sst.*,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM ss_ztf AS sst\nINNER JOIN detection AS d\n    ON d.oid = sst.oid\nWHERE\n    sst.ssnamenr IN ('2003FP134', '2009UK56')\n    AND sst.ssdistnr <= 2\nORDER BY\n    sst.ssnamenr ASC,\n    d.mjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 1117, "total_tokens": 4242, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28445af88190b7427090e7fb469e", "custom_id": "94-5", "response": {"status_code": 200, "request_id": "1242c1420c8f715a7c347026437a713b", "body": {"id": "chatcmpl-CZaxBgiO0bFpN3RkZlJvlF7AuQevS", "object": "chat.completion", "created": 1762599565, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all columns from 'object' and 'reference' for objects with a reference change, limited to 50 rows\nSELECT\n  o.*,\n  r.*\nFROM object AS o\nINNER JOIN reference AS r\n  ON r.oid = o.oid\nWHERE o.reference_change IS TRUE\nORDER BY o.oid ASC, r.rfid ASC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2708, "completion_tokens": 795, "total_tokens": 3503, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28448a1c8190bcb40fade95f58ae", "custom_id": "94-6", "response": {"status_code": 200, "request_id": "59fc1584b80e3f02c17bf172497bde01", "body": {"id": "chatcmpl-CZaxKle0zJiut9v94kCMDSdvPAmDh", "object": "chat.completion", "created": 1762599574, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- The ALeRCE 2023 schema provided does not include a 'reference' table.\n-- Using 'detection' as the source of reference-related information via detection.rfid.\nSELECT\n  o.*,\n  d.*\nFROM object AS o\nINNER JOIN detection AS d\n  ON d.oid = o.oid\nWHERE\n  o.reference_change IS TRUE\nORDER BY\n  o.lastmjd DESC NULLS LAST,\n  d.mjd DESC NULLS LAST,\n  d.candid DESC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2638, "completion_tokens": 1402, "total_tokens": 4040, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1280, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2844c24c81909248c0392ebe8877", "custom_id": "94-7", "response": {"status_code": 200, "request_id": "0bf03284e808b92571cb08832247f178", "body": {"id": "chatcmpl-CZayOVtmWPrD8fBGS9pFxRQ8tzcbb", "object": "chat.completion", "created": 1762599640, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all columns from 'object' and 'reference' for ZTF objects with a change in the reference image\nSELECT\n  o.*,\n  r.*\nFROM object AS o\nINNER JOIN reference AS r\n  ON r.oid = o.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2464, "completion_tokens": 1038, "total_tokens": 3502, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2844b2248190b35ad851d8ede4d7", "custom_id": "94-8", "response": {"status_code": 200, "request_id": "cb5b178465c129ce01a3e29d3120c59d", "body": {"id": "chatcmpl-CZaxOyRAZ9yJTusOZvltzONlP1bl9", "object": "chat.completion", "created": 1762599578, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all columns from 'object' and 'reference' for objects with a change in the reference, limited to 50 rows\nSELECT\n  o.*,\n  r.*\nFROM object AS o\nINNER JOIN reference AS r\n  ON r.oid = o.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2880, "completion_tokens": 1105, "total_tokens": 3985, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284501c081908bae51edd0588b4d", "custom_id": "94-9", "response": {"status_code": 200, "request_id": "df4c7bf3aeaedd2e1914ba664f177ff9", "body": {"id": "chatcmpl-CZaySwXWhj9SIprEsP7138HGt5EtV", "object": "chat.completion", "created": 1762599644, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all columns from 'object' and 'reference' for objects where the reference image changed\nSELECT\n  o.*,\n  r.*\nFROM object AS o\nINNER JOIN reference AS r\n  ON r.oid = o.oid\nWHERE o.reference_change IS TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2792, "completion_tokens": 1034, "total_tokens": 3826, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2846a8708190ba1ab588fbdc057d", "custom_id": "90-5", "response": {"status_code": 200, "request_id": "a5e961e7e0ffb4c8ca9c14878868f813", "body": {"id": "chatcmpl-CZaxRb6zUXoPxNcMPLslaZekhE3DY", "object": "chat.completion", "created": 1762599581, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* Find up to 100 ZTF objects with Multiband_period < 5 in version 'lc_classifier_1.2.1-P'\n   and return all columns from probability for the light curve classifier with rankings 1 or 2 */\nWITH candidates AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n      AND f.oid LIKE 'ZTF%' -- ensure ZTF objects\n    ORDER BY f.value ASC, f.oid -- pick the shortest periods deterministically\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nINNER JOIN candidates c ON c.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nORDER BY p.oid ASC, p.ranking ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2862, "completion_tokens": 1424, "total_tokens": 4286, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2844d1f88190a4861ac65abe4c63", "custom_id": "90-6", "response": {"status_code": 200, "request_id": "1990d9136bfbf4de403e08923f5ca119", "body": {"id": "chatcmpl-CZayUyAsHlo9GXPxu4rmovRXLcrGg", "object": "chat.completion", "created": 1762599646, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all probability rows (all columns) for up to 100 objects whose Multiband_period < 5\n-- using feature.version = 'lc_classifier_1.2.1-P', restricted to the light curve classifier\n-- and rankings 1 or 2.\nWITH candidate_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    ORDER BY f.oid\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nINNER JOIN candidate_oids c ON c.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nORDER BY p.oid ASC, p.classifier_version ASC, p.ranking ASC, p.probability DESC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3041, "completion_tokens": 1611, "total_tokens": 4652, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28452a308190b3f9f862c86fefbe", "custom_id": "90-7", "response": {"status_code": 200, "request_id": "a9eabd5b8a8f9631bff059f336f5e8ae", "body": {"id": "chatcmpl-CZaxUJiZy7To9P9YucQQNNtzKon4r", "object": "chat.completion", "created": 1762599584, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 100 objects with Multiband_period < 5 in feature version 'lc_classifier_1.2.1-P'\n-- Then return all probability rows for the light curve classifier with rankings 1 or 2\nWITH candidate_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nINNER JOIN candidate_oids c ON p.oid = c.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nORDER BY p.oid, p.ranking, p.classifier_version;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3085, "completion_tokens": 1907, "total_tokens": 4992, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2845ae04819089af085268efaed0", "custom_id": "90-8", "response": {"status_code": 200, "request_id": "976a086cae7751dca359a1ee7c536549", "body": {"id": "chatcmpl-CZayb1bhNmr8cISOFvnwkBLO44vdf", "object": "chat.completion", "created": 1762599653, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 100 objects with Multiband_period < 5 days from feature version 'lc_classifier_1.2.1-P'\n-- Assumes multiband period is stored with fid = 123 (gri)\n-- Return all probability columns for the light curve classifier with rankings 1 or 2\nWITH selected_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.fid = 123\n      AND f.value < 5\n    ORDER BY f.value ASC\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nINNER JOIN selected_oids s ON p.oid = s.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nORDER BY p.oid, p.ranking;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3208, "completion_tokens": 1936, "total_tokens": 5144, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2844f38481908bd41822b981b8d1", "custom_id": "90-9", "response": {"status_code": 200, "request_id": "64c1e979ce3737c64c248f2d1cd8bafa", "body": {"id": "chatcmpl-CZaxnL1AkMIh3P1lQpKtqhDdtzOLQ", "object": "chat.completion", "created": 1762599603, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* Return all probability rows (all columns) for up to 100 objects\n   that have Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P',\n   using the multiband fid = 123. Only include light curve classifier results\n   with ranking 1 or 2. */\nWITH selected_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.fid = 123\n      AND f.value < 5\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nINNER JOIN selected_oids s ON p.oid = s.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3131, "completion_tokens": 1474, "total_tokens": 4605, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1280, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2844f1c881909b83c33088b830e1", "custom_id": "100-5", "response": {"status_code": 200, "request_id": "111caf54bb6ea67bdeab8225ff77b7d9", "body": {"id": "chatcmpl-CZawckEAM01Zu7KmUJ9Y59apJu2aR", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return detections for the specified ZTF object with the requested columns.\n-- NOTE: The provided schema includes only the 'detection' table; there are no\n--       'non_detection' or 'forced_photometry' tables available here.\n--       Placeholders for those are included as empty SELECTs to keep a single\n--       unified output with a 'table' origin column.\n\nSELECT\n    d.oid,                  -- ZTF identifier\n    d.mjd,                  -- epoch date\n    d.fid,                  -- filter identifier\n    d.isdiffpos,            -- isdiffpos flag\n    d.magpsf,               -- detection difference magnitude\n    d.sigmapsf,             -- detection difference magnitude uncertainty\n    d.diffmaglim,           -- 5-sigma magnitude limit\n    NULL::DOUBLE PRECISION AS forced_mag,       -- forced photometry magnitude (not available in this schema)\n    NULL::DOUBLE PRECISION AS forced_mag_err,   -- forced photometry magnitude uncertainty (not available in this schema)\n    'detection'::TEXT AS \"table\"                -- origin table\nFROM detection d\nWHERE d.oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Placeholder for non-detections (no table available in provided schema)\nSELECT\n    'ZTF24aamtvxb'::VARCHAR AS oid,\n    NULL::DOUBLE PRECISION  AS mjd,\n    NULL::INTEGER           AS fid,\n    NULL::INTEGER           AS isdiffpos,\n    NULL::DOUBLE PRECISION  AS magpsf,\n    NULL::DOUBLE PRECISION  AS sigmapsf,\n    NULL::DOUBLE PRECISION  AS diffmaglim,\n    NULL::DOUBLE PRECISION  AS forced_mag,\n    NULL::DOUBLE PRECISION  AS forced_mag_err,\n    'non_detection'::TEXT   AS \"table\"\nWHERE FALSE\n\nUNION ALL\n\n-- Placeholder for forced photometry (no table available in provided schema)\nSELECT\n    'ZTF24aamtvxb'::VARCHAR AS oid,\n    NULL::DOUBLE PRECISION  AS mjd,\n    NULL::INTEGER           AS fid,\n    NULL::INTEGER           AS isdiffpos,\n    NULL::DOUBLE PRECISION  AS magpsf,\n    NULL::DOUBLE PRECISION  AS sigmapsf,\n    NULL::DOUBLE PRECISION  AS diffmaglim,\n    NULL::DOUBLE PRECISION  AS forced_mag,\n    NULL::DOUBLE PRECISION  AS forced_mag_err,\n    'forced_photometry'::TEXT AS \"table\"\nWHERE FALSE;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3803, "total_tokens": 6873, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28453910819092f656031dc91e35", "custom_id": "100-6", "response": {"status_code": 200, "request_id": "565f7850c6250fe7d83e695e60f4b114", "body": {"id": "chatcmpl-CZaypTZan3bhkQc6eP8GnyCwRmynC", "object": "chat.completion", "created": 1762599667, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* The provided schema includes only the 'detection' table for per-epoch photometry.\n   There are no tables for non-detections or forced photometry in the given schema,\n   so this query returns only detections for the requested object. The columns for\n   forced photometry are included as NULL placeholders to match the requested output.\n*/\nSELECT\n  d.oid,                -- ZTF identifier\n  d.mjd,                -- epoch date\n  d.fid,                -- filter identifier (1=g; 2=r; 3=i)\n  d.isdiffpos,          -- isdiffpos flag\n  d.magpsf,             -- detection difference magnitude\n  d.sigmapsf,           -- detection difference magnitude uncertainty\n  d.diffmaglim,         -- 5-sigma magnitude limit\n  NULL::double precision AS forced_mag,      -- forced difference magnitude (not available)\n  NULL::double precision AS forced_mag_err,  -- forced difference magnitude uncertainty (not available)\n  'detection'::text AS \"table\"               -- origin table\nFROM detection d\nWHERE d.oid = 'ZTF24aamtvxb'\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3011, "total_tokens": 6081, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2752, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284563c48190ac28a0d953125f74", "custom_id": "100-7", "response": {"status_code": 200, "request_id": "9d09285077687aad2c3e37617b24916a", "body": {"id": "chatcmpl-CZaxq74JJhPd6h7SFYD11dn20qQSW", "object": "chat.completion", "created": 1762599606, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- The current schema exposes only 'detection'; there are no 'non_detection' or 'forced_photometry' tables defined above.\n-- This query returns all detection epochs for the object, and includes placeholder NULLs for the forced-photometry columns.\n-- If your deployment includes 'non_detection' and/or 'forced_photometry' tables, you can UNION ALL analogous SELECTs to combine all epochs.\n\nSELECT\n  d.oid,                 -- ZTF identifier\n  d.mjd,                 -- epoch date\n  d.fid,                 -- filter identifier (1=g; 2=r; 3=i)\n  d.isdiffpos,           -- isdiffpos flag\n  d.magpsf,              -- detection difference magnitude\n  d.sigmapsf,            -- detection difference magnitude uncertainty\n  d.diffmaglim,          -- 5-sigma magnitude limit\n  NULL::DOUBLE PRECISION AS forced_magpsf,     -- forced difference magnitude (placeholder)\n  NULL::DOUBLE PRECISION AS forced_sigmapsf,   -- forced difference magnitude uncertainty (placeholder)\n  'detection'::text AS \"table\"                 -- table of origin\nFROM detection d\nWHERE d.oid = 'ZTF24aamtvxb'\nORDER BY d.mjd;\n\n/*\n-- Example blocks to UNION if your instance has these tables (adjust column names as needed):\n\nUNION ALL\nSELECT\n  nd.oid,\n  nd.mjd,\n  nd.fid,\n  NULL::INTEGER AS isdiffpos,\n  NULL::DOUBLE PRECISION AS magpsf,\n  NULL::DOUBLE PRECISION AS sigmapsf,\n  nd.diffmaglim,\n  NULL::DOUBLE PRECISION AS forced_magpsf,\n  NULL::DOUBLE PRECISION AS forced_sigmapsf,\n  'non_detection'::text AS \"table\"\nFROM non_detection nd\nWHERE nd.oid = 'ZTF24aamtvxb'\n\nUNION ALL\nSELECT\n  fp.oid,\n  fp.mjd,\n  fp.fid,\n  NULL::INTEGER AS isdiffpos,\n  NULL::DOUBLE PRECISION AS magpsf,\n  NULL::DOUBLE PRECISION AS sigmapsf,\n  NULL::DOUBLE PRECISION AS diffmaglim,\n  fp.magpsf AS forced_magpsf,\n  fp.sigmapsf AS forced_sigmapsf,\n  'forced_photometry'::text AS \"table\"\nFROM forced_photometry fp\nWHERE fp.oid = 'ZTF24aamtvxb'\nORDER BY mjd;\n*/\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3603, "total_tokens": 6673, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3072, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2845437c8190942931c5a339d307", "custom_id": "100-8", "response": {"status_code": 200, "request_id": "0063e468ff429c1f4c8287c6edb40b54", "body": {"id": "chatcmpl-CZawcRJsL2KVtHvh8jhPzxKqSKDiy", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* \nRequested: detections, non-detections, and forced photometry epochs for 'ZTF24aamtvxb'\nNote: In the provided schema, only the 'detection' table contains epoch-level photometry.\n      There are no 'non_detection' or 'forced_photometry' tables available, so those\n      UNION branches are placeholders that return zero rows (kept for schema consistency).\n      If those tables become available, replace the placeholders with real SELECTs.\n\nColumns returned:\n- oid (ZTF identifier)\n- mjd (epoch date)\n- fid (filter identifier)\n- isdiffpos (flag)\n- magpsf, sigmapsf (detection difference magnitude and its uncertainty)\n- diffmaglim (5-sigma magnitude limit)\n- forced_magpsf, forced_sigmapsf (forced photometry magnitude and uncertainty; NULL here)\n- \"table\" (name of origin table)\n*/\n\nSELECT\n  d.oid,\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.magpsf,\n  d.sigmapsf,\n  d.diffmaglim,\n  NULL::double precision AS forced_magpsf,\n  NULL::double precision AS forced_sigmapsf,\n  'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n/* Placeholder for non-detections: returns zero rows in this schema */\nSELECT\n  o.oid,\n  NULL::double precision AS mjd,\n  NULL::integer AS fid,\n  NULL::integer AS isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  NULL::double precision AS diffmaglim,\n  NULL::double precision AS forced_magpsf,\n  NULL::double precision AS forced_sigmapsf,\n  'non_detection'::text AS \"table\"\nFROM object o\nWHERE o.oid = 'ZTF24aamtvxb' AND FALSE\n\nUNION ALL\n\n/* Placeholder for forced photometry: returns zero rows in this schema */\nSELECT\n  o.oid,\n  NULL::double precision AS mjd,\n  NULL::integer AS fid,\n  NULL::integer AS isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  NULL::double precision AS diffmaglim,\n  NULL::double precision AS forced_magpsf,\n  NULL::double precision AS forced_sigmapsf,\n  'forced_photometry'::text AS \"table\"\nFROM object o\nWHERE o.oid = 'ZTF24aamtvxb' AND FALSE\n\nORDER BY mjd NULLS LAST;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3837, "total_tokens": 6907, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2845656c81909476dcb1faf13c37", "custom_id": "100-9", "response": {"status_code": 200, "request_id": "4c83a6122a5e82d75dfe39034a27e634", "body": {"id": "chatcmpl-CZayrPbFl9TtBmwz7SIF4EEJSKwxZ", "object": "chat.completion", "created": 1762599669, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Combined epochs (detections, non-detections, forced photometry) for ZTF24aamtvxb\n-- Note: In this schema only the 'detection' table exists. Non-detections and forced photometry\n-- tables are not present, so those sections return zero rows but keep the requested unified layout.\n\nSELECT\n  d.oid,                                -- ZTF identifier\n  d.mjd,                                -- epoch date (MJD)\n  d.fid,                                -- filter identifier (1=g; 2=r; 3=i)\n  d.isdiffpos,                          -- isdiffpos flag\n  d.magpsf,                             -- detection difference magnitude\n  d.sigmapsf,                           -- detection difference magnitude uncertainty\n  d.diffmaglim,                         -- 5-sigma magnitude limit\n  NULL::double precision AS forced_mag, -- forced difference magnitude (not available in this schema)\n  NULL::double precision AS forced_mag_err, -- forced difference magnitude uncertainty (not available)\n  'detection'::text AS \"table\"          -- origin table\nFROM detection d\nWHERE d.oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Placeholder for non-detections (no rows returned in this schema)\nSELECT\n  o.oid,\n  NULL::double precision AS mjd,\n  NULL::integer AS fid,\n  NULL::integer AS isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  NULL::double precision AS diffmaglim,\n  NULL::double precision AS forced_mag,\n  NULL::double precision AS forced_mag_err,\n  'non_detection'::text AS \"table\"\nFROM object o\nWHERE o.oid = 'ZTF24aamtvxb' AND FALSE\n\nUNION ALL\n\n-- Placeholder for forced photometry (no rows returned in this schema)\nSELECT\n  o.oid,\n  NULL::double precision AS mjd,\n  NULL::integer AS fid,\n  NULL::integer AS isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  NULL::double precision AS diffmaglim,\n  NULL::double precision AS forced_mag,\n  NULL::double precision AS forced_mag_err,\n  'forced_photometry'::text AS \"table\"\nFROM object o\nWHERE o.oid = 'ZTF24aamtvxb' AND FALSE\n\nORDER BY mjd;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3596, "total_tokens": 6666, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3072, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28457d1c8190a5fa10ed273e6782", "custom_id": "106-5", "response": {"status_code": 200, "request_id": "bfbc3868b5749f83a9c53b0b96cb2e43", "body": {"id": "chatcmpl-CZaxxVUxxTmsQWNtkgkt4CRshSy95", "object": "chat.completion", "created": 1762599613, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* Find up to 30 ZTF objects with ndet > 10, high bogus prob in stamp_classifier v1.0.4,\n   and high Transient prob in lc_classifier_top. Return requested columns and order by oid. */\nWITH lc_top AS (\n    SELECT\n        oid,\n        MAX(probability) AS prob_lc_transient\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n    GROUP BY oid\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p_s.probability AS prob_stamp_bogus,\n    lc_top.prob_lc_transient\nFROM object o\nINNER JOIN probability p_s\n    ON p_s.oid = o.oid\n   AND p_s.class_name = 'bogus'\n   AND p_s.classifier_name = 'stamp_classifier'\n   AND p_s.classifier_version = 'stamp_classifier_1.0.4'\n   AND p_s.probability > 0.7\nINNER JOIN lc_top\n    ON lc_top.oid = o.oid\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3114, "completion_tokens": 2576, "total_tokens": 5690, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284580208190bddd6c3140239f79", "custom_id": "106-6", "response": {"status_code": 200, "request_id": "b0b1bed09d55ed31daae7199a266e472", "body": {"id": "chatcmpl-CZayrUEz0c8mdul35EakD1mYB8H08", "object": "chat.completion", "created": 1762599669, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 30 ZTF objects with:\n-- - ndet > 10\n-- - stamp classifier (version 'stamp_classifier_1.0.4') bogus probability > 0.7 (ranking=1)\n-- - lc_classifier_top Transient probability > 0.9 (ranking=1)\n-- Return: oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient\n-- Order by ZTF identifier (oid)\nSELECT DISTINCT ON (o.oid)\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p_stamp.probability AS prob_stamp_bogus,\n    p_top.probability AS prob_lc_transient\nFROM object o\nINNER JOIN probability p_stamp\n    ON p_stamp.oid = o.oid\nINNER JOIN probability p_top\n    ON p_top.oid = o.oid\nWHERE\n    o.ndet > 10\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.class_name = 'bogus'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.7\n    AND p_stamp.ranking = 1 -- default condition: use most likely class per classifier/version\n    AND p_top.classifier_name = 'lc_classifier_top'\n    AND p_top.class_name = 'Transient'\n    AND p_top.probability > 0.9\n    AND p_top.ranking = 1 -- default condition\nORDER BY\n    o.oid,               -- order by ZTF identifier\n    p_top.probability DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3114, "completion_tokens": 3369, "total_tokens": 6483, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3008, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2845938c8190a001ec904cf78139", "custom_id": "106-7", "response": {"status_code": 200, "request_id": "0d15eb724f467efdc0794260bc2e6c5a", "body": {"id": "chatcmpl-CZawcEvVadJ8BmZLpBY99SZOCUJ84", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 30 ZTF objects with >10 detections, bogus prob > 0.7 (stamp_classifier_1.0.4),\n-- and Transient prob > 0.9 (lc_classifier_top). Return requested columns and order by object oid.\nWITH plct AS (\n    SELECT\n        p.oid,\n        MAX(p.probability) AS probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n    GROUP BY p.oid\n    HAVING MAX(p.probability) > 0.9\n),\nps AS (\n    SELECT\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    ps.probability AS prob_stamp_bogus,\n    plct.probability AS prob_lc_transient\nFROM object o\nINNER JOIN ps ON ps.oid = o.oid\nINNER JOIN plct ON plct.oid = o.oid\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3114, "completion_tokens": 2545, "total_tokens": 5659, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2845c1bc8190b0dd06100d12ce74", "custom_id": "58-5", "response": {"status_code": 200, "request_id": "bd7dc7da94e4da0ae60026276a0207c2", "body": {"id": "chatcmpl-CZaz0RKDAOcDLqjISqFHEUCOADNzE", "object": "chat.completion", "created": 1762599678, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get up to 20 ZTF objects with:\n-- - at least 30 detections (object.ndet >= 30)\n-- - time span between last and first detection > 20 days (object.deltajd > 20)\n-- - difference between minimum corrected magnitudes in g and r bands > 3.5 (min_g - min_r > 3.5)\nWITH objs AS (\n    SELECT *\n    FROM object\n    WHERE ndet >= 30\n      AND deltajd > 20\n),\nband_mins AS (\n    SELECT\n        d.oid,\n        MIN(CASE WHEN d.fid = 1 AND d.magpsf_corr IS NOT NULL THEN d.magpsf_corr END) AS min_g, -- g band\n        MIN(CASE WHEN d.fid = 2 AND d.magpsf_corr IS NOT NULL THEN d.magpsf_corr END) AS min_r  -- r band\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM objs)\n    GROUP BY d.oid\n),\nfiltered AS (\n    SELECT bm.oid\n    FROM band_mins bm\n    WHERE bm.min_g IS NOT NULL\n      AND bm.min_r IS NOT NULL\n      AND (bm.min_g - bm.min_r) > 3.5\n)\nSELECT o.*\nFROM objs o\nINNER JOIN filtered f ON f.oid = o.oid\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3129, "completion_tokens": 1460, "total_tokens": 4589, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2845d4748190a0823d7503814925", "custom_id": "58-6", "response": {"status_code": 200, "request_id": "c6b9107aead2cd8edab2cb3aed453440", "body": {"id": "chatcmpl-CZawcMS5WIf4DqjdH557oHM3Cw2yF", "object": "chat.completion", "created": 1762599530, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get up to 20 ZTF objects with:\n-- - at least 30 detections (ndet >= 30)\n-- - absolute difference between minimum g- and r-band corrected magnitudes > 3.5 (|g_r_max_corr| > 3.5)\n-- - time between last and first detection > 20 days (deltajd > 20)\nSELECT\n    *\nFROM\n    object\nWHERE\n    ndet >= 30\n    AND ABS(g_r_max_corr) > 3.5\n    AND deltajd > 20\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3037, "completion_tokens": 969, "total_tokens": 4006, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2845f4ec81908252bf2f17a6e9f1", "custom_id": "58-7", "response": {"status_code": 200, "request_id": "9ff4a20eda6e570ad461af144df66b54", "body": {"id": "chatcmpl-CZawuFDZ4uIoYXSFyGcLEW3ktHaNp", "object": "chat.completion", "created": 1762599548, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get up to 20 objects with:\n-- - at least 30 detections (object.ndet >= 30)\n-- - time span between first and last detection > 20 days (object.deltajd > 20)\n-- - absolute difference between minimum corrected g and r magnitudes > 3.5\n--   g band fid=1, r band fid=2; use detection.magpsf_corr with corrected=TRUE\nSELECT\n  o.*\nFROM object AS o\nINNER JOIN (\n  SELECT\n    d.oid,\n    MIN(CASE WHEN d.fid = 1 AND d.corrected = TRUE THEN d.magpsf_corr END) AS min_g_corr,\n    MIN(CASE WHEN d.fid = 2 AND d.corrected = TRUE THEN d.magpsf_corr END) AS min_r_corr\n  FROM detection AS d\n  GROUP BY d.oid\n  HAVING\n    MIN(CASE WHEN d.fid = 1 AND d.corrected = TRUE THEN d.magpsf_corr END) IS NOT NULL\n    AND MIN(CASE WHEN d.fid = 2 AND d.corrected = TRUE THEN d.magpsf_corr END) IS NOT NULL\n) AS agg\n  ON o.oid = agg.oid\nWHERE\n  o.ndet >= 30\n  AND o.deltajd > 20\n  AND ABS(agg.min_g_corr - agg.min_r_corr) > 3.5\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3161, "completion_tokens": 1216, "total_tokens": 4377, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f2845f3008190bf2e37a7c329ee2a", "custom_id": "58-8", "response": {"status_code": 200, "request_id": "bcd8775f451b9107081e2192c7213a4e", "body": {"id": "chatcmpl-CZayLKo9bcyjgg8LmJf1KGilE27Vo", "object": "chat.completion", "created": 1762599637, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get up to 20 ZTF objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - Absolute difference between minimum corrected g- and r-band magnitudes > 3.5\n-- Uses conditional aggregation on detection to compute per-band minima for corrected magnitudes\nWITH candidate_objects AS (\n    SELECT *\n    FROM object o\n    WHERE o.ndet >= 30\n      AND o.deltajd > 20\n),\nband_minima AS (\n    SELECT\n        d.oid,\n        MIN(CASE WHEN d.fid = 1 AND d.corrected = true THEN d.magpsf_corr END) AS min_g,\n        MIN(CASE WHEN d.fid = 2 AND d.corrected = true THEN d.magpsf_corr END) AS min_r\n    FROM detection d\n    INNER JOIN candidate_objects co ON co.oid = d.oid\n    GROUP BY d.oid\n)\nSELECT co.*\nFROM candidate_objects co\nINNER JOIN band_minima bm ON bm.oid = co.oid\nWHERE bm.min_g IS NOT NULL\n  AND bm.min_r IS NOT NULL\n  AND ABS(bm.min_g - bm.min_r) > 3.5\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3224, "completion_tokens": 2065, "total_tokens": 5289, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28460f8c819082e7e9af3f5ccb15", "custom_id": "39-5", "response": {"status_code": 200, "request_id": "6c04a861c2df217892a79f22f4dba7cd", "body": {"id": "chatcmpl-CZaxHIUbe1FHTsPpvjYSsAIxtPNa9", "object": "chat.completion", "created": 1762599571, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* CV/Nova objects (highest-probability class from the stochastic light curve classifier),\n   with at most 50 detections, and their r-band detections with corrected magnitudes.\n   Also computes the maximum rise from minimum (amplitude) in magpsf_corr per object (r-band only). */\nWITH cvnova_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    INNER JOIN object o ON o.oid = p.oid\n    WHERE p.classifier_name = 'lc_classifier_stochastic'  -- user requested stochastic LC classifier\n      AND p.ranking = 1                                    -- highest-probability class\n      AND p.class_name = 'CV/Nova'\n      AND o.ndet <= 50                                     -- at most 50 detections\n)\nSELECT\n    d.oid,                 -- object identifier\n    d.candid,              -- candidate identifier\n    d.fid AS f_id,         -- filter id (aliased as requested)\n    d.ra,                  -- coordinates: RA\n    d.dec,                 -- coordinates: Dec\n    d.magpsf,              -- magnitude (difference PSF)\n    d.sigmapsf,            -- magnitude error (difference PSF)\n    d.magpsf_corr,         -- corrected difference magnitude (PSF corrected magnitude in r-band)\n    d.sigmapsf_corr,       -- corrected magnitude error\n    -- maximum rise from minimum (amplitude) in corrected PSF magnitude within r-band per object\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid)\n     - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_corr\nFROM detection d\nINNER JOIN cvnova_oids co ON co.oid = d.oid\nWHERE d.fid = 2  -- r-band\nORDER BY d.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3092, "completion_tokens": 3542, "total_tokens": 6634, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3136, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f28460f488190858ad2f8402228da", "custom_id": "39-6", "response": {"status_code": 200, "request_id": "b9c56b77606f52271c26161ee95a2a67", "body": {"id": "chatcmpl-CZaxcctA0Nw85WUv8jd6waMzPQq3m", "object": "chat.completion", "created": 1762599592, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3092, "completion_tokens": 4000, "total_tokens": 7092, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284655dc81909ce4c1edd5ad7fbb", "custom_id": "39-7", "response": {"status_code": 200, "request_id": "e52f115cca780d3aab59aa7dbd4d2c1c", "body": {"id": "chatcmpl-CZaxsFAZmVTdY8FJnhuGIxdXhixHQ", "object": "chat.completion", "created": 1762599608, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* CV/Nova objects by the stochastic light curve classifier (top-ranked), with <= 50 detections.\n   Return r-band detections with corrected PSF magnitude and its error, plus rise-from-min stats.\n*/\nWITH cvnova AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n),\nsel_obj AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN cvnova c ON c.oid = o.oid\n    WHERE o.ndet <= 50\n),\nr_dets AS (\n    SELECT d.oid,\n           d.candid,\n           d.fid,\n           d.ra,\n           d.dec,\n           d.magpsf_corr,\n           d.sigmapsf_corr,\n           d.mjd\n    FROM detection d\n    INNER JOIN sel_obj so ON so.oid = d.oid\n    WHERE d.fid = 2\n      AND d.magpsf_corr IS NOT NULL\n)\nSELECT\n    r.oid,\n    r.candid,\n    r.fid AS f_id,\n    r.ra,\n    r.dec,\n    r.magpsf_corr,\n    r.sigmapsf_corr,\n    (r.magpsf_corr - MIN(r.magpsf_corr) OVER (PARTITION BY r.oid)) AS rise_from_min,\n    (MAX(r.magpsf_corr) OVER (PARTITION BY r.oid) - MIN(r.magpsf_corr) OVER (PARTITION BY r.oid)) AS max_rise_from_min\nFROM r_dets r\nORDER BY r.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3092, "completion_tokens": 3950, "total_tokens": 7042, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3584, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284630dc81909e2bc9a095981512", "custom_id": "39-8", "response": {"status_code": 200, "request_id": "b30287a01ec6b8954e2717e76dfddfd1", "body": {"id": "chatcmpl-CZaySxosqQ7kVsH4ByOUkSiOj1nEY", "object": "chat.completion", "created": 1762599644, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* CV/Nova objects (highest-probability in the stochastic LC classifier), with <= 50 detections.\n   Return r-band detections only, including corrected PSF magnitudes and rise metrics. */\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p\n        ON p.oid = o.oid\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n      AND o.ndet <= 50\n),\nr_detections AS (\n    SELECT d.*\n    FROM detection d\n    INNER JOIN selected_objects so\n        ON so.oid = d.oid\n    WHERE d.fid = 2  -- r-band only\n)\nSELECT\n    rd.oid,                              -- object identifier\n    rd.candid,                           -- candidate identifier\n    rd.fid AS f_id,                      -- filter id (r-band = 2)\n    rd.ra,                               -- right ascension (per detection)\n    rd.dec,                              -- declination (per detection)\n    rd.magpsf,                           -- magnitude (PSF difference magnitude)\n    rd.sigmapsf,                         -- magnitude error\n    rd.magpsf_corr,                      -- corrected difference magnitude in r-band (PSF corrected magnitude)\n    rd.sigmapsf_corr,                    -- error of PSF corrected magnitude in r-band\n    MIN(rd.magpsf_corr) OVER (PARTITION BY rd.oid) AS min_r_magpsf_corr,  -- per-object minimum corrected magnitude (r)\n    rd.magpsf_corr - MIN(rd.magpsf_corr) OVER (PARTITION BY rd.oid) AS rise_from_min_r, -- per-detection rise from object minimum (r)\n    MAX(rd.magpsf_corr) OVER (PARTITION BY rd.oid) - MIN(rd.magpsf_corr) OVER (PARTITION BY rd.oid) AS max_rise_from_min_r -- per-object max rise (r)\nFROM r_detections rd\nORDER BY rd.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3092, "completion_tokens": 3907, "total_tokens": 6999, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3456, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690f284639c48190bf7b86029daef383", "custom_id": "39-9", "response": {"status_code": 200, "request_id": "9b41309825897caad297b5c40486f32c", "body": {"id": "chatcmpl-CZayyLSZA9gyyvqrzBXe3AHqGj3kR", "object": "chat.completion", "created": 1762599676, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- CV/Nova objects (highest-probability class) from the stochastic light curve classifier,\n-- with at most 50 detections, r-band (fid=2) corrected detections only.\n-- Return object identifier, candidate identifier, filter id as f_id, coordinates,\n-- magnitudes and magnitude errors, plus rise-from-min and max-rise-from-min (magpsf_corr, r-band).\nSELECT\n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    -- Rise from the minimum corrected PSF magnitude (r-band) for this object\n    d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS rise_from_min_magpsf_corr,\n    -- Maximum rise from minimum (amplitude) across all r-band corrected detections for this object\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_magpsf_corr\nFROM detection d\nINNER JOIN object o\n    ON o.oid = d.oid\nINNER JOIN probability p\n    ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'lc_classifier_stochastic'  -- stochastic light curve classifier\n    AND p.ranking = 1                               -- highest probability class\n    AND p.class_name = 'CV/Nova'                    -- desired class\n    AND o.ndet <= 50                                -- at most 50 detections from discovery to last detection\n    AND d.fid = 2                                   -- r-band detections\n    AND d.corrected = TRUE                          -- use corrected detections (for magpsf_corr)\nORDER BY o.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3092, "completion_tokens": 3682, "total_tokens": 6774, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
