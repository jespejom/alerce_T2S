{"id": "batch_req_68f70f5805dc819081317fd92032a6c0", "custom_id": "8-2", "response": {"status_code": 200, "request_id": "ddcb00428bfe30adb9ceab6990630250", "body": {"id": "chatcmpl-CSyK3L6mVMswA4zYR0M5qnTPz2hr7", "object": "chat.completion", "created": 1761021099, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects first detected between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0)\n-- and classified as 'SN' by the stamp classifier (ranking=1),\n-- with either probability > 0.5 OR at least 2 detections.\nSELECT\n    o.*,\n    p.*\nFROM object o\nINNER JOIN probability p\n    ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND (p.probability > 0.5 OR o.ndet >= 2);\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3037, "completion_tokens": 1845, "total_tokens": 4882, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1664, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5813008190b9ecc159b023774c", "custom_id": "8-3", "response": {"status_code": 200, "request_id": "dfb7e25fe97d7ed5b7e11f93b4b73ca2", "body": {"id": "chatcmpl-CSyKN5UdRNN1nBRTOBFRFUGnT9WMW", "object": "chat.completion", "created": 1761021119, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects whose first detection (proxy for \"first classified by stamp\") is between 2023-08-17 and 2023-08-21 (MJD 60173.0\u201360177.0, inclusive)\n-- Keep only 'SN' from the 'stamp_classifier' with top rank, and require probability > 0.5 OR at least two detections\nSELECT\n    p.*,\n    o.*\nFROM probability AS p\nINNER JOIN object AS o ON o.oid = p.oid\nWHERE\n    p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND (p.probability > 0.5 OR o.ndet >= 2)\nORDER BY o.firstmjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3043, "completion_tokens": 2884, "total_tokens": 5927, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2688, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5800e88190a64fedabd48c546c", "custom_id": "27-3", "response": {"status_code": 200, "request_id": "c4b719fb0fe12ee756f56e167d56c41d", "body": {"id": "chatcmpl-CSyL4Gf76VwaIxtU9mLUFjQunlQbo", "object": "chat.completion", "created": 1761021162, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects whose top-ranked lc_classifier class is 'CEP' with probability > 0.76\n-- Return all lc_classifier classes (same classifier_version) for those objects\n-- Restrict to objects with ndet >= 100 and return requested columns\nWITH pr_top AS (\n    SELECT\n        p.oid,\n        p.classifier_name,\n        p.classifier_version,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name = 'CEP'\n      AND p.probability > 0.76\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_max,\n    pr_all.classifier_name,\n    pr_all.class_name,\n    pr_all.ranking,\n    pr_all.probability\nFROM pr_top\nINNER JOIN object o\n    ON o.oid = pr_top.oid\nINNER JOIN probability pr_all\n    ON pr_all.oid = pr_top.oid\n   AND pr_all.classifier_name = pr_top.classifier_name\n   AND pr_all.classifier_version = pr_top.classifier_version\nWHERE o.ndet >= 100\nORDER BY o.oid, pr_all.ranking;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 1447, "total_tokens": 4480, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5808c481908dab28b1d241a992", "custom_id": "17-2", "response": {"status_code": 200, "request_id": "9ce29502b0a5a9b8d636c8d8a5480039", "body": {"id": "chatcmpl-CSyLPy8A3WTGr8fF98Ol6d8Trl0AE", "object": "chat.completion", "created": 1761021183, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 4000, "total_tokens": 7016, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5807d48190a2f20f2e93a088a4", "custom_id": "17-3", "response": {"status_code": 200, "request_id": "08fe938137744428d36c6db5a67b95e5", "body": {"id": "chatcmpl-CSyM6kik7PgabFJ4hiWHx2WGQnJN3", "object": "chat.completion", "created": 1761021226, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 4000, "total_tokens": 7016, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f57ff608190a613ba6a9883c9de", "custom_id": "17-4", "response": {"status_code": 200, "request_id": "a8f4cb5a406557a4aeeaba8aa6a9ad1d", "body": {"id": "chatcmpl-CSyMsCnll2w3lm9LOeUnc6Z5pBw5R", "object": "chat.completion", "created": 1761021274, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects classified as AGN (lc_classifier, ranking=1)\n-- Show variability in r band (fid=2) measured by amplitude > 0\n-- Have no detections in g band (fid=1) OR show no variability in g (amplitude = 0)\n-- Order results by the variability feature (r_amp) ascending, then by oid\n\nWITH r AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS r_cnt,\n        MIN(d.magpsf_corr) AS r_min_magpsf_corr,\n        MAX(d.magpsf_corr) AS r_max_magpsf_corr,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS r_amp,\n        stddev_samp(d.magpsf_corr) AS r_std\n    FROM detection d\n    WHERE d.fid = 2\n      AND d.magpsf_corr IS NOT NULL\n    GROUP BY d.oid\n),\ng AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS g_cnt,\n        MIN(d.magpsf_corr) AS g_min_magpsf_corr,\n        MAX(d.magpsf_corr) AS g_max_magpsf_corr,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS g_amp,\n        stddev_samp(d.magpsf_corr) AS g_std\n    FROM detection d\n    WHERE d.fid = 1\n      AND d.magpsf_corr IS NOT NULL\n    GROUP BY d.oid\n)\nSELECT\n    o.*,\n    p.*,\n    r.*,\n    g.*\nFROM probability p\nINNER JOIN object o USING (oid)\nINNER JOIN r ON r.oid = o.oid\nLEFT JOIN g ON g.oid = o.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'AGN'\n  AND r.r_amp > 0\n  AND (\n        COALESCE(g.g_cnt, 0) = 0\n        OR COALESCE(g.g_amp, 0) = 0\n      )\nORDER BY r.r_amp ASC, o.oid ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 2959, "total_tokens": 5975, "prompt_tokens_details": {"cached_tokens": 1280, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f57feac81908147f2aaf775000f", "custom_id": "34-4", "response": {"status_code": 200, "request_id": "336d10b80de96fd95688baa9d868dec5", "body": {"id": "chatcmpl-CSyNR5gKslQ4SO5Nx8q69GRXxJ4Yq", "object": "chat.completion", "created": 1761021309, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* Returns the requested features for the given list of oids.\n   - \"Amplitude\" is computed as (max - min) of magpsf_corr across all detections for each oid.\n   - \"Multiband_period\" is not available in the provided schema; returned as NULL.\n*/\nWITH input_oids (oid) AS (\n    VALUES \n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n),\ndet AS (\n    SELECT d.oid, d.magpsf_corr\n    FROM detection d\n    INNER JOIN input_oids i USING (oid)\n    WHERE d.magpsf_corr IS NOT NULL\n),\namplitude AS (\n    SELECT \n        oid, \n        (MAX(magpsf_corr) - MIN(magpsf_corr))::DOUBLE PRECISION AS \"Amplitude\"\n    FROM det\n    GROUP BY oid\n)\nSELECT \n    i.oid, \n    a.\"Amplitude\",\n    NULL::DOUBLE PRECISION AS \"Multiband_period\"\nFROM input_oids i\nLEFT JOIN amplitude a USING (oid)\nORDER BY i.oid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3091, "completion_tokens": 2875, "total_tokens": 5966, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f581c288190ad347c7bf7f56528", "custom_id": "1-2", "response": {"status_code": 200, "request_id": "9f7a3087f7b16b5ae082b2b0d8345ca2", "body": {"id": "chatcmpl-CSyNt7IKhuZFoeOYFpESJGcRXAP2n", "object": "chat.completion", "created": 1761021337, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3124, "completion_tokens": 4000, "total_tokens": 7124, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f58104081908c449ddb4cf327c8", "custom_id": "1-3", "response": {"status_code": 200, "request_id": "e0821aad546d865c66dfc5ae783bf768", "body": {"id": "chatcmpl-CSyOkiGHqKh9mNxPrYTEMrtkk8omb", "object": "chat.completion", "created": 1761021390, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3124, "completion_tokens": 4000, "total_tokens": 7124, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f57ff588190b3dd77343eaefd95", "custom_id": "1-4", "response": {"status_code": 200, "request_id": "db7c6b88a54e98b80ff8c355068f06dc", "body": {"id": "chatcmpl-CSyPR0IlIP44VSlAErHWN4oYFYXgs", "object": "chat.completion", "created": 1761021433, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3124, "completion_tokens": 4000, "total_tokens": 7124, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f58ca1c819083685d88408ad0a4", "custom_id": "16-2", "response": {"status_code": 200, "request_id": "bbdcf83392898b2432214216637457f7", "body": {"id": "chatcmpl-CSyQ7enXdBUkn1A75vj92mN6o960H", "object": "chat.completion", "created": 1761021475, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3159, "completion_tokens": 4000, "total_tokens": 7159, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f58de5c8190aa152e78d3c8863d", "custom_id": "16-3", "response": {"status_code": 200, "request_id": "b02c01a5bbd0302645d61a891f697517", "body": {"id": "chatcmpl-CSyQgJFiAQ0Fawdfw1d85eRwRgdjj", "object": "chat.completion", "created": 1761021510, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3159, "completion_tokens": 4000, "total_tokens": 7159, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5abd4081908a26aff3aafeff0f", "custom_id": "16-4", "response": {"status_code": 200, "request_id": "62d249281d5f30a101b9b65e6b733d18", "body": {"id": "chatcmpl-CSyREjPdwelfta8jLEQsR5cy4fpn5", "object": "chat.completion", "created": 1761021544, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3159, "completion_tokens": 4000, "total_tokens": 7159, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f58cdf08190b53164a9964faa45", "custom_id": "14-2", "response": {"status_code": 200, "request_id": "00e32a5fb66cab89f0d3f9daaab8b530", "body": {"id": "chatcmpl-CSyRrBb4MujTqq8maoPmgxh6lBbY6", "object": "chat.completion", "created": 1761021583, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* Return detections for the given OIDs with DRB > 0.5 and (sgscore1 < 0.5 OR distpsnr1 < 1\") */\nWITH oids(oid) AS (\n  VALUES\n    ('ZTF23aavzgjg'),\n    ('ZTF23aaynzyk'),\n    ('ZTF23aavqxos'),\n    ('ZTF23aaknyni'),\n    ('ZTF23aavsdtc'),\n    ('ZTF18aandkua'),\n    ('ZTF23aaxfewt'),\n    ('ZTF23aavshwi'),\n    ('ZTF22aawasao'),\n    ('ZTF23aaxgvnt')\n)\nSELECT\n  d.oid,\n  d.candid,\n  d.fid,        -- 1=g; 2=r; 3=i\n  d.mjd,\n  d.magpsf,\n  d.sigmapsf,\n  d.has_stamp,\n  d.drb,\n  p.sgscore1,\n  p.distpsnr1\nFROM oids\nINNER JOIN detection AS d\n  ON d.oid = oids.oid\nINNER JOIN ps1_ztf AS p\n  ON p.oid = d.oid\n AND p.candid = d.candid\nWHERE d.drb > 0.5\n  AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\nORDER BY d.oid, d.mjd;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3195, "completion_tokens": 2114, "total_tokens": 5309, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f58eca081908bdc3347617596c2", "custom_id": "14-3", "response": {"status_code": 200, "request_id": "3ee95927f737167c45a1a6629c8a035e", "body": {"id": "chatcmpl-CSySAol7ewJvAqPnD9ACu0kcFc1uf", "object": "chat.completion", "created": 1761021602, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* \nReturn per-detection rows for the given oids, joined with PS1 nearest-source info.\nScience cuts: drb > 0.5 AND (sgscore1 < 0.5 OR distpsnr1 < 1)\nOnly filter detection by oid in the initial step for performance.\n*/\nWITH filtered_detections AS (\n  SELECT\n    oid,\n    candid,\n    fid,\n    mjd,\n    magpsf,\n    sigmapsf,\n    has_stamp,\n    drb\n  FROM detection\n  WHERE oid IN (\n    'ZTF23aavzgjg',\n    'ZTF23aaynzyk',\n    'ZTF23aavqxos',\n    'ZTF23aaknyni',\n    'ZTF23aavsdtc',\n    'ZTF18aandkua',\n    'ZTF23aaxfewt',\n    'ZTF23aavshwi',\n    'ZTF22aawasao',\n    'ZTF23aaxgvnt'\n  )\n)\nSELECT\n  d.oid,\n  d.candid,\n  d.fid,\n  d.mjd,\n  d.magpsf,\n  d.sigmapsf,\n  d.has_stamp,\n  d.drb,\n  p.sgscore1,\n  p.distpsnr1\nFROM filtered_detections d\nINNER JOIN ps1_ztf p\n  ON p.oid = d.oid\n AND p.candid = d.candid\nWHERE d.drb > 0.5\n  AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3345, "completion_tokens": 1182, "total_tokens": 4527, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f590938819095dc292e0c667ef4", "custom_id": "14-4", "response": {"status_code": 200, "request_id": "7fe531b1ac0804a344a09c185fececd2", "body": {"id": "chatcmpl-CSySPtVEJfNjOypOk8XzSN4uI4exC", "object": "chat.completion", "created": 1761021617, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* For the given list of oids, return selected detection-level fields with filters:\n   - drb > 0.5\n   - AND distance to nearest reference source < 1 arcsec (using distnr as proxy)\n   NOTE: The provided schema does not include Pan-STARRS-specific distance (e.g., distpsnr1)\n         nor star-galaxy score (e.g., sgscore1). Therefore, we return distnr and cannot\n         return a star-galaxy score column or filter on it.\n*/\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,               -- unique object identifier\n    d.candid,            -- candidate identifier\n    d.fid,               -- filter identifier\n    d.mjd,               -- modified julian date\n    d.magpsf,            -- magnitude (PSF difference magnitude)\n    d.sigmapsf,          -- magnitude error\n    d.has_stamp,         -- whether the object has stamps\n    d.drb,               -- deep learning real bogus score\n    d.distnr             -- distance to the nearest source in the reference image (used as proxy for Pan-STARRS)\nFROM detection d\nINNER JOIN oids o USING (oid)\nWHERE\n    d.drb > 0.5\n    AND d.distnr < 1  -- assuming units are arcseconds\n;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3170, "completion_tokens": 3788, "total_tokens": 6958, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3392, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f58d9c081909ad0d2375cbc0550", "custom_id": "89-3", "response": {"status_code": 200, "request_id": "f1c74a88abb567ea7d76b8dfd0c99a40", "body": {"id": "chatcmpl-CSyT6zTovrMb5QctfGKCkoKSAFmQ4", "object": "chat.completion", "created": 1761021660, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find at most 50 ZTF objects with P(SN | stamp_classifier) > 0.7 (ranking = 1), then return all rows from dataquality for those objects\nWITH selected_oids AS (\n  SELECT\n    p.oid,\n    MAX(p.probability) AS maxprob\n  FROM probability p\n  WHERE\n    p.classifier_name = 'stamp_classifier' -- user-requested classifier\n    AND p.class_name = 'SN'                -- supernova class in the stamp classifier\n    AND p.ranking = 1                      -- default: keep the most likely class per classifier/version\n    AND p.probability > 0.7\n    AND p.oid LIKE 'ZTF%'                  -- ensure ZTF objects\n  GROUP BY p.oid\n  ORDER BY maxprob DESC\n  LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nINNER JOIN selected_oids so\n  ON dq.oid = so.oid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2788, "completion_tokens": 2263, "total_tokens": 5051, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f58f2888190a615a5faf95c50d4", "custom_id": "89-4", "response": {"status_code": 200, "request_id": "6a5b19961b2b15cb83efda1ca12ab4e6", "body": {"id": "chatcmpl-CSyTR1HfxRTqRqSAmtiHCSXkLuzcx", "object": "chat.completion", "created": 1761021681, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 50 ZTF objects with P(SN) > 0.7 under the stamp classifier (ranking=1),\n-- and return all per-detection columns for those objects.\n-- NOTE: The provided schema does not include a 'dataquality' table; using 'detection' instead.\n\nWITH filtered AS (\n    SELECT\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'  -- user-specified classifier\n        AND p.class_name = 'SN'                 -- supernovae class\n        AND p.ranking = 1                       -- default condition: most likely class\n        AND p.probability > 0.7\n        AND p.oid LIKE 'ZTF%'                   -- ensure ZTF objects\n),\ndedup AS (\n    -- Keep the highest probability per oid (in case multiple versions exist)\n    SELECT DISTINCT ON (oid)\n        oid,\n        probability\n    FROM filtered\n    ORDER BY oid, probability DESC\n),\ntop50 AS (\n    -- Select at most 50 objects by highest probability\n    SELECT\n        oid\n    FROM dedup\n    ORDER BY probability DESC, oid\n    LIMIT 50\n)\nSELECT\n    d.*  -- return all columns from the detection table for the selected objects\nFROM detection d\nINNER JOIN top50 t\n    ON t.oid = d.oid\nORDER BY d.oid, d.mjd, d.candid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2910, "completion_tokens": 2177, "total_tokens": 5087, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1856, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f58ee7c8190b269e0f815c9125d", "custom_id": "103-2", "response": {"status_code": 200, "request_id": "f3845cada28139750bf43e6f0f25eae3", "body": {"id": "chatcmpl-CSyTn05AWK3CXy25fhKWaqU5btfl0", "object": "chat.completion", "created": 1761021703, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 200 ZTF objects whose nearest PS1 source distance > 5 arcsec\n-- and whose top-1 lc_classifier class is non-SN with probability > 0.7.\n-- Return all columns from object, probability, and a derived ps1_ztf table\n-- (computed from detection.distnr as the nearest PS1 distance per object).\n\nWITH ps1_ztf AS (\n    SELECT\n        d.oid,\n        MIN(d.distnr) AS nearest_ps1_dist\n    FROM detection d\n    WHERE d.distnr IS NOT NULL\n    GROUP BY d.oid\n)\nSELECT\n    o.*,\n    p.*,\n    pz.*\nFROM ps1_ztf pz\nINNER JOIN object o\n    ON o.oid = pz.oid\nINNER JOIN probability p\n    ON p.oid = o.oid\nWHERE\n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND p.probability > 0.7\n    AND pz.nearest_ps1_dist > 5.0\nORDER BY\n    pz.nearest_ps1_dist ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3062, "completion_tokens": 3549, "total_tokens": 6611, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f58f3dc81908620aed9e0fa622a", "custom_id": "103-3", "response": {"status_code": 200, "request_id": "fef191b3dea104b5a828315671744da9", "body": {"id": "chatcmpl-CSyUOHIDhg3F2DacoWKt6nuJCkVCE", "object": "chat.completion", "created": 1761021740, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 200 ZTF objects with nearest PS1 source farther than 5 arcsec\n-- and with lc_classifier non-SN class probability > 0.7 (using rank-1 classes).\nSELECT\n  o.*,\n  p.*,\n  x.*\nFROM object AS o\nINNER JOIN probability AS p\n  ON p.oid = o.oid\nINNER JOIN ps1_ztf AS x\n  ON x.oid = o.oid\nWHERE\n  p.classifier_name = 'lc_classifier'       -- light curve classifier\n  AND p.ranking = 1                          -- most likely class\n  AND p.class_name NOT IN ('SNIa','SNIbc','SNII','SLSN')  -- exclude supernova classes\n  AND p.probability > 0.7\n  -- q3c_dist returns degrees; 5 arcsec = 5/3600 degrees\n  AND q3c_dist(o.meanra, o.meandec, x.ra, x.dec) > (5.0 / 3600.0)\nORDER BY\n  q3c_dist(o.meanra, o.meandec, x.ra, x.dec) ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3062, "completion_tokens": 2379, "total_tokens": 5441, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2112, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f59aacc819086ffe3c2cd942af8", "custom_id": "103-4", "response": {"status_code": 200, "request_id": "c5c156244ec33e0d0652118f77f1b6dc", "body": {"id": "chatcmpl-CSyK6GoJHxyZuhfF3Qe4UHA7cnIBL", "object": "chat.completion", "created": 1761021102, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 200 ZTF objects whose nearest PS1 counterpart is farther than 5 arcsec,\n-- and whose most likely lc_classifier class (ranking=1) is non-supernova with probability > 0.7.\n-- Return all columns from object, probability, and ps1_ztf, ordered by PS1 nearest distance.\nSELECT\n    o.*,\n    pr.*,\n    p.*\nFROM object AS o\nINNER JOIN probability AS pr\n    ON pr.oid = o.oid\n    AND pr.ranking = 1  -- default condition: most likely class\n    AND pr.classifier_name = 'lc_classifier'  -- default condition: light curve classifier\n    AND pr.probability > 0.7\n    AND pr.class_name NOT IN ('SNIa','SNIbc','SNII','SLSN')  -- exclude supernova classes\nINNER JOIN ps1_ztf AS p\n    ON p.oid = o.oid\nWHERE\n    -- 5 arcsec = 5/3600 degrees; use Q3C to compute the angular separation to the PS1 match\n    q3c_dist(o.meanra, o.meandec, p.ra, p.dec) > (5.0/3600.0)\nORDER BY\n    q3c_dist(o.meanra, o.meandec, p.ra, p.dec) ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3062, "completion_tokens": 2355, "total_tokens": 5417, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f59a1f081909ba5e3acf878c602", "custom_id": "99-2", "response": {"status_code": 200, "request_id": "06c63a68fda23d0ca54aa6fa87ad402c", "body": {"id": "chatcmpl-CSyKUjKPnQhb5rpMGrlVCGAhFifvD", "object": "chat.completion", "created": 1761021126, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 10 objects with first detection after MJD 60310\n-- and with probability 1 of being 'asteroid' in the 'stamp_classifier',\n-- then return all forced photometry rows for those objects.\nWITH top_objects AS (\n  SELECT o.oid, o.firstmjd\n  FROM object o\n  WHERE o.firstmjd > 60310\n    AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n        AND p.ranking = 1\n    )\n  ORDER BY o.firstmjd ASC\n  LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nINNER JOIN top_objects t ON t.oid = fp.oid\nORDER BY t.firstmjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 2701, "total_tokens": 5734, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f59b39c8190b30296ea97f14ebb", "custom_id": "99-3", "response": {"status_code": 200, "request_id": "55452b1596ca98abc6355174292db6d3", "body": {"id": "chatcmpl-CSyL9hLVhxnsoH6UQbh06YGVtH2s3", "object": "chat.completion", "created": 1761021167, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all forced photometry rows for up to 10 objects with first detection after MJD 60310\n-- and stamp classifier probability 1 for class 'asteroid', ordered by first detection date.\nWITH selected_oids AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n          SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n            AND p.ranking = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nINNER JOIN selected_oids s ON s.oid = fp.oid\nORDER BY s.firstmjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 2186, "total_tokens": 5219, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1984, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f59bb6c8190b526133f1742a9e7", "custom_id": "99-4", "response": {"status_code": 200, "request_id": "47d688e0dbe09e6c0238e6cb5539c223", "body": {"id": "chatcmpl-CSyLWTkttlO3cHxb7SukvuzYNPZh0", "object": "chat.completion", "created": 1761021190, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 10 objects with first detection later than MJD 60310\n-- and with probability 1 of being 'asteroid' according to the stamp classifier.\n-- Then return all forced photometry rows for those objects, ordered by first detection date.\nWITH selected_oids AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM object o\n    INNER JOIN probability p\n        ON p.oid = o.oid\n    WHERE\n        o.firstmjd > 60310\n        AND p.classifier_name = 'stamp_classifier'  -- use the stamp-based classifier\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n        AND p.ranking = 1  -- keep only the top-ranked class\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT\n    fp.*\nFROM forced_photometry fp\nINNER JOIN selected_oids so\n    ON so.oid = fp.oid\nORDER BY so.firstmjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 2533, "total_tokens": 5566, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f59c6b08190a37cafa496864dd1", "custom_id": "92-3", "response": {"status_code": 200, "request_id": "33e36b25517141b011177430858ca95f", "body": {"id": "chatcmpl-CSyLx6dr0CkKNmCKOq5gZDkWdbIFj", "object": "chat.completion", "created": 1761021217, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 500 ZTF objects with at least 10 good (corrected, non-dubious) g-band detections\n-- and no dubious detections in g, returning lc_classifier rank-1 probabilities\nSELECT\n  p.oid,\n  p.classifier_version,\n  p.class_name,\n  p.probability\nFROM probability p\nINNER JOIN (\n  SELECT d.oid\n  FROM detection d\n  WHERE d.fid = 1 -- g band\n  GROUP BY d.oid\n  HAVING\n    COUNT(*) FILTER (WHERE d.corrected = TRUE AND d.dubious = FALSE) >= 10 -- minimum 10 good g detections\n    AND COUNT(*) FILTER (WHERE d.dubious = TRUE) = 0 -- no dubious in g band\n) g ON g.oid = p.oid\nWHERE\n  p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nORDER BY p.oid ASC\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2891, "completion_tokens": 1566, "total_tokens": 4457, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f59bbf88190a5a459b27929adda", "custom_id": "102-2", "response": {"status_code": 200, "request_id": "cc2a96fdb144ddd0594123a7fffafac7", "body": {"id": "chatcmpl-CSyMMPLuoRhVuWT0dEi2dAUxaT0RP", "object": "chat.completion", "created": 1761021242, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 50 oids with lc_classifier rank-1 AGN probability > 0.6 and WISE W1 in [12,13],\n-- then return all columns from the magstats table for those oids.\n-- Note: Assuming the table with per-object magnitude statistics is named 'magstats' (plural).\n--       If your schema uses 'magstat' (singular), replace 'magstats' accordingly.\n-- Note: Assuming AllWISE crossmatch table is 'xmatch_allwise' with W1 magnitude column 'w1mpro'.\nWITH selected AS (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN xmatch_allwise w ON w.oid = p.oid\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND w.w1mpro BETWEEN 12 AND 13\n    ORDER BY p.probability DESC\n    LIMIT 50\n)\nSELECT m.*\nFROM magstats m\nINNER JOIN selected s ON s.oid = m.oid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3032, "completion_tokens": 3132, "total_tokens": 6164, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2880, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5a04f481908268bc68b6208c28", "custom_id": "102-3", "response": {"status_code": 200, "request_id": "9d39defc5f54049049d0ad38cc4d88dc", "body": {"id": "chatcmpl-CSyN0XkvmdHwZwCAoZWlVwAyfR4b2", "object": "chat.completion", "created": 1761021282, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Returns up to 50 objects with lc_classifier rank-1 AGN probability > 0.6\n-- and WISE W1 magnitude between 12 and 13.\n-- NOTE: Adjust m.w1 to the correct W1 magnitude column name if different (e.g., w1mpro).\nSELECT\n    m.*\nFROM\n    magstat AS m\nINNER JOIN\n    probability AS p\n    ON p.oid = m.oid\nWHERE\n    p.classifier_name = 'lc_classifier'   -- default classifier\n    AND p.ranking = 1                      -- only the most likely class\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND m.w1 BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3032, "completion_tokens": 1968, "total_tokens": 5000, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f59e84c8190b629a1d6d0e990fb", "custom_id": "102-4", "response": {"status_code": 200, "request_id": "dcccf002caa068cd1da15ecb388f89df", "body": {"id": "chatcmpl-CSyNJj9bLZi6zgYvUNQARyTNydmwA", "object": "chat.completion", "created": 1761021301, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 50 objects with rank-1 AGN classification by the lc_classifier,\n-- probability > 0.6, and WISE W1 magnitude between 12 and 13.\n-- Assumes a table named 'magstats' with columns 'oid' and 'w1'.\nSELECT DISTINCT ms.*\nFROM magstats AS ms\nINNER JOIN probability AS p\n  ON p.oid = ms.oid\nWHERE p.classifier_name = 'lc_classifier'  -- default classifier as requested\n  AND p.ranking = 1                        -- use only top-ranked class per object\n  AND p.class_name = 'AGN'                 -- AGN class\n  AND p.probability > 0.6                  -- probability threshold\n  AND ms.w1 BETWEEN 12 AND 13              -- WISE W1 magnitude constraint\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3032, "completion_tokens": 2685, "total_tokens": 5717, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f59f86481908cf4cbf627dd954a", "custom_id": "104-2", "response": {"status_code": 200, "request_id": "0ff0474ad53f47c0df53787b2f33160c", "body": {"id": "chatcmpl-CSyNtSbwJEiZzI04svncK19xOQVy4", "object": "chat.completion", "created": 1761021337, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Top 30 ZTF objects with stamp classifier ('stamp_classifier_1.0.4') probability > 0.9 for class 'asteroid'\nWITH top_asteroids AS (\n    SELECT\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier' AND            -- use stamp classifier\n        p.classifier_version = 'stamp_classifier_1.0.4' AND   -- requested version\n        p.class_name = 'asteroid' AND                         -- asteroid class\n        p.ranking = 1 AND                                     -- top-ranked class\n        p.probability > 0.9                                   -- probability threshold\n    ORDER BY p.probability DESC\n    LIMIT 30                                                  -- at most 30 objects\n),\nlatest_det AS (\n    -- Pick one candidate (latest by mjd) per selected object to report candidate-level columns\n    SELECT DISTINCT ON (d.oid)\n        d.oid,\n        d.candid,\n        d.ssdistnr,     -- distance from the nearest Solar System object (arcsec)\n        d.ssmagnr,      -- MPC archive magnitude\n        d.ssnamenr,     -- MPC object name\n        d.fid,          -- filter identifier\n        d.fwhm,         -- FWHM from SExtractor\n        d.ncalib,       -- number of PS1 calibrators used\n        d.exptime       -- exposure time\n    FROM detection d\n    INNER JOIN top_asteroids ta ON ta.oid = d.oid\n    ORDER BY d.oid, d.mjd DESC\n)\nSELECT\n    ld.oid,         -- ZTF object identifier\n    ld.candid,      -- candidate identifier\n    ld.ssdistnr,    -- distance to nearest Solar System object\n    ld.ssmagnr,     -- MPC archive magnitude\n    ld.ssnamenr,    -- MPC object name\n    ld.fid,         -- filter identifier\n    ld.fwhm,        -- FWHM from SExtractor\n    ld.ncalib,      -- number of PS1 calibrators\n    ld.exptime      -- exposure time\nFROM latest_det ld\nORDER BY ld.oid;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 2719, "total_tokens": 5789, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5a6ed48190aaea7d02e4e20635", "custom_id": "104-3", "response": {"status_code": 200, "request_id": "26519e8e5e620ea23e01005609c45832", "body": {"id": "chatcmpl-CSyOTV8meKrvf397Agg7RgQykAG4I", "object": "chat.completion", "created": 1761021373, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 30 objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4'\n-- with probability > 0.9. Then list all their candidates (detections) with requested fields.\n-- NOTE: The ALeRCE detection schema provided here does not include Solar System matching\n-- (e.g., ssdistnr, ssmagnr, ssnamenr), FWHM, number of PS1 calibrators, or exposure time.\n-- These are returned as NULL placeholders with conventional aliases.\n\nWITH selected_oids AS (\n    SELECT\n        p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    d.oid,                      -- ZTF object identifier\n    d.candid,                   -- candidate identifier\n    NULL::double precision AS ssdistnr,  -- distance to nearest Solar System object (not available in this schema)\n    NULL::double precision AS ssmagnr,   -- MPC archive magnitude (not available in this schema)\n    NULL::text AS ssnamenr,               -- MPC object name (not available in this schema)\n    d.fid,                      -- filter identifier\n    NULL::double precision AS fwhm,       -- FWHM from SExtractor (not available in this schema)\n    NULL::integer AS nps1_calibrators,    -- number of PS1 calibrators used (not available in this schema)\n    NULL::double precision AS exptime     -- exposure time (not available in this schema)\nFROM selected_oids s\nINNER JOIN detection d\n    ON d.oid = s.oid\nORDER BY d.oid, d.mjd;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3874, "total_tokens": 6944, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3456, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5ab9cc81909e795091541cd5c4", "custom_id": "104-4", "response": {"status_code": 200, "request_id": "1d0b6d6e6542f250050892c405f45c78", "body": {"id": "chatcmpl-CSyPD0k0Rdk05hMus1GHQVBtQkqrV", "object": "chat.completion", "created": 1761021419, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 4000, "total_tokens": 7070, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5a90688190ab57e71696938f7f", "custom_id": "107-2", "response": {"status_code": 200, "request_id": "b478687f3101944101a560e99126137a", "body": {"id": "chatcmpl-CSyPp6hswVFISkEjmAsHXBI7Ubm4P", "object": "chat.completion", "created": 1761021457, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3086, "completion_tokens": 4000, "total_tokens": 7086, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5ab8008190a8c7e79a281dc1ee", "custom_id": "107-3", "response": {"status_code": 200, "request_id": "e4f1958d4c8363f76c791f8d603925e9", "body": {"id": "chatcmpl-CSyQQQpN9ceySZfKWZX2LVhXv4K4h", "object": "chat.completion", "created": 1761021494, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 10 ZTF objects with >500 detections, asteroid probability > 0.5\n-- in the stamp classifier version 'stamp_classifier_1.0.4', and with at least\n-- one detection having ssdistnr < 2 arcsec. Return one detection per object\n-- (the one with the smallest ssdistnr), ordered by the object's first detection date.\n-- Note: This query assumes detection.ssdistnr (arcsec) and detection.ssnamenr (MPC name)\n-- are available in the detection table, as in ZTF alert schemas.\n\nWITH base AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability\n    FROM object o\n    INNER JOIN probability p ON p.oid = o.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.5\n),\nper_oid AS (\n    SELECT DISTINCT ON (b.oid)\n        b.oid,\n        b.ndet,\n        b.firstmjd,\n        b.lastmjd,\n        b.probability,\n        d.candid,\n        d.ssdistnr,\n        d.ssnamenr,\n        d.mjd,\n        d.fid\n    FROM base b\n    INNER JOIN detection d ON d.oid = b.oid\n    WHERE d.ssdistnr < 2.0\n    ORDER BY b.oid, d.ssdistnr ASC, d.mjd ASC\n)\nSELECT\n    oid,\n    ndet,\n    firstmjd,\n    lastmjd,\n    probability,\n    candid,\n    ssdistnr,\n    ssnamenr,\n    mjd,\n    fid\nFROM per_oid\nORDER BY firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3086, "completion_tokens": 3506, "total_tokens": 6592, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3072, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5a98b48190ba030a71b2ed9a35", "custom_id": "107-4", "response": {"status_code": 200, "request_id": "1ea7b30fba13efb2901b4e41670d2e7a", "body": {"id": "chatcmpl-CSyQtw4ktPFTaa4rqYJvDZBBwnvM4", "object": "chat.completion", "created": 1761021523, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 10 ZTF objects with:\n--  - ndet > 500\n--  - stamp classifier ('stamp_classifier_1.0.4') probability > 0.5 for class 'asteroid' (ranking = 1)\n--  - at least one detection with ssdistnr < 2 arcsec (nearest Solar System object) and known ssnamenr\n-- Return the requested columns and order results by the object's first detection date (firstmjd)\nWITH best_det AS (\n    SELECT *\n    FROM (\n        SELECT\n            d.*,\n            row_number() OVER (PARTITION BY d.oid ORDER BY d.ssdistnr ASC, d.mjd ASC) AS rn\n        FROM detection d\n        WHERE d.ssdistnr IS NOT NULL\n          AND d.ssnamenr IS NOT NULL\n          AND d.ssdistnr < 2.0  -- arcseconds\n    ) t\n    WHERE t.rn = 1\n)\nSELECT\n    o.oid,                -- ZTF identifier\n    o.ndet,               -- number of detections\n    o.firstmjd,           -- first detection date\n    o.lastmjd,            -- last detection date\n    p.probability,        -- probability from stamp classifier\n    bd.candid,            -- candidate identifier\n    bd.ssdistnr,          -- distance to nearest Solar System object (arcsec)\n    bd.ssnamenr,          -- MPC name\n    bd.mjd,               -- detection date\n    bd.fid                -- filter identifier (1=g; 2=r; 3=i)\nFROM object o\nINNER JOIN probability p\n    ON p.oid = o.oid\nINNER JOIN best_det bd\n    ON bd.oid = o.oid\nWHERE o.ndet > 500\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.5\n  AND p.ranking = 1\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3086, "completion_tokens": 3346, "total_tokens": 6432, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2880, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5aac548190800b066c2c728e83", "custom_id": "83-2", "response": {"status_code": 200, "request_id": "f991babd67619d55ea43f81d2c39cdd6", "body": {"id": "chatcmpl-CSyRK0PDOvNDDKbLLS1oAEmO7qpqO", "object": "chat.completion", "created": 1761021550, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all columns from the ALLWISE table for the ZTF object 'ZTF21aazqwxv'\n-- Crossmatch radius: 3 arcseconds (0.0008333333333333333 degrees)\n-- Returns all ALLWISE matches within the cone, ordered by nearest first\nWITH target_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21aazqwxv'\n)\nSELECT a.*\nFROM allwise AS a\nINNER JOIN target_object AS o\n    ON q3c_radial_query(a.ra, a.dec, o.meanra, o.meandec, 0.0008333333333333333)\nORDER BY q3c_dist(a.ra, a.dec, o.meanra, o.meandec) ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3281, "completion_tokens": 1461, "total_tokens": 4742, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1280, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5abaf48190a1e875c5a891e3a0", "custom_id": "83-3", "response": {"status_code": 200, "request_id": "4ff5b8235f982a44c07b3b8a161cd27d", "body": {"id": "chatcmpl-CSyRelAc8Xnj0QooED5Mtjrv6nsEa", "object": "chat.completion", "created": 1761021570, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all ALLWISE columns for the ZTF object 'ZTF21aazqwxv' by positional cross-match within 3 arcseconds\nSELECT\n    aw.*\nFROM object AS o\nINNER JOIN allwise AS aw\n    ON q3c_radial_query(aw.ra, aw.dec, o.meanra, o.meandec, 3.0/3600.0) -- 3 arcsec radius in degrees\nWHERE o.oid = 'ZTF21aazqwxv'\nORDER BY q3c_dist(aw.ra, aw.dec, o.meanra, o.meandec) ASC -- closest counterpart first\nLIMIT 1; -- return the single nearest ALLWISE match\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2851, "completion_tokens": 1184, "total_tokens": 4035, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5b6af0819099cd6f05fca18f7f", "custom_id": "83-4", "response": {"status_code": 200, "request_id": "ac1609fb97df6c61c891f5af92b4361e", "body": {"id": "chatcmpl-CSyRsyO1N8DVCd5927qgUh0TXsgLd", "object": "chat.completion", "created": 1761021584, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all columns from the AllWISE catalog entry matched to the given ZTF object\nSELECT aw.*\nFROM xmatch AS xm\nINNER JOIN allwise AS aw\n  ON aw.oid_catalog = xm.oid_catalog\nWHERE xm.oid = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2598, "completion_tokens": 906, "total_tokens": 3504, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5b8b408190ab8439a298f53180", "custom_id": "84-2", "response": {"status_code": 200, "request_id": "a03d2ac689b1c96b0aeabc38235fe557", "body": {"id": "chatcmpl-CSyS51rtgWKBzBLQKkrowrBSfMINN", "object": "chat.completion", "created": 1761021597, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- ALLWISE matches for the ZTF object ZTF19aascdol with separations and W1\u2013W4 magnitudes\nSELECT\n    x.oid,                -- ZTF identifier\n    x.oid_catalog,        -- ALLWISE catalog identifier\n    x.dist,               -- angular separation (arcsec)\n    a.w1mpro,             -- WISE W1 magnitude\n    a.w2mpro,             -- WISE W2 magnitude\n    a.w3mpro,             -- WISE W3 magnitude\n    a.w4mpro              -- WISE W4 magnitude\nFROM xmatch AS x\nINNER JOIN allwise AS a\n    ON x.oid_catalog = a.oid_catalog\nWHERE x.oid = 'ZTF19aascdol'\nORDER BY x.dist ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2994, "completion_tokens": 1205, "total_tokens": 4199, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5b40a48190a69ed7f7cffd586d", "custom_id": "84-3", "response": {"status_code": 200, "request_id": "1cba1cd6975f3ed187519309a2de580f", "body": {"id": "chatcmpl-CSySIMuLgy3mANQq0cyKv0J4I45XO", "object": "chat.completion", "created": 1761021610, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- ALLWISE crossmatches for a given ZTF object with WISE W1\u2013W4 magnitudes\nSELECT\n    xmatch.oid,               -- ZTF object identifier\n    xmatch.oid_catalog,       -- ALLWISE catalog identifier\n    xmatch.dist,              -- distance between counterparts (arcseconds)\n    allwise.w1mpro,           -- WISE W1 magnitude\n    allwise.w2mpro,           -- WISE W2 magnitude\n    allwise.w3mpro,           -- WISE W3 magnitude\n    allwise.w4mpro            -- WISE W4 magnitude\nFROM xmatch\nINNER JOIN allwise\n    ON xmatch.oid_catalog = allwise.oid_catalog\nWHERE xmatch.oid = 'ZTF19aascdol'\n  AND xmatch.catid = 'ALLWISE'\nORDER BY xmatch.dist ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3127, "completion_tokens": 1348, "total_tokens": 4475, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5b63b08190a78ab82ececb99fc", "custom_id": "84-4", "response": {"status_code": 200, "request_id": "96e68dca0e54e03a0cc732616c4e5384", "body": {"id": "chatcmpl-CSySZfnXPMrYYOnIJJsmZkyXe5N3A", "object": "chat.completion", "created": 1761021627, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- ALLWISE cross-matches for the given ZTF object with W1\u2013W4 magnitudes\nSELECT\n    x.oid,               -- ZTF identifier\n    x.oid_catalog,       -- ALLWISE catalog identifier\n    x.dist,              -- angular separation in arcseconds\n    a.w1mpro,            -- WISE W1 magnitude\n    a.w2mpro,            -- WISE W2 magnitude\n    a.w3mpro,            -- WISE W3 magnitude\n    a.w4mpro             -- WISE W4 magnitude\nFROM xmatch AS x\nINNER JOIN allwise AS a\n    ON a.oid_catalog = x.oid_catalog\nWHERE x.oid = 'ZTF19aascdol'\n  AND x.catid = 'allwise'\nORDER BY x.dist ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2900, "completion_tokens": 1145, "total_tokens": 4045, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5b7578819082e7769da34c3cfa", "custom_id": "96-2", "response": {"status_code": 200, "request_id": "837ad42fba36f2bee6438e18300e062e", "body": {"id": "chatcmpl-CSyK8vzCzlR77HqEbY0IeVBFj0Bxv", "object": "chat.completion", "created": 1761021104, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all detections for ZTF objects within 2 arcsec of specified MPC names\n-- Returns: all columns from ss_ztf, plus selected detection columns\nSELECT\n    s.*,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM ss_ztf AS s\nINNER JOIN detection AS d\n    ON d.oid = s.oid\nWHERE\n    s.ssnamenr IN ('2003FP134', '2009UK56')\n    AND s.ssdistnr <= 2.0\nORDER BY\n    s.ssnamenr ASC,\n    d.mjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3102, "completion_tokens": 1189, "total_tokens": 4291, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5b97c88190ab2957b6664906eb", "custom_id": "96-3", "response": {"status_code": 200, "request_id": "bc8a2dccc716729fafe05b00b12bb310", "body": {"id": "chatcmpl-CSyKPFNNwwwZXuBfmPMIEZ1x16yQ8", "object": "chat.completion", "created": 1761021121, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- All detections for ZTF objects within 2 arcsec of MPC names '2003FP134' or '2009UK56'\n-- Returns: ss_ztf.* plus detection.mjd, detection.fid, detection.isdiffpos, detection.ra, detection.dec, detection.magpsf, detection.sigmapsf\nSELECT\n    ss_ztf.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra,\n    detection.dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM ss_ztf\nINNER JOIN detection\n    ON detection.oid = ss_ztf.oid\nWHERE\n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\n    AND ss_ztf.ssdistnr <= 2\nORDER BY\n    ss_ztf.ssnamenr ASC,\n    detection.mjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3139, "completion_tokens": 1102, "total_tokens": 4241, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5b939c8190ad2d57a2bcaa853c", "custom_id": "96-4", "response": {"status_code": 200, "request_id": "65d35f3da1d14012c8dea077c80ee620", "body": {"id": "chatcmpl-CSyKiv8ZT0jotHfyVI0YxuocD9Vnk", "object": "chat.completion", "created": 1761021140, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all detections for ZTF objects whose nearest Solar System object is '2003FP134' or '2009UK56' within 2 arcsec\nSELECT\n    ss_ztf.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra,\n    detection.dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM ss_ztf\nINNER JOIN detection\n    ON ss_ztf.oid = detection.oid\nWHERE ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\n  AND ss_ztf.ssdistnr <= 2\nORDER BY ss_ztf.ssnamenr ASC, detection.mjd ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 2024, "total_tokens": 5040, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1856, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5b97208190b8b767812d6c26ed", "custom_id": "94-2", "response": {"status_code": 200, "request_id": "7fb628fc1873bcbf8ffe2a272b4d7744", "body": {"id": "chatcmpl-CSyL203xKxu7bI3SzcBvw7yLpjOTD", "object": "chat.completion", "created": 1761021160, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Objects with a change in the reference image; return all columns from object and reference\nSELECT\n  o.*,\n  r.*\nFROM object AS o\nINNER JOIN reference AS r\n  ON r.oid = o.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 904, "total_tokens": 3615, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5ca6d081909bed2e7e5dc0800d", "custom_id": "94-3", "response": {"status_code": 200, "request_id": "423610af6b9fddeae68f85bab5a01ef2", "body": {"id": "chatcmpl-CSyLHkBE4ORTgV0VvxCf2IvrKFpgA", "object": "chat.completion", "created": 1761021175, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get all columns from the object and reference tables for objects with a changed reference\nSELECT\n  o.*,\n  r.*\nFROM object AS o\nINNER JOIN reference AS r\n  ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2845, "completion_tokens": 967, "total_tokens": 3812, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5b90e481908b33193ed0f1cabe", "custom_id": "94-4", "response": {"status_code": 200, "request_id": "f480b1f7c6c98678ab9081812622b8b3", "body": {"id": "chatcmpl-CSyLYJvZausMLvG4mQzq9WzCDRrfx", "object": "chat.completion", "created": 1761021192, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all columns from object and reference for objects with a change in the reference, limited to 50 rows\nSELECT\n  o.*,\n  r.*\nFROM object AS o\nINNER JOIN reference AS r\n  ON r.oid = o.oid\nWHERE o.reference_change IS TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2752, "completion_tokens": 717, "total_tokens": 3469, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5c12f88190b35360e54bc8bc18", "custom_id": "90-2", "response": {"status_code": 200, "request_id": "e9cc205599bf72f67df0683ce148570d", "body": {"id": "chatcmpl-CSyLh1JcQgNAoRWaegousNyXBbjbZ", "object": "chat.completion", "created": 1761021201, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return all probability rows (p.*) for up to 100 ZTF objects whose Multiband_period < 5 days\n-- in feature.version = 'lc_classifier_1.2.1-P', restricted to the light curve classifier\n-- and rankings 1 or 2.\nWITH eligible_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n      AND f.oid LIKE 'ZTF%'\n    ORDER BY f.value ASC, f.oid ASC\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nINNER JOIN eligible_oids e ON p.oid = e.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nORDER BY p.oid ASC, p.ranking ASC;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2964, "completion_tokens": 1233, "total_tokens": 4197, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5c37248190a8495018c71dbc9a", "custom_id": "90-3", "response": {"status_code": 200, "request_id": "2f9927771a6768f4b1c8689f73e84024", "body": {"id": "chatcmpl-CSyLykvOOlPg5iyqhxGgJEuIhUhYH", "object": "chat.completion", "created": 1761021218, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 100 objects with Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P'\n-- and return all probability rows for the light curve classifier with ranking 1 or 2\nWITH selected_oids AS (\n  SELECT DISTINCT f.oid\n  FROM feature f\n  WHERE f.name = 'Multiband_period'\n    AND f.version = 'lc_classifier_1.2.1-P'\n    AND f.value < 5\n  LIMIT 100\n)\nSELECT p.*\nFROM probability p\nINNER JOIN selected_oids s ON s.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nORDER BY p.oid, p.ranking, p.classifier_version, p.class_name;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3074, "completion_tokens": 1912, "total_tokens": 4986, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5c4400819096d4dea249e21268", "custom_id": "90-4", "response": {"status_code": 200, "request_id": "4cae86a780f66a7197d248ccb9d596c2", "body": {"id": "chatcmpl-CSyMKl7tMKiCa2cOIxxbwl8Hjrv3w", "object": "chat.completion", "created": 1761021240, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- This query assumes there is a features table that stores the multiband period per object and feature/classifier version.\n-- Replace 'periodic_features' and 'multiband_period'/'classifier_version' with the actual table/column names in your ALeRCE DB.\nSELECT p.*\nFROM probability p\nINNER JOIN periodic_features f ON f.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'          -- only light curve classifier\n  AND p.ranking IN (1, 2)                          -- rankings either 1 or 2\n  AND f.classifier_version = 'lc_classifier_1.2.1-P' -- feature version filter\n  AND f.multiband_period < 5                       -- multiband period lower than 5 days\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3038, "completion_tokens": 3443, "total_tokens": 6481, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5c4a688190992324f1c6ecbe3d", "custom_id": "100-2", "response": {"status_code": 200, "request_id": "c409ef9db64a361407de36bd122bbc28", "body": {"id": "chatcmpl-CSyMw7B370Yp6Vx0WEuVL6RS3lhtm", "object": "chat.completion", "created": 1761021278, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* NOTE:\n   The provided schema includes only the 'detection' table at the epoch level.\n   Tables for non-detections and forced photometry are not available here, so this query returns detection epochs only.\n   The 'forced_magpsf' and 'forced_sigmapsf' columns are returned as NULL placeholders.\n*/\nSELECT\n  d.oid,\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.magpsf,\n  d.sigmapsf,\n  d.diffmaglim,\n  NULL::double precision AS forced_magpsf,\n  NULL::double precision AS forced_sigmapsf,\n  'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid = 'ZTF24aamtvxb'\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3570, "total_tokens": 6640, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3392, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5c61d48190af3482e13e965410", "custom_id": "100-3", "response": {"status_code": 200, "request_id": "8262f742136fe4bccdd480887e62bf03", "body": {"id": "chatcmpl-CSyNkZ8biuLrB8u0zPlHMmQtqa8EN", "object": "chat.completion", "created": 1761021328, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- NOTE: The available schema here includes only the 'detection' table for epoch-level photometry.\n-- Non-detections and forced photometry tables are not present in this context, so this query returns\n-- only detections for the requested object. It includes placeholders (NULLs) for forced photometry columns.\nSELECT\n    d.oid,                -- ZTF identifier\n    d.mjd,                -- epoch date\n    d.fid,                -- filter identifier\n    d.isdiffpos,          -- isdiffpos flag\n    d.magpsf,             -- detection difference magnitude\n    d.sigmapsf,           -- detection difference magnitude uncertainty\n    d.diffmaglim,         -- 5-sigma magnitude limit\n    NULL::double precision AS forced_magpsf,      -- forced difference magnitude (not available)\n    NULL::double precision AS forced_sigmapsf,    -- forced difference magnitude uncertainty (not available)\n    'detection'::text AS \"table\"                  -- table of origin\nFROM detection d\nWHERE d.oid = 'ZTF24aamtvxb'\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3702, "total_tokens": 6772, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3456, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5c68588190a2510a9426e1c265", "custom_id": "100-4", "response": {"status_code": 200, "request_id": "998b119f872bcf3fb0bbd215ca823644", "body": {"id": "chatcmpl-CSyOJBhtS6KX10t1qytI2okUXV6Qq", "object": "chat.completion", "created": 1761021363, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- NOTE: The provided schema includes only the 'detection' table for time/band-dependent epochs.\n--       There are no 'non_detection' or 'forced_photometry' tables available here.\n--       This query returns detections for the requested object and includes placeholder columns\n--       for forced photometry (NULL), along with the requested 'table' source label.\n\nSELECT\n    d.oid,               -- ZTF identifier\n    d.mjd,               -- epoch date (MJD)\n    d.fid,               -- filter identifier (1=g; 2=r; 3=i)\n    d.isdiffpos,         -- isdiffpos flag\n    d.magpsf,            -- detection difference magnitude\n    d.sigmapsf,          -- detection difference magnitude uncertainty\n    d.diffmaglim,        -- 5-sigma magnitude limit\n    NULL::double precision AS forced_magpsf,     -- forced difference magnitude (not available in this schema)\n    NULL::double precision AS forced_sigmapsf,   -- forced difference magnitude uncertainty (not available)\n    'detection'::text AS \"table\"                 -- origin table\nFROM detection d\nWHERE d.oid = 'ZTF24aamtvxb'\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3070, "completion_tokens": 3345, "total_tokens": 6415, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3072, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5c7bf481909087b16fe3f663db", "custom_id": "106-2", "response": {"status_code": 200, "request_id": "d9956142a394359d9c9b6561249bfd62", "body": {"id": "chatcmpl-CSyP2cwUuLZcDOMqEzfu4DRsyy0n6", "object": "chat.completion", "created": 1761021408, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 30 ZTF objects with >10 detections, bogus prob > 0.7 in stamp_classifier v1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top.\nSELECT\n  o.oid,\n  o.ndet,\n  o.firstmjd,\n  p_stamp.probability AS prob_stamp_bogus,\n  p_top.probability AS prob_lc_transient\nFROM object AS o\nINNER JOIN probability AS p_stamp\n  ON p_stamp.oid = o.oid\n  AND p_stamp.classifier_name = 'stamp_classifier'\n  AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n  AND p_stamp.class_name = 'bogus'\n  AND p_stamp.probability > 0.7\n  AND p_stamp.ranking = 1\nINNER JOIN probability AS p_top\n  ON p_top.oid = o.oid\n  AND p_top.classifier_name = 'lc_classifier_top'\n  AND p_top.class_name = 'Transient'\n  AND p_top.probability > 0.9\n  AND p_top.ranking = 1\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3114, "completion_tokens": 2833, "total_tokens": 5947, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5c68f88190b9d9f57687021335", "custom_id": "106-3", "response": {"status_code": 200, "request_id": "59d72337c4b2c0c7af50ad684164c950", "body": {"id": "chatcmpl-CSyPQaNCEAo73ILqaGQTG7o0RZZzF", "object": "chat.completion", "created": 1761021432, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Find up to 30 ZTF objects with ndet > 10, high bogus prob in stamp_classifier v1.0.4,\n-- and high Transient prob in lc_classifier_top. Return requested columns with specified aliases.\nSELECT\n  o.oid,\n  o.ndet,\n  o.firstmjd,\n  sp.prob_stamp_bogus,\n  lt.prob_lc_transient\nFROM object AS o\nINNER JOIN (\n  SELECT\n    p.oid,\n    p.probability AS prob_stamp_bogus\n  FROM probability AS p\n  WHERE\n    p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'bogus'\n    AND p.probability > 0.7\n) AS sp\n  ON sp.oid = o.oid\nINNER JOIN (\n  SELECT\n    p.oid,\n    MAX(p.probability) AS prob_lc_transient\n  FROM probability AS p\n  WHERE\n    p.classifier_name = 'lc_classifier_top'\n    AND p.class_name = 'Transient'\n    AND p.probability > 0.9\n  GROUP BY p.oid\n) AS lt\n  ON lt.oid = o.oid\nWHERE\n  o.ndet > 10\nORDER BY\n  o.oid ASC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3134, "completion_tokens": 1330, "total_tokens": 4464, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5c65dc81909b3cf857ae7b38cf", "custom_id": "58-2", "response": {"status_code": 200, "request_id": "f09000b086397dec05b4e4dbc70275be", "body": {"id": "chatcmpl-CSyPgFhzJPWVQZoKXSMeXcnEKarCi", "object": "chat.completion", "created": 1761021448, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Return up to 20 objects meeting the requested criteria from the ZTF object table\nSELECT\n  o.*\nFROM object AS o\nWHERE\n  o.ndet >= 30                  -- minimum number of detections\n  AND o.g_r_max_corr > 3.5      -- difference between minimum g- and r-band corrected magnitudes (g - r at max)\n  AND o.deltajd > 20            -- time difference between last and first detection in days\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2708, "completion_tokens": 564, "total_tokens": 3272, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 448, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5ce5f08190b27d3846f6fa9268", "custom_id": "58-3", "response": {"status_code": 200, "request_id": "c067f7e1212a06637654989a3bd40c12", "body": {"id": "chatcmpl-CSyPngI3g7MwNxoPhRkbN55ABbhYC", "object": "chat.completion", "created": 1761021455, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Get up to 20 objects with: ndet >= 30, g_r_max_corr > 3.5, and deltajd > 20\nSELECT\n    *\nFROM\n    object\nWHERE\n    ndet >= 30\n    AND g_r_max_corr > 3.5\n    AND deltajd > 20\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2718, "completion_tokens": 409, "total_tokens": 3127, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 320, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5d361c8190a8e869b615e31181", "custom_id": "58-4", "response": {"status_code": 200, "request_id": "cec5473f8f4635cacfe1cf4794329f6d", "body": {"id": "chatcmpl-CSyPtzRKStUbNv8Ie6sMk6GBdsHDs", "object": "chat.completion", "created": 1761021461, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n/* Get at most 20 ZTF objects with:\n   - ndet >= 30\n   - deltajd > 20\n   - absolute difference between minimum corrected g and r magnitudes > 3.5\n   Return all columns from object\n*/\nWITH obj_prefilter AS (\n  SELECT *\n  FROM object\n  WHERE ndet >= 30\n    AND deltajd > 20\n),\nband_minima AS (\n  SELECT\n    d.oid,\n    MIN(CASE WHEN d.fid = 1 AND d.corrected THEN d.magpsf_corr END) AS g_min_corr,\n    MIN(CASE WHEN d.fid = 2 AND d.corrected THEN d.magpsf_corr END) AS r_min_corr\n  FROM detection d\n  INNER JOIN obj_prefilter o USING (oid)  -- restrict detection scan to candidate oids\n  GROUP BY d.oid\n  HAVING\n    MIN(CASE WHEN d.fid = 1 AND d.corrected THEN d.magpsf_corr END) IS NOT NULL\n    AND MIN(CASE WHEN d.fid = 2 AND d.corrected THEN d.magpsf_corr END) IS NOT NULL\n    AND ABS(\n      MIN(CASE WHEN d.fid = 1 AND d.corrected THEN d.magpsf_corr END)\n      - MIN(CASE WHEN d.fid = 2 AND d.corrected THEN d.magpsf_corr END)\n    ) > 3.5\n)\nSELECT o.*\nFROM obj_prefilter o\nINNER JOIN band_minima bm ON bm.oid = o.oid\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2793, "completion_tokens": 1691, "total_tokens": 4484, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5d14488190838e23d307d6c509", "custom_id": "39-2", "response": {"status_code": 200, "request_id": "8c63641de67136cd83b75f84fc54f1e7", "body": {"id": "chatcmpl-CSyQHapaLJO0FG7EsZPhGRWS9N4OF", "object": "chat.completion", "created": 1761021485, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3092, "completion_tokens": 4000, "total_tokens": 7092, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5d32848190914dbb49015d240a", "custom_id": "39-3", "response": {"status_code": 200, "request_id": "e361e7ada5a28e97050193183670e6f9", "body": {"id": "chatcmpl-CSyQqj4mDX4TqtCH2t4PcreIUZu0C", "object": "chat.completion", "created": 1761021520, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3092, "completion_tokens": 4000, "total_tokens": 7092, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f70f5d373c819099f694e4ae3d3c1e", "custom_id": "39-4", "response": {"status_code": 200, "request_id": "2da2d5704347bd942521ffed94af145e", "body": {"id": "chatcmpl-CSyRa4pzmwztHSTvu6hE4pm5cNLIT", "object": "chat.completion", "created": 1761021566, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select r-band detections for objects classified as 'CV/Nova' by the stochastic LC classifier (top-ranked),\n-- with at most 50 detections, and include corrected PSF magnitudes and their errors.\n-- Compute per-object maximum rise from minimum (max(magpsf_corr) - min(magpsf_corr)).\nSELECT\n    o.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.magpsf_corr,\n    d.sigmapsf,\n    d.sigmapsf_corr,\n    MIN(d.magpsf_corr) OVER (PARTITION BY o.oid) AS min_magpsf_corr,\n    MAX(d.magpsf_corr) OVER (PARTITION BY o.oid) AS max_magpsf_corr,\n    (MAX(d.magpsf_corr) OVER (PARTITION BY o.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY o.oid)) AS max_rise_from_min\nFROM object o\nINNER JOIN probability p\n    ON p.oid = o.oid\n   AND p.classifier_name = 'lc_classifier_stochastic' -- user requested the stochastic LC classifier\n   AND p.class_name = 'CV/Nova'\n   AND p.ranking = 1                                  -- highest probability class\nINNER JOIN detection d\n    ON d.oid = o.oid\nWHERE\n    o.ndet <= 50              -- at most 50 detections from discovery to last detection\n    AND d.fid = 2             -- r-band\n    AND d.corrected = TRUE    -- use corrected measurements (magpsf_corr and its errors)\nORDER BY o.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3092, "completion_tokens": 3317, "total_tokens": 6409, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2944, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
