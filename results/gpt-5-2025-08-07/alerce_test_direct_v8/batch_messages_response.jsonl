{"id": "batch_req_690ebb47eb18819080c2ed3bbcca9f9c", "custom_id": "8-5", "response": {"status_code": 200, "request_id": "506c38d91d96f8e8fb8a55f4a55086d1", "body": {"id": "chatcmpl-CZROa7u7Zhon0SfCp680A486ZT2tF", "object": "chat.completion", "created": 1762562824, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects first observed (via their earliest detection) between 2023-08-17 (MJD=60173.0) and 2023-08-21 (MJD=60177.0),\n-- whose stamp classifier predicts 'SN' as the top class (ranking=1), and that either have SN probability > 0.5\n-- OR have at least two detections.\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1\n  AND p.oid IN (\n      SELECT oid\n      FROM (\n          SELECT d.oid, MIN(d.mjd) AS first_mjd\n          FROM detection d\n          GROUP BY d.oid\n      ) first_det\n      WHERE first_mjd >= 60173.0\n        AND first_mjd <= 60177.0\n  )\n  AND (\n      p.probability > 0.5\n      OR p.oid IN (\n          SELECT d2.oid\n          FROM detection d2\n          GROUP BY d2.oid\n          HAVING COUNT(*) >= 2\n      )\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2650, "completion_tokens": 2941, "total_tokens": 5591, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2688, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb47cf9481908ced1a41331bb69d", "custom_id": "8-6", "response": {"status_code": 200, "request_id": "40a92e1d888a2a8e94fa76e67d9400ed", "body": {"id": "chatcmpl-CZRJsgPEf2Ir2MRYBaVOiwbBpkcKA", "object": "chat.completion", "created": 1762562532, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Assumptions:\n-- 1) \"first classified as SN\" means the stamp classifier's top-ranked class (ranking = 1) is 'SN'.\n-- 2) The classification time is approximated by the object's first detection time (firstmjd).\n-- 3) Date range is inclusive: Aug 17\u201321 corresponds to MJD 60173.0\u201360177.0.\nSELECT *\nFROM object o\nWHERE\n  o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND o.oid IN (\n    -- Case A: SN (rank 1) by stamp classifier with probability > 0.5\n    SELECT p1.oid\n    FROM probability p1\n    WHERE p1.classifier_name = 'stamp_classifier'\n      AND p1.class_name = 'SN'\n      AND p1.ranking = 1\n      AND p1.probability > 0.5\n\n    UNION\n\n    -- Case B: SN (rank 1) by stamp classifier and at least two detections (regardless of probability)\n    SELECT o2.oid\n    FROM object o2\n    WHERE o2.ndet >= 2\n      AND o2.oid IN (\n        SELECT p2.oid\n        FROM probability p2\n        WHERE p2.classifier_name = 'stamp_classifier'\n          AND p2.class_name = 'SN'\n          AND p2.ranking = 1\n      )\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2584, "completion_tokens": 2810, "total_tokens": 5394, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb47c954819091a14bde9b4eefe8", "custom_id": "8-7", "response": {"status_code": 200, "request_id": "89c107da91dcf48603538777941826e9", "body": {"id": "chatcmpl-CZRHKDTaAc2CrCnKfbKccrs2CQNwv", "object": "chat.completion", "created": 1762562374, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects whose first detection (firstmjd) is between Aug 17 (60173.0) and Aug 21 (60177.0),\n-- and whose top-ranked stamp classifier label is SN, with either probability > 0.5\n-- or at least 2 detections (ndet >= 2).\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n      AND (\n        probability > 0.5\n        OR oid IN (\n          SELECT oid\n          FROM object\n          WHERE ndet >= 2\n            AND firstmjd BETWEEN 60173.0 AND 60177.0\n        )\n      )\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2629, "completion_tokens": 1982, "total_tokens": 4611, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb47d688819099bc5917aa16d74a", "custom_id": "8-9", "response": {"status_code": 200, "request_id": "1a9a6c24eec5b3f776da76b3ce150a47", "body": {"id": "chatcmpl-CZROfYYs9Jl0Fgf0H01vvFDOtbyG1", "object": "chat.completion", "created": 1762562829, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* \nObjects whose first detection (as a proxy for first stamp-classification event) occurred between 60173.0 (Aug 17) and 60177.0 (Aug 21), \nthat the stamp classifier classifies as SN (top-ranked), and that either have SN probability > 0.5 or at least two detections.\n*/\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1  /* interpret \"classified as SN\" as top-ranked class */\n  AND p.oid IN (\n    /* Obtain candidate OIDs meeting the time-window and (probability > 0.5 OR >=2 detections) condition */\n    SELECT s.oid\n    FROM (\n      SELECT d.oid, MIN(d.mjd) AS first_mjd, COUNT(*) AS ndet\n      FROM detection d\n      GROUP BY d.oid\n    ) s\n    WHERE s.first_mjd BETWEEN 60173.0 AND 60177.0\n      AND (\n        s.ndet >= 2\n        OR EXISTS (\n          SELECT 1\n          FROM probability p2\n          WHERE p2.oid = s.oid\n            AND p2.classifier_name = 'stamp_classifier'\n            AND p2.class_name = 'SN'\n            AND p2.probability > 0.5\n        )\n      )\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2650, "completion_tokens": 3506, "total_tokens": 6156, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3200, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb47e4d08190a301b10253c7c1ab", "custom_id": "27-5", "response": {"status_code": 200, "request_id": "e02fd4ebf711aaf8977661c34917c14c", "body": {"id": "chatcmpl-CZRIkHgBCGTL5RgL9lVQrlaunyBaZ", "object": "chat.completion", "created": 1762562462, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with >=100 detections whose top-ranked lc_classifier class is CEP with probability > 0.76\nWITH cepheids AS (\n    SELECT pr.oid\n    FROM probability pr\n    WHERE pr.classifier_name = 'lc_classifier'\n      AND pr.class_name = 'CEP'\n      AND pr.ranking = 1\n      AND pr.probability > 0.76\n),\nselected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 100\n      AND o.oid IN (SELECT oid FROM cepheids)\n)\n-- For those objects, return probabilities for each lc_classifier class plus requested object columns\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN (SELECT oid FROM selected_oids)\nORDER BY p.oid, p.ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2640, "completion_tokens": 2791, "total_tokens": 5431, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2432, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb47db6481908173735801d302a4", "custom_id": "27-6", "response": {"status_code": 200, "request_id": "1bb0b58b5383f8068c96f66763e7be7c", "body": {"id": "chatcmpl-CZRM1HajZ5fdSEgH6jfOJlLFXWq7y", "object": "chat.completion", "created": 1762562665, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return, for each class row of the lc_classifier, the object and probability info,\n-- but only for those (oid, classifier_version) where CEP is the top class (ranking=1)\n-- with probability > 0.76 and the object has ndet >= 100.\n\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND (p.oid, p.classifier_version) IN (\n        SELECT DISTINCT prob.oid, prob.classifier_version\n        FROM probability prob\n        WHERE prob.classifier_name = 'lc_classifier'\n          AND prob.class_name = 'CEP'\n          AND prob.ranking = 1\n          AND prob.probability > 0.76\n          AND prob.oid IN (\n                SELECT o2.oid\n                FROM object o2\n                WHERE o2.ndet >= 100\n          )\n  )\nORDER BY p.oid, p.ranking, p.class_name;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5027, "completion_tokens": 3320, "total_tokens": 8347, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2944, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb47d4cc8190ada0fc32c05a5d61", "custom_id": "27-7", "response": {"status_code": 200, "request_id": "7622e362b6c4d386771194ceb1c7e621", "body": {"id": "chatcmpl-CZRJMIk0PRleCbKkV3xLEpjcynxdS", "object": "chat.completion", "created": 1762562500, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76\nWITH eligible AS (\n    SELECT p.oid, p.classifier_version\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet >= 100\n      )\n)\n-- Return all lc_classifier class probabilities for the eligible objects (same classifier_version)\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND (p.oid, p.classifier_version) IN (\n      SELECT e.oid, e.classifier_version\n      FROM eligible e\n  )\nORDER BY p.oid, p.ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2640, "completion_tokens": 2419, "total_tokens": 5059, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb47d9c08190aca584a4daa806e9", "custom_id": "27-8", "response": {"status_code": 200, "request_id": "af49a4cb7d3b15a9a4b9f62a2d18e042", "body": {"id": "chatcmpl-CZRM57Xyp7jGEHuofsgtcVxwQX8rt", "object": "chat.completion", "created": 1762562669, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all lc_classifier class probabilities for objects with ndet >= 100 whose top-ranked class is CEP with probability > 0.76\nSELECT\n    p.oid,\n    /* object-level attributes via scalar subqueries to avoid JOINs */\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE\n    /* only lc_classifier classes */\n    p.classifier_name = 'lc_classifier'\n    /* ensure objects have at least 100 detections */\n    AND p.oid IN (\n        SELECT o.oid\n        FROM object o\n        WHERE o.ndet >= 100\n    )\n    /* restrict to classifier versions where CEP is top-ranked with prob > 0.76 */\n    AND (p.oid, p.classifier_version) IN (\n        SELECT pr.oid, pr.classifier_version\n        FROM probability pr\n        WHERE pr.classifier_name = 'lc_classifier'\n          AND pr.class_name = 'CEP'\n          AND pr.ranking = 1\n          AND pr.probability > 0.76\n    )\nORDER BY p.oid, p.ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2640, "completion_tokens": 2825, "total_tokens": 5465, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2432, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb47d0f08190b0d7f4a27f86b431", "custom_id": "27-9", "response": {"status_code": 200, "request_id": "1b0d883f93d32c1c7bb0a4e4b5eb6707", "body": {"id": "chatcmpl-CZRJkqM5nZ7g5waUWC2Aj6eHEmlFK", "object": "chat.completion", "created": 1762562524, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all lc_classifier class probabilities for objects whose top-ranked class is CEP with prob>0.76\n-- and have ndet >= 100, including selected object metadata via scalar subqueries (no explicit JOINs).\nWITH target_oids AS (\n    SELECT pr.oid\n    FROM probability pr\n    WHERE pr.classifier_name = 'lc_classifier'\n      AND pr.class_name = 'CEP'\n      AND pr.ranking = 1\n      AND pr.probability > 0.76\n      AND pr.oid IN (\n          SELECT o2.oid\n          FROM object o2\n          WHERE o2.ndet >= 100\n      )\n)\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN (SELECT oid FROM target_oids)\nORDER BY p.oid, p.ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2595, "completion_tokens": 1958, "total_tokens": 4553, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb48c574819099987129162a75ba", "custom_id": "17-5", "response": {"status_code": 200, "request_id": "ab3dcb19ec878302d3e0d07f383c391a", "body": {"id": "chatcmpl-CZRNMslIzu7hGj7BK47CaQK5Qnekh", "object": "chat.completion", "created": 1762562748, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Objects whose top lc_classifier class is AGN */\nSELECT\n    /* return all r-band features for the selected objects */\n    f.*\nFROM feature f\nWHERE f.fid = 2 /* r band */\n  AND f.oid IN (\n      /* OIDs classified as AGN (top-ranked) by the Light Curve classifier */\n      SELECT p.oid\n      FROM probability p\n      WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'AGN'\n        AND p.ranking = 1\n        /* r-band variability: ExcessVar > 0 in r (fid=2) */\n        AND p.oid IN (\n            SELECT f2.oid\n            FROM feature f2\n            WHERE f2.fid = 2\n              AND f2.name = 'ExcessVar'\n              AND f2.value > 0\n        )\n        /* g-band condition: no detections OR non-variable in g (fid=1) */\n        AND (\n            /* no detections in g band (either no magstat row or ndet=0) */\n            NOT EXISTS (\n                SELECT 1\n                FROM magstat m\n                WHERE m.oid = p.oid\n                  AND m.fid = 1\n                  AND m.ndet > 0\n            )\n            /* OR: has g-band feature ExcessVar <= 0 (non-variable) */\n            OR EXISTS (\n                SELECT 1\n                FROM feature f3\n                WHERE f3.oid = p.oid\n                  AND f3.fid = 1\n                  AND f3.name = 'ExcessVar'\n                  AND COALESCE(f3.value, 0) <= 0\n            )\n        )\n  )\n/* final ordering: by object id, and within each object order features by value ascending */\nORDER BY f.oid ASC, f.value ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5230, "completion_tokens": 3915, "total_tokens": 9145, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3520, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb48c72c819082124fda402927ee", "custom_id": "17-6", "response": {"status_code": 200, "request_id": "4ec7830a848f33e8faf87256a13e4f04", "body": {"id": "chatcmpl-CZSqJH0Ba7jWWzRcaGFQKfYzB0tee", "object": "chat.completion", "created": 1762568387, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 5275, "completion_tokens": 4000, "total_tokens": 9275, "prompt_tokens_details": {"cached_tokens": 5248, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb48c3a4819088cc23e1a9284da4", "custom_id": "17-8", "response": {"status_code": 200, "request_id": "ce7b6b2e0f126452acbb92d9a813db34", "body": {"id": "chatcmpl-CZRJpGqwYJNyUFDqgJxf0mAuoOxXg", "object": "chat.completion", "created": 1762562529, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects classified as AGN (most probable class from lc_classifier) \n-- that show variability in r band (ExcessVar > 0 in fid=2),\n-- and either have no detections in g band (no magstat with ndet>0 for fid=1)\n-- OR show no variability in g band (no ExcessVar > 0 in fid=1).\n-- Returns all feature rows for the selected objects, ordered by oid then feature value.\n-- Note: Variability is interpreted via ExcessVar > 0 per band. \n-- If you prefer using Pvar, replace the ExcessVar tests with Pvar and a chosen threshold.\nSELECT *\nFROM feature f\nWHERE f.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.ranking = 1\n)\nAND EXISTS (\n    SELECT 1\n    FROM feature fr\n    WHERE fr.oid = f.oid\n      AND fr.fid = 2 -- r band\n      AND fr.name = 'ExcessVar'\n      AND fr.value > 0\n)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat mg\n        WHERE mg.oid = f.oid\n          AND mg.fid = 1 -- g band\n          AND mg.ndet > 0\n    )\n    OR NOT EXISTS (\n        SELECT 1\n        FROM feature fg\n        WHERE fg.oid = f.oid\n          AND fg.fid = 1 -- g band\n          AND fg.name = 'ExcessVar'\n          AND fg.value > 0\n    )\n)\nORDER BY f.oid ASC, f.value ASC NULLS LAST;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5275, "completion_tokens": 3635, "total_tokens": 8910, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb48cb248190b34aa75575d3fc98", "custom_id": "17-9", "response": {"status_code": 200, "request_id": "beef097efcb761f496938bdab234ae9d", "body": {"id": "chatcmpl-CZRKhq5EsTa8COrkt1JGEpvGCr8vj", "object": "chat.completion", "created": 1762562583, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Objects classified as AGN by the lc_classifier (top-1 class),\n   that show variability in r band (ExcessVar fid=2 > 0),\n   and either have no detections in g (no magstat with ndet>0 for fid=1)\n   OR show no variability in g (ExcessVar fid=1 <= 0).\n   Return all features for those objects, ordered by oid then by feature value ASC. */\nWITH agn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.ranking = 1\n),\nr_var_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 2  -- r band\n      AND f.value > 0\n),\ng_non_det_or_non_var_oids AS (\n    SELECT o.oid\n    FROM agn_oids o\n    WHERE\n        /* No detections in g band (there is no magstat row with ndet > 0) */\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m\n            WHERE m.oid = o.oid\n              AND m.fid = 1  -- g band\n              AND m.ndet > 0\n        )\n        OR\n        /* Or: explicitly non-variable in g band (ExcessVar <= 0) */\n        EXISTS (\n            SELECT 1\n            FROM feature f\n            WHERE f.oid = o.oid\n              AND f.fid = 1  -- g band\n              AND f.name = 'ExcessVar'\n              AND (f.value <= 0 OR f.value IS NULL)\n        )\n),\nselected_oids AS (\n    SELECT oid\n    FROM agn_oids\n    WHERE oid IN (SELECT oid FROM r_var_oids)\n      AND oid IN (SELECT oid FROM g_non_det_or_non_var_oids)\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM selected_oids)\nORDER BY oid ASC, value ASC NULLS FIRST;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5230, "completion_tokens": 3467, "total_tokens": 8697, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3008, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb48c6a081908e7ecd9421460a8a", "custom_id": "37-5", "response": {"status_code": 200, "request_id": "03900be11da8562e122315057f46c143", "body": {"id": "chatcmpl-CZRLAwLlWXkkBxMv8bUYaS6uS2ans", "object": "chat.completion", "created": 1762562612, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Top 200 objects whose most probable lc_classifier class is SNIa, ordered by probability DESC\nWITH best_per_oid AS (\n    SELECT DISTINCT ON (oid) *\n    FROM probability\n    WHERE class_name = 'SNIa'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1  -- ensure SNIa is the top-ranked class for the object\n    ORDER BY oid, probability DESC  -- keep the highest-probability version per oid\n)\nSELECT *\nFROM best_per_oid\nORDER BY probability DESC\nLIMIT 200;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2113, "completion_tokens": 2364, "total_tokens": 4477, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb48d220819099fabb622baf3e7e", "custom_id": "37-7", "response": {"status_code": 200, "request_id": "594a6da9e89e17b0ba86e0515e287025", "body": {"id": "chatcmpl-CZRN19Hw4RvDugW7sxfiUXWwzwLbC", "object": "chat.completion", "created": 1762562727, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Top 200 objects classified as SNIa by the light curve classifier (lc_classifier)\n   - We treat \"classified SNIa\" as the top-ranked class for the object (ranking = 1).\n   - If multiple classifier_versions exist, we pick the row with the highest probability per oid.\n   - Results ordered by probability descending.\n*/\nWITH top_snia AS (\n    SELECT oid, MAX(probability) AS max_prob\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1\n    GROUP BY oid\n    ORDER BY MAX(probability) DESC\n    LIMIT 200\n)\nSELECT p.*\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'SNIa'\n  AND p.ranking = 1\n  AND (p.oid, p.probability) IN (SELECT oid, max_prob FROM top_snia)\nORDER BY p.probability DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2113, "completion_tokens": 2778, "total_tokens": 4891, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb48d1a88190b0a2d19076d82247", "custom_id": "37-8", "response": {"status_code": 200, "request_id": "5d7983c2df380cc59b29804536675c30", "body": {"id": "chatcmpl-CZRAME7SU0E6mpNIl6mlAO6waNqf0", "object": "chat.completion", "created": 1762561942, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Top 200 objects whose most probable class (ranking=1) is SNIa according to the light curve classifier,\n-- ordered by probability DESC. We select one row per object (the highest-probability version if multiple exist).\nWITH sni_rank1 AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1\n),\ntop_oids AS (\n    SELECT oid\n    FROM (\n        SELECT oid, max(probability) AS max_prob\n        FROM sni_rank1\n        GROUP BY oid\n    ) t\n    ORDER BY max_prob DESC\n    LIMIT 200\n)\nSELECT *\nFROM (\n    SELECT DISTINCT ON (p.oid) p.*\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM top_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'SNIa'\n      AND p.ranking = 1\n    ORDER BY p.oid, p.probability DESC\n) q\nORDER BY probability DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2068, "completion_tokens": 2736, "total_tokens": 4804, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb48e2d8819090814e32f456fd3b", "custom_id": "37-9", "response": {"status_code": 200, "request_id": "a8cd74a881e655fb255afcc7c327c61e", "body": {"id": "chatcmpl-CZT1SuMMdt2YFTDnYpL6Z8zQVZgXd", "object": "chat.completion", "created": 1762569078, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Top 200 unique objects (one row per oid) classified as SNIa by the Light Curve classifier,\n-- ordered by their highest available probability in descending order.\n-- DISTINCT ON selects the highest-probability row per oid (across classifier_version),\n-- then the outer ORDER BY + LIMIT picks the top 200 objects overall.\nSELECT *\nFROM (\n    SELECT DISTINCT ON (oid) *\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n    ORDER BY oid, probability DESC\n) AS t\nORDER BY probability DESC\nLIMIT 200;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2113, "completion_tokens": 2629, "total_tokens": 4742, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb49b2a88190bdee523293d52204", "custom_id": "34-5", "response": {"status_code": 200, "request_id": "47e11f164229644f48d7c1ee72457966", "body": {"id": "chatcmpl-CZSyi3Xmy6JiVXJU2feIR0vNG6vad", "object": "chat.completion", "created": 1762568908, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all rows from the feature table for the requested objects and features\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM oids)\nORDER BY oid, name, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4404, "completion_tokens": 680, "total_tokens": 5084, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb49b6c48190bcf8dc4d05394f3f", "custom_id": "34-6", "response": {"status_code": 200, "request_id": "f69f2a0f56a775483482193f4eee3285", "body": {"id": "chatcmpl-CZSylJ3Hww27GqX2yvmzUvRM4PB3K", "object": "chat.completion", "created": 1762568911, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all feature rows for the specified OIDs where the feature name is either 'Amplitude' or 'Multiband_period'\nWITH input_oids (oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM input_oids)\n  AND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4404, "completion_tokens": 949, "total_tokens": 5353, "prompt_tokens_details": {"cached_tokens": 4352, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb49afc48190a30fc08930f22908", "custom_id": "34-7", "response": {"status_code": 200, "request_id": "510eb69b13340897212cae11dd03bc61", "body": {"id": "chatcmpl-CZRAMqHB3pb34pRAygzczatBlW1bq", "object": "chat.completion", "created": 1762561942, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the requested features ('Amplitude', 'Multiband_period')\n-- for the provided list of OIDs. OIDs are defined in a CTE and used via a subquery\n-- to avoid JOINs, per guidance.\nWITH given_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM given_oids)\nORDER BY oid, name, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4404, "completion_tokens": 1101, "total_tokens": 5505, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb49b7e081909f0f7be46f038e5d", "custom_id": "34-8", "response": {"status_code": 200, "request_id": "711e54a5bd76800a4cd8c3fb3a8bff4f", "body": {"id": "chatcmpl-CZRAMoUi3R6JvlNveML51wIibYtX9", "object": "chat.completion", "created": 1762561942, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all feature rows (all bands and versions) for the requested OIDs where the feature name is 'Amplitude' or 'Multiband_period'\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM input_oids)\nORDER BY oid, name, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4404, "completion_tokens": 954, "total_tokens": 5358, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb49e770819082d65a9e15827957", "custom_id": "34-9", "response": {"status_code": 200, "request_id": "c05dfbd98f041604ffaf665564386d56", "body": {"id": "chatcmpl-CZRAMEdoaRPmWaWzOLFLqLjytyHRO", "object": "chat.completion", "created": 1762561942, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return all columns from feature for Amplitude or Multiband_period for the specified OIDs.\n   Following the guidelines, OIDs are obtained via a subquery against the object table and used in the main query. */\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n),\ntarget_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM oids)\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid, name, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4886, "completion_tokens": 998, "total_tokens": 5884, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb49b5ac8190bba4650160f59797", "custom_id": "1-5", "response": {"status_code": 200, "request_id": "825d6b51023ae678952c922e289d4cde", "body": {"id": "chatcmpl-CZRBEKoIQWcH8sRlcbix72pBUjbqL", "object": "chat.completion", "created": 1762561996, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 5696, "completion_tokens": 4000, "total_tokens": 9696, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb49cf048190a2d1491f8e35168b", "custom_id": "1-6", "response": {"status_code": 200, "request_id": "8a544afe33fcdd4cba776c52748e5bd1", "body": {"id": "chatcmpl-CZRBOJBB2mTXJ9r5ty7pmT0fmfHTM", "object": "chat.completion", "created": 1762562006, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 5696, "completion_tokens": 4000, "total_tokens": 9696, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb49c4048190a74dc2c5bfb0daf2", "custom_id": "1-7", "response": {"status_code": 200, "request_id": "b7bac6f419cda0647d06a857e3895b4e", "body": {"id": "chatcmpl-CZRBRZMEjn8YheY4qCl30s0ETs1SS", "object": "chat.completion", "created": 1762562009, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 5747, "completion_tokens": 4000, "total_tokens": 9747, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb49d9e48190a91e5945e2e3b578", "custom_id": "1-9", "response": {"status_code": 200, "request_id": "8135f6978c162d5a2a381f3de6cc8a72", "body": {"id": "chatcmpl-CZRE3i90dKZKlBzWISX6O5136POiC", "object": "chat.completion", "created": 1762562171, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 5747, "completion_tokens": 4000, "total_tokens": 9747, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4a9edc8190a1584331b15f7ec8", "custom_id": "16-5", "response": {"status_code": 200, "request_id": "c0081dd22484ea9d9a7360e79090db43", "body": {"id": "chatcmpl-CZREbRw9SpWW8inNtpERXTop6MdSS", "object": "chat.completion", "created": 1762562205, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 4134, "completion_tokens": 4000, "total_tokens": 8134, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4aaa8881909b408b7a459a5387", "custom_id": "16-6", "response": {"status_code": 200, "request_id": "1dedb1a714a4e4f9a3ae194980f1b4f4", "body": {"id": "chatcmpl-CZREsa9KnS836BKaJs2QmVHtfvsl8", "object": "chat.completion", "created": 1762562222, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3586, "completion_tokens": 4000, "total_tokens": 7586, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4aa9ac819099bec1a5325bee53", "custom_id": "16-7", "response": {"status_code": 200, "request_id": "7b9e5698ffb3cb997ebe86a234ab4cb6", "body": {"id": "chatcmpl-CZREyfC97HdMxFvOO8h7WuqEKfpu6", "object": "chat.completion", "created": 1762562228, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 4134, "completion_tokens": 4000, "total_tokens": 8134, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4aa3948190a8b2ad58d6a151b0", "custom_id": "16-8", "response": {"status_code": 200, "request_id": "a2903916fc4bc3392992f905596cd917", "body": {"id": "chatcmpl-CZRH1nBTdGtBct32nk8nI8c8Zw2hP", "object": "chat.completion", "created": 1762562355, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 4134, "completion_tokens": 4000, "total_tokens": 8134, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4aa8248190a42e9f2fb14dced5", "custom_id": "16-9", "response": {"status_code": 200, "request_id": "1dec7aaa7e119cba6b053beae398c363", "body": {"id": "chatcmpl-CZRHEBk31qPeZDG3eEmDS9UQ9ieR8", "object": "chat.completion", "created": 1762562368, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 4134, "completion_tokens": 4000, "total_tokens": 8134, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4aaf18819098b7d0be7c75f1ee", "custom_id": "19-5", "response": {"status_code": 200, "request_id": "ab32643bd09981c36201bcaa8f4c5e40", "body": {"id": "chatcmpl-CZRHcZs02i2jHelAlmukXmgdNNQzk", "object": "chat.completion", "created": 1762562392, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with at most one detection (ndet <= 1), first detection between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0)),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    -- Class name (from stamp classifier), taking the highest-probability row if multiple versions exist\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    -- Corresponding probability\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.ndet <= 1\n    AND o.firstmjd >= 59274.0\n    AND o.firstmjd < 59305.0\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2693, "completion_tokens": 2938, "total_tokens": 5631, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ac12481908df91e42387a17b9", "custom_id": "19-6", "response": {"status_code": 200, "request_id": "f0a8be0805e3b58b441a780386fde2c0", "body": {"id": "chatcmpl-CZRJ5UrBCn1h81aE5qDirxfW50XiP", "object": "chat.completion", "created": 1762562483, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects detected between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0),\n-- with at most one detection (ndet <= 1),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Columns returned: oid, meanra, meandec, ndet, firstmjd, class_name, probability\n\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Retrieve the matching class_name ('asteroid') from probability */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    /* Retrieve the corresponding probability */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59274.0 AND 59305.0\n    AND o.ndet <= 1\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2693, "completion_tokens": 2440, "total_tokens": 5133, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4acb9481908adbcf2f78dc6f63", "custom_id": "19-7", "response": {"status_code": 200, "request_id": "2a6fde661fe63d4c7233465575b404b2", "body": {"id": "chatcmpl-CZRK9S8AHnXUmZtuwA2gVGWTyIO4z", "object": "chat.completion", "created": 1762562549, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with at most one detection (ndet <= 1), first detection between 2021-03-01 and 2021-04-01,\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Note: We interpret \"between March 1st and April 1st\" as [59274.0, 59305.0), excluding April 1st itself.\nWITH asteroid_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Return the corresponding class_name and highest probability for display */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.ndet <= 1\n  AND o.oid IN (SELECT oid FROM asteroid_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2765, "completion_tokens": 2445, "total_tokens": 5210, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ac7c88190a12593b557a010de", "custom_id": "19-8", "response": {"status_code": 200, "request_id": "454869fc0252acfd9d8f822c9f033fed", "body": {"id": "chatcmpl-CZRANoYTksk0OqhMPZeEMYqKNWTi0", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0)\n-- With at most one detection (ndet <= 1)\n-- Classified as 'asteroid' by the stamp classifier with probability > 0.7\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    (\n        SELECT p2.class_name\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'stamp_classifier'\n          AND p2.class_name = 'asteroid'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'stamp_classifier'\n          AND p2.class_name = 'asteroid'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    )\n    AND o.firstmjd >= 59274.0\n    AND o.firstmjd <= 59305.0\n    AND o.ndet <= 1;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2693, "completion_tokens": 2259, "total_tokens": 4952, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1920, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ad6308190a58fa17ac36d706d", "custom_id": "19-9", "response": {"status_code": 200, "request_id": "b8c3220c1ac500c695d38deecaa1c817", "body": {"id": "chatcmpl-CZRANA0m8PAbupqGenTHaMB9LQGfC", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF objects that:\n--  - first appeared between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0) using firstmjd)\n--  - have at most one detection (ndet <= 1)\n--  - are classified as 'asteroid' by the stamp classifier with probability > 0.7\n-- Columns returned: oid, meanra, meandec, ndet, firstmjd, class_name, probability\n\nWITH candidate_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd >= 59274.0\n      AND o.firstmjd < 59305.0\n      AND o.ndet <= 1\n)\nSELECT\n    p.oid,\n    (SELECT o.meanra  FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet    FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.oid IN (SELECT oid FROM candidate_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2693, "completion_tokens": 2575, "total_tokens": 5268, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4b8b40819084a93b54840cac94", "custom_id": "14-5", "response": {"status_code": 200, "request_id": "1d33b92eeffa6e9a928f8f03d47b321c", "body": {"id": "chatcmpl-CZRANSqVLF1UdyQHtfpYQVA6lLNYP", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return detections for the given OIDs with drb > 0.5 and either sgscore1 < 0.5 or distpsnr1 < 1 arcsec\n-- Note: magpsf (magnitude) and sigmapsf (magnitude error) are used\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p\n      WHERE p.oid = d.oid\n        AND p.candid = d.candid\n        AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4150, "completion_tokens": 2947, "total_tokens": 7097, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4b915081909fa3040c7c0704fe", "custom_id": "14-6", "response": {"status_code": 200, "request_id": "8bbd21714b2333a93b6e2ef3c4af48e7", "body": {"id": "chatcmpl-CZRANmQWZH3PxBviZv9RMuWn5oo80", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,                         -- unique object identifier\n    d.candid,                      -- candidate identifier\n    d.fid,                         -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,                         -- modified julian date\n    d.magpsf AS magnitude,         -- using PSF difference magnitude\n    d.sigmapsf AS magnitude_error, -- corresponding magnitude error\n    d.has_stamp,                   -- whether the candidate has an associated image stamp\n    d.drb,                         -- deep learning real bogus score\n    (SELECT p.sgscore1\n       FROM ps1_ztf p\n      WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,     -- star/galaxy score of nearest PS1 source\n    (SELECT p.distpsnr1\n       FROM ps1_ztf p\n      WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1     -- distance to nearest PS1 source [arcsec]\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  -- enforce drb > 0.5 via a nested EXISTS to avoid direct non-oid filtering on detection\n  AND EXISTS (\n        SELECT 1\n          FROM detection dx\n         WHERE dx.oid = d.oid\n           AND dx.candid = d.candid\n           AND dx.drb > 0.5\n      )\n  -- require either sgscore1 < 0.5 or distpsnr1 < 1 arcsec in the matching PS1 association\n  AND EXISTS (\n        SELECT 1\n          FROM ps1_ztf p\n         WHERE p.oid = d.oid\n           AND p.candid = d.candid\n           AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n      );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3353, "completion_tokens": 2887, "total_tokens": 6240, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2368, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4b9bc88190981e20467388692d", "custom_id": "14-7", "response": {"status_code": 200, "request_id": "95a5245c46d1366621ccf27d895958ba", "body": {"id": "chatcmpl-CZRANq570cQQaZd6aascMaV9XNXVH", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return detection-level info for specific OIDs, with DRB > 0.5 and PS1 constraints:\n   - magnitude and error use magpsf_corr and sigmapsf_corr from detection\n   - PS1 constraints and outputs use sgscore1 and distpsnr1 from ps1_ztf\n   - Avoid explicit JOINs by using scalar subqueries and EXISTS\n*/\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    d.has_stamp,\n    d.drb,\n    /* PS1 nearest-object star/galaxy score and distance for this (oid, candid) */\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p\n      WHERE p.oid = d.oid\n        AND p.candid = d.candid\n        AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3353, "completion_tokens": 3694, "total_tokens": 7047, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4b9abc81908846ddc4d378c057", "custom_id": "14-8", "response": {"status_code": 200, "request_id": "2729340a56a6073102d4a1ee016a1483", "body": {"id": "chatcmpl-CZRCFWorUeL8BX7dEL2ZvZpyPp31O", "object": "chat.completion", "created": 1762562059, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH requested_oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n),\n/* Preselect PS1 matches for the requested oids that satisfy the sgscore/dist conditions */\nps AS (\n    SELECT p.oid, p.candid, p.sgscore1, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM requested_oids)\n      AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1.0)\n),\n/* Preselect detections for the requested oids with drb > 0.5 */\ndet AS (\n    SELECT *\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM requested_oids)\n      AND d.drb > 0.5\n)\nSELECT\n    d.oid,                       -- unique object identifier\n    d.candid,                    -- candidate identifier\n    d.fid,                       -- filter identifier\n    d.mjd,                       -- modified julian date\n    d.magpsf,                    -- magnitude\n    d.sigmapsf,                  -- magnitude error\n    d.has_stamp,                 -- whether the object has stamps\n    d.drb,                       -- deep learning real bogus score\n    (SELECT ps.sgscore1\n     FROM ps\n     WHERE ps.oid = d.oid AND ps.candid = d.candid) AS sgscore1,   -- star galaxy score of the nearest PS1 object\n    (SELECT ps.distpsnr1\n     FROM ps\n     WHERE ps.oid = d.oid AND ps.candid = d.candid) AS distpsnr1   -- distance to nearest PS1 source [arcsec]\nFROM det d\nWHERE EXISTS (\n    SELECT 1\n    FROM ps\n    WHERE ps.oid = d.oid AND ps.candid = d.candid\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3353, "completion_tokens": 2858, "total_tokens": 6211, "prompt_tokens_details": {"cached_tokens": 3328, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2368, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4b9b44819094a64d6dcdea8e49", "custom_id": "14-9", "response": {"status_code": 200, "request_id": "f3bb253863a9cf624142f27aff38e9fb", "body": {"id": "chatcmpl-CZRCMJKuHYQ3cdDY0FTgMF1xM6BsW", "object": "chat.completion", "created": 1762562066, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return detections for the given OIDs with drb > 0.5 and either sgscore1 < 0.5 or distpsnr1 < 1 arcsec.\n   - magpsf and sigmapsf are used as the magnitude and magnitude error, respectively.\n   - sgscore1 and distpsnr1 are taken from ps1_ztf for the same (oid, candid). */\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,        -- magnitude\n    d.sigmapsf,      -- magnitude error\n    d.has_stamp,\n    d.drb,           -- deep learning real-bogus score\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n    )\nORDER BY d.oid, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4334, "completion_tokens": 2682, "total_tokens": 7016, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4bb54481908f4ccfe2e677531e", "custom_id": "30-6", "response": {"status_code": 200, "request_id": "742b416af2cdeb09cb97b4ba9bcf6339", "body": {"id": "chatcmpl-CZRCkYsuEiO8CgkAuPRtAch2kebbu", "object": "chat.completion", "created": 1762562090, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Predicted (top-ranked) class for each object from the Light Curve classifier\nSELECT p.oid, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (\n      -- Obtain the set of OIDs first (per guidelines), restricted to the lc_classifier\n      SELECT DISTINCT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2119, "completion_tokens": 1453, "total_tokens": 3572, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4bc7208190b25c29e3461ea668", "custom_id": "30-7", "response": {"status_code": 200, "request_id": "a55b127464578c3c4fc88c6eba5e0347", "body": {"id": "chatcmpl-CZRDQFiQYe71u68zYND68CLBV4vK1", "object": "chat.completion", "created": 1762562132, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Predicted class per object using the Light Curve classifier (lc_classifier)\n-- Ranking=1 selects the most probable class per object (and classifier version).\nWITH top_ranked_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n)\nSELECT p.oid, p.class_name, p.probability\nFROM probability AS p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM top_ranked_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2119, "completion_tokens": 1983, "total_tokens": 4102, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1856, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4bc0d88190bef4941f3ac00b66", "custom_id": "30-8", "response": {"status_code": 200, "request_id": "fec40a7593736973c31c7f29f87d0345", "body": {"id": "chatcmpl-CZRDUAfYn8v13MY3voFzBCowOhkjG", "object": "chat.completion", "created": 1762562136, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Predicted class per object from the Light Curve classifier (lc_classifier)\n-- Uses ranking=1 (most probable per classifier version) and, if multiple versions exist,\n-- keeps the row with the highest probability per oid.\nWITH lc_rank1 AS (\n    SELECT oid, class_name, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n)\nSELECT DISTINCT ON (oid) oid, class_name, probability\nFROM lc_rank1\nORDER BY oid, probability DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2119, "completion_tokens": 2419, "total_tokens": 4538, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4bc83c8190befd1b2e469a9aad", "custom_id": "30-9", "response": {"status_code": 200, "request_id": "e8fb3af02556a2a846bf578f6370d34b", "body": {"id": "chatcmpl-CZRDoN5Pb53OViRJUftdtiCPlZRwA", "object": "chat.completion", "created": 1762562156, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Top predicted class per object using the Light Curve Classifier\n-- If multiple classifier versions exist for an object, this selects the highest classifier_version string (descending) and returns its rank-1 class.\nSELECT p.oid, p.class_name, p.probability\nFROM (\n    SELECT\n        oid,\n        class_name,\n        probability,\n        classifier_version,\n        ROW_NUMBER() OVER (PARTITION BY oid ORDER BY classifier_version DESC) AS rn\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n) AS p\nWHERE p.rn = 1;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2119, "completion_tokens": 1478, "total_tokens": 3597, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4c8404819095815f3c2adf9b64", "custom_id": "22-5", "response": {"status_code": 200, "request_id": "c6d1b0b4b280fd1cc0b3cd1836c41edd", "body": {"id": "chatcmpl-CZRE14WBze4p1pCKSr5sOxWvbn9VO", "object": "chat.completion", "created": 1762562169, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects first detected between 2018-06-01 (MJD 58239.0) and 2018-07-01 (MJD 58270.0), inclusive\n-- Restricted to objects that have probabilities from the Light Curve Classifier (lc_classifier)\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 58239.0 AND 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  )\nORDER BY firstmjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2578, "completion_tokens": 1462, "total_tokens": 4040, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4c86848190bd86d04244abbc17", "custom_id": "22-6", "response": {"status_code": 200, "request_id": "99a8a5d56ccb4dd7bf85195f7fd32e65", "body": {"id": "chatcmpl-CZREjQMoXn9UNrLE7bIIDTprRSjYg", "object": "chat.completion", "created": 1762562213, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects first detected between 2018-06-01 (MJD 58239.0, inclusive) and 2018-07-01 (MJD 58270.0, exclusive)\n-- and that have a Light Curve Classifier ('lc_classifier') probability entry.\n-- Note: If you only want objects with the top-ranked class, add \"AND ranking = 1\" in the subquery.\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2578, "completion_tokens": 1042, "total_tokens": 3620, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ca50c8190b538f7948605b498", "custom_id": "22-7", "response": {"status_code": 200, "request_id": "87e3b34cbc654734b3354ab9de93f817", "body": {"id": "chatcmpl-CZREv50kx4CUHqZZrBB7xmefHSmez", "object": "chat.completion", "created": 1762562225, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects first detected between 2018-06-01 (MJD 58239.0) inclusive and 2018-07-01 (MJD 58270.0) exclusive\n-- and that have been classified by the Light Curve classifier ('lc_classifier').\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2578, "completion_tokens": 1525, "total_tokens": 4103, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4c8be481909543c583268345d3", "custom_id": "22-8", "response": {"status_code": 200, "request_id": "2ef5647e8c10ca49e44d8b4b0c001894", "body": {"id": "chatcmpl-CZREv2e1dGKGdLB8iXjI5Uq03krH9", "object": "chat.completion", "created": 1762562225, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects first detected (firstmjd) between 2018-06-01 (MJD 58239.0) inclusive and 2018-07-01 (MJD 58270.0) exclusive\n-- and that have been classified by the Light Curve classifier (classifier_name = 'lc_classifier').\n-- Using a subquery to obtain OIDs from the probability table as recommended, and avoiding JOINs.\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2578, "completion_tokens": 1171, "total_tokens": 3749, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4c8c888190809005e97a6654d1", "custom_id": "22-9", "response": {"status_code": 200, "request_id": "7c7444048a5f485683ce1dc0d3359899", "body": {"id": "chatcmpl-CZRF56w2KXiFCp5HXTEduVDEntODR", "object": "chat.completion", "created": 1762562235, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects first detected in [2018-06-01, 2018-07-01) by the Light Curve Classifier\n-- Using MJD boundaries: start = 58239.0 (inclusive), end = 58270.0 (exclusive)\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1  -- ensure object has a top-ranked lc_classifier classification\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2578, "completion_tokens": 1355, "total_tokens": 3933, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4c9f108190b84a92101f90f4ca", "custom_id": "12-5", "response": {"status_code": 200, "request_id": "18e7300ee746fc51d18b8c498b6efe6d", "body": {"id": "chatcmpl-CZRFALv1KBIHBafaZ4G7eiNoqUUiy", "object": "chat.completion", "created": 1762562240, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- SNe between Feb 13 (MJD 59988.0) and Sep 10 (MJD 60197.0)\n-- Using lc_classifier with ranking=1 to select Supernova subclasses: SNIa, SNIbc, SNII, SLSN\n-- Spatial filter via q3c_poly_query within the provided polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2668, "completion_tokens": 1714, "total_tokens": 4382, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ca8c48190882496c90024e656", "custom_id": "12-6", "response": {"status_code": 200, "request_id": "24d9a4e140bda98e443f20fed14d9a51", "body": {"id": "chatcmpl-CZRFmpg9eGABaHcYGwtioRLwOgYDG", "object": "chat.completion", "created": 1762562278, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- SNe = all supernova subclasses in the lc_classifier: SNIa, SNIbc, SNII, SLSN\n-- \"first occurred\" interpreted as firstmjd; inclusive range: 2023-02-13 (59988.0) to 2023-09-10 (60197.0)\n-- Spatial filter uses Q3C polygon query on meanra, meandec\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2668, "completion_tokens": 1657, "total_tokens": 4325, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4cbf688190bd4692aa0d4bcdf9", "custom_id": "12-7", "response": {"status_code": 200, "request_id": "4a7b16ea1e00467effadf6e4b9f06418", "body": {"id": "chatcmpl-CZRFw43QKHE2pCHl3SmdWxWQlEVit", "object": "chat.completion", "created": 1762562288, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- SNe classified by the Light Curve classifier (top-ranked): SNIa, SNIbc, SNII, SLSN\n-- First detection between MJD 59988.0 (Feb 13) and 60197.0 (Sep 10)\n-- Spatial filter: within the provided polygon using Q3C\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2668, "completion_tokens": 1837, "total_tokens": 4505, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4cb79c8190a256071e8dfa3b97", "custom_id": "12-8", "response": {"status_code": 200, "request_id": "0ea813fbc45dada05d603b2f13f60db6", "body": {"id": "chatcmpl-CZRANTLkhg3a5Ox5ISJtxeGGhH2N1", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return OIDs and mean coordinates for objects classified as SNe (top-ranked lc_classifier class in {SNIa,SNIbc,SNII,SLSN}),\n-- with first detection between MJD 59988.0 (Feb 13) and 60197.0 (Sep 10),\n-- and located within the specified polygon.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2668, "completion_tokens": 2031, "total_tokens": 4699, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4cba80819088a56f2691b258b0", "custom_id": "12-9", "response": {"status_code": 200, "request_id": "3383713516c17d99bd48c33035e7d1b1", "body": {"id": "chatcmpl-CZRANKkkt6w0PXzBktpNj8PGBYjA5", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- SNe (all types) from the Light Curve Classifier with top-ranked SN subclass\n-- Time window: firstmjd between 2023-02-13 (MJD 59988.0) and 2023-09-10 (MJD 60197.0)\n-- Spatial filter: inside the polygon given\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND o.oid IN (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2668, "completion_tokens": 1705, "total_tokens": 4373, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4d78ac8190982a5279759d9182", "custom_id": "57-5", "response": {"status_code": 200, "request_id": "8795f9d04fb066fad977a6c6f1cb50e7", "body": {"id": "chatcmpl-CZRANGdEp2tThnsvQGaanI4lzdKhZ", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find ZTF objects within 30\" of id_1 (354.67, 15.954) or 20\" of id_2 (20.7993, 1.00331)\n-- Radii converted to degrees: 30\" = 30/3600 deg, 20\" = 20/3600 deg\nSELECT\n  t.identifier AS input_identifier,\n  t.input_ra AS input_ra_deg,\n  t.input_dec AS input_dec_deg,\n  t.radius_deg AS search_radius_deg,\n  t.oid,\n  t.ndet,\n  t.meanra,\n  t.meandec,\n  t.firstmjd\nFROM (\n  SELECT\n    'id_1'::text AS identifier,\n    354.67::double precision AS input_ra,\n    15.954::double precision AS input_dec,\n    (30.0/3600.0)::double precision AS radius_deg,\n    o.*\n  FROM object o\n  WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n\n  UNION ALL\n\n  SELECT\n    'id_2'::text AS identifier,\n    20.7993::double precision AS input_ra,\n    1.00331::double precision AS input_dec,\n    (20.0/3600.0)::double precision AS radius_deg,\n    o.*\n  FROM object o\n  WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0)\n) AS t\nORDER BY t.lastmjd DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2478, "completion_tokens": 2606, "total_tokens": 5084, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4d79388190bd4b2699bddae405", "custom_id": "57-6", "response": {"status_code": 200, "request_id": "20f7e227c2e652e12e265b4955cce89b", "body": {"id": "chatcmpl-CZRANQkY8vJCxl74WA4JXm0dlkAIe", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Cone search around two input sources using Q3C, returning input metadata and matching ZTF object info\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        -- radii converted from arcseconds to degrees\n        ('id_1', 354.67,   15.954,   30.0/3600.0),  -- 30\"\n        ('id_2',  20.7993,  1.00331, 20.0/3600.0)   -- 20\"\n)\nSELECT\n    -- input (catalog) info\n    c.identifier,\n    c.ra,\n    c.dec,\n    c.radius_deg,\n    -- matched ZTF object info\n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c,\nLATERAL (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM object o\n    -- q3c_radial_query(ra, dec, center_ra, center_dec, radius_deg)\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\n) o\nORDER BY o.lastmjd DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2478, "completion_tokens": 2731, "total_tokens": 5209, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2432, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4dfc788190a1ae321612013569", "custom_id": "57-7", "response": {"status_code": 200, "request_id": "642cd47c746f4f7ca76fde8e56a1e9d2", "body": {"id": "chatcmpl-CZRANcWOy8bbr993BKWwUky9zcx96", "object": "chat.completion", "created": 1762561943, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog (source_id, ra, dec, radius_deg) AS (\n    -- radii given in arcseconds converted to degrees: 30\"/3600 = 0.008333..., 20\"/3600 = 0.005555...\n    VALUES\n        ('id_1', 354.67, 15.954, 30.0/3600.0),\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0)\n),\nmatched AS (\n    -- gather matched objects together with the input (catalog) row that matched them\n    SELECT\n        c.source_id,\n        c.ra,\n        c.dec,\n        c.radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM catalog c, object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\n)\nSELECT\n    -- input object info\n    source_id,\n    ra,\n    dec,\n    radius_deg,\n    -- matched ZTF object info\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM matched\nORDER BY lastmjd DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2478, "completion_tokens": 2721, "total_tokens": 5199, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2432, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4d9b688190b4f049781fbb873b", "custom_id": "57-8", "response": {"status_code": 200, "request_id": "70f83dc68b1445bad883c588146d4c39", "body": {"id": "chatcmpl-CZRBxJuX60QB8CYRbQiSEgtzmjmcx", "object": "chat.completion", "created": 1762562041, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Cone search around two input positions using Q3C, radii converted from arcsec to degrees\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67::double precision, 15.954::double precision, (30.0/3600.0)::double precision),  -- 30 arcsec\n        ('id_2', 20.7993::double precision, 1.00331::double precision, (20.0/3600.0)::double precision) -- 20 arcsec\n)\nSELECT\n    c.identifier,          -- input identifier\n    c.ra,                  -- input RA (deg)\n    c.dec,                 -- input Dec (deg)\n    c.radius_deg,          -- input search radius (deg)\n    o.oid,                 -- ZTF identifier\n    o.ndet,                -- number of detections\n    o.meanra,              -- mean RA (deg)\n    o.meandec,             -- mean Dec (deg)\n    o.firstmjd             -- first detection MJD\nFROM catalog c\nJOIN object o\n  ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY o.lastmjd DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2478, "completion_tokens": 2778, "total_tokens": 5256, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4d8c7c8190a0bd299e5252b115", "custom_id": "57-9", "response": {"status_code": 200, "request_id": "667887129a42983487dc8489b6ca1444", "body": {"id": "chatcmpl-CZRCBbdee3fMgVswc4dZ7Rk1EYxJf", "object": "chat.completion", "created": 1762562055, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Cone-search around two input sources using Q3C and return matching ZTF objects with requested columns.\n   - 30 arcsec = 30/3600 deg\n   - 20 arcsec = 20/3600 deg\n*/\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67,   15.954,  30.0/3600.0),\n        ('id_2',  20.7993,  1.00331, 20.0/3600.0)\n)\nSELECT\n    c.identifier AS input_identifier,\n    c.ra AS input_ra_deg,\n    c.dec AS input_dec_deg,\n    c.radius_deg AS input_radius_deg,\n    o.oid AS ztf_oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c, object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY o.lastmjd DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2478, "completion_tokens": 3442, "total_tokens": 5920, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3200, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4d9310819085857f3625a48a4a", "custom_id": "75-5", "response": {"status_code": 200, "request_id": "f861b2cc6fe2a77eeb51b46ee6bf34e6", "body": {"id": "chatcmpl-CZRCi7DuuX2esr2JHJYK4bXFs0ROH", "object": "chat.completion", "created": 1762562088, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return up to 100 rows with a known (non-null and not literal 'null') nearest Solar System object\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND lower(ssnamenr) <> 'null'\nLIMIT 100;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 448, "total_tokens": 2487, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 384, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4d94988190b4ceb6dc1106805f", "custom_id": "75-6", "response": {"status_code": 200, "request_id": "8e2345b6307c19799abfdaec0eec9e7d", "body": {"id": "chatcmpl-CZRCjuY1eckIlpUe4sKvb0hT0jAdp", "object": "chat.completion", "created": 1762562089, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return up to 100 rows with a known (non-null and not the literal 'null') nearest Solar System object name\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 512, "total_tokens": 2551, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 448, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4da5108190804663aac926bb35", "custom_id": "75-7", "response": {"status_code": 200, "request_id": "b32c504f3570112df1f00cdab3da711b", "body": {"id": "chatcmpl-CZRCjdyblbNmkyBpaMsFIJN3nfUra", "object": "chat.completion", "created": 1762562089, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return up to 100 rows where the nearest Solar System object name is present\n-- Excludes both actual NULLs and the literal string 'null' sometimes used in this column\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr NOT ILIKE 'null'\nLIMIT 100;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 653, "total_tokens": 2692, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4df9108190862d6ba748b15fb8", "custom_id": "75-8", "response": {"status_code": 200, "request_id": "a3d686d227bd456cde67d2e2f840c2f9", "body": {"id": "chatcmpl-CZRDChmu2xU3XtDCfSLOhAkCcCRL2", "object": "chat.completion", "created": 1762562118, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get up to 100 rows with a known nearest Solar System object (exclude NULL and the literal 'null')\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND lower(ssnamenr) <> 'null'\nLIMIT 100;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 831, "total_tokens": 2870, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4e0d5881908f4e806d39d4937b", "custom_id": "75-9", "response": {"status_code": 200, "request_id": "ff81c048b47e134735c6676d9dd003d1", "body": {"id": "chatcmpl-CZRDC5kB4DEXYHo8XGIPdyw95u2GJ", "object": "chat.completion", "created": 1762562118, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return at most 100 rows from ss_ztf where the nearest Solar System object is known\n-- Note: Some rows may store the unknown state as the literal string 'null', so exclude that as well.\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 914, "total_tokens": 2953, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4eb7948190b8a9ee56aacedcfa", "custom_id": "43-5", "response": {"status_code": 200, "request_id": "bf316938f6282050622a80bcf9150c7a", "body": {"id": "chatcmpl-CZRDHVw6h7XTZsWyu9paqxYl12wjM", "object": "chat.completion", "created": 1762562123, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- r-band (fid=2) epochs in dataquality for the specified ZTF objects\nWITH targets(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,      -- ZTF identifier\n    dq.candid,   -- candidate identifier\n    dq.xpos,     -- x-image position [pixels]\n    dq.ypos,     -- y-image position [pixels]\n    dq.scorr     -- peak-pixel signal-to-noise ratio\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM targets)\nORDER BY dq.oid, dq.candid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3193, "completion_tokens": 1054, "total_tokens": 4247, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ebab881909fb0c30a4dfd916e", "custom_id": "43-6", "response": {"status_code": 200, "request_id": "bbf03f9b842f55cb5b27b0d6fd3662b9", "body": {"id": "chatcmpl-CZRDQaAbM2hRh1G3q3ky54IGHbsny", "object": "chat.completion", "created": 1762562132, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- r-band epochs for two specified ZTF objects from dataquality\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,       -- ZTF identifier\n    dq.candid,    -- candidate identifier\n    dq.xpos,      -- x-image position [pixels]\n    dq.ypos,      -- y-image position [pixels]\n    dq.scorr      -- peak-pixel S/N in matched-filtered detection image\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.fid = 2  -- r-band\nORDER BY dq.oid, dq.candid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 932, "total_tokens": 3643, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ec5248190a009d904e30dad2e", "custom_id": "43-7", "response": {"status_code": 200, "request_id": "f69ab2690b2219cda95ed6dfa8271657", "body": {"id": "chatcmpl-CZRDypvV5A5DajZSb0Poy4b3jaO0l", "object": "chat.completion", "created": 1762562166, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- r-band corresponds to fid = 2; return object (oid), candidate (candid), image positions, and peak-pixel S/N\nSELECT\n  oid,\n  candid,\n  xpos,\n  ypos,\n  scorr\nFROM dataquality\nWHERE fid = 2\n  AND oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\nORDER BY oid, candid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 543, "total_tokens": 3254, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 448, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ebd1c81909abf2e2d938f34cd", "custom_id": "43-8", "response": {"status_code": 200, "request_id": "0616eebfe7cdaed470e376fc9c4d450c", "body": {"id": "chatcmpl-CZRE1yh0MWLm0ZvKBLrI7JgXqQ3vE", "object": "chat.completion", "created": 1762562169, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find r-band (fid=2) epochs in dataquality for two specified ZTF objects\nWITH targets(oid) AS (\n    VALUES \n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,          -- ZTF identifier\n    dq.candid,       -- candidate identifier\n    dq.xpos,         -- x-image position [pixels]\n    dq.ypos,         -- y-image position [pixels]\n    dq.scorr         -- peak-pixel S/N\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM targets)\nORDER BY dq.oid, dq.candid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 796, "total_tokens": 3507, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4edae88190b9bb1c05b28e6b14", "custom_id": "43-9", "response": {"status_code": 200, "request_id": "7d8d4bdbc9dd84575b1b6afe94abd5b8", "body": {"id": "chatcmpl-CZREAUKRYnIBUz3aMZJtHGBdIsFlE", "object": "chat.completion", "created": 1762562178, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- r-band epochs for specified ZTF objects from dataquality\n-- fid = 2 corresponds to r-band; scorr is the peak-pixel signal-to-noise ratio\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF20acwrybw'),\n    ('ZTF22abugigx')\n)\nSELECT\n  dq.oid,        -- ZTF identifier\n  dq.candid,     -- candidate identifier (epoch)\n  dq.xpos,       -- x-image position [pixels]\n  dq.ypos,       -- y-image position [pixels]\n  dq.scorr       -- peak-pixel S/N\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.fid = 2\nORDER BY dq.oid, dq.candid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 946, "total_tokens": 3657, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ee2748190ad3ec99941d522ed", "custom_id": "89-5", "response": {"status_code": 200, "request_id": "9954583c974d9a0aacf0695502b3a4f3", "body": {"id": "chatcmpl-CZREL7kwgQb4GCZQWxeu2zK1TtorT", "object": "chat.completion", "created": 1762562189, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all dataquality rows for up to 50 objects with stamp-classifier SN probability > 0.7\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (\n    -- Pick at most 50 distinct OIDs with highest SN probabilities (stamp_classifier)\n    SELECT t.oid\n    FROM (\n        SELECT p.oid, MAX(p.probability) AS max_prob\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'  -- use Stamp Classifier as requested\n          AND p.class_name = 'SN'                      -- 'SN' corresponds to supernovae in stamp_classifier\n          AND p.probability > 0.7\n        GROUP BY p.oid\n        ORDER BY max_prob DESC\n        LIMIT 50\n    ) AS t\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2874, "completion_tokens": 1903, "total_tokens": 4777, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ed1d08190858074a2d12f98b2", "custom_id": "89-6", "response": {"status_code": 200, "request_id": "6b8d9b393e2f3d524b05af3b74eda276", "body": {"id": "chatcmpl-CZRES29xDWuwCnlQZl1iXocyDlZrG", "object": "chat.completion", "created": 1762562196, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all dataquality rows for up to 50 objects whose stamp classifier assigns SN probability > 0.7\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    -- Subquery: obtain up to 50 OIDs with highest SN probability from the stamp classifier\n    SELECT oid\n    FROM (\n        SELECT oid, MAX(probability) AS max_p\n        FROM probability\n        WHERE classifier_name = 'stamp_classifier'\n          AND class_name = 'SN'\n          AND probability > 0.7\n        GROUP BY oid\n    ) t\n    ORDER BY max_p DESC\n    LIMIT 50\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2874, "completion_tokens": 1799, "total_tokens": 4673, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1664, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ef48c8190acb75179db72881c", "custom_id": "89-7", "response": {"status_code": 200, "request_id": "cf478e94fff985dd5bc9bf27a8bb5e05", "body": {"id": "chatcmpl-CZREjrTEVlaDdXtNxVvFQx848e3MG", "object": "chat.completion", "created": 1762562213, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return all columns from dataquality for up to 50 objects with P(SN | stamp_classifier) > 0.7 */\nSELECT dq.*\nFROM dataquality AS dq\nWHERE dq.oid IN (\n    /* Get at most 50 distinct OIDs meeting the probability criterion (highest max probability first) */\n    SELECT t.oid\n    FROM (\n        SELECT p.oid, MAX(p.probability) AS max_prob\n        FROM probability AS p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'SN'\n          AND p.probability > 0.7\n        GROUP BY p.oid\n        ORDER BY max_prob DESC\n        LIMIT 50\n    ) AS t\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2919, "completion_tokens": 2785, "total_tokens": 5704, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2624, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ef8ec819092f3b6f73c8757a1", "custom_id": "89-8", "response": {"status_code": 200, "request_id": "c19b4bb78094ff16d0244997ab9f179a", "body": {"id": "chatcmpl-CZRAO27vEhpONhRMLOwTE3HXkRMzq", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all dataquality rows for up to 50 objects whose stamp classifier assigns SN probability > 0.7\nWITH top_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n    GROUP BY oid\n    ORDER BY MAX(probability) DESC\n    LIMIT 50\n)\nSELECT *\nFROM dataquality\nWHERE oid IN (SELECT oid FROM top_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2874, "completion_tokens": 1774, "total_tokens": 4648, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1664, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4eff308190a39efec27fd14b8a", "custom_id": "89-9", "response": {"status_code": 200, "request_id": "35baa0d2b321e0152606842aa619c5e5", "body": {"id": "chatcmpl-CZRAOqMxkUi1DdGS61kUv7a5GpVAj", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find up to 50 distinct objects (OIDs) whose stamp classifier assigns SN class with probability > 0.7.\n   If multiple classifier versions exist per object, keep the highest probability per OID.\n   Then return all rows from dataquality for those OIDs (may include many detections per object). */\nWITH top_oids AS (\n    SELECT oid\n    FROM (\n        SELECT oid, MAX(probability) AS max_prob\n        FROM probability\n        WHERE classifier_name = 'stamp_classifier'\n          AND class_name = 'SN'\n          AND probability > 0.7\n        GROUP BY oid\n    ) p\n    ORDER BY max_prob DESC\n    LIMIT 50\n)\nSELECT *\nFROM dataquality\nWHERE oid IN (SELECT oid FROM top_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2919, "completion_tokens": 2089, "total_tokens": 5008, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1920, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4faaa481909bd2d4a84924c787", "custom_id": "72-5", "response": {"status_code": 200, "request_id": "9a26de28ab73f3d726a0dc49f98a1f02", "body": {"id": "chatcmpl-CZRAOar5VVHrKyRD0zRDRcwGcYASv", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the specified object and reference identifier\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2248, "completion_tokens": 1007, "total_tokens": 3255, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4fab88819081b3ee397ed00a28", "custom_id": "72-6", "response": {"status_code": 200, "request_id": "37f192eacbb6420e502d58eebbc1a8a5", "body": {"id": "chatcmpl-CZRAOCnYSJLliB3WiRtLumNnBc9LA", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the specified object and reference identifier\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2248, "completion_tokens": 623, "total_tokens": 2871, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4fb91c8190a1c6b386a3273dad", "custom_id": "72-7", "response": {"status_code": 200, "request_id": "088b3aaec89e17fca92e2101425b19e2", "body": {"id": "chatcmpl-CZRAOLC4KfzYIyOjJwVzf2E3gLBR8", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Retrieve all columns from reference for the specified object and reference ID\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2730, "completion_tokens": 561, "total_tokens": 3291, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4fb14881908fcc522ed5f924c0", "custom_id": "72-8", "response": {"status_code": 200, "request_id": "7993552f066511e04530e0acb7ca2e85", "body": {"id": "chatcmpl-CZRAvxWDZngWImjUG5xuXYzeF2J4k", "object": "chat.completion", "created": 1762561977, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns from the 'reference' table for the ZTF object 'ZTF20actnuls' and reference identifier '712120223'\n-- Per guidance, obtain the OID via a nested subquery from the 'object' table and avoid explicit JOINs\nSELECT *\nFROM reference\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20actnuls'\n)\nAND referenceid::text = '712120223';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1882, "completion_tokens": 1322, "total_tokens": 3204, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4fc5588190a51f0d588dd3c7d2", "custom_id": "72-9", "response": {"status_code": 200, "request_id": "38e9e7b6a0c788f099b87a6dcd0d65df", "body": {"id": "chatcmpl-CZRB45GtUM8OokpqLHk9RR1CdEVf0", "object": "chat.completion", "created": 1762561986, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Retrieve all columns for ZTF object 'ZTF20actnuls' and reference identifier 712120223\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2248, "completion_tokens": 763, "total_tokens": 3011, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4fc9448190a76717c62966d599", "custom_id": "103-5", "response": {"status_code": 200, "request_id": "5584dec106daa10cac3fe5be06a77a5e", "body": {"id": "chatcmpl-CZRBRVsh4dWvIoSZJSAoIsTB7051X", "object": "chat.completion", "created": 1762562009, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3363, "completion_tokens": 4000, "total_tokens": 7363, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4fee808190a4510d7b0a6e03e2", "custom_id": "103-6", "response": {"status_code": 200, "request_id": "8bff159a541572745be59e89e84f27e0", "body": {"id": "chatcmpl-CZRBkgghedea4hKBWhw7MbR4PH7W5", "object": "chat.completion", "created": 1762562028, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3408, "completion_tokens": 4000, "total_tokens": 7408, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4fe1648190a3f4f0259ddc0f3a", "custom_id": "103-7", "response": {"status_code": 200, "request_id": "106e0a6dd421961527b8b21c02ed9bdc", "body": {"id": "chatcmpl-CZRAOn45Fm91JdDxmwjPdMtoPdkq6", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3408, "completion_tokens": 4000, "total_tokens": 7408, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4fe54481908f1ad871ba69e35a", "custom_id": "103-8", "response": {"status_code": 200, "request_id": "6e3c0dc4c40448515c17f007b6c9cd48", "body": {"id": "chatcmpl-CZRBnkX0UcPskJf4f2w4FNegYBHjQ", "object": "chat.completion", "created": 1762562031, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3363, "completion_tokens": 4000, "total_tokens": 7363, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb4ff0288190a16d36186ba7c1fe", "custom_id": "103-9", "response": {"status_code": 200, "request_id": "1669b595d3538ccff119f36e201ce68e", "body": {"id": "chatcmpl-CZRAO2Ys2SPLyj8jfjhPdwuH9ELWq", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 200 objects with nearest PS1 source farther than 5 arcsec\n-- and with lc_classifier probability > 0.7 for any non-supernova class.\n-- Return all columns from object, probability, and ps1_ztf.\nWITH obj_ps AS (\n    -- Per object, compute the nearest PS1 distance (only considering > 5 arcsec)\n    SELECT ps.oid, MIN(ps.distpsnr1) AS min_dist\n    FROM ps1_ztf ps\n    WHERE ps.distpsnr1 > 5\n    GROUP BY ps.oid\n),\nobj_prob AS (\n    -- OIDs that have lc_classifier probability > 0.7 for any non-SN class\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND p.probability > 0.7\n),\ncandidate_oids AS (\n    -- Intersect the two conditions and keep at most 200 objects,\n    -- prioritizing those with the smallest (but > 5 arcsec) nearest PS1 distance\n    SELECT o.oid, o.min_dist\n    FROM obj_ps o\n    WHERE o.oid IN (SELECT oid FROM obj_prob)\n    ORDER BY o.min_dist ASC\n    LIMIT 200\n)\nSELECT obj.*, prob.*, ps1.*\nFROM object obj, probability prob, ps1_ztf ps1\nWHERE obj.oid IN (SELECT oid FROM candidate_oids)\n  AND prob.oid = obj.oid\n  AND ps1.oid = obj.oid\n  AND prob.classifier_name = 'lc_classifier'\n  AND prob.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND prob.probability > 0.7\n  AND ps1.distpsnr1 > 5\nORDER BY ps1.distpsnr1 ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3363, "completion_tokens": 3503, "total_tokens": 6866, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3072, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb509a988190b7ea3ff9d3ed362f", "custom_id": "54-5", "response": {"status_code": 200, "request_id": "4ff2ee6a6b975b0f68b378a02108ded5", "body": {"id": "chatcmpl-CZRC8cVjm0lyPTOVKkdIH2DIT67ep", "object": "chat.completion", "created": 1762562052, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find all non-detection epochs for the specified ZTF objects with 5-sigma limits fainter than 19.5 mag\n-- Note: \"fainter\" => larger magnitude, so diffmaglim > 19.5\n-- OIDs are obtained via a subquery from the object table as recommended\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2521, "completion_tokens": 636, "total_tokens": 3157, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb50a9008190831237afeed95aad", "custom_id": "54-6", "response": {"status_code": 200, "request_id": "8448590d97b0a4f3c1f281804bc784f8", "body": {"id": "chatcmpl-CZRAOvdfvURtSs4Lgor3raKeoQvGs", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find non-detection epochs with 5-sigma magnitude limit fainter than 19.5 (i.e., diffmaglim > 19.5)\n-- for the specified ZTF objects, returning all columns from non_detection.\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nSELECT nd.*\nFROM non_detection AS nd\nWHERE nd.oid IN (SELECT oid FROM selected_oids)\n  AND nd.diffmaglim > 19.5\nORDER BY nd.oid, nd.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2521, "completion_tokens": 841, "total_tokens": 3362, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb50a3648190a79e4ecb10816d1a", "custom_id": "54-7", "response": {"status_code": 200, "request_id": "0bb923a6da4bca082fb974046295d854", "body": {"id": "chatcmpl-CZRCGb8GklfTP2j9k2knkLO71yd7O", "object": "chat.completion", "created": 1762562060, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find all non-detection epochs for the specified ZTF objects with 5-sigma limits fainter (i.e., larger magnitude) than 19.5\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    -- Prioritize obtaining OIDs from the object table via a subquery\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2521, "completion_tokens": 621, "total_tokens": 3142, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb50ac988190be502f9394810aa1", "custom_id": "54-8", "response": {"status_code": 200, "request_id": "5a0c036cb57c574fab498625dd864e44", "body": {"id": "chatcmpl-CZRAOhVM80EyzzE4nI5qOqEqhiRGu", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all non-detection epochs for the specified ZTF objects\n-- Note: 'fainter' magnitudes correspond to larger numeric values, so we use diffmaglim > 19.5\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT *\nFROM non_detection\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND diffmaglim > 19.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 622, "total_tokens": 2661, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb50b01c81909224309a52c3e94d", "custom_id": "54-9", "response": {"status_code": 200, "request_id": "cd5a7fe53a04b9b6f1511be2d487a686", "body": {"id": "chatcmpl-CZRCiYUMBWeeMqwlZiFbuzmxArska", "object": "chat.completion", "created": 1762562088, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all non-detection epochs for the specified OIDs with 5-sigma limits fainter than 19.5 mag (i.e., diffmaglim > 19.5)\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT *\nFROM non_detection\nWHERE oid IN (SELECT oid FROM oids)\n  AND diffmaglim > 19.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 810, "total_tokens": 2849, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb50b6ac8190a6662b3eaabc2f2d", "custom_id": "99-5", "response": {"status_code": 200, "request_id": "e9948a9520e863b754525fc2e91f33b1", "body": {"id": "chatcmpl-CZRAOoP7pxNarQ7n4ShCIts0YvbPC", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all forced_photometry rows for at most 10 objects\n-- that have first detections after MJD 60310 and probability 1\n-- of being 'asteroid' in the 'stamp_classifier'.\n-- Objects are selected and ordered by firstmjd in a subquery (no JOINs),\n-- and the final result is ordered by the corresponding object's firstmjd.\nSELECT\n    *\nFROM\n    forced_photometry fp\nWHERE\n    fp.oid IN (\n        SELECT\n            o.oid\n        FROM\n            object o\n        WHERE\n            o.firstmjd > 60310\n            AND o.oid IN (\n                SELECT\n                    p.oid\n                FROM\n                    probability p\n                WHERE\n                    p.classifier_name = 'stamp_classifier'\n                    AND p.class_name = 'asteroid'\n                    AND p.probability = 1\n            )\n        ORDER BY\n            o.firstmjd\n        LIMIT 10\n    )\nORDER BY\n    (SELECT o2.firstmjd FROM object o2 WHERE o2.oid = fp.oid) ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3273, "completion_tokens": 2542, "total_tokens": 5815, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb50ecb08190861457f101a3fc12", "custom_id": "99-6", "response": {"status_code": 200, "request_id": "c64086ed3e7990638b5770fddb72e9f3", "body": {"id": "chatcmpl-CZRCwyYsbShc863BkFyy2UUBLxQ5e", "object": "chat.completion", "created": 1762562102, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all forced_photometry rows for at most 10 objects\n-- that have firstmjd > 60310 and probability=1 for 'asteroid' in the stamp classifier.\nWITH candidate_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM candidate_oids)\nORDER BY (\n    SELECT o.firstmjd\n    FROM object o\n    WHERE o.oid = fp.oid\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3273, "completion_tokens": 1534, "total_tokens": 4807, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb50e4f88190b2f97ce5c72ec871", "custom_id": "99-7", "response": {"status_code": 200, "request_id": "e2c9ed0089214e67563eaa05d1fb8eb4", "body": {"id": "chatcmpl-CZRB2OudTo32AgCQfoXjl1fryfsEV", "object": "chat.completion", "created": 1762561984, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 10 objects with first detection after MJD 60310 and probability 1.0 of being 'asteroid' in the stamp classifier,\n-- then return all forced_photometry rows for those objects, ordered by the objects' first detection date.\nWITH selected_oids AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n            AND p.ranking = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT so.oid FROM selected_oids so)\nORDER BY\n    (SELECT so.firstmjd FROM selected_oids so WHERE so.oid = fp.oid) ASC,\n    fp.oid,\n    fp.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3318, "completion_tokens": 1577, "total_tokens": 4895, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb50e4708190bd56a4972d72ba58", "custom_id": "99-8", "response": {"status_code": 200, "request_id": "a4b853fbbbe2e0170c4b30c405d7fa35", "body": {"id": "chatcmpl-CZRDLUDyejy8kI0JPQnANa1wjKg4m", "object": "chat.completion", "created": 1762562127, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all forced_photometry rows for up to 10 objects whose firstmjd > 60310\n-- and have probability=1 for class 'asteroid' in the 'stamp_classifier'.\n-- Objects are selected and limited in a subquery (CTE) and results are ordered by the object's firstmjd.\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC,\n    fp.mjd ASC,\n    fp.pid ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3318, "completion_tokens": 2019, "total_tokens": 5337, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb50e78881908354e6941233729c", "custom_id": "99-9", "response": {"status_code": 200, "request_id": "5cbc7f1a801a28ee280fedaac0a10dac", "body": {"id": "chatcmpl-CZRB2liGTBbCcgcL4lwgcu2KJCnyC", "object": "chat.completion", "created": 1762561984, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 10 objects with first detection later than MJD 60310\n-- and with probability 1 of being 'asteroid' in the 'stamp_classifier'\n-- Then return all forced_photometry rows for those objects,\n-- ordered by the object's first detection date (firstmjd)\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC,\n    fp.oid,\n    fp.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3273, "completion_tokens": 1566, "total_tokens": 4839, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb51b0c88190a4bf5ac585846a1f", "custom_id": "40-5", "response": {"status_code": 200, "request_id": "fe86a8ed7b679c2115eb8091888cae6e", "body": {"id": "chatcmpl-CZRDuutrgYyIncbdfLFpyaiUv8uLW", "object": "chat.completion", "created": 1762562162, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE cone search: 1 arcsec (1/3600 deg) around RA=23.6488, Dec=30.7314\nSELECT\n    oid_catalog,           -- ALLWISE identifier\n    ra,\n    dec,\n    w1mpro,                -- WISE W1 magnitude\n    w1sigmpro,             -- WISE W1 magnitude uncertainty\n    w2mpro,                -- WISE W2 magnitude\n    w2sigmpro,             -- WISE W2 magnitude uncertainty\n    j_m_2mass,             -- 2MASS J magnitude\n    j_msig_2mass           -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 1301, "total_tokens": 3925, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb518d1c819097d89d67fa23bc4f", "custom_id": "40-6", "response": {"status_code": 200, "request_id": "4fc84082a18f7df3e6e7dc79de1c8ede", "body": {"id": "chatcmpl-CZRCAn7zci28VyoAlOX59MSXzwN5A", "object": "chat.completion", "created": 1762562054, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE cone search: 1 arcsec = 1/3600 degrees\n-- Returns: ALLWISE identifier, coordinates, WISE W1/W2 magnitudes with uncertainties, and 2MASS J magnitude with uncertainty\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM allwise a\nWHERE q3c_radial_query(a.ra, a.dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(a.ra, a.dec, 23.6488, 30.7314) ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 1274, "total_tokens": 3898, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb519df88190bc204889b0896946", "custom_id": "40-7", "response": {"status_code": 200, "request_id": "6062fa7648c8c1daeca5358f534cb69e", "body": {"id": "chatcmpl-CZREqpOQo47xY8H0NjAfTn5wEQJMl", "object": "chat.completion", "created": 1762562220, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE cone search of 1 arcsec around RA=23.6488 deg, Dec=30.7314 deg\nWITH params (center_ra, center_dec, radius_deg) AS (\n  VALUES (23.6488::double precision, 30.7314::double precision, 1.0/3600.0)  -- 1 arcsec in degrees\n)\nSELECT\n  a.oid_catalog,     -- identifier in the ALLWISE catalog\n  a.ra,\n  a.dec,\n  a.w1mpro,          -- WISE W1 magnitude\n  a.w1sigmpro,       -- WISE W1 magnitude uncertainty\n  a.w2mpro,          -- WISE W2 magnitude\n  a.w2sigmpro,       -- WISE W2 magnitude uncertainty\n  a.j_m_2mass,       -- 2MASS J magnitude\n  a.j_msig_2mass     -- 2MASS J magnitude uncertainty\nFROM allwise a\nCROSS JOIN params p\nWHERE q3c_radial_query(a.ra, a.dec, p.center_ra, p.center_dec, p.radius_deg)\n;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 1211, "total_tokens": 3835, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb519a3081908f6dc6ec9c8abc8a", "custom_id": "40-8", "response": {"status_code": 200, "request_id": "893c8d89e04627e6b2e0b4c6afd69852", "body": {"id": "chatcmpl-CZRCHMHD8WhrNIc5b2XO61BZuSnms", "object": "chat.completion", "created": 1762562061, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE cone search: 1 arcsec (1/3600 deg) around RA=23.6488 deg, Dec=30.7314 deg\n-- Returns identifier, coordinates, and requested magnitudes with uncertainties\nSELECT\n    oid_catalog,    -- ALLWISE identifier\n    ra,\n    dec,\n    w1mpro,         -- WISE W1 magnitude\n    w1sigmpro,      -- WISE W1 magnitude uncertainty\n    w2mpro,         -- WISE W2 magnitude\n    w2sigmpro,      -- WISE W2 magnitude uncertainty\n    j_m_2mass,      -- 2MASS J magnitude\n    j_msig_2mass    -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 1124, "total_tokens": 3748, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb51a74881909a696acd605a8e3b", "custom_id": "40-9", "response": {"status_code": 200, "request_id": "985a179910403f7f557d86e0d9d8d77d", "body": {"id": "chatcmpl-CZRF0fYTpy7ds22MrwG7lT3tsDaAi", "object": "chat.completion", "created": 1762562230, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE sources within 1 arcsec of (RA, Dec) = (23.6488, 30.7314)\n-- 1 arcsec = 1/3600 degrees\nSELECT\n    oid_catalog,       -- Identifier in the ALLWISE catalog\n    ra,\n    dec,\n    w1mpro,            -- WISE W1 magnitude\n    w1sigmpro,         -- WISE W1 magnitude uncertainty\n    w2mpro,            -- WISE W2 magnitude\n    w2sigmpro,         -- WISE W2 magnitude uncertainty\n    j_m_2mass,         -- 2MASS J magnitude\n    j_msig_2mass       -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314) ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 1059, "total_tokens": 3683, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb51a7dc81909a8dd09c653d34ed", "custom_id": "80-5", "response": {"status_code": 200, "request_id": "6e0a2d251acd34fcc8d7d11d4a40405a", "body": {"id": "chatcmpl-CZRCN4dLx2UpK4wYZu8SRJJBR5KcI", "object": "chat.completion", "created": 1762562067, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all xmatch rows for the specified ZTF objects with distance < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2508, "completion_tokens": 592, "total_tokens": 3100, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb51ed7881909ebe1ca0a6af3691", "custom_id": "80-6", "response": {"status_code": 200, "request_id": "62e991039e32affdf8f2a3e68812b414", "body": {"id": "chatcmpl-CZRF3ddenuSWVb1iRR5kzulFIMByI", "object": "chat.completion", "created": 1762562233, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all xmatch rows for the specified OIDs with dist < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    -- Obtain valid OIDs from the object table (nested subquery as recommended)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2508, "completion_tokens": 736, "total_tokens": 3244, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb51d8488190bcbfe3fe5b0e280b", "custom_id": "80-7", "response": {"status_code": 200, "request_id": "f542e700c6c9dd235d5f61e2d17a0652", "body": {"id": "chatcmpl-CZRCV8Iwucow35zf4ilTZMxVOYzoE", "object": "chat.completion", "created": 1762562075, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find xmatch rows for the specified ZTF oids with dist < 0.5 arcsec\nWITH target_oids (oid) AS (\n    VALUES \n        ('ZTF22abcmmkz'),\n        ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND dist < 0.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2508, "completion_tokens": 602, "total_tokens": 3110, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb51f26481909580fa7986803c72", "custom_id": "80-8", "response": {"status_code": 200, "request_id": "76c1488309fe26f6c1e1332592ff8c0d", "body": {"id": "chatcmpl-CZRF4Ix93g7mqVwRojfH0G9HFlPRE", "object": "chat.completion", "created": 1762562234, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find cross-matches for the specified ZTF objects with separation < 0.5 arcsec, returning all columns */\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    /* Obtain valid OIDs from the object table (nested subquery as recommended) */\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2508, "completion_tokens": 742, "total_tokens": 3250, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb51e4348190a1ddada1a49f9607", "custom_id": "80-9", "response": {"status_code": 200, "request_id": "7d831dbc8430ee48e4fdfa1362abde39", "body": {"id": "chatcmpl-CZRCy6jSsqQWWoXssUoLiZFii2M3A", "object": "chat.completion", "created": 1762562104, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find xmatch rows for the given OIDs with distance < 0.5 arcsec (dist is in arcsec per schema)\nWITH selected_oids (oid) AS (\n    VALUES \n        ('ZTF22abcmmkz'),\n        ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM selected_oids)\n  AND dist < 0.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2508, "completion_tokens": 672, "total_tokens": 3180, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb527f448190b00cc2fadd53e77f", "custom_id": "45-5", "response": {"status_code": 200, "request_id": "1bb97e1fffecdcbf8ede94d163c5a20a", "body": {"id": "chatcmpl-CZRD12hBxsgfhitADgvO9bWYcFec7", "object": "chat.completion", "created": 1762562107, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Count rows in dataquality with reduced chi-square (chipsf) at least 5\n-- for the specified ZTF objects. Interpreting \"minimum reduced chi-square value of 5\"\n-- as a threshold (chipsf >= 5).\nSELECT\n  dq.oid,\n  COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (\n  SELECT o.oid\n  FROM object o\n  WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nAND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3175, "completion_tokens": 1356, "total_tokens": 4531, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5286688190b62a4121a1488667", "custom_id": "45-6", "response": {"status_code": 200, "request_id": "528a9725689b0abd6c29692195dcad90", "body": {"id": "chatcmpl-CZRDBgk2xPfyQWI01a2GzfA1SBUVa", "object": "chat.completion", "created": 1762562117, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Count dataquality rows for the specified ZTF objects where the reduced chi-square (chipsf) meets a minimum threshold of 5\n-- Interpretation: \"minimum reduced chi-square value of 5\" -> chipsf >= 5\nWITH target_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nSELECT dq.oid, COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3175, "completion_tokens": 1620, "total_tokens": 4795, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb52906c8190b060091977fe2221", "custom_id": "45-7", "response": {"status_code": 200, "request_id": "3a40a387c1be4577d8bffb0dfa15e7fd", "body": {"id": "chatcmpl-CZRDBSRiPnG3YWjxifnBnuNkXCnUK", "object": "chat.completion", "created": 1762562117, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Count rows in dataquality for the specified OIDs with reduced chi-square (chipsf) at least 5\n-- Interpreting \"minimum reduced chi-square value of 5\" as a threshold chipsf >= 5\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nSELECT COUNT(*) AS row_count_with_chipsf_ge_5\nFROM dataquality\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND chipsf >= 5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3175, "completion_tokens": 1728, "total_tokens": 4903, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5292f08190a704949f147f7495", "custom_id": "45-8", "response": {"status_code": 200, "request_id": "07854fd679c71707bf57af966a7cde34", "body": {"id": "chatcmpl-CZRDJJQHP3KizmNO69ii9egjnBXln", "object": "chat.completion", "created": 1762562125, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Assumption: \"minimum reduced chi-square value of 5\" means a lower bound threshold, i.e., chipsf >= 5.\nSELECT COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nAND dq.chipsf >= 5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3175, "completion_tokens": 1891, "total_tokens": 5066, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb529d0c8190bf8ad71eb63cc555", "custom_id": "45-9", "response": {"status_code": 200, "request_id": "790e3a77baee989d25984ec8e32ecdd6", "body": {"id": "chatcmpl-CZRDdQx52K1NNDrg6RnAe4h0Qm7LP", "object": "chat.completion", "created": 1762562145, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Count rows in dataquality for the specified OIDs where the reduced chi-square (chipsf) is at least 5.\n   Interpreting \"minimum reduced chi-square value of 5\" as a threshold: chipsf >= 5. */\nSELECT\n  dq.oid,\n  COUNT(*) AS count_rows_chipsf_ge_5\nFROM dataquality dq\nWHERE dq.oid IN (\n  SELECT o.oid\n  FROM object o\n  WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nAND dq.chipsf >= 5\nGROUP BY dq.oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3175, "completion_tokens": 2253, "total_tokens": 5428, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2112, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb52a6308190865f7815eef0366d", "custom_id": "63-5", "response": {"status_code": 200, "request_id": "4a9e3a036d7ae65c60feb46f3a4e7e6f", "body": {"id": "chatcmpl-CZREBd6A3pOE8Nm4NXeoTtmTWuZSu", "object": "chat.completion", "created": 1762562179, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier, with ranking 1 or 2, sorted by ranking\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2574, "completion_tokens": 803, "total_tokens": 3377, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb52d0d08190a1ae6dfde4c56f39", "custom_id": "63-6", "response": {"status_code": 200, "request_id": "628547fe9d9b9e0ff844fd6f5da20a3e", "body": {"id": "chatcmpl-CZREbmaJWw0Ee5Y65S0ohQqxhBdbC", "object": "chat.completion", "created": 1762562205, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all probabilities (all columns) for the requested OIDs,\n-- restricted to the Light Curve classifier and rankings 1 or 2.\n-- OIDs are obtained via a subquery (no JOIN), as requested.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2574, "completion_tokens": 693, "total_tokens": 3267, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb52dbb48190aca3967a9773f806", "custom_id": "63-7", "response": {"status_code": 200, "request_id": "9dad118f7c39f73223d68b4fd7cfaaaf", "body": {"id": "chatcmpl-CZREgNuk4HHnX9zUWU7rbrY99Pqjd", "object": "chat.completion", "created": 1762562210, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all probability rows for the specified ZTF objects, restricted to the Light Curve classifier,\n-- with ranking 1 or 2, sorted by ranking (ascending).\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n        -- Subquery to define the target OIDs without using JOINs\n        SELECT oid FROM (VALUES\n            ('ZTF21aaobkmg'),\n            ('ZTF21aaomuka')\n        ) AS oids(oid)\n  )\nORDER BY ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2092, "completion_tokens": 1086, "total_tokens": 3178, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb52e5d8819082951faf1b3e1243", "custom_id": "63-8", "response": {"status_code": 200, "request_id": "900e7e20bb18b4f9effa1a5a0149a4fb", "body": {"id": "chatcmpl-CZRAOUKpBVZvgSpFCB7aj9vk4ncqG", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier and rankings 1 or 2\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2574, "completion_tokens": 1121, "total_tokens": 3695, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb52e2088190a2e18b5c21148ec5", "custom_id": "63-9", "response": {"status_code": 200, "request_id": "383541f3cc35430756a1063b1a518a7b", "body": {"id": "chatcmpl-CZRAOAY60wyXdAcq7RSWbvsAw9Oia", "object": "chat.completion", "created": 1762561944, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all probability rows for the specified ZTF objects, light curve classifier, with ranking 1 or 2, sorted by ranking\nSELECT *\nFROM probability\nWHERE oid IN (\n    -- Obtain OIDs via a subquery (avoiding JOINs)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2646, "completion_tokens": 944, "total_tokens": 3590, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5379c881908f325b8d25b5c917", "custom_id": "73-5", "response": {"status_code": 200, "request_id": "1a10173b8cb0f10861d68f8dfe9423c4", "body": {"id": "chatcmpl-CZRBLAKi5sU2YKX2zYCOhdBcl9NOi", "object": "chat.completion", "created": 1762562003, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object\n-- Filter excludes entries where the MPC name is missing or stored as the literal string 'null'\nSELECT\n    oid,\n    ssnamenr,\n    ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz'\n  AND ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2056, "completion_tokens": 1189, "total_tokens": 3245, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb537db081908742d0c81ead8b66", "custom_id": "73-6", "response": {"status_code": 200, "request_id": "0eed9e9c55cc32e1480671bb7cfd18ff", "body": {"id": "chatcmpl-CZRBTG6jLq4ZZxXiffpaWWU6R5G3S", "object": "chat.completion", "created": 1762562011, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return the ZTF object identifier (oid), the MPC name (ssnamenr), and the MPC magnitude (ssmagnr)\nSELECT oid, ssnamenr, ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2056, "completion_tokens": 1473, "total_tokens": 3529, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5381e881909d3013bdd5f3dc4c", "custom_id": "73-7", "response": {"status_code": 200, "request_id": "a69df636b293efad69a419e1b983bd41", "body": {"id": "chatcmpl-CZRCgzDKyBuEdPz8nSsy2ten2HvZi", "object": "chat.completion", "created": 1762562086, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return ZTF object identifier (oid), MPC name (ssnamenr), and MPC magnitude (ssmagnr) for the nearest known Solar System object */\nSELECT\n    oid,\n    ssnamenr,\n    ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2056, "completion_tokens": 843, "total_tokens": 2899, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb537e8481908046cd1937b8f067", "custom_id": "73-8", "response": {"status_code": 200, "request_id": "8fd219e7959a3792bf5243081e28c35a", "body": {"id": "chatcmpl-CZRCmfoq68wyNtq6I4vtZ5WDpUSBe", "object": "chat.completion", "created": 1762562092, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object\nSELECT\n    oid,\n    ssnamenr,\n    ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2056, "completion_tokens": 896, "total_tokens": 2952, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb538ae08190b654711fa662efcf", "custom_id": "73-9", "response": {"status_code": 200, "request_id": "03289f3dcdccb2826b6539201ba5406f", "body": {"id": "chatcmpl-CZRDMvqPi1tMFMoUW9o7H8X2aoAG5", "object": "chat.completion", "created": 1762562128, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return the ZTF object identifier (oid), MPC name (ssnamenr), and MPC magnitude (ssmagnr)\nSELECT oid, ssnamenr, ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2056, "completion_tokens": 1023, "total_tokens": 3079, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb539ba08190bc51c7f35518ad6a", "custom_id": "92-5", "response": {"status_code": 200, "request_id": "2ce6bc419f6c533b27429fd2c380c28a", "body": {"id": "chatcmpl-CZRDPSSZtcVUNyZXW0DWFjvyeGegb", "object": "chat.completion", "created": 1762562131, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find at most 500 ZTF objects with >=10 detections in g band (fid=1) and no dubious points (ndubious=0),\n-- then return their lc_classifier rank-1 probabilities.\n-- Assumption: \"no dubious corrections\" is interpreted as ndubious=0 in magstat for fid=1.\nWITH g_band_oids AS (\n    SELECT m.oid\n    FROM magstat m\n    WHERE m.fid = 1              -- g band\n      AND m.ndet >= 10           -- at least 10 detections in g\n      AND m.ndubious = 0         -- no dubious points in that filter\n),\nrank1_lc_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM g_band_oids)\n    ORDER BY p.oid               -- order by OID before limiting objects\n    LIMIT 500\n)\nSELECT\n    p.oid,                       -- ZTF identifier\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM rank1_lc_oids)\nORDER BY p.oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3422, "completion_tokens": 3053, "total_tokens": 6475, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2752, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb53c55c8190bcb14380b67dcaee", "custom_id": "92-6", "response": {"status_code": 200, "request_id": "66258328d962eb2e42c4663c7d446b4e", "body": {"id": "chatcmpl-CZREJxgyDf2NL96MKQgLn049QH8JH", "object": "chat.completion", "created": 1762562187, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 500 ZTF objects (one row per oid) that:\n--  - have at least 10 detections in g band (fid=1),\n--  - have no dubious detections in g band,\n--  - and return only their lc_classifier ranking=1 probability rows.\n-- Notes on ambiguity:\n--  - \u201cno dubious corrections in that filter\u201d is interpreted here as: no g-band detections flagged as dubious (dubious=false for all fid=1 detections).\n--    If instead you want to exclude only detections where both corrected=true AND dubious=true, replace the HAVING SUM(...) condition as indicated below.\n\nWITH eligible_oids AS (\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1  -- g band\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n       AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0\n       -- Alternative (stricter) interpretation of \"dubious corrections\":\n       -- AND SUM(CASE WHEN d.corrected AND d.dubious THEN 1 ELSE 0 END) = 0\n)\nSELECT DISTINCT ON (p.oid)\n    p.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT eo.oid FROM eligible_oids eo)\nORDER BY p.oid, p.classifier_version DESC\nLIMIT 500;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2699, "completion_tokens": 3159, "total_tokens": 5858, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2816, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb53cf70819080ac71dacaf636a5", "custom_id": "92-7", "response": {"status_code": 200, "request_id": "b22d135aaf95c0dcb20b95fe1e4f9ffc", "body": {"id": "chatcmpl-CZRFhIyUsDj3ssohsrBpDDkBxruhU", "object": "chat.completion", "created": 1762562273, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with at least 10 g-band (fid=1) detections and no dubious detections in g,\n-- then keep only lc_classifier probabilities with ranking=1, ordered by oid, limited to 500.\nSELECT\n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.oid IN (\n        SELECT d.oid\n        FROM detection d\n        WHERE d.fid = 1\n        GROUP BY d.oid\n        HAVING COUNT(*) >= 10\n           AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0\n    )\nORDER BY p.oid\nLIMIT 500;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2699, "completion_tokens": 2740, "total_tokens": 5439, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb53ecc88190816c6d3ae46362bc", "custom_id": "92-8", "response": {"status_code": 200, "request_id": "eeb2e41a719f728f00228f3f7eaddabd", "body": {"id": "chatcmpl-CZRGzmMUcvQTDZN7r85qSfHpKmCId", "object": "chat.completion", "created": 1762562353, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 500 ZTF objects (ordered by oid) that:\n--  - have at least 10 detections in the g band (fid=1)\n--  - have no dubious detections in the g band\n-- Then, return only ranking=1 probabilities from the Light Curve classifier (lc_classifier)\n-- Columns requested: ZTF identifier (oid), classifier_version, class_name, probability\n\nSELECT\n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'   -- Light Curve classifier\n    AND p.ranking = 1                      -- only most probable class per classifier version\n    AND p.oid IN (\n        SELECT d.oid\n        FROM detection d\n        GROUP BY d.oid\n        HAVING\n            COUNT(*) FILTER (WHERE d.fid = 1) >= 10                      -- at least 10 g-band detections\n            AND BOOL_AND(NOT d.dubious) FILTER (WHERE d.fid = 1)         -- no dubious detections in g band\n    )\nORDER BY p.oid\nLIMIT 500;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2699, "completion_tokens": 3392, "total_tokens": 6091, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3136, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb53e36881909d8ddecbec891257", "custom_id": "92-9", "response": {"status_code": 200, "request_id": "ff96e41172425b02d8c4768209499537", "body": {"id": "chatcmpl-CZRHgfNfsKdAnJpFGpQoFB133VdCL", "object": "chat.completion", "created": 1762562396, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 500 objects (by oid) with at least 10 detections in g-band (fid=1) and no dubious points (ndubious=0),\n-- then return their top-1 lc_classifier probability entries.\nSELECT\n    p.oid,                -- ZTF identifier\n    p.classifier_version, -- classifier version\n    p.class_name,         -- class name\n    p.probability         -- probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.oid IN (\n        SELECT oid\n        FROM (\n            SELECT DISTINCT m.oid\n            FROM magstat m\n            WHERE m.fid = 1           -- g band\n              AND m.ndet >= 10        -- minimum 10 detections\n              AND m.ndubious = 0      -- no dubious points in that filter\n            ORDER BY m.oid\n            LIMIT 500                 -- at most 500 objects\n        ) AS oids\n    )\nORDER BY p.oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3620, "completion_tokens": 2984, "total_tokens": 6604, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2752, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5467e881908c2851d809c3c03c", "custom_id": "102-5", "response": {"status_code": 200, "request_id": "40fc22c6af937ac7711451e504544098", "body": {"id": "chatcmpl-CZRJX105FdnEQzNVWWNCsMyLvsihC", "object": "chat.completion", "created": 1762562511, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find up to 50 distinct ZTF objects with:\n   - AGN probability > 0.6 from the light curve classifier (lc_classifier)\n   - WISE W1 magnitude between 12 and 13\n   Then return all columns from magstat for those objects.\n\n   Note: The provided schema documents that allwise.oid_catalog is not the same as the ZTF oid in other tables.\n   In the absence of an explicit crossmatch table in the provided schema, this query assumes filtering by\n   comparing magstat.oid against allwise.oid_catalog via nested subqueries.\n*/\nWITH selected_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.oid IN (\n          SELECT aw.oid_catalog\n          FROM allwise aw\n          WHERE aw.w1mpro BETWEEN 12 AND 13\n      )\n    LIMIT 50\n)\nSELECT *\nFROM magstat\nWHERE oid IN (SELECT oid FROM selected_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3558, "completion_tokens": 2801, "total_tokens": 6359, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb54720081908b8db7d545e1f193", "custom_id": "102-6", "response": {"status_code": 200, "request_id": "832e09fc214ee4347bc09b254a3c7a15", "body": {"id": "chatcmpl-CZRKHbqeZmSeMCLe2sYmepaDBY7Le", "object": "chat.completion", "created": 1762562557, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3513, "completion_tokens": 4000, "total_tokens": 7513, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb546fd081909877aaf6128c851f", "custom_id": "102-8", "response": {"status_code": 200, "request_id": "e6a6611d2bcd7e4e8d162ffbd444a61e", "body": {"id": "chatcmpl-CZRO8C8NNq0MW2dpI6vPleSacQVVV", "object": "chat.completion", "created": 1762562796, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find up to 50 ZTF objects with:\n   - lc_classifier AGN probability > 0.6\n   - A spatial match to an ALLWISE source with 12 <= W1 (w1mpro) <= 13\n   Return all magstat rows for those objects.\n   Notes:\n   - Uses a 2 arcsec (2/3600 deg) match radius via q3c_join.\n   - Avoids explicit JOINs per guidance; uses CTEs and nested queries.\n*/\n\nWITH agn_oids AS (\n  SELECT DISTINCT p.oid\n  FROM probability p\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n),\nw1_match_oids AS (\n  SELECT DISTINCT o.oid\n  FROM object o\n  WHERE EXISTS (\n    SELECT 1\n    FROM allwise aw\n    WHERE aw.w1mpro BETWEEN 12 AND 13\n      AND q3c_join(aw.ra, aw.dec, o.ra, o.dec, 2.0/3600.0) -- 2 arcsec in degrees\n  )\n),\nselected_oids AS (\n  SELECT oid\n  FROM agn_oids\n  WHERE oid IN (SELECT oid FROM w1_match_oids)\n  LIMIT 50\n)\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM selected_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3558, "completion_tokens": 3640, "total_tokens": 7198, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3328, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb548b5481909d179f7f00c3188b", "custom_id": "102-9", "response": {"status_code": 200, "request_id": "a5b929d9bffcf09088174d77b3c7744b", "body": {"id": "chatcmpl-CZROwS04cW7XltgMWVTQggdNsp0CE", "object": "chat.completion", "created": 1762562846, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3513, "completion_tokens": 4000, "total_tokens": 7513, "prompt_tokens_details": {"cached_tokens": 3456, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb548be48190bb4c6add71eb5869", "custom_id": "81-5", "response": {"status_code": 200, "request_id": "4c1f91dd09383e3d769b891ada33d063", "body": {"id": "chatcmpl-CZRScYl8wPFybG8LYGSzi5T1yO869", "object": "chat.completion", "created": 1762563074, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF object id and angular distance (arcsec) for the ALLWISE source 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.catid ILIKE 'allwise%'\n  AND x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 3112, "total_tokens": 5826, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3008, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb54c4a881908a03d416aa49f193", "custom_id": "81-6", "response": {"status_code": 200, "request_id": "b2d12377f140d25d9c3a50529aa52fe2", "body": {"id": "chatcmpl-CZRSmFNcJZUI9m9aHn6iuQVS3f7vT", "object": "chat.completion", "created": 1762563084, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF object identifier (oid) and angular separation (dist) for the ALLWISE object id 'J163603.54-065228.7'\nWITH target_oids AS (\n    -- Obtain relevant OIDs first (per guidance to prioritize OIDs via subquery)\n    SELECT DISTINCT oid\n    FROM xmatch\n    WHERE catid = 'ALLWISE'\n      AND oid_catalog = 'J163603.54-065228.7'\n)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM target_oids)\n  AND x.catid = 'ALLWISE'\n  AND x.oid_catalog = 'J163603.54-065228.7';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2015, "completion_tokens": 1182, "total_tokens": 3197, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb54cea08190adab1fc8c8d69372", "custom_id": "81-7", "response": {"status_code": 200, "request_id": "b7f3767fcbf437151a74c38f31be663c", "body": {"id": "chatcmpl-CZRUeVjuZs8Oz6JaYwR6cEhLsYgBH", "object": "chat.completion", "created": 1762563200, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ZTF object identifier and xmatch distance for the AllWISE source 'J163603.54-065228.7'\nSELECT xm.oid, xm.dist\nFROM xmatch xm\nWHERE xm.oid_catalog = (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 2200, "total_tokens": 4914, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2112, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb54d794819082bd94446a2153ed", "custom_id": "81-8", "response": {"status_code": 200, "request_id": "8e2abc212e1c8c03a461ccb7c9297b89", "body": {"id": "chatcmpl-CZRAPf22MQc4WQfkGc09luT9LVMvn", "object": "chat.completion", "created": 1762561945, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ZTF objects cross-matched to the specified ALLWISE source, returning ZTF oid and angular distance (arcsec)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.catid ILIKE 'allwise'\n  AND x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 2339, "total_tokens": 5053, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb54df388190be83d5530c870769", "custom_id": "81-9", "response": {"status_code": 200, "request_id": "11a6b60d54c7f82dece668f8da529f98", "body": {"id": "chatcmpl-CZRAP3drPCwhVRwBEPRtpAuiuDx2u", "object": "chat.completion", "created": 1762561945, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ZTF objects matched to the ALLWISE designation 'J163603.54-065228.7'\n-- Returns: ZTF object identifier (oid) and angular separation (dist, in arcseconds)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n)\nORDER BY x.dist;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 1901, "total_tokens": 4615, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb555b108190bdf7a11262bc6588", "custom_id": "69-5", "response": {"status_code": 200, "request_id": "adb26473aa4123fbf0d8181e502f67ae", "body": {"id": "chatcmpl-CZRAPatcmsiJ1VgNab4YwZATY368Z", "object": "chat.completion", "created": 1762561945, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all Pan-STARRS crossmatch rows for the specified ZTF objects\n-- where the nearest source star/galaxy score (sgscore1) is < 0.2\nWITH requested_oids(oid) AS (\n    VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n)\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM requested_oids)\n  AND sgscore1 < 0.2;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2672, "completion_tokens": 825, "total_tokens": 3497, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb55664c8190a9de499075c80116", "custom_id": "69-6", "response": {"status_code": 200, "request_id": "eb9f1c3cf6e453460050294b2796f1b0", "body": {"id": "chatcmpl-CZRAQPnxszOfmzsrOUSzb77hoBpzb", "object": "chat.completion", "created": 1762561946, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find all ps1_ztf rows for the specified ZTF objects where the nearest PS1 source has a star/galaxy score (sgscore1) < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND sgscore1 < 0.2;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2672, "completion_tokens": 737, "total_tokens": 3409, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb555eec81909e743eddb7017795", "custom_id": "69-7", "response": {"status_code": 200, "request_id": "c4c8e055af32496d2b58ed38303c5524", "body": {"id": "chatcmpl-CZRAQL9VI33rWkhMamnZOG4zklKXd", "object": "chat.completion", "created": 1762561946, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Inline list of requested ZTF object identifiers\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n)\n-- Return all rows in ps1_ztf for those objects where the nearest source S/G score is < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM oids)\n  AND sgscore1 < 0.2;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2672, "completion_tokens": 757, "total_tokens": 3429, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb55635081908fcd7010ae61ac64", "custom_id": "69-8", "response": {"status_code": 200, "request_id": "70010948ade7743254434af72bfcf512", "body": {"id": "chatcmpl-CZRAz62pawztCRvw7vYP5wpnTHGQ4", "object": "chat.completion", "created": 1762561981, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all PS1-ZTF crossmatch rows for the specified ZTF objects\n-- where the star/galaxy score of the nearest PS1 source (sgscore1) is < 0.2\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF21abstkhj'),\n    ('ZTF22aacqjeb'),\n    ('ZTF21aamwpdf')\n)\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND sgscore1 < 0.2;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2672, "completion_tokens": 829, "total_tokens": 3501, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb558d2881909a7c86724a9ae0d8", "custom_id": "69-9", "response": {"status_code": 200, "request_id": "d723b31ad3ca00017f0455ab8d37c6a8", "body": {"id": "chatcmpl-CZRB5irKf0G6PnSANbIGmiQzZMKCF", "object": "chat.completion", "created": 1762561987, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all rows in ps1_ztf for the specified objects where the nearest PS1 source has sgscore1 < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n    ) AS oids(oid)\n)\nAND sgscore1 < 0.2;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2672, "completion_tokens": 813, "total_tokens": 3485, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb557c78819081c7b1f494f81be3", "custom_id": "61-5", "response": {"status_code": 200, "request_id": "82318d6506b1d260ded8af4e9f7c2c0e", "body": {"id": "chatcmpl-CZRBO53F1dDkLUWMV1lxT2PXDFpLo", "object": "chat.completion", "created": 1762562006, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2631, "completion_tokens": 433, "total_tokens": 3064, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 320, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb55c1d48190b110f0db52eb82bc", "custom_id": "61-6", "response": {"status_code": 200, "request_id": "947b07351f0b45d1aae6fada9411b255", "body": {"id": "chatcmpl-CZRAPHVTzjdulcbZUCMB0SFdmznmh", "object": "chat.completion", "created": 1762561945, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2631, "completion_tokens": 817, "total_tokens": 3448, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb55ba74819089968b97162eb36d", "custom_id": "61-7", "response": {"status_code": 200, "request_id": "a8a6ffce2cc2b3f00c2e239474a44fcd", "body": {"id": "chatcmpl-CZRBkLTVpSYPuUiT7rrpm7zaPza76", "object": "chat.completion", "created": 1762562028, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19; fainter means larger magnitude)\n-- - last difference magnitude brighter than 17 (maglast < 17; brighter means smaller magnitude)\n-- Results ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2631, "completion_tokens": 701, "total_tokens": 3332, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb55d2548190a4aa863b6d9e42e3", "custom_id": "61-8", "response": {"status_code": 200, "request_id": "4cb97696196234ee32cfc2e1ae22b6ca", "body": {"id": "chatcmpl-CZRAQX1F0yQoAV34MNzLR4BivajzE", "object": "chat.completion", "created": 1762561946, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)  -- fainter = larger magnitude\n-- - last difference magnitude brighter than 17 (maglast < 17)     -- brighter = smaller magnitude\n-- Ordered by the object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2631, "completion_tokens": 1153, "total_tokens": 3784, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb564e188190991e096c2a0072de", "custom_id": "104-5", "response": {"status_code": 200, "request_id": "b9d41402ffe40d1ab6def5deac047b57", "body": {"id": "chatcmpl-CZRAQaEggxZSejOxLvnDTbUVwNfRx", "object": "chat.completion", "created": 1762561946, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find up to 30 ZTF objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4' with probability > 0.9.\n   Return: ZTF object id (oid), candidate id (candid), nearest SS object distance, MPC magnitude, and name.\n   Also include candidate-related columns: filter identifier (fid).\n   Note: FWHM from SExtractor, number of PS1 calibrators, and exposure time are not present in the provided schema, so they are returned as NULL placeholders. */\nSELECT\n    s.oid AS oid,\n    s.candid AS candid,\n    s.ssdistnr,\n    s.ssmagnr,   -- interpreted as MPC archive magnitude\n    s.ssnamenr,\n    /* Candidate-related fields from detection */\n    (SELECT d.fid FROM detection d WHERE d.candid = s.candid) AS fid,\n    /* Placeholders for fields not available in the given schema */\n    NULL::double precision AS fwhm,\n    NULL::integer AS ps1_ncalibrators,\n    NULL::double precision AS exposure_time\nFROM ss_ztf s\nWHERE s.oid IN (\n    /* Prioritize obtaining OIDs via a subquery from probability */\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n)\nORDER BY (\n    /* Order by the asteroid probability (descending) to pick the most confident ones */\n    SELECT p2.probability\n    FROM probability p2\n    WHERE p2.oid = s.oid\n      AND p2.classifier_name = 'stamp_classifier'\n      AND p2.classifier_version = 'stamp_classifier_1.0.4'\n      AND p2.class_name = 'asteroid'\n) DESC NULLS LAST\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2845, "completion_tokens": 2923, "total_tokens": 5768, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb564d8c8190ad75237892f89bb5", "custom_id": "104-6", "response": {"status_code": 200, "request_id": "93b21f4464c990e623164eb1123c13cb", "body": {"id": "chatcmpl-CZRAwaP7cHkvHRNCFu8qWzzUDnuRL", "object": "chat.completion", "created": 1762561978, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 ZTF objects (oids) with asteroid probability > 0.9 for stamp_classifier version 'stamp_classifier_1.0.4'\n-- Return oid, candid, Solar System object info (distance, MPC magnitude, name),\n-- plus candidate-related fields: filter identifier (fid), and placeholders for FWHM (SExtractor), number of PS1 calibrators, and exposure time\n-- Note: The provided schema does not include columns for FWHM (SExtractor), PS1 calibrators count, or exposure time.\n--       These are returned as NULL placeholders with appropriate types.\n\nWITH best_oids AS (\n    SELECT\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.9\n)\nSELECT\n    s.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.oid = s.oid AND d.candid = s.candid\n     LIMIT 1) AS fid,\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,     -- not available in provided schema\n    NULL::INTEGER AS n_ps1_calibrators,            -- not available in provided schema\n    NULL::DOUBLE PRECISION AS exposure_time        -- not available in provided schema\nFROM ss_ztf s\nWHERE s.oid IN (SELECT bo.oid FROM best_oids bo)\nORDER BY (SELECT bo.probability FROM best_oids bo WHERE bo.oid = s.oid) DESC NULLS LAST\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2890, "completion_tokens": 3147, "total_tokens": 6037, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2752, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb566b1c8190baea9972107014d8", "custom_id": "104-9", "response": {"status_code": 200, "request_id": "60b801fc3abea0c908d93ab029634826", "body": {"id": "chatcmpl-CZRBpvFhmHCLBsLYE5GYtk0knnwxe", "object": "chat.completion", "created": 1762562033, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find up to 30 objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4'\n   with probability > 0.9, and return object/candidate identifiers plus Solar System info and candidate details.\n   Assumption: for each object we select the latest detection (highest mjd) to get its candid and fid.\n   Note: The provided schema does not include fields for FWHM (SExtractor), number of PS1 calibrators, or exposure time.\n         These are returned as NULL placeholders with descriptive aliases. */\nWITH target_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND class_name = 'asteroid'\n      AND probability > 0.9\n    ORDER BY probability DESC\n    LIMIT 30\n),\nlatest_det AS (\n    SELECT DISTINCT ON (oid) oid, candid, fid\n    FROM detection\n    WHERE oid IN (SELECT oid FROM target_oids)\n    ORDER BY oid, mjd DESC\n)\nSELECT\n    ld.oid,                                        -- ZTF object identifier\n    ld.candid,                                     -- candidate identifier (from latest detection)\n    (SELECT ssdistnr FROM ss_ztf s WHERE s.oid = ld.oid) AS ssdistnr,   -- distance to nearest SS object\n    (SELECT ssmagnr FROM ss_ztf s WHERE s.oid = ld.oid) AS ssmagnr,     -- MPC magnitude of nearest SS object\n    (SELECT ssnamenr FROM ss_ztf s WHERE s.oid = ld.oid) AS ssnamenr,   -- name of nearest SS object\n    ld.fid,                                        -- filter identifier\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,     -- placeholder: FWHM from SExtractor (not present in schema)\n    NULL::INTEGER AS ps1_calibrators_used,         -- placeholder: number of PS1 calibrators used (not present)\n    NULL::DOUBLE PRECISION AS exposure_time        -- placeholder: exposure time (not present)\nFROM latest_det ld;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2890, "completion_tokens": 3727, "total_tokens": 6617, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb56849881908cc6c098d17092a8", "custom_id": "71-5", "response": {"status_code": 200, "request_id": "6057fb4c87ff8a6876d2154a911104ea", "body": {"id": "chatcmpl-CZRCb1Y3JfddaKWJvpgR1bscg8PKO", "object": "chat.completion", "created": 1762562081, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return reference entries in g band (fid=1) for the specified ZTF object oids\nWITH wanted_oids (oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    r.rfid,        -- identifier of the reference\n    r.oid,         -- ZTF identifier\n    r.candid,      -- candidate identifier\n    r.magnr,       -- magnitude of nearest reference object\n    r.sigmagnr     -- uncertainty in magnr\nFROM reference r\nWHERE r.oid IN (SELECT oid FROM wanted_oids)\n  AND r.fid = 1   -- g band\nORDER BY r.oid, r.rfid;  -- sort by ZTF identifier (and by reference id for determinism)", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2300, "completion_tokens": 1149, "total_tokens": 3449, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb56b4fc81908a3c49ae6041c572", "custom_id": "71-7", "response": {"status_code": 200, "request_id": "e56903b8f965c974b36779a911d295a6", "body": {"id": "chatcmpl-CZRC384JM36rnWILF2lr82TzKCgTX", "object": "chat.completion", "created": 1762562047, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return reference ID, ZTF object ID, candidate ID, and nearest reference magnitude with its uncertainty\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,\n    oid,\n    candid,\n    magnr,\n    sigmagnr\nFROM reference\nWHERE fid = 1  -- g band (1=g; 2=r; 3=i)\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2300, "completion_tokens": 1220, "total_tokens": 3520, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb56c9588190af91b9e77eac1626", "custom_id": "71-8", "response": {"status_code": 200, "request_id": "b7939cf549f7380d2c8c1455f2144081", "body": {"id": "chatcmpl-CZRCkvYgoh3vaExFlcIav8ugLl0RC", "object": "chat.completion", "created": 1762562090, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find g-band (fid=1) reference rows for the given ZTF objects\n-- Returns: reference identifier (rfid), ZTF identifier (oid), candidate identifier (candid),\n-- and nearest reference magnitude with its uncertainty (magnr, sigmagnr), sorted by oid\nWITH oids (oid) AS (\n    VALUES\n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nWHERE r.fid = 1 -- g band\n  AND r.oid IN (SELECT oid FROM oids)\nORDER BY r.oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2300, "completion_tokens": 1516, "total_tokens": 3816, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb56c5f88190b46863d8f9abec3b", "custom_id": "71-9", "response": {"status_code": 200, "request_id": "0ff35c4ce9759275f8916789bd984008", "body": {"id": "chatcmpl-CZRCIDrvMLoQqE3dhH9lEEPTWdsj6", "object": "chat.completion", "created": 1762562062, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find g-band (fid=1) reference rows for the specified ZTF objects\nWITH targets (oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,        -- identifier of the reference\n    oid,         -- ZTF identifier\n    candid,      -- candidate identifier\n    magnr,       -- magnitude of nearest reference object\n    sigmagnr     -- 1-sigma uncertainty in magnr\nFROM reference\nWHERE fid = 1  -- g band\n  AND oid IN (SELECT oid FROM targets)\nORDER BY oid;  -- sort by ZTF identifier", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2300, "completion_tokens": 733, "total_tokens": 3033, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb573de08190987899b2fcf65649", "custom_id": "42-5", "response": {"status_code": 200, "request_id": "7d822bd084e66e91498ad47f83fed9e3", "body": {"id": "chatcmpl-CZRDSuxcb2ti8acPLWZ9MM1F2gzXr", "object": "chat.completion", "created": 1762562134, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- All dataquality epochs for object ZTF21aapnixl, sorted by reduced chi-square\nSELECT\n    oid,           -- object identifier\n    candid,        -- candidate identifier\n    fid,           -- filter identifier (1=g, 2=r, 3=i)\n    chipsf,        -- reduced chi-square for PSF-fit\n    fwhm,          -- FWHM from SExtractor [pixels]\n    classtar,      -- Star/Galaxy classification score from SExtractor\n    nbad,          -- number of prior-tagged bad pixels in 5x5 stamp\n    magzpsci,      -- magnitude zero point [mag]\n    magzpsciunc,   -- magnitude zero point uncertainty [mag]\n    exptime        -- exposure time [sec]\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2728, "completion_tokens": 1032, "total_tokens": 3760, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5744388190a7775780fd1bede2", "custom_id": "42-6", "response": {"status_code": 200, "request_id": "48bed07a6b147d534883c7d53960de9b", "body": {"id": "chatcmpl-CZRCJAQExhSiUxafjDGdvGgC4vYYV", "object": "chat.completion", "created": 1762562063, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- All dataquality epochs for the object 'ZTF21aapnixl', sorted by reduced chi-square (ascending)\nSELECT\n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2728, "completion_tokens": 874, "total_tokens": 3602, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb57481081909d3082ce41efcb44", "custom_id": "42-7", "response": {"status_code": 200, "request_id": "bdf0da1a2635c9a7156b493c328465e7", "body": {"id": "chatcmpl-CZRDYrUNfZeDtEzAspay7AMOJfAsT", "object": "chat.completion", "created": 1762562140, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- All epochs in dataquality for the specified ZTF object, ordered by reduced chi-square (ascending)\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.fid,\n    dq.chipsf,\n    dq.fwhm,\n    dq.classtar,\n    dq.nbad,\n    dq.magzpsci,\n    dq.magzpsciunc,\n    dq.exptime\nFROM dataquality AS dq\nWHERE dq.oid = 'ZTF21aapnixl'\nORDER BY dq.chipsf ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2728, "completion_tokens": 1143, "total_tokens": 3871, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5750c881909d483cd1a7092af2", "custom_id": "42-8", "response": {"status_code": 200, "request_id": "791186d66a89abe30718594705ff9366", "body": {"id": "chatcmpl-CZRClrXL5lWO8Q8eByA3rDxpmUfeU", "object": "chat.completion", "created": 1762562091, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all epochs in dataquality for the object 'ZTF21aapnixl'\n-- Return: object (oid), candidate (candid), filter (fid), reduced chi-square (chipsf),\n-- FWHM (fwhm), star/galaxy score (classtar), number of bad pixels (nbad),\n-- ZP magnitude and its uncertainty (magzpsci, magzpsciunc), and exposure time (exptime)\n-- Sorted by reduced chi-square ascending\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.fid,\n    dq.chipsf,\n    dq.fwhm,\n    dq.classtar,\n    dq.nbad,\n    dq.magzpsci,\n    dq.magzpsciunc,\n    dq.exptime\nFROM dataquality dq\nWHERE dq.oid IN (\n    -- Prioritize obtaining OIDs in a subquery\n    SELECT DISTINCT oid\n    FROM dataquality\n    WHERE oid = 'ZTF21aapnixl'\n)\nORDER BY dq.chipsf ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2728, "completion_tokens": 1188, "total_tokens": 3916, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb575700819098d1ff65931cc8ec", "custom_id": "42-9", "response": {"status_code": 200, "request_id": "5ae438e5c0847bd15bb6134d59148f12", "body": {"id": "chatcmpl-CZRDwcF9dhE81XhVKZJt2zevX5J7P", "object": "chat.completion", "created": 1762562164, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all epochs in dataquality for the specified ZTF object, sorted by reduced chi-square\nWITH target_oids (oid) AS (\n    VALUES ('ZTF21aapnixl')\n)\nSELECT\n    dq.oid,           -- object\n    dq.candid,        -- candidate identifier\n    dq.fid,           -- filter identifier (1=g; 2=r; 3=i)\n    dq.chipsf,        -- reduced chi-square for PSF-fit\n    dq.fwhm,          -- FWHM from SExtractor [pixels]\n    dq.classtar,      -- star/galaxy score from SExtractor\n    dq.nbad,          -- number of bad pixels in 5x5 stamp\n    dq.magzpsci,      -- magnitude zero point [mag]\n    dq.magzpsciunc,   -- magnitude zero point uncertainty [mag]\n    dq.exptime        -- exposure time [sec]\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\nORDER BY dq.chipsf ASC NULLS LAST;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2728, "completion_tokens": 1065, "total_tokens": 3793, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb57726881908683323abf45544e", "custom_id": "107-5", "response": {"status_code": 200, "request_id": "e23faf981c5b1a07788241a7ca12d239", "body": {"id": "chatcmpl-CZRCnP49o6TKpG0tPASwSc2DKUhhL", "object": "chat.completion", "created": 1762562093, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3343, "completion_tokens": 4000, "total_tokens": 7343, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb579a2c8190be47cab2313970e2", "custom_id": "107-6", "response": {"status_code": 200, "request_id": "1f9aa56a8ae3b751ef89e99e99a9048f", "body": {"id": "chatcmpl-CZREHyYWIv2mZIPP1LbZ34VabAyaW", "object": "chat.completion", "created": 1762562185, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH qualifying_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500  -- more than 500 detections\n      AND EXISTS (\n          SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.classifier_version = 'stamp_classifier_1.0.4'\n            AND p.class_name = 'asteroid'\n            AND p.probability > 0.5  -- probability larger than 0.5\n      )\n      AND EXISTS (\n          SELECT 1\n          FROM ss_ztf s\n          WHERE s.oid = o.oid\n            AND s.ssdistnr < 2  -- distance to nearest Solar System object below 2 arcsec\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10  -- return at most 10 objects\n)\nSELECT\n    o.oid,                        -- ZTF identifier\n    o.ndet,                       -- number of detections\n    o.firstmjd,                   -- first detection date\n    o.lastmjd,                    -- last detection date\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4'\n       AND p.class_name = 'asteroid') AS probability,  -- asteroid probability\n    (SELECT s.candid\n     FROM ss_ztf s\n     WHERE s.oid = o.oid) AS candid,                   -- candidate identifier\n    (SELECT s.ssdistnr\n     FROM ss_ztf s\n     WHERE s.oid = o.oid) AS ssdistnr,                 -- distance between ZTF object and MPC object (arcsec)\n    (SELECT s.ssnamenr\n     FROM ss_ztf s\n     WHERE s.oid = o.oid) AS ssnamenr,                 -- MPC name\n    (SELECT d.mjd\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS mjd,  -- detection date for that candid\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS fid   -- filter identifier for that candid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM qualifying_oids)\nORDER BY o.firstmjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3343, "completion_tokens": 3184, "total_tokens": 6527, "prompt_tokens_details": {"cached_tokens": 3328, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2624, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb57a3e48190b98acf177797850c", "custom_id": "107-7", "response": {"status_code": 200, "request_id": "62f1016ce680b46ea99fd86a88479a61", "body": {"id": "chatcmpl-CZRCrCo6hhZDzC7T2YCslXOCNTjlu", "object": "chat.completion", "created": 1762562097, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3460, "completion_tokens": 4000, "total_tokens": 7460, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb57b9f0819080de621cdbad6722", "custom_id": "107-8", "response": {"status_code": 200, "request_id": "459085f87f2d6612c9ef03e5e00dc8e8", "body": {"id": "chatcmpl-CZRESwr9TUWG6AjSPt6Litru7beAs", "object": "chat.completion", "created": 1762562196, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find at most 10 ZTF objects with:\n   - ndet > 500\n   - stamp_classifier (version 'stamp_classifier_1.0.4') class 'asteroid' probability > 0.5\n   - nearest Solar System object distance < 2 arcsec\n   Return: oid, ndet, firstmjd, lastmjd, probability, candid, ssdistnr, ssnamenr, detection mjd, detection fid\n   Ordered by firstmjd\n*/\nWITH prob_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.5\n),\noid_candidates AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500\n      AND o.oid IN (SELECT oid FROM prob_oids)\n      AND o.oid IN (\n          SELECT s.oid\n          FROM ss_ztf s\n          WHERE s.ssdistnr < 2\n      )\n)\nSELECT\n    o.oid AS oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    /* Probability from the specified stamp classifier and version */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n    ) AS probability,\n    /* Candidate identifier and SS info from ss_ztf */\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    /* Detection date and filter identifier for that candidate */\n    (\n        SELECT d.mjd\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS detection_mjd,\n    (\n        SELECT d.fid\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS fid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM oid_candidates)\nORDER BY o.firstmjd\nLIMIT 10;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3388, "completion_tokens": 2948, "total_tokens": 6336, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2368, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb57b18c8190aa0cfbe12b3dca82", "custom_id": "107-9", "response": {"status_code": 200, "request_id": "4e64814d82d01b8918215f01d764b3ee", "body": {"id": "chatcmpl-CZRD0oYeen9HxaP6Qho8EchQB1Gzh", "object": "chat.completion", "created": 1762562106, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 2906, "completion_tokens": 4000, "total_tokens": 6906, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb583cbc8190a16bf57638563da7", "custom_id": "83-5", "response": {"status_code": 200, "request_id": "aedd7402aecee354495d7311725e2ac2", "body": {"id": "chatcmpl-CZRErVX94fsh7UizZiUBuGQw7kxAd", "object": "chat.completion", "created": 1762562221, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* The provided schema contains only the 'allwise' table, which uses 'oid_catalog' (ALLWISE designation), not ZTF object IDs. \n   To fetch ALLWISE rows for a ZTF object like 'ZTF21aazqwxv', you would typically use a crossmatch table to map the ZTF oid to 'allwise.oid_catalog'.\n   Example (if a crossmatch table existed):\n   SELECT a.*\n   FROM allwise a\n   WHERE a.oid_catalog IN (\n       SELECT xm.oid_catalog\n       FROM xmatch xm\n       WHERE xm.oid = 'ZTF21aazqwxv'\n   );\n*/\n\n/* With only the 'allwise' table available, there is no direct way to filter by a ZTF object id; return no rows by design. */\nSELECT *\nFROM allwise\nWHERE 1 = 0;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2575, "completion_tokens": 1406, "total_tokens": 3981, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb58a8a081909d58a20bfefe330b", "custom_id": "83-6", "response": {"status_code": 200, "request_id": "99c4ad705b783596a25b02ab113e6b2f", "body": {"id": "chatcmpl-CZRG79afi2EJnbOgxBMYSsMW02ymZ", "object": "chat.completion", "created": 1762562299, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get the closest AllWISE counterpart to the ZTF object by a cone search around the object's mean position\n-- Adjust the radius (in arcseconds) if needed; here we use 3.0 arcsec and return the nearest match\nSELECT *\nFROM allwise aw\nWHERE q3c_radial_query(\n    aw.ra,\n    aw.dec,\n    (SELECT o.meanra FROM object o WHERE o.oid = 'ZTF21aazqwxv'),\n    (SELECT o.meandec FROM object o WHERE o.oid = 'ZTF21aazqwxv'),\n    3.0/3600.0  -- radius in degrees\n)\nORDER BY q3c_dist(\n    aw.ra,\n    aw.dec,\n    (SELECT o.meanra FROM object o WHERE o.oid = 'ZTF21aazqwxv'),\n    (SELECT o.meandec FROM object o WHERE o.oid = 'ZTF21aazqwxv')\n)\nLIMIT 1;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3057, "completion_tokens": 1816, "total_tokens": 4873, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5839fc819097592aea360562da", "custom_id": "83-7", "response": {"status_code": 200, "request_id": "d1396cd62ac2cb0599443fa9ed4fc7e6", "body": {"id": "chatcmpl-CZRGKmpLsm7BL9kL5czfwXG1vtxuW", "object": "chat.completion", "created": 1762562312, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns from ALLWISE for the provided identifier.\n-- Note: In this schema, the only key available is allwise.oid_catalog (an ALLWISE designation).\n-- If 'ZTF21aazqwxv' is not an ALLWISE oid_catalog, this will return no rows.\nSELECT *\nFROM allwise\nWHERE oid_catalog = 'ZTF21aazqwxv';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2575, "completion_tokens": 1306, "total_tokens": 3881, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb58493c81908eb5aee537a6dc32", "custom_id": "83-8", "response": {"status_code": 200, "request_id": "b588cba8c66653c843867e3e29f8ea37", "body": {"id": "chatcmpl-CZRGfd0yx3anngHVltwYDAr0537CA", "object": "chat.completion", "created": 1762562333, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all ALLWISE rows spatially matched to the ZTF object 'ZTF21aazqwxv'\n-- Using a 2-arcsecond cone around the object's mean position (meanra, meandec)\nSELECT *\nFROM allwise\nWHERE q3c_radial_query(\n    ra,\n    dec,\n    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),\n    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),\n    2.0/3600.0  -- radius in degrees (2 arcsec)\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3057, "completion_tokens": 1801, "total_tokens": 4858, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1664, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb584f0c8190ba763c95be14d23d", "custom_id": "83-9", "response": {"status_code": 200, "request_id": "1c0d77997826db8a88b5e01df63dda68", "body": {"id": "chatcmpl-CZRHOVglajbMeT9NHmJncJm1C4rCQ", "object": "chat.completion", "created": 1762562378, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all AllWISE columns for the ZTF object by first retrieving its AllWISE oid_catalog via xmatch\nSELECT *\nFROM allwise\nWHERE oid_catalog IN (\n    SELECT xm.oid_catalog\n    FROM xmatch xm\n    WHERE xm.oid = 'ZTF21aazqwxv'\n      AND xm.catid ILIKE 'allwise%'  -- adjust/remove this filter if your catid differs\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2688, "completion_tokens": 1312, "total_tokens": 4000, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb586e248190906a2e4b00e7a439", "custom_id": "84-5", "response": {"status_code": 200, "request_id": "a4c680c62ff420515e01efbf6d024774", "body": {"id": "chatcmpl-CZRHSajXGYXRadu6Yep8aXjufPPyh", "object": "chat.completion", "created": 1762562382, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF oid, ALLWISE oid_catalog, angular distance between counterparts (arcsec),\n-- and ALLWISE magnitudes W1\u2013W4 for the ZTF object 'ZTF19aascdol'.\nWITH matched AS (\n    SELECT xm.oid, xm.oid_catalog, xm.dist\n    FROM xmatch xm\n    WHERE xm.oid = 'ZTF19aascdol'\n      -- Keep only matches that exist in the ALLWISE catalog\n      AND xm.oid_catalog IN (SELECT aw.oid_catalog FROM allwise aw)\n)\nSELECT\n    m.oid,\n    m.oid_catalog,\n    m.dist,\n    (SELECT aw.w1mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w1mpro,\n    (SELECT aw.w2mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w2mpro,\n    (SELECT aw.w3mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w3mpro,\n    (SELECT aw.w4mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w4mpro\nFROM matched m;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2732, "completion_tokens": 2051, "total_tokens": 4783, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb588c648190802d8069d9a55513", "custom_id": "84-6", "response": {"status_code": 200, "request_id": "6445f26a81d010e06bf109484014b5cb", "body": {"id": "chatcmpl-CZRHyPZvQnETkL2jf7bgwzb9IjUH1", "object": "chat.completion", "created": 1762562414, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE matches for ZTF object 'ZTF19aascdol' with ZTF and catalog identifiers, counterpart distance [arcsec], and WISE W1\u2013W4 magnitudes\nSELECT\n    x.oid,                 -- ZTF object identifier\n    x.oid_catalog,         -- ALLWISE catalog identifier\n    x.dist,                -- angular distance between counterparts [arcsec]\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = 'ZTF19aascdol'\n  AND EXISTS (\n      SELECT 1 FROM allwise a WHERE a.oid_catalog = x.oid_catalog\n  )\nORDER BY x.dist ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2732, "completion_tokens": 3263, "total_tokens": 5995, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3008, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5897748190be17d5986324edc5", "custom_id": "84-7", "response": {"status_code": 200, "request_id": "d8cc44bd56a2c8ce24cba4daa2feb8ec", "body": {"id": "chatcmpl-CZRIR9SmkdQHjHydgdOj6DE6CBsQf", "object": "chat.completion", "created": 1762562443, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* ALLWISE matches for the ZTF object 'ZTF19aascdol', returning:\n   - ZTF identifier (oid)\n   - Catalog identifier (oid_catalog)\n   - Angular distance between counterparts (dist, in arcsec)\n   - WISE magnitudes W1 to W4 (w1mpro, w2mpro, w3mpro, w4mpro)\n   Notes:\n   - OID is obtained via a subquery from the object table as recommended.\n   - No explicit JOINs are used; ALLWISE magnitudes are retrieved via correlated subqueries.\n   - We ensure the match belongs to ALLWISE by requiring existence in the allwise table.\n*/\nSELECT\n    x.oid,\n    x.oid_catalog,\n    x.dist,\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid IN (SELECT o.oid FROM object o WHERE o.oid = 'ZTF19aascdol')\n  AND EXISTS (SELECT 1 FROM allwise a WHERE a.oid_catalog = x.oid_catalog);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3214, "completion_tokens": 1936, "total_tokens": 5150, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb58aacc81908fde4e57c2bd0e2a", "custom_id": "84-8", "response": {"status_code": 200, "request_id": "ce9cd3cbb0b8df4eb600fdbdaf32d5d0", "body": {"id": "chatcmpl-CZRAQVySFXID46SWFINgGvY1Ww3Us", "object": "chat.completion", "created": 1762561946, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE matches for ZTF object 'ZTF19aascdol' with ZTF and catalog identifiers,\n-- angular distance, and WISE W1\u2013W4 magnitudes. Uses nested subqueries (no JOINs).\nSELECT\n    x.oid,          -- ZTF object identifier\n    x.oid_catalog,  -- ALLWISE catalog identifier\n    x.dist,         -- angular distance [arcsec] between counterparts\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro, -- WISE W1 mag\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro, -- WISE W2 mag\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro, -- WISE W3 mag\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro  -- WISE W4 mag\nFROM xmatch x\nWHERE x.oid IN (\n    -- prioritize obtaining OIDs via a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF19aascdol'\n)\nAND x.oid_catalog IN (\n    -- ensure we only keep matches that exist in the ALLWISE catalog table\n    SELECT a.oid_catalog\n    FROM allwise a\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3214, "completion_tokens": 2827, "total_tokens": 6041, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb58b49481909e201eb818d54199", "custom_id": "84-9", "response": {"status_code": 200, "request_id": "7fd1e64d75d3eeba12aaa73193f8c07a", "body": {"id": "chatcmpl-CZRAQMVWos4dHbb4CrUNBNdn2XQRz", "object": "chat.completion", "created": 1762561946, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE matches for ZTF object 'ZTF19aascdol'\n-- Returns: ZTF oid, ALLWISE oid_catalog, angular separation in arcsec (xmatch.dist),\n-- and WISE magnitudes W1\u2013W4 (w1mpro\u2013w4mpro) from the ALLWISE catalog.\nSELECT\n  x.oid AS ztf_oid,\n  x.oid_catalog AS allwise_oid,\n  x.dist AS dist_arcsec,\n  (SELECT aw.w1mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w1mpro,\n  (SELECT aw.w2mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w2mpro,\n  (SELECT aw.w3mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w3mpro,\n  (SELECT aw.w4mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid IN (\n  -- prioritize obtaining OIDs via the object table\n  SELECT o.oid FROM object o WHERE o.oid = 'ZTF19aascdol'\n)\n-- ensure we only keep matches that exist in the ALLWISE catalog\nAND EXISTS (\n  SELECT 1 FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3214, "completion_tokens": 1837, "total_tokens": 5051, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1536, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb592b4c819091c34bc69cf50a9b", "custom_id": "96-5", "response": {"status_code": 200, "request_id": "189f895600a301ecf2811d9679490e6d", "body": {"id": "chatcmpl-CZRC16o1Fdp7NGndEhWNODqY0AMDB", "object": "chat.completion", "created": 1762562045, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* \nFor MPC names '2003FP134' and '2009UK56', return all detections from ZTF objects whose nearest known Solar System object matches either name and lies within 2 arcsec (using ss_ztf.ssdistnr).\nOutput:\n- all columns from ss_ztf (oid, candid, ssdistnr, ssmagnr, ssnamenr)\n- detection info: mjd (detection date), fid, isdiffpos, ra, dec, magpsf, sigmapsf\nSorted by MPC name (ssnamenr) and detection date (mjd).\nNo JOINs are used; OIDs are obtained in a subquery as recommended.\n*/\nWITH ss_matches AS (\n    SELECT s.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr\n    FROM ss_ztf s\n    WHERE s.ssnamenr IN ('2003FP134', '2009UK56')\n      AND s.ssdistnr <= 2  -- assumed arcseconds per schema context\n)\nSELECT\n    /* all columns from ss_ztf via correlated subqueries */\n    (SELECT sm.oid FROM ss_matches sm WHERE sm.oid = d.oid) AS oid,\n    (SELECT sm.candid FROM ss_matches sm WHERE sm.oid = d.oid) AS candid,\n    (SELECT sm.ssdistnr FROM ss_matches sm WHERE sm.oid = d.oid) AS ssdistnr,\n    (SELECT sm.ssmagnr FROM ss_matches sm WHERE sm.oid = d.oid) AS ssmagnr,\n    (SELECT sm.ssnamenr FROM ss_matches sm WHERE sm.oid = d.oid) AS ssnamenr,\n    /* requested detection columns */\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM ss_matches)\nORDER BY ssnamenr, mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2649, "completion_tokens": 3451, "total_tokens": 6100, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3008, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5931508190be918dd723254d9f", "custom_id": "96-6", "response": {"status_code": 200, "request_id": "a0a27c6c6a82d8c8d338bb0f3e1f0e42", "body": {"id": "chatcmpl-CZRCcCTG9PW7qDDnF5NRqUXD4l1tn", "object": "chat.completion", "created": 1762562082, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Detections within 2 arcsec of MPC objects '2003FP134' and '2009UK56'\n   Returns all ss_ztf columns plus selected detection fields, ordered by MPC name and detection date */\nWITH ss_targets AS (\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n      AND ssdistnr <= 2.0  -- distance to nearest known solar system object, assumed in arcseconds\n)\nSELECT\n    s.*,                  -- all columns from ss_ztf\n    d.mjd,                -- detection date (MJD)\n    d.fid,                -- filter identifier\n    d.isdiffpos,          -- isdiffpos flag\n    d.ra,                 -- RA (deg)\n    d.dec,                -- Dec (deg)\n    d.magpsf,             -- PSF difference magnitude\n    d.sigmapsf            -- uncertainty of PSF difference magnitude\nFROM ss_targets s, detection d\nWHERE d.oid = s.oid\nORDER BY s.ssnamenr, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2649, "completion_tokens": 3123, "total_tokens": 5772, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2880, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb593dec8190b25e3c2813112994", "custom_id": "96-7", "response": {"status_code": 200, "request_id": "04fa91837c0fc5d32dcf28e3644560b2", "body": {"id": "chatcmpl-CZRE26qFHJ0d53rUIfAUnk9OpUxRj", "object": "chat.completion", "created": 1762562170, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Get all detections for objects whose nearest known Solar System object\n   is either '2003FP134' or '2009UK56' and within 2 arcsec (assuming ssdistnr is in arcseconds).\n   Return all ss_ztf columns plus selected detection fields.\n*/\nSELECT\n    /* all columns from ss_ztf via correlated subqueries */\n    (SELECT s.oid FROM ss_ztf s WHERE s.oid = d.oid) AS oid,\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = d.oid) AS candid,\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssdistnr,\n    (SELECT s.ssmagnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssmagnr,\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid) AS ssnamenr,\n    /* requested detection fields */\n    d.mjd AS detection_date,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detection d\nWHERE d.oid IN (\n    /* prioritize obtaining OIDs in a subquery */\n    SELECT s1.oid\n    FROM ss_ztf s1\n    WHERE s1.ssnamenr IN ('2003FP134', '2009UK56')\n      AND s1.ssdistnr <= 2.0  /* 2 arcsec threshold */\n)\nORDER BY\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid),\n    d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2649, "completion_tokens": 3385, "total_tokens": 6034, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3008, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb594804819087309d67116d089e", "custom_id": "96-8", "response": {"status_code": 200, "request_id": "dd99102f8ddf362bf18941268dce957c", "body": {"id": "chatcmpl-CZRF1nyojo9rbQznrgdhTXvF1bz2x", "object": "chat.completion", "created": 1762562231, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* \nFor the Solar System identifiers '2003FP134' and '2009UK56', this query:\n- Selects all ZTF detections whose object OID is associated in ss_ztf to either name within 2 arcsec (ssdistnr <= 2).\n- Returns all columns from ss_ztf (oid, candid, ssdistnr, ssmagnr, ssnamenr).\n- Returns detection date (mjd), filter id (fid), isdiffpos, RA/Dec (ra, dec), and difference magnitude plus uncertainty (magpsf, sigmapsf).\n- Sorts by MPC name (ssnamenr) and detection date (mjd).\n- Avoids explicit JOINs by using nested subqueries and an OID subquery.\n*/\n\nWITH selected_oids AS (\n  SELECT s.oid\n  FROM ss_ztf s\n  WHERE s.ssnamenr IN ('2003FP134', '2009UK56')\n    AND s.ssdistnr <= 2\n)\nSELECT\n  /* All columns from ss_ztf */\n  (SELECT s.oid FROM ss_ztf s WHERE s.oid = d.oid) AS oid,\n  (SELECT s.candid FROM ss_ztf s WHERE s.oid = d.oid) AS candid,\n  (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssdistnr,\n  (SELECT s.ssmagnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssmagnr,\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid) AS ssnamenr,\n  /* Detection fields requested */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\nORDER BY ssnamenr, mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2649, "completion_tokens": 3318, "total_tokens": 5967, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2880, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb595e9c81909e6700bf1940ef4e", "custom_id": "96-9", "response": {"status_code": 200, "request_id": "e78c98022e4c6423ead8512d5d38acdf", "body": {"id": "chatcmpl-CZRFw5XUI7UCtSkl23dyafnOEe7q1", "object": "chat.completion", "created": 1762562288, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all detections for ZTF objects whose nearest known solar system object is either '2003FP134' or '2009UK56'\n-- and is within 2 arcsec, returning all ss_ztf columns plus selected detection fields.\nWITH target_oids AS (\n  SELECT s.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr\n  FROM ss_ztf s\n  WHERE s.ssnamenr IN ('2003FP134', '2009UK56')\n    AND s.ssdistnr <= 2  -- arcseconds\n)\nSELECT\n  /* all columns from ss_ztf */\n  (SELECT t.oid FROM target_oids t WHERE t.oid = d.oid) AS oid,\n  (SELECT t.candid FROM target_oids t WHERE t.oid = d.oid) AS candid,\n  (SELECT t.ssdistnr FROM target_oids t WHERE t.oid = d.oid) AS ssdistnr,\n  (SELECT t.ssmagnr FROM target_oids t WHERE t.oid = d.oid) AS ssmagnr,\n  (SELECT t.ssnamenr FROM target_oids t WHERE t.oid = d.oid) AS ssnamenr,\n  /* detection fields: detection date (mjd), filter identifier, isdiffpos flag, RA/Dec, difference magnitude and its uncertainty */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\nORDER BY\n  (SELECT t.ssnamenr FROM target_oids t WHERE t.oid = d.oid),\n  d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2649, "completion_tokens": 3719, "total_tokens": 6368, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3328, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb598ff8819092368c9f44fca01d", "custom_id": "67-5", "response": {"status_code": 200, "request_id": "db3d62294efae74907c994bee77ab586", "body": {"id": "chatcmpl-CZRHOF81unGv7ZMaCDPhpmcZ9WVpF", "object": "chat.completion", "created": 1762562378, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find all gaia_ztf rows for the specified ZTF objects where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Obtain the OIDs via a subquery from the object table as recommended\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n)\nAND neargaia <= 1.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2616, "completion_tokens": 949, "total_tokens": 3565, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb598d7c819096d73058504043f4", "custom_id": "67-6", "response": {"status_code": 200, "request_id": "37c7c58f5316462b15a190b96c1b609f", "body": {"id": "chatcmpl-CZRI8rwRAssQHb6Jr2djhegaooDnU", "object": "chat.completion", "created": 1762562424, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find gaia_ztf rows for specific ZTF objects whose nearest Gaia source is within 1.5 arcsec\nWITH targets(oid) AS (\n    VALUES \n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT oid FROM targets)\n  AND g.neargaia <= 1.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2134, "completion_tokens": 684, "total_tokens": 2818, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb59a77881909e073913730dd6e7", "custom_id": "67-7", "response": {"status_code": 200, "request_id": "734842f9fd0ea0a055c326029b81f674", "body": {"id": "chatcmpl-CZRIdO86StqkJhesvBTdBhQXzq5hC", "object": "chat.completion", "created": 1762562455, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all rows in gaia_ztf for the specified ZTF objects where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  AND neargaia <= 1.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2134, "completion_tokens": 920, "total_tokens": 3054, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb59a6f08190b876115b186033a8", "custom_id": "67-8", "response": {"status_code": 200, "request_id": "fde02ef0bc455c86adc71ef2ab1d1d7b", "body": {"id": "chatcmpl-CZRIyzTPnouTlaUWkl1ShqS1sCxFW", "object": "chat.completion", "created": 1762562476, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all gaia_ztf rows for the specified ZTF oids where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n    ) AS oids(oid)\n)\nAND neargaia <= 1.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2134, "completion_tokens": 877, "total_tokens": 3011, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a36048190b41358cc178aedee", "custom_id": "55-5", "response": {"status_code": 200, "request_id": "4f1e1405c7552c76d0eaa2e6175d6f34", "body": {"id": "chatcmpl-CZRJj618VlCvEkTZ52NeLMzceCh5X", "object": "chat.completion", "created": 1762562523, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the specific ZTF object from the object table\nSELECT *\nFROM object\nWHERE oid IN (\n    -- Subquery to obtain the target OID (follows the guideline of obtaining OIDs via a nested query)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2357, "completion_tokens": 398, "total_tokens": 2755, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 320, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a205c8190ae06c1575c704a07", "custom_id": "55-6", "response": {"status_code": 200, "request_id": "75e4c1bf35578e5ffa0b4baa65d0bfe9", "body": {"id": "chatcmpl-CZRK476GT5hA7x9z5K9ymOBNrUoW9", "object": "chat.completion", "created": 1762562544, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the specified ZTF object, retrieving the OID via a subquery as per guidance\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM target_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2357, "completion_tokens": 651, "total_tokens": 3008, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a29e481909a325f2f7f9a989f", "custom_id": "55-7", "response": {"status_code": 200, "request_id": "e940765c12d9cb7770683d535314b38e", "body": {"id": "chatcmpl-CZRKE7hRu2E5KruXfsMTbtEYHOBXE", "object": "chat.completion", "created": 1762562554, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns from the object table for the specified ZTF oid\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2357, "completion_tokens": 360, "total_tokens": 2717, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 320, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a40688190bf1b454c8f6f3a5e", "custom_id": "55-8", "response": {"status_code": 200, "request_id": "edcf5bdf3d19c2a50ccff7aa9becc0b7", "body": {"id": "chatcmpl-CZRKd3Kvc05GQCH9O2QN9TnbAdXmR", "object": "chat.completion", "created": 1762562579, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the specified ZTF object\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2357, "completion_tokens": 548, "total_tokens": 2905, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a66c88190ac44e1000a91d7bf", "custom_id": "55-9", "response": {"status_code": 200, "request_id": "100202faafa4c68896a1a4e9d192d6f5", "body": {"id": "chatcmpl-CZRKhresJpB7teSc2Jpge6lgh9tWq", "object": "chat.completion", "created": 1762562583, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all information from the 'object' table for the specified ZTF object, using a nested subquery to select the OID\nSELECT *\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2357, "completion_tokens": 387, "total_tokens": 2744, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 320, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a950081909b0fdee79b06adec", "custom_id": "47-5", "response": {"status_code": 200, "request_id": "39beb3f96a17ef1b8c2864d80d6ede52", "body": {"id": "chatcmpl-CZRLBtgVoR1xUT8ALRwTswaYwfz6H", "object": "chat.completion", "created": 1762562613, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Detections for specified ZTF objects with rb > 0.7\n-- Columns returned:\n--  oid (ZTF identifier), candid (candidate id), fid (filter id), mjd (detection date),\n--  isdiffpos flag, ra, dec (detection coordinates), magpsf (difference magnitude),\n--  sigmapsf (difference magnitude uncertainty), rb (real/bogus score)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.rb\nFROM detection d\nWHERE d.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- obtain OIDs in a subquery\n)\nAND d.rb > 0.7\nORDER BY d.oid, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2972, "completion_tokens": 1565, "total_tokens": 4537, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a80a48190a081470d7dfcdda8", "custom_id": "47-6", "response": {"status_code": 200, "request_id": "4518be5359ebd530828a8151d5f1bffa", "body": {"id": "chatcmpl-CZRLAvWxXprqFzyavL2QhzfIlduTi", "object": "chat.completion", "created": 1762562612, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Detections for specific ZTF objects with deep-learning real/bogus (drb) > 0.7\n-- Columns: ZTF identifier (oid), candidate id (candid), filter id (fid), detection date (mjd),\n--          isdiffpos flag, detection RA/Dec, difference magnitude (magpsf) and its uncertainty (sigmapsf), and real/bogus score (drb)\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF23aaawbsc'),\n        ('ZTF21abxlmuw')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.drb\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.drb > 0.7\nORDER BY d.oid, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2490, "completion_tokens": 1757, "total_tokens": 4247, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1536, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a93c88190bac068cb123c6a1d", "custom_id": "47-7", "response": {"status_code": 200, "request_id": "5340f3bc5441b446b390c9203063c84d", "body": {"id": "chatcmpl-CZRM5Lurx9p2ia270r5gEONwQa14s", "object": "chat.completion", "created": 1762562669, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find detections for the specified ZTF objects with real/bogus score > 0.7\n-- Note: Using rb (ZTF real bogus score). If you intended the deep-learning score, replace rb with drb in SELECT and WHERE.\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,         -- ZTF identifier\n    d.candid,      -- candidate identifier\n    d.fid,         -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,         -- detection date (MJD)\n    d.isdiffpos,   -- isdiffpos flag\n    d.ra,          -- detection RA\n    d.dec,         -- detection Dec\n    d.magpsf,      -- difference magnitude (PSF)\n    d.sigmapsf,    -- uncertainty of difference magnitude\n    d.rb           -- real/bogus score\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.rb > 0.7\nORDER BY d.oid, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2972, "completion_tokens": 1796, "total_tokens": 4768, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1536, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a97308190b404b530b9513157", "custom_id": "47-8", "response": {"status_code": 200, "request_id": "9506fe780b96fc461830b6adf4d3d618", "body": {"id": "chatcmpl-CZRAQDzOv1a6RS3YFjmmfLtx1z9CL", "object": "chat.completion", "created": 1762561946, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Detections for the specified ZTF objects with real/bogus score > 0.7\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,        -- ZTF identifier\n    d.candid,     -- candidate identifier\n    d.fid,        -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,        -- detection date (MJD)\n    d.isdiffpos,  -- isdiffpos flag\n    d.ra,         -- detection RA\n    d.dec,        -- detection Dec\n    d.magpsf,     -- difference magnitude\n    d.sigmapsf,   -- uncertainty of difference magnitude\n    d.rb          -- real/bogus score\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.rb > 0.7\nORDER BY d.oid ASC, d.mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2972, "completion_tokens": 1637, "total_tokens": 4609, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5a9e148190a49fbaf7c20e6661", "custom_id": "47-9", "response": {"status_code": 200, "request_id": "2eb1e191546efa9389defdd52252177a", "body": {"id": "chatcmpl-CZRBYFzGoSiNliHVy5Msk1N1wdrwj", "object": "chat.completion", "created": 1762562016, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Detections for the specified ZTF objects with real/bogus score > 0.7\n-- Using COALESCE(drb, rb) to prefer the deep-learning score (drb) when available, otherwise fall back to rb\nSELECT\n    d.oid,          -- ZTF identifier\n    d.candid,       -- candidate identifier\n    d.fid,          -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,          -- detection date (MJD)\n    d.isdiffpos,    -- isdiffpos flag\n    d.ra,           -- detection RA\n    d.dec,          -- detection Dec\n    d.magpsf,       -- difference magnitude\n    d.sigmapsf,     -- uncertainty of difference magnitude\n    COALESCE(d.drb, d.rb) AS real_bogus_score\nFROM detection d\nWHERE d.oid IN (\n    -- Prioritize obtaining OIDs in a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nAND COALESCE(d.drb, d.rb) > 0.7\nORDER BY d.oid, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2972, "completion_tokens": 1750, "total_tokens": 4722, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b106c81909d2c479257478b64", "custom_id": "79-5", "response": {"status_code": 200, "request_id": "217aeeda292847f781c72c12d155df3e", "body": {"id": "chatcmpl-CZRD0nFked56Pbu8OdRYO20eJKMo8", "object": "chat.completion", "created": 1762562106, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get catalog name, catalog object identifier, and angular separation (arcsec) \n-- for the specified ZTF object from the xmatch table\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2005, "completion_tokens": 579, "total_tokens": 2584, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b16b0819081ff6aa8af80e036", "custom_id": "79-6", "response": {"status_code": 200, "request_id": "fbf01129d4a729fd53c09122f80faaec", "body": {"id": "chatcmpl-CZRDaqxgSxLvrvfiPku3fXjN598qb", "object": "chat.completion", "created": 1762562142, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Retrieve catalog name (catid), catalog object identifier (oid_catalog), and distance (dist)\n-- for the specified ZTF object using a subquery to provide the target OID.\nWITH target_oids AS (\n    SELECT 'ZTF20achscch'::varchar AS oid\n)\nSELECT\n    x.catid,\n    x.oid_catalog,\n    x.dist\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM target_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2005, "completion_tokens": 616, "total_tokens": 2621, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b2ed88190b95ebe0737fda09e", "custom_id": "79-7", "response": {"status_code": 200, "request_id": "cf3baea3fff6a4a14b29955bd08fd9d2", "body": {"id": "chatcmpl-CZRE7zlydGsYWmvfCEksgr7vsAo7h", "object": "chat.completion", "created": 1762562175, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get catalog name, catalog object identifier, and distance for the given ZTF object using a subquery for the OID\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20achscch'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2487, "completion_tokens": 653, "total_tokens": 3140, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b43188190befab8f4b7afc998", "custom_id": "79-8", "response": {"status_code": 200, "request_id": "98613e5d9e59f4940bb970fa4e01772d", "body": {"id": "chatcmpl-CZREjeEKvtaZkn0E7dejluhURL8m6", "object": "chat.completion", "created": 1762562213, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get catalog name, catalog object identifier, and distance for a given ZTF object from xmatch\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2005, "completion_tokens": 762, "total_tokens": 2767, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b50dc8190ab57c7c28fe72173", "custom_id": "79-9", "response": {"status_code": 200, "request_id": "ea053e54eda32306e397233bf4096080", "body": {"id": "chatcmpl-CZRFRHqQzqO4MsqsbSr4AUFMy0OfJ", "object": "chat.completion", "created": 1762562257, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return catalog name (catid), object identifier in the catalog (oid_catalog), and distance in arcseconds (dist)\nSELECT x.catid, x.oid_catalog, x.dist\nFROM xmatch x\nWHERE x.oid = (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF20achscch'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2487, "completion_tokens": 660, "total_tokens": 3147, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b81208190ad8095aca383b739", "custom_id": "94-5", "response": {"status_code": 200, "request_id": "442bcee03cab5054508df56ba754d708", "body": {"id": "chatcmpl-CZRGAPnai8JsN5aw4XN1uGp9C88Fj", "object": "chat.completion", "created": 1762562302, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all columns from object and reference for objects with a change in the reference\nWITH refchange_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change IS TRUE\n)\nSELECT o.*, r.*\nFROM object o, reference r\nWHERE o.oid = r.oid\n  AND o.oid IN (SELECT oid FROM refchange_oids)\nLIMIT 50;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2735, "completion_tokens": 1433, "total_tokens": 4168, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b91cc8190935fe748d6ff0df5", "custom_id": "94-6", "response": {"status_code": 200, "request_id": "6aee528fb91d876ed1426024fce3e8f2", "body": {"id": "chatcmpl-CZRHODujXqLlyqTnfnVfOUCPMPjee", "object": "chat.completion", "created": 1762562378, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all columns from object and reference for objects with a change in the reference\n-- Using a nested subquery to first select OIDs from object where reference_change is true\n-- Avoiding explicit JOIN clauses as requested\nSELECT\n  o.*,\n  r.*\nFROM\n  (SELECT * FROM object WHERE reference_change = TRUE) AS o,\n  reference AS r\nWHERE\n  r.oid = o.oid\nLIMIT 50;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2735, "completion_tokens": 1956, "total_tokens": 4691, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1856, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b85948190a428d48def0120dc", "custom_id": "94-7", "response": {"status_code": 200, "request_id": "e555fad5d94c8e6e8f9ae3590edbf5fb", "body": {"id": "chatcmpl-CZRIwzu2jPpljA9pV4qMjZalejUlX", "object": "chat.completion", "created": 1762562474, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all columns from 'object' and 'reference' for objects with a change in the reference, limited to 50 rows\nSELECT o.*, r.*\nFROM (\n    SELECT * \n    FROM object \n    WHERE reference_change = TRUE\n) o,\nreference r\nWHERE r.oid = o.oid\nLIMIT 50;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2735, "completion_tokens": 1165, "total_tokens": 3900, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b8518819088c319a3c051bd5b", "custom_id": "94-8", "response": {"status_code": 200, "request_id": "0ccbec5ab037770a25f9659c42a2aa2f", "body": {"id": "chatcmpl-CZRJuWeqi8fT1NKb0aFht1F3KAdG6", "object": "chat.completion", "created": 1762562534, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all columns from object and reference for objects with a change in the reference, capped at 50 rows\nWITH sel_oids AS (\n  SELECT oid\n  FROM object\n  WHERE reference_change = TRUE\n)\nSELECT o.*, r.*\nFROM sel_oids s\nJOIN object o ON o.oid = s.oid\nJOIN reference r ON r.oid = s.oid\nLIMIT 50;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2735, "completion_tokens": 1245, "total_tokens": 3980, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5b988c81908d92e4ed4e093c75", "custom_id": "94-9", "response": {"status_code": 200, "request_id": "8ebc3c347a740f8c4ebbac874afd9461", "body": {"id": "chatcmpl-CZRL82ZUNsPOotjbaN0dzuwbUM5CH", "object": "chat.completion", "created": 1762562610, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all columns from object and reference for objects with a reference change, limit to 50 rows\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change IS TRUE\n)\nSELECT o.*, r.*\nFROM object o, reference r\nWHERE o.oid = r.oid\n  AND o.oid IN (SELECT oid FROM target_oids)\nLIMIT 50;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2735, "completion_tokens": 1755, "total_tokens": 4490, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1664, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5bfc188190b2b91ccf7bdb0798", "custom_id": "90-5", "response": {"status_code": 200, "request_id": "f3e344c224417c693f7762d00b0c4fd7", "body": {"id": "chatcmpl-CZRMVL4OAFUHiXvJ95Cs7TnmRNZaN", "object": "chat.completion", "created": 1762562695, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return all probability rows for up to 100 objects whose Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P'\n   Only include probabilities from the light curve classifier and with rankings 1 or 2.\n   The LIMIT 100 applies to the number of distinct oids selected from feature (i.e., objects), not to probability rows. */\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4586, "completion_tokens": 1515, "total_tokens": 6101, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5c03788190881462162710c513", "custom_id": "90-6", "response": {"status_code": 200, "request_id": "7de7846b2b4217f245b699acb09d93bb", "body": {"id": "chatcmpl-CZRNzJsZa4ms8QvCN63oELQa1JKMp", "object": "chat.completion", "created": 1762562787, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all probability rows for up to 100 objects with Multiband_period < 5 days\n-- in the specified feature version, restricted to the light curve classifier\n-- and rankings 1 or 2. OIDs are obtained in a subquery (distinct, limited to 100).\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4586, "completion_tokens": 1559, "total_tokens": 6145, "prompt_tokens_details": {"cached_tokens": 4224, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5c1e88819096fc60d005bdaaee", "custom_id": "90-7", "response": {"status_code": 200, "request_id": "981d625f3b0d5ee1f7a6db1de58935b7", "body": {"id": "chatcmpl-CZRPYRqR0cobVDfU0DXadwdIPRmDa", "object": "chat.completion", "created": 1762562884, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return all probability rows for objects with Multiband_period < 5 days\n   computed in feature version 'lc_classifier_1.2.1-P',\n   restricted to the light curve classifier and rankings 1 or 2.\n   The subquery limits to at most 100 distinct objects (OIDs). */\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n      SELECT oid\n      FROM (\n          SELECT DISTINCT f.oid\n          FROM feature f\n          WHERE f.name = 'Multiband_period'\n            AND f.value < 5\n            AND f.version = 'lc_classifier_1.2.1-P'\n      ) o\n      LIMIT 100\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4586, "completion_tokens": 1320, "total_tokens": 5906, "prompt_tokens_details": {"cached_tokens": 4480, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5c30748190bd69864990949805", "custom_id": "90-8", "response": {"status_code": 200, "request_id": "dfe70f25cb823f752732f88621c51d93", "body": {"id": "chatcmpl-CZRQjOR01tW4CozWbCjNST1K6eCyP", "object": "chat.completion", "created": 1762562957, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 100 objects with Multiband_period < 5 days in the specified feature version\nWITH target_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n)\n-- Return all probability rows for those objects, restricted to the light curve classifier and rankings 1 or 2\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.oid IN (SELECT oid FROM target_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4586, "completion_tokens": 2075, "total_tokens": 6661, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1920, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5c42b8819081df921e1087ef37", "custom_id": "90-9", "response": {"status_code": 200, "request_id": "4450fd40b454abf460219787ace87ab0", "body": {"id": "chatcmpl-CZRSgoNIdPt6KynUwIELY3OH1ZmPy", "object": "chat.completion", "created": 1762563078, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return all probability rows for up to 100 objects whose Multiband_period < 5 days\n   measured in the feature version 'lc_classifier_1.2.1-P'.\n   Only include probabilities from the light curve classifier with ranking 1 or 2.\n   OIDs are obtained first via a nested subquery (no JOINs), per guidance. */\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n      SELECT DISTINCT f.oid\n      FROM feature f\n      WHERE f.name = 'Multiband_period'\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.value < 5\n      LIMIT 100\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4586, "completion_tokens": 1447, "total_tokens": 6033, "prompt_tokens_details": {"cached_tokens": 4480, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1280, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5c6c70819089a30f97344e6e04", "custom_id": "51-5", "response": {"status_code": 200, "request_id": "518b897fba23a5021af77028e015e714", "body": {"id": "chatcmpl-CZRUYgIE6u7KljDf6TcpR4EF7wSaQ", "object": "chat.completion", "created": 1762563194, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Epochs for ZTF object 'ZTF24aaiutyh' from forced_photometry, sorted by date (MJD)\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2604, "completion_tokens": 1311, "total_tokens": 3915, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5c74a481908763b99cf4fe2938", "custom_id": "51-6", "response": {"status_code": 200, "request_id": "8dc417a2b13b6bea1687c5bad114194a", "body": {"id": "chatcmpl-CZRVwfkxk9Ckj0o3WG0EL5OWy1YZ6", "object": "chat.completion", "created": 1762563280, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Epochs (forced photometry) for ZTF object ZTF24aaiutyh\n-- Using mjd as the date column and e_mag_corr as the uncertainty of mag_corr (point-like source)\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2604, "completion_tokens": 1069, "total_tokens": 3673, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5c70108190872a1882418f377f", "custom_id": "51-7", "response": {"status_code": 200, "request_id": "3c39686f2cba30e8590d01ef880ec2e1", "body": {"id": "chatcmpl-CZRX9tMoxUWBYSVU9azs6XeLEbQjf", "object": "chat.completion", "created": 1762563355, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find all forced-photometry epochs for the given ZTF object, sorted by time (MJD)\n-- Requested columns mapping:\n-- - object identifier -> oid\n-- - date -> mjd (Modified Julian Date)\n-- - filter identifier -> fid\n-- - difference magnitude and its uncertainty -> mag, e_mag\n-- - corrected magnitude and its uncertainty -> mag_corr, e_mag_corr\n-- - isdiffpos flag -> isdiffpos\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2604, "completion_tokens": 989, "total_tokens": 3593, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5c862c81909c6d73e32daabb80", "custom_id": "51-8", "response": {"status_code": 200, "request_id": "f42041f2d7c72c2ea5546eab377a0417", "body": {"id": "chatcmpl-CZRAYBgIPik6dMoq5t7k5SRsiFq6L", "object": "chat.completion", "created": 1762561954, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return epochs for the given object from forced_photometry, sorted by time (MJD)\nSELECT\n  oid,\n  mjd,\n  fid,\n  mag,\n  e_mag,\n  mag_corr,\n  e_mag_corr,\n  isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2604, "completion_tokens": 726, "total_tokens": 3330, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5c83148190a0ea9c48a2088ce7", "custom_id": "51-9", "response": {"status_code": 200, "request_id": "ce229da138c26326c7344aa8b26a025a", "body": {"id": "chatcmpl-CZRAYmpplG7k6V0JuZhSFCaY71qXI", "object": "chat.completion", "created": 1762561954, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Returning epochs for ZTF object 'ZTF24aaiutyh'\n-- Columns: object identifier (oid), date (mjd), filter identifier (fid),\n-- difference magnitude (mag) and its uncertainty (e_mag),\n-- corrected magnitude (mag_corr) and its uncertainty (e_mag_corr),\n-- and isdiffpos flag. Sorted by date (mjd).\n-- Note: Using e_mag_corr as the uncertainty for corrected magnitude (point-like source).\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2604, "completion_tokens": 928, "total_tokens": 3532, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5d23188190894aae6f94e2c24c", "custom_id": "59-5", "response": {"status_code": 200, "request_id": "b8aa692738be96700a20fc8581e76685", "body": {"id": "chatcmpl-CZRAYwvMoeBnF3hzQqjVD3yG3xQ2r", "object": "chat.completion", "created": 1762561954, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean) for ZTF18acsvogv */\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat m\nWHERE m.oid IN (\n    /* Obtain the OID from the object table (nested subquery as recommended) */\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18acsvogv'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3093, "completion_tokens": 894, "total_tokens": 3987, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5cf7d881908998dd38717a2272", "custom_id": "59-6", "response": {"status_code": 200, "request_id": "88bf096076b27140158c0579e84cb71e", "body": {"id": "chatcmpl-CZRB7xEFIffaEe4eGnWDpoEw5RR7O", "object": "chat.completion", "created": 1762561989, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get ZTF identifier, filter identifier, number of detections, and mean difference magnitude\n-- for the specified ZTF object from the magstat table\nSELECT\n    oid,       -- ZTF identifier\n    fid,       -- filter identifier (1=g; 2=r; 3=i)\n    ndet,      -- number of detections\n    magmean    -- mean difference magnitude\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2611, "completion_tokens": 1003, "total_tokens": 3614, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5d1f048190ba1fd8c3437da876", "custom_id": "59-7", "response": {"status_code": 200, "request_id": "825f7b2ca9b4ae705c1523364aef2cea", "body": {"id": "chatcmpl-CZRBAeKscLi8puQC5KvqT4ZP5FZMw", "object": "chat.completion", "created": 1762561992, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return the requested columns for the specified ZTF object\nWITH targets(oid) AS (\n  VALUES ('ZTF18acsvogv')\n)\nSELECT\n  m.oid,        -- ZTF identifier\n  m.fid,        -- filter identifier (1=g; 2=r; 3=i)\n  m.ndet,       -- number of detections\n  m.magmean     -- mean difference magnitude\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM targets);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2611, "completion_tokens": 944, "total_tokens": 3555, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5d2c208190b839011017a1f412", "custom_id": "59-8", "response": {"status_code": 200, "request_id": "b27b8c88b11197eaae1536336d46f15f", "body": {"id": "chatcmpl-CZRBAtBP0B5uAnf5MSu9qx3fsSEOE", "object": "chat.completion", "created": 1762561992, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get oid (ZTF identifier), fid (filter identifier), ndet (number of detections), and magmean (mean difference magnitude)\nSELECT\n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2611, "completion_tokens": 582, "total_tokens": 3193, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5d32e881908839014d56be5ce4", "custom_id": "59-9", "response": {"status_code": 200, "request_id": "368366b9149cd20a2b1e79664a2d0eab", "body": {"id": "chatcmpl-CZRBYyEhEM5iSGgq2rVTy7j4ZJdGh", "object": "chat.completion", "created": 1762562016, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean)\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat m\nWHERE EXISTS (\n    SELECT 1\n    FROM object o\n    WHERE o.oid = 'ZTF18acsvogv'\n      AND o.oid = m.oid\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3093, "completion_tokens": 872, "total_tokens": 3965, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5d60a881909ba6631d732154aa", "custom_id": "100-5", "response": {"status_code": 200, "request_id": "689c1395a10f426d349c3ef60400efd5", "body": {"id": "chatcmpl-CZRBxZBfDIr0WkUG9aioeUyzviM0t", "object": "chat.completion", "created": 1762562041, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all epochs for ZTF object 'ZTF24aamtvxb' from detection, non_detection, and forced_photometry\n-- Includes: oid, mjd, fid, isdiffpos, detection mag and error, 5-sigma limit, forced mag and error, and the origin table name\nWITH oids AS (\n    SELECT 'ZTF24aamtvxb'::varchar AS oid\n)\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf AS det_mag,\n    d.sigmapsf AS det_mag_err,\n    d.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    n.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    f.diffmaglim,\n    f.mag AS forced_mag,\n    f.e_mag AS forced_mag_err,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY oid, mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3310, "completion_tokens": 2255, "total_tokens": 5565, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1856, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5d62008190971b179158478fac", "custom_id": "100-6", "response": {"status_code": 200, "request_id": "3d2e7b2faf0dbf8e749dd18f45182ce1", "body": {"id": "chatcmpl-CZRCAJHOKRjatVFUQNHF6dMZtapn1", "object": "chat.completion", "created": 1762562054, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return detections, non-detections, and forced photometry for the given ZTF object in a single table\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid,                  -- ZTF identifier\n    d.mjd,                  -- epoch date\n    d.fid,                  -- filter identifier\n    d.isdiffpos,            -- isdiffpos flag\n    d.magpsf AS det_mag,    -- detection difference magnitude\n    d.sigmapsf AS det_mag_err, -- detection magnitude uncertainty\n    d.diffmaglim,           -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- forced difference magnitude (not applicable)\n    NULL::double precision AS forced_mag_err,  -- forced magnitude uncertainty (not applicable)\n    'detection'::text AS \"table\"               -- origin table\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,                  -- ZTF identifier\n    n.mjd,                  -- epoch date\n    n.fid,                  -- filter identifier\n    NULL::integer AS isdiffpos,        -- isdiffpos flag (not available)\n    NULL::double precision AS det_mag, -- detection difference magnitude (not available)\n    NULL::double precision AS det_mag_err, -- detection magnitude uncertainty (not available)\n    n.diffmaglim,           -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- forced difference magnitude (not applicable)\n    NULL::double precision AS forced_mag_err,  -- forced magnitude uncertainty (not applicable)\n    'non_detection'::text AS \"table\"           -- origin table\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,                  -- ZTF identifier\n    f.mjd,                  -- epoch date\n    f.fid,                  -- filter identifier\n    f.isdiffpos,            -- isdiffpos flag\n    NULL::double precision AS det_mag, -- detection difference magnitude (not applicable)\n    NULL::double precision AS det_mag_err, -- detection magnitude uncertainty (not applicable)\n    f.diffmaglim,           -- 5-sigma magnitude limit\n    f.mag AS forced_mag,    -- forced difference magnitude\n    f.e_mag AS forced_mag_err, -- forced magnitude uncertainty\n    'forced_photometry'::text AS \"table\"      -- origin table\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3792, "completion_tokens": 2358, "total_tokens": 6150, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5d613c8190b408f7bef73a343a", "custom_id": "100-7", "response": {"status_code": 200, "request_id": "5ae45cd7fab616ba40438b29e8271ec5", "body": {"id": "chatcmpl-CZRCHBbQ6IkuujRjJBxwy1KO55knm", "object": "chat.completion", "created": 1762562061, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH target (oid) AS (\n    VALUES ('ZTF24aamtvxb')\n)\n-- Detections\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    d.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target)\n\nUNION ALL\n\n-- Non-detections\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    n.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM target)\n\nUNION ALL\n\n-- Forced photometry\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    f.diffmaglim,\n    f.mag,\n    f.e_mag,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM target)\n\nORDER BY mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3310, "completion_tokens": 2566, "total_tokens": 5876, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5d6ff48190a6c1987d95256931", "custom_id": "100-8", "response": {"status_code": 200, "request_id": "1f41d524b44af85a76c142da16ad57a7", "body": {"id": "chatcmpl-CZRDGKSkA6K6a5NloZIz51gX8d2ah", "object": "chat.completion", "created": 1762562122, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Detections\nSELECT\n    d.oid,                     -- ZTF identifier\n    d.mjd,                     -- epoch date (MJD)\n    d.fid,                     -- filter identifier (1=g; 2=r; 3=i)\n    d.isdiffpos,               -- isdiffpos flag\n    d.magpsf AS detection_mag, -- detection difference magnitude\n    d.sigmapsf AS detection_mag_err, -- detection magnitude uncertainty\n    d.diffmaglim,              -- 5-sigma magnitude limit\n    NULL::DOUBLE PRECISION AS forced_mag,      -- forced difference magnitude (N/A for detections)\n    NULL::DOUBLE PRECISION AS forced_mag_err,  -- forced magnitude uncertainty (N/A for detections)\n    'detection'::TEXT AS \"table\"               -- origin table\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n\nUNION ALL\n\n-- Non-detections\nSELECT\n    nd.oid,                    -- ZTF identifier\n    nd.mjd,                    -- epoch date (MJD)\n    nd.fid,                    -- filter identifier (1=g; 2=r; 3=i)\n    NULL::INTEGER AS isdiffpos, -- isdiffpos flag (N/A for non-detections)\n    NULL::DOUBLE PRECISION AS detection_mag,     -- detection difference magnitude (N/A)\n    NULL::DOUBLE PRECISION AS detection_mag_err, -- detection magnitude uncertainty (N/A)\n    nd.diffmaglim,             -- 5-sigma magnitude limit\n    NULL::DOUBLE PRECISION AS forced_mag,        -- forced difference magnitude (N/A)\n    NULL::DOUBLE PRECISION AS forced_mag_err,    -- forced magnitude uncertainty (N/A)\n    'non_detection'::TEXT AS \"table\"             -- origin table\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM target_oids)\n\nUNION ALL\n\n-- Forced photometry\nSELECT\n    f.oid,                     -- ZTF identifier\n    f.mjd,                     -- epoch date (MJD)\n    f.fid,                     -- filter identifier (1=g; 2=r; 3=i)\n    f.isdiffpos,               -- isdiffpos flag\n    NULL::DOUBLE PRECISION AS detection_mag,     -- detection difference magnitude (N/A for forced photometry)\n    NULL::DOUBLE PRECISION AS detection_mag_err, -- detection magnitude uncertainty (N/A for forced photometry)\n    f.diffmaglim,              -- 5-sigma magnitude limit\n    f.mag AS forced_mag,       -- forced difference magnitude\n    f.e_mag AS forced_mag_err, -- forced magnitude uncertainty\n    'forced_photometry'::TEXT AS \"table\"         -- origin table\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM target_oids)\n\nORDER BY mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3792, "completion_tokens": 2807, "total_tokens": 6599, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2176, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5d71348190b5136f93a7d45efd", "custom_id": "100-9", "response": {"status_code": 200, "request_id": "9b9e84d8f12f5b9ca2430025d8322d6b", "body": {"id": "chatcmpl-CZREJGAa4P2ikBITbNG6K1tcTWcon", "object": "chat.completion", "created": 1762562187, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* All epochs (detections, non-detections, forced photometry) for the object 'ZTF24aamtvxb'\n   Columns:\n   - oid: ZTF identifier\n   - mjd: epoch date\n   - fid: filter identifier (1=g; 2=r; 3=i)\n   - isdiffpos: sign of difference flux (NULL for non-detections)\n   - det_mag: detection difference magnitude (magpsf)\n   - det_mag_err: detection magnitude uncertainty (sigmapsf)\n   - diffmaglim: 5-sigma magnitude limit\n   - forced_mag: forced photometry difference magnitude (mag)\n   - forced_mag_err: forced photometry magnitude uncertainty (e_mag)\n   - \"table\": source table name for each epoch\n*/\nWITH target AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid AS oid,\n    d.mjd AS mjd,\n    d.fid AS fid,\n    d.isdiffpos AS isdiffpos,\n    d.magpsf AS det_mag,\n    d.sigmapsf AS det_mag_err,\n    d.diffmaglim AS diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid = (SELECT oid FROM target)\n\nUNION ALL\n\nSELECT\n    nd.oid,\n    nd.mjd,\n    nd.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    nd.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'non_detection'::text AS \"table\"\nFROM non_detection nd\nWHERE nd.oid = (SELECT oid FROM target)\n\nUNION ALL\n\nSELECT\n    fp.oid,\n    fp.mjd,\n    fp.fid,\n    fp.isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    fp.diffmaglim,\n    fp.mag AS forced_mag,\n    fp.e_mag AS forced_mag_err,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry fp\nWHERE fp.oid = (SELECT oid FROM target)\n\nORDER BY mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3792, "completion_tokens": 3014, "total_tokens": 6806, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5de7b0819093bf2f44a60d7c02", "custom_id": "106-5", "response": {"status_code": 200, "request_id": "893e689327791d63cc4bddc29323472b", "body": {"id": "chatcmpl-CZREZdBzURf3qYqziOdy2icmG3N6C", "object": "chat.completion", "created": 1762562203, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return requested columns and order by oid.\nWITH valid_oids AS (\n    SELECT DISTINCT p_bogus.oid\n    FROM probability p_bogus\n    WHERE p_bogus.classifier_name = 'stamp_classifier'\n      AND p_bogus.classifier_version = 'stamp_classifier_1.0.4'\n      AND p_bogus.class_name = 'bogus'\n      AND p_bogus.probability > 0.7\n      AND EXISTS (\n          SELECT 1\n          FROM probability p_top\n          WHERE p_top.oid = p_bogus.oid\n            AND p_top.classifier_name = 'lc_classifier_top'\n            AND p_top.class_name = 'Transient'\n            AND p_top.probability > 0.9\n      )\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of 'bogus' in stamp_classifier v1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Highest 'Transient' probability in lc_classifier_top (any version) */\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'lc_classifier_top'\n          AND p2.class_name = 'Transient'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (SELECT oid FROM valid_oids)\nORDER BY o.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2778, "completion_tokens": 2832, "total_tokens": 5610, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2368, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5e15f481909cc258d1729df5a7", "custom_id": "106-6", "response": {"status_code": 200, "request_id": "ef0483886228ff10d2057f4e71e379ff", "body": {"id": "chatcmpl-CZRFRM6AzBzDbjME32kbH3yQGeCKi", "object": "chat.completion", "created": 1762562257, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4, and Transient prob > 0.9 in lc_classifier_top.\n   For lc_classifier_top we return the highest available probability across versions if multiple exist. */\nWITH\nstamp_bogus AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'bogus'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.7\n),\nlc_trans AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of 'bogus' in stamp_classifier v1.0.4 (return the highest if duplicated entries exist) */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'bogus'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Highest probability of 'Transient' in lc_classifier_top across available versions */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (SELECT oid FROM stamp_bogus)\n  AND o.oid IN (SELECT oid FROM lc_trans)\nORDER BY o.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2661, "completion_tokens": 2950, "total_tokens": 5611, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5e1cdc819092b352fbca1e9bbf", "custom_id": "106-7", "response": {"status_code": 200, "request_id": "996e8868f8c3acd2f3b5c6d8986735d4", "body": {"id": "chatcmpl-CZRGhEn4ndkZtTCwkIFHtFqpwEcKw", "object": "chat.completion", "created": 1762562335, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier_1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return requested columns and order by oid.\nWITH stamp_bogus AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n),\nlc_transient AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of bogus in stamp_classifier_1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Max probability of Transient in lc_classifier_top across available versions */\n    (\n        SELECT MAX(p.probability)\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (SELECT oid FROM stamp_bogus)\n  AND o.oid IN (SELECT oid FROM lc_transient)\nORDER BY o.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2661, "completion_tokens": 2784, "total_tokens": 5445, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2368, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5e27c08190bd35fcb5e5a71659", "custom_id": "106-8", "response": {"status_code": 200, "request_id": "f19bf48b008997a39365064a035c6185", "body": {"id": "chatcmpl-CZRGnGk7TsITU7Sf96KHJ3Sys5MRR", "object": "chat.completion", "created": 1762562341, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 ZTF objects with:\n-- - ndet > 10\n-- - stamp_classifier v1.0.4 bogus probability > 0.7\n-- - lc_classifier_top Transient probability > 0.9\n-- Return: ZTF identifier, number of detections, first detection date,\n--         prob_stamp_bogus, prob_lc_transient\nWITH objects_ndet AS (\n    SELECT oid\n    FROM object\n    WHERE ndet > 10\n),\nbogus_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n),\ntransient_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n),\ncandidate_oids AS (\n    SELECT oid FROM objects_ndet\n    INTERSECT\n    SELECT oid FROM bogus_oids\n    INTERSECT\n    SELECT oid FROM transient_oids\n)\nSELECT\n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    o.firstmjd AS first_detection_date,\n    -- Stamp classifier bogus probability (specific version)\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    -- Top-level LC Transient probability (any version)\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'lc_classifier_top'\n          AND p2.class_name = 'Transient'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.oid IN (SELECT oid FROM candidate_oids)\nORDER BY ztf_identifier\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2706, "completion_tokens": 2368, "total_tokens": 5074, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1856, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5e2fcc81908289d887ff41251e", "custom_id": "106-9", "response": {"status_code": 200, "request_id": "fa6d48452e565e43073521cb152e0e2b", "body": {"id": "chatcmpl-CZRHN3MHxCzhOdXH6FBvUM54WjWAO", "object": "chat.completion", "created": 1762562377, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find ZTF objects with ndet>10, bogus prob>0.7 for stamp_classifier v1.0.4, and Transient prob>0.9 for lc_classifier_top\nWITH bogus_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n),\ntransient_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n),\nselected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 10\n      AND o.oid IN (SELECT oid FROM bogus_oids)\n      AND o.oid IN (SELECT oid FROM transient_oids)\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of being bogus in stamp classifier v1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Highest probability of being Transient in lc_classifier_top (any version) */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_oids)\nORDER BY o.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2706, "completion_tokens": 3708, "total_tokens": 6414, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5e503c819092466ec33866ab9d", "custom_id": "56-5", "response": {"status_code": 200, "request_id": "f4ea8555e8b76ff4344b20ec0033ca32", "body": {"id": "chatcmpl-CZRIiopRPmtt7Qt6qCQP95ZIC50Mg", "object": "chat.completion", "created": 1762562460, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects among the given ZTF OIDs where the corrected light curve was not computed (corrected IS NOT TRUE)\n-- Returns: oid, ndet, mean coordinates, first/last detection dates, g-r mean difference magnitudes (raw and corrected)\nSELECT\n    o.oid,                 -- ZTF identifier\n    o.ndet,                -- number of detections\n    o.meanra,              -- mean RA\n    o.meandec,             -- mean Dec\n    o.firstmjd,            -- date of first detection\n    o.lastmjd,             -- date of last detection\n    o.g_r_mean,            -- difference between mean g- and r-band difference magnitudes\n    o.g_r_mean_corr        -- difference between mean g- and r-band corrected magnitudes\nFROM object o\nWHERE o.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n      AND corrected IS NOT TRUE  -- includes FALSE or NULL (not computed)\n)\nORDER BY o.firstmjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3160, "completion_tokens": 1653, "total_tokens": 4813, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5e548081908e6d024d6ff96010", "custom_id": "56-6", "response": {"status_code": 200, "request_id": "3b0891594999f1212c42c2731a4dcc81", "body": {"id": "chatcmpl-CZRJ2DtN5UZJHzAapNnr8nBfcsGwH", "object": "chat.completion", "created": 1762562480, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get specified ZTF objects whose corrected light curve was not computed\nWITH selected_oids AS (\n    -- Prioritize obtaining OIDs in a subquery from the object table\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n)\nSELECT\n    oid,                 -- ZTF identifier\n    ndet,                -- number of detections\n    meanra,              -- mean RA\n    meandec,             -- mean Dec\n    firstmjd,            -- date of first detection\n    lastmjd,             -- date of last detection\n    g_r_mean,            -- difference between mean g- and r-band difference magnitudes\n    g_r_mean_corr        -- difference between mean g- and r-band corrected magnitudes\nFROM object\nWHERE corrected IS FALSE\n  AND oid IN (SELECT oid FROM selected_oids)\nORDER BY firstmjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3160, "completion_tokens": 1172, "total_tokens": 4332, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5e5554819094a5d58257299679", "custom_id": "56-7", "response": {"status_code": 200, "request_id": "2453e1c49e6188c73bb8edf113609eb4", "body": {"id": "chatcmpl-CZRJrcRcBl1f0PqHnR5GllnsIJc2Y", "object": "chat.completion", "created": 1762562531, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with specified ZTF oids where corrected light curve was not computed (object.corrected = false)\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n)\nSELECT\n    o.oid,             -- ZTF identifier\n    o.ndet,            -- number of detections\n    o.meanra,          -- mean RA\n    o.meandec,         -- mean Dec\n    o.firstmjd,        -- first detection date (MJD)\n    o.lastmjd,         -- last detection date (MJD)\n    o.g_r_mean,        -- mean g - r difference magnitude\n    o.g_r_mean_corr    -- mean g - r corrected magnitude\nFROM object o\nWHERE o.oid IN (SELECT oid FROM target_oids)\n  AND o.corrected = false\nORDER BY o.firstmjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2991, "completion_tokens": 1558, "total_tokens": 4549, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5e5ba481909bf6a8720b3d293d", "custom_id": "56-8", "response": {"status_code": 200, "request_id": "07a87a5e6023029e6107d50f8b9aabb2", "body": {"id": "chatcmpl-CZRAZVzCnQT8LGAAKj0kUbmT3nDal", "object": "chat.completion", "created": 1762561955, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects among the specified ZTF IDs where the corrected light curve was not computed (corrected is false or null)\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    o.oid,         -- ZTF identifier\n    o.ndet,        -- number of detections\n    o.meanra,      -- mean RA\n    o.meandec,     -- mean Dec\n    o.firstmjd,    -- date of first detection\n    o.lastmjd,     -- date of last detection\n    o.g_r_mean,    -- difference between mean g- and r-band difference magnitudes\n    o.g_r_mean_corr -- difference between mean g- and r-band corrected magnitudes\nFROM object o\nWHERE o.oid IN (SELECT oid FROM target_oids)\n  AND o.corrected IS DISTINCT FROM TRUE\nORDER BY o.firstmjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2991, "completion_tokens": 1692, "total_tokens": 4683, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5e61488190b728eb77cea66280", "custom_id": "56-9", "response": {"status_code": 200, "request_id": "4d8de33f18d5bb64a7a22cfbafa397ed", "body": {"id": "chatcmpl-CZRAZxx0gQna6VFYQQtpBmDORUhr4", "object": "chat.completion", "created": 1762561955, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return selected ZTF objects where the corrected light curve was not computed (object.corrected IS NOT TRUE)\n-- Using a subquery to provide the OIDs (no JOINs as per guidance), and sorting by first detection date (firstmjd)\nWITH oids (oid) AS (\n    VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    o.oid,            -- ZTF identifier\n    o.ndet,           -- number of detections\n    o.meanra,         -- mean RA\n    o.meandec,        -- mean Dec\n    o.firstmjd,       -- date of first detection\n    o.lastmjd,        -- date of last detection\n    o.g_r_mean,       -- mean g-r difference magnitudes\n    o.g_r_mean_corr   -- mean g-r corrected magnitudes\nFROM object o\nWHERE o.oid IN (SELECT oid FROM oids)\n  AND o.corrected IS NOT TRUE\nORDER BY o.firstmjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2991, "completion_tokens": 1451, "total_tokens": 4442, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5eede08190af76efb19e7b8b77", "custom_id": "48-5", "response": {"status_code": 200, "request_id": "053936d8a04d77006e781fdca5e534d0", "body": {"id": "chatcmpl-CZRAYIDvhptyHfAuUyQjRXZiR6tmm", "object": "chat.completion", "created": 1762561954, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all features for the ZTF object 'ZTF18abqyaix'\n-- Columns returned: oid (ZTF identifier), name (feature name), value (feature value), fid (filter identifier), version (feature version)\n-- Sorted by ZTF identifier (oid), filter identifier (fid), and feature version (version)\nSELECT\n    oid,\n    name,\n    value,\n    fid,\n    version\nFROM feature\nWHERE oid IN (\n    -- Obtain the OID in a subquery as per optimization guideline\n    SELECT oid\n    FROM feature\n    WHERE oid = 'ZTF18abqyaix'\n)\nORDER BY oid, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4383, "completion_tokens": 1362, "total_tokens": 5745, "prompt_tokens_details": {"cached_tokens": 3968, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5f051881908ecde3badd0f2325", "custom_id": "48-6", "response": {"status_code": 200, "request_id": "199579a7651a2071e1ac020423b50f70", "body": {"id": "chatcmpl-CZRAZSOP0L0fijw2UQ5ggQrlWNUwW", "object": "chat.completion", "created": 1762561955, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all features for the specified ZTF object, using a nested subquery to obtain the OID\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,\n    f.fid,\n    f.version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4865, "completion_tokens": 1133, "total_tokens": 5998, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5f093081909ef60a0b31c0ca69", "custom_id": "48-7", "response": {"status_code": 200, "request_id": "0975efdde3e1a9eff5b21f1b77a565ea", "body": {"id": "chatcmpl-CZRBpwktdLFzurri7XvKpQCCDMKsQ", "object": "chat.completion", "created": 1762562033, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all features for the specified ZTF object, ordered by ZTF identifier, filter identifier, and feature version\nSELECT\n    f.oid,     -- ZTF identifier\n    f.name,    -- feature name\n    f.value,   -- feature value\n    f.fid,     -- filter identifier (1=g, 2=r, 3=i, 12=gr, 13=gi, 23=ri, 123=gri)\n    f.version  -- feature version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY f.oid, f.fid, f.version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4865, "completion_tokens": 995, "total_tokens": 5860, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5f19d08190ba8a2b08711cb0b1", "custom_id": "48-8", "response": {"status_code": 200, "request_id": "0ea48be48b997cf76647a98aa6464b54", "body": {"id": "chatcmpl-CZRBsM10NCErVXKGs3ajl7yRrYPMr", "object": "chat.completion", "created": 1762562036, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all features for a specific ZTF object, returning requested columns\nSELECT\n    f.oid,         -- ZTF identifier\n    f.name,        -- feature name\n    f.value,       -- feature value\n    f.fid,         -- filter identifier\n    f.version      -- feature version\nFROM feature f\nWHERE f.oid IN (\n    -- Obtain the OID from the object table (nested subquery as per guidelines)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,         -- sort by ZTF identifier\n    f.fid,         -- then by filter identifier\n    f.version;     -- then by feature version", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4865, "completion_tokens": 742, "total_tokens": 5607, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5f26c88190ae84ba25282e4478", "custom_id": "48-9", "response": {"status_code": 200, "request_id": "fa7eabb9412411dfbe1ddd858c32663e", "body": {"id": "chatcmpl-CZRBxAbFXsyi88UnsAdwnYLEYAmLG", "object": "chat.completion", "created": 1762562041, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all features for the specified ZTF object, returning the requested columns\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,\n    f.fid,\n    f.version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4865, "completion_tokens": 871, "total_tokens": 5736, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5f3cdc81909ab8689e3f5be63f", "custom_id": "58-5", "response": {"status_code": 200, "request_id": "3cd0030098a4acdd59a07ed328e4be65", "body": {"id": "chatcmpl-CZRC4I4CqSSYF7WueerR0PqdrzGXZ", "object": "chat.completion", "created": 1762562048, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get up to 20 objects with:\n-- - at least 30 detections (object.ndet >= 30)\n-- - time span between first and last detection > 20 days (object.deltajd > 20)\n-- - absolute difference between minimum corrected g and r magnitudes > 3.5\n--   (Assumption: use ABS(min_g - min_r) > 3.5; change if a signed difference is desired.)\nWITH base_oids AS (\n  SELECT oid\n  FROM object\n  WHERE ndet >= 30\n    AND deltajd > 20\n), good_color_oids AS (\n  SELECT oid\n  FROM detection\n  WHERE oid IN (SELECT oid FROM base_oids)\n  GROUP BY oid\n  HAVING\n    MIN(CASE WHEN fid = 1 THEN magpsf_corr END) IS NOT NULL\n    AND MIN(CASE WHEN fid = 2 THEN magpsf_corr END) IS NOT NULL\n    AND ABS(\n      MIN(CASE WHEN fid = 1 THEN magpsf_corr END)\n      - MIN(CASE WHEN fid = 2 THEN magpsf_corr END)\n    ) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM good_color_oids)\nLIMIT 20;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2948, "completion_tokens": 1814, "total_tokens": 4762, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1536, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5f465881909a9752b54526acce", "custom_id": "58-6", "response": {"status_code": 200, "request_id": "22c9482a67ba2bf546e06d6ef8bfc367", "body": {"id": "chatcmpl-CZRCY8jp675sSjiwPkVOMOHj7N6ML", "object": "chat.completion", "created": 1762562078, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 2948, "completion_tokens": 4000, "total_tokens": 6948, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5f59b081908f8eb321132cc365", "custom_id": "58-7", "response": {"status_code": 200, "request_id": "e5bc4400460733fb2bcaafe545cac6f3", "body": {"id": "chatcmpl-CZRCfVCLaXoohcSfpVa2W5Z0lklko", "object": "chat.completion", "created": 1762562085, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return at most 20 objects meeting:\n   - at least 30 detections (ndet >= 30)\n   - time span > 20 days (deltajd > 20)\n   - absolute difference between the minimum corrected magnitudes in g (fid=1) and r (fid=2) > 3.5\n*/\nSELECT *\nFROM object\nWHERE oid IN (\n    /* Preselect OIDs from object table meeting ndet and deltajd constraints */\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 30\n      AND o.deltajd > 20\n      AND o.oid IN (\n          /* OIDs whose |min_g_corr - min_r_corr| > 3.5 using magpsf_corr per band */\n          SELECT oid\n          FROM (\n              SELECT d.oid,\n                     MIN(CASE WHEN d.fid = 1 AND d.magpsf_corr IS NOT NULL THEN d.magpsf_corr END) AS min_g_corr,\n                     MIN(CASE WHEN d.fid = 2 AND d.magpsf_corr IS NOT NULL THEN d.magpsf_corr END) AS min_r_corr\n              FROM detection d\n              GROUP BY d.oid\n          ) m\n          WHERE m.min_g_corr IS NOT NULL\n            AND m.min_r_corr IS NOT NULL\n            AND ABS(m.min_g_corr - m.min_r_corr) > 3.5\n      )\n)\nLIMIT 20;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2948, "completion_tokens": 3067, "total_tokens": 6015, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2752, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5f4e7481908af2977f814c3166", "custom_id": "58-8", "response": {"status_code": 200, "request_id": "af269a991f4fa1ecc4e83a1c790a7fc0", "body": {"id": "chatcmpl-CZRCt20dEOEDRjHXm5z7J6CVlZk0i", "object": "chat.completion", "created": 1762562099, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get at most 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days (difference between last and first detection times)\n-- - absolute difference between the minimum corrected magnitudes in g (fid=1) and r (fid=2) bands > 3.5\n-- Note: We use conditional aggregation on detection without explicit non-oid filters, and select all columns from object.\nWITH oids_with_large_gr_diff AS (\n    SELECT\n        d.oid\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n    HAVING\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) IS NOT NULL\n        AND MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) IS NOT NULL\n        AND ABS(\n            MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END)\n            - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END)\n        ) > 3.5\n)\nSELECT\n    *\nFROM\n    object o\nWHERE\n    o.oid IN (SELECT oid FROM oids_with_large_gr_diff)\n    AND o.ndet >= 30\n    AND o.deltajd > 20\nLIMIT 20;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2948, "completion_tokens": 2078, "total_tokens": 5026, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5f50908190a6d38ff3d3294eb4", "custom_id": "58-9", "response": {"status_code": 200, "request_id": "67d1d860c90ed4b06cf166e3a04bd9f6", "body": {"id": "chatcmpl-CZRD7mPJ4ElbUPqHCnGhk2QWoimwu", "object": "chat.completion", "created": 1762562113, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get at most 20 objects with:\n-- - at least 30 detections (ndet >= 30)\n-- - time span between last and first detection > 20 days (deltajd > 20)\n-- - absolute difference between the minimum corrected g- and r-band magnitudes > 3.5\n--   (computed from detection.magpsf_corr with fid=1 for g and fid=2 for r, using only corrected and non-dubious detections)\nSELECT *\nFROM object o\nWHERE o.ndet >= 30\n  AND o.deltajd > 20\n  AND ABS(\n        (SELECT MIN(dg.magpsf_corr)\n         FROM detection dg\n         WHERE dg.oid = o.oid\n           AND dg.fid = 1\n           AND dg.corrected = TRUE\n           AND dg.dubious = FALSE)\n        -\n        (SELECT MIN(dr.magpsf_corr)\n         FROM detection dr\n         WHERE dr.oid = o.oid\n           AND dr.fid = 2\n           AND dr.corrected = TRUE\n           AND dr.dubious = FALSE)\n      ) > 3.5\nLIMIT 20;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2948, "completion_tokens": 2176, "total_tokens": 5124, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1920, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5feec881908a1e6ea20c04bbb4", "custom_id": "78-5", "response": {"status_code": 200, "request_id": "08140a4589c4af8e6a6c5ac366816a01", "body": {"id": "chatcmpl-CZRE7rbk40uLj8C1zbp9ljsjIMK7h", "object": "chat.completion", "created": 1762562175, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1926, "completion_tokens": 304, "total_tokens": 2230, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 256, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb5ffd8c81909e9735368c044a41", "custom_id": "78-6", "response": {"status_code": 200, "request_id": "f6f482d01d38247c7405bd77fe771e5e", "body": {"id": "chatcmpl-CZREO8dGl5ccJZM9IwUipFOVw26c8", "object": "chat.completion", "created": 1762562192, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1926, "completion_tokens": 368, "total_tokens": 2294, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 320, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb600600819098b9f438f8ebd578", "custom_id": "78-7", "response": {"status_code": 200, "request_id": "33bc9946d0fdd88337654d7a0a5acdd3", "body": {"id": "chatcmpl-CZREVGxfZ2KkSbcII1gjLhGf1wlMe", "object": "chat.completion", "created": 1762562199, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1926, "completion_tokens": 623, "total_tokens": 2549, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb6008f88190b482767b3c8ccccb", "custom_id": "78-8", "response": {"status_code": 200, "request_id": "f5dac21b3fc0730794e55590bc482b18", "body": {"id": "chatcmpl-CZREhC6i1CMUZxo6FaMMUkZQ6EgB4", "object": "chat.completion", "created": 1762562211, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n  classifier_name,\n  classifier_version,\n  classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1926, "completion_tokens": 560, "total_tokens": 2486, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb601964819094b39138dfe8ad4c", "custom_id": "78-9", "response": {"status_code": 200, "request_id": "607e6c5049b1d93cdecb8edd7b481481", "body": {"id": "chatcmpl-CZRF4snofwmBMdiiU4vFQvX9p0N46", "object": "chat.completion", "created": 1762562234, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1926, "completion_tokens": 240, "total_tokens": 2166, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 192, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb602b10819081af4bc0b8ed2331", "custom_id": "39-5", "response": {"status_code": 200, "request_id": "c0a19fa44d4ab4849cca0540ea433388", "body": {"id": "chatcmpl-CZRFAPpyfUHtKW6o11eF6GeqzZYE0", "object": "chat.completion", "created": 1762562240, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get r-band detections for objects whose top-ranked class is CV/Nova by the stochastic LC classifier,\n-- with at most 50 detections overall. Return requested columns and compute the maximum rise from minimum\n-- (range of corrected PSF magnitudes in r) per object. Limit to first 1000 rows ordered by object id.\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 50\n      AND oid IN (\n          SELECT oid\n          FROM probability\n          WHERE classifier_name = 'lc_classifier_stochastic'\n            AND class_name = 'CV/Nova'\n            AND ranking = 1\n      )\n),\nr_detections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf_corr AS magpsf_corr_r,\n        d.sigmapsf_corr AS sigmapsf_corr_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM oids)\n      AND d.fid = 2                  -- r-band\n      AND d.corrected = TRUE         -- ensure using corrected magnitudes\n)\nSELECT\n    oid AS object_identifier,\n    candid AS candidate_identifier,\n    f_id,\n    ra,\n    dec,\n    magpsf_corr_r AS magnitude_r_psf_corr,       -- corrected difference magnitude (r)\n    sigmapsf_corr_r AS magnitude_error_r_psf_corr,\n    magpsf_corr_r AS psf_corrected_mag_r,        -- PSF corrected magnitude in r-filter (explicit column)\n    (MAX(magpsf_corr_r) OVER (PARTITION BY oid) - MIN(magpsf_corr_r) OVER (PARTITION BY oid)) AS max_rise_from_min_r\nFROM r_detections\nORDER BY object_identifier, candidate_identifier\nLIMIT 1000;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3232, "completion_tokens": 3726, "total_tokens": 6958, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3328, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb604ac481909b58bf7a48b9d040", "custom_id": "39-6", "response": {"status_code": 200, "request_id": "fdd67638096b1e00ba07d37c1003bb56", "body": {"id": "chatcmpl-CZRFAbAyatNPtbDzYSwjcVl0xHLiY", "object": "chat.completion", "created": 1762562240, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* \nReturn:\n- object identifier (oid)\n- candidate identifier (candid)\n- filter id as f_id\n- coordinates (ra, dec)\n- magnitude (PSF difference magnitude) and its error\n- corrected difference magnitude in r-band and its error\n- PSF corrected magnitude in r-band\n- per-object maximum rise from minimum (amplitude) in r-band using PSF-corrected magnitudes\n\nFilters:\n- Keep only objects whose top-ranked class (ranking=1) under the stochastic light curve classifier is 'CV/Nova'\n- Keep only objects with ndet <= 50\n- Only r-band detections (fid = 2)\n\nNotes:\n- No explicit JOINs; OIDs are obtained via nested subqueries for probability and object.\n*/\n\nSELECT\n    q.oid,\n    q.candid,\n    q.fid AS f_id,\n    q.ra,\n    q.dec,\n    q.magpsf AS mag,\n    q.sigmapsf AS mag_err,\n    q.magpsf_corr AS corr_diff_mag_r,\n    q.sigmapsf_corr AS corr_diff_mag_err_r,\n    q.magpsf_corr AS psf_corrected_mag_r,\n    (q.max_magpsf_corr_r - q.min_magpsf_corr_r) AS max_rise_from_min_r\nFROM (\n    SELECT\n        d.*,\n        MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS min_magpsf_corr_r,\n        MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_magpsf_corr_r\n    FROM detection d\n    WHERE d.fid = 2  -- r-band\n      AND d.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet <= 50\n      )\n      AND d.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'lc_classifier_stochastic'\n            AND p.class_name = 'CV/Nova'\n            AND p.ranking = 1\n      )\n) q\nORDER BY q.oid\nLIMIT 1000;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3232, "completion_tokens": 3459, "total_tokens": 6691, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3008, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb604b948190a6657b70aa2bea9c", "custom_id": "39-7", "response": {"status_code": 200, "request_id": "350f47894b881439c7915aac142028c3", "body": {"id": "chatcmpl-CZRFNyzt7kKb6SpO35roUMJIGStHW", "object": "chat.completion", "created": 1762562253, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Objects whose top-ranked class (ranking=1) is 'CV/Nova' under the stochastic light curve classifier,\n   with at most 50 detections overall (object.ndet <= 50). Then, for r-band detections (fid=2),\n   return object and detection identifiers, filter id (as f_id), coordinates, magnitudes and their errors,\n   including corrected PSF magnitudes, and compute per-object maximum rise from minimum (using magpsf_corr)\n   within the r-band. Limit to the first 1000 rows ordered by object identifier. */\nSELECT\n    d.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,            -- PSF difference magnitude\n    d.sigmapsf,          -- PSF difference magnitude error\n    d.magpsf_corr,       -- corrected (PSF) magnitude in r-band\n    d.sigmapsf_corr,     -- error of corrected (PSF) magnitude\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_r\nFROM detection d\nWHERE\n    d.fid = 2  -- r-band\n    AND d.oid IN (\n        SELECT o.oid\n        FROM object o\n        WHERE\n            o.ndet <= 50\n            AND o.oid IN (\n                SELECT p.oid\n                FROM probability p\n                WHERE\n                    p.classifier_name = 'lc_classifier_stochastic'\n                    AND p.class_name = 'CV/Nova'\n                    AND p.ranking = 1\n            )\n    )\nORDER BY d.oid\nLIMIT 1000;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3232, "completion_tokens": 3642, "total_tokens": 6874, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb603e808190b5769566d03bc192", "custom_id": "39-8", "response": {"status_code": 200, "request_id": "5d64d2e79b0fcd69ac9bdca6cf6a8a4e", "body": {"id": "chatcmpl-CZRAZ04uOTQfZ81W1PChRv4c6N8UQ", "object": "chat.completion", "created": 1762561955, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Get r-band detections for objects whose top-ranked class is CV/Nova under the stochastic LC classifier,\n   and with at most 50 detections. Return requested columns and compute max rise from min (using magpsf_corr). */\nWITH candidate_oids AS (\n    /* Obtain OIDs whose highest-probability class is CV/Nova for lc_classifier_stochastic,\n       and with total detections (ndet) <= 50 */\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet <= 50\n      )\n)\nSELECT\n    d.oid AS oid,                       -- object identifier\n    d.candid AS candid,                 -- candidate identifier\n    d.fid AS f_id,                      -- filter id (1=g, 2=r, 3=i)\n    d.ra AS ra,                         -- detection RA\n    d.dec AS dec,                       -- detection Dec\n    d.magpsf AS magnitude_psf,          -- PSF difference magnitude\n    d.sigmapsf AS magnitude_psf_err,    -- PSF difference magnitude error\n    d.magpsf_corr AS magnitude_psf_corr,        -- PSF corrected (apparent) magnitude (corrected difference magnitude)\n    d.sigmapsf_corr AS magnitude_psf_corr_err,  -- PSF corrected magnitude error\n    /* Maximum rise from minimum (amplitude) in r-band per object using corrected PSF magnitudes */\n    MAX(d.magpsf_corr) OVER (PARTITION BY d.oid)\n      - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_rise_from_min\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM candidate_oids)\n  AND d.fid = 2              -- r-band\n  AND d.corrected = TRUE     -- use corrected magnitudes\nORDER BY d.oid\nLIMIT 1000;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3232, "completion_tokens": 3587, "total_tokens": 6819, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3136, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_690ebb6059c48190bbff34fa9b81b914", "custom_id": "39-9", "response": {"status_code": 200, "request_id": "710ea57177f107c04c891d42bf9faacd", "body": {"id": "chatcmpl-CZRAZMOHTvUgz8ZZ73FDXUOYO6Ist", "object": "chat.completion", "created": 1762561955, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- CV/Nova (highest-probability) objects by the stochastic light curve classifier (ranking=1),\n-- further restricted to objects with ndet <= 50. We then fetch their r-band (fid=2) detections\n-- and compute rise-from-min and max-rise-from-min using the PSF corrected magnitude (magpsf_corr).\nWITH selected_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet <= 50\n      )\n)\nSELECT\n    d.oid AS oid,                     -- object identifier\n    d.candid AS candid,               -- candidate identifier\n    d.fid AS f_id,                    -- filter id (r-band = 2)\n    d.ra AS ra,                       -- detection RA\n    d.dec AS dec,                     -- detection Dec\n    -- Magnitudes and errors:\n    d.magpsf_corr AS magpsf_corr_r,       -- corrected PSF magnitude (r-band)\n    d.sigmapsf_corr AS err_magpsf_corr_r, -- error of corrected PSF magnitude\n    d.sigmapsf_corr_ext AS err_magpsf_corr_ext_r, -- extended-source error (if applicable)\n    d.magpsf AS magpsf_r,                 -- PSF difference magnitude (uncorrected; included for completeness)\n    d.sigmapsf AS err_magpsf_r,           -- error of uncorrected PSF magnitude\n    -- Rise from minimum (per detection) and maximum rise from minimum (per object) using magpsf_corr:\n    (d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS rise_from_min_magpsf_corr_r,\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_magpsf_corr_r\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\n  AND d.fid = 2  -- r-band\nORDER BY d.oid\nLIMIT 1000;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3232, "completion_tokens": 3314, "total_tokens": 6546, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2816, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
