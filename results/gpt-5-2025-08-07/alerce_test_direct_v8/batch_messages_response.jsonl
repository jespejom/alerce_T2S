{"id": "batch_req_68f6be1a8ff881908760108625961c18", "custom_id": "8-2", "response": {"status_code": 200, "request_id": "6c52208c85ce534ed5c05f7624169d15", "body": {"id": "chatcmpl-CSsxXJayi4rpj5vNpQTwEgGv4hRsb", "object": "chat.completion", "created": 1761000483, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects whose first detection (proxy for first stamp classification time) is between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- and that are top-ranked as SN by the stamp classifier, keeping those with probability > 0.5 OR with at least 2 detections.\nWITH oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n      AND (\n            p.probability > 0.5\n            OR (SELECT COUNT(*) FROM detection d WHERE d.oid = p.oid) >= 2\n          )\n      AND (SELECT MIN(d.mjd) FROM detection d WHERE d.oid = p.oid) BETWEEN 60173.0 AND 60177.0\n)\nSELECT *\nFROM probability\nWHERE oid IN (SELECT oid FROM oids)\n  AND classifier_name = 'stamp_classifier'\n  AND class_name = 'SN'\n  AND ranking = 1;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2650, "completion_tokens": 2805, "total_tokens": 5455, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1a07a48190ae1021d05d905670", "custom_id": "8-3", "response": {"status_code": 200, "request_id": "e813411a9ac35ad4e464adc1269ea330", "body": {"id": "chatcmpl-CSsyXRI400rJnI04liZCVHn7bMPWM", "object": "chat.completion", "created": 1761000545, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects first classified (first detection) between Aug 17 (60173.0) and Aug 21 (60177.0),\n-- with stamp classifier assigning top class 'SN', and (probability > 0.5 OR at least two detections)\nSELECT *\nFROM probability p\nWHERE\n    p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND p.oid IN (\n        SELECT d.oid\n        FROM detection d\n        GROUP BY d.oid\n        HAVING MIN(d.mjd) BETWEEN 60173.0 AND 60177.0\n    )\n    AND (\n        p.probability > 0.5\n        OR p.oid IN (\n            SELECT d2.oid\n            FROM detection d2\n            GROUP BY d2.oid\n            HAVING COUNT(*) >= 2\n        )\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2695, "completion_tokens": 2698, "total_tokens": 5393, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be19e8a88190b8f297237bdf95d5", "custom_id": "8-4", "response": {"status_code": 200, "request_id": "201d7df58a9d65496c6c6f0473146e41", "body": {"id": "chatcmpl-CSsz0VeucnQdm9YBemjLXllVmQl7O", "object": "chat.completion", "created": 1761000574, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects whose first detection is between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- that were classified as SN (top-ranked, i.e., ranking = 1) by the stamp classifier,\n-- and that either have probability > 0.5 for that SN classification OR have at least two detections.\n-- Note: The schema does not store classification time; we assume \"first classified\" aligns with firstmjd.\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  -- Must be top-ranked SN by the stamp classifier\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n  )\n  -- Additional requirement: either high probability or at least 2 detections\n  AND (\n       oid IN (\n         SELECT oid\n         FROM probability\n         WHERE classifier_name = 'stamp_classifier'\n           AND class_name = 'SN'\n           AND ranking = 1\n           AND probability > 0.5\n       )\n       OR ndet >= 2\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2584, "completion_tokens": 1995, "total_tokens": 4579, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be19e3648190838e4a20ab3110f5", "custom_id": "27-2", "response": {"status_code": 200, "request_id": "69d0767da29fad16f59ad72597004620", "body": {"id": "chatcmpl-CSszQPF3GhR8oJjDKiGr68YK2xPIM", "object": "chat.completion", "created": 1761000600, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76\n-- Return one row per lc_classifier class (all classes) for each qualifying object\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN (\n      SELECT o.oid\n      FROM object o\n      WHERE o.ndet >= 100\n  )\n  AND EXISTS (\n      SELECT 1\n      FROM probability p1\n      WHERE p1.oid = p.oid\n        AND p1.classifier_name = 'lc_classifier'\n        AND p1.classifier_version = p.classifier_version\n        AND p1.class_name = 'CEP'\n        AND p1.ranking = 1\n        AND p1.probability > 0.76\n  )\nORDER BY p.oid, p.ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2640, "completion_tokens": 3692, "total_tokens": 6332, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3328, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be19e17081909ca9a5e0ff1efa0b", "custom_id": "27-3", "response": {"status_code": 200, "request_id": "5c7084de93d813876358a5661191ccb1", "body": {"id": "chatcmpl-CSt1vrSOF9E2jAzCwsWfnxf9nT9JV", "object": "chat.completion", "created": 1761000755, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all lc_classifier class probabilities for objects that are most likely CEP (ranking=1) with prob>0.76\n-- and have ndet >= 100, along with selected object columns.\nSELECT\n    p.oid,\n    /* object columns via scalar subqueries to avoid explicit JOINs */\n    (SELECT o.meanra FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    /* probability columns */\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.oid IN (\n        /* Select OIDs that are most likely CEP with prob>0.76 and ndet>=100 */\n        SELECT p_top.oid\n        FROM probability p_top\n        WHERE\n            p_top.classifier_name = 'lc_classifier'\n            AND p_top.class_name = 'CEP'\n            AND p_top.ranking = 1\n            AND p_top.probability > 0.76\n            AND p_top.oid IN (\n                SELECT o.oid\n                FROM object o\n                WHERE o.ndet >= 100\n            )\n    )\nORDER BY\n    p.oid,\n    p.ranking ASC,\n    p.probability DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2640, "completion_tokens": 1997, "total_tokens": 4637, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be19e95481908d70d051b7f732a8", "custom_id": "27-4", "response": {"status_code": 200, "request_id": "61afb17996c21cacefe9438294930148", "body": {"id": "chatcmpl-CSszyITmHzPsu9tKdTOH1eNh6LA3r", "object": "chat.completion", "created": 1761000634, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 2640, "completion_tokens": 4000, "total_tokens": 6640, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be19e9d8819085041aedf6dbd978", "custom_id": "17-2", "response": {"status_code": 200, "request_id": "9e7693eb21eb3efd03e587228511c529", "body": {"id": "chatcmpl-CSt2I0b7N2ZUHP0FnQucbMT1hgLGr", "object": "chat.completion", "created": 1761000778, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with top-1 AGN classification (lc_classifier), variable in r band, and either no detections in g or non-variable in g.\n-- Variability is approximated via Pvar >= 0.5 per band (fid=2 for r, fid=1 for g).\n-- Returns all features for the selected objects (SELECT * per default), ordered by oid, then by feature value ascending.\nSELECT *\nFROM feature f\nWHERE f.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      -- require r-band detections\n      AND EXISTS (\n          SELECT 1\n          FROM magstat msr\n          WHERE msr.oid = p.oid\n            AND msr.fid = 2  -- r band\n            AND msr.ndet > 0\n      )\n      -- require r-band variability (Pvar >= 0.5)\n      AND EXISTS (\n          SELECT 1\n          FROM feature fr\n          WHERE fr.oid = p.oid\n            AND fr.fid = 2  -- r band\n            AND fr.name = 'Pvar'\n            AND fr.value >= 0.5\n      )\n      -- enforce: either no g detections OR (g detections but NOT variable in g)\n      AND NOT EXISTS (\n          SELECT 1\n          FROM magstat msg\n          WHERE msg.oid = p.oid\n            AND msg.fid = 1  -- g band\n            AND msg.ndet > 0\n            AND EXISTS (\n                SELECT 1\n                FROM feature fg\n                WHERE fg.oid = p.oid\n                  AND fg.fid = 1  -- g band\n                  AND fg.name = 'Pvar'\n                  AND fg.value >= 0.5  -- would indicate variability in g; exclude those\n            )\n      )\n)\nORDER BY f.oid ASC, f.value ASC NULLS FIRST;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5275, "completion_tokens": 3504, "total_tokens": 8779, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3072, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1a05288190a469c11aa3177832", "custom_id": "17-3", "response": {"status_code": 200, "request_id": "4fc19771090f7c7a3c5fb926a3a56381", "body": {"id": "chatcmpl-CSt38KaTEOw4MyA3TWl5jom3RLTqY", "object": "chat.completion", "created": 1761000830, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 5275, "completion_tokens": 4000, "total_tokens": 9275, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be19ebbc8190a028bbf9a81c97b1", "custom_id": "17-4", "response": {"status_code": 200, "request_id": "9a29a8698d99b651dd9dba2d75ac9b79", "body": {"id": "chatcmpl-CSsxYKM12guUEZpLB0GoQCiRhmCgr", "object": "chat.completion", "created": 1761000484, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects whose most probable (ranking=1) lc_classifier class is AGN,\n-- that are variable in r band (fid=2; magsigma>0 and ndet>0),\n-- and have either no g-band detections or show no variability in g (i.e., no g row with ndet>0 AND magsigma>0).\n-- Ambiguity note: \"variability\" is interpreted here as magsigma > 0 in magstat (difference-magnitude dispersion).\n-- Result rows (features from magstat) are ordered by magsigma ascending, then by oid.\nSELECT\n    *\nFROM\n    magstat ms\nWHERE\n    ms.fid = 2\n    AND ms.ndet > 0\n    AND ms.magsigma IS NOT NULL\n    AND ms.magsigma > 0\n    AND ms.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.ranking = 1\n    )\n    AND NOT EXISTS (\n        SELECT 1\n        FROM magstat mg\n        WHERE mg.oid = ms.oid\n          AND mg.fid = 1\n          AND mg.ndet > 0\n          AND mg.magsigma IS NOT NULL\n          AND mg.magsigma > 0\n    )\nORDER BY\n    ms.magsigma ASC,\n    ms.oid ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2843, "completion_tokens": 2614, "total_tokens": 5457, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be19ec8c819084f4c8b4ee968838", "custom_id": "37-2", "response": {"status_code": 200, "request_id": "7a349af1b2134c80a0ef71b916fad350", "body": {"id": "chatcmpl-CSsxYFCPpVj8YaWNrHSnWE8Et0yBF", "object": "chat.completion", "created": 1761000484, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Top 200 objects whose most probable lc_classifier class is SNIa, ordered by probability DESC\nWITH top_snia AS (\n  SELECT oid, classifier_version, probability\n  FROM (\n    SELECT\n      oid,\n      classifier_version,\n      probability,\n      row_number() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1  -- ensure SNIa is the assigned (top-ranked) class\n  ) t\n  WHERE rn = 1\n  ORDER BY probability DESC\n  LIMIT 200\n)\nSELECT p.*\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'SNIa'\n  AND p.ranking = 1\n  AND (p.oid, p.classifier_version) IN (SELECT oid, classifier_version FROM top_snia)\nORDER BY p.probability DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2113, "completion_tokens": 2647, "total_tokens": 4760, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2432, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1acf5881908c8a0065eedbe2ea", "custom_id": "37-3", "response": {"status_code": 200, "request_id": "d3d0663e80e6b34db70f566b9d45e519", "body": {"id": "chatcmpl-CSsxYxt3HwH6cSoLakLU1FuJwDVK1", "object": "chat.completion", "created": 1761000484, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Top 200 objects classified as SNIa by the light curve classifier (ranking=1), ordered by probability DESC\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND class_name = 'SNIa'\n  AND ranking = 1\n  AND (oid, probability) IN (\n    SELECT oid, probability\n    FROM (\n      SELECT\n        oid,\n        probability,\n        row_number() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n        AND class_name = 'SNIa'\n        AND ranking = 1\n    ) t\n    WHERE rn = 1\n    ORDER BY probability DESC\n    LIMIT 200\n  )\nORDER BY probability DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2113, "completion_tokens": 2472, "total_tokens": 4585, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1b27448190a82c9e1cf329f719", "custom_id": "37-4", "response": {"status_code": 200, "request_id": "bc3e4adc47b623cdb2d1f5996b8c267f", "body": {"id": "chatcmpl-CSsxzkV6Nu1LwEgG1vzyP5nx13eAA", "object": "chat.completion", "created": 1761000511, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Top 200 objects classified as SNIa by the light curve classifier (lc_classifier)\n-- Ensures the class is the top-ranked (ranking = 1) per object and selects the max probability per oid across versions\nWITH best_per_oid AS (\n  SELECT p.*\n  FROM probability p\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'SNIa'\n    AND p.ranking = 1\n    AND p.probability = (\n      SELECT MAX(p2.probability)\n      FROM probability p2\n      WHERE p2.oid = p.oid\n        AND p2.classifier_name = 'lc_classifier'\n        AND p2.class_name = 'SNIa'\n        AND p2.ranking = 1\n    )\n),\ntop200 AS (\n  SELECT oid\n  FROM best_per_oid\n  ORDER BY probability DESC\n  LIMIT 200\n)\nSELECT *\nFROM best_per_oid\nWHERE oid IN (SELECT oid FROM top200)\nORDER BY probability DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2113, "completion_tokens": 2524, "total_tokens": 4637, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1aced88190b8ffa06a73a8fa38", "custom_id": "34-2", "response": {"status_code": 200, "request_id": "14eff65fccf2e3c5ab3f22c6aba69a93", "body": {"id": "chatcmpl-CSsy6qj9nsne3WHMezYR0UsvDgtn4", "object": "chat.completion", "created": 1761000518, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all feature rows for the given OIDs, limited to 'Amplitude' and 'Multiband_period'\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid, name, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4404, "completion_tokens": 818, "total_tokens": 5222, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1ad2d881909c9744c8389e53b6", "custom_id": "34-3", "response": {"status_code": 200, "request_id": "dbe7ab79deee489deff42a13237c6496", "body": {"id": "chatcmpl-CSsy87RHzAvk71YKFIPiUL3dYwbb1", "object": "chat.completion", "created": 1761000520, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all rows in feature for the given OIDs and the requested feature names\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM input_oids)\n  AND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4404, "completion_tokens": 1068, "total_tokens": 5472, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1ade248190a67f40566672010c", "custom_id": "34-4", "response": {"status_code": 200, "request_id": "039729c7beb3fc4f456054e77b7ee270", "body": {"id": "chatcmpl-CSsyKGcfyc3Q3RcCRDyrvRPJoq67d", "object": "chat.completion", "created": 1761000532, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the requested features for the given list of OIDs\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM input_oids)\n  AND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4404, "completion_tokens": 1003, "total_tokens": 5407, "prompt_tokens_details": {"cached_tokens": 4352, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1b49b48190b7cf1be8d7aeb770", "custom_id": "1-2", "response": {"status_code": 200, "request_id": "d6f6b635ffda531b89b32483aca312c3", "body": {"id": "chatcmpl-CSsyQ0fegrQ2cVvdTi8sSKBcPPkSL", "object": "chat.completion", "created": 1761000538, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 5747, "completion_tokens": 4000, "total_tokens": 9747, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1ad6cc8190bea52d93a0498316", "custom_id": "1-3", "response": {"status_code": 200, "request_id": "540de37b503c5300479971b5cf8f9081", "body": {"id": "chatcmpl-CSsyVarpyxeRwumtpfXmlcnrWVFmq", "object": "chat.completion", "created": 1761000543, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 5747, "completion_tokens": 4000, "total_tokens": 9747, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1aebb08190a78a369def429dfe", "custom_id": "1-4", "response": {"status_code": 200, "request_id": "021b5b9bfcf7a9835aea3e6ca190d5af", "body": {"id": "chatcmpl-CSsyXye9ehIRrU9nZ5t92uMZELyGR", "object": "chat.completion", "created": 1761000545, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 6464, "completion_tokens": 4000, "total_tokens": 10464, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1aff308190bf92fcf5414689e0", "custom_id": "16-2", "response": {"status_code": 200, "request_id": "042e50e7459cbf682721610531c0e80d", "body": {"id": "chatcmpl-CSszImIqyQLM9lZlieWUeDeFzFFPZ", "object": "chat.completion", "created": 1761000592, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3586, "completion_tokens": 4000, "total_tokens": 7586, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1b776881908e9ad9e3d828da25", "custom_id": "16-3", "response": {"status_code": 200, "request_id": "e8b367b7789350a65c0ef1d3d22390ad", "body": {"id": "chatcmpl-CSszQHWVqsmkzerLZ3hFpkKb50ROg", "object": "chat.completion", "created": 1761000600, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3586, "completion_tokens": 4000, "total_tokens": 7586, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1bbe708190901a62cb7d76e3d0", "custom_id": "16-4", "response": {"status_code": 200, "request_id": "f824ca28914f1fbebc9d64c47544fb46", "body": {"id": "chatcmpl-CSszS92zdDA9sViuFMzBxketF5Clc", "object": "chat.completion", "created": 1761000602, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 4134, "completion_tokens": 4000, "total_tokens": 8134, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1bbaa08190bbd20496a7dce016", "custom_id": "19-2", "response": {"status_code": 200, "request_id": "271b6eafe06fca868731f92308e5cfca", "body": {"id": "chatcmpl-CSt03jUtFZiRNNk0GGVCWQkPdJrxe", "object": "chat.completion", "created": 1761000639, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with at most one detection (ndet <= 1), whose first detection occurred between\n-- 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0)),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Assumption: \"appeared between\" is interpreted as firstmjd within the interval.\n\nWITH asteroid_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n    GROUP BY p.oid\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Fetch the asteroid class_name (should be 'asteroid') with the highest probability for this oid */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE o.ndet <= 1\n  AND o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.oid IN (SELECT ao.oid FROM asteroid_oids ao);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2693, "completion_tokens": 2912, "total_tokens": 5605, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1bc69c8190b7d61fdfb9035458", "custom_id": "19-3", "response": {"status_code": 200, "request_id": "d2bd866997e383a23af3cd943307dd46", "body": {"id": "chatcmpl-CSt0GxsVZ48era5SPMYLRtce5iu1T", "object": "chat.completion", "created": 1761000652, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with first detection between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0)),\n-- with at most one detection, and classified as 'asteroid' by the stamp classifier with probability > 0.7.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    -- Return the asteroid class name from the stamp classifier (highest available probability per object)\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    -- Return the corresponding probability (highest available per object)\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.firstmjd >= 59274.0\n    AND o.firstmjd < 59305.0\n    AND o.ndet <= 1\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2693, "completion_tokens": 3174, "total_tokens": 5867, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2816, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1bbd948190a2b8e1936e5a051c", "custom_id": "19-4", "response": {"status_code": 200, "request_id": "b372e09c68d9f2357fafe7ffd6e08c7d", "body": {"id": "chatcmpl-CSsxeDHexiMsGPdrDz1uWX2XZiQCg", "object": "chat.completion", "created": 1761000490, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Objects with at most one detection (ndet <= 1), first detected between 2021-03-01 and 2021-04-01,\n   and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n   We obtain OIDs in a subquery (as recommended) and use scalar subqueries to fetch class_name and probability.\n   If multiple classifier versions exist, the highest probability per oid is selected. */\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* class_name and probability from the highest-probability stamp_classifier 'asteroid' entry */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    /* first detection between 2021-03-01 (MJD 59274.0) inclusive and 2021-04-01 (MJD 59305.0) exclusive */\n    o.firstmjd >= 59274.0\n    AND o.firstmjd < 59305.0\n    /* at most one detection */\n    AND o.ndet <= 1\n    /* ensure the object is classified as 'asteroid' by the stamp classifier with prob > 0.7 */\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2765, "completion_tokens": 2390, "total_tokens": 5155, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1920, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1bc8548190bf74750b8460e86b", "custom_id": "14-2", "response": {"status_code": 200, "request_id": "d26a67f27837761dc3e253a5ba477333", "body": {"id": "chatcmpl-CSsy0K0qkRRtVvVsQxRsG3Cki5Y1i", "object": "chat.completion", "created": 1761000512, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,                    -- unique object identifier\n    d.candid,                 -- candidate identifier\n    d.fid,                    -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,                    -- modified julian date\n    d.magpsf_corr,            -- magnitude (corrected PSF magnitude)\n    d.sigmapsf_corr,          -- magnitude error (assuming point-like source)\n    d.has_stamp,              -- whether the candidate has an associated image stamp\n    d.drb,                    -- deep learning real-bogus score\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,     -- star/galaxy score of nearest PS1 source\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1     -- distance [arcsec] to nearest PS1 source\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p\n      WHERE p.oid = d.oid\n        AND p.candid = d.candid\n        AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3353, "completion_tokens": 2475, "total_tokens": 5828, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1bd5f4819098afef0e95c7b81c", "custom_id": "14-3", "response": {"status_code": 200, "request_id": "8cbb48bbe7caca19f8ce215e3e6a5a2d", "body": {"id": "chatcmpl-CSsyTLt14hX24ucOlQJw3hWPOhxOl", "object": "chat.completion", "created": 1761000541, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return detections for given OIDs with drb > 0.5 and (sgscore1 < 0.5 OR distpsnr1 < 1 arcsec).\n-- Magnitude and error are taken as magpsf and sigmapsf from detection.\nWITH input_oids(oid) AS (\n    VALUES \n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n),\nfiltered AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM input_oids)\n      AND d.drb > 0.5\n      AND EXISTS (\n          SELECT 1\n          FROM ps1_ztf p\n          WHERE p.oid = d.oid\n            AND p.candid = d.candid\n            AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n      )\n)\nSELECT\n    f.oid,\n    f.candid,\n    f.fid,\n    f.mjd,\n    f.magpsf,\n    f.sigmapsf,\n    f.has_stamp,\n    f.drb,\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = f.oid AND p.candid = f.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = f.oid AND p.candid = f.candid) AS distpsnr1\nFROM filtered f;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3353, "completion_tokens": 3084, "total_tokens": 6437, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2688, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1bfb288190a1e1b4dc825b5dac", "custom_id": "14-4", "response": {"status_code": 200, "request_id": "60034cbf9fd69f5927824745302eded3", "body": {"id": "chatcmpl-CSsz9Iaqa2cgwwc2hf24ajQ3EcPGy", "object": "chat.completion", "created": 1761000583, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return detection-level info for the provided OIDs with DRB > 0.5\n-- and PS1 constraints: sgscore1 < 0.5 OR distpsnr1 < 1 arcsec.\n-- Assumption: \"magnitude\" and \"magnitude error\" refer to magpsf and sigmapsf from detection.\nWITH oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,        -- magnitude (PSF difference magnitude)\n    d.sigmapsf,      -- magnitude error (PSF difference magnitude error)\n    d.has_stamp,     -- whether the candidate has stamps\n    d.drb,           -- deep learning real-bogus score\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE\n    d.oid IN (SELECT oid FROM oids)\n    AND d.drb > 0.5\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3353, "completion_tokens": 2995, "total_tokens": 6348, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1c0ef08190b6828d2e02dcd15d", "custom_id": "30-2", "response": {"status_code": 200, "request_id": "4dda9395cbd34e33dc554c3eb0f6a4e3", "body": {"id": "chatcmpl-CSszeG2NJbkdTgQjMYlsFusnTLqKU", "object": "chat.completion", "created": 1761000614, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Predicted class per object from the Light Curve classifier (lc_classifier), using the latest available classifier_version\nWITH latest_version AS (\n  SELECT max(classifier_version) AS v\n  FROM probability\n  WHERE classifier_name = 'lc_classifier'\n),\noids AS (\n  -- Prioritize retrieving OIDs first for optimization\n  SELECT DISTINCT oid\n  FROM probability\n  WHERE classifier_name = 'lc_classifier'\n    AND ranking = 1\n    AND classifier_version = (SELECT v FROM latest_version)\n)\nSELECT p.oid, p.class_name, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM oids)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.classifier_version = (SELECT v FROM latest_version);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2119, "completion_tokens": 1776, "total_tokens": 3895, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1c305081909bcae3bd4e730856", "custom_id": "30-3", "response": {"status_code": 200, "request_id": "46ec42982ceafbcad9b89b6dad53484d", "body": {"id": "chatcmpl-CSszyBebM76rOywkX4yAXEV3yFc1d", "object": "chat.completion", "created": 1761000634, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Predicted class per object using the Light Curve Classifier (lc_classifier)\n-- For each oid, selects the class with ranking=1 and the highest probability across versions\nSELECT p.oid, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability = (\n    SELECT MAX(p2.probability)\n    FROM probability p2\n    WHERE p2.oid = p.oid\n      AND p2.classifier_name = 'lc_classifier'\n      AND p2.ranking = 1\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2119, "completion_tokens": 1675, "total_tokens": 3794, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1536, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1c6e008190a9a9b80eb47c6011", "custom_id": "30-4", "response": {"status_code": 200, "request_id": "55c0ffd28562542724640ab0bc762945", "body": {"id": "chatcmpl-CSt0JX0m0tfUEUJn3ANGOvcKmHiCy", "object": "chat.completion", "created": 1761000655, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Predicted class per object using the Light Curve classifier (lc_classifier)\n-- Returns one row per object per classifier_version with the top-ranked class (ranking = 1)\nSELECT\n    p.oid,\n    p.class_name,\n    p.probability\nFROM probability AS p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2119, "completion_tokens": 1878, "total_tokens": 3997, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1cae248190b3bda6b8302d44ee", "custom_id": "22-2", "response": {"status_code": 200, "request_id": "99e40df5cf903768fc36abe846da8c74", "body": {"id": "chatcmpl-CSt0evh888DDSrpzOs0jpSlJppxrX", "object": "chat.completion", "created": 1761000676, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects first detected between 2018-06-01 (MJD 58239.0) and 2018-07-01 (MJD 58270.0), inclusive,\n-- that have a Light Curve classifier ('lc_classifier') probability entry with top rank (ranking = 1).\n-- We return all columns from the probability table for these objects.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking = 1\n  AND oid IN (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 58239.0 AND 58270.0\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2578, "completion_tokens": 1673, "total_tokens": 4251, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1536, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1cacac819081532919d4c9de5f", "custom_id": "22-3", "response": {"status_code": 200, "request_id": "d23df06c5b67dacaaa88831a5839b32c", "body": {"id": "chatcmpl-CSt0zOu1AOhPS9PpCDOSVTHQfyQ8e", "object": "chat.completion", "created": 1761000697, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects first detected between 2018-06-01 (MJD 58239.0, inclusive) and 2018-07-01 (MJD 58270.0, exclusive)\n-- and that have classifications from the Light Curve classifier (lc_classifier).\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2623, "completion_tokens": 1013, "total_tokens": 3636, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1d4d1c8190887ad102d7c4c090", "custom_id": "22-4", "response": {"status_code": 200, "request_id": "b8d2dac19d75773966c8f6bc0ec667d1", "body": {"id": "chatcmpl-CSt1AFgRvnsiH3wryXpC950Fl4Ann", "object": "chat.completion", "created": 1761000708, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects \"found\" interpreted as those with first detection between 2018-06-01 and 2018-07-01 (MJD 58239.0 to 58270.0)\n-- Filter to objects that have been classified by the Light Curve classifier ('lc_classifier')\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2578, "completion_tokens": 760, "total_tokens": 3338, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1cb10481909cd59c284ce27dc2", "custom_id": "12-2", "response": {"status_code": 200, "request_id": "043b857306b7b4793bf1c92dd8689860", "body": {"id": "chatcmpl-CSt1Kjhn7rrvDAa2lailbcIgemKE8", "object": "chat.completion", "created": 1761000718, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- SNe interpreted as all SN subclasses in the lc_classifier: SNIa, SNIbc, SNII, SLSN\n-- Date range: firstmjd between 59988.0 (Feb 13) and 60197.0 (Sep 10), inclusive\n-- Spatial filter: objects within the given spherical polygon (RA,Dec) using Q3C\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1  -- use top-ranked class as the object's SN class\n    );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2668, "completion_tokens": 1981, "total_tokens": 4649, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1cb778819086f9a0105187080b", "custom_id": "12-3", "response": {"status_code": 200, "request_id": "d5320aa18b4b1bcb847bdbcd09d9510f", "body": {"id": "chatcmpl-CSt1e44SCTuQCuFDnMkuYMgxnluYT", "object": "chat.completion", "created": 1761000738, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- SNe selected using Light Curve classifier (default) and top-ranked class (ranking=1)\n-- Time window: Feb 13 (MJD 59988.0) to Sep 10 (MJD 60197.0)\n-- Spatial filter: within the specified spherical polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n          AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    )\n  AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n  AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n      );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2668, "completion_tokens": 1698, "total_tokens": 4366, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1cbb048190bd08a6ccc42ba270", "custom_id": "12-4", "response": {"status_code": 200, "request_id": "03ac126e1cea9dcfb91682417757f356", "body": {"id": "chatcmpl-CSt1xL0gXNdB9E3LXqZPYcu2xdfWd", "object": "chat.completion", "created": 1761000757, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- SNe = {SNIa, SNIbc, SNII, SLSN} in lc_classifier; require top-ranked (ranking=1)\n-- First detection between 2023-02-13 (MJD 59988.0) and 2023-09-10 (MJD 60197.0)\n-- Spatial filter: objects within the given spherical polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nAND o.firstmjd BETWEEN 59988.0 AND 60197.0\nAND q3c_poly_query(\n    o.meanra,\n    o.meandec,\n    '((-20,-20),(-2,-20),(20,1),(10,10))'::polygon\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2668, "completion_tokens": 2027, "total_tokens": 4695, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1ce6608190978211a5e685c7e3", "custom_id": "57-2", "response": {"status_code": 200, "request_id": "1c692f7294e71870f89eaf992983ec87", "body": {"id": "chatcmpl-CSt2ONeeBQPqUFWxbd0BPjxar7VZb", "object": "chat.completion", "created": 1761000784, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find ZTF objects within 30\" of id_1 (354.67, 15.954) or 20\" of id_2 (20.7993, 1.00331)\n-- 1 arcsec = 1/3600 deg\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n  VALUES\n    ('id_1', 354.67::double precision, 15.954::double precision, 30.0/3600.0),\n    ('id_2', 20.7993::double precision, 1.00331::double precision, 20.0/3600.0)\n)\nSELECT\n  c.identifier,              -- input object identifier\n  c.ra,                      -- input RA (deg)\n  c.dec,                     -- input Dec (deg)\n  c.radius_deg,              -- search radius used (deg)\n  o.oid,                     -- ZTF object identifier\n  o.ndet,                    -- number of detections\n  o.meanra,                  -- mean RA (deg)\n  o.meandec,                 -- mean Dec (deg)\n  o.firstmjd                 -- first detection date (MJD)\nFROM catalog c, object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY o.lastmjd DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2478, "completion_tokens": 3180, "total_tokens": 5658, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2880, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1cffc48190915ed2d84bb93d34", "custom_id": "57-3", "response": {"status_code": 200, "request_id": "7f3b96125b02d984b5af462c620ef6d7", "body": {"id": "chatcmpl-CSt2uYwwaGgsEIfhCVc4kKX1Z07uD", "object": "chat.completion", "created": 1761000816, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF objects within 30 arcsec of id_1 or 20 arcsec of id_2,\n-- including input identifiers/coordinates/radius and matched object details,\n-- sorted by last detection date (lastmjd) descending.\n\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        -- arcsec to degrees: 30\" = 30/3600 deg, 20\" = 20/3600 deg\n        ('id_1', 354.67,   15.954,   30.0/3600.0),\n        ('id_2', 20.7993,   1.00331, 20.0/3600.0)\n),\noid_list AS (\n    SELECT\n        o.oid,\n        c.identifier,\n        c.ra,\n        c.dec,\n        c.radius_deg\n    FROM object o, catalog c\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\n)\nSELECT\n    ol.identifier,          -- input object identifier\n    ol.ra,                  -- input RA [deg]\n    ol.dec,                 -- input Dec [deg]\n    ol.radius_deg,          -- search radius used [deg]\n    o.oid,                  -- ZTF object identifier\n    o.ndet,                 -- number of detections\n    o.meanra,               -- mean RA [deg]\n    o.meandec,              -- mean Dec [deg]\n    o.firstmjd              -- first detection date [MJD]\nFROM object o, oid_list ol\nWHERE o.oid = ol.oid\nORDER BY o.lastmjd DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2478, "completion_tokens": 2667, "total_tokens": 5145, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1d1e3481909b1a7c2245b76eef", "custom_id": "57-4", "response": {"status_code": 200, "request_id": "80f8f1b40837ac5cf4c5d6dde20f3d8d", "body": {"id": "chatcmpl-CSt3LSnaQ67vRE5RVvJtwLPnyJgeX", "object": "chat.completion", "created": 1761000843, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Define the input targets and their search radii (converted from arcseconds to degrees)\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67::double precision, 15.954::double precision, 30.0/3600.0), -- 30 arcsec = 0.008333... deg\n        ('id_2', 20.7993::double precision, 1.00331::double precision, 20.0/3600.0) -- 20 arcsec = 0.005555... deg\n)\nSELECT\n    c.identifier,\n    c.ra AS input_ra,\n    c.dec AS input_dec,\n    c.radius_deg AS search_radius_deg,\n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM\n    object o,\n    catalog c\nWHERE\n    q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY\n    o.lastmjd DESC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2478, "completion_tokens": 2739, "total_tokens": 5217, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1d55988190862529b2f3433b16", "custom_id": "75-2", "response": {"status_code": 200, "request_id": "8453e62d5937f6396db6ac6444f99c7f", "body": {"id": "chatcmpl-CSt3yp7rl9TuIdxQSgLSLxZQJXvsW", "object": "chat.completion", "created": 1761000882, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get at most 100 rows from ss_ztf where the nearest Solar System object name is known.\n-- Note: ssnamenr may contain the literal string 'null' when unknown, not SQL NULL, so exclude both.\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM ss_ztf\n    WHERE ssnamenr IS NOT NULL\n      AND ssnamenr <> 'null'\n    LIMIT 100\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 999, "total_tokens": 3038, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1e24408190898c3b5ce1012cd6", "custom_id": "75-3", "response": {"status_code": 200, "request_id": "05874c241b3e9cbda6049d5480c0c552", "body": {"id": "chatcmpl-CSt4HCXwDNcAuiChJ3wlwE3J2TTkq", "object": "chat.completion", "created": 1761000901, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return up to 100 rows from ss_ztf where the nearest Solar System object name is present\n-- Filter out both SQL NULLs and the literal string 'null' noted in the schema comments\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND LOWER(ssnamenr) <> 'null'\nLIMIT 100;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 722, "total_tokens": 2761, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1d9d44819086bf79126129bb03", "custom_id": "75-4", "response": {"status_code": 200, "request_id": "a026866f4685675a53bc0b47f1bb5b9f", "body": {"id": "chatcmpl-CSt4Rws3muLQNy720MaSY1ah8qBc6", "object": "chat.completion", "created": 1761000911, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return at most 100 rows with a known (non-null) nearest Solar System object name.\n-- Note: Some records may use the literal string 'null' to denote unknown; we exclude both SQL NULL and the string 'null'.\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2039, "completion_tokens": 534, "total_tokens": 2573, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 448, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1e43248190a45cc3f14fffb283", "custom_id": "43-2", "response": {"status_code": 200, "request_id": "301a116767dea12ee5ed8b75393583db", "body": {"id": "chatcmpl-CSt4aaTL5NTYBgIKcwG7NTDY1SxJD", "object": "chat.completion", "created": 1761000920, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find all r-band (fid=2) epochs in dataquality for the specified ZTF objects\nWITH target_oids(oid) AS (\n    VALUES \n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT \n    dq.oid,          -- ZTF identifier\n    dq.candid,       -- candidate identifier\n    dq.xpos,         -- x-image position [pixels]\n    dq.ypos,         -- y-image position [pixels]\n    dq.scorr         -- peak-pixel signal-to-noise ratio\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM target_oids)\nORDER BY dq.oid, dq.candid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 1060, "total_tokens": 3771, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1dacfc8190bde5bcd21f20e984", "custom_id": "43-3", "response": {"status_code": 200, "request_id": "72f3bc8f17037d78bdecbb566259a9b3", "body": {"id": "chatcmpl-CSsxoBCodz2YZyNUiJ0DXx6j5BXOz", "object": "chat.completion", "created": 1761000500, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return r-band (fid=2) epochs in dataquality for the specified ZTF objects\n-- Columns: object (oid), candidate id (candid), x/y image positions (xpos, ypos), peak-pixel S/N (scorr)\nWITH targets (oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nWHERE dq.fid = 2  -- r-band\n  AND dq.oid IN (SELECT oid FROM targets)\nORDER BY dq.oid, dq.candid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 1118, "total_tokens": 3829, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1de83481908603c9c4a2e5701a", "custom_id": "43-4", "response": {"status_code": 200, "request_id": "fb183260a92cf81d48dd3ef8123e1cf3", "body": {"id": "chatcmpl-CSsy6cFQ527ZNaVqmGKOWpsVO1naE", "object": "chat.completion", "created": 1761000518, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find all r-band (fid=2) epochs in dataquality for the specified ZTF objects\nWITH target_oids (oid) AS (\n  VALUES\n    ('ZTF20acwrybw'),\n    ('ZTF22abugigx')\n)\nSELECT\n  dq.oid,        -- ZTF identifier\n  dq.candid,     -- candidate identifier\n  dq.xpos,       -- x-image position [pixels]\n  dq.ypos,       -- y-image position [pixels]\n  dq.scorr       -- peak-pixel S/N in matched-filtered image\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM target_oids)\nORDER BY dq.oid, dq.candid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 806, "total_tokens": 3517, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1dd4dc8190a0e082e98e94f863", "custom_id": "89-2", "response": {"status_code": 200, "request_id": "f5dcefb4738abaa7bf71f3ed52491cb8", "body": {"id": "chatcmpl-CSsyGdMyD63E9QbsmuFTxhycYD8hU", "object": "chat.completion", "created": 1761000528, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 50 OIDs with P(SN | stamp_classifier) > 0.7 (highest probability per OID across versions),\n-- then return all dataquality rows for those objects.\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n    GROUP BY oid\n    ORDER BY MAX(probability) DESC\n    LIMIT 50\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2874, "completion_tokens": 1650, "total_tokens": 4524, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1536, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1df35481909d6874eb26f4d077", "custom_id": "89-3", "response": {"status_code": 200, "request_id": "eb2e7e91b96ef0219c98582ca0e13c6c", "body": {"id": "chatcmpl-CSsyghHOaQ9PvneLNWvFvpurSD4W3", "object": "chat.completion", "created": 1761000554, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all dataquality rows for up to 50 objects classified as Supernova (SN) by the stamp classifier with probability > 0.7\nWITH target_oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n    LIMIT 50\n)\nSELECT *\nFROM dataquality\nWHERE oid IN (SELECT oid FROM target_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2919, "completion_tokens": 1832, "total_tokens": 4751, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1e0b6c8190999ae9980042f020", "custom_id": "89-4", "response": {"status_code": 200, "request_id": "e934e9cbd00d8f041e16968680ee6bbb", "body": {"id": "chatcmpl-CSsz4GlnQvVe9a02izZmCUC9bncnK", "object": "chat.completion", "created": 1761000578, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find at most 50 objects with SN probability > 0.7 in the stamp classifier,\n-- then return all columns from dataquality for those objects.\nSELECT *\nFROM dataquality dq\nWHERE dq.oid IN (\n    SELECT s.oid\n    FROM (\n        SELECT p.oid, MAX(p.probability) AS max_prob\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'SN'\n        GROUP BY p.oid\n    ) s\n    WHERE s.max_prob > 0.7\n    ORDER BY s.max_prob DESC\n    LIMIT 50\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2874, "completion_tokens": 1804, "total_tokens": 4678, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1664, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1e3d288190956ff5ae0400949f", "custom_id": "72-2", "response": {"status_code": 200, "request_id": "a9f06e52524d1ee6a0b1061c43e71867", "body": {"id": "chatcmpl-CSszLIwvJkQ2g9legkKCd6nK4bcns", "object": "chat.completion", "created": 1761000595, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return all columns from reference for the specified object OID and reference ID using a CTE to supply the identifiers */\nWITH target (oid, rfid) AS (\n    VALUES ('ZTF20actnuls'::varchar, 712120223::bigint)\n)\nSELECT *\nFROM reference\nWHERE (oid, rfid) IN (SELECT oid, rfid FROM target);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2248, "completion_tokens": 984, "total_tokens": 3232, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1e470881909ffa3141ec98f5f0", "custom_id": "72-3", "response": {"status_code": 200, "request_id": "beaab231724fce15bebe622c587eee8e", "body": {"id": "chatcmpl-CSszXMfTWEAtsZ6TmDkmI0361TrmS", "object": "chat.completion", "created": 1761000607, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns from reference for the specified object OID and reference identifier (rfid)\nWITH target_oids(oid) AS (\n    VALUES ('ZTF20actnuls')  -- prioritize obtaining OIDs via a subquery\n)\nSELECT *\nFROM reference\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND rfid = 712120223;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2248, "completion_tokens": 1109, "total_tokens": 3357, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1f2638819093cb06a81c3a631d", "custom_id": "72-4", "response": {"status_code": 200, "request_id": "34b9ddc57072ce94bf6338fe4606f2d2", "body": {"id": "chatcmpl-CSszppjcjVO0F8jt2pI4SqjZQa4cW", "object": "chat.completion", "created": 1761000625, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Retrieve all columns from the 'reference' table for the specified object and reference identifier\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2248, "completion_tokens": 565, "total_tokens": 2813, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1e98288190b9aafbd60596b81b", "custom_id": "103-2", "response": {"status_code": 200, "request_id": "7ce09e659fbe074bce1012c31e323dcf", "body": {"id": "chatcmpl-CSszx9iRN8Q0TGOBI7GtaKwg1a9JL", "object": "chat.completion", "created": 1761000633, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3408, "completion_tokens": 4000, "total_tokens": 7408, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1f038081908adcfeaf0c62705b", "custom_id": "103-3", "response": {"status_code": 200, "request_id": "df91520e0ab7eee417ad6819b7b17e55", "body": {"id": "chatcmpl-CSt0gIADXARL7GcV7yG69RmE1skEv", "object": "chat.completion", "created": 1761000678, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 200 objects whose nearest PS1 neighbor is farther than 5 arcsec\n-- and that have lc_classifier probability > 0.7 for any non-supernova class.\n-- Return all columns from object, probability (restricted to lc_classifier), and ps1_ztf.\n-- Results are ordered by the nearest PS1 source distance (ascending).\n\nWITH mindist AS (\n    -- Compute the nearest PS1 distance per object across all alerts/candid\n    SELECT\n        oid,\n        MIN(distpsnr1) AS nearest_ps1_dist\n    FROM ps1_ztf\n    GROUP BY oid\n),\nselected_oids AS (\n    -- Select at most 200 OIDs that satisfy both conditions,\n    -- ordered by their nearest PS1 distance\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE\n        p.classifier_name = 'lc_classifier' AND\n        p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') AND\n        p.probability > 0.7 AND\n        p.oid IN (\n            SELECT m.oid\n            FROM mindist m\n            WHERE m.nearest_ps1_dist > 5\n        )\n    ORDER BY (SELECT m.nearest_ps1_dist FROM mindist m WHERE m.oid = p.oid) ASC\n    LIMIT 200\n)\nSELECT\n    o.*,\n    pr.*,\n    ps.*\nFROM\n    object o,\n    probability pr,\n    ps1_ztf ps\nWHERE\n    o.oid IN (SELECT oid FROM selected_oids) AND\n    pr.oid = o.oid AND\n    pr.classifier_name = 'lc_classifier' AND  -- default to lc_classifier for returned probabilities\n    ps.oid = o.oid\nORDER BY\n    (SELECT m.nearest_ps1_dist FROM mindist m WHERE m.oid = o.oid) ASC,\n    pr.class_name,\n    ps.candid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3408, "completion_tokens": 3685, "total_tokens": 7093, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1ecd408190836ba7efd9d8d830", "custom_id": "103-4", "response": {"status_code": 200, "request_id": "df1618072cebe00ee4ce8f89a5c5ee6b", "body": {"id": "chatcmpl-CSt1BxgRn1axXenmuLP26WAg5Yopa", "object": "chat.completion", "created": 1761000709, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3363, "completion_tokens": 4000, "total_tokens": 7363, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1edc648190b281de346512777b", "custom_id": "54-2", "response": {"status_code": 200, "request_id": "a72157307fe5f2ba4c38318e47c83be1", "body": {"id": "chatcmpl-CSt2Ha3UbwEkEJGknu26c2o53sEE7", "object": "chat.completion", "created": 1761000777, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find non-detection epochs for the specified ZTF objects with 5-sigma magnitude limit fainter than 19.5 (i.e., larger than 19.5)\nSELECT\n    *\nFROM\n    non_detection\nWHERE\n    oid IN (\n        -- Obtain valid OIDs from the object table (nested subquery as per guidelines)\n        SELECT oid\n        FROM object\n        WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n    )\n    AND diffmaglim > 19.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2521, "completion_tokens": 570, "total_tokens": 3091, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 448, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1f00dc8190be4f8d69eb879f0a", "custom_id": "54-3", "response": {"status_code": 200, "request_id": "5fdea5914a2329d329ed5f1f5e97713b", "body": {"id": "chatcmpl-CSt2QmSt5TJJOQTYebfSPHpV8kTf7", "object": "chat.completion", "created": 1761000786, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find non-detections with 5-sigma mag limit fainter than 19.5 (i.e., diffmaglim > 19.5)\n-- for the specified ZTF object identifiers. Return all columns.\nSELECT *\nFROM non_detection\nWHERE diffmaglim > 19.5\n  AND oid IN (\n      -- Obtain OIDs from the object table (nested subquery as per guidance)\n      SELECT oid\n      FROM object\n      WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  )\nORDER BY oid, mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2521, "completion_tokens": 515, "total_tokens": 3036, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 384, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1f12c48190aa7ebfcbf7d324f5", "custom_id": "54-4", "response": {"status_code": 200, "request_id": "21399b03588ccc6ba9ddfe5f5579a354", "body": {"id": "chatcmpl-CSt2ZyCPqqo9EjE7W36e0tF6WwqpT", "object": "chat.completion", "created": 1761000795, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find all non-detection epochs for the given ZTF oids with 5-sigma mag limit fainter than 19.5 (i.e., larger magnitudes)\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2521, "completion_tokens": 1055, "total_tokens": 3576, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1f24c88190af5f22c9660f426e", "custom_id": "99-2", "response": {"status_code": 200, "request_id": "e65cb37dc8be1bb89f9de1cc954f04b8", "body": {"id": "chatcmpl-CSt2lZK2AKqa2gKvSF36BF42fNOz5", "object": "chat.completion", "created": 1761000807, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 10 objects with first detection after MJD 60310 and asteroid probability=1 in stamp_classifier,\n-- then return all forced_photometry rows for those objects, ordered by the object's first detection date.\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC, fp.oid, fp.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3273, "completion_tokens": 1801, "total_tokens": 5074, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1f276c81909ea62a9d94105721", "custom_id": "99-3", "response": {"status_code": 200, "request_id": "4da853cf27ce1952e25262e5cd7d6bd2", "body": {"id": "chatcmpl-CSt36Ef7zh1iG0VACge6CWtXHr9NM", "object": "chat.completion", "created": 1761000828, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    /* Get up to 10 objects with first detection after MJD 60310\n       and classified as 'asteroid' with probability 1 by the stamp classifier,\n       ordered by first detection date */\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*  /* Return all forced_photometry columns for the selected objects */\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    /* Order rows by the object's first detection date, then by the photometry MJD */\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC,\n    fp.mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3273, "completion_tokens": 1639, "total_tokens": 4912, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1f32fc8190a480ae96becfe2bb", "custom_id": "99-4", "response": {"status_code": 200, "request_id": "14bf58563f1bfd9cf7230ad84ee9b1af", "body": {"id": "chatcmpl-CSt3PyVAy53xibHk0a5XnQqMdADro", "object": "chat.completion", "created": 1761000847, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all forced_photometry rows for up to 10 objects whose first detection (object.firstmjd) is > 60310\n-- and that have probability=1 of being 'asteroid' in the 'stamp_classifier'.\n-- Objects are chosen and ordered by firstmjd; the output is ordered accordingly.\n\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT DISTINCT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nORDER BY\n  (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid),\n  fp.mjd,\n  fp.pid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3273, "completion_tokens": 2001, "total_tokens": 5274, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1f8154819086a5e8b59f6739f1", "custom_id": "40-2", "response": {"status_code": 200, "request_id": "e84305d9b11e51bc234de015fdc76d1e", "body": {"id": "chatcmpl-CSt3tIhmXDl0JaHsDXjnYJZR6O6yl", "object": "chat.completion", "created": 1761000877, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE cone search: 1 arcsec (1/3600 deg) around RA=23.6488, Dec=30.7314\nSELECT\n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 1028, "total_tokens": 3652, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1fb38c8190b943f0dda63b79f1", "custom_id": "40-3", "response": {"status_code": 200, "request_id": "c06a3fa9a8dd5a494d30c52a17f90b89", "body": {"id": "chatcmpl-CSt47BVC3ftMHAnEpVRwHAROBDnz0", "object": "chat.completion", "created": 1761000891, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE cone search: 1 arcsec = 1/3600 degrees\nSELECT\n  oid_catalog,\n  ra,\n  dec,\n  w1mpro,\n  w1sigmpro,\n  w2mpro,\n  w2sigmpro,\n  j_m_2mass,\n  j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 1206, "total_tokens": 3830, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1fbe548190b3bcd804a54b78b3", "custom_id": "40-4", "response": {"status_code": 200, "request_id": "fbf604f2fac10dc3f2323b5cf643c034", "body": {"id": "chatcmpl-CSt4MQDkkbEifOFqwI5tECRHbBQTH", "object": "chat.completion", "created": 1761000906, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE sources within 1 arcsec of RA=23.6488 deg, Dec=30.7314 deg\nSELECT\n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 766, "total_tokens": 3390, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1fed30819097b39ad1a09d6f1f", "custom_id": "80-2", "response": {"status_code": 200, "request_id": "71a04ede00c1f7d3c128049dfa9ed671", "body": {"id": "chatcmpl-CSsxu7vhIHTnb65bbAGsobny0Gz0Y", "object": "chat.completion", "created": 1761000506, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all xmatch rows for the two specified ZTF objects where the match distance is < 0.5 arcsec\nWITH target_oids AS (\n    -- Obtain valid OIDs from the object table (subquery as per guidelines)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE dist < 0.5\n  AND oid IN (SELECT oid FROM target_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2508, "completion_tokens": 691, "total_tokens": 3199, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be1fedc48190985f68e21fb42c44", "custom_id": "80-3", "response": {"status_code": 200, "request_id": "d992b22d866df46ca79390c3badb0f95", "body": {"id": "chatcmpl-CSsy4lLa8devkTbcBse2oi8fNh5PP", "object": "chat.completion", "created": 1761000516, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all xmatch rows for the specified ZTF oids with dist < 0.5 arcsec\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF22abcmmkz'),\n    ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND dist < 0.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2026, "completion_tokens": 667, "total_tokens": 2693, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2000b081908ac105d16cd35a60", "custom_id": "80-4", "response": {"status_code": 200, "request_id": "58053409a72e6b06d99deae0cb157444", "body": {"id": "chatcmpl-CSsyE8SUnqFK26dl9pqEDiiVUEGaC", "object": "chat.completion", "created": 1761000526, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all xmatch rows for the specified OIDs with separation < 0.5 arcsec\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF22abcmmkz'),\n        ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND dist < 0.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2026, "completion_tokens": 729, "total_tokens": 2755, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2009408190bf75a1de9510addb", "custom_id": "45-2", "response": {"status_code": 200, "request_id": "861d4ebfea328ab326b343cf81a139c9", "body": {"id": "chatcmpl-CSsyPBhjVBhRd8lROFOJi0wyE5yUO", "object": "chat.completion", "created": 1761000537, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Assumption: \"minimum reduced chi-square value of 5\" means a threshold of chipsf >= 5.\n-- If you intended exactly 5, replace the comparison with \"= 5\".\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nSELECT COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3175, "completion_tokens": 1079, "total_tokens": 4254, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be20111c8190b9054b20a829b69b", "custom_id": "45-3", "response": {"status_code": 200, "request_id": "f4ebe1605abe5e30310bb957ba2baf9a", "body": {"id": "chatcmpl-CSsydKU27QIzGwvJOMPwRscHLZfEH", "object": "chat.completion", "created": 1761000551, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Assumption: \"minimum reduced chi-square value of 5\" means a threshold of at least 5 (chipsf >= 5). \n   If you instead mean \"exactly 5\", change the condition to \"chipsf = 5\".\n   If you mean \"rows whose chipsf is the minimum for their object and that minimum equals 5\", see the alternative query below. */\nWITH target_oids AS (\n  SELECT oid FROM (VALUES \n    ('ZTF23abjikaf'),\n    ('ZTF20achlced')\n  ) AS v(oid)\n)\nSELECT COUNT(*) AS n_rows_chipsf_at_least_5\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5;\n\n/* Alternative: count rows where chipsf is the minimum per object and that minimum equals 5.\nWITH target_oids AS (\n  SELECT oid FROM (VALUES \n    ('ZTF23abjikaf'),\n    ('ZTF20achlced')\n  ) AS v(oid)\n)\nSELECT COUNT(*) AS n_rows_min_chipsf_equals_5\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf = 5\n  AND dq.chipsf = (\n    SELECT MIN(dqi.chipsf)\n    FROM dataquality dqi\n    WHERE dqi.oid = dq.oid\n  );\n*/", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3175, "completion_tokens": 2040, "total_tokens": 5215, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2010ac8190be382e3fe7915ea9", "custom_id": "45-4", "response": {"status_code": 200, "request_id": "fd5be26235f89d28316016050418ccdd", "body": {"id": "chatcmpl-CSsyx2Wd3gUlLBhrcfTwZf8wRLtIH", "object": "chat.completion", "created": 1761000571, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Count rows in dataquality for the specified OIDs where the reduced chi-square (chipsf) equals 5\nWITH target_oids AS (\n    SELECT 'ZTF23abjikaf'::varchar AS oid\n    UNION ALL\n    SELECT 'ZTF20achlced'::varchar\n)\nSELECT COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf = 5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3175, "completion_tokens": 1515, "total_tokens": 4690, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be201ff881909fa298512ec2fea9", "custom_id": "63-2", "response": {"status_code": 200, "request_id": "2937ad699da6f0255e4af2a172179fee", "body": {"id": "chatcmpl-CSszNYivWVgZiQVx5VqBhxueWAhE7", "object": "chat.completion", "created": 1761000597, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all 'probability' rows for the specified OIDs, restricted to the Light Curve classifier\n-- and rankings 1 or 2. Use a subquery to obtain OIDs from the 'object' table, and sort by ranking.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n      SELECT oid\n      FROM object\n      WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2574, "completion_tokens": 1210, "total_tokens": 3784, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2064308190908f4b1105019f5f", "custom_id": "63-3", "response": {"status_code": 200, "request_id": "e334230de285cead5bda3a40ed1eaea4", "body": {"id": "chatcmpl-CSszcmUnqOO13XssAPst2wx4qJoid", "object": "chat.completion", "created": 1761000612, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all lc_classifier probabilities with ranking 1 or 2 for the specified ZTF objects\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2574, "completion_tokens": 1064, "total_tokens": 3638, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be209b988190a77cc223afacff92", "custom_id": "63-4", "response": {"status_code": 200, "request_id": "baddd2d603fb3070889f11d43982b54e", "body": {"id": "chatcmpl-CSszoCYCzleyW15tMXikO4S0E3tlj", "object": "chat.completion", "created": 1761000624, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier\n-- and rankings 1 or 2. OIDs are obtained via a subquery from the object table as recommended.\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2574, "completion_tokens": 815, "total_tokens": 3389, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be20b5e48190b194f58263f03a68", "custom_id": "73-2", "response": {"status_code": 200, "request_id": "ad12244e1b3693809d370e22889198ae", "body": {"id": "chatcmpl-CSt005ePpOQif21CleODoZ8IKiaf1", "object": "chat.completion", "created": 1761000636, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return the ZTF object identifier, MPC name (ssnamenr), and MPC magnitude (ssmagnr)\nSELECT ss.oid, ss.ssnamenr, ss.ssmagnr\nFROM ss_ztf ss\nWHERE ss.oid IN (\n    -- Prioritize obtaining OIDs in a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF21acitntz'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2538, "completion_tokens": 1064, "total_tokens": 3602, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be20d68c8190a0dd23a3a8197989", "custom_id": "73-3", "response": {"status_code": 200, "request_id": "54fdfd1058d980d572b5edd200a23432", "body": {"id": "chatcmpl-CSt0E7uWsJqoTQbClDOze3LjeDb2U", "object": "chat.completion", "created": 1761000650, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object\n-- Filters out rows where ssnamenr is the literal string 'null' or SQL NULL (i.e., not a known solar system object)\nSELECT\n  oid,\n  ssnamenr,\n  ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz'\n  AND ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2056, "completion_tokens": 1071, "total_tokens": 3127, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be20da4c8190ba2fa829db85fe92", "custom_id": "73-4", "response": {"status_code": 200, "request_id": "954707ba09be0c5a91f14e48f7c4a05c", "body": {"id": "chatcmpl-CSt0PW9XemWpsj4BR7FHie1fZxjJ9", "object": "chat.completion", "created": 1761000661, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return the ZTF object identifier, the MPC name, and the MPC magnitude for the nearest known Solar System object\n-- Note: ssnamenr is 'null' (string) if no known Solar System object is associated\nSELECT\n    oid,          -- ZTF object identifier\n    ssnamenr,     -- MPC name of nearest known Solar System object\n    ssmagnr       -- MPC magnitude of nearest known Solar System object\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2056, "completion_tokens": 1140, "total_tokens": 3196, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be20ee10819092bc5ef5985711d1", "custom_id": "92-2", "response": {"status_code": 200, "request_id": "9f543ba4cd04b336778b02dbcb8694c2", "body": {"id": "chatcmpl-CSt0eaRpiP8IF6qk2DPhTKpA1Nvcg", "object": "chat.completion", "created": 1761000676, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 500 ZTF objects (by oid) that have at least 10 detections in g-band (fid=1) and no dubious points (ndubious=0),\n-- and return only their lc_classifier ranking=1 probabilities: oid, classifier_version, class_name, probability.\nWITH selected_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (\n          SELECT m.oid\n          FROM magstat m\n          WHERE m.fid = 1            -- g band\n            AND m.ndet >= 10         -- minimum 10 detections in g\n            AND m.ndubious = 0       -- no dubious points in that filter\n      )\n    ORDER BY p.oid\n    LIMIT 500\n)\nSELECT p.oid, p.classifier_version, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM selected_oids)\nORDER BY p.oid, p.classifier_version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3898, "completion_tokens": 3203, "total_tokens": 7101, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2944, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be20f50c8190a5a3be78308af7d6", "custom_id": "92-3", "response": {"status_code": 200, "request_id": "7a15ec73c8444430a5f4ba3f7d12b219", "body": {"id": "chatcmpl-CSt1E1xGOrfXVy7QIjLLchahED4Iw", "object": "chat.completion", "created": 1761000712, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 500 ZTF objects (ordered by oid) that:\n--  - have at least 10 detections in the g band (fid=1), and\n--  - have no g-band detections flagged as dubious (interpreting \"no dubious corrections\" as no detections with dubious=true in that filter).\n-- Then, return only lc_classifier probabilities with ranking=1 for those objects.\nWITH filtered_oids AS (\n  SELECT p.oid\n  FROM (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n  ) p\n  WHERE p.oid IN (\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n       AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0\n  )\n  ORDER BY p.oid\n  LIMIT 500\n)\nSELECT p.oid, p.classifier_version, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM filtered_oids)\nORDER BY p.oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3181, "completion_tokens": 3550, "total_tokens": 6731, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be20fbcc81909672e831d5f3b8b6", "custom_id": "92-4", "response": {"status_code": 200, "request_id": "3816a0a108d28fbc6e9cc9a703d18f35", "body": {"id": "chatcmpl-CSt1jvdRrn0IeD4b4dzt5P3ScMVTC", "object": "chat.completion", "created": 1761000743, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 500 ZTF objects (ordered by oid) with at least 10 detections in g-band (fid=1)\n-- and no dubious points in that band (ndubious=0). Then return rank-1 lc_classifier results.\nWITH target_oids AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1               -- g band\n      AND ndet >= 10            -- at least 10 detections in g\n      AND ndubious = 0          -- no dubious points in g\n    GROUP BY oid\n    ORDER BY oid\n    LIMIT 500\n)\nSELECT\n    p.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM target_oids)\nORDER BY p.oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3488, "completion_tokens": 2257, "total_tokens": 5745, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be20fef08190a5a943e271925411", "custom_id": "102-2", "response": {"status_code": 200, "request_id": "bd77b85cb66ee894df33ada79d8d0364", "body": {"id": "chatcmpl-CSt2PryTbE8hG22gUDo76Co1bL1pJ", "object": "chat.completion", "created": 1761000785, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- The WISE W1 constraint cannot be enforced with the provided schema because there is no linkage\n-- between ZTF objects (oid in magstat/probability) and ALLWISE sources (oid_catalog in allwise),\n-- nor are there ZTF object coordinates available to perform a positional cross-match.\n-- The query below applies the lc_classifier AGN probability > 0.6 condition, selects at most 50 distinct\n-- ZTF objects (oids), and returns all columns from magstat for those objects.\n\nWITH candidate_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'AGN'\n      AND probability > 0.6\n    GROUP BY oid\n    LIMIT 50\n)\nSELECT *\nFROM magstat\nWHERE oid IN (SELECT oid FROM candidate_oids)\nORDER BY oid, fid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3558, "completion_tokens": 1979, "total_tokens": 5537, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be21160081908163a0942dbce41a", "custom_id": "102-3", "response": {"status_code": 200, "request_id": "88241ddb67a984a555c8b7eb7b9fb430", "body": {"id": "chatcmpl-CSt2k1Kk3V5GBD7MbaAmOZSTTSJSr", "object": "chat.completion", "created": 1761000806, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find at most 50 ZTF objects with P(AGN | lc_classifier) > 0.6\n-- and return all magstat rows for those objects.\n-- NOTE: The WISE W1 constraint (12 <= w1mpro <= 13) requires a linkage between ZTF objects and ALLWISE sources.\n-- In the provided schema, there is no table relating magstat/probability.oids to allwise.oid_catalog (e.g., an xmatch table or object coordinates).\n-- Therefore, the W1 magnitude filter cannot be enforced strictly with the given tables.\n-- If such a linkage table existed (e.g., xmatch(oid, oid_catalog)), the W1 filter would be applied inside the OID subquery using nested queries.\n\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          -- AND p.oid IN (  -- Example of how the W1 filter would be applied if a linkage table were available:\n          --     SELECT xm.oid\n          --     FROM xmatch xm\n          --     WHERE xm.oid_catalog IN (\n          --         SELECT a.oid_catalog\n          --         FROM allwise a\n          --         WHERE a.w1mpro BETWEEN 12 AND 13\n          --     )\n          -- )\n        ORDER BY p.oid\n        LIMIT 50\n    ) o\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3513, "completion_tokens": 2959, "total_tokens": 6472, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2624, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be214ee0819093a6815114823a85", "custom_id": "102-4", "response": {"status_code": 200, "request_id": "e0d65360a1f85c2e55aeb2fa476bdb79", "body": {"id": "chatcmpl-CSt3MDgZjQ7v8ZHfFhvjPvurdw9t9", "object": "chat.completion", "created": 1761000844, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* \nFind at most 50 ZTF objects with:\n- lc_classifier AGN probability > 0.6\n- WISE W1 magnitude between 12 and 13\n\nNotes:\n- We first select up to 50 oids in a subquery (from probability), as recommended.\n- We avoid JOINs and use nested subqueries/CTEs.\n- This query assumes that the ALLWISE identifier (allwise.oid_catalog) can be matched to the ZTF oid. \n  If an explicit crossmatch table is required in your deployment, replace the IN (...) on allwise.oid_catalog\n  with the appropriate subquery that maps ZTF oids to ALLWISE oid_catalog values.\n*/\n\nWITH selected_oids AS (\n  SELECT p.oid\n  FROM probability p\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND p.oid IN (\n      SELECT aw.oid_catalog\n      FROM allwise aw\n      WHERE aw.w1mpro BETWEEN 12 AND 13\n    )\n  GROUP BY p.oid\n  ORDER BY MAX(p.probability) DESC\n  LIMIT 50\n)\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM selected_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3513, "completion_tokens": 3484, "total_tokens": 6997, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3200, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2189a08190943f208b942812db", "custom_id": "81-2", "response": {"status_code": 200, "request_id": "18c0f51fc772e1cdb6fd407225dc9c2b", "body": {"id": "chatcmpl-CSt4QyiYYSeCsB2elJuNCQMtWq8bJ", "object": "chat.completion", "created": 1761000910, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF object id (oid) and angular distance [arcsec] for the ALLWISE source 'J163603.54-065228.7'\n-- Uses a nested subquery to ensure the source belongs to the ALLWISE catalog without an explicit JOIN.\n-- If your xmatch.catid uses a specific value for ALLWISE (e.g., 'ALLWISE'), you may add: AND x.catid = 'ALLWISE'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT aw.oid_catalog\n    FROM allwise aw\n    WHERE aw.oid_catalog = 'J163603.54-065228.7'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 1495, "total_tokens": 4209, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be21fc1081908079ff4813ab8ca1", "custom_id": "81-3", "response": {"status_code": 200, "request_id": "962fda68c390db7f7258970218c4706b", "body": {"id": "chatcmpl-CSt4l5ktjpegmvU1hqROpl0PtkQut", "object": "chat.completion", "created": 1761000931, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF object id (oid) and distance (dist) for the ALLWISE source with designation 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 1311, "total_tokens": 4025, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1216, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be21c29481909ce5a1d50ea6e88f", "custom_id": "81-4", "response": {"status_code": 200, "request_id": "b8ea1429a31f04f6d9679e58880f20d2", "body": {"id": "chatcmpl-CSsxyfOJ6NgM8vwoX6fLA0HqNGi79", "object": "chat.completion", "created": 1761000510, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ZTF objects matched to the specified ALLWISE source; returns ZTF oid and angular separation (dist, arcsec)\nSELECT x.oid, x.dist\nFROM xmatch AS x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise AS a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 1561, "total_tokens": 4275, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be21c0a8819083724354d5e7996e", "custom_id": "69-2", "response": {"status_code": 200, "request_id": "4e7471fbb5d2374506d817cff735d098", "body": {"id": "chatcmpl-CSsyLI3xkznWhmZOtl44De3CiXe4o", "object": "chat.completion", "created": 1761000533, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns from ps1_ztf for the specified ZTF objects\n-- Filter to rows where the nearest source Star/Galaxy score (sgscore1) is < 0.2\n-- Obtain OIDs via a subquery from the object table (avoiding JOINs as per guidance)\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3154, "completion_tokens": 838, "total_tokens": 3992, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be21d94081909c5e4f3e68819554", "custom_id": "69-3", "response": {"status_code": 200, "request_id": "ab22f3fe6e08716c234c84b84d4578f0", "body": {"id": "chatcmpl-CSsyWQRv72i4CHcrdIWbYJRbLTyJn", "object": "chat.completion", "created": 1761000544, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find PS1/ZTF matches for specified OIDs where the nearest source star/galaxy score (sgscore1) is < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Obtain valid OIDs from the object table (avoids joins and follows best practice of nested subqueries)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3154, "completion_tokens": 958, "total_tokens": 4112, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be21e87c819083abc9f0e7d7b51f", "custom_id": "69-4", "response": {"status_code": 200, "request_id": "fa2dfc3444cf83ec6367e4f94bb7b96d", "body": {"id": "chatcmpl-CSsyiJFr2I3y8vpIjEIRkojMjfyYZ", "object": "chat.completion", "created": 1761000556, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all Pan-STARRS crossmatch rows (ps1_ztf) for the specified ZTF object IDs\n-- where the star/galaxy score of the nearest source (sgscore1) is less than 0.2.\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Obtain the relevant OIDs from the object table (preferred nested lookup)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3154, "completion_tokens": 649, "total_tokens": 3803, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be21decc8190b61ad3f005b31136", "custom_id": "61-2", "response": {"status_code": 200, "request_id": "f919d36ceecfa9c81ed0a2bcff64ddb4", "body": {"id": "chatcmpl-CSsyvEPtcRgJ5zncnfSAiSQMic5mr", "object": "chat.completion", "created": 1761000569, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19; fainter = larger magnitude)\n-- - last difference magnitude brighter than 17 (maglast < 17; brighter = smaller magnitude)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2631, "completion_tokens": 700, "total_tokens": 3331, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be21ec3c81908cb7ac7d125eddba", "custom_id": "61-3", "response": {"status_code": 200, "request_id": "eac3ca4ce7df6e7f745e26f92886f1b6", "body": {"id": "chatcmpl-CSsz41Zr2Ph3LRbNPo3heQhvRCpxY", "object": "chat.completion", "created": 1761000578, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19; larger mag = fainter)\n-- - last difference magnitude brighter than 17 (maglast < 17; smaller mag = brighter)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2631, "completion_tokens": 700, "total_tokens": 3331, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be22059081909b7788eab76a3035", "custom_id": "61-4", "response": {"status_code": 200, "request_id": "1575c028862325bf400738899c789e37", "body": {"id": "chatcmpl-CSszEoYSLbEJhuveoAnK3vrcp8FPX", "object": "chat.completion", "created": 1761000588, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2631, "completion_tokens": 945, "total_tokens": 3576, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be223bac8190a768068240fcefa7", "custom_id": "104-2", "response": {"status_code": 200, "request_id": "2d5df89a73087d4a449cc500adb3968f", "body": {"id": "chatcmpl-CSszRwvM9mmrU0nxRW3pYmKPdg6P0", "object": "chat.completion", "created": 1761000601, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Objects with P(asteroid) > 0.9 for stamp classifier version 'stamp_classifier_1.0.4'\n-- Returns: ZTF object id (oid), candidate id (candid), nearest SSO distance, MPC magnitude, SSO name,\n-- and candidate-related fields: filter id, FWHM (SExtractor), number of PS1 calibrators, exposure time.\nSELECT\n    s.oid AS oid,\n    s.candid AS candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    (SELECT dq.fid FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS fid,\n    (SELECT dq.fwhm FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS fwhm,\n    (SELECT dq.nmatches FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS nmatches,\n    (SELECT dq.exptime FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS exptime\nFROM ss_ztf s\nWHERE s.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n)\nORDER BY (\n    SELECT p2.probability\n    FROM probability p2\n    WHERE p2.oid = s.oid\n      AND p2.classifier_name = 'stamp_classifier'\n      AND p2.classifier_version = 'stamp_classifier_1.0.4'\n      AND p2.class_name = 'asteroid'\n) DESC\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3687, "completion_tokens": 2771, "total_tokens": 6458, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2368, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2281348190a8f10085d55377cf", "custom_id": "104-3", "response": {"status_code": 200, "request_id": "7d58545d2e2c067398eab0d715c6e413", "body": {"id": "chatcmpl-CSszrElLf35hu0AI67idylhsuRpQS", "object": "chat.completion", "created": 1761000627, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- At most 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n-- For each object, we return the most recent candidate (by mjd) to supply candidate-related fields.\nWITH selected_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    -- Identifiers\n    o.oid AS oid,\n    (SELECT d.candid\n     FROM detection d\n     WHERE d.oid = o.oid\n     ORDER BY d.mjd DESC\n     LIMIT 1) AS candid,\n    -- Nearest Solar System object info (MPC-like magnitude provided by ssmagnr)\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    (SELECT s.ssmagnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssmagnr,\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    -- Candidate-related fields from the latest detection\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.oid = o.oid\n     ORDER BY d.mjd DESC\n     LIMIT 1) AS fid,\n    -- Requested fields not present in the provided schema; returned as NULL placeholders\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,\n    NULL::INTEGER AS n_ps1_calibrators,\n    NULL::DOUBLE PRECISION AS exposure_time\nFROM selected_oids o;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2845, "completion_tokens": 3414, "total_tokens": 6259, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3008, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be22aed48190b5f76f290b7ba4f2", "custom_id": "104-4", "response": {"status_code": 200, "request_id": "c8b379364eda6bac06afa2420dd2929d", "body": {"id": "chatcmpl-CSt0brTxd6whbeVkj2ZQFY1cmzqkb", "object": "chat.completion", "created": 1761000673, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n   Return: object oid, candidate candid, nearest SSO distance, MPC magnitude, SSO name,\n           and detection-level fields: fid, plus placeholders for FWHM, PS1 calibrators, exposure time.\n   Note: The provided schema does not include columns for FWHM (SExtractor), number of PS1 calibrators, or exposure time.\n         These are returned as NULL placeholders. If these fields exist in another schema/table, they can be substituted here. */\nWITH candidate_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n)\nSELECT\n    s.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    /* filter identifier from detection corresponding to this candid */\n    (SELECT d.fid FROM detection d WHERE d.candid = s.candid) AS fid,\n    /* Placeholders for fields not present in the provided schema */\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,\n    NULL::INTEGER AS ps1_calibrators_used,\n    NULL::DOUBLE PRECISION AS exposure_time\nFROM ss_ztf s\nWHERE s.oid IN (SELECT oid FROM candidate_oids)\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3444, "completion_tokens": 2775, "total_tokens": 6219, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2432, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be22ad388190a52e96320d085e24", "custom_id": "71-2", "response": {"status_code": 200, "request_id": "ee89e741468ac1f9d71c3b0fcddd0f56", "body": {"id": "chatcmpl-CSt109ZtD97Cfgl2V2Q8ie93weK7s", "object": "chat.completion", "created": 1761000698, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find reference rows for given ZTF objects in g band (fid=1)\n-- Return: reference ID (rfid), ZTF ID (oid), candidate ID (candid), and nearest reference magnitude with uncertainty (magnr, sigmagnr)\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF20aczxeud'),\n    ('ZTF21aappfdu'),\n    ('ZTF22aacqjeb')\n)\nSELECT\n  r.rfid,\n  r.oid,\n  r.candid,\n  r.magnr,\n  r.sigmagnr\nFROM reference r\nWHERE r.fid = 1\n  AND r.oid IN (SELECT oid FROM target_oids)\nORDER BY r.oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2300, "completion_tokens": 1124, "total_tokens": 3424, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be22c27c819099c580d0a231b79c", "custom_id": "71-3", "response": {"status_code": 200, "request_id": "70626b809cfc4aa0ad567bb41efdea82", "body": {"id": "chatcmpl-CSt1DeTPbREBiNjzNKujXK26vXOT4", "object": "chat.completion", "created": 1761000711, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find g-band (fid = 1) reference entries for specific ZTF objects\nWITH selected_oids (oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,        -- identifier of the reference\n    oid,         -- ZTF identifier\n    candid,      -- candidate identifier\n    magnr,       -- magnitude of nearest reference object\n    sigmagnr     -- 1-sigma uncertainty of magnr\nFROM reference\nWHERE fid = 1\n  AND oid IN (SELECT oid FROM selected_oids)\nORDER BY oid;  -- sort by ZTF identifier", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2300, "completion_tokens": 1437, "total_tokens": 3737, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1280, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be22cac88190b42ffb6b0766fc6e", "custom_id": "71-4", "response": {"status_code": 200, "request_id": "92c632e6e9e68c7b6514d545e20f795b", "body": {"id": "chatcmpl-CSt1TBNy2Q4EWxGD1GxVWh0zLirnm", "object": "chat.completion", "created": 1761000727, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Filter g-band reference rows (fid = 1) for the specified ZTF objects.\n-- Return: reference identifier (rfid), ZTF identifier (oid), candidate identifier (candid),\n-- and the nearest reference object's magnitude and uncertainty (magnr, sigmagnr).\nSELECT\n    rfid,\n    oid,\n    candid,\n    magnr,\n    sigmagnr\nFROM reference\nWHERE fid = 1\n  AND oid IN (\n      SELECT oid\n      FROM object\n      WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n  )\nORDER BY oid;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2782, "completion_tokens": 1040, "total_tokens": 3822, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be22d4d88190bbcbec1df5ca1a07", "custom_id": "42-2", "response": {"status_code": 200, "request_id": "2fde4fd822d1e3e374751c2b651af915", "body": {"id": "chatcmpl-CSt1lCkJvsvMTk5daOXQAQQ1jO9d7", "object": "chat.completion", "created": 1761000745, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all epochs in dataquality for the specified ZTF object, sorted by reduced chi-square (ascending)\nSELECT\n    oid,           -- object identifier\n    candid,        -- candidate identifier\n    fid,           -- filter identifier (1=g; 2=r; 3=i)\n    chipsf,        -- reduced chi-square for PSF-fit\n    fwhm,          -- Full Width Half Max from SExtractor [pixels]\n    classtar,      -- Star/Galaxy classification score from SExtractor\n    nbad,          -- number of prior-tagged bad pixels in a 5 x 5 pixel stamp\n    magzpsci,      -- magnitude zero point [mag]\n    magzpsciunc,   -- magnitude zero point uncertainty [mag]\n    exptime        -- exposure time [sec]\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf NULLS LAST;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2728, "completion_tokens": 971, "total_tokens": 3699, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be22db848190a362b4f40370c2de", "custom_id": "42-3", "response": {"status_code": 200, "request_id": "ef55660608f051436b3ecdf15bd34bb2", "body": {"id": "chatcmpl-CSt1yoML2AkmiCwTPN90bnh0kGW2b", "object": "chat.completion", "created": 1761000758, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- All epochs in dataquality for object 'ZTF21aapnixl', sorted by reduced chi-square (chipsf)\nSELECT\n    oid,            -- object identifier\n    candid,         -- candidate identifier (epoch)\n    fid,            -- filter identifier (1=g; 2=r; 3=i)\n    chipsf,         -- reduced chi-square for PSF-fit\n    fwhm,           -- FWHM from SExtractor [pixels]\n    classtar,       -- Star/Galaxy classification score from SExtractor\n    nbad,           -- number of prior-tagged bad pixels in 5x5 stamp\n    magzpsci,       -- magnitude zero point [mag]\n    magzpsciunc,    -- magnitude zero point uncertainty [mag]\n    exptime         -- exposure time [sec]\nFROM dataquality\nWHERE oid IN (\n    -- prioritize obtaining OIDs in a subquery (from object table)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF21aapnixl'\n)\nORDER BY chipsf ASC NULLS LAST;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3210, "completion_tokens": 1004, "total_tokens": 4214, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be22ed888190bd70b2a841324daf", "custom_id": "42-4", "response": {"status_code": 200, "request_id": "210460d4ccbf453f3eec59e96b0efcde", "body": {"id": "chatcmpl-CSt2Cc4jUUO5KwdrljGCaVF5URzBv", "object": "chat.completion", "created": 1761000772, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all epochs (rows) in dataquality for the specified ZTF object\n-- Return: oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime\n-- Sort by reduced chi-square (chipsf), placing NULLs last\nSELECT\n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2728, "completion_tokens": 1172, "total_tokens": 3900, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be22f9a88190a0388eabd263bca5", "custom_id": "107-2", "response": {"status_code": 200, "request_id": "3bce8833f6bb55fa5cd129899a68610a", "body": {"id": "chatcmpl-CSt2XSzQflUOG0naLUF0bbwnRw5rI", "object": "chat.completion", "created": 1761000793, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find up to 10 ZTF objects with:\n   - ndet > 500\n   - stamp_classifier (version 'stamp_classifier_1.0.4') asteroid probability > 0.5\n   - nearest Solar System object distance < 2 arcsec\n   Return: oid, ndet, firstmjd, lastmjd, probability, candid, ssdistnr, ssnamenr, mjd, fid\n   Ordered by first detection date (firstmjd)\n*/\nWITH good_prob AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n),\ngood_ss AS (\n    SELECT s.oid, s.candid, s.ssdistnr, s.ssnamenr\n    FROM ss_ztf s\n    WHERE s.ssdistnr < 2\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    /* asteroid probability from the specified stamp classifier version */\n    (SELECT gp.probability FROM good_prob gp WHERE gp.oid = o.oid) AS probability,\n    /* candidate identifier and Solar System match info */\n    (SELECT gs.candid FROM good_ss gs WHERE gs.oid = o.oid) AS candid,\n    (SELECT gs.ssdistnr FROM good_ss gs WHERE gs.oid = o.oid) AS ssdistnr,\n    (SELECT gs.ssnamenr FROM good_ss gs WHERE gs.oid = o.oid) AS ssnamenr,\n    /* detection date and filter for the matched candidate */\n    (SELECT d.mjd FROM detection d WHERE d.candid = (SELECT gs.candid FROM good_ss gs WHERE gs.oid = o.oid)) AS mjd,\n    (SELECT d.fid FROM detection d WHERE d.candid = (SELECT gs.candid FROM good_ss gs WHERE gs.oid = o.oid)) AS fid\nFROM object o\nWHERE o.ndet > 500\n  AND o.oid IN (SELECT gp.oid FROM good_prob gp)\n  AND o.oid IN (SELECT gs.oid FROM good_ss gs)\nORDER BY o.firstmjd\nLIMIT 10;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3343, "completion_tokens": 3070, "total_tokens": 6413, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be232b2481909a6f62c2cdf33a02", "custom_id": "107-3", "response": {"status_code": 200, "request_id": "4393532f54ec56f8f9f08061e362de2b", "body": {"id": "chatcmpl-CSt3D8sVfiZIX27egMwsm6a1uuxHa", "object": "chat.completion", "created": 1761000835, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 10 ZTF objects meeting:\n-- - ndet > 500\n-- - stamp_classifier (v=stamp_classifier_1.0.4) asteroid probability > 0.5\n-- - nearest Solar System object distance < 2 arcsec\n-- Return requested columns and order by firstmjd\n\nWITH prob_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n),\nss_oids AS (\n    SELECT s.oid\n    FROM ss_ztf s\n    WHERE s.ssdistnr < 2\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    /* asteroid probability from the specified stamp classifier/version */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'asteroid'\n    ) AS probability,\n    /* candidate identifier associated with the SS match */\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n    /* distance (arcsec) to nearest known Solar System object */\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    /* MPC name of the nearest SS object */\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    /* detection date and filter for that candidate */\n    (\n        SELECT d.mjd\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS mjd,\n    (\n        SELECT d.fid\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS fid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM prob_oids)\n  AND o.oid IN (SELECT oid FROM ss_oids)\n  AND o.ndet > 500\nORDER BY o.firstmjd\nLIMIT 10;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3388, "completion_tokens": 3870, "total_tokens": 7258, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3328, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2372bc81908644b41899aad4dc", "custom_id": "107-4", "response": {"status_code": 200, "request_id": "bf15d0226d2ffd7909f095cdafa86d7a", "body": {"id": "chatcmpl-CSt45dQHrbKGa0zVwFpDHk113X7VZ", "object": "chat.completion", "created": 1761000889, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find up to 10 ZTF objects with:\n   - ndet > 500\n   - stamp_classifier (version 'stamp_classifier_1.0.4') asteroid probability > 0.5\n   - nearest Solar System object distance < 2 arcsec\n   Return requested columns and order by first detection date (firstmjd).\n*/\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500\n      AND EXISTS (\n          SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.class_name = 'asteroid'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.classifier_version = 'stamp_classifier_1.0.4'\n            AND p.probability > 0.5\n      )\n      AND EXISTS (\n          SELECT 1\n          FROM ss_ztf s\n          WHERE s.oid = o.oid\n            AND s.ssdistnr < 2\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT\n    o.oid,                                   -- ZTF identifier\n    o.ndet,                                  -- number of detections\n    o.firstmjd,                              -- first detection date\n    o.lastmjd,                               -- last detection date\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'asteroid'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4') AS probability,  -- asteroid prob (stamp classifier)\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,            -- candidate identifier\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,        -- distance to nearest SS object (arcsec)\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,        -- MPC name (may be null)\n    (SELECT d.mjd\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS detection_mjd,  -- detection date for that candid\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS fid              -- filter identifier for that candid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_oids)\nORDER BY o.firstmjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3388, "completion_tokens": 3532, "total_tokens": 6920, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2944, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2399108190961dc5fca405760b", "custom_id": "83-2", "response": {"status_code": 200, "request_id": "bcb86d53d4ab56b019a780e1a9a5b1d9", "body": {"id": "chatcmpl-CSt4g1rChKLamhzRfdC3kCx5WeW1L", "object": "chat.completion", "created": 1761000926, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all ALLWISE rows within 2 arcseconds of the ZTF object's mean position\nSELECT *\nFROM allwise\nWHERE q3c_radial_query(\n    ra,\n    dec,\n    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),\n    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),\n    2.0/3600.0  -- radius in degrees (2 arcsec)\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3057, "completion_tokens": 2222, "total_tokens": 5279, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2112, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be239ad08190aed5195d33345671", "custom_id": "83-3", "response": {"status_code": 200, "request_id": "9a13570c30414b2f922e4540fd6b1d18", "body": {"id": "chatcmpl-CSsxzqaKG3MziuZnMssbBBbXoVQsG", "object": "chat.completion", "created": 1761000511, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all ALLWISE rows near the ZTF object 'ZTF21aazqwxv' using a cone search around its mean coordinates.\n-- Radius set to 2 arcseconds (2/3600 degrees). Adjust if needed.\nWITH target AS (\n    SELECT meanra AS ra, meandec AS dec\n    FROM object\n    WHERE oid = 'ZTF21aazqwxv'\n)\nSELECT a.*\nFROM allwise a\nWHERE EXISTS (\n    SELECT 1\n    FROM target t\n    WHERE q3c_radial_query(a.ra, a.dec, t.ra, t.dec, 2.0/3600.0)\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3057, "completion_tokens": 1746, "total_tokens": 4803, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be23bb288190939d0eb8e22b0179", "custom_id": "83-4", "response": {"status_code": 200, "request_id": "f6a6ca11df197331f87d7a8cf7f39cfd", "body": {"id": "chatcmpl-CSsxz3VrW00ZdgzcSQv0FlhpoC4iv", "object": "chat.completion", "created": 1761000511, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all ALLWISE catalog rows linked to the given ZTF object via xmatch (no explicit JOIN, use nested query)\nSELECT *\nFROM allwise\nWHERE oid_catalog IN (\n    SELECT DISTINCT oid_catalog\n    FROM xmatch\n    WHERE oid = 'ZTF21aazqwxv'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2688, "completion_tokens": 776, "total_tokens": 3464, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be23bf788190aec35faa05f5ed93", "custom_id": "84-2", "response": {"status_code": 200, "request_id": "58d9d018a0587caa708692da95466ffa", "body": {"id": "chatcmpl-CSsxzaPEVtfp6LGygQAFpuvbHfItA", "object": "chat.completion", "created": 1761000511, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- For the ZTF object 'ZTF19aascdol', return its ALLWISE counterpart(s):\n-- ZTF identifier (oid), catalog identifier (oid_catalog), angular separation (dist in arcsec),\n-- and WISE magnitudes W1\u2013W4 (w1mpro, w2mpro, w3mpro, w4mpro).\nWITH targets AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF19aascdol'\n)\nSELECT\n    xm.oid,\n    xm.oid_catalog,\n    xm.dist,\n    (SELECT aw.w1mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w1mpro,\n    (SELECT aw.w2mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w2mpro,\n    (SELECT aw.w3mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w3mpro,\n    (SELECT aw.w4mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w4mpro\nFROM xmatch xm\nWHERE xm.oid IN (SELECT oid FROM targets)\n  AND xm.catid = 'ALLWISE'\n  AND EXISTS (\n      SELECT 1 FROM allwise aw\n      WHERE aw.oid_catalog = xm.oid_catalog\n  );", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3214, "completion_tokens": 2603, "total_tokens": 5817, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2304, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be23be90819088956ee9feb53f48", "custom_id": "84-3", "response": {"status_code": 200, "request_id": "d97d13c3cfc61a3fa9f5101717cbca93", "body": {"id": "chatcmpl-CSsxzRn0KjB4uGFADbT5syTYPp9P9", "object": "chat.completion", "created": 1761000511, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ALLWISE matches for the given ZTF object, including:\n-- - ZTF identifier (oid)\n-- - ALLWISE catalog identifier (oid_catalog)\n-- - Angular distance between counterparts in arcseconds (dist)\n-- - WISE magnitudes W1 through W4 (w1mpro, w2mpro, w3mpro, w4mpro)\nSELECT\n    x.oid,\n    x.oid_catalog,\n    x.dist,\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = (\n    -- Obtain the OID via subquery (ensures the object exists and optimizes the main query)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF19aascdol'\n)\n-- Ensure we only return matches that exist in the ALLWISE catalog table\nAND EXISTS (\n    SELECT 1\n    FROM allwise a\n    WHERE a.oid_catalog = x.oid_catalog\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3214, "completion_tokens": 1471, "total_tokens": 4685, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be23c4e48190935374d8fe3c6c33", "custom_id": "84-4", "response": {"status_code": 200, "request_id": "284b5db0791b9553606058d8906ae69f", "body": {"id": "chatcmpl-CSsxzNHA4QRXMmqtIedITcVce1Eyi", "object": "chat.completion", "created": 1761000511, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ALLWISE matches for a specific ZTF object, returning ZTF and catalog identifiers,\n-- angular separation (arcsec), and WISE W1\u2013W4 magnitudes.\nSELECT\n  x.oid,                -- ZTF object identifier\n  x.oid_catalog,        -- Identifier in the ALLWISE catalog\n  x.dist,               -- Angular distance between counterparts [arcsec]\n  (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n  (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n  (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n  (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = 'ZTF19aascdol'\n  AND x.catid = 'ALLWISE';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3214, "completion_tokens": 2408, "total_tokens": 5622, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2176, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2507648190961371ca3ec6fe8e", "custom_id": "96-2", "response": {"status_code": 200, "request_id": "be21441701927920063dc1512dee975e", "body": {"id": "chatcmpl-CSsyAH1gKN5c6PNoZ7I13RI9VdgJn", "object": "chat.completion", "created": 1761000522, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find all detections for objects whose nearest known Solar System object\n   is '2003FP134' or '2009UK56' within 2 arcsec according to ss_ztf.ssdistnr */\nWITH target_ss AS (\n  SELECT oid, candid, ssdistnr, ssmagnr, ssnamenr\n  FROM ss_ztf\n  WHERE ssnamenr IN ('2003FP134', '2009UK56')\n    AND ssdistnr <= 2  -- ssdistnr is the distance to the nearest known solar system object (arcsec)\n)\nSELECT\n  /* all columns from ss_ztf (via correlated subqueries to avoid JOINs) */\n  (SELECT t.oid FROM target_ss t WHERE t.oid = d.oid) AS oid,\n  (SELECT t.candid FROM target_ss t WHERE t.oid = d.oid) AS candid,\n  (SELECT t.ssdistnr FROM target_ss t WHERE t.oid = d.oid) AS ssdistnr,\n  (SELECT t.ssmagnr FROM target_ss t WHERE t.oid = d.oid) AS ssmagnr,\n  (SELECT t.ssnamenr FROM target_ss t WHERE t.oid = d.oid) AS ssnamenr,\n  /* requested detection columns */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_ss)\nORDER BY\n  /* Sort by MPC name (ssnamenr) then detection date (mjd) */\n  (SELECT t.ssnamenr FROM target_ss t WHERE t.oid = d.oid),\n  d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2649, "completion_tokens": 3459, "total_tokens": 6108, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3072, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be23e1648190a727e0474fa1b7ce", "custom_id": "96-3", "response": {"status_code": 200, "request_id": "9bc1b8c9ee53c9d88e59fe5750babbaa", "body": {"id": "chatcmpl-CSsyJste1M5pqxEThftMsVxntWouc", "object": "chat.completion", "created": 1761000531, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Get all detections for ZTF objects within 2 arcsec of the MPC names '2003FP134' and '2009UK56'.\n   Return all ss_ztf columns, plus detection date (mjd), filter id (fid), isdiffpos, RA, Dec, magpsf and sigmapsf.\n   Sort by MPC name (ssnamenr) and detection date (mjd). */\nWITH target_oids AS (\n  SELECT oid\n  FROM ss_ztf\n  WHERE ssnamenr IN ('2003FP134', '2009UK56')\n    AND ssdistnr <= 2\n)\nSELECT\n  /* all columns from ss_ztf (via scalar subqueries keyed by detection.oid) */\n  (SELECT s.oid      FROM ss_ztf s WHERE s.oid = d.oid) AS oid,\n  (SELECT s.candid   FROM ss_ztf s WHERE s.oid = d.oid) AS candid,\n  (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssdistnr,\n  (SELECT s.ssmagnr  FROM ss_ztf s WHERE s.oid = d.oid) AS ssmagnr,\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid) AS ssnamenr,\n  /* selected detection columns */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\nORDER BY\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid),\n  d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2649, "completion_tokens": 3336, "total_tokens": 5985, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2944, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2419d0819097407f352e688f94", "custom_id": "96-4", "response": {"status_code": 200, "request_id": "6edf62cdff9fb515eee295aaf174c5d8", "body": {"id": "chatcmpl-CSsyNBzj6jngVdl8Xc6OFnbHqRLhl", "object": "chat.completion", "created": 1761000535, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all detections for ZTF objects whose nearest known Solar System object is either\n-- '2003FP134' or '2009UK56' and lies within 2 arcsec (using ssdistnr), returning:\n-- - all columns from ss_ztf\n-- - detection date (mjd), filter identifier (fid), isdiffpos, RA, Dec, magpsf and sigmapsf\n-- Results are sorted by MPC name (ssnamenr) and detection date (mjd)\n\nWITH target_ss AS (\n    SELECT\n        oid,\n        candid,\n        ssdistnr,\n        ssmagnr,\n        ssnamenr\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n      AND ssdistnr <= 2  -- 2 arcsec\n)\nSELECT\n    d.oid AS oid,  -- ss_ztf.oid\n    (SELECT t.candid FROM target_ss t WHERE t.oid = d.oid) AS candid,       -- ss_ztf.candid\n    (SELECT t.ssdistnr FROM target_ss t WHERE t.oid = d.oid) AS ssdistnr,   -- ss_ztf.ssdistnr\n    (SELECT t.ssmagnr FROM target_ss t WHERE t.oid = d.oid) AS ssmagnr,     -- ss_ztf.ssmagnr\n    (SELECT t.ssnamenr FROM target_ss t WHERE t.oid = d.oid) AS ssnamenr,   -- ss_ztf.ssnamenr\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_ss)\nORDER BY ssnamenr, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2649, "completion_tokens": 3356, "total_tokens": 6005, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2944, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be246750819092740421acbc7ecf", "custom_id": "67-2", "response": {"status_code": 200, "request_id": "1a2bab4be9513e462ec3af45817f424d", "body": {"id": "chatcmpl-CSsybLFcZUEKQNRQFWZv8gDtk3xLQ", "object": "chat.completion", "created": 1761000549, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns (*) for the requested ZTF objects whose nearest Gaia source is within 1.5 arcsec\nWITH targets(oid) AS (\n  VALUES \n    ('ZTF18acxlskz'),\n    ('ZTF22aanppbi'),\n    ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (SELECT oid FROM targets)\n  AND neargaia <= 1.5;  -- neargaia is in arcseconds; NULLs are excluded automatically by the comparison", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2134, "completion_tokens": 1272, "total_tokens": 3406, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be247bcc819085d5a100e91dc374", "custom_id": "67-3", "response": {"status_code": 200, "request_id": "bba394e4be851e0ac76707f5c41c2dc1", "body": {"id": "chatcmpl-CSsyeCrhwcmONKPzBSVDFZP3QMqdc", "object": "chat.completion", "created": 1761000552, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the requested OIDs where the nearest Gaia source is within 1.5 arcsec\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT oid FROM target_oids)\n  AND g.neargaia <= 1.5;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2616, "completion_tokens": 749, "total_tokens": 3365, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be247eac819093fdf4690e2fd646", "custom_id": "67-4", "response": {"status_code": 200, "request_id": "ef552b46140a750b1d38488b8da8d4c0", "body": {"id": "chatcmpl-CSsyf9qJdEKRipHUmf2O54pMOjghm", "object": "chat.completion", "created": 1761000553, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find objects in gaia_ztf whose nearest Gaia source is within 1.5 arcsec for the specified ZTF OIDs\nWITH input_oids(oid) AS (\n    VALUES \n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n),\nselected_oids AS (\n    -- Retrieve valid OIDs from the object table (following the guideline to obtain OIDs via a subquery)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT i.oid FROM input_oids i)\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT so.oid FROM selected_oids so)\n  AND g.neargaia <= 1.5;  -- \"within 1.5 arcsec\" interpreted as inclusive (<= 1.5)", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2616, "completion_tokens": 1028, "total_tokens": 3644, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 832, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be24a7848190a2f1aa64394e904f", "custom_id": "55-2", "response": {"status_code": 200, "request_id": "82a87471916e78d10920be3d80968b1f", "body": {"id": "chatcmpl-CSsyo64JNtgWxBMfyicpV2y83Ly5L", "object": "chat.completion", "created": 1761000562, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the specified ZTF object OID\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2357, "completion_tokens": 422, "total_tokens": 2779, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 384, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be24a8108190bfb25481bc873f26", "custom_id": "55-3", "response": {"status_code": 200, "request_id": "56184cac930f121caed19ec9eef6756e", "body": {"id": "chatcmpl-CSsyqxUwt6uJzPbNobkYDQcjQcN2N", "object": "chat.completion", "created": 1761000564, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all columns for the requested ZTF object using a nested subquery to retrieve the OID\nSELECT *\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2357, "completion_tokens": 508, "total_tokens": 2865, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 448, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be24a504819080ff8979c61d9503", "custom_id": "55-4", "response": {"status_code": 200, "request_id": "3a6635c6b765d297292e9061c788283a", "body": {"id": "chatcmpl-CSsytK61NJUsc7oNHWFFhKln92YdP", "object": "chat.completion", "created": 1761000567, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all columns for the specified ZTF object from the object table\nSELECT *\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2357, "completion_tokens": 566, "total_tokens": 2923, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be24b7b081908464b714ed4c5b44", "custom_id": "47-2", "response": {"status_code": 200, "request_id": "b18cb7ddf3c290df6fcd3406cffca081", "body": {"id": "chatcmpl-CSsyvH634FVwDxt3txTE1TaSoXk2C", "object": "chat.completion", "created": 1761000569, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Find detections for the specified ZTF objects with real/bogus (deep-learning) score > 0.7\n   Returning: ZTF identifier (oid), candidate id (candid), filter id (fid), detection date (mjd),\n   isdiffpos flag, detection coordinates (ra, dec), difference magnitude (magpsf) and its uncertainty (sigmapsf), and real/bogus score (drb) */\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.drb\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\n  AND d.drb > 0.7\nORDER BY d.oid, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2972, "completion_tokens": 1380, "total_tokens": 4352, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be24d8508190bbae1dd521ac6c17", "custom_id": "47-3", "response": {"status_code": 200, "request_id": "8752439617075ad8d96e0fece8a82702", "body": {"id": "chatcmpl-CSsywa0pGyOKgMtMAycRcDySPhunY", "object": "chat.completion", "created": 1761000570, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Detections for the specified ZTF objects with real/bogus score (rb) > 0.7\n-- Note: 'rb' (traditional ZTF real-bogus score) is used for filtering and returning,\n-- and 'magpsf'/'sigmapsf' provide the difference magnitude and its uncertainty.\nSELECT\n    d.oid,          -- ZTF identifier\n    d.candid,       -- candidate identifier\n    d.fid,          -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,          -- detection date (MJD)\n    d.isdiffpos,    -- isdiffpos flag\n    d.ra,           -- detection RA\n    d.dec,          -- detection Dec\n    d.magpsf,       -- difference magnitude (PSF)\n    d.sigmapsf,     -- uncertainty of difference magnitude\n    d.rb            -- real/bogus score\nFROM detection d\nWHERE d.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nAND d.rb > 0.7\nORDER BY d.oid, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2972, "completion_tokens": 1739, "total_tokens": 4711, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2504508190ae51f755c8889cbe", "custom_id": "47-4", "response": {"status_code": 200, "request_id": "6f061452de7654a3e6ac8afef0ce195b", "body": {"id": "chatcmpl-CSsyzNaJjFBydny6CZU5EjXG29F85", "object": "chat.completion", "created": 1761000573, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Detections for specified ZTF objects with rb > 0.7, ordered by ZTF (oid) and detection date (mjd)\nWITH desired_oids(oid) AS (\n    VALUES \n        ('ZTF23aaawbsc'),\n        ('ZTF21abxlmuw')\n)\nSELECT\n    d.oid AS ztf,        -- ZTF identifier (object id)\n    d.candid,            -- candidate identifier\n    d.fid,               -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,               -- detection date (MJD)\n    d.isdiffpos,         -- isdiffpos flag\n    d.ra,                -- detection RA\n    d.dec,               -- detection Dec\n    d.magpsf,            -- difference magnitude\n    d.sigmapsf,          -- difference magnitude uncertainty\n    d.rb                 -- real/bogus score\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM desired_oids)\n  AND d.rb > 0.7\nORDER BY d.oid, d.mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2490, "completion_tokens": 1645, "total_tokens": 4135, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1408, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2554c88190be0ad7f399f31cb4", "custom_id": "79-2", "response": {"status_code": 200, "request_id": "18a29723727616ded188430e810f5f83", "body": {"id": "chatcmpl-CSsz2nQWRKh27qGILqvj7r7lhT2ju", "object": "chat.completion", "created": 1761000576, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get catalog name (catid), catalog object identifier (oid_catalog), and angular distance in arcsec (dist)\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2005, "completion_tokens": 701, "total_tokens": 2706, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 640, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be25704c8190b81edcb39de81e55", "custom_id": "79-3", "response": {"status_code": 200, "request_id": "82a35e718f315b9b43002ae599cec0cb", "body": {"id": "chatcmpl-CSsz3PSGdardEcPGK0Gq2aC84wvAG", "object": "chat.completion", "created": 1761000577, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Retrieve catalog name, catalog object identifier, and angular distance (arcsec) for the specified ZTF object\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2005, "completion_tokens": 828, "total_tokens": 2833, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 768, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2571f08190afc1e331d9df86f1", "custom_id": "79-4", "response": {"status_code": 200, "request_id": "b39d0c7bbaebc65257fa863fd0a53e0c", "body": {"id": "chatcmpl-CSsz9jJWaFVXv096AVxPivmkNt2aK", "object": "chat.completion", "created": 1761000583, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return catalog name, catalog object id, and angular separation [arcsec] for the given ZTF object\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2005, "completion_tokens": 636, "total_tokens": 2641, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 576, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be258dac8190a511ac5e59be2b54", "custom_id": "94-2", "response": {"status_code": 200, "request_id": "1ca8f28386ea75e9841324bd5e4ff4bb", "body": {"id": "chatcmpl-CSsxzQLf8IYEDiWBqO2QIxKzZLpf5", "object": "chat.completion", "created": 1761000511, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all columns from object and reference for ZTF objects with a reference change, limiting the result to at most 50 rows\nSELECT\n    o.*,\n    r.*\nFROM\n    object o,\n    reference r\nWHERE\n    o.oid = r.oid\n    AND o.oid IN (\n        SELECT oid\n        FROM object\n        WHERE reference_change = TRUE\n    )\nLIMIT 50;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2735, "completion_tokens": 1886, "total_tokens": 4621, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be258eac81908a9d554f0fef4b9e", "custom_id": "94-3", "response": {"status_code": 200, "request_id": "37133dcca170bbd5f7577c2548a1da5e", "body": {"id": "chatcmpl-CSsyKwENNDcs1HLjULMGsvf0Wap3T", "object": "chat.completion", "created": 1761000532, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all columns from object and reference for objects with a reference change, limiting to 50 rows\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change = true\n)\nSELECT o.*, r.*\nFROM selected_oids so, object o, reference r\nWHERE o.oid = so.oid\n  AND r.oid = so.oid\nLIMIT 50;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2735, "completion_tokens": 1692, "total_tokens": 4427, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1600, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be263cc881908bdbc65160acfeba", "custom_id": "94-4", "response": {"status_code": 200, "request_id": "51121b503826c0eac15c69f199e8fcc1", "body": {"id": "chatcmpl-CSsyeSpPGn57IllyYKXNMXr31Tnsn", "object": "chat.completion", "created": 1761000552, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get up to 50 rows combining all columns from object and reference\n-- for objects that had a change in the reference (reference_change = TRUE)\nSELECT *\nFROM\n    (SELECT * FROM object WHERE reference_change = TRUE) o,\n    reference r\nWHERE r.oid = o.oid\nLIMIT 50;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2735, "completion_tokens": 1739, "total_tokens": 4474, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1664, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be25a6888190b492f17fac90a250", "custom_id": "90-2", "response": {"status_code": 200, "request_id": "50374e41366e64e0f908505fbeb7ef8c", "body": {"id": "chatcmpl-CSsz40bsRL8qfsg0KzoRcZ5K5BzXp", "object": "chat.completion", "created": 1761000578, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 100 objects with Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P'\n-- and return all probability rows for those objects restricted to the light curve classifier\n-- with rankings 1 or 2.\n-- Note: Multiband_period is a multiband feature; fid=123 (gri) is commonly used for multiband features,\n-- but since the request does not specify fid explicitly, no fid filter is applied here.\n-- If you want to restrict to the multiband fid, uncomment the indicated line below.\n\nWITH target_oids AS (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT f.oid\n        FROM feature f\n        WHERE f.name = 'Multiband_period'\n          AND f.version = 'lc_classifier_1.2.1-P'\n          AND f.value < 5\n          -- AND f.fid = 123  -- Uncomment if you want to enforce the multiband (gri) fid\n        ORDER BY f.oid\n        LIMIT 100\n    ) s\n)\nSELECT *\nFROM probability\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4586, "completion_tokens": 1742, "total_tokens": 6328, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1472, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be25e3288190aa90be1a5427431c", "custom_id": "90-3", "response": {"status_code": 200, "request_id": "69b8430c958a2b28044867c820065505", "body": {"id": "chatcmpl-CSszTHFC8spLODXufMDJPpsJYGZpf", "object": "chat.completion", "created": 1761000603, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all probability rows (for the lc_classifier with ranking 1 or 2) for up to 100 objects\n-- that have Multiband_period < 5 days in the specified feature version.\nWITH selected_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.oid IN (SELECT oid FROM selected_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4586, "completion_tokens": 1817, "total_tokens": 6403, "prompt_tokens_details": {"cached_tokens": 4480, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1664, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be25e84c819080b9106802bffa6b", "custom_id": "90-4", "response": {"status_code": 200, "request_id": "8dad6dcf4d71cba656eaef957a9d5ead", "body": {"id": "chatcmpl-CSszl9tnRhpOZQyjJjbMwr1rx1nu1", "object": "chat.completion", "created": 1761000621, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find at most 100 objects with Multiband_period < 5 days in the specified feature version,\n-- and return all probability rows for those objects for the light curve classifier with ranking 1 or 2.\n\nWITH candidate_oids AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n),\nprob_oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking IN (1, 2)\n),\ntarget_oids AS (\n    SELECT oid\n    FROM candidate_oids\n    WHERE oid IN (SELECT oid FROM prob_oids)\n    LIMIT 100\n)\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (SELECT oid FROM target_oids);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4586, "completion_tokens": 2443, "total_tokens": 7029, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2240, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be25f5bc81908702e90a192e5e83", "custom_id": "51-2", "response": {"status_code": 200, "request_id": "fdfa428bebe3ea312c1c9d1755c6e6ee", "body": {"id": "chatcmpl-CSt0N7EaMS2esExZFUq6uUIkLyLLo", "object": "chat.completion", "created": 1761000659, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find all forced photometry epochs for the specified ZTF object\n-- Notes:\n-- - 'mjd' is the date in Modified Julian Date (sorted ascending).\n-- - 'e_mag_corr' is the uncertainty for the corrected magnitude assuming a point-like source.\n--   If you prefer the extended-source uncertainty, consider 'e_mag_corr_ext'.\nSELECT\n    oid,         -- object identifier\n    mjd,         -- date (Modified Julian Date)\n    fid,         -- filter identifier (1=g; 2=r; 3=i)\n    mag,         -- difference magnitude (PSF)\n    e_mag,       -- uncertainty of difference magnitude\n    mag_corr,    -- corrected (apparent) magnitude\n    e_mag_corr,  -- uncertainty of corrected magnitude (point-like source)\n    isdiffpos    -- difference sign flag\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2604, "completion_tokens": 1550, "total_tokens": 4154, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be263d688190831571bd06dd250d", "custom_id": "51-3", "response": {"status_code": 200, "request_id": "94a5ee9fb92d493da9aca5d00b87b486", "body": {"id": "chatcmpl-CSt0hGequ1Yptf7Os7p8hsi7YPHWB", "object": "chat.completion", "created": 1761000679, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- All forced-photometry epochs for the specified ZTF object, sorted by time (MJD)\nSELECT\n    oid,           -- object identifier\n    mjd,           -- date (Modified Julian Date)\n    fid,           -- filter identifier (1=g; 2=r; 3=i)\n    mag,           -- difference magnitude\n    e_mag,         -- uncertainty of difference magnitude\n    mag_corr,      -- corrected (apparent) magnitude\n    e_mag_corr,    -- uncertainty of corrected magnitude\n    isdiffpos      -- difference sign flag\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2604, "completion_tokens": 853, "total_tokens": 3457, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 704, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be26573881908912fe9f57d998b5", "custom_id": "51-4", "response": {"status_code": 200, "request_id": "ac7cf4e7c12eaa9c67bac93760ae06d7", "body": {"id": "chatcmpl-CSt0t4UlJIrKtFUGxgTN8BgJPF7aI", "object": "chat.completion", "created": 1761000691, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return epochs for the specified ZTF object from forced_photometry\n-- Note: 'mjd' is the observation date in Modified Julian Date (MJD).\n-- Note: Using e_mag_corr as the uncertainty for the corrected magnitude.\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2604, "completion_tokens": 1203, "total_tokens": 3807, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be281e44819096e1e755dce8c68e", "custom_id": "59-2", "response": {"status_code": 200, "request_id": "a3baed73cdf372b388c2107c33b9f4c7", "body": {"id": "chatcmpl-CSt18HGge4POnXoA5XChT3t6aImVp", "object": "chat.completion", "created": 1761000706, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Retrieve oid (ZTF identifier), filter id (fid), number of detections (ndet), and mean difference magnitude (magmean)\n-- for the specified ZTF object from the magstat table\nSELECT\n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2611, "completion_tokens": 595, "total_tokens": 3206, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be26780c8190ae2cd305c2fd39e8", "custom_id": "59-3", "response": {"status_code": 200, "request_id": "77ecc1b89cb462574462a4e480a5077f", "body": {"id": "chatcmpl-CSt1JfopxoSo4gtBfCOfuzXEmJ5gr", "object": "chat.completion", "created": 1761000717, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean)\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat AS m\nWHERE m.oid IN (\n    -- Obtain the OID from the object table (nested subquery as recommended)\n    SELECT o.oid\n    FROM object AS o\n    WHERE o.oid = 'ZTF18acsvogv'\n);", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3093, "completion_tokens": 501, "total_tokens": 3594, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 384, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2688dc8190a0cc66cda99f1e39", "custom_id": "59-4", "response": {"status_code": 200, "request_id": "172d9dc8f37a4fd1014788c875b691fa", "body": {"id": "chatcmpl-CSt1Rvb7i6qlubA0PEKwrMKXp0CUo", "object": "chat.completion", "created": 1761000725, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- ZTF identifier (oid), filter identifier (fid), number of detections (ndet), mean difference magnitude (magmean)\nSELECT\n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2611, "completion_tokens": 1156, "total_tokens": 3767, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1088, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be26946481908b0e1312f886c131", "custom_id": "100-2", "response": {"status_code": 200, "request_id": "6bed8660cbe61079ffc798a149a64cf1", "body": {"id": "chatcmpl-CSt1ex6VJMNsWCdkcdtm6Sx5yFDwb", "object": "chat.completion", "created": 1761000738, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return all epochs (detections, non-detections, forced photometry) for the given ZTF object in a single table\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf AS det_magpsf,\n    d.sigmapsf AS det_sigmapsf,\n    d.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_e_mag,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS det_magpsf,\n    NULL::double precision AS det_sigmapsf,\n    n.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_e_mag,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS det_magpsf,\n    NULL::double precision AS det_sigmapsf,\n    f.diffmaglim,\n    f.mag AS forced_mag,\n    f.e_mag AS forced_e_mag,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3792, "completion_tokens": 2230, "total_tokens": 6022, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1856, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be26ccec81909b396c1ba0de6556", "custom_id": "100-3", "response": {"status_code": 200, "request_id": "778fda9f58153c7ddb44f25658b0c463", "body": {"id": "chatcmpl-CSt20RHnIi3hIdegQ8ytwIlWCASOU", "object": "chat.completion", "created": 1761000760, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Return detections, non-detections, and forced photometry for a single ZTF object, in one table */\nWITH target_oid AS (\n  SELECT 'ZTF24aamtvxb'::varchar AS oid\n)\nSELECT\n  d.oid,\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.magpsf,\n  d.sigmapsf,\n  d.diffmaglim,\n  NULL::double precision AS mag,\n  NULL::double precision AS e_mag,\n  'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oid)\n\nUNION ALL\n\nSELECT\n  nd.oid,\n  nd.mjd,\n  nd.fid,\n  NULL::integer AS isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  nd.diffmaglim,\n  NULL::double precision AS mag,\n  NULL::double precision AS e_mag,\n  'non_detection'::text AS \"table\"\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM target_oid)\n\nUNION ALL\n\nSELECT\n  fp.oid,\n  fp.mjd,\n  fp.fid,\n  fp.isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  fp.diffmaglim,\n  fp.mag,\n  fp.e_mag,\n  'forced_photometry'::text AS \"table\"\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM target_oid)\n\nORDER BY mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3310, "completion_tokens": 2902, "total_tokens": 6212, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2560, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be26e00c8190a11d0ea641cb618e", "custom_id": "100-4", "response": {"status_code": 200, "request_id": "9b3ae06ccde837936e623fc3f7699470", "body": {"id": "chatcmpl-CSt2RUreE2HpJp8r7YWbbttPy7AFR", "object": "chat.completion", "created": 1761000787, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH obj AS (\n    -- Select the target object OID (ZTF identifier)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Detections\nSELECT\n    d.oid AS ztf_oid,                 -- ZTF identifier\n    d.mjd AS epoch_mjd,               -- Epoch date (MJD)\n    d.fid,                            -- Filter identifier (1=g; 2=r; 3=i)\n    d.isdiffpos,                      -- isdiffpos flag\n    d.magpsf AS det_magpsf,           -- Detection difference magnitude\n    d.sigmapsf AS det_sigmapsf,       -- Detection magnitude uncertainty\n    d.diffmaglim,                     -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- Forced photometry magnitude (N/A here)\n    NULL::double precision AS forced_e_mag,    -- Forced photometry uncertainty (N/A here)\n    'detection'::text AS \"table\"      -- Origin table\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM obj)\n\nUNION ALL\n\n-- Non-detections\nSELECT\n    nd.oid AS ztf_oid,                -- ZTF identifier\n    nd.mjd AS epoch_mjd,              -- Epoch date (MJD)\n    nd.fid,                           -- Filter identifier\n    NULL::integer AS isdiffpos,       -- No isdiffpos for non-detections\n    NULL::double precision AS det_magpsf,    -- No detection magnitude\n    NULL::double precision AS det_sigmapsf,  -- No detection uncertainty\n    nd.diffmaglim,                    -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- No forced photometry magnitude here\n    NULL::double precision AS forced_e_mag,    -- No forced photometry uncertainty here\n    'non_detection'::text AS \"table\"  -- Origin table\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM obj)\n\nUNION ALL\n\n-- Forced photometry\nSELECT\n    fp.oid AS ztf_oid,                -- ZTF identifier\n    fp.mjd AS epoch_mjd,              -- Epoch date (MJD)\n    fp.fid,                           -- Filter identifier\n    fp.isdiffpos,                     -- isdiffpos flag\n    NULL::double precision AS det_magpsf,    -- No detection magnitude here\n    NULL::double precision AS det_sigmapsf,  -- No detection uncertainty here\n    fp.diffmaglim,                    -- 5-sigma magnitude limit\n    fp.mag AS forced_mag,             -- Forced difference magnitude\n    fp.e_mag AS forced_e_mag,         -- Forced magnitude uncertainty\n    'forced_photometry'::text AS \"table\"  -- Origin table\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM obj)\n\nORDER BY epoch_mjd;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3792, "completion_tokens": 2606, "total_tokens": 6398, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1984, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be26e69c8190bd35c21c6b23c7a1", "custom_id": "106-2", "response": {"status_code": 200, "request_id": "3c1ea1bbdd72e2167ff2a906bf4d80b8", "body": {"id": "chatcmpl-CSt32qQRhtoPOryCoejkpslcGEM30", "object": "chat.completion", "created": 1761000824, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 ZTF objects with:\n-- - ndet > 10\n-- - stamp_classifier version 'stamp_classifier_1.0.4' class 'bogus' probability > 0.7\n-- - lc_classifier_top class 'Transient' probability > 0.9\n-- Return: oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient\n-- Order by oid (ZTF identifier)\nSELECT\n  o.oid,\n  o.ndet,\n  o.firstmjd,\n  /* Probability of being 'bogus' in the specified stamp classifier version */\n  (\n    SELECT MAX(p1.probability)\n    FROM probability p1\n    WHERE p1.oid = o.oid\n      AND p1.classifier_name = 'stamp_classifier'\n      AND p1.classifier_version = 'stamp_classifier_1.0.4'\n      AND p1.class_name = 'bogus'\n  ) AS prob_stamp_bogus,\n  /* Probability of being 'Transient' in the top-level light curve classifier (any version) */\n  (\n    SELECT MAX(p2.probability)\n    FROM probability p2\n    WHERE p2.oid = o.oid\n      AND p2.classifier_name = 'lc_classifier_top'\n      AND p2.class_name = 'Transient'\n  ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n  )\n  AND o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2661, "completion_tokens": 1785, "total_tokens": 4446, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1344, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be27aa48819084e4b35c7f347c7b", "custom_id": "106-3", "response": {"status_code": 200, "request_id": "1aa9d847e83cca103dde4a6c15b60369", "body": {"id": "chatcmpl-CSt3IxSBTU6TE5XnNUx2RH0UkwpMo", "object": "chat.completion", "created": 1761000840, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 ZTF objects:\n-- - ndet > 10\n-- - bogus prob > 0.7 in stamp_classifier version 'stamp_classifier_1.0.4' (and ranked as top class)\n-- - Transient prob > 0.9 in lc_classifier_top (any version; take max per object)\n-- Return: oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient\n-- Order by the ZTF identifier (oid)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    (\n        SELECT p1.probability\n        FROM probability p1\n        WHERE p1.oid = o.oid\n          AND p1.class_name = 'bogus'\n          AND p1.classifier_name = 'stamp_classifier'\n          AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    ) AS prob_stamp_bogus,\n    (\n        SELECT MAX(p2.probability)\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name = 'Transient'\n          AND p2.classifier_name = 'lc_classifier_top'\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n      SELECT oid\n      FROM probability\n      WHERE class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier'\n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND ranking = 1\n        AND probability > 0.7\n      INTERSECT\n      SELECT oid\n      FROM probability\n      WHERE class_name = 'Transient'\n        AND classifier_name = 'lc_classifier_top'\n        AND probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2661, "completion_tokens": 3661, "total_tokens": 6322, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3264, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be27250c8190972b8c90950d90b8", "custom_id": "106-4", "response": {"status_code": 200, "request_id": "fac381b2d972fe6a67ca8c77a3c4616e", "body": {"id": "chatcmpl-CSt4PqF2Bbvb083Hq6Iom7YYW9MjI", "object": "chat.completion", "created": 1761000909, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Find up to 30 ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return requested columns and order by oid.\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* probability of being 'bogus' in the stamp classifier v1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* probability of being 'Transient' in the top-level light curve classifier (any version) */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n      SELECT pr1.oid\n      FROM probability pr1\n      WHERE pr1.classifier_name = 'stamp_classifier'\n        AND pr1.classifier_version = 'stamp_classifier_1.0.4'\n        AND pr1.class_name = 'bogus'\n        AND pr1.probability > 0.7\n  )\n  AND o.oid IN (\n      SELECT pr2.oid\n      FROM probability pr2\n      WHERE pr2.classifier_name = 'lc_classifier_top'\n        AND pr2.class_name = 'Transient'\n        AND pr2.probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2661, "completion_tokens": 2599, "total_tokens": 5260, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2176, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be27418881908921da315a587be7", "custom_id": "56-2", "response": {"status_code": 200, "request_id": "7e294d1ab731a67edc392e3f6c69dd10", "body": {"id": "chatcmpl-CSt53D7Sulqayhvaipxt8Yvr2EfmG", "object": "chat.completion", "created": 1761000949, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Select ZTF objects among the given OIDs whose corrected light curve was not computed\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n),\nfiltered_oids AS (\n    SELECT oid\n    FROM object\n    WHERE corrected IS NOT TRUE\n      AND oid IN (SELECT oid FROM target_oids)\n)\nSELECT\n    oid,            -- ZTF identifier\n    ndet,           -- number of detections\n    meanra,         -- mean right ascension\n    meandec,        -- mean declination\n    firstmjd,       -- date of first detection\n    lastmjd,        -- date of last detection\n    g_r_mean,       -- difference between mean g- and r-band difference magnitudes\n    g_r_mean_corr   -- difference between mean g- and r-band corrected magnitudes\nFROM object\nWHERE oid IN (SELECT oid FROM filtered_oids)\nORDER BY firstmjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3160, "completion_tokens": 2023, "total_tokens": 5183, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1792, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2767608190a44e21dae170e0e4", "custom_id": "56-3", "response": {"status_code": 200, "request_id": "daf163e89278248322b855c370f7e00e", "body": {"id": "chatcmpl-CSt5NKGnJCC6AS8qfbDDl9E6GKdW9", "object": "chat.completion", "created": 1761000969, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return specified columns for the given ZTF objects whose corrected light curve was not computed\n-- Using a subquery/CTE to supply OIDs as requested, and avoiding JOINs\n-- The filter \"o.corrected IS NOT TRUE\" treats NULL or FALSE as \"not computed\"\nWITH requested_oids AS (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n    ) v(oid)\n)\nSELECT\n    o.oid,             -- ZTF identifier\n    o.ndet,            -- number of detections\n    o.meanra,          -- mean RA\n    o.meandec,         -- mean Dec\n    o.firstmjd,        -- date of first detection\n    o.lastmjd,         -- date of last detection\n    o.g_r_mean,        -- difference between mean g and r difference magnitudes\n    o.g_r_mean_corr    -- difference between mean g and r corrected magnitudes\nFROM object o\nWHERE o.oid IN (SELECT oid FROM requested_oids)\n  AND o.corrected IS NOT TRUE\nORDER BY o.firstmjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3708, "completion_tokens": 1155, "total_tokens": 4863, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be276c788190a1a32d7905e6b031", "custom_id": "56-4", "response": {"status_code": 200, "request_id": "70e83227dc63cb8f549762618864a9ef", "body": {"id": "chatcmpl-CSsy0FhFPK8bCxjWbrHfv2zSYUTVT", "object": "chat.completion", "created": 1761000512, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return ZTF objects among the specified OIDs where the corrected light curve was not computed (corrected = false or NULL)\nWITH requested_oids (oid) AS (\n    VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    oid,                -- ZTF identifier\n    ndet,               -- number of detections\n    meanra,             -- mean right ascension\n    meandec,            -- mean declination\n    firstmjd,           -- date of first detection\n    lastmjd,            -- date of last detection\n    g_r_mean,           -- difference between mean g- and r-band difference magnitudes\n    g_r_mean_corr       -- difference between mean g- and r-band corrected magnitudes\nFROM object\nWHERE oid IN (SELECT oid FROM requested_oids)\n  AND (corrected = false OR corrected IS NULL)\nORDER BY firstmjd ASC;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2991, "completion_tokens": 1175, "total_tokens": 4166, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 960, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2783e88190bdbcd5c6f3a11ccf", "custom_id": "48-2", "response": {"status_code": 200, "request_id": "2d5e3f51ecdae6e0ffe4c95ad6038cfe", "body": {"id": "chatcmpl-CSsyB04DPEa6iS7XPFgzhnoj3gXLr", "object": "chat.completion", "created": 1761000523, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all features for the specified ZTF object, using a subquery on object to obtain the OID\nWITH target_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM target_oids)\nORDER BY f.oid, f.fid, f.version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4865, "completion_tokens": 1015, "total_tokens": 5880, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be27cbdc8190bcf41762d07ae11a", "custom_id": "48-3", "response": {"status_code": 200, "request_id": "1be9b64887653abdfbda45b011c606f1", "body": {"id": "chatcmpl-CSsyS1LRKPm7Eee8eAN96qkDHsKPS", "object": "chat.completion", "created": 1761000540, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all features for the ZTF object 'ZTF18abqyaix'\n-- Return columns: oid (ZTF identifier), name (feature name), value (feature value), fid (filter identifier), version (feature version)\n-- Obtain OIDs via a subquery from the object table and avoid JOINs per guidelines\nWITH sel_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF18abqyaix'\n)\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM sel_oids)\nORDER BY\n    f.oid,        -- ZTF identifier\n    f.fid,        -- filter identifier\n    f.version;    -- feature version", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4865, "completion_tokens": 1329, "total_tokens": 6194, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1152, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be27e9d4819086e35b2b5615501b", "custom_id": "48-4", "response": {"status_code": 200, "request_id": "2cd40844955f18eece124bc53cf5cd49", "body": {"id": "chatcmpl-CSsyg0m7i9GEa2yUASqWY3UXyr0Uj", "object": "chat.completion", "created": 1761000554, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get all features for the specified ZTF object, returning the requested columns\nSELECT\n    oid,            -- ZTF identifier\n    name,           -- feature name\n    value,          -- feature value\n    fid,            -- filter identifier\n    version         -- feature version\nFROM feature\nWHERE oid = 'ZTF18abqyaix'\nORDER BY oid, fid, version;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4383, "completion_tokens": 1114, "total_tokens": 5497, "prompt_tokens_details": {"cached_tokens": 3968, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1024, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be27d5948190914ee847f4d3d86d", "custom_id": "58-2", "response": {"status_code": 200, "request_id": "6f081ebcd2931fccf2240f611b929528", "body": {"id": "chatcmpl-CSsyt6eJE2OJLeAKiPzl7MKYymLb2", "object": "chat.completion", "created": 1761000567, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Get up to 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - absolute difference between the minimum corrected g- and r-band magnitudes > 3.5\nWITH candidate_oids AS (\n  SELECT o.oid\n  FROM object o\n  WHERE o.ndet >= 30\n    AND o.deltajd > 20\n),\nmagdiff_oids AS (\n  SELECT d.oid\n  FROM detection d\n  WHERE d.oid IN (SELECT oid FROM candidate_oids)\n  GROUP BY d.oid\n  HAVING\n    -- minimum corrected g-band magnitude (fid=1) exists\n    MIN(CASE WHEN d.fid = 1 AND d.corrected THEN d.magpsf_corr END) IS NOT NULL\n    -- minimum corrected r-band magnitude (fid=2) exists\n    AND MIN(CASE WHEN d.fid = 2 AND d.corrected THEN d.magpsf_corr END) IS NOT NULL\n    -- absolute difference between the minima > 3.5\n    AND ABS(\n      MIN(CASE WHEN d.fid = 1 AND d.corrected THEN d.magpsf_corr END) -\n      MIN(CASE WHEN d.fid = 2 AND d.corrected THEN d.magpsf_corr END)\n    ) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM magdiff_oids)\nLIMIT 20;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2948, "completion_tokens": 2042, "total_tokens": 4990, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 1728, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be28101081909a2437765a22f16a", "custom_id": "58-3", "response": {"status_code": 200, "request_id": "b9b33cffe9d35ceaa21c43832a99d9d2", "body": {"id": "chatcmpl-CSszD5CUtUeD4M5rOyqyy37zQQG3E", "object": "chat.completion", "created": 1761000587, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Get at most 20 objects with:\n   - ndet >= 30\n   - deltajd > 20 days\n   - absolute difference between minimum corrected g and r magnitudes > 3.5\n   Notes:\n   - ZTF filters: fid=1 (g), fid=2 (r)\n   - Using ABS(min_g_corr - min_r_corr) to interpret \"difference\"; if you intend (min_g_corr - min_r_corr) strictly, remove ABS().\n*/\nWITH eligible_oids AS (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND deltajd > 20\n),\nband_mins AS (\n    SELECT\n        d.oid,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1 AND d.corrected = TRUE) AS min_g_corr,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2 AND d.corrected = TRUE) AS min_r_corr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM eligible_oids)  -- only filter detection by oid, per guidance\n    GROUP BY d.oid\n),\nqualifying_oids AS (\n    SELECT oid\n    FROM band_mins\n    WHERE min_g_corr IS NOT NULL\n      AND min_r_corr IS NOT NULL\n      AND ABS(min_g_corr - min_r_corr) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM qualifying_oids)\nORDER BY oid\nLIMIT 20;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2948, "completion_tokens": 2376, "total_tokens": 5324, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be282adc8190a935bdd665ae6922", "custom_id": "58-4", "response": {"status_code": 200, "request_id": "5f2613f6096a9de56d1abdb1280503cc", "body": {"id": "chatcmpl-CSszbwJHpEGC4Sb0C14j6z8wzPYAe", "object": "chat.completion", "created": 1761000611, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "/* Get at most 20 objects with:\n   - ndet >= 30\n   - deltajd > 20 (difference between last and first detection times)\n   - absolute difference between minimum corrected magnitudes in g (fid=1) and r (fid=2) > 3.5\n   Note: \"difference\" is interpreted as absolute(min_g_corr - min_r_corr).\n*/\nWITH seed_oids AS (\n  SELECT oid\n  FROM object\n  WHERE ndet >= 30\n    AND deltajd > 20\n),\nband_min AS (\n  SELECT d.oid,\n         MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS min_g_corr,\n         MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS min_r_corr\n  FROM detection d\n  WHERE d.oid IN (SELECT oid FROM seed_oids)\n  GROUP BY d.oid\n),\nqualified_oids AS (\n  SELECT oid\n  FROM band_min\n  WHERE min_g_corr IS NOT NULL\n    AND min_r_corr IS NOT NULL\n    AND ABS(min_g_corr - min_r_corr) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM qualified_oids)\nLIMIT 20;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2948, "completion_tokens": 2327, "total_tokens": 5275, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2048, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be28662c8190a54e3e6bf52292c1", "custom_id": "78-2", "response": {"status_code": 200, "request_id": "2c884e2b627fcfe740cc9a139e2a468e", "body": {"id": "chatcmpl-CSt01bmSJDXlc2wwlnnIKVbQ9g2eR", "object": "chat.completion", "created": 1761000637, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return taxonomy entry for the Light Curve classifier (lc_classifier)\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1926, "completion_tokens": 942, "total_tokens": 2868, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 896, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2850288190ba8490e47436c520", "custom_id": "78-3", "response": {"status_code": 200, "request_id": "35a94d491b79e4c5999ef2585d13519b", "body": {"id": "chatcmpl-CSt0DDsfB8IXkdWe9Ua2f41zkvb1I", "object": "chat.completion", "created": 1761000649, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return the classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1926, "completion_tokens": 561, "total_tokens": 2487, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 512, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be28792081909601257803791f74", "custom_id": "78-4", "response": {"status_code": 200, "request_id": "c7f2d8cd4cd74949039b9c0f643f8e54", "body": {"id": "chatcmpl-CSt0P4fa3RkVU4aGvwE3lw4aMXPOm", "object": "chat.completion", "created": 1761000661, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Return name, version, and classes for the Light Curve classifier from taxonomy\nSELECT\n  classifier_name,\n  classifier_version,\n  classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1926, "completion_tokens": 369, "total_tokens": 2295, "prompt_tokens_details": {"cached_tokens": 1536, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 320, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be2893588190beb9a6610023acdc", "custom_id": "39-2", "response": {"status_code": 200, "request_id": "9e1ea57444fccecf53db909f297f2a82", "body": {"id": "chatcmpl-CSt0Wzlfprqja9rEx595CZLaQDoHa", "object": "chat.completion", "created": 1761000668, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "", "refusal": null, "annotations": []}, "finish_reason": "length"}], "usage": {"prompt_tokens": 3232, "completion_tokens": 4000, "total_tokens": 7232, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 4000, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be28b6308190bafc3ada17d0519b", "custom_id": "39-3", "response": {"status_code": 200, "request_id": "fd3fc304f5e70a49dd5847397a2a22bb", "body": {"id": "chatcmpl-CSt1QuDiPrR8SOjsJiiAQ9CRbClUa", "object": "chat.completion", "created": 1761000724, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- CV/Nova candidates (highest-probability class by stochastic light-curve classifier)\nWITH cvn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n),\n-- Restrict to objects with at most 50 detections (from discovery to last detection)\nlimited_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM cvn_oids)\n      AND o.ndet <= 50\n),\n-- r-band detections with corrected photometry\nr_dets AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.ra,\n        d.dec,\n        d.magpsf_corr,\n        d.sigmapsf_corr,\n        d.mjd\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM limited_oids)\n      AND d.fid = 2                  -- r-band\n      AND d.corrected = TRUE         -- use corrected difference magnitudes\n)\nSELECT\n    rd.oid,                          -- object identifier\n    rd.candid,                       -- candidate identifier\n    rd.fid AS f_id,                  -- filter id as requested\n    rd.ra,                           -- detection RA\n    rd.dec,                          -- detection Dec\n    rd.magpsf_corr AS mag,           -- corrected difference magnitude (r-band)\n    rd.sigmapsf_corr AS mag_err,     -- magnitude error (PSF-corrected, r-band)\n    rd.magpsf_corr AS psf_corr_mag_r, -- PSF corrected magnitude in r-filter (explicit)\n    -- rise from the minimum corrected mag within each object (positive = fainter than brightest point)\n    rd.magpsf_corr - MIN(rd.magpsf_corr) OVER (PARTITION BY rd.oid) AS rise_from_min_mag,\n    -- maximum rise from minimum across r-band detections for the object\n    MAX(rd.magpsf_corr) OVER (PARTITION BY rd.oid) - MIN(rd.magpsf_corr) OVER (PARTITION BY rd.oid) AS max_rise_from_min_mag\nFROM r_dets rd\nORDER BY rd.oid, rd.mjd\nLIMIT 1000;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3232, "completion_tokens": 3823, "total_tokens": 7055, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 3328, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_68f6be28c1908190874291336694fe2b", "custom_id": "39-4", "response": {"status_code": 200, "request_id": "38e9a70ca08b8de094bbb0bff3533eb7", "body": {"id": "chatcmpl-CSt1zSnIyV6XArQJGVr9tmCLE5YyD", "object": "chat.completion", "created": 1761000759, "model": "gpt-5-2025-08-07", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Select r-band detections for objects whose most probable class (ranking=1) under the stochastic LC classifier is 'CV/Nova',\n-- and whose total number of detections is at most 50. Return identifiers, coordinates, magnitudes, errors,\n-- and window-based rise metrics relative to the minimum corrected PSF magnitude in r.\nSELECT\n    d.oid,                               -- object identifier\n    d.candid,                            -- candidate identifier\n    d.fid AS f_id,                       -- filter id (1=g; 2=r; 3=i)\n    d.ra,                                -- right ascension\n    d.dec,                               -- declination\n    d.magpsf AS magnitude,               -- PSF difference magnitude\n    d.sigmapsf AS magnitude_error,       -- PSF difference magnitude error\n    d.magpsf_corr,                       -- corrected PSF (apparent) magnitude in r\n    d.sigmapsf_corr,                     -- error of corrected PSF magnitude (point-like)\n    d.sigmapsf_corr_ext,                 -- error of corrected PSF magnitude (extended source)\n    -- Window stats per object in r-band:\n    MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS min_magpsf_corr_r,\n    MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_magpsf_corr_r,\n    -- Rise from the minimum corrected magnitude for this detection:\n    d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS rise_from_min_r,\n    -- Maximum rise from minimum across all r-band detections for the object:\n    MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_rise_from_min_r\nFROM detection d\nWHERE\n    d.fid = 2  -- r-band only\n    AND d.oid IN (\n        -- Objects with at most 50 detections (from discovery to last detection per object definition)\n        SELECT o.oid\n        FROM object o\n        WHERE o.ndet <= 50\n    )\n    AND d.oid IN (\n        -- Objects whose top-ranked class under the stochastic light curve classifier is 'CV/Nova'\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier_stochastic'\n          AND p.class_name = 'CV/Nova'\n          AND p.ranking = 1\n    )\nORDER BY d.oid\nLIMIT 1000;", "refusal": null, "annotations": []}, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3232, "completion_tokens": 3040, "total_tokens": 6272, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 2496, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
