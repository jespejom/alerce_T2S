{
    "8": {
        "0": {
            "req_id": "8",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'object']",
                    "1": "['probability', 'taxonomy', 'detection']"
                },
                "in_toks": 622,
                "out_toks": 2020,
                "id": "chatcmpl-CSnQ1UuU1sSlI3jThIPXTOshwvU6p",
                "created": 1760979185,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Objects with first detection between Aug 17 (MJD 60173.0) and Aug 21 (MJD 60177.0),\n   whose top-ranked (ranking=1) Stamp Classifier class is SN, and that additionally have\n   either SN probability > 0.5 or at least two detections (ndet >= 2).\n   Note: Since probability is time-independent here, we use object.firstmjd as a proxy for \"first classified\" time.\n   Optimized by filtering objects first, then using a LATERAL subquery keyed by oid to hit the PK on probability. */\nSELECT o.*\nFROM OBJECT AS o\nJOIN LATERAL\n  (SELECT MAX(p.probability) AS prob\n   FROM probability AS p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1) AS sn ON TRUE\nWHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND (sn.prob > 0.5\n       OR o.ndet >= 2);",
            "sql_response": {
                "responses": {
                    "0": "/* Objects with first detection between Aug 17 (MJD 60173.0) and Aug 21 (MJD 60177.0),\n   whose top-ranked (ranking=1) Stamp Classifier class is SN, and that additionally have\n   either SN probability > 0.5 or at least two detections (ndet >= 2).\n   Note: Since probability is time-independent here, we use object.firstmjd as a proxy for \"first classified\" time.\n   Optimized by filtering objects first, then using a LATERAL subquery keyed by oid to hit the PK on probability. */\nSELECT o.*\nFROM OBJECT AS o\nJOIN LATERAL\n  (SELECT MAX(p.probability) AS prob\n   FROM probability AS p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1) AS sn ON TRUE\nWHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND (sn.prob > 0.5\n       OR o.ndet >= 2);"
                },
                "in_toks": 1594,
                "out_toks": 2681,
                "id": "chatcmpl-Cb9GXKKKoHu0ciMxD6aOXCpS2qtGx",
                "created": 1762969789,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects first detected between Aug 17 (MJD 60173.0) and Aug 21 (MJD 60177.0),\n   whose top-ranked Stamp Classifier class is SN, and additionally have\n   either SN probability > 0.5 or at least two detections (ndet >= 2).\n   Note: We interpret \"first classified\" timing using object.firstmjd,\n   since the probability table is time-independent in this schema. */\nWITH sn_rank1 AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n),\nsn_prob_gt05 AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n      AND probability > 0.5\n)\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  AND oid IN (SELECT oid FROM sn_rank1)\n  AND (\n        oid IN (SELECT oid FROM sn_prob_gt05)\n        OR ndet >= 2\n      );",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects first detected between Aug 17 (MJD 60173.0) and Aug 21 (MJD 60177.0),\n   whose top-ranked Stamp Classifier class is SN, and additionally have\n   either SN probability > 0.5 or at least two detections (ndet >= 2).\n   Note: We interpret \"first classified\" timing using object.firstmjd,\n   since the probability table is time-independent in this schema. */\nWITH sn_rank1 AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n),\nsn_prob_gt05 AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n      AND probability > 0.5\n)\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  AND oid IN (SELECT oid FROM sn_rank1)\n  AND (\n        oid IN (SELECT oid FROM sn_prob_gt05)\n        OR ndet >= 2\n      );"
                },
                "in_toks": 2584,
                "out_toks": 2428,
                "id": "chatcmpl-CSoFHCwest382wuchtsLTOaLSc7AZ",
                "created": 1760982363,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "8",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'object']",
                    "1": "['probability', 'taxonomy', 'detection']"
                },
                "in_toks": 622,
                "out_toks": 2020,
                "id": "chatcmpl-CSnQ1UuU1sSlI3jThIPXTOshwvU6p",
                "created": 1760979185,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized: restrict detection aggregation to candidate oids from probability first\n-- We use first detection time (MIN mjd) as a proxy for \"first classified\" time.\nWITH p_sn AS\n  (SELECT p.oid,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- condition 1\n\n     AND p.class_name = 'SN' -- condition 2\n\n     AND p.ranking = 1 -- condition 3 (top-ranked as SN)\n),\n     det_agg AS\n  (SELECT d.oid,\n          MIN(d.mjd) AS first_mjd,\n          COUNT(*) AS ndet\n   FROM detection d\n   INNER JOIN p_sn ps ON ps.oid = d.oid -- limit scan to relevant oids\n\n   GROUP BY d.oid)\nSELECT p.*\nFROM p_sn p\nJOIN det_agg da ON da.oid = p.oid\nWHERE da.first_mjd BETWEEN 60173.0 AND 60177.0 -- Aug 17\u201321 (MJD)\n\n  AND (p.probability > 0.5\n       OR da.ndet >= 2); -- prob>0.5 OR at least two detections",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized: restrict detection aggregation to candidate oids from probability first\n-- We use first detection time (MIN mjd) as a proxy for \"first classified\" time.\nWITH p_sn AS\n  (SELECT p.oid,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- condition 1\n\n     AND p.class_name = 'SN' -- condition 2\n\n     AND p.ranking = 1 -- condition 3 (top-ranked as SN)\n),\n     det_agg AS\n  (SELECT d.oid,\n          MIN(d.mjd) AS first_mjd,\n          COUNT(*) AS ndet\n   FROM detection d\n   INNER JOIN p_sn ps ON ps.oid = d.oid -- limit scan to relevant oids\n\n   GROUP BY d.oid)\nSELECT p.*\nFROM p_sn p\nJOIN det_agg da ON da.oid = p.oid\nWHERE da.first_mjd BETWEEN 60173.0 AND 60177.0 -- Aug 17\u201321 (MJD)\n\n  AND (p.probability > 0.5\n       OR da.ndet >= 2); -- prob>0.5 OR at least two detections"
                },
                "in_toks": 1791,
                "out_toks": 2149,
                "id": "chatcmpl-Cb9HDYsMdXBmFHgVi6b7mO4zd5qup",
                "created": 1762969831,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first classified as SN (top-ranked by the stamp classifier)\n-- whose FIRST detection (proxy for first stamp classification time) is between 60173 and 60177 (Aug 17\u201321),\n-- and that either have SN probability > 0.5 OR have at least two detections.\n-- Returns the probability row for class='SN' in the stamp classifier (one row per oid if ranking=1).\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1\n  AND p.oid IN (\n      -- oids whose first detection is within the requested MJD window\n      SELECT d.oid\n      FROM detection d\n      GROUP BY d.oid\n      HAVING MIN(d.mjd) BETWEEN 60173.0 AND 60177.0\n  )\n  AND (\n      p.probability > 0.5\n      OR p.oid IN (\n          -- oids with at least two detections\n          SELECT d2.oid\n          FROM detection d2\n          GROUP BY d2.oid\n          HAVING COUNT(*) >= 2\n      )\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first classified as SN (top-ranked by the stamp classifier)\n-- whose FIRST detection (proxy for first stamp classification time) is between 60173 and 60177 (Aug 17\u201321),\n-- and that either have SN probability > 0.5 OR have at least two detections.\n-- Returns the probability row for class='SN' in the stamp classifier (one row per oid if ranking=1).\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1\n  AND p.oid IN (\n      -- oids whose first detection is within the requested MJD window\n      SELECT d.oid\n      FROM detection d\n      GROUP BY d.oid\n      HAVING MIN(d.mjd) BETWEEN 60173.0 AND 60177.0\n  )\n  AND (\n      p.probability > 0.5\n      OR p.oid IN (\n          -- oids with at least two detections\n          SELECT d2.oid\n          FROM detection d2\n          GROUP BY d2.oid\n          HAVING COUNT(*) >= 2\n      )\n  );"
                },
                "in_toks": 2695,
                "out_toks": 2306,
                "id": "chatcmpl-CSoFj4E3Ern07WLbR7DTy9B5HtJvV",
                "created": 1760982391,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "8",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'detection']"
                },
                "in_toks": 622,
                "out_toks": 977,
                "id": "chatcmpl-CSsRLWJbVXHQ2DA7KEu4WjCIYtyGB",
                "created": 1760998487,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query: first detection between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- top-ranked as SN by the stamp classifier, and (probability > 0.5 OR at least 2 detections).\n-- We first restrict to relevant probability rows (ranking=1) and only then aggregate detections for those oids to avoid full-table scans.\n WITH candidates AS\n  (SELECT p.*\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- classifier\n\n     AND p.class_name = 'SN' -- class\n\n     AND p.ranking = 1 -- top-ranked\n),\n      det AS\n  (SELECT d.oid,\n          MIN(d.mjd) AS first_mjd,\n          COUNT(*)::int AS n_det\n   FROM detection d\n   JOIN candidates c ON c.oid = d.oid -- limit detection aggregation to candidate oids\n\n   GROUP BY d.oid)\nSELECT c.*\nFROM candidates c\nJOIN det ON det.oid = c.oid\nWHERE det.first_mjd BETWEEN 60173.0 AND 60177.0 -- proxy for first stamp classification time\n\n  AND (c.probability > 0.5\n       OR det.n_det >= 2); -- probability or detection-count condition",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query: first detection between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- top-ranked as SN by the stamp classifier, and (probability > 0.5 OR at least 2 detections).\n-- We first restrict to relevant probability rows (ranking=1) and only then aggregate detections for those oids to avoid full-table scans.\n WITH candidates AS\n  (SELECT p.*\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- classifier\n\n     AND p.class_name = 'SN' -- class\n\n     AND p.ranking = 1 -- top-ranked\n),\n      det AS\n  (SELECT d.oid,\n          MIN(d.mjd) AS first_mjd,\n          COUNT(*)::int AS n_det\n   FROM detection d\n   JOIN candidates c ON c.oid = d.oid -- limit detection aggregation to candidate oids\n\n   GROUP BY d.oid)\nSELECT c.*\nFROM candidates c\nJOIN det ON det.oid = c.oid\nWHERE det.first_mjd BETWEEN 60173.0 AND 60177.0 -- proxy for first stamp classification time\n\n  AND (c.probability > 0.5\n       OR det.n_det >= 2); -- probability or detection-count condition"
                },
                "in_toks": 1741,
                "out_toks": 2664,
                "id": "chatcmpl-Cb9HreBcV9ueuClJh2lfieJfSnhZV",
                "created": 1762969871,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects whose first detection (proxy for first stamp classification time) is between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- and that are top-ranked as SN by the stamp classifier, keeping those with probability > 0.5 OR with at least 2 detections.\nWITH oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n      AND (\n            p.probability > 0.5\n            OR (SELECT COUNT(*) FROM detection d WHERE d.oid = p.oid) >= 2\n          )\n      AND (SELECT MIN(d.mjd) FROM detection d WHERE d.oid = p.oid) BETWEEN 60173.0 AND 60177.0\n)\nSELECT *\nFROM probability\nWHERE oid IN (SELECT oid FROM oids)\n  AND classifier_name = 'stamp_classifier'\n  AND class_name = 'SN'\n  AND ranking = 1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects whose first detection (proxy for first stamp classification time) is between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- and that are top-ranked as SN by the stamp classifier, keeping those with probability > 0.5 OR with at least 2 detections.\nWITH oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n      AND (\n            p.probability > 0.5\n            OR (SELECT COUNT(*) FROM detection d WHERE d.oid = p.oid) >= 2\n          )\n      AND (SELECT MIN(d.mjd) FROM detection d WHERE d.oid = p.oid) BETWEEN 60173.0 AND 60177.0\n)\nSELECT *\nFROM probability\nWHERE oid IN (SELECT oid FROM oids)\n  AND classifier_name = 'stamp_classifier'\n  AND class_name = 'SN'\n  AND ranking = 1;"
                },
                "in_toks": 2650,
                "out_toks": 2805,
                "id": "chatcmpl-CSsxXJayi4rpj5vNpQTwEgGv4hRsb",
                "created": 1761000483,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "8",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'detection']"
                },
                "in_toks": 622,
                "out_toks": 1364,
                "id": "chatcmpl-CSsRXqLOSbYoxgUtgKkUFiQ5MVIl9",
                "created": 1760998499,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Find objects whose first detection (proxy for \"first classified\") is between 2023-08-17 and 2023-08-21,\n-- that have top-ranked 'SN' from the stamp classifier, and (probability > 0.5 OR at least 2 detections).\n-- Optimized by pre-filtering oids in probability and aggregating detections only for those oids.\n WITH sn AS\n  (-- Preselect objects with stamp classifier, top-ranked SN\n SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1),\n      det AS\n  (-- Aggregate detections only for selected objects to get first detection time and count\n SELECT d.oid,\n        MIN(d.mjd) AS first_mjd,\n        COUNT(*) AS n_detections\n   FROM detection d\n   JOIN sn USING (oid)\n   GROUP BY d.oid)\nSELECT DISTINCT p.oid\nFROM probability p\nJOIN det ON det.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1 -- Date window: inclusive Aug 17 to Aug 21 (MJD 60173.0 to 60177.999...)\n\n  AND det.first_mjd BETWEEN 60173.0 AND 60177.999999\n  AND (p.probability > 0.5\n       OR det.n_detections >= 2);",
            "sql_response": {
                "responses": {
                    "0": "-- Find objects whose first detection (proxy for \"first classified\") is between 2023-08-17 and 2023-08-21,\n-- that have top-ranked 'SN' from the stamp classifier, and (probability > 0.5 OR at least 2 detections).\n-- Optimized by pre-filtering oids in probability and aggregating detections only for those oids.\n WITH sn AS\n  (-- Preselect objects with stamp classifier, top-ranked SN\n SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1),\n      det AS\n  (-- Aggregate detections only for selected objects to get first detection time and count\n SELECT d.oid,\n        MIN(d.mjd) AS first_mjd,\n        COUNT(*) AS n_detections\n   FROM detection d\n   JOIN sn USING (oid)\n   GROUP BY d.oid)\nSELECT DISTINCT p.oid\nFROM probability p\nJOIN det ON det.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1 -- Date window: inclusive Aug 17 to Aug 21 (MJD 60173.0 to 60177.999...)\n\n  AND det.first_mjd BETWEEN 60173.0 AND 60177.999999\n  AND (p.probability > 0.5\n       OR det.n_detections >= 2);"
                },
                "in_toks": 1681,
                "out_toks": 2388,
                "id": "chatcmpl-Cb9IaBZ6Im6our2fjtR9RcLOcnUBE",
                "created": 1762969916,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first classified (first detection) between Aug 17 (60173.0) and Aug 21 (60177.0),\n-- with stamp classifier assigning top class 'SN', and (probability > 0.5 OR at least two detections)\nSELECT *\nFROM probability p\nWHERE\n    p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND p.oid IN (\n        SELECT d.oid\n        FROM detection d\n        GROUP BY d.oid\n        HAVING MIN(d.mjd) BETWEEN 60173.0 AND 60177.0\n    )\n    AND (\n        p.probability > 0.5\n        OR p.oid IN (\n            SELECT d2.oid\n            FROM detection d2\n            GROUP BY d2.oid\n            HAVING COUNT(*) >= 2\n        )\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first classified (first detection) between Aug 17 (60173.0) and Aug 21 (60177.0),\n-- with stamp classifier assigning top class 'SN', and (probability > 0.5 OR at least two detections)\nSELECT *\nFROM probability p\nWHERE\n    p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND p.oid IN (\n        SELECT d.oid\n        FROM detection d\n        GROUP BY d.oid\n        HAVING MIN(d.mjd) BETWEEN 60173.0 AND 60177.0\n    )\n    AND (\n        p.probability > 0.5\n        OR p.oid IN (\n            SELECT d2.oid\n            FROM detection d2\n            GROUP BY d2.oid\n            HAVING COUNT(*) >= 2\n        )\n    );"
                },
                "in_toks": 2695,
                "out_toks": 2698,
                "id": "chatcmpl-CSsyXRI400rJnI04liZCVHn7bMPWM",
                "created": 1761000545,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "8",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'object']"
                },
                "in_toks": 622,
                "out_toks": 1104,
                "id": "chatcmpl-CSsRoMius3zFqrowXoQb3wiPUVblW",
                "created": 1760998516,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Objects first detected between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- with a top-ranked (ranking = 1) SN classification by the stamp classifier,\n-- and that either have SN probability > 0.5 for that classifier OR at least two detections (ndet >= 2).\n-- Note: The schema lacks classification timestamps; we assume \"first classified\" ~ firstmjd.\n\nSELECT o.*\nFROM OBJECT o\nJOIN\n  (-- Pre-aggregate to one row per oid to avoid duplicates and multiple scans\n SELECT oid,\n        bool_or(probability > 0.5) AS has_pgt05\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier' -- 1) classifier filter\n\n     AND class_name = 'SN' -- 2) class filter\n\n     AND ranking = 1 -- 3) only top-ranked class\n\n   GROUP BY oid) p ON p.oid = o.oid\nWHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND (p.has_pgt05\n       OR o.ndet >= 2);",
            "sql_response": {
                "responses": {
                    "0": "-- Objects first detected between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- with a top-ranked (ranking = 1) SN classification by the stamp classifier,\n-- and that either have SN probability > 0.5 for that classifier OR at least two detections (ndet >= 2).\n-- Note: The schema lacks classification timestamps; we assume \"first classified\" ~ firstmjd.\n\nSELECT o.*\nFROM OBJECT o\nJOIN\n  (-- Pre-aggregate to one row per oid to avoid duplicates and multiple scans\n SELECT oid,\n        bool_or(probability > 0.5) AS has_pgt05\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier' -- 1) classifier filter\n\n     AND class_name = 'SN' -- 2) class filter\n\n     AND ranking = 1 -- 3) only top-ranked class\n\n   GROUP BY oid) p ON p.oid = o.oid\nWHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND (p.has_pgt05\n       OR o.ndet >= 2);"
                },
                "in_toks": 1612,
                "out_toks": 2633,
                "id": "chatcmpl-Cb9JFleB0jiaI19VQ8n0PfIklIDzd",
                "created": 1762969957,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects whose first detection is between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- that were classified as SN (top-ranked, i.e., ranking = 1) by the stamp classifier,\n-- and that either have probability > 0.5 for that SN classification OR have at least two detections.\n-- Note: The schema does not store classification time; we assume \"first classified\" aligns with firstmjd.\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  -- Must be top-ranked SN by the stamp classifier\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n  )\n  -- Additional requirement: either high probability or at least 2 detections\n  AND (\n       oid IN (\n         SELECT oid\n         FROM probability\n         WHERE classifier_name = 'stamp_classifier'\n           AND class_name = 'SN'\n           AND ranking = 1\n           AND probability > 0.5\n       )\n       OR ndet >= 2\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects whose first detection is between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- that were classified as SN (top-ranked, i.e., ranking = 1) by the stamp classifier,\n-- and that either have probability > 0.5 for that SN classification OR have at least two detections.\n-- Note: The schema does not store classification time; we assume \"first classified\" aligns with firstmjd.\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  -- Must be top-ranked SN by the stamp classifier\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n  )\n  -- Additional requirement: either high probability or at least 2 detections\n  AND (\n       oid IN (\n         SELECT oid\n         FROM probability\n         WHERE classifier_name = 'stamp_classifier'\n           AND class_name = 'SN'\n           AND ranking = 1\n           AND probability > 0.5\n       )\n       OR ndet >= 2\n  );"
                },
                "in_toks": 2584,
                "out_toks": 1995,
                "id": "chatcmpl-CSsz0VeucnQdm9YBemjLXllVmQl7O",
                "created": 1761000574,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "8",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'detection']"
                },
                "in_toks": 622,
                "out_toks": 1297,
                "id": "chatcmpl-CZM0qtkFj1zGul08RIRfb6p1hEWhP",
                "created": 1762542132,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Objects whose earliest detection falls between 2023-08-17 (MJD=60173.0) and 2023-08-21 (MJD=60177.0),\n-- and whose stamp classifier predicts 'SN' as the top class (ranking=1),\n-- and that either have SN probability > 0.5 OR have at least two detections.\n-- Uses EXISTS instead of full-table GROUP BY to avoid timeouts, and narrows detection aggregations to candidates only.\n WITH prob AS\n  (SELECT p.oid,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- 1st condition on probability\n\n     AND p.class_name = 'SN' -- 2nd condition on probability\n\n     AND p.ranking = 1 -- 3rd condition on probability\n),\n      first_in_window AS\n  (SELECT DISTINCT d.oid\n   FROM detection d\n   WHERE d.mjd BETWEEN 60173.0 AND 60177.0\n     AND NOT EXISTS\n       (-- ensure there is no earlier detection for this oid\n SELECT 1\n        FROM detection d0\n        WHERE d0.oid = d.oid\n          AND d0.mjd < 60173.0)),\n      candidates AS\n  (SELECT p.oid\n   FROM prob p\n   JOIN first_in_window f ON f.oid = p.oid),\n      two_det AS\n  (SELECT d.oid\n   FROM detection d\n   JOIN candidates c ON c.oid = d.oid\n   GROUP BY d.oid\n   HAVING COUNT(*) >= 2)\nSELECT p.*\nFROM prob p\nJOIN candidates c ON c.oid = p.oid\nLEFT JOIN two_det t ON t.oid = p.oid\nWHERE p.probability > 0.5 -- probability > 0.5\n\n  OR t.oid IS NOT NULL; -- or at least two detections",
            "sql_response": {
                "responses": {
                    "0": "-- Objects whose earliest detection falls between 2023-08-17 (MJD=60173.0) and 2023-08-21 (MJD=60177.0),\n-- and whose stamp classifier predicts 'SN' as the top class (ranking=1),\n-- and that either have SN probability > 0.5 OR have at least two detections.\n-- Uses EXISTS instead of full-table GROUP BY to avoid timeouts, and narrows detection aggregations to candidates only.\n WITH prob AS\n  (SELECT p.oid,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- 1st condition on probability\n\n     AND p.class_name = 'SN' -- 2nd condition on probability\n\n     AND p.ranking = 1 -- 3rd condition on probability\n),\n      first_in_window AS\n  (SELECT DISTINCT d.oid\n   FROM detection d\n   WHERE d.mjd BETWEEN 60173.0 AND 60177.0\n     AND NOT EXISTS\n       (-- ensure there is no earlier detection for this oid\n SELECT 1\n        FROM detection d0\n        WHERE d0.oid = d.oid\n          AND d0.mjd < 60173.0)),\n      candidates AS\n  (SELECT p.oid\n   FROM prob p\n   JOIN first_in_window f ON f.oid = p.oid),\n      two_det AS\n  (SELECT d.oid\n   FROM detection d\n   JOIN candidates c ON c.oid = d.oid\n   GROUP BY d.oid\n   HAVING COUNT(*) >= 2)\nSELECT p.*\nFROM prob p\nJOIN candidates c ON c.oid = p.oid\nLEFT JOIN two_det t ON t.oid = p.oid\nWHERE p.probability > 0.5 -- probability > 0.5\n\n  OR t.oid IS NOT NULL; -- or at least two detections"
                },
                "in_toks": 1740,
                "out_toks": 3903,
                "id": "chatcmpl-Cb9JqZqiF0JSTYHTwUyD9HuJJjFRr",
                "created": 1762969994,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first observed (via their earliest detection) between 2023-08-17 (MJD=60173.0) and 2023-08-21 (MJD=60177.0),\n-- whose stamp classifier predicts 'SN' as the top class (ranking=1), and that either have SN probability > 0.5\n-- OR have at least two detections.\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1\n  AND p.oid IN (\n      SELECT oid\n      FROM (\n          SELECT d.oid, MIN(d.mjd) AS first_mjd\n          FROM detection d\n          GROUP BY d.oid\n      ) first_det\n      WHERE first_mjd >= 60173.0\n        AND first_mjd <= 60177.0\n  )\n  AND (\n      p.probability > 0.5\n      OR p.oid IN (\n          SELECT d2.oid\n          FROM detection d2\n          GROUP BY d2.oid\n          HAVING COUNT(*) >= 2\n      )\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first observed (via their earliest detection) between 2023-08-17 (MJD=60173.0) and 2023-08-21 (MJD=60177.0),\n-- whose stamp classifier predicts 'SN' as the top class (ranking=1), and that either have SN probability > 0.5\n-- OR have at least two detections.\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1\n  AND p.oid IN (\n      SELECT oid\n      FROM (\n          SELECT d.oid, MIN(d.mjd) AS first_mjd\n          FROM detection d\n          GROUP BY d.oid\n      ) first_det\n      WHERE first_mjd >= 60173.0\n        AND first_mjd <= 60177.0\n  )\n  AND (\n      p.probability > 0.5\n      OR p.oid IN (\n          SELECT d2.oid\n          FROM detection d2\n          GROUP BY d2.oid\n          HAVING COUNT(*) >= 2\n      )\n  );"
                },
                "in_toks": 2650,
                "out_toks": 2941,
                "id": "chatcmpl-CZROa7u7Zhon0SfCp680A486ZT2tF",
                "created": 1762562824,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "8",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'object']"
                },
                "in_toks": 622,
                "out_toks": 1616,
                "id": "chatcmpl-CZM1GQ0arLw9rnGersJcaeYgPuf5H",
                "created": 1762542158,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Objects first detected between 2023-08-17 and 2023-08-21 (MJD 60173\u201360177),\n   that have a stamp classifier SN (ranking=1), and either p(SN)>0.5 or at least 2 detections.\n   Note: \"first classified\" is approximated by the object's first detection time (firstmjd). */ \nSELECT o.*\nFROM OBJECT o \nWHERE o.firstmjd >= 60173.0 \n  AND o.firstmjd <= 60177.0 \n  AND EXISTS \n    (SELECT 1 \n     FROM probability p \n     WHERE p.oid = o.oid \n       AND p.classifier_name = 'stamp_classifier' -- classifier filter\n \n       AND p.class_name = 'SN' -- class filter\n\n       AND p.ranking = 1 -- top-ranked class\n\n       AND (p.probability > 0.5\n            OR o.ndet >= 2)-- probability or detections condition\n);",
            "sql_response": {
                "responses": {
                    "0": "/* Objects first detected between 2023-08-17 and 2023-08-21 (MJD 60173\u201360177),\n   that have a stamp classifier SN (ranking=1), and either p(SN)>0.5 or at least 2 detections.\n   Note: \"first classified\" is approximated by the object's first detection time (firstmjd). */ \nSELECT o.*\nFROM OBJECT o \nWHERE o.firstmjd >= 60173.0 \n  AND o.firstmjd <= 60177.0 \n  AND EXISTS \n    (SELECT 1 \n     FROM probability p \n     WHERE p.oid = o.oid \n       AND p.classifier_name = 'stamp_classifier' -- classifier filter\n \n       AND p.class_name = 'SN' -- class filter\n\n       AND p.ranking = 1 -- top-ranked class\n\n       AND (p.probability > 0.5\n            OR o.ndet >= 2)-- probability or detections condition\n);"
                },
                "in_toks": 1705,
                "out_toks": 3805,
                "id": "chatcmpl-Cb9KwDgop3xEt5waO02ja4mKvlAie",
                "created": 1762970062,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Assumptions:\n-- 1) \"first classified as SN\" means the stamp classifier's top-ranked class (ranking = 1) is 'SN'.\n-- 2) The classification time is approximated by the object's first detection time (firstmjd).\n-- 3) Date range is inclusive: Aug 17\u201321 corresponds to MJD 60173.0\u201360177.0.\nSELECT *\nFROM object o\nWHERE\n  o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND o.oid IN (\n    -- Case A: SN (rank 1) by stamp classifier with probability > 0.5\n    SELECT p1.oid\n    FROM probability p1\n    WHERE p1.classifier_name = 'stamp_classifier'\n      AND p1.class_name = 'SN'\n      AND p1.ranking = 1\n      AND p1.probability > 0.5\n\n    UNION\n\n    -- Case B: SN (rank 1) by stamp classifier and at least two detections (regardless of probability)\n    SELECT o2.oid\n    FROM object o2\n    WHERE o2.ndet >= 2\n      AND o2.oid IN (\n        SELECT p2.oid\n        FROM probability p2\n        WHERE p2.classifier_name = 'stamp_classifier'\n          AND p2.class_name = 'SN'\n          AND p2.ranking = 1\n      )\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Assumptions:\n-- 1) \"first classified as SN\" means the stamp classifier's top-ranked class (ranking = 1) is 'SN'.\n-- 2) The classification time is approximated by the object's first detection time (firstmjd).\n-- 3) Date range is inclusive: Aug 17\u201321 corresponds to MJD 60173.0\u201360177.0.\nSELECT *\nFROM object o\nWHERE\n  o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND o.oid IN (\n    -- Case A: SN (rank 1) by stamp classifier with probability > 0.5\n    SELECT p1.oid\n    FROM probability p1\n    WHERE p1.classifier_name = 'stamp_classifier'\n      AND p1.class_name = 'SN'\n      AND p1.ranking = 1\n      AND p1.probability > 0.5\n\n    UNION\n\n    -- Case B: SN (rank 1) by stamp classifier and at least two detections (regardless of probability)\n    SELECT o2.oid\n    FROM object o2\n    WHERE o2.ndet >= 2\n      AND o2.oid IN (\n        SELECT p2.oid\n        FROM probability p2\n        WHERE p2.classifier_name = 'stamp_classifier'\n          AND p2.class_name = 'SN'\n          AND p2.ranking = 1\n      )\n  );"
                },
                "in_toks": 2584,
                "out_toks": 2810,
                "id": "chatcmpl-CZRJsgPEf2Ir2MRYBaVOiwbBpkcKA",
                "created": 1762562532,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "8",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability",
                "taxonomy",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'object']"
                },
                "in_toks": 622,
                "out_toks": 1171,
                "id": "chatcmpl-CZM1cmW38mMJKZaN4dEFaGyTrozQ0",
                "created": 1762542180,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized: filter objects by firstmjd, then semi-join via EXISTS to top-ranked SN\n-- from the stamp classifier; require prob > 0.5 OR at least 2 detections.\n\nSELECT o.*\nFROM OBJECT AS o\nWHERE o.firstmjd BETWEEN 60173.0 AND 60177.0 -- Aug 17 to Aug 21 (MJD)\n\n  AND EXISTS\n    (SELECT 1\n     FROM probability AS p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'SN'\n       AND p.ranking = 1\n       AND (p.probability > 0.5\n            OR o.ndet >= 2));",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized: filter objects by firstmjd, then semi-join via EXISTS to top-ranked SN\n-- from the stamp classifier; require prob > 0.5 OR at least 2 detections.\n\nSELECT o.*\nFROM OBJECT AS o\nWHERE o.firstmjd BETWEEN 60173.0 AND 60177.0 -- Aug 17 to Aug 21 (MJD)\n\n  AND EXISTS\n    (SELECT 1\n     FROM probability AS p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'SN'\n       AND p.ranking = 1\n       AND (p.probability > 0.5\n            OR o.ndet >= 2));"
                },
                "in_toks": 1507,
                "out_toks": 2662,
                "id": "chatcmpl-Cb9LyGWwlVqObh86PkbFHIcFF8WPl",
                "created": 1762970126,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects whose first detection (firstmjd) is between Aug 17 (60173.0) and Aug 21 (60177.0),\n-- and whose top-ranked stamp classifier label is SN, with either probability > 0.5\n-- or at least 2 detections (ndet >= 2).\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n      AND (\n        probability > 0.5\n        OR oid IN (\n          SELECT oid\n          FROM object\n          WHERE ndet >= 2\n            AND firstmjd BETWEEN 60173.0 AND 60177.0\n        )\n      )\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects whose first detection (firstmjd) is between Aug 17 (60173.0) and Aug 21 (60177.0),\n-- and whose top-ranked stamp classifier label is SN, with either probability > 0.5\n-- or at least 2 detections (ndet >= 2).\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND ranking = 1\n      AND (\n        probability > 0.5\n        OR oid IN (\n          SELECT oid\n          FROM object\n          WHERE ndet >= 2\n            AND firstmjd BETWEEN 60173.0 AND 60177.0\n        )\n      )\n  );"
                },
                "in_toks": 2629,
                "out_toks": 1982,
                "id": "chatcmpl-CZRHKDTaAc2CrCnKfbKccrs2CQNwv",
                "created": 1762562374,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "8",
            "experiment_id": "run_8",
            "pred_tables": [
                "probability",
                "taxonomy",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'object']"
                },
                "in_toks": 622,
                "out_toks": 1171,
                "id": "chatcmpl-CZM208ZOgDiJGGawB3nQhhIphNnLL",
                "created": 1762542204,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Objects whose first detection (proxy for first stamp classification) is between 2023-08-17 and 2023-08-21 inclusive (MJD 60173\u201360177),\n-- that are ranked 1 as 'SN' by the stamp classifier, and additionally have (probability > 0.5 OR at least 2 detections).\n-- Optimized using a single EXISTS on the probability table (filtered by classifier_name, class_name, and ranking).\n\nSELECT o.*\nFROM OBJECT AS o\nWHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND EXISTS\n    (SELECT 1\n     FROM probability AS p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'SN'\n       AND p.ranking = 1\n       AND (p.probability > 0.5\n            OR o.ndet >= 2));",
            "sql_response": {
                "responses": {
                    "0": "-- Objects whose first detection (proxy for first stamp classification) is between 2023-08-17 and 2023-08-21 inclusive (MJD 60173\u201360177),\n-- that are ranked 1 as 'SN' by the stamp classifier, and additionally have (probability > 0.5 OR at least 2 detections).\n-- Optimized using a single EXISTS on the probability table (filtered by classifier_name, class_name, and ranking).\n\nSELECT o.*\nFROM OBJECT AS o\nWHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND EXISTS\n    (SELECT 1\n     FROM probability AS p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'SN'\n       AND p.ranking = 1\n       AND (p.probability > 0.5\n            OR o.ndet >= 2));"
                },
                "in_toks": 1539,
                "out_toks": 3280,
                "id": "chatcmpl-Cb9Mt6zDewxm8hkWvdR9xHliDXyx7",
                "created": 1762970183,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first observed (proxy for first stamped classification) between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- that were ranked-1 as 'SN' by the stamp classifier, and additionally have (probability > 0.5 OR at least 2 detections).\n\nSELECT *\nFROM OBJECT\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  AND oid IN\n    (SELECT oid\n     FROM probability\n     WHERE classifier_name = 'stamp_classifier'\n       AND class_name = 'SN'\n       AND ranking = 1)\n  AND (ndet >= 2\n       OR oid IN\n         (SELECT oid\n          FROM probability\n          WHERE classifier_name = 'stamp_classifier'\n            AND class_name = 'SN'\n            AND ranking = 1\n            AND probability > 0.5));",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first observed (proxy for first stamped classification) between 2023-08-17 (MJD 60173.0) and 2023-08-21 (MJD 60177.0),\n-- that were ranked-1 as 'SN' by the stamp classifier, and additionally have (probability > 0.5 OR at least 2 detections).\n\nSELECT *\nFROM OBJECT\nWHERE firstmjd BETWEEN 60173.0 AND 60177.0\n  AND oid IN\n    (SELECT oid\n     FROM probability\n     WHERE classifier_name = 'stamp_classifier'\n       AND class_name = 'SN'\n       AND ranking = 1)\n  AND (ndet >= 2\n       OR oid IN\n         (SELECT oid\n          FROM probability\n          WHERE classifier_name = 'stamp_classifier'\n            AND class_name = 'SN'\n            AND ranking = 1\n            AND probability > 0.5));"
                },
                "in_toks": 2629,
                "out_toks": 2193,
                "id": "chatcmpl-CayCMPlMuucV9Dw0jI6Fs1ubk6sLZ",
                "created": 1762927246,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "8",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'detection']"
                },
                "in_toks": 622,
                "out_toks": 1681,
                "id": "chatcmpl-CZM2ONXptF6uB1aJ3hv3ykgc1nQMg",
                "created": 1762542228,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Objects first classified as SN by the stamp classifier between MJD 60173.0 (Aug 17) and 60177.0 (Aug 21),\n   with either SN probability > 0.5 or at least two detections. Optimized by restricting detection aggregation\n   to OIDs already classified as SN (ranking=1) by the stamp classifier. */ WITH p_sn AS\n  (/* All OIDs classified as SN (top-ranked) by the stamp classifier */  SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n     AND class_name = 'SN'\n     AND ranking = 1),\n                                                                                 p_prob AS\n  (/* Subset with SN probability > 0.5 */  SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n     AND class_name = 'SN'\n     AND ranking = 1\n     AND probability > 0.5),\n                                                                                 det_rank AS\n  (/* Compute first detection time and total detections per OID (only for SN candidates) */  SELECT d.oid,\n                                                                                                    d.mjd,\n                                                                                                    ROW_NUMBER() OVER (PARTITION BY d.oid\n                                                                                                                       ORDER BY d.mjd) AS rn,\n                                                                                                    COUNT(*) OVER (PARTITION BY d.oid) AS ndet\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM p_sn)-- only filter by oid as recommended\n),\n                                                                                 first_det AS\n  (/* First detection within the MJD window */  SELECT oid,\n                                                       mjd AS first_mjd,\n                                                       ndet\n   FROM det_rank\n   WHERE rn = 1\n     AND mjd BETWEEN 60173.0 AND 60177.0),\n                                                                                 cand AS\n  (/* OIDs meeting (prob>0.5 OR >=2 detections) and first detection in window */  SELECT fd.oid\n   FROM first_det fd\n   WHERE fd.ndet >= 2\n   UNION SELECT pp.oid\n   FROM p_prob pp\n   INNER JOIN first_det fd2 ON fd2.oid = pp.oid)\nSELECT DISTINCT p.oid\nFROM probability p\nJOIN cand c ON c.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1;",
            "sql_response": {
                "responses": {
                    "0": "/* Objects first classified as SN by the stamp classifier between MJD 60173.0 (Aug 17) and 60177.0 (Aug 21),\n   with either SN probability > 0.5 or at least two detections. Optimized by restricting detection aggregation\n   to OIDs already classified as SN (ranking=1) by the stamp classifier. */ WITH p_sn AS\n  (/* All OIDs classified as SN (top-ranked) by the stamp classifier */  SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n     AND class_name = 'SN'\n     AND ranking = 1),\n                                                                                 p_prob AS\n  (/* Subset with SN probability > 0.5 */  SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n     AND class_name = 'SN'\n     AND ranking = 1\n     AND probability > 0.5),\n                                                                                 det_rank AS\n  (/* Compute first detection time and total detections per OID (only for SN candidates) */  SELECT d.oid,\n                                                                                                    d.mjd,\n                                                                                                    ROW_NUMBER() OVER (PARTITION BY d.oid\n                                                                                                                       ORDER BY d.mjd) AS rn,\n                                                                                                    COUNT(*) OVER (PARTITION BY d.oid) AS ndet\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM p_sn)-- only filter by oid as recommended\n),\n                                                                                 first_det AS\n  (/* First detection within the MJD window */  SELECT oid,\n                                                       mjd AS first_mjd,\n                                                       ndet\n   FROM det_rank\n   WHERE rn = 1\n     AND mjd BETWEEN 60173.0 AND 60177.0),\n                                                                                 cand AS\n  (/* OIDs meeting (prob>0.5 OR >=2 detections) and first detection in window */  SELECT fd.oid\n   FROM first_det fd\n   WHERE fd.ndet >= 2\n   UNION SELECT pp.oid\n   FROM p_prob pp\n   INNER JOIN first_det fd2 ON fd2.oid = pp.oid)\nSELECT DISTINCT p.oid\nFROM probability p\nJOIN cand c ON c.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1;"
                },
                "in_toks": 1842,
                "out_toks": 3374,
                "id": "chatcmpl-Cb9NyBSlKaBN2E0uBLDasO3W4woen",
                "created": 1762970250,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* \nObjects whose first detection (as a proxy for first stamp-classification event) occurred between 60173.0 (Aug 17) and 60177.0 (Aug 21), \nthat the stamp classifier classifies as SN (top-ranked), and that either have SN probability > 0.5 or at least two detections.\n*/\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1  /* interpret \"classified as SN\" as top-ranked class */\n  AND p.oid IN (\n    /* Obtain candidate OIDs meeting the time-window and (probability > 0.5 OR >=2 detections) condition */\n    SELECT s.oid\n    FROM (\n      SELECT d.oid, MIN(d.mjd) AS first_mjd, COUNT(*) AS ndet\n      FROM detection d\n      GROUP BY d.oid\n    ) s\n    WHERE s.first_mjd BETWEEN 60173.0 AND 60177.0\n      AND (\n        s.ndet >= 2\n        OR EXISTS (\n          SELECT 1\n          FROM probability p2\n          WHERE p2.oid = s.oid\n            AND p2.classifier_name = 'stamp_classifier'\n            AND p2.class_name = 'SN'\n            AND p2.probability > 0.5\n        )\n      )\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "/* \nObjects whose first detection (as a proxy for first stamp-classification event) occurred between 60173.0 (Aug 17) and 60177.0 (Aug 21), \nthat the stamp classifier classifies as SN (top-ranked), and that either have SN probability > 0.5 or at least two detections.\n*/\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1  /* interpret \"classified as SN\" as top-ranked class */\n  AND p.oid IN (\n    /* Obtain candidate OIDs meeting the time-window and (probability > 0.5 OR >=2 detections) condition */\n    SELECT s.oid\n    FROM (\n      SELECT d.oid, MIN(d.mjd) AS first_mjd, COUNT(*) AS ndet\n      FROM detection d\n      GROUP BY d.oid\n    ) s\n    WHERE s.first_mjd BETWEEN 60173.0 AND 60177.0\n      AND (\n        s.ndet >= 2\n        OR EXISTS (\n          SELECT 1\n          FROM probability p2\n          WHERE p2.oid = s.oid\n            AND p2.classifier_name = 'stamp_classifier'\n            AND p2.class_name = 'SN'\n            AND p2.probability > 0.5\n        )\n      )\n  );"
                },
                "in_toks": 2650,
                "out_toks": 3506,
                "id": "chatcmpl-CZROfYYs9Jl0Fgf0H01vvFDOtbyG1",
                "created": 1762562829,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        }
    },
    "27": {
        "0": {
            "req_id": "27",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 661,
                "out_toks": 3043,
                "id": "chatcmpl-CSnQJ7a0dL9yoLji7XUSpWvCUqx4j",
                "created": 1760979203,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Fix: the original IN subquery referenced alias \"s\" without defining it.\n   Also switch to JOINs for clarity and to fetch object columns directly. */ WITH selected AS\n  (/* Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76 */  SELECT p.oid,\n                                                                                                               p.classifier_version\n   FROM probability p\n   JOIN OBJECT o ON o.oid = p.oid\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'CEP'\n     AND p.ranking = 1\n     AND p.probability > 0.76\n     AND o.ndet >= 100)\nSELECT p.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       o.g_r_max,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM probability p\nJOIN selected s ON s.oid = p.oid\nAND s.classifier_version = p.classifier_version\nJOIN OBJECT o ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\nORDER BY p.oid,\n         p.ranking;",
            "sql_response": {
                "responses": {
                    "0": "/* Fix: the original IN subquery referenced alias \"s\" without defining it.\n   Also switch to JOINs for clarity and to fetch object columns directly. */ WITH selected AS\n  (/* Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76 */  SELECT p.oid,\n                                                                                                               p.classifier_version\n   FROM probability p\n   JOIN OBJECT o ON o.oid = p.oid\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'CEP'\n     AND p.ranking = 1\n     AND p.probability > 0.76\n     AND o.ndet >= 100)\nSELECT p.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       o.g_r_max,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM probability p\nJOIN selected s ON s.oid = p.oid\nAND s.classifier_version = p.classifier_version\nJOIN OBJECT o ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\nORDER BY p.oid,\n         p.ranking;"
                },
                "in_toks": 4308,
                "out_toks": 1367,
                "id": "chatcmpl-Cb9P3E3JdMzbm2LctDhs6lY6fCb8r",
                "created": 1762970317,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76,\n   then return all lc_classifier classes (and their probabilities) for the matching (oid, classifier_version) pairs */\nWITH selected AS (\n    SELECT p.oid, p.classifier_version\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet >= 100\n      )\n)\nSELECT\n    p.oid,\n    /* object-level columns via scalar subqueries to avoid JOINs */\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND (p.oid, p.classifier_version) IN (SELECT s.oid, s.classifier_version FROM selected)\nORDER BY p.oid, p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76,\n   then return all lc_classifier classes (and their probabilities) for the matching (oid, classifier_version) pairs */\nWITH selected AS (\n    SELECT p.oid, p.classifier_version\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet >= 100\n      )\n)\nSELECT\n    p.oid,\n    /* object-level columns via scalar subqueries to avoid JOINs */\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND (p.oid, p.classifier_version) IN (SELECT s.oid, s.classifier_version FROM selected)\nORDER BY p.oid, p.ranking;"
                },
                "in_toks": 5027,
                "out_toks": 2627,
                "id": "chatcmpl-CSoG79NLAtEilQL1gkMWl1h06rLAE",
                "created": 1760982415,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "27",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 661,
                "out_toks": 3043,
                "id": "chatcmpl-CSnQJ7a0dL9yoLji7XUSpWvCUqx4j",
                "created": 1760979203,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76 */\nWITH eligible AS (\n    SELECT pr.oid, pr.classifier_version\n    FROM probability pr\n    WHERE pr.classifier_name = 'lc_classifier'\n      AND pr.class_name = 'CEP'\n      AND pr.ranking = 1\n      AND pr.probability > 0.76\n      AND pr.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet >= 100\n      )\n)\nSELECT\n    p.oid,\n    /* Object-level columns retrieved via scalar subqueries to avoid explicit JOINs */\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    /* Probability-level columns for each lc_classifier class and eligible version */\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND EXISTS (\n      SELECT 1\n      FROM eligible e\n      WHERE e.oid = p.oid\n        AND e.classifier_version = p.classifier_version\n  )\nORDER BY p.oid, p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76 */\nWITH eligible AS (\n    SELECT pr.oid, pr.classifier_version\n    FROM probability pr\n    WHERE pr.classifier_name = 'lc_classifier'\n      AND pr.class_name = 'CEP'\n      AND pr.ranking = 1\n      AND pr.probability > 0.76\n      AND pr.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet >= 100\n      )\n)\nSELECT\n    p.oid,\n    /* Object-level columns retrieved via scalar subqueries to avoid explicit JOINs */\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    /* Probability-level columns for each lc_classifier class and eligible version */\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND EXISTS (\n      SELECT 1\n      FROM eligible e\n      WHERE e.oid = p.oid\n        AND e.classifier_version = p.classifier_version\n  )\nORDER BY p.oid, p.ranking;"
                },
                "in_toks": 2595,
                "out_toks": 3272,
                "id": "chatcmpl-CSoGeOGvQprPmtv93lrnkSxin67SY",
                "created": 1760982448,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "27",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 661,
                "out_toks": 1811,
                "id": "chatcmpl-CSsS15jpkW38D70xuXe6tdrT8Z3AA",
                "created": 1760998529,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76\n-- Return one row per lc_classifier class (all classes) for each qualifying object\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN (\n      SELECT o.oid\n      FROM object o\n      WHERE o.ndet >= 100\n  )\n  AND EXISTS (\n      SELECT 1\n      FROM probability p1\n      WHERE p1.oid = p.oid\n        AND p1.classifier_name = 'lc_classifier'\n        AND p1.classifier_version = p.classifier_version\n        AND p1.class_name = 'CEP'\n        AND p1.ranking = 1\n        AND p1.probability > 0.76\n  )\nORDER BY p.oid, p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76\n-- Return one row per lc_classifier class (all classes) for each qualifying object\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN (\n      SELECT o.oid\n      FROM object o\n      WHERE o.ndet >= 100\n  )\n  AND EXISTS (\n      SELECT 1\n      FROM probability p1\n      WHERE p1.oid = p.oid\n        AND p1.classifier_name = 'lc_classifier'\n        AND p1.classifier_version = p.classifier_version\n        AND p1.class_name = 'CEP'\n        AND p1.ranking = 1\n        AND p1.probability > 0.76\n  )\nORDER BY p.oid, p.ranking;"
                },
                "in_toks": 2640,
                "out_toks": 3692,
                "id": "chatcmpl-CSszQPF3GhR8oJjDKiGr68YK2xPIM",
                "created": 1761000600,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "27",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 661,
                "out_toks": 915,
                "id": "chatcmpl-CSsSNuOmKoLQRTzxK9AxUVJjK6Kqt",
                "created": 1760998551,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all lc_classifier class probabilities for objects that are most likely CEP (ranking=1) with prob>0.76\n-- and have ndet >= 100, along with selected object columns.\nSELECT\n    p.oid,\n    /* object columns via scalar subqueries to avoid explicit JOINs */\n    (SELECT o.meanra FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    /* probability columns */\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.oid IN (\n        /* Select OIDs that are most likely CEP with prob>0.76 and ndet>=100 */\n        SELECT p_top.oid\n        FROM probability p_top\n        WHERE\n            p_top.classifier_name = 'lc_classifier'\n            AND p_top.class_name = 'CEP'\n            AND p_top.ranking = 1\n            AND p_top.probability > 0.76\n            AND p_top.oid IN (\n                SELECT o.oid\n                FROM object o\n                WHERE o.ndet >= 100\n            )\n    )\nORDER BY\n    p.oid,\n    p.ranking ASC,\n    p.probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all lc_classifier class probabilities for objects that are most likely CEP (ranking=1) with prob>0.76\n-- and have ndet >= 100, along with selected object columns.\nSELECT\n    p.oid,\n    /* object columns via scalar subqueries to avoid explicit JOINs */\n    (SELECT o.meanra FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    /* probability columns */\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.oid IN (\n        /* Select OIDs that are most likely CEP with prob>0.76 and ndet>=100 */\n        SELECT p_top.oid\n        FROM probability p_top\n        WHERE\n            p_top.classifier_name = 'lc_classifier'\n            AND p_top.class_name = 'CEP'\n            AND p_top.ranking = 1\n            AND p_top.probability > 0.76\n            AND p_top.oid IN (\n                SELECT o.oid\n                FROM object o\n                WHERE o.ndet >= 100\n            )\n    )\nORDER BY\n    p.oid,\n    p.ranking ASC,\n    p.probability DESC;"
                },
                "in_toks": 2640,
                "out_toks": 1997,
                "id": "chatcmpl-CSt1vrSOF9E2jAzCwsWfnxf9nT9JV",
                "created": 1761000755,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "27",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 661,
                "out_toks": 1107,
                "id": "chatcmpl-CSsSa9powxoSVht4RKMmB8YJVs3gy",
                "created": 1760998564,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with ndet >= 100 whose top-ranked lc_classifier class is CEP with probability > 0.76,\n-- then return all lc_classifier class probabilities for those objects, plus object metadata.\nWITH cep_oids AS\n  (SELECT pr.oid\n   FROM probability pr\n   WHERE pr.classifier_name = 'lc_classifier'\n     AND pr.class_name = 'CEP'\n     AND pr.ranking = 1\n     AND pr.probability > 0.76),\n     filtered_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.ndet >= 100\n     AND o.oid IN\n       (SELECT oid\n        FROM cep_oids))\nSELECT p.oid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS ndet,\n\n  (SELECT o.firstmjd\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS firstmjd,\n\n  (SELECT o.deltajd\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS deltajd,\n\n  (SELECT o.g_r_max\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS g_r_max,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN\n    (SELECT oid\n     FROM filtered_oids)\nORDER BY p.oid,\n         p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with ndet >= 100 whose top-ranked lc_classifier class is CEP with probability > 0.76,\n-- then return all lc_classifier class probabilities for those objects, plus object metadata.\nWITH cep_oids AS\n  (SELECT pr.oid\n   FROM probability pr\n   WHERE pr.classifier_name = 'lc_classifier'\n     AND pr.class_name = 'CEP'\n     AND pr.ranking = 1\n     AND pr.probability > 0.76),\n     filtered_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.ndet >= 100\n     AND o.oid IN\n       (SELECT oid\n        FROM cep_oids))\nSELECT p.oid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS ndet,\n\n  (SELECT o.firstmjd\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS firstmjd,\n\n  (SELECT o.deltajd\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS deltajd,\n\n  (SELECT o.g_r_max\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS g_r_max,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN\n    (SELECT oid\n     FROM filtered_oids)\nORDER BY p.oid,\n         p.ranking;"
                },
                "in_toks": 2640,
                "out_toks": 2212,
                "id": "chatcmpl-CayD751fqcAKv4tY14Gquh4imxnKX",
                "created": 1762927293,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "27",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 661,
                "out_toks": 1491,
                "id": "chatcmpl-CZM2tYuxRXaG1hpsrAh7F26DtVplW",
                "created": 1762542259,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with >=100 detections whose top-ranked lc_classifier class is CEP with probability > 0.76\nWITH cepheids AS (\n    SELECT pr.oid\n    FROM probability pr\n    WHERE pr.classifier_name = 'lc_classifier'\n      AND pr.class_name = 'CEP'\n      AND pr.ranking = 1\n      AND pr.probability > 0.76\n),\nselected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 100\n      AND o.oid IN (SELECT oid FROM cepheids)\n)\n-- For those objects, return probabilities for each lc_classifier class plus requested object columns\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN (SELECT oid FROM selected_oids)\nORDER BY p.oid, p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with >=100 detections whose top-ranked lc_classifier class is CEP with probability > 0.76\nWITH cepheids AS (\n    SELECT pr.oid\n    FROM probability pr\n    WHERE pr.classifier_name = 'lc_classifier'\n      AND pr.class_name = 'CEP'\n      AND pr.ranking = 1\n      AND pr.probability > 0.76\n),\nselected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 100\n      AND o.oid IN (SELECT oid FROM cepheids)\n)\n-- For those objects, return probabilities for each lc_classifier class plus requested object columns\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN (SELECT oid FROM selected_oids)\nORDER BY p.oid, p.ranking;"
                },
                "in_toks": 2640,
                "out_toks": 2791,
                "id": "chatcmpl-CZRIkHgBCGTL5RgL9lVQrlaunyBaZ",
                "created": 1762562462,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "27",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 661,
                "out_toks": 2131,
                "id": "chatcmpl-CZM3T8jFrymdeV6oMnUPkykS7dVYv",
                "created": 1762542295,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return, for each class row of the lc_classifier, the object and probability info,\n-- but only for those (oid, classifier_version) where CEP is the top class (ranking=1)\n-- with probability > 0.76 and the object has ndet >= 100.\n\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND (p.oid, p.classifier_version) IN (\n        SELECT DISTINCT prob.oid, prob.classifier_version\n        FROM probability prob\n        WHERE prob.classifier_name = 'lc_classifier'\n          AND prob.class_name = 'CEP'\n          AND prob.ranking = 1\n          AND prob.probability > 0.76\n          AND prob.oid IN (\n                SELECT o2.oid\n                FROM object o2\n                WHERE o2.ndet >= 100\n          )\n  )\nORDER BY p.oid, p.ranking, p.class_name;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return, for each class row of the lc_classifier, the object and probability info,\n-- but only for those (oid, classifier_version) where CEP is the top class (ranking=1)\n-- with probability > 0.76 and the object has ndet >= 100.\n\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND (p.oid, p.classifier_version) IN (\n        SELECT DISTINCT prob.oid, prob.classifier_version\n        FROM probability prob\n        WHERE prob.classifier_name = 'lc_classifier'\n          AND prob.class_name = 'CEP'\n          AND prob.ranking = 1\n          AND prob.probability > 0.76\n          AND prob.oid IN (\n                SELECT o2.oid\n                FROM object o2\n                WHERE o2.ndet >= 100\n          )\n  )\nORDER BY p.oid, p.ranking, p.class_name;"
                },
                "in_toks": 5027,
                "out_toks": 3320,
                "id": "chatcmpl-CZRM1HajZ5fdSEgH6jfOJlLFXWq7y",
                "created": 1762562665,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "27",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 661,
                "out_toks": 979,
                "id": "chatcmpl-CZM4ALXEJRY1EBGCMYlffkgfxGPUw",
                "created": 1762542338,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76\nWITH eligible AS (\n    SELECT p.oid, p.classifier_version\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet >= 100\n      )\n)\n-- Return all lc_classifier class probabilities for the eligible objects (same classifier_version)\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND (p.oid, p.classifier_version) IN (\n      SELECT e.oid, e.classifier_version\n      FROM eligible e\n  )\nORDER BY p.oid, p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with ndet >= 100 whose most likely lc_classifier class is CEP with probability > 0.76\nWITH eligible AS (\n    SELECT p.oid, p.classifier_version\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet >= 100\n      )\n)\n-- Return all lc_classifier class probabilities for the eligible objects (same classifier_version)\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND (p.oid, p.classifier_version) IN (\n      SELECT e.oid, e.classifier_version\n      FROM eligible e\n  )\nORDER BY p.oid, p.ranking;"
                },
                "in_toks": 2640,
                "out_toks": 2419,
                "id": "chatcmpl-CZRJMIk0PRleCbKkV3xLEpjcynxdS",
                "created": 1762562500,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "27",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 661,
                "out_toks": 1363,
                "id": "chatcmpl-CZM58TRLnantHtAn9BF7Uuy0Z4fSI",
                "created": 1762542398,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all lc_classifier class probabilities for objects with ndet >= 100 whose top-ranked class is CEP with probability > 0.76\nSELECT\n    p.oid,\n    /* object-level attributes via scalar subqueries to avoid JOINs */\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE\n    /* only lc_classifier classes */\n    p.classifier_name = 'lc_classifier'\n    /* ensure objects have at least 100 detections */\n    AND p.oid IN (\n        SELECT o.oid\n        FROM object o\n        WHERE o.ndet >= 100\n    )\n    /* restrict to classifier versions where CEP is top-ranked with prob > 0.76 */\n    AND (p.oid, p.classifier_version) IN (\n        SELECT pr.oid, pr.classifier_version\n        FROM probability pr\n        WHERE pr.classifier_name = 'lc_classifier'\n          AND pr.class_name = 'CEP'\n          AND pr.ranking = 1\n          AND pr.probability > 0.76\n    )\nORDER BY p.oid, p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all lc_classifier class probabilities for objects with ndet >= 100 whose top-ranked class is CEP with probability > 0.76\nSELECT\n    p.oid,\n    /* object-level attributes via scalar subqueries to avoid JOINs */\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE\n    /* only lc_classifier classes */\n    p.classifier_name = 'lc_classifier'\n    /* ensure objects have at least 100 detections */\n    AND p.oid IN (\n        SELECT o.oid\n        FROM object o\n        WHERE o.ndet >= 100\n    )\n    /* restrict to classifier versions where CEP is top-ranked with prob > 0.76 */\n    AND (p.oid, p.classifier_version) IN (\n        SELECT pr.oid, pr.classifier_version\n        FROM probability pr\n        WHERE pr.classifier_name = 'lc_classifier'\n          AND pr.class_name = 'CEP'\n          AND pr.ranking = 1\n          AND pr.probability > 0.76\n    )\nORDER BY p.oid, p.ranking;"
                },
                "in_toks": 2640,
                "out_toks": 2825,
                "id": "chatcmpl-CZRM57Xyp7jGEHuofsgtcVxwQX8rt",
                "created": 1762562669,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "27",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 661,
                "out_toks": 1744,
                "id": "chatcmpl-CZM5rECGOOjPrLkdRcZcoOUTKny6Z",
                "created": 1762542443,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all lc_classifier class probabilities for objects whose top-ranked class is CEP with prob>0.76\n-- and have ndet >= 100, including selected object metadata via scalar subqueries (no explicit JOINs).\nWITH target_oids AS (\n    SELECT pr.oid\n    FROM probability pr\n    WHERE pr.classifier_name = 'lc_classifier'\n      AND pr.class_name = 'CEP'\n      AND pr.ranking = 1\n      AND pr.probability > 0.76\n      AND pr.oid IN (\n          SELECT o2.oid\n          FROM object o2\n          WHERE o2.ndet >= 100\n      )\n)\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN (SELECT oid FROM target_oids)\nORDER BY p.oid, p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all lc_classifier class probabilities for objects whose top-ranked class is CEP with prob>0.76\n-- and have ndet >= 100, including selected object metadata via scalar subqueries (no explicit JOINs).\nWITH target_oids AS (\n    SELECT pr.oid\n    FROM probability pr\n    WHERE pr.classifier_name = 'lc_classifier'\n      AND pr.class_name = 'CEP'\n      AND pr.ranking = 1\n      AND pr.probability > 0.76\n      AND pr.oid IN (\n          SELECT o2.oid\n          FROM object o2\n          WHERE o2.ndet >= 100\n      )\n)\nSELECT\n    p.oid,\n    (SELECT o.meanra   FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec  FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet     FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    (SELECT o.deltajd  FROM object o WHERE o.oid = p.oid) AS deltajd,\n    (SELECT o.g_r_max  FROM object o WHERE o.oid = p.oid) AS g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.oid IN (SELECT oid FROM target_oids)\nORDER BY p.oid, p.ranking;"
                },
                "in_toks": 2595,
                "out_toks": 1958,
                "id": "chatcmpl-CZRJkqM5nZ7g5waUWC2Aj6eHEmlFK",
                "created": 1762562524,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "17": {
        "0": {
            "req_id": "17",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "taxonomy",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'magstat', 'feature']",
                    "1": "['object', 'probability', 'taxonomy', 'magstat', 'feature']"
                },
                "in_toks": 629,
                "out_toks": 2353,
                "id": "chatcmpl-CSnQghlCZSCyxi02PHl2bE903Mx5M",
                "created": 1760979226,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with top-ranked AGN classification (lc_classifier),\n-- that show variability in r band (ExcessVar(fid=2) > 0),\n-- and either have no g-band detections (no magstat with fid=1 and ndet>0)\n-- OR show no variability in g band (ExcessVar(fid=1) <= 0).\n-- Return all features for those objects, ordered by oid then feature value (ascending).\n\nSELECT *\nFROM feature f\nWHERE f.oid IN\n    (SELECT DISTINCT p.oid\n     FROM probability p\n     WHERE p.class_name = 'AGN'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.ranking = 1\n       AND EXISTS\n         (SELECT 1\n          FROM feature fr\n          WHERE fr.oid = p.oid\n            AND fr.name = 'ExcessVar'\n            AND fr.fid = 2 -- r band\n\n            AND fr.value > 0)\n       AND (NOT EXISTS\n              (SELECT 1\n               FROM magstat mg\n               WHERE mg.oid = p.oid\n                 AND mg.fid = 1 -- g band\n\n                 AND mg.ndet > 0)\n            OR EXISTS\n              (SELECT 1\n               FROM feature fg\n               WHERE fg.oid = p.oid\n                 AND fg.name = 'ExcessVar'\n                 AND fg.fid = 1 -- g band\n\n                 AND COALESCE(fg.value, 0) <= 0)))\nORDER BY f.oid,\n         f.value ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with top-ranked AGN classification (lc_classifier),\n-- that show variability in r band (ExcessVar(fid=2) > 0),\n-- and either have no g-band detections (no magstat with fid=1 and ndet>0)\n-- OR show no variability in g band (ExcessVar(fid=1) <= 0).\n-- Return all features for those objects, ordered by oid then feature value (ascending).\n\nSELECT *\nFROM feature f\nWHERE f.oid IN\n    (SELECT DISTINCT p.oid\n     FROM probability p\n     WHERE p.class_name = 'AGN'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.ranking = 1\n       AND EXISTS\n         (SELECT 1\n          FROM feature fr\n          WHERE fr.oid = p.oid\n            AND fr.name = 'ExcessVar'\n            AND fr.fid = 2 -- r band\n\n            AND fr.value > 0)\n       AND (NOT EXISTS\n              (SELECT 1\n               FROM magstat mg\n               WHERE mg.oid = p.oid\n                 AND mg.fid = 1 -- g band\n\n                 AND mg.ndet > 0)\n            OR EXISTS\n              (SELECT 1\n               FROM feature fg\n               WHERE fg.oid = p.oid\n                 AND fg.name = 'ExcessVar'\n                 AND fg.fid = 1 -- g band\n\n                 AND COALESCE(fg.value, 0) <= 0)))\nORDER BY f.oid,\n         f.value ASC;"
                },
                "in_toks": 5275,
                "out_toks": 4180,
                "id": "chatcmpl-CayDrnuVWHXaO1ne0xueshBuT2cIX",
                "created": 1762927339,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "17",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'magstat', 'feature']",
                    "1": "['object', 'probability', 'taxonomy', 'magstat', 'feature']"
                },
                "in_toks": 629,
                "out_toks": 2353,
                "id": "chatcmpl-CSnQghlCZSCyxi02PHl2bE903Mx5M",
                "created": 1760979226,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects classified as AGN (most probable class, lc_classifier), that:\n   - show variability in the r band (ExcessVar, fid=2 > 0), AND\n   - either have no detections in g (magstat.ndet for fid=1 = 0 or no magstat row)\n     OR show no variability in g (ExcessVar, fid=1 <= 0 or missing).\n   Returns all features (*) for the selected objects.\n   Ordering: primarily by oid (final query by oid), and secondarily by feature value ascending.\n*/\nWITH agn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.ranking = 1\n),\nr_variable_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 2  -- r band\n      AND f.value > 0\n),\ng_no_det_or_no_var_oids AS (\n    SELECT a.oid\n    FROM agn_oids a\n    WHERE\n        /* No detections in g band: ndet = 0 or no magstat row for fid=1 */\n        COALESCE((\n            SELECT m.ndet\n            FROM magstat m\n            WHERE m.oid = a.oid AND m.fid = 1\n            LIMIT 1\n        ), 0) = 0\n        OR\n        /* No variability in g band: ExcessVar <= 0 or missing */\n        COALESCE((\n            SELECT f.value\n            FROM feature f\n            WHERE f.oid = a.oid AND f.fid = 1 AND f.name = 'ExcessVar'\n            /* if multiple versions exist, pick any; absence is treated as 0 via COALESCE */\n            LIMIT 1\n        ), 0) <= 0\n),\nselected_oids AS (\n    SELECT oid\n    FROM agn_oids\n    WHERE oid IN (SELECT oid FROM r_variable_oids)\n      AND oid IN (SELECT oid FROM g_no_det_or_no_var_oids)\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM selected_oids)\nORDER BY oid ASC, value ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects classified as AGN (most probable class, lc_classifier), that:\n   - show variability in the r band (ExcessVar, fid=2 > 0), AND\n   - either have no detections in g (magstat.ndet for fid=1 = 0 or no magstat row)\n     OR show no variability in g (ExcessVar, fid=1 <= 0 or missing).\n   Returns all features (*) for the selected objects.\n   Ordering: primarily by oid (final query by oid), and secondarily by feature value ascending.\n*/\nWITH agn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.ranking = 1\n),\nr_variable_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 2  -- r band\n      AND f.value > 0\n),\ng_no_det_or_no_var_oids AS (\n    SELECT a.oid\n    FROM agn_oids a\n    WHERE\n        /* No detections in g band: ndet = 0 or no magstat row for fid=1 */\n        COALESCE((\n            SELECT m.ndet\n            FROM magstat m\n            WHERE m.oid = a.oid AND m.fid = 1\n            LIMIT 1\n        ), 0) = 0\n        OR\n        /* No variability in g band: ExcessVar <= 0 or missing */\n        COALESCE((\n            SELECT f.value\n            FROM feature f\n            WHERE f.oid = a.oid AND f.fid = 1 AND f.name = 'ExcessVar'\n            /* if multiple versions exist, pick any; absence is treated as 0 via COALESCE */\n            LIMIT 1\n        ), 0) <= 0\n),\nselected_oids AS (\n    SELECT oid\n    FROM agn_oids\n    WHERE oid IN (SELECT oid FROM r_variable_oids)\n      AND oid IN (SELECT oid FROM g_no_det_or_no_var_oids)\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM selected_oids)\nORDER BY oid ASC, value ASC;"
                },
                "in_toks": 5757,
                "out_toks": 3500,
                "id": "chatcmpl-CSoIFmIu86Sgpv1bW3Q66l7ZxFLE6",
                "created": 1760982547,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "17",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "taxonomy",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'magstat', 'feature']"
                },
                "in_toks": 629,
                "out_toks": 1175,
                "id": "chatcmpl-CSsSpk65ez952Be3nzdS0jZba5OYN",
                "created": 1760998579,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with top-1 AGN classification (lc_classifier), variable in r band, and either no detections in g or non-variable in g.\n-- Variability is approximated via Pvar >= 0.5 per band (fid=2 for r, fid=1 for g).\n-- Returns all features for the selected objects (SELECT * per default), ordered by oid, then by feature value ascending.\nSELECT *\nFROM feature f\nWHERE f.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      -- require r-band detections\n      AND EXISTS (\n          SELECT 1\n          FROM magstat msr\n          WHERE msr.oid = p.oid\n            AND msr.fid = 2  -- r band\n            AND msr.ndet > 0\n      )\n      -- require r-band variability (Pvar >= 0.5)\n      AND EXISTS (\n          SELECT 1\n          FROM feature fr\n          WHERE fr.oid = p.oid\n            AND fr.fid = 2  -- r band\n            AND fr.name = 'Pvar'\n            AND fr.value >= 0.5\n      )\n      -- enforce: either no g detections OR (g detections but NOT variable in g)\n      AND NOT EXISTS (\n          SELECT 1\n          FROM magstat msg\n          WHERE msg.oid = p.oid\n            AND msg.fid = 1  -- g band\n            AND msg.ndet > 0\n            AND EXISTS (\n                SELECT 1\n                FROM feature fg\n                WHERE fg.oid = p.oid\n                  AND fg.fid = 1  -- g band\n                  AND fg.name = 'Pvar'\n                  AND fg.value >= 0.5  -- would indicate variability in g; exclude those\n            )\n      )\n)\nORDER BY f.oid ASC, f.value ASC NULLS FIRST;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with top-1 AGN classification (lc_classifier), variable in r band, and either no detections in g or non-variable in g.\n-- Variability is approximated via Pvar >= 0.5 per band (fid=2 for r, fid=1 for g).\n-- Returns all features for the selected objects (SELECT * per default), ordered by oid, then by feature value ascending.\nSELECT *\nFROM feature f\nWHERE f.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      -- require r-band detections\n      AND EXISTS (\n          SELECT 1\n          FROM magstat msr\n          WHERE msr.oid = p.oid\n            AND msr.fid = 2  -- r band\n            AND msr.ndet > 0\n      )\n      -- require r-band variability (Pvar >= 0.5)\n      AND EXISTS (\n          SELECT 1\n          FROM feature fr\n          WHERE fr.oid = p.oid\n            AND fr.fid = 2  -- r band\n            AND fr.name = 'Pvar'\n            AND fr.value >= 0.5\n      )\n      -- enforce: either no g detections OR (g detections but NOT variable in g)\n      AND NOT EXISTS (\n          SELECT 1\n          FROM magstat msg\n          WHERE msg.oid = p.oid\n            AND msg.fid = 1  -- g band\n            AND msg.ndet > 0\n            AND EXISTS (\n                SELECT 1\n                FROM feature fg\n                WHERE fg.oid = p.oid\n                  AND fg.fid = 1  -- g band\n                  AND fg.name = 'Pvar'\n                  AND fg.value >= 0.5  -- would indicate variability in g; exclude those\n            )\n      )\n)\nORDER BY f.oid ASC, f.value ASC NULLS FIRST;"
                },
                "in_toks": 5275,
                "out_toks": 3504,
                "id": "chatcmpl-CSt2I0b7N2ZUHP0FnQucbMT1hgLGr",
                "created": 1761000778,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "17",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "taxonomy",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'magstat', 'feature']"
                },
                "in_toks": 629,
                "out_toks": 1367,
                "id": "chatcmpl-CSsTGVxOXtrkJNIGvShvNxm99QUmL",
                "created": 1760998606,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with top-ranked AGN classification (lc_classifier),\n-- variable in r band (ExcessVar > 0, fid=2),\n-- and either no g detections (no magstat with fid=1 and ndet>0)\n-- OR no variability in g band (no ExcessVar > 0 with fid=1).\n-- Return all features for the selected objects.\n\nSELECT *\nFROM feature\nWHERE oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'lc_classifier'\n       AND p.class_name = 'AGN'\n       AND p.ranking = 1\n       AND EXISTS\n         (SELECT 1\n          FROM feature fr\n          WHERE fr.oid = p.oid\n            AND fr.fid = 2\n            AND fr.name = 'ExcessVar'\n            AND fr.value > 0)\n       AND (NOT EXISTS\n              (SELECT 1\n               FROM magstat mg\n               WHERE mg.oid = p.oid\n                 AND mg.fid = 1\n                 AND mg.ndet > 0)\n            OR NOT EXISTS\n              (SELECT 1\n               FROM feature fg\n               WHERE fg.oid = p.oid\n                 AND fg.fid = 1\n                 AND fg.name = 'ExcessVar'\n                 AND fg.value > 0)))\nORDER BY oid ASC,\n         value ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with top-ranked AGN classification (lc_classifier),\n-- variable in r band (ExcessVar > 0, fid=2),\n-- and either no g detections (no magstat with fid=1 and ndet>0)\n-- OR no variability in g band (no ExcessVar > 0 with fid=1).\n-- Return all features for the selected objects.\n\nSELECT *\nFROM feature\nWHERE oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'lc_classifier'\n       AND p.class_name = 'AGN'\n       AND p.ranking = 1\n       AND EXISTS\n         (SELECT 1\n          FROM feature fr\n          WHERE fr.oid = p.oid\n            AND fr.fid = 2\n            AND fr.name = 'ExcessVar'\n            AND fr.value > 0)\n       AND (NOT EXISTS\n              (SELECT 1\n               FROM magstat mg\n               WHERE mg.oid = p.oid\n                 AND mg.fid = 1\n                 AND mg.ndet > 0)\n            OR NOT EXISTS\n              (SELECT 1\n               FROM feature fg\n               WHERE fg.oid = p.oid\n                 AND fg.fid = 1\n                 AND fg.name = 'ExcessVar'\n                 AND fg.value > 0)))\nORDER BY oid ASC,\n         value ASC;"
                },
                "in_toks": 5275,
                "out_toks": 3182,
                "id": "chatcmpl-CayF2NKfuYA61dPEMVvydr3tqRV6i",
                "created": 1762927412,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "17",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "taxonomy",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'magstat']"
                },
                "in_toks": 629,
                "out_toks": 1940,
                "id": "chatcmpl-CSsTX3PiUhFoVOWg5lEA9gDpfZ1A7",
                "created": 1760998623,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects whose most probable (ranking=1) lc_classifier class is AGN,\n-- that are variable in r band (fid=2; magsigma>0 and ndet>0),\n-- and have either no g-band detections or show no variability in g (i.e., no g row with ndet>0 AND magsigma>0).\n-- Ambiguity note: \"variability\" is interpreted here as magsigma > 0 in magstat (difference-magnitude dispersion).\n-- Result rows (features from magstat) are ordered by magsigma ascending, then by oid.\nSELECT\n    *\nFROM\n    magstat ms\nWHERE\n    ms.fid = 2\n    AND ms.ndet > 0\n    AND ms.magsigma IS NOT NULL\n    AND ms.magsigma > 0\n    AND ms.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.ranking = 1\n    )\n    AND NOT EXISTS (\n        SELECT 1\n        FROM magstat mg\n        WHERE mg.oid = ms.oid\n          AND mg.fid = 1\n          AND mg.ndet > 0\n          AND mg.magsigma IS NOT NULL\n          AND mg.magsigma > 0\n    )\nORDER BY\n    ms.magsigma ASC,\n    ms.oid ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects whose most probable (ranking=1) lc_classifier class is AGN,\n-- that are variable in r band (fid=2; magsigma>0 and ndet>0),\n-- and have either no g-band detections or show no variability in g (i.e., no g row with ndet>0 AND magsigma>0).\n-- Ambiguity note: \"variability\" is interpreted here as magsigma > 0 in magstat (difference-magnitude dispersion).\n-- Result rows (features from magstat) are ordered by magsigma ascending, then by oid.\nSELECT\n    *\nFROM\n    magstat ms\nWHERE\n    ms.fid = 2\n    AND ms.ndet > 0\n    AND ms.magsigma IS NOT NULL\n    AND ms.magsigma > 0\n    AND ms.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.ranking = 1\n    )\n    AND NOT EXISTS (\n        SELECT 1\n        FROM magstat mg\n        WHERE mg.oid = ms.oid\n          AND mg.fid = 1\n          AND mg.ndet > 0\n          AND mg.magsigma IS NOT NULL\n          AND mg.magsigma > 0\n    )\nORDER BY\n    ms.magsigma ASC,\n    ms.oid ASC;"
                },
                "in_toks": 2843,
                "out_toks": 2614,
                "id": "chatcmpl-CSsxYKM12guUEZpLB0GoQCiRhmCgr",
                "created": 1761000484,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "17",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat', 'feature']"
                },
                "in_toks": 629,
                "out_toks": 1812,
                "id": "chatcmpl-CZM6UVCscqIGLPxOBq7LaFLwRKz5N",
                "created": 1762542482,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects whose top lc_classifier class is AGN */\nSELECT\n    /* return all r-band features for the selected objects */\n    f.*\nFROM feature f\nWHERE f.fid = 2 /* r band */\n  AND f.oid IN (\n      /* OIDs classified as AGN (top-ranked) by the Light Curve classifier */\n      SELECT p.oid\n      FROM probability p\n      WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'AGN'\n        AND p.ranking = 1\n        /* r-band variability: ExcessVar > 0 in r (fid=2) */\n        AND p.oid IN (\n            SELECT f2.oid\n            FROM feature f2\n            WHERE f2.fid = 2\n              AND f2.name = 'ExcessVar'\n              AND f2.value > 0\n        )\n        /* g-band condition: no detections OR non-variable in g (fid=1) */\n        AND (\n            /* no detections in g band (either no magstat row or ndet=0) */\n            NOT EXISTS (\n                SELECT 1\n                FROM magstat m\n                WHERE m.oid = p.oid\n                  AND m.fid = 1\n                  AND m.ndet > 0\n            )\n            /* OR: has g-band feature ExcessVar <= 0 (non-variable) */\n            OR EXISTS (\n                SELECT 1\n                FROM feature f3\n                WHERE f3.oid = p.oid\n                  AND f3.fid = 1\n                  AND f3.name = 'ExcessVar'\n                  AND COALESCE(f3.value, 0) <= 0\n            )\n        )\n  )\n/* final ordering: by object id, and within each object order features by value ascending */\nORDER BY f.oid ASC, f.value ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects whose top lc_classifier class is AGN */\nSELECT\n    /* return all r-band features for the selected objects */\n    f.*\nFROM feature f\nWHERE f.fid = 2 /* r band */\n  AND f.oid IN (\n      /* OIDs classified as AGN (top-ranked) by the Light Curve classifier */\n      SELECT p.oid\n      FROM probability p\n      WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'AGN'\n        AND p.ranking = 1\n        /* r-band variability: ExcessVar > 0 in r (fid=2) */\n        AND p.oid IN (\n            SELECT f2.oid\n            FROM feature f2\n            WHERE f2.fid = 2\n              AND f2.name = 'ExcessVar'\n              AND f2.value > 0\n        )\n        /* g-band condition: no detections OR non-variable in g (fid=1) */\n        AND (\n            /* no detections in g band (either no magstat row or ndet=0) */\n            NOT EXISTS (\n                SELECT 1\n                FROM magstat m\n                WHERE m.oid = p.oid\n                  AND m.fid = 1\n                  AND m.ndet > 0\n            )\n            /* OR: has g-band feature ExcessVar <= 0 (non-variable) */\n            OR EXISTS (\n                SELECT 1\n                FROM feature f3\n                WHERE f3.oid = p.oid\n                  AND f3.fid = 1\n                  AND f3.name = 'ExcessVar'\n                  AND COALESCE(f3.value, 0) <= 0\n            )\n        )\n  )\n/* final ordering: by object id, and within each object order features by value ascending */\nORDER BY f.oid ASC, f.value ASC;"
                },
                "in_toks": 5230,
                "out_toks": 3915,
                "id": "chatcmpl-CZRNMslIzu7hGj7BK47CaQK5Qnekh",
                "created": 1762562748,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "17",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability",
                "taxonomy",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'magstat', 'feature']"
                },
                "in_toks": 629,
                "out_toks": 1431,
                "id": "chatcmpl-CZM7CU01sbUzWRRI3QItJrdnaWlVx",
                "created": 1762542526,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects with top-1 lc_classifier = 'AGN', variable in r-band (ExcessVar fid=2 > 0), and either no g-band detections (ndet=0) or non-variable in g-band (ExcessVar fid=1 <= 0 or NULL).\n   Returns all features for those objects. Ordered by oid, then feature value ascending. */\nSELECT *\nFROM feature\nWHERE oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'lc_classifier'\n       AND p.class_name = 'AGN'\n       AND p.ranking = 1\n       AND p.oid IN\n         (SELECT oid\n          FROM feature\n          WHERE name = 'ExcessVar'\n            AND fid = 2\n            AND value > 0)\n       AND p.oid IN\n         (SELECT oid\n          FROM magstat\n          WHERE fid = 1\n            AND ndet = 0\n          UNION SELECT oid\n          FROM feature\n          WHERE name = 'ExcessVar'\n            AND fid = 1\n            AND (value <= 0\n                 OR value IS NULL)))\nORDER BY oid,\n         value ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects with top-1 lc_classifier = 'AGN', variable in r-band (ExcessVar fid=2 > 0), and either no g-band detections (ndet=0) or non-variable in g-band (ExcessVar fid=1 <= 0 or NULL).\n   Returns all features for those objects. Ordered by oid, then feature value ascending. */\nSELECT *\nFROM feature\nWHERE oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'lc_classifier'\n       AND p.class_name = 'AGN'\n       AND p.ranking = 1\n       AND p.oid IN\n         (SELECT oid\n          FROM feature\n          WHERE name = 'ExcessVar'\n            AND fid = 2\n            AND value > 0)\n       AND p.oid IN\n         (SELECT oid\n          FROM magstat\n          WHERE fid = 1\n            AND ndet = 0\n          UNION SELECT oid\n          FROM feature\n          WHERE name = 'ExcessVar'\n            AND fid = 1\n            AND (value <= 0\n                 OR value IS NULL)))\nORDER BY oid,\n         value ASC;"
                },
                "in_toks": 5275,
                "out_toks": 3248,
                "id": "chatcmpl-CayFijQ3esuKeLls9wAwiJlU04k1T",
                "created": 1762927454,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "17",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability",
                "taxonomy",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'magstat', 'feature']"
                },
                "in_toks": 629,
                "out_toks": 1943,
                "id": "chatcmpl-CZM7vAi9ekxqaDCxkOnS2BTCu2Ng5",
                "created": 1762542571,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH agn_oids AS\n  (-- OIDs whose top lc_classifier class is AGN\n SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.ranking = 1),\n     r_var AS\n  (-- OIDs showing variability in r band (fid=2) via ExcessVar > 0\n SELECT DISTINCT f.oid\n   FROM feature f\n   WHERE f.name = 'ExcessVar'\n     AND f.fid = 2\n     AND f.value > 0\n     AND f.oid IN\n       (SELECT oid\n        FROM agn_oids)),\n     filtered_oids AS\n  (-- Keep OIDs that either have no g-band detections OR show no g-band variability\n SELECT o.oid\n   FROM r_var o\n   WHERE NOT EXISTS\n       (SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1\n          AND m.ndet > 0)\n     OR NOT EXISTS\n       (SELECT 1\n        FROM feature fg\n        WHERE fg.oid = o.oid\n          AND fg.fid = 1\n          AND fg.name = 'ExcessVar'\n          AND fg.value > 0)) -- Return all features for the selected objects\n\nSELECT *\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM filtered_oids)\nORDER BY f.oid,\n         f.value ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH agn_oids AS\n  (-- OIDs whose top lc_classifier class is AGN\n SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.ranking = 1),\n     r_var AS\n  (-- OIDs showing variability in r band (fid=2) via ExcessVar > 0\n SELECT DISTINCT f.oid\n   FROM feature f\n   WHERE f.name = 'ExcessVar'\n     AND f.fid = 2\n     AND f.value > 0\n     AND f.oid IN\n       (SELECT oid\n        FROM agn_oids)),\n     filtered_oids AS\n  (-- Keep OIDs that either have no g-band detections OR show no g-band variability\n SELECT o.oid\n   FROM r_var o\n   WHERE NOT EXISTS\n       (SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1\n          AND m.ndet > 0)\n     OR NOT EXISTS\n       (SELECT 1\n        FROM feature fg\n        WHERE fg.oid = o.oid\n          AND fg.fid = 1\n          AND fg.name = 'ExcessVar'\n          AND fg.value > 0)) -- Return all features for the selected objects\n\nSELECT *\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM filtered_oids)\nORDER BY f.oid,\n         f.value ASC;"
                },
                "in_toks": 5275,
                "out_toks": 3782,
                "id": "chatcmpl-CayGNYCFIyWwlJbCiIoBERb4fprsc",
                "created": 1762927495,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "17",
            "experiment_id": "run_8",
            "pred_tables": [
                "probability",
                "taxonomy",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'magstat', 'feature']"
                },
                "in_toks": 629,
                "out_toks": 1175,
                "id": "chatcmpl-CZM8T4Dw3RKLJrUDH8EWCAukhpUEV",
                "created": 1762542605,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects classified as AGN (most probable class from lc_classifier) \n-- that show variability in r band (ExcessVar > 0 in fid=2),\n-- and either have no detections in g band (no magstat with ndet>0 for fid=1)\n-- OR show no variability in g band (no ExcessVar > 0 in fid=1).\n-- Returns all feature rows for the selected objects, ordered by oid then feature value.\n-- Note: Variability is interpreted via ExcessVar > 0 per band. \n-- If you prefer using Pvar, replace the ExcessVar tests with Pvar and a chosen threshold.\nSELECT *\nFROM feature f\nWHERE f.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.ranking = 1\n)\nAND EXISTS (\n    SELECT 1\n    FROM feature fr\n    WHERE fr.oid = f.oid\n      AND fr.fid = 2 -- r band\n      AND fr.name = 'ExcessVar'\n      AND fr.value > 0\n)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat mg\n        WHERE mg.oid = f.oid\n          AND mg.fid = 1 -- g band\n          AND mg.ndet > 0\n    )\n    OR NOT EXISTS (\n        SELECT 1\n        FROM feature fg\n        WHERE fg.oid = f.oid\n          AND fg.fid = 1 -- g band\n          AND fg.name = 'ExcessVar'\n          AND fg.value > 0\n    )\n)\nORDER BY f.oid ASC, f.value ASC NULLS LAST;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects classified as AGN (most probable class from lc_classifier) \n-- that show variability in r band (ExcessVar > 0 in fid=2),\n-- and either have no detections in g band (no magstat with ndet>0 for fid=1)\n-- OR show no variability in g band (no ExcessVar > 0 in fid=1).\n-- Returns all feature rows for the selected objects, ordered by oid then feature value.\n-- Note: Variability is interpreted via ExcessVar > 0 per band. \n-- If you prefer using Pvar, replace the ExcessVar tests with Pvar and a chosen threshold.\nSELECT *\nFROM feature f\nWHERE f.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.ranking = 1\n)\nAND EXISTS (\n    SELECT 1\n    FROM feature fr\n    WHERE fr.oid = f.oid\n      AND fr.fid = 2 -- r band\n      AND fr.name = 'ExcessVar'\n      AND fr.value > 0\n)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat mg\n        WHERE mg.oid = f.oid\n          AND mg.fid = 1 -- g band\n          AND mg.ndet > 0\n    )\n    OR NOT EXISTS (\n        SELECT 1\n        FROM feature fg\n        WHERE fg.oid = f.oid\n          AND fg.fid = 1 -- g band\n          AND fg.name = 'ExcessVar'\n          AND fg.value > 0\n    )\n)\nORDER BY f.oid ASC, f.value ASC NULLS LAST;"
                },
                "in_toks": 5275,
                "out_toks": 3635,
                "id": "chatcmpl-CZRJpGqwYJNyUFDqgJxf0mAuoOxXg",
                "created": 1762562529,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "17",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability",
                "feature",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'magstat']"
                },
                "in_toks": 629,
                "out_toks": 1556,
                "id": "chatcmpl-CZM8psfsG4aWtul5JsUUkD8KQa0eY",
                "created": 1762542627,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects classified as AGN by the lc_classifier (top-1 class),\n   that show variability in r band (ExcessVar fid=2 > 0),\n   and either have no detections in g (no magstat with ndet>0 for fid=1)\n   OR show no variability in g (ExcessVar fid=1 <= 0).\n   Return all features for those objects, ordered by oid then by feature value ASC. */\nWITH agn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.ranking = 1\n),\nr_var_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 2  -- r band\n      AND f.value > 0\n),\ng_non_det_or_non_var_oids AS (\n    SELECT o.oid\n    FROM agn_oids o\n    WHERE\n        /* No detections in g band (there is no magstat row with ndet > 0) */\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m\n            WHERE m.oid = o.oid\n              AND m.fid = 1  -- g band\n              AND m.ndet > 0\n        )\n        OR\n        /* Or: explicitly non-variable in g band (ExcessVar <= 0) */\n        EXISTS (\n            SELECT 1\n            FROM feature f\n            WHERE f.oid = o.oid\n              AND f.fid = 1  -- g band\n              AND f.name = 'ExcessVar'\n              AND (f.value <= 0 OR f.value IS NULL)\n        )\n),\nselected_oids AS (\n    SELECT oid\n    FROM agn_oids\n    WHERE oid IN (SELECT oid FROM r_var_oids)\n      AND oid IN (SELECT oid FROM g_non_det_or_non_var_oids)\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM selected_oids)\nORDER BY oid ASC, value ASC NULLS FIRST;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects classified as AGN by the lc_classifier (top-1 class),\n   that show variability in r band (ExcessVar fid=2 > 0),\n   and either have no detections in g (no magstat with ndet>0 for fid=1)\n   OR show no variability in g (ExcessVar fid=1 <= 0).\n   Return all features for those objects, ordered by oid then by feature value ASC. */\nWITH agn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.ranking = 1\n),\nr_var_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 2  -- r band\n      AND f.value > 0\n),\ng_non_det_or_non_var_oids AS (\n    SELECT o.oid\n    FROM agn_oids o\n    WHERE\n        /* No detections in g band (there is no magstat row with ndet > 0) */\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m\n            WHERE m.oid = o.oid\n              AND m.fid = 1  -- g band\n              AND m.ndet > 0\n        )\n        OR\n        /* Or: explicitly non-variable in g band (ExcessVar <= 0) */\n        EXISTS (\n            SELECT 1\n            FROM feature f\n            WHERE f.oid = o.oid\n              AND f.fid = 1  -- g band\n              AND f.name = 'ExcessVar'\n              AND (f.value <= 0 OR f.value IS NULL)\n        )\n),\nselected_oids AS (\n    SELECT oid\n    FROM agn_oids\n    WHERE oid IN (SELECT oid FROM r_var_oids)\n      AND oid IN (SELECT oid FROM g_non_det_or_non_var_oids)\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM selected_oids)\nORDER BY oid ASC, value ASC NULLS FIRST;"
                },
                "in_toks": 5230,
                "out_toks": 3467,
                "id": "chatcmpl-CZRKhq5EsTa8COrkt1JGEpvGCr8vj",
                "created": 1762562583,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "37": {
        "0": {
            "req_id": "37",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']",
                    "1": "['probability', 'taxonomy']"
                },
                "in_toks": 615,
                "out_toks": 1184,
                "id": "chatcmpl-CSnR2X2auYn6KmFcrUu5Ak5pyU47k",
                "created": 1760979248,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top 200 objects classified as SNIa by the Light Curve classifier (lc_classifier), using the top-ranked class per object.\n-- We first determine, per oid, the row with the highest SNIa probability where ranking=1, then take the 200 oids with the largest such probabilities.\n-- Finally, we return the full probability rows for those oids, ordered by probability descending.\n\nWITH sniabest AS (\n    SELECT DISTINCT ON (oid) oid, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1\n    ORDER BY oid, probability DESC\n),\ntop_oids AS (\n    SELECT oid\n    FROM sniabest\n    ORDER BY probability DESC\n    LIMIT 200\n),\nbest_rows AS (\n    SELECT DISTINCT ON (p.oid) p.*\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM top_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'SNIa'\n      AND p.ranking = 1\n    ORDER BY p.oid, p.probability DESC\n)\nSELECT *\nFROM best_rows\nORDER BY probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top 200 objects classified as SNIa by the Light Curve classifier (lc_classifier), using the top-ranked class per object.\n-- We first determine, per oid, the row with the highest SNIa probability where ranking=1, then take the 200 oids with the largest such probabilities.\n-- Finally, we return the full probability rows for those oids, ordered by probability descending.\n\nWITH sniabest AS (\n    SELECT DISTINCT ON (oid) oid, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1\n    ORDER BY oid, probability DESC\n),\ntop_oids AS (\n    SELECT oid\n    FROM sniabest\n    ORDER BY probability DESC\n    LIMIT 200\n),\nbest_rows AS (\n    SELECT DISTINCT ON (p.oid) p.*\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM top_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'SNIa'\n      AND p.ranking = 1\n    ORDER BY p.oid, p.probability DESC\n)\nSELECT *\nFROM best_rows\nORDER BY probability DESC;"
                },
                "in_toks": 2113,
                "out_toks": 3017,
                "id": "chatcmpl-CSoIuZrYJVBjvWSy0umnZ8jWbN11q",
                "created": 1760982588,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "37",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']",
                    "1": "['probability', 'taxonomy']"
                },
                "in_toks": 615,
                "out_toks": 1184,
                "id": "chatcmpl-CSnR2X2auYn6KmFcrUu5Ak5pyU47k",
                "created": 1760979248,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top 200 unique objects classified as SNIa by the light curve classifier (ranking=1),\n-- ordered by probability in descending order. DISTINCT ON ensures one row per oid\nWITH snias AS (\n  SELECT DISTINCT ON (oid) *\n  FROM probability\n  WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'SNIa'\n    AND ranking = 1\n  ORDER BY oid, probability DESC\n)\nSELECT *\nFROM snias\nORDER BY probability DESC\nLIMIT 200;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top 200 unique objects classified as SNIa by the light curve classifier (ranking=1),\n-- ordered by probability in descending order. DISTINCT ON ensures one row per oid\nWITH snias AS (\n  SELECT DISTINCT ON (oid) *\n  FROM probability\n  WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'SNIa'\n    AND ranking = 1\n  ORDER BY oid, probability DESC\n)\nSELECT *\nFROM snias\nORDER BY probability DESC\nLIMIT 200;"
                },
                "in_toks": 2113,
                "out_toks": 2867,
                "id": "chatcmpl-CSoJK7ZL2vXrJRGWwzzTWjRADkOYm",
                "created": 1760982614,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "37",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 615,
                "out_toks": 784,
                "id": "chatcmpl-CSsUA7bo17TxsrP8xHQWcGjaSwjaj",
                "created": 1760998662,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top 200 objects whose most probable lc_classifier class is SNIa, ordered by probability DESC\nWITH top_snia AS (\n  SELECT oid, classifier_version, probability\n  FROM (\n    SELECT\n      oid,\n      classifier_version,\n      probability,\n      row_number() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1  -- ensure SNIa is the assigned (top-ranked) class\n  ) t\n  WHERE rn = 1\n  ORDER BY probability DESC\n  LIMIT 200\n)\nSELECT p.*\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'SNIa'\n  AND p.ranking = 1\n  AND (p.oid, p.classifier_version) IN (SELECT oid, classifier_version FROM top_snia)\nORDER BY p.probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top 200 objects whose most probable lc_classifier class is SNIa, ordered by probability DESC\nWITH top_snia AS (\n  SELECT oid, classifier_version, probability\n  FROM (\n    SELECT\n      oid,\n      classifier_version,\n      probability,\n      row_number() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1  -- ensure SNIa is the assigned (top-ranked) class\n  ) t\n  WHERE rn = 1\n  ORDER BY probability DESC\n  LIMIT 200\n)\nSELECT p.*\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'SNIa'\n  AND p.ranking = 1\n  AND (p.oid, p.classifier_version) IN (SELECT oid, classifier_version FROM top_snia)\nORDER BY p.probability DESC;"
                },
                "in_toks": 2113,
                "out_toks": 2647,
                "id": "chatcmpl-CSsxYFCPpVj8YaWNrHSnWE8Et0yBF",
                "created": 1761000484,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "37",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 615,
                "out_toks": 336,
                "id": "chatcmpl-CSsUM8Aunb22j8cR5iKrRXKsRwqYV",
                "created": 1760998674,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top 200 objects classified as SNIa by the light curve classifier (ranking=1), ordered by probability DESC\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND class_name = 'SNIa'\n  AND ranking = 1\n  AND (oid, probability) IN (\n    SELECT oid, probability\n    FROM (\n      SELECT\n        oid,\n        probability,\n        row_number() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n        AND class_name = 'SNIa'\n        AND ranking = 1\n    ) t\n    WHERE rn = 1\n    ORDER BY probability DESC\n    LIMIT 200\n  )\nORDER BY probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top 200 objects classified as SNIa by the light curve classifier (ranking=1), ordered by probability DESC\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND class_name = 'SNIa'\n  AND ranking = 1\n  AND (oid, probability) IN (\n    SELECT oid, probability\n    FROM (\n      SELECT\n        oid,\n        probability,\n        row_number() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n        AND class_name = 'SNIa'\n        AND ranking = 1\n    ) t\n    WHERE rn = 1\n    ORDER BY probability DESC\n    LIMIT 200\n  )\nORDER BY probability DESC;"
                },
                "in_toks": 2113,
                "out_toks": 2472,
                "id": "chatcmpl-CSsxYxt3HwH6cSoLakLU1FuJwDVK1",
                "created": 1761000484,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "37",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 615,
                "out_toks": 464,
                "id": "chatcmpl-CSsUSf1fcvdhvVVe8bw6LzpagqDgL",
                "created": 1760998680,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top 200 objects classified as SNIa by the light curve classifier (lc_classifier)\n-- Ensures the class is the top-ranked (ranking = 1) per object and selects the max probability per oid across versions\nWITH best_per_oid AS (\n  SELECT p.*\n  FROM probability p\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'SNIa'\n    AND p.ranking = 1\n    AND p.probability = (\n      SELECT MAX(p2.probability)\n      FROM probability p2\n      WHERE p2.oid = p.oid\n        AND p2.classifier_name = 'lc_classifier'\n        AND p2.class_name = 'SNIa'\n        AND p2.ranking = 1\n    )\n),\ntop200 AS (\n  SELECT oid\n  FROM best_per_oid\n  ORDER BY probability DESC\n  LIMIT 200\n)\nSELECT *\nFROM best_per_oid\nWHERE oid IN (SELECT oid FROM top200)\nORDER BY probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top 200 objects classified as SNIa by the light curve classifier (lc_classifier)\n-- Ensures the class is the top-ranked (ranking = 1) per object and selects the max probability per oid across versions\nWITH best_per_oid AS (\n  SELECT p.*\n  FROM probability p\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'SNIa'\n    AND p.ranking = 1\n    AND p.probability = (\n      SELECT MAX(p2.probability)\n      FROM probability p2\n      WHERE p2.oid = p.oid\n        AND p2.classifier_name = 'lc_classifier'\n        AND p2.class_name = 'SNIa'\n        AND p2.ranking = 1\n    )\n),\ntop200 AS (\n  SELECT oid\n  FROM best_per_oid\n  ORDER BY probability DESC\n  LIMIT 200\n)\nSELECT *\nFROM best_per_oid\nWHERE oid IN (SELECT oid FROM top200)\nORDER BY probability DESC;"
                },
                "in_toks": 2113,
                "out_toks": 2524,
                "id": "chatcmpl-CSsxzkV6Nu1LwEgG1vzyP5nx13eAA",
                "created": 1761000511,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "37",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 615,
                "out_toks": 784,
                "id": "chatcmpl-CZM9PbQjxJimSPDwXrPECpBrDtQOA",
                "created": 1762542663,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top 200 objects whose most probable lc_classifier class is SNIa, ordered by probability DESC\nWITH best_per_oid AS (\n    SELECT DISTINCT ON (oid) *\n    FROM probability\n    WHERE class_name = 'SNIa'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1  -- ensure SNIa is the top-ranked class for the object\n    ORDER BY oid, probability DESC  -- keep the highest-probability version per oid\n)\nSELECT *\nFROM best_per_oid\nORDER BY probability DESC\nLIMIT 200;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top 200 objects whose most probable lc_classifier class is SNIa, ordered by probability DESC\nWITH best_per_oid AS (\n    SELECT DISTINCT ON (oid) *\n    FROM probability\n    WHERE class_name = 'SNIa'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1  -- ensure SNIa is the top-ranked class for the object\n    ORDER BY oid, probability DESC  -- keep the highest-probability version per oid\n)\nSELECT *\nFROM best_per_oid\nORDER BY probability DESC\nLIMIT 200;"
                },
                "in_toks": 2113,
                "out_toks": 2364,
                "id": "chatcmpl-CZRLAwLlWXkkBxMv8bUYaS6uS2ans",
                "created": 1762562612,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "37",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 615,
                "out_toks": 525,
                "id": "chatcmpl-CZM9m7ljmtYItVm8gxikbwg6B711M",
                "created": 1762542686,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top 200 objects classified as SNIa by the Light Curve classifier (lc_classifier), sorted by probability DESC\nWITH top_oids AS\n  (SELECT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND class_name = 'SNIa'\n     AND ranking = 1 -- ensure SNIa is the top-ranked class for the object/version\n\n   GROUP BY oid\n   ORDER BY max(probability) DESC\n   LIMIT 200)\nSELECT *\nFROM\n  (SELECT DISTINCT ON (oid) *\n   FROM probability\n   WHERE oid IN\n       (SELECT oid\n        FROM top_oids)\n     AND classifier_name = 'lc_classifier'\n     AND class_name = 'SNIa'\n     AND ranking = 1\n   ORDER BY oid,\n            probability DESC -- pick the highest-probability version per object\n) t\nORDER BY probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top 200 objects classified as SNIa by the Light Curve classifier (lc_classifier), sorted by probability DESC\nWITH top_oids AS\n  (SELECT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND class_name = 'SNIa'\n     AND ranking = 1 -- ensure SNIa is the top-ranked class for the object/version\n\n   GROUP BY oid\n   ORDER BY max(probability) DESC\n   LIMIT 200)\nSELECT *\nFROM\n  (SELECT DISTINCT ON (oid) *\n   FROM probability\n   WHERE oid IN\n       (SELECT oid\n        FROM top_oids)\n     AND classifier_name = 'lc_classifier'\n     AND class_name = 'SNIa'\n     AND ranking = 1\n   ORDER BY oid,\n            probability DESC -- pick the highest-probability version per object\n) t\nORDER BY probability DESC;"
                },
                "in_toks": 2068,
                "out_toks": 2941,
                "id": "chatcmpl-CayH2vdb8AOfgwMyb6M2vedf18g8Z",
                "created": 1762927536,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "37",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 615,
                "out_toks": 1104,
                "id": "chatcmpl-CZM9u5gJPxeZqLgcVIJdpAMCbPvQs",
                "created": 1762542694,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Top 200 objects classified as SNIa by the light curve classifier (lc_classifier)\n   - We treat \"classified SNIa\" as the top-ranked class for the object (ranking = 1).\n   - If multiple classifier_versions exist, we pick the row with the highest probability per oid.\n   - Results ordered by probability descending.\n*/\nWITH top_snia AS (\n    SELECT oid, MAX(probability) AS max_prob\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1\n    GROUP BY oid\n    ORDER BY MAX(probability) DESC\n    LIMIT 200\n)\nSELECT p.*\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'SNIa'\n  AND p.ranking = 1\n  AND (p.oid, p.probability) IN (SELECT oid, max_prob FROM top_snia)\nORDER BY p.probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Top 200 objects classified as SNIa by the light curve classifier (lc_classifier)\n   - We treat \"classified SNIa\" as the top-ranked class for the object (ranking = 1).\n   - If multiple classifier_versions exist, we pick the row with the highest probability per oid.\n   - Results ordered by probability descending.\n*/\nWITH top_snia AS (\n    SELECT oid, MAX(probability) AS max_prob\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1\n    GROUP BY oid\n    ORDER BY MAX(probability) DESC\n    LIMIT 200\n)\nSELECT p.*\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'SNIa'\n  AND p.ranking = 1\n  AND (p.oid, p.probability) IN (SELECT oid, max_prob FROM top_snia)\nORDER BY p.probability DESC;"
                },
                "in_toks": 2113,
                "out_toks": 2778,
                "id": "chatcmpl-CZRN19Hw4RvDugW7sxfiUXWwzwLbC",
                "created": 1762562727,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "37",
            "experiment_id": "run_8",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 615,
                "out_toks": 781,
                "id": "chatcmpl-CZMAI0g1PVCcdfanvBrvYIJFpUaPB",
                "created": 1762542718,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top 200 objects whose most probable class (ranking=1) is SNIa according to the light curve classifier,\n-- ordered by probability DESC. We select one row per object (the highest-probability version if multiple exist).\nWITH sni_rank1 AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1\n),\ntop_oids AS (\n    SELECT oid\n    FROM (\n        SELECT oid, max(probability) AS max_prob\n        FROM sni_rank1\n        GROUP BY oid\n    ) t\n    ORDER BY max_prob DESC\n    LIMIT 200\n)\nSELECT *\nFROM (\n    SELECT DISTINCT ON (p.oid) p.*\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM top_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'SNIa'\n      AND p.ranking = 1\n    ORDER BY p.oid, p.probability DESC\n) q\nORDER BY probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top 200 objects whose most probable class (ranking=1) is SNIa according to the light curve classifier,\n-- ordered by probability DESC. We select one row per object (the highest-probability version if multiple exist).\nWITH sni_rank1 AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n      AND ranking = 1\n),\ntop_oids AS (\n    SELECT oid\n    FROM (\n        SELECT oid, max(probability) AS max_prob\n        FROM sni_rank1\n        GROUP BY oid\n    ) t\n    ORDER BY max_prob DESC\n    LIMIT 200\n)\nSELECT *\nFROM (\n    SELECT DISTINCT ON (p.oid) p.*\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM top_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'SNIa'\n      AND p.ranking = 1\n    ORDER BY p.oid, p.probability DESC\n) q\nORDER BY probability DESC;"
                },
                "in_toks": 2068,
                "out_toks": 2736,
                "id": "chatcmpl-CZRAME7SU0E6mpNIl6mlAO6waNqf0",
                "created": 1762561942,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "37",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 615,
                "out_toks": 592,
                "id": "chatcmpl-CZMAbxEAe2yLvrRflfpFYh8B4LBGA",
                "created": 1762542737,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Top 200 unique objects classified as SNIa by the Light Curve classifier (ranking=1),\n-- ordered by their highest probability across versions in descending order.\n\nSELECT *\nFROM\n  (SELECT DISTINCT ON (s.oid) s.oid,\n                      s.probability,\n                      s.classifier_version\n   FROM probability AS s\n   JOIN\n     (-- Highest SNIa probability per object (restricting to lc_classifier and ranking=1)\n SELECT oid,\n        MAX(probability) AS max_prob\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n        AND class_name = 'SNIa'\n        AND ranking = 1\n      GROUP BY oid) AS m ON m.oid = s.oid\n   AND m.max_prob = s.probability\n   WHERE s.classifier_name = 'lc_classifier'\n     AND s.class_name = 'SNIa'\n     AND s.ranking = 1\n   ORDER BY s.oid,\n            s.probability DESC) AS t\nORDER BY t.probability DESC\nLIMIT 200;",
            "sql_response": {
                "responses": {
                    "0": "-- Top 200 unique objects classified as SNIa by the Light Curve classifier (ranking=1),\n-- ordered by their highest probability across versions in descending order.\n\nSELECT *\nFROM\n  (SELECT DISTINCT ON (s.oid) s.oid,\n                      s.probability,\n                      s.classifier_version\n   FROM probability AS s\n   JOIN\n     (-- Highest SNIa probability per object (restricting to lc_classifier and ranking=1)\n SELECT oid,\n        MAX(probability) AS max_prob\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n        AND class_name = 'SNIa'\n        AND ranking = 1\n      GROUP BY oid) AS m ON m.oid = s.oid\n   AND m.max_prob = s.probability\n   WHERE s.classifier_name = 'lc_classifier'\n     AND s.class_name = 'SNIa'\n     AND s.ranking = 1\n   ORDER BY s.oid,\n            s.probability DESC) AS t\nORDER BY t.probability DESC\nLIMIT 200;"
                },
                "in_toks": 1010,
                "out_toks": 2858,
                "id": "chatcmpl-Cb9PUxwyimbEXRyTaW4ygY3VZwGgQ",
                "created": 1762970344,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top 200 unique objects (one row per oid) classified as SNIa by the Light Curve classifier,\n-- ordered by their highest available probability in descending order.\n-- DISTINCT ON selects the highest-probability row per oid (across classifier_version),\n-- then the outer ORDER BY + LIMIT picks the top 200 objects overall.\nSELECT *\nFROM (\n    SELECT DISTINCT ON (oid) *\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n    ORDER BY oid, probability DESC\n) AS t\nORDER BY probability DESC\nLIMIT 200;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top 200 unique objects (one row per oid) classified as SNIa by the Light Curve classifier,\n-- ordered by their highest available probability in descending order.\n-- DISTINCT ON selects the highest-probability row per oid (across classifier_version),\n-- then the outer ORDER BY + LIMIT picks the top 200 objects overall.\nSELECT *\nFROM (\n    SELECT DISTINCT ON (oid) *\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'SNIa'\n    ORDER BY oid, probability DESC\n) AS t\nORDER BY probability DESC\nLIMIT 200;"
                },
                "in_toks": 2113,
                "out_toks": 2629,
                "id": "chatcmpl-CZT1SuMMdt2YFTDnYpL6Z8zQVZgXd",
                "created": 1762569078,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        }
    },
    "34": {
        "0": {
            "req_id": "34",
            "experiment_id": "run_0",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']",
                    "1": "['feature']"
                },
                "in_toks": 704,
                "out_toks": 1176,
                "id": "chatcmpl-CSnRDc2zssFOaFaoebOh07xzzCwnh",
                "created": 1760979259,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all rows in the feature table for the requested objects and features\n-- Note: This returns all bands (fid) and all feature versions available\nWITH oids_list(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n),\nfeat_names(name) AS (\n    VALUES\n        ('Amplitude'),\n        ('Multiband_period')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM oids_list)\n  AND name IN (SELECT name FROM feat_names)\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all rows in the feature table for the requested objects and features\n-- Note: This returns all bands (fid) and all feature versions available\nWITH oids_list(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n),\nfeat_names(name) AS (\n    VALUES\n        ('Amplitude'),\n        ('Multiband_period')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM oids_list)\n  AND name IN (SELECT name FROM feat_names)\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4404,
                "out_toks": 1037,
                "id": "chatcmpl-CSoJlptV04KWFHhyHUFBsQqTFmoyx",
                "created": 1760982641,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "34",
            "experiment_id": "run_1",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']",
                    "1": "['feature']"
                },
                "in_toks": 704,
                "out_toks": 1176,
                "id": "chatcmpl-CSnRDc2zssFOaFaoebOh07xzzCwnh",
                "created": 1760979259,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all feature rows for the specified objects where the feature name is either 'Amplitude' or 'Multiband_period'\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM input_oids)\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all feature rows for the specified objects where the feature name is either 'Amplitude' or 'Multiband_period'\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM input_oids)\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4404,
                "out_toks": 1012,
                "id": "chatcmpl-CSoK1yUTemxtEBVcVVxHT5BycYGNc",
                "created": 1760982657,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "34",
            "experiment_id": "run_2",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']"
                },
                "in_toks": 704,
                "out_toks": 396,
                "id": "chatcmpl-CSsUc5QQv6xkxNbcBcZQiyfAHB2LL",
                "created": 1760998690,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all feature rows for the given OIDs, limited to 'Amplitude' and 'Multiband_period'\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all feature rows for the given OIDs, limited to 'Amplitude' and 'Multiband_period'\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4404,
                "out_toks": 818,
                "id": "chatcmpl-CSsy6qj9nsne3WHMezYR0UsvDgtn4",
                "created": 1761000518,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "34",
            "experiment_id": "run_3",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']"
                },
                "in_toks": 704,
                "out_toks": 268,
                "id": "chatcmpl-CSsUjvJRYIrHdwwcmiteepKeGBpJN",
                "created": 1760998697,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all rows in feature for the given OIDs and the requested feature names\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM input_oids)\n  AND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all rows in feature for the given OIDs and the requested feature names\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM input_oids)\n  AND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4404,
                "out_toks": 1068,
                "id": "chatcmpl-CSsy87RHzAvk71YKFIPiUL3dYwbb1",
                "created": 1761000520,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "34",
            "experiment_id": "run_4",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']"
                },
                "in_toks": 704,
                "out_toks": 268,
                "id": "chatcmpl-CSsUpH6lb6XYiEvnXZkPKXomBN2At",
                "created": 1760998703,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the requested features for the given list of OIDs\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM input_oids)\n  AND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the requested features for the given list of OIDs\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM input_oids)\n  AND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4404,
                "out_toks": 1003,
                "id": "chatcmpl-CSsyKGcfyc3Q3RcCRDyrvRPJoq67d",
                "created": 1761000532,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "34",
            "experiment_id": "run_5",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']"
                },
                "in_toks": 704,
                "out_toks": 716,
                "id": "chatcmpl-CZMAnV6MZGqyvPaQkw1PjB3qkmjgq",
                "created": 1762542749,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all rows from the feature table for the requested objects and features\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM oids)\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all rows from the feature table for the requested objects and features\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM oids)\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4404,
                "out_toks": 680,
                "id": "chatcmpl-CZSyi3Xmy6JiVXJU2feIR0vNG6vad",
                "created": 1762568908,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "34",
            "experiment_id": "run_6",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']"
                },
                "in_toks": 704,
                "out_toks": 140,
                "id": "chatcmpl-CZMB8btSGLBwtEJpRwnpz383iBXax",
                "created": 1762542770,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all feature rows for the specified OIDs where the feature name is either 'Amplitude' or 'Multiband_period'\nWITH input_oids (oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM input_oids)\n  AND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all feature rows for the specified OIDs where the feature name is either 'Amplitude' or 'Multiband_period'\nWITH input_oids (oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM input_oids)\n  AND name IN ('Amplitude', 'Multiband_period')\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4404,
                "out_toks": 949,
                "id": "chatcmpl-CZSylJ3Hww27GqX2yvmzUvRM4PB3K",
                "created": 1762568911,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "34",
            "experiment_id": "run_7",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']"
                },
                "in_toks": 704,
                "out_toks": 396,
                "id": "chatcmpl-CZMBCV9HQo7p4WbNNfalw6ytRvl8a",
                "created": 1762542774,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the requested features ('Amplitude', 'Multiband_period')\n-- for the provided list of OIDs. OIDs are defined in a CTE and used via a subquery\n-- to avoid JOINs, per guidance.\nWITH given_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM given_oids)\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the requested features ('Amplitude', 'Multiband_period')\n-- for the provided list of OIDs. OIDs are defined in a CTE and used via a subquery\n-- to avoid JOINs, per guidance.\nWITH given_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM given_oids)\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4404,
                "out_toks": 1101,
                "id": "chatcmpl-CZRAMqHB3pb34pRAygzczatBlW1bq",
                "created": 1762561942,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "34",
            "experiment_id": "run_8",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']"
                },
                "in_toks": 704,
                "out_toks": 332,
                "id": "chatcmpl-CZMBN003PlbPhJllGMEdYXuAoGVrI",
                "created": 1762542785,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all feature rows (all bands and versions) for the requested OIDs where the feature name is 'Amplitude' or 'Multiband_period'\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM input_oids)\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all feature rows (all bands and versions) for the requested OIDs where the feature name is 'Amplitude' or 'Multiband_period'\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM input_oids)\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4404,
                "out_toks": 954,
                "id": "chatcmpl-CZRAMoUi3R6JvlNveML51wIibYtX9",
                "created": 1762561942,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "34",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 704,
                "out_toks": 271,
                "id": "chatcmpl-CZMBXifasv28aviymPc8teNEI0GCB",
                "created": 1762542795,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return all columns from feature for Amplitude or Multiband_period for the specified OIDs.\n   Following the guidelines, OIDs are obtained via a subquery against the object table and used in the main query. */\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n),\ntarget_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM oids)\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid, name, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return all columns from feature for Amplitude or Multiband_period for the specified OIDs.\n   Following the guidelines, OIDs are obtained via a subquery against the object table and used in the main query. */\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n),\ntarget_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM oids)\n)\nSELECT *\nFROM feature\nWHERE name IN ('Amplitude', 'Multiband_period')\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid, name, fid, version;"
                },
                "in_toks": 4886,
                "out_toks": 998,
                "id": "chatcmpl-CZRAMEdoaRPmWaWzOLFLqLjytyHRO",
                "created": 1762561942,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "1": {
        "0": {
            "req_id": "1",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "taxonomy",
                "object",
                "detection",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'object', 'detection', 'feature']",
                    "1": "['object', 'probability', 'taxonomy', 'detection', 'feature', 'feature_version']"
                },
                "in_toks": 737,
                "out_toks": 3768,
                "id": "chatcmpl-CSnRMZVL5fCoKd8sNFTC9XZ6qtbfd",
                "created": 1760979268,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH target_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6 /* at least one year of coverage */\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.deltajd >= 365 )/* at least 20 detections in at least one band (use feature n_det) */\n     AND EXISTS\n       (SELECT 1\n        FROM feature f2\n        WHERE f2.oid = p.oid\n          AND f2.name = 'n_det'\n          AND f2.value >= 20 )/* corrected magnitude variations: g > 1.0 mag */\n     AND (\n            (SELECT MAX(d1.magpsf_corr) - MIN(d1.magpsf_corr)\n             FROM detection d1\n             WHERE d1.oid = p.oid\n               AND d1.fid = 1) > 1.0 )/* corrected magnitude variations: r > 0.5 mag */\n     AND (\n            (SELECT MAX(d2.magpsf_corr) - MIN(d2.magpsf_corr)\n             FROM detection d2\n             WHERE d2.oid = p.oid\n               AND d2.fid = 2) > 0.5))\nSELECT f.oid, /* feature fields */  f.value,\n                                    f.name,\n                                    f.version,\n                                    f.fid AS feature_fid, /* object fields */\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, /* corrected magnitude stats per band (fid = 1:g, 2:r) */\n  (SELECT MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid) AS min_mag,\n\n  (SELECT MAX(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid) AS max_mag,\n                                                                                            (\n                                                                                               (SELECT MAX(d.magpsf_corr)\n                                                                                                FROM detection d\n                                                                                                WHERE d.oid = f.oid\n                                                                                                  AND d.fid = f.fid) -\n                                                                                               (SELECT MIN(d.magpsf_corr)\n                                                                                                FROM detection d\n                                                                                                WHERE d.oid = f.oid\n                                                                                                  AND d.fid = f.fid)) AS delta_mag\nFROM feature f\nWHERE f.name = 'delta_mag_fid'\n  AND f.fid IN (1,\n                2)/* g and r bands */\n  AND f.oid IN\n    (SELECT oid\n     FROM target_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH target_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6 /* at least one year of coverage */\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.deltajd >= 365 )/* at least 20 detections in at least one band (use feature n_det) */\n     AND EXISTS\n       (SELECT 1\n        FROM feature f2\n        WHERE f2.oid = p.oid\n          AND f2.name = 'n_det'\n          AND f2.value >= 20 )/* corrected magnitude variations: g > 1.0 mag */\n     AND (\n            (SELECT MAX(d1.magpsf_corr) - MIN(d1.magpsf_corr)\n             FROM detection d1\n             WHERE d1.oid = p.oid\n               AND d1.fid = 1) > 1.0 )/* corrected magnitude variations: r > 0.5 mag */\n     AND (\n            (SELECT MAX(d2.magpsf_corr) - MIN(d2.magpsf_corr)\n             FROM detection d2\n             WHERE d2.oid = p.oid\n               AND d2.fid = 2) > 0.5))\nSELECT f.oid, /* feature fields */  f.value,\n                                    f.name,\n                                    f.version,\n                                    f.fid AS feature_fid, /* object fields */\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, /* corrected magnitude stats per band (fid = 1:g, 2:r) */\n  (SELECT MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid) AS min_mag,\n\n  (SELECT MAX(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid) AS max_mag,\n                                                                                            (\n                                                                                               (SELECT MAX(d.magpsf_corr)\n                                                                                                FROM detection d\n                                                                                                WHERE d.oid = f.oid\n                                                                                                  AND d.fid = f.fid) -\n                                                                                               (SELECT MIN(d.magpsf_corr)\n                                                                                                FROM detection d\n                                                                                                WHERE d.oid = f.oid\n                                                                                                  AND d.fid = f.fid)) AS delta_mag\nFROM feature f\nWHERE f.name = 'delta_mag_fid'\n  AND f.fid IN (1,\n                2)/* g and r bands */\n  AND f.oid IN\n    (SELECT oid\n     FROM target_oids);"
                },
                "in_toks": 5696,
                "out_toks": 7337,
                "id": "chatcmpl-CayHcYpYUnHn7X6V8XK6Ts2GPBBF0",
                "created": 1762927572,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "1",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'object', 'detection', 'feature']",
                    "1": "['object', 'probability', 'taxonomy', 'detection', 'feature', 'feature_version']"
                },
                "in_toks": 737,
                "out_toks": 3768,
                "id": "chatcmpl-CSnRMZVL5fCoKd8sNFTC9XZ6qtbfd",
                "created": 1760979268,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects classified as AGN (lc_classifier) with p>0.6, baseline >= 365 days,\n-- at least one band with >=20 detections (via feature 'n_det'),\n-- and variability using corrected magnitudes (magpsf_corr) >1.0 mag in g (fid=1) and >0.5 mag in r (fid=2).\n-- Return per-object feature rows for g and r (fid IN (1,2)), including corrected-band max/min mags and their difference as delta_mag.\n\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, -- requested alias for feature fid\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid=f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid=f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid=f.oid) AS ndet,\n\n  (SELECT MAX(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid=f.oid\n     AND d.fid=f.fid\n     AND d.corrected=TRUE\n     AND d.magpsf_corr IS NOT NULL) AS max_mag,\n\n  (SELECT MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid=f.oid\n     AND d.fid=f.fid\n     AND d.corrected=TRUE\n     AND d.magpsf_corr IS NOT NULL) AS min_mag,\n\n  (SELECT MAX(d.magpsf_corr) - MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid=f.oid\n     AND d.fid=f.fid\n     AND d.corrected=TRUE\n     AND d.magpsf_corr IS NOT NULL) AS delta_mag\nFROM feature f\nWHERE f.fid IN (1,\n                2)-- 1=g, 2=r\n\n  AND f.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.deltajd >= 365\n       AND o.oid IN\n         (SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'lc_classifier'\n            AND p.class_name = 'AGN'\n            AND p.probability > 0.6)\n       AND EXISTS\n         (SELECT 1\n          FROM feature f2\n          WHERE f2.oid = o.oid\n            AND f2.name = 'n_det'\n            AND f2.value >= 20)\n       AND\n         (SELECT MAX(d1.magpsf_corr) - MIN(d1.magpsf_corr)\n          FROM detection d1\n          WHERE d1.oid = o.oid\n            AND d1.fid = 1\n            AND d1.corrected = TRUE\n            AND d1.magpsf_corr IS NOT NULL) > 1.0\n       AND\n         (SELECT MAX(d2.magpsf_corr) - MIN(d2.magpsf_corr)\n          FROM detection d2\n          WHERE d2.oid = o.oid\n            AND d2.fid = 2\n            AND d2.corrected = TRUE\n            AND d2.magpsf_corr IS NOT NULL) > 0.5);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects classified as AGN (lc_classifier) with p>0.6, baseline >= 365 days,\n-- at least one band with >=20 detections (via feature 'n_det'),\n-- and variability using corrected magnitudes (magpsf_corr) >1.0 mag in g (fid=1) and >0.5 mag in r (fid=2).\n-- Return per-object feature rows for g and r (fid IN (1,2)), including corrected-band max/min mags and their difference as delta_mag.\n\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, -- requested alias for feature fid\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid=f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid=f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid=f.oid) AS ndet,\n\n  (SELECT MAX(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid=f.oid\n     AND d.fid=f.fid\n     AND d.corrected=TRUE\n     AND d.magpsf_corr IS NOT NULL) AS max_mag,\n\n  (SELECT MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid=f.oid\n     AND d.fid=f.fid\n     AND d.corrected=TRUE\n     AND d.magpsf_corr IS NOT NULL) AS min_mag,\n\n  (SELECT MAX(d.magpsf_corr) - MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid=f.oid\n     AND d.fid=f.fid\n     AND d.corrected=TRUE\n     AND d.magpsf_corr IS NOT NULL) AS delta_mag\nFROM feature f\nWHERE f.fid IN (1,\n                2)-- 1=g, 2=r\n\n  AND f.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.deltajd >= 365\n       AND o.oid IN\n         (SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'lc_classifier'\n            AND p.class_name = 'AGN'\n            AND p.probability > 0.6)\n       AND EXISTS\n         (SELECT 1\n          FROM feature f2\n          WHERE f2.oid = o.oid\n            AND f2.name = 'n_det'\n            AND f2.value >= 20)\n       AND\n         (SELECT MAX(d1.magpsf_corr) - MIN(d1.magpsf_corr)\n          FROM detection d1\n          WHERE d1.oid = o.oid\n            AND d1.fid = 1\n            AND d1.corrected = TRUE\n            AND d1.magpsf_corr IS NOT NULL) > 1.0\n       AND\n         (SELECT MAX(d2.magpsf_corr) - MIN(d2.magpsf_corr)\n          FROM detection d2\n          WHERE d2.oid = o.oid\n            AND d2.fid = 2\n            AND d2.corrected = TRUE\n            AND d2.magpsf_corr IS NOT NULL) > 0.5);"
                },
                "in_toks": 5747,
                "out_toks": 6317,
                "id": "chatcmpl-CayIszFz31Gwr85oarS8ky2H1Gmmq",
                "created": 1762927650,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "1",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature",
                "feature_version",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'feature_version', 'detection']"
                },
                "in_toks": 737,
                "out_toks": 2270,
                "id": "chatcmpl-CSsUxtqppQhgh63PPKIjH3FLCWGVE",
                "created": 1760998711,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Get OIDs of AGN objects with P(AGN|lc_classifier) > 0.6, >=1 yr baseline, >=20 detections in any band, and corrected variability thresholds in g (>1 mag) and r (>0.5 mag) */ WITH selected_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.deltajd >= 365 /* at least 20 detections in any single band (use feature n_det per fid) */\n     AND EXISTS\n       (SELECT 1\n        FROM feature f2\n        WHERE f2.oid = o.oid\n          AND f2.name = 'n_det'\n          AND f2.value >= 20\n          AND f2.fid IN (1,\n                         2,\n                         3) )/* AGN probability constraint (default classifier: lc_classifier) */\n     AND o.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6 )/* corrected magnitude variability constraints per band */\n     AND\n       (SELECT max(d.magpsf_corr) - min(d.magpsf_corr)\n        FROM detection d\n        WHERE d.oid = o.oid\n          AND d.fid = 1\n          AND d.corrected = TRUE) > 1.0\n     AND\n       (SELECT max(d.magpsf_corr) - min(d.magpsf_corr)\n        FROM detection d\n        WHERE d.oid = o.oid\n          AND d.fid = 2\n          AND d.corrected = TRUE) > 0.5)\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, /* requested alias pattern: [table_name]_fid */ /* mean coordinates and total number of detections from object table */\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, /* corrected max/min magnitudes and per-band variation (delta_mag) based on feature_fid */  CASE\n                                                                                                                                 WHEN f.fid = 1 THEN\n                                                                                                                                        (SELECT max(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 1\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 WHEN f.fid = 2 THEN\n                                                                                                                                        (SELECT max(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 2\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 ELSE NULL\n                                                                                                                             END AS max_mag,\n                                                                                                                             CASE\n                                                                                                                                 WHEN f.fid = 1 THEN\n                                                                                                                                        (SELECT min(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 1\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 WHEN f.fid = 2 THEN\n                                                                                                                                        (SELECT min(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 2\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 ELSE NULL\n                                                                                                                             END AS min_mag,\n                                                                                                                             CASE\n                                                                                                                                 WHEN f.fid = 1 THEN\n                                                                                                                                        (SELECT max(d.magpsf_corr) - min(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 1\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 WHEN f.fid = 2 THEN\n                                                                                                                                        (SELECT max(d.magpsf_corr) - min(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 2\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 ELSE NULL\n                                                                                                                             END AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM selected_oids)/* return per-band feature rows for g and r */\n  AND f.fid IN (1,\n                2);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Get OIDs of AGN objects with P(AGN|lc_classifier) > 0.6, >=1 yr baseline, >=20 detections in any band, and corrected variability thresholds in g (>1 mag) and r (>0.5 mag) */ WITH selected_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.deltajd >= 365 /* at least 20 detections in any single band (use feature n_det per fid) */\n     AND EXISTS\n       (SELECT 1\n        FROM feature f2\n        WHERE f2.oid = o.oid\n          AND f2.name = 'n_det'\n          AND f2.value >= 20\n          AND f2.fid IN (1,\n                         2,\n                         3) )/* AGN probability constraint (default classifier: lc_classifier) */\n     AND o.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6 )/* corrected magnitude variability constraints per band */\n     AND\n       (SELECT max(d.magpsf_corr) - min(d.magpsf_corr)\n        FROM detection d\n        WHERE d.oid = o.oid\n          AND d.fid = 1\n          AND d.corrected = TRUE) > 1.0\n     AND\n       (SELECT max(d.magpsf_corr) - min(d.magpsf_corr)\n        FROM detection d\n        WHERE d.oid = o.oid\n          AND d.fid = 2\n          AND d.corrected = TRUE) > 0.5)\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, /* requested alias pattern: [table_name]_fid */ /* mean coordinates and total number of detections from object table */\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, /* corrected max/min magnitudes and per-band variation (delta_mag) based on feature_fid */  CASE\n                                                                                                                                 WHEN f.fid = 1 THEN\n                                                                                                                                        (SELECT max(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 1\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 WHEN f.fid = 2 THEN\n                                                                                                                                        (SELECT max(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 2\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 ELSE NULL\n                                                                                                                             END AS max_mag,\n                                                                                                                             CASE\n                                                                                                                                 WHEN f.fid = 1 THEN\n                                                                                                                                        (SELECT min(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 1\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 WHEN f.fid = 2 THEN\n                                                                                                                                        (SELECT min(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 2\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 ELSE NULL\n                                                                                                                             END AS min_mag,\n                                                                                                                             CASE\n                                                                                                                                 WHEN f.fid = 1 THEN\n                                                                                                                                        (SELECT max(d.magpsf_corr) - min(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 1\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 WHEN f.fid = 2 THEN\n                                                                                                                                        (SELECT max(d.magpsf_corr) - min(d.magpsf_corr)\n                                                                                                                                         FROM detection d\n                                                                                                                                         WHERE d.oid = f.oid\n                                                                                                                                           AND d.fid = 2\n                                                                                                                                           AND d.corrected = TRUE)\n                                                                                                                                 ELSE NULL\n                                                                                                                             END AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM selected_oids)/* return per-band feature rows for g and r */\n  AND f.fid IN (1,\n                2);"
                },
                "in_toks": 5747,
                "out_toks": 6023,
                "id": "chatcmpl-CayK3vfVl975mtQdOXmnoJs3JAy06",
                "created": 1762927723,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "1",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection', 'feature', 'feature_version']"
                },
                "in_toks": 737,
                "out_toks": 1374,
                "id": "chatcmpl-CSsViDMYfYdtLovU53yXm09gvVR8L",
                "created": 1760998758,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects classified as AGN by the lc_classifier with probability > 0.6,\n   with light-curve span >= 365 days, at least one band with n_det >= 20,\n   and showing corrected-magnitude variations > 1 mag in g (fid=1) and > 0.5 mag in r (fid=2).\n   Returns per-band rows (g and r) including feature fields and corrected min/max mags with delta_mag. */ WITH qualified_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.deltajd >= 365)\n     AND EXISTS\n       (SELECT 1\n        FROM feature f2\n        WHERE f2.oid = p.oid\n          AND f2.name = 'n_det'\n          AND f2.value >= 20\n          AND f2.fid IN (1,\n                         2)-- at least one of g or r has >= 20 detections\n)\n     AND\n       (SELECT max(d1.magpsf_corr) - min(d1.magpsf_corr)\n        FROM detection d1\n        WHERE d1.oid = p.oid\n          AND d1.fid = 1\n          AND d1.corrected = TRUE\n          AND d1.magpsf_corr IS NOT NULL) > 1\n     AND\n       (SELECT max(d2.magpsf_corr) - min(d2.magpsf_corr)\n        FROM detection d2\n        WHERE d2.oid = p.oid\n          AND d2.fid = 2\n          AND d2.corrected = TRUE\n          AND d2.magpsf_corr IS NOT NULL) > 0.5) -- g-band rows (fid=1)\n\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet,\n       1 AS detection_fid,\n\n  (SELECT max(dg.magpsf_corr)\n   FROM detection dg\n   WHERE dg.oid = f.oid\n     AND dg.fid = 1\n     AND dg.corrected = TRUE\n     AND dg.magpsf_corr IS NOT NULL) AS max_mag,\n\n  (SELECT min(dg.magpsf_corr)\n   FROM detection dg\n   WHERE dg.oid = f.oid\n     AND dg.fid = 1\n     AND dg.corrected = TRUE\n     AND dg.magpsf_corr IS NOT NULL) AS min_mag,\n       (\n          (SELECT max(dg.magpsf_corr)\n           FROM detection dg\n           WHERE dg.oid = f.oid\n             AND dg.fid = 1\n             AND dg.corrected = TRUE\n             AND dg.magpsf_corr IS NOT NULL) -\n          (SELECT min(dg.magpsf_corr)\n           FROM detection dg\n           WHERE dg.oid = f.oid\n             AND dg.fid = 1\n             AND dg.corrected = TRUE\n             AND dg.magpsf_corr IS NOT NULL)) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM qualified_oids)\nUNION ALL -- r-band rows (fid=2)\n\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet,\n       2 AS detection_fid,\n\n  (SELECT max(dr.magpsf_corr)\n   FROM detection dr\n   WHERE dr.oid = f.oid\n     AND dr.fid = 2\n     AND dr.corrected = TRUE\n     AND dr.magpsf_corr IS NOT NULL) AS max_mag,\n\n  (SELECT min(dr.magpsf_corr)\n   FROM detection dr\n   WHERE dr.oid = f.oid\n     AND dr.fid = 2\n     AND dr.corrected = TRUE\n     AND dr.magpsf_corr IS NOT NULL) AS min_mag,\n       (\n          (SELECT max(dr.magpsf_corr)\n           FROM detection dr\n           WHERE dr.oid = f.oid\n             AND dr.fid = 2\n             AND dr.corrected = TRUE\n             AND dr.magpsf_corr IS NOT NULL) -\n          (SELECT min(dr.magpsf_corr)\n           FROM detection dr\n           WHERE dr.oid = f.oid\n             AND dr.fid = 2\n             AND dr.corrected = TRUE\n             AND dr.magpsf_corr IS NOT NULL)) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM qualified_oids)\nORDER BY oid,\n         detection_fid,\n         name,\n         VERSION,\n         feature_fid;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects classified as AGN by the lc_classifier with probability > 0.6,\n   with light-curve span >= 365 days, at least one band with n_det >= 20,\n   and showing corrected-magnitude variations > 1 mag in g (fid=1) and > 0.5 mag in r (fid=2).\n   Returns per-band rows (g and r) including feature fields and corrected min/max mags with delta_mag. */ WITH qualified_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.deltajd >= 365)\n     AND EXISTS\n       (SELECT 1\n        FROM feature f2\n        WHERE f2.oid = p.oid\n          AND f2.name = 'n_det'\n          AND f2.value >= 20\n          AND f2.fid IN (1,\n                         2)-- at least one of g or r has >= 20 detections\n)\n     AND\n       (SELECT max(d1.magpsf_corr) - min(d1.magpsf_corr)\n        FROM detection d1\n        WHERE d1.oid = p.oid\n          AND d1.fid = 1\n          AND d1.corrected = TRUE\n          AND d1.magpsf_corr IS NOT NULL) > 1\n     AND\n       (SELECT max(d2.magpsf_corr) - min(d2.magpsf_corr)\n        FROM detection d2\n        WHERE d2.oid = p.oid\n          AND d2.fid = 2\n          AND d2.corrected = TRUE\n          AND d2.magpsf_corr IS NOT NULL) > 0.5) -- g-band rows (fid=1)\n\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet,\n       1 AS detection_fid,\n\n  (SELECT max(dg.magpsf_corr)\n   FROM detection dg\n   WHERE dg.oid = f.oid\n     AND dg.fid = 1\n     AND dg.corrected = TRUE\n     AND dg.magpsf_corr IS NOT NULL) AS max_mag,\n\n  (SELECT min(dg.magpsf_corr)\n   FROM detection dg\n   WHERE dg.oid = f.oid\n     AND dg.fid = 1\n     AND dg.corrected = TRUE\n     AND dg.magpsf_corr IS NOT NULL) AS min_mag,\n       (\n          (SELECT max(dg.magpsf_corr)\n           FROM detection dg\n           WHERE dg.oid = f.oid\n             AND dg.fid = 1\n             AND dg.corrected = TRUE\n             AND dg.magpsf_corr IS NOT NULL) -\n          (SELECT min(dg.magpsf_corr)\n           FROM detection dg\n           WHERE dg.oid = f.oid\n             AND dg.fid = 1\n             AND dg.corrected = TRUE\n             AND dg.magpsf_corr IS NOT NULL)) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM qualified_oids)\nUNION ALL -- r-band rows (fid=2)\n\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet,\n       2 AS detection_fid,\n\n  (SELECT max(dr.magpsf_corr)\n   FROM detection dr\n   WHERE dr.oid = f.oid\n     AND dr.fid = 2\n     AND dr.corrected = TRUE\n     AND dr.magpsf_corr IS NOT NULL) AS max_mag,\n\n  (SELECT min(dr.magpsf_corr)\n   FROM detection dr\n   WHERE dr.oid = f.oid\n     AND dr.fid = 2\n     AND dr.corrected = TRUE\n     AND dr.magpsf_corr IS NOT NULL) AS min_mag,\n       (\n          (SELECT max(dr.magpsf_corr)\n           FROM detection dr\n           WHERE dr.oid = f.oid\n             AND dr.fid = 2\n             AND dr.corrected = TRUE\n             AND dr.magpsf_corr IS NOT NULL) -\n          (SELECT min(dr.magpsf_corr)\n           FROM detection dr\n           WHERE dr.oid = f.oid\n             AND dr.fid = 2\n             AND dr.corrected = TRUE\n             AND dr.magpsf_corr IS NOT NULL)) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM qualified_oids)\nORDER BY oid,\n         detection_fid,\n         name,\n         VERSION,\n         feature_fid;"
                },
                "in_toks": 5747,
                "out_toks": 7565,
                "id": "chatcmpl-CayL1WAqwvT4XPPuC2fgXAWzsiPHo",
                "created": 1762927783,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "1",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection",
                "magstat",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection', 'magstat', 'feature', 'feature_version']"
                },
                "in_toks": 737,
                "out_toks": 1314,
                "id": "chatcmpl-CSsW578JbEY4swrSPu1ksLiXCoL4O",
                "created": 1760998781,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects classified as AGN (lc_classifier) with P>0.6,\n-- with light curves spanning >= 1 year,\n-- with >= 20 detections in at least one band,\n-- and showing corrected magnitude variations: >1.0 mag in g (fid=1) and >0.5 mag in r (fid=2).\n-- Returns per-feature rows (for g and r bands only), including per-band corrected mag extrema and delta_mag.\n\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet,\n\n  (SELECT ms.magmax_corr\n   FROM magstat ms\n   WHERE ms.oid = f.oid\n     AND ms.fid = f.fid\n     AND ms.corrected = TRUE\n   LIMIT 1) AS magmax_corr,\n\n  (SELECT ms.magmin_corr\n   FROM magstat ms\n   WHERE ms.oid = f.oid\n     AND ms.fid = f.fid\n     AND ms.corrected = TRUE\n   LIMIT 1) AS magmin_corr,\n       (\n          (SELECT ms.magmax_corr\n           FROM magstat ms\n           WHERE ms.oid = f.oid\n             AND ms.fid = f.fid\n             AND ms.corrected = TRUE\n           LIMIT 1) -\n          (SELECT ms.magmin_corr\n           FROM magstat ms\n           WHERE ms.oid = f.oid\n             AND ms.fid = f.fid\n             AND ms.corrected = TRUE\n           LIMIT 1)) AS delta_mag,\n       f.fid AS magstat_fid\nFROM feature f\nWHERE f.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.deltajd >= 365\n       AND EXISTS\n         (SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.classifier_name = 'lc_classifier'\n            AND p.class_name = 'AGN'\n            AND p.probability > 0.6)\n       AND EXISTS\n         (SELECT 1\n          FROM magstat m\n          WHERE m.oid = o.oid\n            AND m.ndet >= 20)\n       AND EXISTS\n         (SELECT 1\n          FROM magstat mg\n          WHERE mg.oid = o.oid\n            AND mg.fid = 1\n            AND mg.corrected = TRUE\n            AND (mg.magmax_corr - mg.magmin_corr) > 1.0)\n       AND EXISTS\n         (SELECT 1\n          FROM magstat mr\n          WHERE mr.oid = o.oid\n            AND mr.fid = 2\n            AND mr.corrected = TRUE\n            AND (mr.magmax_corr - mr.magmin_corr) > 0.5))\n  AND f.fid IN (1,\n                2);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects classified as AGN (lc_classifier) with P>0.6,\n-- with light curves spanning >= 1 year,\n-- with >= 20 detections in at least one band,\n-- and showing corrected magnitude variations: >1.0 mag in g (fid=1) and >0.5 mag in r (fid=2).\n-- Returns per-feature rows (for g and r bands only), including per-band corrected mag extrema and delta_mag.\n\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet,\n\n  (SELECT ms.magmax_corr\n   FROM magstat ms\n   WHERE ms.oid = f.oid\n     AND ms.fid = f.fid\n     AND ms.corrected = TRUE\n   LIMIT 1) AS magmax_corr,\n\n  (SELECT ms.magmin_corr\n   FROM magstat ms\n   WHERE ms.oid = f.oid\n     AND ms.fid = f.fid\n     AND ms.corrected = TRUE\n   LIMIT 1) AS magmin_corr,\n       (\n          (SELECT ms.magmax_corr\n           FROM magstat ms\n           WHERE ms.oid = f.oid\n             AND ms.fid = f.fid\n             AND ms.corrected = TRUE\n           LIMIT 1) -\n          (SELECT ms.magmin_corr\n           FROM magstat ms\n           WHERE ms.oid = f.oid\n             AND ms.fid = f.fid\n             AND ms.corrected = TRUE\n           LIMIT 1)) AS delta_mag,\n       f.fid AS magstat_fid\nFROM feature f\nWHERE f.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.deltajd >= 365\n       AND EXISTS\n         (SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.classifier_name = 'lc_classifier'\n            AND p.class_name = 'AGN'\n            AND p.probability > 0.6)\n       AND EXISTS\n         (SELECT 1\n          FROM magstat m\n          WHERE m.oid = o.oid\n            AND m.ndet >= 20)\n       AND EXISTS\n         (SELECT 1\n          FROM magstat mg\n          WHERE mg.oid = o.oid\n            AND mg.fid = 1\n            AND mg.corrected = TRUE\n            AND (mg.magmax_corr - mg.magmin_corr) > 1.0)\n       AND EXISTS\n         (SELECT 1\n          FROM magstat mr\n          WHERE mr.oid = o.oid\n            AND mr.fid = 2\n            AND mr.corrected = TRUE\n            AND (mr.magmax_corr - mr.magmin_corr) > 0.5))\n  AND f.fid IN (1,\n                2);"
                },
                "in_toks": 6464,
                "out_toks": 4802,
                "id": "chatcmpl-CayMJAwrTsvJLdZLFySZnea5Omeyg",
                "created": 1762927863,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "1",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection', 'feature']"
                },
                "in_toks": 737,
                "out_toks": 2522,
                "id": "chatcmpl-CZMBeGibsTonPswHkVx4vcnXdhJ3V",
                "created": 1762542802,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects classified as AGN (lc_classifier) with probability > 0.6\n-- Light curves span at least 1 year (deltajd >= 365)\n-- At least 20 corrected detections in g or r\n-- Variability (using corrected magnitudes) > 1.0 mag in g and > 0.5 mag in r\n-- Return feature fields (with fid aliased as feature_fid), object coords and ndet,\n-- per-band min/max corrected magnitudes, and delta_mag per band\n WITH candidates AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6),\n      lc_stats AS\n  (SELECT d.oid, -- counts (only corrected detections)\n SUM(CASE\n         WHEN d.fid = 1\n              AND d.corrected THEN 1\n         ELSE 0\n     END) AS cnt_g,\n SUM(CASE\n         WHEN d.fid = 2\n              AND d.corrected THEN 1\n         ELSE 0\n     END) AS cnt_r, -- corrected magnitudes per band\n MAX(CASE\n         WHEN d.fid = 1\n              AND d.corrected THEN d.magpsf_corr\n     END) AS max_mag_g,\n MIN(CASE\n         WHEN d.fid = 1\n              AND d.corrected THEN d.magpsf_corr\n     END) AS min_mag_g,\n MAX(CASE\n         WHEN d.fid = 2\n              AND d.corrected THEN d.magpsf_corr\n     END) AS max_mag_r,\n MIN(CASE\n         WHEN d.fid = 2\n              AND d.corrected THEN d.magpsf_corr\n     END) AS min_mag_r\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM candidates)\n     AND d.corrected = TRUE\n   GROUP BY d.oid),\n      qualified_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT oid\n        FROM candidates)\n     AND o.deltajd >= 365\n     AND EXISTS\n       (SELECT 1\n        FROM lc_stats s\n        WHERE s.oid = o.oid\n          AND (s.cnt_g >= 20\n               OR s.cnt_r >= 20)\n          AND (s.max_mag_g - s.min_mag_g > 1.0)\n          AND (s.max_mag_r - s.min_mag_r > 0.5)))\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, -- per instructions, alias filter id columns as [table]_fid\n -- object-level info\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, -- per-band corrected magnitude extrema depending on feature_fid (only meaningful for g=1, r=2)\n CASE\n     WHEN f.fid = 1 THEN\n            (SELECT s.min_mag_g\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     WHEN f.fid = 2 THEN\n            (SELECT s.min_mag_r\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     ELSE NULL\n END AS min_mag,\n CASE\n     WHEN f.fid = 1 THEN\n            (SELECT s.max_mag_g\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     WHEN f.fid = 2 THEN\n            (SELECT s.max_mag_r\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     ELSE NULL\n END AS max_mag,\n CASE\n     WHEN f.fid = 1 THEN\n            (SELECT s.max_mag_g - s.min_mag_g\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     WHEN f.fid = 2 THEN\n            (SELECT s.max_mag_r - s.min_mag_r\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     ELSE NULL\n END AS delta_mag, -- per-band detection counts (only corrected detections; meaningful for g/r)\n CASE\n     WHEN f.fid = 1 THEN\n            (SELECT s.cnt_g\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     WHEN f.fid = 2 THEN\n            (SELECT s.cnt_r\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     ELSE NULL\n END AS n_det_band\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM qualified_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects classified as AGN (lc_classifier) with probability > 0.6\n-- Light curves span at least 1 year (deltajd >= 365)\n-- At least 20 corrected detections in g or r\n-- Variability (using corrected magnitudes) > 1.0 mag in g and > 0.5 mag in r\n-- Return feature fields (with fid aliased as feature_fid), object coords and ndet,\n-- per-band min/max corrected magnitudes, and delta_mag per band\n WITH candidates AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6),\n      lc_stats AS\n  (SELECT d.oid, -- counts (only corrected detections)\n SUM(CASE\n         WHEN d.fid = 1\n              AND d.corrected THEN 1\n         ELSE 0\n     END) AS cnt_g,\n SUM(CASE\n         WHEN d.fid = 2\n              AND d.corrected THEN 1\n         ELSE 0\n     END) AS cnt_r, -- corrected magnitudes per band\n MAX(CASE\n         WHEN d.fid = 1\n              AND d.corrected THEN d.magpsf_corr\n     END) AS max_mag_g,\n MIN(CASE\n         WHEN d.fid = 1\n              AND d.corrected THEN d.magpsf_corr\n     END) AS min_mag_g,\n MAX(CASE\n         WHEN d.fid = 2\n              AND d.corrected THEN d.magpsf_corr\n     END) AS max_mag_r,\n MIN(CASE\n         WHEN d.fid = 2\n              AND d.corrected THEN d.magpsf_corr\n     END) AS min_mag_r\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM candidates)\n     AND d.corrected = TRUE\n   GROUP BY d.oid),\n      qualified_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT oid\n        FROM candidates)\n     AND o.deltajd >= 365\n     AND EXISTS\n       (SELECT 1\n        FROM lc_stats s\n        WHERE s.oid = o.oid\n          AND (s.cnt_g >= 20\n               OR s.cnt_r >= 20)\n          AND (s.max_mag_g - s.min_mag_g > 1.0)\n          AND (s.max_mag_r - s.min_mag_r > 0.5)))\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, -- per instructions, alias filter id columns as [table]_fid\n -- object-level info\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, -- per-band corrected magnitude extrema depending on feature_fid (only meaningful for g=1, r=2)\n CASE\n     WHEN f.fid = 1 THEN\n            (SELECT s.min_mag_g\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     WHEN f.fid = 2 THEN\n            (SELECT s.min_mag_r\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     ELSE NULL\n END AS min_mag,\n CASE\n     WHEN f.fid = 1 THEN\n            (SELECT s.max_mag_g\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     WHEN f.fid = 2 THEN\n            (SELECT s.max_mag_r\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     ELSE NULL\n END AS max_mag,\n CASE\n     WHEN f.fid = 1 THEN\n            (SELECT s.max_mag_g - s.min_mag_g\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     WHEN f.fid = 2 THEN\n            (SELECT s.max_mag_r - s.min_mag_r\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     ELSE NULL\n END AS delta_mag, -- per-band detection counts (only corrected detections; meaningful for g/r)\n CASE\n     WHEN f.fid = 1 THEN\n            (SELECT s.cnt_g\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     WHEN f.fid = 2 THEN\n            (SELECT s.cnt_r\n             FROM lc_stats s\n             WHERE s.oid = f.oid)\n     ELSE NULL\n END AS n_det_band\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM qualified_oids);"
                },
                "in_toks": 5696,
                "out_toks": 5588,
                "id": "chatcmpl-CayN5wkYt56LBapWOgiUQEWGjKpeL",
                "created": 1762927911,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "1",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'detection']"
                },
                "in_toks": 737,
                "out_toks": 1498,
                "id": "chatcmpl-CZMCWkWRhu3fS96kMAKfq9MKAyIzr",
                "created": 1762542856,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects classified as AGN (lc_classifier) with P>0.6, >=1 yr coverage, >=20 detections in at least one band,\n   and variability using corrected magnitudes: delta_g>1.0 and delta_r>0.5.\n   Returns feature columns, mean coordinates, ndet, and per-band (g,r) min/max/delta from corrected photometry.\n*/ WITH good_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.deltajd >= 365)\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = p.oid\n        GROUP BY d.fid\n        HAVING COUNT(*) >= 20)\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = p.oid\n          AND d.corrected = TRUE\n          AND d.magpsf_corr IS NOT NULL\n          AND d.fid = 1\n        GROUP BY d.oid\n        HAVING max(d.magpsf_corr) - min(d.magpsf_corr) > 1.0)\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = p.oid\n          AND d.corrected = TRUE\n          AND d.magpsf_corr IS NOT NULL\n          AND d.fid = 2\n        GROUP BY d.oid\n        HAVING max(d.magpsf_corr) - min(d.magpsf_corr) > 0.5)),\n        band_stats AS\n  (SELECT d.oid,\n          d.fid,\n          min(d.magpsf_corr) AS min_mag,\n          max(d.magpsf_corr) AS max_mag,\n          max(d.magpsf_corr) - min(d.magpsf_corr) AS delta_mag\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM good_oids)\n     AND d.corrected = TRUE\n     AND d.magpsf_corr IS NOT NULL\n     AND d.fid IN (1,\n                   2)-- g and r bands\n\n   GROUP BY d.oid,\n            d.fid)\nSELECT bs.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = bs.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = bs.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = bs.oid) AS ndet,\n       bs.max_mag,\n       bs.min_mag,\n       bs.delta_mag,\n       bs.fid AS detection_fid\nFROM band_stats bs,\n     feature f\nWHERE f.oid = bs.oid\n  AND f.fid = bs.fid\nORDER BY bs.oid,\n         bs.fid,\n         f.name;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects classified as AGN (lc_classifier) with P>0.6, >=1 yr coverage, >=20 detections in at least one band,\n   and variability using corrected magnitudes: delta_g>1.0 and delta_r>0.5.\n   Returns feature columns, mean coordinates, ndet, and per-band (g,r) min/max/delta from corrected photometry.\n*/ WITH good_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.deltajd >= 365)\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = p.oid\n        GROUP BY d.fid\n        HAVING COUNT(*) >= 20)\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = p.oid\n          AND d.corrected = TRUE\n          AND d.magpsf_corr IS NOT NULL\n          AND d.fid = 1\n        GROUP BY d.oid\n        HAVING max(d.magpsf_corr) - min(d.magpsf_corr) > 1.0)\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = p.oid\n          AND d.corrected = TRUE\n          AND d.magpsf_corr IS NOT NULL\n          AND d.fid = 2\n        GROUP BY d.oid\n        HAVING max(d.magpsf_corr) - min(d.magpsf_corr) > 0.5)),\n        band_stats AS\n  (SELECT d.oid,\n          d.fid,\n          min(d.magpsf_corr) AS min_mag,\n          max(d.magpsf_corr) AS max_mag,\n          max(d.magpsf_corr) - min(d.magpsf_corr) AS delta_mag\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM good_oids)\n     AND d.corrected = TRUE\n     AND d.magpsf_corr IS NOT NULL\n     AND d.fid IN (1,\n                   2)-- g and r bands\n\n   GROUP BY d.oid,\n            d.fid)\nSELECT bs.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = bs.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = bs.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = bs.oid) AS ndet,\n       bs.max_mag,\n       bs.min_mag,\n       bs.delta_mag,\n       bs.fid AS detection_fid\nFROM band_stats bs,\n     feature f\nWHERE f.oid = bs.oid\n  AND f.fid = bs.fid\nORDER BY bs.oid,\n         bs.fid,\n         f.name;"
                },
                "in_toks": 5696,
                "out_toks": 6697,
                "id": "chatcmpl-CayOGAqjaIWpRyCGjz93WCHolAd5I",
                "created": 1762927984,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "1",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature",
                "feature_version",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'feature_version', 'detection']"
                },
                "in_toks": 737,
                "out_toks": 1950,
                "id": "chatcmpl-CZMCz4EH9260oFUNINZJGCcjpz4Gw",
                "created": 1762542885,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects classified as AGN (lc_classifier) with probability > 0.6,\n-- light curves spanning >= 365 days, having >= 20 detections in at least one band,\n-- and showing corrected-magnitude variations > 1.0 mag in g (fid=1) and > 0.5 mag in r (fid=2).\n-- Return per-object, per-feature (g/r bands only): oid, feature value/name/version/fid,\n-- mean coordinates, total ndet, and per-band corrected max/min magnitudes and their difference (delta_mag).\nWITH candidates AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6)\n     AND o.deltajd >= 365\n     AND EXISTS\n       (SELECT 1\n        FROM feature f_nd\n        WHERE f_nd.oid = o.oid\n          AND f_nd.name = 'n_det'\n          AND f_nd.value >= 20)\n     AND\n       (SELECT max(d1.magpsf_corr) - min(d1.magpsf_corr)\n        FROM detection d1\n        WHERE d1.oid = o.oid\n          AND d1.fid = 1\n          AND d1.magpsf_corr IS NOT NULL) > 1.0\n     AND\n       (SELECT max(d2.magpsf_corr) - min(d2.magpsf_corr)\n        FROM detection d2\n        WHERE d2.oid = o.oid\n          AND d2.fid = 2\n          AND d2.magpsf_corr IS NOT NULL) > 0.5)\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet,\n\n  (SELECT max(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.magpsf_corr IS NOT NULL) AS max_mag,\n\n  (SELECT min(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.magpsf_corr IS NOT NULL) AS min_mag,\n       (\n          (SELECT max(d.magpsf_corr)\n           FROM detection d\n           WHERE d.oid = f.oid\n             AND d.fid = f.fid\n             AND d.magpsf_corr IS NOT NULL) -\n          (SELECT min(d.magpsf_corr)\n           FROM detection d\n           WHERE d.oid = f.oid\n             AND d.fid = f.fid\n             AND d.magpsf_corr IS NOT NULL)) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM candidates)\n  AND f.fid IN (1,\n                2);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects classified as AGN (lc_classifier) with probability > 0.6,\n-- light curves spanning >= 365 days, having >= 20 detections in at least one band,\n-- and showing corrected-magnitude variations > 1.0 mag in g (fid=1) and > 0.5 mag in r (fid=2).\n-- Return per-object, per-feature (g/r bands only): oid, feature value/name/version/fid,\n-- mean coordinates, total ndet, and per-band corrected max/min magnitudes and their difference (delta_mag).\nWITH candidates AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6)\n     AND o.deltajd >= 365\n     AND EXISTS\n       (SELECT 1\n        FROM feature f_nd\n        WHERE f_nd.oid = o.oid\n          AND f_nd.name = 'n_det'\n          AND f_nd.value >= 20)\n     AND\n       (SELECT max(d1.magpsf_corr) - min(d1.magpsf_corr)\n        FROM detection d1\n        WHERE d1.oid = o.oid\n          AND d1.fid = 1\n          AND d1.magpsf_corr IS NOT NULL) > 1.0\n     AND\n       (SELECT max(d2.magpsf_corr) - min(d2.magpsf_corr)\n        FROM detection d2\n        WHERE d2.oid = o.oid\n          AND d2.fid = 2\n          AND d2.magpsf_corr IS NOT NULL) > 0.5)\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid,\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet,\n\n  (SELECT max(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.magpsf_corr IS NOT NULL) AS max_mag,\n\n  (SELECT min(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.magpsf_corr IS NOT NULL) AS min_mag,\n       (\n          (SELECT max(d.magpsf_corr)\n           FROM detection d\n           WHERE d.oid = f.oid\n             AND d.fid = f.fid\n             AND d.magpsf_corr IS NOT NULL) -\n          (SELECT min(d.magpsf_corr)\n           FROM detection d\n           WHERE d.oid = f.oid\n             AND d.fid = f.fid\n             AND d.magpsf_corr IS NOT NULL)) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM candidates)\n  AND f.fid IN (1,\n                2);"
                },
                "in_toks": 5747,
                "out_toks": 5807,
                "id": "chatcmpl-CayPOqT91Kq9DgLPUQV7hsMYngrMY",
                "created": 1762928054,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "1",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection', 'feature', 'feature_version']"
                },
                "in_toks": 737,
                "out_toks": 1630,
                "id": "chatcmpl-CZMDxBKm8jeB9zU7EIVF0vZ8ts5bo",
                "created": 1762542945,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects:\n   - AGN with probability > 0.6 using lc_classifier\n   - Light curves spanning >= 365 days\n   - >= 20 detections in at least one single band (g/r/i)\n   - Corrected magnitude variation > 1.0 in g and > 0.5 in r\n   Output:\n   - oid, feature.value/name/version/fid (aliased as feature_fid)\n   - object mean coordinates and ndet\n   - corrected max/min magnitudes per feature_fid (g or r) and their difference as delta_mag\n*/ WITH oids_prob AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6),\n        oids_year AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.deltajd >= 365.0),\n        oids_n_det AS\n  (SELECT DISTINCT f.oid\n   FROM feature f\n   WHERE f.name = 'n_det'\n     AND f.fid IN (1,\n                   2,\n                   3)-- single-band counts\n\n     AND f.value >= 20),\n        oids_var_corr AS\n  (SELECT t.oid\n   FROM\n     (SELECT d.oid,\n             MAX(d.magpsf_corr) FILTER (\n                                        WHERE d.fid = 1\n                                          AND d.corrected) - MIN(d.magpsf_corr) FILTER (\n                                                                                        WHERE d.fid = 1\n                                                                                          AND d.corrected) AS g_delta,\n                                MAX(d.magpsf_corr) FILTER (\n                                                           WHERE d.fid = 2\n                                                             AND d.corrected) - MIN(d.magpsf_corr) FILTER (\n                                                                                                           WHERE d.fid = 2\n                                                                                                             AND d.corrected) AS r_delta\n      FROM detection d\n      GROUP BY d.oid) t\n   WHERE t.g_delta > 1.0\n     AND t.r_delta > 0.5),\n        oids_final AS\n  (SELECT oid\n   FROM oids_prob INTERSECT SELECT oid\n   FROM oids_year INTERSECT SELECT oid\n   FROM oids_n_det INTERSECT SELECT oid\n   FROM oids_var_corr)\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, /* object info */\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, /* corrected magnitudes in the same band as the feature row (g=1, r=2) */\n  (SELECT MAX(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS max_mag,\n\n  (SELECT MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS min_mag,\n                                                                                                            (\n                                                                                                               (SELECT MAX(d.magpsf_corr)\n                                                                                                                FROM detection d\n                                                                                                                WHERE d.oid = f.oid\n                                                                                                                  AND d.fid = f.fid\n                                                                                                                  AND d.corrected = TRUE) -\n                                                                                                               (SELECT MIN(d.magpsf_corr)\n                                                                                                                FROM detection d\n                                                                                                                WHERE d.oid = f.oid\n                                                                                                                  AND d.fid = f.fid\n                                                                                                                  AND d.corrected = TRUE)) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM oids_final)\n  AND f.fid IN (1,\n                2); -- return only g and r feature rows",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects:\n   - AGN with probability > 0.6 using lc_classifier\n   - Light curves spanning >= 365 days\n   - >= 20 detections in at least one single band (g/r/i)\n   - Corrected magnitude variation > 1.0 in g and > 0.5 in r\n   Output:\n   - oid, feature.value/name/version/fid (aliased as feature_fid)\n   - object mean coordinates and ndet\n   - corrected max/min magnitudes per feature_fid (g or r) and their difference as delta_mag\n*/ WITH oids_prob AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6),\n        oids_year AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.deltajd >= 365.0),\n        oids_n_det AS\n  (SELECT DISTINCT f.oid\n   FROM feature f\n   WHERE f.name = 'n_det'\n     AND f.fid IN (1,\n                   2,\n                   3)-- single-band counts\n\n     AND f.value >= 20),\n        oids_var_corr AS\n  (SELECT t.oid\n   FROM\n     (SELECT d.oid,\n             MAX(d.magpsf_corr) FILTER (\n                                        WHERE d.fid = 1\n                                          AND d.corrected) - MIN(d.magpsf_corr) FILTER (\n                                                                                        WHERE d.fid = 1\n                                                                                          AND d.corrected) AS g_delta,\n                                MAX(d.magpsf_corr) FILTER (\n                                                           WHERE d.fid = 2\n                                                             AND d.corrected) - MIN(d.magpsf_corr) FILTER (\n                                                                                                           WHERE d.fid = 2\n                                                                                                             AND d.corrected) AS r_delta\n      FROM detection d\n      GROUP BY d.oid) t\n   WHERE t.g_delta > 1.0\n     AND t.r_delta > 0.5),\n        oids_final AS\n  (SELECT oid\n   FROM oids_prob INTERSECT SELECT oid\n   FROM oids_year INTERSECT SELECT oid\n   FROM oids_n_det INTERSECT SELECT oid\n   FROM oids_var_corr)\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, /* object info */\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, /* corrected magnitudes in the same band as the feature row (g=1, r=2) */\n  (SELECT MAX(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS max_mag,\n\n  (SELECT MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS min_mag,\n                                                                                                            (\n                                                                                                               (SELECT MAX(d.magpsf_corr)\n                                                                                                                FROM detection d\n                                                                                                                WHERE d.oid = f.oid\n                                                                                                                  AND d.fid = f.fid\n                                                                                                                  AND d.corrected = TRUE) -\n                                                                                                               (SELECT MIN(d.magpsf_corr)\n                                                                                                                FROM detection d\n                                                                                                                WHERE d.oid = f.oid\n                                                                                                                  AND d.fid = f.fid\n                                                                                                                  AND d.corrected = TRUE)) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM oids_final)\n  AND f.fid IN (1,\n                2); -- return only g and r feature rows"
                },
                "in_toks": 5747,
                "out_toks": 7016,
                "id": "chatcmpl-CayQUBZhjSpRcJxdhqBe528aXlTLq",
                "created": 1762928122,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "1",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection', 'feature', 'feature_version']"
                },
                "in_toks": 737,
                "out_toks": 2078,
                "id": "chatcmpl-CZMEgcnxPReUuWtCoKnG6Lkr2Rj44",
                "created": 1762542990,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects: AGN (lc_classifier) with probability > 0.6,\n-- time coverage >= 365 days, >= 20 detections in at least one band,\n-- and corrected magnitude variation > 1.0 mag in g (fid=1) and > 0.5 mag in r (fid=2).\nWITH eligible_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6)\n     AND o.deltajd >= 365\n     AND EXISTS\n       (-- at least one band with >= 20 detections\n SELECT 1\n        FROM\n          (SELECT d.fid,\n                  COUNT(*) AS cnt\n           FROM detection d\n           WHERE d.oid = o.oid\n           GROUP BY d.fid) t\n        WHERE t.cnt >= 20)\n     AND\n       (-- g-band (fid=1) corrected variation > 1.0 mag\n SELECT MAX(d1.magpsf_corr) - MIN(d1.magpsf_corr)\n        FROM detection d1\n        WHERE d1.oid = o.oid\n          AND d1.fid = 1\n          AND d1.corrected = TRUE\n          AND d1.magpsf_corr IS NOT NULL) > 1.0\n     AND\n       (-- r-band (fid=2) corrected variation > 0.5 mag\n SELECT MAX(d2.magpsf_corr) - MIN(d2.magpsf_corr)\n        FROM detection d2\n        WHERE d2.oid = o.oid\n          AND d2.fid = 2\n          AND d2.corrected = TRUE\n          AND d2.magpsf_corr IS NOT NULL) > 0.5)\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, -- requested alias for feature.fid\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, -- corrected magnitudes per band (matching feature_fid = 1 for g, 2 for r)\n\n  (SELECT MAX(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS max_mag,\n\n  (SELECT MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS min_mag,\n\n  (SELECT MAX(d.magpsf_corr) - MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM eligible_oids)\n  AND f.fid IN (1,\n                2); -- return g and r band feature rows only",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects: AGN (lc_classifier) with probability > 0.6,\n-- time coverage >= 365 days, >= 20 detections in at least one band,\n-- and corrected magnitude variation > 1.0 mag in g (fid=1) and > 0.5 mag in r (fid=2).\nWITH eligible_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6)\n     AND o.deltajd >= 365\n     AND EXISTS\n       (-- at least one band with >= 20 detections\n SELECT 1\n        FROM\n          (SELECT d.fid,\n                  COUNT(*) AS cnt\n           FROM detection d\n           WHERE d.oid = o.oid\n           GROUP BY d.fid) t\n        WHERE t.cnt >= 20)\n     AND\n       (-- g-band (fid=1) corrected variation > 1.0 mag\n SELECT MAX(d1.magpsf_corr) - MIN(d1.magpsf_corr)\n        FROM detection d1\n        WHERE d1.oid = o.oid\n          AND d1.fid = 1\n          AND d1.corrected = TRUE\n          AND d1.magpsf_corr IS NOT NULL) > 1.0\n     AND\n       (-- r-band (fid=2) corrected variation > 0.5 mag\n SELECT MAX(d2.magpsf_corr) - MIN(d2.magpsf_corr)\n        FROM detection d2\n        WHERE d2.oid = o.oid\n          AND d2.fid = 2\n          AND d2.corrected = TRUE\n          AND d2.magpsf_corr IS NOT NULL) > 0.5)\nSELECT f.oid,\n       f.value,\n       f.name,\n       f.version,\n       f.fid AS feature_fid, -- requested alias for feature.fid\n\n  (SELECT o.meanra\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meanra,\n\n  (SELECT o.meandec\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS meandec,\n\n  (SELECT o.ndet\n   FROM OBJECT o\n   WHERE o.oid = f.oid) AS ndet, -- corrected magnitudes per band (matching feature_fid = 1 for g, 2 for r)\n\n  (SELECT MAX(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS max_mag,\n\n  (SELECT MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS min_mag,\n\n  (SELECT MAX(d.magpsf_corr) - MIN(d.magpsf_corr)\n   FROM detection d\n   WHERE d.oid = f.oid\n     AND d.fid = f.fid\n     AND d.corrected = TRUE) AS delta_mag\nFROM feature f\nWHERE f.oid IN\n    (SELECT oid\n     FROM eligible_oids)\n  AND f.fid IN (1,\n                2); -- return g and r band feature rows only"
                },
                "in_toks": 5747,
                "out_toks": 5153,
                "id": "chatcmpl-CayS18uHSs5s8xJ8QnO04efVNoWQU",
                "created": 1762928217,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "16": {
        "0": {
            "req_id": "16",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "non_detection",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'non_detection', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'taxonomy', 'magstat', 'detection', 'non_detection']"
                },
                "in_toks": 692,
                "out_toks": 4350,
                "id": "chatcmpl-CSnRmqqE3lmLl6qHtfNw2Pfv1DIXI",
                "created": 1760979294,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH stamp_sn_oids AS\n  (-- OIDs whose highest-probability stamp-classifier class is SN\n SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1),\n     sept_first2_oids AS\n  (-- OIDs with first detection in Sep 01\u201302 (MJD in [60188.0, 60190.0))\n SELECT o.oid\n   FROM OBJECT o\n   WHERE o.firstmjd >= 60188.0\n     AND o.firstmjd < 60190.0\n     AND o.oid IN\n       (SELECT oid\n        FROM stamp_sn_oids)),\n     fast_riser_oids AS\n  (-- OIDs that qualify as fast risers in at least one filter (dmdt_first <= -0.25 mag/day)\n SELECT DISTINCT m.oid\n   FROM magstat m\n   WHERE m.dmdt_first <= -0.25\n     AND m.oid IN\n       (SELECT oid\n        FROM sept_first2_oids))\nSELECT nd.oid, /* stamp-classifier probability for SN (top-ranked); pick the highest prob if multiple versions exist */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   ORDER BY p.probability DESC\n   LIMIT 1) AS probability,\n                                                                                                                         nd.fid, -- non-detection filter ID\n nd.diffmaglim, -- difference-image limiting magnitude (image difference)\n /* filter in magstat that yields the steepest initial brightening (fastest rise) */\n  (SELECT m.fid\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.dmdt_first <= -0.25\n   ORDER BY m.dmdt_first ASC\n   LIMIT 1) AS magstat_fid,\n\n  (SELECT m.dmdt_first\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.dmdt_first <= -0.25\n   ORDER BY m.dmdt_first ASC\n   LIMIT 1) AS initial_rise_estimate\nFROM non_detection nd\nWHERE nd.oid IN\n    (SELECT oid\n     FROM fast_riser_oids)-- keep only non-detections in the same filter as the fast-riser estimate\n\n  AND nd.fid =\n    (SELECT m.fid\n     FROM magstat m\n     WHERE m.oid = nd.oid\n       AND m.dmdt_first <= -0.25\n     ORDER BY m.dmdt_first ASC\n     LIMIT 1)\nORDER BY nd.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH stamp_sn_oids AS\n  (-- OIDs whose highest-probability stamp-classifier class is SN\n SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1),\n     sept_first2_oids AS\n  (-- OIDs with first detection in Sep 01\u201302 (MJD in [60188.0, 60190.0))\n SELECT o.oid\n   FROM OBJECT o\n   WHERE o.firstmjd >= 60188.0\n     AND o.firstmjd < 60190.0\n     AND o.oid IN\n       (SELECT oid\n        FROM stamp_sn_oids)),\n     fast_riser_oids AS\n  (-- OIDs that qualify as fast risers in at least one filter (dmdt_first <= -0.25 mag/day)\n SELECT DISTINCT m.oid\n   FROM magstat m\n   WHERE m.dmdt_first <= -0.25\n     AND m.oid IN\n       (SELECT oid\n        FROM sept_first2_oids))\nSELECT nd.oid, /* stamp-classifier probability for SN (top-ranked); pick the highest prob if multiple versions exist */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   ORDER BY p.probability DESC\n   LIMIT 1) AS probability,\n                                                                                                                         nd.fid, -- non-detection filter ID\n nd.diffmaglim, -- difference-image limiting magnitude (image difference)\n /* filter in magstat that yields the steepest initial brightening (fastest rise) */\n  (SELECT m.fid\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.dmdt_first <= -0.25\n   ORDER BY m.dmdt_first ASC\n   LIMIT 1) AS magstat_fid,\n\n  (SELECT m.dmdt_first\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.dmdt_first <= -0.25\n   ORDER BY m.dmdt_first ASC\n   LIMIT 1) AS initial_rise_estimate\nFROM non_detection nd\nWHERE nd.oid IN\n    (SELECT oid\n     FROM fast_riser_oids)-- keep only non-detections in the same filter as the fast-riser estimate\n\n  AND nd.fid =\n    (SELECT m.fid\n     FROM magstat m\n     WHERE m.oid = nd.oid\n       AND m.dmdt_first <= -0.25\n     ORDER BY m.dmdt_first ASC\n     LIMIT 1)\nORDER BY nd.oid\nLIMIT 100;"
                },
                "in_toks": 4134,
                "out_toks": 5152,
                "id": "chatcmpl-CaySyyMQk0KgMk1A7qt7Kl5ErxFv8",
                "created": 1762928276,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "16",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "detection",
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'non_detection', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'taxonomy', 'magstat', 'detection', 'non_detection']"
                },
                "in_toks": 692,
                "out_toks": 4350,
                "id": "chatcmpl-CSnRmqqE3lmLl6qHtfNw2Pfv1DIXI",
                "created": 1760979294,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with top stamp_classifier class 'SN', first detection on Sept 1\u20132 (MJD 60188\u201360189), and fast-riser behavior (dmdt_first >= 0.25) using the same-filter last non-detection\nWITH candidate_oids AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.firstmjd >= 60188.0\n          AND o.firstmjd < 60190.0)\n     AND EXISTS\n       (SELECT 1\n        FROM magstat ms\n        WHERE ms.oid = p.oid\n          AND ms.firstmjd =\n            (SELECT o2.firstmjd\n             FROM OBJECT o2\n             WHERE o2.oid = p.oid)\n          AND ms.dmdt_first >= 0.25\n          AND EXISTS\n            (SELECT 1\n             FROM non_detection nd\n             WHERE nd.oid = p.oid\n               AND nd.fid = ms.fid\n               AND nd.mjd < ms.firstmjd)))\nSELECT co.oid, -- Highest-probability SN from stamp_classifier (rank=1)\n\n  (SELECT pr.probability\n   FROM probability pr\n   WHERE pr.oid = co.oid\n     AND pr.classifier_name = 'stamp_classifier'\n     AND pr.class_name = 'SN'\n     AND pr.ranking = 1\n   ORDER BY pr.probability DESC\n   LIMIT 1) AS stamp_probability, -- Top lc_classifier probability (rank=1)\n\n  (SELECT pr2.probability\n   FROM probability pr2\n   WHERE pr2.oid = co.oid\n     AND pr2.classifier_name = 'lc_classifier'\n     AND pr2.ranking = 1\n   ORDER BY pr2.probability DESC\n   LIMIT 1) AS lc_probability, -- Last non-detection before the first detection in the same filter: return its fid and diffmaglim\n\n  (SELECT nd.fid\n   FROM non_detection nd\n   WHERE nd.oid = co.oid\n     AND nd.fid =\n       (SELECT ms.fid\n        FROM magstat ms\n        WHERE ms.oid = co.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = co.oid)\n          AND ms.dmdt_first >= 0.25\n        ORDER BY ms.dmdt_first DESC\n        LIMIT 1)\n     AND nd.mjd <\n       (SELECT ms.firstmjd\n        FROM magstat ms\n        WHERE ms.oid = co.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = co.oid)\n          AND ms.dmdt_first >= 0.25\n        ORDER BY ms.dmdt_first DESC\n        LIMIT 1)\n   ORDER BY nd.mjd DESC\n   LIMIT 1) AS fid,\n\n  (SELECT nd.diffmaglim\n   FROM non_detection nd\n   WHERE nd.oid = co.oid\n     AND nd.fid =\n       (SELECT ms.fid\n        FROM magstat ms\n        WHERE ms.oid = co.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = co.oid)\n          AND ms.dmdt_first >= 0.25\n        ORDER BY ms.dmdt_first DESC\n        LIMIT 1)\n     AND nd.mjd <\n       (SELECT ms.firstmjd\n        FROM magstat ms\n        WHERE ms.oid = co.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = co.oid)\n          AND ms.dmdt_first >= 0.25\n        ORDER BY ms.dmdt_first DESC\n        LIMIT 1)\n   ORDER BY nd.mjd DESC\n   LIMIT 1) AS diffmaglim, -- magstat filter of the first detection and its initial rise estimate\n\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = co.oid\n     AND ms.firstmjd =\n       (SELECT o.firstmjd\n        FROM OBJECT o\n        WHERE o.oid = co.oid)\n     AND ms.dmdt_first >= 0.25\n   ORDER BY ms.dmdt_first DESC\n   LIMIT 1) AS magstat_fid,\n\n  (SELECT ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.oid = co.oid\n     AND ms.firstmjd =\n       (SELECT o.firstmjd\n        FROM OBJECT o\n        WHERE o.oid = co.oid)\n     AND ms.dmdt_first >= 0.25\n   ORDER BY ms.dmdt_first DESC\n   LIMIT 1) AS dmdt_first\nFROM candidate_oids co\nORDER BY co.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with top stamp_classifier class 'SN', first detection on Sept 1\u20132 (MJD 60188\u201360189), and fast-riser behavior (dmdt_first >= 0.25) using the same-filter last non-detection\nWITH candidate_oids AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.firstmjd >= 60188.0\n          AND o.firstmjd < 60190.0)\n     AND EXISTS\n       (SELECT 1\n        FROM magstat ms\n        WHERE ms.oid = p.oid\n          AND ms.firstmjd =\n            (SELECT o2.firstmjd\n             FROM OBJECT o2\n             WHERE o2.oid = p.oid)\n          AND ms.dmdt_first >= 0.25\n          AND EXISTS\n            (SELECT 1\n             FROM non_detection nd\n             WHERE nd.oid = p.oid\n               AND nd.fid = ms.fid\n               AND nd.mjd < ms.firstmjd)))\nSELECT co.oid, -- Highest-probability SN from stamp_classifier (rank=1)\n\n  (SELECT pr.probability\n   FROM probability pr\n   WHERE pr.oid = co.oid\n     AND pr.classifier_name = 'stamp_classifier'\n     AND pr.class_name = 'SN'\n     AND pr.ranking = 1\n   ORDER BY pr.probability DESC\n   LIMIT 1) AS stamp_probability, -- Top lc_classifier probability (rank=1)\n\n  (SELECT pr2.probability\n   FROM probability pr2\n   WHERE pr2.oid = co.oid\n     AND pr2.classifier_name = 'lc_classifier'\n     AND pr2.ranking = 1\n   ORDER BY pr2.probability DESC\n   LIMIT 1) AS lc_probability, -- Last non-detection before the first detection in the same filter: return its fid and diffmaglim\n\n  (SELECT nd.fid\n   FROM non_detection nd\n   WHERE nd.oid = co.oid\n     AND nd.fid =\n       (SELECT ms.fid\n        FROM magstat ms\n        WHERE ms.oid = co.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = co.oid)\n          AND ms.dmdt_first >= 0.25\n        ORDER BY ms.dmdt_first DESC\n        LIMIT 1)\n     AND nd.mjd <\n       (SELECT ms.firstmjd\n        FROM magstat ms\n        WHERE ms.oid = co.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = co.oid)\n          AND ms.dmdt_first >= 0.25\n        ORDER BY ms.dmdt_first DESC\n        LIMIT 1)\n   ORDER BY nd.mjd DESC\n   LIMIT 1) AS fid,\n\n  (SELECT nd.diffmaglim\n   FROM non_detection nd\n   WHERE nd.oid = co.oid\n     AND nd.fid =\n       (SELECT ms.fid\n        FROM magstat ms\n        WHERE ms.oid = co.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = co.oid)\n          AND ms.dmdt_first >= 0.25\n        ORDER BY ms.dmdt_first DESC\n        LIMIT 1)\n     AND nd.mjd <\n       (SELECT ms.firstmjd\n        FROM magstat ms\n        WHERE ms.oid = co.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = co.oid)\n          AND ms.dmdt_first >= 0.25\n        ORDER BY ms.dmdt_first DESC\n        LIMIT 1)\n   ORDER BY nd.mjd DESC\n   LIMIT 1) AS diffmaglim, -- magstat filter of the first detection and its initial rise estimate\n\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = co.oid\n     AND ms.firstmjd =\n       (SELECT o.firstmjd\n        FROM OBJECT o\n        WHERE o.oid = co.oid)\n     AND ms.dmdt_first >= 0.25\n   ORDER BY ms.dmdt_first DESC\n   LIMIT 1) AS magstat_fid,\n\n  (SELECT ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.oid = co.oid\n     AND ms.firstmjd =\n       (SELECT o.firstmjd\n        FROM OBJECT o\n        WHERE o.oid = co.oid)\n     AND ms.dmdt_first >= 0.25\n   ORDER BY ms.dmdt_first DESC\n   LIMIT 1) AS dmdt_first\nFROM candidate_oids co\nORDER BY co.oid\nLIMIT 100;"
                },
                "in_toks": 4134,
                "out_toks": 7487,
                "id": "chatcmpl-CayTyCVjFqGP5TY6mYbWwBaBQlCeh",
                "created": 1762928338,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "16",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "non_detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'non_detection', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 1627,
                "id": "chatcmpl-CSsWU7nd3bwFLAGtWN787u9mVaNLs",
                "created": 1760998806,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH candidate_oids AS\n  (/* OIDs with SN as top class in the stamp classifier and first detection in Sep 1\u20132, also qualifying as fast risers */  SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND p.oid IN\n       (SELECT o.oid\n        FROM OBJECT o\n        WHERE o.firstmjd >= 60188.0\n          AND o.firstmjd < 60190.0)\n     AND p.oid IN\n       (SELECT m.oid\n        FROM magstat m\n        WHERE m.dmdt_first >= 0.25)),\n     selected_nd AS\n  (/* Last non-detection before the first detection in the same filter, for fast-riser bands */  SELECT nd.oid,\n                                                                                                        nd.fid,\n                                                                                                        nd.mjd,\n                                                                                                        nd.diffmaglim\n   FROM non_detection nd\n   WHERE nd.oid IN\n       (SELECT oid\n        FROM candidate_oids)\n     AND EXISTS\n       (SELECT 1\n        FROM magstat m\n        WHERE m.oid = nd.oid\n          AND m.fid = nd.fid\n          AND m.dmdt_first >= 0.25)\n     AND nd.mjd =\n       (SELECT MAX(nd2.mjd)\n        FROM non_detection nd2\n        WHERE nd2.oid = nd.oid\n          AND nd2.fid = nd.fid\n          AND nd2.mjd <\n            (SELECT m2.firstmjd\n             FROM magstat m2\n             WHERE m2.oid = nd.oid\n               AND m2.fid = nd.fid\n             ORDER BY m2.firstmjd\n             LIMIT 1)))\nSELECT nd.oid, /* Probability of SN (rank 1) in the stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   LIMIT 1) AS stamp_probability, /* Top probability (rank 1) in the light-curve classifier */\n  (SELECT p2.probability\n   FROM probability p2\n   WHERE p2.oid = nd.oid\n     AND p2.classifier_name = 'lc_classifier'\n     AND p2.ranking = 1\n   LIMIT 1) AS lc_probability, /* Non-detection filter and 5-sigma mag limit in the difference image */  nd.fid AS fid,\n                                                                                                         nd.diffmaglim AS diffmaglim, /* magstat filter id and initial rise estimate (mag/day) */  nd.fid AS magstat_fid,\n\n  (SELECT m.dmdt_first\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n   ORDER BY m.dmdt_first DESC\n   LIMIT 1) AS dmdt_first\nFROM selected_nd nd\nORDER BY nd.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH candidate_oids AS\n  (/* OIDs with SN as top class in the stamp classifier and first detection in Sep 1\u20132, also qualifying as fast risers */  SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND p.oid IN\n       (SELECT o.oid\n        FROM OBJECT o\n        WHERE o.firstmjd >= 60188.0\n          AND o.firstmjd < 60190.0)\n     AND p.oid IN\n       (SELECT m.oid\n        FROM magstat m\n        WHERE m.dmdt_first >= 0.25)),\n     selected_nd AS\n  (/* Last non-detection before the first detection in the same filter, for fast-riser bands */  SELECT nd.oid,\n                                                                                                        nd.fid,\n                                                                                                        nd.mjd,\n                                                                                                        nd.diffmaglim\n   FROM non_detection nd\n   WHERE nd.oid IN\n       (SELECT oid\n        FROM candidate_oids)\n     AND EXISTS\n       (SELECT 1\n        FROM magstat m\n        WHERE m.oid = nd.oid\n          AND m.fid = nd.fid\n          AND m.dmdt_first >= 0.25)\n     AND nd.mjd =\n       (SELECT MAX(nd2.mjd)\n        FROM non_detection nd2\n        WHERE nd2.oid = nd.oid\n          AND nd2.fid = nd.fid\n          AND nd2.mjd <\n            (SELECT m2.firstmjd\n             FROM magstat m2\n             WHERE m2.oid = nd.oid\n               AND m2.fid = nd.fid\n             ORDER BY m2.firstmjd\n             LIMIT 1)))\nSELECT nd.oid, /* Probability of SN (rank 1) in the stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   LIMIT 1) AS stamp_probability, /* Top probability (rank 1) in the light-curve classifier */\n  (SELECT p2.probability\n   FROM probability p2\n   WHERE p2.oid = nd.oid\n     AND p2.classifier_name = 'lc_classifier'\n     AND p2.ranking = 1\n   LIMIT 1) AS lc_probability, /* Non-detection filter and 5-sigma mag limit in the difference image */  nd.fid AS fid,\n                                                                                                         nd.diffmaglim AS diffmaglim, /* magstat filter id and initial rise estimate (mag/day) */  nd.fid AS magstat_fid,\n\n  (SELECT m.dmdt_first\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n   ORDER BY m.dmdt_first DESC\n   LIMIT 1) AS dmdt_first\nFROM selected_nd nd\nORDER BY nd.oid\nLIMIT 100;"
                },
                "in_toks": 3586,
                "out_toks": 4897,
                "id": "chatcmpl-CayV74V3JMSsVQSiS4vLl18tOS4hg",
                "created": 1762928409,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "16",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'non_detection']"
                },
                "in_toks": 692,
                "out_toks": 3227,
                "id": "chatcmpl-CSsWqic1R1snaIHN93TgPdWlqbugL",
                "created": 1760998828,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects: top-ranked stamp classifier = 'SN'; first detection in Sep 1\u20132 (MJD [60188, 60190)); fast risers (dmdt_first >= 0.25) in the same filter\nWITH candidate_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.firstmjd >= 60188.0\n          AND o.firstmjd < 60190.0)\n     AND EXISTS\n       (SELECT 1\n        FROM magstat m\n        WHERE m.oid = p.oid\n          AND m.firstmjd >= 60188.0\n          AND m.firstmjd < 60190.0\n          AND m.dmdt_first >= 0.25))\nSELECT nd.oid, /* stamp classifier probability for SN (top-ranked) */\n  (SELECT p1.probability\n   FROM probability p1\n   WHERE p1.oid = nd.oid\n     AND p1.classifier_name = 'stamp_classifier'\n     AND p1.class_name = 'SN'\n     AND p1.ranking = 1\n   ORDER BY p1.probability DESC\n   LIMIT 1) AS stamp_probability, /* light-curve classifier probability (top-ranked) */\n  (SELECT p2.probability\n   FROM probability p2\n   WHERE p2.oid = nd.oid\n     AND p2.classifier_name = 'lc_classifier'\n     AND p2.ranking = 1\n   ORDER BY p2.probability DESC\n   LIMIT 1) AS lc_probability,\n                                                                                         nd.fid,\n                                                                                         nd.diffmaglim, /* magstat filter (same band meeting fast-riser + date conditions) */\n  (SELECT m.fid\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n     AND m.firstmjd >= 60188.0\n     AND m.firstmjd < 60190.0\n     AND m.dmdt_first >= 0.25\n   LIMIT 1) AS magstat_fid, /* initial rise estimate from magstat */\n  (SELECT m.dmdt_first\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n     AND m.firstmjd >= 60188.0\n     AND m.firstmjd < 60190.0\n     AND m.dmdt_first >= 0.25\n   LIMIT 1) AS initial_rise_estimate\nFROM non_detection nd\nWHERE nd.oid IN\n    (SELECT oid\n     FROM candidate_oids)\n  AND nd.fid IN\n    (SELECT m.fid\n     FROM magstat m\n     WHERE m.oid = nd.oid\n       AND m.firstmjd >= 60188.0\n       AND m.firstmjd < 60190.0\n       AND m.dmdt_first >= 0.25)\nORDER BY nd.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects: top-ranked stamp classifier = 'SN'; first detection in Sep 1\u20132 (MJD [60188, 60190)); fast risers (dmdt_first >= 0.25) in the same filter\nWITH candidate_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND EXISTS\n       (SELECT 1\n        FROM OBJECT o\n        WHERE o.oid = p.oid\n          AND o.firstmjd >= 60188.0\n          AND o.firstmjd < 60190.0)\n     AND EXISTS\n       (SELECT 1\n        FROM magstat m\n        WHERE m.oid = p.oid\n          AND m.firstmjd >= 60188.0\n          AND m.firstmjd < 60190.0\n          AND m.dmdt_first >= 0.25))\nSELECT nd.oid, /* stamp classifier probability for SN (top-ranked) */\n  (SELECT p1.probability\n   FROM probability p1\n   WHERE p1.oid = nd.oid\n     AND p1.classifier_name = 'stamp_classifier'\n     AND p1.class_name = 'SN'\n     AND p1.ranking = 1\n   ORDER BY p1.probability DESC\n   LIMIT 1) AS stamp_probability, /* light-curve classifier probability (top-ranked) */\n  (SELECT p2.probability\n   FROM probability p2\n   WHERE p2.oid = nd.oid\n     AND p2.classifier_name = 'lc_classifier'\n     AND p2.ranking = 1\n   ORDER BY p2.probability DESC\n   LIMIT 1) AS lc_probability,\n                                                                                         nd.fid,\n                                                                                         nd.diffmaglim, /* magstat filter (same band meeting fast-riser + date conditions) */\n  (SELECT m.fid\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n     AND m.firstmjd >= 60188.0\n     AND m.firstmjd < 60190.0\n     AND m.dmdt_first >= 0.25\n   LIMIT 1) AS magstat_fid, /* initial rise estimate from magstat */\n  (SELECT m.dmdt_first\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n     AND m.firstmjd >= 60188.0\n     AND m.firstmjd < 60190.0\n     AND m.dmdt_first >= 0.25\n   LIMIT 1) AS initial_rise_estimate\nFROM non_detection nd\nWHERE nd.oid IN\n    (SELECT oid\n     FROM candidate_oids)\n  AND nd.fid IN\n    (SELECT m.fid\n     FROM magstat m\n     WHERE m.oid = nd.oid\n       AND m.firstmjd >= 60188.0\n       AND m.firstmjd < 60190.0\n       AND m.dmdt_first >= 0.25)\nORDER BY nd.oid\nLIMIT 100;"
                },
                "in_toks": 3586,
                "out_toks": 6474,
                "id": "chatcmpl-CayVpB0gPt1U0MYssI6wfUYmfct2R",
                "created": 1762928453,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "16",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection",
                "non_detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection', 'non_detection', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 2271,
                "id": "chatcmpl-CSsXgoCsGy8hrm2MIiBSeElpgHk9w",
                "created": 1760998880,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Optimized query:\n   - Pre-filter objects with top-ranked SN in the stamp classifier.\n   - Pre-filter magstat to fast risers (dmdt_first >= 0.25) with first detection on 2023-09-01 to 2023-09-02 (MJD [60188, 60190)).\n   - Join to non_detections only in those qualifying band(s) and at or before the first detection.\n   - Return oid, stamp probability, non-detection fid and diffmaglim, magstat fid as magstat_fid, and the rise estimate.\n*/ WITH prob_sn AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1),\n        fast_sep AS\n  (SELECT ms.oid,\n          ms.fid,\n          ms.firstmjd,\n          ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0),\n        eligible AS\n  (SELECT fs.oid,\n          fs.fid,\n          fs.firstmjd,\n          fs.dmdt_first,\n          ps.probability\n   FROM fast_sep fs\n   JOIN prob_sn ps ON ps.oid = fs.oid)\nSELECT nd.oid,\n       e.probability,\n       nd.fid,\n       nd.diffmaglim,\n       e.fid AS magstat_fid,\n       e.dmdt_first\nFROM eligible e\nJOIN non_detection nd ON nd.oid = e.oid\nAND nd.fid = e.fid\nAND nd.mjd <= e.firstmjd\nORDER BY nd.oid\nLIMIT 100;",
            "sql_response": {
                "responses": {
                    "0": "/* Optimized query:\n   - Pre-filter objects with top-ranked SN in the stamp classifier.\n   - Pre-filter magstat to fast risers (dmdt_first >= 0.25) with first detection on 2023-09-01 to 2023-09-02 (MJD [60188, 60190)).\n   - Join to non_detections only in those qualifying band(s) and at or before the first detection.\n   - Return oid, stamp probability, non-detection fid and diffmaglim, magstat fid as magstat_fid, and the rise estimate.\n*/ WITH prob_sn AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1),\n        fast_sep AS\n  (SELECT ms.oid,\n          ms.fid,\n          ms.firstmjd,\n          ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0),\n        eligible AS\n  (SELECT fs.oid,\n          fs.fid,\n          fs.firstmjd,\n          fs.dmdt_first,\n          ps.probability\n   FROM fast_sep fs\n   JOIN prob_sn ps ON ps.oid = fs.oid)\nSELECT nd.oid,\n       e.probability,\n       nd.fid,\n       nd.diffmaglim,\n       e.fid AS magstat_fid,\n       e.dmdt_first\nFROM eligible e\nJOIN non_detection nd ON nd.oid = e.oid\nAND nd.fid = e.fid\nAND nd.mjd <= e.firstmjd\nORDER BY nd.oid\nLIMIT 100;"
                },
                "in_toks": 3671,
                "out_toks": 2954,
                "id": "chatcmpl-Cb9Q707x6iRq2NnquRj4ODKcjHQrR",
                "created": 1762970383,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects with top-ranked SN in stamp classifier, first detection on Sep 1\u20132 (per-band), and fast rise (dmdt_first >= 0.25).\n   Return only non-detections in the qualifying band(s), plus stamp probability, magstat fid and rise estimate. */\nSELECT nd.oid, /* top-ranked SN probability from stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   LIMIT 1) AS probability,\n                                                                      nd.fid,\n                                                                      nd.diffmaglim, /* magstat filter ID and initial rise estimate for the qualifying band */\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.fid = nd.fid\n     AND ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   LIMIT 1) AS magstat_fid,\n\n  (SELECT ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.fid = nd.fid\n     AND ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   LIMIT 1) AS dmdt_first\nFROM non_detection nd\nWHERE nd.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'SN'\n       AND p.ranking = 1\n       AND EXISTS\n         (SELECT 1\n          FROM magstat ms\n          WHERE ms.oid = p.oid\n            AND ms.dmdt_first >= 0.25\n            AND ms.firstmjd >= 60188.0\n            AND ms.firstmjd < 60190.0))\n  AND nd.fid IN\n    (SELECT ms.fid\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.dmdt_first >= 0.25\n       AND ms.firstmjd >= 60188.0\n       AND ms.firstmjd < 60190.0 )/* keep only non-detections at or before the first detection in the qualifying band */\n  AND nd.mjd <=\n    (SELECT ms.firstmjd\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.fid = nd.fid\n       AND ms.dmdt_first >= 0.25\n       AND ms.firstmjd >= 60188.0\n       AND ms.firstmjd < 60190.0\n     LIMIT 1)\nORDER BY nd.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects with top-ranked SN in stamp classifier, first detection on Sep 1\u20132 (per-band), and fast rise (dmdt_first >= 0.25).\n   Return only non-detections in the qualifying band(s), plus stamp probability, magstat fid and rise estimate. */\nSELECT nd.oid, /* top-ranked SN probability from stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   LIMIT 1) AS probability,\n                                                                      nd.fid,\n                                                                      nd.diffmaglim, /* magstat filter ID and initial rise estimate for the qualifying band */\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.fid = nd.fid\n     AND ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   LIMIT 1) AS magstat_fid,\n\n  (SELECT ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.fid = nd.fid\n     AND ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   LIMIT 1) AS dmdt_first\nFROM non_detection nd\nWHERE nd.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'SN'\n       AND p.ranking = 1\n       AND EXISTS\n         (SELECT 1\n          FROM magstat ms\n          WHERE ms.oid = p.oid\n            AND ms.dmdt_first >= 0.25\n            AND ms.firstmjd >= 60188.0\n            AND ms.firstmjd < 60190.0))\n  AND nd.fid IN\n    (SELECT ms.fid\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.dmdt_first >= 0.25\n       AND ms.firstmjd >= 60188.0\n       AND ms.firstmjd < 60190.0 )/* keep only non-detections at or before the first detection in the qualifying band */\n  AND nd.mjd <=\n    (SELECT ms.firstmjd\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.fid = nd.fid\n       AND ms.dmdt_first >= 0.25\n       AND ms.firstmjd >= 60188.0\n       AND ms.firstmjd < 60190.0\n     LIMIT 1)\nORDER BY nd.oid\nLIMIT 100;"
                },
                "in_toks": 4134,
                "out_toks": 5311,
                "id": "chatcmpl-CayWjSB7otEHoKA45b1gozpdKOEPU",
                "created": 1762928509,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "16",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "non_detection",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'non_detection', 'detection', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 1695,
                "id": "chatcmpl-CZMFLpjUrbQls7ZvfGPm0uZMKbWHB",
                "created": 1762543031,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query: preselect fast-riser band per object, then join to probabilities and non-detections\nWITH fast_mag AS\n  (-- Per-oid earliest band (fid) whose first detection is in MJD 60188\u201360190 and is a fast riser\n SELECT DISTINCT ON (ms.oid) ms.oid,\n                    ms.fid,\n                    ms.firstmjd,\n                    ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   ORDER BY ms.oid,\n            ms.firstmjd ASC),\n     stamp AS\n  (-- Top-ranked SN in stamp_classifier; take max prob across versions\n SELECT p.oid,\n        MAX(p.probability) AS stamp_probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   GROUP BY p.oid),\n     lc AS\n  (-- Top-ranked class probability in lc_classifier (ranking=1); take max across versions\n SELECT p.oid,\n        MAX(p.probability) AS lc_probability\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1\n   GROUP BY p.oid),\n     eligible AS\n  (-- Only objects that are fast risers in the window AND whose top stamp class is SN\n SELECT fm.*\n   FROM fast_mag fm\n   JOIN stamp s ON s.oid = fm.oid)\nSELECT nd.oid,\n       s.stamp_probability,\n       l.lc_probability,\n       nd.fid, -- non-detection filter ID\n nd.diffmaglim, -- 5-sigma diff image limit (non-detection)\n e.fid AS magstat_fid, -- band of qualifying first detection\n e.dmdt_first -- initial rise estimate\nFROM eligible e\nJOIN non_detection nd ON nd.oid = e.oid\nAND nd.fid = e.fid\nAND nd.mjd <= e.firstmjd -- only non-detections up to the first detection time\nJOIN stamp s ON s.oid = e.oid\nLEFT JOIN lc l ON l.oid = e.oid\nORDER BY nd.oid\nLIMIT 100;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query: preselect fast-riser band per object, then join to probabilities and non-detections\nWITH fast_mag AS\n  (-- Per-oid earliest band (fid) whose first detection is in MJD 60188\u201360190 and is a fast riser\n SELECT DISTINCT ON (ms.oid) ms.oid,\n                    ms.fid,\n                    ms.firstmjd,\n                    ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   ORDER BY ms.oid,\n            ms.firstmjd ASC),\n     stamp AS\n  (-- Top-ranked SN in stamp_classifier; take max prob across versions\n SELECT p.oid,\n        MAX(p.probability) AS stamp_probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   GROUP BY p.oid),\n     lc AS\n  (-- Top-ranked class probability in lc_classifier (ranking=1); take max across versions\n SELECT p.oid,\n        MAX(p.probability) AS lc_probability\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1\n   GROUP BY p.oid),\n     eligible AS\n  (-- Only objects that are fast risers in the window AND whose top stamp class is SN\n SELECT fm.*\n   FROM fast_mag fm\n   JOIN stamp s ON s.oid = fm.oid)\nSELECT nd.oid,\n       s.stamp_probability,\n       l.lc_probability,\n       nd.fid, -- non-detection filter ID\n nd.diffmaglim, -- 5-sigma diff image limit (non-detection)\n e.fid AS magstat_fid, -- band of qualifying first detection\n e.dmdt_first -- initial rise estimate\nFROM eligible e\nJOIN non_detection nd ON nd.oid = e.oid\nAND nd.fid = e.fid\nAND nd.mjd <= e.firstmjd -- only non-detections up to the first detection time\nJOIN stamp s ON s.oid = e.oid\nLEFT JOIN lc l ON l.oid = e.oid\nORDER BY nd.oid\nLIMIT 100;"
                },
                "in_toks": 3979,
                "out_toks": 3525,
                "id": "chatcmpl-Cb9R4orfkXB9tpQ7kVmcNDEWJMaP2",
                "created": 1762970442,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with top-ranked SN in stamp classifier, first detection in Sep 1\u20132 (MJD 60188\u201360190),\n-- and fast-riser behavior (dmdt_first >= 0.25). Return only non-detections in the same band,\n-- along with probabilities, non-detection fid and diffmaglim, and the magstat fid and rise rate.\nWITH eligible_oids AS\n  (SELECT ms.oid\n   FROM magstat ms\n   WHERE ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n     AND ms.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.ranking = 1\n          AND p.class_name = 'SN'))\nSELECT nd.oid, /* highest-probability (ranking=1) SN in stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND p.class_name = 'SN'\n   ORDER BY p.probability DESC\n   LIMIT 1) AS stamp_probability, /* highest-probability (ranking=1) class in lc_classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1\n   ORDER BY p.probability DESC\n   LIMIT 1) AS lc_probability,\n                                                                                                nd.fid,\n                                                                                                nd.diffmaglim, /* band of the first detection used for fast-riser criterion */\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   ORDER BY ms.firstmjd ASC\n   LIMIT 1) AS magstat_fid, /* initial rise estimate (mag/day) */\n  (SELECT ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   ORDER BY ms.firstmjd ASC\n   LIMIT 1) AS dmdt_first\nFROM non_detection nd\nWHERE nd.oid IN\n    (SELECT oid\n     FROM eligible_oids)/* only non-detections in the same band as the qualifying first detection */\n  AND nd.fid =\n    (SELECT ms.fid\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.dmdt_first >= 0.25\n       AND ms.firstmjd >= 60188.0\n       AND ms.firstmjd < 60190.0\n     ORDER BY ms.firstmjd ASC\n     LIMIT 1) /* only non-detections up to (and including) the first detection time */\n  AND nd.mjd <=\n    (SELECT ms.firstmjd\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.dmdt_first >= 0.25\n       AND ms.firstmjd >= 60188.0\n       AND ms.firstmjd < 60190.0\n     ORDER BY ms.firstmjd ASC\n     LIMIT 1)\nORDER BY nd.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with top-ranked SN in stamp classifier, first detection in Sep 1\u20132 (MJD 60188\u201360190),\n-- and fast-riser behavior (dmdt_first >= 0.25). Return only non-detections in the same band,\n-- along with probabilities, non-detection fid and diffmaglim, and the magstat fid and rise rate.\nWITH eligible_oids AS\n  (SELECT ms.oid\n   FROM magstat ms\n   WHERE ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n     AND ms.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.ranking = 1\n          AND p.class_name = 'SN'))\nSELECT nd.oid, /* highest-probability (ranking=1) SN in stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND p.class_name = 'SN'\n   ORDER BY p.probability DESC\n   LIMIT 1) AS stamp_probability, /* highest-probability (ranking=1) class in lc_classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1\n   ORDER BY p.probability DESC\n   LIMIT 1) AS lc_probability,\n                                                                                                nd.fid,\n                                                                                                nd.diffmaglim, /* band of the first detection used for fast-riser criterion */\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   ORDER BY ms.firstmjd ASC\n   LIMIT 1) AS magstat_fid, /* initial rise estimate (mag/day) */\n  (SELECT ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.dmdt_first >= 0.25\n     AND ms.firstmjd >= 60188.0\n     AND ms.firstmjd < 60190.0\n   ORDER BY ms.firstmjd ASC\n   LIMIT 1) AS dmdt_first\nFROM non_detection nd\nWHERE nd.oid IN\n    (SELECT oid\n     FROM eligible_oids)/* only non-detections in the same band as the qualifying first detection */\n  AND nd.fid =\n    (SELECT ms.fid\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.dmdt_first >= 0.25\n       AND ms.firstmjd >= 60188.0\n       AND ms.firstmjd < 60190.0\n     ORDER BY ms.firstmjd ASC\n     LIMIT 1) /* only non-detections up to (and including) the first detection time */\n  AND nd.mjd <=\n    (SELECT ms.firstmjd\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.dmdt_first >= 0.25\n       AND ms.firstmjd >= 60188.0\n       AND ms.firstmjd < 60190.0\n     ORDER BY ms.firstmjd ASC\n     LIMIT 1)\nORDER BY nd.oid\nLIMIT 100;"
                },
                "in_toks": 4134,
                "out_toks": 5348,
                "id": "chatcmpl-CayXp0M65WwkDoEuKESDem6Lg6NwK",
                "created": 1762928577,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "16",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "non_detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'non_detection', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 2267,
                "id": "chatcmpl-CZMG0vHZ45FXBbkXsQi543NY5a0Pl",
                "created": 1762543072,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with top-ranked SN in stamp classifier and first detection on 2023-09-01 or 2023-09-02 (MJD in [60188.0, 60190.0))\nWITH OIDS AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND p.class_name = 'SN'\n     AND p.oid IN\n       (SELECT o.oid\n        FROM OBJECT o\n        WHERE o.firstmjd >= 60188.0\n          AND o.firstmjd < 60190.0))\nSELECT m.oid, /* highest probability for SN in stamp classifier */\n  (SELECT pr.probability\n   FROM probability pr\n   WHERE pr.oid = m.oid\n     AND pr.classifier_name = 'stamp_classifier'\n     AND pr.class_name = 'SN'\n     AND pr.ranking = 1\n   ORDER BY pr.probability DESC\n   LIMIT 1) AS stamp_probability, /* highest probability in lc_classifier (most general) */\n  (SELECT pr2.probability\n   FROM probability pr2\n   WHERE pr2.oid = m.oid\n     AND pr2.classifier_name = 'lc_classifier'\n     AND pr2.ranking = 1\n   ORDER BY pr2.probability DESC\n   LIMIT 1) AS lc_probability, /* last non-detection before first detection in the same filter */\n  (SELECT nd.fid\n   FROM non_detection nd\n   WHERE nd.oid = m.oid\n     AND nd.fid = m.fid\n     AND nd.mjd < m.firstmjd\n   ORDER BY nd.mjd DESC\n   LIMIT 1) AS fid,\n\n  (SELECT nd.diffmaglim\n   FROM non_detection nd\n   WHERE nd.oid = m.oid\n     AND nd.fid = m.fid\n     AND nd.mjd < m.firstmjd\n   ORDER BY nd.mjd DESC\n   LIMIT 1) AS diffmaglim, /* band info and initial rise estimate from magstat */  m.fid AS magstat_fid,\n                                                                                   m.dmdt_first AS initial_rise_estimate\nFROM magstat m\nWHERE m.oid IN\n    (SELECT oid\n     FROM OIDS)/* fast riser criterion: at least 0.25 mag/day */\n  AND m.dmdt_first >= 0.25 /* include only objects with a non-detection before the first detection in the same filter */\n  AND EXISTS\n    (SELECT 1\n     FROM non_detection nd\n     WHERE nd.oid = m.oid\n       AND nd.fid = m.fid\n       AND nd.mjd < m.firstmjd)\nORDER BY m.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with top-ranked SN in stamp classifier and first detection on 2023-09-01 or 2023-09-02 (MJD in [60188.0, 60190.0))\nWITH OIDS AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND p.class_name = 'SN'\n     AND p.oid IN\n       (SELECT o.oid\n        FROM OBJECT o\n        WHERE o.firstmjd >= 60188.0\n          AND o.firstmjd < 60190.0))\nSELECT m.oid, /* highest probability for SN in stamp classifier */\n  (SELECT pr.probability\n   FROM probability pr\n   WHERE pr.oid = m.oid\n     AND pr.classifier_name = 'stamp_classifier'\n     AND pr.class_name = 'SN'\n     AND pr.ranking = 1\n   ORDER BY pr.probability DESC\n   LIMIT 1) AS stamp_probability, /* highest probability in lc_classifier (most general) */\n  (SELECT pr2.probability\n   FROM probability pr2\n   WHERE pr2.oid = m.oid\n     AND pr2.classifier_name = 'lc_classifier'\n     AND pr2.ranking = 1\n   ORDER BY pr2.probability DESC\n   LIMIT 1) AS lc_probability, /* last non-detection before first detection in the same filter */\n  (SELECT nd.fid\n   FROM non_detection nd\n   WHERE nd.oid = m.oid\n     AND nd.fid = m.fid\n     AND nd.mjd < m.firstmjd\n   ORDER BY nd.mjd DESC\n   LIMIT 1) AS fid,\n\n  (SELECT nd.diffmaglim\n   FROM non_detection nd\n   WHERE nd.oid = m.oid\n     AND nd.fid = m.fid\n     AND nd.mjd < m.firstmjd\n   ORDER BY nd.mjd DESC\n   LIMIT 1) AS diffmaglim, /* band info and initial rise estimate from magstat */  m.fid AS magstat_fid,\n                                                                                   m.dmdt_first AS initial_rise_estimate\nFROM magstat m\nWHERE m.oid IN\n    (SELECT oid\n     FROM OIDS)/* fast riser criterion: at least 0.25 mag/day */\n  AND m.dmdt_first >= 0.25 /* include only objects with a non-detection before the first detection in the same filter */\n  AND EXISTS\n    (SELECT 1\n     FROM non_detection nd\n     WHERE nd.oid = m.oid\n       AND nd.fid = m.fid\n       AND nd.mjd < m.firstmjd)\nORDER BY m.oid\nLIMIT 100;"
                },
                "in_toks": 3586,
                "out_toks": 4970,
                "id": "chatcmpl-CayYuDbgM0stvZNESFg7tNa9bIk41",
                "created": 1762928644,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "16",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection",
                "non_detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection', 'non_detection', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 2527,
                "id": "chatcmpl-CZMH17wfQOYG7oWkKLdnaTcafOEZA",
                "created": 1762543135,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Optimized query:\n   - Filters objects with first detection in [60188.0, 60190.0) (first 2 days of September).\n   - Ensures top class in stamp_classifier is SN (ranking=1).\n   - Selects the magstat band corresponding to the first detection with |dmdt_first| >= 0.25 (fast risers).\n   - Requires an existing last non-detection before that first detection in the same band (uses LATERAL for efficiency).\n   - Returns: oid, stamp classifier probability, non-detection fid (fid), image difference sign (diffpos),\n              magstat fid (magstat_fid), and the initial rise estimate (dmdt_first).\n   - Orders by oid and limits to 100 rows.\n*/ WITH base AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.diffpos,\n          p.probability AS stamp_prob\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   AND p.classifier_name = 'stamp_classifier' -- 1st condition on probability\n\n   AND p.class_name = 'SN' -- 2nd condition on probability\n\n   AND p.ranking = 1 -- 3rd condition on probability\n\n   WHERE o.firstmjd >= 60188.0\n     AND o.firstmjd < 60190.0),\n        ms_sel AS\n  (SELECT b.oid,\n          ms.fid AS magstat_fid,\n          ms.dmdt_first,\n          ms.firstmjd\n   FROM base b\n   JOIN LATERAL\n     (SELECT ms.*\n      FROM magstat ms\n      WHERE ms.oid = b.oid\n        AND ms.firstmjd = b.firstmjd\n        AND ABS(ms.dmdt_first) >= 0.25\n      ORDER BY ABS(ms.dmdt_first) DESC NULLS LAST\n      LIMIT 1) ms ON TRUE),\n        nd_last AS\n  (SELECT m.oid,\n          n.fid,\n          n.mjd AS last_non_det_mjd\n   FROM ms_sel m\n   JOIN LATERAL\n     (SELECT n.*\n      FROM non_detection n\n      WHERE n.oid = m.oid\n        AND n.fid = m.magstat_fid\n        AND n.mjd < m.firstmjd\n      ORDER BY n.mjd DESC\n      LIMIT 1) n ON TRUE)\nSELECT b.oid,\n       b.stamp_prob AS probability,\n       nd.fid,\n       b.diffpos,\n       ms.magstat_fid,\n       ms.dmdt_first AS initial_rise_estimate\nFROM base b\nJOIN ms_sel ms ON ms.oid = b.oid\nJOIN nd_last nd ON nd.oid = b.oid\nORDER BY b.oid\nLIMIT 100;",
            "sql_response": {
                "responses": {
                    "0": "/* Optimized query:\n   - Filters objects with first detection in [60188.0, 60190.0) (first 2 days of September).\n   - Ensures top class in stamp_classifier is SN (ranking=1).\n   - Selects the magstat band corresponding to the first detection with |dmdt_first| >= 0.25 (fast risers).\n   - Requires an existing last non-detection before that first detection in the same band (uses LATERAL for efficiency).\n   - Returns: oid, stamp classifier probability, non-detection fid (fid), image difference sign (diffpos),\n              magstat fid (magstat_fid), and the initial rise estimate (dmdt_first).\n   - Orders by oid and limits to 100 rows.\n*/ WITH base AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.diffpos,\n          p.probability AS stamp_prob\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   AND p.classifier_name = 'stamp_classifier' -- 1st condition on probability\n\n   AND p.class_name = 'SN' -- 2nd condition on probability\n\n   AND p.ranking = 1 -- 3rd condition on probability\n\n   WHERE o.firstmjd >= 60188.0\n     AND o.firstmjd < 60190.0),\n        ms_sel AS\n  (SELECT b.oid,\n          ms.fid AS magstat_fid,\n          ms.dmdt_first,\n          ms.firstmjd\n   FROM base b\n   JOIN LATERAL\n     (SELECT ms.*\n      FROM magstat ms\n      WHERE ms.oid = b.oid\n        AND ms.firstmjd = b.firstmjd\n        AND ABS(ms.dmdt_first) >= 0.25\n      ORDER BY ABS(ms.dmdt_first) DESC NULLS LAST\n      LIMIT 1) ms ON TRUE),\n        nd_last AS\n  (SELECT m.oid,\n          n.fid,\n          n.mjd AS last_non_det_mjd\n   FROM ms_sel m\n   JOIN LATERAL\n     (SELECT n.*\n      FROM non_detection n\n      WHERE n.oid = m.oid\n        AND n.fid = m.magstat_fid\n        AND n.mjd < m.firstmjd\n      ORDER BY n.mjd DESC\n      LIMIT 1) n ON TRUE)\nSELECT b.oid,\n       b.stamp_prob AS probability,\n       nd.fid,\n       b.diffpos,\n       ms.magstat_fid,\n       ms.dmdt_first AS initial_rise_estimate\nFROM base b\nJOIN ms_sel ms ON ms.oid = b.oid\nJOIN nd_last nd ON nd.oid = b.oid\nORDER BY b.oid\nLIMIT 100;"
                },
                "in_toks": 4357,
                "out_toks": 4246,
                "id": "chatcmpl-Cb9SAaDTpSpgwjDp3KmSZ0dpyDn8V",
                "created": 1762970510,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects:\n   - first detection in Sept 1\u20132 (MJD in [60188.0, 60190.0) ),\n   - stamp_classifier top class is SN (ranking=1),\n   - fast risers: |dmdt_first| >= 0.25 in the band of the first detection,\n   - and there exists a last non-detection before that first detection in the same band.\n   Assumption: \"image difference\" refers to object.diffpos (first detection difference sign).\n*/ WITH candidates AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.firstmjd >= 60188.0\n     AND o.firstmjd < 60190.0\n     AND EXISTS\n       (SELECT 1\n        FROM probability ps\n        WHERE ps.oid = o.oid\n          AND ps.classifier_name = 'stamp_classifier'\n          AND ps.ranking = 1\n          AND ps.class_name = 'SN' )/* Fast riser in the band of the first detection, ensure a prior non-detection exists in that band */\n     AND EXISTS\n       (SELECT 1\n        FROM magstat ms\n        WHERE ms.oid = o.oid\n          AND ms.firstmjd = o.firstmjd /* Using absolute value to satisfy \"brighter by at least 0.25 mag/day\" irrespective of sign convention */\n          AND ABS(ms.dmdt_first) >= 0.25\n          AND EXISTS\n            (SELECT 1\n             FROM non_detection n\n             WHERE n.oid = o.oid\n               AND n.fid = ms.fid\n               AND n.mjd < ms.firstmjd)))\nSELECT p.oid,\n       p.probability, /* Filter ID from the last non-detection before the first detection (same band) */\n  (SELECT n.fid\n   FROM non_detection n\n   WHERE n.oid = p.oid\n     AND n.fid =\n       (SELECT ms.fid\n        FROM magstat ms\n        WHERE ms.oid = p.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = p.oid)\n        ORDER BY ABS(ms.dmdt_first) DESC NULLS LAST\n        LIMIT 1)\n     AND n.mjd =\n       (SELECT MAX(n2.mjd)\n        FROM non_detection n2\n        WHERE n2.oid = p.oid\n          AND n2.fid =\n            (SELECT ms2.fid\n             FROM magstat ms2\n             WHERE ms2.oid = p.oid\n               AND ms2.firstmjd =\n                 (SELECT o2.firstmjd\n                  FROM OBJECT o2\n                  WHERE o2.oid = p.oid)\n             ORDER BY ABS(ms2.dmdt_first) DESC NULLS LAST\n             LIMIT 1)\n          AND n2.mjd <\n            (SELECT ms3.firstmjd\n             FROM magstat ms3\n             WHERE ms3.oid = p.oid\n               AND ms3.firstmjd =\n                 (SELECT o3.firstmjd\n                  FROM OBJECT o3\n                  WHERE o3.oid = p.oid)\n             ORDER BY ABS(ms3.dmdt_first) DESC NULLS LAST\n             LIMIT 1))\n   LIMIT 1) AS fid, /* Image difference for the first detection */\n  (SELECT o.diffpos\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS diffpos, /* magstat band corresponding to the first detection */\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = p.oid\n     AND ms.firstmjd =\n       (SELECT o.firstmjd\n        FROM OBJECT o\n        WHERE o.oid = p.oid)\n   ORDER BY ABS(ms.dmdt_first) DESC NULLS LAST\n   LIMIT 1) AS magstat_fid, /* Initial rise estimate dmdt_first in that band */\n  (SELECT ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.oid = p.oid\n     AND ms.firstmjd =\n       (SELECT o.firstmjd\n        FROM OBJECT o\n        WHERE o.oid = p.oid)\n   ORDER BY ABS(ms.dmdt_first) DESC NULLS LAST\n   LIMIT 1) AS initial_rise_estimate\nFROM probability p\nWHERE p.oid IN\n    (SELECT oid\n     FROM candidates)\n  AND p.ranking = 1\n  AND p.classifier_name IN ('stamp_classifier',\n                            'lc_classifier')\nORDER BY p.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects:\n   - first detection in Sept 1\u20132 (MJD in [60188.0, 60190.0) ),\n   - stamp_classifier top class is SN (ranking=1),\n   - fast risers: |dmdt_first| >= 0.25 in the band of the first detection,\n   - and there exists a last non-detection before that first detection in the same band.\n   Assumption: \"image difference\" refers to object.diffpos (first detection difference sign).\n*/ WITH candidates AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.firstmjd >= 60188.0\n     AND o.firstmjd < 60190.0\n     AND EXISTS\n       (SELECT 1\n        FROM probability ps\n        WHERE ps.oid = o.oid\n          AND ps.classifier_name = 'stamp_classifier'\n          AND ps.ranking = 1\n          AND ps.class_name = 'SN' )/* Fast riser in the band of the first detection, ensure a prior non-detection exists in that band */\n     AND EXISTS\n       (SELECT 1\n        FROM magstat ms\n        WHERE ms.oid = o.oid\n          AND ms.firstmjd = o.firstmjd /* Using absolute value to satisfy \"brighter by at least 0.25 mag/day\" irrespective of sign convention */\n          AND ABS(ms.dmdt_first) >= 0.25\n          AND EXISTS\n            (SELECT 1\n             FROM non_detection n\n             WHERE n.oid = o.oid\n               AND n.fid = ms.fid\n               AND n.mjd < ms.firstmjd)))\nSELECT p.oid,\n       p.probability, /* Filter ID from the last non-detection before the first detection (same band) */\n  (SELECT n.fid\n   FROM non_detection n\n   WHERE n.oid = p.oid\n     AND n.fid =\n       (SELECT ms.fid\n        FROM magstat ms\n        WHERE ms.oid = p.oid\n          AND ms.firstmjd =\n            (SELECT o.firstmjd\n             FROM OBJECT o\n             WHERE o.oid = p.oid)\n        ORDER BY ABS(ms.dmdt_first) DESC NULLS LAST\n        LIMIT 1)\n     AND n.mjd =\n       (SELECT MAX(n2.mjd)\n        FROM non_detection n2\n        WHERE n2.oid = p.oid\n          AND n2.fid =\n            (SELECT ms2.fid\n             FROM magstat ms2\n             WHERE ms2.oid = p.oid\n               AND ms2.firstmjd =\n                 (SELECT o2.firstmjd\n                  FROM OBJECT o2\n                  WHERE o2.oid = p.oid)\n             ORDER BY ABS(ms2.dmdt_first) DESC NULLS LAST\n             LIMIT 1)\n          AND n2.mjd <\n            (SELECT ms3.firstmjd\n             FROM magstat ms3\n             WHERE ms3.oid = p.oid\n               AND ms3.firstmjd =\n                 (SELECT o3.firstmjd\n                  FROM OBJECT o3\n                  WHERE o3.oid = p.oid)\n             ORDER BY ABS(ms3.dmdt_first) DESC NULLS LAST\n             LIMIT 1))\n   LIMIT 1) AS fid, /* Image difference for the first detection */\n  (SELECT o.diffpos\n   FROM OBJECT o\n   WHERE o.oid = p.oid) AS diffpos, /* magstat band corresponding to the first detection */\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = p.oid\n     AND ms.firstmjd =\n       (SELECT o.firstmjd\n        FROM OBJECT o\n        WHERE o.oid = p.oid)\n   ORDER BY ABS(ms.dmdt_first) DESC NULLS LAST\n   LIMIT 1) AS magstat_fid, /* Initial rise estimate dmdt_first in that band */\n  (SELECT ms.dmdt_first\n   FROM magstat ms\n   WHERE ms.oid = p.oid\n     AND ms.firstmjd =\n       (SELECT o.firstmjd\n        FROM OBJECT o\n        WHERE o.oid = p.oid)\n   ORDER BY ABS(ms.dmdt_first) DESC NULLS LAST\n   LIMIT 1) AS initial_rise_estimate\nFROM probability p\nWHERE p.oid IN\n    (SELECT oid\n     FROM candidates)\n  AND p.ranking = 1\n  AND p.classifier_name IN ('stamp_classifier',\n                            'lc_classifier')\nORDER BY p.oid\nLIMIT 100;"
                },
                "in_toks": 4134,
                "out_toks": 7183,
                "id": "chatcmpl-CayaMsbP1kAKYwupEA9lLBjIedys9",
                "created": 1762928734,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "16",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "non_detection",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'non_detection', 'detection']"
                },
                "in_toks": 692,
                "out_toks": 1951,
                "id": "chatcmpl-CZMI2y8axCkX04moWYZe8H5i2BDGD",
                "created": 1762543198,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects with top-ranked stamp_classifier class 'SN', first detection on Sep 1\u20132 (MJD [60188, 60190)), and fast-riser behavior.\n   Returns one row per object: last non-detection before first detection (same filter), with stamp and LC probabilities, non-detection info, magstat fid, and initial rise estimate. */\nSELECT nd.oid, /* top probability for SN in stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   LIMIT 1) AS stamp_prob, /* top probability in lc_classifier (most likely class) */\n  (SELECT p2.probability\n   FROM probability p2\n   WHERE p2.oid = nd.oid\n     AND p2.classifier_name = 'lc_classifier'\n     AND p2.ranking = 1\n   ORDER BY p2.probability DESC\n   LIMIT 1) AS lc_prob,\n                                                                                       nd.fid AS fid,\n                                                                                       nd.diffmaglim AS diffmaglim, /* magstat filter for the earliest first detection */\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.firstmjd =\n       (SELECT MIN(ms2.firstmjd)\n        FROM magstat ms2\n        WHERE ms2.oid = nd.oid)\n   LIMIT 1) AS magstat_fid, /* initial rise estimate: prefer dm_first/dt_first; fallback to dmdt_first */\n  (SELECT COALESCE(CASE\n                       WHEN ms.dt_first IS NOT NULL\n                            AND ms.dt_first > 0 THEN ms.dm_first / ms.dt_first\n                       ELSE NULL\n                   END, ms.dmdt_first)\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.firstmjd =\n       (SELECT MIN(ms2.firstmjd)\n        FROM magstat ms2\n        WHERE ms2.oid = nd.oid)\n   LIMIT 1) AS initial_rise\nFROM non_detection nd\nWHERE /* restrict to oids meeting all conditions */  nd.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.firstmjd >= 60188.0\n       AND o.firstmjd < 60190.0\n       AND o.oid IN\n         (SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'SN'\n            AND p.ranking = 1)\n       AND EXISTS\n         (SELECT 1\n          FROM magstat ms\n          WHERE ms.oid = o.oid\n            AND ms.firstmjd =\n              (SELECT MIN(ms2.firstmjd)\n               FROM magstat ms2\n               WHERE ms2.oid = o.oid) /* fast riser: brighten rate <= -0.25 mag/day */\n            AND COALESCE(CASE\n                             WHEN ms.dt_first IS NOT NULL\n                                  AND ms.dt_first > 0 THEN ms.dm_first / ms.dt_first\n                             ELSE NULL\n                         END, ms.dmdt_first) <= -0.25) )/* only non-detections in the same filter as the earliest first detection */\n  AND nd.fid =\n    (SELECT ms.fid\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.firstmjd =\n         (SELECT MIN(ms2.firstmjd)\n          FROM magstat ms2\n          WHERE ms2.oid = nd.oid)\n     LIMIT 1) /* pick the last non-detection before that first detection in the same filter */\n  AND nd.mjd =\n    (SELECT MAX(nd2.mjd)\n     FROM non_detection nd2\n     WHERE nd2.oid = nd.oid\n       AND nd2.fid = nd.fid\n       AND nd2.mjd <\n         (SELECT ms.firstmjd\n          FROM magstat ms\n          WHERE ms.oid = nd.oid\n            AND ms.fid = nd.fid\n          ORDER BY ms.firstmjd ASC\n          LIMIT 1))\nORDER BY nd.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects with top-ranked stamp_classifier class 'SN', first detection on Sep 1\u20132 (MJD [60188, 60190)), and fast-riser behavior.\n   Returns one row per object: last non-detection before first detection (same filter), with stamp and LC probabilities, non-detection info, magstat fid, and initial rise estimate. */\nSELECT nd.oid, /* top probability for SN in stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n   LIMIT 1) AS stamp_prob, /* top probability in lc_classifier (most likely class) */\n  (SELECT p2.probability\n   FROM probability p2\n   WHERE p2.oid = nd.oid\n     AND p2.classifier_name = 'lc_classifier'\n     AND p2.ranking = 1\n   ORDER BY p2.probability DESC\n   LIMIT 1) AS lc_prob,\n                                                                                       nd.fid AS fid,\n                                                                                       nd.diffmaglim AS diffmaglim, /* magstat filter for the earliest first detection */\n  (SELECT ms.fid\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.firstmjd =\n       (SELECT MIN(ms2.firstmjd)\n        FROM magstat ms2\n        WHERE ms2.oid = nd.oid)\n   LIMIT 1) AS magstat_fid, /* initial rise estimate: prefer dm_first/dt_first; fallback to dmdt_first */\n  (SELECT COALESCE(CASE\n                       WHEN ms.dt_first IS NOT NULL\n                            AND ms.dt_first > 0 THEN ms.dm_first / ms.dt_first\n                       ELSE NULL\n                   END, ms.dmdt_first)\n   FROM magstat ms\n   WHERE ms.oid = nd.oid\n     AND ms.firstmjd =\n       (SELECT MIN(ms2.firstmjd)\n        FROM magstat ms2\n        WHERE ms2.oid = nd.oid)\n   LIMIT 1) AS initial_rise\nFROM non_detection nd\nWHERE /* restrict to oids meeting all conditions */  nd.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.firstmjd >= 60188.0\n       AND o.firstmjd < 60190.0\n       AND o.oid IN\n         (SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'SN'\n            AND p.ranking = 1)\n       AND EXISTS\n         (SELECT 1\n          FROM magstat ms\n          WHERE ms.oid = o.oid\n            AND ms.firstmjd =\n              (SELECT MIN(ms2.firstmjd)\n               FROM magstat ms2\n               WHERE ms2.oid = o.oid) /* fast riser: brighten rate <= -0.25 mag/day */\n            AND COALESCE(CASE\n                             WHEN ms.dt_first IS NOT NULL\n                                  AND ms.dt_first > 0 THEN ms.dm_first / ms.dt_first\n                             ELSE NULL\n                         END, ms.dmdt_first) <= -0.25) )/* only non-detections in the same filter as the earliest first detection */\n  AND nd.fid =\n    (SELECT ms.fid\n     FROM magstat ms\n     WHERE ms.oid = nd.oid\n       AND ms.firstmjd =\n         (SELECT MIN(ms2.firstmjd)\n          FROM magstat ms2\n          WHERE ms2.oid = nd.oid)\n     LIMIT 1) /* pick the last non-detection before that first detection in the same filter */\n  AND nd.mjd =\n    (SELECT MAX(nd2.mjd)\n     FROM non_detection nd2\n     WHERE nd2.oid = nd.oid\n       AND nd2.fid = nd.fid\n       AND nd2.mjd <\n         (SELECT ms.firstmjd\n          FROM magstat ms\n          WHERE ms.oid = nd.oid\n            AND ms.fid = nd.fid\n          ORDER BY ms.firstmjd ASC\n          LIMIT 1))\nORDER BY nd.oid\nLIMIT 100;"
                },
                "in_toks": 4134,
                "out_toks": 5589,
                "id": "chatcmpl-Cb4wM3YDa5MH41IrP7UDFnh7EHpBj",
                "created": 1762953162,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "16",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "non_detection",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'non_detection', 'detection', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 1439,
                "id": "chatcmpl-CZMJ3ZJhPsPpwVZqapNGWhmIt75Ln",
                "created": 1762543261,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with top-ranked SN in stamp classifier, first detection on Sep 1\u20132 (MJD 60188\u201360189),\n-- and fast risers (per-filter dmdt_first <= -0.25). Return non-detections only.\n\nSELECT nd.oid, /* Probability for SN in the stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n   ORDER BY p.probability DESC\n   LIMIT 1) AS probability, /* Non-detection filter and difference image magnitude limit */  nd.fid,\n                                                                                             nd.diffmaglim, /* magstat filter ID and initial rise estimate */\n  (SELECT m.fid\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n   LIMIT 1) AS magstat_fid,\n\n  (SELECT m.dmdt_first\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n   LIMIT 1) AS dmdt_first\nFROM non_detection nd\nWHERE /* Keep only objects whose top stamp class is SN */  nd.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'SN'\n       AND p.ranking = 1 )/* First detection in the first two days of September */\n  AND nd.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.firstmjd >= 60188.0\n       AND o.firstmjd < 60190.0 )/* Fast riser condition per filter */\n  AND EXISTS\n    (SELECT 1\n     FROM magstat m\n     WHERE m.oid = nd.oid\n       AND m.fid = nd.fid\n       AND m.dmdt_first <= -0.25)\nORDER BY nd.oid\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with top-ranked SN in stamp classifier, first detection on Sep 1\u20132 (MJD 60188\u201360189),\n-- and fast risers (per-filter dmdt_first <= -0.25). Return non-detections only.\n\nSELECT nd.oid, /* Probability for SN in the stamp classifier */\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = nd.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n   ORDER BY p.probability DESC\n   LIMIT 1) AS probability, /* Non-detection filter and difference image magnitude limit */  nd.fid,\n                                                                                             nd.diffmaglim, /* magstat filter ID and initial rise estimate */\n  (SELECT m.fid\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n   LIMIT 1) AS magstat_fid,\n\n  (SELECT m.dmdt_first\n   FROM magstat m\n   WHERE m.oid = nd.oid\n     AND m.fid = nd.fid\n   LIMIT 1) AS dmdt_first\nFROM non_detection nd\nWHERE /* Keep only objects whose top stamp class is SN */  nd.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'SN'\n       AND p.ranking = 1 )/* First detection in the first two days of September */\n  AND nd.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.firstmjd >= 60188.0\n       AND o.firstmjd < 60190.0 )/* Fast riser condition per filter */\n  AND EXISTS\n    (SELECT 1\n     FROM magstat m\n     WHERE m.oid = nd.oid\n       AND m.fid = nd.fid\n       AND m.dmdt_first <= -0.25)\nORDER BY nd.oid\nLIMIT 100;"
                },
                "in_toks": 4134,
                "out_toks": 5641,
                "id": "chatcmpl-CaydN3ZcA67povbQjjmEwdBxhJ9mM",
                "created": 1762928921,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "19": {
        "0": {
            "req_id": "19",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']",
                    "1": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 664,
                "out_toks": 1126,
                "id": "chatcmpl-CSnSQX7JhQ2bzdV9fJncCGsRe0F3y",
                "created": 1760979334,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Objects with first detection between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0),\n-- with at most one detection (ndet <= 1),\n-- classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Optimized by first filtering the object table, then joining to the probability table\n-- and selecting the highest-probability (ranking=1) entry per object.\nWITH objs AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1),\n     best_prob AS\n  (SELECT pr.oid,\n          pr.class_name,\n          pr.probability,\n          ROW_NUMBER() OVER (PARTITION BY pr.oid\n                             ORDER BY pr.probability DESC) AS rn\n   FROM probability pr\n   JOIN objs o ON o.oid = pr.oid\n   WHERE pr.classifier_name = 'stamp_classifier'\n     AND pr.class_name = 'asteroid'\n     AND pr.ranking = 1\n     AND pr.probability > 0.7)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS \"firstMJD\",\n       bp.class_name AS \"class name\",\n       bp.probability\nFROM objs o\nJOIN best_prob bp ON bp.oid = o.oid\nAND bp.rn = 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Objects with first detection between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0),\n-- with at most one detection (ndet <= 1),\n-- classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Optimized by first filtering the object table, then joining to the probability table\n-- and selecting the highest-probability (ranking=1) entry per object.\nWITH objs AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1),\n     best_prob AS\n  (SELECT pr.oid,\n          pr.class_name,\n          pr.probability,\n          ROW_NUMBER() OVER (PARTITION BY pr.oid\n                             ORDER BY pr.probability DESC) AS rn\n   FROM probability pr\n   JOIN objs o ON o.oid = pr.oid\n   WHERE pr.classifier_name = 'stamp_classifier'\n     AND pr.class_name = 'asteroid'\n     AND pr.ranking = 1\n     AND pr.probability > 0.7)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS \"firstMJD\",\n       bp.class_name AS \"class name\",\n       bp.probability\nFROM objs o\nJOIN best_prob bp ON bp.oid = o.oid\nAND bp.rn = 1;"
                },
                "in_toks": 1915,
                "out_toks": 2410,
                "id": "chatcmpl-Cb9TANssCPQJ0vDYRJLubIbw7iJXi",
                "created": 1762970572,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with first detection between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0),\n-- with at most one detection (ndet <= 1),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    -- class_name and probability taken from the stamp_classifier 'asteroid' entry with the highest probability (> 0.7)\n    (SELECT p.class_name\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'asteroid'\n       AND p.probability > 0.7\n     ORDER BY p.probability DESC\n     LIMIT 1) AS class_name,\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'asteroid'\n       AND p.probability > 0.7\n     ORDER BY p.probability DESC\n     LIMIT 1) AS probability\nFROM object o\nWHERE o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.ndet <= 1\n  AND o.oid IN (\n      SELECT pr.oid\n      FROM probability pr\n      WHERE pr.classifier_name = 'stamp_classifier'\n        AND pr.class_name = 'asteroid'\n        AND pr.probability > 0.7\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with first detection between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0),\n-- with at most one detection (ndet <= 1),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    -- class_name and probability taken from the stamp_classifier 'asteroid' entry with the highest probability (> 0.7)\n    (SELECT p.class_name\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'asteroid'\n       AND p.probability > 0.7\n     ORDER BY p.probability DESC\n     LIMIT 1) AS class_name,\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.class_name = 'asteroid'\n       AND p.probability > 0.7\n     ORDER BY p.probability DESC\n     LIMIT 1) AS probability\nFROM object o\nWHERE o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.ndet <= 1\n  AND o.oid IN (\n      SELECT pr.oid\n      FROM probability pr\n      WHERE pr.classifier_name = 'stamp_classifier'\n        AND pr.class_name = 'asteroid'\n        AND pr.probability > 0.7\n  );"
                },
                "in_toks": 2693,
                "out_toks": 3253,
                "id": "chatcmpl-CSoND1mcLVNuB3GxgWd3p75dvFjgw",
                "created": 1760982855,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "19",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']",
                    "1": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 664,
                "out_toks": 1126,
                "id": "chatcmpl-CSnSQX7JhQ2bzdV9fJncCGsRe0F3y",
                "created": 1760979334,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Objects with at most one detection (ndet <= 1), first detected between 2021-03-01 and 2021-04-01,\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- MJD bounds: 2021-03-01 = 59274.0, 2021-04-01 = 59305.0 (upper bound exclusive).\n-- Use a pre-filter on object and a DISTINCT ON subquery on probability to avoid correlated subqueries and timeouts.\n-- Per guidelines, include ranking = 1 in the probability filter.\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS \"firstMJD\",\n       pb.class_name,\n       pb.probability\nFROM\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1) AS o\nJOIN\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.class_name,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n   ORDER BY p.oid,\n            p.probability DESC) AS pb ON pb.oid = o.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Objects with at most one detection (ndet <= 1), first detected between 2021-03-01 and 2021-04-01,\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- MJD bounds: 2021-03-01 = 59274.0, 2021-04-01 = 59305.0 (upper bound exclusive).\n-- Use a pre-filter on object and a DISTINCT ON subquery on probability to avoid correlated subqueries and timeouts.\n-- Per guidelines, include ranking = 1 in the probability filter.\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS \"firstMJD\",\n       pb.class_name,\n       pb.probability\nFROM\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1) AS o\nJOIN\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.class_name,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n   ORDER BY p.oid,\n            p.probability DESC) AS pb ON pb.oid = o.oid;"
                },
                "in_toks": 2041,
                "out_toks": 1942,
                "id": "chatcmpl-Cb9Ta5yLrOnhyVqf9E90AjA0tBTP2",
                "created": 1762970598,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with at most one detection (ndet <= 1), first detected between 2021-03-01 and 2021-04-01,\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- MJD bounds: 2021-03-01 = 59274.0, 2021-04-01 = 59305.0 (upper bound exclusive).\n-- \"Appeared\" is interpreted as firstmjd within the interval (no detection table provided).\n\nWITH asteroid_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Return the matching stamp_classifier class_name (should be 'asteroid') */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    /* Return the highest qualifying probability (> 0.7) for this oid */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE o.oid IN (SELECT oid FROM asteroid_oids)\n  AND o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.ndet <= 1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with at most one detection (ndet <= 1), first detected between 2021-03-01 and 2021-04-01,\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- MJD bounds: 2021-03-01 = 59274.0, 2021-04-01 = 59305.0 (upper bound exclusive).\n-- \"Appeared\" is interpreted as firstmjd within the interval (no detection table provided).\n\nWITH asteroid_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Return the matching stamp_classifier class_name (should be 'asteroid') */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    /* Return the highest qualifying probability (> 0.7) for this oid */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE o.oid IN (SELECT oid FROM asteroid_oids)\n  AND o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.ndet <= 1;"
                },
                "in_toks": 2693,
                "out_toks": 2805,
                "id": "chatcmpl-CSoNmsHvEinjCJyVMcN1J24KZ0flY",
                "created": 1760982890,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "19",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 664,
                "out_toks": 723,
                "id": "chatcmpl-CSsYLhyLqAFBEOq3AVb0Wb3KYJFC7",
                "created": 1760998921,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query: filter objects first, then join to a compact set of asteroid classifications.\n-- Use DISTINCT ON to keep the highest-probability asteroid row per oid, and require ranking=1.\n WITH p_best AS\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.class_name,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- classifier filter\n\n     AND p.class_name = 'asteroid' -- class filter\n\n     AND p.ranking = 1 -- keep only top-ranked class per classifier\n\n     AND p.probability > 0.7 -- probability threshold\n\n   ORDER BY p.oid,\n            p.probability DESC -- highest probability per oid\n)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS firstMJD,\n       pb.class_name,\n       pb.probability\nFROM OBJECT o\nJOIN p_best pb ON pb.oid = o.oid\nWHERE o.ndet <= 1\n  AND o.firstmjd >= 59274.0 -- 2021-03-01 (MJD)\n\n  AND o.firstmjd < 59305.0; -- 2021-04-01 (MJD, exclusive)",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query: filter objects first, then join to a compact set of asteroid classifications.\n-- Use DISTINCT ON to keep the highest-probability asteroid row per oid, and require ranking=1.\n WITH p_best AS\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.class_name,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- classifier filter\n\n     AND p.class_name = 'asteroid' -- class filter\n\n     AND p.ranking = 1 -- keep only top-ranked class per classifier\n\n     AND p.probability > 0.7 -- probability threshold\n\n   ORDER BY p.oid,\n            p.probability DESC -- highest probability per oid\n)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS firstMJD,\n       pb.class_name,\n       pb.probability\nFROM OBJECT o\nJOIN p_best pb ON pb.oid = o.oid\nWHERE o.ndet <= 1\n  AND o.firstmjd >= 59274.0 -- 2021-03-01 (MJD)\n\n  AND o.firstmjd < 59305.0; -- 2021-04-01 (MJD, exclusive)"
                },
                "in_toks": 2000,
                "out_toks": 2148,
                "id": "chatcmpl-Cb9TxjD2O2rHGdnYvc56qmACwUsay",
                "created": 1762970621,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with at most one detection (ndet <= 1), whose first detection occurred between\n-- 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0)),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Assumption: \"appeared between\" is interpreted as firstmjd within the interval.\n\nWITH asteroid_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n    GROUP BY p.oid\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Fetch the asteroid class_name (should be 'asteroid') with the highest probability for this oid */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE o.ndet <= 1\n  AND o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.oid IN (SELECT ao.oid FROM asteroid_oids ao);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with at most one detection (ndet <= 1), whose first detection occurred between\n-- 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0)),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Assumption: \"appeared between\" is interpreted as firstmjd within the interval.\n\nWITH asteroid_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n    GROUP BY p.oid\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Fetch the asteroid class_name (should be 'asteroid') with the highest probability for this oid */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE o.ndet <= 1\n  AND o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.oid IN (SELECT ao.oid FROM asteroid_oids ao);"
                },
                "in_toks": 2693,
                "out_toks": 2912,
                "id": "chatcmpl-CSt03jUtFZiRNNk0GGVCWQkPdJrxe",
                "created": 1761000639,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "19",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 664,
                "out_toks": 595,
                "id": "chatcmpl-CSsYVDDUoQp9JlgDlIuRHBq0BMr29",
                "created": 1760998931,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query: filter objects first, then join only the needed probabilities.\n-- Conditions:\n--  - firstmjd in [59274.0, 59305.0) => between 2021-03-01 and 2021-04-01\n--  - ndet <= 1 (at most one detection)\n--  - stamp classifier, class 'asteroid', probability > 0.7, and ranking = 1\n--  - For objects with multiple classifier versions, keep the maximum probability per oid\nWITH objs AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1),\n     asteroids AS\n  (SELECT p.oid,\n          MAX(p.probability) AS probability\n   FROM probability p\n   JOIN objs o ON o.oid = p.oid\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n   GROUP BY p.oid)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       'asteroid' AS class_name,\n       a.probability\nFROM objs o\nJOIN asteroids a ON a.oid = o.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query: filter objects first, then join only the needed probabilities.\n-- Conditions:\n--  - firstmjd in [59274.0, 59305.0) => between 2021-03-01 and 2021-04-01\n--  - ndet <= 1 (at most one detection)\n--  - stamp classifier, class 'asteroid', probability > 0.7, and ranking = 1\n--  - For objects with multiple classifier versions, keep the maximum probability per oid\nWITH objs AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1),\n     asteroids AS\n  (SELECT p.oid,\n          MAX(p.probability) AS probability\n   FROM probability p\n   JOIN objs o ON o.oid = p.oid\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n   GROUP BY p.oid)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       'asteroid' AS class_name,\n       a.probability\nFROM objs o\nJOIN asteroids a ON a.oid = o.oid;"
                },
                "in_toks": 1876,
                "out_toks": 2640,
                "id": "chatcmpl-Cb9UOURtZArHlX26E08DFjqJrRUA6",
                "created": 1762970648,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with first detection between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0)),\n-- with at most one detection, and classified as 'asteroid' by the stamp classifier with probability > 0.7.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    -- Return the asteroid class name from the stamp classifier (highest available probability per object)\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    -- Return the corresponding probability (highest available per object)\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.firstmjd >= 59274.0\n    AND o.firstmjd < 59305.0\n    AND o.ndet <= 1\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with first detection between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0)),\n-- with at most one detection, and classified as 'asteroid' by the stamp classifier with probability > 0.7.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    -- Return the asteroid class name from the stamp classifier (highest available probability per object)\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    -- Return the corresponding probability (highest available per object)\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.firstmjd >= 59274.0\n    AND o.firstmjd < 59305.0\n    AND o.ndet <= 1\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );"
                },
                "in_toks": 2693,
                "out_toks": 3174,
                "id": "chatcmpl-CSt0GxsVZ48era5SPMYLRtce5iu1T",
                "created": 1761000652,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "19",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'step']"
                },
                "in_toks": 664,
                "out_toks": 1494,
                "id": "chatcmpl-CSsYdRGWZLZlNt60xOhFEsgJsihte",
                "created": 1760998939,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Optimized query:\n   - Pre-filter objects by date and ndet.\n   - Pre-filter probabilities to the stamp classifier, asteroid class, prob > 0.7, and ranking = 1.\n   - Use DISTINCT ON to pick the highest probability per oid across versions.\n   - Join the two reduced sets to avoid timeouts.\n*/ WITH obj AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0 -- 2021-03-01 (MJD)\n\n     AND firstmjd < 59305.0 -- 2021-04-01 (MJD)\n\n     AND ndet <= 1),\n        p_best AS\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.class_name,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.7\n     AND p.ranking = 1\n   ORDER BY p.oid,\n            p.probability DESC)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS \"firstMJD\",\n       pb.class_name,\n       pb.probability\nFROM obj o\nJOIN p_best pb ON pb.oid = o.oid;",
            "sql_response": {
                "responses": {
                    "0": "/* Optimized query:\n   - Pre-filter objects by date and ndet.\n   - Pre-filter probabilities to the stamp classifier, asteroid class, prob > 0.7, and ranking = 1.\n   - Use DISTINCT ON to pick the highest probability per oid across versions.\n   - Join the two reduced sets to avoid timeouts.\n*/ WITH obj AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0 -- 2021-03-01 (MJD)\n\n     AND firstmjd < 59305.0 -- 2021-04-01 (MJD)\n\n     AND ndet <= 1),\n        p_best AS\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.class_name,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.7\n     AND p.ranking = 1\n   ORDER BY p.oid,\n            p.probability DESC)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS \"firstMJD\",\n       pb.class_name,\n       pb.probability\nFROM obj o\nJOIN p_best pb ON pb.oid = o.oid;"
                },
                "in_toks": 2167,
                "out_toks": 1729,
                "id": "chatcmpl-Cb9UujvzfTLVIACbq5hTdHJ94IBeg",
                "created": 1762970680,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects with at most one detection (ndet <= 1), first detected between 2021-03-01 and 2021-04-01,\n   and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n   We obtain OIDs in a subquery (as recommended) and use scalar subqueries to fetch class_name and probability.\n   If multiple classifier versions exist, the highest probability per oid is selected. */\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* class_name and probability from the highest-probability stamp_classifier 'asteroid' entry */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    /* first detection between 2021-03-01 (MJD 59274.0) inclusive and 2021-04-01 (MJD 59305.0) exclusive */\n    o.firstmjd >= 59274.0\n    AND o.firstmjd < 59305.0\n    /* at most one detection */\n    AND o.ndet <= 1\n    /* ensure the object is classified as 'asteroid' by the stamp classifier with prob > 0.7 */\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects with at most one detection (ndet <= 1), first detected between 2021-03-01 and 2021-04-01,\n   and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n   We obtain OIDs in a subquery (as recommended) and use scalar subqueries to fetch class_name and probability.\n   If multiple classifier versions exist, the highest probability per oid is selected. */\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* class_name and probability from the highest-probability stamp_classifier 'asteroid' entry */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    /* first detection between 2021-03-01 (MJD 59274.0) inclusive and 2021-04-01 (MJD 59305.0) exclusive */\n    o.firstmjd >= 59274.0\n    AND o.firstmjd < 59305.0\n    /* at most one detection */\n    AND o.ndet <= 1\n    /* ensure the object is classified as 'asteroid' by the stamp classifier with prob > 0.7 */\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );"
                },
                "in_toks": 2765,
                "out_toks": 2390,
                "id": "chatcmpl-CSsxeDHexiMsGPdrDz1uWX2XZiQCg",
                "created": 1761000490,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "19",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 664,
                "out_toks": 723,
                "id": "chatcmpl-CZMJpZFY2zMkPT2ZfDhln49J17LAR",
                "created": 1762543309,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Objects with at most one detection (ndet <= 1), first detection between 2021-03-01 and 2021-04-01\n-- (MJD in [59274.0, 59305.0)), and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Optimized by filtering objects first and using a LATERAL join to use the probability PK (leading on oid) and pick the best version.\n WITH obj AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE ndet <= 1\n     AND firstmjd >= 59274.0\n     AND firstmjd < 59305.0)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       p.class_name,\n       p.probability\nFROM obj o\nJOIN LATERAL\n  (SELECT p.class_name,\n          p.probability\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier' -- classifier filter\n\n     AND p.class_name = 'asteroid' -- class filter\n\n     AND p.ranking = 1 -- best-ranked class per version\n\n     AND p.probability > 0.7 -- probability threshold\n\n   ORDER BY p.probability DESC -- take highest-probability version\n\n   LIMIT 1) p ON TRUE;",
            "sql_response": {
                "responses": {
                    "0": "-- Objects with at most one detection (ndet <= 1), first detection between 2021-03-01 and 2021-04-01\n-- (MJD in [59274.0, 59305.0)), and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Optimized by filtering objects first and using a LATERAL join to use the probability PK (leading on oid) and pick the best version.\n WITH obj AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE ndet <= 1\n     AND firstmjd >= 59274.0\n     AND firstmjd < 59305.0)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       p.class_name,\n       p.probability\nFROM obj o\nJOIN LATERAL\n  (SELECT p.class_name,\n          p.probability\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier' -- classifier filter\n\n     AND p.class_name = 'asteroid' -- class filter\n\n     AND p.ranking = 1 -- best-ranked class per version\n\n     AND p.probability > 0.7 -- probability threshold\n\n   ORDER BY p.probability DESC -- take highest-probability version\n\n   LIMIT 1) p ON TRUE;"
                },
                "in_toks": 1916,
                "out_toks": 2316,
                "id": "chatcmpl-Cb9VUzZy7Yd9EmnM6YuWpgm9KS8jY",
                "created": 1762970716,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with at most one detection (ndet <= 1), first detection between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0)),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    -- Class name (from stamp classifier), taking the highest-probability row if multiple versions exist\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    -- Corresponding probability\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.ndet <= 1\n    AND o.firstmjd >= 59274.0\n    AND o.firstmjd < 59305.0\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with at most one detection (ndet <= 1), first detection between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0)),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    -- Class name (from stamp classifier), taking the highest-probability row if multiple versions exist\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    -- Corresponding probability\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.ndet <= 1\n    AND o.firstmjd >= 59274.0\n    AND o.firstmjd < 59305.0\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );"
                },
                "in_toks": 2693,
                "out_toks": 2938,
                "id": "chatcmpl-CZRHcZs02i2jHelAlmukXmgdNNQzk",
                "created": 1762562392,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "19",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 664,
                "out_toks": 723,
                "id": "chatcmpl-CZMK6Jcdttnt8fW4tUZgksQL66rip",
                "created": 1762543326,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Objects with first detection between 2021-03-01 and 2021-04-01 (MJD [59274.0, 59305.0)),\n-- with at most one detection (ndet <= 1),\n-- classified as 'asteroid' by the 'stamp_classifier' with probability > 0.7 and ranking = 1.\n-- Returns: oid, meanra, meandec, ndet, firstmjd, class_name, probability.\n WITH filtered_objects AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1),\n      filtered_probability AS\n  (-- Use DISTINCT ON to keep the highest probability per oid (in case of multiple versions)\n SELECT DISTINCT ON (oid) oid,\n                    class_name,\n                    probability\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n     AND class_name = 'asteroid'\n     AND probability > 0.7\n     AND ranking = 1\n   ORDER BY oid,\n            probability DESC)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       p.class_name,\n       p.probability\nFROM filtered_objects o\nJOIN filtered_probability p USING (oid);",
            "sql_response": {
                "responses": {
                    "0": "-- Objects with first detection between 2021-03-01 and 2021-04-01 (MJD [59274.0, 59305.0)),\n-- with at most one detection (ndet <= 1),\n-- classified as 'asteroid' by the 'stamp_classifier' with probability > 0.7 and ranking = 1.\n-- Returns: oid, meanra, meandec, ndet, firstmjd, class_name, probability.\n WITH filtered_objects AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1),\n      filtered_probability AS\n  (-- Use DISTINCT ON to keep the highest probability per oid (in case of multiple versions)\n SELECT DISTINCT ON (oid) oid,\n                    class_name,\n                    probability\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n     AND class_name = 'asteroid'\n     AND probability > 0.7\n     AND ranking = 1\n   ORDER BY oid,\n            probability DESC)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       p.class_name,\n       p.probability\nFROM filtered_objects o\nJOIN filtered_probability p USING (oid);"
                },
                "in_toks": 1944,
                "out_toks": 1714,
                "id": "chatcmpl-Cb9W59HsGUHZeU4lRqLX1x46j7NGI",
                "created": 1762970753,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects detected between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0),\n-- with at most one detection (ndet <= 1),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Columns returned: oid, meanra, meandec, ndet, firstmjd, class_name, probability\n\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Retrieve the matching class_name ('asteroid') from probability */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    /* Retrieve the corresponding probability */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59274.0 AND 59305.0\n    AND o.ndet <= 1\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects detected between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0),\n-- with at most one detection (ndet <= 1),\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Columns returned: oid, meanra, meandec, ndet, firstmjd, class_name, probability\n\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Retrieve the matching class_name ('asteroid') from probability */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    /* Retrieve the corresponding probability */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59274.0 AND 59305.0\n    AND o.ndet <= 1\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    );"
                },
                "in_toks": 2693,
                "out_toks": 2440,
                "id": "chatcmpl-CZRJ5UrBCn1h81aE5qDirxfW50XiP",
                "created": 1762562483,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "19",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'step']"
                },
                "in_toks": 664,
                "out_toks": 1110,
                "id": "chatcmpl-CZMKPvUaAgoYyWcjhaEwzS4HEq3iL",
                "created": 1762543345,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return objects with first detection between 2021-03-01 and 2021-04-01 (MJD in [59274, 59305)),\n-- with at most one detection (ndet <= 1), and classified as 'asteroid' by the stamp classifier\n-- with probability > 0.7. Optimize by pre-filtering objects and aggregating probabilities.\nWITH objs AS\n  (-- Pre-filter objects to reduce join size\n SELECT o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd\n   FROM OBJECT o\n   WHERE o.firstmjd >= 59274.0\n     AND o.firstmjd < 59305.0\n     AND o.ndet <= 1),\n     prob AS\n  (-- Filter probability with at least 3 conditions and enforce ranking=1 as per guidelines.\n -- Aggregate to one row per oid (take max probability across versions).\n SELECT p.oid,\n        MAX(p.probability) AS probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.7\n     AND p.ranking = 1\n   GROUP BY p.oid)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS \"firstMJD\",\n       'asteroid' AS class_name,\n       pr.probability\nFROM objs o\nJOIN prob pr ON pr.oid = o.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Return objects with first detection between 2021-03-01 and 2021-04-01 (MJD in [59274, 59305)),\n-- with at most one detection (ndet <= 1), and classified as 'asteroid' by the stamp classifier\n-- with probability > 0.7. Optimize by pre-filtering objects and aggregating probabilities.\nWITH objs AS\n  (-- Pre-filter objects to reduce join size\n SELECT o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd\n   FROM OBJECT o\n   WHERE o.firstmjd >= 59274.0\n     AND o.firstmjd < 59305.0\n     AND o.ndet <= 1),\n     prob AS\n  (-- Filter probability with at least 3 conditions and enforce ranking=1 as per guidelines.\n -- Aggregate to one row per oid (take max probability across versions).\n SELECT p.oid,\n        MAX(p.probability) AS probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.7\n     AND p.ranking = 1\n   GROUP BY p.oid)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd AS \"firstMJD\",\n       'asteroid' AS class_name,\n       pr.probability\nFROM objs o\nJOIN prob pr ON pr.oid = o.oid;"
                },
                "in_toks": 2034,
                "out_toks": 2387,
                "id": "chatcmpl-Cb9WV5TmaC4hxYRl9p39XRxDB7NSU",
                "created": 1762970779,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with at most one detection (ndet <= 1), first detection between 2021-03-01 and 2021-04-01,\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Note: We interpret \"between March 1st and April 1st\" as [59274.0, 59305.0), excluding April 1st itself.\nWITH asteroid_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Return the corresponding class_name and highest probability for display */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.ndet <= 1\n  AND o.oid IN (SELECT oid FROM asteroid_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with at most one detection (ndet <= 1), first detection between 2021-03-01 and 2021-04-01,\n-- and classified as 'asteroid' by the stamp classifier with probability > 0.7.\n-- Note: We interpret \"between March 1st and April 1st\" as [59274.0, 59305.0), excluding April 1st itself.\nWITH asteroid_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    /* Return the corresponding class_name and highest probability for display */\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE o.firstmjd >= 59274.0\n  AND o.firstmjd < 59305.0\n  AND o.ndet <= 1\n  AND o.oid IN (SELECT oid FROM asteroid_oids);"
                },
                "in_toks": 2765,
                "out_toks": 2445,
                "id": "chatcmpl-CZRK9S8AHnXUmZtuwA2gVGWTyIO4z",
                "created": 1762562549,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "19",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 664,
                "out_toks": 1363,
                "id": "chatcmpl-CZMKqVzpcMhrGkLVakqO8FpUEBDTB",
                "created": 1762543372,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Objects with first detection between 2021-03-01 (MJD 59274.0) inclusive and 2021-04-01 (MJD 59305.0) exclusive,\n-- with at most one detection, and classified as 'asteroid' by the stamp classifier (ranking=1) with probability > 0.7.\n-- Optimized by first filtering objects, then joining to a narrowed probability set and selecting the top-probability version per object.\n WITH o_filtered AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1),\n      p_best AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          ROW_NUMBER() OVER (PARTITION BY p.oid\n                             ORDER BY p.probability DESC) AS rn\n   FROM probability p\n   JOIN o_filtered o ON o.oid = p.oid\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.7\n     AND p.ranking = 1)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       p.class_name,\n       p.probability\nFROM o_filtered o\nJOIN p_best p ON p.oid = o.oid\nWHERE p.rn = 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Objects with first detection between 2021-03-01 (MJD 59274.0) inclusive and 2021-04-01 (MJD 59305.0) exclusive,\n-- with at most one detection, and classified as 'asteroid' by the stamp classifier (ranking=1) with probability > 0.7.\n-- Optimized by first filtering objects, then joining to a narrowed probability set and selecting the top-probability version per object.\n WITH o_filtered AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1),\n      p_best AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          ROW_NUMBER() OVER (PARTITION BY p.oid\n                             ORDER BY p.probability DESC) AS rn\n   FROM probability p\n   JOIN o_filtered o ON o.oid = p.oid\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.7\n     AND p.ranking = 1)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       p.class_name,\n       p.probability\nFROM o_filtered o\nJOIN p_best p ON p.oid = o.oid\nWHERE p.rn = 1;"
                },
                "in_toks": 1840,
                "out_toks": 2332,
                "id": "chatcmpl-Cb9XJKFCLGVOh2Tfy0dNZOax4hM6y",
                "created": 1762970829,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0)\n-- With at most one detection (ndet <= 1)\n-- Classified as 'asteroid' by the stamp classifier with probability > 0.7\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    (\n        SELECT p2.class_name\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'stamp_classifier'\n          AND p2.class_name = 'asteroid'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'stamp_classifier'\n          AND p2.class_name = 'asteroid'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    )\n    AND o.firstmjd >= 59274.0\n    AND o.firstmjd <= 59305.0\n    AND o.ndet <= 1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects between 2021-03-01 (MJD 59274.0) and 2021-04-01 (MJD 59305.0)\n-- With at most one detection (ndet <= 1)\n-- Classified as 'asteroid' by the stamp classifier with probability > 0.7\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    (\n        SELECT p2.class_name\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'stamp_classifier'\n          AND p2.class_name = 'asteroid'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'stamp_classifier'\n          AND p2.class_name = 'asteroid'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS probability\nFROM object o\nWHERE\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.7\n    )\n    AND o.firstmjd >= 59274.0\n    AND o.firstmjd <= 59305.0\n    AND o.ndet <= 1;"
                },
                "in_toks": 2693,
                "out_toks": 2259,
                "id": "chatcmpl-CZRANoYTksk0OqhMPZeEMYqKNWTi0",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "19",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 664,
                "out_toks": 1043,
                "id": "chatcmpl-CZMLIEiBdh7Ie53XQIdEvgJRr4LCL",
                "created": 1762543400,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return ZTF objects that:\n--  - first appeared between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0) using firstmjd)\n--  - have at most one detection (ndet <= 1)\n--  - are classified as 'asteroid' by the stamp classifier with probability > 0.7\n-- Optimization:\n--  - Pre-filter objects in a CTE and join to probability\n--  - Use ranking = 1 on probability to reduce rows scanned, as recommended\nWITH candidate AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1)\nSELECT c.oid,\n       c.meanra,\n       c.meandec,\n       c.ndet,\n       c.firstmjd AS firstMJD,\n       p.class_name,\n       p.probability\nFROM candidate c\nJOIN probability p ON p.oid = c.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.ranking = 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Return ZTF objects that:\n--  - first appeared between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0) using firstmjd)\n--  - have at most one detection (ndet <= 1)\n--  - are classified as 'asteroid' by the stamp classifier with probability > 0.7\n-- Optimization:\n--  - Pre-filter objects in a CTE and join to probability\n--  - Use ranking = 1 on probability to reduce rows scanned, as recommended\nWITH candidate AS\n  (SELECT oid,\n          meanra,\n          meandec,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE firstmjd >= 59274.0\n     AND firstmjd < 59305.0\n     AND ndet <= 1)\nSELECT c.oid,\n       c.meanra,\n       c.meandec,\n       c.ndet,\n       c.firstmjd AS firstMJD,\n       p.class_name,\n       p.probability\nFROM candidate c\nJOIN probability p ON p.oid = c.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.ranking = 1;"
                },
                "in_toks": 1859,
                "out_toks": 1765,
                "id": "chatcmpl-Cb9XtNqDV0YV4pYS8Vtyq96ULai5G",
                "created": 1762970865,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF objects that:\n--  - first appeared between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0) using firstmjd)\n--  - have at most one detection (ndet <= 1)\n--  - are classified as 'asteroid' by the stamp classifier with probability > 0.7\n-- Columns returned: oid, meanra, meandec, ndet, firstmjd, class_name, probability\n\nWITH candidate_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd >= 59274.0\n      AND o.firstmjd < 59305.0\n      AND o.ndet <= 1\n)\nSELECT\n    p.oid,\n    (SELECT o.meanra  FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet    FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.oid IN (SELECT oid FROM candidate_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF objects that:\n--  - first appeared between 2021-03-01 and 2021-04-01 (MJD in [59274.0, 59305.0) using firstmjd)\n--  - have at most one detection (ndet <= 1)\n--  - are classified as 'asteroid' by the stamp classifier with probability > 0.7\n-- Columns returned: oid, meanra, meandec, ndet, firstmjd, class_name, probability\n\nWITH candidate_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd >= 59274.0\n      AND o.firstmjd < 59305.0\n      AND o.ndet <= 1\n)\nSELECT\n    p.oid,\n    (SELECT o.meanra  FROM object o WHERE o.oid = p.oid) AS meanra,\n    (SELECT o.meandec FROM object o WHERE o.oid = p.oid) AS meandec,\n    (SELECT o.ndet    FROM object o WHERE o.oid = p.oid) AS ndet,\n    (SELECT o.firstmjd FROM object o WHERE o.oid = p.oid) AS firstmjd,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.oid IN (SELECT oid FROM candidate_oids);"
                },
                "in_toks": 2693,
                "out_toks": 2575,
                "id": "chatcmpl-CZRANA0m8PAbupqGenTHaMB9LQGfC",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        }
    },
    "14": {
        "0": {
            "req_id": "14",
            "experiment_id": "run_0",
            "pred_tables": [
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'ps1_ztf']",
                    "1": "['detection', 'ps1_ztf', 'probability']"
                },
                "in_toks": 783,
                "out_toks": 2924,
                "id": "chatcmpl-CSnSaxZCD2j4aOmq1qw2AHRbFOJ9t",
                "created": 1760979344,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return detections for the given OIDs with DRB > 0.5 and either PS1 sgscore1 < 0.5 or distpsnr1 < 1 arcsec.\n   Avoid explicit JOINs by using a VALUES list for OIDs and correlated subqueries for PS1 fields. */\nWITH catalog (oid) AS (\n    VALUES \n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,         -- magnitude (corrected difference magnitude)\n    d.sigmapsf_corr,       -- magnitude error\n    d.has_stamp,           -- whether the candidate has an associated image stamp\n    d.drb,                 -- deep learning real-bogus score\n    /* PS1 nearest (1st) source star/galaxy score and distance */\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM catalog)\n  AND d.drb > 0.5\n  AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return detections for the given OIDs with DRB > 0.5 and either PS1 sgscore1 < 0.5 or distpsnr1 < 1 arcsec.\n   Avoid explicit JOINs by using a VALUES list for OIDs and correlated subqueries for PS1 fields. */\nWITH catalog (oid) AS (\n    VALUES \n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,         -- magnitude (corrected difference magnitude)\n    d.sigmapsf_corr,       -- magnitude error\n    d.has_stamp,           -- whether the candidate has an associated image stamp\n    d.drb,                 -- deep learning real-bogus score\n    /* PS1 nearest (1st) source star/galaxy score and distance */\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM catalog)\n  AND d.drb > 0.5\n  AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );"
                },
                "in_toks": 3353,
                "out_toks": 2554,
                "id": "chatcmpl-CSoO9tKoLextTebEM5Md0wJnpGxEy",
                "created": 1760982913,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "14",
            "experiment_id": "run_1",
            "pred_tables": [
                "detection",
                "ps1_ztf",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'ps1_ztf']",
                    "1": "['detection', 'ps1_ztf', 'probability']"
                },
                "in_toks": 783,
                "out_toks": 2924,
                "id": "chatcmpl-CSnSaxZCD2j4aOmq1qw2AHRbFOJ9t",
                "created": 1760979344,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return detections for given OIDs with DRB > 0.5 and (PS1 sgscore1 < 0.5 OR distpsnr1 < 1 arcsec)\n-- Note: Using detection.magpsf and detection.sigmapsf as \"magnitude\" and \"magnitude error\". If you prefer corrected magnitudes, switch to magpsf_corr and sigmapsf_corr.\n\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  )\nORDER BY d.oid, d.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return detections for given OIDs with DRB > 0.5 and (PS1 sgscore1 < 0.5 OR distpsnr1 < 1 arcsec)\n-- Note: Using detection.magpsf and detection.sigmapsf as \"magnitude\" and \"magnitude error\". If you prefer corrected magnitudes, switch to magpsf_corr and sigmapsf_corr.\n\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  )\nORDER BY d.oid, d.candid;"
                },
                "in_toks": 3537,
                "out_toks": 2787,
                "id": "chatcmpl-CSoOUjlrUK47oJpAAPAPCjZO9H4zF",
                "created": 1760982934,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "14",
            "experiment_id": "run_2",
            "pred_tables": [
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'ps1_ztf']"
                },
                "in_toks": 783,
                "out_toks": 1236,
                "id": "chatcmpl-CSsYvwY3sjE0eRk4ljRbkXJR7AYFx",
                "created": 1760998957,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,                    -- unique object identifier\n    d.candid,                 -- candidate identifier\n    d.fid,                    -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,                    -- modified julian date\n    d.magpsf_corr,            -- magnitude (corrected PSF magnitude)\n    d.sigmapsf_corr,          -- magnitude error (assuming point-like source)\n    d.has_stamp,              -- whether the candidate has an associated image stamp\n    d.drb,                    -- deep learning real-bogus score\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,     -- star/galaxy score of nearest PS1 source\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1     -- distance [arcsec] to nearest PS1 source\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p\n      WHERE p.oid = d.oid\n        AND p.candid = d.candid\n        AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "WITH oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,                    -- unique object identifier\n    d.candid,                 -- candidate identifier\n    d.fid,                    -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,                    -- modified julian date\n    d.magpsf_corr,            -- magnitude (corrected PSF magnitude)\n    d.sigmapsf_corr,          -- magnitude error (assuming point-like source)\n    d.has_stamp,              -- whether the candidate has an associated image stamp\n    d.drb,                    -- deep learning real-bogus score\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,     -- star/galaxy score of nearest PS1 source\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1     -- distance [arcsec] to nearest PS1 source\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p\n      WHERE p.oid = d.oid\n        AND p.candid = d.candid\n        AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );"
                },
                "in_toks": 3353,
                "out_toks": 2475,
                "id": "chatcmpl-CSsy0K0qkRRtVvVsQxRsG3Cki5Y1i",
                "created": 1761000512,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "14",
            "experiment_id": "run_3",
            "pred_tables": [
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'ps1_ztf']"
                },
                "in_toks": 783,
                "out_toks": 1492,
                "id": "chatcmpl-CSsZBjTIgPee8X4aXWmxuCfmkzqtf",
                "created": 1760998973,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return detections for given OIDs with drb > 0.5 and (sgscore1 < 0.5 OR distpsnr1 < 1 arcsec).\n-- Magnitude and error are taken as magpsf and sigmapsf from detection.\nWITH input_oids(oid) AS (\n    VALUES \n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n),\nfiltered AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM input_oids)\n      AND d.drb > 0.5\n      AND EXISTS (\n          SELECT 1\n          FROM ps1_ztf p\n          WHERE p.oid = d.oid\n            AND p.candid = d.candid\n            AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n      )\n)\nSELECT\n    f.oid,\n    f.candid,\n    f.fid,\n    f.mjd,\n    f.magpsf,\n    f.sigmapsf,\n    f.has_stamp,\n    f.drb,\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = f.oid AND p.candid = f.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = f.oid AND p.candid = f.candid) AS distpsnr1\nFROM filtered f;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return detections for given OIDs with drb > 0.5 and (sgscore1 < 0.5 OR distpsnr1 < 1 arcsec).\n-- Magnitude and error are taken as magpsf and sigmapsf from detection.\nWITH input_oids(oid) AS (\n    VALUES \n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n),\nfiltered AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM input_oids)\n      AND d.drb > 0.5\n      AND EXISTS (\n          SELECT 1\n          FROM ps1_ztf p\n          WHERE p.oid = d.oid\n            AND p.candid = d.candid\n            AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n      )\n)\nSELECT\n    f.oid,\n    f.candid,\n    f.fid,\n    f.mjd,\n    f.magpsf,\n    f.sigmapsf,\n    f.has_stamp,\n    f.drb,\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = f.oid AND p.candid = f.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = f.oid AND p.candid = f.candid) AS distpsnr1\nFROM filtered f;"
                },
                "in_toks": 3353,
                "out_toks": 3084,
                "id": "chatcmpl-CSsyTLt14hX24ucOlQJw3hWPOhxOl",
                "created": 1761000541,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "14",
            "experiment_id": "run_4",
            "pred_tables": [
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'ps1_ztf']"
                },
                "in_toks": 783,
                "out_toks": 852,
                "id": "chatcmpl-CSsZYJuDOsrC32SHPqruehTnaRFlH",
                "created": 1760998996,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return detection-level info for the provided OIDs with DRB > 0.5\n-- and PS1 constraints: sgscore1 < 0.5 OR distpsnr1 < 1 arcsec.\n-- Assumption: \"magnitude\" and \"magnitude error\" refer to magpsf and sigmapsf from detection.\nWITH oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,        -- magnitude (PSF difference magnitude)\n    d.sigmapsf,      -- magnitude error (PSF difference magnitude error)\n    d.has_stamp,     -- whether the candidate has stamps\n    d.drb,           -- deep learning real-bogus score\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE\n    d.oid IN (SELECT oid FROM oids)\n    AND d.drb > 0.5\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return detection-level info for the provided OIDs with DRB > 0.5\n-- and PS1 constraints: sgscore1 < 0.5 OR distpsnr1 < 1 arcsec.\n-- Assumption: \"magnitude\" and \"magnitude error\" refer to magpsf and sigmapsf from detection.\nWITH oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,        -- magnitude (PSF difference magnitude)\n    d.sigmapsf,      -- magnitude error (PSF difference magnitude error)\n    d.has_stamp,     -- whether the candidate has stamps\n    d.drb,           -- deep learning real-bogus score\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE\n    d.oid IN (SELECT oid FROM oids)\n    AND d.drb > 0.5\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n    );"
                },
                "in_toks": 3353,
                "out_toks": 2995,
                "id": "chatcmpl-CSsz9Iaqa2cgwwc2hf24ajQ3EcPGy",
                "created": 1761000583,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "14",
            "experiment_id": "run_5",
            "pred_tables": [
                "detection",
                "ps1_ztf",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'ps1_ztf', 'dataquality']"
                },
                "in_toks": 783,
                "out_toks": 1560,
                "id": "chatcmpl-CZMLcynvI8w6xxpQyQWRKtVRSeMCx",
                "created": 1762543420,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return detections for the given OIDs with drb > 0.5 and either sgscore1 < 0.5 or distpsnr1 < 1 arcsec\n-- Note: magpsf (magnitude) and sigmapsf (magnitude error) are used\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p\n      WHERE p.oid = d.oid\n        AND p.candid = d.candid\n        AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return detections for the given OIDs with drb > 0.5 and either sgscore1 < 0.5 or distpsnr1 < 1 arcsec\n-- Note: magpsf (magnitude) and sigmapsf (magnitude error) are used\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p\n      WHERE p.oid = d.oid\n        AND p.candid = d.candid\n        AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );"
                },
                "in_toks": 4150,
                "out_toks": 2947,
                "id": "chatcmpl-CZRANSqVLF1UdyQHtfpYQVA6lLNYP",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "14",
            "experiment_id": "run_6",
            "pred_tables": [
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'ps1_ztf']"
                },
                "in_toks": 783,
                "out_toks": 1172,
                "id": "chatcmpl-CZMM6oak0csmNCrvh2X7v10VuAkoJ",
                "created": 1762543450,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,                         -- unique object identifier\n    d.candid,                      -- candidate identifier\n    d.fid,                         -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,                         -- modified julian date\n    d.magpsf AS magnitude,         -- using PSF difference magnitude\n    d.sigmapsf AS magnitude_error, -- corresponding magnitude error\n    d.has_stamp,                   -- whether the candidate has an associated image stamp\n    d.drb,                         -- deep learning real bogus score\n    (SELECT p.sgscore1\n       FROM ps1_ztf p\n      WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,     -- star/galaxy score of nearest PS1 source\n    (SELECT p.distpsnr1\n       FROM ps1_ztf p\n      WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1     -- distance to nearest PS1 source [arcsec]\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  -- enforce drb > 0.5 via a nested EXISTS to avoid direct non-oid filtering on detection\n  AND EXISTS (\n        SELECT 1\n          FROM detection dx\n         WHERE dx.oid = d.oid\n           AND dx.candid = d.candid\n           AND dx.drb > 0.5\n      )\n  -- require either sgscore1 < 0.5 or distpsnr1 < 1 arcsec in the matching PS1 association\n  AND EXISTS (\n        SELECT 1\n          FROM ps1_ztf p\n         WHERE p.oid = d.oid\n           AND p.candid = d.candid\n           AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n      );",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,                         -- unique object identifier\n    d.candid,                      -- candidate identifier\n    d.fid,                         -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,                         -- modified julian date\n    d.magpsf AS magnitude,         -- using PSF difference magnitude\n    d.sigmapsf AS magnitude_error, -- corresponding magnitude error\n    d.has_stamp,                   -- whether the candidate has an associated image stamp\n    d.drb,                         -- deep learning real bogus score\n    (SELECT p.sgscore1\n       FROM ps1_ztf p\n      WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,     -- star/galaxy score of nearest PS1 source\n    (SELECT p.distpsnr1\n       FROM ps1_ztf p\n      WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1     -- distance to nearest PS1 source [arcsec]\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  -- enforce drb > 0.5 via a nested EXISTS to avoid direct non-oid filtering on detection\n  AND EXISTS (\n        SELECT 1\n          FROM detection dx\n         WHERE dx.oid = d.oid\n           AND dx.candid = d.candid\n           AND dx.drb > 0.5\n      )\n  -- require either sgscore1 < 0.5 or distpsnr1 < 1 arcsec in the matching PS1 association\n  AND EXISTS (\n        SELECT 1\n          FROM ps1_ztf p\n         WHERE p.oid = d.oid\n           AND p.candid = d.candid\n           AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n      );"
                },
                "in_toks": 3353,
                "out_toks": 2887,
                "id": "chatcmpl-CZRANmQWZH3PxBviZv9RMuWn5oo80",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "14",
            "experiment_id": "run_7",
            "pred_tables": [
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'ps1_ztf']"
                },
                "in_toks": 783,
                "out_toks": 980,
                "id": "chatcmpl-CZMMPe2zPwgeGMwuP8ZTJJkkFNuoH",
                "created": 1762543469,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return detection-level info for specific OIDs, with DRB > 0.5 and PS1 constraints:\n   - magnitude and error use magpsf_corr and sigmapsf_corr from detection\n   - PS1 constraints and outputs use sgscore1 and distpsnr1 from ps1_ztf\n   - Avoid explicit JOINs by using scalar subqueries and EXISTS\n*/\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    d.has_stamp,\n    d.drb,\n    /* PS1 nearest-object star/galaxy score and distance for this (oid, candid) */\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p\n      WHERE p.oid = d.oid\n        AND p.candid = d.candid\n        AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return detection-level info for specific OIDs, with DRB > 0.5 and PS1 constraints:\n   - magnitude and error use magpsf_corr and sigmapsf_corr from detection\n   - PS1 constraints and outputs use sgscore1 and distpsnr1 from ps1_ztf\n   - Avoid explicit JOINs by using scalar subqueries and EXISTS\n*/\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    d.has_stamp,\n    d.drb,\n    /* PS1 nearest-object star/galaxy score and distance for this (oid, candid) */\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p\n      WHERE p.oid = d.oid\n        AND p.candid = d.candid\n        AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n  );"
                },
                "in_toks": 3353,
                "out_toks": 3694,
                "id": "chatcmpl-CZRANq570cQQaZd6aascMaV9XNXVH",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "14",
            "experiment_id": "run_8",
            "pred_tables": [
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'ps1_ztf']"
                },
                "in_toks": 783,
                "out_toks": 1108,
                "id": "chatcmpl-CZMMeyCzGVACMFkCR4GKdKqotmuHT",
                "created": 1762543484,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH requested_oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n),\n/* Preselect PS1 matches for the requested oids that satisfy the sgscore/dist conditions */\nps AS (\n    SELECT p.oid, p.candid, p.sgscore1, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM requested_oids)\n      AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1.0)\n),\n/* Preselect detections for the requested oids with drb > 0.5 */\ndet AS (\n    SELECT *\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM requested_oids)\n      AND d.drb > 0.5\n)\nSELECT\n    d.oid,                       -- unique object identifier\n    d.candid,                    -- candidate identifier\n    d.fid,                       -- filter identifier\n    d.mjd,                       -- modified julian date\n    d.magpsf,                    -- magnitude\n    d.sigmapsf,                  -- magnitude error\n    d.has_stamp,                 -- whether the object has stamps\n    d.drb,                       -- deep learning real bogus score\n    (SELECT ps.sgscore1\n     FROM ps\n     WHERE ps.oid = d.oid AND ps.candid = d.candid) AS sgscore1,   -- star galaxy score of the nearest PS1 object\n    (SELECT ps.distpsnr1\n     FROM ps\n     WHERE ps.oid = d.oid AND ps.candid = d.candid) AS distpsnr1   -- distance to nearest PS1 source [arcsec]\nFROM det d\nWHERE EXISTS (\n    SELECT 1\n    FROM ps\n    WHERE ps.oid = d.oid AND ps.candid = d.candid\n);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH requested_oids (oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n),\n/* Preselect PS1 matches for the requested oids that satisfy the sgscore/dist conditions */\nps AS (\n    SELECT p.oid, p.candid, p.sgscore1, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM requested_oids)\n      AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1.0)\n),\n/* Preselect detections for the requested oids with drb > 0.5 */\ndet AS (\n    SELECT *\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM requested_oids)\n      AND d.drb > 0.5\n)\nSELECT\n    d.oid,                       -- unique object identifier\n    d.candid,                    -- candidate identifier\n    d.fid,                       -- filter identifier\n    d.mjd,                       -- modified julian date\n    d.magpsf,                    -- magnitude\n    d.sigmapsf,                  -- magnitude error\n    d.has_stamp,                 -- whether the object has stamps\n    d.drb,                       -- deep learning real bogus score\n    (SELECT ps.sgscore1\n     FROM ps\n     WHERE ps.oid = d.oid AND ps.candid = d.candid) AS sgscore1,   -- star galaxy score of the nearest PS1 object\n    (SELECT ps.distpsnr1\n     FROM ps\n     WHERE ps.oid = d.oid AND ps.candid = d.candid) AS distpsnr1   -- distance to nearest PS1 source [arcsec]\nFROM det d\nWHERE EXISTS (\n    SELECT 1\n    FROM ps\n    WHERE ps.oid = d.oid AND ps.candid = d.candid\n);"
                },
                "in_toks": 3353,
                "out_toks": 2858,
                "id": "chatcmpl-CZRCFWorUeL8BX7dEL2ZvZpyPp31O",
                "created": 1762562059,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "14",
            "experiment_id": "run_9",
            "pred_tables": [
                "detection",
                "probability",
                "ps1_ztf",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'probability', 'ps1_ztf', 'dataquality']"
                },
                "in_toks": 783,
                "out_toks": 1948,
                "id": "chatcmpl-CZMN3nz7wTU1BLAVkkxgRcD9K8Tjp",
                "created": 1762543509,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return detections for the given OIDs with drb > 0.5 and either sgscore1 < 0.5 or distpsnr1 < 1 arcsec.\n   - magpsf and sigmapsf are used as the magnitude and magnitude error, respectively.\n   - sgscore1 and distpsnr1 are taken from ps1_ztf for the same (oid, candid). */\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,        -- magnitude\n    d.sigmapsf,      -- magnitude error\n    d.has_stamp,\n    d.drb,           -- deep learning real-bogus score\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n    )\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return detections for the given OIDs with drb > 0.5 and either sgscore1 < 0.5 or distpsnr1 < 1 arcsec.\n   - magpsf and sigmapsf are used as the magnitude and magnitude error, respectively.\n   - sgscore1 and distpsnr1 are taken from ps1_ztf for the same (oid, candid). */\nWITH input_oids(oid) AS (\n    VALUES\n        ('ZTF23aavzgjg'),\n        ('ZTF23aaynzyk'),\n        ('ZTF23aavqxos'),\n        ('ZTF23aaknyni'),\n        ('ZTF23aavsdtc'),\n        ('ZTF18aandkua'),\n        ('ZTF23aaxfewt'),\n        ('ZTF23aavshwi'),\n        ('ZTF22aawasao'),\n        ('ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,        -- magnitude\n    d.sigmapsf,      -- magnitude error\n    d.has_stamp,\n    d.drb,           -- deep learning real-bogus score\n    (SELECT p.sgscore1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS sgscore1,\n    (SELECT p.distpsnr1 FROM ps1_ztf p WHERE p.oid = d.oid AND p.candid = d.candid) AS distpsnr1\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM input_oids)\n  AND d.drb > 0.5\n  AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = d.oid\n          AND p.candid = d.candid\n          AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\n    )\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 4334,
                "out_toks": 2682,
                "id": "chatcmpl-CZRCMJKuHYQ3cdDY0FTgMF1xM6BsW",
                "created": 1762562066,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "30": {
        "0": {
            "req_id": "30",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']",
                    "1": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 1312,
                "id": "chatcmpl-CSnT1K1XVHTXXGavAXXMxEVktHVrZ",
                "created": 1760979371,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Predicted class per object using the Light Curve Classifier (lc_classifier)\n-- Optimized: single pass over probability with DISTINCT ON to avoid per-oid correlated subqueries\n-- Ensures exactly one row per oid (highest probability among ranking=1 entries across versions)\n\nSELECT DISTINCT ON (p.oid) p.oid,\n                   p.class_name,\n                   p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier' -- condition 1: target classifier\n\n  AND p.ranking = 1 -- condition 2: top-ranked class per version\n\n  AND p.class_name IS NOT NULL -- condition 3: ensure valid class name\nORDER BY p.oid,\n         p.probability DESC,\n         p.class_name; -- pick highest probability (tie-break by class name",
            "sql_response": {
                "responses": {
                    "0": "-- Predicted class per object using the Light Curve Classifier (lc_classifier)\n-- Optimized: single pass over probability with DISTINCT ON to avoid per-oid correlated subqueries\n-- Ensures exactly one row per oid (highest probability among ranking=1 entries across versions)\n\nSELECT DISTINCT ON (p.oid) p.oid,\n                   p.class_name,\n                   p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier' -- condition 1: target classifier\n\n  AND p.ranking = 1 -- condition 2: top-ranked class per version\n\n  AND p.class_name IS NOT NULL -- condition 3: ensure valid class name\nORDER BY p.oid,\n         p.probability DESC,\n         p.class_name; -- pick highest probability (tie-break by class name"
                },
                "in_toks": 1225,
                "out_toks": 1713,
                "id": "chatcmpl-Cb9YQwRuTqikHVCikGa9YFY1ImOMx",
                "created": 1762970898,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Predicted class per object using the Light Curve Classifier (lc_classifier)\n-- Returns exactly one row per oid: the class_name with highest probability among ranking=1 entries\n-- If multiple classifier_version entries exist, this picks the one with the highest probability\nWITH oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n)\nSELECT\n    oids.oid,\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = oids.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n        ORDER BY p.probability DESC, p.class_name\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = oids.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n        ORDER BY p.probability DESC, p.class_name\n        LIMIT 1\n    ) AS probability\nFROM oids;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Predicted class per object using the Light Curve Classifier (lc_classifier)\n-- Returns exactly one row per oid: the class_name with highest probability among ranking=1 entries\n-- If multiple classifier_version entries exist, this picks the one with the highest probability\nWITH oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n)\nSELECT\n    oids.oid,\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = oids.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n        ORDER BY p.probability DESC, p.class_name\n        LIMIT 1\n    ) AS class_name,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = oids.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n        ORDER BY p.probability DESC, p.class_name\n        LIMIT 1\n    ) AS probability\nFROM oids;"
                },
                "in_toks": 2119,
                "out_toks": 2225,
                "id": "chatcmpl-CSoOzpUtPJD5XscOH0aINdNf05eKa",
                "created": 1760982965,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "30",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']",
                    "1": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 1312,
                "id": "chatcmpl-CSnT1K1XVHTXXGavAXXMxEVktHVrZ",
                "created": 1760979371,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Predicted class per object from the Light Curve classifier (lc_classifier)\n-- Returns one row per oid: the class_name and probability of the top-ranked class\nWITH oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n)\nSELECT DISTINCT ON (p.oid)\n    p.oid,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM oids)\nORDER BY p.oid, p.probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Predicted class per object from the Light Curve classifier (lc_classifier)\n-- Returns one row per oid: the class_name and probability of the top-ranked class\nWITH oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n)\nSELECT DISTINCT ON (p.oid)\n    p.oid,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM oids)\nORDER BY p.oid, p.probability DESC;"
                },
                "in_toks": 2119,
                "out_toks": 1674,
                "id": "chatcmpl-CSoPGQvAebZ06KEBKk7JjaPztyzYL",
                "created": 1760982982,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "30",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 336,
                "id": "chatcmpl-CSsZiAciHneqbKLvBN3A9WtdiPb7D",
                "created": 1760999006,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Predicted class per object from the Light Curve classifier (lc_classifier), using the latest available classifier_version\nWITH latest_version AS (\n  SELECT max(classifier_version) AS v\n  FROM probability\n  WHERE classifier_name = 'lc_classifier'\n),\noids AS (\n  -- Prioritize retrieving OIDs first for optimization\n  SELECT DISTINCT oid\n  FROM probability\n  WHERE classifier_name = 'lc_classifier'\n    AND ranking = 1\n    AND classifier_version = (SELECT v FROM latest_version)\n)\nSELECT p.oid, p.class_name, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM oids)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.classifier_version = (SELECT v FROM latest_version);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Predicted class per object from the Light Curve classifier (lc_classifier), using the latest available classifier_version\nWITH latest_version AS (\n  SELECT max(classifier_version) AS v\n  FROM probability\n  WHERE classifier_name = 'lc_classifier'\n),\noids AS (\n  -- Prioritize retrieving OIDs first for optimization\n  SELECT DISTINCT oid\n  FROM probability\n  WHERE classifier_name = 'lc_classifier'\n    AND ranking = 1\n    AND classifier_version = (SELECT v FROM latest_version)\n)\nSELECT p.oid, p.class_name, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM oids)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.classifier_version = (SELECT v FROM latest_version);"
                },
                "in_toks": 2119,
                "out_toks": 1776,
                "id": "chatcmpl-CSszeG2NJbkdTgQjMYlsFusnTLqKU",
                "created": 1761000614,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "30",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 400,
                "id": "chatcmpl-CSsZnmYNyCfsll8ZesboTgMdoTav5",
                "created": 1760999011,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Predicted class per object using the Light Curve Classifier (lc_classifier)\n-- Picks, for each oid, the ranking=1 class with the highest probability across all lc_classifier versions\n-- Uses a window function to avoid slow correlated subqueries and prevent timeouts\nWITH lc AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          ROW_NUMBER() OVER (PARTITION BY p.oid\n                             ORDER BY p.probability DESC, p.classifier_version DESC, p.class_name) AS rn\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier' -- condition 1\n\n     AND p.ranking = 1 -- condition 2\n\n     AND p.probability >= 0 -- condition 3 (keeps query selective and valid)\n)\nSELECT oid,\n       class_name,\n       probability\nFROM lc\nWHERE rn = 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Predicted class per object using the Light Curve Classifier (lc_classifier)\n-- Picks, for each oid, the ranking=1 class with the highest probability across all lc_classifier versions\n-- Uses a window function to avoid slow correlated subqueries and prevent timeouts\nWITH lc AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          ROW_NUMBER() OVER (PARTITION BY p.oid\n                             ORDER BY p.probability DESC, p.classifier_version DESC, p.class_name) AS rn\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier' -- condition 1\n\n     AND p.ranking = 1 -- condition 2\n\n     AND p.probability >= 0 -- condition 3 (keeps query selective and valid)\n)\nSELECT oid,\n       class_name,\n       probability\nFROM lc\nWHERE rn = 1;"
                },
                "in_toks": 1027,
                "out_toks": 1800,
                "id": "chatcmpl-Cb9Z0FkAbvPtvFDZeVyRJknrYIbhI",
                "created": 1762970934,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Predicted class per object using the Light Curve Classifier (lc_classifier)\n-- For each oid, selects the class with ranking=1 and the highest probability across versions\nSELECT p.oid, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability = (\n    SELECT MAX(p2.probability)\n    FROM probability p2\n    WHERE p2.oid = p.oid\n      AND p2.classifier_name = 'lc_classifier'\n      AND p2.ranking = 1\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Predicted class per object using the Light Curve Classifier (lc_classifier)\n-- For each oid, selects the class with ranking=1 and the highest probability across versions\nSELECT p.oid, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability = (\n    SELECT MAX(p2.probability)\n    FROM probability p2\n    WHERE p2.oid = p.oid\n      AND p2.classifier_name = 'lc_classifier'\n      AND p2.ranking = 1\n  );"
                },
                "in_toks": 2119,
                "out_toks": 1675,
                "id": "chatcmpl-CSszyBebM76rOywkX4yAXEV3yFc1d",
                "created": 1761000634,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "30",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 656,
                "id": "chatcmpl-CSsZu85PGjeDJw2N5HLTlp53b0mYH",
                "created": 1760999018,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Predicted class per object using the Light Curve classifier (lc_classifier)\n-- Returns one row per object per classifier_version with the top-ranked class (ranking = 1)\nSELECT\n    p.oid,\n    p.class_name,\n    p.probability\nFROM probability AS p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Predicted class per object using the Light Curve classifier (lc_classifier)\n-- Returns one row per object per classifier_version with the top-ranked class (ranking = 1)\nSELECT\n    p.oid,\n    p.class_name,\n    p.probability\nFROM probability AS p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1;"
                },
                "in_toks": 2119,
                "out_toks": 1878,
                "id": "chatcmpl-CSt0JX0m0tfUEUJn3ANGOvcKmHiCy",
                "created": 1761000655,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "30",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 272,
                "id": "chatcmpl-CZMNwc0GNGYbT2lMasjz0TiGM0zlg",
                "created": 1762543564,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Predicted (rank=1) class per object for the Light Curve classifier (lc_classifier)\n-- Uses latest available classifier_version and obtains OIDs via a subquery as recommended\n WITH latest_version AS\n  (SELECT max(classifier_version) AS VERSION\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'),\n      OIDS AS\n  (SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND ranking = 1\n     AND classifier_version =\n       (SELECT VERSION\n        FROM latest_version))\nSELECT p.oid,\n       p.class_name,\n       p.probability\nFROM probability p\nWHERE p.oid IN\n    (SELECT oid\n     FROM OIDS)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.classifier_version =\n    (SELECT VERSION\n     FROM latest_version);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Predicted (rank=1) class per object for the Light Curve classifier (lc_classifier)\n-- Uses latest available classifier_version and obtains OIDs via a subquery as recommended\n WITH latest_version AS\n  (SELECT max(classifier_version) AS VERSION\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'),\n      OIDS AS\n  (SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND ranking = 1\n     AND classifier_version =\n       (SELECT VERSION\n        FROM latest_version))\nSELECT p.oid,\n       p.class_name,\n       p.probability\nFROM probability p\nWHERE p.oid IN\n    (SELECT oid\n     FROM OIDS)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.classifier_version =\n    (SELECT VERSION\n     FROM latest_version);"
                },
                "in_toks": 2119,
                "out_toks": 2036,
                "id": "chatcmpl-CayeRL8upM3ADCi5Z40dtid3wx5RW",
                "created": 1762928987,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "30",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 400,
                "id": "chatcmpl-CZMO3dbQFqrwc8KGUjSX8vXFfQh9G",
                "created": 1762543571,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Predicted (top-ranked) class for each object from the Light Curve classifier\nSELECT p.oid, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (\n      -- Obtain the set of OIDs first (per guidelines), restricted to the lc_classifier\n      SELECT DISTINCT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Predicted (top-ranked) class for each object from the Light Curve classifier\nSELECT p.oid, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (\n      -- Obtain the set of OIDs first (per guidelines), restricted to the lc_classifier\n      SELECT DISTINCT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n  );"
                },
                "in_toks": 2119,
                "out_toks": 1453,
                "id": "chatcmpl-CZRCkYsuEiO8CgkAuPRtAch2kebbu",
                "created": 1762562090,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "30",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 464,
                "id": "chatcmpl-CZMOCpi9LzVelBLXYiKxNmvce76qN",
                "created": 1762543580,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Predicted class per object using the Light Curve classifier (lc_classifier)\n-- Optimize by filtering directly on classifier_name, ranking=1, and the latest classifier_version from taxonomy\n\nSELECT p.oid,\n       p.class_name,\n       p.probability\nFROM probability AS p\nWHERE p.classifier_name = 'lc_classifier' -- condition 1: classifier\n\n  AND p.ranking = 1 -- condition 2: top-ranked class per object\n\n  AND p.classifier_version =\n    (-- condition 3: latest classifier version\n SELECT MAX(t.classifier_version)\n     FROM taxonomy AS t\n     WHERE t.classifier_name = 'lc_classifier');",
            "sql_response": {
                "responses": {
                    "0": "-- Predicted class per object using the Light Curve classifier (lc_classifier)\n-- Optimize by filtering directly on classifier_name, ranking=1, and the latest classifier_version from taxonomy\n\nSELECT p.oid,\n       p.class_name,\n       p.probability\nFROM probability AS p\nWHERE p.classifier_name = 'lc_classifier' -- condition 1: classifier\n\n  AND p.ranking = 1 -- condition 2: top-ranked class per object\n\n  AND p.classifier_version =\n    (-- condition 3: latest classifier version\n SELECT MAX(t.classifier_version)\n     FROM taxonomy AS t\n     WHERE t.classifier_name = 'lc_classifier');"
                },
                "in_toks": 1009,
                "out_toks": 1491,
                "id": "chatcmpl-Cb9Zb89mLW5lqGt2xNeeVLggAmtey",
                "created": 1762970971,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Predicted class per object using the Light Curve classifier (lc_classifier)\n-- Ranking=1 selects the most probable class per object (and classifier version).\nWITH top_ranked_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n)\nSELECT p.oid, p.class_name, p.probability\nFROM probability AS p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM top_ranked_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Predicted class per object using the Light Curve classifier (lc_classifier)\n-- Ranking=1 selects the most probable class per object (and classifier version).\nWITH top_ranked_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n)\nSELECT p.oid, p.class_name, p.probability\nFROM probability AS p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM top_ranked_oids);"
                },
                "in_toks": 2119,
                "out_toks": 1983,
                "id": "chatcmpl-CZRDQFiQYe71u68zYND68CLBV4vK1",
                "created": 1762562132,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "30",
            "experiment_id": "run_8",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 720,
                "id": "chatcmpl-CZMOR2mbuFuD9lkEaMaml11PUkTwV",
                "created": 1762543595,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Predicted class per object from the Light Curve classifier (lc_classifier)\n-- Uses ranking=1 (most probable per classifier version) and, if multiple versions exist,\n-- keeps the row with the highest probability per oid.\nWITH lc_rank1 AS (\n    SELECT oid, class_name, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n)\nSELECT DISTINCT ON (oid) oid, class_name, probability\nFROM lc_rank1\nORDER BY oid, probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Predicted class per object from the Light Curve classifier (lc_classifier)\n-- Uses ranking=1 (most probable per classifier version) and, if multiple versions exist,\n-- keeps the row with the highest probability per oid.\nWITH lc_rank1 AS (\n    SELECT oid, class_name, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n)\nSELECT DISTINCT ON (oid) oid, class_name, probability\nFROM lc_rank1\nORDER BY oid, probability DESC;"
                },
                "in_toks": 2119,
                "out_toks": 2419,
                "id": "chatcmpl-CZRDUAfYn8v13MY3voFzBCowOhkjG",
                "created": 1762562136,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "30",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy']"
                },
                "in_toks": 622,
                "out_toks": 720,
                "id": "chatcmpl-CZMOizP0usbD397XFzxpFZKm3GZir",
                "created": 1762543612,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top predicted class per object using the Light Curve Classifier\n-- If multiple classifier versions exist for an object, this selects the highest classifier_version string (descending) and returns its rank-1 class.\nSELECT p.oid, p.class_name, p.probability\nFROM (\n    SELECT\n        oid,\n        class_name,\n        probability,\n        classifier_version,\n        ROW_NUMBER() OVER (PARTITION BY oid ORDER BY classifier_version DESC) AS rn\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n) AS p\nWHERE p.rn = 1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top predicted class per object using the Light Curve Classifier\n-- If multiple classifier versions exist for an object, this selects the highest classifier_version string (descending) and returns its rank-1 class.\nSELECT p.oid, p.class_name, p.probability\nFROM (\n    SELECT\n        oid,\n        class_name,\n        probability,\n        classifier_version,\n        ROW_NUMBER() OVER (PARTITION BY oid ORDER BY classifier_version DESC) AS rn\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n) AS p\nWHERE p.rn = 1;"
                },
                "in_toks": 2119,
                "out_toks": 1478,
                "id": "chatcmpl-CZRDoN5Pb53OViRJUftdtiCPlZRwA",
                "created": 1762562156,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "22": {
        "0": {
            "req_id": "22",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 607,
                "out_toks": 1568,
                "id": "chatcmpl-CSnTHr0Ax5CW65adJ7RN0lYjuKyPg",
                "created": 1760979387,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with first detection between 2018-06-01 and 2018-07-01 (MJD 58239.0 to 58270.0)\n-- \"Found\" is interpreted as firstmjd in the half-open interval [58239.0, 58270.0)\n-- Restricted to objects classified by the Light Curve Classifier (lc_classifier) with a top-ranked class (ranking = 1)\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with first detection between 2018-06-01 and 2018-07-01 (MJD 58239.0 to 58270.0)\n-- \"Found\" is interpreted as firstmjd in the half-open interval [58239.0, 58270.0)\n-- Restricted to objects classified by the Light Curve Classifier (lc_classifier) with a top-ranked class (ranking = 1)\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n  );"
                },
                "in_toks": 2578,
                "out_toks": 1373,
                "id": "chatcmpl-CSoFHEVek3cKmthj88kDuP5JWCUvY",
                "created": 1760982363,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "22",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 607,
                "out_toks": 1568,
                "id": "chatcmpl-CSnTHr0Ax5CW65adJ7RN0lYjuKyPg",
                "created": 1760979387,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects whose first detection occurred between 2018-06-01 (MJD 58239.0) inclusive\n-- and 2018-07-01 (MJD 58270.0) exclusive, that were classified by the Light Curve classifier.\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n        AND ranking = 1  -- ensure presence of lc_classifier classification (top-ranked class exists)\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects whose first detection occurred between 2018-06-01 (MJD 58239.0) inclusive\n-- and 2018-07-01 (MJD 58270.0) exclusive, that were classified by the Light Curve classifier.\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n        AND ranking = 1  -- ensure presence of lc_classifier classification (top-ranked class exists)\n  );"
                },
                "in_toks": 2578,
                "out_toks": 903,
                "id": "chatcmpl-CSoFYeeQaSORcHKqIsS3O5t3iFz9L",
                "created": 1760982380,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "22",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 607,
                "out_toks": 1168,
                "id": "chatcmpl-CSsa9gra1m9ooyj1IIidf42yn8sLY",
                "created": 1760999033,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first detected between 2018-06-01 (MJD 58239.0) and 2018-07-01 (MJD 58270.0), inclusive,\n-- that have a Light Curve classifier ('lc_classifier') probability entry with top rank (ranking = 1).\n-- We return all columns from the probability table for these objects.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking = 1\n  AND oid IN (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 58239.0 AND 58270.0\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first detected between 2018-06-01 (MJD 58239.0) and 2018-07-01 (MJD 58270.0), inclusive,\n-- that have a Light Curve classifier ('lc_classifier') probability entry with top rank (ranking = 1).\n-- We return all columns from the probability table for these objects.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking = 1\n  AND oid IN (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 58239.0 AND 58270.0\n  );"
                },
                "in_toks": 2578,
                "out_toks": 1673,
                "id": "chatcmpl-CSt0evh888DDSrpzOs0jpSlJppxrX",
                "created": 1761000676,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "22",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 607,
                "out_toks": 979,
                "id": "chatcmpl-CSsaQ0RLrp9ejjga9gBjHKESylKFC",
                "created": 1760999050,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first detected between 2018-06-01 (MJD 58239.0, inclusive) and 2018-07-01 (MJD 58270.0, exclusive)\n-- and that have classifications from the Light Curve classifier (lc_classifier).\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first detected between 2018-06-01 (MJD 58239.0, inclusive) and 2018-07-01 (MJD 58270.0, exclusive)\n-- and that have classifications from the Light Curve classifier (lc_classifier).\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  );"
                },
                "in_toks": 2623,
                "out_toks": 1013,
                "id": "chatcmpl-CSt0zOu1AOhPS9PpCDOSVTHQfyQ8e",
                "created": 1761000697,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "22",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 607,
                "out_toks": 464,
                "id": "chatcmpl-CSsaesFvIQZrDXKtQIcqcc4xbJVNZ",
                "created": 1760999064,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects \"found\" interpreted as those with first detection between 2018-06-01 and 2018-07-01 (MJD 58239.0 to 58270.0)\n-- Filter to objects that have been classified by the Light Curve classifier ('lc_classifier')\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects \"found\" interpreted as those with first detection between 2018-06-01 and 2018-07-01 (MJD 58239.0 to 58270.0)\n-- Filter to objects that have been classified by the Light Curve classifier ('lc_classifier')\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  );"
                },
                "in_toks": 2578,
                "out_toks": 760,
                "id": "chatcmpl-CSt1AFgRvnsiH3wryXpC950Fl4Ann",
                "created": 1761000708,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "22",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 607,
                "out_toks": 656,
                "id": "chatcmpl-CZMOvRG9KtNwCBFvZkt7iTlc5gZc0",
                "created": 1762543625,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first detected between 2018-06-01 (MJD 58239.0) and 2018-07-01 (MJD 58270.0), inclusive\n-- Restricted to objects that have probabilities from the Light Curve Classifier (lc_classifier)\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 58239.0 AND 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  )\nORDER BY firstmjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first detected between 2018-06-01 (MJD 58239.0) and 2018-07-01 (MJD 58270.0), inclusive\n-- Restricted to objects that have probabilities from the Light Curve Classifier (lc_classifier)\nSELECT *\nFROM object\nWHERE firstmjd BETWEEN 58239.0 AND 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  )\nORDER BY firstmjd;"
                },
                "in_toks": 2578,
                "out_toks": 1462,
                "id": "chatcmpl-CZRE14WBze4p1pCKSr5sOxWvbn9VO",
                "created": 1762562169,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "22",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 607,
                "out_toks": 528,
                "id": "chatcmpl-CZMP8e4mjco3k5RxKZ4N8aF7nZgYP",
                "created": 1762543638,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first detected between 2018-06-01 (MJD 58239.0, inclusive) and 2018-07-01 (MJD 58270.0, exclusive)\n-- and that have a Light Curve Classifier ('lc_classifier') probability entry.\n-- Note: If you only want objects with the top-ranked class, add \"AND ranking = 1\" in the subquery.\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first detected between 2018-06-01 (MJD 58239.0, inclusive) and 2018-07-01 (MJD 58270.0, exclusive)\n-- and that have a Light Curve Classifier ('lc_classifier') probability entry.\n-- Note: If you only want objects with the top-ranked class, add \"AND ranking = 1\" in the subquery.\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n  );"
                },
                "in_toks": 2578,
                "out_toks": 1042,
                "id": "chatcmpl-CZREjQMoXn9UNrLE7bIIDTprRSjYg",
                "created": 1762562213,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "22",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 607,
                "out_toks": 656,
                "id": "chatcmpl-CZMPJuRJBEN7vjXxbvqErWXHTq6N1",
                "created": 1762543649,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first detected between 2018-06-01 (MJD 58239.0) inclusive and 2018-07-01 (MJD 58270.0) exclusive\n-- and that have been classified by the Light Curve classifier ('lc_classifier').\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first detected between 2018-06-01 (MJD 58239.0) inclusive and 2018-07-01 (MJD 58270.0) exclusive\n-- and that have been classified by the Light Curve classifier ('lc_classifier').\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n  );"
                },
                "in_toks": 2578,
                "out_toks": 1525,
                "id": "chatcmpl-CZREv50kx4CUHqZZrBB7xmefHSmez",
                "created": 1762562225,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "22",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 607,
                "out_toks": 656,
                "id": "chatcmpl-CZMPbJ7M4bCkRNj2Q7aqiiHVYVQwX",
                "created": 1762543667,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first detected (firstmjd) between 2018-06-01 (MJD 58239.0) inclusive and 2018-07-01 (MJD 58270.0) exclusive\n-- and that have been classified by the Light Curve classifier (classifier_name = 'lc_classifier').\n-- Using a subquery to obtain OIDs from the probability table as recommended, and avoiding JOINs.\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first detected (firstmjd) between 2018-06-01 (MJD 58239.0) inclusive and 2018-07-01 (MJD 58270.0) exclusive\n-- and that have been classified by the Light Curve classifier (classifier_name = 'lc_classifier').\n-- Using a subquery to obtain OIDs from the probability table as recommended, and avoiding JOINs.\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier'\n  );"
                },
                "in_toks": 2578,
                "out_toks": 1171,
                "id": "chatcmpl-CZREv2e1dGKGdLB8iXjI5Uq03krH9",
                "created": 1762562225,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "22",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 607,
                "out_toks": 400,
                "id": "chatcmpl-CZMPxpjdt5QBWgqPea5G3cWHaJUGn",
                "created": 1762543689,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects first detected in [2018-06-01, 2018-07-01) by the Light Curve Classifier\n-- Using MJD boundaries: start = 58239.0 (inclusive), end = 58270.0 (exclusive)\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1  -- ensure object has a top-ranked lc_classifier classification\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects first detected in [2018-06-01, 2018-07-01) by the Light Curve Classifier\n-- Using MJD boundaries: start = 58239.0 (inclusive), end = 58270.0 (exclusive)\nSELECT *\nFROM object\nWHERE firstmjd >= 58239.0\n  AND firstmjd < 58270.0\n  AND oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1  -- ensure object has a top-ranked lc_classifier classification\n);"
                },
                "in_toks": 2578,
                "out_toks": 1355,
                "id": "chatcmpl-CZRF56w2KXiFCp5HXTEduVDEntODR",
                "created": 1762562235,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "12": {
        "0": {
            "req_id": "12",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']",
                    "1": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 2150,
                "id": "chatcmpl-CSnTT8yCeNaCUKhjsuJkwTEJHOpEw",
                "created": 1760979399,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- SNe here includes all LC classifier supernova subclasses: SNIa, SNIbc, SNII, SLSN\n-- Using lc_classifier by default and requiring ranking = 1 (most probable class)\n-- Time filter uses firstmjd between Feb 13 (59988.0) and Sep 10 (60197.0)\n-- Spatial filter uses Q3C polygon query with the user-provided polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd >= 59988.0\n    AND o.firstmjd <= 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- SNe here includes all LC classifier supernova subclasses: SNIa, SNIbc, SNII, SLSN\n-- Using lc_classifier by default and requiring ranking = 1 (most probable class)\n-- Time filter uses firstmjd between Feb 13 (59988.0) and Sep 10 (60197.0)\n-- Spatial filter uses Q3C polygon query with the user-provided polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd >= 59988.0\n    AND o.firstmjd <= 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1\n    );"
                },
                "in_toks": 2668,
                "out_toks": 1799,
                "id": "chatcmpl-CSoFmnQYfgpsmCudgoId1rAcZhp6V",
                "created": 1760982394,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "12",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']",
                    "1": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 2150,
                "id": "chatcmpl-CSnTT8yCeNaCUKhjsuJkwTEJHOpEw",
                "created": 1760979399,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all objects classified as SNe (top-ranked lc_classifier: SNIa, SNIbc, SNII, SLSN)\n-- with first detection between MJD 59988.0 (Feb 13) and 60197.0 (Sep 10),\n-- and located inside the given spherical polygon.\nSELECT\n  o.oid,\n  o.meanra,\n  o.meandec\nFROM object o\nWHERE\n  o.firstmjd BETWEEN 59988.0 AND 60197.0\n  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n  AND o.oid IN (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE\n      p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all objects classified as SNe (top-ranked lc_classifier: SNIa, SNIbc, SNII, SLSN)\n-- with first detection between MJD 59988.0 (Feb 13) and 60197.0 (Sep 10),\n-- and located inside the given spherical polygon.\nSELECT\n  o.oid,\n  o.meanra,\n  o.meandec\nFROM object o\nWHERE\n  o.firstmjd BETWEEN 59988.0 AND 60197.0\n  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n  AND o.oid IN (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE\n      p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  );"
                },
                "in_toks": 2668,
                "out_toks": 1894,
                "id": "chatcmpl-CSoG7TJE7y7fVayUiPKELemPM7YYt",
                "created": 1760982415,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "12",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 915,
                "id": "chatcmpl-CSsajCReXtqsTgJGivZAm9mZth8ey",
                "created": 1760999069,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- SNe interpreted as all SN subclasses in the lc_classifier: SNIa, SNIbc, SNII, SLSN\n-- Date range: firstmjd between 59988.0 (Feb 13) and 60197.0 (Sep 10), inclusive\n-- Spatial filter: objects within the given spherical polygon (RA,Dec) using Q3C\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1  -- use top-ranked class as the object's SN class\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- SNe interpreted as all SN subclasses in the lc_classifier: SNIa, SNIbc, SNII, SLSN\n-- Date range: firstmjd between 59988.0 (Feb 13) and 60197.0 (Sep 10), inclusive\n-- Spatial filter: objects within the given spherical polygon (RA,Dec) using Q3C\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1  -- use top-ranked class as the object's SN class\n    );"
                },
                "in_toks": 2668,
                "out_toks": 1981,
                "id": "chatcmpl-CSt1Kjhn7rrvDAa2lailbcIgemKE8",
                "created": 1761000718,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "12",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 1107,
                "id": "chatcmpl-CSsawkymy7yhZCZAR76pal0lEoQr0",
                "created": 1760999082,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- SNe selected using Light Curve classifier (default) and top-ranked class (ranking=1)\n-- Time window: Feb 13 (MJD 59988.0) to Sep 10 (MJD 60197.0)\n-- Spatial filter: within the specified spherical polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n          AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    )\n  AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n  AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n      );",
            "original_sql_response": {
                "responses": {
                    "0": "-- SNe selected using Light Curve classifier (default) and top-ranked class (ranking=1)\n-- Time window: Feb 13 (MJD 59988.0) to Sep 10 (MJD 60197.0)\n-- Spatial filter: within the specified spherical polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n          AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    )\n  AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n  AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n      );"
                },
                "in_toks": 2668,
                "out_toks": 1698,
                "id": "chatcmpl-CSt1e44SCTuQCuFDnMkuYMgxnluYT",
                "created": 1761000738,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "12",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 787,
                "id": "chatcmpl-CSsbBK9rhJUzT0UjYhQYfnqccdJQV",
                "created": 1760999097,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- SNe = {SNIa, SNIbc, SNII, SLSN} in lc_classifier; require top-ranked (ranking=1)\n-- First detection between 2023-02-13 (MJD 59988.0) and 2023-09-10 (MJD 60197.0)\n-- Spatial filter: objects within the given spherical polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nAND o.firstmjd BETWEEN 59988.0 AND 60197.0\nAND q3c_poly_query(\n    o.meanra,\n    o.meandec,\n    '((-20,-20),(-2,-20),(20,1),(10,10))'::polygon\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- SNe = {SNIa, SNIbc, SNII, SLSN} in lc_classifier; require top-ranked (ranking=1)\n-- First detection between 2023-02-13 (MJD 59988.0) and 2023-09-10 (MJD 60197.0)\n-- Spatial filter: objects within the given spherical polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nAND o.firstmjd BETWEEN 59988.0 AND 60197.0\nAND q3c_poly_query(\n    o.meanra,\n    o.meandec,\n    '((-20,-20),(-2,-20),(20,1),(10,10))'::polygon\n);"
                },
                "in_toks": 2668,
                "out_toks": 2027,
                "id": "chatcmpl-CSt1xL0gXNdB9E3LXqZPYcu2xdfWd",
                "created": 1761000757,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "12",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 979,
                "id": "chatcmpl-CZMQCaZj68BBqgdmGqhgTmIYyL7G2",
                "created": 1762543704,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- SNe between Feb 13 (MJD 59988.0) and Sep 10 (MJD 60197.0)\n-- Using lc_classifier with ranking=1 to select Supernova subclasses: SNIa, SNIbc, SNII, SLSN\n-- Spatial filter via q3c_poly_query within the provided polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- SNe between Feb 13 (MJD 59988.0) and Sep 10 (MJD 60197.0)\n-- Using lc_classifier with ranking=1 to select Supernova subclasses: SNIa, SNIbc, SNII, SLSN\n-- Spatial filter via q3c_poly_query within the provided polygon\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    );"
                },
                "in_toks": 2668,
                "out_toks": 1714,
                "id": "chatcmpl-CZRFALv1KBIHBafaZ4G7eiNoqUUiy",
                "created": 1762562240,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "12",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 723,
                "id": "chatcmpl-CZMQa0dagmQ4DwVdDU4BWwUKE1mkY",
                "created": 1762543728,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- SNe = all supernova subclasses in the lc_classifier: SNIa, SNIbc, SNII, SLSN\n-- \"first occurred\" interpreted as firstmjd; inclusive range: 2023-02-13 (59988.0) to 2023-09-10 (60197.0)\n-- Spatial filter uses Q3C polygon query on meanra, meandec\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- SNe = all supernova subclasses in the lc_classifier: SNIa, SNIbc, SNII, SLSN\n-- \"first occurred\" interpreted as firstmjd; inclusive range: 2023-02-13 (59988.0) to 2023-09-10 (60197.0)\n-- Spatial filter uses Q3C polygon query on meanra, meandec\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    );"
                },
                "in_toks": 2668,
                "out_toks": 1657,
                "id": "chatcmpl-CZRFmpg9eGABaHcYGwtioRLwOgYDG",
                "created": 1762562278,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "12",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 787,
                "id": "chatcmpl-CZMQsbgZLjd6DJ4CdMKcXBmD3Ax9r",
                "created": 1762543746,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- SNe classified by the Light Curve classifier (top-ranked): SNIa, SNIbc, SNII, SLSN\n-- First detection between MJD 59988.0 (Feb 13) and 60197.0 (Sep 10)\n-- Spatial filter: within the provided polygon using Q3C\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- SNe classified by the Light Curve classifier (top-ranked): SNIa, SNIbc, SNII, SLSN\n-- First detection between MJD 59988.0 (Feb 13) and 60197.0 (Sep 10)\n-- Spatial filter: within the provided polygon using Q3C\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1\n    );"
                },
                "in_toks": 2668,
                "out_toks": 1837,
                "id": "chatcmpl-CZRFw43QKHE2pCHl3SmdWxWQlEVit",
                "created": 1762562288,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "12",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 1235,
                "id": "chatcmpl-CZMRBmZexmVpotZlT2UXVsUqmif4R",
                "created": 1762543765,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return OIDs and mean coordinates for objects classified as SNe (top-ranked lc_classifier class in {SNIa,SNIbc,SNII,SLSN}),\n-- with first detection between MJD 59988.0 (Feb 13) and 60197.0 (Sep 10),\n-- and located within the specified polygon.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return OIDs and mean coordinates for objects classified as SNe (top-ranked lc_classifier class in {SNIa,SNIbc,SNII,SLSN}),\n-- with first detection between MJD 59988.0 (Feb 13) and 60197.0 (Sep 10),\n-- and located within the specified polygon.\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(\n        o.meanra,\n        o.meandec,\n        '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n    )\n    AND o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.ranking = 1\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    );"
                },
                "in_toks": 2668,
                "out_toks": 2031,
                "id": "chatcmpl-CZRANTLkhg3a5Ox5ISJtxeGGhH2N1",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "12",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 723,
                "id": "chatcmpl-CZMRZ9TIYSUeyrudm4Vdmjqlk5lgY",
                "created": 1762543789,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- SNe (all types) from the Light Curve Classifier with top-ranked SN subclass\n-- Time window: firstmjd between 2023-02-13 (MJD 59988.0) and 2023-09-10 (MJD 60197.0)\n-- Spatial filter: inside the polygon given\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND o.oid IN (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "-- SNe (all types) from the Light Curve Classifier with top-ranked SN subclass\n-- Time window: firstmjd between 2023-02-13 (MJD 59988.0) and 2023-09-10 (MJD 60197.0)\n-- Spatial filter: inside the polygon given\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE\n    o.firstmjd BETWEEN 59988.0 AND 60197.0\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    AND o.oid IN (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE\n            p.classifier_name = 'lc_classifier'\n            AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n            AND p.ranking = 1\n    );"
                },
                "in_toks": 2668,
                "out_toks": 1705,
                "id": "chatcmpl-CZRANKkkt6w0PXzBktpNj8PGBYjA5",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "57": {
        "0": {
            "req_id": "57",
            "experiment_id": "run_0",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 727,
                "out_toks": 920,
                "id": "chatcmpl-CSnTrN76BI08i8wmTdm7ETTg9J4MO",
                "created": 1760979423,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized: use two independent q3c radial searches with UNION ALL (avoids LATERAL and enables q3c index use)\n-- Returns input identifier, input coords and radius (deg), plus ZTF oid, ndet, meanra, meandec, firstmjd\n-- Sorted by lastmjd (last detection date) descending\n\nSELECT identifier,\n       ra, dec, radius_deg,\n                ztf_oid,\n                ndet,\n                meanra,\n                meandec,\n                firstmjd\nFROM\n  (SELECT 'id_1'::text AS identifier,\n          354.67::double precision AS ra,\n          15.954::double precision AS dec,\n          (30.0/3600.0)::double precision AS radius_deg,\n          o.oid AS ztf_oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL SELECT 'id_2'::text AS identifier,\n                    20.7993::double precision AS ra,\n                    1.00331::double precision AS dec,\n                    (20.0/3600.0)::double precision AS radius_deg,\n                    o.oid AS ztf_oid,\n                    o.ndet,\n                    o.meanra,\n                    o.meandec,\n                    o.firstmjd,\n                    o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0)) hits\nORDER BY hits.lastmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized: use two independent q3c radial searches with UNION ALL (avoids LATERAL and enables q3c index use)\n-- Returns input identifier, input coords and radius (deg), plus ZTF oid, ndet, meanra, meandec, firstmjd\n-- Sorted by lastmjd (last detection date) descending\n\nSELECT identifier,\n       ra, dec, radius_deg,\n                ztf_oid,\n                ndet,\n                meanra,\n                meandec,\n                firstmjd\nFROM\n  (SELECT 'id_1'::text AS identifier,\n          354.67::double precision AS ra,\n          15.954::double precision AS dec,\n          (30.0/3600.0)::double precision AS radius_deg,\n          o.oid AS ztf_oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL SELECT 'id_2'::text AS identifier,\n                    20.7993::double precision AS ra,\n                    1.00331::double precision AS dec,\n                    (20.0/3600.0)::double precision AS radius_deg,\n                    o.oid AS ztf_oid,\n                    o.ndet,\n                    o.meanra,\n                    o.meandec,\n                    o.firstmjd,\n                    o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0)) hits\nORDER BY hits.lastmjd DESC;"
                },
                "in_toks": 1837,
                "out_toks": 1493,
                "id": "chatcmpl-Cb9a7WTw1lEafZo3Wgt7HoTvR6aVs",
                "created": 1762971003,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find ZTF objects within 30\" of id_1 (354.67, 15.954) or 20\" of id_2 (20.7993, 1.00331)\n-- Return input identifier, input coords and radius (deg), plus ZTF oid, ndet, meanra, meandec, firstmjd\n-- Sort by lastmjd (last detection date) descending\n\nWITH catalog (source_id, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67,   15.954,   30.0/3600.0),  -- 30 arcsec = 0.008333... deg\n        ('id_2', 20.7993,   1.00331, 20.0/3600.0)   -- 20 arcsec = 0.005555... deg\n),\nhits AS (\n    SELECT\n        c.source_id,\n        c.ra,\n        c.dec,\n        c.radius_deg,\n        o.oid        AS ztf_oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM catalog c,\n         LATERAL (\n             SELECT oid, ndet, meanra, meandec, firstmjd, lastmjd\n             FROM object\n             WHERE q3c_radial_query(object.meanra, object.meandec, c.ra, c.dec, c.radius_deg)\n         ) o\n)\nSELECT\n    source_id AS identifier,\n    ra,\n    dec,\n    radius_deg,\n    ztf_oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM hits\nORDER BY lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find ZTF objects within 30\" of id_1 (354.67, 15.954) or 20\" of id_2 (20.7993, 1.00331)\n-- Return input identifier, input coords and radius (deg), plus ZTF oid, ndet, meanra, meandec, firstmjd\n-- Sort by lastmjd (last detection date) descending\n\nWITH catalog (source_id, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67,   15.954,   30.0/3600.0),  -- 30 arcsec = 0.008333... deg\n        ('id_2', 20.7993,   1.00331, 20.0/3600.0)   -- 20 arcsec = 0.005555... deg\n),\nhits AS (\n    SELECT\n        c.source_id,\n        c.ra,\n        c.dec,\n        c.radius_deg,\n        o.oid        AS ztf_oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM catalog c,\n         LATERAL (\n             SELECT oid, ndet, meanra, meandec, firstmjd, lastmjd\n             FROM object\n             WHERE q3c_radial_query(object.meanra, object.meandec, c.ra, c.dec, c.radius_deg)\n         ) o\n)\nSELECT\n    source_id AS identifier,\n    ra,\n    dec,\n    radius_deg,\n    ztf_oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM hits\nORDER BY lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 2943,
                "id": "chatcmpl-CSoGRWwDqnc6jsPuerYcI3CUHXsR7",
                "created": 1760982435,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "57",
            "experiment_id": "run_1",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 727,
                "out_toks": 920,
                "id": "chatcmpl-CSnTrN76BI08i8wmTdm7ETTg9J4MO",
                "created": 1760979423,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Optimized query: perform two index-accelerated radial searches with constants and UNION ALL, avoiding cross joins and re-scans; then sort by last detection date (lastmjd) descending */ WITH candidates AS\n  (SELECT 'id_1'::text AS input_identifier,\n          354.67::double precision AS input_ra_deg,\n          15.954::double precision AS input_dec_deg,\n          (30.0/3600.0)::double precision AS search_radius_deg,\n          o.oid AS ztf_oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL SELECT 'id_2'::text AS input_identifier,\n                    20.7993::double precision AS input_ra_deg,\n                    1.00331::double precision AS input_dec_deg,\n                    (20.0/3600.0)::double precision AS search_radius_deg,\n                    o.oid AS ztf_oid,\n                    o.ndet,\n                    o.meanra,\n                    o.meandec,\n                    o.firstmjd,\n                    o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT input_identifier,\n       input_ra_deg,\n       input_dec_deg,\n       search_radius_deg,\n       ztf_oid,\n       ndet,\n       meanra,\n       meandec,\n       firstmjd\nFROM candidates\nORDER BY lastmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "/* Optimized query: perform two index-accelerated radial searches with constants and UNION ALL, avoiding cross joins and re-scans; then sort by last detection date (lastmjd) descending */ WITH candidates AS\n  (SELECT 'id_1'::text AS input_identifier,\n          354.67::double precision AS input_ra_deg,\n          15.954::double precision AS input_dec_deg,\n          (30.0/3600.0)::double precision AS search_radius_deg,\n          o.oid AS ztf_oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL SELECT 'id_2'::text AS input_identifier,\n                    20.7993::double precision AS input_ra_deg,\n                    1.00331::double precision AS input_dec_deg,\n                    (20.0/3600.0)::double precision AS search_radius_deg,\n                    o.oid AS ztf_oid,\n                    o.ndet,\n                    o.meanra,\n                    o.meandec,\n                    o.firstmjd,\n                    o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT input_identifier,\n       input_ra_deg,\n       input_dec_deg,\n       search_radius_deg,\n       ztf_oid,\n       ndet,\n       meanra,\n       meandec,\n       firstmjd\nFROM candidates\nORDER BY lastmjd DESC;"
                },
                "in_toks": 1708,
                "out_toks": 2121,
                "id": "chatcmpl-Cb9achOpPvKVSf5TKQTRdKkdbItAg",
                "created": 1762971034,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find ZTF objects within 30\" of id_1 or 20\" of id_2; return input source info and matched object info; sort by last detection date (lastmjd) descending */\nWITH catalog (source_id, ra, dec, radius) AS (\n    VALUES\n        ('id_1', 354.67, 15.954, 30.0/3600.0),   -- 30 arcsec in degrees\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0) -- 20 arcsec in degrees\n),\nmatches AS (\n    SELECT\n        o.oid AS ztf_oid,\n        c.source_id,\n        c.ra,\n        c.dec,\n        c.radius\n    FROM catalog c, object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius)\n)\nSELECT\n    m.source_id AS input_identifier,\n    m.ra AS input_ra_deg,\n    m.dec AS input_dec_deg,\n    m.radius AS search_radius_deg,\n    o.oid AS ztf_oid,\n    o.ndet AS ndet,\n    o.meanra AS meanra,\n    o.meandec AS meandec,\n    o.firstmjd AS firstmjd\nFROM object o, matches m\nWHERE o.oid = m.ztf_oid\nORDER BY o.lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find ZTF objects within 30\" of id_1 or 20\" of id_2; return input source info and matched object info; sort by last detection date (lastmjd) descending */\nWITH catalog (source_id, ra, dec, radius) AS (\n    VALUES\n        ('id_1', 354.67, 15.954, 30.0/3600.0),   -- 30 arcsec in degrees\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0) -- 20 arcsec in degrees\n),\nmatches AS (\n    SELECT\n        o.oid AS ztf_oid,\n        c.source_id,\n        c.ra,\n        c.dec,\n        c.radius\n    FROM catalog c, object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius)\n)\nSELECT\n    m.source_id AS input_identifier,\n    m.ra AS input_ra_deg,\n    m.dec AS input_dec_deg,\n    m.radius AS search_radius_deg,\n    o.oid AS ztf_oid,\n    o.ndet AS ndet,\n    o.meanra AS meanra,\n    o.meandec AS meandec,\n    o.firstmjd AS firstmjd\nFROM object o, matches m\nWHERE o.oid = m.ztf_oid\nORDER BY o.lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 2746,
                "id": "chatcmpl-CSoGoFiGfXwCNoAqXl2byAexMAW3n",
                "created": 1760982458,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "57",
            "experiment_id": "run_2",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 727,
                "out_toks": 524,
                "id": "chatcmpl-CSsbMyAXNmT9jhPYZqS1ndKqbngPL",
                "created": 1760999108,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized: run two independent, index-usable q3c radial searches and UNION ALL\n-- Avoids a cartesian product with VALUES that can force a table scan\n-- 1 arcsec = 1/3600 deg\n WITH matches AS\n  (-- Cone around id_1: (RA, Dec) = (354.67, 15.954) deg, radius = 30\"\n SELECT 'id_1'::text AS identifier, -- input object identifier\n 354.67::double precision AS ra, -- input RA (deg)\n 15.954::double precision AS dec, -- input Dec (deg)\n (30.0/3600.0)::double precision AS radius_deg, -- search radius (deg)\n o.oid, -- ZTF identifier\n o.ndet, -- number of detections\n o.meanra, -- mean RA (deg)\n o.meandec, -- mean Dec (deg)\n o.firstmjd, -- first detection date (MJD)\n o.lastmjd -- last detection date (MJD) for sorting\n \n   FROM OBJECT o \n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0) \n   UNION ALL -- Cone around id_2: (RA, Dec) = (20.7993, 1.00331) deg, radius = 20\"\n SELECT 'id_2'::text AS identifier,\n        20.7993::double precision AS ra,\n        1.00331::double precision AS dec,\n        (20.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT identifier, -- input object identifier\n ra, -- input RA (deg)\n dec, -- input Dec (deg)\n radius_deg, -- search radius used (deg)\n oid, -- ZTF object identifier\n ndet, -- number of detections\n meanra, -- mean RA (deg)\n meandec, -- mean Dec (deg)\n firstmjd -- first detection date (MJD)\nFROM matches\nORDER BY lastmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized: run two independent, index-usable q3c radial searches and UNION ALL\n-- Avoids a cartesian product with VALUES that can force a table scan\n-- 1 arcsec = 1/3600 deg\n WITH matches AS\n  (-- Cone around id_1: (RA, Dec) = (354.67, 15.954) deg, radius = 30\"\n SELECT 'id_1'::text AS identifier, -- input object identifier\n 354.67::double precision AS ra, -- input RA (deg)\n 15.954::double precision AS dec, -- input Dec (deg)\n (30.0/3600.0)::double precision AS radius_deg, -- search radius (deg)\n o.oid, -- ZTF identifier\n o.ndet, -- number of detections\n o.meanra, -- mean RA (deg)\n o.meandec, -- mean Dec (deg)\n o.firstmjd, -- first detection date (MJD)\n o.lastmjd -- last detection date (MJD) for sorting\n \n   FROM OBJECT o \n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0) \n   UNION ALL -- Cone around id_2: (RA, Dec) = (20.7993, 1.00331) deg, radius = 20\"\n SELECT 'id_2'::text AS identifier,\n        20.7993::double precision AS ra,\n        1.00331::double precision AS dec,\n        (20.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT identifier, -- input object identifier\n ra, -- input RA (deg)\n dec, -- input Dec (deg)\n radius_deg, -- search radius used (deg)\n oid, -- ZTF object identifier\n ndet, -- number of detections\n meanra, -- mean RA (deg)\n meandec, -- mean Dec (deg)\n firstmjd -- first detection date (MJD)\nFROM matches\nORDER BY lastmjd DESC;"
                },
                "in_toks": 1660,
                "out_toks": 2367,
                "id": "chatcmpl-Cb9bFsqL2LT9ZyyFBSPs03INMCFwy",
                "created": 1762971073,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find ZTF objects within 30\" of id_1 (354.67, 15.954) or 20\" of id_2 (20.7993, 1.00331)\n-- 1 arcsec = 1/3600 deg\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n  VALUES\n    ('id_1', 354.67::double precision, 15.954::double precision, 30.0/3600.0),\n    ('id_2', 20.7993::double precision, 1.00331::double precision, 20.0/3600.0)\n)\nSELECT\n  c.identifier,              -- input object identifier\n  c.ra,                      -- input RA (deg)\n  c.dec,                     -- input Dec (deg)\n  c.radius_deg,              -- search radius used (deg)\n  o.oid,                     -- ZTF object identifier\n  o.ndet,                    -- number of detections\n  o.meanra,                  -- mean RA (deg)\n  o.meandec,                 -- mean Dec (deg)\n  o.firstmjd                 -- first detection date (MJD)\nFROM catalog c, object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY o.lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find ZTF objects within 30\" of id_1 (354.67, 15.954) or 20\" of id_2 (20.7993, 1.00331)\n-- 1 arcsec = 1/3600 deg\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n  VALUES\n    ('id_1', 354.67::double precision, 15.954::double precision, 30.0/3600.0),\n    ('id_2', 20.7993::double precision, 1.00331::double precision, 20.0/3600.0)\n)\nSELECT\n  c.identifier,              -- input object identifier\n  c.ra,                      -- input RA (deg)\n  c.dec,                     -- input Dec (deg)\n  c.radius_deg,              -- search radius used (deg)\n  o.oid,                     -- ZTF object identifier\n  o.ndet,                    -- number of detections\n  o.meanra,                  -- mean RA (deg)\n  o.meandec,                 -- mean Dec (deg)\n  o.firstmjd                 -- first detection date (MJD)\nFROM catalog c, object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY o.lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 3180,
                "id": "chatcmpl-CSt2ONeeBQPqUFWxbd0BPjxar7VZb",
                "created": 1761000784,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "57",
            "experiment_id": "run_3",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 727,
                "out_toks": 332,
                "id": "chatcmpl-CSsbTInbpmO5XSHWjq8IvI0zNrBup",
                "created": 1760999115,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query using a small catalog CTE and a LATERAL join so the q3c index\n-- is applied once per input source, avoiding a second scan of the object table.\n-- Returns: input identifier/coords/radius; matched ZTF oid, ndet, meanra, meandec, firstmjd.\n-- Sorted by last detection date (lastmjd) descending.\n WITH CATALOG (identifier,\n               ra, dec, radius_deg) AS (\n                                        VALUES -- arcsec to degrees\n ('id_1',\n  354.67,\n  15.954,\n  30.0/3600.0), ('id_2',\n                 20.7993,\n                 1.00331,\n                 20.0/3600.0)),\n              matches AS\n  (SELECT c.identifier,\n          c.ra,\n          c.dec,\n          c.radius_deg,\n          o.oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM CATALOG c\n   JOIN LATERAL\n     (SELECT oid,\n             ndet,\n             meanra,\n             meandec,\n             firstmjd,\n             lastmjd\n      FROM OBJECT\n      WHERE q3c_radial_query(meanra, meandec, c.ra, c.dec, c.radius_deg)) o ON TRUE)\nSELECT m.identifier, -- input object identifier\n m.ra, -- input RA [deg]\n m.dec, -- input Dec [deg]\n m.radius_deg, -- search radius used [deg]\n m.oid, -- ZTF object identifier\n m.ndet, -- number of detections\n m.meanra, -- mean RA [deg]\n m.meandec, -- mean Dec [deg]\n m.firstmjd -- first detection date [MJD]\nFROM matches m\nORDER BY m.lastmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query using a small catalog CTE and a LATERAL join so the q3c index\n-- is applied once per input source, avoiding a second scan of the object table.\n-- Returns: input identifier/coords/radius; matched ZTF oid, ndet, meanra, meandec, firstmjd.\n-- Sorted by last detection date (lastmjd) descending.\n WITH CATALOG (identifier,\n               ra, dec, radius_deg) AS (\n                                        VALUES -- arcsec to degrees\n ('id_1',\n  354.67,\n  15.954,\n  30.0/3600.0), ('id_2',\n                 20.7993,\n                 1.00331,\n                 20.0/3600.0)),\n              matches AS\n  (SELECT c.identifier,\n          c.ra,\n          c.dec,\n          c.radius_deg,\n          o.oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM CATALOG c\n   JOIN LATERAL\n     (SELECT oid,\n             ndet,\n             meanra,\n             meandec,\n             firstmjd,\n             lastmjd\n      FROM OBJECT\n      WHERE q3c_radial_query(meanra, meandec, c.ra, c.dec, c.radius_deg)) o ON TRUE)\nSELECT m.identifier, -- input object identifier\n m.ra, -- input RA [deg]\n m.dec, -- input Dec [deg]\n m.radius_deg, -- search radius used [deg]\n m.oid, -- ZTF object identifier\n m.ndet, -- number of detections\n m.meanra, -- mean RA [deg]\n m.meandec, -- mean Dec [deg]\n m.firstmjd -- first detection date [MJD]\nFROM matches m\nORDER BY m.lastmjd DESC;"
                },
                "in_toks": 1782,
                "out_toks": 1572,
                "id": "chatcmpl-Cb9btrwYQQvkTVgWnZgoFvSLh9j3Z",
                "created": 1762971113,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF objects within 30 arcsec of id_1 or 20 arcsec of id_2,\n-- including input identifiers/coordinates/radius and matched object details,\n-- sorted by last detection date (lastmjd) descending.\n\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        -- arcsec to degrees: 30\" = 30/3600 deg, 20\" = 20/3600 deg\n        ('id_1', 354.67,   15.954,   30.0/3600.0),\n        ('id_2', 20.7993,   1.00331, 20.0/3600.0)\n),\noid_list AS (\n    SELECT\n        o.oid,\n        c.identifier,\n        c.ra,\n        c.dec,\n        c.radius_deg\n    FROM object o, catalog c\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\n)\nSELECT\n    ol.identifier,          -- input object identifier\n    ol.ra,                  -- input RA [deg]\n    ol.dec,                 -- input Dec [deg]\n    ol.radius_deg,          -- search radius used [deg]\n    o.oid,                  -- ZTF object identifier\n    o.ndet,                 -- number of detections\n    o.meanra,               -- mean RA [deg]\n    o.meandec,              -- mean Dec [deg]\n    o.firstmjd              -- first detection date [MJD]\nFROM object o, oid_list ol\nWHERE o.oid = ol.oid\nORDER BY o.lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF objects within 30 arcsec of id_1 or 20 arcsec of id_2,\n-- including input identifiers/coordinates/radius and matched object details,\n-- sorted by last detection date (lastmjd) descending.\n\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        -- arcsec to degrees: 30\" = 30/3600 deg, 20\" = 20/3600 deg\n        ('id_1', 354.67,   15.954,   30.0/3600.0),\n        ('id_2', 20.7993,   1.00331, 20.0/3600.0)\n),\noid_list AS (\n    SELECT\n        o.oid,\n        c.identifier,\n        c.ra,\n        c.dec,\n        c.radius_deg\n    FROM object o, catalog c\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\n)\nSELECT\n    ol.identifier,          -- input object identifier\n    ol.ra,                  -- input RA [deg]\n    ol.dec,                 -- input Dec [deg]\n    ol.radius_deg,          -- search radius used [deg]\n    o.oid,                  -- ZTF object identifier\n    o.ndet,                 -- number of detections\n    o.meanra,               -- mean RA [deg]\n    o.meandec,              -- mean Dec [deg]\n    o.firstmjd              -- first detection date [MJD]\nFROM object o, oid_list ol\nWHERE o.oid = ol.oid\nORDER BY o.lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 2667,
                "id": "chatcmpl-CSt2uYwwaGgsEIfhCVc4kKX1Z07uD",
                "created": 1761000816,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "57",
            "experiment_id": "run_4",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 727,
                "out_toks": 396,
                "id": "chatcmpl-CSsbYvJpMi2OoU4RtaBpuG6UmB6sK",
                "created": 1760999120,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Find ZTF objects within 30\" of id_1 or 20\" of id_2 using q3c, avoiding a cross join to use the q3c index efficiently\nWITH candidates AS\n  (-- Nearby objects to id_1\n SELECT 'id_1'::text AS identifier,\n        354.67::double precision AS input_ra,\n        15.954::double precision AS input_dec,\n        (30.0/3600.0)::double precision AS search_radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67::double precision, 15.954::double precision, (30.0/3600.0)::double precision)\n   UNION ALL -- Nearby objects to id_2\n SELECT 'id_2'::text AS identifier,\n        20.7993::double precision AS input_ra,\n        1.00331::double precision AS input_dec,\n        (20.0/3600.0)::double precision AS search_radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993::double precision, 1.00331::double precision, (20.0/3600.0)::double precision))\nSELECT identifier,\n       input_ra,\n       input_dec,\n       search_radius_deg,\n       oid,\n       ndet,\n       meanra,\n       meandec,\n       firstmjd\nFROM candidates -- Sort by last detection date (lastmjd) in descending order as requested\nORDER BY lastmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Find ZTF objects within 30\" of id_1 or 20\" of id_2 using q3c, avoiding a cross join to use the q3c index efficiently\nWITH candidates AS\n  (-- Nearby objects to id_1\n SELECT 'id_1'::text AS identifier,\n        354.67::double precision AS input_ra,\n        15.954::double precision AS input_dec,\n        (30.0/3600.0)::double precision AS search_radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67::double precision, 15.954::double precision, (30.0/3600.0)::double precision)\n   UNION ALL -- Nearby objects to id_2\n SELECT 'id_2'::text AS identifier,\n        20.7993::double precision AS input_ra,\n        1.00331::double precision AS input_dec,\n        (20.0/3600.0)::double precision AS search_radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993::double precision, 1.00331::double precision, (20.0/3600.0)::double precision))\nSELECT identifier,\n       input_ra,\n       input_dec,\n       search_radius_deg,\n       oid,\n       ndet,\n       meanra,\n       meandec,\n       firstmjd\nFROM candidates -- Sort by last detection date (lastmjd) in descending order as requested\nORDER BY lastmjd DESC;"
                },
                "in_toks": 1556,
                "out_toks": 2345,
                "id": "chatcmpl-Cb9cL661ZzY6Hl4ON7AdVOcL2UGtq",
                "created": 1762971141,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define the input targets and their search radii (converted from arcseconds to degrees)\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67::double precision, 15.954::double precision, 30.0/3600.0), -- 30 arcsec = 0.008333... deg\n        ('id_2', 20.7993::double precision, 1.00331::double precision, 20.0/3600.0) -- 20 arcsec = 0.005555... deg\n)\nSELECT\n    c.identifier,\n    c.ra AS input_ra,\n    c.dec AS input_dec,\n    c.radius_deg AS search_radius_deg,\n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM\n    object o,\n    catalog c\nWHERE\n    q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY\n    o.lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define the input targets and their search radii (converted from arcseconds to degrees)\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67::double precision, 15.954::double precision, 30.0/3600.0), -- 30 arcsec = 0.008333... deg\n        ('id_2', 20.7993::double precision, 1.00331::double precision, 20.0/3600.0) -- 20 arcsec = 0.005555... deg\n)\nSELECT\n    c.identifier,\n    c.ra AS input_ra,\n    c.dec AS input_dec,\n    c.radius_deg AS search_radius_deg,\n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM\n    object o,\n    catalog c\nWHERE\n    q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY\n    o.lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 2739,
                "id": "chatcmpl-CSt3LSnaQ67vRE5RVvJtwLPnyJgeX",
                "created": 1761000843,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "57",
            "experiment_id": "run_5",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 727,
                "out_toks": 460,
                "id": "chatcmpl-CZMS4nGdXgzQ1EZJtb2zJ3ws4EKlw",
                "created": 1762543820,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find ZTF objects within 30\" of id_1 (354.67, 15.954) or 20\" of id_2 (20.7993, 1.00331)\n-- Radii converted to degrees: 30\" = 30/3600 deg, 20\" = 20/3600 deg\nSELECT\n  t.identifier AS input_identifier,\n  t.input_ra AS input_ra_deg,\n  t.input_dec AS input_dec_deg,\n  t.radius_deg AS search_radius_deg,\n  t.oid,\n  t.ndet,\n  t.meanra,\n  t.meandec,\n  t.firstmjd\nFROM (\n  SELECT\n    'id_1'::text AS identifier,\n    354.67::double precision AS input_ra,\n    15.954::double precision AS input_dec,\n    (30.0/3600.0)::double precision AS radius_deg,\n    o.*\n  FROM object o\n  WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n\n  UNION ALL\n\n  SELECT\n    'id_2'::text AS identifier,\n    20.7993::double precision AS input_ra,\n    1.00331::double precision AS input_dec,\n    (20.0/3600.0)::double precision AS radius_deg,\n    o.*\n  FROM object o\n  WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0)\n) AS t\nORDER BY t.lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find ZTF objects within 30\" of id_1 (354.67, 15.954) or 20\" of id_2 (20.7993, 1.00331)\n-- Radii converted to degrees: 30\" = 30/3600 deg, 20\" = 20/3600 deg\nSELECT\n  t.identifier AS input_identifier,\n  t.input_ra AS input_ra_deg,\n  t.input_dec AS input_dec_deg,\n  t.radius_deg AS search_radius_deg,\n  t.oid,\n  t.ndet,\n  t.meanra,\n  t.meandec,\n  t.firstmjd\nFROM (\n  SELECT\n    'id_1'::text AS identifier,\n    354.67::double precision AS input_ra,\n    15.954::double precision AS input_dec,\n    (30.0/3600.0)::double precision AS radius_deg,\n    o.*\n  FROM object o\n  WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n\n  UNION ALL\n\n  SELECT\n    'id_2'::text AS identifier,\n    20.7993::double precision AS input_ra,\n    1.00331::double precision AS input_dec,\n    (20.0/3600.0)::double precision AS radius_deg,\n    o.*\n  FROM object o\n  WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0)\n) AS t\nORDER BY t.lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 2606,
                "id": "chatcmpl-CZRANGdEp2tThnsvQGaanI4lzdKhZ",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "57",
            "experiment_id": "run_6",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 727,
                "out_toks": 524,
                "id": "chatcmpl-CZMSJgzqvEpzvdJ1xJLE62ZYevzUF",
                "created": 1762543835,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized cone searches around two fixed positions using Q3C, avoiding LATERAL and full scans\n-- Radii are given in arcseconds and converted to degrees\nWITH matches AS\n  (SELECT 'id_1'::text AS identifier,\n          354.67::double precision AS ra,\n          15.954::double precision AS dec,\n          (30.0/3600.0)::double precision AS radius_deg,\n          o.oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL SELECT 'id_2'::text AS identifier,\n                    20.7993::double precision AS ra,\n                    1.00331::double precision AS dec,\n                    (20.0/3600.0)::double precision AS radius_deg,\n                    o.oid,\n                    o.ndet,\n                    o.meanra,\n                    o.meandec,\n                    o.firstmjd,\n                    o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT identifier, -- input object identifier (id_1 or id_2)\n ra, -- input RA (deg)\n dec, -- input Dec (deg)\n radius_deg, -- search radius used (deg)\n oid, -- matched ZTF object id\n ndet, -- number of detections\n meanra, -- mean RA of ZTF object (deg)\n meandec, -- mean Dec of ZTF object (deg)\n firstmjd -- first detection date (MJD)\nFROM matches\nORDER BY lastmjd DESC; -- sorted by last detection date (most recent first)",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized cone searches around two fixed positions using Q3C, avoiding LATERAL and full scans\n-- Radii are given in arcseconds and converted to degrees\nWITH matches AS\n  (SELECT 'id_1'::text AS identifier,\n          354.67::double precision AS ra,\n          15.954::double precision AS dec,\n          (30.0/3600.0)::double precision AS radius_deg,\n          o.oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL SELECT 'id_2'::text AS identifier,\n                    20.7993::double precision AS ra,\n                    1.00331::double precision AS dec,\n                    (20.0/3600.0)::double precision AS radius_deg,\n                    o.oid,\n                    o.ndet,\n                    o.meanra,\n                    o.meandec,\n                    o.firstmjd,\n                    o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT identifier, -- input object identifier (id_1 or id_2)\n ra, -- input RA (deg)\n dec, -- input Dec (deg)\n radius_deg, -- search radius used (deg)\n oid, -- matched ZTF object id\n ndet, -- number of detections\n meanra, -- mean RA of ZTF object (deg)\n meandec, -- mean Dec of ZTF object (deg)\n firstmjd -- first detection date (MJD)\nFROM matches\nORDER BY lastmjd DESC; -- sorted by last detection date (most recent first)"
                },
                "in_toks": 1657,
                "out_toks": 2116,
                "id": "chatcmpl-Cb9ctidrKzJdSRMUHJLQ8Uh46aEGv",
                "created": 1762971175,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Cone search around two input sources using Q3C, returning input metadata and matching ZTF object info\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        -- radii converted from arcseconds to degrees\n        ('id_1', 354.67,   15.954,   30.0/3600.0),  -- 30\"\n        ('id_2',  20.7993,  1.00331, 20.0/3600.0)   -- 20\"\n)\nSELECT\n    -- input (catalog) info\n    c.identifier,\n    c.ra,\n    c.dec,\n    c.radius_deg,\n    -- matched ZTF object info\n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c,\nLATERAL (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM object o\n    -- q3c_radial_query(ra, dec, center_ra, center_dec, radius_deg)\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\n) o\nORDER BY o.lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Cone search around two input sources using Q3C, returning input metadata and matching ZTF object info\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        -- radii converted from arcseconds to degrees\n        ('id_1', 354.67,   15.954,   30.0/3600.0),  -- 30\"\n        ('id_2',  20.7993,  1.00331, 20.0/3600.0)   -- 20\"\n)\nSELECT\n    -- input (catalog) info\n    c.identifier,\n    c.ra,\n    c.dec,\n    c.radius_deg,\n    -- matched ZTF object info\n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c,\nLATERAL (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM object o\n    -- q3c_radial_query(ra, dec, center_ra, center_dec, radius_deg)\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\n) o\nORDER BY o.lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 2731,
                "id": "chatcmpl-CZRANQkY8vJCxl74WA4JXm0dlkAIe",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "57",
            "experiment_id": "run_7",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 727,
                "out_toks": 332,
                "id": "chatcmpl-CZMSUlTn6jorjloReBaIhggIMGiIZ",
                "created": 1762543846,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Optimized radial search using q3c with constants to leverage the q3c index.\n   Avoids cross-joining the entire object table with a CTE, which caused timeouts. */ WITH matched AS\n  (-- id_1 within 30 arcsec (30/3600 deg)\n SELECT 'id_1'::text AS identifier,\n        354.67::double precision AS ra,\n        15.954::double precision AS dec,\n        (30.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL -- id_2 within 20 arcsec (20/3600 deg)\n SELECT 'id_2'::text AS identifier,\n        20.7993::double precision AS ra,\n        1.00331::double precision AS dec,\n        (20.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT -- input object info\n identifier,\n ra, dec, radius_deg, -- matched ZTF object info\n oid,\n ndet,\n meanra,\n meandec,\n firstmjd\nFROM matched\nORDER BY lastmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "/* Optimized radial search using q3c with constants to leverage the q3c index.\n   Avoids cross-joining the entire object table with a CTE, which caused timeouts. */ WITH matched AS\n  (-- id_1 within 30 arcsec (30/3600 deg)\n SELECT 'id_1'::text AS identifier,\n        354.67::double precision AS ra,\n        15.954::double precision AS dec,\n        (30.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL -- id_2 within 20 arcsec (20/3600 deg)\n SELECT 'id_2'::text AS identifier,\n        20.7993::double precision AS ra,\n        1.00331::double precision AS dec,\n        (20.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT -- input object info\n identifier,\n ra, dec, radius_deg, -- matched ZTF object info\n oid,\n ndet,\n meanra,\n meandec,\n firstmjd\nFROM matched\nORDER BY lastmjd DESC;"
                },
                "in_toks": 1640,
                "out_toks": 2397,
                "id": "chatcmpl-Cb9dhRgGZz0V6ZZNJVgNSgB8VELwe",
                "created": 1762971225,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog (source_id, ra, dec, radius_deg) AS (\n    -- radii given in arcseconds converted to degrees: 30\"/3600 = 0.008333..., 20\"/3600 = 0.005555...\n    VALUES\n        ('id_1', 354.67, 15.954, 30.0/3600.0),\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0)\n),\nmatched AS (\n    -- gather matched objects together with the input (catalog) row that matched them\n    SELECT\n        c.source_id,\n        c.ra,\n        c.dec,\n        c.radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM catalog c, object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\n)\nSELECT\n    -- input object info\n    source_id,\n    ra,\n    dec,\n    radius_deg,\n    -- matched ZTF object info\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM matched\nORDER BY lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog (source_id, ra, dec, radius_deg) AS (\n    -- radii given in arcseconds converted to degrees: 30\"/3600 = 0.008333..., 20\"/3600 = 0.005555...\n    VALUES\n        ('id_1', 354.67, 15.954, 30.0/3600.0),\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0)\n),\nmatched AS (\n    -- gather matched objects together with the input (catalog) row that matched them\n    SELECT\n        c.source_id,\n        c.ra,\n        c.dec,\n        c.radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM catalog c, object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\n)\nSELECT\n    -- input object info\n    source_id,\n    ra,\n    dec,\n    radius_deg,\n    -- matched ZTF object info\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM matched\nORDER BY lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 2721,
                "id": "chatcmpl-CZRANcWOy8bbr993BKWwUky9zcx96",
                "created": 1762561943,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "57",
            "experiment_id": "run_8",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 727,
                "out_toks": 396,
                "id": "chatcmpl-CZMSaJpafttUMmxsLeum4igKJFto8",
                "created": 1762543852,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized cone searches executed separately (to ensure Q3C index usage) and then UNION ALL.\n-- We include lastmjd only in the CTE for efficient ordering, but exclude it from the final output as requested.\n WITH hits AS\n  (-- Cone around id_1: (RA, Dec) = (354.67, 15.954) deg, radius = 30 arcsec\n SELECT 'id_1'::text AS identifier,\n        354.67::double precision AS ra,\n        15.954::double precision AS dec,\n        (30.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67::double precision, 15.954::double precision, (30.0/3600.0)::double precision)\n   UNION ALL -- Cone around id_2: (RA, Dec) = (20.7993, 1.00331) deg, radius = 20 arcsec\n SELECT 'id_2'::text AS identifier,\n        20.7993::double precision AS ra,\n        1.00331::double precision AS dec,\n        (20.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993::double precision, 1.00331::double precision, (20.0/3600.0)::double precision))\nSELECT identifier, -- input identifier\n ra, -- input RA (deg)\n dec, -- input Dec (deg)\n radius_deg, -- input search radius (deg)\n oid, -- ZTF identifier\n ndet, -- number of detections\n meanra, -- mean RA (deg)\n meandec, -- mean Dec (deg)\n firstmjd -- first detection MJD\nFROM hits\nORDER BY lastmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized cone searches executed separately (to ensure Q3C index usage) and then UNION ALL.\n-- We include lastmjd only in the CTE for efficient ordering, but exclude it from the final output as requested.\n WITH hits AS\n  (-- Cone around id_1: (RA, Dec) = (354.67, 15.954) deg, radius = 30 arcsec\n SELECT 'id_1'::text AS identifier,\n        354.67::double precision AS ra,\n        15.954::double precision AS dec,\n        (30.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67::double precision, 15.954::double precision, (30.0/3600.0)::double precision)\n   UNION ALL -- Cone around id_2: (RA, Dec) = (20.7993, 1.00331) deg, radius = 20 arcsec\n SELECT 'id_2'::text AS identifier,\n        20.7993::double precision AS ra,\n        1.00331::double precision AS dec,\n        (20.0/3600.0)::double precision AS radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993::double precision, 1.00331::double precision, (20.0/3600.0)::double precision))\nSELECT identifier, -- input identifier\n ra, -- input RA (deg)\n dec, -- input Dec (deg)\n radius_deg, -- input search radius (deg)\n oid, -- ZTF identifier\n ndet, -- number of detections\n meanra, -- mean RA (deg)\n meandec, -- mean Dec (deg)\n firstmjd -- first detection MJD\nFROM hits\nORDER BY lastmjd DESC;"
                },
                "in_toks": 1620,
                "out_toks": 2710,
                "id": "chatcmpl-Cb9ec2OiQyQ0k63qmB7KGQX8KZJZM",
                "created": 1762971282,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Cone search around two input positions using Q3C, radii converted from arcsec to degrees\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67::double precision, 15.954::double precision, (30.0/3600.0)::double precision),  -- 30 arcsec\n        ('id_2', 20.7993::double precision, 1.00331::double precision, (20.0/3600.0)::double precision) -- 20 arcsec\n)\nSELECT\n    c.identifier,          -- input identifier\n    c.ra,                  -- input RA (deg)\n    c.dec,                 -- input Dec (deg)\n    c.radius_deg,          -- input search radius (deg)\n    o.oid,                 -- ZTF identifier\n    o.ndet,                -- number of detections\n    o.meanra,              -- mean RA (deg)\n    o.meandec,             -- mean Dec (deg)\n    o.firstmjd             -- first detection MJD\nFROM catalog c\nJOIN object o\n  ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY o.lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Cone search around two input positions using Q3C, radii converted from arcsec to degrees\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67::double precision, 15.954::double precision, (30.0/3600.0)::double precision),  -- 30 arcsec\n        ('id_2', 20.7993::double precision, 1.00331::double precision, (20.0/3600.0)::double precision) -- 20 arcsec\n)\nSELECT\n    c.identifier,          -- input identifier\n    c.ra,                  -- input RA (deg)\n    c.dec,                 -- input Dec (deg)\n    c.radius_deg,          -- input search radius (deg)\n    o.oid,                 -- ZTF identifier\n    o.ndet,                -- number of detections\n    o.meanra,              -- mean RA (deg)\n    o.meandec,             -- mean Dec (deg)\n    o.firstmjd             -- first detection MJD\nFROM catalog c\nJOIN object o\n  ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY o.lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 2778,
                "id": "chatcmpl-CZRBxJuX60QB8CYRbQiSEgtzmjmcx",
                "created": 1762562041,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "57",
            "experiment_id": "run_9",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 727,
                "out_toks": 268,
                "id": "chatcmpl-CZMSkpR6htXmgXj1qqXvA5vTO1lzZ",
                "created": 1762543862,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized cone search using Q3C with constant parameters to leverage the spatial index.\n-- Returns input identifier/coords/radius and matching ZTF objects with ndet, mean coordinates, and first detection date.\n-- Sorted by last detection date (not returned) in descending order.\n WITH matches AS\n  (SELECT 'id_1'::text AS input_identifier,\n          354.67::double precision AS input_ra_deg,\n          15.954::double precision AS input_dec_deg,\n          (30.0/3600.0)::double precision AS input_radius_deg,\n          o.oid AS ztf_oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL SELECT 'id_2'::text AS input_identifier,\n                    20.7993::double precision AS input_ra_deg,\n                    1.00331::double precision AS input_dec_deg,\n                    (20.0/3600.0)::double precision AS input_radius_deg,\n                    o.oid AS ztf_oid,\n                    o.ndet,\n                    o.meanra,\n                    o.meandec,\n                    o.firstmjd,\n                    o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT input_identifier,\n       input_ra_deg,\n       input_dec_deg,\n       input_radius_deg,\n       ztf_oid,\n       ndet,\n       meanra,\n       meandec,\n       firstmjd\nFROM matches\nORDER BY lastmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized cone search using Q3C with constant parameters to leverage the spatial index.\n-- Returns input identifier/coords/radius and matching ZTF objects with ndet, mean coordinates, and first detection date.\n-- Sorted by last detection date (not returned) in descending order.\n WITH matches AS\n  (SELECT 'id_1'::text AS input_identifier,\n          354.67::double precision AS input_ra_deg,\n          15.954::double precision AS input_dec_deg,\n          (30.0/3600.0)::double precision AS input_radius_deg,\n          o.oid AS ztf_oid,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0/3600.0)\n   UNION ALL SELECT 'id_2'::text AS input_identifier,\n                    20.7993::double precision AS input_ra_deg,\n                    1.00331::double precision AS input_dec_deg,\n                    (20.0/3600.0)::double precision AS input_radius_deg,\n                    o.oid AS ztf_oid,\n                    o.ndet,\n                    o.meanra,\n                    o.meandec,\n                    o.firstmjd,\n                    o.lastmjd\n   FROM OBJECT o\n   WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0/3600.0))\nSELECT input_identifier,\n       input_ra_deg,\n       input_dec_deg,\n       input_radius_deg,\n       ztf_oid,\n       ndet,\n       meanra,\n       meandec,\n       firstmjd\nFROM matches\nORDER BY lastmjd DESC;"
                },
                "in_toks": 1555,
                "out_toks": 2329,
                "id": "chatcmpl-Cb9fUQWAFJXoFiPq6yrwsJNJVx5dx",
                "created": 1762971336,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Cone-search around two input sources using Q3C and return matching ZTF objects with requested columns.\n   - 30 arcsec = 30/3600 deg\n   - 20 arcsec = 20/3600 deg\n*/\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67,   15.954,  30.0/3600.0),\n        ('id_2',  20.7993,  1.00331, 20.0/3600.0)\n)\nSELECT\n    c.identifier AS input_identifier,\n    c.ra AS input_ra_deg,\n    c.dec AS input_dec_deg,\n    c.radius_deg AS input_radius_deg,\n    o.oid AS ztf_oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c, object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY o.lastmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Cone-search around two input sources using Q3C and return matching ZTF objects with requested columns.\n   - 30 arcsec = 30/3600 deg\n   - 20 arcsec = 20/3600 deg\n*/\nWITH catalog (identifier, ra, dec, radius_deg) AS (\n    VALUES\n        ('id_1', 354.67,   15.954,  30.0/3600.0),\n        ('id_2',  20.7993,  1.00331, 20.0/3600.0)\n)\nSELECT\n    c.identifier AS input_identifier,\n    c.ra AS input_ra_deg,\n    c.dec AS input_dec_deg,\n    c.radius_deg AS input_radius_deg,\n    o.oid AS ztf_oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c, object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius_deg)\nORDER BY o.lastmjd DESC;"
                },
                "in_toks": 2478,
                "out_toks": 3442,
                "id": "chatcmpl-CZRCBbdee3fMgVswc4dZ7Rk1EYxJf",
                "created": 1762562055,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        }
    },
    "75": {
        "0": {
            "req_id": "75",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 158,
                "id": "chatcmpl-CSnTzmuoNRyJay6wdbfDZeFV5Mfq0",
                "created": 1760979431,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get up to 100 rows with a known (non-null) nearest Solar System object name\n-- Note: ssnamenr may store the literal string 'null' for unknowns, so we exclude that too\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND lower(ssnamenr) <> 'null'\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get up to 100 rows with a known (non-null) nearest Solar System object name\n-- Note: ssnamenr may store the literal string 'null' for unknowns, so we exclude that too\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND lower(ssnamenr) <> 'null'\nLIMIT 100;"
                },
                "in_toks": 2039,
                "out_toks": 916,
                "id": "chatcmpl-CSoHLFRVRZgmjK7sfztbu2hgd82Ss",
                "created": 1760982491,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "75",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 158,
                "id": "chatcmpl-CSnTzmuoNRyJay6wdbfDZeFV5Mfq0",
                "created": 1760979431,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return up to 100 rows from ss_ztf where the nearest Solar System object name is known\n-- Some records may store unknown as the literal string 'null', so exclude both SQL NULL and 'null'\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return up to 100 rows from ss_ztf where the nearest Solar System object name is known\n-- Some records may store unknown as the literal string 'null', so exclude both SQL NULL and 'null'\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;"
                },
                "in_toks": 2039,
                "out_toks": 594,
                "id": "chatcmpl-CSoHVr2VYiRGGQRuiluRXJtxaPOOs",
                "created": 1760982501,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "75",
            "experiment_id": "run_2",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 79,
                "id": "chatcmpl-CSsbdUWPuEulendLVoNgJkqAfXBZy",
                "created": 1760999125,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get at most 100 rows from ss_ztf where the nearest Solar System object name is known.\n-- Note: ssnamenr may contain the literal string 'null' when unknown, not SQL NULL, so exclude both.\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM ss_ztf\n    WHERE ssnamenr IS NOT NULL\n      AND ssnamenr <> 'null'\n    LIMIT 100\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get at most 100 rows from ss_ztf where the nearest Solar System object name is known.\n-- Note: ssnamenr may contain the literal string 'null' when unknown, not SQL NULL, so exclude both.\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM ss_ztf\n    WHERE ssnamenr IS NOT NULL\n      AND ssnamenr <> 'null'\n    LIMIT 100\n);"
                },
                "in_toks": 2039,
                "out_toks": 999,
                "id": "chatcmpl-CSt3yp7rl9TuIdxQSgLSLxZQJXvsW",
                "created": 1761000882,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "75",
            "experiment_id": "run_3",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 79,
                "id": "chatcmpl-CSsbgwjGX329imyGjBYAqbaVrlxMo",
                "created": 1760999128,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return up to 100 rows from ss_ztf where the nearest Solar System object name is present\n-- Filter out both SQL NULLs and the literal string 'null' noted in the schema comments\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND LOWER(ssnamenr) <> 'null'\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return up to 100 rows from ss_ztf where the nearest Solar System object name is present\n-- Filter out both SQL NULLs and the literal string 'null' noted in the schema comments\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND LOWER(ssnamenr) <> 'null'\nLIMIT 100;"
                },
                "in_toks": 2039,
                "out_toks": 722,
                "id": "chatcmpl-CSt4HCXwDNcAuiChJ3wlwE3J2TTkq",
                "created": 1761000901,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "75",
            "experiment_id": "run_4",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 79,
                "id": "chatcmpl-CSsbjzJtJJ2jdTU8NsR84NsHV41BW",
                "created": 1760999131,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return at most 100 rows with a known (non-null) nearest Solar System object name.\n-- Note: Some records may use the literal string 'null' to denote unknown; we exclude both SQL NULL and the string 'null'.\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return at most 100 rows with a known (non-null) nearest Solar System object name.\n-- Note: Some records may use the literal string 'null' to denote unknown; we exclude both SQL NULL and the string 'null'.\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;"
                },
                "in_toks": 2039,
                "out_toks": 534,
                "id": "chatcmpl-CSt4Rws3muLQNy720MaSY1ah8qBc6",
                "created": 1761000911,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "75",
            "experiment_id": "run_5",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 79,
                "id": "chatcmpl-CZMSroAlybp8tRV1DRSEQtB1DaSAc",
                "created": 1762543869,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return up to 100 rows with a known (non-null and not literal 'null') nearest Solar System object\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND lower(ssnamenr) <> 'null'\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return up to 100 rows with a known (non-null and not literal 'null') nearest Solar System object\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND lower(ssnamenr) <> 'null'\nLIMIT 100;"
                },
                "in_toks": 2039,
                "out_toks": 448,
                "id": "chatcmpl-CZRCi7DuuX2esr2JHJYK4bXFs0ROH",
                "created": 1762562088,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "75",
            "experiment_id": "run_6",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 143,
                "id": "chatcmpl-CZMSuhfXQuqxEa69hhWgIuKDAFQm4",
                "created": 1762543872,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return up to 100 rows with a known (non-null and not the literal 'null') nearest Solar System object name\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return up to 100 rows with a known (non-null and not the literal 'null') nearest Solar System object name\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;"
                },
                "in_toks": 2039,
                "out_toks": 512,
                "id": "chatcmpl-CZRCjuY1eckIlpUe4sKvb0hT0jAdp",
                "created": 1762562089,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "75",
            "experiment_id": "run_7",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 79,
                "id": "chatcmpl-CZMSyRg3FfbeWxfwdvLwP2ruzxHHz",
                "created": 1762543876,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return up to 100 rows where the nearest Solar System object name is present\n-- Excludes both actual NULLs and the literal string 'null' sometimes used in this column\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr NOT ILIKE 'null'\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return up to 100 rows where the nearest Solar System object name is present\n-- Excludes both actual NULLs and the literal string 'null' sometimes used in this column\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr NOT ILIKE 'null'\nLIMIT 100;"
                },
                "in_toks": 2039,
                "out_toks": 653,
                "id": "chatcmpl-CZRCjdyblbNmkyBpaMsFIJN3nfUra",
                "created": 1762562089,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "75",
            "experiment_id": "run_8",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 79,
                "id": "chatcmpl-CZMT02zcFTApIYg3iIA4md24kO6Te",
                "created": 1762543878,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get up to 100 rows with a known nearest Solar System object (exclude NULL and the literal 'null')\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND lower(ssnamenr) <> 'null'\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get up to 100 rows with a known nearest Solar System object (exclude NULL and the literal 'null')\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND lower(ssnamenr) <> 'null'\nLIMIT 100;"
                },
                "in_toks": 2039,
                "out_toks": 831,
                "id": "chatcmpl-CZRDChmu2xU3XtDCfSLOhAkCcCRL2",
                "created": 1762562118,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "75",
            "experiment_id": "run_9",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 608,
                "out_toks": 79,
                "id": "chatcmpl-CZMT4hcQSaB4grjyRVFFreag9ikcp",
                "created": 1762543882,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return at most 100 rows from ss_ztf where the nearest Solar System object is known\n-- Note: Some rows may store the unknown state as the literal string 'null', so exclude that as well.\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return at most 100 rows from ss_ztf where the nearest Solar System object is known\n-- Note: Some rows may store the unknown state as the literal string 'null', so exclude that as well.\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null'\nLIMIT 100;"
                },
                "in_toks": 2039,
                "out_toks": 914,
                "id": "chatcmpl-CZRDC5kB4DEXYHo8XGIPdyw95u2GJ",
                "created": 1762562118,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "43": {
        "0": {
            "req_id": "43",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 645,
                "out_toks": 1245,
                "id": "chatcmpl-CSnU2YDKqfTC2K9BrST7YIvROtgzj",
                "created": 1760979434,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- r-band epochs (fid=2) in dataquality for the specified ZTF objects\nWITH requested_oids(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n),\ntarget_oids AS (\n    -- prioritize obtaining OIDs via a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM requested_oids)\n)\nSELECT\n    dq.oid,          -- ZTF identifier\n    dq.candid,       -- candidate identifier\n    dq.xpos,         -- x-image position [pixels]\n    dq.ypos,         -- y-image position [pixels]\n    dq.scorr         -- peak-pixel S/N\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.fid = 2\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- r-band epochs (fid=2) in dataquality for the specified ZTF objects\nWITH requested_oids(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n),\ntarget_oids AS (\n    -- prioritize obtaining OIDs via a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM requested_oids)\n)\nSELECT\n    dq.oid,          -- ZTF identifier\n    dq.candid,       -- candidate identifier\n    dq.xpos,         -- x-image position [pixels]\n    dq.ypos,         -- y-image position [pixels]\n    dq.scorr         -- peak-pixel S/N\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.fid = 2\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 3193,
                "out_toks": 1229,
                "id": "chatcmpl-CSoHb9kLKQRcz6TuHMVItioYUwe1W",
                "created": 1760982507,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "43",
            "experiment_id": "run_1",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 645,
                "out_toks": 1245,
                "id": "chatcmpl-CSnU2YDKqfTC2K9BrST7YIvROtgzj",
                "created": 1760979434,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- r-band corresponds to fid = 2; return oid (ZTF id), candid (candidate id), x/y image positions, and peak-pixel S/N (scorr)\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM oids)\n  AND dq.fid = 2\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- r-band corresponds to fid = 2; return oid (ZTF id), candid (candidate id), x/y image positions, and peak-pixel S/N (scorr)\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM oids)\n  AND dq.fid = 2\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 2711,
                "out_toks": 973,
                "id": "chatcmpl-CSoHoB2xVf6Bzhk38H24KVBzvaFzP",
                "created": 1760982520,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "43",
            "experiment_id": "run_2",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 645,
                "out_toks": 589,
                "id": "chatcmpl-CSsblC71Z0IvUuebWU6vBmyv66dFA",
                "created": 1760999133,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all r-band (fid=2) epochs in dataquality for the specified ZTF objects\nWITH target_oids(oid) AS (\n    VALUES \n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT \n    dq.oid,          -- ZTF identifier\n    dq.candid,       -- candidate identifier\n    dq.xpos,         -- x-image position [pixels]\n    dq.ypos,         -- y-image position [pixels]\n    dq.scorr         -- peak-pixel signal-to-noise ratio\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM target_oids)\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all r-band (fid=2) epochs in dataquality for the specified ZTF objects\nWITH target_oids(oid) AS (\n    VALUES \n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT \n    dq.oid,          -- ZTF identifier\n    dq.candid,       -- candidate identifier\n    dq.xpos,         -- x-image position [pixels]\n    dq.ypos,         -- y-image position [pixels]\n    dq.scorr         -- peak-pixel signal-to-noise ratio\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM target_oids)\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 2711,
                "out_toks": 1060,
                "id": "chatcmpl-CSt4aaTL5NTYBgIKcwG7NTDY1SxJD",
                "created": 1761000920,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "43",
            "experiment_id": "run_3",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 645,
                "out_toks": 589,
                "id": "chatcmpl-CSsbtxqni2wWxavmMbFQ1XMTGDD3C",
                "created": 1760999141,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return r-band (fid=2) epochs in dataquality for the specified ZTF objects\n-- Columns: object (oid), candidate id (candid), x/y image positions (xpos, ypos), peak-pixel S/N (scorr)\nWITH targets (oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nWHERE dq.fid = 2  -- r-band\n  AND dq.oid IN (SELECT oid FROM targets)\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return r-band (fid=2) epochs in dataquality for the specified ZTF objects\n-- Columns: object (oid), candidate id (candid), x/y image positions (xpos, ypos), peak-pixel S/N (scorr)\nWITH targets (oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nWHERE dq.fid = 2  -- r-band\n  AND dq.oid IN (SELECT oid FROM targets)\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 2711,
                "out_toks": 1118,
                "id": "chatcmpl-CSsxoBCodz2YZyNUiJ0DXx6j5BXOz",
                "created": 1761000500,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "43",
            "experiment_id": "run_4",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 645,
                "out_toks": 589,
                "id": "chatcmpl-CSsc0kHioIGamdoAwkoaHwebAFR0H",
                "created": 1760999148,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all r-band (fid=2) epochs in dataquality for the specified ZTF objects\nWITH target_oids (oid) AS (\n  VALUES\n    ('ZTF20acwrybw'),\n    ('ZTF22abugigx')\n)\nSELECT\n  dq.oid,        -- ZTF identifier\n  dq.candid,     -- candidate identifier\n  dq.xpos,       -- x-image position [pixels]\n  dq.ypos,       -- y-image position [pixels]\n  dq.scorr       -- peak-pixel S/N in matched-filtered image\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM target_oids)\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all r-band (fid=2) epochs in dataquality for the specified ZTF objects\nWITH target_oids (oid) AS (\n  VALUES\n    ('ZTF20acwrybw'),\n    ('ZTF22abugigx')\n)\nSELECT\n  dq.oid,        -- ZTF identifier\n  dq.candid,     -- candidate identifier\n  dq.xpos,       -- x-image position [pixels]\n  dq.ypos,       -- y-image position [pixels]\n  dq.scorr       -- peak-pixel S/N in matched-filtered image\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM target_oids)\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 2711,
                "out_toks": 806,
                "id": "chatcmpl-CSsy6cFQ527ZNaVqmGKOWpsVO1naE",
                "created": 1761000518,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "43",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 645,
                "out_toks": 848,
                "id": "chatcmpl-CZMT8DV4untMsIoYsHnIkjpz7Cxr4",
                "created": 1762543886,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- r-band (fid=2) epochs in dataquality for the specified ZTF objects\nWITH targets(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,      -- ZTF identifier\n    dq.candid,   -- candidate identifier\n    dq.xpos,     -- x-image position [pixels]\n    dq.ypos,     -- y-image position [pixels]\n    dq.scorr     -- peak-pixel signal-to-noise ratio\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM targets)\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- r-band (fid=2) epochs in dataquality for the specified ZTF objects\nWITH targets(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,      -- ZTF identifier\n    dq.candid,   -- candidate identifier\n    dq.xpos,     -- x-image position [pixels]\n    dq.ypos,     -- y-image position [pixels]\n    dq.scorr     -- peak-pixel signal-to-noise ratio\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM targets)\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 3193,
                "out_toks": 1054,
                "id": "chatcmpl-CZRDHVw6h7XTZsWyu9paqxYl12wjM",
                "created": 1762562123,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "43",
            "experiment_id": "run_6",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 645,
                "out_toks": 269,
                "id": "chatcmpl-CZMTPmtersaao1osbrnu3aruZ2bRu",
                "created": 1762543903,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- r-band epochs for two specified ZTF objects from dataquality\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,       -- ZTF identifier\n    dq.candid,    -- candidate identifier\n    dq.xpos,      -- x-image position [pixels]\n    dq.ypos,      -- y-image position [pixels]\n    dq.scorr      -- peak-pixel S/N in matched-filtered detection image\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.fid = 2  -- r-band\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- r-band epochs for two specified ZTF objects from dataquality\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,       -- ZTF identifier\n    dq.candid,    -- candidate identifier\n    dq.xpos,      -- x-image position [pixels]\n    dq.ypos,      -- y-image position [pixels]\n    dq.scorr      -- peak-pixel S/N in matched-filtered detection image\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.fid = 2  -- r-band\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 2711,
                "out_toks": 932,
                "id": "chatcmpl-CZRDQaAbM2hRh1G3q3ky54IGHbsny",
                "created": 1762562132,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "43",
            "experiment_id": "run_7",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 645,
                "out_toks": 717,
                "id": "chatcmpl-CZMTXjRTjkaDTfZQ32JnZy0RE6paC",
                "created": 1762543911,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- r-band corresponds to fid = 2; return object (oid), candidate (candid), image positions, and peak-pixel S/N\nSELECT\n  oid,\n  candid,\n  xpos,\n  ypos,\n  scorr\nFROM dataquality\nWHERE fid = 2\n  AND oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\nORDER BY oid, candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- r-band corresponds to fid = 2; return object (oid), candidate (candid), image positions, and peak-pixel S/N\nSELECT\n  oid,\n  candid,\n  xpos,\n  ypos,\n  scorr\nFROM dataquality\nWHERE fid = 2\n  AND oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\nORDER BY oid, candid;"
                },
                "in_toks": 2711,
                "out_toks": 543,
                "id": "chatcmpl-CZRDypvV5A5DajZSb0Poy4b3jaO0l",
                "created": 1762562166,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "43",
            "experiment_id": "run_8",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 645,
                "out_toks": 397,
                "id": "chatcmpl-CZMTmlKSU1nQfyeVEElbBV9MarHwb",
                "created": 1762543926,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find r-band (fid=2) epochs in dataquality for two specified ZTF objects\nWITH targets(oid) AS (\n    VALUES \n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,          -- ZTF identifier\n    dq.candid,       -- candidate identifier\n    dq.xpos,         -- x-image position [pixels]\n    dq.ypos,         -- y-image position [pixels]\n    dq.scorr         -- peak-pixel S/N\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM targets)\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find r-band (fid=2) epochs in dataquality for two specified ZTF objects\nWITH targets(oid) AS (\n    VALUES \n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT\n    dq.oid,          -- ZTF identifier\n    dq.candid,       -- candidate identifier\n    dq.xpos,         -- x-image position [pixels]\n    dq.ypos,         -- y-image position [pixels]\n    dq.scorr         -- peak-pixel S/N\nFROM dataquality dq\nWHERE dq.fid = 2\n  AND dq.oid IN (SELECT oid FROM targets)\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 2711,
                "out_toks": 796,
                "id": "chatcmpl-CZRE1yh0MWLm0ZvKBLrI7JgXqQ3vE",
                "created": 1762562169,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "43",
            "experiment_id": "run_9",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 645,
                "out_toks": 461,
                "id": "chatcmpl-CZMTuxXtTAfjRWD7KwQckhk8lpBXY",
                "created": 1762543934,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- r-band epochs for specified ZTF objects from dataquality\n-- fid = 2 corresponds to r-band; scorr is the peak-pixel signal-to-noise ratio\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF20acwrybw'),\n    ('ZTF22abugigx')\n)\nSELECT\n  dq.oid,        -- ZTF identifier\n  dq.candid,     -- candidate identifier (epoch)\n  dq.xpos,       -- x-image position [pixels]\n  dq.ypos,       -- y-image position [pixels]\n  dq.scorr       -- peak-pixel S/N\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.fid = 2\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- r-band epochs for specified ZTF objects from dataquality\n-- fid = 2 corresponds to r-band; scorr is the peak-pixel signal-to-noise ratio\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF20acwrybw'),\n    ('ZTF22abugigx')\n)\nSELECT\n  dq.oid,        -- ZTF identifier\n  dq.candid,     -- candidate identifier (epoch)\n  dq.xpos,       -- x-image position [pixels]\n  dq.ypos,       -- y-image position [pixels]\n  dq.scorr       -- peak-pixel S/N\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.fid = 2\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 2711,
                "out_toks": 946,
                "id": "chatcmpl-CZREAUKRYnIBUz3aMZJtHGBdIsFlE",
                "created": 1762562178,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "89": {
        "0": {
            "req_id": "89",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'dataquality']",
                    "1": "['probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 624,
                "out_toks": 1384,
                "id": "chatcmpl-CSnUGTdg660K3arQq3RdKhQyan2uo",
                "created": 1760979448,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Return all dataquality rows for up to 50 ZTF objects with stamp classifier SN probability > 0.7 */ /* Optimize by filtering probability with selective conditions and using ranking = 1 */ WITH top_oids AS\n  (SELECT oid\n   FROM\n     (SELECT DISTINCT ON (p.oid) p.oid,\n                         p.probability\n      FROM probability p\n      WHERE p.classifier_name = 'stamp_classifier' -- classifier filter\n\n        AND p.class_name = 'SN' -- class filter\n\n        AND p.ranking = 1 -- take top-ranked class per classifier/version\n\n        AND p.probability > 0.7 -- probability threshold\n\n        AND p.oid LIKE 'ZTF%' -- restrict to ZTF objects\n\n      ORDER BY p.oid,\n               p.probability DESC -- keep highest prob per oid\n) s\n   ORDER BY s.probability DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN top_oids t ON t.oid = dq.oid;",
            "sql_response": {
                "responses": {
                    "0": "/* Return all dataquality rows for up to 50 ZTF objects with stamp classifier SN probability > 0.7 */ /* Optimize by filtering probability with selective conditions and using ranking = 1 */ WITH top_oids AS\n  (SELECT oid\n   FROM\n     (SELECT DISTINCT ON (p.oid) p.oid,\n                         p.probability\n      FROM probability p\n      WHERE p.classifier_name = 'stamp_classifier' -- classifier filter\n\n        AND p.class_name = 'SN' -- class filter\n\n        AND p.ranking = 1 -- take top-ranked class per classifier/version\n\n        AND p.probability > 0.7 -- probability threshold\n\n        AND p.oid LIKE 'ZTF%' -- restrict to ZTF objects\n\n      ORDER BY p.oid,\n               p.probability DESC -- keep highest prob per oid\n) s\n   ORDER BY s.probability DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN top_oids t ON t.oid = dq.oid;"
                },
                "in_toks": 1952,
                "out_toks": 2279,
                "id": "chatcmpl-Cb9gfhBcv5oaGC9BFEd2J7nl5M2ni",
                "created": 1762971409,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 50 objects (OIDs) with stamp classifier probability > 0.7 for class 'SN' */\nWITH oid_candidates AS (\n    SELECT DISTINCT ON (p.oid)\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.7\n    /* pick the highest probability per OID */\n    ORDER BY p.oid, p.probability DESC\n),\nselected_oids AS (\n    /* choose the top 50 OIDs by their highest probability */\n    SELECT oc.oid\n    FROM oid_candidates oc\n    ORDER BY oc.probability DESC\n    LIMIT 50\n)\nSELECT\n    dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_oids)\nORDER BY dq.oid, dq.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 50 objects (OIDs) with stamp classifier probability > 0.7 for class 'SN' */\nWITH oid_candidates AS (\n    SELECT DISTINCT ON (p.oid)\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.7\n    /* pick the highest probability per OID */\n    ORDER BY p.oid, p.probability DESC\n),\nselected_oids AS (\n    /* choose the top 50 OIDs by their highest probability */\n    SELECT oc.oid\n    FROM oid_candidates oc\n    ORDER BY oc.probability DESC\n    LIMIT 50\n)\nSELECT\n    dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_oids)\nORDER BY dq.oid, dq.candid;"
                },
                "in_toks": 2919,
                "out_toks": 2249,
                "id": "chatcmpl-CSoHyuBfVvElUab9hKVSMmMCSIQhR",
                "created": 1760982530,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "89",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'dataquality']",
                    "1": "['probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 624,
                "out_toks": 1384,
                "id": "chatcmpl-CSnUGTdg660K3arQq3RdKhQyan2uo",
                "created": 1760979448,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Select up to 50 ZTF oids with highest SN probability (>0.7) from the stamp classifier,\n   ensuring SN is the top-ranked class (ranking=1), then return all dataquality rows for them */ WITH top_oids AS\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n     AND p.oid LIKE 'ZTF%'\n   ORDER BY p.oid,\n            p.probability DESC),\n                                                                                                      selected_oids AS\n  (SELECT oid\n   FROM top_oids\n   ORDER BY probability DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN selected_oids so ON so.oid = dq.oid;",
            "sql_response": {
                "responses": {
                    "0": "/* Select up to 50 ZTF oids with highest SN probability (>0.7) from the stamp classifier,\n   ensuring SN is the top-ranked class (ranking=1), then return all dataquality rows for them */ WITH top_oids AS\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n     AND p.oid LIKE 'ZTF%'\n   ORDER BY p.oid,\n            p.probability DESC),\n                                                                                                      selected_oids AS\n  (SELECT oid\n   FROM top_oids\n   ORDER BY probability DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN selected_oids so ON so.oid = dq.oid;"
                },
                "in_toks": 1795,
                "out_toks": 1543,
                "id": "chatcmpl-Cb9hSzGOkXoGKgSbXIC9aYFZ4yQui",
                "created": 1762971458,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 50 distinct OIDs whose stamp classifier assigns SN probability > 0.7,\n   then return all dataquality rows for those OIDs */\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT oid, MAX(probability) AS max_prob\n        FROM probability\n        WHERE classifier_name = 'stamp_classifier'\n          AND class_name = 'SN'\n          AND probability > 0.7\n        GROUP BY oid\n    ) t\n    ORDER BY max_prob DESC\n    LIMIT 50\n);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 50 distinct OIDs whose stamp classifier assigns SN probability > 0.7,\n   then return all dataquality rows for those OIDs */\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT oid, MAX(probability) AS max_prob\n        FROM probability\n        WHERE classifier_name = 'stamp_classifier'\n          AND class_name = 'SN'\n          AND probability > 0.7\n        GROUP BY oid\n    ) t\n    ORDER BY max_prob DESC\n    LIMIT 50\n);"
                },
                "in_toks": 2919,
                "out_toks": 1212,
                "id": "chatcmpl-CSoIK4swuGdVotp9jDRnXaJPV5MOb",
                "created": 1760982552,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "89",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'dataquality']"
                },
                "in_toks": 624,
                "out_toks": 1489,
                "id": "chatcmpl-CSsc7SJ0VlpjwJbojH0xICmCPFvh9",
                "created": 1760999155,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return all dataquality rows for up to 50 objects with P(SN | stamp_classifier) > 0.7.\n-- Optimize by first selecting the top 50 OIDs (using ranking=1 and max probability across versions),\n-- then joining to dataquality.\nWITH top_sn_oids AS\n  (SELECT oid\n   FROM\n     (SELECT oid,\n             MAX(probability) AS max_prob\n      FROM probability\n      WHERE classifier_name = 'stamp_classifier' -- classifier condition\n\n        AND class_name = 'SN' -- class condition\n\n        AND ranking = 1 -- take top-ranked class per version\n\n        AND probability > 0.7 -- probability threshold\n\n      GROUP BY oid) s\n   ORDER BY max_prob DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality AS dq\nJOIN top_sn_oids AS t ON t.oid = dq.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Return all dataquality rows for up to 50 objects with P(SN | stamp_classifier) > 0.7.\n-- Optimize by first selecting the top 50 OIDs (using ranking=1 and max probability across versions),\n-- then joining to dataquality.\nWITH top_sn_oids AS\n  (SELECT oid\n   FROM\n     (SELECT oid,\n             MAX(probability) AS max_prob\n      FROM probability\n      WHERE classifier_name = 'stamp_classifier' -- classifier condition\n\n        AND class_name = 'SN' -- class condition\n\n        AND ranking = 1 -- take top-ranked class per version\n\n        AND probability > 0.7 -- probability threshold\n\n      GROUP BY oid) s\n   ORDER BY max_prob DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality AS dq\nJOIN top_sn_oids AS t ON t.oid = dq.oid;"
                },
                "in_toks": 1732,
                "out_toks": 1988,
                "id": "chatcmpl-Cb9hvVs7Cg1jKnNovjpuniNR2sPhS",
                "created": 1762971487,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 50 OIDs with P(SN | stamp_classifier) > 0.7 (highest probability per OID across versions),\n-- then return all dataquality rows for those objects.\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n    GROUP BY oid\n    ORDER BY MAX(probability) DESC\n    LIMIT 50\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 50 OIDs with P(SN | stamp_classifier) > 0.7 (highest probability per OID across versions),\n-- then return all dataquality rows for those objects.\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n    GROUP BY oid\n    ORDER BY MAX(probability) DESC\n    LIMIT 50\n);"
                },
                "in_toks": 2874,
                "out_toks": 1650,
                "id": "chatcmpl-CSsyGdMyD63E9QbsmuFTxhycYD8hU",
                "created": 1761000528,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "89",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 624,
                "out_toks": 788,
                "id": "chatcmpl-CSscTVnpIvyQG6MuYNsUAbJJv8cBH",
                "created": 1760999177,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return all dataquality rows for up to 50 ZTF objects classified as SN by the stamp classifier with probability > 0.7 and top-ranked (ranking=1)\n\nSELECT dq.*\nFROM dataquality AS dq\nJOIN\n  (SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier' -- use stamp classifier\n\n     AND class_name = 'SN' -- supernova class\n\n     AND ranking = 1 -- top-ranked class per object\n\n     AND probability > 0.7 -- probability threshold\n\n     AND oid LIKE 'ZTF%' -- only ZTF objects\n\n   LIMIT 50 -- at most 50 objects\n) AS t USING (oid);",
            "sql_response": {
                "responses": {
                    "0": "-- Return all dataquality rows for up to 50 ZTF objects classified as SN by the stamp classifier with probability > 0.7 and top-ranked (ranking=1)\n\nSELECT dq.*\nFROM dataquality AS dq\nJOIN\n  (SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier' -- use stamp classifier\n\n     AND class_name = 'SN' -- supernova class\n\n     AND ranking = 1 -- top-ranked class per object\n\n     AND probability > 0.7 -- probability threshold\n\n     AND oid LIKE 'ZTF%' -- only ZTF objects\n\n   LIMIT 50 -- at most 50 objects\n) AS t USING (oid);"
                },
                "in_toks": 1761,
                "out_toks": 3867,
                "id": "chatcmpl-Cb9j4Izzq9wfo8z8dHccB947G3mj2",
                "created": 1762971558,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all dataquality rows for up to 50 objects classified as Supernova (SN) by the stamp classifier with probability > 0.7\nWITH target_oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n    LIMIT 50\n)\nSELECT *\nFROM dataquality\nWHERE oid IN (SELECT oid FROM target_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all dataquality rows for up to 50 objects classified as Supernova (SN) by the stamp classifier with probability > 0.7\nWITH target_oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n    LIMIT 50\n)\nSELECT *\nFROM dataquality\nWHERE oid IN (SELECT oid FROM target_oids);"
                },
                "in_toks": 2919,
                "out_toks": 1832,
                "id": "chatcmpl-CSsyghHOaQ9PvneLNWvFvpurSD4W3",
                "created": 1761000554,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "89",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'dataquality']"
                },
                "in_toks": 624,
                "out_toks": 593,
                "id": "chatcmpl-CSscdBT90CblVDRPuVOgRcWIB5bQQ",
                "created": 1760999187,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return all dataquality rows for up to 50 ZTF objects whose best (ranking=1)\n-- stamp classifier probability for class 'SN' is > 0.7.\n-- Optimization:\n-- 1) Filter probability early with selective predicates (classifier_name, class_name, ranking, probability).\n-- 2) Use DISTINCT ON to pick the highest-probability version per oid without a full GROUP BY.\n-- 3) Limit to 50 oids before joining to dataquality.\n WITH top_oids AS\n  (SELECT oid\n   FROM\n     (SELECT DISTINCT ON (p.oid) p.oid,\n                         p.probability\n      FROM probability p\n      WHERE p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n      ORDER BY p.oid,\n               p.probability DESC) per_oid_best\n   ORDER BY probability DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN top_oids t ON t.oid = dq.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Return all dataquality rows for up to 50 ZTF objects whose best (ranking=1)\n-- stamp classifier probability for class 'SN' is > 0.7.\n-- Optimization:\n-- 1) Filter probability early with selective predicates (classifier_name, class_name, ranking, probability).\n-- 2) Use DISTINCT ON to pick the highest-probability version per oid without a full GROUP BY.\n-- 3) Limit to 50 oids before joining to dataquality.\n WITH top_oids AS\n  (SELECT oid\n   FROM\n     (SELECT DISTINCT ON (p.oid) p.oid,\n                         p.probability\n      FROM probability p\n      WHERE p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n      ORDER BY p.oid,\n               p.probability DESC) per_oid_best\n   ORDER BY probability DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN top_oids t ON t.oid = dq.oid;"
                },
                "in_toks": 1784,
                "out_toks": 1840,
                "id": "chatcmpl-Cb9kFrU1WfN8NNsBZMQzSNHM7GhpK",
                "created": 1762971631,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find at most 50 objects with SN probability > 0.7 in the stamp classifier,\n-- then return all columns from dataquality for those objects.\nSELECT *\nFROM dataquality dq\nWHERE dq.oid IN (\n    SELECT s.oid\n    FROM (\n        SELECT p.oid, MAX(p.probability) AS max_prob\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'SN'\n        GROUP BY p.oid\n    ) s\n    WHERE s.max_prob > 0.7\n    ORDER BY s.max_prob DESC\n    LIMIT 50\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find at most 50 objects with SN probability > 0.7 in the stamp classifier,\n-- then return all columns from dataquality for those objects.\nSELECT *\nFROM dataquality dq\nWHERE dq.oid IN (\n    SELECT s.oid\n    FROM (\n        SELECT p.oid, MAX(p.probability) AS max_prob\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'SN'\n        GROUP BY p.oid\n    ) s\n    WHERE s.max_prob > 0.7\n    ORDER BY s.max_prob DESC\n    LIMIT 50\n);"
                },
                "in_toks": 2874,
                "out_toks": 1804,
                "id": "chatcmpl-CSsz4GlnQvVe9a02izZmCUC9bncnK",
                "created": 1761000578,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "89",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'dataquality']"
                },
                "in_toks": 624,
                "out_toks": 593,
                "id": "chatcmpl-CZMUBV6DZXn5YKf8VyFamCNklnvyS",
                "created": 1762543951,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Get up to 50 distinct objects with stamp-classifier SN probability > 0.7 (use ranking=1 for performance)\nWITH sn_oids AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n   LIMIT 50) -- Return all dataquality rows for those objects\n\nSELECT dq.*\nFROM dataquality dq\nJOIN sn_oids s ON s.oid = dq.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Get up to 50 distinct objects with stamp-classifier SN probability > 0.7 (use ranking=1 for performance)\nWITH sn_oids AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n   LIMIT 50) -- Return all dataquality rows for those objects\n\nSELECT dq.*\nFROM dataquality dq\nJOIN sn_oids s ON s.oid = dq.oid;"
                },
                "in_toks": 1850,
                "out_toks": 1541,
                "id": "chatcmpl-Cb9ksB4JXcTwQ95OJiYvYev00JXKR",
                "created": 1762971670,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all dataquality rows for up to 50 objects with stamp-classifier SN probability > 0.7\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (\n    -- Pick at most 50 distinct OIDs with highest SN probabilities (stamp_classifier)\n    SELECT t.oid\n    FROM (\n        SELECT p.oid, MAX(p.probability) AS max_prob\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'  -- use Stamp Classifier as requested\n          AND p.class_name = 'SN'                      -- 'SN' corresponds to supernovae in stamp_classifier\n          AND p.probability > 0.7\n        GROUP BY p.oid\n        ORDER BY max_prob DESC\n        LIMIT 50\n    ) AS t\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all dataquality rows for up to 50 objects with stamp-classifier SN probability > 0.7\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (\n    -- Pick at most 50 distinct OIDs with highest SN probabilities (stamp_classifier)\n    SELECT t.oid\n    FROM (\n        SELECT p.oid, MAX(p.probability) AS max_prob\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'  -- use Stamp Classifier as requested\n          AND p.class_name = 'SN'                      -- 'SN' corresponds to supernovae in stamp_classifier\n          AND p.probability > 0.7\n        GROUP BY p.oid\n        ORDER BY max_prob DESC\n        LIMIT 50\n    ) AS t\n);"
                },
                "in_toks": 2874,
                "out_toks": 1903,
                "id": "chatcmpl-CZREL7kwgQb4GCZQWxeu2zK1TtorT",
                "created": 1762562189,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "89",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'dataquality']"
                },
                "in_toks": 624,
                "out_toks": 721,
                "id": "chatcmpl-CZMUQxuYLeL3WEunQM79yDYv4YnTH",
                "created": 1762543966,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return all dataquality rows for up to 50 ZTF objects with SN probability > 0.7 from the stamp classifier\n-- Optimizations:\n--  - Filter probability with selective predicates (classifier, class, ranking=1, prob>0.7, ZTF prefix)\n--  - DISTINCT ON to keep the highest-probability row per oid (handles multiple classifier versions)\n--  - Limit to 50 oids before joining to dataquality\nWITH sn_candidates AS\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- required classifier\n\n     AND p.class_name = 'SN' -- supernovae\n\n     AND p.ranking = 1 -- top-ranked class per object\n\n     AND p.probability > 0.7 -- probability threshold\n\n     AND p.oid LIKE 'ZTF%' -- only ZTF objects\n\n   ORDER BY p.oid,\n            p.probability DESC -- keep highest prob per oid\n),\n     top_oids AS\n  (SELECT oid\n   FROM sn_candidates\n   ORDER BY probability DESC\n   LIMIT 50 -- at most 50 objects\n)\nSELECT dq.*\nFROM dataquality dq\nJOIN top_oids t ON t.oid = dq.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Return all dataquality rows for up to 50 ZTF objects with SN probability > 0.7 from the stamp classifier\n-- Optimizations:\n--  - Filter probability with selective predicates (classifier, class, ranking=1, prob>0.7, ZTF prefix)\n--  - DISTINCT ON to keep the highest-probability row per oid (handles multiple classifier versions)\n--  - Limit to 50 oids before joining to dataquality\nWITH sn_candidates AS\n  (SELECT DISTINCT ON (p.oid) p.oid,\n                      p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- required classifier\n\n     AND p.class_name = 'SN' -- supernovae\n\n     AND p.ranking = 1 -- top-ranked class per object\n\n     AND p.probability > 0.7 -- probability threshold\n\n     AND p.oid LIKE 'ZTF%' -- only ZTF objects\n\n   ORDER BY p.oid,\n            p.probability DESC -- keep highest prob per oid\n),\n     top_oids AS\n  (SELECT oid\n   FROM sn_candidates\n   ORDER BY probability DESC\n   LIMIT 50 -- at most 50 objects\n)\nSELECT dq.*\nFROM dataquality dq\nJOIN top_oids t ON t.oid = dq.oid;"
                },
                "in_toks": 1772,
                "out_toks": 2145,
                "id": "chatcmpl-Cb9lRaPeyptolNvrf7wIvXhX5pvm4",
                "created": 1762971705,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all dataquality rows for up to 50 objects whose stamp classifier assigns SN probability > 0.7\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    -- Subquery: obtain up to 50 OIDs with highest SN probability from the stamp classifier\n    SELECT oid\n    FROM (\n        SELECT oid, MAX(probability) AS max_p\n        FROM probability\n        WHERE classifier_name = 'stamp_classifier'\n          AND class_name = 'SN'\n          AND probability > 0.7\n        GROUP BY oid\n    ) t\n    ORDER BY max_p DESC\n    LIMIT 50\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all dataquality rows for up to 50 objects whose stamp classifier assigns SN probability > 0.7\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    -- Subquery: obtain up to 50 OIDs with highest SN probability from the stamp classifier\n    SELECT oid\n    FROM (\n        SELECT oid, MAX(probability) AS max_p\n        FROM probability\n        WHERE classifier_name = 'stamp_classifier'\n          AND class_name = 'SN'\n          AND probability > 0.7\n        GROUP BY oid\n    ) t\n    ORDER BY max_p DESC\n    LIMIT 50\n);"
                },
                "in_toks": 2874,
                "out_toks": 1799,
                "id": "chatcmpl-CZRES29xDWuwCnlQZl1iXocyDlZrG",
                "created": 1762562196,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "89",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability",
                "dataquality",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'dataquality', 'taxonomy']"
                },
                "in_toks": 624,
                "out_toks": 916,
                "id": "chatcmpl-CZMUiIJdefpqEwLfizcpy6HBvn0vW",
                "created": 1762543984,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return all columns from dataquality for up to 50 ZTF objects with P(SN | stamp_classifier) > 0.7 (ranking=1)\nWITH p_filtered AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability AS p\n   WHERE p.classifier_name = 'stamp_classifier' -- classifier condition\n\n     AND p.class_name = 'SN' -- class condition\n\n     AND p.ranking = 1 -- top-ranked class\n\n     AND p.probability > 0.7 -- probability threshold\n\n     AND p.oid LIKE 'ZTF%' -- restrict to ZTF objects\n),\n     top_oids AS\n  (SELECT s.oid\n   FROM\n     (SELECT oid,\n             MAX(probability) AS max_prob\n      FROM p_filtered\n      GROUP BY oid) AS s\n   ORDER BY s.max_prob DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality AS dq\nJOIN top_oids AS t ON t.oid = dq.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Return all columns from dataquality for up to 50 ZTF objects with P(SN | stamp_classifier) > 0.7 (ranking=1)\nWITH p_filtered AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability AS p\n   WHERE p.classifier_name = 'stamp_classifier' -- classifier condition\n\n     AND p.class_name = 'SN' -- class condition\n\n     AND p.ranking = 1 -- top-ranked class\n\n     AND p.probability > 0.7 -- probability threshold\n\n     AND p.oid LIKE 'ZTF%' -- restrict to ZTF objects\n),\n     top_oids AS\n  (SELECT s.oid\n   FROM\n     (SELECT oid,\n             MAX(probability) AS max_prob\n      FROM p_filtered\n      GROUP BY oid) AS s\n   ORDER BY s.max_prob DESC\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality AS dq\nJOIN top_oids AS t ON t.oid = dq.oid;"
                },
                "in_toks": 1869,
                "out_toks": 3038,
                "id": "chatcmpl-Cb9m0g2YRcMceumWtv41pBwqF0ULe",
                "created": 1762971740,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return all columns from dataquality for up to 50 objects with P(SN | stamp_classifier) > 0.7 */\nSELECT dq.*\nFROM dataquality AS dq\nWHERE dq.oid IN (\n    /* Get at most 50 distinct OIDs meeting the probability criterion (highest max probability first) */\n    SELECT t.oid\n    FROM (\n        SELECT p.oid, MAX(p.probability) AS max_prob\n        FROM probability AS p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'SN'\n          AND p.probability > 0.7\n        GROUP BY p.oid\n        ORDER BY max_prob DESC\n        LIMIT 50\n    ) AS t\n);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return all columns from dataquality for up to 50 objects with P(SN | stamp_classifier) > 0.7 */\nSELECT dq.*\nFROM dataquality AS dq\nWHERE dq.oid IN (\n    /* Get at most 50 distinct OIDs meeting the probability criterion (highest max probability first) */\n    SELECT t.oid\n    FROM (\n        SELECT p.oid, MAX(p.probability) AS max_prob\n        FROM probability AS p\n        WHERE p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'SN'\n          AND p.probability > 0.7\n        GROUP BY p.oid\n        ORDER BY max_prob DESC\n        LIMIT 50\n    ) AS t\n);"
                },
                "in_toks": 2919,
                "out_toks": 2785,
                "id": "chatcmpl-CZREjrTEVlaDdXtNxVvFQx848e3MG",
                "created": 1762562213,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "89",
            "experiment_id": "run_8",
            "pred_tables": [
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'dataquality']"
                },
                "in_toks": 624,
                "out_toks": 977,
                "id": "chatcmpl-CZMUyj53oRPe38OsjPwwTu9xAO42O",
                "created": 1762544000,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return all dataquality rows for up to 50 objects whose stamp classifier assigns SN probability > 0.7\n-- Optimizations:\n--  - Apply selective filters on probability (including ranking=1) to reduce scanned rows.\n--  - Use DISTINCT + LIMIT without ORDER BY to avoid expensive sorts/aggregations.\n--  - Join the small CTE set of OIDs to dataquality for efficient filtering.\nWITH OIDS AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN OIDS o USING (oid);",
            "sql_response": {
                "responses": {
                    "0": "-- Return all dataquality rows for up to 50 objects whose stamp classifier assigns SN probability > 0.7\n-- Optimizations:\n--  - Apply selective filters on probability (including ranking=1) to reduce scanned rows.\n--  - Use DISTINCT + LIMIT without ORDER BY to avoid expensive sorts/aggregations.\n--  - Join the small CTE set of OIDs to dataquality for efficient filtering.\nWITH OIDS AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.ranking = 1\n     AND p.probability > 0.7\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN OIDS o USING (oid);"
                },
                "in_toks": 1728,
                "out_toks": 1325,
                "id": "chatcmpl-Cb9mjf9Lc1ldfE3BMTwPyHARAGPG5",
                "created": 1762971785,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all dataquality rows for up to 50 objects whose stamp classifier assigns SN probability > 0.7\nWITH top_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n    GROUP BY oid\n    ORDER BY MAX(probability) DESC\n    LIMIT 50\n)\nSELECT *\nFROM dataquality\nWHERE oid IN (SELECT oid FROM top_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all dataquality rows for up to 50 objects whose stamp classifier assigns SN probability > 0.7\nWITH top_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n    GROUP BY oid\n    ORDER BY MAX(probability) DESC\n    LIMIT 50\n)\nSELECT *\nFROM dataquality\nWHERE oid IN (SELECT oid FROM top_oids);"
                },
                "in_toks": 2874,
                "out_toks": 1774,
                "id": "chatcmpl-CZRAO27vEhpONhRMLOwTE3HXkRMzq",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "89",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 624,
                "out_toks": 724,
                "id": "chatcmpl-CZMVJk24s0psuVbES98X6cOY5ctfE",
                "created": 1762544021,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Return all dataquality rows for up to 50 ZTF objects whose stamp classifier (ranking=1) assigns SN class with probability > 0.7.\n   Use grouping and no global sort to avoid timeouts. */ WITH top_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- required classifier\n\n     AND p.class_name = 'SN' -- supernova class\n\n     AND p.ranking = 1 -- top-ranked class\n\n     AND p.probability > 0.7 -- probability threshold\n\n     AND p.oid LIKE 'ZTF%' -- restrict to ZTF objects\n\n   GROUP BY p.oid\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN top_oids t ON t.oid = dq.oid;",
            "sql_response": {
                "responses": {
                    "0": "/* Return all dataquality rows for up to 50 ZTF objects whose stamp classifier (ranking=1) assigns SN class with probability > 0.7.\n   Use grouping and no global sort to avoid timeouts. */ WITH top_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier' -- required classifier\n\n     AND p.class_name = 'SN' -- supernova class\n\n     AND p.ranking = 1 -- top-ranked class\n\n     AND p.probability > 0.7 -- probability threshold\n\n     AND p.oid LIKE 'ZTF%' -- restrict to ZTF objects\n\n   GROUP BY p.oid\n   LIMIT 50)\nSELECT dq.*\nFROM dataquality dq\nJOIN top_oids t ON t.oid = dq.oid;"
                },
                "in_toks": 1889,
                "out_toks": 3259,
                "id": "chatcmpl-Cb9nP1jxsM1qo8gQ40qSP9Me3hsFt",
                "created": 1762971827,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 50 distinct objects (OIDs) whose stamp classifier assigns SN class with probability > 0.7.\n   If multiple classifier versions exist per object, keep the highest probability per OID.\n   Then return all rows from dataquality for those OIDs (may include many detections per object). */\nWITH top_oids AS (\n    SELECT oid\n    FROM (\n        SELECT oid, MAX(probability) AS max_prob\n        FROM probability\n        WHERE classifier_name = 'stamp_classifier'\n          AND class_name = 'SN'\n          AND probability > 0.7\n        GROUP BY oid\n    ) p\n    ORDER BY max_prob DESC\n    LIMIT 50\n)\nSELECT *\nFROM dataquality\nWHERE oid IN (SELECT oid FROM top_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 50 distinct objects (OIDs) whose stamp classifier assigns SN class with probability > 0.7.\n   If multiple classifier versions exist per object, keep the highest probability per OID.\n   Then return all rows from dataquality for those OIDs (may include many detections per object). */\nWITH top_oids AS (\n    SELECT oid\n    FROM (\n        SELECT oid, MAX(probability) AS max_prob\n        FROM probability\n        WHERE classifier_name = 'stamp_classifier'\n          AND class_name = 'SN'\n          AND probability > 0.7\n        GROUP BY oid\n    ) p\n    ORDER BY max_prob DESC\n    LIMIT 50\n)\nSELECT *\nFROM dataquality\nWHERE oid IN (SELECT oid FROM top_oids);"
                },
                "in_toks": 2919,
                "out_toks": 2089,
                "id": "chatcmpl-CZRAOqMxkUi1DdGS61kUv7a5GpVAj",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        }
    },
    "72": {
        "0": {
            "req_id": "72",
            "experiment_id": "run_0",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['information_schema.tables']",
                    "1": "['reference']"
                },
                "in_toks": 613,
                "out_toks": 2714,
                "id": "chatcmpl-CSnUTHpAHQ3XNm5fM93yLij4GpQuI",
                "created": 1760979461,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns from the 'reference' table for the specified ZTF object and reference identifier\nSELECT *\nFROM reference\nWHERE oid IN (\n    -- Obtain the object's OID via a nested query (avoiding JOINs)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20actnuls'\n)\nAND rfid = 712120223;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns from the 'reference' table for the specified ZTF object and reference identifier\nSELECT *\nFROM reference\nWHERE oid IN (\n    -- Obtain the object's OID via a nested query (avoiding JOINs)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20actnuls'\n)\nAND rfid = 712120223;"
                },
                "in_toks": 1882,
                "out_toks": 2261,
                "id": "chatcmpl-CSoIZd3KzrMgtC8lvWq5uwz9hoSkK",
                "created": 1760982567,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "72",
            "experiment_id": "run_1",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['information_schema.tables']",
                    "1": "['reference']"
                },
                "in_toks": 613,
                "out_toks": 2714,
                "id": "chatcmpl-CSnUTHpAHQ3XNm5fM93yLij4GpQuI",
                "created": 1760979461,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns from the reference table for the given object and reference identifier\nSELECT *\nFROM reference\nWHERE oid IN (\n    -- Obtain the OID via a nested subquery as per guidelines\n    SELECT oid\n    FROM reference\n    WHERE oid = 'ZTF20actnuls'\n)\nAND rfid = 712120223;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns from the reference table for the given object and reference identifier\nSELECT *\nFROM reference\nWHERE oid IN (\n    -- Obtain the OID via a nested subquery as per guidelines\n    SELECT oid\n    FROM reference\n    WHERE oid = 'ZTF20actnuls'\n)\nAND rfid = 712120223;"
                },
                "in_toks": 2248,
                "out_toks": 1551,
                "id": "chatcmpl-CSoIxp2cOZvNAhtvoViLG6Ixp4RrH",
                "created": 1760982591,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "72",
            "experiment_id": "run_2",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 613,
                "out_toks": 1036,
                "id": "chatcmpl-CSsclxJeDvhKPIUbqdsrzgouyVbx7",
                "created": 1760999195,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return all columns from reference for the specified object OID and reference ID using a CTE to supply the identifiers */\nWITH target (oid, rfid) AS (\n    VALUES ('ZTF20actnuls'::varchar, 712120223::bigint)\n)\nSELECT *\nFROM reference\nWHERE (oid, rfid) IN (SELECT oid, rfid FROM target);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return all columns from reference for the specified object OID and reference ID using a CTE to supply the identifiers */\nWITH target (oid, rfid) AS (\n    VALUES ('ZTF20actnuls'::varchar, 712120223::bigint)\n)\nSELECT *\nFROM reference\nWHERE (oid, rfid) IN (SELECT oid, rfid FROM target);"
                },
                "in_toks": 2248,
                "out_toks": 984,
                "id": "chatcmpl-CSszLIwvJkQ2g9legkKCd6nK4bcns",
                "created": 1761000595,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "72",
            "experiment_id": "run_3",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 613,
                "out_toks": 1036,
                "id": "chatcmpl-CSscyFHQC22jeeMSRRiLwyBdXypjl",
                "created": 1760999208,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns from reference for the specified object OID and reference identifier (rfid)\nWITH target_oids(oid) AS (\n    VALUES ('ZTF20actnuls')  -- prioritize obtaining OIDs via a subquery\n)\nSELECT *\nFROM reference\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND rfid = 712120223;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns from reference for the specified object OID and reference identifier (rfid)\nWITH target_oids(oid) AS (\n    VALUES ('ZTF20actnuls')  -- prioritize obtaining OIDs via a subquery\n)\nSELECT *\nFROM reference\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND rfid = 712120223;"
                },
                "in_toks": 2248,
                "out_toks": 1109,
                "id": "chatcmpl-CSszXMfTWEAtsZ6TmDkmI0361TrmS",
                "created": 1761000607,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "72",
            "experiment_id": "run_4",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 613,
                "out_toks": 1804,
                "id": "chatcmpl-CSsdCHD1WKRXbQi3G4SQQLsrFuHrr",
                "created": 1760999222,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all columns from the 'reference' table for the specified object and reference identifier\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all columns from the 'reference' table for the specified object and reference identifier\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;"
                },
                "in_toks": 2248,
                "out_toks": 565,
                "id": "chatcmpl-CSszppjcjVO0F8jt2pI4SqjZQa4cW",
                "created": 1761000625,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "72",
            "experiment_id": "run_5",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 613,
                "out_toks": 908,
                "id": "chatcmpl-CZMVYv9heK0fDzyPbcMxdRxEAe7Np",
                "created": 1762544036,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the specified object and reference identifier\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the specified object and reference identifier\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;"
                },
                "in_toks": 2248,
                "out_toks": 1007,
                "id": "chatcmpl-CZRAOar5VVHrKyRD0zRDRcwGcYASv",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "72",
            "experiment_id": "run_6",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 613,
                "out_toks": 1356,
                "id": "chatcmpl-CZMVvj2Wo8XdN3Blvt4STTjawfr5o",
                "created": 1762544059,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the specified object and reference identifier\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the specified object and reference identifier\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;"
                },
                "in_toks": 2248,
                "out_toks": 623,
                "id": "chatcmpl-CZRAOCnYSJLliB3WiRtLumNnBc9LA",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "72",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 613,
                "out_toks": 1167,
                "id": "chatcmpl-CZMWM9UEMjiUifIdRcvdxSswtgv2X",
                "created": 1762544086,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all columns from reference for the specified object and reference ID\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all columns from reference for the specified object and reference ID\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;"
                },
                "in_toks": 2730,
                "out_toks": 561,
                "id": "chatcmpl-CZRAOLC4KfzYIyOjJwVzf2E3gLBR8",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "72",
            "experiment_id": "run_8",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['information_schema.tables']"
                },
                "in_toks": 613,
                "out_toks": 1358,
                "id": "chatcmpl-CZMWh82dG7ZnuydQ0Tej65py1fAkD",
                "created": 1762544107,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return all columns from the 'reference' table for the ZTF object 'ZTF20actnuls' and reference identifier '712120223'\n-- Fix: the column is 'reference_id' (not 'referenceid'); keep nested subquery to obtain the OID from 'object'\n\nSELECT r.*\nFROM reference AS r\nWHERE r.oid IN\n    (SELECT o.oid\n     FROM OBJECT AS o\n     WHERE o.oid = 'ZTF20actnuls')\n  AND r.reference_id::text = '712120223';",
            "sql_response": {
                "responses": {
                    "0": "-- Return all columns from the 'reference' table for the ZTF object 'ZTF20actnuls' and reference identifier '712120223'\n-- Fix: the column is 'reference_id' (not 'referenceid'); keep nested subquery to obtain the OID from 'object'\n\nSELECT r.*\nFROM reference AS r\nWHERE r.oid IN\n    (SELECT o.oid\n     FROM OBJECT AS o\n     WHERE o.oid = 'ZTF20actnuls')\n  AND r.reference_id::text = '712120223';"
                },
                "in_toks": 856,
                "out_toks": 1850,
                "id": "chatcmpl-Cb9oCmLXrrBMHrguDIsWH6mXQBH3N",
                "created": 1762971876,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns from the 'reference' table for the ZTF object 'ZTF20actnuls' and reference identifier '712120223'\n-- Per guidance, obtain the OID via a nested subquery from the 'object' table and avoid explicit JOINs\nSELECT *\nFROM reference\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20actnuls'\n)\nAND referenceid::text = '712120223';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns from the 'reference' table for the ZTF object 'ZTF20actnuls' and reference identifier '712120223'\n-- Per guidance, obtain the OID via a nested subquery from the 'object' table and avoid explicit JOINs\nSELECT *\nFROM reference\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20actnuls'\n)\nAND referenceid::text = '712120223';"
                },
                "in_toks": 1882,
                "out_toks": 1322,
                "id": "chatcmpl-CZRAvxWDZngWImjUG5xuXYzeF2J4k",
                "created": 1762561977,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "72",
            "experiment_id": "run_9",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 613,
                "out_toks": 588,
                "id": "chatcmpl-CZMX3L1fxhQm1NqRXd6MmuA5zbGWt",
                "created": 1762544129,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all columns for ZTF object 'ZTF20actnuls' and reference identifier 712120223\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all columns for ZTF object 'ZTF20actnuls' and reference identifier 712120223\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\n  AND rfid = 712120223;"
                },
                "in_toks": 2248,
                "out_toks": 763,
                "id": "chatcmpl-CZRB45GtUM8OokpqLHk9RR1CdEVf0",
                "created": 1762561986,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "103": {
        "0": {
            "req_id": "103",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'taxonomy']",
                    "1": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 675,
                "out_toks": 1969,
                "id": "chatcmpl-CSnV139LSHlJeHUJ6Iclw5v48MdUC",
                "created": 1760979495,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 200 oids whose nearest PS1 source is > 5\" and that have lc_classifier non-SN class probability > 0.7.\n   Return all columns from object, probability, and ps1_ztf (for the nearest-PS1 row), ordered by the nearest PS1 distance. */ WITH mindist AS\n  (SELECT oid,\n          MIN(distpsnr1) AS min_distpsnr1\n   FROM ps1_ztf\n   GROUP BY oid\n   HAVING MIN(distpsnr1) > 5),\n                                                                                                                                    eligible_oids AS\n  (SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN')\n     AND probability > 0.7),\n                                                                                                                                    top_oids AS\n  (SELECT m.oid\n   FROM mindist m\n   WHERE m.oid IN\n       (SELECT oid\n        FROM eligible_oids)\n   ORDER BY m.min_distpsnr1 ASC\n   LIMIT 200),\n                                                                                                                                    ps1_min AS\n  (/* Keep only the ps1_ztf row(s) per oid at the minimum distpsnr1 (nearest PS1). */  SELECT p.*\n   FROM ps1_ztf p\n   WHERE (p.oid,\n          p.distpsnr1) IN\n       (SELECT oid,\n               MIN(distpsnr1)\n        FROM ps1_ztf\n        GROUP BY oid\n        HAVING MIN(distpsnr1) > 5))\nSELECT o.*,\n       pr.*,\n       pm.*\nFROM OBJECT o,\n            probability pr,\n            ps1_min pm\nWHERE o.oid IN\n    (SELECT oid\n     FROM top_oids)\n  AND pr.oid = o.oid\n  AND pr.classifier_name = 'lc_classifier'\n  AND pr.class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN')\n  AND pr.probability > 0.7\n  AND pm.oid = o.oid\nORDER BY pm.distpsnr1 ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 200 oids whose nearest PS1 source is > 5\" and that have lc_classifier non-SN class probability > 0.7.\n   Return all columns from object, probability, and ps1_ztf (for the nearest-PS1 row), ordered by the nearest PS1 distance. */ WITH mindist AS\n  (SELECT oid,\n          MIN(distpsnr1) AS min_distpsnr1\n   FROM ps1_ztf\n   GROUP BY oid\n   HAVING MIN(distpsnr1) > 5),\n                                                                                                                                    eligible_oids AS\n  (SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN')\n     AND probability > 0.7),\n                                                                                                                                    top_oids AS\n  (SELECT m.oid\n   FROM mindist m\n   WHERE m.oid IN\n       (SELECT oid\n        FROM eligible_oids)\n   ORDER BY m.min_distpsnr1 ASC\n   LIMIT 200),\n                                                                                                                                    ps1_min AS\n  (/* Keep only the ps1_ztf row(s) per oid at the minimum distpsnr1 (nearest PS1). */  SELECT p.*\n   FROM ps1_ztf p\n   WHERE (p.oid,\n          p.distpsnr1) IN\n       (SELECT oid,\n               MIN(distpsnr1)\n        FROM ps1_ztf\n        GROUP BY oid\n        HAVING MIN(distpsnr1) > 5))\nSELECT o.*,\n       pr.*,\n       pm.*\nFROM OBJECT o,\n            probability pr,\n            ps1_min pm\nWHERE o.oid IN\n    (SELECT oid\n     FROM top_oids)\n  AND pr.oid = o.oid\n  AND pr.classifier_name = 'lc_classifier'\n  AND pr.class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN')\n  AND pr.probability > 0.7\n  AND pm.oid = o.oid\nORDER BY pm.distpsnr1 ASC;"
                },
                "in_toks": 3408,
                "out_toks": 3706,
                "id": "chatcmpl-CayetizNDRa4ASpGNSbFx7sckShDI",
                "created": 1762929015,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "103",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'taxonomy']",
                    "1": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 675,
                "out_toks": 1969,
                "id": "chatcmpl-CSnV139LSHlJeHUJ6Iclw5v48MdUC",
                "created": 1760979495,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 200 objects whose nearest PS1 source distance > 5 arcsec\n-- and that have lc_classifier probability > 0.7 for any non-supernova class.\n-- Return all columns from object, probability, and the nearest-row from ps1_ztf.\nWITH\nps1_nearest AS (\n    -- One ps1_ztf row per oid: the one with the smallest distpsnr1 (nearest PS1 source)\n    SELECT DISTINCT ON (oid) *\n    FROM ps1_ztf\n    WHERE distpsnr1 IS NOT NULL\n    ORDER BY oid, distpsnr1 ASC\n),\nselected_oids AS (\n    -- OIDs that satisfy both the PS1 nearest distance > 5 arcsec\n    -- and the non-supernova lc_classifier probability > 0.7\n    SELECT pn.oid\n    FROM ps1_nearest pn\n    WHERE pn.distpsnr1 > 5\n      AND pn.oid IN (\n          SELECT pr.oid\n          FROM probability pr\n          WHERE pr.classifier_name = 'lc_classifier'\n            AND pr.class_name NOT IN ('SNIa','SNIbc','SNII','SLSN')\n            AND pr.probability > 0.7\n      )\n    ORDER BY pn.distpsnr1 ASC\n    LIMIT 200\n)\nSELECT\n    o.*,\n    pr.*,\n    pn.*\nFROM object o, probability pr, ps1_nearest pn\nWHERE o.oid IN (SELECT oid FROM selected_oids)\n  AND pr.oid = o.oid\n  AND pn.oid = o.oid\n  AND pr.classifier_name = 'lc_classifier'\n  AND pr.class_name NOT IN ('SNIa','SNIbc','SNII','SLSN')\n  AND pr.probability > 0.7\nORDER BY pn.distpsnr1 ASC, o.oid, pr.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 200 objects whose nearest PS1 source distance > 5 arcsec\n-- and that have lc_classifier probability > 0.7 for any non-supernova class.\n-- Return all columns from object, probability, and the nearest-row from ps1_ztf.\nWITH\nps1_nearest AS (\n    -- One ps1_ztf row per oid: the one with the smallest distpsnr1 (nearest PS1 source)\n    SELECT DISTINCT ON (oid) *\n    FROM ps1_ztf\n    WHERE distpsnr1 IS NOT NULL\n    ORDER BY oid, distpsnr1 ASC\n),\nselected_oids AS (\n    -- OIDs that satisfy both the PS1 nearest distance > 5 arcsec\n    -- and the non-supernova lc_classifier probability > 0.7\n    SELECT pn.oid\n    FROM ps1_nearest pn\n    WHERE pn.distpsnr1 > 5\n      AND pn.oid IN (\n          SELECT pr.oid\n          FROM probability pr\n          WHERE pr.classifier_name = 'lc_classifier'\n            AND pr.class_name NOT IN ('SNIa','SNIbc','SNII','SLSN')\n            AND pr.probability > 0.7\n      )\n    ORDER BY pn.distpsnr1 ASC\n    LIMIT 200\n)\nSELECT\n    o.*,\n    pr.*,\n    pn.*\nFROM object o, probability pr, ps1_nearest pn\nWHERE o.oid IN (SELECT oid FROM selected_oids)\n  AND pr.oid = o.oid\n  AND pn.oid = o.oid\n  AND pr.classifier_name = 'lc_classifier'\n  AND pr.class_name NOT IN ('SNIa','SNIbc','SNII','SLSN')\n  AND pr.probability > 0.7\nORDER BY pn.distpsnr1 ASC, o.oid, pr.ranking;"
                },
                "in_toks": 3363,
                "out_toks": 3544,
                "id": "chatcmpl-CSoJicM2bvT52zXEKf2w4ifX2dASO",
                "created": 1760982638,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "103",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'taxonomy']"
                },
                "in_toks": 675,
                "out_toks": 1178,
                "id": "chatcmpl-CSsdokd1k3P9g7wCPQt4ggJ75tztJ",
                "created": 1760999260,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 200 objects whose nearest PS1 source is farther than 5\" and have lc_classifier non-SN class probability > 0.7.\n   Return all columns from object, probability, and ps1_ztf; order by nearest PS1 distance. */ WITH p_oids AS \n  (/* OIDs with non-supernova lc_classifier class probability > 0.7 */  SELECT DISTINCT oid \n   FROM probability \n   WHERE classifier_name = 'lc_classifier' \n     AND class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN') \n     AND probability > 0.7), \n                                                                                                    z_min AS \n  (/* One ps1_ztf row per OID with the minimum (nearest) distpsnr1 */  SELECT DISTINCT ON (oid) oid, \n                                                                                          candid, \n                                                                                          distpsnr1 \n   FROM ps1_ztf \n   WHERE distpsnr1 IS NOT NULL \n   ORDER BY oid, \n            distpsnr1 ASC), \n                                                                                                    eligible AS \n  (/* Eligible OIDs: nearest PS1 distance > 5\" and in the probability set; limit to 200 by increasing distance */  SELECT z.oid,\n                                                                                                                          z.candid,\n                                                                                                                          z.distpsnr1\n   FROM z_min z\n   WHERE z.distpsnr1 > 5\n     AND z.oid IN\n       (SELECT oid\n        FROM p_oids)\n   ORDER BY z.distpsnr1 ASC\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       z.*\nFROM eligible s,\n     OBJECT o,\n            probability p,\n            ps1_ztf z\nWHERE o.oid = s.oid\n  AND p.oid = s.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7\n  AND z.oid = s.oid\n  AND z.candid = s.candid\nORDER BY s.distpsnr1 ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 200 objects whose nearest PS1 source is farther than 5\" and have lc_classifier non-SN class probability > 0.7.\n   Return all columns from object, probability, and ps1_ztf; order by nearest PS1 distance. */ WITH p_oids AS \n  (/* OIDs with non-supernova lc_classifier class probability > 0.7 */  SELECT DISTINCT oid \n   FROM probability \n   WHERE classifier_name = 'lc_classifier' \n     AND class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN') \n     AND probability > 0.7), \n                                                                                                    z_min AS \n  (/* One ps1_ztf row per OID with the minimum (nearest) distpsnr1 */  SELECT DISTINCT ON (oid) oid, \n                                                                                          candid, \n                                                                                          distpsnr1 \n   FROM ps1_ztf \n   WHERE distpsnr1 IS NOT NULL \n   ORDER BY oid, \n            distpsnr1 ASC), \n                                                                                                    eligible AS \n  (/* Eligible OIDs: nearest PS1 distance > 5\" and in the probability set; limit to 200 by increasing distance */  SELECT z.oid,\n                                                                                                                          z.candid,\n                                                                                                                          z.distpsnr1\n   FROM z_min z\n   WHERE z.distpsnr1 > 5\n     AND z.oid IN\n       (SELECT oid\n        FROM p_oids)\n   ORDER BY z.distpsnr1 ASC\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       z.*\nFROM eligible s,\n     OBJECT o,\n            probability p,\n            ps1_ztf z\nWHERE o.oid = s.oid\n  AND p.oid = s.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7\n  AND z.oid = s.oid\n  AND z.candid = s.candid\nORDER BY s.distpsnr1 ASC;"
                },
                "in_toks": 3408,
                "out_toks": 3833,
                "id": "chatcmpl-CayfcBlNHPuLYJ5oaAzIdATgIefkm",
                "created": 1762929060,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "103",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'ps1_ztf']"
                },
                "in_toks": 675,
                "out_toks": 1242,
                "id": "chatcmpl-CSse2DLbnwfLeZi0AtPNVAeEbP6jn",
                "created": 1760999274,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 200 objects whose nearest PS1 neighbor is farther than 5 arcsec\n-- and that have lc_classifier probability > 0.7 for any non-supernova class.\n-- Return all columns from object, probability (restricted to lc_classifier), and ps1_ztf.\n-- Results are ordered by the nearest PS1 source distance (ascending).\n\nWITH mindist AS (\n    -- Compute the nearest PS1 distance per object across all alerts/candid\n    SELECT\n        oid,\n        MIN(distpsnr1) AS nearest_ps1_dist\n    FROM ps1_ztf\n    GROUP BY oid\n),\nselected_oids AS (\n    -- Select at most 200 OIDs that satisfy both conditions,\n    -- ordered by their nearest PS1 distance\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE\n        p.classifier_name = 'lc_classifier' AND\n        p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') AND\n        p.probability > 0.7 AND\n        p.oid IN (\n            SELECT m.oid\n            FROM mindist m\n            WHERE m.nearest_ps1_dist > 5\n        )\n    ORDER BY (SELECT m.nearest_ps1_dist FROM mindist m WHERE m.oid = p.oid) ASC\n    LIMIT 200\n)\nSELECT\n    o.*,\n    pr.*,\n    ps.*\nFROM\n    object o,\n    probability pr,\n    ps1_ztf ps\nWHERE\n    o.oid IN (SELECT oid FROM selected_oids) AND\n    pr.oid = o.oid AND\n    pr.classifier_name = 'lc_classifier' AND  -- default to lc_classifier for returned probabilities\n    ps.oid = o.oid\nORDER BY\n    (SELECT m.nearest_ps1_dist FROM mindist m WHERE m.oid = o.oid) ASC,\n    pr.class_name,\n    ps.candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 200 objects whose nearest PS1 neighbor is farther than 5 arcsec\n-- and that have lc_classifier probability > 0.7 for any non-supernova class.\n-- Return all columns from object, probability (restricted to lc_classifier), and ps1_ztf.\n-- Results are ordered by the nearest PS1 source distance (ascending).\n\nWITH mindist AS (\n    -- Compute the nearest PS1 distance per object across all alerts/candid\n    SELECT\n        oid,\n        MIN(distpsnr1) AS nearest_ps1_dist\n    FROM ps1_ztf\n    GROUP BY oid\n),\nselected_oids AS (\n    -- Select at most 200 OIDs that satisfy both conditions,\n    -- ordered by their nearest PS1 distance\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE\n        p.classifier_name = 'lc_classifier' AND\n        p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') AND\n        p.probability > 0.7 AND\n        p.oid IN (\n            SELECT m.oid\n            FROM mindist m\n            WHERE m.nearest_ps1_dist > 5\n        )\n    ORDER BY (SELECT m.nearest_ps1_dist FROM mindist m WHERE m.oid = p.oid) ASC\n    LIMIT 200\n)\nSELECT\n    o.*,\n    pr.*,\n    ps.*\nFROM\n    object o,\n    probability pr,\n    ps1_ztf ps\nWHERE\n    o.oid IN (SELECT oid FROM selected_oids) AND\n    pr.oid = o.oid AND\n    pr.classifier_name = 'lc_classifier' AND  -- default to lc_classifier for returned probabilities\n    ps.oid = o.oid\nORDER BY\n    (SELECT m.nearest_ps1_dist FROM mindist m WHERE m.oid = o.oid) ASC,\n    pr.class_name,\n    ps.candid;"
                },
                "in_toks": 3408,
                "out_toks": 3685,
                "id": "chatcmpl-CSt0gIADXARL7GcV7yG69RmE1skEv",
                "created": 1761000678,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "103",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 675,
                "out_toks": 1111,
                "id": "chatcmpl-CSseIIDoxzBMyo2zBI4PyFjRnWIxP",
                "created": 1760999290,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH candidates AS\n  (-- Select up to 200 OIDs whose nearest PS1 source distance > 5 arcsec\n -- and that have lc_classifier probability > 0.7 for any non-SN class.\n SELECT z.oid,\n        MIN(z.distpsnr1) AS min_dist\n   FROM ps1_ztf z\n   WHERE z.distpsnr1 > 5\n     AND z.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name NOT IN ('SNIa',\n                                   'SNIbc',\n                                   'SNII',\n                                   'SLSN')\n          AND p.probability > 0.7)\n   GROUP BY z.oid\n   ORDER BY min_dist ASC\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       z.*\nFROM candidates c,\n     OBJECT o,\n            probability p,\n            ps1_ztf z\nWHERE o.oid = c.oid\n  AND p.oid = o.oid\n  AND z.oid = o.oid -- enforce the probability condition and classifier on the returned rows\n\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7 -- ensure returned PS1 rows also satisfy the distance constraint\n\n  AND z.distpsnr1 > 5\nORDER BY c.min_dist ASC, -- order by nearest PS1 source distance per object\n z.distpsnr1 ASC; -- tie-breaker within object rows",
            "original_sql_response": {
                "responses": {
                    "0": "WITH candidates AS\n  (-- Select up to 200 OIDs whose nearest PS1 source distance > 5 arcsec\n -- and that have lc_classifier probability > 0.7 for any non-SN class.\n SELECT z.oid,\n        MIN(z.distpsnr1) AS min_dist\n   FROM ps1_ztf z\n   WHERE z.distpsnr1 > 5\n     AND z.oid IN\n       (SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name NOT IN ('SNIa',\n                                   'SNIbc',\n                                   'SNII',\n                                   'SLSN')\n          AND p.probability > 0.7)\n   GROUP BY z.oid\n   ORDER BY min_dist ASC\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       z.*\nFROM candidates c,\n     OBJECT o,\n            probability p,\n            ps1_ztf z\nWHERE o.oid = c.oid\n  AND p.oid = o.oid\n  AND z.oid = o.oid -- enforce the probability condition and classifier on the returned rows\n\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7 -- ensure returned PS1 rows also satisfy the distance constraint\n\n  AND z.distpsnr1 > 5\nORDER BY c.min_dist ASC, -- order by nearest PS1 source distance per object\n z.distpsnr1 ASC; -- tie-breaker within object rows"
                },
                "in_toks": 3363,
                "out_toks": 3562,
                "id": "chatcmpl-CaygGxP5vAwj5WTKtYiP7AbiTAAdl",
                "created": 1762929100,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "103",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 675,
                "out_toks": 599,
                "id": "chatcmpl-CZMXJLDdKMpTVi0nisVTWWpFjW31a",
                "created": 1762544145,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 200 objects whose nearest PS1 source is >5 arcsec and whose lc_classifier assigns >0.7 probability to a non-supernova class. Return all columns from object, probability, and ps1_ztf, ordered by nearest PS1 distance. */ WITH candidates AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name NOT IN ('SNIa',\n                              'SNIbc',\n                              'SNII',\n                              'SLSN')\n     AND p.probability > 0.7),\n                                                                                                                                                                                                                                              ps1_filter AS\n  (SELECT ps.oid,\n          MIN(ps.distpsnr1) AS min_dist1\n   FROM ps1_ztf ps\n   GROUP BY ps.oid\n   HAVING MIN(ps.distpsnr1) > 5),\n                                                                                                                                                                                                                                              selected_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT oid\n        FROM candidates)\n     AND o.oid IN\n       (SELECT oid\n        FROM ps1_filter)\n   ORDER BY\n     (SELECT pf.min_dist1\n      FROM ps1_filter pf\n      WHERE pf.oid = o.oid) ASC\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       ps.*\nFROM selected_oids so,\n     OBJECT o,\n            probability p,\n            ps1_ztf ps,\n            ps1_filter pf\nWHERE o.oid = so.oid\n  AND p.oid = so.oid\n  AND ps.oid = so.oid\n  AND pf.oid = so.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7\nORDER BY pf.min_dist1 ASC,\n         ps.distpsnr1 ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 200 objects whose nearest PS1 source is >5 arcsec and whose lc_classifier assigns >0.7 probability to a non-supernova class. Return all columns from object, probability, and ps1_ztf, ordered by nearest PS1 distance. */ WITH candidates AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name NOT IN ('SNIa',\n                              'SNIbc',\n                              'SNII',\n                              'SLSN')\n     AND p.probability > 0.7),\n                                                                                                                                                                                                                                              ps1_filter AS\n  (SELECT ps.oid,\n          MIN(ps.distpsnr1) AS min_dist1\n   FROM ps1_ztf ps\n   GROUP BY ps.oid\n   HAVING MIN(ps.distpsnr1) > 5),\n                                                                                                                                                                                                                                              selected_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT oid\n        FROM candidates)\n     AND o.oid IN\n       (SELECT oid\n        FROM ps1_filter)\n   ORDER BY\n     (SELECT pf.min_dist1\n      FROM ps1_filter pf\n      WHERE pf.oid = o.oid) ASC\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       ps.*\nFROM selected_oids so,\n     OBJECT o,\n            probability p,\n            ps1_ztf ps,\n            ps1_filter pf\nWHERE o.oid = so.oid\n  AND p.oid = so.oid\n  AND ps.oid = so.oid\n  AND pf.oid = so.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7\nORDER BY pf.min_dist1 ASC,\n         ps.distpsnr1 ASC;"
                },
                "in_toks": 3363,
                "out_toks": 2952,
                "id": "chatcmpl-Cayh0z8VN4COaowtojc1bBA6chCsO",
                "created": 1762929146,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "103",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'taxonomy']"
                },
                "in_toks": 675,
                "out_toks": 1626,
                "id": "chatcmpl-CZMXYNAMXQnQBwNGVIXidrpGKXenP",
                "created": 1762544160,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 200 objects with:\n   - min PS1 nearest-source distance > 5 arcsec (using distpsnr1)\n   - at least one non-SN lc_classifier class with probability > 0.7\n   Return all columns from object, probability, and ps1_ztf for those objects,\n   ordered by the object's nearest PS1 source distance.\n*/ WITH eligible_oids AS \n  (SELECT DISTINCT oid \n   FROM probability \n   WHERE classifier_name = 'lc_classifier' \n     AND class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN')\n     AND probability > 0.7),\n        distant_oids AS\n  (SELECT oid\n   FROM ps1_ztf\n   GROUP BY oid\n   HAVING MIN(distpsnr1) > 5),\n        selected_oids AS\n  (SELECT o.oid,\n\n     (SELECT MIN(psx.distpsnr1)\n      FROM ps1_ztf psx\n      WHERE psx.oid = o.oid) AS min_dist\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT oid\n        FROM eligible_oids)\n     AND o.oid IN\n       (SELECT oid\n        FROM distant_oids)\n   ORDER BY min_dist\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       ps.*\nFROM selected_oids so,\n     OBJECT o,\n            probability p,\n            ps1_ztf ps\nWHERE o.oid = so.oid\n  AND p.oid = o.oid\n  AND ps.oid = o.oid\nORDER BY so.min_dist,\n         ps.distpsnr1;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 200 objects with:\n   - min PS1 nearest-source distance > 5 arcsec (using distpsnr1)\n   - at least one non-SN lc_classifier class with probability > 0.7\n   Return all columns from object, probability, and ps1_ztf for those objects,\n   ordered by the object's nearest PS1 source distance.\n*/ WITH eligible_oids AS \n  (SELECT DISTINCT oid \n   FROM probability \n   WHERE classifier_name = 'lc_classifier' \n     AND class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN')\n     AND probability > 0.7),\n        distant_oids AS\n  (SELECT oid\n   FROM ps1_ztf\n   GROUP BY oid\n   HAVING MIN(distpsnr1) > 5),\n        selected_oids AS\n  (SELECT o.oid,\n\n     (SELECT MIN(psx.distpsnr1)\n      FROM ps1_ztf psx\n      WHERE psx.oid = o.oid) AS min_dist\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT oid\n        FROM eligible_oids)\n     AND o.oid IN\n       (SELECT oid\n        FROM distant_oids)\n   ORDER BY min_dist\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       ps.*\nFROM selected_oids so,\n     OBJECT o,\n            probability p,\n            ps1_ztf ps\nWHERE o.oid = so.oid\n  AND p.oid = o.oid\n  AND ps.oid = o.oid\nORDER BY so.min_dist,\n         ps.distpsnr1;"
                },
                "in_toks": 3408,
                "out_toks": 3154,
                "id": "chatcmpl-CayhaOEcGS99ovFE5QwkTLEsm17HA",
                "created": 1762929182,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "103",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'taxonomy']"
                },
                "in_toks": 675,
                "out_toks": 922,
                "id": "chatcmpl-CZMYEzOvKhKJLfJGkpT9hNNoTq1lN",
                "created": 1762544202,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 200 objects whose nearest PS1 source is farther than 5\" and\n-- have lc_classifier probability > 0.7 for any non-supernova class.\nWITH eligible_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name NOT IN ('SNIa',\n                              'SNIbc',\n                              'SNII',\n                              'SLSN')\n     AND p.probability > 0.7\n   GROUP BY p.oid),\n     selected_oids AS\n  (SELECT s.oid\n   FROM ps1_ztf s\n   WHERE s.distpsnr1 > 5\n     AND s.oid IN\n       (SELECT oid\n        FROM eligible_oids)\n   GROUP BY s.oid\n   ORDER BY MIN(s.distpsnr1)\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       s.*\nFROM OBJECT o,\n            probability p,\n            ps1_ztf s\nWHERE o.oid IN\n    (SELECT oid\n     FROM selected_oids)\n  AND p.oid = o.oid\n  AND s.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7\n  AND s.distpsnr1 > 5\nORDER BY s.distpsnr1 ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 200 objects whose nearest PS1 source is farther than 5\" and\n-- have lc_classifier probability > 0.7 for any non-supernova class.\nWITH eligible_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name NOT IN ('SNIa',\n                              'SNIbc',\n                              'SNII',\n                              'SLSN')\n     AND p.probability > 0.7\n   GROUP BY p.oid),\n     selected_oids AS\n  (SELECT s.oid\n   FROM ps1_ztf s\n   WHERE s.distpsnr1 > 5\n     AND s.oid IN\n       (SELECT oid\n        FROM eligible_oids)\n   GROUP BY s.oid\n   ORDER BY MIN(s.distpsnr1)\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       s.*\nFROM OBJECT o,\n            probability p,\n            ps1_ztf s\nWHERE o.oid IN\n    (SELECT oid\n     FROM selected_oids)\n  AND p.oid = o.oid\n  AND s.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7\n  AND s.distpsnr1 > 5\nORDER BY s.distpsnr1 ASC;"
                },
                "in_toks": 3408,
                "out_toks": 3063,
                "id": "chatcmpl-CayiEqcG1T29HS3CqstprZSoxy7WT",
                "created": 1762929222,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "103",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 675,
                "out_toks": 663,
                "id": "chatcmpl-CZMYXjVAn5Oc7hBBCnOQGlAChlgE6",
                "created": 1762544221,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 200 objects whose nearest PS1 source is farther than 5 arcsec\n-- and that have lc_classifier probability > 0.7 for a non-supernova class.\n-- Return all columns from object, probability, and ps1_ztf.\nWITH good_prob_oids AS\n  (SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN')\n     AND probability > 0.7),\n     ps1_min AS\n  (SELECT oid,\n          MIN(distpsnr1) AS min_distpsnr1\n   FROM ps1_ztf\n   GROUP BY oid\n   HAVING MIN(distpsnr1) > 5),\n     selected AS\n  (SELECT oid,\n          min_distpsnr1\n   FROM ps1_min\n   WHERE oid IN\n       (SELECT oid\n        FROM good_prob_oids)\n   ORDER BY min_distpsnr1 ASC\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       s.*\nFROM OBJECT o,\n            probability p,\n            ps1_ztf s\nWHERE o.oid IN\n    (SELECT oid\n     FROM selected)\n  AND p.oid = o.oid\n  AND s.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7\nORDER BY\n  (SELECT min_distpsnr1\n   FROM selected\n   WHERE selected.oid = o.oid) ASC, s.distpsnr1 ASC,\n                                    o.oid,\n                                    p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 200 objects whose nearest PS1 source is farther than 5 arcsec\n-- and that have lc_classifier probability > 0.7 for a non-supernova class.\n-- Return all columns from object, probability, and ps1_ztf.\nWITH good_prob_oids AS\n  (SELECT DISTINCT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND class_name NOT IN ('SNIa',\n                            'SNIbc',\n                            'SNII',\n                            'SLSN')\n     AND probability > 0.7),\n     ps1_min AS\n  (SELECT oid,\n          MIN(distpsnr1) AS min_distpsnr1\n   FROM ps1_ztf\n   GROUP BY oid\n   HAVING MIN(distpsnr1) > 5),\n     selected AS\n  (SELECT oid,\n          min_distpsnr1\n   FROM ps1_min\n   WHERE oid IN\n       (SELECT oid\n        FROM good_prob_oids)\n   ORDER BY min_distpsnr1 ASC\n   LIMIT 200)\nSELECT o.*,\n       p.*,\n       s.*\nFROM OBJECT o,\n            probability p,\n            ps1_ztf s\nWHERE o.oid IN\n    (SELECT oid\n     FROM selected)\n  AND p.oid = o.oid\n  AND s.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name NOT IN ('SNIa',\n                           'SNIbc',\n                           'SNII',\n                           'SLSN')\n  AND p.probability > 0.7\nORDER BY\n  (SELECT min_distpsnr1\n   FROM selected\n   WHERE selected.oid = o.oid) ASC, s.distpsnr1 ASC,\n                                    o.oid,\n                                    p.ranking;"
                },
                "in_toks": 3363,
                "out_toks": 3564,
                "id": "chatcmpl-CayikfIBCNSqTa7lbv3kLxeOQLad2",
                "created": 1762929254,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "103",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 675,
                "out_toks": 855,
                "id": "chatcmpl-CZMYlhprFdfsQQ8x3yqCLGE19t1Hq",
                "created": 1762544235,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 200 objects with nearest PS1 source farther than 5 arcsec\n-- and with lc_classifier probability > 0.7 for any non-supernova class.\n-- Return all columns from object, probability, and ps1_ztf.\nWITH obj_ps AS (\n    -- Per object, compute the nearest PS1 distance (only considering > 5 arcsec)\n    SELECT ps.oid, MIN(ps.distpsnr1) AS min_dist\n    FROM ps1_ztf ps\n    WHERE ps.distpsnr1 > 5\n    GROUP BY ps.oid\n),\nobj_prob AS (\n    -- OIDs that have lc_classifier probability > 0.7 for any non-SN class\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND p.probability > 0.7\n),\ncandidate_oids AS (\n    -- Intersect the two conditions and keep at most 200 objects,\n    -- prioritizing those with the smallest (but > 5 arcsec) nearest PS1 distance\n    SELECT o.oid, o.min_dist\n    FROM obj_ps o\n    WHERE o.oid IN (SELECT oid FROM obj_prob)\n    ORDER BY o.min_dist ASC\n    LIMIT 200\n)\nSELECT obj.*, prob.*, ps1.*\nFROM object obj, probability prob, ps1_ztf ps1\nWHERE obj.oid IN (SELECT oid FROM candidate_oids)\n  AND prob.oid = obj.oid\n  AND ps1.oid = obj.oid\n  AND prob.classifier_name = 'lc_classifier'\n  AND prob.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND prob.probability > 0.7\n  AND ps1.distpsnr1 > 5\nORDER BY ps1.distpsnr1 ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 200 objects with nearest PS1 source farther than 5 arcsec\n-- and with lc_classifier probability > 0.7 for any non-supernova class.\n-- Return all columns from object, probability, and ps1_ztf.\nWITH obj_ps AS (\n    -- Per object, compute the nearest PS1 distance (only considering > 5 arcsec)\n    SELECT ps.oid, MIN(ps.distpsnr1) AS min_dist\n    FROM ps1_ztf ps\n    WHERE ps.distpsnr1 > 5\n    GROUP BY ps.oid\n),\nobj_prob AS (\n    -- OIDs that have lc_classifier probability > 0.7 for any non-SN class\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND p.probability > 0.7\n),\ncandidate_oids AS (\n    -- Intersect the two conditions and keep at most 200 objects,\n    -- prioritizing those with the smallest (but > 5 arcsec) nearest PS1 distance\n    SELECT o.oid, o.min_dist\n    FROM obj_ps o\n    WHERE o.oid IN (SELECT oid FROM obj_prob)\n    ORDER BY o.min_dist ASC\n    LIMIT 200\n)\nSELECT obj.*, prob.*, ps1.*\nFROM object obj, probability prob, ps1_ztf ps1\nWHERE obj.oid IN (SELECT oid FROM candidate_oids)\n  AND prob.oid = obj.oid\n  AND ps1.oid = obj.oid\n  AND prob.classifier_name = 'lc_classifier'\n  AND prob.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND prob.probability > 0.7\n  AND ps1.distpsnr1 > 5\nORDER BY ps1.distpsnr1 ASC;"
                },
                "in_toks": 3363,
                "out_toks": 3503,
                "id": "chatcmpl-CZRAO2Ys2SPLyj8jfjhPdwuH9ELWq",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "54": {
        "0": {
            "req_id": "54",
            "experiment_id": "run_0",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']",
                    "1": "['object', 'non_detection']"
                },
                "in_toks": 640,
                "out_toks": 861,
                "id": "chatcmpl-CSnVEQJARqe5JzaZ3nYnD4CR8zKkU",
                "created": 1760979508,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all non-detection epochs for the specified ZTF objects\n-- Condition: \"fainter than 19.5\" => diffmaglim > 19.5 (larger magnitude is fainter)\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT *\nFROM non_detection\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND diffmaglim > 19.5\nORDER BY oid, mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all non-detection epochs for the specified ZTF objects\n-- Condition: \"fainter than 19.5\" => diffmaglim > 19.5 (larger magnitude is fainter)\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT *\nFROM non_detection\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND diffmaglim > 19.5\nORDER BY oid, mjd;"
                },
                "in_toks": 2039,
                "out_toks": 759,
                "id": "chatcmpl-CSoKDPjR8azpnAxNHiw39bq4J1oKk",
                "created": 1760982669,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "54",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']",
                    "1": "['object', 'non_detection']"
                },
                "in_toks": 640,
                "out_toks": 861,
                "id": "chatcmpl-CSnVEQJARqe5JzaZ3nYnD4CR8zKkU",
                "created": 1760979508,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all non-detection epochs for the specified ZTF objects with 5-sigma limits fainter than 19.5 mag\n-- Note: \"fainter\" in magnitudes means numerically larger values\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim IS NOT NULL\nAND diffmaglim > 19.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all non-detection epochs for the specified ZTF objects with 5-sigma limits fainter than 19.5 mag\n-- Note: \"fainter\" in magnitudes means numerically larger values\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim IS NOT NULL\nAND diffmaglim > 19.5;"
                },
                "in_toks": 2521,
                "out_toks": 815,
                "id": "chatcmpl-CSoKLmTrpyf4uMGmwWwcRFHZicLdn",
                "created": 1760982677,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "54",
            "experiment_id": "run_2",
            "pred_tables": [
                "non_detection",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection', 'object']"
                },
                "in_toks": 640,
                "out_toks": 400,
                "id": "chatcmpl-CSsecpgbEt6i8q6MDAha1HlXJoFHu",
                "created": 1760999310,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find non-detection epochs for the specified ZTF objects with 5-sigma magnitude limit fainter than 19.5 (i.e., larger than 19.5)\nSELECT\n    *\nFROM\n    non_detection\nWHERE\n    oid IN (\n        -- Obtain valid OIDs from the object table (nested subquery as per guidelines)\n        SELECT oid\n        FROM object\n        WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n    )\n    AND diffmaglim > 19.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find non-detection epochs for the specified ZTF objects with 5-sigma magnitude limit fainter than 19.5 (i.e., larger than 19.5)\nSELECT\n    *\nFROM\n    non_detection\nWHERE\n    oid IN (\n        -- Obtain valid OIDs from the object table (nested subquery as per guidelines)\n        SELECT oid\n        FROM object\n        WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n    )\n    AND diffmaglim > 19.5;"
                },
                "in_toks": 2521,
                "out_toks": 570,
                "id": "chatcmpl-CSt2Ha3UbwEkEJGknu26c2o53sEE7",
                "created": 1761000777,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "54",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'non_detection']"
                },
                "in_toks": 640,
                "out_toks": 592,
                "id": "chatcmpl-CSseheGESAI3H0vccNamsfx5sBwFw",
                "created": 1760999315,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find non-detections with 5-sigma mag limit fainter than 19.5 (i.e., diffmaglim > 19.5)\n-- for the specified ZTF object identifiers. Return all columns.\nSELECT *\nFROM non_detection\nWHERE diffmaglim > 19.5\n  AND oid IN (\n      -- Obtain OIDs from the object table (nested subquery as per guidance)\n      SELECT oid\n      FROM object\n      WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  )\nORDER BY oid, mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find non-detections with 5-sigma mag limit fainter than 19.5 (i.e., diffmaglim > 19.5)\n-- for the specified ZTF object identifiers. Return all columns.\nSELECT *\nFROM non_detection\nWHERE diffmaglim > 19.5\n  AND oid IN (\n      -- Obtain OIDs from the object table (nested subquery as per guidance)\n      SELECT oid\n      FROM object\n      WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  )\nORDER BY oid, mjd;"
                },
                "in_toks": 2521,
                "out_toks": 515,
                "id": "chatcmpl-CSt2QmSt5TJJOQTYebfSPHpV8kTf7",
                "created": 1761000786,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "54",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'non_detection']"
                },
                "in_toks": 640,
                "out_toks": 400,
                "id": "chatcmpl-CSseofK2H1gKcw7EFHxNV8sUm194X",
                "created": 1760999322,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all non-detection epochs for the given ZTF oids with 5-sigma mag limit fainter than 19.5 (i.e., larger magnitudes)\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all non-detection epochs for the given ZTF oids with 5-sigma mag limit fainter than 19.5 (i.e., larger magnitudes)\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;"
                },
                "in_toks": 2521,
                "out_toks": 1055,
                "id": "chatcmpl-CSt2ZyCPqqo9EjE7W36e0tF6WwqpT",
                "created": 1761000795,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "54",
            "experiment_id": "run_5",
            "pred_tables": [
                "non_detection",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection', 'object']"
                },
                "in_toks": 640,
                "out_toks": 464,
                "id": "chatcmpl-CZMZ4giJtP1yYMPOUD7Mr4hbAP3NA",
                "created": 1762544254,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all non-detection epochs for the specified ZTF objects with 5-sigma limits fainter than 19.5 mag\n-- Note: \"fainter\" => larger magnitude, so diffmaglim > 19.5\n-- OIDs are obtained via a subquery from the object table as recommended\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all non-detection epochs for the specified ZTF objects with 5-sigma limits fainter than 19.5 mag\n-- Note: \"fainter\" => larger magnitude, so diffmaglim > 19.5\n-- OIDs are obtained via a subquery from the object table as recommended\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;"
                },
                "in_toks": 2521,
                "out_toks": 636,
                "id": "chatcmpl-CZRC8cVjm0lyPTOVKkdIH2DIT67ep",
                "created": 1762562052,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "54",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'non_detection']"
                },
                "in_toks": 640,
                "out_toks": 336,
                "id": "chatcmpl-CZMZExBLcDHUthSOWeGEgRproaVE9",
                "created": 1762544264,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find non-detection epochs with 5-sigma magnitude limit fainter than 19.5 (i.e., diffmaglim > 19.5)\n-- for the specified ZTF objects, returning all columns from non_detection.\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nSELECT nd.*\nFROM non_detection AS nd\nWHERE nd.oid IN (SELECT oid FROM selected_oids)\n  AND nd.diffmaglim > 19.5\nORDER BY nd.oid, nd.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find non-detection epochs with 5-sigma magnitude limit fainter than 19.5 (i.e., diffmaglim > 19.5)\n-- for the specified ZTF objects, returning all columns from non_detection.\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nSELECT nd.*\nFROM non_detection AS nd\nWHERE nd.oid IN (SELECT oid FROM selected_oids)\n  AND nd.diffmaglim > 19.5\nORDER BY nd.oid, nd.mjd;"
                },
                "in_toks": 2521,
                "out_toks": 841,
                "id": "chatcmpl-CZRAOvdfvURtSs4Lgor3raKeoQvGs",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "54",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'non_detection']"
                },
                "in_toks": 640,
                "out_toks": 400,
                "id": "chatcmpl-CZMZLC8AZ01DB51d51PWBGaL4PiH6",
                "created": 1762544271,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all non-detection epochs for the specified ZTF objects with 5-sigma limits fainter (i.e., larger magnitude) than 19.5\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    -- Prioritize obtaining OIDs from the object table via a subquery\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all non-detection epochs for the specified ZTF objects with 5-sigma limits fainter (i.e., larger magnitude) than 19.5\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    -- Prioritize obtaining OIDs from the object table via a subquery\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;"
                },
                "in_toks": 2521,
                "out_toks": 621,
                "id": "chatcmpl-CZRCGb8GklfTP2j9k2knkLO71yd7O",
                "created": 1762562060,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "54",
            "experiment_id": "run_8",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 640,
                "out_toks": 717,
                "id": "chatcmpl-CZMZUPp01xiPpfMWVpiSpx6h3IcEx",
                "created": 1762544280,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all non-detection epochs for the specified ZTF objects\n-- Note: 'fainter' magnitudes correspond to larger numeric values, so we use diffmaglim > 19.5\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT *\nFROM non_detection\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND diffmaglim > 19.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all non-detection epochs for the specified ZTF objects\n-- Note: 'fainter' magnitudes correspond to larger numeric values, so we use diffmaglim > 19.5\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT *\nFROM non_detection\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND diffmaglim > 19.5;"
                },
                "in_toks": 2039,
                "out_toks": 622,
                "id": "chatcmpl-CZRAOhVM80EyzzE4nI5qOqEqhiRGu",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "54",
            "experiment_id": "run_9",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 640,
                "out_toks": 397,
                "id": "chatcmpl-CZMZxB2SoSqn51y71QtxlKILQUUCr",
                "created": 1762544309,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all non-detection epochs for the specified OIDs with 5-sigma limits fainter than 19.5 mag (i.e., diffmaglim > 19.5)\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT *\nFROM non_detection\nWHERE oid IN (SELECT oid FROM oids)\n  AND diffmaglim > 19.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all non-detection epochs for the specified OIDs with 5-sigma limits fainter than 19.5 mag (i.e., diffmaglim > 19.5)\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT *\nFROM non_detection\nWHERE oid IN (SELECT oid FROM oids)\n  AND diffmaglim > 19.5;"
                },
                "in_toks": 2039,
                "out_toks": 810,
                "id": "chatcmpl-CZRCiYUMBWeeMqwlZiFbuzmxArska",
                "created": 1762562088,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "99": {
        "0": {
            "req_id": "99",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'forced_photometry']",
                    "1": "['object', 'probability', 'taxonomy', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 1522,
                "id": "chatcmpl-CSnVQJ8DIbVN2NQooz0LrlR4vFlaz",
                "created": 1760979520,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return all forced_photometry rows for up to 10 objects whose first detection (firstmjd) is > 60310\n   and that have probability 1 of being 'asteroid' under the 'stamp_classifier'.\n   Objects are selected and ordered by firstmjd; no JOINs are used, following the guidelines. */\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    /* order rows by the object's first detection date, then by oid and measurement time */\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid),\n    fp.oid,\n    fp.mjd,\n    fp.pid;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return all forced_photometry rows for up to 10 objects whose first detection (firstmjd) is > 60310\n   and that have probability 1 of being 'asteroid' under the 'stamp_classifier'.\n   Objects are selected and ordered by firstmjd; no JOINs are used, following the guidelines. */\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    /* order rows by the object's first detection date, then by oid and measurement time */\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid),\n    fp.oid,\n    fp.mjd,\n    fp.pid;"
                },
                "in_toks": 3318,
                "out_toks": 2233,
                "id": "chatcmpl-CSoKT5kKSylExIPMlgNpnJL6GG1iz",
                "created": 1760982685,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "99",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'forced_photometry']",
                    "1": "['object', 'probability', 'taxonomy', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 1522,
                "id": "chatcmpl-CSnVQJ8DIbVN2NQooz0LrlR4vFlaz",
                "created": 1760979520,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Select up to 10 objects with first detection after MJD 60310 and classified as asteroid with prob=1 and ranking=1 by the stamp_classifier\nWITH selected_oids AS\n  (SELECT o.oid,\n          o.firstmjd\n   FROM OBJECT o\n   WHERE o.firstmjd > 60310\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability = 1\n          AND p.ranking = 1)\n   ORDER BY o.firstmjd\n   LIMIT 10) -- Return all forced_photometry rows for the selected objects, ordered by the object's first detection date, then epoch and pid\n\nSELECT fp.*\nFROM forced_photometry fp\nJOIN selected_oids so ON so.oid = fp.oid\nORDER BY so.firstmjd,\n         fp.mjd,\n         fp.pid;",
            "sql_response": {
                "responses": {
                    "0": "-- Select up to 10 objects with first detection after MJD 60310 and classified as asteroid with prob=1 and ranking=1 by the stamp_classifier\nWITH selected_oids AS\n  (SELECT o.oid,\n          o.firstmjd\n   FROM OBJECT o\n   WHERE o.firstmjd > 60310\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.probability = 1\n          AND p.ranking = 1)\n   ORDER BY o.firstmjd\n   LIMIT 10) -- Return all forced_photometry rows for the selected objects, ordered by the object's first detection date, then epoch and pid\n\nSELECT fp.*\nFROM forced_photometry fp\nJOIN selected_oids so ON so.oid = fp.oid\nORDER BY so.firstmjd,\n         fp.mjd,\n         fp.pid;"
                },
                "in_toks": 2286,
                "out_toks": 1563,
                "id": "chatcmpl-Cb9osNjQ31ReDcViQbn617yvZSP4w",
                "created": 1762971918,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    /* Select up to 10 objects with first detection later than 60310 and classified as asteroid with probability 1 by the stamp classifier */\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT DISTINCT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT so.oid FROM selected_oids so)\n/* Order the results by the object's first detection date, then by epoch and pid for stability */\nORDER BY\n    (SELECT so.firstmjd FROM selected_oids so WHERE so.oid = fp.oid),\n    fp.mjd,\n    fp.pid;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    /* Select up to 10 objects with first detection later than 60310 and classified as asteroid with probability 1 by the stamp classifier */\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT DISTINCT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT so.oid FROM selected_oids so)\n/* Order the results by the object's first detection date, then by epoch and pid for stability */\nORDER BY\n    (SELECT so.firstmjd FROM selected_oids so WHERE so.oid = fp.oid),\n    fp.mjd,\n    fp.pid;"
                },
                "in_toks": 3318,
                "out_toks": 1815,
                "id": "chatcmpl-CSoKmpF3ctSBLngn4FNjfk2T3cyXD",
                "created": 1760982704,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "99",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 598,
                "id": "chatcmpl-CSsetEk5IgK8pUhvBAxQfYeRNq06W",
                "created": 1760999327,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 10 objects with first detection after MJD 60310 and asteroid probability=1 in stamp_classifier,\n-- then return all forced_photometry rows for those objects, ordered by the object's first detection date.\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC, fp.oid, fp.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 10 objects with first detection after MJD 60310 and asteroid probability=1 in stamp_classifier,\n-- then return all forced_photometry rows for those objects, ordered by the object's first detection date.\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC, fp.oid, fp.mjd;"
                },
                "in_toks": 3273,
                "out_toks": 1801,
                "id": "chatcmpl-CSt2lZK2AKqa2gKvSF36BF42fNOz5",
                "created": 1761000807,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "99",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 598,
                "id": "chatcmpl-CSsf3CQ97NyBC0uTwtoYZGb9B1hH8",
                "created": 1760999337,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    /* Get up to 10 objects with first detection after MJD 60310\n       and classified as 'asteroid' with probability 1 by the stamp classifier,\n       ordered by first detection date */\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*  /* Return all forced_photometry columns for the selected objects */\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    /* Order rows by the object's first detection date, then by the photometry MJD */\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC,\n    fp.mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    /* Get up to 10 objects with first detection after MJD 60310\n       and classified as 'asteroid' with probability 1 by the stamp classifier,\n       ordered by first detection date */\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*  /* Return all forced_photometry columns for the selected objects */\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    /* Order rows by the object's first detection date, then by the photometry MJD */\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC,\n    fp.mjd ASC;"
                },
                "in_toks": 3273,
                "out_toks": 1639,
                "id": "chatcmpl-CSt36Ef7zh1iG0VACge6CWtXHr9NM",
                "created": 1761000828,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "99",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 470,
                "id": "chatcmpl-CSsfBu79keGbkGD0LR5Ayc2PsMS7p",
                "created": 1760999345,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Step 1: Preselect up to 10 objects (by earliest firstmjd) with firstmjd > 60310\n-- and with probability=1 for class 'asteroid' from 'stamp_classifier' at ranking=1.\nWITH top10 AS\n  (SELECT o.oid,\n          o.firstmjd\n   FROM OBJECT o\n   WHERE o.firstmjd > 60310\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier' -- classifier condition\n\n          AND p.class_name = 'asteroid' -- class condition\n\n          AND p.ranking = 1 -- ensure top-ranked class\n\n          AND p.probability = 1 -- exact probability requirement\n)\n   ORDER BY o.firstmjd\n   LIMIT 10) -- Step 2: Return all forced_photometry rows for those objects,\n-- ordered by the objects' firstmjd, then by measurement time and pid.\n\nSELECT fp.*\nFROM forced_photometry fp\nJOIN top10 t ON t.oid = fp.oid\nORDER BY t.firstmjd,\n         fp.mjd,\n         fp.pid;",
            "sql_response": {
                "responses": {
                    "0": "-- Step 1: Preselect up to 10 objects (by earliest firstmjd) with firstmjd > 60310\n-- and with probability=1 for class 'asteroid' from 'stamp_classifier' at ranking=1.\nWITH top10 AS\n  (SELECT o.oid,\n          o.firstmjd\n   FROM OBJECT o\n   WHERE o.firstmjd > 60310\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier' -- classifier condition\n\n          AND p.class_name = 'asteroid' -- class condition\n\n          AND p.ranking = 1 -- ensure top-ranked class\n\n          AND p.probability = 1 -- exact probability requirement\n)\n   ORDER BY o.firstmjd\n   LIMIT 10) -- Step 2: Return all forced_photometry rows for those objects,\n-- ordered by the objects' firstmjd, then by measurement time and pid.\n\nSELECT fp.*\nFROM forced_photometry fp\nJOIN top10 t ON t.oid = fp.oid\nORDER BY t.firstmjd,\n         fp.mjd,\n         fp.pid;"
                },
                "in_toks": 2223,
                "out_toks": 1798,
                "id": "chatcmpl-Cb9pPdmSvRoKxg5psIikcURKdl6Jb",
                "created": 1762971951,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all forced_photometry rows for up to 10 objects whose first detection (object.firstmjd) is > 60310\n-- and that have probability=1 of being 'asteroid' in the 'stamp_classifier'.\n-- Objects are chosen and ordered by firstmjd; the output is ordered accordingly.\n\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT DISTINCT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nORDER BY\n  (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid),\n  fp.mjd,\n  fp.pid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all forced_photometry rows for up to 10 objects whose first detection (object.firstmjd) is > 60310\n-- and that have probability=1 of being 'asteroid' in the 'stamp_classifier'.\n-- Objects are chosen and ordered by firstmjd; the output is ordered accordingly.\n\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT DISTINCT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nORDER BY\n  (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid),\n  fp.mjd,\n  fp.pid;"
                },
                "in_toks": 3273,
                "out_toks": 2001,
                "id": "chatcmpl-CSt3PyVAy53xibHk0a5XnQqMdADro",
                "created": 1761000847,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "99",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 470,
                "id": "chatcmpl-CZMaHd7vmUQ37ISTYwWUHavbCUnVA",
                "created": 1762544329,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all forced_photometry rows for at most 10 objects\n-- that have first detections after MJD 60310 and probability 1\n-- of being 'asteroid' in the 'stamp_classifier'.\n-- Objects are selected and ordered by firstmjd in a subquery (no JOINs),\n-- and the final result is ordered by the corresponding object's firstmjd.\nSELECT\n    *\nFROM\n    forced_photometry fp\nWHERE\n    fp.oid IN (\n        SELECT\n            o.oid\n        FROM\n            object o\n        WHERE\n            o.firstmjd > 60310\n            AND o.oid IN (\n                SELECT\n                    p.oid\n                FROM\n                    probability p\n                WHERE\n                    p.classifier_name = 'stamp_classifier'\n                    AND p.class_name = 'asteroid'\n                    AND p.probability = 1\n            )\n        ORDER BY\n            o.firstmjd\n        LIMIT 10\n    )\nORDER BY\n    (SELECT o2.firstmjd FROM object o2 WHERE o2.oid = fp.oid) ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all forced_photometry rows for at most 10 objects\n-- that have first detections after MJD 60310 and probability 1\n-- of being 'asteroid' in the 'stamp_classifier'.\n-- Objects are selected and ordered by firstmjd in a subquery (no JOINs),\n-- and the final result is ordered by the corresponding object's firstmjd.\nSELECT\n    *\nFROM\n    forced_photometry fp\nWHERE\n    fp.oid IN (\n        SELECT\n            o.oid\n        FROM\n            object o\n        WHERE\n            o.firstmjd > 60310\n            AND o.oid IN (\n                SELECT\n                    p.oid\n                FROM\n                    probability p\n                WHERE\n                    p.classifier_name = 'stamp_classifier'\n                    AND p.class_name = 'asteroid'\n                    AND p.probability = 1\n            )\n        ORDER BY\n            o.firstmjd\n        LIMIT 10\n    )\nORDER BY\n    (SELECT o2.firstmjd FROM object o2 WHERE o2.oid = fp.oid) ASC;"
                },
                "in_toks": 3273,
                "out_toks": 2542,
                "id": "chatcmpl-CZRAOoP7pxNarQ7n4ShCIts0YvbPC",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "99",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 790,
                "id": "chatcmpl-CZMakkdMh7Edrz42rNa1fFvDBp7aI",
                "created": 1762544358,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all forced_photometry rows for at most 10 objects\n-- that have firstmjd > 60310 and probability=1 for 'asteroid' in the stamp classifier.\nWITH candidate_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM candidate_oids)\nORDER BY (\n    SELECT o.firstmjd\n    FROM object o\n    WHERE o.oid = fp.oid\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all forced_photometry rows for at most 10 objects\n-- that have firstmjd > 60310 and probability=1 for 'asteroid' in the stamp classifier.\nWITH candidate_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM candidate_oids)\nORDER BY (\n    SELECT o.firstmjd\n    FROM object o\n    WHERE o.oid = fp.oid\n);"
                },
                "in_toks": 3273,
                "out_toks": 1534,
                "id": "chatcmpl-CZRCwyYsbShc863BkFyy2UUBLxQ5e",
                "created": 1762562102,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "99",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 601,
                "id": "chatcmpl-CZMbD0nqUzHvmSGmWh6djCkQIXbBM",
                "created": 1762544387,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 10 objects with first detection after MJD 60310 and probability 1.0 of being 'asteroid' in the stamp classifier,\n-- then return all forced_photometry rows for those objects, ordered by the objects' first detection date.\nWITH selected_oids AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n            AND p.ranking = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT so.oid FROM selected_oids so)\nORDER BY\n    (SELECT so.firstmjd FROM selected_oids so WHERE so.oid = fp.oid) ASC,\n    fp.oid,\n    fp.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 10 objects with first detection after MJD 60310 and probability 1.0 of being 'asteroid' in the stamp classifier,\n-- then return all forced_photometry rows for those objects, ordered by the objects' first detection date.\nWITH selected_oids AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n            AND p.ranking = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT so.oid FROM selected_oids so)\nORDER BY\n    (SELECT so.firstmjd FROM selected_oids so WHERE so.oid = fp.oid) ASC,\n    fp.oid,\n    fp.mjd;"
                },
                "in_toks": 3318,
                "out_toks": 1577,
                "id": "chatcmpl-CZRB2OudTo32AgCQfoXjl1fryfsEV",
                "created": 1762561984,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "99",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 921,
                "id": "chatcmpl-CZMbipY84Y4ZfqtE8pG7NYnuoHkJa",
                "created": 1762544418,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all forced_photometry rows for up to 10 objects whose firstmjd > 60310\n-- and have probability=1 for class 'asteroid' in the 'stamp_classifier'.\n-- Objects are selected and limited in a subquery (CTE) and results are ordered by the object's firstmjd.\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC,\n    fp.mjd ASC,\n    fp.pid ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all forced_photometry rows for up to 10 objects whose firstmjd > 60310\n-- and have probability=1 for class 'asteroid' in the 'stamp_classifier'.\n-- Objects are selected and limited in a subquery (CTE) and results are ordered by the object's firstmjd.\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC,\n    fp.mjd ASC,\n    fp.pid ASC;"
                },
                "in_toks": 3318,
                "out_toks": 2019,
                "id": "chatcmpl-CZRDLUDyejy8kI0JPQnANa1wjKg4m",
                "created": 1762562127,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "99",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 645,
                "out_toks": 598,
                "id": "chatcmpl-CZMc9SuG12dBq7eQVENh0REZHnnbr",
                "created": 1762544445,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 10 objects with first detection later than MJD 60310\n-- and with probability 1 of being 'asteroid' in the 'stamp_classifier'\n-- Then return all forced_photometry rows for those objects,\n-- ordered by the object's first detection date (firstmjd)\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC,\n    fp.oid,\n    fp.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 10 objects with first detection later than MJD 60310\n-- and with probability 1 of being 'asteroid' in the 'stamp_classifier'\n-- Then return all forced_photometry rows for those objects,\n-- ordered by the object's first detection date (firstmjd)\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND o.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'asteroid'\n            AND p.probability = 1\n      )\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_oids)\nORDER BY\n    (SELECT o.firstmjd FROM object o WHERE o.oid = fp.oid) ASC,\n    fp.oid,\n    fp.mjd;"
                },
                "in_toks": 3273,
                "out_toks": 1566,
                "id": "chatcmpl-CZRB2liGTBbCcgcL4lwgcu2KJCnyC",
                "created": 1762561984,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "40": {
        "0": {
            "req_id": "40",
            "experiment_id": "run_0",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 1050,
                "id": "chatcmpl-CSnViDcjNfMpxXKCa0CZ8bCA9KVCP",
                "created": 1760979538,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Cone search of 1 arcsec (1/3600 deg) around RA=23.6488 deg, Dec=30.7314 deg\nSELECT\n    oid_catalog,     -- ALLWISE identifier\n    ra,\n    dec,\n    w1mpro,          -- WISE W1 magnitude\n    w1sigmpro,       -- WISE W1 magnitude uncertainty\n    w2mpro,          -- WISE W2 magnitude\n    w2sigmpro,       -- WISE W2 magnitude uncertainty\n    j_m_2mass,       -- 2MASS J magnitude\n    j_msig_2mass     -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314) ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Cone search of 1 arcsec (1/3600 deg) around RA=23.6488 deg, Dec=30.7314 deg\nSELECT\n    oid_catalog,     -- ALLWISE identifier\n    ra,\n    dec,\n    w1mpro,          -- WISE W1 magnitude\n    w1sigmpro,       -- WISE W1 magnitude uncertainty\n    w2mpro,          -- WISE W2 magnitude\n    w2sigmpro,       -- WISE W2 magnitude uncertainty\n    j_m_2mass,       -- 2MASS J magnitude\n    j_msig_2mass     -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314) ASC;"
                },
                "in_toks": 2624,
                "out_toks": 1239,
                "id": "chatcmpl-CSoFIcUPKBCgj3fiRbdFv7DwA4HFN",
                "created": 1760982364,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "40",
            "experiment_id": "run_1",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 1050,
                "id": "chatcmpl-CSnViDcjNfMpxXKCa0CZ8bCA9KVCP",
                "created": 1760979538,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE sources within 1 arcsec of RA=23.6488 deg, Dec=30.7314 deg\n-- Radius is in degrees; 1 arcsec = 1.0/3600.0 degrees\nSELECT\n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE sources within 1 arcsec of RA=23.6488 deg, Dec=30.7314 deg\n-- Radius is in degrees; 1 arcsec = 1.0/3600.0 degrees\nSELECT\n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314);"
                },
                "in_toks": 2624,
                "out_toks": 1323,
                "id": "chatcmpl-CSoFYtZWS5NAFMbWIwpDnvmVKYWKh",
                "created": 1760982380,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "40",
            "experiment_id": "run_2",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 205,
                "id": "chatcmpl-CSsfId4LJCN0eaIhQ2Fa5VbsgLEsn",
                "created": 1760999352,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE cone search: 1 arcsec (1/3600 deg) around RA=23.6488, Dec=30.7314\nSELECT\n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE cone search: 1 arcsec (1/3600 deg) around RA=23.6488, Dec=30.7314\nSELECT\n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0);"
                },
                "in_toks": 2624,
                "out_toks": 1028,
                "id": "chatcmpl-CSt3tIhmXDl0JaHsDXjnYJZR6O6yl",
                "created": 1761000877,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "40",
            "experiment_id": "run_3",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 333,
                "id": "chatcmpl-CSsfNzLH587X8YGXeHfrmrNkMAoNE",
                "created": 1760999357,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE cone search: 1 arcsec = 1/3600 degrees\nSELECT\n  oid_catalog,\n  ra,\n  dec,\n  w1mpro,\n  w1sigmpro,\n  w2mpro,\n  w2sigmpro,\n  j_m_2mass,\n  j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE cone search: 1 arcsec = 1/3600 degrees\nSELECT\n  oid_catalog,\n  ra,\n  dec,\n  w1mpro,\n  w1sigmpro,\n  w2mpro,\n  w2sigmpro,\n  j_m_2mass,\n  j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0);"
                },
                "in_toks": 2624,
                "out_toks": 1206,
                "id": "chatcmpl-CSt47BVC3ftMHAnEpVRwHAROBDnz0",
                "created": 1761000891,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "40",
            "experiment_id": "run_4",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 205,
                "id": "chatcmpl-CSsfTyMHf0wODXh1YeWrVSo0wcRmk",
                "created": 1760999363,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE sources within 1 arcsec of RA=23.6488 deg, Dec=30.7314 deg\nSELECT\n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE sources within 1 arcsec of RA=23.6488 deg, Dec=30.7314 deg\nSELECT\n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0);"
                },
                "in_toks": 2624,
                "out_toks": 766,
                "id": "chatcmpl-CSt4MQDkkbEifOFqwI5tECRHbBQTH",
                "created": 1761000906,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "40",
            "experiment_id": "run_5",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 205,
                "id": "chatcmpl-CZMcUPuthKP9200Pp8PIBSv3xDJhx",
                "created": 1762544466,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE cone search: 1 arcsec (1/3600 deg) around RA=23.6488, Dec=30.7314\nSELECT\n    oid_catalog,           -- ALLWISE identifier\n    ra,\n    dec,\n    w1mpro,                -- WISE W1 magnitude\n    w1sigmpro,             -- WISE W1 magnitude uncertainty\n    w2mpro,                -- WISE W2 magnitude\n    w2sigmpro,             -- WISE W2 magnitude uncertainty\n    j_m_2mass,             -- 2MASS J magnitude\n    j_msig_2mass           -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE cone search: 1 arcsec (1/3600 deg) around RA=23.6488, Dec=30.7314\nSELECT\n    oid_catalog,           -- ALLWISE identifier\n    ra,\n    dec,\n    w1mpro,                -- WISE W1 magnitude\n    w1sigmpro,             -- WISE W1 magnitude uncertainty\n    w2mpro,                -- WISE W2 magnitude\n    w2sigmpro,             -- WISE W2 magnitude uncertainty\n    j_m_2mass,             -- 2MASS J magnitude\n    j_msig_2mass           -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314);"
                },
                "in_toks": 2624,
                "out_toks": 1301,
                "id": "chatcmpl-CZRDuutrgYyIncbdfLFpyaiUv8uLW",
                "created": 1762562162,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "40",
            "experiment_id": "run_6",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 269,
                "id": "chatcmpl-CZMccpRBioSRFp0AJcEE0zm01ufLz",
                "created": 1762544474,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE cone search: 1 arcsec = 1/3600 degrees\n-- Returns: ALLWISE identifier, coordinates, WISE W1/W2 magnitudes with uncertainties, and 2MASS J magnitude with uncertainty\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM allwise a\nWHERE q3c_radial_query(a.ra, a.dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(a.ra, a.dec, 23.6488, 30.7314) ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE cone search: 1 arcsec = 1/3600 degrees\n-- Returns: ALLWISE identifier, coordinates, WISE W1/W2 magnitudes with uncertainties, and 2MASS J magnitude with uncertainty\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM allwise a\nWHERE q3c_radial_query(a.ra, a.dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(a.ra, a.dec, 23.6488, 30.7314) ASC;"
                },
                "in_toks": 2624,
                "out_toks": 1274,
                "id": "chatcmpl-CZRCAn7zci28VyoAlOX59MSXzwN5A",
                "created": 1762562054,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "40",
            "experiment_id": "run_7",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 269,
                "id": "chatcmpl-CZMcntgmDoy9RdMd8hBCidZDqJlWJ",
                "created": 1762544485,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE cone search of 1 arcsec around RA=23.6488 deg, Dec=30.7314 deg\nWITH params (center_ra, center_dec, radius_deg) AS (\n  VALUES (23.6488::double precision, 30.7314::double precision, 1.0/3600.0)  -- 1 arcsec in degrees\n)\nSELECT\n  a.oid_catalog,     -- identifier in the ALLWISE catalog\n  a.ra,\n  a.dec,\n  a.w1mpro,          -- WISE W1 magnitude\n  a.w1sigmpro,       -- WISE W1 magnitude uncertainty\n  a.w2mpro,          -- WISE W2 magnitude\n  a.w2sigmpro,       -- WISE W2 magnitude uncertainty\n  a.j_m_2mass,       -- 2MASS J magnitude\n  a.j_msig_2mass     -- 2MASS J magnitude uncertainty\nFROM allwise a\nCROSS JOIN params p\nWHERE q3c_radial_query(a.ra, a.dec, p.center_ra, p.center_dec, p.radius_deg)\n;",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE cone search of 1 arcsec around RA=23.6488 deg, Dec=30.7314 deg\nWITH params (center_ra, center_dec, radius_deg) AS (\n  VALUES (23.6488::double precision, 30.7314::double precision, 1.0/3600.0)  -- 1 arcsec in degrees\n)\nSELECT\n  a.oid_catalog,     -- identifier in the ALLWISE catalog\n  a.ra,\n  a.dec,\n  a.w1mpro,          -- WISE W1 magnitude\n  a.w1sigmpro,       -- WISE W1 magnitude uncertainty\n  a.w2mpro,          -- WISE W2 magnitude\n  a.w2sigmpro,       -- WISE W2 magnitude uncertainty\n  a.j_m_2mass,       -- 2MASS J magnitude\n  a.j_msig_2mass     -- 2MASS J magnitude uncertainty\nFROM allwise a\nCROSS JOIN params p\nWHERE q3c_radial_query(a.ra, a.dec, p.center_ra, p.center_dec, p.radius_deg)\n;"
                },
                "in_toks": 2624,
                "out_toks": 1211,
                "id": "chatcmpl-CZREqpOQo47xY8H0NjAfTn5wEQJMl",
                "created": 1762562220,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "40",
            "experiment_id": "run_8",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 269,
                "id": "chatcmpl-CZMcvxBYP8EewZwjyaEKwiQ5JqDBW",
                "created": 1762544493,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE cone search: 1 arcsec (1/3600 deg) around RA=23.6488 deg, Dec=30.7314 deg\n-- Returns identifier, coordinates, and requested magnitudes with uncertainties\nSELECT\n    oid_catalog,    -- ALLWISE identifier\n    ra,\n    dec,\n    w1mpro,         -- WISE W1 magnitude\n    w1sigmpro,      -- WISE W1 magnitude uncertainty\n    w2mpro,         -- WISE W2 magnitude\n    w2sigmpro,      -- WISE W2 magnitude uncertainty\n    j_m_2mass,      -- 2MASS J magnitude\n    j_msig_2mass    -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE cone search: 1 arcsec (1/3600 deg) around RA=23.6488 deg, Dec=30.7314 deg\n-- Returns identifier, coordinates, and requested magnitudes with uncertainties\nSELECT\n    oid_catalog,    -- ALLWISE identifier\n    ra,\n    dec,\n    w1mpro,         -- WISE W1 magnitude\n    w1sigmpro,      -- WISE W1 magnitude uncertainty\n    w2mpro,         -- WISE W2 magnitude\n    w2sigmpro,      -- WISE W2 magnitude uncertainty\n    j_m_2mass,      -- 2MASS J magnitude\n    j_msig_2mass    -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314);"
                },
                "in_toks": 2624,
                "out_toks": 1124,
                "id": "chatcmpl-CZRCHMHD8WhrNIc5b2XO61BZuSnms",
                "created": 1762562061,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "40",
            "experiment_id": "run_9",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 656,
                "out_toks": 269,
                "id": "chatcmpl-CZMd18TDOosdXki63SzP4sSfxN9gf",
                "created": 1762544499,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE sources within 1 arcsec of (RA, Dec) = (23.6488, 30.7314)\n-- 1 arcsec = 1/3600 degrees\nSELECT\n    oid_catalog,       -- Identifier in the ALLWISE catalog\n    ra,\n    dec,\n    w1mpro,            -- WISE W1 magnitude\n    w1sigmpro,         -- WISE W1 magnitude uncertainty\n    w2mpro,            -- WISE W2 magnitude\n    w2sigmpro,         -- WISE W2 magnitude uncertainty\n    j_m_2mass,         -- 2MASS J magnitude\n    j_msig_2mass       -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314) ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE sources within 1 arcsec of (RA, Dec) = (23.6488, 30.7314)\n-- 1 arcsec = 1/3600 degrees\nSELECT\n    oid_catalog,       -- Identifier in the ALLWISE catalog\n    ra,\n    dec,\n    w1mpro,            -- WISE W1 magnitude\n    w1sigmpro,         -- WISE W1 magnitude uncertainty\n    w2mpro,            -- WISE W2 magnitude\n    w2sigmpro,         -- WISE W2 magnitude uncertainty\n    j_m_2mass,         -- 2MASS J magnitude\n    j_msig_2mass       -- 2MASS J magnitude uncertainty\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 1.0/3600.0)\nORDER BY q3c_dist(ra, dec, 23.6488, 30.7314) ASC;"
                },
                "in_toks": 2624,
                "out_toks": 1059,
                "id": "chatcmpl-CZRF0fYTpy7ds22MrwG7lT3tsDaAi",
                "created": 1762562230,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "80": {
        "0": {
            "req_id": "80",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch']",
                    "1": "['object', 'xmatch']"
                },
                "in_toks": 644,
                "out_toks": 480,
                "id": "chatcmpl-CSnVypuAnMjI42qsT6v4WxgTwDO1T",
                "created": 1760979554,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all cross-matches for the specified ZTF objects with distance < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all cross-matches for the specified ZTF objects with distance < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;"
                },
                "in_toks": 2508,
                "out_toks": 656,
                "id": "chatcmpl-CSoFkJcZkahtXxYyrnkYlxlGL9d3r",
                "created": 1760982392,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "80",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch']",
                    "1": "['object', 'xmatch']"
                },
                "in_toks": 644,
                "out_toks": 480,
                "id": "chatcmpl-CSnVypuAnMjI42qsT6v4WxgTwDO1T",
                "created": 1760979554,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all xmatch rows for the specified OIDs with separation < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    -- Obtain valid OIDs from the object table (nested subquery as recommended)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all xmatch rows for the specified OIDs with separation < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    -- Obtain valid OIDs from the object table (nested subquery as recommended)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;"
                },
                "in_toks": 2508,
                "out_toks": 608,
                "id": "chatcmpl-CSoFrhVgq29ObvhrwtecLg4zFE2pE",
                "created": 1760982399,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "80",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch']"
                },
                "in_toks": 644,
                "out_toks": 464,
                "id": "chatcmpl-CSsfWllprHKk4TXA586oWczlKAxSz",
                "created": 1760999366,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all xmatch rows for the two specified ZTF objects where the match distance is < 0.5 arcsec\nWITH target_oids AS (\n    -- Obtain valid OIDs from the object table (subquery as per guidelines)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE dist < 0.5\n  AND oid IN (SELECT oid FROM target_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all xmatch rows for the two specified ZTF objects where the match distance is < 0.5 arcsec\nWITH target_oids AS (\n    -- Obtain valid OIDs from the object table (subquery as per guidelines)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE dist < 0.5\n  AND oid IN (SELECT oid FROM target_oids);"
                },
                "in_toks": 2508,
                "out_toks": 691,
                "id": "chatcmpl-CSsxu7vhIHTnb65bbAGsobny0Gz0Y",
                "created": 1761000506,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "80",
            "experiment_id": "run_3",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 644,
                "out_toks": 653,
                "id": "chatcmpl-CSsfdscW4Cm28wR7FhjxJmyPRZGEt",
                "created": 1760999373,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all xmatch rows for the specified ZTF oids with dist < 0.5 arcsec\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF22abcmmkz'),\n    ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND dist < 0.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all xmatch rows for the specified ZTF oids with dist < 0.5 arcsec\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF22abcmmkz'),\n    ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND dist < 0.5;"
                },
                "in_toks": 2026,
                "out_toks": 667,
                "id": "chatcmpl-CSsy4lLa8devkTbcBse2oi8fNh5PP",
                "created": 1761000516,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "80",
            "experiment_id": "run_4",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 644,
                "out_toks": 525,
                "id": "chatcmpl-CSsfmRf2WB7xw6ZM5BqUMAXmAqdTG",
                "created": 1760999382,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all xmatch rows for the specified OIDs with separation < 0.5 arcsec\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF22abcmmkz'),\n        ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND dist < 0.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all xmatch rows for the specified OIDs with separation < 0.5 arcsec\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF22abcmmkz'),\n        ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND dist < 0.5;"
                },
                "in_toks": 2026,
                "out_toks": 729,
                "id": "chatcmpl-CSsyE8SUnqFK26dl9pqEDiiVUEGaC",
                "created": 1761000526,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "80",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch']"
                },
                "in_toks": 644,
                "out_toks": 464,
                "id": "chatcmpl-CZMdAlMIBNSYDk3suhK8J3fiI1c9F",
                "created": 1762544508,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all xmatch rows for the specified ZTF objects with distance < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all xmatch rows for the specified ZTF objects with distance < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;"
                },
                "in_toks": 2508,
                "out_toks": 592,
                "id": "chatcmpl-CZRCN4dLx2UpK4wYZu8SRJJBR5KcI",
                "created": 1762562067,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "80",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch']"
                },
                "in_toks": 644,
                "out_toks": 400,
                "id": "chatcmpl-CZMdMZLc1lKxwYfsn0pz3WewuXGg2",
                "created": 1762544520,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all xmatch rows for the specified OIDs with dist < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    -- Obtain valid OIDs from the object table (nested subquery as recommended)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all xmatch rows for the specified OIDs with dist < 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    -- Obtain valid OIDs from the object table (nested subquery as recommended)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;"
                },
                "in_toks": 2508,
                "out_toks": 736,
                "id": "chatcmpl-CZRF3ddenuSWVb1iRR5kzulFIMByI",
                "created": 1762562233,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "80",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch']"
                },
                "in_toks": 644,
                "out_toks": 400,
                "id": "chatcmpl-CZMdWRBo3UaK9jo8u5mC4mNhQfWVK",
                "created": 1762544530,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find xmatch rows for the specified ZTF oids with dist < 0.5 arcsec\nWITH target_oids (oid) AS (\n    VALUES \n        ('ZTF22abcmmkz'),\n        ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND dist < 0.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find xmatch rows for the specified ZTF oids with dist < 0.5 arcsec\nWITH target_oids (oid) AS (\n    VALUES \n        ('ZTF22abcmmkz'),\n        ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND dist < 0.5;"
                },
                "in_toks": 2508,
                "out_toks": 602,
                "id": "chatcmpl-CZRCV8Iwucow35zf4ilTZMxVOYzoE",
                "created": 1762562075,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "80",
            "experiment_id": "run_8",
            "pred_tables": [
                "xmatch",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'object']"
                },
                "in_toks": 644,
                "out_toks": 528,
                "id": "chatcmpl-CZMdijr8ytbd4grR0voGIm4Lelmv8",
                "created": 1762544542,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find cross-matches for the specified ZTF objects with separation < 0.5 arcsec, returning all columns */\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    /* Obtain valid OIDs from the object table (nested subquery as recommended) */\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find cross-matches for the specified ZTF objects with separation < 0.5 arcsec, returning all columns */\nSELECT *\nFROM xmatch\nWHERE oid IN (\n    /* Obtain valid OIDs from the object table (nested subquery as recommended) */\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n)\nAND dist < 0.5;"
                },
                "in_toks": 2508,
                "out_toks": 742,
                "id": "chatcmpl-CZRF4Ix93g7mqVwRojfH0G9HFlPRE",
                "created": 1762562234,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "80",
            "experiment_id": "run_9",
            "pred_tables": [
                "xmatch",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'object']"
                },
                "in_toks": 644,
                "out_toks": 784,
                "id": "chatcmpl-CZMe1M3CyGZ65TRkFKTZzsCkWUoAU",
                "created": 1762544561,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find xmatch rows for the given OIDs with distance < 0.5 arcsec (dist is in arcsec per schema)\nWITH selected_oids (oid) AS (\n    VALUES \n        ('ZTF22abcmmkz'),\n        ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM selected_oids)\n  AND dist < 0.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find xmatch rows for the given OIDs with distance < 0.5 arcsec (dist is in arcsec per schema)\nWITH selected_oids (oid) AS (\n    VALUES \n        ('ZTF22abcmmkz'),\n        ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch\nWHERE oid IN (SELECT oid FROM selected_oids)\n  AND dist < 0.5;"
                },
                "in_toks": 2508,
                "out_toks": 672,
                "id": "chatcmpl-CZRCy6jSsqQWWoXssUoLiZFii2M3A",
                "created": 1762562104,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "45": {
        "0": {
            "req_id": "45",
            "experiment_id": "run_0",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 627,
                "out_toks": 861,
                "id": "chatcmpl-CSnW3jIIG21DtCiAuWQVt8JDvEy4W",
                "created": 1760979559,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Count rows per object in dataquality where the reduced chi-square (chipsf) meets a minimum value of 5,\n-- interpreted as a threshold (chipsf >= 5). If you intended exactly 5, change \">= 5\" to \"= 5\".\nWITH target_oids(oid) AS (\n    VALUES ('ZTF23abjikaf'),\n           ('ZTF20achlced')\n)\nSELECT\n    dq.oid,\n    COUNT(*) AS rows_with_chipsf_ge_5\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Count rows per object in dataquality where the reduced chi-square (chipsf) meets a minimum value of 5,\n-- interpreted as a threshold (chipsf >= 5). If you intended exactly 5, change \">= 5\" to \"= 5\".\nWITH target_oids(oid) AS (\n    VALUES ('ZTF23abjikaf'),\n           ('ZTF20achlced')\n)\nSELECT\n    dq.oid,\n    COUNT(*) AS rows_with_chipsf_ge_5\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;"
                },
                "in_toks": 2693,
                "out_toks": 1561,
                "id": "chatcmpl-CSoFyOqGuzWXsxSpOFQLhjqQL0Cbf",
                "created": 1760982406,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "45",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 627,
                "out_toks": 861,
                "id": "chatcmpl-CSnW3jIIG21DtCiAuWQVt8JDvEy4W",
                "created": 1760979559,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Count rows in dataquality for the specified OIDs where the reduced chi-square (chipsf) is at least 5\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF23abjikaf'),\n        ('ZTF20achlced')\n)\nSELECT\n    dq.oid,\n    COUNT(*) AS n_rows\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Count rows in dataquality for the specified OIDs where the reduced chi-square (chipsf) is at least 5\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF23abjikaf'),\n        ('ZTF20achlced')\n)\nSELECT\n    dq.oid,\n    COUNT(*) AS n_rows\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;"
                },
                "in_toks": 3175,
                "out_toks": 1336,
                "id": "chatcmpl-CSoGJCTBidTHbCNLblCE1m1kGiIyb",
                "created": 1760982427,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "45",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 627,
                "out_toks": 272,
                "id": "chatcmpl-CSsfvCsNW65B2LBdADUyWuroIsPPR",
                "created": 1760999391,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Assumption: \"minimum reduced chi-square value of 5\" means a threshold of chipsf >= 5.\n-- If you intended exactly 5, replace the comparison with \"= 5\".\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nSELECT COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Assumption: \"minimum reduced chi-square value of 5\" means a threshold of chipsf >= 5.\n-- If you intended exactly 5, replace the comparison with \"= 5\".\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nSELECT COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5;"
                },
                "in_toks": 3175,
                "out_toks": 1079,
                "id": "chatcmpl-CSsyPBhjVBhRd8lROFOJi0wyE5yUO",
                "created": 1761000537,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "45",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 627,
                "out_toks": 336,
                "id": "chatcmpl-CSsfzAzRyZM2NlztWVKkU0pVlDMQh",
                "created": 1760999395,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Assumption: \"minimum reduced chi-square value of 5\" means a threshold of at least 5 (chipsf >= 5). \n   If you instead mean \"exactly 5\", change the condition to \"chipsf = 5\".\n   If you mean \"rows whose chipsf is the minimum for their object and that minimum equals 5\", see the alternative query below. */\nWITH target_oids AS (\n  SELECT oid FROM (VALUES \n    ('ZTF23abjikaf'),\n    ('ZTF20achlced')\n  ) AS v(oid)\n)\nSELECT COUNT(*) AS n_rows_chipsf_at_least_5\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5;\n\n/* Alternative: count rows where chipsf is the minimum per object and that minimum equals 5.\nWITH target_oids AS (\n  SELECT oid FROM (VALUES \n    ('ZTF23abjikaf'),\n    ('ZTF20achlced')\n  ) AS v(oid)\n)\nSELECT COUNT(*) AS n_rows_min_chipsf_equals_5\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf = 5\n  AND dq.chipsf = (\n    SELECT MIN(dqi.chipsf)\n    FROM dataquality dqi\n    WHERE dqi.oid = dq.oid\n  );\n*/",
            "original_sql_response": {
                "responses": {
                    "0": "/* Assumption: \"minimum reduced chi-square value of 5\" means a threshold of at least 5 (chipsf >= 5). \n   If you instead mean \"exactly 5\", change the condition to \"chipsf = 5\".\n   If you mean \"rows whose chipsf is the minimum for their object and that minimum equals 5\", see the alternative query below. */\nWITH target_oids AS (\n  SELECT oid FROM (VALUES \n    ('ZTF23abjikaf'),\n    ('ZTF20achlced')\n  ) AS v(oid)\n)\nSELECT COUNT(*) AS n_rows_chipsf_at_least_5\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5;\n\n/* Alternative: count rows where chipsf is the minimum per object and that minimum equals 5.\nWITH target_oids AS (\n  SELECT oid FROM (VALUES \n    ('ZTF23abjikaf'),\n    ('ZTF20achlced')\n  ) AS v(oid)\n)\nSELECT COUNT(*) AS n_rows_min_chipsf_equals_5\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf = 5\n  AND dq.chipsf = (\n    SELECT MIN(dqi.chipsf)\n    FROM dataquality dqi\n    WHERE dqi.oid = dq.oid\n  );\n*/"
                },
                "in_toks": 3175,
                "out_toks": 2040,
                "id": "chatcmpl-CSsydKU27QIzGwvJOMPwRscHLZfEH",
                "created": 1761000551,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "45",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 627,
                "out_toks": 336,
                "id": "chatcmpl-CSsg5fTOvjJ00qkzmYS1OW6BdZbqr",
                "created": 1760999401,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Count rows in dataquality for the specified OIDs where the reduced chi-square (chipsf) equals 5\nWITH target_oids AS (\n    SELECT 'ZTF23abjikaf'::varchar AS oid\n    UNION ALL\n    SELECT 'ZTF20achlced'::varchar\n)\nSELECT COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf = 5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Count rows in dataquality for the specified OIDs where the reduced chi-square (chipsf) equals 5\nWITH target_oids AS (\n    SELECT 'ZTF23abjikaf'::varchar AS oid\n    UNION ALL\n    SELECT 'ZTF20achlced'::varchar\n)\nSELECT COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf = 5;"
                },
                "in_toks": 3175,
                "out_toks": 1515,
                "id": "chatcmpl-CSsyx2Wd3gUlLBhrcfTwZf8wRLtIH",
                "created": 1761000571,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "45",
            "experiment_id": "run_5",
            "pred_tables": [
                "dataquality",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality', 'object']"
                },
                "in_toks": 627,
                "out_toks": 464,
                "id": "chatcmpl-CZMeUcvYYQJuFuL72OAVuWcH8JtWy",
                "created": 1762544590,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Count rows in dataquality with reduced chi-square (chipsf) at least 5\n-- for the specified ZTF objects. Interpreting \"minimum reduced chi-square value of 5\"\n-- as a threshold (chipsf >= 5).\nSELECT\n  dq.oid,\n  COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (\n  SELECT o.oid\n  FROM object o\n  WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nAND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Count rows in dataquality with reduced chi-square (chipsf) at least 5\n-- for the specified ZTF objects. Interpreting \"minimum reduced chi-square value of 5\"\n-- as a threshold (chipsf >= 5).\nSELECT\n  dq.oid,\n  COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (\n  SELECT o.oid\n  FROM object o\n  WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nAND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;"
                },
                "in_toks": 3175,
                "out_toks": 1356,
                "id": "chatcmpl-CZRD12hBxsgfhitADgvO9bWYcFec7",
                "created": 1762562107,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "45",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 627,
                "out_toks": 464,
                "id": "chatcmpl-CZMekYtYt47cu0NneQ84VPotfd8ej",
                "created": 1762544606,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Count dataquality rows for the specified ZTF objects where the reduced chi-square (chipsf) meets a minimum threshold of 5\n-- Interpretation: \"minimum reduced chi-square value of 5\" -> chipsf >= 5\nWITH target_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nSELECT dq.oid, COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Count dataquality rows for the specified ZTF objects where the reduced chi-square (chipsf) meets a minimum threshold of 5\n-- Interpretation: \"minimum reduced chi-square value of 5\" -> chipsf >= 5\nWITH target_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nSELECT dq.oid, COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\n  AND dq.chipsf >= 5\nGROUP BY dq.oid\nORDER BY dq.oid;"
                },
                "in_toks": 3175,
                "out_toks": 1620,
                "id": "chatcmpl-CZRDBgk2xPfyQWI01a2GzfA1SBUVa",
                "created": 1762562117,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "45",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 627,
                "out_toks": 336,
                "id": "chatcmpl-CZMew0519kvEEGScn2qn9PfhKIVOn",
                "created": 1762544618,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Count rows in dataquality for the specified OIDs with reduced chi-square (chipsf) at least 5\n-- Interpreting \"minimum reduced chi-square value of 5\" as a threshold chipsf >= 5\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nSELECT COUNT(*) AS row_count_with_chipsf_ge_5\nFROM dataquality\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND chipsf >= 5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Count rows in dataquality for the specified OIDs with reduced chi-square (chipsf) at least 5\n-- Interpreting \"minimum reduced chi-square value of 5\" as a threshold chipsf >= 5\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nSELECT COUNT(*) AS row_count_with_chipsf_ge_5\nFROM dataquality\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND chipsf >= 5;"
                },
                "in_toks": 3175,
                "out_toks": 1728,
                "id": "chatcmpl-CZRDBSRiPnG3YWjxifnBnuNkXCnUK",
                "created": 1762562117,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "45",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 627,
                "out_toks": 400,
                "id": "chatcmpl-CZMf4FqhPr4lf2A3PKTI2RCriRkGN",
                "created": 1762544626,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Assumption: \"minimum reduced chi-square value of 5\" means a lower bound threshold, i.e., chipsf >= 5.\nSELECT COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nAND dq.chipsf >= 5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Assumption: \"minimum reduced chi-square value of 5\" means a lower bound threshold, i.e., chipsf >= 5.\nSELECT COUNT(*) AS row_count\nFROM dataquality dq\nWHERE dq.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nAND dq.chipsf >= 5;"
                },
                "in_toks": 3175,
                "out_toks": 1891,
                "id": "chatcmpl-CZRDJJQHP3KizmNO69ii9egjnBXln",
                "created": 1762562125,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "45",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 627,
                "out_toks": 400,
                "id": "chatcmpl-CZMfCE8WUdRwNHkKup3hp22tOnAMT",
                "created": 1762544634,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Count rows in dataquality for the specified OIDs where the reduced chi-square (chipsf) is at least 5.\n   Interpreting \"minimum reduced chi-square value of 5\" as a threshold: chipsf >= 5. */\nSELECT\n  dq.oid,\n  COUNT(*) AS count_rows_chipsf_ge_5\nFROM dataquality dq\nWHERE dq.oid IN (\n  SELECT o.oid\n  FROM object o\n  WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nAND dq.chipsf >= 5\nGROUP BY dq.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Count rows in dataquality for the specified OIDs where the reduced chi-square (chipsf) is at least 5.\n   Interpreting \"minimum reduced chi-square value of 5\" as a threshold: chipsf >= 5. */\nSELECT\n  dq.oid,\n  COUNT(*) AS count_rows_chipsf_ge_5\nFROM dataquality dq\nWHERE dq.oid IN (\n  SELECT o.oid\n  FROM object o\n  WHERE o.oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n)\nAND dq.chipsf >= 5\nGROUP BY dq.oid;"
                },
                "in_toks": 3175,
                "out_toks": 2253,
                "id": "chatcmpl-CZRDdQx52K1NNDrg6RnAe4h0Qm7LP",
                "created": 1762562145,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "63": {
        "0": {
            "req_id": "63",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['probability', 'object']"
                },
                "in_toks": 639,
                "out_toks": 1120,
                "id": "chatcmpl-CSnWBWt3tfRnf9RIYF0NqCr7RRyXO",
                "created": 1760979567,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier and rankings 1 or 2\nSELECT *\nFROM probability\nWHERE oid IN (\n    -- Obtain OIDs via subquery as recommended\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier and rankings 1 or 2\nSELECT *\nFROM probability\nWHERE oid IN (\n    -- Obtain OIDs via subquery as recommended\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;"
                },
                "in_toks": 2574,
                "out_toks": 1001,
                "id": "chatcmpl-CSoGcyx8oDhi5VnVWtl9tIAG6CkEt",
                "created": 1760982446,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "63",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['probability', 'object']"
                },
                "in_toks": 639,
                "out_toks": 1120,
                "id": "chatcmpl-CSnWBWt3tfRnf9RIYF0NqCr7RRyXO",
                "created": 1760979567,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all probability rows for the specified OIDs, restricted to the Light Curve classifier,\n-- with ranking 1 or 2. Return all columns and sort by ranking.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    -- Obtain valid OIDs from the object table (subquery to optimize main query)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all probability rows for the specified OIDs, restricted to the Light Curve classifier,\n-- with ranking 1 or 2. Return all columns and sort by ranking.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    -- Obtain valid OIDs from the object table (subquery to optimize main query)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;"
                },
                "in_toks": 2574,
                "out_toks": 829,
                "id": "chatcmpl-CSoGmXK4tE0weFhIKYj0IbOcqW2Po",
                "created": 1760982456,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "63",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'object']"
                },
                "in_toks": 639,
                "out_toks": 912,
                "id": "chatcmpl-CSsgBUqokRiEPuN6DuZEmnoVaxFkO",
                "created": 1760999407,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all 'probability' rows for the specified OIDs, restricted to the Light Curve classifier\n-- and rankings 1 or 2. Use a subquery to obtain OIDs from the 'object' table, and sort by ranking.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n      SELECT oid\n      FROM object\n      WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all 'probability' rows for the specified OIDs, restricted to the Light Curve classifier\n-- and rankings 1 or 2. Use a subquery to obtain OIDs from the 'object' table, and sort by ranking.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n      SELECT oid\n      FROM object\n      WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;"
                },
                "in_toks": 2574,
                "out_toks": 1210,
                "id": "chatcmpl-CSszNYivWVgZiQVx5VqBhxueWAhE7",
                "created": 1761000597,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "63",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'object']"
                },
                "in_toks": 639,
                "out_toks": 912,
                "id": "chatcmpl-CSsgOBpBHSyBUEY7tthTbNHtr3DHL",
                "created": 1760999420,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all lc_classifier probabilities with ranking 1 or 2 for the specified ZTF objects\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all lc_classifier probabilities with ranking 1 or 2 for the specified ZTF objects\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY ranking;"
                },
                "in_toks": 2574,
                "out_toks": 1064,
                "id": "chatcmpl-CSszcmUnqOO13XssAPst2wx4qJoid",
                "created": 1761000612,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "63",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'object']"
                },
                "in_toks": 639,
                "out_toks": 912,
                "id": "chatcmpl-CSsgclOTeL34voJcBAlan3aWiRzWy",
                "created": 1760999434,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier\n-- and rankings 1 or 2. OIDs are obtained via a subquery from the object table as recommended.\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier\n-- and rankings 1 or 2. OIDs are obtained via a subquery from the object table as recommended.\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;"
                },
                "in_toks": 2574,
                "out_toks": 815,
                "id": "chatcmpl-CSszoCYCzleyW15tMXikO4S0E3tlj",
                "created": 1761000624,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "63",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 639,
                "out_toks": 784,
                "id": "chatcmpl-CZMfLrDCYSJIWqZIfYRx95iBgVbsa",
                "created": 1762544643,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier, with ranking 1 or 2, sorted by ranking\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier, with ranking 1 or 2, sorted by ranking\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;"
                },
                "in_toks": 2574,
                "out_toks": 803,
                "id": "chatcmpl-CZREBd6A3pOE8Nm4NXeoTtmTWuZSu",
                "created": 1762562179,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "63",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 639,
                "out_toks": 656,
                "id": "chatcmpl-CZMfcUCDOEnCNenxPvfqksj8MudTI",
                "created": 1762544660,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probabilities (all columns) for the requested OIDs,\n-- restricted to the Light Curve classifier and rankings 1 or 2.\n-- OIDs are obtained via a subquery (no JOIN), as requested.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probabilities (all columns) for the requested OIDs,\n-- restricted to the Light Curve classifier and rankings 1 or 2.\n-- OIDs are obtained via a subquery (no JOIN), as requested.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;"
                },
                "in_toks": 2574,
                "out_toks": 693,
                "id": "chatcmpl-CZREbmaJWw0Ee5Y65S0ohQqxhBdbC",
                "created": 1762562205,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "63",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 639,
                "out_toks": 973,
                "id": "chatcmpl-CZMfs2AdD9fT6hyzJkhGfV3XDjqKZ",
                "created": 1762544676,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows for the specified ZTF objects, restricted to the Light Curve classifier,\n-- with ranking 1 or 2, sorted by ranking (ascending).\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n        -- Subquery to define the target OIDs without using JOINs\n        SELECT oid FROM (VALUES\n            ('ZTF21aaobkmg'),\n            ('ZTF21aaomuka')\n        ) AS oids(oid)\n  )\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows for the specified ZTF objects, restricted to the Light Curve classifier,\n-- with ranking 1 or 2, sorted by ranking (ascending).\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n        -- Subquery to define the target OIDs without using JOINs\n        SELECT oid FROM (VALUES\n            ('ZTF21aaobkmg'),\n            ('ZTF21aaomuka')\n        ) AS oids(oid)\n  )\nORDER BY ranking;"
                },
                "in_toks": 2092,
                "out_toks": 1086,
                "id": "chatcmpl-CZREgNuk4HHnX9zUWU7rbrY99Pqjd",
                "created": 1762562210,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "63",
            "experiment_id": "run_8",
            "pred_tables": [
                "probability",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'object']"
                },
                "in_toks": 639,
                "out_toks": 400,
                "id": "chatcmpl-CZMgDCFq45xmQw6IHYt8PQVu1XzhM",
                "created": 1762544697,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier and rankings 1 or 2\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows for the specified OIDs, restricted to the Light Curve classifier and rankings 1 or 2\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n  )\nORDER BY ranking;"
                },
                "in_toks": 2574,
                "out_toks": 1121,
                "id": "chatcmpl-CZRAOUKpBVZvgSpFCB7aj9vk4ncqG",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "63",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability",
                "object",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'object', 'step']"
                },
                "in_toks": 639,
                "out_toks": 1683,
                "id": "chatcmpl-CZMgNe6l3WNbwMCoexFEwWMT1wp4g",
                "created": 1762544707,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows for the specified ZTF objects, light curve classifier, with ranking 1 or 2, sorted by ranking\nSELECT *\nFROM probability\nWHERE oid IN (\n    -- Obtain OIDs via a subquery (avoiding JOINs)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows for the specified ZTF objects, light curve classifier, with ranking 1 or 2, sorted by ranking\nSELECT *\nFROM probability\nWHERE oid IN (\n    -- Obtain OIDs via a subquery (avoiding JOINs)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nORDER BY ranking;"
                },
                "in_toks": 2646,
                "out_toks": 944,
                "id": "chatcmpl-CZRAOAY60wyXdAcq7RSWbvsAw9Oia",
                "created": 1762561944,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "73": {
        "0": {
            "req_id": "73",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 1246,
                "id": "chatcmpl-CSnWO66MbClXTFGq1WFIpECsC3j4m",
                "created": 1760979580,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object identifier (oid), the MPC name (ssnamenr), and the MPC magnitude (ssmagnr)\nSELECT s.oid, s.ssnamenr, s.ssmagnr\nFROM ss_ztf AS s\nWHERE s.oid IN (\n    -- Obtain the target OID in a subquery as recommended\n    SELECT oid\n    FROM (VALUES ('ZTF21acitntz')) AS target(oid)\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object identifier (oid), the MPC name (ssnamenr), and the MPC magnitude (ssmagnr)\nSELECT s.oid, s.ssnamenr, s.ssmagnr\nFROM ss_ztf AS s\nWHERE s.oid IN (\n    -- Obtain the target OID in a subquery as recommended\n    SELECT oid\n    FROM (VALUES ('ZTF21acitntz')) AS target(oid)\n);"
                },
                "in_toks": 2056,
                "out_toks": 1383,
                "id": "chatcmpl-CSoGwxGYCxXJqULyyISoSvGjurum8",
                "created": 1760982466,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "73",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 1246,
                "id": "chatcmpl-CSnWO66MbClXTFGq1WFIpECsC3j4m",
                "created": 1760979580,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object identifier (oid), the MPC name (ssnamenr), and the MPC magnitude (ssmagnr)\nSELECT s.oid, s.ssnamenr, s.ssmagnr\nFROM ss_ztf s\nWHERE s.oid IN (\n    -- Obtain the OID via a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF21acitntz'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object identifier (oid), the MPC name (ssnamenr), and the MPC magnitude (ssmagnr)\nSELECT s.oid, s.ssnamenr, s.ssmagnr\nFROM ss_ztf s\nWHERE s.oid IN (\n    -- Obtain the OID via a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF21acitntz'\n);"
                },
                "in_toks": 2056,
                "out_toks": 811,
                "id": "chatcmpl-CSoHEmA4BWT2gQfukzgs5LVkvuLX0",
                "created": 1760982484,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "73",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 658,
                "id": "chatcmpl-CSsgrnakGhJkdIUspS0mYCybTHbOe",
                "created": 1760999449,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object identifier, MPC name (ssnamenr), and MPC magnitude (ssmagnr)\nSELECT ss.oid, ss.ssnamenr, ss.ssmagnr\nFROM ss_ztf ss\nWHERE ss.oid IN (\n    -- Prioritize obtaining OIDs in a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF21acitntz'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object identifier, MPC name (ssnamenr), and MPC magnitude (ssmagnr)\nSELECT ss.oid, ss.ssnamenr, ss.ssmagnr\nFROM ss_ztf ss\nWHERE ss.oid IN (\n    -- Prioritize obtaining OIDs in a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF21acitntz'\n);"
                },
                "in_toks": 2538,
                "out_toks": 1064,
                "id": "chatcmpl-CSt005ePpOQif21CleODoZ8IKiaf1",
                "created": 1761000636,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "73",
            "experiment_id": "run_3",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 783,
                "id": "chatcmpl-CSsh26wmQBUpVsBt5cdzk4gIxGdVk",
                "created": 1760999460,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object\n-- Filters out rows where ssnamenr is the literal string 'null' or SQL NULL (i.e., not a known solar system object)\nSELECT\n  oid,\n  ssnamenr,\n  ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz'\n  AND ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object\n-- Filters out rows where ssnamenr is the literal string 'null' or SQL NULL (i.e., not a known solar system object)\nSELECT\n  oid,\n  ssnamenr,\n  ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz'\n  AND ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null';"
                },
                "in_toks": 2056,
                "out_toks": 1071,
                "id": "chatcmpl-CSt0E7uWsJqoTQbClDOze3LjeDb2U",
                "created": 1761000650,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "73",
            "experiment_id": "run_4",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 974,
                "id": "chatcmpl-CSshDsEb20r3YA2JxuPEFiCgtl8FP",
                "created": 1760999471,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object identifier, the MPC name, and the MPC magnitude for the nearest known Solar System object\n-- Note: ssnamenr is 'null' (string) if no known Solar System object is associated\nSELECT\n    oid,          -- ZTF object identifier\n    ssnamenr,     -- MPC name of nearest known Solar System object\n    ssmagnr       -- MPC magnitude of nearest known Solar System object\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object identifier, the MPC name, and the MPC magnitude for the nearest known Solar System object\n-- Note: ssnamenr is 'null' (string) if no known Solar System object is associated\nSELECT\n    oid,          -- ZTF object identifier\n    ssnamenr,     -- MPC name of nearest known Solar System object\n    ssmagnr       -- MPC magnitude of nearest known Solar System object\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';"
                },
                "in_toks": 2056,
                "out_toks": 1140,
                "id": "chatcmpl-CSt0PW9XemWpsj4BR7FHie1fZxjJ9",
                "created": 1761000661,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "73",
            "experiment_id": "run_5",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 719,
                "id": "chatcmpl-CZMgztWLk2EHCmDzWvrJWivZDWWJo",
                "created": 1762544745,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object\n-- Filter excludes entries where the MPC name is missing or stored as the literal string 'null'\nSELECT\n    oid,\n    ssnamenr,\n    ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz'\n  AND ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object\n-- Filter excludes entries where the MPC name is missing or stored as the literal string 'null'\nSELECT\n    oid,\n    ssnamenr,\n    ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz'\n  AND ssnamenr IS NOT NULL\n  AND ssnamenr <> 'null';"
                },
                "in_toks": 2056,
                "out_toks": 1189,
                "id": "chatcmpl-CZRBLAKi5sU2YKX2zYCOhdBcl9NOi",
                "created": 1762562003,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "73",
            "experiment_id": "run_6",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 335,
                "id": "chatcmpl-CZMhBxM0w7GLhLtj7GfCuy5bdbSUb",
                "created": 1762544757,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object identifier (oid), the MPC name (ssnamenr), and the MPC magnitude (ssmagnr)\nSELECT oid, ssnamenr, ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object identifier (oid), the MPC name (ssnamenr), and the MPC magnitude (ssmagnr)\nSELECT oid, ssnamenr, ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';"
                },
                "in_toks": 2056,
                "out_toks": 1473,
                "id": "chatcmpl-CZRBTG6jLq4ZZxXiffpaWWU6R5G3S",
                "created": 1762562011,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "73",
            "experiment_id": "run_7",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 399,
                "id": "chatcmpl-CZMhMugP5UtL8Tb4paiYkNUu7jOAv",
                "created": 1762544768,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return ZTF object identifier (oid), MPC name (ssnamenr), and MPC magnitude (ssmagnr) for the nearest known Solar System object */\nSELECT\n    oid,\n    ssnamenr,\n    ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return ZTF object identifier (oid), MPC name (ssnamenr), and MPC magnitude (ssmagnr) for the nearest known Solar System object */\nSELECT\n    oid,\n    ssnamenr,\n    ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';"
                },
                "in_toks": 2056,
                "out_toks": 843,
                "id": "chatcmpl-CZRCgzDKyBuEdPz8nSsy2ten2HvZi",
                "created": 1762562086,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "73",
            "experiment_id": "run_8",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 591,
                "id": "chatcmpl-CZMhVHB1sgxEuxHdP1EogowDSNL2H",
                "created": 1762544777,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object\nSELECT\n    oid,\n    ssnamenr,\n    ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object\nSELECT\n    oid,\n    ssnamenr,\n    ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';"
                },
                "in_toks": 2056,
                "out_toks": 896,
                "id": "chatcmpl-CZRCmfoq68wyNtq6I4vtZ5WDpUSBe",
                "created": 1762562092,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "73",
            "experiment_id": "run_9",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 626,
                "out_toks": 463,
                "id": "chatcmpl-CZMheBsd6K17AZFCmv2XxIM18df50",
                "created": 1762544786,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object identifier (oid), MPC name (ssnamenr), and MPC magnitude (ssmagnr)\nSELECT oid, ssnamenr, ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object identifier (oid), MPC name (ssnamenr), and MPC magnitude (ssmagnr)\nSELECT oid, ssnamenr, ssmagnr\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';"
                },
                "in_toks": 2056,
                "out_toks": 1023,
                "id": "chatcmpl-CZRDMvqPi1tMFMoUW9o7H8X2aoAG5",
                "created": 1762562128,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "92": {
        "0": {
            "req_id": "92",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "magstat",
                "dataquality",
                "probability",
                "taxonomy",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat', 'dataquality', 'probability', 'taxonomy', 'step']",
                    "1": "['object', 'magstat', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 3637,
                "id": "chatcmpl-CSnWYdzKv9foKBKWsdlBCk8G3OJGt",
                "created": 1760979590,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Top-500 ZTF objects (by oid) with >=10 g-band detections and no dubious points,\n-- returning only lc_classifier ranking=1 probabilities\n\nSELECT p.oid,\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN\n    (SELECT DISTINCT oid\n     FROM magstat\n     WHERE fid = 1 -- g band\n\n       AND ndet >= 10 -- at least 10 detections\n\n       AND ndubious = 0 -- no dubious points in this filter\n\n     ORDER BY oid\n     LIMIT 500)\nORDER BY p.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Top-500 ZTF objects (by oid) with >=10 g-band detections and no dubious points,\n-- returning only lc_classifier ranking=1 probabilities\n\nSELECT p.oid,\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN\n    (SELECT DISTINCT oid\n     FROM magstat\n     WHERE fid = 1 -- g band\n\n       AND ndet >= 10 -- at least 10 detections\n\n       AND ndubious = 0 -- no dubious points in this filter\n\n     ORDER BY oid\n     LIMIT 500)\nORDER BY p.oid;"
                },
                "in_toks": 4219,
                "out_toks": 2600,
                "id": "chatcmpl-CayjPi2fn3n1AMaSEqeBpsI1SNLc0",
                "created": 1762929295,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "92",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "magstat",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat', 'dataquality', 'probability', 'taxonomy', 'step']",
                    "1": "['object', 'magstat', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 3637,
                "id": "chatcmpl-CSnWYdzKv9foKBKWsdlBCk8G3OJGt",
                "created": 1760979590,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 500 ZTF objects (by oid) with at least 10 detections in g-band (fid=1) and no dubious points (ndubious=0),\n-- then return their top-ranked (ranking=1) Light Curve classifier ('lc_classifier') results:\nWITH selected_oids AS (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT m.oid\n        FROM magstat m\n        WHERE m.fid = 1               -- g band\n          AND m.ndet >= 10            -- at least 10 detections in g\n          AND m.ndubious = 0          -- no dubious points in that filter\n    ) s\n    ORDER BY oid\n    LIMIT 500\n)\nSELECT p.oid, p.classifier_version, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM selected_oids)\nORDER BY p.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 500 ZTF objects (by oid) with at least 10 detections in g-band (fid=1) and no dubious points (ndubious=0),\n-- then return their top-ranked (ranking=1) Light Curve classifier ('lc_classifier') results:\nWITH selected_oids AS (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT m.oid\n        FROM magstat m\n        WHERE m.fid = 1               -- g band\n          AND m.ndet >= 10            -- at least 10 detections in g\n          AND m.ndubious = 0          -- no dubious points in that filter\n    ) s\n    ORDER BY oid\n    LIMIT 500\n)\nSELECT p.oid, p.classifier_version, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM selected_oids)\nORDER BY p.oid;"
                },
                "in_toks": 3350,
                "out_toks": 2205,
                "id": "chatcmpl-CSoI5GEEZ88QBXCOp7ftysd7VKnMP",
                "created": 1760982537,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "92",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'detection']"
                },
                "in_toks": 653,
                "out_toks": 1691,
                "id": "chatcmpl-CSshRJQb53TYyf7KMp4CUW9n8p9hW",
                "created": 1760999485,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 500 ZTF objects (by oid) that have at least 10 detections in g-band (fid=1) and no dubious points (ndubious=0),\n-- and return only their lc_classifier ranking=1 probabilities: oid, classifier_version, class_name, probability.\nWITH selected_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (\n          SELECT m.oid\n          FROM magstat m\n          WHERE m.fid = 1            -- g band\n            AND m.ndet >= 10         -- minimum 10 detections in g\n            AND m.ndubious = 0       -- no dubious points in that filter\n      )\n    ORDER BY p.oid\n    LIMIT 500\n)\nSELECT p.oid, p.classifier_version, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM selected_oids)\nORDER BY p.oid, p.classifier_version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 500 ZTF objects (by oid) that have at least 10 detections in g-band (fid=1) and no dubious points (ndubious=0),\n-- and return only their lc_classifier ranking=1 probabilities: oid, classifier_version, class_name, probability.\nWITH selected_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (\n          SELECT m.oid\n          FROM magstat m\n          WHERE m.fid = 1            -- g band\n            AND m.ndet >= 10         -- minimum 10 detections in g\n            AND m.ndubious = 0       -- no dubious points in that filter\n      )\n    ORDER BY p.oid\n    LIMIT 500\n)\nSELECT p.oid, p.classifier_version, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM selected_oids)\nORDER BY p.oid, p.classifier_version;"
                },
                "in_toks": 3898,
                "out_toks": 3203,
                "id": "chatcmpl-CSt0eaRpiP8IF6qk2DPhTKpA1Nvcg",
                "created": 1761000676,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "92",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "detection",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 1495,
                "id": "chatcmpl-CSsht05lUTbkkXfv9COSMcP3awjGP",
                "created": 1760999513,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query:\n-- 1) Pre-filter OIDs using probability (lc_classifier, ranking=1) to reduce detection scan.\n-- 2) Among those, keep OIDs with at least 10 g-band detections and zero dubious detections in g.\n-- 3) Return up to 500 OIDs ordered by oid, and output lc_classifier (ranking=1) rows.\n WITH prob_candidates AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier' -- condition 1\n\n     AND p.ranking = 1 -- condition 2\n\n     AND p.probability > 0 -- condition 3 (keeps meaningful probabilities)\n),\n      valid_oids AS\n  (SELECT d.oid\n   FROM detection d\n   JOIN prob_candidates pc USING (oid)\n   WHERE d.fid = 1 -- g band\n\n   GROUP BY d.oid\n   HAVING COUNT(*) >= 10 -- at least 10 g-band detections\n\n   AND SUM(CASE\n               WHEN d.dubious THEN 1\n               ELSE 0\n           END) = 0 -- no dubious detections in g\n),\n      top_oids AS\n  (SELECT vo.oid\n   FROM valid_oids vo\n   ORDER BY vo.oid\n   LIMIT 500)\nSELECT p.oid AS ztf_oid,\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probability p\nJOIN top_oids t ON t.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0\nORDER BY p.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query:\n-- 1) Pre-filter OIDs using probability (lc_classifier, ranking=1) to reduce detection scan.\n-- 2) Among those, keep OIDs with at least 10 g-band detections and zero dubious detections in g.\n-- 3) Return up to 500 OIDs ordered by oid, and output lc_classifier (ranking=1) rows.\n WITH prob_candidates AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier' -- condition 1\n\n     AND p.ranking = 1 -- condition 2\n\n     AND p.probability > 0 -- condition 3 (keeps meaningful probabilities)\n),\n      valid_oids AS\n  (SELECT d.oid\n   FROM detection d\n   JOIN prob_candidates pc USING (oid)\n   WHERE d.fid = 1 -- g band\n\n   GROUP BY d.oid\n   HAVING COUNT(*) >= 10 -- at least 10 g-band detections\n\n   AND SUM(CASE\n               WHEN d.dubious THEN 1\n               ELSE 0\n           END) = 0 -- no dubious detections in g\n),\n      top_oids AS\n  (SELECT vo.oid\n   FROM valid_oids vo\n   ORDER BY vo.oid\n   LIMIT 500)\nSELECT p.oid AS ztf_oid,\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probability p\nJOIN top_oids t ON t.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0\nORDER BY p.oid;"
                },
                "in_toks": 2281,
                "out_toks": 3564,
                "id": "chatcmpl-Cb9q2qwsFefbTJzKP13O7SeNijOuV",
                "created": 1762971990,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 500 ZTF objects (ordered by oid) that:\n--  - have at least 10 detections in the g band (fid=1), and\n--  - have no g-band detections flagged as dubious (interpreting \"no dubious corrections\" as no detections with dubious=true in that filter).\n-- Then, return only lc_classifier probabilities with ranking=1 for those objects.\nWITH filtered_oids AS (\n  SELECT p.oid\n  FROM (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n  ) p\n  WHERE p.oid IN (\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n       AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0\n  )\n  ORDER BY p.oid\n  LIMIT 500\n)\nSELECT p.oid, p.classifier_version, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM filtered_oids)\nORDER BY p.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 500 ZTF objects (ordered by oid) that:\n--  - have at least 10 detections in the g band (fid=1), and\n--  - have no g-band detections flagged as dubious (interpreting \"no dubious corrections\" as no detections with dubious=true in that filter).\n-- Then, return only lc_classifier probabilities with ranking=1 for those objects.\nWITH filtered_oids AS (\n  SELECT p.oid\n  FROM (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n  ) p\n  WHERE p.oid IN (\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n       AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0\n  )\n  ORDER BY p.oid\n  LIMIT 500\n)\nSELECT p.oid, p.classifier_version, p.class_name, p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM filtered_oids)\nORDER BY p.oid;"
                },
                "in_toks": 3181,
                "out_toks": 3550,
                "id": "chatcmpl-CSt1E1xGOrfXVy7QIjLLchahED4Iw",
                "created": 1761000712,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "92",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "taxonomy",
                "step",
                "magstat",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'step', 'magstat', 'detection']"
                },
                "in_toks": 653,
                "out_toks": 2203,
                "id": "chatcmpl-CSsiCKBy00JEWF5JK6U2XX9Y4wNDG",
                "created": 1760999532,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 500 ZTF objects (ordered by oid) with at least 10 detections in g-band (fid=1)\n-- and no dubious points in that band (ndubious=0). Then return rank-1 lc_classifier results.\nWITH target_oids AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1               -- g band\n      AND ndet >= 10            -- at least 10 detections in g\n      AND ndubious = 0          -- no dubious points in g\n    GROUP BY oid\n    ORDER BY oid\n    LIMIT 500\n)\nSELECT\n    p.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM target_oids)\nORDER BY p.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 500 ZTF objects (ordered by oid) with at least 10 detections in g-band (fid=1)\n-- and no dubious points in that band (ndubious=0). Then return rank-1 lc_classifier results.\nWITH target_oids AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1               -- g band\n      AND ndet >= 10            -- at least 10 detections in g\n      AND ndubious = 0          -- no dubious points in g\n    GROUP BY oid\n    ORDER BY oid\n    LIMIT 500\n)\nSELECT\n    p.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM target_oids)\nORDER BY p.oid;"
                },
                "in_toks": 3488,
                "out_toks": 2257,
                "id": "chatcmpl-CSt1jvdRrn0IeD4b4dzt5P3ScMVTC",
                "created": 1761000743,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "92",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "magstat",
                "probability",
                "taxonomy",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat', 'probability', 'taxonomy', 'step']"
                },
                "in_toks": 653,
                "out_toks": 1690,
                "id": "chatcmpl-CZMhvOqZCmtzsbEnqYICBlFYuAxRn",
                "created": 1762544803,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find at most 500 ZTF objects with >=10 detections in g band (fid=1) and no dubious points (ndubious=0),\n-- then return their lc_classifier rank-1 probabilities.\n-- Assumption: \"no dubious corrections\" is interpreted as ndubious=0 in magstat for fid=1.\nWITH g_band_oids AS (\n    SELECT m.oid\n    FROM magstat m\n    WHERE m.fid = 1              -- g band\n      AND m.ndet >= 10           -- at least 10 detections in g\n      AND m.ndubious = 0         -- no dubious points in that filter\n),\nrank1_lc_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM g_band_oids)\n    ORDER BY p.oid               -- order by OID before limiting objects\n    LIMIT 500\n)\nSELECT\n    p.oid,                       -- ZTF identifier\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM rank1_lc_oids)\nORDER BY p.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find at most 500 ZTF objects with >=10 detections in g band (fid=1) and no dubious points (ndubious=0),\n-- then return their lc_classifier rank-1 probabilities.\n-- Assumption: \"no dubious corrections\" is interpreted as ndubious=0 in magstat for fid=1.\nWITH g_band_oids AS (\n    SELECT m.oid\n    FROM magstat m\n    WHERE m.fid = 1              -- g band\n      AND m.ndet >= 10           -- at least 10 detections in g\n      AND m.ndubious = 0         -- no dubious points in that filter\n),\nrank1_lc_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM g_band_oids)\n    ORDER BY p.oid               -- order by OID before limiting objects\n    LIMIT 500\n)\nSELECT\n    p.oid,                       -- ZTF identifier\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT oid FROM rank1_lc_oids)\nORDER BY p.oid;"
                },
                "in_toks": 3422,
                "out_toks": 3053,
                "id": "chatcmpl-CZRDPSSZtcVUNyZXW0DWFjvyeGegb",
                "created": 1762562131,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "92",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'detection']"
                },
                "in_toks": 653,
                "out_toks": 2452,
                "id": "chatcmpl-CZMiOUGCIOv4afrZfGXHnKgW5aVZl",
                "created": 1762544832,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Up to 500 ZTF objects (one row per oid) that:\n--  - have at least 10 detections in g band (fid=1),\n--  - have no dubious detections in g band,\n--  - and include only lc_classifier ranking=1 probabilities.\n-- Optimization:\n--  - Start from probability (filtered to lc_classifier, ranking=1, and valid probability),\n--    then use a correlated EXISTS over detection keyed by oid (only filtering by oid in WHERE)\n--    and compute g-band conditions in HAVING. This avoids scanning the whole detection table by fid.\n\nSELECT DISTINCT ON (p.oid) p.oid AS ztf_identifier,\n                   p.classifier_version,\n                   p.class_name,\n                   p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier' -- required classifier\n\n  AND p.ranking = 1 -- only ranking=1\n\n  AND p.probability >= 0.0 -- keep valid probabilities (3rd condition)\n\n  AND EXISTS\n    (SELECT 1\n     FROM detection d\n     WHERE d.oid = p.oid -- only filter detection by oid (index-friendly)\n\n     GROUP BY d.oid\n     HAVING SUM(CASE\n                    WHEN d.fid = 1 THEN 1\n                    ELSE 0\n                END) >= 10 -- at least 10 g-band detections\n\n     AND SUM(CASE\n                 WHEN d.fid = 1\n                      AND d.dubious THEN 1\n                 ELSE 0\n             END) = 0 -- no dubious in g-band\n)\nORDER BY p.oid,\n         p.classifier_version DESC\nLIMIT 500;",
            "sql_response": {
                "responses": {
                    "0": "-- Up to 500 ZTF objects (one row per oid) that:\n--  - have at least 10 detections in g band (fid=1),\n--  - have no dubious detections in g band,\n--  - and include only lc_classifier ranking=1 probabilities.\n-- Optimization:\n--  - Start from probability (filtered to lc_classifier, ranking=1, and valid probability),\n--    then use a correlated EXISTS over detection keyed by oid (only filtering by oid in WHERE)\n--    and compute g-band conditions in HAVING. This avoids scanning the whole detection table by fid.\n\nSELECT DISTINCT ON (p.oid) p.oid AS ztf_identifier,\n                   p.classifier_version,\n                   p.class_name,\n                   p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier' -- required classifier\n\n  AND p.ranking = 1 -- only ranking=1\n\n  AND p.probability >= 0.0 -- keep valid probabilities (3rd condition)\n\n  AND EXISTS\n    (SELECT 1\n     FROM detection d\n     WHERE d.oid = p.oid -- only filter detection by oid (index-friendly)\n\n     GROUP BY d.oid\n     HAVING SUM(CASE\n                    WHEN d.fid = 1 THEN 1\n                    ELSE 0\n                END) >= 10 -- at least 10 g-band detections\n\n     AND SUM(CASE\n                 WHEN d.fid = 1\n                      AND d.dubious THEN 1\n                 ELSE 0\n             END) = 0 -- no dubious in g-band\n)\nORDER BY p.oid,\n         p.classifier_version DESC\nLIMIT 500;"
                },
                "in_toks": 2009,
                "out_toks": 4128,
                "id": "chatcmpl-Cb9rTIRnr2HaM5ckwU42hAf1NRmxS",
                "created": 1762972079,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 500 ZTF objects (one row per oid) that:\n--  - have at least 10 detections in g band (fid=1),\n--  - have no dubious detections in g band,\n--  - and return only their lc_classifier ranking=1 probability rows.\n-- Notes on ambiguity:\n--  - \u201cno dubious corrections in that filter\u201d is interpreted here as: no g-band detections flagged as dubious (dubious=false for all fid=1 detections).\n--    If instead you want to exclude only detections where both corrected=true AND dubious=true, replace the HAVING SUM(...) condition as indicated below.\n\nWITH eligible_oids AS (\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1  -- g band\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n       AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0\n       -- Alternative (stricter) interpretation of \"dubious corrections\":\n       -- AND SUM(CASE WHEN d.corrected AND d.dubious THEN 1 ELSE 0 END) = 0\n)\nSELECT DISTINCT ON (p.oid)\n    p.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT eo.oid FROM eligible_oids eo)\nORDER BY p.oid, p.classifier_version DESC\nLIMIT 500;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 500 ZTF objects (one row per oid) that:\n--  - have at least 10 detections in g band (fid=1),\n--  - have no dubious detections in g band,\n--  - and return only their lc_classifier ranking=1 probability rows.\n-- Notes on ambiguity:\n--  - \u201cno dubious corrections in that filter\u201d is interpreted here as: no g-band detections flagged as dubious (dubious=false for all fid=1 detections).\n--    If instead you want to exclude only detections where both corrected=true AND dubious=true, replace the HAVING SUM(...) condition as indicated below.\n\nWITH eligible_oids AS (\n    SELECT d.oid\n    FROM detection d\n    WHERE d.fid = 1  -- g band\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n       AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0\n       -- Alternative (stricter) interpretation of \"dubious corrections\":\n       -- AND SUM(CASE WHEN d.corrected AND d.dubious THEN 1 ELSE 0 END) = 0\n)\nSELECT DISTINCT ON (p.oid)\n    p.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.oid IN (SELECT eo.oid FROM eligible_oids eo)\nORDER BY p.oid, p.classifier_version DESC\nLIMIT 500;"
                },
                "in_toks": 2699,
                "out_toks": 3159,
                "id": "chatcmpl-CZREJxgyDf2NL96MKQgLn049QH8JH",
                "created": 1762562187,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "92",
            "experiment_id": "run_7",
            "pred_tables": [
                "detection",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 1940,
                "id": "chatcmpl-CZMjSFsRQazdsspQr3OoNQSaDdAxm",
                "created": 1762544898,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimize by first narrowing to lc_classifier ranking=1 probabilities (p1),\n-- then aggregating detections only for those oids (d_agg).\n-- Avoid filtering detection on anything other than oid by using FILTER in aggregates.\nWITH p1 AS\n  (SELECT oid,\n          classifier_version,\n          class_name,\n          probability\n   FROM probability\n   WHERE classifier_name = 'lc_classifier' -- condition 1 on probability\n\n     AND ranking = 1 -- condition 2 on probability\n\n     AND probability IS NOT NULL -- condition 3 on probability\n),\n     d_agg AS\n  (SELECT d.oid,\n          COUNT(*) FILTER (\n                           WHERE d.fid = 1) AS g_dets,\n          COUNT(*) FILTER (\n                           WHERE d.fid = 1\n                             AND d.dubious) AS g_dubious\n   FROM detection d\n   JOIN p1 ON p1.oid = d.oid\n   GROUP BY d.oid)\nSELECT p1.oid,\n       p1.classifier_version,\n       p1.class_name,\n       p1.probability\nFROM p1\nJOIN d_agg ON d_agg.oid = p1.oid\nWHERE d_agg.g_dets >= 10 -- at least 10 detections in g\n\n  AND d_agg.g_dubious = 0 -- no dubious detections in g\nORDER BY p1.oid\nLIMIT 500;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimize by first narrowing to lc_classifier ranking=1 probabilities (p1),\n-- then aggregating detections only for those oids (d_agg).\n-- Avoid filtering detection on anything other than oid by using FILTER in aggregates.\nWITH p1 AS\n  (SELECT oid,\n          classifier_version,\n          class_name,\n          probability\n   FROM probability\n   WHERE classifier_name = 'lc_classifier' -- condition 1 on probability\n\n     AND ranking = 1 -- condition 2 on probability\n\n     AND probability IS NOT NULL -- condition 3 on probability\n),\n     d_agg AS\n  (SELECT d.oid,\n          COUNT(*) FILTER (\n                           WHERE d.fid = 1) AS g_dets,\n          COUNT(*) FILTER (\n                           WHERE d.fid = 1\n                             AND d.dubious) AS g_dubious\n   FROM detection d\n   JOIN p1 ON p1.oid = d.oid\n   GROUP BY d.oid)\nSELECT p1.oid,\n       p1.classifier_version,\n       p1.class_name,\n       p1.probability\nFROM p1\nJOIN d_agg ON d_agg.oid = p1.oid\nWHERE d_agg.g_dets >= 10 -- at least 10 detections in g\n\n  AND d_agg.g_dubious = 0 -- no dubious detections in g\nORDER BY p1.oid\nLIMIT 500;"
                },
                "in_toks": 1677,
                "out_toks": 2491,
                "id": "chatcmpl-Cb9t7A7mY029kOrzxwkRaqaJHCoDv",
                "created": 1762972181,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with at least 10 g-band (fid=1) detections and no dubious detections in g,\n-- then keep only lc_classifier probabilities with ranking=1, ordered by oid, limited to 500.\nSELECT\n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.oid IN (\n        SELECT d.oid\n        FROM detection d\n        WHERE d.fid = 1\n        GROUP BY d.oid\n        HAVING COUNT(*) >= 10\n           AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0\n    )\nORDER BY p.oid\nLIMIT 500;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with at least 10 g-band (fid=1) detections and no dubious detections in g,\n-- then keep only lc_classifier probabilities with ranking=1, ordered by oid, limited to 500.\nSELECT\n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.oid IN (\n        SELECT d.oid\n        FROM detection d\n        WHERE d.fid = 1\n        GROUP BY d.oid\n        HAVING COUNT(*) >= 10\n           AND SUM(CASE WHEN d.dubious THEN 1 ELSE 0 END) = 0\n    )\nORDER BY p.oid\nLIMIT 500;"
                },
                "in_toks": 2699,
                "out_toks": 2740,
                "id": "chatcmpl-CZRFhIyUsDj3ssohsrBpDDkBxruhU",
                "created": 1762562273,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "92",
            "experiment_id": "run_8",
            "pred_tables": [
                "detection",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'probability', 'taxonomy']"
                },
                "in_toks": 653,
                "out_toks": 1428,
                "id": "chatcmpl-CZMk7Sn4DdYKWq31qZdUyZV6tRTcw",
                "created": 1762544939,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query:\n--  - First filter probability to lc_classifier, ranking=1, and valid probabilities (>=0).\n--  - Then, per candidate oid, check detections only for that oid (no global scan).\n--    Use HAVING with FILTERs to enforce:\n--      * at least 10 g-band detections (fid=1)\n--      * zero dubious detections in g band.\n--  - Order by oid and limit to 500 rows.\n WITH p_filtered AS\n  (SELECT p.oid,\n          p.classifier_version,\n          p.class_name,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier' -- Light Curve classifier\n\n     AND p.ranking = 1 -- only most probable class per classifier version\n\n     AND p.probability >= 0 -- extra selectivity on probability table\n)\nSELECT pf.oid,\n       pf.classifier_version,\n       pf.class_name,\n       pf.probability\nFROM p_filtered pf\nWHERE EXISTS\n    (SELECT 1\n     FROM detection d\n     WHERE d.oid = pf.oid -- only filter by oid in WHERE for performance\n\n     GROUP BY d.oid\n     HAVING COUNT(*) FILTER (\n                             WHERE d.fid = 1) >= 10 -- at least 10 g-band detections\n\n     AND COUNT(*) FILTER (\n                          WHERE d.fid = 1\n                            AND d.dubious) = 0 -- no dubious in g band\n)\nORDER BY pf.oid\nLIMIT 500;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query:\n--  - First filter probability to lc_classifier, ranking=1, and valid probabilities (>=0).\n--  - Then, per candidate oid, check detections only for that oid (no global scan).\n--    Use HAVING with FILTERs to enforce:\n--      * at least 10 g-band detections (fid=1)\n--      * zero dubious detections in g band.\n--  - Order by oid and limit to 500 rows.\n WITH p_filtered AS\n  (SELECT p.oid,\n          p.classifier_version,\n          p.class_name,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier' -- Light Curve classifier\n\n     AND p.ranking = 1 -- only most probable class per classifier version\n\n     AND p.probability >= 0 -- extra selectivity on probability table\n)\nSELECT pf.oid,\n       pf.classifier_version,\n       pf.class_name,\n       pf.probability\nFROM p_filtered pf\nWHERE EXISTS\n    (SELECT 1\n     FROM detection d\n     WHERE d.oid = pf.oid -- only filter by oid in WHERE for performance\n\n     GROUP BY d.oid\n     HAVING COUNT(*) FILTER (\n                             WHERE d.fid = 1) >= 10 -- at least 10 g-band detections\n\n     AND COUNT(*) FILTER (\n                          WHERE d.fid = 1\n                            AND d.dubious) = 0 -- no dubious in g band\n)\nORDER BY pf.oid\nLIMIT 500;"
                },
                "in_toks": 1820,
                "out_toks": 3859,
                "id": "chatcmpl-Cb9tnec28phe3Y9zecwSh99yUuESm",
                "created": 1762972223,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 500 ZTF objects (ordered by oid) that:\n--  - have at least 10 detections in the g band (fid=1)\n--  - have no dubious detections in the g band\n-- Then, return only ranking=1 probabilities from the Light Curve classifier (lc_classifier)\n-- Columns requested: ZTF identifier (oid), classifier_version, class_name, probability\n\nSELECT\n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'   -- Light Curve classifier\n    AND p.ranking = 1                      -- only most probable class per classifier version\n    AND p.oid IN (\n        SELECT d.oid\n        FROM detection d\n        GROUP BY d.oid\n        HAVING\n            COUNT(*) FILTER (WHERE d.fid = 1) >= 10                      -- at least 10 g-band detections\n            AND BOOL_AND(NOT d.dubious) FILTER (WHERE d.fid = 1)         -- no dubious detections in g band\n    )\nORDER BY p.oid\nLIMIT 500;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 500 ZTF objects (ordered by oid) that:\n--  - have at least 10 detections in the g band (fid=1)\n--  - have no dubious detections in the g band\n-- Then, return only ranking=1 probabilities from the Light Curve classifier (lc_classifier)\n-- Columns requested: ZTF identifier (oid), classifier_version, class_name, probability\n\nSELECT\n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'   -- Light Curve classifier\n    AND p.ranking = 1                      -- only most probable class per classifier version\n    AND p.oid IN (\n        SELECT d.oid\n        FROM detection d\n        GROUP BY d.oid\n        HAVING\n            COUNT(*) FILTER (WHERE d.fid = 1) >= 10                      -- at least 10 g-band detections\n            AND BOOL_AND(NOT d.dubious) FILTER (WHERE d.fid = 1)         -- no dubious detections in g band\n    )\nORDER BY p.oid\nLIMIT 500;"
                },
                "in_toks": 2699,
                "out_toks": 3392,
                "id": "chatcmpl-CZRGzmMUcvQTDZN7r85qSfHpKmCId",
                "created": 1762562353,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "92",
            "experiment_id": "run_9",
            "pred_tables": [
                "magstat",
                "dataquality",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat', 'dataquality', 'probability']"
                },
                "in_toks": 653,
                "out_toks": 2069,
                "id": "chatcmpl-CZMkewkXD2jL39PtUI1Vr5CiwRZaZ",
                "created": 1762544972,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 500 objects (by oid) with at least 10 detections in g-band (fid=1) and no dubious points (ndubious=0),\n-- then return their top-1 lc_classifier probability entries.\nSELECT\n    p.oid,                -- ZTF identifier\n    p.classifier_version, -- classifier version\n    p.class_name,         -- class name\n    p.probability         -- probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.oid IN (\n        SELECT oid\n        FROM (\n            SELECT DISTINCT m.oid\n            FROM magstat m\n            WHERE m.fid = 1           -- g band\n              AND m.ndet >= 10        -- minimum 10 detections\n              AND m.ndubious = 0      -- no dubious points in that filter\n            ORDER BY m.oid\n            LIMIT 500                 -- at most 500 objects\n        ) AS oids\n    )\nORDER BY p.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 500 objects (by oid) with at least 10 detections in g-band (fid=1) and no dubious points (ndubious=0),\n-- then return their top-1 lc_classifier probability entries.\nSELECT\n    p.oid,                -- ZTF identifier\n    p.classifier_version, -- classifier version\n    p.class_name,         -- class name\n    p.probability         -- probability\nFROM probability p\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.oid IN (\n        SELECT oid\n        FROM (\n            SELECT DISTINCT m.oid\n            FROM magstat m\n            WHERE m.fid = 1           -- g band\n              AND m.ndet >= 10        -- minimum 10 detections\n              AND m.ndubious = 0      -- no dubious points in that filter\n            ORDER BY m.oid\n            LIMIT 500                 -- at most 500 objects\n        ) AS oids\n    )\nORDER BY p.oid;"
                },
                "in_toks": 3620,
                "out_toks": 2984,
                "id": "chatcmpl-CZRHgfNfsKdAnJpFGpQoFB133VdCL",
                "created": 1762562396,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "102": {
        "0": {
            "req_id": "102",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "taxonomy",
                "allwise",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'allwise', 'magstat']",
                    "1": "['probability', 'allwise', 'magstat', 'taxonomy']"
                },
                "in_toks": 644,
                "out_toks": 3184,
                "id": "chatcmpl-CSnX3KbtvNUUDP0hdZ9lBjFfmn4dw",
                "created": 1760979621,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return all magstat rows for at most 50 distinct ZTF objects that:\n   - have lc_classifier AGN probability > 0.6, and\n   - have WISE W1 magnitude between 12 and 13 in ALLWISE.\n   NOTE: This query assumes that allwise.oid_catalog can be matched to ZTF objects via the same identifier as probability.oid.\n*/\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND EXISTS (\n              SELECT 1\n              FROM allwise aw\n              WHERE aw.oid_catalog = p.oid\n                AND aw.w1mpro BETWEEN 12 AND 13\n          )\n        ORDER BY p.oid\n        LIMIT 50\n    ) oids\n);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return all magstat rows for at most 50 distinct ZTF objects that:\n   - have lc_classifier AGN probability > 0.6, and\n   - have WISE W1 magnitude between 12 and 13 in ALLWISE.\n   NOTE: This query assumes that allwise.oid_catalog can be matched to ZTF objects via the same identifier as probability.oid.\n*/\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND EXISTS (\n              SELECT 1\n              FROM allwise aw\n              WHERE aw.oid_catalog = p.oid\n                AND aw.w1mpro BETWEEN 12 AND 13\n          )\n        ORDER BY p.oid\n        LIMIT 50\n    ) oids\n);"
                },
                "in_toks": 3558,
                "out_toks": 2707,
                "id": "chatcmpl-CSoIUDTZwP4YEUPhXtBEVxI4Xw6yI",
                "created": 1760982562,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "102",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "allwise",
                "magstat",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'allwise', 'magstat']",
                    "1": "['probability', 'allwise', 'magstat', 'taxonomy']"
                },
                "in_toks": 644,
                "out_toks": 3184,
                "id": "chatcmpl-CSnX3KbtvNUUDP0hdZ9lBjFfmn4dw",
                "created": 1760979621,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* \nNOTE: The WISE W1 magnitude constraint requires a link between ZTF objects (probability.oid / magstat.oid) and ALLWISE sources (allwise.oid_catalog). \nIn the provided schema, there is no crossmatch table to connect these, so the W1 filter cannot be applied directly.\nThe query below returns magstat rows for up to 50 ZTF objects that have AGN probability > 0.6 under the lc_classifier.\nIf/when a crossmatch table (e.g., xmatch(oid, oid_catalog)) is available, see the commented template below to include the W1 filter.\n*/\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n        LIMIT 50\n    ) o\n);\n\n/*\n-- Template if a crossmatch table exists (uncomment and adjust table/column names accordingly):\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.oid IN (\n              SELECT xm.oid\n              FROM xmatch xm\n              WHERE xm.oid_catalog IN (\n                  SELECT a.oid_catalog\n                  FROM allwise a\n                  WHERE a.w1mpro BETWEEN 12 AND 13\n              )\n          )\n        LIMIT 50\n    ) o\n);\n*/",
            "original_sql_response": {
                "responses": {
                    "0": "/* \nNOTE: The WISE W1 magnitude constraint requires a link between ZTF objects (probability.oid / magstat.oid) and ALLWISE sources (allwise.oid_catalog). \nIn the provided schema, there is no crossmatch table to connect these, so the W1 filter cannot be applied directly.\nThe query below returns magstat rows for up to 50 ZTF objects that have AGN probability > 0.6 under the lc_classifier.\nIf/when a crossmatch table (e.g., xmatch(oid, oid_catalog)) is available, see the commented template below to include the W1 filter.\n*/\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n        LIMIT 50\n    ) o\n);\n\n/*\n-- Template if a crossmatch table exists (uncomment and adjust table/column names accordingly):\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.oid IN (\n              SELECT xm.oid\n              FROM xmatch xm\n              WHERE xm.oid_catalog IN (\n                  SELECT a.oid_catalog\n                  FROM allwise a\n                  WHERE a.w1mpro BETWEEN 12 AND 13\n              )\n          )\n        LIMIT 50\n    ) o\n);\n*/"
                },
                "in_toks": 3558,
                "out_toks": 3050,
                "id": "chatcmpl-CSoJ4ItQ7oPepk0KoPife946coddZ",
                "created": 1760982598,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "102",
            "experiment_id": "run_2",
            "pred_tables": [
                "magstat",
                "probability",
                "taxonomy",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat', 'probability', 'taxonomy', 'allwise']"
                },
                "in_toks": 644,
                "out_toks": 920,
                "id": "chatcmpl-CSsidU3nIW0bQHQl1RfFrsAcYXP2X",
                "created": 1760999559,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- The WISE W1 constraint cannot be enforced with the provided schema because there is no linkage\n-- between ZTF objects (oid in magstat/probability) and ALLWISE sources (oid_catalog in allwise),\n-- nor are there ZTF object coordinates available to perform a positional cross-match.\n-- The query below applies the lc_classifier AGN probability > 0.6 condition, selects at most 50 distinct\n-- ZTF objects (oids), and returns all columns from magstat for those objects.\n\nWITH candidate_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'AGN'\n      AND probability > 0.6\n    GROUP BY oid\n    LIMIT 50\n)\nSELECT *\nFROM magstat\nWHERE oid IN (SELECT oid FROM candidate_oids)\nORDER BY oid, fid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- The WISE W1 constraint cannot be enforced with the provided schema because there is no linkage\n-- between ZTF objects (oid in magstat/probability) and ALLWISE sources (oid_catalog in allwise),\n-- nor are there ZTF object coordinates available to perform a positional cross-match.\n-- The query below applies the lc_classifier AGN probability > 0.6 condition, selects at most 50 distinct\n-- ZTF objects (oids), and returns all columns from magstat for those objects.\n\nWITH candidate_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND class_name = 'AGN'\n      AND probability > 0.6\n    GROUP BY oid\n    LIMIT 50\n)\nSELECT *\nFROM magstat\nWHERE oid IN (SELECT oid FROM candidate_oids)\nORDER BY oid, fid;"
                },
                "in_toks": 3558,
                "out_toks": 1979,
                "id": "chatcmpl-CSt2PryTbE8hG22gUDo76Co1bL1pJ",
                "created": 1761000785,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "102",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "allwise",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'allwise', 'magstat']"
                },
                "in_toks": 644,
                "out_toks": 789,
                "id": "chatcmpl-CSsipbwqWYg9BJxseNk82WAmOB8Wh",
                "created": 1760999571,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find at most 50 ZTF objects with P(AGN | lc_classifier) > 0.6\n-- and return all magstat rows for those objects.\n-- NOTE: The WISE W1 constraint (12 <= w1mpro <= 13) requires a linkage between ZTF objects and ALLWISE sources.\n-- In the provided schema, there is no table relating magstat/probability.oids to allwise.oid_catalog (e.g., an xmatch table or object coordinates).\n-- Therefore, the W1 magnitude filter cannot be enforced strictly with the given tables.\n-- If such a linkage table existed (e.g., xmatch(oid, oid_catalog)), the W1 filter would be applied inside the OID subquery using nested queries.\n\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          -- AND p.oid IN (  -- Example of how the W1 filter would be applied if a linkage table were available:\n          --     SELECT xm.oid\n          --     FROM xmatch xm\n          --     WHERE xm.oid_catalog IN (\n          --         SELECT a.oid_catalog\n          --         FROM allwise a\n          --         WHERE a.w1mpro BETWEEN 12 AND 13\n          --     )\n          -- )\n        ORDER BY p.oid\n        LIMIT 50\n    ) o\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find at most 50 ZTF objects with P(AGN | lc_classifier) > 0.6\n-- and return all magstat rows for those objects.\n-- NOTE: The WISE W1 constraint (12 <= w1mpro <= 13) requires a linkage between ZTF objects and ALLWISE sources.\n-- In the provided schema, there is no table relating magstat/probability.oids to allwise.oid_catalog (e.g., an xmatch table or object coordinates).\n-- Therefore, the W1 magnitude filter cannot be enforced strictly with the given tables.\n-- If such a linkage table existed (e.g., xmatch(oid, oid_catalog)), the W1 filter would be applied inside the OID subquery using nested queries.\n\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          -- AND p.oid IN (  -- Example of how the W1 filter would be applied if a linkage table were available:\n          --     SELECT xm.oid\n          --     FROM xmatch xm\n          --     WHERE xm.oid_catalog IN (\n          --         SELECT a.oid_catalog\n          --         FROM allwise a\n          --         WHERE a.w1mpro BETWEEN 12 AND 13\n          --     )\n          -- )\n        ORDER BY p.oid\n        LIMIT 50\n    ) o\n);"
                },
                "in_toks": 3513,
                "out_toks": 2959,
                "id": "chatcmpl-CSt2k1Kk3V5GBD7MbaAmOZSTTSJSr",
                "created": 1761000806,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "102",
            "experiment_id": "run_4",
            "pred_tables": [
                "magstat",
                "probability",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat', 'probability', 'allwise']"
                },
                "in_toks": 644,
                "out_toks": 789,
                "id": "chatcmpl-CSsizaq26Am4ca5ViuIgzgrfp87lj",
                "created": 1760999581,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* \nFind at most 50 ZTF objects with:\n- lc_classifier AGN probability > 0.6\n- WISE W1 magnitude between 12 and 13\n\nNotes:\n- We first select up to 50 oids in a subquery (from probability), as recommended.\n- We avoid JOINs and use nested subqueries/CTEs.\n- This query assumes that the ALLWISE identifier (allwise.oid_catalog) can be matched to the ZTF oid. \n  If an explicit crossmatch table is required in your deployment, replace the IN (...) on allwise.oid_catalog\n  with the appropriate subquery that maps ZTF oids to ALLWISE oid_catalog values.\n*/\n\nWITH selected_oids AS (\n  SELECT p.oid\n  FROM probability p\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND p.oid IN (\n      SELECT aw.oid_catalog\n      FROM allwise aw\n      WHERE aw.w1mpro BETWEEN 12 AND 13\n    )\n  GROUP BY p.oid\n  ORDER BY MAX(p.probability) DESC\n  LIMIT 50\n)\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM selected_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "/* \nFind at most 50 ZTF objects with:\n- lc_classifier AGN probability > 0.6\n- WISE W1 magnitude between 12 and 13\n\nNotes:\n- We first select up to 50 oids in a subquery (from probability), as recommended.\n- We avoid JOINs and use nested subqueries/CTEs.\n- This query assumes that the ALLWISE identifier (allwise.oid_catalog) can be matched to the ZTF oid. \n  If an explicit crossmatch table is required in your deployment, replace the IN (...) on allwise.oid_catalog\n  with the appropriate subquery that maps ZTF oids to ALLWISE oid_catalog values.\n*/\n\nWITH selected_oids AS (\n  SELECT p.oid\n  FROM probability p\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND p.oid IN (\n      SELECT aw.oid_catalog\n      FROM allwise aw\n      WHERE aw.w1mpro BETWEEN 12 AND 13\n    )\n  GROUP BY p.oid\n  ORDER BY MAX(p.probability) DESC\n  LIMIT 50\n)\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM selected_oids);"
                },
                "in_toks": 3513,
                "out_toks": 3484,
                "id": "chatcmpl-CSt3MDgZjQ7v8ZHfFhvjPvurdw9t9",
                "created": 1761000844,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "102",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability",
                "taxonomy",
                "allwise",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'allwise', 'magstat']"
                },
                "in_toks": 644,
                "out_toks": 920,
                "id": "chatcmpl-CZMlSUFwW3Yg7L1IKimlBLkm9CDIS",
                "created": 1762545022,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 50 distinct ZTF objects with:\n   - AGN probability > 0.6 from the light curve classifier (lc_classifier)\n   - WISE W1 magnitude between 12 and 13\n   Then return all columns from magstat for those objects.\n\n   Note: The provided schema documents that allwise.oid_catalog is not the same as the ZTF oid in other tables.\n   In the absence of an explicit crossmatch table in the provided schema, this query assumes filtering by\n   comparing magstat.oid against allwise.oid_catalog via nested subqueries.\n*/\nWITH selected_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.oid IN (\n          SELECT aw.oid_catalog\n          FROM allwise aw\n          WHERE aw.w1mpro BETWEEN 12 AND 13\n      )\n    LIMIT 50\n)\nSELECT *\nFROM magstat\nWHERE oid IN (SELECT oid FROM selected_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 50 distinct ZTF objects with:\n   - AGN probability > 0.6 from the light curve classifier (lc_classifier)\n   - WISE W1 magnitude between 12 and 13\n   Then return all columns from magstat for those objects.\n\n   Note: The provided schema documents that allwise.oid_catalog is not the same as the ZTF oid in other tables.\n   In the absence of an explicit crossmatch table in the provided schema, this query assumes filtering by\n   comparing magstat.oid against allwise.oid_catalog via nested subqueries.\n*/\nWITH selected_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.oid IN (\n          SELECT aw.oid_catalog\n          FROM allwise aw\n          WHERE aw.w1mpro BETWEEN 12 AND 13\n      )\n    LIMIT 50\n)\nSELECT *\nFROM magstat\nWHERE oid IN (SELECT oid FROM selected_oids);"
                },
                "in_toks": 3558,
                "out_toks": 2801,
                "id": "chatcmpl-CZRJX105FdnEQzNVWWNCsMyLvsihC",
                "created": 1762562511,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "102",
            "experiment_id": "run_6",
            "pred_tables": [
                "magstat",
                "probability",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat', 'probability', 'allwise']"
                },
                "in_toks": 644,
                "out_toks": 1365,
                "id": "chatcmpl-CZMlnvOkxOr1pnnp1HguUjqH590rh",
                "created": 1762545043,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 50 unique ZTF object oids that:\n   - are classified as AGN by the light curve classifier with probability > 0.6\n   - have an associated ALLWISE entry with 12 <= W1 <= 13\n   NOTE: This assumes probability.oid matches allwise.oid_catalog. If not, a crossmatch table is required. */\nSELECT *\nFROM magstat\nWHERE oid IN\n    (SELECT DISTINCT oid\n     FROM probability\n     WHERE classifier_name = 'lc_classifier'\n       AND class_name = 'AGN'\n       AND probability > 0.6\n       AND oid IN\n         (SELECT oid_catalog\n          FROM allwise\n          WHERE w1mpro BETWEEN 12 AND 13)\n     LIMIT 50);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 50 unique ZTF object oids that:\n   - are classified as AGN by the light curve classifier with probability > 0.6\n   - have an associated ALLWISE entry with 12 <= W1 <= 13\n   NOTE: This assumes probability.oid matches allwise.oid_catalog. If not, a crossmatch table is required. */\nSELECT *\nFROM magstat\nWHERE oid IN\n    (SELECT DISTINCT oid\n     FROM probability\n     WHERE classifier_name = 'lc_classifier'\n       AND class_name = 'AGN'\n       AND probability > 0.6\n       AND oid IN\n         (SELECT oid_catalog\n          FROM allwise\n          WHERE w1mpro BETWEEN 12 AND 13)\n     LIMIT 50);"
                },
                "in_toks": 3513,
                "out_toks": 2281,
                "id": "chatcmpl-Cayjw8IMVpS0s0jMlXG4fdAIclVM4",
                "created": 1762929328,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "102",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability",
                "taxonomy",
                "allwise",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'allwise', 'magstat']"
                },
                "in_toks": 644,
                "out_toks": 792,
                "id": "chatcmpl-CZMmGGfNvNj3ycaORHSMhnufBrrzL",
                "created": 1762545072,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select up to 50 OIDs with AGN probability > 0.6 in lc_classifier and WISE W1 magnitude between 12 and 13\nWITH agn_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6\n     AND p.oid IN\n       (SELECT a.oid_catalog\n        FROM allwise a\n        WHERE a.w1mpro BETWEEN 12 AND 13)\n   LIMIT 50) -- Return all magstat rows for those OIDs\n\nSELECT *\nFROM magstat\nWHERE oid IN\n    (SELECT oid\n     FROM agn_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select up to 50 OIDs with AGN probability > 0.6 in lc_classifier and WISE W1 magnitude between 12 and 13\nWITH agn_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6\n     AND p.oid IN\n       (SELECT a.oid_catalog\n        FROM allwise a\n        WHERE a.w1mpro BETWEEN 12 AND 13)\n   LIMIT 50) -- Return all magstat rows for those OIDs\n\nSELECT *\nFROM magstat\nWHERE oid IN\n    (SELECT oid\n     FROM agn_oids);"
                },
                "in_toks": 3558,
                "out_toks": 2467,
                "id": "chatcmpl-CaykMgtLZZUwkPENJ75Sb8Y0yZ6iw",
                "created": 1762929354,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "102",
            "experiment_id": "run_8",
            "pred_tables": [
                "magstat",
                "probability",
                "taxonomy",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat', 'probability', 'taxonomy', 'allwise']"
                },
                "in_toks": 644,
                "out_toks": 1240,
                "id": "chatcmpl-CZMmYS3yXNpBKoStCDZlH6J1DIMpo",
                "created": 1762545090,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Corrected query:\n   - Removes invalid spatial join to object.ra/dec (not in provided schema).\n   - Applies AGN probability > 0.6 from lc_classifier.\n   - Returns all magstat rows for up to 50 objects.\n   NOTE: The provided schema lacks a link between ZTF oid and ALLWISE oid_catalog,\n         so the W1 (12\u201313) filter cannot be enforced here without a crossmatch table.\n*/ WITH agn_oids AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6),\n        selected_oids AS\n  (SELECT oid\n   FROM agn_oids\n   LIMIT 50)\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN\n    (SELECT oid\n     FROM selected_oids);",
            "sql_response": {
                "responses": {
                    "0": "/* Corrected query:\n   - Removes invalid spatial join to object.ra/dec (not in provided schema).\n   - Applies AGN probability > 0.6 from lc_classifier.\n   - Returns all magstat rows for up to 50 objects.\n   NOTE: The provided schema lacks a link between ZTF oid and ALLWISE oid_catalog,\n         so the W1 (12\u201313) filter cannot be enforced here without a crossmatch table.\n*/ WITH agn_oids AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.6),\n        selected_oids AS\n  (SELECT oid\n   FROM agn_oids\n   LIMIT 50)\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN\n    (SELECT oid\n     FROM selected_oids);"
                },
                "in_toks": 2753,
                "out_toks": 4293,
                "id": "chatcmpl-Cb9uwj2KdOVjgYpcJtwelodouSEhS",
                "created": 1762972294,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 50 ZTF objects with:\n   - lc_classifier AGN probability > 0.6\n   - A spatial match to an ALLWISE source with 12 <= W1 (w1mpro) <= 13\n   Return all magstat rows for those objects.\n   Notes:\n   - Uses a 2 arcsec (2/3600 deg) match radius via q3c_join.\n   - Avoids explicit JOINs per guidance; uses CTEs and nested queries.\n*/\n\nWITH agn_oids AS (\n  SELECT DISTINCT p.oid\n  FROM probability p\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n),\nw1_match_oids AS (\n  SELECT DISTINCT o.oid\n  FROM object o\n  WHERE EXISTS (\n    SELECT 1\n    FROM allwise aw\n    WHERE aw.w1mpro BETWEEN 12 AND 13\n      AND q3c_join(aw.ra, aw.dec, o.ra, o.dec, 2.0/3600.0) -- 2 arcsec in degrees\n  )\n),\nselected_oids AS (\n  SELECT oid\n  FROM agn_oids\n  WHERE oid IN (SELECT oid FROM w1_match_oids)\n  LIMIT 50\n)\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM selected_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 50 ZTF objects with:\n   - lc_classifier AGN probability > 0.6\n   - A spatial match to an ALLWISE source with 12 <= W1 (w1mpro) <= 13\n   Return all magstat rows for those objects.\n   Notes:\n   - Uses a 2 arcsec (2/3600 deg) match radius via q3c_join.\n   - Avoids explicit JOINs per guidance; uses CTEs and nested queries.\n*/\n\nWITH agn_oids AS (\n  SELECT DISTINCT p.oid\n  FROM probability p\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n),\nw1_match_oids AS (\n  SELECT DISTINCT o.oid\n  FROM object o\n  WHERE EXISTS (\n    SELECT 1\n    FROM allwise aw\n    WHERE aw.w1mpro BETWEEN 12 AND 13\n      AND q3c_join(aw.ra, aw.dec, o.ra, o.dec, 2.0/3600.0) -- 2 arcsec in degrees\n  )\n),\nselected_oids AS (\n  SELECT oid\n  FROM agn_oids\n  WHERE oid IN (SELECT oid FROM w1_match_oids)\n  LIMIT 50\n)\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM selected_oids);"
                },
                "in_toks": 3558,
                "out_toks": 3640,
                "id": "chatcmpl-CZRO8C8NNq0MW2dpI6vPleSacQVVV",
                "created": 1762562796,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "102",
            "experiment_id": "run_9",
            "pred_tables": [
                "magstat",
                "probability",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat', 'probability', 'allwise']"
                },
                "in_toks": 644,
                "out_toks": 853,
                "id": "chatcmpl-CZMmyeDCTOflNPSTDX1VBgiCNCy4x",
                "created": 1762545116,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* This query returns up to 50 ZTF objects (by oid) with AGN probability > 0.6 from the light curve classifier and all columns from magstat.\n   NOTE: The requested WISE W1 magnitude filter (12 <= w1mpro <= 13) cannot be applied with the provided schema, because there is no linkage\n   between ZTF objects (oid in magstat/probability) and ALLWISE sources (oid_catalog in allwise). An association table (e.g., xmatch) or object coordinates would be needed. */ WITH eligible_oids AS\n  (SELECT t.oid\n   FROM\n     (SELECT p.oid,\n             MAX(p.probability) AS max_prob\n      FROM probability p\n      WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'AGN'\n        AND p.probability > 0.6\n      GROUP BY p.oid) t\n   ORDER BY t.max_prob DESC\n   LIMIT 50)\nSELECT *\nFROM magstat\nWHERE oid IN\n    (SELECT oid\n     FROM eligible_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "/* This query returns up to 50 ZTF objects (by oid) with AGN probability > 0.6 from the light curve classifier and all columns from magstat.\n   NOTE: The requested WISE W1 magnitude filter (12 <= w1mpro <= 13) cannot be applied with the provided schema, because there is no linkage\n   between ZTF objects (oid in magstat/probability) and ALLWISE sources (oid_catalog in allwise). An association table (e.g., xmatch) or object coordinates would be needed. */ WITH eligible_oids AS\n  (SELECT t.oid\n   FROM\n     (SELECT p.oid,\n             MAX(p.probability) AS max_prob\n      FROM probability p\n      WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'AGN'\n        AND p.probability > 0.6\n      GROUP BY p.oid) t\n   ORDER BY t.max_prob DESC\n   LIMIT 50)\nSELECT *\nFROM magstat\nWHERE oid IN\n    (SELECT oid\n     FROM eligible_oids);"
                },
                "in_toks": 3513,
                "out_toks": 2923,
                "id": "chatcmpl-CaykvDz0snGn6qs2TN4x8yK8UvOUo",
                "created": 1762929389,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "81": {
        "0": {
            "req_id": "81",
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']",
                    "1": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 1506,
                "id": "chatcmpl-CSnXVT1pjL3xiukhiDMxtRVqOenVc",
                "created": 1760979649,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the ZTF object id (oid) and the angular distance (dist) for the ALLWISE source 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the ZTF object id (oid) and the angular distance (dist) for the ALLWISE source 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);"
                },
                "in_toks": 2714,
                "out_toks": 1760,
                "id": "chatcmpl-CSoFJdnxAAQDYBxbJfGFFRzMD2GoW",
                "created": 1760982365,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "81",
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']",
                    "1": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 1506,
                "id": "chatcmpl-CSnXVT1pjL3xiukhiDMxtRVqOenVc",
                "created": 1760979649,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF object identifier (oid) and distance (dist) for the ALLWISE source 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n  SELECT a.oid_catalog\n  FROM allwise a\n  WHERE a.oid_catalog = 'J163603.54-065228.7'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF object identifier (oid) and distance (dist) for the ALLWISE source 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n  SELECT a.oid_catalog\n  FROM allwise a\n  WHERE a.oid_catalog = 'J163603.54-065228.7'\n);"
                },
                "in_toks": 2714,
                "out_toks": 1885,
                "id": "chatcmpl-CSoJZwXmb4mhjeZJC4lZmtOsn6pG3",
                "created": 1760982629,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "81",
            "experiment_id": "run_2",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 465,
                "id": "chatcmpl-CSsjAENLUGEEuUqumNnIDOfQ4ujmc",
                "created": 1760999592,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF object id (oid) and angular distance [arcsec] for the ALLWISE source 'J163603.54-065228.7'\n-- Uses a nested subquery to ensure the source belongs to the ALLWISE catalog without an explicit JOIN.\n-- If your xmatch.catid uses a specific value for ALLWISE (e.g., 'ALLWISE'), you may add: AND x.catid = 'ALLWISE'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT aw.oid_catalog\n    FROM allwise aw\n    WHERE aw.oid_catalog = 'J163603.54-065228.7'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF object id (oid) and angular distance [arcsec] for the ALLWISE source 'J163603.54-065228.7'\n-- Uses a nested subquery to ensure the source belongs to the ALLWISE catalog without an explicit JOIN.\n-- If your xmatch.catid uses a specific value for ALLWISE (e.g., 'ALLWISE'), you may add: AND x.catid = 'ALLWISE'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT aw.oid_catalog\n    FROM allwise aw\n    WHERE aw.oid_catalog = 'J163603.54-065228.7'\n);"
                },
                "in_toks": 2714,
                "out_toks": 1495,
                "id": "chatcmpl-CSt4QyiYYSeCsB2elJuNCQMtWq8bJ",
                "created": 1761000910,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "81",
            "experiment_id": "run_3",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 657,
                "id": "chatcmpl-CSsjG0kmxijWOledgJzkrQakKf1El",
                "created": 1760999598,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF object id (oid) and distance (dist) for the ALLWISE source with designation 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF object id (oid) and distance (dist) for the ALLWISE source with designation 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);"
                },
                "in_toks": 2714,
                "out_toks": 1311,
                "id": "chatcmpl-CSt4l5ktjpegmvU1hqROpl0PtkQut",
                "created": 1761000931,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "81",
            "experiment_id": "run_4",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 785,
                "id": "chatcmpl-CSsjPmFZbDFg3D3rw7jaQgBTsCbQL",
                "created": 1760999607,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ZTF objects matched to the specified ALLWISE source; returns ZTF oid and angular separation (dist, arcsec)\nSELECT x.oid, x.dist\nFROM xmatch AS x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise AS a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ZTF objects matched to the specified ALLWISE source; returns ZTF oid and angular separation (dist, arcsec)\nSELECT x.oid, x.dist\nFROM xmatch AS x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise AS a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);"
                },
                "in_toks": 2714,
                "out_toks": 1561,
                "id": "chatcmpl-CSsxyfOJ6NgM8vwoX6fLA0HqNGi79",
                "created": 1761000510,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "81",
            "experiment_id": "run_5",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 721,
                "id": "chatcmpl-CZMnH5zLiqJZaX8oBZM1UVbKS6YjT",
                "created": 1762545135,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF object id and angular distance (arcsec) for the ALLWISE source 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.catid ILIKE 'allwise%'\n  AND x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF object id and angular distance (arcsec) for the ALLWISE source 'J163603.54-065228.7'\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.catid ILIKE 'allwise%'\n  AND x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n  );"
                },
                "in_toks": 2714,
                "out_toks": 3112,
                "id": "chatcmpl-CZRScYl8wPFybG8LYGSzi5T1yO869",
                "created": 1762563074,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "81",
            "experiment_id": "run_6",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 633,
                "out_toks": 1101,
                "id": "chatcmpl-CZMnXzhOj4kI875Z2DdYe1kORiQwN",
                "created": 1762545151,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF object identifier (oid) and angular separation (dist) for the ALLWISE object id 'J163603.54-065228.7'\nWITH target_oids AS (\n    -- Obtain relevant OIDs first (per guidance to prioritize OIDs via subquery)\n    SELECT DISTINCT oid\n    FROM xmatch\n    WHERE catid = 'ALLWISE'\n      AND oid_catalog = 'J163603.54-065228.7'\n)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM target_oids)\n  AND x.catid = 'ALLWISE'\n  AND x.oid_catalog = 'J163603.54-065228.7';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF object identifier (oid) and angular separation (dist) for the ALLWISE object id 'J163603.54-065228.7'\nWITH target_oids AS (\n    -- Obtain relevant OIDs first (per guidance to prioritize OIDs via subquery)\n    SELECT DISTINCT oid\n    FROM xmatch\n    WHERE catid = 'ALLWISE'\n      AND oid_catalog = 'J163603.54-065228.7'\n)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM target_oids)\n  AND x.catid = 'ALLWISE'\n  AND x.oid_catalog = 'J163603.54-065228.7';"
                },
                "in_toks": 2015,
                "out_toks": 1182,
                "id": "chatcmpl-CZRSmFNcJZUI9m9aHn6iuQVS3f7vT",
                "created": 1762563084,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "81",
            "experiment_id": "run_7",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 785,
                "id": "chatcmpl-CZMnqvEnZvwyzl40qOGeuK9kmH9gc",
                "created": 1762545170,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ZTF object identifier and xmatch distance for the AllWISE source 'J163603.54-065228.7'\nSELECT xm.oid, xm.dist\nFROM xmatch xm\nWHERE xm.oid_catalog = (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ZTF object identifier and xmatch distance for the AllWISE source 'J163603.54-065228.7'\nSELECT xm.oid, xm.dist\nFROM xmatch xm\nWHERE xm.oid_catalog = (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n);"
                },
                "in_toks": 2714,
                "out_toks": 2200,
                "id": "chatcmpl-CZRUeVjuZs8Oz6JaYwR6cEhLsYgBH",
                "created": 1762563200,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "81",
            "experiment_id": "run_8",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 593,
                "id": "chatcmpl-CZMo9l6l5wbNEzYWBYdriieu8ruyr",
                "created": 1762545189,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ZTF objects cross-matched to the specified ALLWISE source, returning ZTF oid and angular distance (arcsec)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.catid ILIKE 'allwise'\n  AND x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- ZTF objects cross-matched to the specified ALLWISE source, returning ZTF oid and angular distance (arcsec)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.catid ILIKE 'allwise'\n  AND x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n  );"
                },
                "in_toks": 2714,
                "out_toks": 2339,
                "id": "chatcmpl-CZRAPf22MQc4WQfkGc09luT9LVMvn",
                "created": 1762561945,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "81",
            "experiment_id": "run_9",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 593,
                "id": "chatcmpl-CZMoYpY1c8guBXWO5ym8cBX5HYmTW",
                "created": 1762545214,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ZTF objects matched to the ALLWISE designation 'J163603.54-065228.7'\n-- Returns: ZTF object identifier (oid) and angular separation (dist, in arcseconds)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n)\nORDER BY x.dist;",
            "original_sql_response": {
                "responses": {
                    "0": "-- ZTF objects matched to the ALLWISE designation 'J163603.54-065228.7'\n-- Returns: ZTF object identifier (oid) and angular separation (dist, in arcseconds)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (\n    SELECT a.oid_catalog\n    FROM allwise a\n    WHERE a.oid_catalog = 'J163603.54-065228.7'\n)\nORDER BY x.dist;"
                },
                "in_toks": 2714,
                "out_toks": 1901,
                "id": "chatcmpl-CZRAP3drPCwhVRwBEPRtpAuiuDx2u",
                "created": 1762561945,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "69": {
        "0": {
            "req_id": "69",
            "experiment_id": "run_0",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']",
                    "1": "['ps1_ztf', 'object']"
                },
                "in_toks": 649,
                "out_toks": 1315,
                "id": "chatcmpl-CSnXj1DfEmnkxGbO5CmsS69y1rAR1",
                "created": 1760979663,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all ps1_ztf rows for the specified ZTF objects where the nearest PS1 source (sgscore1) < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n    ) AS oids(oid)\n)\nAND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all ps1_ztf rows for the specified ZTF objects where the nearest PS1 source (sgscore1) < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n    ) AS oids(oid)\n)\nAND sgscore1 < 0.2;"
                },
                "in_toks": 2672,
                "out_toks": 879,
                "id": "chatcmpl-CSoFgiC3US9OS48laRqbh8bctXZAD",
                "created": 1760982388,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "69",
            "experiment_id": "run_1",
            "pred_tables": [
                "ps1_ztf",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']",
                    "1": "['ps1_ztf', 'object']"
                },
                "in_toks": 649,
                "out_toks": 1315,
                "id": "chatcmpl-CSnXj1DfEmnkxGbO5CmsS69y1rAR1",
                "created": 1760979663,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Rows in ps1_ztf for the specified ZTF object IDs where the nearest PS1 source has sgscore1 < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Obtain OIDs via subquery from the object table (per optimization guidance)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Rows in ps1_ztf for the specified ZTF object IDs where the nearest PS1 source has sgscore1 < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Obtain OIDs via subquery from the object table (per optimization guidance)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;"
                },
                "in_toks": 3154,
                "out_toks": 887,
                "id": "chatcmpl-CSoJsA93K3PaMWE6InPoKbVQnBxDL",
                "created": 1760982648,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "69",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']"
                },
                "in_toks": 649,
                "out_toks": 339,
                "id": "chatcmpl-CSsjaA3wLmp9lqAMwNBLQHjEpMSeI",
                "created": 1760999618,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns from ps1_ztf for the specified ZTF objects\n-- Filter to rows where the nearest source Star/Galaxy score (sgscore1) is < 0.2\n-- Obtain OIDs via a subquery from the object table (avoiding JOINs as per guidance)\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns from ps1_ztf for the specified ZTF objects\n-- Filter to rows where the nearest source Star/Galaxy score (sgscore1) is < 0.2\n-- Obtain OIDs via a subquery from the object table (avoiding JOINs as per guidance)\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;"
                },
                "in_toks": 3154,
                "out_toks": 838,
                "id": "chatcmpl-CSsyLI3xkznWhmZOtl44De3CiXe4o",
                "created": 1761000533,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "69",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']"
                },
                "in_toks": 649,
                "out_toks": 595,
                "id": "chatcmpl-CSsjfRHd01z7rLvq6p2pZW4b1Rwz2",
                "created": 1760999623,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find PS1/ZTF matches for specified OIDs where the nearest source star/galaxy score (sgscore1) is < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Obtain valid OIDs from the object table (avoids joins and follows best practice of nested subqueries)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find PS1/ZTF matches for specified OIDs where the nearest source star/galaxy score (sgscore1) is < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Obtain valid OIDs from the object table (avoids joins and follows best practice of nested subqueries)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;"
                },
                "in_toks": 3154,
                "out_toks": 958,
                "id": "chatcmpl-CSsyWQRv72i4CHcrdIWbYJRbLTyJn",
                "created": 1761000544,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "69",
            "experiment_id": "run_4",
            "pred_tables": [
                "ps1_ztf",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf', 'object']"
                },
                "in_toks": 649,
                "out_toks": 851,
                "id": "chatcmpl-CSsjnNi9M3t2MztCvFC9fFh8GoMYJ",
                "created": 1760999631,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all Pan-STARRS crossmatch rows (ps1_ztf) for the specified ZTF object IDs\n-- where the star/galaxy score of the nearest source (sgscore1) is less than 0.2.\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Obtain the relevant OIDs from the object table (preferred nested lookup)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all Pan-STARRS crossmatch rows (ps1_ztf) for the specified ZTF object IDs\n-- where the star/galaxy score of the nearest source (sgscore1) is less than 0.2.\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Obtain the relevant OIDs from the object table (preferred nested lookup)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND sgscore1 < 0.2;"
                },
                "in_toks": 3154,
                "out_toks": 649,
                "id": "chatcmpl-CSsyiJFr2I3y8vpIjEIRkojMjfyYZ",
                "created": 1761000556,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "69",
            "experiment_id": "run_5",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']"
                },
                "in_toks": 649,
                "out_toks": 464,
                "id": "chatcmpl-CZMyRNJ2jUM7eAWiqvFTdpnF8MewW",
                "created": 1762545827,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all Pan-STARRS crossmatch rows for the specified ZTF objects\n-- where the nearest source star/galaxy score (sgscore1) is < 0.2\nWITH requested_oids(oid) AS (\n    VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n)\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM requested_oids)\n  AND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all Pan-STARRS crossmatch rows for the specified ZTF objects\n-- where the nearest source star/galaxy score (sgscore1) is < 0.2\nWITH requested_oids(oid) AS (\n    VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n)\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM requested_oids)\n  AND sgscore1 < 0.2;"
                },
                "in_toks": 2672,
                "out_toks": 825,
                "id": "chatcmpl-CZRAPatcmsiJ1VgNab4YwZATY368Z",
                "created": 1762561945,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "69",
            "experiment_id": "run_6",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']"
                },
                "in_toks": 649,
                "out_toks": 208,
                "id": "chatcmpl-CZMyaYPOrfsTtMm8LvYvyvPE0qIjs",
                "created": 1762545836,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all ps1_ztf rows for the specified ZTF objects where the nearest PS1 source has a star/galaxy score (sgscore1) < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all ps1_ztf rows for the specified ZTF objects where the nearest PS1 source has a star/galaxy score (sgscore1) < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND sgscore1 < 0.2;"
                },
                "in_toks": 2672,
                "out_toks": 737,
                "id": "chatcmpl-CZRAQPnxszOfmzsrOUSzb77hoBpzb",
                "created": 1762561946,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "69",
            "experiment_id": "run_7",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']"
                },
                "in_toks": 649,
                "out_toks": 272,
                "id": "chatcmpl-CZMygH0EEu8GYp68PdWqDhdoKKL4q",
                "created": 1762545842,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Inline list of requested ZTF object identifiers\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n)\n-- Return all rows in ps1_ztf for those objects where the nearest source S/G score is < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM oids)\n  AND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Inline list of requested ZTF object identifiers\nWITH oids(oid) AS (\n    VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n)\n-- Return all rows in ps1_ztf for those objects where the nearest source S/G score is < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM oids)\n  AND sgscore1 < 0.2;"
                },
                "in_toks": 2672,
                "out_toks": 757,
                "id": "chatcmpl-CZRAQL9VI33rWkhMamnZOG4zklKXd",
                "created": 1762561946,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "69",
            "experiment_id": "run_8",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']"
                },
                "in_toks": 649,
                "out_toks": 400,
                "id": "chatcmpl-CZMyoUXGLkJ4t1Ij6fSK3rJH6AZfy",
                "created": 1762545850,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all PS1-ZTF crossmatch rows for the specified ZTF objects\n-- where the star/galaxy score of the nearest PS1 source (sgscore1) is < 0.2\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF21abstkhj'),\n    ('ZTF22aacqjeb'),\n    ('ZTF21aamwpdf')\n)\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all PS1-ZTF crossmatch rows for the specified ZTF objects\n-- where the star/galaxy score of the nearest PS1 source (sgscore1) is < 0.2\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF21abstkhj'),\n    ('ZTF22aacqjeb'),\n    ('ZTF21aamwpdf')\n)\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND sgscore1 < 0.2;"
                },
                "in_toks": 2672,
                "out_toks": 829,
                "id": "chatcmpl-CZRAz62pawztCRvw7vYP5wpnTHGQ4",
                "created": 1762561981,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "69",
            "experiment_id": "run_9",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']"
                },
                "in_toks": 649,
                "out_toks": 336,
                "id": "chatcmpl-CZMyyf67zbYPmR7iie7K8hhZdFlsQ",
                "created": 1762545860,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all rows in ps1_ztf for the specified objects where the nearest PS1 source has sgscore1 < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n    ) AS oids(oid)\n)\nAND sgscore1 < 0.2;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all rows in ps1_ztf for the specified objects where the nearest PS1 source has sgscore1 < 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n    ) AS oids(oid)\n)\nAND sgscore1 < 0.2;"
                },
                "in_toks": 2672,
                "out_toks": 813,
                "id": "chatcmpl-CZRB5irKf0G6PnSANbIGmiQzZMKCF",
                "created": 1762561987,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "61": {
        "0": {
            "req_id": "61",
            "experiment_id": "run_0",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 282,
                "id": "chatcmpl-CSnXu8SUMXss678kcq9vw9cOwCb0C",
                "created": 1760979674,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 689,
                "id": "chatcmpl-CSoFpTN6qZ8q8JvO2WNSmkkixhxw7",
                "created": 1760982397,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "61",
            "experiment_id": "run_1",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 282,
                "id": "chatcmpl-CSnXu8SUMXss678kcq9vw9cOwCb0C",
                "created": 1760979674,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select at most 30 magstat rows with:\n-- - ndet >= 10 (minimum number of detections)\n-- - magmedian > 19 (fainter means larger magnitude)\n-- - maglast < 17 (brighter means smaller magnitude)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select at most 30 magstat rows with:\n-- - ndet >= 10 (minimum number of detections)\n-- - magmedian > 19 (fainter means larger magnitude)\n-- - maglast < 17 (brighter means smaller magnitude)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 1003,
                "id": "chatcmpl-CSoK5eQKn3Kl04CcyiEaDdhewI9P8",
                "created": 1760982661,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "61",
            "experiment_id": "run_2",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 77,
                "id": "chatcmpl-CSsjz7LcPYO6LP78mt4zM1AWtg3Ju",
                "created": 1760999643,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19; fainter = larger magnitude)\n-- - last difference magnitude brighter than 17 (maglast < 17; brighter = smaller magnitude)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19; fainter = larger magnitude)\n-- - last difference magnitude brighter than 17 (maglast < 17; brighter = smaller magnitude)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 700,
                "id": "chatcmpl-CSsyvEPtcRgJ5zncnfSAiSQMic5mr",
                "created": 1761000569,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "61",
            "experiment_id": "run_3",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 205,
                "id": "chatcmpl-CSsk1Rs3wzd9kjTkg4BaY7Vf7zriy",
                "created": 1760999645,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19; larger mag = fainter)\n-- - last difference magnitude brighter than 17 (maglast < 17; smaller mag = brighter)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19; larger mag = fainter)\n-- - last difference magnitude brighter than 17 (maglast < 17; smaller mag = brighter)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 700,
                "id": "chatcmpl-CSsz41Zr2Ph3LRbNPo3heQhvRCpxY",
                "created": 1761000578,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "61",
            "experiment_id": "run_4",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 77,
                "id": "chatcmpl-CSsk5L4TBbcun8x6CttkZshnuOXLb",
                "created": 1760999649,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 945,
                "id": "chatcmpl-CSszEoYSLbEJhuveoAnK3vrcp8FPX",
                "created": 1761000588,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "61",
            "experiment_id": "run_5",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 205,
                "id": "chatcmpl-CZMz99TDadEU7EW7Y0snjkhS24rp3",
                "created": 1762545871,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 433,
                "id": "chatcmpl-CZRBO53F1dDkLUWMV1lxT2PXDFpLo",
                "created": 1762562006,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "61",
            "experiment_id": "run_6",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 141,
                "id": "chatcmpl-CZMzFQ3627wOJw9jiZmdBZixzFhFd",
                "created": 1762545877,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)\n-- - last difference magnitude brighter than 17 (maglast < 17)\n-- Ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 817,
                "id": "chatcmpl-CZRAPHVTzjdulcbZUCMB0SFdmznmh",
                "created": 1762561945,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "61",
            "experiment_id": "run_7",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 141,
                "id": "chatcmpl-CZMzJV7pBR6dyTUFb4oZ7qy5EftXP",
                "created": 1762545881,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19; fainter means larger magnitude)\n-- - last difference magnitude brighter than 17 (maglast < 17; brighter means smaller magnitude)\n-- Results ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19; fainter means larger magnitude)\n-- - last difference magnitude brighter than 17 (maglast < 17; brighter means smaller magnitude)\n-- Results ordered by object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 701,
                "id": "chatcmpl-CZRBkLTVpSYPuUiT7rrpm7zaPza76",
                "created": 1762562028,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "61",
            "experiment_id": "run_8",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 141,
                "id": "chatcmpl-CZMzO2JN6KSxKGOoYG5lnhtm3Pql8",
                "created": 1762545886,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)  -- fainter = larger magnitude\n-- - last difference magnitude brighter than 17 (maglast < 17)     -- brighter = smaller magnitude\n-- Ordered by the object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 magstat rows with:\n-- - at least 10 detections (ndet >= 10)\n-- - median difference magnitude fainter than 19 (magmedian > 19)  -- fainter = larger magnitude\n-- - last difference magnitude brighter than 17 (maglast < 17)     -- brighter = smaller magnitude\n-- Ordered by the object identifier (oid)\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 1153,
                "id": "chatcmpl-CZRAQX1F0yQoAV34MNzLR4BivajzE",
                "created": 1762561946,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "61",
            "experiment_id": "run_9",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 634,
                "out_toks": 269,
                "id": "chatcmpl-CZMzSVSK4K8ZAsQf5VYuVGf3Y8E1O",
                "created": 1762545890,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 magstat rows with ndet >= 10, median diff mag fainter than 19 (magmedian > 19),\n-- and last diff mag brighter than 17 (maglast < 17). Order by object identifier (oid).\n\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 magstat rows with ndet >= 10, median diff mag fainter than 19 (magmedian > 19),\n-- and last diff mag brighter than 17 (maglast < 17). Order by object identifier (oid).\n\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n  AND magmedian > 19\n  AND maglast < 17\nORDER BY oid\nLIMIT 30;"
                },
                "in_toks": 2631,
                "out_toks": 1188,
                "id": "chatcmpl-CaylWFbr0upJVUgbOhu9o8hul9HzZ",
                "created": 1762929426,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "104": {
        "0": {
            "req_id": "104",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "taxonomy",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'detection', 'ss_ztf']",
                    "1": "['probability', 'taxonomy', 'detection', 'ss_ztf']"
                },
                "in_toks": 682,
                "out_toks": 4596,
                "id": "chatcmpl-CSnXy7HC7HeUlhNuT0qKZJD6snUI6",
                "created": 1760979678,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Find up to 30 ZTF objects with asteroid probability > 0.9 using the specified classifier version.\n-- Optimization:\n--  - Filter and LIMIT in a CTE to reduce the join size early.\n--  - Enforce ranking=1 per guidelines to narrow results further.\n--  - Use explicit JOINs instead of scalar subqueries.\nWITH prob_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT s.oid, -- ZTF object identifier\n s.candid, -- candidate identifier\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude\n s.ssnamenr, -- MPC name\n d.fid, -- filter identifier (1=g; 2=r; 3=i)\n NULL::DOUBLE PRECISION AS fwhm_sextractor, -- not available in provided schema\n NULL::INTEGER AS n_ps1_calibrators, -- not available in provided schema\n NULL::DOUBLE PRECISION AS exposure_time -- not available in provided schema\nFROM prob_oids po\nJOIN ss_ztf s ON s.oid = po.oid\nLEFT JOIN detection d ON d.candid = s.candid;",
            "sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with asteroid probability > 0.9 using the specified classifier version.\n-- Optimization:\n--  - Filter and LIMIT in a CTE to reduce the join size early.\n--  - Enforce ranking=1 per guidelines to narrow results further.\n--  - Use explicit JOINs instead of scalar subqueries.\nWITH prob_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT s.oid, -- ZTF object identifier\n s.candid, -- candidate identifier\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude\n s.ssnamenr, -- MPC name\n d.fid, -- filter identifier (1=g; 2=r; 3=i)\n NULL::DOUBLE PRECISION AS fwhm_sextractor, -- not available in provided schema\n NULL::INTEGER AS n_ps1_calibrators, -- not available in provided schema\n NULL::DOUBLE PRECISION AS exposure_time -- not available in provided schema\nFROM prob_oids po\nJOIN ss_ztf s ON s.oid = po.oid\nLEFT JOIN detection d ON d.candid = s.candid;"
                },
                "in_toks": 2080,
                "out_toks": 2718,
                "id": "chatcmpl-Cb9wIzkDj1BdwCQ2VmgxGrs6ycyic",
                "created": 1762972378,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects with asteroid probability > 0.9 in stamp_classifier version 'stamp_classifier_1.0.4'\n-- Return ZTF identifier (oid), candidate id (candid), nearest SS object distance, MPC magnitude, name,\n-- plus candidate-related columns: filter id (fid), and placeholders for unavailable fields (FWHM, PS1 calibrators, exposure time).\nWITH prob_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    s.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    (SELECT d.fid FROM detection d WHERE d.candid = s.candid) AS fid,\n    NULL::DOUBLE PRECISION AS fwhm,               -- Not available in the provided schema\n    NULL::INTEGER AS n_ps1_calibrators,           -- Not available in the provided schema\n    NULL::DOUBLE PRECISION AS exposure_time       -- Not available in the provided schema\nFROM ss_ztf s\nWHERE s.oid IN (SELECT oid FROM prob_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with asteroid probability > 0.9 in stamp_classifier version 'stamp_classifier_1.0.4'\n-- Return ZTF identifier (oid), candidate id (candid), nearest SS object distance, MPC magnitude, name,\n-- plus candidate-related columns: filter id (fid), and placeholders for unavailable fields (FWHM, PS1 calibrators, exposure time).\nWITH prob_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    s.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    (SELECT d.fid FROM detection d WHERE d.candid = s.candid) AS fid,\n    NULL::DOUBLE PRECISION AS fwhm,               -- Not available in the provided schema\n    NULL::INTEGER AS n_ps1_calibrators,           -- Not available in the provided schema\n    NULL::DOUBLE PRECISION AS exposure_time       -- Not available in the provided schema\nFROM ss_ztf s\nWHERE s.oid IN (SELECT oid FROM prob_oids);"
                },
                "in_toks": 2890,
                "out_toks": 3316,
                "id": "chatcmpl-CSoFxDylDzlQ8FCPUzADETKdZINSn",
                "created": 1760982405,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "104",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "taxonomy",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'detection', 'ss_ztf']",
                    "1": "['probability', 'taxonomy', 'detection', 'ss_ztf']"
                },
                "in_toks": 682,
                "out_toks": 4596,
                "id": "chatcmpl-CSnXy7HC7HeUlhNuT0qKZJD6snUI6",
                "created": 1760979678,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Select up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9 and ranking=1\n-- Return object/candidate IDs, Solar System nearest-object info, and candidate-related columns.\n-- Note: FWHM (SExtractor), PS1 calibrators, and exposure time are not in the provided schema; returned as NULLs.\n WITH top_oids AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT ss.oid, -- ZTF object identifier\n ss.candid, -- candidate identifier\n ss.ssdistnr, -- distance to nearest Solar System object\n ss.ssmagnr, -- MPC archive magnitude\n ss.ssnamenr, -- name of nearest Solar System object\n d.fid, -- filter identifier\n NULL::double precision AS fwhm_sextractor, -- not available in provided schema\n NULL::integer AS n_ps1_calibrators, -- not available in provided schema\n NULL::double precision AS exptime -- not available in provided schema\nFROM top_oids t\nJOIN ss_ztf ss ON ss.oid = t.oid\nLEFT JOIN detection d ON d.candid = ss.candid\nAND d.oid = ss.oid\nORDER BY t.probability DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Select up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9 and ranking=1\n-- Return object/candidate IDs, Solar System nearest-object info, and candidate-related columns.\n-- Note: FWHM (SExtractor), PS1 calibrators, and exposure time are not in the provided schema; returned as NULLs.\n WITH top_oids AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT ss.oid, -- ZTF object identifier\n ss.candid, -- candidate identifier\n ss.ssdistnr, -- distance to nearest Solar System object\n ss.ssmagnr, -- MPC archive magnitude\n ss.ssnamenr, -- name of nearest Solar System object\n d.fid, -- filter identifier\n NULL::double precision AS fwhm_sextractor, -- not available in provided schema\n NULL::integer AS n_ps1_calibrators, -- not available in provided schema\n NULL::double precision AS exptime -- not available in provided schema\nFROM top_oids t\nJOIN ss_ztf ss ON ss.oid = t.oid\nLEFT JOIN detection d ON d.candid = ss.candid\nAND d.oid = ss.oid\nORDER BY t.probability DESC;"
                },
                "in_toks": 2307,
                "out_toks": 3445,
                "id": "chatcmpl-Cb9x8IGb2tMqO8qnW0Vf7pMrlzl75",
                "created": 1762972430,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9,\n-- returning object and candidate identifiers, Solar System nearest-object info,\n-- and candidate-related columns. We avoid joins and prioritize OID selection\n-- via a subquery, per the provided guidelines.\n-- Note: The requested candidate fields \"FWHM from SExtractor\", \"number of PS1 calibrators\",\n-- and \"exposure time\" are not present in the provided schema; they are returned as NULLs.\n\nSELECT\n    ss.oid AS oid,                          -- ZTF object identifier\n    ss.candid AS candid,                    -- candidate identifier\n    ss.ssdistnr AS ssdistnr,                -- distance to nearest Solar System object\n    ss.ssmagnr AS ssmagnr,                  -- MPC archive magnitude\n    ss.ssnamenr AS ssnamenr,                -- name of nearest Solar System object\n    -- Candidate-related columns from detection (via candidate ID):\n    (SELECT d.fid FROM detection d WHERE d.candid = ss.candid AND d.oid = ss.oid) AS fid,  -- filter identifier\n    -- Columns requested by the user but not available in the provided schema:\n    NULL::DOUBLE PRECISION AS fwhm,                 -- FWHM from SExtractor (not in schema)\n    NULL::INTEGER AS n_ps1_calibrators,             -- number of PS1 calibrators used (not in schema)\n    NULL::DOUBLE PRECISION AS exptime               -- exposure time (not in schema)\nFROM ss_ztf ss\nWHERE ss.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9,\n-- returning object and candidate identifiers, Solar System nearest-object info,\n-- and candidate-related columns. We avoid joins and prioritize OID selection\n-- via a subquery, per the provided guidelines.\n-- Note: The requested candidate fields \"FWHM from SExtractor\", \"number of PS1 calibrators\",\n-- and \"exposure time\" are not present in the provided schema; they are returned as NULLs.\n\nSELECT\n    ss.oid AS oid,                          -- ZTF object identifier\n    ss.candid AS candid,                    -- candidate identifier\n    ss.ssdistnr AS ssdistnr,                -- distance to nearest Solar System object\n    ss.ssmagnr AS ssmagnr,                  -- MPC archive magnitude\n    ss.ssnamenr AS ssnamenr,                -- name of nearest Solar System object\n    -- Candidate-related columns from detection (via candidate ID):\n    (SELECT d.fid FROM detection d WHERE d.candid = ss.candid AND d.oid = ss.oid) AS fid,  -- filter identifier\n    -- Columns requested by the user but not available in the provided schema:\n    NULL::DOUBLE PRECISION AS fwhm,                 -- FWHM from SExtractor (not in schema)\n    NULL::INTEGER AS n_ps1_calibrators,             -- number of PS1 calibrators used (not in schema)\n    NULL::DOUBLE PRECISION AS exptime               -- exposure time (not in schema)\nFROM ss_ztf ss\nWHERE ss.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n);"
                },
                "in_toks": 2890,
                "out_toks": 3694,
                "id": "chatcmpl-CSoKFvjwzTWNYCvvHyPrTfFW8qCVM",
                "created": 1760982671,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "104",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "taxonomy",
                "detection",
                "ss_ztf",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'detection', 'ss_ztf', 'dataquality']"
                },
                "in_toks": 682,
                "out_toks": 1502,
                "id": "chatcmpl-CSsk6D1JRE4N0ySgf3u0cayEdrzAz",
                "created": 1760999650,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized: pre-filter asteroid-class objects (ranking=1) for the specified classifier/version,\n-- require probability > 0.9, and restrict to objects present in ss_ztf. Limit early to reduce work.\nWITH top_ast AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   JOIN ss_ztf s USING (oid)\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT s.oid, -- ZTF object identifier\n s.candid, -- candidate identifier\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude\n s.ssnamenr, -- Solar System object name\n dq.fid, -- filter identifier\n dq.fwhm, -- FWHM from SExtractor\n dq.nmatches, -- number of PS1 calibrators used\n dq.exptime -- exposure time\nFROM top_ast ta\nJOIN ss_ztf s ON s.oid = ta.oid\nLEFT JOIN dataquality dq ON dq.candid = s.candid\nAND dq.oid = s.oid\nORDER BY ta.probability DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized: pre-filter asteroid-class objects (ranking=1) for the specified classifier/version,\n-- require probability > 0.9, and restrict to objects present in ss_ztf. Limit early to reduce work.\nWITH top_ast AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   JOIN ss_ztf s USING (oid)\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT s.oid, -- ZTF object identifier\n s.candid, -- candidate identifier\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude\n s.ssnamenr, -- Solar System object name\n dq.fid, -- filter identifier\n dq.fwhm, -- FWHM from SExtractor\n dq.nmatches, -- number of PS1 calibrators used\n dq.exptime -- exposure time\nFROM top_ast ta\nJOIN ss_ztf s ON s.oid = ta.oid\nLEFT JOIN dataquality dq ON dq.candid = s.candid\nAND dq.oid = s.oid\nORDER BY ta.probability DESC;"
                },
                "in_toks": 3088,
                "out_toks": 2631,
                "id": "chatcmpl-Cb9y3OihfgGtzVrbDUzKBonXqvNXF",
                "created": 1762972487,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with P(asteroid) > 0.9 for stamp classifier version 'stamp_classifier_1.0.4'\n-- Returns: ZTF object id (oid), candidate id (candid), nearest SSO distance, MPC magnitude, SSO name,\n-- and candidate-related fields: filter id, FWHM (SExtractor), number of PS1 calibrators, exposure time.\nSELECT\n    s.oid AS oid,\n    s.candid AS candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    (SELECT dq.fid FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS fid,\n    (SELECT dq.fwhm FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS fwhm,\n    (SELECT dq.nmatches FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS nmatches,\n    (SELECT dq.exptime FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS exptime\nFROM ss_ztf s\nWHERE s.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n)\nORDER BY (\n    SELECT p2.probability\n    FROM probability p2\n    WHERE p2.oid = s.oid\n      AND p2.classifier_name = 'stamp_classifier'\n      AND p2.classifier_version = 'stamp_classifier_1.0.4'\n      AND p2.class_name = 'asteroid'\n) DESC\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with P(asteroid) > 0.9 for stamp classifier version 'stamp_classifier_1.0.4'\n-- Returns: ZTF object id (oid), candidate id (candid), nearest SSO distance, MPC magnitude, SSO name,\n-- and candidate-related fields: filter id, FWHM (SExtractor), number of PS1 calibrators, exposure time.\nSELECT\n    s.oid AS oid,\n    s.candid AS candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    (SELECT dq.fid FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS fid,\n    (SELECT dq.fwhm FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS fwhm,\n    (SELECT dq.nmatches FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS nmatches,\n    (SELECT dq.exptime FROM dataquality dq WHERE dq.candid = s.candid AND dq.oid = s.oid) AS exptime\nFROM ss_ztf s\nWHERE s.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n)\nORDER BY (\n    SELECT p2.probability\n    FROM probability p2\n    WHERE p2.oid = s.oid\n      AND p2.classifier_name = 'stamp_classifier'\n      AND p2.classifier_version = 'stamp_classifier_1.0.4'\n      AND p2.class_name = 'asteroid'\n) DESC\nLIMIT 30;"
                },
                "in_toks": 3687,
                "out_toks": 2771,
                "id": "chatcmpl-CSszRwvM9mmrU0nxRW3pYmKPdg6P0",
                "created": 1761000601,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "104",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'detection', 'ss_ztf']"
                },
                "in_toks": 682,
                "out_toks": 2838,
                "id": "chatcmpl-CSskiBSH1cLb0zeYUyxdQyO5y98Rg",
                "created": 1760999688,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Find up to 30 objects with P(asteroid | stamp_classifier v1.0.4) > 0.9 (restrict to top-ranked class for efficiency)\nWITH top_asteroids AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.9\n     AND p.ranking = 1 -- optimization per guidelines\n\n   ORDER BY p.probability DESC\n   LIMIT 30), -- For the selected oids, get the most recent detection (by mjd) to provide candidate-level fields\nlatest_det AS\n  (SELECT DISTINCT ON (d.oid) d.oid,\n                      d.candid,\n                      d.fid\n   FROM detection d\n   JOIN top_asteroids ta ON ta.oid = d.oid\n   ORDER BY d.oid,\n            d.mjd DESC)\nSELECT ta.oid,\n       ld.candid,\n       s.ssdistnr,\n       s.ssmagnr,\n       s.ssnamenr,\n       ld.fid, -- Fields requested but not present in provided schema; returned as NULL placeholders\n NULL::DOUBLE PRECISION AS fwhm_sextractor,\n NULL::INTEGER AS n_ps1_calibrators,\n NULL::DOUBLE PRECISION AS exposure_time\nFROM top_asteroids ta\nLEFT JOIN latest_det ld ON ld.oid = ta.oid\nLEFT JOIN ss_ztf s ON s.oid = ta.oid\nORDER BY ta.probability DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Find up to 30 objects with P(asteroid | stamp_classifier v1.0.4) > 0.9 (restrict to top-ranked class for efficiency)\nWITH top_asteroids AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.9\n     AND p.ranking = 1 -- optimization per guidelines\n\n   ORDER BY p.probability DESC\n   LIMIT 30), -- For the selected oids, get the most recent detection (by mjd) to provide candidate-level fields\nlatest_det AS\n  (SELECT DISTINCT ON (d.oid) d.oid,\n                      d.candid,\n                      d.fid\n   FROM detection d\n   JOIN top_asteroids ta ON ta.oid = d.oid\n   ORDER BY d.oid,\n            d.mjd DESC)\nSELECT ta.oid,\n       ld.candid,\n       s.ssdistnr,\n       s.ssmagnr,\n       s.ssnamenr,\n       ld.fid, -- Fields requested but not present in provided schema; returned as NULL placeholders\n NULL::DOUBLE PRECISION AS fwhm_sextractor,\n NULL::INTEGER AS n_ps1_calibrators,\n NULL::DOUBLE PRECISION AS exposure_time\nFROM top_asteroids ta\nLEFT JOIN latest_det ld ON ld.oid = ta.oid\nLEFT JOIN ss_ztf s ON s.oid = ta.oid\nORDER BY ta.probability DESC;"
                },
                "in_toks": 2233,
                "out_toks": 2095,
                "id": "chatcmpl-Cb9yzfIwUuFun3J5I9xJPN9UxNDvD",
                "created": 1762972545,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- At most 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n-- For each object, we return the most recent candidate (by mjd) to supply candidate-related fields.\nWITH selected_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    -- Identifiers\n    o.oid AS oid,\n    (SELECT d.candid\n     FROM detection d\n     WHERE d.oid = o.oid\n     ORDER BY d.mjd DESC\n     LIMIT 1) AS candid,\n    -- Nearest Solar System object info (MPC-like magnitude provided by ssmagnr)\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    (SELECT s.ssmagnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssmagnr,\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    -- Candidate-related fields from the latest detection\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.oid = o.oid\n     ORDER BY d.mjd DESC\n     LIMIT 1) AS fid,\n    -- Requested fields not present in the provided schema; returned as NULL placeholders\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,\n    NULL::INTEGER AS n_ps1_calibrators,\n    NULL::DOUBLE PRECISION AS exposure_time\nFROM selected_oids o;",
            "original_sql_response": {
                "responses": {
                    "0": "-- At most 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n-- For each object, we return the most recent candidate (by mjd) to supply candidate-related fields.\nWITH selected_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    -- Identifiers\n    o.oid AS oid,\n    (SELECT d.candid\n     FROM detection d\n     WHERE d.oid = o.oid\n     ORDER BY d.mjd DESC\n     LIMIT 1) AS candid,\n    -- Nearest Solar System object info (MPC-like magnitude provided by ssmagnr)\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    (SELECT s.ssmagnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssmagnr,\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    -- Candidate-related fields from the latest detection\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.oid = o.oid\n     ORDER BY d.mjd DESC\n     LIMIT 1) AS fid,\n    -- Requested fields not present in the provided schema; returned as NULL placeholders\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,\n    NULL::INTEGER AS n_ps1_calibrators,\n    NULL::DOUBLE PRECISION AS exposure_time\nFROM selected_oids o;"
                },
                "in_toks": 2845,
                "out_toks": 3414,
                "id": "chatcmpl-CSszrElLf35hu0AI67idylhsuRpQS",
                "created": 1761000627,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "104",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "taxonomy",
                "step",
                "object",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'step', 'object', 'detection', 'ss_ztf']"
                },
                "in_toks": 682,
                "out_toks": 2400,
                "id": "chatcmpl-CSslahVSxB2z1ceGZvbszOVfHI14c",
                "created": 1760999742,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Find up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n   Return: object oid, candidate candid, nearest SSO distance, MPC magnitude, SSO name,\n           and detection-level fields: fid, plus placeholders for FWHM, PS1 calibrators, exposure time.\n   Note: The provided schema does not include columns for FWHM (SExtractor), number of PS1 calibrators, or exposure time.\n         These are returned as NULL placeholders. */\nSELECT s.oid,\n       s.candid,\n       s.ssdistnr,\n       s.ssmagnr,\n       s.ssnamenr,\n       d.fid,\n       NULL::DOUBLE PRECISION AS fwhm_sextractor, -- Placeholder: not available in provided schema\n NULL::INTEGER AS ps1_calibrators_used, -- Placeholder: not available in provided schema\n NULL::DOUBLE PRECISION AS exposure_time -- Placeholder: not available in provided schema\nFROM ss_ztf AS s\nJOIN probability AS p ON p.oid = s.oid\nAND p.classifier_name = 'stamp_classifier'\nAND p.classifier_version = 'stamp_classifier_1.0.4'\nAND p.class_name = 'asteroid'\nAND p.probability > 0.9\nJOIN detection AS d ON d.candid = s.candid\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "/* Find up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n   Return: object oid, candidate candid, nearest SSO distance, MPC magnitude, SSO name,\n           and detection-level fields: fid, plus placeholders for FWHM, PS1 calibrators, exposure time.\n   Note: The provided schema does not include columns for FWHM (SExtractor), number of PS1 calibrators, or exposure time.\n         These are returned as NULL placeholders. */\nSELECT s.oid,\n       s.candid,\n       s.ssdistnr,\n       s.ssmagnr,\n       s.ssnamenr,\n       d.fid,\n       NULL::DOUBLE PRECISION AS fwhm_sextractor, -- Placeholder: not available in provided schema\n NULL::INTEGER AS ps1_calibrators_used, -- Placeholder: not available in provided schema\n NULL::DOUBLE PRECISION AS exposure_time -- Placeholder: not available in provided schema\nFROM ss_ztf AS s\nJOIN probability AS p ON p.oid = s.oid\nAND p.classifier_name = 'stamp_classifier'\nAND p.classifier_version = 'stamp_classifier_1.0.4'\nAND p.class_name = 'asteroid'\nAND p.probability > 0.9\nJOIN detection AS d ON d.candid = s.candid\nLIMIT 30;"
                },
                "in_toks": 2558,
                "out_toks": 1977,
                "id": "chatcmpl-Cb9zVlSKDIK1ww6zXAGqh7axtBvhb",
                "created": 1762972577,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n   Return: object oid, candidate candid, nearest SSO distance, MPC magnitude, SSO name,\n           and detection-level fields: fid, plus placeholders for FWHM, PS1 calibrators, exposure time.\n   Note: The provided schema does not include columns for FWHM (SExtractor), number of PS1 calibrators, or exposure time.\n         These are returned as NULL placeholders. If these fields exist in another schema/table, they can be substituted here. */\nWITH candidate_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n)\nSELECT\n    s.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    /* filter identifier from detection corresponding to this candid */\n    (SELECT d.fid FROM detection d WHERE d.candid = s.candid) AS fid,\n    /* Placeholders for fields not present in the provided schema */\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,\n    NULL::INTEGER AS ps1_calibrators_used,\n    NULL::DOUBLE PRECISION AS exposure_time\nFROM ss_ztf s\nWHERE s.oid IN (SELECT oid FROM candidate_oids)\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n   Return: object oid, candidate candid, nearest SSO distance, MPC magnitude, SSO name,\n           and detection-level fields: fid, plus placeholders for FWHM, PS1 calibrators, exposure time.\n   Note: The provided schema does not include columns for FWHM (SExtractor), number of PS1 calibrators, or exposure time.\n         These are returned as NULL placeholders. If these fields exist in another schema/table, they can be substituted here. */\nWITH candidate_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n)\nSELECT\n    s.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    /* filter identifier from detection corresponding to this candid */\n    (SELECT d.fid FROM detection d WHERE d.candid = s.candid) AS fid,\n    /* Placeholders for fields not present in the provided schema */\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,\n    NULL::INTEGER AS ps1_calibrators_used,\n    NULL::DOUBLE PRECISION AS exposure_time\nFROM ss_ztf s\nWHERE s.oid IN (SELECT oid FROM candidate_oids)\nLIMIT 30;"
                },
                "in_toks": 3444,
                "out_toks": 2775,
                "id": "chatcmpl-CSt0brTxd6whbeVkj2ZQFY1cmzqkb",
                "created": 1761000673,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "104",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'detection', 'ss_ztf']"
                },
                "in_toks": 682,
                "out_toks": 2327,
                "id": "chatcmpl-CZMzYBwNj8yQUfEEGsWVIM5EDoxXV",
                "created": 1762545896,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Optimized query: join probability -> ss_ztf -> detection and avoid correlated subqueries.\n   - Uses strict filters on probability (class, classifier, version, ranking=1, prob>0.9) to reduce dataset.\n   - Ordering by probability and limiting to 30 rows for performance.\n   - FWHM, PS1 calibrators, and exposure time are not present in the provided schema, so returned as NULLs. */\nSELECT p.oid AS oid,\n       s.candid AS candid,\n       s.ssdistnr,\n       s.ssmagnr, -- interpreted as MPC archive magnitude\n s.ssnamenr,\n d.fid, -- filter identifier from the specific candidate\n NULL::double precision AS fwhm, -- not available in provided schema\n NULL::integer AS ps1_ncalibrators, -- not available in provided schema\n NULL::double precision AS exposure_time -- not available in provided schema\nFROM probability p\nJOIN ss_ztf s ON s.oid = p.oid\nLEFT JOIN detection d ON d.candid = s.candid -- use PK join to get fid for the specific candidate\n\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND p.probability > 0.9\nORDER BY p.probability DESC,\n         p.oid\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "/* Optimized query: join probability -> ss_ztf -> detection and avoid correlated subqueries.\n   - Uses strict filters on probability (class, classifier, version, ranking=1, prob>0.9) to reduce dataset.\n   - Ordering by probability and limiting to 30 rows for performance.\n   - FWHM, PS1 calibrators, and exposure time are not present in the provided schema, so returned as NULLs. */\nSELECT p.oid AS oid,\n       s.candid AS candid,\n       s.ssdistnr,\n       s.ssmagnr, -- interpreted as MPC archive magnitude\n s.ssnamenr,\n d.fid, -- filter identifier from the specific candidate\n NULL::double precision AS fwhm, -- not available in provided schema\n NULL::integer AS ps1_ncalibrators, -- not available in provided schema\n NULL::double precision AS exposure_time -- not available in provided schema\nFROM probability p\nJOIN ss_ztf s ON s.oid = p.oid\nLEFT JOIN detection d ON d.candid = s.candid -- use PK join to get fid for the specific candidate\n\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND p.probability > 0.9\nORDER BY p.probability DESC,\n         p.oid\nLIMIT 30;"
                },
                "in_toks": 2270,
                "out_toks": 2514,
                "id": "chatcmpl-CbA0CAfqfgnVijc5cQH996vEotNox",
                "created": 1762972620,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 30 ZTF objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4' with probability > 0.9.\n   Return: ZTF object id (oid), candidate id (candid), nearest SS object distance, MPC magnitude, and name.\n   Also include candidate-related columns: filter identifier (fid).\n   Note: FWHM from SExtractor, number of PS1 calibrators, and exposure time are not present in the provided schema, so they are returned as NULL placeholders. */\nSELECT\n    s.oid AS oid,\n    s.candid AS candid,\n    s.ssdistnr,\n    s.ssmagnr,   -- interpreted as MPC archive magnitude\n    s.ssnamenr,\n    /* Candidate-related fields from detection */\n    (SELECT d.fid FROM detection d WHERE d.candid = s.candid) AS fid,\n    /* Placeholders for fields not available in the given schema */\n    NULL::double precision AS fwhm,\n    NULL::integer AS ps1_ncalibrators,\n    NULL::double precision AS exposure_time\nFROM ss_ztf s\nWHERE s.oid IN (\n    /* Prioritize obtaining OIDs via a subquery from probability */\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n)\nORDER BY (\n    /* Order by the asteroid probability (descending) to pick the most confident ones */\n    SELECT p2.probability\n    FROM probability p2\n    WHERE p2.oid = s.oid\n      AND p2.classifier_name = 'stamp_classifier'\n      AND p2.classifier_version = 'stamp_classifier_1.0.4'\n      AND p2.class_name = 'asteroid'\n) DESC NULLS LAST\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 30 ZTF objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4' with probability > 0.9.\n   Return: ZTF object id (oid), candidate id (candid), nearest SS object distance, MPC magnitude, and name.\n   Also include candidate-related columns: filter identifier (fid).\n   Note: FWHM from SExtractor, number of PS1 calibrators, and exposure time are not present in the provided schema, so they are returned as NULL placeholders. */\nSELECT\n    s.oid AS oid,\n    s.candid AS candid,\n    s.ssdistnr,\n    s.ssmagnr,   -- interpreted as MPC archive magnitude\n    s.ssnamenr,\n    /* Candidate-related fields from detection */\n    (SELECT d.fid FROM detection d WHERE d.candid = s.candid) AS fid,\n    /* Placeholders for fields not available in the given schema */\n    NULL::double precision AS fwhm,\n    NULL::integer AS ps1_ncalibrators,\n    NULL::double precision AS exposure_time\nFROM ss_ztf s\nWHERE s.oid IN (\n    /* Prioritize obtaining OIDs via a subquery from probability */\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n)\nORDER BY (\n    /* Order by the asteroid probability (descending) to pick the most confident ones */\n    SELECT p2.probability\n    FROM probability p2\n    WHERE p2.oid = s.oid\n      AND p2.classifier_name = 'stamp_classifier'\n      AND p2.classifier_version = 'stamp_classifier_1.0.4'\n      AND p2.class_name = 'asteroid'\n) DESC NULLS LAST\nLIMIT 30;"
                },
                "in_toks": 2845,
                "out_toks": 2923,
                "id": "chatcmpl-CZRAQaEggxZSejOxLvnDTbUVwNfRx",
                "created": 1762561946,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "104",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability",
                "taxonomy",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'detection', 'ss_ztf']"
                },
                "in_toks": 682,
                "out_toks": 1562,
                "id": "chatcmpl-CZN0GGD5oRXzZK2YECpSIREGeHkXj",
                "created": 1762545940,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query: use selective join on probability with ranking=1 and required classifier filters,\n-- then join to ss_ztf and detection by oid and candid. This avoids correlated subqueries and IN clauses.\n-- Note: FWHM (SExtractor), number of PS1 calibrators, and exposure time are not present in the provided schema,\n-- so they are returned as NULL placeholders.\n\nSELECT s.oid, -- ZTF object identifier\n s.candid, -- candidate identifier\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude of nearest Solar System object\n s.ssnamenr, -- name of nearest Solar System object\n d.fid, -- filter identifier\n NULL::DOUBLE PRECISION AS fwhm_sextractor, -- not available in provided schema\n NULL::INTEGER AS n_ps1_calibrators, -- not available in provided schema\n NULL::DOUBLE PRECISION AS exposure_time -- not available in provided schema\nFROM probability p\nJOIN ss_ztf s ON s.oid = p.oid\nJOIN detection d ON d.oid = s.oid\nAND d.candid = s.candid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND p.probability > 0.9\nORDER BY p.probability DESC\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query: use selective join on probability with ranking=1 and required classifier filters,\n-- then join to ss_ztf and detection by oid and candid. This avoids correlated subqueries and IN clauses.\n-- Note: FWHM (SExtractor), number of PS1 calibrators, and exposure time are not present in the provided schema,\n-- so they are returned as NULL placeholders.\n\nSELECT s.oid, -- ZTF object identifier\n s.candid, -- candidate identifier\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude of nearest Solar System object\n s.ssnamenr, -- name of nearest Solar System object\n d.fid, -- filter identifier\n NULL::DOUBLE PRECISION AS fwhm_sextractor, -- not available in provided schema\n NULL::INTEGER AS n_ps1_calibrators, -- not available in provided schema\n NULL::DOUBLE PRECISION AS exposure_time -- not available in provided schema\nFROM probability p\nJOIN ss_ztf s ON s.oid = p.oid\nJOIN detection d ON d.oid = s.oid\nAND d.candid = s.candid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND p.probability > 0.9\nORDER BY p.probability DESC\nLIMIT 30;"
                },
                "in_toks": 2254,
                "out_toks": 2138,
                "id": "chatcmpl-CbA17mIUTYtcugOEAV6CuFy7fsagm",
                "created": 1762972677,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects (oids) with asteroid probability > 0.9 for stamp_classifier version 'stamp_classifier_1.0.4'\n-- Return oid, candid, Solar System object info (distance, MPC magnitude, name),\n-- plus candidate-related fields: filter identifier (fid), and placeholders for FWHM (SExtractor), number of PS1 calibrators, and exposure time\n-- Note: The provided schema does not include columns for FWHM (SExtractor), PS1 calibrators count, or exposure time.\n--       These are returned as NULL placeholders with appropriate types.\n\nWITH best_oids AS (\n    SELECT\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.9\n)\nSELECT\n    s.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.oid = s.oid AND d.candid = s.candid\n     LIMIT 1) AS fid,\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,     -- not available in provided schema\n    NULL::INTEGER AS n_ps1_calibrators,            -- not available in provided schema\n    NULL::DOUBLE PRECISION AS exposure_time        -- not available in provided schema\nFROM ss_ztf s\nWHERE s.oid IN (SELECT bo.oid FROM best_oids bo)\nORDER BY (SELECT bo.probability FROM best_oids bo WHERE bo.oid = s.oid) DESC NULLS LAST\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects (oids) with asteroid probability > 0.9 for stamp_classifier version 'stamp_classifier_1.0.4'\n-- Return oid, candid, Solar System object info (distance, MPC magnitude, name),\n-- plus candidate-related fields: filter identifier (fid), and placeholders for FWHM (SExtractor), number of PS1 calibrators, and exposure time\n-- Note: The provided schema does not include columns for FWHM (SExtractor), PS1 calibrators count, or exposure time.\n--       These are returned as NULL placeholders with appropriate types.\n\nWITH best_oids AS (\n    SELECT\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.9\n)\nSELECT\n    s.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr,\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.oid = s.oid AND d.candid = s.candid\n     LIMIT 1) AS fid,\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,     -- not available in provided schema\n    NULL::INTEGER AS n_ps1_calibrators,            -- not available in provided schema\n    NULL::DOUBLE PRECISION AS exposure_time        -- not available in provided schema\nFROM ss_ztf s\nWHERE s.oid IN (SELECT bo.oid FROM best_oids bo)\nORDER BY (SELECT bo.probability FROM best_oids bo WHERE bo.oid = s.oid) DESC NULLS LAST\nLIMIT 30;"
                },
                "in_toks": 2890,
                "out_toks": 3147,
                "id": "chatcmpl-CZRAwaP7cHkvHRNCFu8qWzzUDnuRL",
                "created": 1762561978,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "104",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'detection', 'ss_ztf']"
                },
                "in_toks": 682,
                "out_toks": 2263,
                "id": "chatcmpl-CZN0rem4sd6HeEyZJIXhF14kS49Z8",
                "created": 1762545977,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Select at most 30 high-probability asteroid candidates from the stamp classifier v1.0.4\n-- Join to ss_ztf to get nearest Solar System object info and to detection (by candid PK) to fetch fid\n-- ranking=1 added for probability table optimization as per guidelines\n-- FWHM (SExtractor), PS1 calibrators, and exposure time are not available in provided schema; returned as NULLs\nWITH top_oids AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT o.oid,\n       s.candid,\n       s.ssdistnr,\n       s.ssmagnr,\n       s.ssnamenr,\n       d.fid,\n       NULL::DOUBLE PRECISION AS fwhm_sextractor,\n       NULL::INTEGER AS n_ps1_calibrators,\n       NULL::DOUBLE PRECISION AS exposure_time\nFROM top_oids o\nLEFT JOIN ss_ztf s ON s.oid = o.oid\nLEFT JOIN detection d ON d.candid = s.candid;",
            "sql_response": {
                "responses": {
                    "0": "-- Select at most 30 high-probability asteroid candidates from the stamp classifier v1.0.4\n-- Join to ss_ztf to get nearest Solar System object info and to detection (by candid PK) to fetch fid\n-- ranking=1 added for probability table optimization as per guidelines\n-- FWHM (SExtractor), PS1 calibrators, and exposure time are not available in provided schema; returned as NULLs\nWITH top_oids AS\n  (SELECT p.oid,\n          p.probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT o.oid,\n       s.candid,\n       s.ssdistnr,\n       s.ssmagnr,\n       s.ssnamenr,\n       d.fid,\n       NULL::DOUBLE PRECISION AS fwhm_sextractor,\n       NULL::INTEGER AS n_ps1_calibrators,\n       NULL::DOUBLE PRECISION AS exposure_time\nFROM top_oids o\nLEFT JOIN ss_ztf s ON s.oid = o.oid\nLEFT JOIN detection d ON d.candid = s.candid;"
                },
                "in_toks": 2278,
                "out_toks": 2224,
                "id": "chatcmpl-CbA1u5WWaGId1v8yanOsjag7a9hQk",
                "created": 1762972726,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n-- Return object oid, candidate candid, distance (ssdistnr), magnitude (ssmagnr), and name (ssnamenr)\n-- Also include candidate's filter identifier (fid).\n-- Note: FWHM from SExtractor, number of PS1 calibrators, and exposure time are not present in the provided schema; they are returned as NULL placeholders.\n WITH OIDS AS \n  (SELECT p.oid \n   FROM probability p \n   WHERE p.classifier_name = 'stamp_classifier' \n     AND p.classifier_version = 'stamp_classifier_1.0.4' \n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT o.oid,\n\n  (SELECT s.candid\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS candid,\n\n  (SELECT s.ssdistnr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssdistnr,\n\n  (SELECT s.ssmagnr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssmagnr,\n\n  (SELECT s.ssnamenr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssnamenr,\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.oid = o.oid\n     AND d.candid =\n       (SELECT s2.candid\n        FROM ss_ztf s2\n        WHERE s2.oid = o.oid)\n   LIMIT 1) AS fid,\n       NULL::DOUBLE PRECISION AS fwhm_sextractor,\n       NULL::INTEGER AS n_ps1_calibrators,\n       NULL::DOUBLE PRECISION AS exposure_time\nFROM OIDS o;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with P(asteroid | stamp_classifier v1.0.4) > 0.9\n-- Return object oid, candidate candid, distance (ssdistnr), magnitude (ssmagnr), and name (ssnamenr)\n-- Also include candidate's filter identifier (fid).\n-- Note: FWHM from SExtractor, number of PS1 calibrators, and exposure time are not present in the provided schema; they are returned as NULL placeholders.\n WITH OIDS AS \n  (SELECT p.oid \n   FROM probability p \n   WHERE p.classifier_name = 'stamp_classifier' \n     AND p.classifier_version = 'stamp_classifier_1.0.4' \n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.9\n   ORDER BY p.probability DESC\n   LIMIT 30)\nSELECT o.oid,\n\n  (SELECT s.candid\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS candid,\n\n  (SELECT s.ssdistnr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssdistnr,\n\n  (SELECT s.ssmagnr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssmagnr,\n\n  (SELECT s.ssnamenr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssnamenr,\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.oid = o.oid\n     AND d.candid =\n       (SELECT s2.candid\n        FROM ss_ztf s2\n        WHERE s2.oid = o.oid)\n   LIMIT 1) AS fid,\n       NULL::DOUBLE PRECISION AS fwhm_sextractor,\n       NULL::INTEGER AS n_ps1_calibrators,\n       NULL::DOUBLE PRECISION AS exposure_time\nFROM OIDS o;"
                },
                "in_toks": 2845,
                "out_toks": 5145,
                "id": "chatcmpl-CayljslhzxS2AiRdFhfjrkAmCR8b7",
                "created": 1762929439,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "104",
            "experiment_id": "run_8",
            "pred_tables": [
                "probability",
                "taxonomy",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'detection', 'ss_ztf']"
                },
                "in_toks": 682,
                "out_toks": 3098,
                "id": "chatcmpl-CZN2Afzg4aq6wR5EJ2WeLSzLGZ1cR",
                "created": 1762546058,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects with asteroid probability > 0.9 in stamp_classifier version 'stamp_classifier_1.0.4'\n-- Returns: ZTF object id (oid), candidate id (candid), distance to nearest SS object, MPC magnitude, name, and filter id.\n-- Note: FWHM from SExtractor, number of PS1 calibrators, and exposure time are not available in the provided schema.\n\nSELECT s.oid, -- ZTF object identifier\n s.candid, -- candidate identifier\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude\n s.ssnamenr, -- name of nearest Solar System object\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid = s.candid) AS fid -- filter identifier\nFROM ss_ztf s\nWHERE s.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4'\n       AND p.class_name = 'asteroid'\n       AND p.probability > 0.9\n     LIMIT 30)\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with asteroid probability > 0.9 in stamp_classifier version 'stamp_classifier_1.0.4'\n-- Returns: ZTF object id (oid), candidate id (candid), distance to nearest SS object, MPC magnitude, name, and filter id.\n-- Note: FWHM from SExtractor, number of PS1 calibrators, and exposure time are not available in the provided schema.\n\nSELECT s.oid, -- ZTF object identifier\n s.candid, -- candidate identifier\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude\n s.ssnamenr, -- name of nearest Solar System object\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid = s.candid) AS fid -- filter identifier\nFROM ss_ztf s\nWHERE s.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4'\n       AND p.class_name = 'asteroid'\n       AND p.probability > 0.9\n     LIMIT 30)\nLIMIT 30;"
                },
                "in_toks": 2890,
                "out_toks": 3412,
                "id": "chatcmpl-CaymcMZrLyjA9qPhI8X7wvFjuHUGn",
                "created": 1762929494,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "104",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability",
                "taxonomy",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'taxonomy', 'detection', 'ss_ztf']"
                },
                "in_toks": 682,
                "out_toks": 1498,
                "id": "chatcmpl-CZN3QBTOkxRaUgvuoeqYICUNU9tpm",
                "created": 1762546136,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Find up to 30 ZTF objects classified as 'asteroid' by the stamp classifier v1.0.4\n   with probability > 0.9 and ranking = 1. For each object, return the latest detection\n   (by mjd) to obtain candid and fid. Join to ss_ztf once to fetch Solar System info.\n   Note: FWHM (SExtractor), number of PS1 calibrators, and exposure time are not present\n   in the provided schema, so they are returned as NULL placeholders. */ WITH target_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   LIMIT 30)\nSELECT t.oid, -- ZTF object identifier\n d.candid, -- candidate identifier (from latest detection)\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude of nearest SS object\n s.ssnamenr, -- name of nearest Solar System object\n d.fid, -- filter identifier (1=g; 2=r; 3=i)\n NULL::DOUBLE PRECISION AS fwhm_sextractor, -- placeholder: not in provided schema\n NULL::INTEGER AS ps1_calibrators_used, -- placeholder: not in provided schema\n NULL::DOUBLE PRECISION AS exposure_time -- placeholder: not in provided schema\nFROM target_oids t\nJOIN LATERAL\n  (/* Efficiently get the latest detection per object */  SELECT d.candid,\n                                                                 d.fid\n   FROM detection d\n   WHERE d.oid = t.oid\n   ORDER BY d.mjd DESC\n   LIMIT 1) d ON TRUE\nLEFT JOIN ss_ztf s ON s.oid = t.oid;",
            "sql_response": {
                "responses": {
                    "0": "/* Find up to 30 ZTF objects classified as 'asteroid' by the stamp classifier v1.0.4\n   with probability > 0.9 and ranking = 1. For each object, return the latest detection\n   (by mjd) to obtain candid and fid. Join to ss_ztf once to fetch Solar System info.\n   Note: FWHM (SExtractor), number of PS1 calibrators, and exposure time are not present\n   in the provided schema, so they are returned as NULL placeholders. */ WITH target_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   LIMIT 30)\nSELECT t.oid, -- ZTF object identifier\n d.candid, -- candidate identifier (from latest detection)\n s.ssdistnr, -- distance to nearest Solar System object\n s.ssmagnr, -- MPC archive magnitude of nearest SS object\n s.ssnamenr, -- name of nearest Solar System object\n d.fid, -- filter identifier (1=g; 2=r; 3=i)\n NULL::DOUBLE PRECISION AS fwhm_sextractor, -- placeholder: not in provided schema\n NULL::INTEGER AS ps1_calibrators_used, -- placeholder: not in provided schema\n NULL::DOUBLE PRECISION AS exposure_time -- placeholder: not in provided schema\nFROM target_oids t\nJOIN LATERAL\n  (/* Efficiently get the latest detection per object */  SELECT d.candid,\n                                                                 d.fid\n   FROM detection d\n   WHERE d.oid = t.oid\n   ORDER BY d.mjd DESC\n   LIMIT 1) d ON TRUE\nLEFT JOIN ss_ztf s ON s.oid = t.oid;"
                },
                "in_toks": 2392,
                "out_toks": 1918,
                "id": "chatcmpl-CbA2p1n0EmDOiBAyDs0ATr5VgRiD9",
                "created": 1762972783,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 30 objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4'\n   with probability > 0.9, and return object/candidate identifiers plus Solar System info and candidate details.\n   Assumption: for each object we select the latest detection (highest mjd) to get its candid and fid.\n   Note: The provided schema does not include fields for FWHM (SExtractor), number of PS1 calibrators, or exposure time.\n         These are returned as NULL placeholders with descriptive aliases. */\nWITH target_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND class_name = 'asteroid'\n      AND probability > 0.9\n    ORDER BY probability DESC\n    LIMIT 30\n),\nlatest_det AS (\n    SELECT DISTINCT ON (oid) oid, candid, fid\n    FROM detection\n    WHERE oid IN (SELECT oid FROM target_oids)\n    ORDER BY oid, mjd DESC\n)\nSELECT\n    ld.oid,                                        -- ZTF object identifier\n    ld.candid,                                     -- candidate identifier (from latest detection)\n    (SELECT ssdistnr FROM ss_ztf s WHERE s.oid = ld.oid) AS ssdistnr,   -- distance to nearest SS object\n    (SELECT ssmagnr FROM ss_ztf s WHERE s.oid = ld.oid) AS ssmagnr,     -- MPC magnitude of nearest SS object\n    (SELECT ssnamenr FROM ss_ztf s WHERE s.oid = ld.oid) AS ssnamenr,   -- name of nearest SS object\n    ld.fid,                                        -- filter identifier\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,     -- placeholder: FWHM from SExtractor (not present in schema)\n    NULL::INTEGER AS ps1_calibrators_used,         -- placeholder: number of PS1 calibrators used (not present)\n    NULL::DOUBLE PRECISION AS exposure_time        -- placeholder: exposure time (not present)\nFROM latest_det ld;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 30 objects classified as 'asteroid' by the stamp classifier version 'stamp_classifier_1.0.4'\n   with probability > 0.9, and return object/candidate identifiers plus Solar System info and candidate details.\n   Assumption: for each object we select the latest detection (highest mjd) to get its candid and fid.\n   Note: The provided schema does not include fields for FWHM (SExtractor), number of PS1 calibrators, or exposure time.\n         These are returned as NULL placeholders with descriptive aliases. */\nWITH target_oids AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND class_name = 'asteroid'\n      AND probability > 0.9\n    ORDER BY probability DESC\n    LIMIT 30\n),\nlatest_det AS (\n    SELECT DISTINCT ON (oid) oid, candid, fid\n    FROM detection\n    WHERE oid IN (SELECT oid FROM target_oids)\n    ORDER BY oid, mjd DESC\n)\nSELECT\n    ld.oid,                                        -- ZTF object identifier\n    ld.candid,                                     -- candidate identifier (from latest detection)\n    (SELECT ssdistnr FROM ss_ztf s WHERE s.oid = ld.oid) AS ssdistnr,   -- distance to nearest SS object\n    (SELECT ssmagnr FROM ss_ztf s WHERE s.oid = ld.oid) AS ssmagnr,     -- MPC magnitude of nearest SS object\n    (SELECT ssnamenr FROM ss_ztf s WHERE s.oid = ld.oid) AS ssnamenr,   -- name of nearest SS object\n    ld.fid,                                        -- filter identifier\n    NULL::DOUBLE PRECISION AS fwhm_sextractor,     -- placeholder: FWHM from SExtractor (not present in schema)\n    NULL::INTEGER AS ps1_calibrators_used,         -- placeholder: number of PS1 calibrators used (not present)\n    NULL::DOUBLE PRECISION AS exposure_time        -- placeholder: exposure time (not present)\nFROM latest_det ld;"
                },
                "in_toks": 2890,
                "out_toks": 3727,
                "id": "chatcmpl-CZRBpvFhmHCLBsLYE5GYtk0knnwxe",
                "created": 1762562033,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        }
    },
    "71": {
        "0": {
            "req_id": "71",
            "experiment_id": "run_0",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']",
                    "1": "['object', 'reference', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 1887,
                "id": "chatcmpl-CSnYcmspI0T4ZxgdWqYX2ZAWdhG6n",
                "created": 1760979718,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select g-band (fid=1) reference rows for given ZTF object identifiers\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,          -- identifier of the reference\n    oid,           -- ZTF identifier\n    candid,        -- candidate identifier\n    magnr,         -- magnitude of nearest reference object\n    sigmagnr       -- uncertainty of magnr\nFROM reference\nWHERE fid = 1                      -- g band\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid;                      -- sort by ZTF identifier",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select g-band (fid=1) reference rows for given ZTF object identifiers\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,          -- identifier of the reference\n    oid,           -- ZTF identifier\n    candid,        -- candidate identifier\n    magnr,         -- magnitude of nearest reference object\n    sigmagnr       -- uncertainty of magnr\nFROM reference\nWHERE fid = 1                      -- g band\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid;                      -- sort by ZTF identifier"
                },
                "in_toks": 2300,
                "out_toks": 1309,
                "id": "chatcmpl-CSoGZhMkVEccRGENlVtylxCOYc7IM",
                "created": 1760982443,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "71",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "reference",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']",
                    "1": "['object', 'reference', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 1887,
                "id": "chatcmpl-CSnYcmspI0T4ZxgdWqYX2ZAWdhG6n",
                "created": 1760979718,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return reference rows in the g band (fid=1) for the specified ZTF objects.\n-- Columns: reference identifier (rfid), ZTF identifier (oid), candidate identifier (candid),\n-- and magnitude (magnr) with its uncertainty (sigmagnr). Sorted by ZTF identifier.\nWITH wanted_oids(oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nWHERE r.oid IN (SELECT oid FROM wanted_oids)\n  AND r.fid = 1  -- g band\nORDER BY r.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return reference rows in the g band (fid=1) for the specified ZTF objects.\n-- Columns: reference identifier (rfid), ZTF identifier (oid), candidate identifier (candid),\n-- and magnitude (magnr) with its uncertainty (sigmagnr). Sorted by ZTF identifier.\nWITH wanted_oids(oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nWHERE r.oid IN (SELECT oid FROM wanted_oids)\n  AND r.fid = 1  -- g band\nORDER BY r.oid;"
                },
                "in_toks": 3330,
                "out_toks": 946,
                "id": "chatcmpl-CSoLKnxjva3wiaJsNXByaUfY6gZGI",
                "created": 1760982738,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "71",
            "experiment_id": "run_2",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 665,
                "out_toks": 780,
                "id": "chatcmpl-CSsmIhAA3WngnvsPFdSqh4fpfmOlO",
                "created": 1760999786,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find reference rows for given ZTF objects in g band (fid=1)\n-- Return: reference ID (rfid), ZTF ID (oid), candidate ID (candid), and nearest reference magnitude with uncertainty (magnr, sigmagnr)\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF20aczxeud'),\n    ('ZTF21aappfdu'),\n    ('ZTF22aacqjeb')\n)\nSELECT\n  r.rfid,\n  r.oid,\n  r.candid,\n  r.magnr,\n  r.sigmagnr\nFROM reference r\nWHERE r.fid = 1\n  AND r.oid IN (SELECT oid FROM target_oids)\nORDER BY r.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find reference rows for given ZTF objects in g band (fid=1)\n-- Return: reference ID (rfid), ZTF ID (oid), candidate ID (candid), and nearest reference magnitude with uncertainty (magnr, sigmagnr)\nWITH target_oids(oid) AS (\n  VALUES\n    ('ZTF20aczxeud'),\n    ('ZTF21aappfdu'),\n    ('ZTF22aacqjeb')\n)\nSELECT\n  r.rfid,\n  r.oid,\n  r.candid,\n  r.magnr,\n  r.sigmagnr\nFROM reference r\nWHERE r.fid = 1\n  AND r.oid IN (SELECT oid FROM target_oids)\nORDER BY r.oid;"
                },
                "in_toks": 2300,
                "out_toks": 1124,
                "id": "chatcmpl-CSt109ZtD97Cfgl2V2Q8ie93weK7s",
                "created": 1761000698,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "71",
            "experiment_id": "run_3",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 665,
                "out_toks": 844,
                "id": "chatcmpl-CSsmRXROGANJCfR3GkDcvUnExunKB",
                "created": 1760999795,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find g-band (fid = 1) reference entries for specific ZTF objects\nWITH selected_oids (oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,        -- identifier of the reference\n    oid,         -- ZTF identifier\n    candid,      -- candidate identifier\n    magnr,       -- magnitude of nearest reference object\n    sigmagnr     -- 1-sigma uncertainty of magnr\nFROM reference\nWHERE fid = 1\n  AND oid IN (SELECT oid FROM selected_oids)\nORDER BY oid;  -- sort by ZTF identifier",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find g-band (fid = 1) reference entries for specific ZTF objects\nWITH selected_oids (oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,        -- identifier of the reference\n    oid,         -- ZTF identifier\n    candid,      -- candidate identifier\n    magnr,       -- magnitude of nearest reference object\n    sigmagnr     -- 1-sigma uncertainty of magnr\nFROM reference\nWHERE fid = 1\n  AND oid IN (SELECT oid FROM selected_oids)\nORDER BY oid;  -- sort by ZTF identifier"
                },
                "in_toks": 2300,
                "out_toks": 1437,
                "id": "chatcmpl-CSt1DeTPbREBiNjzNKujXK26vXOT4",
                "created": 1761000711,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "71",
            "experiment_id": "run_4",
            "pred_tables": [
                "reference",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference', 'object']"
                },
                "in_toks": 665,
                "out_toks": 847,
                "id": "chatcmpl-CSsmdeZJhI02fcC85naeu0crwZ5Y2",
                "created": 1760999807,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Filter g-band reference rows (fid = 1) for the specified ZTF objects.\n-- Return: reference identifier (rfid), ZTF identifier (oid), candidate identifier (candid),\n-- and the nearest reference object's magnitude and uncertainty (magnr, sigmagnr).\nSELECT\n    rfid,\n    oid,\n    candid,\n    magnr,\n    sigmagnr\nFROM reference\nWHERE fid = 1\n  AND oid IN (\n      SELECT oid\n      FROM object\n      WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n  )\nORDER BY oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Filter g-band reference rows (fid = 1) for the specified ZTF objects.\n-- Return: reference identifier (rfid), ZTF identifier (oid), candidate identifier (candid),\n-- and the nearest reference object's magnitude and uncertainty (magnr, sigmagnr).\nSELECT\n    rfid,\n    oid,\n    candid,\n    magnr,\n    sigmagnr\nFROM reference\nWHERE fid = 1\n  AND oid IN (\n      SELECT oid\n      FROM object\n      WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n  )\nORDER BY oid;"
                },
                "in_toks": 2782,
                "out_toks": 1040,
                "id": "chatcmpl-CSt1TBNy2Q4EWxGD1GxVWh0zLirnm",
                "created": 1761000727,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "71",
            "experiment_id": "run_5",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 665,
                "out_toks": 1100,
                "id": "chatcmpl-CZN40suk93QNq0KYfQgZKKjEyB4B8",
                "created": 1762546172,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return reference entries in g band (fid=1) for the specified ZTF object oids\nWITH wanted_oids (oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    r.rfid,        -- identifier of the reference\n    r.oid,         -- ZTF identifier\n    r.candid,      -- candidate identifier\n    r.magnr,       -- magnitude of nearest reference object\n    r.sigmagnr     -- uncertainty in magnr\nFROM reference r\nWHERE r.oid IN (SELECT oid FROM wanted_oids)\n  AND r.fid = 1   -- g band\nORDER BY r.oid, r.rfid;  -- sort by ZTF identifier (and by reference id for determinism)",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return reference entries in g band (fid=1) for the specified ZTF object oids\nWITH wanted_oids (oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    r.rfid,        -- identifier of the reference\n    r.oid,         -- ZTF identifier\n    r.candid,      -- candidate identifier\n    r.magnr,       -- magnitude of nearest reference object\n    r.sigmagnr     -- uncertainty in magnr\nFROM reference r\nWHERE r.oid IN (SELECT oid FROM wanted_oids)\n  AND r.fid = 1   -- g band\nORDER BY r.oid, r.rfid;  -- sort by ZTF identifier (and by reference id for determinism)"
                },
                "in_toks": 2300,
                "out_toks": 1149,
                "id": "chatcmpl-CZRCb1Y3JfddaKWJvpgR1bscg8PKO",
                "created": 1762562081,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "71",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 665,
                "out_toks": 1103,
                "id": "chatcmpl-CZN4lTdIXvB9Nv5SaZWjpEp6H2e96",
                "created": 1762546219,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- g-band (fid=1) reference rows for specified ZTF objects, returning rfid, oid, candid, magnr, sigmagnr\n\nSELECT r.rfid,\n       r.oid,\n       r.candid,\n       r.magnr,\n       r.sigmagnr\nFROM reference r\nWHERE r.fid = 1\n  AND r.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.oid IN ('ZTF20aczxeud',\n                     'ZTF21aappfdu',\n                     'ZTF22aacqjeb'))\nORDER BY r.oid,\n         r.rfid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- g-band (fid=1) reference rows for specified ZTF objects, returning rfid, oid, candid, magnr, sigmagnr\n\nSELECT r.rfid,\n       r.oid,\n       r.candid,\n       r.magnr,\n       r.sigmagnr\nFROM reference r\nWHERE r.fid = 1\n  AND r.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.oid IN ('ZTF20aczxeud',\n                     'ZTF21aappfdu',\n                     'ZTF22aacqjeb'))\nORDER BY r.oid,\n         r.rfid;"
                },
                "in_toks": 2782,
                "out_toks": 1295,
                "id": "chatcmpl-CaynN8nKxhWy2r0oKsYNhSbBXqlIF",
                "created": 1762929541,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "71",
            "experiment_id": "run_7",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 665,
                "out_toks": 652,
                "id": "chatcmpl-CZN5GMWT3DHM1XIhvSm9f7uc9tHPd",
                "created": 1762546250,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return reference ID, ZTF object ID, candidate ID, and nearest reference magnitude with its uncertainty\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,\n    oid,\n    candid,\n    magnr,\n    sigmagnr\nFROM reference\nWHERE fid = 1  -- g band (1=g; 2=r; 3=i)\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return reference ID, ZTF object ID, candidate ID, and nearest reference magnitude with its uncertainty\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,\n    oid,\n    candid,\n    magnr,\n    sigmagnr\nFROM reference\nWHERE fid = 1  -- g band (1=g; 2=r; 3=i)\n  AND oid IN (SELECT oid FROM target_oids)\nORDER BY oid;"
                },
                "in_toks": 2300,
                "out_toks": 1220,
                "id": "chatcmpl-CZRC384JM36rnWILF2lr82TzKCgTX",
                "created": 1762562047,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "71",
            "experiment_id": "run_8",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 665,
                "out_toks": 268,
                "id": "chatcmpl-CZN5TE7bWxdoVfMGrf9vu0xjaC3wa",
                "created": 1762546263,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find g-band (fid=1) reference rows for the given ZTF objects\n-- Returns: reference identifier (rfid), ZTF identifier (oid), candidate identifier (candid),\n-- and nearest reference magnitude with its uncertainty (magnr, sigmagnr), sorted by oid\nWITH oids (oid) AS (\n    VALUES\n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nWHERE r.fid = 1 -- g band\n  AND r.oid IN (SELECT oid FROM oids)\nORDER BY r.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find g-band (fid=1) reference rows for the given ZTF objects\n-- Returns: reference identifier (rfid), ZTF identifier (oid), candidate identifier (candid),\n-- and nearest reference magnitude with its uncertainty (magnr, sigmagnr), sorted by oid\nWITH oids (oid) AS (\n    VALUES\n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nWHERE r.fid = 1 -- g band\n  AND r.oid IN (SELECT oid FROM oids)\nORDER BY r.oid;"
                },
                "in_toks": 2300,
                "out_toks": 1516,
                "id": "chatcmpl-CZRCkvYgoh3vaExFlcIav8ugLl0RC",
                "created": 1762562090,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "71",
            "experiment_id": "run_9",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 665,
                "out_toks": 844,
                "id": "chatcmpl-CZN5aNefCOpZFtGN2FrEc0ybeHdnS",
                "created": 1762546270,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find g-band (fid=1) reference rows for the specified ZTF objects\nWITH targets (oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,        -- identifier of the reference\n    oid,         -- ZTF identifier\n    candid,      -- candidate identifier\n    magnr,       -- magnitude of nearest reference object\n    sigmagnr     -- 1-sigma uncertainty in magnr\nFROM reference\nWHERE fid = 1  -- g band\n  AND oid IN (SELECT oid FROM targets)\nORDER BY oid;  -- sort by ZTF identifier",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find g-band (fid=1) reference rows for the specified ZTF objects\nWITH targets (oid) AS (\n    VALUES \n        ('ZTF20aczxeud'),\n        ('ZTF21aappfdu'),\n        ('ZTF22aacqjeb')\n)\nSELECT\n    rfid,        -- identifier of the reference\n    oid,         -- ZTF identifier\n    candid,      -- candidate identifier\n    magnr,       -- magnitude of nearest reference object\n    sigmagnr     -- 1-sigma uncertainty in magnr\nFROM reference\nWHERE fid = 1  -- g band\n  AND oid IN (SELECT oid FROM targets)\nORDER BY oid;  -- sort by ZTF identifier"
                },
                "in_toks": 2300,
                "out_toks": 733,
                "id": "chatcmpl-CZRCIDrvMLoQqE3dhH9lEEPTWdsj6",
                "created": 1762562062,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "42": {
        "0": {
            "req_id": "42",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 662,
                "out_toks": 1309,
                "id": "chatcmpl-CSnYvWHiKzlPWMMmeI6drO3ClVgZf",
                "created": 1760979737,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all epochs in dataquality for the specified ZTF object, ordered by reduced chi-square (chipsf)\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF21aapnixl'\n)\nSELECT\n    dq.oid,            -- object identifier\n    dq.candid,         -- candidate identifier\n    dq.fid,            -- filter identifier (1=g; 2=r; 3=i)\n    dq.chipsf,         -- reduced chi-square\n    dq.fwhm,           -- FWHM from SExtractor\n    dq.classtar,       -- star/galaxy score from SExtractor\n    dq.nbad,           -- number of bad pixels\n    dq.magzpsci,       -- ZP magnitude\n    dq.magzpsciunc,    -- ZP magnitude uncertainty\n    dq.exptime         -- exposure time\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_oids)\nORDER BY dq.chipsf ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all epochs in dataquality for the specified ZTF object, ordered by reduced chi-square (chipsf)\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF21aapnixl'\n)\nSELECT\n    dq.oid,            -- object identifier\n    dq.candid,         -- candidate identifier\n    dq.fid,            -- filter identifier (1=g; 2=r; 3=i)\n    dq.chipsf,         -- reduced chi-square\n    dq.fwhm,           -- FWHM from SExtractor\n    dq.classtar,       -- star/galaxy score from SExtractor\n    dq.nbad,           -- number of bad pixels\n    dq.magzpsci,       -- ZP magnitude\n    dq.magzpsciunc,    -- ZP magnitude uncertainty\n    dq.exptime         -- exposure time\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_oids)\nORDER BY dq.chipsf ASC;"
                },
                "in_toks": 3210,
                "out_toks": 1055,
                "id": "chatcmpl-CSoGlD9fKyKoGfnu123nJnOmT2W2q",
                "created": 1760982455,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "42",
            "experiment_id": "run_1",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 662,
                "out_toks": 1309,
                "id": "chatcmpl-CSnYvWHiKzlPWMMmeI6drO3ClVgZf",
                "created": 1760979737,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all dataquality epochs for the specified ZTF object, sorted by reduced chi-square (chipsf)\nSELECT\n    oid,         -- object identifier\n    candid,      -- candidate identifier\n    fid,         -- filter identifier (1=g; 2=r; 3=i)\n    chipsf,      -- reduced chi-square for PSF-fit\n    fwhm,        -- FWHM from SExtractor [pixels]\n    classtar,    -- Star/Galaxy classification score from SExtractor\n    nbad,        -- number of prior-tagged bad pixels in a 5 x 5 pixel stamp\n    magzpsci,    -- magnitude zero point for photometry estimates [mag]\n    magzpsciunc, -- magnitude zero point uncertainty [mag]\n    exptime      -- exposure time [sec]\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all dataquality epochs for the specified ZTF object, sorted by reduced chi-square (chipsf)\nSELECT\n    oid,         -- object identifier\n    candid,      -- candidate identifier\n    fid,         -- filter identifier (1=g; 2=r; 3=i)\n    chipsf,      -- reduced chi-square for PSF-fit\n    fwhm,        -- FWHM from SExtractor [pixels]\n    classtar,    -- Star/Galaxy classification score from SExtractor\n    nbad,        -- number of prior-tagged bad pixels in a 5 x 5 pixel stamp\n    magzpsci,    -- magnitude zero point for photometry estimates [mag]\n    magzpsciunc, -- magnitude zero point uncertainty [mag]\n    exptime      -- exposure time [sec]\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;"
                },
                "in_toks": 2728,
                "out_toks": 1166,
                "id": "chatcmpl-CSoLUYtQ0fvC14CCoam9WBskujH3k",
                "created": 1760982748,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "42",
            "experiment_id": "run_2",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 662,
                "out_toks": 205,
                "id": "chatcmpl-CSsmo4CJ2g0gInD9eL8tWHaVAgIi9",
                "created": 1760999818,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all epochs in dataquality for the specified ZTF object, sorted by reduced chi-square (ascending)\nSELECT\n    oid,           -- object identifier\n    candid,        -- candidate identifier\n    fid,           -- filter identifier (1=g; 2=r; 3=i)\n    chipsf,        -- reduced chi-square for PSF-fit\n    fwhm,          -- Full Width Half Max from SExtractor [pixels]\n    classtar,      -- Star/Galaxy classification score from SExtractor\n    nbad,          -- number of prior-tagged bad pixels in a 5 x 5 pixel stamp\n    magzpsci,      -- magnitude zero point [mag]\n    magzpsciunc,   -- magnitude zero point uncertainty [mag]\n    exptime        -- exposure time [sec]\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf NULLS LAST;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all epochs in dataquality for the specified ZTF object, sorted by reduced chi-square (ascending)\nSELECT\n    oid,           -- object identifier\n    candid,        -- candidate identifier\n    fid,           -- filter identifier (1=g; 2=r; 3=i)\n    chipsf,        -- reduced chi-square for PSF-fit\n    fwhm,          -- Full Width Half Max from SExtractor [pixels]\n    classtar,      -- Star/Galaxy classification score from SExtractor\n    nbad,          -- number of prior-tagged bad pixels in a 5 x 5 pixel stamp\n    magzpsci,      -- magnitude zero point [mag]\n    magzpsciunc,   -- magnitude zero point uncertainty [mag]\n    exptime        -- exposure time [sec]\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf NULLS LAST;"
                },
                "in_toks": 2728,
                "out_toks": 971,
                "id": "chatcmpl-CSt1lCkJvsvMTk5daOXQAQQ1jO9d7",
                "created": 1761000745,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "42",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 662,
                "out_toks": 592,
                "id": "chatcmpl-CSsmsQhX4i6LU0HiUgfDcE03EiGrN",
                "created": 1760999822,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- All epochs in dataquality for object 'ZTF21aapnixl', sorted by reduced chi-square (chipsf)\nSELECT\n    oid,            -- object identifier\n    candid,         -- candidate identifier (epoch)\n    fid,            -- filter identifier (1=g; 2=r; 3=i)\n    chipsf,         -- reduced chi-square for PSF-fit\n    fwhm,           -- FWHM from SExtractor [pixels]\n    classtar,       -- Star/Galaxy classification score from SExtractor\n    nbad,           -- number of prior-tagged bad pixels in 5x5 stamp\n    magzpsci,       -- magnitude zero point [mag]\n    magzpsciunc,    -- magnitude zero point uncertainty [mag]\n    exptime         -- exposure time [sec]\nFROM dataquality\nWHERE oid IN (\n    -- prioritize obtaining OIDs in a subquery (from object table)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF21aapnixl'\n)\nORDER BY chipsf ASC NULLS LAST;",
            "original_sql_response": {
                "responses": {
                    "0": "-- All epochs in dataquality for object 'ZTF21aapnixl', sorted by reduced chi-square (chipsf)\nSELECT\n    oid,            -- object identifier\n    candid,         -- candidate identifier (epoch)\n    fid,            -- filter identifier (1=g; 2=r; 3=i)\n    chipsf,         -- reduced chi-square for PSF-fit\n    fwhm,           -- FWHM from SExtractor [pixels]\n    classtar,       -- Star/Galaxy classification score from SExtractor\n    nbad,           -- number of prior-tagged bad pixels in 5x5 stamp\n    magzpsci,       -- magnitude zero point [mag]\n    magzpsciunc,    -- magnitude zero point uncertainty [mag]\n    exptime         -- exposure time [sec]\nFROM dataquality\nWHERE oid IN (\n    -- prioritize obtaining OIDs in a subquery (from object table)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF21aapnixl'\n)\nORDER BY chipsf ASC NULLS LAST;"
                },
                "in_toks": 3210,
                "out_toks": 1004,
                "id": "chatcmpl-CSt1yoML2AkmiCwTPN90bnh0kGW2b",
                "created": 1761000758,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "42",
            "experiment_id": "run_4",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 662,
                "out_toks": 653,
                "id": "chatcmpl-CSsn172tt60haqYgtQcCM13fVzI8M",
                "created": 1760999831,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all epochs (rows) in dataquality for the specified ZTF object\n-- Return: oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime\n-- Sort by reduced chi-square (chipsf), placing NULLs last\nSELECT\n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all epochs (rows) in dataquality for the specified ZTF object\n-- Return: oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime\n-- Sort by reduced chi-square (chipsf), placing NULLs last\nSELECT\n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;"
                },
                "in_toks": 2728,
                "out_toks": 1172,
                "id": "chatcmpl-CSt2Cc4jUUO5KwdrljGCaVF5URzBv",
                "created": 1761000772,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "42",
            "experiment_id": "run_5",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 662,
                "out_toks": 269,
                "id": "chatcmpl-CZN62R4fw9T16br0kapf160ezIJ7G",
                "created": 1762546298,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- All dataquality epochs for object ZTF21aapnixl, sorted by reduced chi-square\nSELECT\n    oid,           -- object identifier\n    candid,        -- candidate identifier\n    fid,           -- filter identifier (1=g, 2=r, 3=i)\n    chipsf,        -- reduced chi-square for PSF-fit\n    fwhm,          -- FWHM from SExtractor [pixels]\n    classtar,      -- Star/Galaxy classification score from SExtractor\n    nbad,          -- number of prior-tagged bad pixels in 5x5 stamp\n    magzpsci,      -- magnitude zero point [mag]\n    magzpsciunc,   -- magnitude zero point uncertainty [mag]\n    exptime        -- exposure time [sec]\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;",
            "original_sql_response": {
                "responses": {
                    "0": "-- All dataquality epochs for object ZTF21aapnixl, sorted by reduced chi-square\nSELECT\n    oid,           -- object identifier\n    candid,        -- candidate identifier\n    fid,           -- filter identifier (1=g, 2=r, 3=i)\n    chipsf,        -- reduced chi-square for PSF-fit\n    fwhm,          -- FWHM from SExtractor [pixels]\n    classtar,      -- Star/Galaxy classification score from SExtractor\n    nbad,          -- number of prior-tagged bad pixels in 5x5 stamp\n    magzpsci,      -- magnitude zero point [mag]\n    magzpsciunc,   -- magnitude zero point uncertainty [mag]\n    exptime        -- exposure time [sec]\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;"
                },
                "in_toks": 2728,
                "out_toks": 1032,
                "id": "chatcmpl-CZRDSuxcb2ti8acPLWZ9MM1F2gzXr",
                "created": 1762562134,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "42",
            "experiment_id": "run_6",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 662,
                "out_toks": 333,
                "id": "chatcmpl-CZN69y2KyO0ClC4isCz0NHj4C8lrm",
                "created": 1762546305,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- All dataquality epochs for the object 'ZTF21aapnixl', sorted by reduced chi-square (ascending)\nSELECT\n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;",
            "original_sql_response": {
                "responses": {
                    "0": "-- All dataquality epochs for the object 'ZTF21aapnixl', sorted by reduced chi-square (ascending)\nSELECT\n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf ASC NULLS LAST;"
                },
                "in_toks": 2728,
                "out_toks": 874,
                "id": "chatcmpl-CZRCJAQExhSiUxafjDGdvGgC4vYYV",
                "created": 1762562063,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "42",
            "experiment_id": "run_7",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 662,
                "out_toks": 269,
                "id": "chatcmpl-CZN6FZvKZiyL7dpsXTHDbALTzhpD0",
                "created": 1762546311,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- All epochs in dataquality for the specified ZTF object, ordered by reduced chi-square (ascending)\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.fid,\n    dq.chipsf,\n    dq.fwhm,\n    dq.classtar,\n    dq.nbad,\n    dq.magzpsci,\n    dq.magzpsciunc,\n    dq.exptime\nFROM dataquality AS dq\nWHERE dq.oid = 'ZTF21aapnixl'\nORDER BY dq.chipsf ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- All epochs in dataquality for the specified ZTF object, ordered by reduced chi-square (ascending)\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.fid,\n    dq.chipsf,\n    dq.fwhm,\n    dq.classtar,\n    dq.nbad,\n    dq.magzpsci,\n    dq.magzpsciunc,\n    dq.exptime\nFROM dataquality AS dq\nWHERE dq.oid = 'ZTF21aapnixl'\nORDER BY dq.chipsf ASC;"
                },
                "in_toks": 2728,
                "out_toks": 1143,
                "id": "chatcmpl-CZRDYrUNfZeDtEzAspay7AMOJfAsT",
                "created": 1762562140,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "42",
            "experiment_id": "run_8",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 662,
                "out_toks": 461,
                "id": "chatcmpl-CZN6Majy6sTj51iksQp4GDh11Dobr",
                "created": 1762546318,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all epochs in dataquality for the object 'ZTF21aapnixl'\n-- Return: object (oid), candidate (candid), filter (fid), reduced chi-square (chipsf),\n-- FWHM (fwhm), star/galaxy score (classtar), number of bad pixels (nbad),\n-- ZP magnitude and its uncertainty (magzpsci, magzpsciunc), and exposure time (exptime)\n-- Sorted by reduced chi-square ascending\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.fid,\n    dq.chipsf,\n    dq.fwhm,\n    dq.classtar,\n    dq.nbad,\n    dq.magzpsci,\n    dq.magzpsciunc,\n    dq.exptime\nFROM dataquality dq\nWHERE dq.oid IN (\n    -- Prioritize obtaining OIDs in a subquery\n    SELECT DISTINCT oid\n    FROM dataquality\n    WHERE oid = 'ZTF21aapnixl'\n)\nORDER BY dq.chipsf ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all epochs in dataquality for the object 'ZTF21aapnixl'\n-- Return: object (oid), candidate (candid), filter (fid), reduced chi-square (chipsf),\n-- FWHM (fwhm), star/galaxy score (classtar), number of bad pixels (nbad),\n-- ZP magnitude and its uncertainty (magzpsci, magzpsciunc), and exposure time (exptime)\n-- Sorted by reduced chi-square ascending\nSELECT\n    dq.oid,\n    dq.candid,\n    dq.fid,\n    dq.chipsf,\n    dq.fwhm,\n    dq.classtar,\n    dq.nbad,\n    dq.magzpsci,\n    dq.magzpsciunc,\n    dq.exptime\nFROM dataquality dq\nWHERE dq.oid IN (\n    -- Prioritize obtaining OIDs in a subquery\n    SELECT DISTINCT oid\n    FROM dataquality\n    WHERE oid = 'ZTF21aapnixl'\n)\nORDER BY dq.chipsf ASC;"
                },
                "in_toks": 2728,
                "out_toks": 1188,
                "id": "chatcmpl-CZRClrXL5lWO8Q8eByA3rDxpmUfeU",
                "created": 1762562091,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "42",
            "experiment_id": "run_9",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 662,
                "out_toks": 525,
                "id": "chatcmpl-CZN6ZoML0uSk0AL0wxzLaigbSgQTs",
                "created": 1762546331,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all epochs in dataquality for the specified ZTF object, sorted by reduced chi-square\nWITH target_oids (oid) AS (\n    VALUES ('ZTF21aapnixl')\n)\nSELECT\n    dq.oid,           -- object\n    dq.candid,        -- candidate identifier\n    dq.fid,           -- filter identifier (1=g; 2=r; 3=i)\n    dq.chipsf,        -- reduced chi-square for PSF-fit\n    dq.fwhm,          -- FWHM from SExtractor [pixels]\n    dq.classtar,      -- star/galaxy score from SExtractor\n    dq.nbad,          -- number of bad pixels in 5x5 stamp\n    dq.magzpsci,      -- magnitude zero point [mag]\n    dq.magzpsciunc,   -- magnitude zero point uncertainty [mag]\n    dq.exptime        -- exposure time [sec]\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\nORDER BY dq.chipsf ASC NULLS LAST;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all epochs in dataquality for the specified ZTF object, sorted by reduced chi-square\nWITH target_oids (oid) AS (\n    VALUES ('ZTF21aapnixl')\n)\nSELECT\n    dq.oid,           -- object\n    dq.candid,        -- candidate identifier\n    dq.fid,           -- filter identifier (1=g; 2=r; 3=i)\n    dq.chipsf,        -- reduced chi-square for PSF-fit\n    dq.fwhm,          -- FWHM from SExtractor [pixels]\n    dq.classtar,      -- star/galaxy score from SExtractor\n    dq.nbad,          -- number of bad pixels in 5x5 stamp\n    dq.magzpsci,      -- magnitude zero point [mag]\n    dq.magzpsciunc,   -- magnitude zero point uncertainty [mag]\n    dq.exptime        -- exposure time [sec]\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_oids)\nORDER BY dq.chipsf ASC NULLS LAST;"
                },
                "in_toks": 2728,
                "out_toks": 1065,
                "id": "chatcmpl-CZRDwcF9dhE81XhVKZJt2zevX5J7P",
                "created": 1762562164,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "107": {
        "0": {
            "req_id": "107",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'ss_ztf', 'detection']",
                    "1": "['object', 'probability', 'detection', 'ss_ztf']"
                },
                "in_toks": 699,
                "out_toks": 3383,
                "id": "chatcmpl-CSnZClff7cK1dHHZI9MYXhmRFTB2F",
                "created": 1760979754,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 10 ZTF objects with >500 detections, asteroid probability >0.5 in stamp_classifier_1.0.4,\n-- and nearest Solar System object within 2 arcsec. Return requested columns and order by first detection date.\nWITH asteroid_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n)\nSELECT\n    o.oid,                           -- ZTF identifier\n    o.ndet,                          -- number of detections\n    o.firstmjd,                      -- first detection date (MJD)\n    o.lastmjd,                       -- last detection date (MJD)\n    /* asteroid probability from the specified stamp classifier version */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'asteroid'\n    ) AS probability,\n    /* candidate identifier associated to the nearest Solar System object match */\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n    /* distance (arcsec) to nearest known Solar System object */\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    /* MPC name of the nearest Solar System object */\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    /* detection date and filter of that candidate */\n    (\n        SELECT d.mjd\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS detection_mjd,\n    (\n        SELECT d.fid\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS fid\nFROM object o\nWHERE o.ndet > 500\n  AND o.oid IN (SELECT oid FROM asteroid_oids)\n  AND o.oid IN (\n      SELECT s.oid\n      FROM ss_ztf s\n      WHERE s.ssdistnr < 2  -- arcseconds\n  )\nORDER BY o.firstmjd\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 10 ZTF objects with >500 detections, asteroid probability >0.5 in stamp_classifier_1.0.4,\n-- and nearest Solar System object within 2 arcsec. Return requested columns and order by first detection date.\nWITH asteroid_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n)\nSELECT\n    o.oid,                           -- ZTF identifier\n    o.ndet,                          -- number of detections\n    o.firstmjd,                      -- first detection date (MJD)\n    o.lastmjd,                       -- last detection date (MJD)\n    /* asteroid probability from the specified stamp classifier version */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'asteroid'\n    ) AS probability,\n    /* candidate identifier associated to the nearest Solar System object match */\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n    /* distance (arcsec) to nearest known Solar System object */\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    /* MPC name of the nearest Solar System object */\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    /* detection date and filter of that candidate */\n    (\n        SELECT d.mjd\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS detection_mjd,\n    (\n        SELECT d.fid\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS fid\nFROM object o\nWHERE o.ndet > 500\n  AND o.oid IN (SELECT oid FROM asteroid_oids)\n  AND o.oid IN (\n      SELECT s.oid\n      FROM ss_ztf s\n      WHERE s.ssdistnr < 2  -- arcseconds\n  )\nORDER BY o.firstmjd\nLIMIT 10;"
                },
                "in_toks": 3388,
                "out_toks": 3629,
                "id": "chatcmpl-CSoGvWmXl5CvVf7z1swoNPvHg9e3t",
                "created": 1760982465,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "107",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'ss_ztf', 'detection']",
                    "1": "['object', 'probability', 'detection', 'ss_ztf']"
                },
                "in_toks": 699,
                "out_toks": 3383,
                "id": "chatcmpl-CSnZClff7cK1dHHZI9MYXhmRFTB2F",
                "created": 1760979754,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- At most 10 ZTF objects with:\n-- - ndet > 500\n-- - stamp_classifier (version 'stamp_classifier_1.0.4') asteroid probability > 0.5\n-- - nearest Solar System object distance < 2 arcsec\n-- Returns: oid, ndet, first/last mjd, probability, candid, ssdistnr, ssnamenr, detection mjd and fid (for that candid)\nSELECT\n  o.oid AS ztf_oid,\n  o.ndet,\n  o.firstmjd,\n  o.lastmjd,\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid') AS probability,\n  (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n  (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n  (SELECT d.mjd\n   FROM detection d\n   WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS detection_mjd,\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS fid\nFROM object o\nWHERE\n  o.ndet > 500\n  AND o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n  )\n  AND o.oid IN (\n    SELECT s.oid\n    FROM ss_ztf s\n    WHERE s.ssdistnr < 2\n  )\nORDER BY o.firstmjd\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "-- At most 10 ZTF objects with:\n-- - ndet > 500\n-- - stamp_classifier (version 'stamp_classifier_1.0.4') asteroid probability > 0.5\n-- - nearest Solar System object distance < 2 arcsec\n-- Returns: oid, ndet, first/last mjd, probability, candid, ssdistnr, ssnamenr, detection mjd and fid (for that candid)\nSELECT\n  o.oid AS ztf_oid,\n  o.ndet,\n  o.firstmjd,\n  o.lastmjd,\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid') AS probability,\n  (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n  (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n  (SELECT d.mjd\n   FROM detection d\n   WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS detection_mjd,\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS fid\nFROM object o\nWHERE\n  o.ndet > 500\n  AND o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n  )\n  AND o.oid IN (\n    SELECT s.oid\n    FROM ss_ztf s\n    WHERE s.ssdistnr < 2\n  )\nORDER BY o.firstmjd\nLIMIT 10;"
                },
                "in_toks": 3343,
                "out_toks": 2663,
                "id": "chatcmpl-CSoHTSoYRYqosaRXC8t8XYXXvsfel",
                "created": 1760982499,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "107",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ss_ztf', 'detection']"
                },
                "in_toks": 699,
                "out_toks": 1882,
                "id": "chatcmpl-CSsn9pIYJXP1Alhqrg2gWTwCBlLCs",
                "created": 1760999839,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 10 ZTF objects with:\n   - ndet > 500\n   - stamp_classifier (version 'stamp_classifier_1.0.4') asteroid probability > 0.5\n   - nearest Solar System object distance < 2 arcsec\n   Return: oid, ndet, firstmjd, lastmjd, probability, candid, ssdistnr, ssnamenr, mjd, fid\n   Ordered by first detection date (firstmjd)\n*/\nWITH good_prob AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n),\ngood_ss AS (\n    SELECT s.oid, s.candid, s.ssdistnr, s.ssnamenr\n    FROM ss_ztf s\n    WHERE s.ssdistnr < 2\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    /* asteroid probability from the specified stamp classifier version */\n    (SELECT gp.probability FROM good_prob gp WHERE gp.oid = o.oid) AS probability,\n    /* candidate identifier and Solar System match info */\n    (SELECT gs.candid FROM good_ss gs WHERE gs.oid = o.oid) AS candid,\n    (SELECT gs.ssdistnr FROM good_ss gs WHERE gs.oid = o.oid) AS ssdistnr,\n    (SELECT gs.ssnamenr FROM good_ss gs WHERE gs.oid = o.oid) AS ssnamenr,\n    /* detection date and filter for the matched candidate */\n    (SELECT d.mjd FROM detection d WHERE d.candid = (SELECT gs.candid FROM good_ss gs WHERE gs.oid = o.oid)) AS mjd,\n    (SELECT d.fid FROM detection d WHERE d.candid = (SELECT gs.candid FROM good_ss gs WHERE gs.oid = o.oid)) AS fid\nFROM object o\nWHERE o.ndet > 500\n  AND o.oid IN (SELECT gp.oid FROM good_prob gp)\n  AND o.oid IN (SELECT gs.oid FROM good_ss gs)\nORDER BY o.firstmjd\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 10 ZTF objects with:\n   - ndet > 500\n   - stamp_classifier (version 'stamp_classifier_1.0.4') asteroid probability > 0.5\n   - nearest Solar System object distance < 2 arcsec\n   Return: oid, ndet, firstmjd, lastmjd, probability, candid, ssdistnr, ssnamenr, mjd, fid\n   Ordered by first detection date (firstmjd)\n*/\nWITH good_prob AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n),\ngood_ss AS (\n    SELECT s.oid, s.candid, s.ssdistnr, s.ssnamenr\n    FROM ss_ztf s\n    WHERE s.ssdistnr < 2\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    /* asteroid probability from the specified stamp classifier version */\n    (SELECT gp.probability FROM good_prob gp WHERE gp.oid = o.oid) AS probability,\n    /* candidate identifier and Solar System match info */\n    (SELECT gs.candid FROM good_ss gs WHERE gs.oid = o.oid) AS candid,\n    (SELECT gs.ssdistnr FROM good_ss gs WHERE gs.oid = o.oid) AS ssdistnr,\n    (SELECT gs.ssnamenr FROM good_ss gs WHERE gs.oid = o.oid) AS ssnamenr,\n    /* detection date and filter for the matched candidate */\n    (SELECT d.mjd FROM detection d WHERE d.candid = (SELECT gs.candid FROM good_ss gs WHERE gs.oid = o.oid)) AS mjd,\n    (SELECT d.fid FROM detection d WHERE d.candid = (SELECT gs.candid FROM good_ss gs WHERE gs.oid = o.oid)) AS fid\nFROM object o\nWHERE o.ndet > 500\n  AND o.oid IN (SELECT gp.oid FROM good_prob gp)\n  AND o.oid IN (SELECT gs.oid FROM good_ss gs)\nORDER BY o.firstmjd\nLIMIT 10;"
                },
                "in_toks": 3343,
                "out_toks": 3070,
                "id": "chatcmpl-CSt2XSzQflUOG0naLUF0bbwnRw5rI",
                "created": 1761000793,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "107",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'ss_ztf', 'detection']"
                },
                "in_toks": 699,
                "out_toks": 2333,
                "id": "chatcmpl-CSsnmG0DawwKMevx2QRXkTYJdeQlN",
                "created": 1760999878,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 10 ZTF objects meeting:\n-- - ndet > 500\n-- - stamp_classifier (v=stamp_classifier_1.0.4) asteroid probability > 0.5\n-- - nearest Solar System object distance < 2 arcsec\n-- Return requested columns and order by firstmjd\n\nWITH prob_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n),\nss_oids AS (\n    SELECT s.oid\n    FROM ss_ztf s\n    WHERE s.ssdistnr < 2\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    /* asteroid probability from the specified stamp classifier/version */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'asteroid'\n    ) AS probability,\n    /* candidate identifier associated with the SS match */\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n    /* distance (arcsec) to nearest known Solar System object */\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    /* MPC name of the nearest SS object */\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    /* detection date and filter for that candidate */\n    (\n        SELECT d.mjd\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS mjd,\n    (\n        SELECT d.fid\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS fid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM prob_oids)\n  AND o.oid IN (SELECT oid FROM ss_oids)\n  AND o.ndet > 500\nORDER BY o.firstmjd\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 10 ZTF objects meeting:\n-- - ndet > 500\n-- - stamp_classifier (v=stamp_classifier_1.0.4) asteroid probability > 0.5\n-- - nearest Solar System object distance < 2 arcsec\n-- Return requested columns and order by firstmjd\n\nWITH prob_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.5\n),\nss_oids AS (\n    SELECT s.oid\n    FROM ss_ztf s\n    WHERE s.ssdistnr < 2\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    /* asteroid probability from the specified stamp classifier/version */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'asteroid'\n    ) AS probability,\n    /* candidate identifier associated with the SS match */\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n    /* distance (arcsec) to nearest known Solar System object */\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    /* MPC name of the nearest SS object */\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    /* detection date and filter for that candidate */\n    (\n        SELECT d.mjd\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS mjd,\n    (\n        SELECT d.fid\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS fid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM prob_oids)\n  AND o.oid IN (SELECT oid FROM ss_oids)\n  AND o.ndet > 500\nORDER BY o.firstmjd\nLIMIT 10;"
                },
                "in_toks": 3388,
                "out_toks": 3870,
                "id": "chatcmpl-CSt3D8sVfiZIX27egMwsm6a1uuxHa",
                "created": 1761000835,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "107",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'ss_ztf', 'detection']"
                },
                "in_toks": 699,
                "out_toks": 2013,
                "id": "chatcmpl-CSsoEBzpPjWUwbJkLFLfZ5N4YLVRm",
                "created": 1760999906,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find up to 10 ZTF objects with:\n   - ndet > 500\n   - stamp_classifier (version 'stamp_classifier_1.0.4') asteroid probability > 0.5\n   - nearest Solar System object distance < 2 arcsec\n   Return requested columns and order by first detection date (firstmjd).\n*/\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500\n      AND EXISTS (\n          SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.class_name = 'asteroid'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.classifier_version = 'stamp_classifier_1.0.4'\n            AND p.probability > 0.5\n      )\n      AND EXISTS (\n          SELECT 1\n          FROM ss_ztf s\n          WHERE s.oid = o.oid\n            AND s.ssdistnr < 2\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT\n    o.oid,                                   -- ZTF identifier\n    o.ndet,                                  -- number of detections\n    o.firstmjd,                              -- first detection date\n    o.lastmjd,                               -- last detection date\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'asteroid'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4') AS probability,  -- asteroid prob (stamp classifier)\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,            -- candidate identifier\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,        -- distance to nearest SS object (arcsec)\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,        -- MPC name (may be null)\n    (SELECT d.mjd\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS detection_mjd,  -- detection date for that candid\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS fid              -- filter identifier for that candid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_oids)\nORDER BY o.firstmjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find up to 10 ZTF objects with:\n   - ndet > 500\n   - stamp_classifier (version 'stamp_classifier_1.0.4') asteroid probability > 0.5\n   - nearest Solar System object distance < 2 arcsec\n   Return requested columns and order by first detection date (firstmjd).\n*/\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500\n      AND EXISTS (\n          SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.class_name = 'asteroid'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.classifier_version = 'stamp_classifier_1.0.4'\n            AND p.probability > 0.5\n      )\n      AND EXISTS (\n          SELECT 1\n          FROM ss_ztf s\n          WHERE s.oid = o.oid\n            AND s.ssdistnr < 2\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\nSELECT\n    o.oid,                                   -- ZTF identifier\n    o.ndet,                                  -- number of detections\n    o.firstmjd,                              -- first detection date\n    o.lastmjd,                               -- last detection date\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'asteroid'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4') AS probability,  -- asteroid prob (stamp classifier)\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,            -- candidate identifier\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,        -- distance to nearest SS object (arcsec)\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,        -- MPC name (may be null)\n    (SELECT d.mjd\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS detection_mjd,  -- detection date for that candid\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS fid              -- filter identifier for that candid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_oids)\nORDER BY o.firstmjd;"
                },
                "in_toks": 3388,
                "out_toks": 3532,
                "id": "chatcmpl-CSt45dQHrbKGa0zVwFpDHk113X7VZ",
                "created": 1761000889,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "107",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ss_ztf', 'detection']"
                },
                "in_toks": 699,
                "out_toks": 1370,
                "id": "chatcmpl-CZN6l4GpDapXCAXAotfzDAWB11PiA",
                "created": 1762546343,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 10 ZTF objects with >500 detections, asteroid P>0.5 in stamp_classifier_1.0.4, and ss nearest distance < 2\"\nWITH filtered_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.ndet > 500\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.5)\n     AND EXISTS\n       (SELECT 1\n        FROM ss_ztf s\n        WHERE s.oid = o.oid\n          AND s.ssdistnr < 2)\n   ORDER BY o.firstmjd\n   LIMIT 10)\nSELECT o.oid,\n       o.ndet,\n       o.firstmjd,\n       o.lastmjd,\n\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n   ORDER BY p.probability DESC\n   LIMIT 1) AS probability,\n\n  (SELECT s.candid\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS candid,\n\n  (SELECT s.ssdistnr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssdistnr,\n\n  (SELECT s.ssnamenr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssnamenr,\n\n  (SELECT d.mjd\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s.candid\n        FROM ss_ztf s\n        WHERE s.oid = o.oid)) AS mjd,\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s.candid\n        FROM ss_ztf s\n        WHERE s.oid = o.oid)) AS fid\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM filtered_oids)\nORDER BY o.firstmjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 10 ZTF objects with >500 detections, asteroid P>0.5 in stamp_classifier_1.0.4, and ss nearest distance < 2\"\nWITH filtered_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.ndet > 500\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'asteroid'\n          AND p.probability > 0.5)\n     AND EXISTS\n       (SELECT 1\n        FROM ss_ztf s\n        WHERE s.oid = o.oid\n          AND s.ssdistnr < 2)\n   ORDER BY o.firstmjd\n   LIMIT 10)\nSELECT o.oid,\n       o.ndet,\n       o.firstmjd,\n       o.lastmjd,\n\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n   ORDER BY p.probability DESC\n   LIMIT 1) AS probability,\n\n  (SELECT s.candid\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS candid,\n\n  (SELECT s.ssdistnr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssdistnr,\n\n  (SELECT s.ssnamenr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssnamenr,\n\n  (SELECT d.mjd\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s.candid\n        FROM ss_ztf s\n        WHERE s.oid = o.oid)) AS mjd,\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s.candid\n        FROM ss_ztf s\n        WHERE s.oid = o.oid)) AS fid\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM filtered_oids)\nORDER BY o.firstmjd;"
                },
                "in_toks": 3343,
                "out_toks": 3250,
                "id": "chatcmpl-Cayne2Q7uw19oZowUGa3axYyqv2OX",
                "created": 1762929558,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "107",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ss_ztf', 'detection']"
                },
                "in_toks": 699,
                "out_toks": 1754,
                "id": "chatcmpl-CZN7GAbn9VDWvCBQ05kyczBsCJPDt",
                "created": 1762546374,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH qualifying_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500  -- more than 500 detections\n      AND EXISTS (\n          SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.classifier_version = 'stamp_classifier_1.0.4'\n            AND p.class_name = 'asteroid'\n            AND p.probability > 0.5  -- probability larger than 0.5\n      )\n      AND EXISTS (\n          SELECT 1\n          FROM ss_ztf s\n          WHERE s.oid = o.oid\n            AND s.ssdistnr < 2  -- distance to nearest Solar System object below 2 arcsec\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10  -- return at most 10 objects\n)\nSELECT\n    o.oid,                        -- ZTF identifier\n    o.ndet,                       -- number of detections\n    o.firstmjd,                   -- first detection date\n    o.lastmjd,                    -- last detection date\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4'\n       AND p.class_name = 'asteroid') AS probability,  -- asteroid probability\n    (SELECT s.candid\n     FROM ss_ztf s\n     WHERE s.oid = o.oid) AS candid,                   -- candidate identifier\n    (SELECT s.ssdistnr\n     FROM ss_ztf s\n     WHERE s.oid = o.oid) AS ssdistnr,                 -- distance between ZTF object and MPC object (arcsec)\n    (SELECT s.ssnamenr\n     FROM ss_ztf s\n     WHERE s.oid = o.oid) AS ssnamenr,                 -- MPC name\n    (SELECT d.mjd\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS mjd,  -- detection date for that candid\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS fid   -- filter identifier for that candid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM qualifying_oids)\nORDER BY o.firstmjd;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH qualifying_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500  -- more than 500 detections\n      AND EXISTS (\n          SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.classifier_version = 'stamp_classifier_1.0.4'\n            AND p.class_name = 'asteroid'\n            AND p.probability > 0.5  -- probability larger than 0.5\n      )\n      AND EXISTS (\n          SELECT 1\n          FROM ss_ztf s\n          WHERE s.oid = o.oid\n            AND s.ssdistnr < 2  -- distance to nearest Solar System object below 2 arcsec\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10  -- return at most 10 objects\n)\nSELECT\n    o.oid,                        -- ZTF identifier\n    o.ndet,                       -- number of detections\n    o.firstmjd,                   -- first detection date\n    o.lastmjd,                    -- last detection date\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4'\n       AND p.class_name = 'asteroid') AS probability,  -- asteroid probability\n    (SELECT s.candid\n     FROM ss_ztf s\n     WHERE s.oid = o.oid) AS candid,                   -- candidate identifier\n    (SELECT s.ssdistnr\n     FROM ss_ztf s\n     WHERE s.oid = o.oid) AS ssdistnr,                 -- distance between ZTF object and MPC object (arcsec)\n    (SELECT s.ssnamenr\n     FROM ss_ztf s\n     WHERE s.oid = o.oid) AS ssnamenr,                 -- MPC name\n    (SELECT d.mjd\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS mjd,  -- detection date for that candid\n    (SELECT d.fid\n     FROM detection d\n     WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)) AS fid   -- filter identifier for that candid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM qualifying_oids)\nORDER BY o.firstmjd;"
                },
                "in_toks": 3343,
                "out_toks": 3184,
                "id": "chatcmpl-CZREHyYWIv2mZIPP1LbZ34VabAyaW",
                "created": 1762562185,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "107",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "step",
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'step', 'ss_ztf', 'detection']"
                },
                "in_toks": 699,
                "out_toks": 1632,
                "id": "chatcmpl-CZN7mQ9Q4wukBdUPN6XXcZnzTRVkd",
                "created": 1762546406,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS\n  (/* OIDs with asteroid probability > 0.5 in stamp_classifier_1.0.4 and ss distance < 2 arcsec */  SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.5 INTERSECT\n     SELECT s.oid\n     FROM ss_ztf s WHERE s.ssdistnr < 2.0)\nSELECT o.oid, -- ZTF identifier\n o.ndet, -- number of detections\n o.firstmjd, -- first detection date\n o.lastmjd, -- last detection date\n\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid') AS probability,\n\n  (SELECT s.candid\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS candid, -- candidate identifier\n\n  (SELECT s.ssdistnr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssdistnr, -- distance to MPC object (arcsec)\n\n  (SELECT s.ssnamenr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssnamenr, -- MPC name\n\n  (SELECT d.mjd\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s.candid\n        FROM ss_ztf s\n        WHERE s.oid = o.oid)) AS mjd, -- detection date\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s.candid\n        FROM ss_ztf s\n        WHERE s.oid = o.oid)) AS fid -- filter identifier\nFROM OBJECT o\nWHERE o.ndet > 500\n  AND o.oid IN\n    (SELECT oid\n     FROM selected_oids)\nORDER BY o.firstmjd\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS\n  (/* OIDs with asteroid probability > 0.5 in stamp_classifier_1.0.4 and ss distance < 2 arcsec */  SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.5 INTERSECT\n     SELECT s.oid\n     FROM ss_ztf s WHERE s.ssdistnr < 2.0)\nSELECT o.oid, -- ZTF identifier\n o.ndet, -- number of detections\n o.firstmjd, -- first detection date\n o.lastmjd, -- last detection date\n\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid') AS probability,\n\n  (SELECT s.candid\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS candid, -- candidate identifier\n\n  (SELECT s.ssdistnr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssdistnr, -- distance to MPC object (arcsec)\n\n  (SELECT s.ssnamenr\n   FROM ss_ztf s\n   WHERE s.oid = o.oid) AS ssnamenr, -- MPC name\n\n  (SELECT d.mjd\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s.candid\n        FROM ss_ztf s\n        WHERE s.oid = o.oid)) AS mjd, -- detection date\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s.candid\n        FROM ss_ztf s\n        WHERE s.oid = o.oid)) AS fid -- filter identifier\nFROM OBJECT o\nWHERE o.ndet > 500\n  AND o.oid IN\n    (SELECT oid\n     FROM selected_oids)\nORDER BY o.firstmjd\nLIMIT 10;"
                },
                "in_toks": 3460,
                "out_toks": 3362,
                "id": "chatcmpl-CayoFZUNQgtg2WRIeMXF8yZ1c6JO5",
                "created": 1762929595,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "107",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'ss_ztf', 'detection']"
                },
                "in_toks": 699,
                "out_toks": 1373,
                "id": "chatcmpl-CZN8EDLWYEyENDv7tSyiwxzTO7VyH",
                "created": 1762546434,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find at most 10 ZTF objects with:\n   - ndet > 500\n   - stamp_classifier (version 'stamp_classifier_1.0.4') class 'asteroid' probability > 0.5\n   - nearest Solar System object distance < 2 arcsec\n   Return: oid, ndet, firstmjd, lastmjd, probability, candid, ssdistnr, ssnamenr, detection mjd, detection fid\n   Ordered by firstmjd\n*/\nWITH prob_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.5\n),\noid_candidates AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500\n      AND o.oid IN (SELECT oid FROM prob_oids)\n      AND o.oid IN (\n          SELECT s.oid\n          FROM ss_ztf s\n          WHERE s.ssdistnr < 2\n      )\n)\nSELECT\n    o.oid AS oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    /* Probability from the specified stamp classifier and version */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n    ) AS probability,\n    /* Candidate identifier and SS info from ss_ztf */\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    /* Detection date and filter identifier for that candidate */\n    (\n        SELECT d.mjd\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS detection_mjd,\n    (\n        SELECT d.fid\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS fid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM oid_candidates)\nORDER BY o.firstmjd\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find at most 10 ZTF objects with:\n   - ndet > 500\n   - stamp_classifier (version 'stamp_classifier_1.0.4') class 'asteroid' probability > 0.5\n   - nearest Solar System object distance < 2 arcsec\n   Return: oid, ndet, firstmjd, lastmjd, probability, candid, ssdistnr, ssnamenr, detection mjd, detection fid\n   Ordered by firstmjd\n*/\nWITH prob_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.5\n),\noid_candidates AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500\n      AND o.oid IN (SELECT oid FROM prob_oids)\n      AND o.oid IN (\n          SELECT s.oid\n          FROM ss_ztf s\n          WHERE s.ssdistnr < 2\n      )\n)\nSELECT\n    o.oid AS oid,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    /* Probability from the specified stamp classifier and version */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'asteroid'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n    ) AS probability,\n    /* Candidate identifier and SS info from ss_ztf */\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid) AS candid,\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = o.oid) AS ssdistnr,\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = o.oid) AS ssnamenr,\n    /* Detection date and filter identifier for that candidate */\n    (\n        SELECT d.mjd\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS detection_mjd,\n    (\n        SELECT d.fid\n        FROM detection d\n        WHERE d.candid = (SELECT s.candid FROM ss_ztf s WHERE s.oid = o.oid)\n    ) AS fid\nFROM object o\nWHERE o.oid IN (SELECT oid FROM oid_candidates)\nORDER BY o.firstmjd\nLIMIT 10;"
                },
                "in_toks": 3388,
                "out_toks": 2948,
                "id": "chatcmpl-CZRESwr9TUWG6AjSPt6Litru7beAs",
                "created": 1762562196,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "107",
            "experiment_id": "run_9",
            "pred_tables": [
                "detection",
                "probability",
                "taxonomy",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'probability', 'taxonomy', 'ss_ztf']"
                },
                "in_toks": 699,
                "out_toks": 2970,
                "id": "chatcmpl-CZN8qHk45N9Af7Kw1vUHmeFQ4Okio",
                "created": 1762546472,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 10 ZTF objects with >500 detections, asteroid prob>0.5 in stamp_classifier_1.0.4, and ss distance <2 arcsec\nWITH candidate_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.5),\n     det_stats AS\n  (SELECT d.oid,\n          COUNT(*) AS n_det,\n          MIN(d.mjd) AS first_mjd,\n          MAX(d.mjd) AS last_mjd\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM candidate_oids)\n   GROUP BY d.oid\n   HAVING COUNT(*) > 500),\n     ss_filtered AS\n  (SELECT s.oid,\n          s.candid,\n          s.ssdistnr,\n          s.ssnamenr\n   FROM ss_ztf s\n   WHERE s.oid IN\n       (SELECT oid\n        FROM det_stats)\n     AND s.ssdistnr < 2)\nSELECT ds.oid AS ztf_oid,\n       ds.n_det AS n_detections,\n       ds.first_mjd AS first_detection_mjd,\n       ds.last_mjd AS last_detection_mjd,\n\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = ds.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid') AS probability,\n\n  (SELECT s.candid\n   FROM ss_filtered s\n   WHERE s.oid = ds.oid) AS candid,\n\n  (SELECT s.ssdistnr\n   FROM ss_filtered s\n   WHERE s.oid = ds.oid) AS ssdistnr_arcsec,\n\n  (SELECT s.ssnamenr\n   FROM ss_filtered s\n   WHERE s.oid = ds.oid) AS mpc_name,\n\n  (SELECT d.mjd\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s2.candid\n        FROM ss_filtered s2\n        WHERE s2.oid = ds.oid)) AS detection_mjd,\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s2.candid\n        FROM ss_filtered s2\n        WHERE s2.oid = ds.oid)) AS fid\nFROM det_stats ds\nWHERE ds.oid IN\n    (SELECT oid\n     FROM ss_filtered)\nORDER BY ds.first_mjd\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 10 ZTF objects with >500 detections, asteroid prob>0.5 in stamp_classifier_1.0.4, and ss distance <2 arcsec\nWITH candidate_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid'\n     AND p.probability > 0.5),\n     det_stats AS\n  (SELECT d.oid,\n          COUNT(*) AS n_det,\n          MIN(d.mjd) AS first_mjd,\n          MAX(d.mjd) AS last_mjd\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM candidate_oids)\n   GROUP BY d.oid\n   HAVING COUNT(*) > 500),\n     ss_filtered AS\n  (SELECT s.oid,\n          s.candid,\n          s.ssdistnr,\n          s.ssnamenr\n   FROM ss_ztf s\n   WHERE s.oid IN\n       (SELECT oid\n        FROM det_stats)\n     AND s.ssdistnr < 2)\nSELECT ds.oid AS ztf_oid,\n       ds.n_det AS n_detections,\n       ds.first_mjd AS first_detection_mjd,\n       ds.last_mjd AS last_detection_mjd,\n\n  (SELECT p.probability\n   FROM probability p\n   WHERE p.oid = ds.oid\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'asteroid') AS probability,\n\n  (SELECT s.candid\n   FROM ss_filtered s\n   WHERE s.oid = ds.oid) AS candid,\n\n  (SELECT s.ssdistnr\n   FROM ss_filtered s\n   WHERE s.oid = ds.oid) AS ssdistnr_arcsec,\n\n  (SELECT s.ssnamenr\n   FROM ss_filtered s\n   WHERE s.oid = ds.oid) AS mpc_name,\n\n  (SELECT d.mjd\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s2.candid\n        FROM ss_filtered s2\n        WHERE s2.oid = ds.oid)) AS detection_mjd,\n\n  (SELECT d.fid\n   FROM detection d\n   WHERE d.candid =\n       (SELECT s2.candid\n        FROM ss_filtered s2\n        WHERE s2.oid = ds.oid)) AS fid\nFROM det_stats ds\nWHERE ds.oid IN\n    (SELECT oid\n     FROM ss_filtered)\nORDER BY ds.first_mjd\nLIMIT 10;"
                },
                "in_toks": 2906,
                "out_toks": 3944,
                "id": "chatcmpl-CayowqLrtmx8Ys8NzvWf16KeVCiRj",
                "created": 1762929638,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "83": {
        "0": {
            "req_id": "83",
            "experiment_id": "run_0",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 608,
                "out_toks": 666,
                "id": "chatcmpl-CSnZdRa7zHLwhlRnHvVrEGbYBdw27",
                "created": 1760979781,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Attempt to retrieve ALLWISE entry by treating the provided identifier as an ALLWISE oid_catalog.\n-- Note: In the provided schema, there is no crossmatch table (e.g., xmatch) or ZTF object table to map 'ZTF21aazqwxv' to an ALLWISE oid_catalog.\n-- This query will only return results if the ALLWISE oid_catalog is literally 'ZTF21aazqwxv'.\nSELECT *\nFROM allwise\nWHERE oid_catalog = 'ZTF21aazqwxv';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Attempt to retrieve ALLWISE entry by treating the provided identifier as an ALLWISE oid_catalog.\n-- Note: In the provided schema, there is no crossmatch table (e.g., xmatch) or ZTF object table to map 'ZTF21aazqwxv' to an ALLWISE oid_catalog.\n-- This query will only return results if the ALLWISE oid_catalog is literally 'ZTF21aazqwxv'.\nSELECT *\nFROM allwise\nWHERE oid_catalog = 'ZTF21aazqwxv';"
                },
                "in_toks": 2575,
                "out_toks": 1078,
                "id": "chatcmpl-CSoHnTAbi786bLyvNPCYliWuAZzEB",
                "created": 1760982519,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "83",
            "experiment_id": "run_1",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 608,
                "out_toks": 666,
                "id": "chatcmpl-CSnZdRa7zHLwhlRnHvVrEGbYBdw27",
                "created": 1760979781,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Attempt to retrieve ALLWISE rows using the provided ZTF object id as an ALLWISE oid_catalog.\n   Note: In ALeRCE, ZTF object ids typically do not match ALLWISE oid_catalog values directly.\n   Without an xmatch/object table (not provided in this schema), this will likely return zero rows. */\nWITH target_oids AS (\n    SELECT oid_catalog\n    FROM allwise\n    WHERE oid_catalog = 'ZTF21aazqwxv'\n)\nSELECT *\nFROM allwise\nWHERE oid_catalog IN (SELECT oid_catalog FROM target_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Attempt to retrieve ALLWISE rows using the provided ZTF object id as an ALLWISE oid_catalog.\n   Note: In ALeRCE, ZTF object ids typically do not match ALLWISE oid_catalog values directly.\n   Without an xmatch/object table (not provided in this schema), this will likely return zero rows. */\nWITH target_oids AS (\n    SELECT oid_catalog\n    FROM allwise\n    WHERE oid_catalog = 'ZTF21aazqwxv'\n)\nSELECT *\nFROM allwise\nWHERE oid_catalog IN (SELECT oid_catalog FROM target_oids);"
                },
                "in_toks": 2575,
                "out_toks": 1216,
                "id": "chatcmpl-CSoHzVbx9SzspxAsWLCooKzlfeJlb",
                "created": 1760982531,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "83",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'allwise']"
                },
                "in_toks": 608,
                "out_toks": 400,
                "id": "chatcmpl-CSsofKiuAEhK5LAtXIBic1qEXSlsX",
                "created": 1760999933,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized: compute the object's mean position once, then use q3c_join (index-friendly) for the spatial match\nWITH obj AS \n  (SELECT meanra AS ra, \n          meandec AS dec \n   FROM OBJECT \n   WHERE oid = 'ZTF21aazqwxv')\nSELECT a.*\nFROM allwise AS a\nJOIN obj AS o ON q3c_join(a.ra, a.dec, o.ra, o.dec, 2.0/3600.0);",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized: compute the object's mean position once, then use q3c_join (index-friendly) for the spatial match\nWITH obj AS \n  (SELECT meanra AS ra, \n          meandec AS dec \n   FROM OBJECT \n   WHERE oid = 'ZTF21aazqwxv')\nSELECT a.*\nFROM allwise AS a\nJOIN obj AS o ON q3c_join(a.ra, a.dec, o.ra, o.dec, 2.0/3600.0);"
                },
                "in_toks": 1884,
                "out_toks": 945,
                "id": "chatcmpl-CbA3lm6h2vtxB9ouZotAnSoC6Xgze",
                "created": 1762972841,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all ALLWISE rows within 2 arcseconds of the ZTF object's mean position\nSELECT *\nFROM allwise\nWHERE q3c_radial_query(\n    ra,\n    dec,\n    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),\n    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),\n    2.0/3600.0  -- radius in degrees (2 arcsec)\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all ALLWISE rows within 2 arcseconds of the ZTF object's mean position\nSELECT *\nFROM allwise\nWHERE q3c_radial_query(\n    ra,\n    dec,\n    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),\n    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),\n    2.0/3600.0  -- radius in degrees (2 arcsec)\n);"
                },
                "in_toks": 3057,
                "out_toks": 2222,
                "id": "chatcmpl-CSt4g1rChKLamhzRfdC3kCx5WeW1L",
                "created": 1761000926,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "83",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'allwise']"
                },
                "in_toks": 608,
                "out_toks": 336,
                "id": "chatcmpl-CSsolWNtUwWRwEyzK409v2CBiKsmm",
                "created": 1760999939,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all ALLWISE rows near the ZTF object 'ZTF21aazqwxv' using a cone search around its mean coordinates.\n-- Radius set to 2 arcseconds (2/3600 degrees). Adjust if needed.\nWITH target AS (\n    SELECT meanra AS ra, meandec AS dec\n    FROM object\n    WHERE oid = 'ZTF21aazqwxv'\n)\nSELECT a.*\nFROM allwise a\nWHERE EXISTS (\n    SELECT 1\n    FROM target t\n    WHERE q3c_radial_query(a.ra, a.dec, t.ra, t.dec, 2.0/3600.0)\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all ALLWISE rows near the ZTF object 'ZTF21aazqwxv' using a cone search around its mean coordinates.\n-- Radius set to 2 arcseconds (2/3600 degrees). Adjust if needed.\nWITH target AS (\n    SELECT meanra AS ra, meandec AS dec\n    FROM object\n    WHERE oid = 'ZTF21aazqwxv'\n)\nSELECT a.*\nFROM allwise a\nWHERE EXISTS (\n    SELECT 1\n    FROM target t\n    WHERE q3c_radial_query(a.ra, a.dec, t.ra, t.dec, 2.0/3600.0)\n);"
                },
                "in_toks": 3057,
                "out_toks": 1746,
                "id": "chatcmpl-CSsxzqaKG3MziuZnMssbBBbXoVQsG",
                "created": 1761000511,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "83",
            "experiment_id": "run_4",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 608,
                "out_toks": 529,
                "id": "chatcmpl-CSsoqThPB4QvRONMoKDvBnJhTtdcZ",
                "created": 1760999944,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all ALLWISE catalog rows linked to the given ZTF object via xmatch (no explicit JOIN, use nested query)\nSELECT *\nFROM allwise\nWHERE oid_catalog IN (\n    SELECT DISTINCT oid_catalog\n    FROM xmatch\n    WHERE oid = 'ZTF21aazqwxv'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all ALLWISE catalog rows linked to the given ZTF object via xmatch (no explicit JOIN, use nested query)\nSELECT *\nFROM allwise\nWHERE oid_catalog IN (\n    SELECT DISTINCT oid_catalog\n    FROM xmatch\n    WHERE oid = 'ZTF21aazqwxv'\n);"
                },
                "in_toks": 2688,
                "out_toks": 776,
                "id": "chatcmpl-CSsxz3VrW00ZdgzcSQv0FlhpoC4iv",
                "created": 1761000511,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "83",
            "experiment_id": "run_5",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 608,
                "out_toks": 333,
                "id": "chatcmpl-CZNA4LIkmiY0cwKaryN1TNxPmon0N",
                "created": 1762546548,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* The provided schema contains only the 'allwise' table, which uses 'oid_catalog' (ALLWISE designation), not ZTF object IDs. \n   To fetch ALLWISE rows for a ZTF object like 'ZTF21aazqwxv', you would typically use a crossmatch table to map the ZTF oid to 'allwise.oid_catalog'.\n   Example (if a crossmatch table existed):\n   SELECT a.*\n   FROM allwise a\n   WHERE a.oid_catalog IN (\n       SELECT xm.oid_catalog\n       FROM xmatch xm\n       WHERE xm.oid = 'ZTF21aazqwxv'\n   );\n*/\n\n/* With only the 'allwise' table available, there is no direct way to filter by a ZTF object id; return no rows by design. */\nSELECT *\nFROM allwise\nWHERE 1 = 0;",
            "original_sql_response": {
                "responses": {
                    "0": "/* The provided schema contains only the 'allwise' table, which uses 'oid_catalog' (ALLWISE designation), not ZTF object IDs. \n   To fetch ALLWISE rows for a ZTF object like 'ZTF21aazqwxv', you would typically use a crossmatch table to map the ZTF oid to 'allwise.oid_catalog'.\n   Example (if a crossmatch table existed):\n   SELECT a.*\n   FROM allwise a\n   WHERE a.oid_catalog IN (\n       SELECT xm.oid_catalog\n       FROM xmatch xm\n       WHERE xm.oid = 'ZTF21aazqwxv'\n   );\n*/\n\n/* With only the 'allwise' table available, there is no direct way to filter by a ZTF object id; return no rows by design. */\nSELECT *\nFROM allwise\nWHERE 1 = 0;"
                },
                "in_toks": 2575,
                "out_toks": 1406,
                "id": "chatcmpl-CZRErVX94fsh7UizZiUBuGQw7kxAd",
                "created": 1762562221,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "83",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'allwise']"
                },
                "in_toks": 608,
                "out_toks": 400,
                "id": "chatcmpl-CZNAAh69th67rb5g5TlQwlkJ0aUbj",
                "created": 1762546554,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Find the nearest AllWISE counterpart to the given ZTF object using q3c_join (index-aware) and return all AllWISE columns\nWITH target AS\n  (SELECT meanra AS ra,\n          meandec AS dec\n   FROM OBJECT\n   WHERE oid = 'ZTF21aazqwxv')\nSELECT aw.*\nFROM target t\nJOIN allwise aw ON q3c_join(aw.ra, aw.dec, t.ra, t.dec, 3.0/3600.0) -- 3 arcsec radius\nORDER BY q3c_dist(aw.ra, aw.dec, t.ra, t.dec)\nLIMIT 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Find the nearest AllWISE counterpart to the given ZTF object using q3c_join (index-aware) and return all AllWISE columns\nWITH target AS\n  (SELECT meanra AS ra,\n          meandec AS dec\n   FROM OBJECT\n   WHERE oid = 'ZTF21aazqwxv')\nSELECT aw.*\nFROM target t\nJOIN allwise aw ON q3c_join(aw.ra, aw.dec, t.ra, t.dec, 3.0/3600.0) -- 3 arcsec radius\nORDER BY q3c_dist(aw.ra, aw.dec, t.ra, t.dec)\nLIMIT 1;"
                },
                "in_toks": 2104,
                "out_toks": 1105,
                "id": "chatcmpl-CbA4816b5AXMdQ4P1wNJR2iuJaPeI",
                "created": 1762972864,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get the closest AllWISE counterpart to the ZTF object by a cone search around the object's mean position\n-- Adjust the radius (in arcseconds) if needed; here we use 3.0 arcsec and return the nearest match\nSELECT *\nFROM allwise aw\nWHERE q3c_radial_query(\n    aw.ra,\n    aw.dec,\n    (SELECT o.meanra FROM object o WHERE o.oid = 'ZTF21aazqwxv'),\n    (SELECT o.meandec FROM object o WHERE o.oid = 'ZTF21aazqwxv'),\n    3.0/3600.0  -- radius in degrees\n)\nORDER BY q3c_dist(\n    aw.ra,\n    aw.dec,\n    (SELECT o.meanra FROM object o WHERE o.oid = 'ZTF21aazqwxv'),\n    (SELECT o.meandec FROM object o WHERE o.oid = 'ZTF21aazqwxv')\n)\nLIMIT 1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get the closest AllWISE counterpart to the ZTF object by a cone search around the object's mean position\n-- Adjust the radius (in arcseconds) if needed; here we use 3.0 arcsec and return the nearest match\nSELECT *\nFROM allwise aw\nWHERE q3c_radial_query(\n    aw.ra,\n    aw.dec,\n    (SELECT o.meanra FROM object o WHERE o.oid = 'ZTF21aazqwxv'),\n    (SELECT o.meandec FROM object o WHERE o.oid = 'ZTF21aazqwxv'),\n    3.0/3600.0  -- radius in degrees\n)\nORDER BY q3c_dist(\n    aw.ra,\n    aw.dec,\n    (SELECT o.meanra FROM object o WHERE o.oid = 'ZTF21aazqwxv'),\n    (SELECT o.meandec FROM object o WHERE o.oid = 'ZTF21aazqwxv')\n)\nLIMIT 1;"
                },
                "in_toks": 3057,
                "out_toks": 1816,
                "id": "chatcmpl-CZRG79afi2EJnbOgxBMYSsMW02ymZ",
                "created": 1762562299,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "83",
            "experiment_id": "run_7",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 608,
                "out_toks": 333,
                "id": "chatcmpl-CZNAMXXakqYrUQxmZjVP9nD3a6DMB",
                "created": 1762546566,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns from ALLWISE for the provided identifier.\n-- Note: In this schema, the only key available is allwise.oid_catalog (an ALLWISE designation).\n-- If 'ZTF21aazqwxv' is not an ALLWISE oid_catalog, this will return no rows.\nSELECT *\nFROM allwise\nWHERE oid_catalog = 'ZTF21aazqwxv';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns from ALLWISE for the provided identifier.\n-- Note: In this schema, the only key available is allwise.oid_catalog (an ALLWISE designation).\n-- If 'ZTF21aazqwxv' is not an ALLWISE oid_catalog, this will return no rows.\nSELECT *\nFROM allwise\nWHERE oid_catalog = 'ZTF21aazqwxv';"
                },
                "in_toks": 2575,
                "out_toks": 1306,
                "id": "chatcmpl-CZRGKmpLsm7BL9kL5czfwXG1vtxuW",
                "created": 1762562312,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "83",
            "experiment_id": "run_8",
            "pred_tables": [
                "allwise",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise', 'object']"
                },
                "in_toks": 608,
                "out_toks": 272,
                "id": "chatcmpl-CZNATrHCvtfYG8gGz4gB64uIBrP9v",
                "created": 1762546573,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Get all ALLWISE rows within 2 arcseconds of the ZTF object's mean position\n-- Optimization: first filter the single ZTF object, then apply q3c predicate so the q3c index on allwise(ra,dec) can be used\n\nSELECT a.*\nFROM OBJECT o\nJOIN allwise a ON q3c_radial_query(a.ra, a.dec, o.meanra, o.meandec, 2.0/3600.0) \nWHERE o.oid = 'ZTF21aazqwxv'\n  AND o.meanra IS NOT NULL\n  AND o.meandec IS NOT NULL;",
            "sql_response": {
                "responses": {
                    "0": "-- Get all ALLWISE rows within 2 arcseconds of the ZTF object's mean position\n-- Optimization: first filter the single ZTF object, then apply q3c predicate so the q3c index on allwise(ra,dec) can be used\n\nSELECT a.*\nFROM OBJECT o\nJOIN allwise a ON q3c_radial_query(a.ra, a.dec, o.meanra, o.meandec, 2.0/3600.0) \nWHERE o.oid = 'ZTF21aazqwxv'\n  AND o.meanra IS NOT NULL\n  AND o.meandec IS NOT NULL;"
                },
                "in_toks": 1938,
                "out_toks": 1806,
                "id": "chatcmpl-CbA4e9wD4Vq5ZcxzkNSYvAuK3Lvs9",
                "created": 1762972896,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all ALLWISE rows spatially matched to the ZTF object 'ZTF21aazqwxv'\n-- Using a 2-arcsecond cone around the object's mean position (meanra, meandec)\nSELECT *\nFROM allwise\nWHERE q3c_radial_query(\n    ra,\n    dec,\n    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),\n    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),\n    2.0/3600.0  -- radius in degrees (2 arcsec)\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all ALLWISE rows spatially matched to the ZTF object 'ZTF21aazqwxv'\n-- Using a 2-arcsecond cone around the object's mean position (meanra, meandec)\nSELECT *\nFROM allwise\nWHERE q3c_radial_query(\n    ra,\n    dec,\n    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),\n    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),\n    2.0/3600.0  -- radius in degrees (2 arcsec)\n);"
                },
                "in_toks": 3057,
                "out_toks": 1801,
                "id": "chatcmpl-CZRGfd0yx3anngHVltwYDAr0537CA",
                "created": 1762562333,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "83",
            "experiment_id": "run_9",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 608,
                "out_toks": 913,
                "id": "chatcmpl-CZNAZt74WR3FwFfoAM4n5seuiEJiM",
                "created": 1762546579,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all AllWISE columns for the ZTF object by first retrieving its AllWISE oid_catalog via xmatch\nSELECT *\nFROM allwise\nWHERE oid_catalog IN (\n    SELECT xm.oid_catalog\n    FROM xmatch xm\n    WHERE xm.oid = 'ZTF21aazqwxv'\n      AND xm.catid ILIKE 'allwise%'  -- adjust/remove this filter if your catid differs\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all AllWISE columns for the ZTF object by first retrieving its AllWISE oid_catalog via xmatch\nSELECT *\nFROM allwise\nWHERE oid_catalog IN (\n    SELECT xm.oid_catalog\n    FROM xmatch xm\n    WHERE xm.oid = 'ZTF21aazqwxv'\n      AND xm.catid ILIKE 'allwise%'  -- adjust/remove this filter if your catid differs\n);"
                },
                "in_toks": 2688,
                "out_toks": 1312,
                "id": "chatcmpl-CZRHOVglajbMeT9NHmJncJm1C4rCQ",
                "created": 1762562378,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "84": {
        "0": {
            "req_id": "84",
            "experiment_id": "run_0",
            "pred_tables": [
                "allwise",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise', 'xmatch']",
                    "1": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 1445,
                "id": "chatcmpl-CSnZkVySUssDCrjQ8EzxQ2udwwqoW",
                "created": 1760979788,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE matches for the ZTF object 'ZTF19aascdol'\n-- Returns: ZTF identifier (oid), ALLWISE identifier (oid_catalog), angular distance [arcsec], and WISE W1\u2013W4 magnitudes\nSELECT\n  x.oid,\n  x.oid_catalog,\n  x.dist,\n  (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n  (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n  (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n  (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = 'ZTF19aascdol'\n  AND x.catid ILIKE 'allwise'\n  AND EXISTS (\n    SELECT 1\n    FROM allwise a\n    WHERE a.oid_catalog = x.oid_catalog\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE matches for the ZTF object 'ZTF19aascdol'\n-- Returns: ZTF identifier (oid), ALLWISE identifier (oid_catalog), angular distance [arcsec], and WISE W1\u2013W4 magnitudes\nSELECT\n  x.oid,\n  x.oid_catalog,\n  x.dist,\n  (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n  (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n  (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n  (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = 'ZTF19aascdol'\n  AND x.catid ILIKE 'allwise'\n  AND EXISTS (\n    SELECT 1\n    FROM allwise a\n    WHERE a.oid_catalog = x.oid_catalog\n  );"
                },
                "in_toks": 2732,
                "out_toks": 3002,
                "id": "chatcmpl-CSoIEAa8dXGszWeiEPgyu0zifdsps",
                "created": 1760982546,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "84",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise', 'xmatch']",
                    "1": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 1445,
                "id": "chatcmpl-CSnZkVySUssDCrjQ8EzxQ2udwwqoW",
                "created": 1760979788,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE matches for a specific ZTF object, returning ZTF and catalog identifiers, separation, and W1\u2013W4 magnitudes\nWITH target_oid AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n)\nSELECT\n    x.oid,               -- ZTF identifier\n    x.oid_catalog,       -- ALLWISE catalog identifier\n    x.dist,              -- distance between counterparts [arcsec]\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM target_oid)\n  AND EXISTS (SELECT 1 FROM allwise a WHERE a.oid_catalog = x.oid_catalog)\nORDER BY x.dist ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE matches for a specific ZTF object, returning ZTF and catalog identifiers, separation, and W1\u2013W4 magnitudes\nWITH target_oid AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n)\nSELECT\n    x.oid,               -- ZTF identifier\n    x.oid_catalog,       -- ALLWISE catalog identifier\n    x.dist,              -- distance between counterparts [arcsec]\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM target_oid)\n  AND EXISTS (SELECT 1 FROM allwise a WHERE a.oid_catalog = x.oid_catalog)\nORDER BY x.dist ASC;"
                },
                "in_toks": 3214,
                "out_toks": 2248,
                "id": "chatcmpl-CSoIcNmHTX7oug2EYXmd3vIreSaLI",
                "created": 1760982570,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "84",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 468,
                "id": "chatcmpl-CSsoysomzGVO1BOkSTJxQpIopjvdZ",
                "created": 1760999952,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- For the ZTF object 'ZTF19aascdol', return its ALLWISE counterpart(s):\n-- ZTF identifier (oid), catalog identifier (oid_catalog), angular separation (dist in arcsec),\n-- and WISE magnitudes W1\u2013W4 (w1mpro, w2mpro, w3mpro, w4mpro).\nWITH targets AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF19aascdol'\n)\nSELECT\n    xm.oid,\n    xm.oid_catalog,\n    xm.dist,\n    (SELECT aw.w1mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w1mpro,\n    (SELECT aw.w2mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w2mpro,\n    (SELECT aw.w3mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w3mpro,\n    (SELECT aw.w4mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w4mpro\nFROM xmatch xm\nWHERE xm.oid IN (SELECT oid FROM targets)\n  AND xm.catid = 'ALLWISE'\n  AND EXISTS (\n      SELECT 1 FROM allwise aw\n      WHERE aw.oid_catalog = xm.oid_catalog\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- For the ZTF object 'ZTF19aascdol', return its ALLWISE counterpart(s):\n-- ZTF identifier (oid), catalog identifier (oid_catalog), angular separation (dist in arcsec),\n-- and WISE magnitudes W1\u2013W4 (w1mpro, w2mpro, w3mpro, w4mpro).\nWITH targets AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF19aascdol'\n)\nSELECT\n    xm.oid,\n    xm.oid_catalog,\n    xm.dist,\n    (SELECT aw.w1mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w1mpro,\n    (SELECT aw.w2mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w2mpro,\n    (SELECT aw.w3mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w3mpro,\n    (SELECT aw.w4mpro FROM allwise aw WHERE aw.oid_catalog = xm.oid_catalog) AS w4mpro\nFROM xmatch xm\nWHERE xm.oid IN (SELECT oid FROM targets)\n  AND xm.catid = 'ALLWISE'\n  AND EXISTS (\n      SELECT 1 FROM allwise aw\n      WHERE aw.oid_catalog = xm.oid_catalog\n  );"
                },
                "in_toks": 3214,
                "out_toks": 2603,
                "id": "chatcmpl-CSsxzaPEVtfp6LGygQAFpuvbHfItA",
                "created": 1761000511,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "84",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 596,
                "id": "chatcmpl-CSsp4S7zNq10b1lFS8NUzSqKcZkTt",
                "created": 1760999958,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ALLWISE matches for the given ZTF object, including:\n-- - ZTF identifier (oid)\n-- - ALLWISE catalog identifier (oid_catalog)\n-- - Angular distance between counterparts in arcseconds (dist)\n-- - WISE magnitudes W1 through W4 (w1mpro, w2mpro, w3mpro, w4mpro)\nSELECT\n    x.oid,\n    x.oid_catalog,\n    x.dist,\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = (\n    -- Obtain the OID via subquery (ensures the object exists and optimizes the main query)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF19aascdol'\n)\n-- Ensure we only return matches that exist in the ALLWISE catalog table\nAND EXISTS (\n    SELECT 1\n    FROM allwise a\n    WHERE a.oid_catalog = x.oid_catalog\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ALLWISE matches for the given ZTF object, including:\n-- - ZTF identifier (oid)\n-- - ALLWISE catalog identifier (oid_catalog)\n-- - Angular distance between counterparts in arcseconds (dist)\n-- - WISE magnitudes W1 through W4 (w1mpro, w2mpro, w3mpro, w4mpro)\nSELECT\n    x.oid,\n    x.oid_catalog,\n    x.dist,\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = (\n    -- Obtain the OID via subquery (ensures the object exists and optimizes the main query)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF19aascdol'\n)\n-- Ensure we only return matches that exist in the ALLWISE catalog table\nAND EXISTS (\n    SELECT 1\n    FROM allwise a\n    WHERE a.oid_catalog = x.oid_catalog\n);"
                },
                "in_toks": 3214,
                "out_toks": 1471,
                "id": "chatcmpl-CSsxzRn0KjB4uGFADbT5syTYPp9P9",
                "created": 1761000511,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "84",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 404,
                "id": "chatcmpl-CSspDBeyN8if4bXLB9dfG0PcDvMsa",
                "created": 1760999967,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE matches for a specific ZTF object, returning ZTF and catalog identifiers,\n-- angular separation (arcsec), and WISE W1\u2013W4 magnitudes.\nSELECT\n  x.oid,                -- ZTF object identifier\n  x.oid_catalog,        -- Identifier in the ALLWISE catalog\n  x.dist,               -- Angular distance between counterparts [arcsec]\n  (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n  (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n  (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n  (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = 'ZTF19aascdol'\n  AND x.catid = 'ALLWISE';",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE matches for a specific ZTF object, returning ZTF and catalog identifiers,\n-- angular separation (arcsec), and WISE W1\u2013W4 magnitudes.\nSELECT\n  x.oid,                -- ZTF object identifier\n  x.oid_catalog,        -- Identifier in the ALLWISE catalog\n  x.dist,               -- Angular distance between counterparts [arcsec]\n  (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n  (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n  (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n  (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = 'ZTF19aascdol'\n  AND x.catid = 'ALLWISE';"
                },
                "in_toks": 3214,
                "out_toks": 2408,
                "id": "chatcmpl-CSsxzNHA4QRXMmqtIedITcVce1Eyi",
                "created": 1761000511,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "84",
            "experiment_id": "run_5",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 913,
                "id": "chatcmpl-CZNAr6Hj6pls3orhzUWUj0Y6G023F",
                "created": 1762546597,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF oid, ALLWISE oid_catalog, angular distance between counterparts (arcsec),\n-- and ALLWISE magnitudes W1\u2013W4 for the ZTF object 'ZTF19aascdol'.\nWITH matched AS (\n    SELECT xm.oid, xm.oid_catalog, xm.dist\n    FROM xmatch xm\n    WHERE xm.oid = 'ZTF19aascdol'\n      -- Keep only matches that exist in the ALLWISE catalog\n      AND xm.oid_catalog IN (SELECT aw.oid_catalog FROM allwise aw)\n)\nSELECT\n    m.oid,\n    m.oid_catalog,\n    m.dist,\n    (SELECT aw.w1mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w1mpro,\n    (SELECT aw.w2mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w2mpro,\n    (SELECT aw.w3mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w3mpro,\n    (SELECT aw.w4mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w4mpro\nFROM matched m;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF oid, ALLWISE oid_catalog, angular distance between counterparts (arcsec),\n-- and ALLWISE magnitudes W1\u2013W4 for the ZTF object 'ZTF19aascdol'.\nWITH matched AS (\n    SELECT xm.oid, xm.oid_catalog, xm.dist\n    FROM xmatch xm\n    WHERE xm.oid = 'ZTF19aascdol'\n      -- Keep only matches that exist in the ALLWISE catalog\n      AND xm.oid_catalog IN (SELECT aw.oid_catalog FROM allwise aw)\n)\nSELECT\n    m.oid,\n    m.oid_catalog,\n    m.dist,\n    (SELECT aw.w1mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w1mpro,\n    (SELECT aw.w2mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w2mpro,\n    (SELECT aw.w3mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w3mpro,\n    (SELECT aw.w4mpro FROM allwise aw WHERE aw.oid_catalog = m.oid_catalog) AS w4mpro\nFROM matched m;"
                },
                "in_toks": 2732,
                "out_toks": 2051,
                "id": "chatcmpl-CZRHSajXGYXRadu6Yep8aXjufPPyh",
                "created": 1762562382,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "84",
            "experiment_id": "run_6",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 593,
                "id": "chatcmpl-CZNB8ykSJqSdH2z0BE5LbWGy6gKbJ",
                "created": 1762546614,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE matches for ZTF object 'ZTF19aascdol' with ZTF and catalog identifiers, counterpart distance [arcsec], and WISE W1\u2013W4 magnitudes\nSELECT\n    x.oid,                 -- ZTF object identifier\n    x.oid_catalog,         -- ALLWISE catalog identifier\n    x.dist,                -- angular distance between counterparts [arcsec]\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = 'ZTF19aascdol'\n  AND EXISTS (\n      SELECT 1 FROM allwise a WHERE a.oid_catalog = x.oid_catalog\n  )\nORDER BY x.dist ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE matches for ZTF object 'ZTF19aascdol' with ZTF and catalog identifiers, counterpart distance [arcsec], and WISE W1\u2013W4 magnitudes\nSELECT\n    x.oid,                 -- ZTF object identifier\n    x.oid_catalog,         -- ALLWISE catalog identifier\n    x.dist,                -- angular distance between counterparts [arcsec]\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid = 'ZTF19aascdol'\n  AND EXISTS (\n      SELECT 1 FROM allwise a WHERE a.oid_catalog = x.oid_catalog\n  )\nORDER BY x.dist ASC;"
                },
                "in_toks": 2732,
                "out_toks": 3263,
                "id": "chatcmpl-CZRHyPZvQnETkL2jf7bgwzb9IjUH1",
                "created": 1762562414,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "84",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 404,
                "id": "chatcmpl-CZNBNmpa0uRNILbkGDcEDjxgGH48M",
                "created": 1762546629,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* ALLWISE matches for the ZTF object 'ZTF19aascdol', returning:\n   - ZTF identifier (oid)\n   - Catalog identifier (oid_catalog)\n   - Angular distance between counterparts (dist, in arcsec)\n   - WISE magnitudes W1 to W4 (w1mpro, w2mpro, w3mpro, w4mpro)\n   Notes:\n   - OID is obtained via a subquery from the object table as recommended.\n   - No explicit JOINs are used; ALLWISE magnitudes are retrieved via correlated subqueries.\n   - We ensure the match belongs to ALLWISE by requiring existence in the allwise table.\n*/\nSELECT\n    x.oid,\n    x.oid_catalog,\n    x.dist,\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid IN (SELECT o.oid FROM object o WHERE o.oid = 'ZTF19aascdol')\n  AND EXISTS (SELECT 1 FROM allwise a WHERE a.oid_catalog = x.oid_catalog);",
            "original_sql_response": {
                "responses": {
                    "0": "/* ALLWISE matches for the ZTF object 'ZTF19aascdol', returning:\n   - ZTF identifier (oid)\n   - Catalog identifier (oid_catalog)\n   - Angular distance between counterparts (dist, in arcsec)\n   - WISE magnitudes W1 to W4 (w1mpro, w2mpro, w3mpro, w4mpro)\n   Notes:\n   - OID is obtained via a subquery from the object table as recommended.\n   - No explicit JOINs are used; ALLWISE magnitudes are retrieved via correlated subqueries.\n   - We ensure the match belongs to ALLWISE by requiring existence in the allwise table.\n*/\nSELECT\n    x.oid,\n    x.oid_catalog,\n    x.dist,\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro,\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro,\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro,\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid IN (SELECT o.oid FROM object o WHERE o.oid = 'ZTF19aascdol')\n  AND EXISTS (SELECT 1 FROM allwise a WHERE a.oid_catalog = x.oid_catalog);"
                },
                "in_toks": 3214,
                "out_toks": 1936,
                "id": "chatcmpl-CZRIR9SmkdQHjHydgdOj6DE6CBsQf",
                "created": 1762562443,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "84",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 532,
                "id": "chatcmpl-CZNBXbVHy8Se5QOL0gzIFx0pGJR0I",
                "created": 1762546639,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE matches for ZTF object 'ZTF19aascdol' with ZTF and catalog identifiers,\n-- angular distance, and WISE W1\u2013W4 magnitudes. Uses nested subqueries (no JOINs).\nSELECT\n    x.oid,          -- ZTF object identifier\n    x.oid_catalog,  -- ALLWISE catalog identifier\n    x.dist,         -- angular distance [arcsec] between counterparts\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro, -- WISE W1 mag\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro, -- WISE W2 mag\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro, -- WISE W3 mag\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro  -- WISE W4 mag\nFROM xmatch x\nWHERE x.oid IN (\n    -- prioritize obtaining OIDs via a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF19aascdol'\n)\nAND x.oid_catalog IN (\n    -- ensure we only keep matches that exist in the ALLWISE catalog table\n    SELECT a.oid_catalog\n    FROM allwise a\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE matches for ZTF object 'ZTF19aascdol' with ZTF and catalog identifiers,\n-- angular distance, and WISE W1\u2013W4 magnitudes. Uses nested subqueries (no JOINs).\nSELECT\n    x.oid,          -- ZTF object identifier\n    x.oid_catalog,  -- ALLWISE catalog identifier\n    x.dist,         -- angular distance [arcsec] between counterparts\n    (SELECT a.w1mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w1mpro, -- WISE W1 mag\n    (SELECT a.w2mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w2mpro, -- WISE W2 mag\n    (SELECT a.w3mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w3mpro, -- WISE W3 mag\n    (SELECT a.w4mpro FROM allwise a WHERE a.oid_catalog = x.oid_catalog) AS w4mpro  -- WISE W4 mag\nFROM xmatch x\nWHERE x.oid IN (\n    -- prioritize obtaining OIDs via a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF19aascdol'\n)\nAND x.oid_catalog IN (\n    -- ensure we only keep matches that exist in the ALLWISE catalog table\n    SELECT a.oid_catalog\n    FROM allwise a\n);"
                },
                "in_toks": 3214,
                "out_toks": 2827,
                "id": "chatcmpl-CZRAQVySFXID46SWFINgGvY1Ww3Us",
                "created": 1762561946,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "84",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 632,
                "out_toks": 660,
                "id": "chatcmpl-CZNBfxOKbAbWtwVnuEReyEkIv6sMg",
                "created": 1762546647,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ALLWISE matches for ZTF object 'ZTF19aascdol'\n-- Returns: ZTF oid, ALLWISE oid_catalog, angular separation in arcsec (xmatch.dist),\n-- and WISE magnitudes W1\u2013W4 (w1mpro\u2013w4mpro) from the ALLWISE catalog.\nSELECT\n  x.oid AS ztf_oid,\n  x.oid_catalog AS allwise_oid,\n  x.dist AS dist_arcsec,\n  (SELECT aw.w1mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w1mpro,\n  (SELECT aw.w2mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w2mpro,\n  (SELECT aw.w3mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w3mpro,\n  (SELECT aw.w4mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid IN (\n  -- prioritize obtaining OIDs via the object table\n  SELECT o.oid FROM object o WHERE o.oid = 'ZTF19aascdol'\n)\n-- ensure we only keep matches that exist in the ALLWISE catalog\nAND EXISTS (\n  SELECT 1 FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- ALLWISE matches for ZTF object 'ZTF19aascdol'\n-- Returns: ZTF oid, ALLWISE oid_catalog, angular separation in arcsec (xmatch.dist),\n-- and WISE magnitudes W1\u2013W4 (w1mpro\u2013w4mpro) from the ALLWISE catalog.\nSELECT\n  x.oid AS ztf_oid,\n  x.oid_catalog AS allwise_oid,\n  x.dist AS dist_arcsec,\n  (SELECT aw.w1mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w1mpro,\n  (SELECT aw.w2mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w2mpro,\n  (SELECT aw.w3mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w3mpro,\n  (SELECT aw.w4mpro FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog) AS w4mpro\nFROM xmatch x\nWHERE x.oid IN (\n  -- prioritize obtaining OIDs via the object table\n  SELECT o.oid FROM object o WHERE o.oid = 'ZTF19aascdol'\n)\n-- ensure we only keep matches that exist in the ALLWISE catalog\nAND EXISTS (\n  SELECT 1 FROM allwise aw WHERE aw.oid_catalog = x.oid_catalog\n);"
                },
                "in_toks": 3214,
                "out_toks": 1837,
                "id": "chatcmpl-CZRAQMVWos4dHbb4CrUNBNdn2XQRz",
                "created": 1762561946,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "96": {
        "0": {
            "req_id": "96",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']",
                    "1": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 1318,
                "id": "chatcmpl-CSna2ywfLLJAcv7zvQIOykzbR8bwL",
                "created": 1760979806,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* \nFind all detections for ZTF objects whose nearest known Solar System object\nis either '2003FP134' or '2009UK56' and is within 2 arcseconds.\nWe first select the relevant OIDs via a subquery on ss_ztf (using ssdistnr in arcseconds),\nthen return all detections for those OIDs.\nReturn: all ss_ztf columns, plus detection mjd, fid, isdiffpos, ra, dec, magpsf, sigmapsf.\nSorted by MPC name (ssnamenr) and detection date (mjd).\n*/\nSELECT\n    s.*,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM\n    detection d,\n    ss_ztf s\nWHERE\n    d.oid IN (\n        SELECT ss.oid\n        FROM ss_ztf ss\n        WHERE ss.ssnamenr IN ('2003FP134', '2009UK56')\n          AND ss.ssdistnr <= 2.0\n    )\n    AND s.oid = d.oid\nORDER BY\n    s.ssnamenr,\n    d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* \nFind all detections for ZTF objects whose nearest known Solar System object\nis either '2003FP134' or '2009UK56' and is within 2 arcseconds.\nWe first select the relevant OIDs via a subquery on ss_ztf (using ssdistnr in arcseconds),\nthen return all detections for those OIDs.\nReturn: all ss_ztf columns, plus detection mjd, fid, isdiffpos, ra, dec, magpsf, sigmapsf.\nSorted by MPC name (ssnamenr) and detection date (mjd).\n*/\nSELECT\n    s.*,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM\n    detection d,\n    ss_ztf s\nWHERE\n    d.oid IN (\n        SELECT ss.oid\n        FROM ss_ztf ss\n        WHERE ss.ssnamenr IN ('2003FP134', '2009UK56')\n          AND ss.ssdistnr <= 2.0\n    )\n    AND s.oid = d.oid\nORDER BY\n    s.ssnamenr,\n    d.mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3088,
                "id": "chatcmpl-CSoIxN6sFclvt6IKeH99ErVYoYAoP",
                "created": 1760982591,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "96",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']",
                    "1": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 1318,
                "id": "chatcmpl-CSna2ywfLLJAcv7zvQIOykzbR8bwL",
                "created": 1760979806,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* \nGet all detections for ZTF objects whose nearest known Solar System object is either\n'2003FP134' or '2009UK56' within 2 arcsec. \nReturn:\n- all columns from ss_ztf\n- detection mjd (date), fid, isdiffpos, ra, dec, magpsf, sigmapsf\nSorted by MPC name (ssnamenr) and detection date (mjd).\n*/\nWITH targets AS (\n  SELECT oid, candid, ssdistnr, ssmagnr, ssnamenr\n  FROM ss_ztf\n  WHERE ssnamenr IN ('2003FP134', '2009UK56')\n    AND ssdistnr <= 2\n)\nSELECT\n  /* all columns from ss_ztf (via targets CTE) */\n  (SELECT t.oid FROM targets t WHERE t.oid = d.oid) AS oid,\n  (SELECT t.candid FROM targets t WHERE t.oid = d.oid) AS candid,\n  (SELECT t.ssdistnr FROM targets t WHERE t.oid = d.oid) AS ssdistnr,\n  (SELECT t.ssmagnr FROM targets t WHERE t.oid = d.oid) AS ssmagnr,\n  (SELECT t.ssnamenr FROM targets t WHERE t.oid = d.oid) AS ssnamenr,\n  /* requested detection columns */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM targets)\nORDER BY ssnamenr, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* \nGet all detections for ZTF objects whose nearest known Solar System object is either\n'2003FP134' or '2009UK56' within 2 arcsec. \nReturn:\n- all columns from ss_ztf\n- detection mjd (date), fid, isdiffpos, ra, dec, magpsf, sigmapsf\nSorted by MPC name (ssnamenr) and detection date (mjd).\n*/\nWITH targets AS (\n  SELECT oid, candid, ssdistnr, ssmagnr, ssnamenr\n  FROM ss_ztf\n  WHERE ssnamenr IN ('2003FP134', '2009UK56')\n    AND ssdistnr <= 2\n)\nSELECT\n  /* all columns from ss_ztf (via targets CTE) */\n  (SELECT t.oid FROM targets t WHERE t.oid = d.oid) AS oid,\n  (SELECT t.candid FROM targets t WHERE t.oid = d.oid) AS candid,\n  (SELECT t.ssdistnr FROM targets t WHERE t.oid = d.oid) AS ssdistnr,\n  (SELECT t.ssmagnr FROM targets t WHERE t.oid = d.oid) AS ssmagnr,\n  (SELECT t.ssnamenr FROM targets t WHERE t.oid = d.oid) AS ssnamenr,\n  /* requested detection columns */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM targets)\nORDER BY ssnamenr, d.mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3438,
                "id": "chatcmpl-CSoJXh4wsqB0TgmshYNBguiQnyBQm",
                "created": 1760982627,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "96",
            "experiment_id": "run_2",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 851,
                "id": "chatcmpl-CSspKMchseKzSnZRPuM2tNHwIHKys",
                "created": 1760999974,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find all detections for objects whose nearest known Solar System object\n   is '2003FP134' or '2009UK56' within 2 arcsec according to ss_ztf.ssdistnr */\nWITH target_ss AS (\n  SELECT oid, candid, ssdistnr, ssmagnr, ssnamenr\n  FROM ss_ztf\n  WHERE ssnamenr IN ('2003FP134', '2009UK56')\n    AND ssdistnr <= 2  -- ssdistnr is the distance to the nearest known solar system object (arcsec)\n)\nSELECT\n  /* all columns from ss_ztf (via correlated subqueries to avoid JOINs) */\n  (SELECT t.oid FROM target_ss t WHERE t.oid = d.oid) AS oid,\n  (SELECT t.candid FROM target_ss t WHERE t.oid = d.oid) AS candid,\n  (SELECT t.ssdistnr FROM target_ss t WHERE t.oid = d.oid) AS ssdistnr,\n  (SELECT t.ssmagnr FROM target_ss t WHERE t.oid = d.oid) AS ssmagnr,\n  (SELECT t.ssnamenr FROM target_ss t WHERE t.oid = d.oid) AS ssnamenr,\n  /* requested detection columns */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_ss)\nORDER BY\n  /* Sort by MPC name (ssnamenr) then detection date (mjd) */\n  (SELECT t.ssnamenr FROM target_ss t WHERE t.oid = d.oid),\n  d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find all detections for objects whose nearest known Solar System object\n   is '2003FP134' or '2009UK56' within 2 arcsec according to ss_ztf.ssdistnr */\nWITH target_ss AS (\n  SELECT oid, candid, ssdistnr, ssmagnr, ssnamenr\n  FROM ss_ztf\n  WHERE ssnamenr IN ('2003FP134', '2009UK56')\n    AND ssdistnr <= 2  -- ssdistnr is the distance to the nearest known solar system object (arcsec)\n)\nSELECT\n  /* all columns from ss_ztf (via correlated subqueries to avoid JOINs) */\n  (SELECT t.oid FROM target_ss t WHERE t.oid = d.oid) AS oid,\n  (SELECT t.candid FROM target_ss t WHERE t.oid = d.oid) AS candid,\n  (SELECT t.ssdistnr FROM target_ss t WHERE t.oid = d.oid) AS ssdistnr,\n  (SELECT t.ssmagnr FROM target_ss t WHERE t.oid = d.oid) AS ssmagnr,\n  (SELECT t.ssnamenr FROM target_ss t WHERE t.oid = d.oid) AS ssnamenr,\n  /* requested detection columns */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_ss)\nORDER BY\n  /* Sort by MPC name (ssnamenr) then detection date (mjd) */\n  (SELECT t.ssnamenr FROM target_ss t WHERE t.oid = d.oid),\n  d.mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3459,
                "id": "chatcmpl-CSsyAH1gKN5c6PNoZ7I13RI9VdgJn",
                "created": 1761000522,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "96",
            "experiment_id": "run_3",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 403,
                "id": "chatcmpl-CSspW69MBi0mA3405MwpBYcsNcG7C",
                "created": 1760999986,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Get all detections for ZTF objects within 2 arcsec of the MPC names '2003FP134' and '2009UK56'.\n   Return all ss_ztf columns, plus detection date (mjd), filter id (fid), isdiffpos, RA, Dec, magpsf and sigmapsf.\n   Sort by MPC name (ssnamenr) and detection date (mjd). */\nWITH target_oids AS (\n  SELECT oid\n  FROM ss_ztf\n  WHERE ssnamenr IN ('2003FP134', '2009UK56')\n    AND ssdistnr <= 2\n)\nSELECT\n  /* all columns from ss_ztf (via scalar subqueries keyed by detection.oid) */\n  (SELECT s.oid      FROM ss_ztf s WHERE s.oid = d.oid) AS oid,\n  (SELECT s.candid   FROM ss_ztf s WHERE s.oid = d.oid) AS candid,\n  (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssdistnr,\n  (SELECT s.ssmagnr  FROM ss_ztf s WHERE s.oid = d.oid) AS ssmagnr,\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid) AS ssnamenr,\n  /* selected detection columns */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\nORDER BY\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid),\n  d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Get all detections for ZTF objects within 2 arcsec of the MPC names '2003FP134' and '2009UK56'.\n   Return all ss_ztf columns, plus detection date (mjd), filter id (fid), isdiffpos, RA, Dec, magpsf and sigmapsf.\n   Sort by MPC name (ssnamenr) and detection date (mjd). */\nWITH target_oids AS (\n  SELECT oid\n  FROM ss_ztf\n  WHERE ssnamenr IN ('2003FP134', '2009UK56')\n    AND ssdistnr <= 2\n)\nSELECT\n  /* all columns from ss_ztf (via scalar subqueries keyed by detection.oid) */\n  (SELECT s.oid      FROM ss_ztf s WHERE s.oid = d.oid) AS oid,\n  (SELECT s.candid   FROM ss_ztf s WHERE s.oid = d.oid) AS candid,\n  (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssdistnr,\n  (SELECT s.ssmagnr  FROM ss_ztf s WHERE s.oid = d.oid) AS ssmagnr,\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid) AS ssnamenr,\n  /* selected detection columns */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\nORDER BY\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid),\n  d.mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3336,
                "id": "chatcmpl-CSsyJste1M5pqxEThftMsVxntWouc",
                "created": 1761000531,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "96",
            "experiment_id": "run_4",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 531,
                "id": "chatcmpl-CSspcWJZbw0rLzgXhuLRzEUHioBY6",
                "created": 1760999992,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all detections for ZTF objects whose nearest known Solar System object is either\n-- '2003FP134' or '2009UK56' and lies within 2 arcsec (using ssdistnr), returning:\n-- - all columns from ss_ztf\n-- - detection date (mjd), filter identifier (fid), isdiffpos, RA, Dec, magpsf and sigmapsf\n-- Results are sorted by MPC name (ssnamenr) and detection date (mjd)\n\nWITH target_ss AS (\n    SELECT\n        oid,\n        candid,\n        ssdistnr,\n        ssmagnr,\n        ssnamenr\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n      AND ssdistnr <= 2  -- 2 arcsec\n)\nSELECT\n    d.oid AS oid,  -- ss_ztf.oid\n    (SELECT t.candid FROM target_ss t WHERE t.oid = d.oid) AS candid,       -- ss_ztf.candid\n    (SELECT t.ssdistnr FROM target_ss t WHERE t.oid = d.oid) AS ssdistnr,   -- ss_ztf.ssdistnr\n    (SELECT t.ssmagnr FROM target_ss t WHERE t.oid = d.oid) AS ssmagnr,     -- ss_ztf.ssmagnr\n    (SELECT t.ssnamenr FROM target_ss t WHERE t.oid = d.oid) AS ssnamenr,   -- ss_ztf.ssnamenr\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_ss)\nORDER BY ssnamenr, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all detections for ZTF objects whose nearest known Solar System object is either\n-- '2003FP134' or '2009UK56' and lies within 2 arcsec (using ssdistnr), returning:\n-- - all columns from ss_ztf\n-- - detection date (mjd), filter identifier (fid), isdiffpos, RA, Dec, magpsf and sigmapsf\n-- Results are sorted by MPC name (ssnamenr) and detection date (mjd)\n\nWITH target_ss AS (\n    SELECT\n        oid,\n        candid,\n        ssdistnr,\n        ssmagnr,\n        ssnamenr\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n      AND ssdistnr <= 2  -- 2 arcsec\n)\nSELECT\n    d.oid AS oid,  -- ss_ztf.oid\n    (SELECT t.candid FROM target_ss t WHERE t.oid = d.oid) AS candid,       -- ss_ztf.candid\n    (SELECT t.ssdistnr FROM target_ss t WHERE t.oid = d.oid) AS ssdistnr,   -- ss_ztf.ssdistnr\n    (SELECT t.ssmagnr FROM target_ss t WHERE t.oid = d.oid) AS ssmagnr,     -- ss_ztf.ssmagnr\n    (SELECT t.ssnamenr FROM target_ss t WHERE t.oid = d.oid) AS ssnamenr,   -- ss_ztf.ssnamenr\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_ss)\nORDER BY ssnamenr, d.mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3356,
                "id": "chatcmpl-CSsyNBzj6jngVdl8Xc6OFnbHqRLhl",
                "created": 1761000535,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "96",
            "experiment_id": "run_5",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 595,
                "id": "chatcmpl-CZNBv4rzxiRw1a1rU7rJAKl0uinnW",
                "created": 1762546663,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* \nFor MPC names '2003FP134' and '2009UK56', return all detections from ZTF objects whose nearest known Solar System object matches either name and lies within 2 arcsec (using ss_ztf.ssdistnr).\nOutput:\n- all columns from ss_ztf (oid, candid, ssdistnr, ssmagnr, ssnamenr)\n- detection info: mjd (detection date), fid, isdiffpos, ra, dec, magpsf, sigmapsf\nSorted by MPC name (ssnamenr) and detection date (mjd).\nNo JOINs are used; OIDs are obtained in a subquery as recommended.\n*/\nWITH ss_matches AS (\n    SELECT s.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr\n    FROM ss_ztf s\n    WHERE s.ssnamenr IN ('2003FP134', '2009UK56')\n      AND s.ssdistnr <= 2  -- assumed arcseconds per schema context\n)\nSELECT\n    /* all columns from ss_ztf via correlated subqueries */\n    (SELECT sm.oid FROM ss_matches sm WHERE sm.oid = d.oid) AS oid,\n    (SELECT sm.candid FROM ss_matches sm WHERE sm.oid = d.oid) AS candid,\n    (SELECT sm.ssdistnr FROM ss_matches sm WHERE sm.oid = d.oid) AS ssdistnr,\n    (SELECT sm.ssmagnr FROM ss_matches sm WHERE sm.oid = d.oid) AS ssmagnr,\n    (SELECT sm.ssnamenr FROM ss_matches sm WHERE sm.oid = d.oid) AS ssnamenr,\n    /* requested detection columns */\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM ss_matches)\nORDER BY ssnamenr, mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* \nFor MPC names '2003FP134' and '2009UK56', return all detections from ZTF objects whose nearest known Solar System object matches either name and lies within 2 arcsec (using ss_ztf.ssdistnr).\nOutput:\n- all columns from ss_ztf (oid, candid, ssdistnr, ssmagnr, ssnamenr)\n- detection info: mjd (detection date), fid, isdiffpos, ra, dec, magpsf, sigmapsf\nSorted by MPC name (ssnamenr) and detection date (mjd).\nNo JOINs are used; OIDs are obtained in a subquery as recommended.\n*/\nWITH ss_matches AS (\n    SELECT s.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr\n    FROM ss_ztf s\n    WHERE s.ssnamenr IN ('2003FP134', '2009UK56')\n      AND s.ssdistnr <= 2  -- assumed arcseconds per schema context\n)\nSELECT\n    /* all columns from ss_ztf via correlated subqueries */\n    (SELECT sm.oid FROM ss_matches sm WHERE sm.oid = d.oid) AS oid,\n    (SELECT sm.candid FROM ss_matches sm WHERE sm.oid = d.oid) AS candid,\n    (SELECT sm.ssdistnr FROM ss_matches sm WHERE sm.oid = d.oid) AS ssdistnr,\n    (SELECT sm.ssmagnr FROM ss_matches sm WHERE sm.oid = d.oid) AS ssmagnr,\n    (SELECT sm.ssnamenr FROM ss_matches sm WHERE sm.oid = d.oid) AS ssnamenr,\n    /* requested detection columns */\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM ss_matches)\nORDER BY ssnamenr, mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3451,
                "id": "chatcmpl-CZRC16o1Fdp7NGndEhWNODqY0AMDB",
                "created": 1762562045,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "96",
            "experiment_id": "run_6",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 723,
                "id": "chatcmpl-CZNCMPLntAsfpUQpJ1vrx0XgVgLOi",
                "created": 1762546690,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Detections within 2 arcsec of MPC objects '2003FP134' and '2009UK56'\n   Returns all ss_ztf columns plus selected detection fields, ordered by MPC name and detection date */\nWITH ss_targets AS (\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n      AND ssdistnr <= 2.0  -- distance to nearest known solar system object, assumed in arcseconds\n)\nSELECT\n    s.*,                  -- all columns from ss_ztf\n    d.mjd,                -- detection date (MJD)\n    d.fid,                -- filter identifier\n    d.isdiffpos,          -- isdiffpos flag\n    d.ra,                 -- RA (deg)\n    d.dec,                -- Dec (deg)\n    d.magpsf,             -- PSF difference magnitude\n    d.sigmapsf            -- uncertainty of PSF difference magnitude\nFROM ss_targets s, detection d\nWHERE d.oid = s.oid\nORDER BY s.ssnamenr, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Detections within 2 arcsec of MPC objects '2003FP134' and '2009UK56'\n   Returns all ss_ztf columns plus selected detection fields, ordered by MPC name and detection date */\nWITH ss_targets AS (\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n      AND ssdistnr <= 2.0  -- distance to nearest known solar system object, assumed in arcseconds\n)\nSELECT\n    s.*,                  -- all columns from ss_ztf\n    d.mjd,                -- detection date (MJD)\n    d.fid,                -- filter identifier\n    d.isdiffpos,          -- isdiffpos flag\n    d.ra,                 -- RA (deg)\n    d.dec,                -- Dec (deg)\n    d.magpsf,             -- PSF difference magnitude\n    d.sigmapsf            -- uncertainty of PSF difference magnitude\nFROM ss_targets s, detection d\nWHERE d.oid = s.oid\nORDER BY s.ssnamenr, d.mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3123,
                "id": "chatcmpl-CZRCcCTG9PW7qDDnF5NRqUXD4l1tn",
                "created": 1762562082,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "96",
            "experiment_id": "run_7",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 531,
                "id": "chatcmpl-CZNCgNfUBhd8i8fm8PEpyvSXb7wfq",
                "created": 1762546710,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Get all detections for objects whose nearest known Solar System object\n   is either '2003FP134' or '2009UK56' and within 2 arcsec (assuming ssdistnr is in arcseconds).\n   Return all ss_ztf columns plus selected detection fields.\n*/\nSELECT\n    /* all columns from ss_ztf via correlated subqueries */\n    (SELECT s.oid FROM ss_ztf s WHERE s.oid = d.oid) AS oid,\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = d.oid) AS candid,\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssdistnr,\n    (SELECT s.ssmagnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssmagnr,\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid) AS ssnamenr,\n    /* requested detection fields */\n    d.mjd AS detection_date,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detection d\nWHERE d.oid IN (\n    /* prioritize obtaining OIDs in a subquery */\n    SELECT s1.oid\n    FROM ss_ztf s1\n    WHERE s1.ssnamenr IN ('2003FP134', '2009UK56')\n      AND s1.ssdistnr <= 2.0  /* 2 arcsec threshold */\n)\nORDER BY\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid),\n    d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Get all detections for objects whose nearest known Solar System object\n   is either '2003FP134' or '2009UK56' and within 2 arcsec (assuming ssdistnr is in arcseconds).\n   Return all ss_ztf columns plus selected detection fields.\n*/\nSELECT\n    /* all columns from ss_ztf via correlated subqueries */\n    (SELECT s.oid FROM ss_ztf s WHERE s.oid = d.oid) AS oid,\n    (SELECT s.candid FROM ss_ztf s WHERE s.oid = d.oid) AS candid,\n    (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssdistnr,\n    (SELECT s.ssmagnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssmagnr,\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid) AS ssnamenr,\n    /* requested detection fields */\n    d.mjd AS detection_date,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detection d\nWHERE d.oid IN (\n    /* prioritize obtaining OIDs in a subquery */\n    SELECT s1.oid\n    FROM ss_ztf s1\n    WHERE s1.ssnamenr IN ('2003FP134', '2009UK56')\n      AND s1.ssdistnr <= 2.0  /* 2 arcsec threshold */\n)\nORDER BY\n    (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid),\n    d.mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3385,
                "id": "chatcmpl-CZRE26qFHJ0d53rUIfAUnk9OpUxRj",
                "created": 1762562170,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "96",
            "experiment_id": "run_8",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 851,
                "id": "chatcmpl-CZNCse8UqmzKUux1Aa84mTeoUVBiA",
                "created": 1762546722,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* \nFor the Solar System identifiers '2003FP134' and '2009UK56', this query:\n- Selects all ZTF detections whose object OID is associated in ss_ztf to either name within 2 arcsec (ssdistnr <= 2).\n- Returns all columns from ss_ztf (oid, candid, ssdistnr, ssmagnr, ssnamenr).\n- Returns detection date (mjd), filter id (fid), isdiffpos, RA/Dec (ra, dec), and difference magnitude plus uncertainty (magpsf, sigmapsf).\n- Sorts by MPC name (ssnamenr) and detection date (mjd).\n- Avoids explicit JOINs by using nested subqueries and an OID subquery.\n*/\n\nWITH selected_oids AS (\n  SELECT s.oid\n  FROM ss_ztf s\n  WHERE s.ssnamenr IN ('2003FP134', '2009UK56')\n    AND s.ssdistnr <= 2\n)\nSELECT\n  /* All columns from ss_ztf */\n  (SELECT s.oid FROM ss_ztf s WHERE s.oid = d.oid) AS oid,\n  (SELECT s.candid FROM ss_ztf s WHERE s.oid = d.oid) AS candid,\n  (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssdistnr,\n  (SELECT s.ssmagnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssmagnr,\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid) AS ssnamenr,\n  /* Detection fields requested */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\nORDER BY ssnamenr, mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* \nFor the Solar System identifiers '2003FP134' and '2009UK56', this query:\n- Selects all ZTF detections whose object OID is associated in ss_ztf to either name within 2 arcsec (ssdistnr <= 2).\n- Returns all columns from ss_ztf (oid, candid, ssdistnr, ssmagnr, ssnamenr).\n- Returns detection date (mjd), filter id (fid), isdiffpos, RA/Dec (ra, dec), and difference magnitude plus uncertainty (magpsf, sigmapsf).\n- Sorts by MPC name (ssnamenr) and detection date (mjd).\n- Avoids explicit JOINs by using nested subqueries and an OID subquery.\n*/\n\nWITH selected_oids AS (\n  SELECT s.oid\n  FROM ss_ztf s\n  WHERE s.ssnamenr IN ('2003FP134', '2009UK56')\n    AND s.ssdistnr <= 2\n)\nSELECT\n  /* All columns from ss_ztf */\n  (SELECT s.oid FROM ss_ztf s WHERE s.oid = d.oid) AS oid,\n  (SELECT s.candid FROM ss_ztf s WHERE s.oid = d.oid) AS candid,\n  (SELECT s.ssdistnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssdistnr,\n  (SELECT s.ssmagnr FROM ss_ztf s WHERE s.oid = d.oid) AS ssmagnr,\n  (SELECT s.ssnamenr FROM ss_ztf s WHERE s.oid = d.oid) AS ssnamenr,\n  /* Detection fields requested */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\nORDER BY ssnamenr, mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3318,
                "id": "chatcmpl-CZRF1nyojo9rbQznrgdhTXvF1bz2x",
                "created": 1762562231,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "96",
            "experiment_id": "run_9",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 670,
                "out_toks": 659,
                "id": "chatcmpl-CZNDFfBRkseQkMlaZYZn8biwm646x",
                "created": 1762546745,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all detections for ZTF objects whose nearest known solar system object is either '2003FP134' or '2009UK56'\n-- and is within 2 arcsec, returning all ss_ztf columns plus selected detection fields.\nWITH target_oids AS (\n  SELECT s.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr\n  FROM ss_ztf s\n  WHERE s.ssnamenr IN ('2003FP134', '2009UK56')\n    AND s.ssdistnr <= 2  -- arcseconds\n)\nSELECT\n  /* all columns from ss_ztf */\n  (SELECT t.oid FROM target_oids t WHERE t.oid = d.oid) AS oid,\n  (SELECT t.candid FROM target_oids t WHERE t.oid = d.oid) AS candid,\n  (SELECT t.ssdistnr FROM target_oids t WHERE t.oid = d.oid) AS ssdistnr,\n  (SELECT t.ssmagnr FROM target_oids t WHERE t.oid = d.oid) AS ssmagnr,\n  (SELECT t.ssnamenr FROM target_oids t WHERE t.oid = d.oid) AS ssnamenr,\n  /* detection fields: detection date (mjd), filter identifier, isdiffpos flag, RA/Dec, difference magnitude and its uncertainty */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\nORDER BY\n  (SELECT t.ssnamenr FROM target_oids t WHERE t.oid = d.oid),\n  d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all detections for ZTF objects whose nearest known solar system object is either '2003FP134' or '2009UK56'\n-- and is within 2 arcsec, returning all ss_ztf columns plus selected detection fields.\nWITH target_oids AS (\n  SELECT s.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr\n  FROM ss_ztf s\n  WHERE s.ssnamenr IN ('2003FP134', '2009UK56')\n    AND s.ssdistnr <= 2  -- arcseconds\n)\nSELECT\n  /* all columns from ss_ztf */\n  (SELECT t.oid FROM target_oids t WHERE t.oid = d.oid) AS oid,\n  (SELECT t.candid FROM target_oids t WHERE t.oid = d.oid) AS candid,\n  (SELECT t.ssdistnr FROM target_oids t WHERE t.oid = d.oid) AS ssdistnr,\n  (SELECT t.ssmagnr FROM target_oids t WHERE t.oid = d.oid) AS ssmagnr,\n  (SELECT t.ssnamenr FROM target_oids t WHERE t.oid = d.oid) AS ssnamenr,\n  /* detection fields: detection date (mjd), filter identifier, isdiffpos flag, RA/Dec, difference magnitude and its uncertainty */\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.ra,\n  d.dec,\n  d.magpsf,\n  d.sigmapsf\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\nORDER BY\n  (SELECT t.ssnamenr FROM target_oids t WHERE t.oid = d.oid),\n  d.mjd;"
                },
                "in_toks": 2649,
                "out_toks": 3719,
                "id": "chatcmpl-CZRFw5XUI7UCtSkl23dyafnOEe7q1",
                "created": 1762562288,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "67": {
        "0": {
            "req_id": "67",
            "experiment_id": "run_0",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']",
                    "1": "['gaia_ztf', 'object']"
                },
                "in_toks": 648,
                "out_toks": 931,
                "id": "chatcmpl-CSnaGUytjCCf9415XtrvZMWaAk4FK",
                "created": 1760979820,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- OIDs of interest defined in a subquery (temporary inline table)\nWITH target_oids(oid) AS (\n    VALUES \n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n)\n-- Select all rows in gaia_ztf where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND neargaia <= 1.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- OIDs of interest defined in a subquery (temporary inline table)\nWITH target_oids(oid) AS (\n    VALUES \n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n)\n-- Select all rows in gaia_ztf where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND neargaia <= 1.5;"
                },
                "in_toks": 2134,
                "out_toks": 1273,
                "id": "chatcmpl-CSoJyt4LM7QWuCfujqb6kNTp2HvHf",
                "created": 1760982654,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "67",
            "experiment_id": "run_1",
            "pred_tables": [
                "gaia_ztf",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']",
                    "1": "['gaia_ztf', 'object']"
                },
                "in_toks": 648,
                "out_toks": 931,
                "id": "chatcmpl-CSnaGUytjCCf9415XtrvZMWaAk4FK",
                "created": 1760979820,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all gaia_ztf rows for the given ZTF object IDs where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE neargaia <= 1.5\n  AND oid IN (\n    -- Obtain the relevant object OIDs via a subquery (avoids JOINs as requested)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all gaia_ztf rows for the given ZTF object IDs where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE neargaia <= 1.5\n  AND oid IN (\n    -- Obtain the relevant object OIDs via a subquery (avoids JOINs as requested)\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  );"
                },
                "in_toks": 2616,
                "out_toks": 827,
                "id": "chatcmpl-CSoKA5xkkf0EDuqt1Q0MvhKyBV6jc",
                "created": 1760982666,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "67",
            "experiment_id": "run_2",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 648,
                "out_toks": 208,
                "id": "chatcmpl-CSsplOdikbQAradcsiK5uv8RTHMv4",
                "created": 1761000001,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns (*) for the requested ZTF objects whose nearest Gaia source is within 1.5 arcsec\nWITH targets(oid) AS (\n  VALUES \n    ('ZTF18acxlskz'),\n    ('ZTF22aanppbi'),\n    ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (SELECT oid FROM targets)\n  AND neargaia <= 1.5;  -- neargaia is in arcseconds; NULLs are excluded automatically by the comparison",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns (*) for the requested ZTF objects whose nearest Gaia source is within 1.5 arcsec\nWITH targets(oid) AS (\n  VALUES \n    ('ZTF18acxlskz'),\n    ('ZTF22aanppbi'),\n    ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (SELECT oid FROM targets)\n  AND neargaia <= 1.5;  -- neargaia is in arcseconds; NULLs are excluded automatically by the comparison"
                },
                "in_toks": 2134,
                "out_toks": 1272,
                "id": "chatcmpl-CSsybLFcZUEKQNRQFWZv8gDtk3xLQ",
                "created": 1761000549,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "67",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']"
                },
                "in_toks": 648,
                "out_toks": 595,
                "id": "chatcmpl-CSsppMZDzN4HhmobWOmMv2yCN0REl",
                "created": 1761000005,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the requested OIDs where the nearest Gaia source is within 1.5 arcsec\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT oid FROM target_oids)\n  AND g.neargaia <= 1.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the requested OIDs where the nearest Gaia source is within 1.5 arcsec\nWITH target_oids (oid) AS (\n    VALUES\n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT oid FROM target_oids)\n  AND g.neargaia <= 1.5;"
                },
                "in_toks": 2616,
                "out_toks": 749,
                "id": "chatcmpl-CSsyeCrhwcmONKPzBSVDFZP3QMqdc",
                "created": 1761000552,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "67",
            "experiment_id": "run_4",
            "pred_tables": [
                "gaia_ztf",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf', 'object']"
                },
                "in_toks": 648,
                "out_toks": 659,
                "id": "chatcmpl-CSspwe4D0RrEAl9tyOvomlbSMqGjf",
                "created": 1761000012,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find objects in gaia_ztf whose nearest Gaia source is within 1.5 arcsec for the specified ZTF OIDs\nWITH input_oids(oid) AS (\n    VALUES \n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n),\nselected_oids AS (\n    -- Retrieve valid OIDs from the object table (following the guideline to obtain OIDs via a subquery)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT i.oid FROM input_oids i)\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT so.oid FROM selected_oids so)\n  AND g.neargaia <= 1.5;  -- \"within 1.5 arcsec\" interpreted as inclusive (<= 1.5)",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find objects in gaia_ztf whose nearest Gaia source is within 1.5 arcsec for the specified ZTF OIDs\nWITH input_oids(oid) AS (\n    VALUES \n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n),\nselected_oids AS (\n    -- Retrieve valid OIDs from the object table (following the guideline to obtain OIDs via a subquery)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT i.oid FROM input_oids i)\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT so.oid FROM selected_oids so)\n  AND g.neargaia <= 1.5;  -- \"within 1.5 arcsec\" interpreted as inclusive (<= 1.5)"
                },
                "in_toks": 2616,
                "out_toks": 1028,
                "id": "chatcmpl-CSsyf9qJdEKRipHUmf2O54pMOjghm",
                "created": 1761000553,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "67",
            "experiment_id": "run_5",
            "pred_tables": [
                "gaia_ztf",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf', 'object']"
                },
                "in_toks": 648,
                "out_toks": 531,
                "id": "chatcmpl-CZNDVeGhefrspHar9wR8NYzlmMTDK",
                "created": 1762546761,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all gaia_ztf rows for the specified ZTF objects where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Obtain the OIDs via a subquery from the object table as recommended\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n)\nAND neargaia <= 1.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all gaia_ztf rows for the specified ZTF objects where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Obtain the OIDs via a subquery from the object table as recommended\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n)\nAND neargaia <= 1.5;"
                },
                "in_toks": 2616,
                "out_toks": 949,
                "id": "chatcmpl-CZRHOF81unGv7ZMaCDPhpmcZ9WVpF",
                "created": 1762562378,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "67",
            "experiment_id": "run_6",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 648,
                "out_toks": 272,
                "id": "chatcmpl-CZNDoU4fJBQr6Nw9ugbAyZeJcxWhg",
                "created": 1762546780,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find gaia_ztf rows for specific ZTF objects whose nearest Gaia source is within 1.5 arcsec\nWITH targets(oid) AS (\n    VALUES \n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT oid FROM targets)\n  AND g.neargaia <= 1.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find gaia_ztf rows for specific ZTF objects whose nearest Gaia source is within 1.5 arcsec\nWITH targets(oid) AS (\n    VALUES \n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT oid FROM targets)\n  AND g.neargaia <= 1.5;"
                },
                "in_toks": 2134,
                "out_toks": 684,
                "id": "chatcmpl-CZRI8rwRAssQHb6Jr2djhegaooDnU",
                "created": 1762562424,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "67",
            "experiment_id": "run_7",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 648,
                "out_toks": 336,
                "id": "chatcmpl-CZNDveg46DuJDhK6w70wgSDExec6x",
                "created": 1762546787,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all rows in gaia_ztf for the specified ZTF objects where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  AND neargaia <= 1.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all rows in gaia_ztf for the specified ZTF objects where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  AND neargaia <= 1.5;"
                },
                "in_toks": 2134,
                "out_toks": 920,
                "id": "chatcmpl-CZRIdO86StqkJhesvBTdBhQXzq5hC",
                "created": 1762562455,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "67",
            "experiment_id": "run_8",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 648,
                "out_toks": 272,
                "id": "chatcmpl-CZNE3Ck1YeZ5J8w7nc1Tj3n1Bkknj",
                "created": 1762546795,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all gaia_ztf rows for the specified ZTF oids where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n    ) AS oids(oid)\n)\nAND neargaia <= 1.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all gaia_ztf rows for the specified ZTF oids where the nearest Gaia source is within 1.5 arcsec\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF18acxlskz'),\n        ('ZTF22aanppbi'),\n        ('ZTF22abunrft')\n    ) AS oids(oid)\n)\nAND neargaia <= 1.5;"
                },
                "in_toks": 2134,
                "out_toks": 877,
                "id": "chatcmpl-CZRIyzTPnouTlaUWkl1ShqS1sCxFW",
                "created": 1762562476,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "67",
            "experiment_id": "run_9",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 648,
                "out_toks": 912,
                "id": "chatcmpl-CZNEB58MdOGg0ySHK5t8KLwWGdX42",
                "created": 1762546803,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all Gaia crossmatch rows for the specified ZTF objects where the nearest Gaia source is within 1.5 arcsec\nWITH target_oids (oid) AS (\n                           VALUES ('ZTF18acxlskz'), ('ZTF22aanppbi'), ('ZTF22abunrft'))\nSELECT *\nFROM gaia_ztf\nWHERE oid IN\n    (SELECT oid\n     FROM target_oids)\n  AND neargaia <= 1.5;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all Gaia crossmatch rows for the specified ZTF objects where the nearest Gaia source is within 1.5 arcsec\nWITH target_oids (oid) AS (\n                           VALUES ('ZTF18acxlskz'), ('ZTF22aanppbi'), ('ZTF22abunrft'))\nSELECT *\nFROM gaia_ztf\nWHERE oid IN\n    (SELECT oid\n     FROM target_oids)\n  AND neargaia <= 1.5;"
                },
                "in_toks": 2134,
                "out_toks": 877,
                "id": "chatcmpl-CaypkfDHohJd0iy5dyMsVrdemGRpR",
                "created": 1762929688,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "55": {
        "0": {
            "req_id": "55",
            "experiment_id": "run_0",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 607,
                "out_toks": 152,
                "id": "chatcmpl-CSnaSBPUHxkKdTVX9uu5LJq1mn5IH",
                "created": 1760979832,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the specified ZTF object OID\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the specified ZTF object OID\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';"
                },
                "in_toks": 2357,
                "out_toks": 486,
                "id": "chatcmpl-CSoKMVcdWzVdxBcBF1DBAF3OmZnYN",
                "created": 1760982678,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "55",
            "experiment_id": "run_1",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 607,
                "out_toks": 152,
                "id": "chatcmpl-CSnaSBPUHxkKdTVX9uu5LJq1mn5IH",
                "created": 1760979832,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all available columns for the specified ZTF object from the 'object' table\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all available columns for the specified ZTF object from the 'object' table\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';"
                },
                "in_toks": 2357,
                "out_toks": 747,
                "id": "chatcmpl-CSoKTbGTsqJz51cIZuyqmy9Z9q6GM",
                "created": 1760982685,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "55",
            "experiment_id": "run_2",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 607,
                "out_toks": 76,
                "id": "chatcmpl-CSsq5bY7poSRBtc2zabSHirIfCTY2",
                "created": 1761000021,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the specified ZTF object OID\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the specified ZTF object OID\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';"
                },
                "in_toks": 2357,
                "out_toks": 422,
                "id": "chatcmpl-CSsyo64JNtgWxBMfyicpV2y83Ly5L",
                "created": 1761000562,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "55",
            "experiment_id": "run_3",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 607,
                "out_toks": 140,
                "id": "chatcmpl-CSsq76jBrHlKkFCsrtti92MwtoQtI",
                "created": 1761000023,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns for the requested ZTF object using a nested subquery to retrieve the OID\nSELECT *\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns for the requested ZTF object using a nested subquery to retrieve the OID\nSELECT *\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);"
                },
                "in_toks": 2357,
                "out_toks": 508,
                "id": "chatcmpl-CSsyqxUwt6uJzPbNobkYDQcjQcN2N",
                "created": 1761000564,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "55",
            "experiment_id": "run_4",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 607,
                "out_toks": 12,
                "id": "chatcmpl-CSsqAHC52r5ekJLkXhIFyQN8ur36w",
                "created": 1761000026,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the specified ZTF object from the object table\nSELECT *\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the specified ZTF object from the object table\nSELECT *\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);"
                },
                "in_toks": 2357,
                "out_toks": 566,
                "id": "chatcmpl-CSsytK61NJUsc7oNHWFFhKln92YdP",
                "created": 1761000567,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "55",
            "experiment_id": "run_5",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 607,
                "out_toks": 140,
                "id": "chatcmpl-CZNEXhUZ3LKdVzVL0Q2sVuP00jaZO",
                "created": 1762546825,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the specific ZTF object from the object table\nSELECT *\nFROM object\nWHERE oid IN (\n    -- Subquery to obtain the target OID (follows the guideline of obtaining OIDs via a nested query)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the specific ZTF object from the object table\nSELECT *\nFROM object\nWHERE oid IN (\n    -- Subquery to obtain the target OID (follows the guideline of obtaining OIDs via a nested query)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);"
                },
                "in_toks": 2357,
                "out_toks": 398,
                "id": "chatcmpl-CZRJj618VlCvEkTZ52NeLMzceCh5X",
                "created": 1762562523,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "55",
            "experiment_id": "run_6",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 607,
                "out_toks": 76,
                "id": "chatcmpl-CZNEab1jXDv3mjIeg9NuNu9iAsRKz",
                "created": 1762546828,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the specified ZTF object, retrieving the OID via a subquery as per guidance\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM target_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the specified ZTF object, retrieving the OID via a subquery as per guidance\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM target_oids);"
                },
                "in_toks": 2357,
                "out_toks": 651,
                "id": "chatcmpl-CZRK476GT5hA7x9z5K9ymOBNrUoW9",
                "created": 1762562544,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "55",
            "experiment_id": "run_7",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 607,
                "out_toks": 76,
                "id": "chatcmpl-CZNEeFg7CB2OaHJFzKQgOVNPrfxXR",
                "created": 1762546832,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns from the object table for the specified ZTF oid\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns from the object table for the specified ZTF oid\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';"
                },
                "in_toks": 2357,
                "out_toks": 360,
                "id": "chatcmpl-CZRKE7hRu2E5KruXfsMTbtEYHOBXE",
                "created": 1762562554,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "55",
            "experiment_id": "run_8",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 607,
                "out_toks": 76,
                "id": "chatcmpl-CZNEhpts7D8Q1xoF6rUc5ifxdDzwN",
                "created": 1762546835,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all columns for the specified ZTF object\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all columns for the specified ZTF object\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';"
                },
                "in_toks": 2357,
                "out_toks": 548,
                "id": "chatcmpl-CZRKd3Kvc05GQCH9O2QN9TnbAdXmR",
                "created": 1762562579,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "55",
            "experiment_id": "run_9",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 607,
                "out_toks": 76,
                "id": "chatcmpl-CZNEkcoGtqzsvcyQLqljhSikpAAZ4",
                "created": 1762546838,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all information from the 'object' table for the specified ZTF object, using a nested subquery to select the OID\nSELECT *\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all information from the 'object' table for the specified ZTF object, using a nested subquery to select the OID\nSELECT *\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20aatxryt'\n);"
                },
                "in_toks": 2357,
                "out_toks": 387,
                "id": "chatcmpl-CZRKhresJpB7teSc2Jpge6lgh9tWq",
                "created": 1762562583,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "47": {
        "0": {
            "req_id": "47",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']",
                    "1": "['object', 'detection']"
                },
                "in_toks": 673,
                "out_toks": 1312,
                "id": "chatcmpl-CSnaUMpSjCI2qddNmQ0rA2gvPnDvX",
                "created": 1760979834,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return detections for the requested ZTF objects with real/bogus score > 0.7\n-- We use COALESCE(drb, rb) both to filter and to return a single \"real_bogus_score\" column:\n--   - drb: deep-learning real/bogus score (preferred when available)\n--   - rb: legacy real/bogus score (used as fallback if drb is NULL)\n-- Columns returned: ZTF (oid), candidate id (candid), filter id (fid), detection date (mjd),\n-- isdiffpos flag, detection RA/Dec, difference magnitude (magpsf) and its uncertainty (sigmapsf),\n-- and the selected real_bogus_score\nSELECT\n    d.oid AS ztf,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    COALESCE(d.drb, d.rb) AS real_bogus_score\nFROM detection d\nWHERE d.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nAND COALESCE(d.drb, d.rb) > 0.7\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return detections for the requested ZTF objects with real/bogus score > 0.7\n-- We use COALESCE(drb, rb) both to filter and to return a single \"real_bogus_score\" column:\n--   - drb: deep-learning real/bogus score (preferred when available)\n--   - rb: legacy real/bogus score (used as fallback if drb is NULL)\n-- Columns returned: ZTF (oid), candidate id (candid), filter id (fid), detection date (mjd),\n-- isdiffpos flag, detection RA/Dec, difference magnitude (magpsf) and its uncertainty (sigmapsf),\n-- and the selected real_bogus_score\nSELECT\n    d.oid AS ztf,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    COALESCE(d.drb, d.rb) AS real_bogus_score\nFROM detection d\nWHERE d.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nAND COALESCE(d.drb, d.rb) > 0.7\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 2972,
                "out_toks": 2349,
                "id": "chatcmpl-CSoKc4295nO2VEZWcnEKvTj4Rq1Cx",
                "created": 1760982694,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "47",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']",
                    "1": "['object', 'detection']"
                },
                "in_toks": 673,
                "out_toks": 1312,
                "id": "chatcmpl-CSnaUMpSjCI2qddNmQ0rA2gvPnDvX",
                "created": 1760979834,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* For the requested ZTF oids, filter detections with Deep-Learning Real/Bogus (drb) > 0.7 */\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,          -- ZTF identifier\n    d.candid,       -- candidate identifier\n    d.fid,          -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,          -- detection date (MJD)\n    d.isdiffpos,    -- isdiffpos flag\n    d.ra,           -- detection RA\n    d.dec,          -- detection Dec\n    d.magpsf,       -- difference magnitude\n    d.sigmapsf,     -- uncertainty of difference magnitude\n    d.drb           -- real/bogus score (deep learning)\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.drb IS NOT NULL\n  AND d.drb > 0.7\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* For the requested ZTF oids, filter detections with Deep-Learning Real/Bogus (drb) > 0.7 */\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,          -- ZTF identifier\n    d.candid,       -- candidate identifier\n    d.fid,          -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,          -- detection date (MJD)\n    d.isdiffpos,    -- isdiffpos flag\n    d.ra,           -- detection RA\n    d.dec,          -- detection Dec\n    d.magpsf,       -- difference magnitude\n    d.sigmapsf,     -- uncertainty of difference magnitude\n    d.drb           -- real/bogus score (deep learning)\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.drb IS NOT NULL\n  AND d.drb > 0.7\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 2972,
                "out_toks": 1594,
                "id": "chatcmpl-CSoKyhgCr54H9wvzjWrVLSatxNP3m",
                "created": 1760982716,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "47",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 673,
                "out_toks": 976,
                "id": "chatcmpl-CSsqDfN810u0NE7MRFISMNk0ZWp18",
                "created": 1761000029,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find detections for the specified ZTF objects with real/bogus (deep-learning) score > 0.7\n   Returning: ZTF identifier (oid), candidate id (candid), filter id (fid), detection date (mjd),\n   isdiffpos flag, detection coordinates (ra, dec), difference magnitude (magpsf) and its uncertainty (sigmapsf), and real/bogus score (drb) */\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.drb\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\n  AND d.drb > 0.7\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find detections for the specified ZTF objects with real/bogus (deep-learning) score > 0.7\n   Returning: ZTF identifier (oid), candidate id (candid), filter id (fid), detection date (mjd),\n   isdiffpos flag, detection coordinates (ra, dec), difference magnitude (magpsf) and its uncertainty (sigmapsf), and real/bogus score (drb) */\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.drb\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\n  AND d.drb > 0.7\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 2972,
                "out_toks": 1380,
                "id": "chatcmpl-CSsyvH634FVwDxt3txTE1TaSoXk2C",
                "created": 1761000569,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "47",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 673,
                "out_toks": 464,
                "id": "chatcmpl-CSsqQGVpukh81zrRbJ3WPTmiWcOoI",
                "created": 1761000042,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Detections for the specified ZTF objects with real/bogus score (rb) > 0.7\n-- Note: 'rb' (traditional ZTF real-bogus score) is used for filtering and returning,\n-- and 'magpsf'/'sigmapsf' provide the difference magnitude and its uncertainty.\nSELECT\n    d.oid,          -- ZTF identifier\n    d.candid,       -- candidate identifier\n    d.fid,          -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,          -- detection date (MJD)\n    d.isdiffpos,    -- isdiffpos flag\n    d.ra,           -- detection RA\n    d.dec,          -- detection Dec\n    d.magpsf,       -- difference magnitude (PSF)\n    d.sigmapsf,     -- uncertainty of difference magnitude\n    d.rb            -- real/bogus score\nFROM detection d\nWHERE d.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nAND d.rb > 0.7\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Detections for the specified ZTF objects with real/bogus score (rb) > 0.7\n-- Note: 'rb' (traditional ZTF real-bogus score) is used for filtering and returning,\n-- and 'magpsf'/'sigmapsf' provide the difference magnitude and its uncertainty.\nSELECT\n    d.oid,          -- ZTF identifier\n    d.candid,       -- candidate identifier\n    d.fid,          -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,          -- detection date (MJD)\n    d.isdiffpos,    -- isdiffpos flag\n    d.ra,           -- detection RA\n    d.dec,          -- detection Dec\n    d.magpsf,       -- difference magnitude (PSF)\n    d.sigmapsf,     -- uncertainty of difference magnitude\n    d.rb            -- real/bogus score\nFROM detection d\nWHERE d.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nAND d.rb > 0.7\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 2972,
                "out_toks": 1739,
                "id": "chatcmpl-CSsywa0pGyOKgMtMAycRcDySPhunY",
                "created": 1761000570,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "47",
            "experiment_id": "run_4",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']"
                },
                "in_toks": 673,
                "out_toks": 589,
                "id": "chatcmpl-CSsqXZhPclcj7cOBhmSa4Ep1HCviC",
                "created": 1761000049,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Detections for specified ZTF objects with rb > 0.7, ordered by ZTF (oid) and detection date (mjd)\nWITH desired_oids(oid) AS (\n    VALUES \n        ('ZTF23aaawbsc'),\n        ('ZTF21abxlmuw')\n)\nSELECT\n    d.oid AS ztf,        -- ZTF identifier (object id)\n    d.candid,            -- candidate identifier\n    d.fid,               -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,               -- detection date (MJD)\n    d.isdiffpos,         -- isdiffpos flag\n    d.ra,                -- detection RA\n    d.dec,               -- detection Dec\n    d.magpsf,            -- difference magnitude\n    d.sigmapsf,          -- difference magnitude uncertainty\n    d.rb                 -- real/bogus score\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM desired_oids)\n  AND d.rb > 0.7\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Detections for specified ZTF objects with rb > 0.7, ordered by ZTF (oid) and detection date (mjd)\nWITH desired_oids(oid) AS (\n    VALUES \n        ('ZTF23aaawbsc'),\n        ('ZTF21abxlmuw')\n)\nSELECT\n    d.oid AS ztf,        -- ZTF identifier (object id)\n    d.candid,            -- candidate identifier\n    d.fid,               -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,               -- detection date (MJD)\n    d.isdiffpos,         -- isdiffpos flag\n    d.ra,                -- detection RA\n    d.dec,               -- detection Dec\n    d.magpsf,            -- difference magnitude\n    d.sigmapsf,          -- difference magnitude uncertainty\n    d.rb                 -- real/bogus score\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM desired_oids)\n  AND d.rb > 0.7\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 2490,
                "out_toks": 1645,
                "id": "chatcmpl-CSsyzNaJjFBydny6CZU5EjXG29F85",
                "created": 1761000573,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "47",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 673,
                "out_toks": 784,
                "id": "chatcmpl-CZNEoVv3Hv1RK4naay5L5m0rkIqDU",
                "created": 1762546842,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Detections for specified ZTF objects with rb > 0.7\n-- Columns returned:\n--  oid (ZTF identifier), candid (candidate id), fid (filter id), mjd (detection date),\n--  isdiffpos flag, ra, dec (detection coordinates), magpsf (difference magnitude),\n--  sigmapsf (difference magnitude uncertainty), rb (real/bogus score)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.rb\nFROM detection d\nWHERE d.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- obtain OIDs in a subquery\n)\nAND d.rb > 0.7\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Detections for specified ZTF objects with rb > 0.7\n-- Columns returned:\n--  oid (ZTF identifier), candid (candidate id), fid (filter id), mjd (detection date),\n--  isdiffpos flag, ra, dec (detection coordinates), magpsf (difference magnitude),\n--  sigmapsf (difference magnitude uncertainty), rb (real/bogus score)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.rb\nFROM detection d\nWHERE d.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- obtain OIDs in a subquery\n)\nAND d.rb > 0.7\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 2972,
                "out_toks": 1565,
                "id": "chatcmpl-CZRLBtgVoR1xUT8ALRwTswaYwfz6H",
                "created": 1762562613,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "47",
            "experiment_id": "run_6",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']"
                },
                "in_toks": 673,
                "out_toks": 781,
                "id": "chatcmpl-CZNF8D0yxuJCqQqpNlEC7s8xXpVxR",
                "created": 1762546862,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Detections for specific ZTF objects with deep-learning real/bogus (drb) > 0.7\n-- Columns: ZTF identifier (oid), candidate id (candid), filter id (fid), detection date (mjd),\n--          isdiffpos flag, detection RA/Dec, difference magnitude (magpsf) and its uncertainty (sigmapsf), and real/bogus score (drb)\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF23aaawbsc'),\n        ('ZTF21abxlmuw')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.drb\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.drb > 0.7\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Detections for specific ZTF objects with deep-learning real/bogus (drb) > 0.7\n-- Columns: ZTF identifier (oid), candidate id (candid), filter id (fid), detection date (mjd),\n--          isdiffpos flag, detection RA/Dec, difference magnitude (magpsf) and its uncertainty (sigmapsf), and real/bogus score (drb)\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF23aaawbsc'),\n        ('ZTF21abxlmuw')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.drb\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.drb > 0.7\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 2490,
                "out_toks": 1757,
                "id": "chatcmpl-CZRLAvWxXprqFzyavL2QhzfIlduTi",
                "created": 1762562612,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "47",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 673,
                "out_toks": 528,
                "id": "chatcmpl-CZNFSrGrJK9BO6ujRlL0sCVTNnbq9",
                "created": 1762546882,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find detections for the specified ZTF objects with real/bogus score > 0.7\n-- Note: Using rb (ZTF real bogus score). If you intended the deep-learning score, replace rb with drb in SELECT and WHERE.\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,         -- ZTF identifier\n    d.candid,      -- candidate identifier\n    d.fid,         -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,         -- detection date (MJD)\n    d.isdiffpos,   -- isdiffpos flag\n    d.ra,          -- detection RA\n    d.dec,         -- detection Dec\n    d.magpsf,      -- difference magnitude (PSF)\n    d.sigmapsf,    -- uncertainty of difference magnitude\n    d.rb           -- real/bogus score\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.rb > 0.7\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find detections for the specified ZTF objects with real/bogus score > 0.7\n-- Note: Using rb (ZTF real bogus score). If you intended the deep-learning score, replace rb with drb in SELECT and WHERE.\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,         -- ZTF identifier\n    d.candid,      -- candidate identifier\n    d.fid,         -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,         -- detection date (MJD)\n    d.isdiffpos,   -- isdiffpos flag\n    d.ra,          -- detection RA\n    d.dec,         -- detection Dec\n    d.magpsf,      -- difference magnitude (PSF)\n    d.sigmapsf,    -- uncertainty of difference magnitude\n    d.rb           -- real/bogus score\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.rb > 0.7\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 2972,
                "out_toks": 1796,
                "id": "chatcmpl-CZRM5Lurx9p2ia270r5gEONwQa14s",
                "created": 1762562669,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "47",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 673,
                "out_toks": 528,
                "id": "chatcmpl-CZNFmsl5i2YfvedMlOEwkLBzhrkBZ",
                "created": 1762546902,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Detections for the specified ZTF objects with real/bogus score > 0.7\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,        -- ZTF identifier\n    d.candid,     -- candidate identifier\n    d.fid,        -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,        -- detection date (MJD)\n    d.isdiffpos,  -- isdiffpos flag\n    d.ra,         -- detection RA\n    d.dec,        -- detection Dec\n    d.magpsf,     -- difference magnitude\n    d.sigmapsf,   -- uncertainty of difference magnitude\n    d.rb          -- real/bogus score\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.rb > 0.7\nORDER BY d.oid ASC, d.mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Detections for the specified ZTF objects with real/bogus score > 0.7\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nSELECT\n    d.oid,        -- ZTF identifier\n    d.candid,     -- candidate identifier\n    d.fid,        -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,        -- detection date (MJD)\n    d.isdiffpos,  -- isdiffpos flag\n    d.ra,         -- detection RA\n    d.dec,        -- detection Dec\n    d.magpsf,     -- difference magnitude\n    d.sigmapsf,   -- uncertainty of difference magnitude\n    d.rb          -- real/bogus score\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n  AND d.rb > 0.7\nORDER BY d.oid ASC, d.mjd ASC;"
                },
                "in_toks": 2972,
                "out_toks": 1637,
                "id": "chatcmpl-CZRAQDzOv1a6RS3YFjmmfLtx1z9CL",
                "created": 1762561946,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "47",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 673,
                "out_toks": 720,
                "id": "chatcmpl-CZNG27j87aghz6d6C6o3eNgP27kAb",
                "created": 1762546918,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Detections for the specified ZTF objects with real/bogus score > 0.7\n-- Using COALESCE(drb, rb) to prefer the deep-learning score (drb) when available, otherwise fall back to rb\nSELECT\n    d.oid,          -- ZTF identifier\n    d.candid,       -- candidate identifier\n    d.fid,          -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,          -- detection date (MJD)\n    d.isdiffpos,    -- isdiffpos flag\n    d.ra,           -- detection RA\n    d.dec,          -- detection Dec\n    d.magpsf,       -- difference magnitude\n    d.sigmapsf,     -- uncertainty of difference magnitude\n    COALESCE(d.drb, d.rb) AS real_bogus_score\nFROM detection d\nWHERE d.oid IN (\n    -- Prioritize obtaining OIDs in a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nAND COALESCE(d.drb, d.rb) > 0.7\nORDER BY d.oid, d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Detections for the specified ZTF objects with real/bogus score > 0.7\n-- Using COALESCE(drb, rb) to prefer the deep-learning score (drb) when available, otherwise fall back to rb\nSELECT\n    d.oid,          -- ZTF identifier\n    d.candid,       -- candidate identifier\n    d.fid,          -- filter identifier (1=g; 2=r; 3=i)\n    d.mjd,          -- detection date (MJD)\n    d.isdiffpos,    -- isdiffpos flag\n    d.ra,           -- detection RA\n    d.dec,          -- detection Dec\n    d.magpsf,       -- difference magnitude\n    d.sigmapsf,     -- uncertainty of difference magnitude\n    COALESCE(d.drb, d.rb) AS real_bogus_score\nFROM detection d\nWHERE d.oid IN (\n    -- Prioritize obtaining OIDs in a subquery from the object table\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n)\nAND COALESCE(d.drb, d.rb) > 0.7\nORDER BY d.oid, d.mjd;"
                },
                "in_toks": 2972,
                "out_toks": 1750,
                "id": "chatcmpl-CZRBYFzGoSiNliHVy5Msk1N1wdrwj",
                "created": 1762562016,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "79": {
        "0": {
            "req_id": "79",
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 623,
                "out_toks": 538,
                "id": "chatcmpl-CSnafRwOUBqB2ZvpMynSMG2Qw33UE",
                "created": 1760979845,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return catalog name (catid), catalog object id (oid_catalog), and angular distance (dist, in arcsec)\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return catalog name (catid), catalog object id (oid_catalog), and angular distance (dist, in arcsec)\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';"
                },
                "in_toks": 2005,
                "out_toks": 574,
                "id": "chatcmpl-CSoFLtSjJeqCPpEe7d40Iplgol9eX",
                "created": 1760982367,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "79",
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 623,
                "out_toks": 538,
                "id": "chatcmpl-CSnafRwOUBqB2ZvpMynSMG2Qw33UE",
                "created": 1760979845,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get catalog name, catalog object id, and angular distance [arcsec] for the given ZTF object\nSELECT\n  catid,\n  oid_catalog,\n  dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get catalog name, catalog object id, and angular distance [arcsec] for the given ZTF object\nSELECT\n  catid,\n  oid_catalog,\n  dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';"
                },
                "in_toks": 2005,
                "out_toks": 636,
                "id": "chatcmpl-CSoFSrcVk2zmyHDLYAqjZsPvk70lH",
                "created": 1760982374,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "79",
            "experiment_id": "run_2",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 623,
                "out_toks": 141,
                "id": "chatcmpl-CSsqhGWT5VT0PpPLm7ymn9rPoT6aX",
                "created": 1761000059,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get catalog name (catid), catalog object identifier (oid_catalog), and angular distance in arcsec (dist)\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get catalog name (catid), catalog object identifier (oid_catalog), and angular distance in arcsec (dist)\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';"
                },
                "in_toks": 2005,
                "out_toks": 701,
                "id": "chatcmpl-CSsz2nQWRKh27qGILqvj7r7lhT2ju",
                "created": 1761000576,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "79",
            "experiment_id": "run_3",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 623,
                "out_toks": 205,
                "id": "chatcmpl-CSsqlVjZ59uw9ngwqdeWUf30ygUdU",
                "created": 1761000063,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve catalog name, catalog object identifier, and angular distance (arcsec) for the specified ZTF object\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve catalog name, catalog object identifier, and angular distance (arcsec) for the specified ZTF object\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';"
                },
                "in_toks": 2005,
                "out_toks": 828,
                "id": "chatcmpl-CSsz3PSGdardEcPGK0Gq2aC84wvAG",
                "created": 1761000577,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "79",
            "experiment_id": "run_4",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 623,
                "out_toks": 589,
                "id": "chatcmpl-CSsqpsMNijHdBEx2E2I3uYqdDQayF",
                "created": 1761000067,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return catalog name, catalog object id, and angular separation [arcsec] for the given ZTF object\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return catalog name, catalog object id, and angular separation [arcsec] for the given ZTF object\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';"
                },
                "in_toks": 2005,
                "out_toks": 636,
                "id": "chatcmpl-CSsz9jJWaFVXv096AVxPivmkNt2aK",
                "created": 1761000583,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "79",
            "experiment_id": "run_5",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 623,
                "out_toks": 269,
                "id": "chatcmpl-CZNGZnp8hbAS4mHkgw5NB96cJ17Py",
                "created": 1762546951,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get catalog name, catalog object identifier, and angular separation (arcsec) \n-- for the specified ZTF object from the xmatch table\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get catalog name, catalog object identifier, and angular separation (arcsec) \n-- for the specified ZTF object from the xmatch table\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';"
                },
                "in_toks": 2005,
                "out_toks": 579,
                "id": "chatcmpl-CZRD0nFked56Pbu8OdRYO20eJKMo8",
                "created": 1762562106,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "79",
            "experiment_id": "run_6",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 623,
                "out_toks": 269,
                "id": "chatcmpl-CZNGh3sthAkzxp5w733CW0sr9gesB",
                "created": 1762546959,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve catalog name (catid), catalog object identifier (oid_catalog), and distance (dist)\n-- for the specified ZTF object using a subquery to provide the target OID.\nWITH target_oids AS (\n    SELECT 'ZTF20achscch'::varchar AS oid\n)\nSELECT\n    x.catid,\n    x.oid_catalog,\n    x.dist\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM target_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve catalog name (catid), catalog object identifier (oid_catalog), and distance (dist)\n-- for the specified ZTF object using a subquery to provide the target OID.\nWITH target_oids AS (\n    SELECT 'ZTF20achscch'::varchar AS oid\n)\nSELECT\n    x.catid,\n    x.oid_catalog,\n    x.dist\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM target_oids);"
                },
                "in_toks": 2005,
                "out_toks": 616,
                "id": "chatcmpl-CZRDaqxgSxLvrvfiPku3fXjN598qb",
                "created": 1762562142,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "79",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch']"
                },
                "in_toks": 623,
                "out_toks": 336,
                "id": "chatcmpl-CZNGq60YJBy0HSjHTm2NfLdtdqatJ",
                "created": 1762546968,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get catalog name, catalog object identifier, and distance for the given ZTF object using a subquery for the OID\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20achscch'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get catalog name, catalog object identifier, and distance for the given ZTF object using a subquery for the OID\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF20achscch'\n);"
                },
                "in_toks": 2487,
                "out_toks": 653,
                "id": "chatcmpl-CZRE7zlydGsYWmvfCEksgr7vsAo7h",
                "created": 1762562175,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "79",
            "experiment_id": "run_8",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 623,
                "out_toks": 589,
                "id": "chatcmpl-CZNGznhHe16HSfMFFn5oXRyO9UH7g",
                "created": 1762546977,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get catalog name, catalog object identifier, and distance for a given ZTF object from xmatch\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get catalog name, catalog object identifier, and distance for a given ZTF object from xmatch\nSELECT\n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';"
                },
                "in_toks": 2005,
                "out_toks": 762,
                "id": "chatcmpl-CZREjeEKvtaZkn0E7dejluhURL8m6",
                "created": 1762562213,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "79",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch']"
                },
                "in_toks": 623,
                "out_toks": 336,
                "id": "chatcmpl-CZNHGBhmIhYhDWs2El4kS16cDrA2A",
                "created": 1762546994,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return catalog name (catid), object identifier in the catalog (oid_catalog), and distance in arcseconds (dist)\nSELECT x.catid, x.oid_catalog, x.dist\nFROM xmatch x\nWHERE x.oid = (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF20achscch'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return catalog name (catid), object identifier in the catalog (oid_catalog), and distance in arcseconds (dist)\nSELECT x.catid, x.oid_catalog, x.dist\nFROM xmatch x\nWHERE x.oid = (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF20achscch'\n);"
                },
                "in_toks": 2487,
                "out_toks": 660,
                "id": "chatcmpl-CZRFRHqQzqO4MsqsbSr4AUFMy0OfJ",
                "created": 1762562257,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "94": {
        "0": {
            "req_id": "94",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 734,
                "id": "chatcmpl-CSnakHQhj7VbqNRO3C4mDvsm0gSmF",
                "created": 1760979850,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns from object and reference for objects with a change in the reference\n-- Avoid explicit JOINs by using a nested OID subquery and comma-separated FROM with a WHERE clause\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change = true\n)\nSELECT o.*, r.*\nFROM object o, reference r\nWHERE o.oid = r.oid\n  AND o.oid IN (SELECT oid FROM oids)\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns from object and reference for objects with a change in the reference\n-- Avoid explicit JOINs by using a nested OID subquery and comma-separated FROM with a WHERE clause\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change = true\n)\nSELECT o.*, r.*\nFROM object o, reference r\nWHERE o.oid = r.oid\n  AND o.oid IN (SELECT oid FROM oids)\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 2091,
                "id": "chatcmpl-CSoFZpQ2nItecqv8m8vFsIchIdK4d",
                "created": 1760982381,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "94",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 734,
                "id": "chatcmpl-CSnakHQhj7VbqNRO3C4mDvsm0gSmF",
                "created": 1760979850,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns from object and reference for objects with a change in the reference (reference_change = TRUE)\n-- Uses a subquery to obtain OIDs first and avoids explicit JOIN clauses\nWITH refchg_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change = TRUE\n)\nSELECT o.*, r.*\nFROM reference r, object o\nWHERE r.oid IN (SELECT oid FROM refchg_oids)\n  AND o.oid = r.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns from object and reference for objects with a change in the reference (reference_change = TRUE)\n-- Uses a subquery to obtain OIDs first and avoids explicit JOIN clauses\nWITH refchg_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change = TRUE\n)\nSELECT o.*, r.*\nFROM reference r, object o\nWHERE r.oid IN (SELECT oid FROM refchg_oids)\n  AND o.oid = r.oid\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 2094,
                "id": "chatcmpl-CSoFsdXMaBKbwvQ4Sz1miDmsLisZ8",
                "created": 1760982400,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "94",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 335,
                "id": "chatcmpl-CSsqzSXQEYRC7JMajHPYfohcmelH4",
                "created": 1761000077,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns from object and reference for ZTF objects with a reference change, limiting the result to at most 50 rows\nSELECT\n    o.*,\n    r.*\nFROM\n    object o,\n    reference r\nWHERE\n    o.oid = r.oid\n    AND o.oid IN (\n        SELECT oid\n        FROM object\n        WHERE reference_change = TRUE\n    )\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns from object and reference for ZTF objects with a reference change, limiting the result to at most 50 rows\nSELECT\n    o.*,\n    r.*\nFROM\n    object o,\n    reference r\nWHERE\n    o.oid = r.oid\n    AND o.oid IN (\n        SELECT oid\n        FROM object\n        WHERE reference_change = TRUE\n    )\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 1886,
                "id": "chatcmpl-CSsxzQLf8IYEDiWBqO2QIxKzZLpf5",
                "created": 1761000511,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "94",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 271,
                "id": "chatcmpl-CSsr6TEoBoiBWI7BXnPWCu9jSy49X",
                "created": 1761000084,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns from object and reference for objects with a reference change, limiting to 50 rows\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change = true\n)\nSELECT o.*, r.*\nFROM selected_oids so, object o, reference r\nWHERE o.oid = so.oid\n  AND r.oid = so.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns from object and reference for objects with a reference change, limiting to 50 rows\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change = true\n)\nSELECT o.*, r.*\nFROM selected_oids so, object o, reference r\nWHERE o.oid = so.oid\n  AND r.oid = so.oid\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 1692,
                "id": "chatcmpl-CSsyKwENNDcs1HLjULMGsvf0Wap3T",
                "created": 1761000532,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "94",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 207,
                "id": "chatcmpl-CSsrB2EtnPBgqX4w13P0ZOYr4XduT",
                "created": 1761000089,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get up to 50 rows combining all columns from object and reference\n-- for objects that had a change in the reference (reference_change = TRUE)\nSELECT *\nFROM\n    (SELECT * FROM object WHERE reference_change = TRUE) o,\n    reference r\nWHERE r.oid = o.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get up to 50 rows combining all columns from object and reference\n-- for objects that had a change in the reference (reference_change = TRUE)\nSELECT *\nFROM\n    (SELECT * FROM object WHERE reference_change = TRUE) o,\n    reference r\nWHERE r.oid = o.oid\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 1739,
                "id": "chatcmpl-CSsyeSpPGn57IllyYKXNMXr31Tnsn",
                "created": 1761000552,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "94",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 271,
                "id": "chatcmpl-CZNHPZyjt9HN2EndsdrEx4NV2hwqd",
                "created": 1762547003,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns from object and reference for objects with a change in the reference\nWITH refchange_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change IS TRUE\n)\nSELECT o.*, r.*\nFROM object o, reference r\nWHERE o.oid = r.oid\n  AND o.oid IN (SELECT oid FROM refchange_oids)\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns from object and reference for objects with a change in the reference\nWITH refchange_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change IS TRUE\n)\nSELECT o.*, r.*\nFROM object o, reference r\nWHERE o.oid = r.oid\n  AND o.oid IN (SELECT oid FROM refchange_oids)\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 1433,
                "id": "chatcmpl-CZRGAPnai8JsN5aw4XN1uGp9C88Fj",
                "created": 1762562302,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "94",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 207,
                "id": "chatcmpl-CZNHXmAufq1sX590CgYpq6GVQAtKe",
                "created": 1762547011,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns from object and reference for objects with a change in the reference\n-- Using a nested subquery to first select OIDs from object where reference_change is true\n-- Avoiding explicit JOIN clauses as requested\nSELECT\n  o.*,\n  r.*\nFROM\n  (SELECT * FROM object WHERE reference_change = TRUE) AS o,\n  reference AS r\nWHERE\n  r.oid = o.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns from object and reference for objects with a change in the reference\n-- Using a nested subquery to first select OIDs from object where reference_change is true\n-- Avoiding explicit JOIN clauses as requested\nSELECT\n  o.*,\n  r.*\nFROM\n  (SELECT * FROM object WHERE reference_change = TRUE) AS o,\n  reference AS r\nWHERE\n  r.oid = o.oid\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 1956,
                "id": "chatcmpl-CZRHODujXqLlyqTnfnVfOUCPMPjee",
                "created": 1762562378,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "94",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 271,
                "id": "chatcmpl-CZNHdwQUihdXhOB7K6zzga7P7XG6Z",
                "created": 1762547017,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns from 'object' and 'reference' for objects with a change in the reference, limited to 50 rows\nSELECT o.*, r.*\nFROM (\n    SELECT * \n    FROM object \n    WHERE reference_change = TRUE\n) o,\nreference r\nWHERE r.oid = o.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns from 'object' and 'reference' for objects with a change in the reference, limited to 50 rows\nSELECT o.*, r.*\nFROM (\n    SELECT * \n    FROM object \n    WHERE reference_change = TRUE\n) o,\nreference r\nWHERE r.oid = o.oid\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 1165,
                "id": "chatcmpl-CZRIwzu2jPpljA9pV4qMjZalejUlX",
                "created": 1762562474,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "94",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 335,
                "id": "chatcmpl-CZNHk1zDSFluiPjnIa1HBbv1ojdOG",
                "created": 1762547024,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns from object and reference for objects with a change in the reference, capped at 50 rows\nWITH sel_oids AS (\n  SELECT oid\n  FROM object\n  WHERE reference_change = TRUE\n)\nSELECT o.*, r.*\nFROM sel_oids s\nJOIN object o ON o.oid = s.oid\nJOIN reference r ON r.oid = s.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns from object and reference for objects with a change in the reference, capped at 50 rows\nWITH sel_oids AS (\n  SELECT oid\n  FROM object\n  WHERE reference_change = TRUE\n)\nSELECT o.*, r.*\nFROM sel_oids s\nJOIN object o ON o.oid = s.oid\nJOIN reference r ON r.oid = s.oid\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 1245,
                "id": "chatcmpl-CZRJuWeqi8fT1NKb0aFht1F3KAdG6",
                "created": 1762562534,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "94",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 618,
                "out_toks": 271,
                "id": "chatcmpl-CZNHtMbiC1uDgk5SelwlS4o3NI4ZR",
                "created": 1762547033,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all columns from object and reference for objects with a reference change, limit to 50 rows\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change IS TRUE\n)\nSELECT o.*, r.*\nFROM object o, reference r\nWHERE o.oid = r.oid\n  AND o.oid IN (SELECT oid FROM target_oids)\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all columns from object and reference for objects with a reference change, limit to 50 rows\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE reference_change IS TRUE\n)\nSELECT o.*, r.*\nFROM object o, reference r\nWHERE o.oid = r.oid\n  AND o.oid IN (SELECT oid FROM target_oids)\nLIMIT 50;"
                },
                "in_toks": 2735,
                "out_toks": 1755,
                "id": "chatcmpl-CZRL82ZUNsPOotjbaN0dzuwbUM5CH",
                "created": 1762562610,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "90": {
        "0": {
            "req_id": "90",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'feature_version']",
                    "1": "['probability', 'feature', 'feature_version']"
                },
                "in_toks": 650,
                "out_toks": 2280,
                "id": "chatcmpl-CSnarZW8cnIBWwhtwdF3EweLRNeUB",
                "created": 1760979857,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows (all columns) for up to 100 objects whose Multiband_period < 5 days\n-- in feature version 'lc_classifier_1.2.1-P', restricted to the light curve classifier and rankings 1 or 2.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND version = 'lc_classifier_1.2.1-P'\n      AND value < 5\n    LIMIT 100\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows (all columns) for up to 100 objects whose Multiband_period < 5 days\n-- in feature version 'lc_classifier_1.2.1-P', restricted to the light curve classifier and rankings 1 or 2.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND version = 'lc_classifier_1.2.1-P'\n      AND value < 5\n    LIMIT 100\n  );"
                },
                "in_toks": 4586,
                "out_toks": 1611,
                "id": "chatcmpl-CSoGBIun4EVK3Puy2BG542p7J3pM9",
                "created": 1760982419,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "90",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'feature_version']",
                    "1": "['probability', 'feature', 'feature_version']"
                },
                "in_toks": 650,
                "out_toks": 2280,
                "id": "chatcmpl-CSnarZW8cnIBWwhtwdF3EweLRNeUB",
                "created": 1760979857,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows (all columns) for up to 100 objects\n-- whose Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P'.\n-- Only keep light-curve classifier results with ranking 1 or 2.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    -- Prioritize obtaining OIDs in a subquery; avoid JOINs\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = 'lc_classifier_1.2.1-P'\n    ORDER BY f.oid\n    LIMIT 100\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows (all columns) for up to 100 objects\n-- whose Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P'.\n-- Only keep light-curve classifier results with ranking 1 or 2.\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    -- Prioritize obtaining OIDs in a subquery; avoid JOINs\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = 'lc_classifier_1.2.1-P'\n    ORDER BY f.oid\n    LIMIT 100\n  );"
                },
                "in_toks": 4586,
                "out_toks": 1898,
                "id": "chatcmpl-CSoGYGMbsjXLg71z7fJbUv8iXpuA0",
                "created": 1760982442,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "90",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'feature_version']"
                },
                "in_toks": 650,
                "out_toks": 1172,
                "id": "chatcmpl-CSsrGJoil9O0WSwiSKJ9GSoNqjVoV",
                "created": 1761000094,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 100 objects with Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P'\n-- and return all probability rows for those objects restricted to the light curve classifier\n-- with rankings 1 or 2.\n-- Note: Multiband_period is a multiband feature; fid=123 (gri) is commonly used for multiband features,\n-- but since the request does not specify fid explicitly, no fid filter is applied here.\n-- If you want to restrict to the multiband fid, uncomment the indicated line below.\n\nWITH target_oids AS (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT f.oid\n        FROM feature f\n        WHERE f.name = 'Multiband_period'\n          AND f.version = 'lc_classifier_1.2.1-P'\n          AND f.value < 5\n          -- AND f.fid = 123  -- Uncomment if you want to enforce the multiband (gri) fid\n        ORDER BY f.oid\n        LIMIT 100\n    ) s\n)\nSELECT *\nFROM probability\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 100 objects with Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P'\n-- and return all probability rows for those objects restricted to the light curve classifier\n-- with rankings 1 or 2.\n-- Note: Multiband_period is a multiband feature; fid=123 (gri) is commonly used for multiband features,\n-- but since the request does not specify fid explicitly, no fid filter is applied here.\n-- If you want to restrict to the multiband fid, uncomment the indicated line below.\n\nWITH target_oids AS (\n    SELECT oid\n    FROM (\n        SELECT DISTINCT f.oid\n        FROM feature f\n        WHERE f.name = 'Multiband_period'\n          AND f.version = 'lc_classifier_1.2.1-P'\n          AND f.value < 5\n          -- AND f.fid = 123  -- Uncomment if you want to enforce the multiband (gri) fid\n        ORDER BY f.oid\n        LIMIT 100\n    ) s\n)\nSELECT *\nFROM probability\nWHERE oid IN (SELECT oid FROM target_oids)\n  AND classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2);"
                },
                "in_toks": 4586,
                "out_toks": 1742,
                "id": "chatcmpl-CSsz40bsRL8qfsg0KzoRcZ5K5BzXp",
                "created": 1761000578,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "90",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'feature_version']"
                },
                "in_toks": 650,
                "out_toks": 788,
                "id": "chatcmpl-CSsrWHfTa95Elew6hZtuVPY5AEB1O",
                "created": 1761000110,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows (for the lc_classifier with ranking 1 or 2) for up to 100 objects\n-- that have Multiband_period < 5 days in the specified feature version.\nWITH selected_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.oid IN (SELECT oid FROM selected_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows (for the lc_classifier with ranking 1 or 2) for up to 100 objects\n-- that have Multiband_period < 5 days in the specified feature version.\nWITH selected_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.oid IN (SELECT oid FROM selected_oids);"
                },
                "in_toks": 4586,
                "out_toks": 1817,
                "id": "chatcmpl-CSszTHFC8spLODXufMDJPpsJYGZpf",
                "created": 1761000603,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "90",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'feature_version']"
                },
                "in_toks": 650,
                "out_toks": 852,
                "id": "chatcmpl-CSsrlOF3E4SecSiDN3NxYd1txaIiB",
                "created": 1761000125,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query: pick at most 100 oids that have Multiband_period < 5 (in the requested feature version)\n-- and that also have probability rows for the light curve classifier with ranking 1 or 2.\n-- Then return all columns from probability for those oids, restricted to the light curve classifier and ranking 1 or 2.\n WITH target_oids AS\n  (SELECT DISTINCT f.oid\n   FROM feature f\n   JOIN probability p ON p.oid = f.oid\n   AND p.classifier_name = 'lc_classifier' -- 1st condition on probability\n\n   AND p.ranking IN (1,\n                     2)-- 2nd condition on probability\n\n   AND p.classifier_version IS NOT NULL -- 3rd condition on probability (ensures adequate filtering)\n\n   WHERE f.name = 'Multiband_period'\n     AND f.value < 5\n     AND f.version = 'lc_classifier_1.2.1-P'\n   LIMIT 100)\nSELECT p.*\nFROM probability p\nJOIN target_oids t ON t.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier' -- keep only light curve classifier rows\n\n  AND p.ranking IN (1,\n                    2)-- only rankings 1 or 2\n\n  AND p.classifier_version IS NOT NULL; -- third probability condition to keep the query selective",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query: pick at most 100 oids that have Multiband_period < 5 (in the requested feature version)\n-- and that also have probability rows for the light curve classifier with ranking 1 or 2.\n-- Then return all columns from probability for those oids, restricted to the light curve classifier and ranking 1 or 2.\n WITH target_oids AS\n  (SELECT DISTINCT f.oid\n   FROM feature f\n   JOIN probability p ON p.oid = f.oid\n   AND p.classifier_name = 'lc_classifier' -- 1st condition on probability\n\n   AND p.ranking IN (1,\n                     2)-- 2nd condition on probability\n\n   AND p.classifier_version IS NOT NULL -- 3rd condition on probability (ensures adequate filtering)\n\n   WHERE f.name = 'Multiband_period'\n     AND f.value < 5\n     AND f.version = 'lc_classifier_1.2.1-P'\n   LIMIT 100)\nSELECT p.*\nFROM probability p\nJOIN target_oids t ON t.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier' -- keep only light curve classifier rows\n\n  AND p.ranking IN (1,\n                    2)-- only rankings 1 or 2\n\n  AND p.classifier_version IS NOT NULL; -- third probability condition to keep the query selective"
                },
                "in_toks": 3620,
                "out_toks": 2351,
                "id": "chatcmpl-CbA5QlwRq3TpPInFwLyxr3qcocAQ4",
                "created": 1762972944,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find at most 100 objects with Multiband_period < 5 days in the specified feature version,\n-- and return all probability rows for those objects for the light curve classifier with ranking 1 or 2.\n\nWITH candidate_oids AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n),\nprob_oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking IN (1, 2)\n),\ntarget_oids AS (\n    SELECT oid\n    FROM candidate_oids\n    WHERE oid IN (SELECT oid FROM prob_oids)\n    LIMIT 100\n)\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (SELECT oid FROM target_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find at most 100 objects with Multiband_period < 5 days in the specified feature version,\n-- and return all probability rows for those objects for the light curve classifier with ranking 1 or 2.\n\nWITH candidate_oids AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n),\nprob_oids AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking IN (1, 2)\n),\ntarget_oids AS (\n    SELECT oid\n    FROM candidate_oids\n    WHERE oid IN (SELECT oid FROM prob_oids)\n    LIMIT 100\n)\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (SELECT oid FROM target_oids);"
                },
                "in_toks": 4586,
                "out_toks": 2443,
                "id": "chatcmpl-CSszl9tnRhpOZQyjJjbMwr1rx1nu1",
                "created": 1761000621,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "90",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'feature_version']"
                },
                "in_toks": 650,
                "out_toks": 980,
                "id": "chatcmpl-CZNI1QkJiC00sOX6JItk1ZJ55RcSN",
                "created": 1762547041,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return all probability rows for up to 100 objects whose Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P'\n   Only include probabilities from the light curve classifier and with rankings 1 or 2.\n   The LIMIT 100 applies to the number of distinct oids selected from feature (i.e., objects), not to probability rows. */\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return all probability rows for up to 100 objects whose Multiband_period < 5 days in feature version 'lc_classifier_1.2.1-P'\n   Only include probabilities from the light curve classifier and with rankings 1 or 2.\n   The LIMIT 100 applies to the number of distinct oids selected from feature (i.e., objects), not to probability rows. */\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = 'lc_classifier_1.2.1-P'\n    LIMIT 100\n);"
                },
                "in_toks": 4586,
                "out_toks": 1515,
                "id": "chatcmpl-CZRMVL4OAFUHiXvJ95Cs7TnmRNZaN",
                "created": 1762562695,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "90",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'feature_version']"
                },
                "in_toks": 650,
                "out_toks": 660,
                "id": "chatcmpl-CZNIQ7g4brLZuECRfTr3EPWydDidx",
                "created": 1762547066,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all probability rows for up to 100 objects with Multiband_period < 5 days\n-- in the specified feature version, restricted to the light curve classifier\n-- and rankings 1 or 2. OIDs are obtained in a subquery (distinct, limited to 100).\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all probability rows for up to 100 objects with Multiband_period < 5 days\n-- in the specified feature version, restricted to the light curve classifier\n-- and rankings 1 or 2. OIDs are obtained in a subquery (distinct, limited to 100).\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n  );"
                },
                "in_toks": 4586,
                "out_toks": 1559,
                "id": "chatcmpl-CZRNzJsZa4ms8QvCN63oELQa1JKMp",
                "created": 1762562787,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "90",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'feature_version']"
                },
                "in_toks": 650,
                "out_toks": 1172,
                "id": "chatcmpl-CZNIeWZ8IHOk5tnaHO10fJby12zPq",
                "created": 1762547080,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return all probability rows for objects with Multiband_period < 5 days\n   computed in feature version 'lc_classifier_1.2.1-P',\n   restricted to the light curve classifier and rankings 1 or 2.\n   The subquery limits to at most 100 distinct objects (OIDs). */\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n      SELECT oid\n      FROM (\n          SELECT DISTINCT f.oid\n          FROM feature f\n          WHERE f.name = 'Multiband_period'\n            AND f.value < 5\n            AND f.version = 'lc_classifier_1.2.1-P'\n      ) o\n      LIMIT 100\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return all probability rows for objects with Multiband_period < 5 days\n   computed in feature version 'lc_classifier_1.2.1-P',\n   restricted to the light curve classifier and rankings 1 or 2.\n   The subquery limits to at most 100 distinct objects (OIDs). */\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n      SELECT oid\n      FROM (\n          SELECT DISTINCT f.oid\n          FROM feature f\n          WHERE f.name = 'Multiband_period'\n            AND f.value < 5\n            AND f.version = 'lc_classifier_1.2.1-P'\n      ) o\n      LIMIT 100\n  );"
                },
                "in_toks": 4586,
                "out_toks": 1320,
                "id": "chatcmpl-CZRPYRqR0cobVDfU0DXadwdIPRmDa",
                "created": 1762562884,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "90",
            "experiment_id": "run_8",
            "pred_tables": [
                "feature",
                "feature_version",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'feature_version', 'probability']"
                },
                "in_toks": 650,
                "out_toks": 724,
                "id": "chatcmpl-CZNJ2jkvEBoHPIOewDZVjBeSwgmZU",
                "created": 1762547104,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 100 objects with Multiband_period < 5 days in the specified feature version\nWITH target_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n)\n-- Return all probability rows for those objects, restricted to the light curve classifier and rankings 1 or 2\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.oid IN (SELECT oid FROM target_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 100 objects with Multiband_period < 5 days in the specified feature version\nWITH target_oids AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.version = 'lc_classifier_1.2.1-P'\n      AND f.value < 5\n    LIMIT 100\n)\n-- Return all probability rows for those objects, restricted to the light curve classifier and rankings 1 or 2\nSELECT *\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.oid IN (SELECT oid FROM target_oids);"
                },
                "in_toks": 4586,
                "out_toks": 2075,
                "id": "chatcmpl-CZRQjOR01tW4CozWbCjNST1K6eCyP",
                "created": 1762562957,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "90",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'feature', 'feature_version']"
                },
                "in_toks": 650,
                "out_toks": 1108,
                "id": "chatcmpl-CZNJRpqE43UteAxvyKPURBfv8wtfX",
                "created": 1762547129,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return all probability rows for up to 100 objects whose Multiband_period < 5 days\n   measured in the feature version 'lc_classifier_1.2.1-P'.\n   Only include probabilities from the light curve classifier with ranking 1 or 2.\n   OIDs are obtained first via a nested subquery (no JOINs), per guidance. */\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n      SELECT DISTINCT f.oid\n      FROM feature f\n      WHERE f.name = 'Multiband_period'\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.value < 5\n      LIMIT 100\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return all probability rows for up to 100 objects whose Multiband_period < 5 days\n   measured in the feature version 'lc_classifier_1.2.1-P'.\n   Only include probabilities from the light curve classifier with ranking 1 or 2.\n   OIDs are obtained first via a nested subquery (no JOINs), per guidance. */\nSELECT *\nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n      SELECT DISTINCT f.oid\n      FROM feature f\n      WHERE f.name = 'Multiband_period'\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.value < 5\n      LIMIT 100\n  );"
                },
                "in_toks": 4586,
                "out_toks": 1447,
                "id": "chatcmpl-CZRSgoNIdPt6KynUwIELY3OH1ZmPy",
                "created": 1762563078,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "51": {
        "0": {
            "req_id": "51",
            "experiment_id": "run_0",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 478,
                "id": "chatcmpl-CSnbBqkFuuIgFPcKGPN6Y68zbi47a",
                "created": 1760979877,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all epochs for the specified ZTF object in forced_photometry\n-- Columns: object identifier, date (MJD), filter id, diff mag and uncertainty, corrected mag and uncertainty, isdiffpos\nSELECT\n    fp.oid,\n    fp.mjd AS date,\n    fp.fid,\n    fp.mag,\n    fp.e_mag,\n    fp.mag_corr,\n    fp.e_mag_corr,\n    fp.isdiffpos\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    -- Prioritize obtaining OIDs in a subquery (avoiding JOINs)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF24aaiutyh'\n)\nORDER BY fp.mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all epochs for the specified ZTF object in forced_photometry\n-- Columns: object identifier, date (MJD), filter id, diff mag and uncertainty, corrected mag and uncertainty, isdiffpos\nSELECT\n    fp.oid,\n    fp.mjd AS date,\n    fp.fid,\n    fp.mag,\n    fp.e_mag,\n    fp.mag_corr,\n    fp.e_mag_corr,\n    fp.isdiffpos\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    -- Prioritize obtaining OIDs in a subquery (avoiding JOINs)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF24aaiutyh'\n)\nORDER BY fp.mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 994,
                "id": "chatcmpl-CSoGxfd79GkDmKcUuxK5gtxMBFvRd",
                "created": 1760982467,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "51",
            "experiment_id": "run_1",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 478,
                "id": "chatcmpl-CSnbBqkFuuIgFPcKGPN6Y68zbi47a",
                "created": 1760979877,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Epochs of forced photometry for the specified ZTF object, sorted by date (MJD)\nSELECT\n    oid,          -- object identifier\n    mjd,          -- date (Modified Julian Date)\n    fid,          -- filter identifier (1=g; 2=r; 3=i)\n    mag,          -- PSF difference magnitude\n    e_mag,        -- uncertainty of difference magnitude\n    mag_corr,     -- corrected apparent magnitude\n    e_mag_corr,   -- uncertainty of corrected magnitude\n    isdiffpos     -- difference sign flag\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Epochs of forced photometry for the specified ZTF object, sorted by date (MJD)\nSELECT\n    oid,          -- object identifier\n    mjd,          -- date (Modified Julian Date)\n    fid,          -- filter identifier (1=g; 2=r; 3=i)\n    mag,          -- PSF difference magnitude\n    e_mag,        -- uncertainty of difference magnitude\n    mag_corr,     -- corrected apparent magnitude\n    e_mag_corr,   -- uncertainty of corrected magnitude\n    isdiffpos     -- difference sign flag\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 916,
                "id": "chatcmpl-CSoH87txICccMHphM2gKTnn0z6uKb",
                "created": 1760982478,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "51",
            "experiment_id": "run_2",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 719,
                "id": "chatcmpl-CSsrxS99XNje7UVv3qXbQdcaFu9OR",
                "created": 1761000137,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all forced photometry epochs for the specified ZTF object\n-- Notes:\n-- - 'mjd' is the date in Modified Julian Date (sorted ascending).\n-- - 'e_mag_corr' is the uncertainty for the corrected magnitude assuming a point-like source.\n--   If you prefer the extended-source uncertainty, consider 'e_mag_corr_ext'.\nSELECT\n    oid,         -- object identifier\n    mjd,         -- date (Modified Julian Date)\n    fid,         -- filter identifier (1=g; 2=r; 3=i)\n    mag,         -- difference magnitude (PSF)\n    e_mag,       -- uncertainty of difference magnitude\n    mag_corr,    -- corrected (apparent) magnitude\n    e_mag_corr,  -- uncertainty of corrected magnitude (point-like source)\n    isdiffpos    -- difference sign flag\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all forced photometry epochs for the specified ZTF object\n-- Notes:\n-- - 'mjd' is the date in Modified Julian Date (sorted ascending).\n-- - 'e_mag_corr' is the uncertainty for the corrected magnitude assuming a point-like source.\n--   If you prefer the extended-source uncertainty, consider 'e_mag_corr_ext'.\nSELECT\n    oid,         -- object identifier\n    mjd,         -- date (Modified Julian Date)\n    fid,         -- filter identifier (1=g; 2=r; 3=i)\n    mag,         -- difference magnitude (PSF)\n    e_mag,       -- uncertainty of difference magnitude\n    mag_corr,    -- corrected (apparent) magnitude\n    e_mag_corr,  -- uncertainty of corrected magnitude (point-like source)\n    isdiffpos    -- difference sign flag\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 1550,
                "id": "chatcmpl-CSt0N7EaMS2esExZFUq6uUIkLyLLo",
                "created": 1761000659,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "51",
            "experiment_id": "run_3",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 207,
                "id": "chatcmpl-CSss78qgVIC7oZdr37lo5ySbAHrYa",
                "created": 1761000147,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- All forced-photometry epochs for the specified ZTF object, sorted by time (MJD)\nSELECT\n    oid,           -- object identifier\n    mjd,           -- date (Modified Julian Date)\n    fid,           -- filter identifier (1=g; 2=r; 3=i)\n    mag,           -- difference magnitude\n    e_mag,         -- uncertainty of difference magnitude\n    mag_corr,      -- corrected (apparent) magnitude\n    e_mag_corr,    -- uncertainty of corrected magnitude\n    isdiffpos      -- difference sign flag\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- All forced-photometry epochs for the specified ZTF object, sorted by time (MJD)\nSELECT\n    oid,           -- object identifier\n    mjd,           -- date (Modified Julian Date)\n    fid,           -- filter identifier (1=g; 2=r; 3=i)\n    mag,           -- difference magnitude\n    e_mag,         -- uncertainty of difference magnitude\n    mag_corr,      -- corrected (apparent) magnitude\n    e_mag_corr,    -- uncertainty of corrected magnitude\n    isdiffpos      -- difference sign flag\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 853,
                "id": "chatcmpl-CSt0hGequ1Yptf7Os7p8hsi7YPHWB",
                "created": 1761000679,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "51",
            "experiment_id": "run_4",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 207,
                "id": "chatcmpl-CSssBDRNJrOE8O0w838WIyVJRcXud",
                "created": 1761000151,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return epochs for the specified ZTF object from forced_photometry\n-- Note: 'mjd' is the observation date in Modified Julian Date (MJD).\n-- Note: Using e_mag_corr as the uncertainty for the corrected magnitude.\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return epochs for the specified ZTF object from forced_photometry\n-- Note: 'mjd' is the observation date in Modified Julian Date (MJD).\n-- Note: Using e_mag_corr as the uncertainty for the corrected magnitude.\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 1203,
                "id": "chatcmpl-CSt0t4UlJIrKtFUGxgTN8BgJPF7aI",
                "created": 1761000691,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "51",
            "experiment_id": "run_5",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 463,
                "id": "chatcmpl-CZNJluzxfMZRTnMEHNluuaUx3C3Sl",
                "created": 1762547149,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Epochs for ZTF object 'ZTF24aaiutyh' from forced_photometry, sorted by date (MJD)\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Epochs for ZTF object 'ZTF24aaiutyh' from forced_photometry, sorted by date (MJD)\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 1311,
                "id": "chatcmpl-CZRUYgIE6u7KljDf6TcpR4EF7wSaQ",
                "created": 1762563194,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "51",
            "experiment_id": "run_6",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 463,
                "id": "chatcmpl-CZNJtmgUGlo0haVxzMZSh00qB7vUo",
                "created": 1762547157,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Epochs (forced photometry) for ZTF object ZTF24aaiutyh\n-- Using mjd as the date column and e_mag_corr as the uncertainty of mag_corr (point-like source)\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Epochs (forced photometry) for ZTF object ZTF24aaiutyh\n-- Using mjd as the date column and e_mag_corr as the uncertainty of mag_corr (point-like source)\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 1069,
                "id": "chatcmpl-CZRVwfkxk9Ckj0o3WG0EL5OWy1YZ6",
                "created": 1762563280,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "51",
            "experiment_id": "run_7",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 271,
                "id": "chatcmpl-CZNK4lofcSoCS2g5x1EYOczN8YPUY",
                "created": 1762547168,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find all forced-photometry epochs for the given ZTF object, sorted by time (MJD)\n-- Requested columns mapping:\n-- - object identifier -> oid\n-- - date -> mjd (Modified Julian Date)\n-- - filter identifier -> fid\n-- - difference magnitude and its uncertainty -> mag, e_mag\n-- - corrected magnitude and its uncertainty -> mag_corr, e_mag_corr\n-- - isdiffpos flag -> isdiffpos\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find all forced-photometry epochs for the given ZTF object, sorted by time (MJD)\n-- Requested columns mapping:\n-- - object identifier -> oid\n-- - date -> mjd (Modified Julian Date)\n-- - filter identifier -> fid\n-- - difference magnitude and its uncertainty -> mag, e_mag\n-- - corrected magnitude and its uncertainty -> mag_corr, e_mag_corr\n-- - isdiffpos flag -> isdiffpos\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 989,
                "id": "chatcmpl-CZRX9tMoxUWBYSVU9azs6XeLEbQjf",
                "created": 1762563355,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "51",
            "experiment_id": "run_8",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 335,
                "id": "chatcmpl-CZNK9ieZohYzimf5IJ9XIdgmptli4",
                "created": 1762547173,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return epochs for the given object from forced_photometry, sorted by time (MJD)\nSELECT\n  oid,\n  mjd,\n  fid,\n  mag,\n  e_mag,\n  mag_corr,\n  e_mag_corr,\n  isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return epochs for the given object from forced_photometry, sorted by time (MJD)\nSELECT\n  oid,\n  mjd,\n  fid,\n  mag,\n  e_mag,\n  mag_corr,\n  e_mag_corr,\n  isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 726,
                "id": "chatcmpl-CZRAYBgIPik6dMoq5t7k5SRsiFq6L",
                "created": 1762561954,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "51",
            "experiment_id": "run_9",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 642,
                "out_toks": 271,
                "id": "chatcmpl-CZNKF7TcGSQw62snrqfTcqL7PO3GE",
                "created": 1762547179,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Returning epochs for ZTF object 'ZTF24aaiutyh'\n-- Columns: object identifier (oid), date (mjd), filter identifier (fid),\n-- difference magnitude (mag) and its uncertainty (e_mag),\n-- corrected magnitude (mag_corr) and its uncertainty (e_mag_corr),\n-- and isdiffpos flag. Sorted by date (mjd).\n-- Note: Using e_mag_corr as the uncertainty for corrected magnitude (point-like source).\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Returning epochs for ZTF object 'ZTF24aaiutyh'\n-- Columns: object identifier (oid), date (mjd), filter identifier (fid),\n-- difference magnitude (mag) and its uncertainty (e_mag),\n-- corrected magnitude (mag_corr) and its uncertainty (e_mag_corr),\n-- and isdiffpos flag. Sorted by date (mjd).\n-- Note: Using e_mag_corr as the uncertainty for corrected magnitude (point-like source).\nSELECT\n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd ASC;"
                },
                "in_toks": 2604,
                "out_toks": 928,
                "id": "chatcmpl-CZRAYmpplG7k6V0JuZhSFCaY71qXI",
                "created": 1762561954,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "59": {
        "0": {
            "req_id": "59",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 625,
                "out_toks": 1629,
                "id": "chatcmpl-CSnbIL4nI2tWgxMhfPO2JRkFNR1O6",
                "created": 1760979884,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean)\n-- for the specified object, obtaining the OID via a subquery from the object table as per guidelines.\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat AS m\nWHERE m.oid IN (\n    SELECT o.oid\n    FROM object AS o\n    WHERE o.oid = 'ZTF18acsvogv'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean)\n-- for the specified object, obtaining the OID via a subquery from the object table as per guidelines.\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat AS m\nWHERE m.oid IN (\n    SELECT o.oid\n    FROM object AS o\n    WHERE o.oid = 'ZTF18acsvogv'\n);"
                },
                "in_toks": 3093,
                "out_toks": 570,
                "id": "chatcmpl-CSoHHXPfEg2suUmbqYcbnNrWzZe5u",
                "created": 1760982487,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "59",
            "experiment_id": "run_1",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 625,
                "out_toks": 1629,
                "id": "chatcmpl-CSnbIL4nI2tWgxMhfPO2JRkFNR1O6",
                "created": 1760979884,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Get ZTF identifier (oid), filter id (fid), number of detections (ndet), and mean difference magnitude (magmean)\n   for the specified ZTF object, using a subquery to provide the OID as per guidance */\nWITH oids AS (\n    SELECT 'ZTF18acsvogv'::varchar AS oid\n)\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM oids);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Get ZTF identifier (oid), filter id (fid), number of detections (ndet), and mean difference magnitude (magmean)\n   for the specified ZTF object, using a subquery to provide the OID as per guidance */\nWITH oids AS (\n    SELECT 'ZTF18acsvogv'::varchar AS oid\n)\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM oids);"
                },
                "in_toks": 2611,
                "out_toks": 825,
                "id": "chatcmpl-CSoHQSnxRqnhM4RJvqle89P3BAs4b",
                "created": 1760982496,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "59",
            "experiment_id": "run_2",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 625,
                "out_toks": 269,
                "id": "chatcmpl-CSssESW0jTgjUV7wslUEK8Cmej5ry",
                "created": 1761000154,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve oid (ZTF identifier), filter id (fid), number of detections (ndet), and mean difference magnitude (magmean)\n-- for the specified ZTF object from the magstat table\nSELECT\n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve oid (ZTF identifier), filter id (fid), number of detections (ndet), and mean difference magnitude (magmean)\n-- for the specified ZTF object from the magstat table\nSELECT\n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';"
                },
                "in_toks": 2611,
                "out_toks": 595,
                "id": "chatcmpl-CSt18HGge4POnXoA5XChT3t6aImVp",
                "created": 1761000706,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "59",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']"
                },
                "in_toks": 625,
                "out_toks": 336,
                "id": "chatcmpl-CSssLgKIXbRNW5alKzRlQkLwAmmRK",
                "created": 1761000161,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean)\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat AS m\nWHERE m.oid IN (\n    -- Obtain the OID from the object table (nested subquery as recommended)\n    SELECT o.oid\n    FROM object AS o\n    WHERE o.oid = 'ZTF18acsvogv'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean)\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat AS m\nWHERE m.oid IN (\n    -- Obtain the OID from the object table (nested subquery as recommended)\n    SELECT o.oid\n    FROM object AS o\n    WHERE o.oid = 'ZTF18acsvogv'\n);"
                },
                "in_toks": 3093,
                "out_toks": 501,
                "id": "chatcmpl-CSt1JfopxoSo4gtBfCOfuzXEmJ5gr",
                "created": 1761000717,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "59",
            "experiment_id": "run_4",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 625,
                "out_toks": 205,
                "id": "chatcmpl-CSssSQRJDeJZrZKonozffVrV12shS",
                "created": 1761000168,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- ZTF identifier (oid), filter identifier (fid), number of detections (ndet), mean difference magnitude (magmean)\nSELECT\n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';",
            "original_sql_response": {
                "responses": {
                    "0": "-- ZTF identifier (oid), filter identifier (fid), number of detections (ndet), mean difference magnitude (magmean)\nSELECT\n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';"
                },
                "in_toks": 2611,
                "out_toks": 1156,
                "id": "chatcmpl-CSt1Rvb7i6qlubA0PEKwrMKXp0CUo",
                "created": 1761000725,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "59",
            "experiment_id": "run_5",
            "pred_tables": [
                "magstat",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat', 'object']"
                },
                "in_toks": 625,
                "out_toks": 528,
                "id": "chatcmpl-CZNKLH06W2zvIbQxsIv7saoh0fuZu",
                "created": 1762547185,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean) for ZTF18acsvogv */\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat m\nWHERE m.oid IN (\n    /* Obtain the OID from the object table (nested subquery as recommended) */\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18acsvogv'\n);",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean) for ZTF18acsvogv */\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat m\nWHERE m.oid IN (\n    /* Obtain the OID from the object table (nested subquery as recommended) */\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18acsvogv'\n);"
                },
                "in_toks": 3093,
                "out_toks": 894,
                "id": "chatcmpl-CZRAYwvMoeBnF3hzQqjVD3yG3xQ2r",
                "created": 1762561954,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "59",
            "experiment_id": "run_6",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 625,
                "out_toks": 653,
                "id": "chatcmpl-CZNKY6exwWC0vrOjpzfAj15HsEk3G",
                "created": 1762547198,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get ZTF identifier, filter identifier, number of detections, and mean difference magnitude\n-- for the specified ZTF object from the magstat table\nSELECT\n    oid,       -- ZTF identifier\n    fid,       -- filter identifier (1=g; 2=r; 3=i)\n    ndet,      -- number of detections\n    magmean    -- mean difference magnitude\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get ZTF identifier, filter identifier, number of detections, and mean difference magnitude\n-- for the specified ZTF object from the magstat table\nSELECT\n    oid,       -- ZTF identifier\n    fid,       -- filter identifier (1=g; 2=r; 3=i)\n    ndet,      -- number of detections\n    magmean    -- mean difference magnitude\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';"
                },
                "in_toks": 2611,
                "out_toks": 1003,
                "id": "chatcmpl-CZRB7xEFIffaEe4eGnWDpoEw5RR7O",
                "created": 1762561989,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "59",
            "experiment_id": "run_7",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 625,
                "out_toks": 141,
                "id": "chatcmpl-CZNKlOwWjExBhlRfylw01ZiayjOsB",
                "created": 1762547211,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the requested columns for the specified ZTF object\nWITH targets(oid) AS (\n  VALUES ('ZTF18acsvogv')\n)\nSELECT\n  m.oid,        -- ZTF identifier\n  m.fid,        -- filter identifier (1=g; 2=r; 3=i)\n  m.ndet,       -- number of detections\n  m.magmean     -- mean difference magnitude\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM targets);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the requested columns for the specified ZTF object\nWITH targets(oid) AS (\n  VALUES ('ZTF18acsvogv')\n)\nSELECT\n  m.oid,        -- ZTF identifier\n  m.fid,        -- filter identifier (1=g; 2=r; 3=i)\n  m.ndet,       -- number of detections\n  m.magmean     -- mean difference magnitude\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM targets);"
                },
                "in_toks": 2611,
                "out_toks": 944,
                "id": "chatcmpl-CZRBAeKscLi8puQC5KvqT4ZP5FZMw",
                "created": 1762561992,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "59",
            "experiment_id": "run_8",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 625,
                "out_toks": 205,
                "id": "chatcmpl-CZNKr3XlASwMisAzejnaBc54i1kX3",
                "created": 1762547217,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get oid (ZTF identifier), fid (filter identifier), ndet (number of detections), and magmean (mean difference magnitude)\nSELECT\n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get oid (ZTF identifier), fid (filter identifier), ndet (number of detections), and magmean (mean difference magnitude)\nSELECT\n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';"
                },
                "in_toks": 2611,
                "out_toks": 582,
                "id": "chatcmpl-CZRBAtBP0B5uAnf5MSu9qx3fsSEOE",
                "created": 1762561992,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "59",
            "experiment_id": "run_9",
            "pred_tables": [
                "magstat",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat', 'object']"
                },
                "in_toks": 625,
                "out_toks": 528,
                "id": "chatcmpl-CZNKwJhrV12f4c6CozYWtSlUC4WJ5",
                "created": 1762547222,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean)\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat m\nWHERE EXISTS (\n    SELECT 1\n    FROM object o\n    WHERE o.oid = 'ZTF18acsvogv'\n      AND o.oid = m.oid\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF identifier (oid), filter identifier (fid), number of detections (ndet), and mean difference magnitude (magmean)\nSELECT\n    m.oid,\n    m.fid,\n    m.ndet,\n    m.magmean\nFROM magstat m\nWHERE EXISTS (\n    SELECT 1\n    FROM object o\n    WHERE o.oid = 'ZTF18acsvogv'\n      AND o.oid = m.oid\n);"
                },
                "in_toks": 3093,
                "out_toks": 872,
                "id": "chatcmpl-CZRBYyEhEM5iSGgq2rVTy7j4ZJdGh",
                "created": 1762562016,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "100": {
        "0": {
            "req_id": "100",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'non_detection', 'forced_photometry']",
                    "1": "['object', 'detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 1332,
                "id": "chatcmpl-CSnbZDsVYVVJxe5lQBdaK7F2L9GZ4",
                "created": 1760979901,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return detections, non-detections, and forced photometry for the specified ZTF object\n-- Columns:\n--  oid              -> ZTF identifier\n--  mjd              -> epoch date\n--  fid              -> filter identifier\n--  isdiffpos        -> isdiffpos flag (NULL for non-detections)\n--  magpsf           -> detection difference magnitude (NULL for non-detections and forced photometry)\n--  sigmapsf         -> detection difference magnitude uncertainty (NULL for non-detections and forced photometry)\n--  diffmaglim       -> 5-sigma magnitude limit (when available)\n--  mag              -> forced photometry difference magnitude (NULL for detections and non-detections)\n--  e_mag            -> forced photometry magnitude uncertainty (NULL for detections and non-detections)\n--  \"table\"          -> name of the table of origin for each epoch\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    d.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    n.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    f.diffmaglim,\n    f.mag,\n    f.e_mag,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return detections, non-detections, and forced photometry for the specified ZTF object\n-- Columns:\n--  oid              -> ZTF identifier\n--  mjd              -> epoch date\n--  fid              -> filter identifier\n--  isdiffpos        -> isdiffpos flag (NULL for non-detections)\n--  magpsf           -> detection difference magnitude (NULL for non-detections and forced photometry)\n--  sigmapsf         -> detection difference magnitude uncertainty (NULL for non-detections and forced photometry)\n--  diffmaglim       -> 5-sigma magnitude limit (when available)\n--  mag              -> forced photometry difference magnitude (NULL for detections and non-detections)\n--  e_mag            -> forced photometry magnitude uncertainty (NULL for detections and non-detections)\n--  \"table\"          -> name of the table of origin for each epoch\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    d.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    n.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    f.diffmaglim,\n    f.mag,\n    f.e_mag,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY mjd;"
                },
                "in_toks": 3792,
                "out_toks": 3328,
                "id": "chatcmpl-CSoHbGjHQUy8THmeX6c94B8X0cjQn",
                "created": 1760982507,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "100",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'non_detection', 'forced_photometry']",
                    "1": "['object', 'detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 1332,
                "id": "chatcmpl-CSnbZDsVYVVJxe5lQBdaK7F2L9GZ4",
                "created": 1760979901,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all epochs (detections, non-detections, and forced photometry) for the given ZTF object,\n-- providing requested columns and indicating the source table for each row.\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid AS oid,\n    d.mjd AS epoch_mjd,\n    d.fid AS fid,\n    d.isdiffpos AS isdiffpos,\n    d.magpsf AS detection_mag,\n    d.sigmapsf AS detection_mag_err,\n    d.diffmaglim AS diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'detection' AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid AS oid,\n    n.mjd AS epoch_mjd,\n    n.fid AS fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS detection_mag,\n    NULL::double precision AS detection_mag_err,\n    n.diffmaglim AS diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'non_detection' AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid AS oid,\n    f.mjd AS epoch_mjd,\n    f.fid AS fid,\n    f.isdiffpos AS isdiffpos,\n    NULL::double precision AS detection_mag,\n    NULL::double precision AS detection_mag_err,\n    f.diffmaglim AS diffmaglim,\n    f.mag AS forced_mag,\n    f.e_mag AS forced_mag_err,\n    'forced_photometry' AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY oid, epoch_mjd, fid, \"table\";",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all epochs (detections, non-detections, and forced photometry) for the given ZTF object,\n-- providing requested columns and indicating the source table for each row.\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid AS oid,\n    d.mjd AS epoch_mjd,\n    d.fid AS fid,\n    d.isdiffpos AS isdiffpos,\n    d.magpsf AS detection_mag,\n    d.sigmapsf AS detection_mag_err,\n    d.diffmaglim AS diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'detection' AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid AS oid,\n    n.mjd AS epoch_mjd,\n    n.fid AS fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS detection_mag,\n    NULL::double precision AS detection_mag_err,\n    n.diffmaglim AS diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'non_detection' AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid AS oid,\n    f.mjd AS epoch_mjd,\n    f.fid AS fid,\n    f.isdiffpos AS isdiffpos,\n    NULL::double precision AS detection_mag,\n    NULL::double precision AS detection_mag_err,\n    f.diffmaglim AS diffmaglim,\n    f.mag AS forced_mag,\n    f.e_mag AS forced_mag_err,\n    'forced_photometry' AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY oid, epoch_mjd, fid, \"table\";"
                },
                "in_toks": 3792,
                "out_toks": 2981,
                "id": "chatcmpl-CSoIJVyejimnC4N4zNU4K3cU79kWw",
                "created": 1760982551,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "100",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 410,
                "id": "chatcmpl-CSssWlx0pC7L4GTGAFiiwuuNiA4hX",
                "created": 1761000172,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all epochs (detections, non-detections, forced photometry) for the given ZTF object in a single table\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf AS det_magpsf,\n    d.sigmapsf AS det_sigmapsf,\n    d.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_e_mag,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS det_magpsf,\n    NULL::double precision AS det_sigmapsf,\n    n.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_e_mag,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS det_magpsf,\n    NULL::double precision AS det_sigmapsf,\n    f.diffmaglim,\n    f.mag AS forced_mag,\n    f.e_mag AS forced_e_mag,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all epochs (detections, non-detections, forced photometry) for the given ZTF object in a single table\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf AS det_magpsf,\n    d.sigmapsf AS det_sigmapsf,\n    d.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_e_mag,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS det_magpsf,\n    NULL::double precision AS det_sigmapsf,\n    n.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_e_mag,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS det_magpsf,\n    NULL::double precision AS det_sigmapsf,\n    f.diffmaglim,\n    f.mag AS forced_mag,\n    f.e_mag AS forced_e_mag,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY mjd;"
                },
                "in_toks": 3792,
                "out_toks": 2230,
                "id": "chatcmpl-CSt1ex6VJMNsWCdkcdtm6Sx5yFDwb",
                "created": 1761000738,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "100",
            "experiment_id": "run_3",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 1239,
                "id": "chatcmpl-CSssdpLWVoV222RMYTgiYa84CHAcd",
                "created": 1761000179,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return detections, non-detections, and forced photometry for a single ZTF object, in one table */\nWITH target_oid AS (\n  SELECT 'ZTF24aamtvxb'::varchar AS oid\n)\nSELECT\n  d.oid,\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.magpsf,\n  d.sigmapsf,\n  d.diffmaglim,\n  NULL::double precision AS mag,\n  NULL::double precision AS e_mag,\n  'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oid)\n\nUNION ALL\n\nSELECT\n  nd.oid,\n  nd.mjd,\n  nd.fid,\n  NULL::integer AS isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  nd.diffmaglim,\n  NULL::double precision AS mag,\n  NULL::double precision AS e_mag,\n  'non_detection'::text AS \"table\"\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM target_oid)\n\nUNION ALL\n\nSELECT\n  fp.oid,\n  fp.mjd,\n  fp.fid,\n  fp.isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  fp.diffmaglim,\n  fp.mag,\n  fp.e_mag,\n  'forced_photometry'::text AS \"table\"\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM target_oid)\n\nORDER BY mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return detections, non-detections, and forced photometry for a single ZTF object, in one table */\nWITH target_oid AS (\n  SELECT 'ZTF24aamtvxb'::varchar AS oid\n)\nSELECT\n  d.oid,\n  d.mjd,\n  d.fid,\n  d.isdiffpos,\n  d.magpsf,\n  d.sigmapsf,\n  d.diffmaglim,\n  NULL::double precision AS mag,\n  NULL::double precision AS e_mag,\n  'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oid)\n\nUNION ALL\n\nSELECT\n  nd.oid,\n  nd.mjd,\n  nd.fid,\n  NULL::integer AS isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  nd.diffmaglim,\n  NULL::double precision AS mag,\n  NULL::double precision AS e_mag,\n  'non_detection'::text AS \"table\"\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM target_oid)\n\nUNION ALL\n\nSELECT\n  fp.oid,\n  fp.mjd,\n  fp.fid,\n  fp.isdiffpos,\n  NULL::double precision AS magpsf,\n  NULL::double precision AS sigmapsf,\n  fp.diffmaglim,\n  fp.mag,\n  fp.e_mag,\n  'forced_photometry'::text AS \"table\"\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM target_oid)\n\nORDER BY mjd;"
                },
                "in_toks": 3310,
                "out_toks": 2902,
                "id": "chatcmpl-CSt20RHnIi3hIdegQ8ytwIlWCASOU",
                "created": 1761000760,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "100",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 538,
                "id": "chatcmpl-CSssuZC30YDVRmz6FvtcJsssGwtOz",
                "created": 1761000196,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH obj AS (\n    -- Select the target object OID (ZTF identifier)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Detections\nSELECT\n    d.oid AS ztf_oid,                 -- ZTF identifier\n    d.mjd AS epoch_mjd,               -- Epoch date (MJD)\n    d.fid,                            -- Filter identifier (1=g; 2=r; 3=i)\n    d.isdiffpos,                      -- isdiffpos flag\n    d.magpsf AS det_magpsf,           -- Detection difference magnitude\n    d.sigmapsf AS det_sigmapsf,       -- Detection magnitude uncertainty\n    d.diffmaglim,                     -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- Forced photometry magnitude (N/A here)\n    NULL::double precision AS forced_e_mag,    -- Forced photometry uncertainty (N/A here)\n    'detection'::text AS \"table\"      -- Origin table\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM obj)\n\nUNION ALL\n\n-- Non-detections\nSELECT\n    nd.oid AS ztf_oid,                -- ZTF identifier\n    nd.mjd AS epoch_mjd,              -- Epoch date (MJD)\n    nd.fid,                           -- Filter identifier\n    NULL::integer AS isdiffpos,       -- No isdiffpos for non-detections\n    NULL::double precision AS det_magpsf,    -- No detection magnitude\n    NULL::double precision AS det_sigmapsf,  -- No detection uncertainty\n    nd.diffmaglim,                    -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- No forced photometry magnitude here\n    NULL::double precision AS forced_e_mag,    -- No forced photometry uncertainty here\n    'non_detection'::text AS \"table\"  -- Origin table\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM obj)\n\nUNION ALL\n\n-- Forced photometry\nSELECT\n    fp.oid AS ztf_oid,                -- ZTF identifier\n    fp.mjd AS epoch_mjd,              -- Epoch date (MJD)\n    fp.fid,                           -- Filter identifier\n    fp.isdiffpos,                     -- isdiffpos flag\n    NULL::double precision AS det_magpsf,    -- No detection magnitude here\n    NULL::double precision AS det_sigmapsf,  -- No detection uncertainty here\n    fp.diffmaglim,                    -- 5-sigma magnitude limit\n    fp.mag AS forced_mag,             -- Forced difference magnitude\n    fp.e_mag AS forced_e_mag,         -- Forced magnitude uncertainty\n    'forced_photometry'::text AS \"table\"  -- Origin table\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM obj)\n\nORDER BY epoch_mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH obj AS (\n    -- Select the target object OID (ZTF identifier)\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Detections\nSELECT\n    d.oid AS ztf_oid,                 -- ZTF identifier\n    d.mjd AS epoch_mjd,               -- Epoch date (MJD)\n    d.fid,                            -- Filter identifier (1=g; 2=r; 3=i)\n    d.isdiffpos,                      -- isdiffpos flag\n    d.magpsf AS det_magpsf,           -- Detection difference magnitude\n    d.sigmapsf AS det_sigmapsf,       -- Detection magnitude uncertainty\n    d.diffmaglim,                     -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- Forced photometry magnitude (N/A here)\n    NULL::double precision AS forced_e_mag,    -- Forced photometry uncertainty (N/A here)\n    'detection'::text AS \"table\"      -- Origin table\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM obj)\n\nUNION ALL\n\n-- Non-detections\nSELECT\n    nd.oid AS ztf_oid,                -- ZTF identifier\n    nd.mjd AS epoch_mjd,              -- Epoch date (MJD)\n    nd.fid,                           -- Filter identifier\n    NULL::integer AS isdiffpos,       -- No isdiffpos for non-detections\n    NULL::double precision AS det_magpsf,    -- No detection magnitude\n    NULL::double precision AS det_sigmapsf,  -- No detection uncertainty\n    nd.diffmaglim,                    -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- No forced photometry magnitude here\n    NULL::double precision AS forced_e_mag,    -- No forced photometry uncertainty here\n    'non_detection'::text AS \"table\"  -- Origin table\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM obj)\n\nUNION ALL\n\n-- Forced photometry\nSELECT\n    fp.oid AS ztf_oid,                -- ZTF identifier\n    fp.mjd AS epoch_mjd,              -- Epoch date (MJD)\n    fp.fid,                           -- Filter identifier\n    fp.isdiffpos,                     -- isdiffpos flag\n    NULL::double precision AS det_magpsf,    -- No detection magnitude here\n    NULL::double precision AS det_sigmapsf,  -- No detection uncertainty here\n    fp.diffmaglim,                    -- 5-sigma magnitude limit\n    fp.mag AS forced_mag,             -- Forced difference magnitude\n    fp.e_mag AS forced_e_mag,         -- Forced magnitude uncertainty\n    'forced_photometry'::text AS \"table\"  -- Origin table\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM obj)\n\nORDER BY epoch_mjd;"
                },
                "in_toks": 3792,
                "out_toks": 2606,
                "id": "chatcmpl-CSt2RUreE2HpJp8r7YWbbttPy7AFR",
                "created": 1761000787,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "100",
            "experiment_id": "run_5",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 855,
                "id": "chatcmpl-CZNLEVkgVp0W3c0NT1hADdeV7vS3f",
                "created": 1762547240,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return all epochs for ZTF object 'ZTF24aamtvxb' from detection, non_detection, and forced_photometry\n-- Includes: oid, mjd, fid, isdiffpos, detection mag and error, 5-sigma limit, forced mag and error, and the origin table name\nWITH oids AS (\n    SELECT 'ZTF24aamtvxb'::varchar AS oid\n)\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf AS det_mag,\n    d.sigmapsf AS det_mag_err,\n    d.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    n.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    f.diffmaglim,\n    f.mag AS forced_mag,\n    f.e_mag AS forced_mag_err,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY oid, mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return all epochs for ZTF object 'ZTF24aamtvxb' from detection, non_detection, and forced_photometry\n-- Includes: oid, mjd, fid, isdiffpos, detection mag and error, 5-sigma limit, forced mag and error, and the origin table name\nWITH oids AS (\n    SELECT 'ZTF24aamtvxb'::varchar AS oid\n)\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf AS det_mag,\n    d.sigmapsf AS det_mag_err,\n    d.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    n.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    f.diffmaglim,\n    f.mag AS forced_mag,\n    f.e_mag AS forced_mag_err,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY oid, mjd;"
                },
                "in_toks": 3310,
                "out_toks": 2255,
                "id": "chatcmpl-CZRBxZBfDIr0WkUG9aioeUyzviM0t",
                "created": 1762562041,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "100",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 538,
                "id": "chatcmpl-CZNLV7bC4pebTMlpuArkIe4yV9iOy",
                "created": 1762547257,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return detections, non-detections, and forced photometry for the given ZTF object in a single table\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid,                  -- ZTF identifier\n    d.mjd,                  -- epoch date\n    d.fid,                  -- filter identifier\n    d.isdiffpos,            -- isdiffpos flag\n    d.magpsf AS det_mag,    -- detection difference magnitude\n    d.sigmapsf AS det_mag_err, -- detection magnitude uncertainty\n    d.diffmaglim,           -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- forced difference magnitude (not applicable)\n    NULL::double precision AS forced_mag_err,  -- forced magnitude uncertainty (not applicable)\n    'detection'::text AS \"table\"               -- origin table\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,                  -- ZTF identifier\n    n.mjd,                  -- epoch date\n    n.fid,                  -- filter identifier\n    NULL::integer AS isdiffpos,        -- isdiffpos flag (not available)\n    NULL::double precision AS det_mag, -- detection difference magnitude (not available)\n    NULL::double precision AS det_mag_err, -- detection magnitude uncertainty (not available)\n    n.diffmaglim,           -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- forced difference magnitude (not applicable)\n    NULL::double precision AS forced_mag_err,  -- forced magnitude uncertainty (not applicable)\n    'non_detection'::text AS \"table\"           -- origin table\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,                  -- ZTF identifier\n    f.mjd,                  -- epoch date\n    f.fid,                  -- filter identifier\n    f.isdiffpos,            -- isdiffpos flag\n    NULL::double precision AS det_mag, -- detection difference magnitude (not applicable)\n    NULL::double precision AS det_mag_err, -- detection magnitude uncertainty (not applicable)\n    f.diffmaglim,           -- 5-sigma magnitude limit\n    f.mag AS forced_mag,    -- forced difference magnitude\n    f.e_mag AS forced_mag_err, -- forced magnitude uncertainty\n    'forced_photometry'::text AS \"table\"      -- origin table\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return detections, non-detections, and forced photometry for the given ZTF object in a single table\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid,                  -- ZTF identifier\n    d.mjd,                  -- epoch date\n    d.fid,                  -- filter identifier\n    d.isdiffpos,            -- isdiffpos flag\n    d.magpsf AS det_mag,    -- detection difference magnitude\n    d.sigmapsf AS det_mag_err, -- detection magnitude uncertainty\n    d.diffmaglim,           -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- forced difference magnitude (not applicable)\n    NULL::double precision AS forced_mag_err,  -- forced magnitude uncertainty (not applicable)\n    'detection'::text AS \"table\"               -- origin table\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    n.oid,                  -- ZTF identifier\n    n.mjd,                  -- epoch date\n    n.fid,                  -- filter identifier\n    NULL::integer AS isdiffpos,        -- isdiffpos flag (not available)\n    NULL::double precision AS det_mag, -- detection difference magnitude (not available)\n    NULL::double precision AS det_mag_err, -- detection magnitude uncertainty (not available)\n    n.diffmaglim,           -- 5-sigma magnitude limit\n    NULL::double precision AS forced_mag,      -- forced difference magnitude (not applicable)\n    NULL::double precision AS forced_mag_err,  -- forced magnitude uncertainty (not applicable)\n    'non_detection'::text AS \"table\"           -- origin table\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM oids)\n\nUNION ALL\n\nSELECT\n    f.oid,                  -- ZTF identifier\n    f.mjd,                  -- epoch date\n    f.fid,                  -- filter identifier\n    f.isdiffpos,            -- isdiffpos flag\n    NULL::double precision AS det_mag, -- detection difference magnitude (not applicable)\n    NULL::double precision AS det_mag_err, -- detection magnitude uncertainty (not applicable)\n    f.diffmaglim,           -- 5-sigma magnitude limit\n    f.mag AS forced_mag,    -- forced difference magnitude\n    f.e_mag AS forced_mag_err, -- forced magnitude uncertainty\n    'forced_photometry'::text AS \"table\"      -- origin table\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM oids)\n\nORDER BY mjd;"
                },
                "in_toks": 3792,
                "out_toks": 2358,
                "id": "chatcmpl-CZRCAJHOKRjatVFUQNHF6dMZtapn1",
                "created": 1762562054,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "100",
            "experiment_id": "run_7",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 407,
                "id": "chatcmpl-CZNLg7A7othMlbwjxC9D8cYtdNXj6",
                "created": 1762547268,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH target (oid) AS (\n    VALUES ('ZTF24aamtvxb')\n)\n-- Detections\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    d.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target)\n\nUNION ALL\n\n-- Non-detections\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    n.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM target)\n\nUNION ALL\n\n-- Forced photometry\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    f.diffmaglim,\n    f.mag,\n    f.e_mag,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM target)\n\nORDER BY mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH target (oid) AS (\n    VALUES ('ZTF24aamtvxb')\n)\n-- Detections\nSELECT\n    d.oid,\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    d.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target)\n\nUNION ALL\n\n-- Non-detections\nSELECT\n    n.oid,\n    n.mjd,\n    n.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    n.diffmaglim,\n    NULL::double precision AS mag,\n    NULL::double precision AS e_mag,\n    'non_detection'::text AS \"table\"\nFROM non_detection n\nWHERE n.oid IN (SELECT oid FROM target)\n\nUNION ALL\n\n-- Forced photometry\nSELECT\n    f.oid,\n    f.mjd,\n    f.fid,\n    f.isdiffpos,\n    NULL::double precision AS magpsf,\n    NULL::double precision AS sigmapsf,\n    f.diffmaglim,\n    f.mag,\n    f.e_mag,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM target)\n\nORDER BY mjd;"
                },
                "in_toks": 3310,
                "out_toks": 2566,
                "id": "chatcmpl-CZRCHBbQ6IkuujRjJBxwy1KO55knm",
                "created": 1762562061,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "100",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 538,
                "id": "chatcmpl-CZNLo0SDs4b0gYOqC5iYDiehpY5pC",
                "created": 1762547276,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Detections\nSELECT\n    d.oid,                     -- ZTF identifier\n    d.mjd,                     -- epoch date (MJD)\n    d.fid,                     -- filter identifier (1=g; 2=r; 3=i)\n    d.isdiffpos,               -- isdiffpos flag\n    d.magpsf AS detection_mag, -- detection difference magnitude\n    d.sigmapsf AS detection_mag_err, -- detection magnitude uncertainty\n    d.diffmaglim,              -- 5-sigma magnitude limit\n    NULL::DOUBLE PRECISION AS forced_mag,      -- forced difference magnitude (N/A for detections)\n    NULL::DOUBLE PRECISION AS forced_mag_err,  -- forced magnitude uncertainty (N/A for detections)\n    'detection'::TEXT AS \"table\"               -- origin table\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n\nUNION ALL\n\n-- Non-detections\nSELECT\n    nd.oid,                    -- ZTF identifier\n    nd.mjd,                    -- epoch date (MJD)\n    nd.fid,                    -- filter identifier (1=g; 2=r; 3=i)\n    NULL::INTEGER AS isdiffpos, -- isdiffpos flag (N/A for non-detections)\n    NULL::DOUBLE PRECISION AS detection_mag,     -- detection difference magnitude (N/A)\n    NULL::DOUBLE PRECISION AS detection_mag_err, -- detection magnitude uncertainty (N/A)\n    nd.diffmaglim,             -- 5-sigma magnitude limit\n    NULL::DOUBLE PRECISION AS forced_mag,        -- forced difference magnitude (N/A)\n    NULL::DOUBLE PRECISION AS forced_mag_err,    -- forced magnitude uncertainty (N/A)\n    'non_detection'::TEXT AS \"table\"             -- origin table\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM target_oids)\n\nUNION ALL\n\n-- Forced photometry\nSELECT\n    f.oid,                     -- ZTF identifier\n    f.mjd,                     -- epoch date (MJD)\n    f.fid,                     -- filter identifier (1=g; 2=r; 3=i)\n    f.isdiffpos,               -- isdiffpos flag\n    NULL::DOUBLE PRECISION AS detection_mag,     -- detection difference magnitude (N/A for forced photometry)\n    NULL::DOUBLE PRECISION AS detection_mag_err, -- detection magnitude uncertainty (N/A for forced photometry)\n    f.diffmaglim,              -- 5-sigma magnitude limit\n    f.mag AS forced_mag,       -- forced difference magnitude\n    f.e_mag AS forced_mag_err, -- forced magnitude uncertainty\n    'forced_photometry'::TEXT AS \"table\"         -- origin table\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM target_oids)\n\nORDER BY mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Detections\nSELECT\n    d.oid,                     -- ZTF identifier\n    d.mjd,                     -- epoch date (MJD)\n    d.fid,                     -- filter identifier (1=g; 2=r; 3=i)\n    d.isdiffpos,               -- isdiffpos flag\n    d.magpsf AS detection_mag, -- detection difference magnitude\n    d.sigmapsf AS detection_mag_err, -- detection magnitude uncertainty\n    d.diffmaglim,              -- 5-sigma magnitude limit\n    NULL::DOUBLE PRECISION AS forced_mag,      -- forced difference magnitude (N/A for detections)\n    NULL::DOUBLE PRECISION AS forced_mag_err,  -- forced magnitude uncertainty (N/A for detections)\n    'detection'::TEXT AS \"table\"               -- origin table\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_oids)\n\nUNION ALL\n\n-- Non-detections\nSELECT\n    nd.oid,                    -- ZTF identifier\n    nd.mjd,                    -- epoch date (MJD)\n    nd.fid,                    -- filter identifier (1=g; 2=r; 3=i)\n    NULL::INTEGER AS isdiffpos, -- isdiffpos flag (N/A for non-detections)\n    NULL::DOUBLE PRECISION AS detection_mag,     -- detection difference magnitude (N/A)\n    NULL::DOUBLE PRECISION AS detection_mag_err, -- detection magnitude uncertainty (N/A)\n    nd.diffmaglim,             -- 5-sigma magnitude limit\n    NULL::DOUBLE PRECISION AS forced_mag,        -- forced difference magnitude (N/A)\n    NULL::DOUBLE PRECISION AS forced_mag_err,    -- forced magnitude uncertainty (N/A)\n    'non_detection'::TEXT AS \"table\"             -- origin table\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM target_oids)\n\nUNION ALL\n\n-- Forced photometry\nSELECT\n    f.oid,                     -- ZTF identifier\n    f.mjd,                     -- epoch date (MJD)\n    f.fid,                     -- filter identifier (1=g; 2=r; 3=i)\n    f.isdiffpos,               -- isdiffpos flag\n    NULL::DOUBLE PRECISION AS detection_mag,     -- detection difference magnitude (N/A for forced photometry)\n    NULL::DOUBLE PRECISION AS detection_mag_err, -- detection magnitude uncertainty (N/A for forced photometry)\n    f.diffmaglim,              -- 5-sigma magnitude limit\n    f.mag AS forced_mag,       -- forced difference magnitude\n    f.e_mag AS forced_mag_err, -- forced magnitude uncertainty\n    'forced_photometry'::TEXT AS \"table\"         -- origin table\nFROM forced_photometry f\nWHERE f.oid IN (SELECT oid FROM target_oids)\n\nORDER BY mjd;"
                },
                "in_toks": 3792,
                "out_toks": 2807,
                "id": "chatcmpl-CZRDGKSkA6K6a5NloZIz51gX8d2ah",
                "created": 1762562122,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "100",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 682,
                "out_toks": 794,
                "id": "chatcmpl-CZNM1EaoUf1rGD4cf1fmXSJrVl9K7",
                "created": 1762547289,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* All epochs (detections, non-detections, forced photometry) for the object 'ZTF24aamtvxb'\n   Columns:\n   - oid: ZTF identifier\n   - mjd: epoch date\n   - fid: filter identifier (1=g; 2=r; 3=i)\n   - isdiffpos: sign of difference flux (NULL for non-detections)\n   - det_mag: detection difference magnitude (magpsf)\n   - det_mag_err: detection magnitude uncertainty (sigmapsf)\n   - diffmaglim: 5-sigma magnitude limit\n   - forced_mag: forced photometry difference magnitude (mag)\n   - forced_mag_err: forced photometry magnitude uncertainty (e_mag)\n   - \"table\": source table name for each epoch\n*/\nWITH target AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid AS oid,\n    d.mjd AS mjd,\n    d.fid AS fid,\n    d.isdiffpos AS isdiffpos,\n    d.magpsf AS det_mag,\n    d.sigmapsf AS det_mag_err,\n    d.diffmaglim AS diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid = (SELECT oid FROM target)\n\nUNION ALL\n\nSELECT\n    nd.oid,\n    nd.mjd,\n    nd.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    nd.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'non_detection'::text AS \"table\"\nFROM non_detection nd\nWHERE nd.oid = (SELECT oid FROM target)\n\nUNION ALL\n\nSELECT\n    fp.oid,\n    fp.mjd,\n    fp.fid,\n    fp.isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    fp.diffmaglim,\n    fp.mag AS forced_mag,\n    fp.e_mag AS forced_mag_err,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry fp\nWHERE fp.oid = (SELECT oid FROM target)\n\nORDER BY mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "/* All epochs (detections, non-detections, forced photometry) for the object 'ZTF24aamtvxb'\n   Columns:\n   - oid: ZTF identifier\n   - mjd: epoch date\n   - fid: filter identifier (1=g; 2=r; 3=i)\n   - isdiffpos: sign of difference flux (NULL for non-detections)\n   - det_mag: detection difference magnitude (magpsf)\n   - det_mag_err: detection magnitude uncertainty (sigmapsf)\n   - diffmaglim: 5-sigma magnitude limit\n   - forced_mag: forced photometry difference magnitude (mag)\n   - forced_mag_err: forced photometry magnitude uncertainty (e_mag)\n   - \"table\": source table name for each epoch\n*/\nWITH target AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF24aamtvxb'\n)\nSELECT\n    d.oid AS oid,\n    d.mjd AS mjd,\n    d.fid AS fid,\n    d.isdiffpos AS isdiffpos,\n    d.magpsf AS det_mag,\n    d.sigmapsf AS det_mag_err,\n    d.diffmaglim AS diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'detection'::text AS \"table\"\nFROM detection d\nWHERE d.oid = (SELECT oid FROM target)\n\nUNION ALL\n\nSELECT\n    nd.oid,\n    nd.mjd,\n    nd.fid,\n    NULL::integer AS isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    nd.diffmaglim,\n    NULL::double precision AS forced_mag,\n    NULL::double precision AS forced_mag_err,\n    'non_detection'::text AS \"table\"\nFROM non_detection nd\nWHERE nd.oid = (SELECT oid FROM target)\n\nUNION ALL\n\nSELECT\n    fp.oid,\n    fp.mjd,\n    fp.fid,\n    fp.isdiffpos,\n    NULL::double precision AS det_mag,\n    NULL::double precision AS det_mag_err,\n    fp.diffmaglim,\n    fp.mag AS forced_mag,\n    fp.e_mag AS forced_mag_err,\n    'forced_photometry'::text AS \"table\"\nFROM forced_photometry fp\nWHERE fp.oid = (SELECT oid FROM target)\n\nORDER BY mjd;"
                },
                "in_toks": 3792,
                "out_toks": 3014,
                "id": "chatcmpl-CZREJGAa4P2ikBITbNG6K1tcTWcon",
                "created": 1762562187,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "106": {
        "0": {
            "req_id": "106",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']",
                    "1": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 727,
                "out_toks": 2086,
                "id": "chatcmpl-CSnbkCpHSedB9SMJfxVzlCCnUR6pL",
                "created": 1760979912,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query using selective CTEs and ranking=1 filters to avoid full scans and timeouts\nWITH stamp_bogus AS\n  (SELECT p.oid,\n          p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'bogus'\n     AND p.ranking = 1\n     AND p.probability > 0.7),\n     lc_transient AS\n  (SELECT p.oid,\n          MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_top'\n     AND p.class_name = 'Transient'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid)\nSELECT o.oid, -- ZTF identifier\n o.ndet, -- number of detections\n o.firstmjd, -- first detection date\n sb.prob_stamp_bogus, -- probability in stamp classifier\n lt.prob_lc_transient -- probability in LC classifier top level\nFROM stamp_bogus sb\nJOIN lc_transient lt ON lt.oid = sb.oid\nJOIN OBJECT o ON o.oid = sb.oid\nWHERE o.ndet > 10\nORDER BY sb.oid\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query using selective CTEs and ranking=1 filters to avoid full scans and timeouts\nWITH stamp_bogus AS\n  (SELECT p.oid,\n          p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'bogus'\n     AND p.ranking = 1\n     AND p.probability > 0.7),\n     lc_transient AS\n  (SELECT p.oid,\n          MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_top'\n     AND p.class_name = 'Transient'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid)\nSELECT o.oid, -- ZTF identifier\n o.ndet, -- number of detections\n o.firstmjd, -- first detection date\n sb.prob_stamp_bogus, -- probability in stamp classifier\n lt.prob_lc_transient -- probability in LC classifier top level\nFROM stamp_bogus sb\nJOIN lc_transient lt ON lt.oid = sb.oid\nJOIN OBJECT o ON o.oid = sb.oid\nWHERE o.ndet > 10\nORDER BY sb.oid\nLIMIT 30;"
                },
                "in_toks": 2019,
                "out_toks": 1472,
                "id": "chatcmpl-CbA6Uchi5pgiu3ncZEMNfeBn0NLqa",
                "created": 1762973010,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects with ndet > 10, stamp bogus prob > 0.7 (version 'stamp_classifier_1.0.4'),\r\n-- and lc_top Transient prob > 0.9. Return required columns and order by oid.\r\nWITH cand_oids AS (\r\n    SELECT pb.oid\r\n    FROM probability pb\r\n    WHERE pb.classifier_name = 'stamp_classifier'\r\n      AND pb.classifier_version = 'stamp_classifier_1.0.4'\r\n      AND pb.class_name = 'bogus'\r\n      AND pb.probability > 0.7\r\n    INTERSECT\r\n    SELECT pt.oid\r\n    FROM probability pt\r\n    WHERE pt.classifier_name = 'lc_classifier_top'\r\n      AND pt.class_name = 'Transient'\r\n      AND pt.probability > 0.9\r\n)\r\nSELECT\r\n    o.oid,                         -- ZTF identifier\r\n    o.ndet,                        -- number of detections\r\n    o.firstmjd,                    -- first detection date\r\n    (\r\n        SELECT p.probability\r\n        FROM probability p\r\n        WHERE p.oid = o.oid\r\n          AND p.classifier_name = 'stamp_classifier'\r\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\r\n          AND p.class_name = 'bogus'\r\n    ) AS prob_stamp_bogus,\r\n    (\r\n        SELECT MAX(p2.probability) -- in case multiple versions exist, take the maximum\r\n        FROM probability p2\r\n        WHERE p2.oid = o.oid\r\n          AND p2.classifier_name = 'lc_classifier_top'\r\n          AND p2.class_name = 'Transient'\r\n    ) AS prob_lc_transient\r\nFROM object o\r\nWHERE o.ndet > 10\r\n  AND o.oid IN (SELECT oid FROM cand_oids)\r\nORDER BY o.oid\r\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with ndet > 10, stamp bogus prob > 0.7 (version 'stamp_classifier_1.0.4'),\r\n-- and lc_top Transient prob > 0.9. Return required columns and order by oid.\r\nWITH cand_oids AS (\r\n    SELECT pb.oid\r\n    FROM probability pb\r\n    WHERE pb.classifier_name = 'stamp_classifier'\r\n      AND pb.classifier_version = 'stamp_classifier_1.0.4'\r\n      AND pb.class_name = 'bogus'\r\n      AND pb.probability > 0.7\r\n    INTERSECT\r\n    SELECT pt.oid\r\n    FROM probability pt\r\n    WHERE pt.classifier_name = 'lc_classifier_top'\r\n      AND pt.class_name = 'Transient'\r\n      AND pt.probability > 0.9\r\n)\r\nSELECT\r\n    o.oid,                         -- ZTF identifier\r\n    o.ndet,                        -- number of detections\r\n    o.firstmjd,                    -- first detection date\r\n    (\r\n        SELECT p.probability\r\n        FROM probability p\r\n        WHERE p.oid = o.oid\r\n          AND p.classifier_name = 'stamp_classifier'\r\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\r\n          AND p.class_name = 'bogus'\r\n    ) AS prob_stamp_bogus,\r\n    (\r\n        SELECT MAX(p2.probability) -- in case multiple versions exist, take the maximum\r\n        FROM probability p2\r\n        WHERE p2.oid = o.oid\r\n          AND p2.classifier_name = 'lc_classifier_top'\r\n          AND p2.class_name = 'Transient'\r\n    ) AS prob_lc_transient\r\nFROM object o\r\nWHERE o.ndet > 10\r\n  AND o.oid IN (SELECT oid FROM cand_oids)\r\nORDER BY o.oid\r\nLIMIT 30;"
                },
                "in_toks": 2706,
                "out_toks": 3150,
                "id": "chatcmpl-CSoIjfNqCAFVvCpP759fD0TEG9W9m",
                "created": 1760982577,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "106",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']",
                    "1": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 727,
                "out_toks": 2086,
                "id": "chatcmpl-CSnbkCpHSedB9SMJfxVzlCCnUR6pL",
                "created": 1760979912,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return required columns and sort by ZTF id.\nSELECT\n    o.oid AS ztf_id,\n    o.ndet,\n    o.firstmjd,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n    ) AS prob_stamp_bogus,\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'lc_classifier_top'\n          AND p2.class_name = 'Transient'\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'stamp_classifier'\n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND class_name = 'bogus'\n        AND probability > 0.7\n  )\n  AND o.oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier_top'\n        AND class_name = 'Transient'\n        AND probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return required columns and sort by ZTF id.\nSELECT\n    o.oid AS ztf_id,\n    o.ndet,\n    o.firstmjd,\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n    ) AS prob_stamp_bogus,\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'lc_classifier_top'\n          AND p2.class_name = 'Transient'\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'stamp_classifier'\n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND class_name = 'bogus'\n        AND probability > 0.7\n  )\n  AND o.oid IN (\n      SELECT oid\n      FROM probability\n      WHERE classifier_name = 'lc_classifier_top'\n        AND class_name = 'Transient'\n        AND probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2706,
                "out_toks": 2004,
                "id": "chatcmpl-CSoJHtkSRAtEPUurPlPWjctWRo1OX",
                "created": 1760982611,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "106",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 727,
                "out_toks": 528,
                "id": "chatcmpl-CSst2xzC2NtLcStgseg6c5kqE43wV",
                "created": 1761000204,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects with:\n-- - ndet > 10\n-- - stamp_classifier version 'stamp_classifier_1.0.4' class 'bogus' probability > 0.7\n-- - lc_classifier_top class 'Transient' probability > 0.9\n-- Return: oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient\n-- Order by oid (ZTF identifier)\nSELECT\n  o.oid,\n  o.ndet,\n  o.firstmjd,\n  /* Probability of being 'bogus' in the specified stamp classifier version */\n  (\n    SELECT MAX(p1.probability)\n    FROM probability p1\n    WHERE p1.oid = o.oid\n      AND p1.classifier_name = 'stamp_classifier'\n      AND p1.classifier_version = 'stamp_classifier_1.0.4'\n      AND p1.class_name = 'bogus'\n  ) AS prob_stamp_bogus,\n  /* Probability of being 'Transient' in the top-level light curve classifier (any version) */\n  (\n    SELECT MAX(p2.probability)\n    FROM probability p2\n    WHERE p2.oid = o.oid\n      AND p2.classifier_name = 'lc_classifier_top'\n      AND p2.class_name = 'Transient'\n  ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n  )\n  AND o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with:\n-- - ndet > 10\n-- - stamp_classifier version 'stamp_classifier_1.0.4' class 'bogus' probability > 0.7\n-- - lc_classifier_top class 'Transient' probability > 0.9\n-- Return: oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient\n-- Order by oid (ZTF identifier)\nSELECT\n  o.oid,\n  o.ndet,\n  o.firstmjd,\n  /* Probability of being 'bogus' in the specified stamp classifier version */\n  (\n    SELECT MAX(p1.probability)\n    FROM probability p1\n    WHERE p1.oid = o.oid\n      AND p1.classifier_name = 'stamp_classifier'\n      AND p1.classifier_version = 'stamp_classifier_1.0.4'\n      AND p1.class_name = 'bogus'\n  ) AS prob_stamp_bogus,\n  /* Probability of being 'Transient' in the top-level light curve classifier (any version) */\n  (\n    SELECT MAX(p2.probability)\n    FROM probability p2\n    WHERE p2.oid = o.oid\n      AND p2.classifier_name = 'lc_classifier_top'\n      AND p2.class_name = 'Transient'\n  ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n  )\n  AND o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2661,
                "out_toks": 1785,
                "id": "chatcmpl-CSt32qQRhtoPOryCoejkpslcGEM30",
                "created": 1761000824,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "106",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 727,
                "out_toks": 912,
                "id": "chatcmpl-CSstAsfmAJ8D1L8JGYWRoGlluhGfH",
                "created": 1761000212,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query using CTEs and joins to avoid correlated subqueries and INTERSECT\n-- Conditions:\n--  - ndet > 10\n--  - bogus prob > 0.7 in stamp_classifier v 'stamp_classifier_1.0.4' and ranked top (ranking=1)\n--  - Transient prob > 0.9 in lc_classifier_top (take the max prob per object, restrict to ranking=1 for efficiency)\n-- Returns: oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient\n-- Ordered by oid\nWITH stamp_bogus AS\n  (SELECT p.oid,\n          p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.ranking = 1\n     AND p.probability > 0.7),\n     lc_trans AS\n  (SELECT p.oid,\n          MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.class_name = 'Transient'\n     AND p.classifier_name = 'lc_classifier_top'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid)\nSELECT o.oid,\n       o.ndet,\n       o.firstmjd,\n       sb.prob_stamp_bogus,\n       lt.prob_lc_transient\nFROM stamp_bogus sb\nJOIN lc_trans lt ON lt.oid = sb.oid\nJOIN OBJECT o ON o.oid = sb.oid\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query using CTEs and joins to avoid correlated subqueries and INTERSECT\n-- Conditions:\n--  - ndet > 10\n--  - bogus prob > 0.7 in stamp_classifier v 'stamp_classifier_1.0.4' and ranked top (ranking=1)\n--  - Transient prob > 0.9 in lc_classifier_top (take the max prob per object, restrict to ranking=1 for efficiency)\n-- Returns: oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient\n-- Ordered by oid\nWITH stamp_bogus AS\n  (SELECT p.oid,\n          p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.ranking = 1\n     AND p.probability > 0.7),\n     lc_trans AS\n  (SELECT p.oid,\n          MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.class_name = 'Transient'\n     AND p.classifier_name = 'lc_classifier_top'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid)\nSELECT o.oid,\n       o.ndet,\n       o.firstmjd,\n       sb.prob_stamp_bogus,\n       lt.prob_lc_transient\nFROM stamp_bogus sb\nJOIN lc_trans lt ON lt.oid = sb.oid\nJOIN OBJECT o ON o.oid = sb.oid\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 1972,
                "out_toks": 2568,
                "id": "chatcmpl-CbA7HUepwkjv6jwRpQ6ZctL2623Ar",
                "created": 1762973059,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects:\n-- - ndet > 10\n-- - bogus prob > 0.7 in stamp_classifier version 'stamp_classifier_1.0.4' (and ranked as top class)\n-- - Transient prob > 0.9 in lc_classifier_top (any version; take max per object)\n-- Return: oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient\n-- Order by the ZTF identifier (oid)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    (\n        SELECT p1.probability\n        FROM probability p1\n        WHERE p1.oid = o.oid\n          AND p1.class_name = 'bogus'\n          AND p1.classifier_name = 'stamp_classifier'\n          AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    ) AS prob_stamp_bogus,\n    (\n        SELECT MAX(p2.probability)\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name = 'Transient'\n          AND p2.classifier_name = 'lc_classifier_top'\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n      SELECT oid\n      FROM probability\n      WHERE class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier'\n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND ranking = 1\n        AND probability > 0.7\n      INTERSECT\n      SELECT oid\n      FROM probability\n      WHERE class_name = 'Transient'\n        AND classifier_name = 'lc_classifier_top'\n        AND probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects:\n-- - ndet > 10\n-- - bogus prob > 0.7 in stamp_classifier version 'stamp_classifier_1.0.4' (and ranked as top class)\n-- - Transient prob > 0.9 in lc_classifier_top (any version; take max per object)\n-- Return: oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient\n-- Order by the ZTF identifier (oid)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    (\n        SELECT p1.probability\n        FROM probability p1\n        WHERE p1.oid = o.oid\n          AND p1.class_name = 'bogus'\n          AND p1.classifier_name = 'stamp_classifier'\n          AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    ) AS prob_stamp_bogus,\n    (\n        SELECT MAX(p2.probability)\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name = 'Transient'\n          AND p2.classifier_name = 'lc_classifier_top'\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n      SELECT oid\n      FROM probability\n      WHERE class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier'\n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND ranking = 1\n        AND probability > 0.7\n      INTERSECT\n      SELECT oid\n      FROM probability\n      WHERE class_name = 'Transient'\n        AND classifier_name = 'lc_classifier_top'\n        AND probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2661,
                "out_toks": 3661,
                "id": "chatcmpl-CSt3IxSBTU6TE5XnNUx2RH0UkwpMo",
                "created": 1761000840,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "106",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 727,
                "out_toks": 1040,
                "id": "chatcmpl-CSstNKTmv86PgZmMl9st9qvjGUOic",
                "created": 1761000225,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return requested columns and order by oid.\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* probability of being 'bogus' in the stamp classifier v1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* probability of being 'Transient' in the top-level light curve classifier (any version) */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n      SELECT pr1.oid\n      FROM probability pr1\n      WHERE pr1.classifier_name = 'stamp_classifier'\n        AND pr1.classifier_version = 'stamp_classifier_1.0.4'\n        AND pr1.class_name = 'bogus'\n        AND pr1.probability > 0.7\n  )\n  AND o.oid IN (\n      SELECT pr2.oid\n      FROM probability pr2\n      WHERE pr2.classifier_name = 'lc_classifier_top'\n        AND pr2.class_name = 'Transient'\n        AND pr2.probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return requested columns and order by oid.\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* probability of being 'bogus' in the stamp classifier v1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* probability of being 'Transient' in the top-level light curve classifier (any version) */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (\n      SELECT pr1.oid\n      FROM probability pr1\n      WHERE pr1.classifier_name = 'stamp_classifier'\n        AND pr1.classifier_version = 'stamp_classifier_1.0.4'\n        AND pr1.class_name = 'bogus'\n        AND pr1.probability > 0.7\n  )\n  AND o.oid IN (\n      SELECT pr2.oid\n      FROM probability pr2\n      WHERE pr2.classifier_name = 'lc_classifier_top'\n        AND pr2.class_name = 'Transient'\n        AND pr2.probability > 0.9\n  )\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2661,
                "out_toks": 2599,
                "id": "chatcmpl-CSt4PqF2Bbvb083Hq6Iom7YYW9MjI",
                "created": 1761000909,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "106",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'step']"
                },
                "in_toks": 727,
                "out_toks": 1942,
                "id": "chatcmpl-CZNMMVbSQWusJSuokroZjfB8oTRhX",
                "created": 1762547310,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query: pre-filter probabilities with ranking=1 and join to reduce scans.\nWITH -- Objects with more than 10 detections\n o_filtered AS\n  (SELECT oid,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE ndet > 10), -- Stamp classifier bogus probability for specified version\n p_bogus AS\n  (SELECT p.oid,\n          p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'bogus'\n     AND p.ranking = 1\n     AND p.probability > 0.7), -- Top-level LC classifier transient probability (use max across versions), keep ranking=1\n p_transient AS\n  (SELECT p.oid,\n          MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_top'\n     AND p.class_name = 'Transient'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid)\nSELECT o.oid,\n       o.ndet,\n       o.firstmjd,\n       b.prob_stamp_bogus,\n       t.prob_lc_transient\nFROM o_filtered o\nJOIN p_bogus b ON b.oid = o.oid\nJOIN p_transient t ON t.oid = o.oid\nORDER BY o.oid\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query: pre-filter probabilities with ranking=1 and join to reduce scans.\nWITH -- Objects with more than 10 detections\n o_filtered AS\n  (SELECT oid,\n          ndet,\n          firstmjd\n   FROM OBJECT\n   WHERE ndet > 10), -- Stamp classifier bogus probability for specified version\n p_bogus AS\n  (SELECT p.oid,\n          p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'bogus'\n     AND p.ranking = 1\n     AND p.probability > 0.7), -- Top-level LC classifier transient probability (use max across versions), keep ranking=1\n p_transient AS\n  (SELECT p.oid,\n          MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_top'\n     AND p.class_name = 'Transient'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid)\nSELECT o.oid,\n       o.ndet,\n       o.firstmjd,\n       b.prob_stamp_bogus,\n       t.prob_lc_transient\nFROM o_filtered o\nJOIN p_bogus b ON b.oid = o.oid\nJOIN p_transient t ON t.oid = o.oid\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2229,
                "out_toks": 2270,
                "id": "chatcmpl-CbA8bColIGHtviQv9uPYNdnhVk2AR",
                "created": 1762973141,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return requested columns and order by oid.\nWITH valid_oids AS (\n    SELECT DISTINCT p_bogus.oid\n    FROM probability p_bogus\n    WHERE p_bogus.classifier_name = 'stamp_classifier'\n      AND p_bogus.classifier_version = 'stamp_classifier_1.0.4'\n      AND p_bogus.class_name = 'bogus'\n      AND p_bogus.probability > 0.7\n      AND EXISTS (\n          SELECT 1\n          FROM probability p_top\n          WHERE p_top.oid = p_bogus.oid\n            AND p_top.classifier_name = 'lc_classifier_top'\n            AND p_top.class_name = 'Transient'\n            AND p_top.probability > 0.9\n      )\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of 'bogus' in stamp_classifier v1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Highest 'Transient' probability in lc_classifier_top (any version) */\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'lc_classifier_top'\n          AND p2.class_name = 'Transient'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (SELECT oid FROM valid_oids)\nORDER BY o.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return requested columns and order by oid.\nWITH valid_oids AS (\n    SELECT DISTINCT p_bogus.oid\n    FROM probability p_bogus\n    WHERE p_bogus.classifier_name = 'stamp_classifier'\n      AND p_bogus.classifier_version = 'stamp_classifier_1.0.4'\n      AND p_bogus.class_name = 'bogus'\n      AND p_bogus.probability > 0.7\n      AND EXISTS (\n          SELECT 1\n          FROM probability p_top\n          WHERE p_top.oid = p_bogus.oid\n            AND p_top.classifier_name = 'lc_classifier_top'\n            AND p_top.class_name = 'Transient'\n            AND p_top.probability > 0.9\n      )\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of 'bogus' in stamp_classifier v1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Highest 'Transient' probability in lc_classifier_top (any version) */\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'lc_classifier_top'\n          AND p2.class_name = 'Transient'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (SELECT oid FROM valid_oids)\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2778,
                "out_toks": 2832,
                "id": "chatcmpl-CZREZdBzURf3qYqziOdy2icmG3N6C",
                "created": 1762562203,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "106",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 727,
                "out_toks": 976,
                "id": "chatcmpl-CZNNEZ8SnuqlUE7SEso3bqfdVlGEk",
                "created": 1762547364,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Find ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4, and Transient prob > 0.9 in lc_classifier_top.\n   For lc_classifier_top we return the highest available probability across versions if multiple exist. */\nWITH\nstamp_bogus AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'bogus'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.7\n),\nlc_trans AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of 'bogus' in stamp_classifier v1.0.4 (return the highest if duplicated entries exist) */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'bogus'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Highest probability of 'Transient' in lc_classifier_top across available versions */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (SELECT oid FROM stamp_bogus)\n  AND o.oid IN (SELECT oid FROM lc_trans)\nORDER BY o.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Find ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier v1.0.4, and Transient prob > 0.9 in lc_classifier_top.\n   For lc_classifier_top we return the highest available probability across versions if multiple exist. */\nWITH\nstamp_bogus AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'bogus'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.7\n),\nlc_trans AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of 'bogus' in stamp_classifier v1.0.4 (return the highest if duplicated entries exist) */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.class_name = 'bogus'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Highest probability of 'Transient' in lc_classifier_top across available versions */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (SELECT oid FROM stamp_bogus)\n  AND o.oid IN (SELECT oid FROM lc_trans)\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2661,
                "out_toks": 2950,
                "id": "chatcmpl-CZRFRM6AzBzDbjME32kbH3yQGeCKi",
                "created": 1762562257,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "106",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 727,
                "out_toks": 528,
                "id": "chatcmpl-CZNNmIhEtxKMLA5VNeeRh8SOnVfW4",
                "created": 1762547398,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query: push filters into subqueries, avoid correlated subselects, and use ranking=1\n-- per guidelines. Aggregate lc_classifier_top across versions with MAX(probability).\n\nSELECT o.oid,\n       o.ndet,\n       o.firstmjd,\n       sb.prob_stamp_bogus,\n       lct.prob_lc_transient\nFROM\n  (-- Stamp classifier bogus probability in version 1.0.4, keep only top-ranked class rows\n SELECT p.oid,\n        p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'bogus'\n     AND p.ranking = 1\n     AND p.probability > 0.7) sb\nJOIN\n  (-- Light curve top-level Transient probability, top-ranked class rows, across versions\n SELECT p.oid,\n        MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_top'\n     AND p.class_name = 'Transient'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid) lct ON lct.oid = sb.oid\nJOIN OBJECT o ON o.oid = sb.oid\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query: push filters into subqueries, avoid correlated subselects, and use ranking=1\n-- per guidelines. Aggregate lc_classifier_top across versions with MAX(probability).\n\nSELECT o.oid,\n       o.ndet,\n       o.firstmjd,\n       sb.prob_stamp_bogus,\n       lct.prob_lc_transient\nFROM\n  (-- Stamp classifier bogus probability in version 1.0.4, keep only top-ranked class rows\n SELECT p.oid,\n        p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'bogus'\n     AND p.ranking = 1\n     AND p.probability > 0.7) sb\nJOIN\n  (-- Light curve top-level Transient probability, top-ranked class rows, across versions\n SELECT p.oid,\n        MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_top'\n     AND p.class_name = 'Transient'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid) lct ON lct.oid = sb.oid\nJOIN OBJECT o ON o.oid = sb.oid\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2022,
                "out_toks": 2060,
                "id": "chatcmpl-CbA9QtF5Hh8vnrrDhbWFETzM2S2Wj",
                "created": 1762973192,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier_1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return requested columns and order by oid.\nWITH stamp_bogus AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n),\nlc_transient AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of bogus in stamp_classifier_1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Max probability of Transient in lc_classifier_top across available versions */\n    (\n        SELECT MAX(p.probability)\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (SELECT oid FROM stamp_bogus)\n  AND o.oid IN (SELECT oid FROM lc_transient)\nORDER BY o.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with ndet > 10, bogus prob > 0.7 in stamp_classifier_1.0.4,\n-- and Transient prob > 0.9 in lc_classifier_top. Return requested columns and order by oid.\nWITH stamp_bogus AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n),\nlc_transient AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of bogus in stamp_classifier_1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Max probability of Transient in lc_classifier_top across available versions */\n    (\n        SELECT MAX(p.probability)\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.ndet > 10\n  AND o.oid IN (SELECT oid FROM stamp_bogus)\n  AND o.oid IN (SELECT oid FROM lc_transient)\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2661,
                "out_toks": 2784,
                "id": "chatcmpl-CZRGhEn4ndkZtTCwkIFHtFqpwEcKw",
                "created": 1762562335,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "106",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 727,
                "out_toks": 723,
                "id": "chatcmpl-CZNNz6sUPPVOWTg1d3eMNRBsCg4SN",
                "created": 1762547411,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Efficient query using pre-filtered probability sets and ranking=1 to avoid full scans\n-- Conditions:\n-- - object.ndet > 10\n-- - probability for stamp_classifier v 'stamp_classifier_1.0.4', class 'bogus', ranking=1, prob > 0.7\n-- - probability for lc_classifier_top, class 'Transient', ranking=1, prob > 0.9 (max across versions)\n-- Returns up to 30 objects ordered by ZTF identifier\nWITH stamp_prob AS\n  (SELECT p.oid,\n          p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'bogus'\n     AND p.ranking = 1\n     AND p.probability > 0.7),\n     lc_prob AS\n  (SELECT p.oid,\n          MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_top'\n     AND p.class_name = 'Transient'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid),\n     candidates AS\n  (SELECT sp.oid\n   FROM stamp_prob sp\n   JOIN lc_prob lp USING (oid)\n   JOIN OBJECT o ON o.oid = sp.oid\n   WHERE o.ndet > 10\n   ORDER BY sp.oid\n   LIMIT 30)\nSELECT o.oid AS ztf_identifier,\n       o.ndet AS number_of_detections,\n       o.firstmjd AS first_detection_date,\n       sp.prob_stamp_bogus,\n       lp.prob_lc_transient\nFROM candidates c\nJOIN OBJECT o ON o.oid = c.oid\nJOIN stamp_prob sp ON sp.oid = c.oid\nJOIN lc_prob lp ON lp.oid = c.oid\nORDER BY ztf_identifier;",
            "sql_response": {
                "responses": {
                    "0": "-- Efficient query using pre-filtered probability sets and ranking=1 to avoid full scans\n-- Conditions:\n-- - object.ndet > 10\n-- - probability for stamp_classifier v 'stamp_classifier_1.0.4', class 'bogus', ranking=1, prob > 0.7\n-- - probability for lc_classifier_top, class 'Transient', ranking=1, prob > 0.9 (max across versions)\n-- Returns up to 30 objects ordered by ZTF identifier\nWITH stamp_prob AS\n  (SELECT p.oid,\n          p.probability AS prob_stamp_bogus\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.classifier_version = 'stamp_classifier_1.0.4'\n     AND p.class_name = 'bogus'\n     AND p.ranking = 1\n     AND p.probability > 0.7),\n     lc_prob AS\n  (SELECT p.oid,\n          MAX(p.probability) AS prob_lc_transient\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_top'\n     AND p.class_name = 'Transient'\n     AND p.ranking = 1\n     AND p.probability > 0.9\n   GROUP BY p.oid),\n     candidates AS\n  (SELECT sp.oid\n   FROM stamp_prob sp\n   JOIN lc_prob lp USING (oid)\n   JOIN OBJECT o ON o.oid = sp.oid\n   WHERE o.ndet > 10\n   ORDER BY sp.oid\n   LIMIT 30)\nSELECT o.oid AS ztf_identifier,\n       o.ndet AS number_of_detections,\n       o.firstmjd AS first_detection_date,\n       sp.prob_stamp_bogus,\n       lp.prob_lc_transient\nFROM candidates c\nJOIN OBJECT o ON o.oid = c.oid\nJOIN stamp_prob sp ON sp.oid = c.oid\nJOIN lc_prob lp ON lp.oid = c.oid\nORDER BY ztf_identifier;"
                },
                "in_toks": 2253,
                "out_toks": 2612,
                "id": "chatcmpl-CbAA4s5IW7Zyg5W5MgrQHDgRbXRZM",
                "created": 1762973232,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find up to 30 ZTF objects with:\n-- - ndet > 10\n-- - stamp_classifier v1.0.4 bogus probability > 0.7\n-- - lc_classifier_top Transient probability > 0.9\n-- Return: ZTF identifier, number of detections, first detection date,\n--         prob_stamp_bogus, prob_lc_transient\nWITH objects_ndet AS (\n    SELECT oid\n    FROM object\n    WHERE ndet > 10\n),\nbogus_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n),\ntransient_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n),\ncandidate_oids AS (\n    SELECT oid FROM objects_ndet\n    INTERSECT\n    SELECT oid FROM bogus_oids\n    INTERSECT\n    SELECT oid FROM transient_oids\n)\nSELECT\n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    o.firstmjd AS first_detection_date,\n    -- Stamp classifier bogus probability (specific version)\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    -- Top-level LC Transient probability (any version)\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'lc_classifier_top'\n          AND p2.class_name = 'Transient'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.oid IN (SELECT oid FROM candidate_oids)\nORDER BY ztf_identifier\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find up to 30 ZTF objects with:\n-- - ndet > 10\n-- - stamp_classifier v1.0.4 bogus probability > 0.7\n-- - lc_classifier_top Transient probability > 0.9\n-- Return: ZTF identifier, number of detections, first detection date,\n--         prob_stamp_bogus, prob_lc_transient\nWITH objects_ndet AS (\n    SELECT oid\n    FROM object\n    WHERE ndet > 10\n),\nbogus_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n),\ntransient_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n),\ncandidate_oids AS (\n    SELECT oid FROM objects_ndet\n    INTERSECT\n    SELECT oid FROM bogus_oids\n    INTERSECT\n    SELECT oid FROM transient_oids\n)\nSELECT\n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    o.firstmjd AS first_detection_date,\n    -- Stamp classifier bogus probability (specific version)\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    -- Top-level LC Transient probability (any version)\n    (\n        SELECT p2.probability\n        FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.classifier_name = 'lc_classifier_top'\n          AND p2.class_name = 'Transient'\n        ORDER BY p2.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.oid IN (SELECT oid FROM candidate_oids)\nORDER BY ztf_identifier\nLIMIT 30;"
                },
                "in_toks": 2706,
                "out_toks": 2368,
                "id": "chatcmpl-CZRGnGk7TsITU7Sf96KHJ3Sys5MRR",
                "created": 1762562341,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "106",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 727,
                "out_toks": 1299,
                "id": "chatcmpl-CZNOV1qVjoUWfx1JpzYLzY98cOz5c",
                "created": 1762547443,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Find ZTF objects with ndet>10, bogus prob>0.7 for stamp_classifier v1.0.4, and Transient prob>0.9 for lc_classifier_top\nWITH bogus_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n),\ntransient_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n),\nselected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 10\n      AND o.oid IN (SELECT oid FROM bogus_oids)\n      AND o.oid IN (SELECT oid FROM transient_oids)\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of being bogus in stamp classifier v1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Highest probability of being Transient in lc_classifier_top (any version) */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_oids)\nORDER BY o.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Find ZTF objects with ndet>10, bogus prob>0.7 for stamp_classifier v1.0.4, and Transient prob>0.9 for lc_classifier_top\nWITH bogus_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'bogus'\n      AND p.probability > 0.7\n),\ntransient_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top'\n      AND p.class_name = 'Transient'\n      AND p.probability > 0.9\n),\nselected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 10\n      AND o.oid IN (SELECT oid FROM bogus_oids)\n      AND o.oid IN (SELECT oid FROM transient_oids)\n)\nSELECT\n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    /* Probability of being bogus in stamp classifier v1.0.4 */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.class_name = 'bogus'\n        LIMIT 1\n    ) AS prob_stamp_bogus,\n    /* Highest probability of being Transient in lc_classifier_top (any version) */\n    (\n        SELECT p.probability\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier_top'\n          AND p.class_name = 'Transient'\n        ORDER BY p.probability DESC\n        LIMIT 1\n    ) AS prob_lc_transient\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_oids)\nORDER BY o.oid\nLIMIT 30;"
                },
                "in_toks": 2706,
                "out_toks": 3708,
                "id": "chatcmpl-CZRHN3MHxCzhOdXH6FBvUM54WjWAO",
                "created": 1762562377,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "56": {
        "0": {
            "req_id": "56",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']",
                    "1": "['object', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 2656,
                "id": "chatcmpl-CSnc21PEm7VMBoRYgupyVxRcKLves",
                "created": 1760979930,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get specified ZTF objects whose corrected light curve was not computed\nWITH selected_oids(oid) AS (\n    VALUES \n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    o.oid,              -- ZTF identifier\n    o.ndet,             -- number of detections\n    o.meanra,           -- mean RA\n    o.meandec,          -- mean Dec\n    o.firstmjd,         -- date of first detection\n    o.lastmjd,          -- date of last detection\n    o.g_r_mean,         -- mean g-r difference magnitude\n    o.g_r_mean_corr     -- mean g-r corrected magnitude\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_oids)\n  AND COALESCE(o.corrected, FALSE) = FALSE\nORDER BY o.firstmjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get specified ZTF objects whose corrected light curve was not computed\nWITH selected_oids(oid) AS (\n    VALUES \n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    o.oid,              -- ZTF identifier\n    o.ndet,             -- number of detections\n    o.meanra,           -- mean RA\n    o.meandec,          -- mean Dec\n    o.firstmjd,         -- date of first detection\n    o.lastmjd,          -- date of last detection\n    o.g_r_mean,         -- mean g-r difference magnitude\n    o.g_r_mean_corr     -- mean g-r corrected magnitude\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_oids)\n  AND COALESCE(o.corrected, FALSE) = FALSE\nORDER BY o.firstmjd ASC;"
                },
                "in_toks": 2991,
                "out_toks": 1739,
                "id": "chatcmpl-CSoJgUVPQZhcdavsvGNsPaubqmePq",
                "created": 1760982636,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "56",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']",
                    "1": "['object', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 2656,
                "id": "chatcmpl-CSnc21PEm7VMBoRYgupyVxRcKLves",
                "created": 1760979930,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects among the given OIDs whose corrected light curve was not computed (corrected is false or null)\nSELECT\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd,\n    lastmjd,\n    g_r_mean,\n    g_r_mean_corr\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n      AND COALESCE(corrected, FALSE) = FALSE\n)\nORDER BY firstmjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects among the given OIDs whose corrected light curve was not computed (corrected is false or null)\nSELECT\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd,\n    lastmjd,\n    g_r_mean,\n    g_r_mean_corr\nFROM object\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n      AND COALESCE(corrected, FALSE) = FALSE\n)\nORDER BY firstmjd ASC;"
                },
                "in_toks": 3160,
                "out_toks": 1607,
                "id": "chatcmpl-CSoJxD3MOIjKgcbnsSqOYuwESC6oU",
                "created": 1760982653,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "56",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 1040,
                "id": "chatcmpl-CSste7suRweqzWQyy8wfkz9Ob121G",
                "created": 1761000242,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select ZTF objects among the given OIDs whose corrected light curve was not computed\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n),\nfiltered_oids AS (\n    SELECT oid\n    FROM object\n    WHERE corrected IS NOT TRUE\n      AND oid IN (SELECT oid FROM target_oids)\n)\nSELECT\n    oid,            -- ZTF identifier\n    ndet,           -- number of detections\n    meanra,         -- mean right ascension\n    meandec,        -- mean declination\n    firstmjd,       -- date of first detection\n    lastmjd,        -- date of last detection\n    g_r_mean,       -- difference between mean g- and r-band difference magnitudes\n    g_r_mean_corr   -- difference between mean g- and r-band corrected magnitudes\nFROM object\nWHERE oid IN (SELECT oid FROM filtered_oids)\nORDER BY firstmjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select ZTF objects among the given OIDs whose corrected light curve was not computed\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n),\nfiltered_oids AS (\n    SELECT oid\n    FROM object\n    WHERE corrected IS NOT TRUE\n      AND oid IN (SELECT oid FROM target_oids)\n)\nSELECT\n    oid,            -- ZTF identifier\n    ndet,           -- number of detections\n    meanra,         -- mean right ascension\n    meandec,        -- mean declination\n    firstmjd,       -- date of first detection\n    lastmjd,        -- date of last detection\n    g_r_mean,       -- difference between mean g- and r-band difference magnitudes\n    g_r_mean_corr   -- difference between mean g- and r-band corrected magnitudes\nFROM object\nWHERE oid IN (SELECT oid FROM filtered_oids)\nORDER BY firstmjd ASC;"
                },
                "in_toks": 3160,
                "out_toks": 2023,
                "id": "chatcmpl-CSt53D7Sulqayhvaipxt8Yvr2EfmG",
                "created": 1761000949,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "56",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "magstat",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat', 'detection']"
                },
                "in_toks": 692,
                "out_toks": 1236,
                "id": "chatcmpl-CSstsDDZxxSdQvwGH0yAmxYHWudpT",
                "created": 1761000256,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return specified columns for the given ZTF objects whose corrected light curve was not computed\n-- Using a subquery/CTE to supply OIDs as requested, and avoiding JOINs\n-- The filter \"o.corrected IS NOT TRUE\" treats NULL or FALSE as \"not computed\"\nWITH requested_oids AS (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n    ) v(oid)\n)\nSELECT\n    o.oid,             -- ZTF identifier\n    o.ndet,            -- number of detections\n    o.meanra,          -- mean RA\n    o.meandec,         -- mean Dec\n    o.firstmjd,        -- date of first detection\n    o.lastmjd,         -- date of last detection\n    o.g_r_mean,        -- difference between mean g and r difference magnitudes\n    o.g_r_mean_corr    -- difference between mean g and r corrected magnitudes\nFROM object o\nWHERE o.oid IN (SELECT oid FROM requested_oids)\n  AND o.corrected IS NOT TRUE\nORDER BY o.firstmjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return specified columns for the given ZTF objects whose corrected light curve was not computed\n-- Using a subquery/CTE to supply OIDs as requested, and avoiding JOINs\n-- The filter \"o.corrected IS NOT TRUE\" treats NULL or FALSE as \"not computed\"\nWITH requested_oids AS (\n    SELECT oid\n    FROM (VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n    ) v(oid)\n)\nSELECT\n    o.oid,             -- ZTF identifier\n    o.ndet,            -- number of detections\n    o.meanra,          -- mean RA\n    o.meandec,         -- mean Dec\n    o.firstmjd,        -- date of first detection\n    o.lastmjd,         -- date of last detection\n    o.g_r_mean,        -- difference between mean g and r difference magnitudes\n    o.g_r_mean_corr    -- difference between mean g and r corrected magnitudes\nFROM object o\nWHERE o.oid IN (SELECT oid FROM requested_oids)\n  AND o.corrected IS NOT TRUE\nORDER BY o.firstmjd ASC;"
                },
                "in_toks": 3708,
                "out_toks": 1155,
                "id": "chatcmpl-CSt5NKGnJCC6AS8qfbDDl9E6GKdW9",
                "created": 1761000969,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "56",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 692,
                "out_toks": 1616,
                "id": "chatcmpl-CSsuBxUVgTkCwo3J5ogNpWm9YJBBb",
                "created": 1761000275,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return ZTF objects among the specified OIDs where the corrected light curve was not computed (corrected = false or NULL)\nWITH requested_oids (oid) AS (\n    VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    oid,                -- ZTF identifier\n    ndet,               -- number of detections\n    meanra,             -- mean right ascension\n    meandec,            -- mean declination\n    firstmjd,           -- date of first detection\n    lastmjd,            -- date of last detection\n    g_r_mean,           -- difference between mean g- and r-band difference magnitudes\n    g_r_mean_corr       -- difference between mean g- and r-band corrected magnitudes\nFROM object\nWHERE oid IN (SELECT oid FROM requested_oids)\n  AND (corrected = false OR corrected IS NULL)\nORDER BY firstmjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return ZTF objects among the specified OIDs where the corrected light curve was not computed (corrected = false or NULL)\nWITH requested_oids (oid) AS (\n    VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    oid,                -- ZTF identifier\n    ndet,               -- number of detections\n    meanra,             -- mean right ascension\n    meandec,            -- mean declination\n    firstmjd,           -- date of first detection\n    lastmjd,            -- date of last detection\n    g_r_mean,           -- difference between mean g- and r-band difference magnitudes\n    g_r_mean_corr       -- difference between mean g- and r-band corrected magnitudes\nFROM object\nWHERE oid IN (SELECT oid FROM requested_oids)\n  AND (corrected = false OR corrected IS NULL)\nORDER BY firstmjd ASC;"
                },
                "in_toks": 2991,
                "out_toks": 1175,
                "id": "chatcmpl-CSsy0FhFPK8bCxjWbrHfv2zSYUTVT",
                "created": 1761000512,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "56",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 1680,
                "id": "chatcmpl-CZNP6wkind1SXCXtGXJasisH6TiBF",
                "created": 1762547480,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects among the given ZTF OIDs where the corrected light curve was not computed (corrected IS NOT TRUE)\n-- Returns: oid, ndet, mean coordinates, first/last detection dates, g-r mean difference magnitudes (raw and corrected)\nSELECT\n    o.oid,                 -- ZTF identifier\n    o.ndet,                -- number of detections\n    o.meanra,              -- mean RA\n    o.meandec,             -- mean Dec\n    o.firstmjd,            -- date of first detection\n    o.lastmjd,             -- date of last detection\n    o.g_r_mean,            -- difference between mean g- and r-band difference magnitudes\n    o.g_r_mean_corr        -- difference between mean g- and r-band corrected magnitudes\nFROM object o\nWHERE o.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n      AND corrected IS NOT TRUE  -- includes FALSE or NULL (not computed)\n)\nORDER BY o.firstmjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects among the given ZTF OIDs where the corrected light curve was not computed (corrected IS NOT TRUE)\n-- Returns: oid, ndet, mean coordinates, first/last detection dates, g-r mean difference magnitudes (raw and corrected)\nSELECT\n    o.oid,                 -- ZTF identifier\n    o.ndet,                -- number of detections\n    o.meanra,              -- mean RA\n    o.meandec,             -- mean Dec\n    o.firstmjd,            -- date of first detection\n    o.lastmjd,             -- date of last detection\n    o.g_r_mean,            -- difference between mean g- and r-band difference magnitudes\n    o.g_r_mean_corr        -- difference between mean g- and r-band corrected magnitudes\nFROM object o\nWHERE o.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n      AND corrected IS NOT TRUE  -- includes FALSE or NULL (not computed)\n)\nORDER BY o.firstmjd ASC;"
                },
                "in_toks": 3160,
                "out_toks": 1653,
                "id": "chatcmpl-CZRIiopRPmtt7Qt6qCQP95ZIC50Mg",
                "created": 1762562460,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "56",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']"
                },
                "in_toks": 692,
                "out_toks": 1232,
                "id": "chatcmpl-CZNPhYonxth2NQmC05HixM65zNrFi",
                "created": 1762547517,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get specified ZTF objects whose corrected light curve was not computed\nWITH selected_oids AS (\n    -- Prioritize obtaining OIDs in a subquery from the object table\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n)\nSELECT\n    oid,                 -- ZTF identifier\n    ndet,                -- number of detections\n    meanra,              -- mean RA\n    meandec,             -- mean Dec\n    firstmjd,            -- date of first detection\n    lastmjd,             -- date of last detection\n    g_r_mean,            -- difference between mean g- and r-band difference magnitudes\n    g_r_mean_corr        -- difference between mean g- and r-band corrected magnitudes\nFROM object\nWHERE corrected IS FALSE\n  AND oid IN (SELECT oid FROM selected_oids)\nORDER BY firstmjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get specified ZTF objects whose corrected light curve was not computed\nWITH selected_oids AS (\n    -- Prioritize obtaining OIDs in a subquery from the object table\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n)\nSELECT\n    oid,                 -- ZTF identifier\n    ndet,                -- number of detections\n    meanra,              -- mean RA\n    meandec,             -- mean Dec\n    firstmjd,            -- date of first detection\n    lastmjd,             -- date of last detection\n    g_r_mean,            -- difference between mean g- and r-band difference magnitudes\n    g_r_mean_corr        -- difference between mean g- and r-band corrected magnitudes\nFROM object\nWHERE corrected IS FALSE\n  AND oid IN (SELECT oid FROM selected_oids)\nORDER BY firstmjd;"
                },
                "in_toks": 3160,
                "out_toks": 1172,
                "id": "chatcmpl-CZRJ2DtN5UZJHzAapNnr8nBfcsGwH",
                "created": 1762562480,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "56",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 692,
                "out_toks": 1232,
                "id": "chatcmpl-CZNQ7ImzwbdN4j6nNIic2WQyAvp3g",
                "created": 1762547543,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects with specified ZTF oids where corrected light curve was not computed (object.corrected = false)\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n)\nSELECT\n    o.oid,             -- ZTF identifier\n    o.ndet,            -- number of detections\n    o.meanra,          -- mean RA\n    o.meandec,         -- mean Dec\n    o.firstmjd,        -- first detection date (MJD)\n    o.lastmjd,         -- last detection date (MJD)\n    o.g_r_mean,        -- mean g - r difference magnitude\n    o.g_r_mean_corr    -- mean g - r corrected magnitude\nFROM object o\nWHERE o.oid IN (SELECT oid FROM target_oids)\n  AND o.corrected = false\nORDER BY o.firstmjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects with specified ZTF oids where corrected light curve was not computed (object.corrected = false)\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n)\nSELECT\n    o.oid,             -- ZTF identifier\n    o.ndet,            -- number of detections\n    o.meanra,          -- mean RA\n    o.meandec,         -- mean Dec\n    o.firstmjd,        -- first detection date (MJD)\n    o.lastmjd,         -- last detection date (MJD)\n    o.g_r_mean,        -- mean g - r difference magnitude\n    o.g_r_mean_corr    -- mean g - r corrected magnitude\nFROM object o\nWHERE o.oid IN (SELECT oid FROM target_oids)\n  AND o.corrected = false\nORDER BY o.firstmjd ASC;"
                },
                "in_toks": 2991,
                "out_toks": 1558,
                "id": "chatcmpl-CZRJrcRcBl1f0PqHnR5GllnsIJc2Y",
                "created": 1762562531,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "56",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 692,
                "out_toks": 1360,
                "id": "chatcmpl-CZNQbTxThLqZ8qm5IpYAxJGRV680L",
                "created": 1762547573,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Objects among the specified ZTF IDs where the corrected light curve was not computed (corrected is false or null)\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    o.oid,         -- ZTF identifier\n    o.ndet,        -- number of detections\n    o.meanra,      -- mean RA\n    o.meandec,     -- mean Dec\n    o.firstmjd,    -- date of first detection\n    o.lastmjd,     -- date of last detection\n    o.g_r_mean,    -- difference between mean g- and r-band difference magnitudes\n    o.g_r_mean_corr -- difference between mean g- and r-band corrected magnitudes\nFROM object o\nWHERE o.oid IN (SELECT oid FROM target_oids)\n  AND o.corrected IS DISTINCT FROM TRUE\nORDER BY o.firstmjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Objects among the specified ZTF IDs where the corrected light curve was not computed (corrected is false or null)\nWITH target_oids(oid) AS (\n    VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    o.oid,         -- ZTF identifier\n    o.ndet,        -- number of detections\n    o.meanra,      -- mean RA\n    o.meandec,     -- mean Dec\n    o.firstmjd,    -- date of first detection\n    o.lastmjd,     -- date of last detection\n    o.g_r_mean,    -- difference between mean g- and r-band difference magnitudes\n    o.g_r_mean_corr -- difference between mean g- and r-band corrected magnitudes\nFROM object o\nWHERE o.oid IN (SELECT oid FROM target_oids)\n  AND o.corrected IS DISTINCT FROM TRUE\nORDER BY o.firstmjd ASC;"
                },
                "in_toks": 2991,
                "out_toks": 1692,
                "id": "chatcmpl-CZRAZVzCnQT8LGAAKj0kUbmT3nDal",
                "created": 1762561955,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "56",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 692,
                "out_toks": 1808,
                "id": "chatcmpl-CZNR43AcCs8M41WFp89xlxWyaChxL",
                "created": 1762547602,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return selected ZTF objects where the corrected light curve was not computed (object.corrected IS NOT TRUE)\n-- Using a subquery to provide the OIDs (no JOINs as per guidance), and sorting by first detection date (firstmjd)\nWITH oids (oid) AS (\n    VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    o.oid,            -- ZTF identifier\n    o.ndet,           -- number of detections\n    o.meanra,         -- mean RA\n    o.meandec,        -- mean Dec\n    o.firstmjd,       -- date of first detection\n    o.lastmjd,        -- date of last detection\n    o.g_r_mean,       -- mean g-r difference magnitudes\n    o.g_r_mean_corr   -- mean g-r corrected magnitudes\nFROM object o\nWHERE o.oid IN (SELECT oid FROM oids)\n  AND o.corrected IS NOT TRUE\nORDER BY o.firstmjd ASC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return selected ZTF objects where the corrected light curve was not computed (object.corrected IS NOT TRUE)\n-- Using a subquery to provide the OIDs (no JOINs as per guidance), and sorting by first detection date (firstmjd)\nWITH oids (oid) AS (\n    VALUES\n        ('ZTF20abywydb'),\n        ('ZTF20abzpxxu'),\n        ('ZTF20acduffd')\n)\nSELECT\n    o.oid,            -- ZTF identifier\n    o.ndet,           -- number of detections\n    o.meanra,         -- mean RA\n    o.meandec,        -- mean Dec\n    o.firstmjd,       -- date of first detection\n    o.lastmjd,        -- date of last detection\n    o.g_r_mean,       -- mean g-r difference magnitudes\n    o.g_r_mean_corr   -- mean g-r corrected magnitudes\nFROM object o\nWHERE o.oid IN (SELECT oid FROM oids)\n  AND o.corrected IS NOT TRUE\nORDER BY o.firstmjd ASC;"
                },
                "in_toks": 2991,
                "out_toks": 1451,
                "id": "chatcmpl-CZRAZxx0gQna6VFYQQtpBmDORUhr4",
                "created": 1762561955,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "48": {
        "0": {
            "req_id": "48",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 1126,
                "id": "chatcmpl-CSncRleWl58KorEugX1sijfN6nlAi",
                "created": 1760979955,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for the specified ZTF object, using a subquery to obtain the OID from the object table\nSELECT\n    f.oid,         -- ZTF identifier\n    f.name,        -- feature name\n    f.value,       -- feature value\n    f.fid,         -- filter identifier\n    f.version      -- feature version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,         -- ZTF identifier\n    f.fid,         -- filter identifier\n    f.version;     -- feature version",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for the specified ZTF object, using a subquery to obtain the OID from the object table\nSELECT\n    f.oid,         -- ZTF identifier\n    f.name,        -- feature name\n    f.value,       -- feature value\n    f.fid,         -- filter identifier\n    f.version      -- feature version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,         -- ZTF identifier\n    f.fid,         -- filter identifier\n    f.version;     -- feature version"
                },
                "in_toks": 4865,
                "out_toks": 1048,
                "id": "chatcmpl-CSoKA4Pf95RID2FbwlU1LIXJUTGkQ",
                "created": 1760982666,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "48",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 1126,
                "id": "chatcmpl-CSncRleWl58KorEugX1sijfN6nlAi",
                "created": 1760979955,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for the specified ZTF object, with requested columns and sorting\nSELECT\n    f.oid,           -- ZTF identifier\n    f.name,          -- feature name\n    f.value,         -- feature value\n    f.fid,           -- filter identifier\n    f.version        -- feature version\nFROM feature f\nWHERE f.oid IN (\n    -- prioritize obtaining OIDs from the object table via a subquery\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY f.oid, f.fid, f.version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for the specified ZTF object, with requested columns and sorting\nSELECT\n    f.oid,           -- ZTF identifier\n    f.name,          -- feature name\n    f.value,         -- feature value\n    f.fid,           -- filter identifier\n    f.version        -- feature version\nFROM feature f\nWHERE f.oid IN (\n    -- prioritize obtaining OIDs from the object table via a subquery\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY f.oid, f.fid, f.version;"
                },
                "in_toks": 4865,
                "out_toks": 780,
                "id": "chatcmpl-CSoKQHQmB9f8RkWhxLGseAUXOT8Vv",
                "created": 1760982682,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "48",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 595,
                "id": "chatcmpl-CSsunYQxKMErFugZerDcAFwqFI7bw",
                "created": 1761000313,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for the specified ZTF object, using a subquery on object to obtain the OID\nWITH target_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM target_oids)\nORDER BY f.oid, f.fid, f.version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for the specified ZTF object, using a subquery on object to obtain the OID\nWITH target_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM target_oids)\nORDER BY f.oid, f.fid, f.version;"
                },
                "in_toks": 4865,
                "out_toks": 1015,
                "id": "chatcmpl-CSsyB04DPEa6iS7XPFgzhnoj3gXLr",
                "created": 1761000523,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "48",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 467,
                "id": "chatcmpl-CSsuy78kbuFDzWWtRGTz1pt77ZEz6",
                "created": 1761000324,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for the ZTF object 'ZTF18abqyaix'\n-- Return columns: oid (ZTF identifier), name (feature name), value (feature value), fid (filter identifier), version (feature version)\n-- Obtain OIDs via a subquery from the object table and avoid JOINs per guidelines\nWITH sel_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF18abqyaix'\n)\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM sel_oids)\nORDER BY\n    f.oid,        -- ZTF identifier\n    f.fid,        -- filter identifier\n    f.version;    -- feature version",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for the ZTF object 'ZTF18abqyaix'\n-- Return columns: oid (ZTF identifier), name (feature name), value (feature value), fid (filter identifier), version (feature version)\n-- Obtain OIDs via a subquery from the object table and avoid JOINs per guidelines\nWITH sel_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF18abqyaix'\n)\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM sel_oids)\nORDER BY\n    f.oid,        -- ZTF identifier\n    f.fid,        -- filter identifier\n    f.version;    -- feature version"
                },
                "in_toks": 4865,
                "out_toks": 1329,
                "id": "chatcmpl-CSsyS1LRKPm7Eee8eAN96qkDHsKPS",
                "created": 1761000540,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "48",
            "experiment_id": "run_4",
            "pred_tables": [
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 1104,
                "id": "chatcmpl-CSsv8UJPIGVZEnZgNvInQeM7JXtWw",
                "created": 1761000334,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for the specified ZTF object, returning the requested columns\nSELECT\n    oid,            -- ZTF identifier\n    name,           -- feature name\n    value,          -- feature value\n    fid,            -- filter identifier\n    version         -- feature version\nFROM feature\nWHERE oid = 'ZTF18abqyaix'\nORDER BY oid, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for the specified ZTF object, returning the requested columns\nSELECT\n    oid,            -- ZTF identifier\n    name,           -- feature name\n    value,          -- feature value\n    fid,            -- filter identifier\n    version         -- feature version\nFROM feature\nWHERE oid = 'ZTF18abqyaix'\nORDER BY oid, fid, version;"
                },
                "in_toks": 4383,
                "out_toks": 1114,
                "id": "chatcmpl-CSsyg0m7i9GEa2yUASqWY3UXyr0Uj",
                "created": 1761000554,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "48",
            "experiment_id": "run_5",
            "pred_tables": [
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 912,
                "id": "chatcmpl-CZNRc3yHVxEwsnCqZsUPwcbk7i1Fi",
                "created": 1762547636,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for the ZTF object 'ZTF18abqyaix'\n-- Columns returned: oid (ZTF identifier), name (feature name), value (feature value), fid (filter identifier), version (feature version)\n-- Sorted by ZTF identifier (oid), filter identifier (fid), and feature version (version)\nSELECT\n    oid,\n    name,\n    value,\n    fid,\n    version\nFROM feature\nWHERE oid IN (\n    -- Obtain the OID in a subquery as per optimization guideline\n    SELECT oid\n    FROM feature\n    WHERE oid = 'ZTF18abqyaix'\n)\nORDER BY oid, fid, version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for the ZTF object 'ZTF18abqyaix'\n-- Columns returned: oid (ZTF identifier), name (feature name), value (feature value), fid (filter identifier), version (feature version)\n-- Sorted by ZTF identifier (oid), filter identifier (fid), and feature version (version)\nSELECT\n    oid,\n    name,\n    value,\n    fid,\n    version\nFROM feature\nWHERE oid IN (\n    -- Obtain the OID in a subquery as per optimization guideline\n    SELECT oid\n    FROM feature\n    WHERE oid = 'ZTF18abqyaix'\n)\nORDER BY oid, fid, version;"
                },
                "in_toks": 4383,
                "out_toks": 1362,
                "id": "chatcmpl-CZRAYIDvhptyHfAuUyQjRXZiR6tmm",
                "created": 1762561954,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "48",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 531,
                "id": "chatcmpl-CZNSV2DcIVwjdnRNeIzPC87xp9u0q",
                "created": 1762547691,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for the specified ZTF object, using a nested subquery to obtain the OID\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,\n    f.fid,\n    f.version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for the specified ZTF object, using a nested subquery to obtain the OID\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,\n    f.fid,\n    f.version;"
                },
                "in_toks": 4865,
                "out_toks": 1133,
                "id": "chatcmpl-CZRAZSOP0L0fijw2UQ5ggQrlWNUwW",
                "created": 1762561955,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "48",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 467,
                "id": "chatcmpl-CZNSkYkQ6QRPnxKQAu43mKTAzbGdV",
                "created": 1762547706,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for the specified ZTF object, ordered by ZTF identifier, filter identifier, and feature version\nSELECT\n    f.oid,     -- ZTF identifier\n    f.name,    -- feature name\n    f.value,   -- feature value\n    f.fid,     -- filter identifier (1=g, 2=r, 3=i, 12=gr, 13=gi, 23=ri, 123=gri)\n    f.version  -- feature version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY f.oid, f.fid, f.version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for the specified ZTF object, ordered by ZTF identifier, filter identifier, and feature version\nSELECT\n    f.oid,     -- ZTF identifier\n    f.name,    -- feature name\n    f.value,   -- feature value\n    f.fid,     -- filter identifier (1=g, 2=r, 3=i, 12=gr, 13=gi, 23=ri, 123=gri)\n    f.version  -- feature version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY f.oid, f.fid, f.version;"
                },
                "in_toks": 4865,
                "out_toks": 995,
                "id": "chatcmpl-CZRBpwktdLFzurri7XvKpQCCDMKsQ",
                "created": 1762562033,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "48",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 467,
                "id": "chatcmpl-CZNT2MGTLxzkBW8Yu7Q6WsdtR36pF",
                "created": 1762547724,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for a specific ZTF object, returning requested columns\nSELECT\n    f.oid,         -- ZTF identifier\n    f.name,        -- feature name\n    f.value,       -- feature value\n    f.fid,         -- filter identifier\n    f.version      -- feature version\nFROM feature f\nWHERE f.oid IN (\n    -- Obtain the OID from the object table (nested subquery as per guidelines)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,         -- sort by ZTF identifier\n    f.fid,         -- then by filter identifier\n    f.version;     -- then by feature version",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for a specific ZTF object, returning requested columns\nSELECT\n    f.oid,         -- ZTF identifier\n    f.name,        -- feature name\n    f.value,       -- feature value\n    f.fid,         -- filter identifier\n    f.version      -- feature version\nFROM feature f\nWHERE f.oid IN (\n    -- Obtain the OID from the object table (nested subquery as per guidelines)\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,         -- sort by ZTF identifier\n    f.fid,         -- then by filter identifier\n    f.version;     -- then by feature version"
                },
                "in_toks": 4865,
                "out_toks": 742,
                "id": "chatcmpl-CZRBsM10NCErVXKGs3ajl7yRrYPMr",
                "created": 1762562036,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "48",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 632,
                "out_toks": 275,
                "id": "chatcmpl-CZNTHLCm8HsCvYZNkUrjfrARqQEnO",
                "created": 1762547739,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get all features for the specified ZTF object, returning the requested columns\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,\n    f.fid,\n    f.version;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get all features for the specified ZTF object, returning the requested columns\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM feature f\nWHERE f.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid = 'ZTF18abqyaix'\n)\nORDER BY\n    f.oid,\n    f.fid,\n    f.version;"
                },
                "in_toks": 4865,
                "out_toks": 871,
                "id": "chatcmpl-CZRBxAbFXsyi88UnsAdwnYLEYAmLG",
                "created": 1762562041,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "58": {
        "0": {
            "req_id": "58",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']",
                    "1": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 1504,
                "id": "chatcmpl-CSncao6dsm7TwOTLwsVybJz6Gnsxz",
                "created": 1760979964,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized approach:\n-- 1) Pre-filter objects by ndet and deltajd to reduce the detection scan.\n-- 2) Compute min corrected magnitudes per band (g=1, r=2) only for those oids.\n-- 3) Keep objects where the absolute difference between g_min_corr and r_min_corr > 3.5.\n-- 4) Return at most 20 full rows from the object table.\n WITH obj_filt AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20)\nSELECT obj.*\nFROM obj_filt OF\nJOIN OBJECT obj USING (oid)\nJOIN\n  (SELECT d.oid,\n          MIN(CASE\n                  WHEN d.fid = 1\n                       AND d.corrected THEN d.magpsf_corr\n              END) AS g_min_corr,\n          MIN(CASE\n                  WHEN d.fid = 2\n                       AND d.corrected THEN d.magpsf_corr\n              END) AS r_min_corr\n   FROM detection d\n   JOIN obj_filt o ON o.oid = d.oid -- restrict detections to the pre-filtered oids\n\n   GROUP BY d.oid) m USING (oid)\nWHERE m.g_min_corr IS NOT NULL\n  AND m.r_min_corr IS NOT NULL\n  AND ABS(m.g_min_corr - m.r_min_corr) > 3.5\nLIMIT 20;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized approach:\n-- 1) Pre-filter objects by ndet and deltajd to reduce the detection scan.\n-- 2) Compute min corrected magnitudes per band (g=1, r=2) only for those oids.\n-- 3) Keep objects where the absolute difference between g_min_corr and r_min_corr > 3.5.\n-- 4) Return at most 20 full rows from the object table.\n WITH obj_filt AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20)\nSELECT obj.*\nFROM obj_filt OF\nJOIN OBJECT obj USING (oid)\nJOIN\n  (SELECT d.oid,\n          MIN(CASE\n                  WHEN d.fid = 1\n                       AND d.corrected THEN d.magpsf_corr\n              END) AS g_min_corr,\n          MIN(CASE\n                  WHEN d.fid = 2\n                       AND d.corrected THEN d.magpsf_corr\n              END) AS r_min_corr\n   FROM detection d\n   JOIN obj_filt o ON o.oid = d.oid -- restrict detections to the pre-filtered oids\n\n   GROUP BY d.oid) m USING (oid)\nWHERE m.g_min_corr IS NOT NULL\n  AND m.r_min_corr IS NOT NULL\n  AND ABS(m.g_min_corr - m.r_min_corr) > 3.5\nLIMIT 20;"
                },
                "in_toks": 2058,
                "out_toks": 3755,
                "id": "chatcmpl-CbAAnS8nUkhomNxH1dG1Xdh9Zhbfo",
                "created": 1762973277,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return at most 20 objects meeting:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - absolute difference between minimum corrected g- and r-band magnitudes > 3.5\n--   (If a directional difference is desired instead of absolute, replace ABS(g_min_corr - r_min_corr) > 3.5 with (g_min_corr - r_min_corr) > 3.5)\nSELECT *\nFROM object\nWHERE ndet >= 30\n  AND deltajd > 20\n  AND oid IN (\n    SELECT oid\n    FROM (\n      SELECT d.oid,\n             MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS g_min_corr, -- g-band minimum corrected magnitude\n             MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS r_min_corr  -- r-band minimum corrected magnitude\n      FROM detection d\n      GROUP BY d.oid\n    ) m\n    WHERE m.g_min_corr IS NOT NULL\n      AND m.r_min_corr IS NOT NULL\n      AND ABS(m.g_min_corr - m.r_min_corr) > 3.5\n  )\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return at most 20 objects meeting:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - absolute difference between minimum corrected g- and r-band magnitudes > 3.5\n--   (If a directional difference is desired instead of absolute, replace ABS(g_min_corr - r_min_corr) > 3.5 with (g_min_corr - r_min_corr) > 3.5)\nSELECT *\nFROM object\nWHERE ndet >= 30\n  AND deltajd > 20\n  AND oid IN (\n    SELECT oid\n    FROM (\n      SELECT d.oid,\n             MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS g_min_corr, -- g-band minimum corrected magnitude\n             MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS r_min_corr  -- r-band minimum corrected magnitude\n      FROM detection d\n      GROUP BY d.oid\n    ) m\n    WHERE m.g_min_corr IS NOT NULL\n      AND m.r_min_corr IS NOT NULL\n      AND ABS(m.g_min_corr - m.r_min_corr) > 3.5\n  )\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 3462,
                "id": "chatcmpl-CSoKdIM1umXRpL5yhQJkCHK5DwsYC",
                "created": 1760982695,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "58",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']",
                    "1": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 1504,
                "id": "chatcmpl-CSncao6dsm7TwOTLwsVybJz6Gnsxz",
                "created": 1760979964,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Return up to 20 objects meeting:\n-- - at least 30 detections (object.ndet >= 30)\n-- - time span between first and last detection > 20 days (object.deltajd > 20)\n-- - absolute difference between minimum corrected g and r magnitudes > 3.5\n-- Optimizations:\n--   1) Restrict detection aggregation to candidate oids first (JOIN on objcand).\n--   2) Compute per-band minima in separate grouped subqueries.\n--   3) Limit to 20 eligible oids before fetching all object columns.\nWITH objcand AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     min_g AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) AS min_g_corr\n   FROM detection d\n   JOIN objcand oc ON oc.oid = d.oid\n   WHERE d.fid = 1\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     min_r AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) AS min_r_corr\n   FROM detection d\n   JOIN objcand oc ON oc.oid = d.oid\n   WHERE d.fid = 2\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     eligible AS\n  (SELECT g.oid\n   FROM min_g g\n   JOIN min_r r ON r.oid = g.oid\n   WHERE ABS(g.min_g_corr - r.min_r_corr) > 3.5\n   LIMIT 20)\nSELECT o.*\nFROM OBJECT o\nJOIN eligible e ON e.oid = o.oid;",
            "sql_response": {
                "responses": {
                    "0": "-- Return up to 20 objects meeting:\n-- - at least 30 detections (object.ndet >= 30)\n-- - time span between first and last detection > 20 days (object.deltajd > 20)\n-- - absolute difference between minimum corrected g and r magnitudes > 3.5\n-- Optimizations:\n--   1) Restrict detection aggregation to candidate oids first (JOIN on objcand).\n--   2) Compute per-band minima in separate grouped subqueries.\n--   3) Limit to 20 eligible oids before fetching all object columns.\nWITH objcand AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     min_g AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) AS min_g_corr\n   FROM detection d\n   JOIN objcand oc ON oc.oid = d.oid\n   WHERE d.fid = 1\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     min_r AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) AS min_r_corr\n   FROM detection d\n   JOIN objcand oc ON oc.oid = d.oid\n   WHERE d.fid = 2\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     eligible AS\n  (SELECT g.oid\n   FROM min_g g\n   JOIN min_r r ON r.oid = g.oid\n   WHERE ABS(g.min_g_corr - r.min_r_corr) > 3.5\n   LIMIT 20)\nSELECT o.*\nFROM OBJECT o\nJOIN eligible e ON e.oid = o.oid;"
                },
                "in_toks": 2112,
                "out_toks": 3318,
                "id": "chatcmpl-CbABhXtnYoMRTXfXvJDOxQGpfQm3q",
                "created": 1762973333,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get at most 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - absolute difference between minimum g- and r-band corrected magnitudes > 3.5\n--   Note: we use ABS(min_g_corr - min_r_corr) since the request does not specify sign.\nWITH objcand AS (\n  SELECT oid\n  FROM object\n  WHERE ndet >= 30\n    AND deltajd > 20\n),\nband_mins AS (\n  SELECT d.oid,\n         MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS min_g_corr, -- g-band\n         MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS min_r_corr  -- r-band\n  FROM detection d\n  WHERE d.oid IN (SELECT oid FROM objcand)\n    AND d.magpsf_corr IS NOT NULL\n  GROUP BY d.oid\n),\noid_selected AS (\n  SELECT oid\n  FROM band_mins\n  WHERE min_g_corr IS NOT NULL\n    AND min_r_corr IS NOT NULL\n    AND ABS(min_g_corr - min_r_corr) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM oid_selected)\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get at most 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - absolute difference between minimum g- and r-band corrected magnitudes > 3.5\n--   Note: we use ABS(min_g_corr - min_r_corr) since the request does not specify sign.\nWITH objcand AS (\n  SELECT oid\n  FROM object\n  WHERE ndet >= 30\n    AND deltajd > 20\n),\nband_mins AS (\n  SELECT d.oid,\n         MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS min_g_corr, -- g-band\n         MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS min_r_corr  -- r-band\n  FROM detection d\n  WHERE d.oid IN (SELECT oid FROM objcand)\n    AND d.magpsf_corr IS NOT NULL\n  GROUP BY d.oid\n),\noid_selected AS (\n  SELECT oid\n  FROM band_mins\n  WHERE min_g_corr IS NOT NULL\n    AND min_r_corr IS NOT NULL\n    AND ABS(min_g_corr - min_r_corr) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM oid_selected)\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 2075,
                "id": "chatcmpl-CSoLB0rvTLgD9MJnMloFVG80EKr1C",
                "created": 1760982729,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "58",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 528,
                "id": "chatcmpl-CSsvNMyw5RUwUSdKBgmOsMeYz4Ob9",
                "created": 1761000349,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query: prefilter objects in \"object\", then aggregate only detections for those oids and compute min corrected g/r magnitudes\nWITH candidate_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.ndet >= 30 -- at least 30 detections\n\n     AND o.deltajd > 20 -- time span > 20 days\n),\n     min_mags AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1) AS g_min_corr, -- g-band (fid=1)\n MIN(d.magpsf_corr) FILTER (\n                            WHERE d.fid = 2) AS r_min_corr -- r-band (fid=2)\n\n   FROM detection d\n   JOIN candidate_oids c ON c.oid = d.oid\n   WHERE d.corrected = TRUE -- use corrected magnitudes\n\n     AND d.fid IN (1,\n                   2)-- only g and r bands\n\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     magdiff_oids AS\n  (SELECT m.oid\n   FROM min_mags m\n   WHERE m.g_min_corr IS NOT NULL\n     AND m.r_min_corr IS NOT NULL\n     AND ABS(m.g_min_corr - m.r_min_corr) > 3.5 -- difference between minima > 3.5\n)\nSELECT o.*\nFROM OBJECT o\nJOIN magdiff_oids md ON md.oid = o.oid\nLIMIT 20;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query: prefilter objects in \"object\", then aggregate only detections for those oids and compute min corrected g/r magnitudes\nWITH candidate_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.ndet >= 30 -- at least 30 detections\n\n     AND o.deltajd > 20 -- time span > 20 days\n),\n     min_mags AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1) AS g_min_corr, -- g-band (fid=1)\n MIN(d.magpsf_corr) FILTER (\n                            WHERE d.fid = 2) AS r_min_corr -- r-band (fid=2)\n\n   FROM detection d\n   JOIN candidate_oids c ON c.oid = d.oid\n   WHERE d.corrected = TRUE -- use corrected magnitudes\n\n     AND d.fid IN (1,\n                   2)-- only g and r bands\n\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     magdiff_oids AS\n  (SELECT m.oid\n   FROM min_mags m\n   WHERE m.g_min_corr IS NOT NULL\n     AND m.r_min_corr IS NOT NULL\n     AND ABS(m.g_min_corr - m.r_min_corr) > 3.5 -- difference between minima > 3.5\n)\nSELECT o.*\nFROM OBJECT o\nJOIN magdiff_oids md ON md.oid = o.oid\nLIMIT 20;"
                },
                "in_toks": 2180,
                "out_toks": 2062,
                "id": "chatcmpl-CbACwrwcoei0kXtWOt8y9M8UJUUAR",
                "created": 1762973410,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get up to 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - absolute difference between the minimum corrected g- and r-band magnitudes > 3.5\nWITH candidate_oids AS (\n  SELECT o.oid\n  FROM object o\n  WHERE o.ndet >= 30\n    AND o.deltajd > 20\n),\nmagdiff_oids AS (\n  SELECT d.oid\n  FROM detection d\n  WHERE d.oid IN (SELECT oid FROM candidate_oids)\n  GROUP BY d.oid\n  HAVING\n    -- minimum corrected g-band magnitude (fid=1) exists\n    MIN(CASE WHEN d.fid = 1 AND d.corrected THEN d.magpsf_corr END) IS NOT NULL\n    -- minimum corrected r-band magnitude (fid=2) exists\n    AND MIN(CASE WHEN d.fid = 2 AND d.corrected THEN d.magpsf_corr END) IS NOT NULL\n    -- absolute difference between the minima > 3.5\n    AND ABS(\n      MIN(CASE WHEN d.fid = 1 AND d.corrected THEN d.magpsf_corr END) -\n      MIN(CASE WHEN d.fid = 2 AND d.corrected THEN d.magpsf_corr END)\n    ) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM magdiff_oids)\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get up to 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - absolute difference between the minimum corrected g- and r-band magnitudes > 3.5\nWITH candidate_oids AS (\n  SELECT o.oid\n  FROM object o\n  WHERE o.ndet >= 30\n    AND o.deltajd > 20\n),\nmagdiff_oids AS (\n  SELECT d.oid\n  FROM detection d\n  WHERE d.oid IN (SELECT oid FROM candidate_oids)\n  GROUP BY d.oid\n  HAVING\n    -- minimum corrected g-band magnitude (fid=1) exists\n    MIN(CASE WHEN d.fid = 1 AND d.corrected THEN d.magpsf_corr END) IS NOT NULL\n    -- minimum corrected r-band magnitude (fid=2) exists\n    AND MIN(CASE WHEN d.fid = 2 AND d.corrected THEN d.magpsf_corr END) IS NOT NULL\n    -- absolute difference between the minima > 3.5\n    AND ABS(\n      MIN(CASE WHEN d.fid = 1 AND d.corrected THEN d.magpsf_corr END) -\n      MIN(CASE WHEN d.fid = 2 AND d.corrected THEN d.magpsf_corr END)\n    ) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM magdiff_oids)\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 2042,
                "id": "chatcmpl-CSsyt6eJE2OJLeAKiPzl7MKYymLb2",
                "created": 1761000567,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "58",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 784,
                "id": "chatcmpl-CSsvUkyZwtCIapjW1rVfeSqVxuzQO",
                "created": 1761000356,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized: filter objects first, then compute per-oid band minima via a lateral subquery\n-- Returns at most 20 objects from 'object' with:\n--  - ndet >= 30\n--  - deltajd > 20\n--  - |min(corrected g) - min(corrected r)| > 3.5\n-- Notes: fid=1 (g), fid=2 (r)\n\nSELECT o.*\nFROM OBJECT o\nJOIN LATERAL\n  (SELECT MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1\n                                       AND d.corrected = TRUE) AS min_g_corr,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 2\n                                       AND d.corrected = TRUE) AS min_r_corr\n   FROM detection d\n   WHERE d.oid = o.oid -- only filter detection by oid\n) bm ON TRUE\nWHERE o.ndet >= 30\n  AND o.deltajd > 20\n  AND bm.min_g_corr IS NOT NULL\n  AND bm.min_r_corr IS NOT NULL\n  AND ABS(bm.min_g_corr - bm.min_r_corr) > 3.5\nORDER BY o.oid\nLIMIT 20;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized: filter objects first, then compute per-oid band minima via a lateral subquery\n-- Returns at most 20 objects from 'object' with:\n--  - ndet >= 30\n--  - deltajd > 20\n--  - |min(corrected g) - min(corrected r)| > 3.5\n-- Notes: fid=1 (g), fid=2 (r)\n\nSELECT o.*\nFROM OBJECT o\nJOIN LATERAL\n  (SELECT MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1\n                                       AND d.corrected = TRUE) AS min_g_corr,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 2\n                                       AND d.corrected = TRUE) AS min_r_corr\n   FROM detection d\n   WHERE d.oid = o.oid -- only filter detection by oid\n) bm ON TRUE\nWHERE o.ndet >= 30\n  AND o.deltajd > 20\n  AND bm.min_g_corr IS NOT NULL\n  AND bm.min_r_corr IS NOT NULL\n  AND ABS(bm.min_g_corr - bm.min_r_corr) > 3.5\nORDER BY o.oid\nLIMIT 20;"
                },
                "in_toks": 2195,
                "out_toks": 2443,
                "id": "chatcmpl-CbADpoDoildRDp4jUHYRLsA0wLJ9i",
                "created": 1762973465,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Get at most 20 objects with:\n   - ndet >= 30\n   - deltajd > 20 days\n   - absolute difference between minimum corrected g and r magnitudes > 3.5\n   Notes:\n   - ZTF filters: fid=1 (g), fid=2 (r)\n   - Using ABS(min_g_corr - min_r_corr) to interpret \"difference\"; if you intend (min_g_corr - min_r_corr) strictly, remove ABS().\n*/\nWITH eligible_oids AS (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND deltajd > 20\n),\nband_mins AS (\n    SELECT\n        d.oid,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1 AND d.corrected = TRUE) AS min_g_corr,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2 AND d.corrected = TRUE) AS min_r_corr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM eligible_oids)  -- only filter detection by oid, per guidance\n    GROUP BY d.oid\n),\nqualifying_oids AS (\n    SELECT oid\n    FROM band_mins\n    WHERE min_g_corr IS NOT NULL\n      AND min_r_corr IS NOT NULL\n      AND ABS(min_g_corr - min_r_corr) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM qualifying_oids)\nORDER BY oid\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Get at most 20 objects with:\n   - ndet >= 30\n   - deltajd > 20 days\n   - absolute difference between minimum corrected g and r magnitudes > 3.5\n   Notes:\n   - ZTF filters: fid=1 (g), fid=2 (r)\n   - Using ABS(min_g_corr - min_r_corr) to interpret \"difference\"; if you intend (min_g_corr - min_r_corr) strictly, remove ABS().\n*/\nWITH eligible_oids AS (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND deltajd > 20\n),\nband_mins AS (\n    SELECT\n        d.oid,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1 AND d.corrected = TRUE) AS min_g_corr,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2 AND d.corrected = TRUE) AS min_r_corr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM eligible_oids)  -- only filter detection by oid, per guidance\n    GROUP BY d.oid\n),\nqualifying_oids AS (\n    SELECT oid\n    FROM band_mins\n    WHERE min_g_corr IS NOT NULL\n      AND min_r_corr IS NOT NULL\n      AND ABS(min_g_corr - min_r_corr) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM qualifying_oids)\nORDER BY oid\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 2376,
                "id": "chatcmpl-CSszD5CUtUeD4M5rOyqyy37zQQG3E",
                "created": 1761000587,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "58",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 464,
                "id": "chatcmpl-CSsvilKjVbS7caO236HAQBwMcdvRq",
                "created": 1761000370,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Optimized query:\n   - Pre-filter objects by ndet and deltajd.\n   - Aggregate detections only for those objects, restricted to corrected mags and bands g/r.\n   - Use FILTER to compute per-band minima and HAVING to keep only qualifying OIDs.\n   - Join back to object and limit to 20 rows.\n*/ WITH seed_oids AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n        band_min AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1) AS min_g_corr,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 2) AS min_r_corr\n   FROM detection d\n   JOIN seed_oids s ON s.oid = d.oid\n   WHERE d.corrected = TRUE\n     AND d.fid IN (1,\n                   2)\n   GROUP BY d.oid\n   HAVING MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1) IS NOT NULL\n   AND MIN(d.magpsf_corr) FILTER (\n                                  WHERE d.fid = 2) IS NOT NULL\n   AND ABS(MIN(d.magpsf_corr) FILTER (\n                                      WHERE d.fid = 1) - MIN(d.magpsf_corr) FILTER (\n                                                                                    WHERE d.fid = 2)) > 3.5)\nSELECT o.*\nFROM OBJECT o\nJOIN band_min bm ON bm.oid = o.oid\nLIMIT 20;",
            "sql_response": {
                "responses": {
                    "0": "/* Optimized query:\n   - Pre-filter objects by ndet and deltajd.\n   - Aggregate detections only for those objects, restricted to corrected mags and bands g/r.\n   - Use FILTER to compute per-band minima and HAVING to keep only qualifying OIDs.\n   - Join back to object and limit to 20 rows.\n*/ WITH seed_oids AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n        band_min AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1) AS min_g_corr,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 2) AS min_r_corr\n   FROM detection d\n   JOIN seed_oids s ON s.oid = d.oid\n   WHERE d.corrected = TRUE\n     AND d.fid IN (1,\n                   2)\n   GROUP BY d.oid\n   HAVING MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1) IS NOT NULL\n   AND MIN(d.magpsf_corr) FILTER (\n                                  WHERE d.fid = 2) IS NOT NULL\n   AND ABS(MIN(d.magpsf_corr) FILTER (\n                                      WHERE d.fid = 1) - MIN(d.magpsf_corr) FILTER (\n                                                                                    WHERE d.fid = 2)) > 3.5)\nSELECT o.*\nFROM OBJECT o\nJOIN band_min bm ON bm.oid = o.oid\nLIMIT 20;"
                },
                "in_toks": 2104,
                "out_toks": 2640,
                "id": "chatcmpl-CbAF9hMJNqdBchN80DckROish7mJw",
                "created": 1762973547,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Get at most 20 objects with:\n   - ndet >= 30\n   - deltajd > 20 (difference between last and first detection times)\n   - absolute difference between minimum corrected magnitudes in g (fid=1) and r (fid=2) > 3.5\n   Note: \"difference\" is interpreted as absolute(min_g_corr - min_r_corr).\n*/\nWITH seed_oids AS (\n  SELECT oid\n  FROM object\n  WHERE ndet >= 30\n    AND deltajd > 20\n),\nband_min AS (\n  SELECT d.oid,\n         MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS min_g_corr,\n         MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS min_r_corr\n  FROM detection d\n  WHERE d.oid IN (SELECT oid FROM seed_oids)\n  GROUP BY d.oid\n),\nqualified_oids AS (\n  SELECT oid\n  FROM band_min\n  WHERE min_g_corr IS NOT NULL\n    AND min_r_corr IS NOT NULL\n    AND ABS(min_g_corr - min_r_corr) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM qualified_oids)\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Get at most 20 objects with:\n   - ndet >= 30\n   - deltajd > 20 (difference between last and first detection times)\n   - absolute difference between minimum corrected magnitudes in g (fid=1) and r (fid=2) > 3.5\n   Note: \"difference\" is interpreted as absolute(min_g_corr - min_r_corr).\n*/\nWITH seed_oids AS (\n  SELECT oid\n  FROM object\n  WHERE ndet >= 30\n    AND deltajd > 20\n),\nband_min AS (\n  SELECT d.oid,\n         MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS min_g_corr,\n         MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS min_r_corr\n  FROM detection d\n  WHERE d.oid IN (SELECT oid FROM seed_oids)\n  GROUP BY d.oid\n),\nqualified_oids AS (\n  SELECT oid\n  FROM band_min\n  WHERE min_g_corr IS NOT NULL\n    AND min_r_corr IS NOT NULL\n    AND ABS(min_g_corr - min_r_corr) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM qualified_oids)\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 2327,
                "id": "chatcmpl-CSszbwJHpEGC4Sb0C14j6z8wzPYAe",
                "created": 1761000611,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "58",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 336,
                "id": "chatcmpl-CZNTQ35s8eRyMlWBOycsWMstiZDTs",
                "created": 1762547748,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query using prefiltered OIDs and per-band minima to avoid scanning all detections\nWITH base AS\n  (-- Objects with at least 30 detections and time span > 20 days\n SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     gmin AS\n  (-- Minimum corrected g-band magnitude per object\n SELECT d.oid,\n        MIN(d.magpsf_corr) AS min_g\n   FROM detection d\n   JOIN base b ON b.oid = d.oid\n   WHERE d.fid = 1\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     rmin AS\n  (-- Minimum corrected r-band magnitude per object\n SELECT d.oid,\n        MIN(d.magpsf_corr) AS min_r\n   FROM detection d\n   JOIN base b ON b.oid = d.oid\n   WHERE d.fid = 2\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     good AS\n  (-- Objects where the absolute difference between min g and min r > 3.5\n SELECT g.oid\n   FROM gmin g\n   JOIN rmin r ON r.oid = g.oid\n   WHERE ABS(g.min_g - r.min_r) > 3.5)\nSELECT o.*\nFROM OBJECT o\nJOIN good g ON g.oid = o.oid\nLIMIT 20;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query using prefiltered OIDs and per-band minima to avoid scanning all detections\nWITH base AS\n  (-- Objects with at least 30 detections and time span > 20 days\n SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     gmin AS\n  (-- Minimum corrected g-band magnitude per object\n SELECT d.oid,\n        MIN(d.magpsf_corr) AS min_g\n   FROM detection d\n   JOIN base b ON b.oid = d.oid\n   WHERE d.fid = 1\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     rmin AS\n  (-- Minimum corrected r-band magnitude per object\n SELECT d.oid,\n        MIN(d.magpsf_corr) AS min_r\n   FROM detection d\n   JOIN base b ON b.oid = d.oid\n   WHERE d.fid = 2\n     AND d.magpsf_corr IS NOT NULL\n   GROUP BY d.oid),\n     good AS\n  (-- Objects where the absolute difference between min g and min r > 3.5\n SELECT g.oid\n   FROM gmin g\n   JOIN rmin r ON r.oid = g.oid\n   WHERE ABS(g.min_g - r.min_r) > 3.5)\nSELECT o.*\nFROM OBJECT o\nJOIN good g ON g.oid = o.oid\nLIMIT 20;"
                },
                "in_toks": 2105,
                "out_toks": 2048,
                "id": "chatcmpl-CbAGRq3Kw4u8V2Se4SA24rnwh34nH",
                "created": 1762973627,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get up to 20 objects with:\n-- - at least 30 detections (object.ndet >= 30)\n-- - time span between first and last detection > 20 days (object.deltajd > 20)\n-- - absolute difference between minimum corrected g and r magnitudes > 3.5\n--   (Assumption: use ABS(min_g - min_r) > 3.5; change if a signed difference is desired.)\nWITH base_oids AS (\n  SELECT oid\n  FROM object\n  WHERE ndet >= 30\n    AND deltajd > 20\n), good_color_oids AS (\n  SELECT oid\n  FROM detection\n  WHERE oid IN (SELECT oid FROM base_oids)\n  GROUP BY oid\n  HAVING\n    MIN(CASE WHEN fid = 1 THEN magpsf_corr END) IS NOT NULL\n    AND MIN(CASE WHEN fid = 2 THEN magpsf_corr END) IS NOT NULL\n    AND ABS(\n      MIN(CASE WHEN fid = 1 THEN magpsf_corr END)\n      - MIN(CASE WHEN fid = 2 THEN magpsf_corr END)\n    ) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM good_color_oids)\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get up to 20 objects with:\n-- - at least 30 detections (object.ndet >= 30)\n-- - time span between first and last detection > 20 days (object.deltajd > 20)\n-- - absolute difference between minimum corrected g and r magnitudes > 3.5\n--   (Assumption: use ABS(min_g - min_r) > 3.5; change if a signed difference is desired.)\nWITH base_oids AS (\n  SELECT oid\n  FROM object\n  WHERE ndet >= 30\n    AND deltajd > 20\n), good_color_oids AS (\n  SELECT oid\n  FROM detection\n  WHERE oid IN (SELECT oid FROM base_oids)\n  GROUP BY oid\n  HAVING\n    MIN(CASE WHEN fid = 1 THEN magpsf_corr END) IS NOT NULL\n    AND MIN(CASE WHEN fid = 2 THEN magpsf_corr END) IS NOT NULL\n    AND ABS(\n      MIN(CASE WHEN fid = 1 THEN magpsf_corr END)\n      - MIN(CASE WHEN fid = 2 THEN magpsf_corr END)\n    ) > 3.5\n)\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM good_color_oids)\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 1814,
                "id": "chatcmpl-CZRC4I4CqSSYF7WueerR0PqdrzGXZ",
                "created": 1762562048,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "58",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 336,
                "id": "chatcmpl-CZNTYWnVzdhXD4QEswYHvt9LfM218",
                "created": 1762547756,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query using a lateral aggregate on detections per object\n-- Conditions:\n-- - at least 30 detections (object.ndet >= 30)\n-- - time span between first and last detection > 20 days (object.deltajd > 20)\n-- - absolute difference between minimum corrected g- and r-band magnitudes > 3.5\n--   computed from detection.magpsf_corr with fid=1 (g) and fid=2 (r), only for corrected detections\n\nSELECT o.*\nFROM OBJECT o\nJOIN LATERAL\n  (SELECT MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1\n                                       AND d.corrected) AS min_g_corr,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 2\n                                       AND d.corrected) AS min_r_corr\n   FROM detection d\n   WHERE d.oid = o.oid -- only scan detections for this object (uses index on detection.oid)\n) m ON TRUE\nWHERE o.ndet >= 30\n  AND o.deltajd > 20\n  AND m.min_g_corr IS NOT NULL\n  AND m.min_r_corr IS NOT NULL\n  AND ABS(m.min_g_corr - m.min_r_corr) > 3.5\nLIMIT 20;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query using a lateral aggregate on detections per object\n-- Conditions:\n-- - at least 30 detections (object.ndet >= 30)\n-- - time span between first and last detection > 20 days (object.deltajd > 20)\n-- - absolute difference between minimum corrected g- and r-band magnitudes > 3.5\n--   computed from detection.magpsf_corr with fid=1 (g) and fid=2 (r), only for corrected detections\n\nSELECT o.*\nFROM OBJECT o\nJOIN LATERAL\n  (SELECT MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 1\n                                       AND d.corrected) AS min_g_corr,\n          MIN(d.magpsf_corr) FILTER (\n                                     WHERE d.fid = 2\n                                       AND d.corrected) AS min_r_corr\n   FROM detection d\n   WHERE d.oid = o.oid -- only scan detections for this object (uses index on detection.oid)\n) m ON TRUE\nWHERE o.ndet >= 30\n  AND o.deltajd > 20\n  AND m.min_g_corr IS NOT NULL\n  AND m.min_r_corr IS NOT NULL\n  AND ABS(m.min_g_corr - m.min_r_corr) > 3.5\nLIMIT 20;"
                },
                "in_toks": 2012,
                "out_toks": 2009,
                "id": "chatcmpl-CbAHGaIcEdXDtX56pJH4tovwhcWVi",
                "created": 1762973678,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get at most 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - absolute difference between minimum corrected g- and r-band magnitudes > 3.5\nWITH candidate_oids AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     color_oids AS\n  (SELECT d.oid\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM candidate_oids)\n   GROUP BY d.oid\n   HAVING abs(MIN(CASE\n                      WHEN d.fid = 1\n                           AND d.corrected THEN d.magpsf_corr\n                  END) -- g-band min corrected mag\n - MIN(CASE\n           WHEN d.fid = 2\n                AND d.corrected THEN d.magpsf_corr\n       END) -- r-band min corrected mag\n) > 3.5)\nSELECT *\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM color_oids)\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get at most 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days\n-- - absolute difference between minimum corrected g- and r-band magnitudes > 3.5\nWITH candidate_oids AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     color_oids AS\n  (SELECT d.oid\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM candidate_oids)\n   GROUP BY d.oid\n   HAVING abs(MIN(CASE\n                      WHEN d.fid = 1\n                           AND d.corrected THEN d.magpsf_corr\n                  END) -- g-band min corrected mag\n - MIN(CASE\n           WHEN d.fid = 2\n                AND d.corrected THEN d.magpsf_corr\n       END) -- r-band min corrected mag\n) > 3.5)\nSELECT *\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM color_oids)\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 2017,
                "id": "chatcmpl-Caypuscmsxfu1Vs86sYRvGw0Eu6w2",
                "created": 1762929698,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "58",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 400,
                "id": "chatcmpl-CZNTiWmXIrCx0Aons5PMUhDokYE2g",
                "created": 1762547766,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query using pre-filtered objects and band-wise aggregation on detections\nWITH candidate_objects AS\n  (-- Objects meeting detection count and time span constraints\n SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     band_mins AS\n  (-- Compute minimum corrected magnitudes per band only for candidate objects\n SELECT d.oid,\n        MIN(d.magpsf_corr) FILTER (\n                                   WHERE d.fid = 1\n                                     AND d.magpsf_corr IS NOT NULL\n                                     AND d.corrected) AS min_g_corr,\n        MIN(d.magpsf_corr) FILTER (\n                                   WHERE d.fid = 2\n                                     AND d.magpsf_corr IS NOT NULL\n                                     AND d.corrected) AS min_r_corr\n   FROM detection d\n   JOIN candidate_objects co ON co.oid = d.oid\n   GROUP BY d.oid),\n     qualified AS\n  (-- Keep only objects where the absolute difference between min g and r corrected magnitudes is > 3.5\n SELECT bm.oid\n   FROM band_mins bm\n   WHERE bm.min_g_corr IS NOT NULL\n     AND bm.min_r_corr IS NOT NULL\n     AND ABS(bm.min_g_corr - bm.min_r_corr) > 3.5) -- Return all columns from the object table for up to 20 qualified objects\n\nSELECT o.*\nFROM OBJECT o\nJOIN qualified q ON q.oid = o.oid\nLIMIT 20;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query using pre-filtered objects and band-wise aggregation on detections\nWITH candidate_objects AS\n  (-- Objects meeting detection count and time span constraints\n SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     band_mins AS\n  (-- Compute minimum corrected magnitudes per band only for candidate objects\n SELECT d.oid,\n        MIN(d.magpsf_corr) FILTER (\n                                   WHERE d.fid = 1\n                                     AND d.magpsf_corr IS NOT NULL\n                                     AND d.corrected) AS min_g_corr,\n        MIN(d.magpsf_corr) FILTER (\n                                   WHERE d.fid = 2\n                                     AND d.magpsf_corr IS NOT NULL\n                                     AND d.corrected) AS min_r_corr\n   FROM detection d\n   JOIN candidate_objects co ON co.oid = d.oid\n   GROUP BY d.oid),\n     qualified AS\n  (-- Keep only objects where the absolute difference between min g and r corrected magnitudes is > 3.5\n SELECT bm.oid\n   FROM band_mins bm\n   WHERE bm.min_g_corr IS NOT NULL\n     AND bm.min_r_corr IS NOT NULL\n     AND ABS(bm.min_g_corr - bm.min_r_corr) > 3.5) -- Return all columns from the object table for up to 20 qualified objects\n\nSELECT o.*\nFROM OBJECT o\nJOIN qualified q ON q.oid = o.oid\nLIMIT 20;"
                },
                "in_toks": 2168,
                "out_toks": 2424,
                "id": "chatcmpl-CbAHvbsrJPdrQFHpIcOirzMI7ZRBW",
                "created": 1762973719,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Return at most 20 objects meeting:\n   - at least 30 detections (ndet >= 30)\n   - time span > 20 days (deltajd > 20)\n   - absolute difference between the minimum corrected magnitudes in g (fid=1) and r (fid=2) > 3.5\n*/\nSELECT *\nFROM object\nWHERE oid IN (\n    /* Preselect OIDs from object table meeting ndet and deltajd constraints */\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 30\n      AND o.deltajd > 20\n      AND o.oid IN (\n          /* OIDs whose |min_g_corr - min_r_corr| > 3.5 using magpsf_corr per band */\n          SELECT oid\n          FROM (\n              SELECT d.oid,\n                     MIN(CASE WHEN d.fid = 1 AND d.magpsf_corr IS NOT NULL THEN d.magpsf_corr END) AS min_g_corr,\n                     MIN(CASE WHEN d.fid = 2 AND d.magpsf_corr IS NOT NULL THEN d.magpsf_corr END) AS min_r_corr\n              FROM detection d\n              GROUP BY d.oid\n          ) m\n          WHERE m.min_g_corr IS NOT NULL\n            AND m.min_r_corr IS NOT NULL\n            AND ABS(m.min_g_corr - m.min_r_corr) > 3.5\n      )\n)\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Return at most 20 objects meeting:\n   - at least 30 detections (ndet >= 30)\n   - time span > 20 days (deltajd > 20)\n   - absolute difference between the minimum corrected magnitudes in g (fid=1) and r (fid=2) > 3.5\n*/\nSELECT *\nFROM object\nWHERE oid IN (\n    /* Preselect OIDs from object table meeting ndet and deltajd constraints */\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 30\n      AND o.deltajd > 20\n      AND o.oid IN (\n          /* OIDs whose |min_g_corr - min_r_corr| > 3.5 using magpsf_corr per band */\n          SELECT oid\n          FROM (\n              SELECT d.oid,\n                     MIN(CASE WHEN d.fid = 1 AND d.magpsf_corr IS NOT NULL THEN d.magpsf_corr END) AS min_g_corr,\n                     MIN(CASE WHEN d.fid = 2 AND d.magpsf_corr IS NOT NULL THEN d.magpsf_corr END) AS min_r_corr\n              FROM detection d\n              GROUP BY d.oid\n          ) m\n          WHERE m.min_g_corr IS NOT NULL\n            AND m.min_r_corr IS NOT NULL\n            AND ABS(m.min_g_corr - m.min_r_corr) > 3.5\n      )\n)\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 3067,
                "id": "chatcmpl-CZRCfVCLaXoohcSfpVa2W5Z0lklko",
                "created": 1762562085,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "58",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 592,
                "id": "chatcmpl-CZNTr9quQBYXcXGhRQuIskDqhQbs3",
                "created": 1762547775,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimize by first filtering candidate oids from the smaller 'object' table,\n-- then aggregating detections only for those oids to compute per-band minimum corrected magnitudes.\nWITH candidates AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     gr_min_diff AS\n  (SELECT d.oid,\n          MIN(CASE\n                  WHEN d.fid = 1 THEN d.magpsf_corr\n              END) AS min_g_corr,\n          MIN(CASE\n                  WHEN d.fid = 2 THEN d.magpsf_corr\n              END) AS min_r_corr\n   FROM detection d\n   JOIN candidates c ON c.oid = d.oid\n   GROUP BY d.oid\n   HAVING MIN(CASE\n                  WHEN d.fid = 1 THEN d.magpsf_corr\n              END) IS NOT NULL\n   AND MIN(CASE\n               WHEN d.fid = 2 THEN d.magpsf_corr\n           END) IS NOT NULL\n   AND ABS(MIN(CASE\n                   WHEN d.fid = 1 THEN d.magpsf_corr\n               END) - MIN(CASE\n                              WHEN d.fid = 2 THEN d.magpsf_corr\n                          END)) > 3.5)\nSELECT o.*\nFROM OBJECT o\nJOIN gr_min_diff g ON g.oid = o.oid\nLIMIT 20;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimize by first filtering candidate oids from the smaller 'object' table,\n-- then aggregating detections only for those oids to compute per-band minimum corrected magnitudes.\nWITH candidates AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE ndet >= 30\n     AND deltajd > 20),\n     gr_min_diff AS\n  (SELECT d.oid,\n          MIN(CASE\n                  WHEN d.fid = 1 THEN d.magpsf_corr\n              END) AS min_g_corr,\n          MIN(CASE\n                  WHEN d.fid = 2 THEN d.magpsf_corr\n              END) AS min_r_corr\n   FROM detection d\n   JOIN candidates c ON c.oid = d.oid\n   GROUP BY d.oid\n   HAVING MIN(CASE\n                  WHEN d.fid = 1 THEN d.magpsf_corr\n              END) IS NOT NULL\n   AND MIN(CASE\n               WHEN d.fid = 2 THEN d.magpsf_corr\n           END) IS NOT NULL\n   AND ABS(MIN(CASE\n                   WHEN d.fid = 1 THEN d.magpsf_corr\n               END) - MIN(CASE\n                              WHEN d.fid = 2 THEN d.magpsf_corr\n                          END)) > 3.5)\nSELECT o.*\nFROM OBJECT o\nJOIN gr_min_diff g ON g.oid = o.oid\nLIMIT 20;"
                },
                "in_toks": 2104,
                "out_toks": 2209,
                "id": "chatcmpl-CbAJEiKAJxSodr4ZJh0411K2y5rm7",
                "created": 1762973800,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get at most 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days (difference between last and first detection times)\n-- - absolute difference between the minimum corrected magnitudes in g (fid=1) and r (fid=2) bands > 3.5\n-- Note: We use conditional aggregation on detection without explicit non-oid filters, and select all columns from object.\nWITH oids_with_large_gr_diff AS (\n    SELECT\n        d.oid\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n    HAVING\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) IS NOT NULL\n        AND MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) IS NOT NULL\n        AND ABS(\n            MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END)\n            - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END)\n        ) > 3.5\n)\nSELECT\n    *\nFROM\n    object o\nWHERE\n    o.oid IN (SELECT oid FROM oids_with_large_gr_diff)\n    AND o.ndet >= 30\n    AND o.deltajd > 20\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get at most 20 objects with:\n-- - ndet >= 30\n-- - deltajd > 20 days (difference between last and first detection times)\n-- - absolute difference between the minimum corrected magnitudes in g (fid=1) and r (fid=2) bands > 3.5\n-- Note: We use conditional aggregation on detection without explicit non-oid filters, and select all columns from object.\nWITH oids_with_large_gr_diff AS (\n    SELECT\n        d.oid\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n    HAVING\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) IS NOT NULL\n        AND MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) IS NOT NULL\n        AND ABS(\n            MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END)\n            - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END)\n        ) > 3.5\n)\nSELECT\n    *\nFROM\n    object o\nWHERE\n    o.oid IN (SELECT oid FROM oids_with_large_gr_diff)\n    AND o.ndet >= 30\n    AND o.deltajd > 20\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 2078,
                "id": "chatcmpl-CZRCt20dEOEDRjHXm5z7J6CVlZk0i",
                "created": 1762562099,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "58",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 649,
                "out_toks": 848,
                "id": "chatcmpl-CZNU7poh8ulFQpIlNDvlJmwtClAuN",
                "created": 1762547791,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get at most 20 objects with:\n-- - at least 30 detections (ndet >= 30)\n-- - time span between last and first detection > 20 days (deltajd > 20)\n-- - absolute difference between the minimum corrected g- and r-band magnitudes > 3.5\n--   (computed from detection.magpsf_corr with fid=1 for g and fid=2 for r, using only corrected and non-dubious detections)\nSELECT *\nFROM object o\nWHERE o.ndet >= 30\n  AND o.deltajd > 20\n  AND ABS(\n        (SELECT MIN(dg.magpsf_corr)\n         FROM detection dg\n         WHERE dg.oid = o.oid\n           AND dg.fid = 1\n           AND dg.corrected = TRUE\n           AND dg.dubious = FALSE)\n        -\n        (SELECT MIN(dr.magpsf_corr)\n         FROM detection dr\n         WHERE dr.oid = o.oid\n           AND dr.fid = 2\n           AND dr.corrected = TRUE\n           AND dr.dubious = FALSE)\n      ) > 3.5\nLIMIT 20;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get at most 20 objects with:\n-- - at least 30 detections (ndet >= 30)\n-- - time span between last and first detection > 20 days (deltajd > 20)\n-- - absolute difference between the minimum corrected g- and r-band magnitudes > 3.5\n--   (computed from detection.magpsf_corr with fid=1 for g and fid=2 for r, using only corrected and non-dubious detections)\nSELECT *\nFROM object o\nWHERE o.ndet >= 30\n  AND o.deltajd > 20\n  AND ABS(\n        (SELECT MIN(dg.magpsf_corr)\n         FROM detection dg\n         WHERE dg.oid = o.oid\n           AND dg.fid = 1\n           AND dg.corrected = TRUE\n           AND dg.dubious = FALSE)\n        -\n        (SELECT MIN(dr.magpsf_corr)\n         FROM detection dr\n         WHERE dr.oid = o.oid\n           AND dr.fid = 2\n           AND dr.corrected = TRUE\n           AND dr.dubious = FALSE)\n      ) > 3.5\nLIMIT 20;"
                },
                "in_toks": 2948,
                "out_toks": 2176,
                "id": "chatcmpl-CZRD7mPJ4ElbUPqHCnGhk2QWoimwu",
                "created": 1762562113,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "78": {
        "0": {
            "req_id": "78",
            "experiment_id": "run_0",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']",
                    "1": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 280,
                "id": "chatcmpl-CSncmJEtkzWigIoJXBoTvkZj0gS9T",
                "created": 1760979976,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 431,
                "id": "chatcmpl-CSoFP8XMvePHVDh7Ji3ybVNl7QN21",
                "created": 1760982371,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "78",
            "experiment_id": "run_1",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']",
                    "1": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 280,
                "id": "chatcmpl-CSncmJEtkzWigIoJXBoTvkZj0gS9T",
                "created": 1760979976,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 368,
                "id": "chatcmpl-CSoFUbZgzezTPqdkjdWSVAyfwrWzF",
                "created": 1760982376,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "78",
            "experiment_id": "run_2",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 140,
                "id": "chatcmpl-CSsvqnsEcuKSFfA90L9yPW8k9KOTf",
                "created": 1761000378,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return taxonomy entry for the Light Curve classifier (lc_classifier)\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return taxonomy entry for the Light Curve classifier (lc_classifier)\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 942,
                "id": "chatcmpl-CSt01bmSJDXlc2wwlnnIKVbQ9g2eR",
                "created": 1761000637,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "78",
            "experiment_id": "run_3",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 204,
                "id": "chatcmpl-CSsvtC2sZs2WwqmFWveGOKueZDnx3",
                "created": 1761000381,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return the classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return the classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 561,
                "id": "chatcmpl-CSt0DDsfB8IXkdWe9Ua2f41zkvb1I",
                "created": 1761000649,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "78",
            "experiment_id": "run_4",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 140,
                "id": "chatcmpl-CSsvxvYob8VKDpdRCUf47SLvQYMKN",
                "created": 1761000385,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return name, version, and classes for the Light Curve classifier from taxonomy\nSELECT\n  classifier_name,\n  classifier_version,\n  classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return name, version, and classes for the Light Curve classifier from taxonomy\nSELECT\n  classifier_name,\n  classifier_version,\n  classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 369,
                "id": "chatcmpl-CSt0P4fa3RkVU4aGvwE3lw4aMXPOm",
                "created": 1761000661,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "78",
            "experiment_id": "run_5",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 140,
                "id": "chatcmpl-CZNUQj485WpvYOxL75zLisuyttCbj",
                "created": 1762547810,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 304,
                "id": "chatcmpl-CZRE7rbk40uLj8C1zbp9ljsjIMK7h",
                "created": 1762562175,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "78",
            "experiment_id": "run_6",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 76,
                "id": "chatcmpl-CZNUV3cCfO6daJQ0PmiyfrMIZYMkR",
                "created": 1762547815,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 368,
                "id": "chatcmpl-CZREO8dGl5ccJZM9IwUipFOVw26c8",
                "created": 1762562192,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "78",
            "experiment_id": "run_7",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 140,
                "id": "chatcmpl-CZNUZ8qqQEZMG9kRtZy828KiFX6X9",
                "created": 1762547819,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 623,
                "id": "chatcmpl-CZREVGxfZ2KkSbcII1gjLhGf1wlMe",
                "created": 1762562199,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "78",
            "experiment_id": "run_8",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 140,
                "id": "chatcmpl-CZNUd6lILMrWVqfbGHKr7D2C6NeLB",
                "created": 1762547823,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n  classifier_name,\n  classifier_version,\n  classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n  classifier_name,\n  classifier_version,\n  classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 560,
                "id": "chatcmpl-CZREhC6i1CMUZxo6FaMMUkZQ6EgB4",
                "created": 1762562211,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "78",
            "experiment_id": "run_9",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 612,
                "out_toks": 140,
                "id": "chatcmpl-CZNUi75yy4GssltW8nHTmsHRAe2jV",
                "created": 1762547828,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Return classifier name, version, and classes for the Light Curve classifier\nSELECT\n    classifier_name,\n    classifier_version,\n    classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';"
                },
                "in_toks": 1926,
                "out_toks": 240,
                "id": "chatcmpl-CZRF4snofwmBMdiiU4vFQvX9p0N46",
                "created": 1762562234,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    },
    "39": {
        "0": {
            "req_id": "39",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 705,
                "out_toks": 2603,
                "id": "chatcmpl-CSncqSm4oMNIlcuJuu5hpmByygdvW",
                "created": 1760979980,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "WITH cvn_oids AS\n  (-- Objects whose highest-probability class is 'CV/Nova' under the stochastic light curve classifier\n SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_stochastic'\n     AND p.class_name = 'CV/Nova'\n     AND p.ranking = 1),\n     limited_oids AS\n  (-- Objects with at most 50 detections overall\n SELECT o.oid\n   FROM OBJECT o\n   INNER JOIN cvn_oids c USING (oid)\n   WHERE o.ndet <= 50),\n     detection_r AS\n  (-- r-band, corrected detections for the selected objects\n SELECT d.oid,\n        d.candid,\n        d.fid,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.magpsf_corr,\n        d.sigmapsf_corr\n   FROM detection d\n   INNER JOIN limited_oids lo ON lo.oid = d.oid\n   WHERE d.fid = 2\n     AND d.corrected = TRUE\n     AND d.magpsf_corr IS NOT NULL),\n     amp AS\n  (-- Per-object maximum rise from minimum in corrected PSF magnitude (r-band)\n SELECT oid,\n        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise_from_min\n   FROM detection_r\n   GROUP BY oid)\nSELECT dr.oid AS oid, -- object identifier\n dr.candid AS candid, -- candidate identifier\n dr.fid AS f_id, -- filter id\n dr.ra AS ra, -- right ascension\n dr.dec AS dec, -- declination\n dr.magpsf AS magpsf, -- PSF difference magnitude\n dr.sigmapsf AS sigmapsf, -- PSF difference magnitude error\n dr.magpsf_corr AS magpsf_corr, -- corrected PSF magnitude in r-band\n dr.sigmapsf_corr AS sigmapsf_corr, -- error of corrected PSF magnitude\n a.max_rise_from_min\nFROM detection_r dr\nINNER JOIN amp a USING (oid)\nORDER BY dr.oid\nLIMIT 1000;",
            "sql_response": {
                "responses": {
                    "0": "WITH cvn_oids AS\n  (-- Objects whose highest-probability class is 'CV/Nova' under the stochastic light curve classifier\n SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_stochastic'\n     AND p.class_name = 'CV/Nova'\n     AND p.ranking = 1),\n     limited_oids AS\n  (-- Objects with at most 50 detections overall\n SELECT o.oid\n   FROM OBJECT o\n   INNER JOIN cvn_oids c USING (oid)\n   WHERE o.ndet <= 50),\n     detection_r AS\n  (-- r-band, corrected detections for the selected objects\n SELECT d.oid,\n        d.candid,\n        d.fid,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.magpsf_corr,\n        d.sigmapsf_corr\n   FROM detection d\n   INNER JOIN limited_oids lo ON lo.oid = d.oid\n   WHERE d.fid = 2\n     AND d.corrected = TRUE\n     AND d.magpsf_corr IS NOT NULL),\n     amp AS\n  (-- Per-object maximum rise from minimum in corrected PSF magnitude (r-band)\n SELECT oid,\n        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise_from_min\n   FROM detection_r\n   GROUP BY oid)\nSELECT dr.oid AS oid, -- object identifier\n dr.candid AS candid, -- candidate identifier\n dr.fid AS f_id, -- filter id\n dr.ra AS ra, -- right ascension\n dr.dec AS dec, -- declination\n dr.magpsf AS magpsf, -- PSF difference magnitude\n dr.sigmapsf AS sigmapsf, -- PSF difference magnitude error\n dr.magpsf_corr AS magpsf_corr, -- corrected PSF magnitude in r-band\n dr.sigmapsf_corr AS sigmapsf_corr, -- error of corrected PSF magnitude\n a.max_rise_from_min\nFROM detection_r dr\nINNER JOIN amp a USING (oid)\nORDER BY dr.oid\nLIMIT 1000;"
                },
                "in_toks": 2571,
                "out_toks": 3110,
                "id": "chatcmpl-CbAKHE0IARGcX4pdcDSevrw8RC5VT",
                "created": 1762973865,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH cvn_oids AS (\n    -- OIDs whose highest-probability class is 'CV/Nova' under the stochastic light curve classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n),\nlimited_oids AS (\n    -- OIDs with at most 50 detections from discovery to last detection\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n      AND o.oid IN (SELECT oid FROM cvn_oids)\n)\nSELECT\n    d.oid AS oid,                 -- object identifier\n    d.candid AS candid,           -- candidate identifier\n    d.fid AS f_id,                -- filter id\n    d.ra AS ra,                   -- right ascension (coordinates)\n    d.dec AS dec,                 -- declination (coordinates)\n    d.magpsf AS magpsf,           -- PSF difference magnitude\n    d.sigmapsf AS sigmapsf,       -- PSF difference magnitude error\n    d.magpsf_corr AS magpsf_corr, -- corrected PSF magnitude in r-band\n    d.sigmapsf_corr AS sigmapsf_corr, -- error of corrected PSF magnitude\n    (\n        -- Maximum rise from minimum (amplitude) in corrected PSF magnitude for r-band per object\n        SELECT MAX(dd.magpsf_corr) - MIN(dd.magpsf_corr)\n        FROM detection dd\n        WHERE dd.oid = d.oid\n          AND dd.fid = 2\n          AND dd.corrected = TRUE\n          AND dd.magpsf_corr IS NOT NULL\n    ) AS max_rise_from_min\nFROM detection d\nWHERE d.fid = 2                      -- r-band\n  AND d.corrected = TRUE\n  AND d.magpsf_corr IS NOT NULL      -- ensure corrected magnitude is available\n  AND d.oid IN (SELECT oid FROM limited_oids)\nORDER BY d.oid\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH cvn_oids AS (\n    -- OIDs whose highest-probability class is 'CV/Nova' under the stochastic light curve classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n),\nlimited_oids AS (\n    -- OIDs with at most 50 detections from discovery to last detection\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n      AND o.oid IN (SELECT oid FROM cvn_oids)\n)\nSELECT\n    d.oid AS oid,                 -- object identifier\n    d.candid AS candid,           -- candidate identifier\n    d.fid AS f_id,                -- filter id\n    d.ra AS ra,                   -- right ascension (coordinates)\n    d.dec AS dec,                 -- declination (coordinates)\n    d.magpsf AS magpsf,           -- PSF difference magnitude\n    d.sigmapsf AS sigmapsf,       -- PSF difference magnitude error\n    d.magpsf_corr AS magpsf_corr, -- corrected PSF magnitude in r-band\n    d.sigmapsf_corr AS sigmapsf_corr, -- error of corrected PSF magnitude\n    (\n        -- Maximum rise from minimum (amplitude) in corrected PSF magnitude for r-band per object\n        SELECT MAX(dd.magpsf_corr) - MIN(dd.magpsf_corr)\n        FROM detection dd\n        WHERE dd.oid = d.oid\n          AND dd.fid = 2\n          AND dd.corrected = TRUE\n          AND dd.magpsf_corr IS NOT NULL\n    ) AS max_rise_from_min\nFROM detection d\nWHERE d.fid = 2                      -- r-band\n  AND d.corrected = TRUE\n  AND d.magpsf_corr IS NOT NULL      -- ensure corrected magnitude is available\n  AND d.oid IN (SELECT oid FROM limited_oids)\nORDER BY d.oid\nLIMIT 1000;"
                },
                "in_toks": 3187,
                "out_toks": 2619,
                "id": "chatcmpl-CSoFbTa7sxppVBxwuI4TyLq9jJEiD",
                "created": 1760982383,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "39",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 705,
                "out_toks": 2603,
                "id": "chatcmpl-CSncqSm4oMNIlcuJuu5hpmByygdvW",
                "created": 1760979980,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Optimized query:\n-- 1) Pre-filter OIDs by top-ranked 'CV/Nova' in lc_classifier_stochastic and ndet <= 50 (small set).\n-- 2) Pre-aggregate r-band corrected magnitudes per OID to get min/max.\n-- 3) Join to r-band, corrected detections only, to compute per-detection rise and object-level max rise.\nWITH selected_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE p.classifier_name = 'lc_classifier_stochastic'\n     AND p.class_name = 'CV/Nova'\n     AND p.ranking = 1\n     AND o.ndet <= 50),\n     r_band_stats AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) AS min_mag_corr,\n          MAX(d.magpsf_corr) AS max_mag_corr\n   FROM detection d\n   JOIN selected_oids s USING (oid)\n   WHERE d.fid = 2\n     AND d.corrected = TRUE\n   GROUP BY d.oid)\nSELECT d.oid, -- object identifier\n d.candid, -- candidate identifier\n d.fid AS f_id, -- filter id\n d.ra, -- right ascension\n d.dec, -- declination\n d.magpsf AS magnitude, -- PSF difference magnitude\n d.sigmapsf AS magnitude_error, -- PSF difference magnitude error\n d.magpsf_corr AS corrected_diff_mag_r, -- corrected difference magnitude (r-band)\n d.magpsf_corr AS psf_corrected_magnitude_r, -- PSF corrected magnitude (r-band)\n d.sigmapsf_corr AS psf_corrected_magnitude_error, -- error of corrected magnitude\n (d.magpsf_corr - r.min_mag_corr) AS rise_from_min, -- per-detection rise from min (r-band)\n (r.max_mag_corr - r.min_mag_corr) AS max_rise_from_min -- object-level max rise (r-band)\nFROM detection d\nJOIN selected_oids s ON d.oid = s.oid\nJOIN r_band_stats r ON d.oid = r.oid\nWHERE d.fid = 2\n  AND d.corrected = TRUE\nORDER BY d.oid,\n         d.candid\nLIMIT 1000;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query:\n-- 1) Pre-filter OIDs by top-ranked 'CV/Nova' in lc_classifier_stochastic and ndet <= 50 (small set).\n-- 2) Pre-aggregate r-band corrected magnitudes per OID to get min/max.\n-- 3) Join to r-band, corrected detections only, to compute per-detection rise and object-level max rise.\nWITH selected_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE p.classifier_name = 'lc_classifier_stochastic'\n     AND p.class_name = 'CV/Nova'\n     AND p.ranking = 1\n     AND o.ndet <= 50),\n     r_band_stats AS\n  (SELECT d.oid,\n          MIN(d.magpsf_corr) AS min_mag_corr,\n          MAX(d.magpsf_corr) AS max_mag_corr\n   FROM detection d\n   JOIN selected_oids s USING (oid)\n   WHERE d.fid = 2\n     AND d.corrected = TRUE\n   GROUP BY d.oid)\nSELECT d.oid, -- object identifier\n d.candid, -- candidate identifier\n d.fid AS f_id, -- filter id\n d.ra, -- right ascension\n d.dec, -- declination\n d.magpsf AS magnitude, -- PSF difference magnitude\n d.sigmapsf AS magnitude_error, -- PSF difference magnitude error\n d.magpsf_corr AS corrected_diff_mag_r, -- corrected difference magnitude (r-band)\n d.magpsf_corr AS psf_corrected_magnitude_r, -- PSF corrected magnitude (r-band)\n d.sigmapsf_corr AS psf_corrected_magnitude_error, -- error of corrected magnitude\n (d.magpsf_corr - r.min_mag_corr) AS rise_from_min, -- per-detection rise from min (r-band)\n (r.max_mag_corr - r.min_mag_corr) AS max_rise_from_min -- object-level max rise (r-band)\nFROM detection d\nJOIN selected_oids s ON d.oid = s.oid\nJOIN r_band_stats r ON d.oid = r.oid\nWHERE d.fid = 2\n  AND d.corrected = TRUE\nORDER BY d.oid,\n         d.candid\nLIMIT 1000;"
                },
                "in_toks": 2666,
                "out_toks": 2885,
                "id": "chatcmpl-CbALLzJ2g5DQCx6P6gvRwbcILa1GJ",
                "created": 1762973931,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select r-band detections for objects whose top-ranked lc_classifier_stochastic class is 'CV/Nova'\n-- and with total number of detections <= 50. Return requested columns plus rise metrics.\nWITH valid_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n),\nlimited_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nselected_oids AS (\n    SELECT oid FROM valid_oids\n    INTERSECT\n    SELECT oid FROM limited_oids\n)\nSELECT\n    d.oid,                              -- object identifier\n    d.candid,                           -- candidate identifier\n    d.fid AS f_id,                      -- filter id\n    d.ra,                               -- coordinate: right ascension (per detection)\n    d.dec,                              -- coordinate: declination (per detection)\n    d.magpsf AS magnitude,              -- PSF difference magnitude\n    d.sigmapsf AS magnitude_error,      -- PSF difference magnitude error\n    d.magpsf_corr AS psf_corrected_magnitude,        -- corrected PSF magnitude (r-band due to fid=2)\n    d.sigmapsf_corr AS psf_corrected_magnitude_error, -- corrected PSF magnitude error\n    -- rise from the minimum corrected magnitude observed for the object (r-band)\n    (d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS rise_from_min,\n    -- maximum rise (amplitude) across all r-band detections for the object\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\n  AND d.fid = 2                 -- r-band\n  AND d.corrected = TRUE        -- use corrected magnitudes as requested\nORDER BY d.oid, d.candid\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select r-band detections for objects whose top-ranked lc_classifier_stochastic class is 'CV/Nova'\n-- and with total number of detections <= 50. Return requested columns plus rise metrics.\nWITH valid_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n),\nlimited_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nselected_oids AS (\n    SELECT oid FROM valid_oids\n    INTERSECT\n    SELECT oid FROM limited_oids\n)\nSELECT\n    d.oid,                              -- object identifier\n    d.candid,                           -- candidate identifier\n    d.fid AS f_id,                      -- filter id\n    d.ra,                               -- coordinate: right ascension (per detection)\n    d.dec,                              -- coordinate: declination (per detection)\n    d.magpsf AS magnitude,              -- PSF difference magnitude\n    d.sigmapsf AS magnitude_error,      -- PSF difference magnitude error\n    d.magpsf_corr AS psf_corrected_magnitude,        -- corrected PSF magnitude (r-band due to fid=2)\n    d.sigmapsf_corr AS psf_corrected_magnitude_error, -- corrected PSF magnitude error\n    -- rise from the minimum corrected magnitude observed for the object (r-band)\n    (d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS rise_from_min,\n    -- maximum rise (amplitude) across all r-band detections for the object\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\n  AND d.fid = 2                 -- r-band\n  AND d.corrected = TRUE        -- use corrected magnitudes as requested\nORDER BY d.oid, d.candid\nLIMIT 1000;"
                },
                "in_toks": 3232,
                "out_toks": 3603,
                "id": "chatcmpl-CSoG4Wnwrj1W5PKiHX6P2K6euscD2",
                "created": 1760982412,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "39",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 705,
                "out_toks": 1751,
                "id": "chatcmpl-CSsw1fcpCVocXQJSfPDaLcAx0jndC",
                "created": 1761000389,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/* Select top-ranked CV/Nova objects from the stochastic LC classifier with <=50 detections,\n   then return per-detection r-band info and per-object max rise (max - min) of magpsf_corr. */ WITH eligible AS\n  (/* Pre-filter objects by class, classifier, rank, and ndet to shrink detection joins */  SELECT DISTINCT o.oid\n   FROM probability p\n   JOIN OBJECT o USING (oid)\n   WHERE p.classifier_name = 'lc_classifier_stochastic'\n     AND p.class_name = 'CV/Nova'\n     AND p.ranking = 1\n     AND o.ndet <= 50),\n                                                                                                     r_stats AS\n  (/* Compute per-object min/max corrected PSF magnitude in r-band to avoid window scans */  SELECT d.oid,\n                                                                                                    MIN(d.magpsf_corr) AS min_magpsf_corr_r,\n                                                                                                    MAX(d.magpsf_corr) AS max_magpsf_corr_r\n   FROM detection d\n   JOIN eligible e ON e.oid = d.oid\n   WHERE d.fid = 2\n   GROUP BY d.oid)\nSELECT d.oid,\n       d.candid,\n       d.fid AS f_id,\n       d.ra,\n       d.dec,\n       d.magpsf AS magnitude,\n       d.sigmapsf AS magnitude_error,\n       d.magpsf_corr AS magnitude_corr,\n       d.sigmapsf_corr AS magnitude_corr_error,\n       (r.max_magpsf_corr_r - r.min_magpsf_corr_r) AS max_rise_from_min_r\nFROM detection d\nJOIN eligible e ON e.oid = d.oid\nJOIN r_stats r ON r.oid = d.oid\nWHERE d.fid = 2\nORDER BY d.oid\nLIMIT 1000;",
            "sql_response": {
                "responses": {
                    "0": "/* Select top-ranked CV/Nova objects from the stochastic LC classifier with <=50 detections,\n   then return per-detection r-band info and per-object max rise (max - min) of magpsf_corr. */ WITH eligible AS\n  (/* Pre-filter objects by class, classifier, rank, and ndet to shrink detection joins */  SELECT DISTINCT o.oid\n   FROM probability p\n   JOIN OBJECT o USING (oid)\n   WHERE p.classifier_name = 'lc_classifier_stochastic'\n     AND p.class_name = 'CV/Nova'\n     AND p.ranking = 1\n     AND o.ndet <= 50),\n                                                                                                     r_stats AS\n  (/* Compute per-object min/max corrected PSF magnitude in r-band to avoid window scans */  SELECT d.oid,\n                                                                                                    MIN(d.magpsf_corr) AS min_magpsf_corr_r,\n                                                                                                    MAX(d.magpsf_corr) AS max_magpsf_corr_r\n   FROM detection d\n   JOIN eligible e ON e.oid = d.oid\n   WHERE d.fid = 2\n   GROUP BY d.oid)\nSELECT d.oid,\n       d.candid,\n       d.fid AS f_id,\n       d.ra,\n       d.dec,\n       d.magpsf AS magnitude,\n       d.sigmapsf AS magnitude_error,\n       d.magpsf_corr AS magnitude_corr,\n       d.sigmapsf_corr AS magnitude_corr_error,\n       (r.max_magpsf_corr_r - r.min_magpsf_corr_r) AS max_rise_from_min_r\nFROM detection d\nJOIN eligible e ON e.oid = d.oid\nJOIN r_stats r ON r.oid = d.oid\nWHERE d.fid = 2\nORDER BY d.oid\nLIMIT 1000;"
                },
                "in_toks": 2313,
                "out_toks": 2296,
                "id": "chatcmpl-CbAMIsdTASaepE9cy4woPrwBH4CsA",
                "created": 1762973990,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* CV/Nova objects (top-ranked) under the stochastic LC classifier, with <= 50 detections overall.\n   Return per-detection info in r-band (fid=2), including corrected magnitudes and a per-object\n   max rise (max - min) of magpsf_corr in r. */\nSELECT d.oid,\n       d.candid,\n       d.fid AS f_id,\n       d.ra,\n       d.dec,\n       d.magpsf AS magnitude,\n       d.sigmapsf AS magnitude_error,\n       d.magpsf_corr AS magnitude_corr,\n       d.sigmapsf_corr AS magnitude_corr_error,\n       (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_r\nFROM detection d\nWHERE d.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'lc_classifier_stochastic'\n       AND p.class_name = 'CV/Nova'\n       AND p.ranking = 1)\n  AND d.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.ndet <= 50)\n  AND d.fid = 2\nORDER BY d.oid\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "/* CV/Nova objects (top-ranked) under the stochastic LC classifier, with <= 50 detections overall.\n   Return per-detection info in r-band (fid=2), including corrected magnitudes and a per-object\n   max rise (max - min) of magpsf_corr in r. */\nSELECT d.oid,\n       d.candid,\n       d.fid AS f_id,\n       d.ra,\n       d.dec,\n       d.magpsf AS magnitude,\n       d.sigmapsf AS magnitude_error,\n       d.magpsf_corr AS magnitude_corr,\n       d.sigmapsf_corr AS magnitude_corr_error,\n       (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_r\nFROM detection d\nWHERE d.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.classifier_name = 'lc_classifier_stochastic'\n       AND p.class_name = 'CV/Nova'\n       AND p.ranking = 1)\n  AND d.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.ndet <= 50)\n  AND d.fid = 2\nORDER BY d.oid\nLIMIT 1000;"
                },
                "in_toks": 3232,
                "out_toks": 3099,
                "id": "chatcmpl-CayqLhDLS2hkLwZCTZcolD8Z0YFcL",
                "created": 1762929725,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "39",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 705,
                "out_toks": 1751,
                "id": "chatcmpl-CSswNecBrY36xhmCwl2L8oj4Ly3b1",
                "created": 1761000411,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "-- Get CV/Nova objects with highest-probability class by the stochastic light-curve classifier and <= 50 detections\nWITH cvn_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_stochastic' -- classifier constraint\n\n     AND p.class_name = 'CV/Nova' -- class constraint\n\n     AND p.ranking = 1 -- highest-probability class\n),\n     limited_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN cvn_oids c ON c.oid = o.oid\n   WHERE o.ndet <= 50), -- Pre-limit to earliest OIDs to avoid scanning the entire detection table; preserves correct global ordering by oid\ntop_oids AS\n  (SELECT oid\n   FROM limited_oids\n   ORDER BY oid\n   LIMIT 10000), -- r-band, corrected detections only, for the selected OIDs\nr_dets AS\n  (SELECT d.candid,\n          d.oid,\n          d.fid,\n          d.ra,\n          d.dec,\n          d.magpsf_corr,\n          d.sigmapsf_corr,\n          d.magpsf,\n          d.sigmapsf,\n          d.mjd\n   FROM detection d\n   JOIN top_oids t ON t.oid = d.oid\n   WHERE d.fid = 2 -- r-band\n\n     AND d.corrected = TRUE -- corrected photometry\n), -- Pre-aggregate per-oid extrema to avoid window aggregations over large sets\nagg AS\n  (SELECT oid,\n          MIN(magpsf_corr) AS min_magpsf_corr,\n          MAX(magpsf_corr) AS max_magpsf_corr\n   FROM r_dets\n   GROUP BY oid)\nSELECT rd.oid, -- object identifier\n rd.candid, -- candidate identifier\n rd.fid AS f_id, -- filter id\n rd.ra, -- RA\n rd.dec, -- Dec\n rd.magpsf_corr AS mag_r_corr, -- corrected difference magnitude in r-band\n rd.sigmapsf_corr AS mag_r_corr_err, -- magnitude error (corrected)\n rd.magpsf AS mag_r_psf, -- PSF magnitude in r-band\n rd.sigmapsf AS mag_r_psf_err, -- PSF magnitude error\n rd.magpsf_corr - a.min_magpsf_corr AS rise_from_min_mag, -- per-detection rise from minimum\n a.max_magpsf_corr - a.min_magpsf_corr AS max_rise_from_min_mag -- per-object maximum rise\nFROM r_dets rd\nJOIN agg a USING (oid)\nORDER BY rd.oid\nLIMIT 1000;",
            "sql_response": {
                "responses": {
                    "0": "-- Get CV/Nova objects with highest-probability class by the stochastic light-curve classifier and <= 50 detections\nWITH cvn_oids AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier_stochastic' -- classifier constraint\n\n     AND p.class_name = 'CV/Nova' -- class constraint\n\n     AND p.ranking = 1 -- highest-probability class\n),\n     limited_oids AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN cvn_oids c ON c.oid = o.oid\n   WHERE o.ndet <= 50), -- Pre-limit to earliest OIDs to avoid scanning the entire detection table; preserves correct global ordering by oid\ntop_oids AS\n  (SELECT oid\n   FROM limited_oids\n   ORDER BY oid\n   LIMIT 10000), -- r-band, corrected detections only, for the selected OIDs\nr_dets AS\n  (SELECT d.candid,\n          d.oid,\n          d.fid,\n          d.ra,\n          d.dec,\n          d.magpsf_corr,\n          d.sigmapsf_corr,\n          d.magpsf,\n          d.sigmapsf,\n          d.mjd\n   FROM detection d\n   JOIN top_oids t ON t.oid = d.oid\n   WHERE d.fid = 2 -- r-band\n\n     AND d.corrected = TRUE -- corrected photometry\n), -- Pre-aggregate per-oid extrema to avoid window aggregations over large sets\nagg AS\n  (SELECT oid,\n          MIN(magpsf_corr) AS min_magpsf_corr,\n          MAX(magpsf_corr) AS max_magpsf_corr\n   FROM r_dets\n   GROUP BY oid)\nSELECT rd.oid, -- object identifier\n rd.candid, -- candidate identifier\n rd.fid AS f_id, -- filter id\n rd.ra, -- RA\n rd.dec, -- Dec\n rd.magpsf_corr AS mag_r_corr, -- corrected difference magnitude in r-band\n rd.sigmapsf_corr AS mag_r_corr_err, -- magnitude error (corrected)\n rd.magpsf AS mag_r_psf, -- PSF magnitude in r-band\n rd.sigmapsf AS mag_r_psf_err, -- PSF magnitude error\n rd.magpsf_corr - a.min_magpsf_corr AS rise_from_min_mag, -- per-detection rise from minimum\n a.max_magpsf_corr - a.min_magpsf_corr AS max_rise_from_min_mag -- per-object maximum rise\nFROM r_dets rd\nJOIN agg a USING (oid)\nORDER BY rd.oid\nLIMIT 1000;"
                },
                "in_toks": 2725,
                "out_toks": 4500,
                "id": "chatcmpl-CbANEoX5x4llRRKOb6hLcuDrwRieN",
                "created": 1762974048,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- CV/Nova candidates (highest-probability class by stochastic light-curve classifier)\nWITH cvn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n),\n-- Restrict to objects with at most 50 detections (from discovery to last detection)\nlimited_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM cvn_oids)\n      AND o.ndet <= 50\n),\n-- r-band detections with corrected photometry\nr_dets AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.ra,\n        d.dec,\n        d.magpsf_corr,\n        d.sigmapsf_corr,\n        d.mjd\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM limited_oids)\n      AND d.fid = 2                  -- r-band\n      AND d.corrected = TRUE         -- use corrected difference magnitudes\n)\nSELECT\n    rd.oid,                          -- object identifier\n    rd.candid,                       -- candidate identifier\n    rd.fid AS f_id,                  -- filter id as requested\n    rd.ra,                           -- detection RA\n    rd.dec,                          -- detection Dec\n    rd.magpsf_corr AS mag,           -- corrected difference magnitude (r-band)\n    rd.sigmapsf_corr AS mag_err,     -- magnitude error (PSF-corrected, r-band)\n    rd.magpsf_corr AS psf_corr_mag_r, -- PSF corrected magnitude in r-filter (explicit)\n    -- rise from the minimum corrected mag within each object (positive = fainter than brightest point)\n    rd.magpsf_corr - MIN(rd.magpsf_corr) OVER (PARTITION BY rd.oid) AS rise_from_min_mag,\n    -- maximum rise from minimum across r-band detections for the object\n    MAX(rd.magpsf_corr) OVER (PARTITION BY rd.oid) - MIN(rd.magpsf_corr) OVER (PARTITION BY rd.oid) AS max_rise_from_min_mag\nFROM r_dets rd\nORDER BY rd.oid, rd.mjd\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "-- CV/Nova candidates (highest-probability class by stochastic light-curve classifier)\nWITH cvn_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n),\n-- Restrict to objects with at most 50 detections (from discovery to last detection)\nlimited_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM cvn_oids)\n      AND o.ndet <= 50\n),\n-- r-band detections with corrected photometry\nr_dets AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.ra,\n        d.dec,\n        d.magpsf_corr,\n        d.sigmapsf_corr,\n        d.mjd\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM limited_oids)\n      AND d.fid = 2                  -- r-band\n      AND d.corrected = TRUE         -- use corrected difference magnitudes\n)\nSELECT\n    rd.oid,                          -- object identifier\n    rd.candid,                       -- candidate identifier\n    rd.fid AS f_id,                  -- filter id as requested\n    rd.ra,                           -- detection RA\n    rd.dec,                          -- detection Dec\n    rd.magpsf_corr AS mag,           -- corrected difference magnitude (r-band)\n    rd.sigmapsf_corr AS mag_err,     -- magnitude error (PSF-corrected, r-band)\n    rd.magpsf_corr AS psf_corr_mag_r, -- PSF corrected magnitude in r-filter (explicit)\n    -- rise from the minimum corrected mag within each object (positive = fainter than brightest point)\n    rd.magpsf_corr - MIN(rd.magpsf_corr) OVER (PARTITION BY rd.oid) AS rise_from_min_mag,\n    -- maximum rise from minimum across r-band detections for the object\n    MAX(rd.magpsf_corr) OVER (PARTITION BY rd.oid) - MIN(rd.magpsf_corr) OVER (PARTITION BY rd.oid) AS max_rise_from_min_mag\nFROM r_dets rd\nORDER BY rd.oid, rd.mjd\nLIMIT 1000;"
                },
                "in_toks": 3232,
                "out_toks": 3823,
                "id": "chatcmpl-CSt1QuDiPrR8SOjsJiiAQ9CRbClUa",
                "created": 1761000724,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "39",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 705,
                "out_toks": 1879,
                "id": "chatcmpl-CSswjfoUqVQCflUMkzeBblu8Z0a4j",
                "created": 1761000433,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select r-band detections for objects whose most probable class (ranking=1) under the stochastic LC classifier is 'CV/Nova',\n-- and whose total number of detections is at most 50. Return identifiers, coordinates, magnitudes, errors,\n-- and window-based rise metrics relative to the minimum corrected PSF magnitude in r.\nSELECT\n    d.oid,                               -- object identifier\n    d.candid,                            -- candidate identifier\n    d.fid AS f_id,                       -- filter id (1=g; 2=r; 3=i)\n    d.ra,                                -- right ascension\n    d.dec,                               -- declination\n    d.magpsf AS magnitude,               -- PSF difference magnitude\n    d.sigmapsf AS magnitude_error,       -- PSF difference magnitude error\n    d.magpsf_corr,                       -- corrected PSF (apparent) magnitude in r\n    d.sigmapsf_corr,                     -- error of corrected PSF magnitude (point-like)\n    d.sigmapsf_corr_ext,                 -- error of corrected PSF magnitude (extended source)\n    -- Window stats per object in r-band:\n    MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS min_magpsf_corr_r,\n    MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_magpsf_corr_r,\n    -- Rise from the minimum corrected magnitude for this detection:\n    d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS rise_from_min_r,\n    -- Maximum rise from minimum across all r-band detections for the object:\n    MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_rise_from_min_r\nFROM detection d\nWHERE\n    d.fid = 2  -- r-band only\n    AND d.oid IN (\n        -- Objects with at most 50 detections (from discovery to last detection per object definition)\n        SELECT o.oid\n        FROM object o\n        WHERE o.ndet <= 50\n    )\n    AND d.oid IN (\n        -- Objects whose top-ranked class under the stochastic light curve classifier is 'CV/Nova'\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier_stochastic'\n          AND p.class_name = 'CV/Nova'\n          AND p.ranking = 1\n    )\nORDER BY d.oid\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select r-band detections for objects whose most probable class (ranking=1) under the stochastic LC classifier is 'CV/Nova',\n-- and whose total number of detections is at most 50. Return identifiers, coordinates, magnitudes, errors,\n-- and window-based rise metrics relative to the minimum corrected PSF magnitude in r.\nSELECT\n    d.oid,                               -- object identifier\n    d.candid,                            -- candidate identifier\n    d.fid AS f_id,                       -- filter id (1=g; 2=r; 3=i)\n    d.ra,                                -- right ascension\n    d.dec,                               -- declination\n    d.magpsf AS magnitude,               -- PSF difference magnitude\n    d.sigmapsf AS magnitude_error,       -- PSF difference magnitude error\n    d.magpsf_corr,                       -- corrected PSF (apparent) magnitude in r\n    d.sigmapsf_corr,                     -- error of corrected PSF magnitude (point-like)\n    d.sigmapsf_corr_ext,                 -- error of corrected PSF magnitude (extended source)\n    -- Window stats per object in r-band:\n    MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS min_magpsf_corr_r,\n    MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_magpsf_corr_r,\n    -- Rise from the minimum corrected magnitude for this detection:\n    d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS rise_from_min_r,\n    -- Maximum rise from minimum across all r-band detections for the object:\n    MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_rise_from_min_r\nFROM detection d\nWHERE\n    d.fid = 2  -- r-band only\n    AND d.oid IN (\n        -- Objects with at most 50 detections (from discovery to last detection per object definition)\n        SELECT o.oid\n        FROM object o\n        WHERE o.ndet <= 50\n    )\n    AND d.oid IN (\n        -- Objects whose top-ranked class under the stochastic light curve classifier is 'CV/Nova'\n        SELECT p.oid\n        FROM probability p\n        WHERE p.classifier_name = 'lc_classifier_stochastic'\n          AND p.class_name = 'CV/Nova'\n          AND p.ranking = 1\n    )\nORDER BY d.oid\nLIMIT 1000;"
                },
                "in_toks": 3232,
                "out_toks": 3040,
                "id": "chatcmpl-CSt1zSnIyV6XArQJGVr9tmCLE5YyD",
                "created": 1761000759,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "39",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 705,
                "out_toks": 1495,
                "id": "chatcmpl-CZNUmn5IrpPYnwSk51LpV2iPGq9jC",
                "created": 1762547832,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Get r-band detections for objects whose top-ranked class is CV/Nova by the stochastic LC classifier,\n-- with at most 50 detections overall. Return requested columns and compute the maximum rise from minimum\n-- (range of corrected PSF magnitudes in r) per object. Limit to first 1000 rows ordered by object id.\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 50\n      AND oid IN (\n          SELECT oid\n          FROM probability\n          WHERE classifier_name = 'lc_classifier_stochastic'\n            AND class_name = 'CV/Nova'\n            AND ranking = 1\n      )\n),\nr_detections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf_corr AS magpsf_corr_r,\n        d.sigmapsf_corr AS sigmapsf_corr_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM oids)\n      AND d.fid = 2                  -- r-band\n      AND d.corrected = TRUE         -- ensure using corrected magnitudes\n)\nSELECT\n    oid AS object_identifier,\n    candid AS candidate_identifier,\n    f_id,\n    ra,\n    dec,\n    magpsf_corr_r AS magnitude_r_psf_corr,       -- corrected difference magnitude (r)\n    sigmapsf_corr_r AS magnitude_error_r_psf_corr,\n    magpsf_corr_r AS psf_corrected_mag_r,        -- PSF corrected magnitude in r-filter (explicit column)\n    (MAX(magpsf_corr_r) OVER (PARTITION BY oid) - MIN(magpsf_corr_r) OVER (PARTITION BY oid)) AS max_rise_from_min_r\nFROM r_detections\nORDER BY object_identifier, candidate_identifier\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Get r-band detections for objects whose top-ranked class is CV/Nova by the stochastic LC classifier,\n-- with at most 50 detections overall. Return requested columns and compute the maximum rise from minimum\n-- (range of corrected PSF magnitudes in r) per object. Limit to first 1000 rows ordered by object id.\nWITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 50\n      AND oid IN (\n          SELECT oid\n          FROM probability\n          WHERE classifier_name = 'lc_classifier_stochastic'\n            AND class_name = 'CV/Nova'\n            AND ranking = 1\n      )\n),\nr_detections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf_corr AS magpsf_corr_r,\n        d.sigmapsf_corr AS sigmapsf_corr_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM oids)\n      AND d.fid = 2                  -- r-band\n      AND d.corrected = TRUE         -- ensure using corrected magnitudes\n)\nSELECT\n    oid AS object_identifier,\n    candid AS candidate_identifier,\n    f_id,\n    ra,\n    dec,\n    magpsf_corr_r AS magnitude_r_psf_corr,       -- corrected difference magnitude (r)\n    sigmapsf_corr_r AS magnitude_error_r_psf_corr,\n    magpsf_corr_r AS psf_corrected_mag_r,        -- PSF corrected magnitude in r-filter (explicit column)\n    (MAX(magpsf_corr_r) OVER (PARTITION BY oid) - MIN(magpsf_corr_r) OVER (PARTITION BY oid)) AS max_rise_from_min_r\nFROM r_detections\nORDER BY object_identifier, candidate_identifier\nLIMIT 1000;"
                },
                "in_toks": 3232,
                "out_toks": 3726,
                "id": "chatcmpl-CZRFAPpyfUHtKW6o11eF6GeqzZYE0",
                "created": 1762562240,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "39",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 705,
                "out_toks": 1111,
                "id": "chatcmpl-CZNVME363DO36Y8YRK1HKlpDBlESP",
                "created": 1762547868,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": "/*\nOptimized query using CTEs and JOINs to reduce scan size and avoid timeouts.\n\nReturn:\n- object identifier (oid)\n- candidate identifier (candid)\n- filter id as f_id\n- coordinates (ra, dec)\n- magnitude (PSF difference magnitude) and its error\n- corrected difference magnitude in r-band and its error\n- PSF corrected magnitude in r-band\n- per-object maximum rise from minimum (amplitude) in r-band using PSF-corrected magnitudes\n\nFilters:\n- Only objects with ndet <= 50\n- Only objects whose top-ranked class (ranking=1) under the stochastic light curve classifier is 'CV/Nova'\n- Only r-band detections (fid = 2)\n*/ WITH cvnova_oids AS\n  (/* Preselect OIDs by classification (3 conditions on probability) and detection count */  SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE o.ndet <= 50\n     AND p.classifier_name = 'lc_classifier_stochastic'\n     AND p.class_name = 'CV/Nova'\n     AND p.ranking = 1),\n        r_dets AS\n  (/* Restrict detections to r-band for the selected OIDs */  SELECT d.candid,\n                                                                     d.oid,\n                                                                     d.fid,\n                                                                     d.ra,\n                                                                     d.dec,\n                                                                     d.magpsf,\n                                                                     d.sigmapsf,\n                                                                     d.magpsf_corr,\n                                                                     d.sigmapsf_corr\n   FROM detection d\n   JOIN cvnova_oids c ON c.oid = d.oid\n   WHERE d.fid = 2),\n        r_stats AS\n  (/* Compute per-object min/max PSF-corrected magnitude in r-band */  SELECT oid,\n                                                                              MIN(magpsf_corr) AS min_magpsf_corr_r,\n                                                                              MAX(magpsf_corr) AS max_magpsf_corr_r\n   FROM r_dets\n   WHERE magpsf_corr IS NOT NULL\n   GROUP BY oid)\nSELECT r.oid,\n       r.candid,\n       r.fid AS f_id,\n       r.ra,\n       r.dec,\n       r.magpsf AS mag,\n       r.sigmapsf AS mag_err,\n       r.magpsf_corr AS corr_diff_mag_r,\n       r.sigmapsf_corr AS corr_diff_mag_err_r,\n       r.magpsf_corr AS psf_corrected_mag_r,\n       (s.max_magpsf_corr_r - s.min_magpsf_corr_r) AS max_rise_from_min_r\nFROM r_dets r\nLEFT JOIN r_stats s ON s.oid = r.oid\nORDER BY r.oid\nLIMIT 1000;",
            "sql_response": {
                "responses": {
                    "0": "/*\nOptimized query using CTEs and JOINs to reduce scan size and avoid timeouts.\n\nReturn:\n- object identifier (oid)\n- candidate identifier (candid)\n- filter id as f_id\n- coordinates (ra, dec)\n- magnitude (PSF difference magnitude) and its error\n- corrected difference magnitude in r-band and its error\n- PSF corrected magnitude in r-band\n- per-object maximum rise from minimum (amplitude) in r-band using PSF-corrected magnitudes\n\nFilters:\n- Only objects with ndet <= 50\n- Only objects whose top-ranked class (ranking=1) under the stochastic light curve classifier is 'CV/Nova'\n- Only r-band detections (fid = 2)\n*/ WITH cvnova_oids AS\n  (/* Preselect OIDs by classification (3 conditions on probability) and detection count */  SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE o.ndet <= 50\n     AND p.classifier_name = 'lc_classifier_stochastic'\n     AND p.class_name = 'CV/Nova'\n     AND p.ranking = 1),\n        r_dets AS\n  (/* Restrict detections to r-band for the selected OIDs */  SELECT d.candid,\n                                                                     d.oid,\n                                                                     d.fid,\n                                                                     d.ra,\n                                                                     d.dec,\n                                                                     d.magpsf,\n                                                                     d.sigmapsf,\n                                                                     d.magpsf_corr,\n                                                                     d.sigmapsf_corr\n   FROM detection d\n   JOIN cvnova_oids c ON c.oid = d.oid\n   WHERE d.fid = 2),\n        r_stats AS\n  (/* Compute per-object min/max PSF-corrected magnitude in r-band */  SELECT oid,\n                                                                              MIN(magpsf_corr) AS min_magpsf_corr_r,\n                                                                              MAX(magpsf_corr) AS max_magpsf_corr_r\n   FROM r_dets\n   WHERE magpsf_corr IS NOT NULL\n   GROUP BY oid)\nSELECT r.oid,\n       r.candid,\n       r.fid AS f_id,\n       r.ra,\n       r.dec,\n       r.magpsf AS mag,\n       r.sigmapsf AS mag_err,\n       r.magpsf_corr AS corr_diff_mag_r,\n       r.sigmapsf_corr AS corr_diff_mag_err_r,\n       r.magpsf_corr AS psf_corrected_mag_r,\n       (s.max_magpsf_corr_r - s.min_magpsf_corr_r) AS max_rise_from_min_r\nFROM r_dets r\nLEFT JOIN r_stats s ON s.oid = r.oid\nORDER BY r.oid\nLIMIT 1000;"
                },
                "in_toks": 2641,
                "out_toks": 2507,
                "id": "chatcmpl-CbAObxR4nXQSq1UJttNuArq4mLWO3",
                "created": 1762974133,
                "model": "gpt-5-2025-08-07"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* \nReturn:\n- object identifier (oid)\n- candidate identifier (candid)\n- filter id as f_id\n- coordinates (ra, dec)\n- magnitude (PSF difference magnitude) and its error\n- corrected difference magnitude in r-band and its error\n- PSF corrected magnitude in r-band\n- per-object maximum rise from minimum (amplitude) in r-band using PSF-corrected magnitudes\n\nFilters:\n- Keep only objects whose top-ranked class (ranking=1) under the stochastic light curve classifier is 'CV/Nova'\n- Keep only objects with ndet <= 50\n- Only r-band detections (fid = 2)\n\nNotes:\n- No explicit JOINs; OIDs are obtained via nested subqueries for probability and object.\n*/\n\nSELECT\n    q.oid,\n    q.candid,\n    q.fid AS f_id,\n    q.ra,\n    q.dec,\n    q.magpsf AS mag,\n    q.sigmapsf AS mag_err,\n    q.magpsf_corr AS corr_diff_mag_r,\n    q.sigmapsf_corr AS corr_diff_mag_err_r,\n    q.magpsf_corr AS psf_corrected_mag_r,\n    (q.max_magpsf_corr_r - q.min_magpsf_corr_r) AS max_rise_from_min_r\nFROM (\n    SELECT\n        d.*,\n        MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS min_magpsf_corr_r,\n        MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_magpsf_corr_r\n    FROM detection d\n    WHERE d.fid = 2  -- r-band\n      AND d.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet <= 50\n      )\n      AND d.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'lc_classifier_stochastic'\n            AND p.class_name = 'CV/Nova'\n            AND p.ranking = 1\n      )\n) q\nORDER BY q.oid\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "/* \nReturn:\n- object identifier (oid)\n- candidate identifier (candid)\n- filter id as f_id\n- coordinates (ra, dec)\n- magnitude (PSF difference magnitude) and its error\n- corrected difference magnitude in r-band and its error\n- PSF corrected magnitude in r-band\n- per-object maximum rise from minimum (amplitude) in r-band using PSF-corrected magnitudes\n\nFilters:\n- Keep only objects whose top-ranked class (ranking=1) under the stochastic light curve classifier is 'CV/Nova'\n- Keep only objects with ndet <= 50\n- Only r-band detections (fid = 2)\n\nNotes:\n- No explicit JOINs; OIDs are obtained via nested subqueries for probability and object.\n*/\n\nSELECT\n    q.oid,\n    q.candid,\n    q.fid AS f_id,\n    q.ra,\n    q.dec,\n    q.magpsf AS mag,\n    q.sigmapsf AS mag_err,\n    q.magpsf_corr AS corr_diff_mag_r,\n    q.sigmapsf_corr AS corr_diff_mag_err_r,\n    q.magpsf_corr AS psf_corrected_mag_r,\n    (q.max_magpsf_corr_r - q.min_magpsf_corr_r) AS max_rise_from_min_r\nFROM (\n    SELECT\n        d.*,\n        MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS min_magpsf_corr_r,\n        MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_magpsf_corr_r\n    FROM detection d\n    WHERE d.fid = 2  -- r-band\n      AND d.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet <= 50\n      )\n      AND d.oid IN (\n          SELECT p.oid\n          FROM probability p\n          WHERE p.classifier_name = 'lc_classifier_stochastic'\n            AND p.class_name = 'CV/Nova'\n            AND p.ranking = 1\n      )\n) q\nORDER BY q.oid\nLIMIT 1000;"
                },
                "in_toks": 3232,
                "out_toks": 3459,
                "id": "chatcmpl-CZRFAbAyatNPtbDzYSwjcVl0xHLiY",
                "created": 1762562240,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "39",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "detection",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'probability', 'taxonomy']"
                },
                "in_toks": 705,
                "out_toks": 2263,
                "id": "chatcmpl-CZNVnwuzQ5isVs5fAVmmUO9cewRFb",
                "created": 1762547895,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Objects whose top-ranked class (ranking=1) is 'CV/Nova' under the stochastic light curve classifier,\n   with at most 50 detections overall (object.ndet <= 50). Then, for r-band detections (fid=2),\n   return object and detection identifiers, filter id (as f_id), coordinates, magnitudes and their errors,\n   including corrected PSF magnitudes, and compute per-object maximum rise from minimum (using magpsf_corr)\n   within the r-band. Limit to the first 1000 rows ordered by object identifier. */\nSELECT\n    d.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,            -- PSF difference magnitude\n    d.sigmapsf,          -- PSF difference magnitude error\n    d.magpsf_corr,       -- corrected (PSF) magnitude in r-band\n    d.sigmapsf_corr,     -- error of corrected (PSF) magnitude\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_r\nFROM detection d\nWHERE\n    d.fid = 2  -- r-band\n    AND d.oid IN (\n        SELECT o.oid\n        FROM object o\n        WHERE\n            o.ndet <= 50\n            AND o.oid IN (\n                SELECT p.oid\n                FROM probability p\n                WHERE\n                    p.classifier_name = 'lc_classifier_stochastic'\n                    AND p.class_name = 'CV/Nova'\n                    AND p.ranking = 1\n            )\n    )\nORDER BY d.oid\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Objects whose top-ranked class (ranking=1) is 'CV/Nova' under the stochastic light curve classifier,\n   with at most 50 detections overall (object.ndet <= 50). Then, for r-band detections (fid=2),\n   return object and detection identifiers, filter id (as f_id), coordinates, magnitudes and their errors,\n   including corrected PSF magnitudes, and compute per-object maximum rise from minimum (using magpsf_corr)\n   within the r-band. Limit to the first 1000 rows ordered by object identifier. */\nSELECT\n    d.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,            -- PSF difference magnitude\n    d.sigmapsf,          -- PSF difference magnitude error\n    d.magpsf_corr,       -- corrected (PSF) magnitude in r-band\n    d.sigmapsf_corr,     -- error of corrected (PSF) magnitude\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_r\nFROM detection d\nWHERE\n    d.fid = 2  -- r-band\n    AND d.oid IN (\n        SELECT o.oid\n        FROM object o\n        WHERE\n            o.ndet <= 50\n            AND o.oid IN (\n                SELECT p.oid\n                FROM probability p\n                WHERE\n                    p.classifier_name = 'lc_classifier_stochastic'\n                    AND p.class_name = 'CV/Nova'\n                    AND p.ranking = 1\n            )\n    )\nORDER BY d.oid\nLIMIT 1000;"
                },
                "in_toks": 3232,
                "out_toks": 3642,
                "id": "chatcmpl-CZRFNyzt7kKb6SpO35roUMJIGStHW",
                "created": 1762562253,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "39",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 705,
                "out_toks": 1751,
                "id": "chatcmpl-CZNX69enCA5XQM3K4tlTXzHKs0QUz",
                "created": 1762547976,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "/* Get r-band detections for objects whose top-ranked class is CV/Nova under the stochastic LC classifier,\n   and with at most 50 detections. Return requested columns and compute max rise from min (using magpsf_corr). */\nWITH candidate_oids AS (\n    /* Obtain OIDs whose highest-probability class is CV/Nova for lc_classifier_stochastic,\n       and with total detections (ndet) <= 50 */\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet <= 50\n      )\n)\nSELECT\n    d.oid AS oid,                       -- object identifier\n    d.candid AS candid,                 -- candidate identifier\n    d.fid AS f_id,                      -- filter id (1=g, 2=r, 3=i)\n    d.ra AS ra,                         -- detection RA\n    d.dec AS dec,                       -- detection Dec\n    d.magpsf AS magnitude_psf,          -- PSF difference magnitude\n    d.sigmapsf AS magnitude_psf_err,    -- PSF difference magnitude error\n    d.magpsf_corr AS magnitude_psf_corr,        -- PSF corrected (apparent) magnitude (corrected difference magnitude)\n    d.sigmapsf_corr AS magnitude_psf_corr_err,  -- PSF corrected magnitude error\n    /* Maximum rise from minimum (amplitude) in r-band per object using corrected PSF magnitudes */\n    MAX(d.magpsf_corr) OVER (PARTITION BY d.oid)\n      - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_rise_from_min\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM candidate_oids)\n  AND d.fid = 2              -- r-band\n  AND d.corrected = TRUE     -- use corrected magnitudes\nORDER BY d.oid\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "/* Get r-band detections for objects whose top-ranked class is CV/Nova under the stochastic LC classifier,\n   and with at most 50 detections. Return requested columns and compute max rise from min (using magpsf_corr). */\nWITH candidate_oids AS (\n    /* Obtain OIDs whose highest-probability class is CV/Nova for lc_classifier_stochastic,\n       and with total detections (ndet) <= 50 */\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet <= 50\n      )\n)\nSELECT\n    d.oid AS oid,                       -- object identifier\n    d.candid AS candid,                 -- candidate identifier\n    d.fid AS f_id,                      -- filter id (1=g, 2=r, 3=i)\n    d.ra AS ra,                         -- detection RA\n    d.dec AS dec,                       -- detection Dec\n    d.magpsf AS magnitude_psf,          -- PSF difference magnitude\n    d.sigmapsf AS magnitude_psf_err,    -- PSF difference magnitude error\n    d.magpsf_corr AS magnitude_psf_corr,        -- PSF corrected (apparent) magnitude (corrected difference magnitude)\n    d.sigmapsf_corr AS magnitude_psf_corr_err,  -- PSF corrected magnitude error\n    /* Maximum rise from minimum (amplitude) in r-band per object using corrected PSF magnitudes */\n    MAX(d.magpsf_corr) OVER (PARTITION BY d.oid)\n      - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_rise_from_min\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM candidate_oids)\n  AND d.fid = 2              -- r-band\n  AND d.corrected = TRUE     -- use corrected magnitudes\nORDER BY d.oid\nLIMIT 1000;"
                },
                "in_toks": 3232,
                "out_toks": 3587,
                "id": "chatcmpl-CZRAZ04uOTQfZ81W1PChRv4c6N8UQ",
                "created": 1762561955,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "39",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 705,
                "out_toks": 1559,
                "id": "chatcmpl-CZNXsjqrtpqRrHzrcZldpzuSieTdZ",
                "created": 1762548024,
                "model": "gpt-5-2025-08-07"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- CV/Nova (highest-probability) objects by the stochastic light curve classifier (ranking=1),\n-- further restricted to objects with ndet <= 50. We then fetch their r-band (fid=2) detections\n-- and compute rise-from-min and max-rise-from-min using the PSF corrected magnitude (magpsf_corr).\nWITH selected_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet <= 50\n      )\n)\nSELECT\n    d.oid AS oid,                     -- object identifier\n    d.candid AS candid,               -- candidate identifier\n    d.fid AS f_id,                    -- filter id (r-band = 2)\n    d.ra AS ra,                       -- detection RA\n    d.dec AS dec,                     -- detection Dec\n    -- Magnitudes and errors:\n    d.magpsf_corr AS magpsf_corr_r,       -- corrected PSF magnitude (r-band)\n    d.sigmapsf_corr AS err_magpsf_corr_r, -- error of corrected PSF magnitude\n    d.sigmapsf_corr_ext AS err_magpsf_corr_ext_r, -- extended-source error (if applicable)\n    d.magpsf AS magpsf_r,                 -- PSF difference magnitude (uncorrected; included for completeness)\n    d.sigmapsf AS err_magpsf_r,           -- error of uncorrected PSF magnitude\n    -- Rise from minimum (per detection) and maximum rise from minimum (per object) using magpsf_corr:\n    (d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS rise_from_min_magpsf_corr_r,\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_magpsf_corr_r\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\n  AND d.fid = 2  -- r-band\nORDER BY d.oid\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "-- CV/Nova (highest-probability) objects by the stochastic light curve classifier (ranking=1),\n-- further restricted to objects with ndet <= 50. We then fetch their r-band (fid=2) detections\n-- and compute rise-from-min and max-rise-from-min using the PSF corrected magnitude (magpsf_corr).\nWITH selected_oids AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n      AND p.class_name = 'CV/Nova'\n      AND p.ranking = 1\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.ndet <= 50\n      )\n)\nSELECT\n    d.oid AS oid,                     -- object identifier\n    d.candid AS candid,               -- candidate identifier\n    d.fid AS f_id,                    -- filter id (r-band = 2)\n    d.ra AS ra,                       -- detection RA\n    d.dec AS dec,                     -- detection Dec\n    -- Magnitudes and errors:\n    d.magpsf_corr AS magpsf_corr_r,       -- corrected PSF magnitude (r-band)\n    d.sigmapsf_corr AS err_magpsf_corr_r, -- error of corrected PSF magnitude\n    d.sigmapsf_corr_ext AS err_magpsf_corr_ext_r, -- extended-source error (if applicable)\n    d.magpsf AS magpsf_r,                 -- PSF difference magnitude (uncorrected; included for completeness)\n    d.sigmapsf AS err_magpsf_r,           -- error of uncorrected PSF magnitude\n    -- Rise from minimum (per detection) and maximum rise from minimum (per object) using magpsf_corr:\n    (d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS rise_from_min_magpsf_corr_r,\n    (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise_from_min_magpsf_corr_r\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM selected_oids)\n  AND d.fid = 2  -- r-band\nORDER BY d.oid\nLIMIT 1000;"
                },
                "in_toks": 3232,
                "out_toks": 3314,
                "id": "chatcmpl-CZRAZMOHTvUgz8ZZ73FDXUOYO6Ist",
                "created": 1762561955,
                "model": "gpt-5-2025-08-07"
            },
            "correction_applied": false
        }
    }
}