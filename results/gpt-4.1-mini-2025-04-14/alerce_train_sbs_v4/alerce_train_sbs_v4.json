{
    "13": {
        "0": {
            "req_id": 13,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 780,
                "out_toks": 14,
                "id": "chatcmpl-BgrX8z7JUs5JXZOJWy7nY8Vmjj4Pu",
                "created": 1749555258,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    p.class_name, \n    o.firstmjd, \n    o.lastmjd, \n    o.oid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND o.firstmjd BETWEEN 59914.0 AND 60217.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p.class_name, \n    o.firstmjd, \n    o.lastmjd, \n    o.oid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND o.firstmjd BETWEEN 59914.0 AND 60217.0;\n```"
                },
                "in_toks": 2467,
                "out_toks": 117,
                "id": "chatcmpl-BgxqWY4kB3ERl5RLMIGohzMxxAihu",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1104,
                "out_toks": 6,
                "id": "chatcmpl-BgrXB6aPzLP2x6idv6sDdbUuCiOEP",
                "created": 1749555261,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 13,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 780,
                "out_toks": 14,
                "id": "chatcmpl-BgrX8z7JUs5JXZOJWy7nY8Vmjj4Pu",
                "created": 1749555258,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    p.class_name, \n    o.firstmjd, \n    o.lastmjd, \n    o.oid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND o.firstmjd BETWEEN 59914.0 AND 60217.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p.class_name, \n    o.firstmjd, \n    o.lastmjd, \n    o.oid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND o.firstmjd BETWEEN 59914.0 AND 60217.0;\n```"
                },
                "in_toks": 2467,
                "out_toks": 117,
                "id": "chatcmpl-BgxqWUgGaxro01Kf8lCOaa1dAaoY2",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1104,
                "out_toks": 6,
                "id": "chatcmpl-BgrXDY83o90cTZLtUqy4ylBX8bZuO",
                "created": 1749555263,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "10": {
        "0": {
            "req_id": 10,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 816,
                "out_toks": 14,
                "id": "chatcmpl-BgrXFrGBG3MijGW1cIh2RxCOfF8Ie",
                "created": 1749555265,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH ranked_probs AS (\n    SELECT\n        oid,\n        class_name,\n        probability,\n        ranking\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking IN (1, 2)\n      AND class_name IN ('SNIa', 'CV/Nova')\n)\nSELECT\n    p1.oid,\n    p1.probability AS SN_prob,\n    p2.probability AS CV_prob\nFROM\n    ranked_probs p1\nJOIN\n    ranked_probs p2 ON p1.oid = p2.oid\nWHERE\n    p1.class_name = 'SNIa' AND p1.ranking = 1\n    AND p2.class_name = 'CV/Nova' AND p2.ranking = 2\n    AND ABS(p1.probability - p2.probability) < 0.1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH ranked_probs AS (\n    SELECT\n        oid,\n        class_name,\n        probability,\n        ranking\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking IN (1, 2)\n      AND class_name IN ('SNIa', 'CV/Nova')\n)\nSELECT\n    p1.oid,\n    p1.probability AS SN_prob,\n    p2.probability AS CV_prob\nFROM\n    ranked_probs p1\nJOIN\n    ranked_probs p2 ON p1.oid = p2.oid\nWHERE\n    p1.class_name = 'SNIa' AND p1.ranking = 1\n    AND p2.class_name = 'CV/Nova' AND p2.ranking = 2\n    AND ABS(p1.probability - p2.probability) < 0.1;\n```"
                },
                "in_toks": 2457,
                "out_toks": 182,
                "id": "chatcmpl-BgxqXKbFh2eZatWus8fUnfXUjXWgC",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1140,
                "out_toks": 6,
                "id": "chatcmpl-BgrXIDhswwRRIWZDxL34xPyzMb6mb",
                "created": 1749555268,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 10,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 816,
                "out_toks": 14,
                "id": "chatcmpl-BgrXFrGBG3MijGW1cIh2RxCOfF8Ie",
                "created": 1749555265,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH ranked_probs AS (\n    SELECT\n        oid,\n        class_name,\n        probability,\n        ranking\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking IN (1, 2)\n      AND class_name IN ('SNIa', 'CV/Nova')\n)\nSELECT\n    p1.oid,\n    p1.probability AS SN_prob,\n    p2.probability AS CV_prob\nFROM\n    ranked_probs p1\nJOIN\n    ranked_probs p2 ON p1.oid = p2.oid\nWHERE\n    p1.class_name = 'SNIa'\n    AND p1.ranking = 1\n    AND p2.class_name = 'CV/Nova'\n    AND p2.ranking = 2\n    AND ABS(p1.probability - p2.probability) < 0.1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH ranked_probs AS (\n    SELECT\n        oid,\n        class_name,\n        probability,\n        ranking\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking IN (1, 2)\n      AND class_name IN ('SNIa', 'CV/Nova')\n)\nSELECT\n    p1.oid,\n    p1.probability AS SN_prob,\n    p2.probability AS CV_prob\nFROM\n    ranked_probs p1\nJOIN\n    ranked_probs p2 ON p1.oid = p2.oid\nWHERE\n    p1.class_name = 'SNIa'\n    AND p1.ranking = 1\n    AND p2.class_name = 'CV/Nova'\n    AND p2.ranking = 2\n    AND ABS(p1.probability - p2.probability) < 0.1;\n```"
                },
                "in_toks": 2457,
                "out_toks": 184,
                "id": "chatcmpl-BgxqUnlxJ1B8q5Pdp7U42zRaN9OAI",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1140,
                "out_toks": 6,
                "id": "chatcmpl-BgrXIVQYoAlib5s99SDgNKNO0KBde",
                "created": 1749555268,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "15": {
        "0": {
            "req_id": 15,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']",
                    "1": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 831,
                "out_toks": 36,
                "id": "chatcmpl-BgrXJdSwEsgMr3o9ghjmvZvqdUAz8",
                "created": 1749555269,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects classified as 'SN' by the stamp_classifier with highest probability (ranking=1)\n-- Filter objects with first detection in first two days of September (MJD 60188.0 to 60189.0)\n-- Filter fast risers: dmag_first / dt_first >= 0.25 in magstat for the same filter as detection\n-- Return oid, probability, candid, detection fid, magstat fid as magstat_fid, and dmag_first\n-- Order by oid\n\nWITH sn_objects AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n),\nfirst_detect AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT m.oid, m.fid AS magstat_fid, m.dmag_first, m.dt_first\n    FROM magstat m\n    WHERE m.dt_first > 0\n      AND (m.dmag_first / m.dt_first) >= 0.25\n)\n\nSELECT \n    d.oid,\n    s.probability,\n    d.candid,\n    d.fid,\n    f.magstat_fid,\n    f.dmag_first\nFROM sn_objects s\nINNER JOIN first_detect fd ON s.oid = fd.oid\nINNER JOIN fast_risers f ON s.oid = f.oid\nINNER JOIN detection d ON s.oid = d.oid\n-- Ensure detection filter matches magstat filter for initial rise estimate\nWHERE d.fid = f.magstat_fid\nORDER BY d.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as 'SN' by the stamp_classifier with highest probability (ranking=1)\n-- Filter objects with first detection in first two days of September (MJD 60188.0 to 60189.0)\n-- Filter fast risers: dmag_first / dt_first >= 0.25 in magstat for the same filter as detection\n-- Return oid, probability, candid, detection fid, magstat fid as magstat_fid, and dmag_first\n-- Order by oid\n\nWITH sn_objects AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n),\nfirst_detect AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT m.oid, m.fid AS magstat_fid, m.dmag_first, m.dt_first\n    FROM magstat m\n    WHERE m.dt_first > 0\n      AND (m.dmag_first / m.dt_first) >= 0.25\n)\n\nSELECT \n    d.oid,\n    s.probability,\n    d.candid,\n    d.fid,\n    f.magstat_fid,\n    f.dmag_first\nFROM sn_objects s\nINNER JOIN first_detect fd ON s.oid = fd.oid\nINNER JOIN fast_risers f ON s.oid = f.oid\nINNER JOIN detection d ON s.oid = d.oid\n-- Ensure detection filter matches magstat filter for initial rise estimate\nWHERE d.fid = f.magstat_fid\nORDER BY d.oid;\n```"
                },
                "in_toks": 2966,
                "out_toks": 375,
                "id": "chatcmpl-Bh2sOB8lPKMeicfVAq9jWaaGdj47x",
                "created": 1749598860,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 4851,
                "out_toks": 6,
                "id": "chatcmpl-BgrXKcLLmmlI9NseWLK7WZsMojTS0",
                "created": 1749555270,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that fulfills the user request, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - Use the `probability` table to filter objects classified by the `stamp_classifier` with the highest probability (ranking=1) for class `'SN'`.\n     - Columns needed: `oid`, `probability`, `class_name`, `classifier_name`, `ranking`.\n   - Use the `object` table to get the object identifiers (`oid`) and the time of first detection (`firstmjd`).\n   - Use the `detection` table to retrieve the light curve detections for the objects, including `oid`, `candid`, `fid` (filter ID), and other detection details.\n   - Use the `magstat` table to get the filter ID (`fid`) as `magstat_fid` and the initial rise estimate, which corresponds to the feature `dmag_first` for the relevant filter.\n     - Note: The initial rise estimate is defined as the difference in magnitude between the last non-detection and the first detection in the same filter, which corresponds to the `dmag_first` column in `magstat`.\n\n2. **Apply Classification Filter:**\n   - Filter the `probability` table for:\n     - `classifier_name = 'stamp_classifier'`\n     - `class_name = 'SN'`\n     - `ranking = 1` (to get the highest probability class only)\n   - This will yield the list of object IDs (`oid`) classified as SN with the highest probability by the stamp classifier.\n\n3. **Filter Objects by First Detection Date:**\n   - Join the filtered `probability` results with the `object` table on `oid`.\n   - Filter objects whose `firstmjd` is between 60188.0 and 60189.0 inclusive, corresponding to the first two days of September.\n\n4. **Identify Fast Risers:**\n   - The fast riser condition requires that the initial rise rate is at least 0.25 magnitudes/day.\n   - The initial rise rate can be calculated as the difference in magnitude between the last non-detection and the first detection divided by the time difference between these two events.\n   - The `magstat` table contains `dmag_first` (difference in magnitude at first detection) and `dt_first` (time difference between last non-detection and first detection) for each filter.\n   - Join the `magstat` table on `oid` to get these values.\n   - Filter for `dmag_first / dt_first >= 0.25` to select fast risers.\n   - Also, ensure that the `magstat` entries correspond to the same filter as the first detection filter in the `detection` table (or at least consistent with the filter used for the initial rise estimate).\n   - Since the user wants the filter ID from `magstat` as `magstat_fid`, include `magstat.fid` in the output.\n\n5. **Retrieve Light Curve Detections:**\n   - Join the `detection` table on `oid` to get all detections for the selected objects.\n   - Include columns: `oid`, `candid`, `fid` (filter ID).\n   - Only include detections (all rows in `detection` correspond to detections).\n   - No additional filtering on detections is specified, so include all detections for the selected objects.\n\n6. **Retrieve Probabilities from Stamp Classifier:**\n   - For each selected object, retrieve the probability value from the `probability` table for the `stamp_classifier` and class `'SN'` (already filtered in step 2).\n   - Include the `probability` column in the output.\n\n7. **Select and Alias Columns:**\n   - Select the following columns in the final output:\n     - `oid` (object identifier)\n     - `probability` (from `probability` table for `stamp_classifier` and class `'SN'`)\n     - `candid` (from `detection` table)\n     - `fid` (filter ID from `detection` table)\n     - `magstat_fid` (alias for `magstat.fid`)\n     - `dmag_first` (initial rise estimate from `magstat`)\n\n8. **Join Strategy:**\n   - Start from the filtered `probability` table (step 2).\n   - Join with `object` to filter by `firstmjd` (step 3).\n   - Join with `magstat` to get initial rise parameters and filter by fast riser condition (step 4).\n   - Join with `detection` to get light curve detections (step 5).\n   - Ensure joins are on `oid`.\n   - Use INNER JOINs to ensure only objects meeting all criteria are included.\n\n9. **Ordering:**\n   - Order the final results by `oid` ascending.\n\n10. **Additional Considerations:**\n    - Ensure that the `magstat` entries used correspond to the same filter as the first detection filter or at least are consistent with the initial rise estimate definition.\n    - If multiple filters exist for an object in `magstat`, consider selecting the filter corresponding to the first detection filter or the filter with the maximum initial rise rate.\n    - If the user does not specify, include all detections regardless of filter.\n    - Use the exact column and table names as specified.\n    - Apply the default condition for `probability` table: `ranking=1` and `classifier_name='stamp_classifier'` for the classification filter.\n    - The user wants the probability from the stamp classifier, so do not include probabilities from other classifiers.\n\nBy following these steps, the resulting query will retrieve the object identifiers, their highest probability for class `'SN'` from the stamp classifier, all detections (with candid and filter ID), the filter ID from `magstat` as `magstat_fid`, and the initial rise estimate (`dmag_first`), for objects first detected in the first two days of September and qualifying as fast risers, ordered by `oid`.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that fulfills the user request, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - Use the `probability` table to filter objects classified by the `stamp_classifier` with the highest probability (ranking=1) for class `'SN'`.\n     - Columns needed: `oid`, `probability`, `class_name`, `classifier_name`, `ranking`.\n   - Use the `object` table to get the object identifiers (`oid`) and the time of first detection (`firstmjd`).\n   - Use the `detection` table to retrieve the light curve detections for the objects, including `oid`, `candid`, `fid` (filter ID), and other detection details.\n   - Use the `magstat` table to get the filter ID (`fid`) as `magstat_fid` and the initial rise estimate, which corresponds to the feature `dmag_first` for the relevant filter.\n     - Note: The initial rise estimate is defined as the difference in magnitude between the last non-detection and the first detection in the same filter, which corresponds to the `dmag_first` column in `magstat`.\n\n2. **Apply Classification Filter:**\n   - Filter the `probability` table for:\n     - `classifier_name = 'stamp_classifier'`\n     - `class_name = 'SN'`\n     - `ranking = 1` (to get the highest probability class only)\n   - This will yield the list of object IDs (`oid`) classified as SN with the highest probability by the stamp classifier.\n\n3. **Filter Objects by First Detection Date:**\n   - Join the filtered `probability` results with the `object` table on `oid`.\n   - Filter objects whose `firstmjd` is between 60188.0 and 60189.0 inclusive, corresponding to the first two days of September.\n\n4. **Identify Fast Risers:**\n   - The fast riser condition requires that the initial rise rate is at least 0.25 magnitudes/day.\n   - The initial rise rate can be calculated as the difference in magnitude between the last non-detection and the first detection divided by the time difference between these two events.\n   - The `magstat` table contains `dmag_first` (difference in magnitude at first detection) and `dt_first` (time difference between last non-detection and first detection) for each filter.\n   - Join the `magstat` table on `oid` to get these values.\n   - Filter for `dmag_first / dt_first >= 0.25` to select fast risers.\n   - Also, ensure that the `magstat` entries correspond to the same filter as the first detection filter in the `detection` table (or at least consistent with the filter used for the initial rise estimate).\n   - Since the user wants the filter ID from `magstat` as `magstat_fid`, include `magstat.fid` in the output.\n\n5. **Retrieve Light Curve Detections:**\n   - Join the `detection` table on `oid` to get all detections for the selected objects.\n   - Include columns: `oid`, `candid`, `fid` (filter ID).\n   - Only include detections (all rows in `detection` correspond to detections).\n   - No additional filtering on detections is specified, so include all detections for the selected objects.\n\n6. **Retrieve Probabilities from Stamp Classifier:**\n   - For each selected object, retrieve the probability value from the `probability` table for the `stamp_classifier` and class `'SN'` (already filtered in step 2).\n   - Include the `probability` column in the output.\n\n7. **Select and Alias Columns:**\n   - Select the following columns in the final output:\n     - `oid` (object identifier)\n     - `probability` (from `probability` table for `stamp_classifier` and class `'SN'`)\n     - `candid` (from `detection` table)\n     - `fid` (filter ID from `detection` table)\n     - `magstat_fid` (alias for `magstat.fid`)\n     - `dmag_first` (initial rise estimate from `magstat`)\n\n8. **Join Strategy:**\n   - Start from the filtered `probability` table (step 2).\n   - Join with `object` to filter by `firstmjd` (step 3).\n   - Join with `magstat` to get initial rise parameters and filter by fast riser condition (step 4).\n   - Join with `detection` to get light curve detections (step 5).\n   - Ensure joins are on `oid`.\n   - Use INNER JOINs to ensure only objects meeting all criteria are included.\n\n9. **Ordering:**\n   - Order the final results by `oid` ascending.\n\n10. **Additional Considerations:**\n    - Ensure that the `magstat` entries used correspond to the same filter as the first detection filter or at least are consistent with the initial rise estimate definition.\n    - If multiple filters exist for an object in `magstat`, consider selecting the filter corresponding to the first detection filter or the filter with the maximum initial rise rate.\n    - If the user does not specify, include all detections regardless of filter.\n    - Use the exact column and table names as specified.\n    - Apply the default condition for `probability` table: `ranking=1` and `classifier_name='stamp_classifier'` for the classification filter.\n    - The user wants the probability from the stamp classifier, so do not include probabilities from other classifiers.\n\nBy following these steps, the resulting query will retrieve the object identifiers, their highest probability for class `'SN'` from the stamp classifier, all detections (with candid and filter ID), the filter ID from `magstat` as `magstat_fid`, and the initial rise estimate (`dmag_first`), for objects first detected in the first two days of September and qualifying as fast risers, ordered by `oid`."
                },
                "in_toks": 6538,
                "out_toks": 1266,
                "id": "chatcmpl-Bh1x3sZ2nPfQ2Y7ZU52TUcK4JO1wU",
                "created": 1749595305,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        },
        "1": {
            "req_id": 15,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']",
                    "1": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 831,
                "out_toks": 36,
                "id": "chatcmpl-BgrXJdSwEsgMr3o9ghjmvZvqdUAz8",
                "created": 1749555269,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    p.oid,\n    p.probability,\n    d.candid,\n    d.fid,\n    m.fid AS magstat_fid,\n    m.dmag_first\nFROM \n    probability p\nINNER JOIN \n    object o ON p.oid = o.oid\nINNER JOIN \n    magstat m ON p.oid = m.oid\nINNER JOIN \n    detection d ON p.oid = d.oid\nWHERE \n    p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND o.firstmjd >= 60188.0\n    AND o.firstmjd < 60190.0\n    AND m.dmag_first >= 0.25\nORDER BY \n    p.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p.oid,\n    p.probability,\n    d.candid,\n    d.fid,\n    m.fid AS magstat_fid,\n    m.dmag_first\nFROM \n    probability p\nINNER JOIN \n    object o ON p.oid = o.oid\nINNER JOIN \n    magstat m ON p.oid = m.oid\nINNER JOIN \n    detection d ON p.oid = d.oid\nWHERE \n    p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND o.firstmjd >= 60188.0\n    AND o.firstmjd < 60190.0\n    AND m.dmag_first >= 0.25\nORDER BY \n    p.oid;\n```"
                },
                "in_toks": 2840,
                "out_toks": 171,
                "id": "chatcmpl-Bh2sPHkLltPHNJ15co19ENDrwQHt5",
                "created": 1749598861,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 4851,
                "out_toks": 6,
                "id": "chatcmpl-BgrXLGVgoqpIjxx3ZTw4W62nQVqYS",
                "created": 1749555271,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - Use the `probability` table to filter objects classified by the `stamp_classifier` with the highest probability for class `'SN'`.\n     - Columns: `oid`, `class_name`, `classifier_name`, `probability`, `ranking`.\n   - Use the `object` table to get object identifiers and first detection times.\n     - Columns: `oid`, `firstmjd`.\n   - Use the `detection` table to retrieve light curve detections for the objects.\n     - Columns: `oid`, `candid`, `fid` (filter ID), `mjd`.\n   - Use the `magstat` table to get the filter ID (`fid`) and the initial rise estimate feature.\n     - Columns: `oid`, `fid` (to be aliased as `magstat_fid`), and the feature related to initial rise (likely `dmag_first` or similar, but since the user requests \"initial rise estimate,\" it corresponds to the feature `dmag_first` in `magstat`).\n\n2. **Apply Classification Filter:**\n   - Filter the `probability` table for:\n     - `classifier_name = 'stamp_classifier'`\n     - `class_name = 'SN'`\n     - `ranking = 1` (to get the highest probability class only)\n   - This will give the list of objects (`oid`) classified as SN with the highest confidence by the stamp classifier.\n\n3. **Filter Objects by First Detection Date:**\n   - Use the `object` table to filter objects whose `firstmjd` is within the first two days of September.\n     - Since MJD for September 1 is 60188.0 and for September 2 is 60189.0, filter for `firstmjd >= 60188.0` and `firstmjd < 60190.0` (to include both days fully).\n\n4. **Identify Fast Risers:**\n   - The definition of a fast riser is an object whose first detection is brighter by at least 0.25 magnitudes/day than the last non-detection before the first detection, both in the same filter.\n   - This information is stored in the `magstat` table, specifically in the column `dmag_first` (difference in magnitude between last non-detection and first detection in the same filter).\n   - Filter for `dmag_first >= 0.25` to select fast risers.\n   - Also, ensure that the `magstat` entries correspond to the same object (`oid`) and that the `firstmjd` in `magstat` aligns with the first detection date.\n   - Since the user wants the filter ID from `magstat` as `magstat_fid`, select `fid` from `magstat` and alias it accordingly.\n\n5. **Retrieve Light Curve Detections:**\n   - From the `detection` table, select all detections (`oid`, `candid`, `fid`) for the filtered objects.\n   - Join on `oid` to ensure only detections for the selected objects are included.\n   - No additional filtering on detection dates is specified, so include all detections for these objects.\n   - Include the filter ID (`fid`) and candidate ID (`candid`) as requested.\n\n6. **Combine Data from Multiple Tables:**\n   - Join the filtered `probability` table (step 2) with the `object` table (step 3) on `oid`.\n   - Join the result with the `magstat` table (step 4) on `oid` to get the filter ID and initial rise estimate.\n   - Join with the `detection` table (step 5) on `oid` to get the light curve detections.\n   - Ensure that the joins maintain the filtering conditions and do not multiply rows unnecessarily.\n\n7. **Select Required Columns:**\n   - From `object` or `probability`: `oid`.\n   - From `probability`: `probability` (for the stamp classifier).\n   - From `detection`: `candid`, `fid` (filter ID).\n   - From `magstat`: `fid` aliased as `magstat_fid`, and the initial rise estimate (`dmag_first`).\n\n8. **Ordering the Results:**\n   - Order the final results by `oid` ascending as requested.\n\n9. **Additional Considerations:**\n   - Use the default condition for `probability.ranking = 1` and `classifier_name = 'stamp_classifier'` unless specified otherwise.\n   - Ensure that the `magstat` entries correspond to the same correction step or version if applicable, or use the latest available.\n   - Since the user wants only detections (light curves), avoid including non-detection data.\n   - If multiple `magstat` entries exist per object (due to different filters), include all relevant ones or clarify if only one filter is needed.\n   - Use appropriate INNER JOINs to ensure only objects meeting all criteria are included.\n\nBy following these steps, the resulting query will efficiently retrieve the object identifiers, their highest stamp classifier probabilities for class 'SN', the light curve detections with candid and filter ID, the filter ID from `magstat` as `magstat_fid`, and the initial rise estimate, all filtered by first detection date and fast riser criteria, ordered by object ID.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - Use the `probability` table to filter objects classified by the `stamp_classifier` with the highest probability for class `'SN'`.\n     - Columns: `oid`, `class_name`, `classifier_name`, `probability`, `ranking`.\n   - Use the `object` table to get object identifiers and first detection times.\n     - Columns: `oid`, `firstmjd`.\n   - Use the `detection` table to retrieve light curve detections for the objects.\n     - Columns: `oid`, `candid`, `fid` (filter ID), `mjd`.\n   - Use the `magstat` table to get the filter ID (`fid`) and the initial rise estimate feature.\n     - Columns: `oid`, `fid` (to be aliased as `magstat_fid`), and the feature related to initial rise (likely `dmag_first` or similar, but since the user requests \"initial rise estimate,\" it corresponds to the feature `dmag_first` in `magstat`).\n\n2. **Apply Classification Filter:**\n   - Filter the `probability` table for:\n     - `classifier_name = 'stamp_classifier'`\n     - `class_name = 'SN'`\n     - `ranking = 1` (to get the highest probability class only)\n   - This will give the list of objects (`oid`) classified as SN with the highest confidence by the stamp classifier.\n\n3. **Filter Objects by First Detection Date:**\n   - Use the `object` table to filter objects whose `firstmjd` is within the first two days of September.\n     - Since MJD for September 1 is 60188.0 and for September 2 is 60189.0, filter for `firstmjd >= 60188.0` and `firstmjd < 60190.0` (to include both days fully).\n\n4. **Identify Fast Risers:**\n   - The definition of a fast riser is an object whose first detection is brighter by at least 0.25 magnitudes/day than the last non-detection before the first detection, both in the same filter.\n   - This information is stored in the `magstat` table, specifically in the column `dmag_first` (difference in magnitude between last non-detection and first detection in the same filter).\n   - Filter for `dmag_first >= 0.25` to select fast risers.\n   - Also, ensure that the `magstat` entries correspond to the same object (`oid`) and that the `firstmjd` in `magstat` aligns with the first detection date.\n   - Since the user wants the filter ID from `magstat` as `magstat_fid`, select `fid` from `magstat` and alias it accordingly.\n\n5. **Retrieve Light Curve Detections:**\n   - From the `detection` table, select all detections (`oid`, `candid`, `fid`) for the filtered objects.\n   - Join on `oid` to ensure only detections for the selected objects are included.\n   - No additional filtering on detection dates is specified, so include all detections for these objects.\n   - Include the filter ID (`fid`) and candidate ID (`candid`) as requested.\n\n6. **Combine Data from Multiple Tables:**\n   - Join the filtered `probability` table (step 2) with the `object` table (step 3) on `oid`.\n   - Join the result with the `magstat` table (step 4) on `oid` to get the filter ID and initial rise estimate.\n   - Join with the `detection` table (step 5) on `oid` to get the light curve detections.\n   - Ensure that the joins maintain the filtering conditions and do not multiply rows unnecessarily.\n\n7. **Select Required Columns:**\n   - From `object` or `probability`: `oid`.\n   - From `probability`: `probability` (for the stamp classifier).\n   - From `detection`: `candid`, `fid` (filter ID).\n   - From `magstat`: `fid` aliased as `magstat_fid`, and the initial rise estimate (`dmag_first`).\n\n8. **Ordering the Results:**\n   - Order the final results by `oid` ascending as requested.\n\n9. **Additional Considerations:**\n   - Use the default condition for `probability.ranking = 1` and `classifier_name = 'stamp_classifier'` unless specified otherwise.\n   - Ensure that the `magstat` entries correspond to the same correction step or version if applicable, or use the latest available.\n   - Since the user wants only detections (light curves), avoid including non-detection data.\n   - If multiple `magstat` entries exist per object (due to different filters), include all relevant ones or clarify if only one filter is needed.\n   - Use appropriate INNER JOINs to ensure only objects meeting all criteria are included.\n\nBy following these steps, the resulting query will efficiently retrieve the object identifiers, their highest stamp classifier probabilities for class 'SN', the light curve detections with candid and filter ID, the filter ID from `magstat` as `magstat_fid`, and the initial rise estimate, all filtered by first detection date and fast riser criteria, ordered by object ID."
                },
                "in_toks": 6538,
                "out_toks": 1140,
                "id": "chatcmpl-Bh1wsZ0MFh5dvxsOF6kVPAaZ5pigi",
                "created": 1749595294,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        }
    },
    "4": {
        "0": {
            "req_id": 4,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "magstat",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat', 'detection']",
                    "1": "['object', 'probability', 'magstat', 'detection']"
                },
                "in_toks": 817,
                "out_toks": 30,
                "id": "chatcmpl-BgrXRRbaIrmvyhDYh38pms2LP9hS3",
                "created": 1749555277,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    m.dmdt_first,\n    d.fid,\n    d.mjd\nFROM \n    probability p\n    INNER JOIN object o ON p.oid = o.oid\n    INNER JOIN magstat m ON o.oid = m.oid AND m.fid IN (1, 2)\n    INNER JOIN detection d ON o.oid = d.oid\nWHERE \n    p.class_name = 'SNII'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.6\n    AND o.ndet > 50\n    AND m.dmdt_first > 0.5\n    AND d.fid IN (1, 2)\n    AND d.mjd BETWEEN 58484 AND 59926\nORDER BY \n    o.oid,\n    d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    m.dmdt_first,\n    d.fid,\n    d.mjd\nFROM \n    probability p\n    INNER JOIN object o ON p.oid = o.oid\n    INNER JOIN magstat m ON o.oid = m.oid AND m.fid IN (1, 2)\n    INNER JOIN detection d ON o.oid = d.oid\nWHERE \n    p.class_name = 'SNII'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.6\n    AND o.ndet > 50\n    AND m.dmdt_first > 0.5\n    AND d.fid IN (1, 2)\n    AND d.mjd BETWEEN 58484 AND 59926\nORDER BY \n    o.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2690,
                "out_toks": 208,
                "id": "chatcmpl-Bh2sPYOeZBLf4PyeG7pwt1twbG04c",
                "created": 1749598861,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 2406,
                "out_toks": 6,
                "id": "chatcmpl-BgrXTG88oGEBuNOWIjR2mli0e0Ebq",
                "created": 1749555279,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main object identifier is in the `object` table (`oid`).\n   - Candidate identifier (`candid`), magnitudes, magnitude errors, time of detection (`mjd`), and band identifiers (`fid`) are in the `detection` table.\n   - Classification information, including class name, classifier name, probability, and ranking, is in the `probability` table.\n   - Initial rise estimate (initial rise rate) is represented by `dmdt_first` in the `magstat` table.\n   - Number of detections (`ndet`) is available in the `object` table.\n   \n2. **Define the Selection Criteria Based on User Request:**\n   - Objects classified as 'SNII' (Supernova Type II) by the light curve classifier (`classifier_name = 'lc_classifier'`).\n   - Probability of classification greater than 0.6.\n   - Classification ranking must be 1 (most likely class).\n   - Time range for detections between 2019 and 2022. Since time is stored as Modified Julian Date (MJD), convert the calendar years 2019-2022 to MJD ranges:\n     - 2019-01-01 corresponds approximately to MJD 58484.\n     - 2022-12-31 corresponds approximately to MJD 59926.\n   - Initial rise rate (`dmdt_first`) greater than 0.5 mag/day.\n   - Band identifiers limited to ZTF g and r bands (`fid` in (1, 2)).\n   - Number of detections (`ndet`) greater than 50.\n   \n3. **Determine the Necessary Joins Between Tables:**\n   - Join `probability` and `object` tables on `oid` to filter objects classified as 'SNII' with the required probability and ranking.\n   - Join `magstat` on `oid` to filter objects with initial rise rate (`dmdt_first`) > 0.5 and to ensure the band is g or r (`fid` in (1, 2)).\n   - Join `detection` on `oid` to retrieve candidate identifiers (`candid`), magnitudes (`magpsf` or `magpsf_corr`), magnitude errors (`sigmapsf` or `sigmapsf_corr`), band identifiers (`fid`), and detection times (`mjd`).\n   \n4. **Apply Filters and Conditions:**\n   - Filter `probability` table for:\n     - `class_name = 'SNII'`\n     - `classifier_name = 'lc_classifier'`\n     - `ranking = 1`\n     - `probability > 0.6`\n   - Filter `object` table for:\n     - `ndet > 50`\n   - Filter `magstat` table for:\n     - `dmdt_first > 0.5`\n     - `fid` in (1, 2) (g and r bands)\n   - Filter `detection` table for:\n     - `fid` in (1, 2) (g and r bands)\n     - `mjd` between 58484 and 59926 (corresponding to 2019-2022)\n   \n5. **Select Required Columns:**\n   - From `object`: `oid` (object identifier)\n   - From `detection`: `candid` (candidate identifier), `magpsf` or `magpsf_corr` (magnitude), `sigmapsf` or `sigmapsf_corr` (magnitude error), `fid` (band identifier), `mjd` (time of detection)\n   - From `magstat`: `dmdt_first` (initial rise estimate)\n   \n6. **Decide on the Type of Join:**\n   - Use INNER JOINs to ensure only objects meeting all criteria are included.\n   - Join `probability` to `object` on `oid`.\n   - Join `magstat` to `object` on `oid` and filter by band.\n   - Join `detection` to `object` on `oid` and filter by band and time.\n   \n7. **Ordering and Output:**\n   - Order results by `oid` and `mjd` to show the time evolution of magnitudes for each object.\n   \n8. **Summary of the Query Logic:**\n   - Start from `probability` filtered by class 'SNII', classifier 'lc_classifier', ranking 1, and probability > 0.6.\n   - Join to `object` filtered by `ndet > 50`.\n   - Join to `magstat` filtered by `dmdt_first > 0.5` and `fid` in (1, 2).\n   - Join to `detection` filtered by `fid` in (1, 2) and `mjd` between 58484 and 59926.\n   - Select the requested columns.\n   - Order by object and detection time.\n   \nThis decomposition ensures the query is efficient, uses appropriate filters, and retrieves all requested information accurately.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main object identifier is in the `object` table (`oid`).\n   - Candidate identifier (`candid`), magnitudes, magnitude errors, time of detection (`mjd`), and band identifiers (`fid`) are in the `detection` table.\n   - Classification information, including class name, classifier name, probability, and ranking, is in the `probability` table.\n   - Initial rise estimate (initial rise rate) is represented by `dmdt_first` in the `magstat` table.\n   - Number of detections (`ndet`) is available in the `object` table.\n   \n2. **Define the Selection Criteria Based on User Request:**\n   - Objects classified as 'SNII' (Supernova Type II) by the light curve classifier (`classifier_name = 'lc_classifier'`).\n   - Probability of classification greater than 0.6.\n   - Classification ranking must be 1 (most likely class).\n   - Time range for detections between 2019 and 2022. Since time is stored as Modified Julian Date (MJD), convert the calendar years 2019-2022 to MJD ranges:\n     - 2019-01-01 corresponds approximately to MJD 58484.\n     - 2022-12-31 corresponds approximately to MJD 59926.\n   - Initial rise rate (`dmdt_first`) greater than 0.5 mag/day.\n   - Band identifiers limited to ZTF g and r bands (`fid` in (1, 2)).\n   - Number of detections (`ndet`) greater than 50.\n   \n3. **Determine the Necessary Joins Between Tables:**\n   - Join `probability` and `object` tables on `oid` to filter objects classified as 'SNII' with the required probability and ranking.\n   - Join `magstat` on `oid` to filter objects with initial rise rate (`dmdt_first`) > 0.5 and to ensure the band is g or r (`fid` in (1, 2)).\n   - Join `detection` on `oid` to retrieve candidate identifiers (`candid`), magnitudes (`magpsf` or `magpsf_corr`), magnitude errors (`sigmapsf` or `sigmapsf_corr`), band identifiers (`fid`), and detection times (`mjd`).\n   \n4. **Apply Filters and Conditions:**\n   - Filter `probability` table for:\n     - `class_name = 'SNII'`\n     - `classifier_name = 'lc_classifier'`\n     - `ranking = 1`\n     - `probability > 0.6`\n   - Filter `object` table for:\n     - `ndet > 50`\n   - Filter `magstat` table for:\n     - `dmdt_first > 0.5`\n     - `fid` in (1, 2) (g and r bands)\n   - Filter `detection` table for:\n     - `fid` in (1, 2) (g and r bands)\n     - `mjd` between 58484 and 59926 (corresponding to 2019-2022)\n   \n5. **Select Required Columns:**\n   - From `object`: `oid` (object identifier)\n   - From `detection`: `candid` (candidate identifier), `magpsf` or `magpsf_corr` (magnitude), `sigmapsf` or `sigmapsf_corr` (magnitude error), `fid` (band identifier), `mjd` (time of detection)\n   - From `magstat`: `dmdt_first` (initial rise estimate)\n   \n6. **Decide on the Type of Join:**\n   - Use INNER JOINs to ensure only objects meeting all criteria are included.\n   - Join `probability` to `object` on `oid`.\n   - Join `magstat` to `object` on `oid` and filter by band.\n   - Join `detection` to `object` on `oid` and filter by band and time.\n   \n7. **Ordering and Output:**\n   - Order results by `oid` and `mjd` to show the time evolution of magnitudes for each object.\n   \n8. **Summary of the Query Logic:**\n   - Start from `probability` filtered by class 'SNII', classifier 'lc_classifier', ranking 1, and probability > 0.6.\n   - Join to `object` filtered by `ndet > 50`.\n   - Join to `magstat` filtered by `dmdt_first > 0.5` and `fid` in (1, 2).\n   - Join to `detection` filtered by `fid` in (1, 2) and `mjd` between 58484 and 59926.\n   - Select the requested columns.\n   - Order by object and detection time.\n   \nThis decomposition ensures the query is efficient, uses appropriate filters, and retrieves all requested information accurately."
                },
                "in_toks": 4013,
                "out_toks": 1083,
                "id": "chatcmpl-Bh1wsq5B7w62X5ToIRF77oWmw1KwT",
                "created": 1749595294,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        },
        "1": {
            "req_id": 4,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "magstat",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat', 'detection']",
                    "1": "['object', 'probability', 'magstat', 'detection']"
                },
                "in_toks": 817,
                "out_toks": 30,
                "id": "chatcmpl-BgrXRRbaIrmvyhDYh38pms2LP9hS3",
                "created": 1749555277,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    m.dmdt_first,\n    d.fid,\n    d.mjd\nFROM \n    probability p\n    INNER JOIN object o ON p.oid = o.oid\n    INNER JOIN magstat m ON o.oid = m.oid AND m.fid IN (1, 2)\n    INNER JOIN detection d ON o.oid = d.oid\nWHERE \n    p.class_name = 'SNII'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.6\n    AND o.ndet > 50\n    AND m.dmdt_first > 0.5\n    AND d.fid IN (1, 2)\n    AND d.mjd BETWEEN 58484 AND 59927\nORDER BY \n    o.oid,\n    d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    m.dmdt_first,\n    d.fid,\n    d.mjd\nFROM \n    probability p\n    INNER JOIN object o ON p.oid = o.oid\n    INNER JOIN magstat m ON o.oid = m.oid AND m.fid IN (1, 2)\n    INNER JOIN detection d ON o.oid = d.oid\nWHERE \n    p.class_name = 'SNII'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.6\n    AND o.ndet > 50\n    AND m.dmdt_first > 0.5\n    AND d.fid IN (1, 2)\n    AND d.mjd BETWEEN 58484 AND 59927\nORDER BY \n    o.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2822,
                "out_toks": 208,
                "id": "chatcmpl-Bh2hr7YtpcIkKbxRDdU4B1Yq3iMiH",
                "created": 1749598207,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 2406,
                "out_toks": 6,
                "id": "chatcmpl-BgrXTnQc2mVznsl9Bkd29LdeTTweD",
                "created": 1749555279,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main object identifier (`oid`) is in the **object** table.\n   - Candidate identifier (`candid`), magnitudes, magnitude errors, time of detection (`mjd`), and band identifiers (`fid`) are in the **detection** table.\n   - Initial rise estimate corresponds to the magnitude change rate at first detection, which is stored as `dmdt_first` in the **magstat** table.\n   - Classification information, including class name and probability, is in the **probability** table.\n   - Number of detections (`ndet`) is in the **object** table.\n   - The time range filter (2019-2022) applies to the detection times (`mjd`), which are in Modified Julian Date (MJD). The MJD range for 2019-2022 needs to be calculated or approximated.\n\n2. **Define Filtering Criteria:**\n   - Select objects classified as 'SNII' (Supernova Type II) with:\n     - `probability.class_name = 'SNII'`\n     - `probability.classifier_name = 'lc_classifier'` (default condition)\n     - `probability.ranking = 1` (default condition to get the most likely class)\n     - `probability.probability > 0.6`\n   - Objects must have:\n     - Number of detections (`object.ndet`) greater than 50.\n   - Initial rise rate (`magstat.dmdt_first`) greater than 0.5 mag/day.\n   - Band identifiers restricted to ZTF g and r bands, which correspond to `fid` values 1 (g) and 2 (r).\n   - Time of detections (`detection.mjd`) within the years 2019 to 2022. Convert calendar years to MJD:\n     - Approximate MJD for 2019-01-01: 58484\n     - Approximate MJD for 2022-12-31: 59927\n     - Filter detections with `mjd` between 58484 and 59927.\n\n3. **Determine Table Joins and Relationships:**\n   - Join **probability** to **object** on `oid` to filter objects by classification and probability.\n   - Join **magstat** to **object** on `oid` to filter by initial rise rate (`dmdt_first`) and band (`fid`).\n   - Join **detection** to **object** on `oid` to retrieve candidate identifiers, magnitudes, magnitude errors, band identifiers, and detection times.\n   - Ensure that the joins maintain the filtering conditions and do not multiply rows unnecessarily.\n\n4. **Select Required Columns:**\n   - From **object**: `oid` (object identifier).\n   - From **detection**: `candid` (candidate identifier), `magpsf` (magnitude), `sigmapsf` (magnitude error), `fid` (band identifier), `mjd` (time of detection).\n   - From **magstat**: `dmdt_first` (initial rise rate).\n   - Optionally, include `step_id_corr` or other relevant columns if needed for data provenance or filtering.\n\n5. **Apply Filtering Conditions in the Query:**\n   - Filter on `probability.class_name = 'SNII'`, `probability.classifier_name = 'lc_classifier'`, `probability.ranking = 1`, and `probability.probability > 0.6`.\n   - Filter on `object.ndet > 50`.\n   - Filter on `magstat.dmdt_first > 0.5` and `magstat.fid IN (1, 2)` to restrict to g and r bands.\n   - Filter on `detection.mjd` between 58484 and 59927.\n   - Filter on `detection.fid IN (1, 2)` to restrict detections to g and r bands.\n\n6. **Consider Query Performance and Index Usage:**\n   - Use indexed columns for filtering where possible (`probability.ranking`, `probability.classifier_name`, `probability.class_name`, `object.ndet`, `magstat.dmdt_first`, `detection.mjd`, `detection.fid`).\n   - Use INNER JOINs to ensure only matching records are returned.\n   - Avoid unnecessary columns in SELECT to optimize performance.\n\n7. **Order and Format the Results:**\n   - Order results by `oid` and `mjd` to present detections chronologically per object.\n   - Return all requested columns clearly labeled.\n\n8. **Summary of the Query Logic:**\n   - Start from the **probability** table filtered by class 'SNII', classifier 'lc_classifier', ranking 1, and probability > 0.6.\n   - Join to **object** to get `oid` and `ndet > 50`.\n   - Join to **magstat** filtered by `dmdt_first > 0.5` and `fid` in (1, 2).\n   - Join to **detection** filtered by `mjd` in 2019-2022 and `fid` in (1, 2).\n   - Select the requested columns: `oid`, `candid`, `magpsf`, `sigmapsf`, `dmdt_first`, `fid`, and `mjd`.\n   - Order by `oid` and `mjd`.\n\nThis decomposition plan ensures the query will retrieve the object identifiers, candidate identifiers, magnitudes, magnitude errors, initial rise estimates, and band identifiers as a function of time for SN II classified objects meeting the specified criteria in the years 2019-2022.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main object identifier (`oid`) is in the **object** table.\n   - Candidate identifier (`candid`), magnitudes, magnitude errors, time of detection (`mjd`), and band identifiers (`fid`) are in the **detection** table.\n   - Initial rise estimate corresponds to the magnitude change rate at first detection, which is stored as `dmdt_first` in the **magstat** table.\n   - Classification information, including class name and probability, is in the **probability** table.\n   - Number of detections (`ndet`) is in the **object** table.\n   - The time range filter (2019-2022) applies to the detection times (`mjd`), which are in Modified Julian Date (MJD). The MJD range for 2019-2022 needs to be calculated or approximated.\n\n2. **Define Filtering Criteria:**\n   - Select objects classified as 'SNII' (Supernova Type II) with:\n     - `probability.class_name = 'SNII'`\n     - `probability.classifier_name = 'lc_classifier'` (default condition)\n     - `probability.ranking = 1` (default condition to get the most likely class)\n     - `probability.probability > 0.6`\n   - Objects must have:\n     - Number of detections (`object.ndet`) greater than 50.\n   - Initial rise rate (`magstat.dmdt_first`) greater than 0.5 mag/day.\n   - Band identifiers restricted to ZTF g and r bands, which correspond to `fid` values 1 (g) and 2 (r).\n   - Time of detections (`detection.mjd`) within the years 2019 to 2022. Convert calendar years to MJD:\n     - Approximate MJD for 2019-01-01: 58484\n     - Approximate MJD for 2022-12-31: 59927\n     - Filter detections with `mjd` between 58484 and 59927.\n\n3. **Determine Table Joins and Relationships:**\n   - Join **probability** to **object** on `oid` to filter objects by classification and probability.\n   - Join **magstat** to **object** on `oid` to filter by initial rise rate (`dmdt_first`) and band (`fid`).\n   - Join **detection** to **object** on `oid` to retrieve candidate identifiers, magnitudes, magnitude errors, band identifiers, and detection times.\n   - Ensure that the joins maintain the filtering conditions and do not multiply rows unnecessarily.\n\n4. **Select Required Columns:**\n   - From **object**: `oid` (object identifier).\n   - From **detection**: `candid` (candidate identifier), `magpsf` (magnitude), `sigmapsf` (magnitude error), `fid` (band identifier), `mjd` (time of detection).\n   - From **magstat**: `dmdt_first` (initial rise rate).\n   - Optionally, include `step_id_corr` or other relevant columns if needed for data provenance or filtering.\n\n5. **Apply Filtering Conditions in the Query:**\n   - Filter on `probability.class_name = 'SNII'`, `probability.classifier_name = 'lc_classifier'`, `probability.ranking = 1`, and `probability.probability > 0.6`.\n   - Filter on `object.ndet > 50`.\n   - Filter on `magstat.dmdt_first > 0.5` and `magstat.fid IN (1, 2)` to restrict to g and r bands.\n   - Filter on `detection.mjd` between 58484 and 59927.\n   - Filter on `detection.fid IN (1, 2)` to restrict detections to g and r bands.\n\n6. **Consider Query Performance and Index Usage:**\n   - Use indexed columns for filtering where possible (`probability.ranking`, `probability.classifier_name`, `probability.class_name`, `object.ndet`, `magstat.dmdt_first`, `detection.mjd`, `detection.fid`).\n   - Use INNER JOINs to ensure only matching records are returned.\n   - Avoid unnecessary columns in SELECT to optimize performance.\n\n7. **Order and Format the Results:**\n   - Order results by `oid` and `mjd` to present detections chronologically per object.\n   - Return all requested columns clearly labeled.\n\n8. **Summary of the Query Logic:**\n   - Start from the **probability** table filtered by class 'SNII', classifier 'lc_classifier', ranking 1, and probability > 0.6.\n   - Join to **object** to get `oid` and `ndet > 50`.\n   - Join to **magstat** filtered by `dmdt_first > 0.5` and `fid` in (1, 2).\n   - Join to **detection** filtered by `mjd` in 2019-2022 and `fid` in (1, 2).\n   - Select the requested columns: `oid`, `candid`, `magpsf`, `sigmapsf`, `dmdt_first`, `fid`, and `mjd`.\n   - Order by `oid` and `mjd`.\n\nThis decomposition plan ensures the query will retrieve the object identifiers, candidate identifiers, magnitudes, magnitude errors, initial rise estimates, and band identifiers as a function of time for SN II classified objects meeting the specified criteria in the years 2019-2022."
                },
                "in_toks": 4013,
                "out_toks": 1215,
                "id": "chatcmpl-BgxqU3ELzWGexxqFs5gsV1Q42vQN0",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        }
    },
    "25": {
        "0": {
            "req_id": 25,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 14,
                "id": "chatcmpl-BgrXU0wYXgDsBB03ywJyXkf44HshY",
                "created": 1749555280,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH catalog AS (\n    SELECT 'source_1' AS source_id, 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 'source_2', 174.21524897555543, 44.83789535222221\n)\nSELECT object.*, probability.*, catalog.source_id\nFROM object\nINNER JOIN catalog\n    ON q3c_join(object.meanra, object.meandec, catalog.ra, catalog.dec, 10)\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.ranking = 1\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.class_name = 'SN'\n    AND probability.probability > 0.4\nWHERE object.firstmjd BETWEEN 59976.0 AND 59982.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH catalog AS (\n    SELECT 'source_1' AS source_id, 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 'source_2', 174.21524897555543, 44.83789535222221\n)\nSELECT object.*, probability.*, catalog.source_id\nFROM object\nINNER JOIN catalog\n    ON q3c_join(object.meanra, object.meandec, catalog.ra, catalog.dec, 10)\nINNER JOIN probability\n    ON object.oid = probability.oid\n    AND probability.ranking = 1\n    AND probability.classifier_name = 'stamp_classifier'\n    AND probability.class_name = 'SN'\n    AND probability.probability > 0.4\nWHERE object.firstmjd BETWEEN 59976.0 AND 59982.0;\n```"
                },
                "in_toks": 2420,
                "out_toks": 184,
                "id": "chatcmpl-Bh2hshGzjpJbwCNdHaMR9CLM8hWG2",
                "created": 1749598208,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 1150,
                "out_toks": 6,
                "id": "chatcmpl-BgrXViLoM4KYdeMRd6kgy2AJ1y7MV",
                "created": 1749555281,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves objects from the ALeRCE database based on the user's request, follow this detailed decomposition plan:\n\n1. **Define the Input Positions and Radius:**\n   - Create a temporary inline table (using a WITH clause) named, for example, `catalog`, containing the three sources with their identifiers and celestial coordinates (right ascension and declination):\n     - 'source_1' at RA=160.18301441363647, Dec=33.0164673528409\n     - 'source_2' at RA=174.21524897555543, Dec=44.83789535222221\n   - The search radius is 10 degrees around each source position.\n\n2. **Select Objects Within 10 Degrees of the Given Positions:**\n   - Use the Q3C extension function `q3c_join` to perform a spatial join between the `object` table and the `catalog` temporary table.\n   - The join condition should check if the object's mean coordinates (`meanra`, `meandec`) lie within 10 degrees of any of the catalog positions.\n   - This will filter objects spatially near the specified sources.\n\n3. **Filter Objects by First Detection Date:**\n   - Use the `firstmjd` column in the `object` table to filter objects whose first detection occurred within the first 7 days of February.\n   - According to the external knowledge, the Modified Julian Date (MJD) for February 1 is 59976.0 and for February 7 is 59982.0.\n   - Apply a `WHERE` clause to select objects with `firstmjd` between 59976.0 and 59982.0 inclusive.\n\n4. **Join with the Probability Table for Classification Filtering:**\n   - Join the `object` table with the `probability` table on the `oid` column to access classification probabilities.\n   - Apply the default conditions for the `probability` table:\n     - `ranking = 1` to select only the most likely class.\n     - `classifier_name = 'stamp_classifier'` as specified by the user.\n   - Filter for classes related to supernovae (SN) in the `stamp_classifier`.\n     - According to the general context, the `stamp_classifier` classes include 'SN', 'AGN', 'VS', 'asteroid', 'bogus'.\n     - Since the user requests SN probabilities > 0.4, filter for `class_name = 'SN'`.\n   - Apply a probability threshold condition: `probability > 0.4`.\n\n5. **Select the Required Columns:**\n   - Since the user did not specify particular columns, select all columns (`SELECT *`) from the joined tables (`object` and `probability`).\n   - Optionally, include the source identifier from the `catalog` table to indicate which input source each object is near.\n\n6. **Combine All Conditions and Joins:**\n   - The query will involve:\n     - A WITH clause defining the `catalog` table with the input sources.\n     - An INNER JOIN between `object` and `catalog` using `q3c_join` for spatial filtering.\n     - An INNER JOIN between `object` and `probability` for classification filtering.\n     - WHERE clauses for date filtering (`firstmjd`), classification filtering (`ranking`, `classifier_name`, `class_name`), and probability threshold.\n\n7. **Ordering and Final Output:**\n   - If desired, order the results by probability descending to prioritize higher confidence SN classifications.\n   - Otherwise, no specific ordering is required.\n\nThis decomposition ensures the query efficiently retrieves objects near the specified positions, detected in the first week of February, classified as supernovae by the stamp classifier with high confidence.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves objects from the ALeRCE database based on the user's request, follow this detailed decomposition plan:\n\n1. **Define the Input Positions and Radius:**\n   - Create a temporary inline table (using a WITH clause) named, for example, `catalog`, containing the three sources with their identifiers and celestial coordinates (right ascension and declination):\n     - 'source_1' at RA=160.18301441363647, Dec=33.0164673528409\n     - 'source_2' at RA=174.21524897555543, Dec=44.83789535222221\n   - The search radius is 10 degrees around each source position.\n\n2. **Select Objects Within 10 Degrees of the Given Positions:**\n   - Use the Q3C extension function `q3c_join` to perform a spatial join between the `object` table and the `catalog` temporary table.\n   - The join condition should check if the object's mean coordinates (`meanra`, `meandec`) lie within 10 degrees of any of the catalog positions.\n   - This will filter objects spatially near the specified sources.\n\n3. **Filter Objects by First Detection Date:**\n   - Use the `firstmjd` column in the `object` table to filter objects whose first detection occurred within the first 7 days of February.\n   - According to the external knowledge, the Modified Julian Date (MJD) for February 1 is 59976.0 and for February 7 is 59982.0.\n   - Apply a `WHERE` clause to select objects with `firstmjd` between 59976.0 and 59982.0 inclusive.\n\n4. **Join with the Probability Table for Classification Filtering:**\n   - Join the `object` table with the `probability` table on the `oid` column to access classification probabilities.\n   - Apply the default conditions for the `probability` table:\n     - `ranking = 1` to select only the most likely class.\n     - `classifier_name = 'stamp_classifier'` as specified by the user.\n   - Filter for classes related to supernovae (SN) in the `stamp_classifier`.\n     - According to the general context, the `stamp_classifier` classes include 'SN', 'AGN', 'VS', 'asteroid', 'bogus'.\n     - Since the user requests SN probabilities > 0.4, filter for `class_name = 'SN'`.\n   - Apply a probability threshold condition: `probability > 0.4`.\n\n5. **Select the Required Columns:**\n   - Since the user did not specify particular columns, select all columns (`SELECT *`) from the joined tables (`object` and `probability`).\n   - Optionally, include the source identifier from the `catalog` table to indicate which input source each object is near.\n\n6. **Combine All Conditions and Joins:**\n   - The query will involve:\n     - A WITH clause defining the `catalog` table with the input sources.\n     - An INNER JOIN between `object` and `catalog` using `q3c_join` for spatial filtering.\n     - An INNER JOIN between `object` and `probability` for classification filtering.\n     - WHERE clauses for date filtering (`firstmjd`), classification filtering (`ranking`, `classifier_name`, `class_name`), and probability threshold.\n\n7. **Ordering and Final Output:**\n   - If desired, order the results by probability descending to prioritize higher confidence SN classifications.\n   - Otherwise, no specific ordering is required.\n\nThis decomposition ensures the query efficiently retrieves objects near the specified positions, detected in the first week of February, classified as supernovae by the stamp classifier with high confidence."
                },
                "in_toks": 2785,
                "out_toks": 776,
                "id": "chatcmpl-BgxqWxVJRjJaYNeReAF2VY3248J0i",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        },
        "1": {
            "req_id": 25,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 14,
                "id": "chatcmpl-BgrXU0wYXgDsBB03ywJyXkf44HshY",
                "created": 1749555280,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n    ('source_1', 160.18301441363647, 33.0164673528409),\n    ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN catalog c ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)\nWHERE o.firstmjd BETWEEN 59976.0 AND 59982.0\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'SN'\n  AND p.probability > 0.4;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n    ('source_1', 160.18301441363647, 33.0164673528409),\n    ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN catalog c ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)\nWHERE o.firstmjd BETWEEN 59976.0 AND 59982.0\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'SN'\n  AND p.probability > 0.4;\n```"
                },
                "in_toks": 2495,
                "out_toks": 178,
                "id": "chatcmpl-BgxqUg2m0OCce4tV3ngDF3YftVXbq",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1150,
                "out_toks": 6,
                "id": "chatcmpl-BgrXWymtm8EHPWKQMuODDhoGj5HVd",
                "created": 1749555282,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "7": {
        "0": {
            "req_id": 7,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 773,
                "out_toks": 14,
                "id": "chatcmpl-BgrXYbpfBNFNNdp7Y8ITEzD2cGYfS",
                "created": 1749555284,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT p.oid, p.probability\nFROM probability p\nJOIN object o ON p.oid = o.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'SN'\n  AND o.firstmjd >= 59945.0\n  AND o.firstmjd <= 59975.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT p.oid, p.probability\nFROM probability p\nJOIN object o ON p.oid = o.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'SN'\n  AND o.firstmjd >= 59945.0\n  AND o.firstmjd <= 59975.0;\n```"
                },
                "in_toks": 2444,
                "out_toks": 84,
                "id": "chatcmpl-BgxqVEje4LgK13Jbus6ussBfyT2qq",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1097,
                "out_toks": 6,
                "id": "chatcmpl-BgrXs4Fp6hUy609gLBL0JxV6yGTp9",
                "created": 1749555304,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 7,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 773,
                "out_toks": 14,
                "id": "chatcmpl-BgrXYbpfBNFNNdp7Y8ITEzD2cGYfS",
                "created": 1749555284,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT p.oid, p.probability\nFROM probability p\nJOIN object o ON p.oid = o.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'SN'\n  AND o.firstmjd BETWEEN 59945.0 AND 59975.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT p.oid, p.probability\nFROM probability p\nJOIN object o ON p.oid = o.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'SN'\n  AND o.firstmjd BETWEEN 59945.0 AND 59975.0;\n```"
                },
                "in_toks": 2444,
                "out_toks": 77,
                "id": "chatcmpl-BgxqVTakCctmttI21DDhMdfPKgSm4",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1097,
                "out_toks": 6,
                "id": "chatcmpl-BgrXtujC3zj03ZjulmcDr4oaFsrvJ",
                "created": 1749555305,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "2": {
        "0": {
            "req_id": 2,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 760,
                "out_toks": 14,
                "id": "chatcmpl-BgrXtNsNvJRnU6JojMCfNEzU0amPW",
                "created": 1749555305,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'YSO'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'YSO'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7;\n```"
                },
                "in_toks": 2402,
                "out_toks": 65,
                "id": "chatcmpl-BgxqVC5BI9sY0bvmY8dGAeSuyzsLz",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1084,
                "out_toks": 6,
                "id": "chatcmpl-BgrY0neZ8aoGfYGjCfyNVTUcs0YSY",
                "created": 1749555312,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 2,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 760,
                "out_toks": 14,
                "id": "chatcmpl-BgrXtNsNvJRnU6JojMCfNEzU0amPW",
                "created": 1749555305,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'YSO'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'YSO'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7;\n```"
                },
                "in_toks": 2402,
                "out_toks": 65,
                "id": "chatcmpl-BgxqXJpQ3uEHrHbRiuyfncBCRDI8T",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1084,
                "out_toks": 6,
                "id": "chatcmpl-BgrY0AQZ2sTdz2kOlzdG7YFHbwfyU",
                "created": 1749555312,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "3": {
        "0": {
            "req_id": 3,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 764,
                "out_toks": 14,
                "id": "chatcmpl-BgrY1cHCw14npzLRyZ0AdtnxDg60a",
                "created": 1749555313,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'YSO'\n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'YSO'\n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;\n```"
                },
                "in_toks": 2427,
                "out_toks": 84,
                "id": "chatcmpl-BgxqV0ZLOcD1OQg5DQL8KVHcZqhgt",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1088,
                "out_toks": 6,
                "id": "chatcmpl-BgrY2UViWjHRX7IZjmpRiGEcfrk0T",
                "created": 1749555314,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 3,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 764,
                "out_toks": 14,
                "id": "chatcmpl-BgrY1cHCw14npzLRyZ0AdtnxDg60a",
                "created": 1749555313,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'YSO'\n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'YSO'\n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;\n```"
                },
                "in_toks": 2427,
                "out_toks": 84,
                "id": "chatcmpl-BgxqUb3oSLy0xiRklwFIlnnQE8Nm5",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1088,
                "out_toks": 6,
                "id": "chatcmpl-BgrY30Q455gPJbHNVPQIe9DFnTXQV",
                "created": 1749555315,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "23": {
        "0": {
            "req_id": 23,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 787,
                "out_toks": 14,
                "id": "chatcmpl-BgrY38JRKHnFQ7KHBT6R1wRFdOv6S",
                "created": 1749555315,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND o.oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND probability > 0.2\n  )\nORDER BY o.oid, p.ranking;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND o.oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND probability > 0.2\n  )\nORDER BY o.oid, p.ranking;\n```"
                },
                "in_toks": 2440,
                "out_toks": 137,
                "id": "chatcmpl-BgxqZ8hz3KU5eIsZc4doAP6MqjuIR",
                "created": 1749579527,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1111,
                "out_toks": 6,
                "id": "chatcmpl-BgrY4yQRKfz5UKzxsScZxNFogQKDh",
                "created": 1749555316,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 23,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 787,
                "out_toks": 14,
                "id": "chatcmpl-BgrY38JRKHnFQ7KHBT6R1wRFdOv6S",
                "created": 1749555315,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND o.oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND probability > 0.2\n  )\nORDER BY o.oid, p.ranking;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND o.oid IN (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND probability > 0.2\n  )\nORDER BY o.oid, p.ranking;\n```"
                },
                "in_toks": 2440,
                "out_toks": 137,
                "id": "chatcmpl-BgxqUlkHT0HxA4gjXkxFgw8dYXIuq",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1111,
                "out_toks": 6,
                "id": "chatcmpl-BgrY5fKuW1xIMC03uGw7Xw8hKanOH",
                "created": 1749555317,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "32": {
        "0": {
            "req_id": 32,
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 777,
                "out_toks": 12,
                "id": "chatcmpl-BgrY5la6zRFvnKMJhkqPYhhmSGpgq",
                "created": 1749555317,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqosfm', 'ZTF21aaqosfs', 'ZTF21aaqosff', \n              'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosfo', 'ZTF21aaqosly', \n              'ZTF21aaqosgi', 'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqosfm', 'ZTF21aaqosfs', 'ZTF21aaqosff', \n              'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosfo', 'ZTF21aaqosly', \n              'ZTF21aaqosgi', 'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;\n```"
                },
                "in_toks": 1999,
                "out_toks": 113,
                "id": "chatcmpl-BgxqZn69QzK3pIguGcKM7HP5Q0Me3",
                "created": 1749579527,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 597,
                "out_toks": 6,
                "id": "chatcmpl-BgrY6uc6RWEgWgWjxGi9UZ5oe50gq",
                "created": 1749555318,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 32,
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 777,
                "out_toks": 12,
                "id": "chatcmpl-BgrY5la6zRFvnKMJhkqPYhhmSGpgq",
                "created": 1749555317,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqosfm', 'ZTF21aaqosfs', 'ZTF21aaqosff', \n              'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosfo', 'ZTF21aaqosly', \n              'ZTF21aaqosgi', 'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqosfm', 'ZTF21aaqosfs', 'ZTF21aaqosff', \n              'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosfo', 'ZTF21aaqosly', \n              'ZTF21aaqosgi', 'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;\n```"
                },
                "in_toks": 1999,
                "out_toks": 113,
                "id": "chatcmpl-Bh1x7xtOJgSrwlPm8OZGBvl5Rc2Yy",
                "created": 1749595309,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 597,
                "out_toks": 6,
                "id": "chatcmpl-BgrY7Yepb9KGkwsecqj9ukJsGveIJ",
                "created": 1749555319,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "20": {
        "0": {
            "req_id": 20,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 778,
                "out_toks": 14,
                "id": "chatcmpl-BgrY83dwt8itSgw6xmv6cnpm8CVDv",
                "created": 1749555320,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*, p.probability, p.class_name, p.classifier_name, p.classifier_version, p.ranking\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'RRL'\n  AND p.ranking = 1\n  AND p.probability > 0.55\n  AND o.ndet >= 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*, p.probability, p.class_name, p.classifier_name, p.classifier_version, p.ranking\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'RRL'\n  AND p.ranking = 1\n  AND p.probability > 0.55\n  AND o.ndet >= 100;\n```"
                },
                "in_toks": 2419,
                "out_toks": 97,
                "id": "chatcmpl-BgxqVAhwklyOIf7jiL76SjENhpVVa",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1102,
                "out_toks": 6,
                "id": "chatcmpl-BgrYBwhWlVXuaWcFxBImhLUiHUVUa",
                "created": 1749555323,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 20,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 778,
                "out_toks": 14,
                "id": "chatcmpl-BgrY83dwt8itSgw6xmv6cnpm8CVDv",
                "created": 1749555320,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*, p.probability, p.class_name, p.classifier_name, p.classifier_version, p.ranking\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'RRL'\n  AND p.ranking = 1\n  AND p.probability > 0.55\n  AND o.ndet >= 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*, p.probability, p.class_name, p.classifier_name, p.classifier_version, p.ranking\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'RRL'\n  AND p.ranking = 1\n  AND p.probability > 0.55\n  AND o.ndet >= 100;\n```"
                },
                "in_toks": 2419,
                "out_toks": 97,
                "id": "chatcmpl-BgxqWFtHDlTJANIAiuRHSAyNgnYvu",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1102,
                "out_toks": 6,
                "id": "chatcmpl-BgrYC0XArP2uuFlzwaxHMNzW3rvWQ",
                "created": 1749555324,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "18": {
        "0": {
            "req_id": 18,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 911,
                "out_toks": 14,
                "id": "chatcmpl-BgrYDnNXl0yZugqt4OIRRHnYfn5bo",
                "created": 1749555325,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\n-- Query to get probabilities for AGN, QSO, and Blazar with specified filters and thresholds\n(\n  SELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\n  FROM \n    object o\n    INNER JOIN probability p ON o.oid = p.oid\n  WHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'AGN'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.probability > 0.95\n)\nUNION\n(\n  SELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\n  FROM \n    object o\n    INNER JOIN probability p ON o.oid = p.oid\n  WHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'QSO'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.probability > 0.95\n)\nUNION\n(\n  SELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\n  FROM \n    object o\n    INNER JOIN probability p ON o.oid = p.oid\n  WHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'Blazar'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.probability > 0.8\n);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Query to get probabilities for AGN, QSO, and Blazar with specified filters and thresholds\n(\n  SELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\n  FROM \n    object o\n    INNER JOIN probability p ON o.oid = p.oid\n  WHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'AGN'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.probability > 0.95\n)\nUNION\n(\n  SELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\n  FROM \n    object o\n    INNER JOIN probability p ON o.oid = p.oid\n  WHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'QSO'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.probability > 0.95\n)\nUNION\n(\n  SELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\n  FROM \n    object o\n    INNER JOIN probability p ON o.oid = p.oid\n  WHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'Blazar'\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.probability > 0.8\n);\n```"
                },
                "in_toks": 2552,
                "out_toks": 519,
                "id": "chatcmpl-BgxqWwFKsT2sWNrTky4fxq7lmVTE8",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1235,
                "out_toks": 6,
                "id": "chatcmpl-BgrYEPdgrHqOV5GhZGLp82AHppx2h",
                "created": 1749555326,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 18,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 911,
                "out_toks": 14,
                "id": "chatcmpl-BgrYDnNXl0yZugqt4OIRRHnYfn5bo",
                "created": 1749555325,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\n-- Query to get probabilities for AGN, QSO, and Blazar classified by lc_classifier\n-- with specified filters on detections, time span, and probability thresholds\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND (\n        (p.class_name = 'Blazar' AND p.probability > 0.8)\n        OR (p.class_name = 'AGN' AND p.probability > 0.95)\n        OR (p.class_name = 'QSO' AND p.probability > 0.95)\n    )\nUNION\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND (\n        (p.class_name = 'Blazar' AND p.probability > 0.8)\n        OR (p.class_name = 'AGN' AND p.probability > 0.95)\n        OR (p.class_name = 'QSO' AND p.probability > 0.95)\n    )\nUNION\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND (\n        (p.class_name = 'Blazar' AND p.probability > 0.8)\n        OR (p.class_name = 'AGN' AND p.probability > 0.95)\n        OR (p.class_name = 'QSO' AND p.probability > 0.95)\n    );\n```\n",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Query to get probabilities for AGN, QSO, and Blazar classified by lc_classifier\n-- with specified filters on detections, time span, and probability thresholds\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND (\n        (p.class_name = 'Blazar' AND p.probability > 0.8)\n        OR (p.class_name = 'AGN' AND p.probability > 0.95)\n        OR (p.class_name = 'QSO' AND p.probability > 0.95)\n    )\nUNION\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND (\n        (p.class_name = 'Blazar' AND p.probability > 0.8)\n        OR (p.class_name = 'AGN' AND p.probability > 0.95)\n        OR (p.class_name = 'QSO' AND p.probability > 0.95)\n    )\nUNION\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND (\n        (p.class_name = 'Blazar' AND p.probability > 0.8)\n        OR (p.class_name = 'AGN' AND p.probability > 0.95)\n        OR (p.class_name = 'QSO' AND p.probability > 0.95)\n    );\n```\n"
                },
                "in_toks": 2552,
                "out_toks": 664,
                "id": "chatcmpl-Bh1ws1S6ziTf2HfgiFiQuYc3begcj",
                "created": 1749595294,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1235,
                "out_toks": 6,
                "id": "chatcmpl-BgrYHwLgdDLUd7QMs6yUQxRTKZQoV",
                "created": 1749555329,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "35": {
        "0": {
            "req_id": 35,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 752,
                "out_toks": 8,
                "id": "chatcmpl-BgrYHiOViT0Ugjf1lloPKGBZ0oKvz",
                "created": 1749555329,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```"
                },
                "in_toks": 1911,
                "out_toks": 17,
                "id": "chatcmpl-BgxqW88IfZAY1fsYHMFhtegtgSjbR",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 594,
                "out_toks": 6,
                "id": "chatcmpl-BgrYJhutVZIKTXPW2n4rAGBHQzATY",
                "created": 1749555331,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 35,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 752,
                "out_toks": 8,
                "id": "chatcmpl-BgrYHiOViT0Ugjf1lloPKGBZ0oKvz",
                "created": 1749555329,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM probability\nORDER BY oid\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM probability\nORDER BY oid\nLIMIT 10;\n```"
                },
                "in_toks": 1911,
                "out_toks": 18,
                "id": "chatcmpl-BgxqWCt7tlNOarndislDbK3KuvBAZ",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 594,
                "out_toks": 6,
                "id": "chatcmpl-BgrYLpDoiV1VjJHea4izj4r3NZOrL",
                "created": 1749555333,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "11": {
        "0": {
            "req_id": 11,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat']",
                    "1": "['object', 'probability', 'magstat']"
                },
                "in_toks": 791,
                "out_toks": 22,
                "id": "chatcmpl-BgrYMlNu5mxNAPVAy6xEJFIdvKsFC",
                "created": 1749555334,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.g_r_max, \n    m.magmax, \n    m.fid\nFROM \n    object o\nINNER JOIN \n    magstat m ON o.oid = m.oid\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'SNIa'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.firstmjd BETWEEN 60188.0 AND 60217.0\n    AND m.magmax > 19\n    AND o.g_r_max < 1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.g_r_max, \n    m.magmax, \n    m.fid\nFROM \n    object o\nINNER JOIN \n    magstat m ON o.oid = m.oid\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'SNIa'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.firstmjd BETWEEN 60188.0 AND 60217.0\n    AND m.magmax > 19\n    AND o.g_r_max < 1;\n```"
                },
                "in_toks": 3179,
                "out_toks": 137,
                "id": "chatcmpl-BgxqgoVDDFtHVt4vr7ffbKM1GRdlR",
                "created": 1749579534,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1832,
                "out_toks": 6,
                "id": "chatcmpl-BgrYOkdpmd5yWFHVD3x1SExMzSG6p",
                "created": 1749555336,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 11,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat']",
                    "1": "['object', 'probability', 'magstat']"
                },
                "in_toks": 791,
                "out_toks": 22,
                "id": "chatcmpl-BgrYMlNu5mxNAPVAy6xEJFIdvKsFC",
                "created": 1749555334,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.g_r_max, \n    m.magmax, \n    m.fid\nFROM \n    object o\nINNER JOIN \n    magstat m ON o.oid = m.oid\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'SNIa'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.firstmjd BETWEEN 60188.0 AND 60217.0\n    AND m.magmax > 19\n    AND o.g_r_max < 1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.g_r_max, \n    m.magmax, \n    m.fid\nFROM \n    object o\nINNER JOIN \n    magstat m ON o.oid = m.oid\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'SNIa'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND o.firstmjd BETWEEN 60188.0 AND 60217.0\n    AND m.magmax > 19\n    AND o.g_r_max < 1;\n```"
                },
                "in_toks": 3179,
                "out_toks": 137,
                "id": "chatcmpl-BgxqXO6OoOhQPrPTd1BsE1A2BB7Gu",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1832,
                "out_toks": 6,
                "id": "chatcmpl-BgrYPLAPWand9QqWrtQdWmSqrGkEL",
                "created": 1749555337,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "9": {
        "0": {
            "req_id": 9,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'step']",
                    "1": "['object', 'probability', 'step']"
                },
                "in_toks": 862,
                "out_toks": 20,
                "id": "chatcmpl-BgrYPcESN1U1HJncNp4eQfRlXuBgt",
                "created": 1749555337,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid,\n    p.probability AS value,\n    s.name,\n    s.version,\n    o.meanra,\n    o.meandec,\n    p.classifier_version AS source_identifier,\n    q3c_dist(o.meanra, o.meandec, 39.97, -1.5768) AS dist\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    step s ON p.classifier_version = s.step_id\nWHERE \n    o.firstmjd BETWEEN 60126.0 AND 60156.0\n    AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n    AND o.sgscore1 < 0.3\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND p.class_name NOT IN ('asteroid', 'bogus');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid,\n    p.probability AS value,\n    s.name,\n    s.version,\n    o.meanra,\n    o.meandec,\n    p.classifier_version AS source_identifier,\n    q3c_dist(o.meanra, o.meandec, 39.97, -1.5768) AS dist\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    step s ON p.classifier_version = s.step_id\nWHERE \n    o.firstmjd BETWEEN 60126.0 AND 60156.0\n    AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n    AND o.sgscore1 < 0.3\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND p.class_name NOT IN ('asteroid', 'bogus');\n```"
                },
                "in_toks": 3005,
                "out_toks": 213,
                "id": "chatcmpl-Bh2hrIGyCDMUDReXf79Ysa8N6gQT8",
                "created": 1749598207,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 1258,
                "out_toks": 6,
                "id": "chatcmpl-BgrYRKJRO4KPkpewxNMD1G7iX9zbr",
                "created": 1749555339,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that fulfills the user request, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main table for object information is `object`.\n     - Columns needed: `oid` (object identifier), `meanra`, `meandec`.\n   - The `probability` table contains classification probabilities.\n     - Columns needed: `oid`, `class_name`, `classifier_name`, `probability`, `ranking`.\n   - The user requests columns `value`, `name`, `version`, and a \"source identifier\" (likely referring to the step or classification source).\n     - `name` and `version` can be obtained from the `step` table, which contains step metadata.\n     - `value` is not explicitly defined in the schema; it may refer to the probability value or another relevant metric. Since the user requests it alongside `name` and `version`, it is likely the `probability` column from the `probability` table.\n     - The \"source identifier\" is ambiguous but likely corresponds to the `step_id` or `classifier_version` from the `probability` table or the `step` table. Since the user wants `name` and `version` from the `step` table, the source identifier can be the `step_id` or `classifier_version` linked to the classification.\n   - The `object` table does not have `sgscore1` column mentioned in the schema. This suggests `sgscore1` is either a user-defined column or from another table not listed. Since it is required, assume it is a column in the `object` table or a related table. If it is in another table, identify and join accordingly. If not available, clarify or omit.\n   - The user wants the distance from the center of Abell 370 calculated using the `q3c_dist` function.\n\n2. **Apply Time Filter for First Detection in July 2023:**\n   - Use the `firstmjd` column in the `object` table.\n   - Filter objects where `firstmjd` is between 60126.0 and 60156.0 (start and end of July 2023).\n\n3. **Apply Spatial Filter Using Q3C:**\n   - The center coordinates of Abell 370 are RA=39.97, Dec=-1.5768.\n   - The search radius is 1000 arcmin, which equals 16.16667 degrees.\n   - Use the `q3c_radial_query` function to filter objects within this radius based on their `meanra` and `meandec`.\n   - Also calculate the distance using `q3c_dist(meanra, meandec, 39.97, -1.5768)` and return it as `dist`.\n\n4. **Filter Based on `sgscore1` < 0.3:**\n   - Since `sgscore1` is not in the provided schema, verify its location.\n   - If it is in the `object` table, apply the filter directly.\n   - If it is in another table, join that table accordingly.\n   - If unavailable, note this as a limitation or clarify.\n\n5. **Filter Based on Stamp Classifier Probabilities:**\n   - Use the `probability` table.\n   - Filter for `classifier_name = 'stamp_classifier'`.\n   - Only consider the highest probability class per object (`ranking = 1`).\n   - Exclude objects where the highest probability class is 'asteroid' or 'bogus'.\n   - Join the `probability` table with the `object` table on `oid`.\n\n6. **Retrieve Required Columns:**\n   - From `object`: `oid`, `meanra`, `meandec`.\n   - From `probability`: `probability` as `value`, `class_name` (if needed), `classifier_version` as `version`.\n   - From `step`: `name` and `version` corresponding to the `classifier_version` or `step_id` linked to the classification.\n     - Join `step` table on `step_id` = `classifier_version` or another appropriate key.\n   - Include the calculated distance as `dist`.\n\n7. **Construct Joins:**\n   - Inner join `object` and `probability` on `oid`.\n   - Inner join `probability` and `step` on `classifier_version` = `step_id` (assuming this relation).\n   - If `sgscore1` is in another table, join that table accordingly.\n\n8. **Apply Default Conditions:**\n   - For the `probability` table, always filter by `ranking = 1` and `classifier_name = 'stamp_classifier'` as per user request.\n   - Apply all other filters as described.\n\n9. **Ordering and Output:**\n   - The user does not specify ordering; default ordering can be by distance ascending or by `oid`.\n   - Select the columns as requested: `oid`, `value` (probability), `name` (from step), `version` (from step), `meanra`, `meandec`, source identifier (likely `classifier_version` or `step_id`), and `dist`.\n\n10. **Summary of Steps:**\n    - Filter `object` by `firstmjd` in July 2023.\n    - Filter `object` by spatial location within 16.16667 degrees of (39.97, -1.5768) using `q3c_radial_query`.\n    - Filter `object` by `sgscore1 < 0.3`.\n    - Join with `probability` filtered by `classifier_name = 'stamp_classifier'` and `ranking = 1`.\n    - Exclude objects with `class_name` in ('asteroid', 'bogus').\n    - Join with `step` table to get `name` and `version`.\n    - Calculate distance using `q3c_dist`.\n    - Select requested columns.\n\nThis decomposition plan ensures the query will retrieve the object identifiers and associated metadata for objects first detected in July 2023, within the specified spatial radius, with low `sgscore1`, and whose top stamp classifier probability is not 'asteroid' or 'bogus', including the requested columns and the distance from the Abell 370 center.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that fulfills the user request, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main table for object information is `object`.\n     - Columns needed: `oid` (object identifier), `meanra`, `meandec`.\n   - The `probability` table contains classification probabilities.\n     - Columns needed: `oid`, `class_name`, `classifier_name`, `probability`, `ranking`.\n   - The user requests columns `value`, `name`, `version`, and a \"source identifier\" (likely referring to the step or classification source).\n     - `name` and `version` can be obtained from the `step` table, which contains step metadata.\n     - `value` is not explicitly defined in the schema; it may refer to the probability value or another relevant metric. Since the user requests it alongside `name` and `version`, it is likely the `probability` column from the `probability` table.\n     - The \"source identifier\" is ambiguous but likely corresponds to the `step_id` or `classifier_version` from the `probability` table or the `step` table. Since the user wants `name` and `version` from the `step` table, the source identifier can be the `step_id` or `classifier_version` linked to the classification.\n   - The `object` table does not have `sgscore1` column mentioned in the schema. This suggests `sgscore1` is either a user-defined column or from another table not listed. Since it is required, assume it is a column in the `object` table or a related table. If it is in another table, identify and join accordingly. If not available, clarify or omit.\n   - The user wants the distance from the center of Abell 370 calculated using the `q3c_dist` function.\n\n2. **Apply Time Filter for First Detection in July 2023:**\n   - Use the `firstmjd` column in the `object` table.\n   - Filter objects where `firstmjd` is between 60126.0 and 60156.0 (start and end of July 2023).\n\n3. **Apply Spatial Filter Using Q3C:**\n   - The center coordinates of Abell 370 are RA=39.97, Dec=-1.5768.\n   - The search radius is 1000 arcmin, which equals 16.16667 degrees.\n   - Use the `q3c_radial_query` function to filter objects within this radius based on their `meanra` and `meandec`.\n   - Also calculate the distance using `q3c_dist(meanra, meandec, 39.97, -1.5768)` and return it as `dist`.\n\n4. **Filter Based on `sgscore1` < 0.3:**\n   - Since `sgscore1` is not in the provided schema, verify its location.\n   - If it is in the `object` table, apply the filter directly.\n   - If it is in another table, join that table accordingly.\n   - If unavailable, note this as a limitation or clarify.\n\n5. **Filter Based on Stamp Classifier Probabilities:**\n   - Use the `probability` table.\n   - Filter for `classifier_name = 'stamp_classifier'`.\n   - Only consider the highest probability class per object (`ranking = 1`).\n   - Exclude objects where the highest probability class is 'asteroid' or 'bogus'.\n   - Join the `probability` table with the `object` table on `oid`.\n\n6. **Retrieve Required Columns:**\n   - From `object`: `oid`, `meanra`, `meandec`.\n   - From `probability`: `probability` as `value`, `class_name` (if needed), `classifier_version` as `version`.\n   - From `step`: `name` and `version` corresponding to the `classifier_version` or `step_id` linked to the classification.\n     - Join `step` table on `step_id` = `classifier_version` or another appropriate key.\n   - Include the calculated distance as `dist`.\n\n7. **Construct Joins:**\n   - Inner join `object` and `probability` on `oid`.\n   - Inner join `probability` and `step` on `classifier_version` = `step_id` (assuming this relation).\n   - If `sgscore1` is in another table, join that table accordingly.\n\n8. **Apply Default Conditions:**\n   - For the `probability` table, always filter by `ranking = 1` and `classifier_name = 'stamp_classifier'` as per user request.\n   - Apply all other filters as described.\n\n9. **Ordering and Output:**\n   - The user does not specify ordering; default ordering can be by distance ascending or by `oid`.\n   - Select the columns as requested: `oid`, `value` (probability), `name` (from step), `version` (from step), `meanra`, `meandec`, source identifier (likely `classifier_version` or `step_id`), and `dist`.\n\n10. **Summary of Steps:**\n    - Filter `object` by `firstmjd` in July 2023.\n    - Filter `object` by spatial location within 16.16667 degrees of (39.97, -1.5768) using `q3c_radial_query`.\n    - Filter `object` by `sgscore1 < 0.3`.\n    - Join with `probability` filtered by `classifier_name = 'stamp_classifier'` and `ranking = 1`.\n    - Exclude objects with `class_name` in ('asteroid', 'bogus').\n    - Join with `step` table to get `name` and `version`.\n    - Calculate distance using `q3c_dist`.\n    - Select requested columns.\n\nThis decomposition plan ensures the query will retrieve the object identifiers and associated metadata for objects first detected in July 2023, within the specified spatial radius, with low `sgscore1`, and whose top stamp classifier probability is not 'asteroid' or 'bogus', including the requested columns and the distance from the Abell 370 center."
                },
                "in_toks": 2906,
                "out_toks": 1312,
                "id": "chatcmpl-BgxqYmDxw5XY1Px8qi7vs7c6SHQrN",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        },
        "1": {
            "req_id": 9,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'step']",
                    "1": "['object', 'probability', 'step']"
                },
                "in_toks": 862,
                "out_toks": 20,
                "id": "chatcmpl-BgrYPcESN1U1HJncNp4eQfRlXuBgt",
                "created": 1749555337,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid,\n    p.value,\n    s.name,\n    s.version,\n    o.meanra,\n    o.meandec,\n    o.oid AS source_identifier,\n    q3c_dist(o.meanra, o.meandec, 39.97, -1.5768) AS dist\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    step s ON o.step_id_corr = s.step_id\nWHERE \n    o.firstmjd BETWEEN 60126.0 AND 60156.0\n    AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n    AND o.sgscore1 < 0.3\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND p.class_name NOT IN ('asteroid', 'bogus');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid,\n    p.value,\n    s.name,\n    s.version,\n    o.meanra,\n    o.meandec,\n    o.oid AS source_identifier,\n    q3c_dist(o.meanra, o.meandec, 39.97, -1.5768) AS dist\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    step s ON o.step_id_corr = s.step_id\nWHERE \n    o.firstmjd BETWEEN 60126.0 AND 60156.0\n    AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n    AND o.sgscore1 < 0.3\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND p.class_name NOT IN ('asteroid', 'bogus');\n```"
                },
                "in_toks": 3009,
                "out_toks": 208,
                "id": "chatcmpl-Bh2hrItspv3ueOIhuZ3HeNyzw5khv",
                "created": 1749598207,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 1258,
                "out_toks": 6,
                "id": "chatcmpl-BgrYRpjfFOsHX45s356xA8QnL5Je4",
                "created": 1749555339,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that fulfills the user request, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main table for object information is `object`, which contains `oid`, `meanra`, and `meandec`.\n   - The `probability` table contains classification probabilities, including the classifier name, class name, probability, and ranking.\n   - The user requests columns `oid`, `value`, `name`, `version`, `meanra`, `meandec`, the source identifier, and the distance as `dist`.\n     - `oid` is from the `object` table.\n     - `meanra` and `meandec` are from the `object` table.\n     - `name` and `version` likely refer to the `step` table columns, which contain pipeline step information.\n     - `value` and \"source identifier\" are not explicitly defined in the schema provided. Since the user requests \"value\" and \"source identifier,\" and these are not columns in `object` or `probability`, it is necessary to clarify or interpret:\n       - Possibly \"value\" refers to the probability value from the `probability` table.\n       - \"source identifier\" could be the `oid` or another identifier; since no other source identifier is defined, assume it is `oid`.\n   - The `stamp_classifier` classification probabilities are stored in the `probability` table with `classifier_name='stamp_classifier'`.\n   - The `sgscore1` column is not explicitly listed in the schema provided. It is likely a column in the `object` table or another table not listed. Since it is not in the schema, assume it is in the `object` table or a related table. If it is in another table, a join will be needed. For this plan, assume it is in the `object` table.\n\n2. **Apply Time Filter for First Detection in July 2023:**\n   - Use the `firstmjd` column in the `object` table.\n   - Filter objects where `firstmjd` is between 60126.0 and 60156.0 (start and end of July 2023).\n\n3. **Apply Spatial Filter Using Q3C:**\n   - Use the `q3c_radial_query` function to filter objects within a radius of 16.16667 degrees (1000 arcmin) from the center of Abell 370 (RA=39.97, Dec=-1.5768).\n   - The function will be applied on `meanra` and `meandec` columns of the `object` table.\n\n4. **Apply sgscore1 Filter:**\n   - Filter objects with `sgscore1 < 0.3`.\n   - Since `sgscore1` is not explicitly in the schema, confirm its table and join if necessary. If it is in the `object` table, apply the filter directly.\n\n5. **Filter Based on Stamp Classifier Probabilities:**\n   - Join the `probability` table on `oid` to get the classification probabilities for each object.\n   - Filter for `classifier_name = 'stamp_classifier'`.\n   - Restrict to the highest probability class per object by filtering `ranking = 1`.\n   - Exclude objects where the highest probability class is 'asteroid' or 'bogus'.\n   - Retrieve the `value` column as the probability value from the `probability` table.\n\n6. **Retrieve Step Information:**\n   - Join the `step` table to get the `name` and `version` columns.\n   - The join key is likely `step_id` in the `object` table or `probability` table. Since `step_id_corr` is in the `object` table, and the user requests `name` and `version`, join `step` on `object.step_id_corr = step.step_id`.\n   - This will provide the pipeline step name and version related to the object.\n\n7. **Calculate Distance Using q3c_dist:**\n   - Use the `q3c_dist` function to calculate the angular distance between each object's `meanra`, `meandec` and the Abell 370 center (RA=39.97, Dec=-1.5768).\n   - Return this value as `dist`.\n\n8. **Select Required Columns:**\n   - Select the following columns in the output:\n     - `oid` from `object`\n     - `value` from `probability` (probability value of the highest ranked class in the stamp classifier)\n     - `name` and `version` from `step`\n     - `meanra` and `meandec` from `object`\n     - The source identifier (assumed to be `oid` again, or clarify if different)\n     - The calculated distance as `dist`\n\n9. **Construct the Query with Appropriate Joins and Filters:**\n   - Start from the `object` table.\n   - Join `probability` on `oid` with conditions `classifier_name='stamp_classifier'` and `ranking=1`.\n   - Join `step` on `object.step_id_corr = step.step_id`.\n   - Apply all filters: `firstmjd` date range, spatial radius, `sgscore1 < 0.3`, and exclude classes 'asteroid' and 'bogus' in the highest probability stamp classifier.\n   - Calculate distance using `q3c_dist`.\n\n10. **Ordering and Final Output:**\n    - The user does not specify ordering; default ordering can be by distance ascending or by `oid`.\n    - Ensure the query returns only distinct objects if duplicates are possible.\n\n11. **Additional Considerations:**\n    - Confirm the exact table and column for `sgscore1`. If it is in another table, include the necessary join.\n    - Confirm the meaning of \"source identifier\" if different from `oid`.\n    - Use exact column and table names as per the schema.\n    - Use the default conditions for the `probability` table as specified (ranking=1 and classifier_name='stamp_classifier' in this case).\n    - Use the Q3C extension functions correctly with the right parameter order.\n\nBy following these steps, the resulting query will accurately retrieve the requested object identifiers and associated information filtered by date, spatial location, classification, and other criteria.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that fulfills the user request, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main table for object information is `object`, which contains `oid`, `meanra`, and `meandec`.\n   - The `probability` table contains classification probabilities, including the classifier name, class name, probability, and ranking.\n   - The user requests columns `oid`, `value`, `name`, `version`, `meanra`, `meandec`, the source identifier, and the distance as `dist`.\n     - `oid` is from the `object` table.\n     - `meanra` and `meandec` are from the `object` table.\n     - `name` and `version` likely refer to the `step` table columns, which contain pipeline step information.\n     - `value` and \"source identifier\" are not explicitly defined in the schema provided. Since the user requests \"value\" and \"source identifier,\" and these are not columns in `object` or `probability`, it is necessary to clarify or interpret:\n       - Possibly \"value\" refers to the probability value from the `probability` table.\n       - \"source identifier\" could be the `oid` or another identifier; since no other source identifier is defined, assume it is `oid`.\n   - The `stamp_classifier` classification probabilities are stored in the `probability` table with `classifier_name='stamp_classifier'`.\n   - The `sgscore1` column is not explicitly listed in the schema provided. It is likely a column in the `object` table or another table not listed. Since it is not in the schema, assume it is in the `object` table or a related table. If it is in another table, a join will be needed. For this plan, assume it is in the `object` table.\n\n2. **Apply Time Filter for First Detection in July 2023:**\n   - Use the `firstmjd` column in the `object` table.\n   - Filter objects where `firstmjd` is between 60126.0 and 60156.0 (start and end of July 2023).\n\n3. **Apply Spatial Filter Using Q3C:**\n   - Use the `q3c_radial_query` function to filter objects within a radius of 16.16667 degrees (1000 arcmin) from the center of Abell 370 (RA=39.97, Dec=-1.5768).\n   - The function will be applied on `meanra` and `meandec` columns of the `object` table.\n\n4. **Apply sgscore1 Filter:**\n   - Filter objects with `sgscore1 < 0.3`.\n   - Since `sgscore1` is not explicitly in the schema, confirm its table and join if necessary. If it is in the `object` table, apply the filter directly.\n\n5. **Filter Based on Stamp Classifier Probabilities:**\n   - Join the `probability` table on `oid` to get the classification probabilities for each object.\n   - Filter for `classifier_name = 'stamp_classifier'`.\n   - Restrict to the highest probability class per object by filtering `ranking = 1`.\n   - Exclude objects where the highest probability class is 'asteroid' or 'bogus'.\n   - Retrieve the `value` column as the probability value from the `probability` table.\n\n6. **Retrieve Step Information:**\n   - Join the `step` table to get the `name` and `version` columns.\n   - The join key is likely `step_id` in the `object` table or `probability` table. Since `step_id_corr` is in the `object` table, and the user requests `name` and `version`, join `step` on `object.step_id_corr = step.step_id`.\n   - This will provide the pipeline step name and version related to the object.\n\n7. **Calculate Distance Using q3c_dist:**\n   - Use the `q3c_dist` function to calculate the angular distance between each object's `meanra`, `meandec` and the Abell 370 center (RA=39.97, Dec=-1.5768).\n   - Return this value as `dist`.\n\n8. **Select Required Columns:**\n   - Select the following columns in the output:\n     - `oid` from `object`\n     - `value` from `probability` (probability value of the highest ranked class in the stamp classifier)\n     - `name` and `version` from `step`\n     - `meanra` and `meandec` from `object`\n     - The source identifier (assumed to be `oid` again, or clarify if different)\n     - The calculated distance as `dist`\n\n9. **Construct the Query with Appropriate Joins and Filters:**\n   - Start from the `object` table.\n   - Join `probability` on `oid` with conditions `classifier_name='stamp_classifier'` and `ranking=1`.\n   - Join `step` on `object.step_id_corr = step.step_id`.\n   - Apply all filters: `firstmjd` date range, spatial radius, `sgscore1 < 0.3`, and exclude classes 'asteroid' and 'bogus' in the highest probability stamp classifier.\n   - Calculate distance using `q3c_dist`.\n\n10. **Ordering and Final Output:**\n    - The user does not specify ordering; default ordering can be by distance ascending or by `oid`.\n    - Ensure the query returns only distinct objects if duplicates are possible.\n\n11. **Additional Considerations:**\n    - Confirm the exact table and column for `sgscore1`. If it is in another table, include the necessary join.\n    - Confirm the meaning of \"source identifier\" if different from `oid`.\n    - Use exact column and table names as per the schema.\n    - Use the default conditions for the `probability` table as specified (ranking=1 and classifier_name='stamp_classifier' in this case).\n    - Use the Q3C extension functions correctly with the right parameter order.\n\nBy following these steps, the resulting query will accurately retrieve the requested object identifiers and associated information filtered by date, spatial location, classification, and other criteria."
                },
                "in_toks": 2906,
                "out_toks": 1316,
                "id": "chatcmpl-BgxqXx9veipu4H2kZrcmWj8t8uTat",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        }
    },
    "5": {
        "0": {
            "req_id": 5,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'feature', 'detection', 'magstat']"
                },
                "in_toks": 833,
                "out_toks": 36,
                "id": "chatcmpl-BgrYSGqdM1UeqQlf6gMrUcjpelmVC",
                "created": 1749555340,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    f.name,\n    f.value,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid,\n    f.fid AS feature_fid,\n    d.mjd\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    magstat m ON o.oid = m.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'SNII'\n    AND p.probability > 0.6\n    AND o.ndet > 50\n    AND m.fid = 1\n    AND (m.magmax - m.magmin) > 2\nORDER BY \n    o.oid,\n    d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid,\n    d.candid,\n    f.name,\n    f.value,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid,\n    f.fid AS feature_fid,\n    d.mjd\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    magstat m ON o.oid = m.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'SNII'\n    AND p.probability > 0.6\n    AND o.ndet > 50\n    AND m.fid = 1\n    AND (m.magmax - m.magmin) > 2\nORDER BY \n    o.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2482,
                "out_toks": 211,
                "id": "chatcmpl-Bh2hrb5DIapmMDOe53gfmbiG9ZjFr",
                "created": 1749598207,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 4854,
                "out_toks": 6,
                "id": "chatcmpl-BgrYULQCnavFVkzAOVMV5But4OP5B",
                "created": 1749555342,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify the Relevant Tables and Columns:**\n   - From the user request, the following tables and columns are needed:\n     - `object` table: to get the object identifier (`oid`) and number of detections (`ndet`).\n     - `probability` table: to filter objects classified as 'SNII' with probability > 0.6.\n     - `feature` table: to get the feature name (`name`), feature value (`value`), and feature band identifier (`fid`), which should be renamed as `feature_fid`.\n     - `detection` table: to get candidate identifier (`candid`), PSF magnitudes (`magpsf`), magnitude errors (`sigmapsf`), and band identifiers (`fid`).\n     - `magstat` table: to filter objects with difference between minimum and maximum magnitudes in ZTF g-band (fid=1) greater than 2 mag.\n\n2. **Apply the Default Conditions for the `probability` Table:**\n   - Use `probability.ranking = 1` to select the most likely class.\n   - Use `probability.classifier_name = 'lc_classifier'` to select classifications from the light curve classifier.\n   - Filter for `class_name = 'SNII'` and `probability > 0.6`.\n\n3. **Filter Objects Based on Number of Detections:**\n   - Use the `object.ndet` column to filter objects with more than 50 detections (`ndet > 50`).\n\n4. **Filter Objects Based on Magnitude Difference in g-band:**\n   - Use the `magstat` table to find objects with `fid = 1` (ZTF g-band).\n   - Calculate the difference between minimum and maximum magnitudes (`magmax - magmin`) and filter for values greater than 2 mag.\n\n5. **Join Tables Appropriately:**\n   - Join `object` and `probability` on `oid` to filter objects classified as 'SNII' with the required probability.\n   - Join `object` and `magstat` on `oid` to apply the magnitude difference filter for g-band.\n   - Join `object` and `feature` on `oid` to retrieve feature information.\n   - Join `object` and `detection` on `oid` to retrieve detection information including candidate id, PSF magnitudes, magnitude errors, and band identifiers.\n\n6. **Select Required Columns:**\n   - From `object`: `oid` (object identifier).\n   - From `detection`: `candid` (candidate identifier), `magpsf` (PSF magnitude), `sigmapsf` (magnitude error), `fid` (band identifier).\n   - From `feature`: `name` (feature name), `value` (feature value), and `fid` renamed as `feature_fid`.\n   - From `detection`: `mjd` (time of detection) to order results as a function of time.\n\n7. **Apply Ordering:**\n   - Order the results by `oid` as requested.\n   - Optionally, within each `oid`, order by `mjd` (time) to reflect the time evolution.\n\n8. **Additional Considerations:**\n   - Ensure that the joins do not multiply rows unnecessarily; consider if distinct or grouping is needed depending on the data.\n   - Since the user wants the data \"as a function of time,\" ensure that the `mjd` column from `detection` is included or used for ordering.\n   - Rename the `feature.fid` column as `feature_fid` in the SELECT clause.\n\nBy following these steps, the query will retrieve the object identifiers, candidate identifiers, feature names and values, PSF magnitudes, magnitude errors, and band identifiers (with the feature band id renamed), for objects classified as SN II with probability > 0.6, having more than 50 detections, and with a g-band magnitude difference greater than 2 mag, ordered by object identifier.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify the Relevant Tables and Columns:**\n   - From the user request, the following tables and columns are needed:\n     - `object` table: to get the object identifier (`oid`) and number of detections (`ndet`).\n     - `probability` table: to filter objects classified as 'SNII' with probability > 0.6.\n     - `feature` table: to get the feature name (`name`), feature value (`value`), and feature band identifier (`fid`), which should be renamed as `feature_fid`.\n     - `detection` table: to get candidate identifier (`candid`), PSF magnitudes (`magpsf`), magnitude errors (`sigmapsf`), and band identifiers (`fid`).\n     - `magstat` table: to filter objects with difference between minimum and maximum magnitudes in ZTF g-band (fid=1) greater than 2 mag.\n\n2. **Apply the Default Conditions for the `probability` Table:**\n   - Use `probability.ranking = 1` to select the most likely class.\n   - Use `probability.classifier_name = 'lc_classifier'` to select classifications from the light curve classifier.\n   - Filter for `class_name = 'SNII'` and `probability > 0.6`.\n\n3. **Filter Objects Based on Number of Detections:**\n   - Use the `object.ndet` column to filter objects with more than 50 detections (`ndet > 50`).\n\n4. **Filter Objects Based on Magnitude Difference in g-band:**\n   - Use the `magstat` table to find objects with `fid = 1` (ZTF g-band).\n   - Calculate the difference between minimum and maximum magnitudes (`magmax - magmin`) and filter for values greater than 2 mag.\n\n5. **Join Tables Appropriately:**\n   - Join `object` and `probability` on `oid` to filter objects classified as 'SNII' with the required probability.\n   - Join `object` and `magstat` on `oid` to apply the magnitude difference filter for g-band.\n   - Join `object` and `feature` on `oid` to retrieve feature information.\n   - Join `object` and `detection` on `oid` to retrieve detection information including candidate id, PSF magnitudes, magnitude errors, and band identifiers.\n\n6. **Select Required Columns:**\n   - From `object`: `oid` (object identifier).\n   - From `detection`: `candid` (candidate identifier), `magpsf` (PSF magnitude), `sigmapsf` (magnitude error), `fid` (band identifier).\n   - From `feature`: `name` (feature name), `value` (feature value), and `fid` renamed as `feature_fid`.\n   - From `detection`: `mjd` (time of detection) to order results as a function of time.\n\n7. **Apply Ordering:**\n   - Order the results by `oid` as requested.\n   - Optionally, within each `oid`, order by `mjd` (time) to reflect the time evolution.\n\n8. **Additional Considerations:**\n   - Ensure that the joins do not multiply rows unnecessarily; consider if distinct or grouping is needed depending on the data.\n   - Since the user wants the data \"as a function of time,\" ensure that the `mjd` column from `detection` is included or used for ordering.\n   - Rename the `feature.fid` column as `feature_fid` in the SELECT clause.\n\nBy following these steps, the query will retrieve the object identifiers, candidate identifiers, feature names and values, PSF magnitudes, magnitude errors, and band identifiers (with the feature band id renamed), for objects classified as SN II with probability > 0.6, having more than 50 detections, and with a g-band magnitude difference greater than 2 mag, ordered by object identifier."
                },
                "in_toks": 6461,
                "out_toks": 859,
                "id": "chatcmpl-BgxqYVMZ0hdGHRPPOOLolajw6USbe",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        },
        "1": {
            "req_id": 5,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'feature', 'detection', 'magstat']"
                },
                "in_toks": 833,
                "out_toks": 36,
                "id": "chatcmpl-BgrYSGqdM1UeqQlf6gMrUcjpelmVC",
                "created": 1749555340,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH filtered_objects AS (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    INNER JOIN magstat m ON p.oid = m.oid\n    WHERE p.class_name = 'SNII'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND o.ndet > 50\n      AND m.fid = 1\n      AND (m.magmax - m.magmin) > 2\n)\nSELECT \n    d.oid,\n    d.candid,\n    f.name,\n    f.value,\n    d.magpsf,\n    d.sigmapsf,\n    f.fid AS feature_fid,\n    d.mjd\nFROM filtered_objects fo\nINNER JOIN feature f ON fo.oid = f.oid\nINNER JOIN detection d ON fo.oid = d.oid\nORDER BY d.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH filtered_objects AS (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    INNER JOIN magstat m ON p.oid = m.oid\n    WHERE p.class_name = 'SNII'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND o.ndet > 50\n      AND m.fid = 1\n      AND (m.magmax - m.magmin) > 2\n)\nSELECT \n    d.oid,\n    d.candid,\n    f.name,\n    f.value,\n    d.magpsf,\n    d.sigmapsf,\n    f.fid AS feature_fid,\n    d.mjd\nFROM filtered_objects fo\nINNER JOIN feature f ON fo.oid = f.oid\nINNER JOIN detection d ON fo.oid = d.oid\nORDER BY d.oid;\n```"
                },
                "in_toks": 3197,
                "out_toks": 208,
                "id": "chatcmpl-Bh2hrPc5SDgMEJ4UWcDbFhClPgQWT",
                "created": 1749598207,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "advanced",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'advanced'}"
                },
                "in_toks": 4854,
                "out_toks": 6,
                "id": "chatcmpl-BgrYVmEA9zjK08jIjEzLyurRJ2IPa",
                "created": 1749555343,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify the Main Tables and Columns Needed:**\n   - From the user request, the main entities are:\n     - Objects classified as SN II with probability > 0.6.\n     - Detections of those objects.\n     - Features of those objects.\n   - Relevant tables and columns:\n     - `probability`: to filter objects classified as 'SNII' with probability > 0.6, classifier_name='lc_classifier', and ranking=1.\n       - Columns: `oid`, `class_name`, `probability`, `ranking`, `classifier_name`.\n     - `object`: to filter objects with number of detections (`ndet`) > 50.\n       - Columns: `oid`, `ndet`.\n     - `magstat`: to filter objects with difference between minimum and maximum magnitudes in ZTF g-band (fid=1) greater than 2 mag.\n       - Columns: `oid`, `fid`, `magmax`, `magmin`.\n     - `feature`: to retrieve feature name, value, and feature fid (renamed as `feature_fid`).\n       - Columns: `oid`, `name`, `value`, `fid`.\n     - `detection`: to retrieve candidate identifier (`candid`), psf magnitudes (`magpsf`), magnitude errors (`sigmapsf`), and band identifiers (`fid`).\n       - Columns: `oid`, `candid`, `magpsf`, `sigmapsf`, `fid`, `mjd` (time of detection).\n\n2. **Step 1: Filter Objects Classified as SN II with Probability > 0.6**\n   - Query the `probability` table with conditions:\n     - `class_name = 'SNII'`\n     - `probability > 0.6`\n     - `ranking = 1` (to get the most likely class)\n     - `classifier_name = 'lc_classifier'`\n   - This will produce a list of `oid`s of objects classified as SN II with high confidence.\n\n3. **Step 2: Filter Objects with Number of Detections > 50**\n   - Join the filtered `oid`s from Step 1 with the `object` table.\n   - Apply the condition `ndet > 50` on the `object` table.\n   - This step narrows down the objects to those with sufficient detections.\n\n4. **Step 3: Filter Objects with Magnitude Difference in g-band > 2 mag**\n   - Join the filtered `oid`s from Step 2 with the `magstat` table.\n   - Filter `magstat` rows where `fid = 1` (g-band).\n   - Calculate the difference between `magmax` and `magmin` and filter where this difference is greater than 2.\n   - This step ensures the objects have significant variability in the g-band.\n\n5. **Step 4: Retrieve Features for the Filtered Objects**\n   - Since the user requests the feature name, value, and feature fid (renamed as `feature_fid`), query the `feature` table.\n   - Join the `feature` table with the filtered `oid`s from Step 3.\n   - Select columns: `oid`, `name`, `value`, and `fid` (renamed as `feature_fid`).\n   - No specific feature filtering is requested, so retrieve all features for these objects.\n\n6. **Step 5: Retrieve Detections for the Filtered Objects**\n   - Query the `detection` table for the filtered `oid`s from Step 3.\n   - Select columns: `oid`, `candid` (candidate identifier), `magpsf` (psf magnitude), `sigmapsf` (magnitude error), `fid` (band identifier), and `mjd` (time of detection).\n   - This will provide the time series data for the detections.\n\n7. **Step 6: Combine Features and Detections**\n   - The user wants the output as a function of time, implying that detection time (`mjd`) is important.\n   - Since features are static per object and detections are time-dependent, the query should join the `feature` and `detection` tables on `oid`.\n   - This join will produce rows with:\n     - `oid`\n     - `candid`\n     - `feature` name, value, and `feature_fid`\n     - `magpsf`, `sigmapsf`, `fid` (from detection)\n     - `mjd` (time of detection)\n   - This join will produce multiple rows per object per detection per feature.\n\n8. **Step 7: Final Selection and Ordering**\n   - Select the columns as requested:\n     - `oid` (object identifier)\n     - `candid` (candidate identifier)\n     - `feature` name\n     - `feature` value\n     - `magpsf` (psf magnitude)\n     - `sigmapsf` (magnitude error)\n     - `fid` from `feature` table renamed as `feature_fid`\n     - `mjd` (time of detection)\n   - Order the results by `oid` ascending.\n\n9. **Step 8: Optimize the Query**\n   - Use INNER JOINs to ensure only objects meeting all criteria are included.\n   - Use subqueries or CTEs (WITH clauses) to filter objects stepwise:\n     - First filter by classification and probability.\n     - Then filter by number of detections.\n     - Then filter by magnitude difference in g-band.\n   - Join the filtered object list with `feature` and `detection` tables.\n   - Apply the renaming of the `fid` column from the `feature` table as `feature_fid` in the SELECT clause.\n\n10. **Summary of the Query Logic:**\n    - Start with a subquery filtering `probability` for SNII with probability > 0.6, ranking=1, classifier_name='lc_classifier'.\n    - Join with `object` to filter `ndet > 50`.\n    - Join with `magstat` filtered on `fid=1` and `(magmax - magmin) > 2`.\n    - Use the resulting `oid`s to join with `feature` and `detection`.\n    - Select the requested columns, rename `feature.fid` as `feature_fid`.\n    - Order by `oid`.\n\nThis decomposition plan ensures the query is accurate, efficient, and meets all user requirements.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify the Main Tables and Columns Needed:**\n   - From the user request, the main entities are:\n     - Objects classified as SN II with probability > 0.6.\n     - Detections of those objects.\n     - Features of those objects.\n   - Relevant tables and columns:\n     - `probability`: to filter objects classified as 'SNII' with probability > 0.6, classifier_name='lc_classifier', and ranking=1.\n       - Columns: `oid`, `class_name`, `probability`, `ranking`, `classifier_name`.\n     - `object`: to filter objects with number of detections (`ndet`) > 50.\n       - Columns: `oid`, `ndet`.\n     - `magstat`: to filter objects with difference between minimum and maximum magnitudes in ZTF g-band (fid=1) greater than 2 mag.\n       - Columns: `oid`, `fid`, `magmax`, `magmin`.\n     - `feature`: to retrieve feature name, value, and feature fid (renamed as `feature_fid`).\n       - Columns: `oid`, `name`, `value`, `fid`.\n     - `detection`: to retrieve candidate identifier (`candid`), psf magnitudes (`magpsf`), magnitude errors (`sigmapsf`), and band identifiers (`fid`).\n       - Columns: `oid`, `candid`, `magpsf`, `sigmapsf`, `fid`, `mjd` (time of detection).\n\n2. **Step 1: Filter Objects Classified as SN II with Probability > 0.6**\n   - Query the `probability` table with conditions:\n     - `class_name = 'SNII'`\n     - `probability > 0.6`\n     - `ranking = 1` (to get the most likely class)\n     - `classifier_name = 'lc_classifier'`\n   - This will produce a list of `oid`s of objects classified as SN II with high confidence.\n\n3. **Step 2: Filter Objects with Number of Detections > 50**\n   - Join the filtered `oid`s from Step 1 with the `object` table.\n   - Apply the condition `ndet > 50` on the `object` table.\n   - This step narrows down the objects to those with sufficient detections.\n\n4. **Step 3: Filter Objects with Magnitude Difference in g-band > 2 mag**\n   - Join the filtered `oid`s from Step 2 with the `magstat` table.\n   - Filter `magstat` rows where `fid = 1` (g-band).\n   - Calculate the difference between `magmax` and `magmin` and filter where this difference is greater than 2.\n   - This step ensures the objects have significant variability in the g-band.\n\n5. **Step 4: Retrieve Features for the Filtered Objects**\n   - Since the user requests the feature name, value, and feature fid (renamed as `feature_fid`), query the `feature` table.\n   - Join the `feature` table with the filtered `oid`s from Step 3.\n   - Select columns: `oid`, `name`, `value`, and `fid` (renamed as `feature_fid`).\n   - No specific feature filtering is requested, so retrieve all features for these objects.\n\n6. **Step 5: Retrieve Detections for the Filtered Objects**\n   - Query the `detection` table for the filtered `oid`s from Step 3.\n   - Select columns: `oid`, `candid` (candidate identifier), `magpsf` (psf magnitude), `sigmapsf` (magnitude error), `fid` (band identifier), and `mjd` (time of detection).\n   - This will provide the time series data for the detections.\n\n7. **Step 6: Combine Features and Detections**\n   - The user wants the output as a function of time, implying that detection time (`mjd`) is important.\n   - Since features are static per object and detections are time-dependent, the query should join the `feature` and `detection` tables on `oid`.\n   - This join will produce rows with:\n     - `oid`\n     - `candid`\n     - `feature` name, value, and `feature_fid`\n     - `magpsf`, `sigmapsf`, `fid` (from detection)\n     - `mjd` (time of detection)\n   - This join will produce multiple rows per object per detection per feature.\n\n8. **Step 7: Final Selection and Ordering**\n   - Select the columns as requested:\n     - `oid` (object identifier)\n     - `candid` (candidate identifier)\n     - `feature` name\n     - `feature` value\n     - `magpsf` (psf magnitude)\n     - `sigmapsf` (magnitude error)\n     - `fid` from `feature` table renamed as `feature_fid`\n     - `mjd` (time of detection)\n   - Order the results by `oid` ascending.\n\n9. **Step 8: Optimize the Query**\n   - Use INNER JOINs to ensure only objects meeting all criteria are included.\n   - Use subqueries or CTEs (WITH clauses) to filter objects stepwise:\n     - First filter by classification and probability.\n     - Then filter by number of detections.\n     - Then filter by magnitude difference in g-band.\n   - Join the filtered object list with `feature` and `detection` tables.\n   - Apply the renaming of the `fid` column from the `feature` table as `feature_fid` in the SELECT clause.\n\n10. **Summary of the Query Logic:**\n    - Start with a subquery filtering `probability` for SNII with probability > 0.6, ranking=1, classifier_name='lc_classifier'.\n    - Join with `object` to filter `ndet > 50`.\n    - Join with `magstat` filtered on `fid=1` and `(magmax - magmin) > 2`.\n    - Use the resulting `oid`s to join with `feature` and `detection`.\n    - Select the requested columns, rename `feature.fid` as `feature_fid`.\n    - Order by `oid`.\n\nThis decomposition plan ensures the query is accurate, efficient, and meets all user requirements."
                },
                "in_toks": 6732,
                "out_toks": 1370,
                "id": "chatcmpl-BgxqU2XrXLVqPtKjrvkEmDxPBbf75",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        }
    },
    "0": {
        "0": {
            "req_id": 0,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version']",
                    "1": "['object', 'probability', 'feature', 'feature_version']"
                },
                "in_toks": 823,
                "out_toks": 28,
                "id": "chatcmpl-BgrYWVVZvdq4YSq9k9qtCqcKx4nN1",
                "created": 1749555344,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    p.oid, \n    p.probability, \n    f.value, \n    f.name, \n    f.fid, \n    f.version\nFROM \n    probability p\nINNER JOIN \n    feature f ON p.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.7\n    AND f.name = 'Multiband_period'\n    AND f.value BETWEEN 3 AND 10\n    AND EXISTS (\n        SELECT 1\n        FROM feature f2\n        WHERE f2.oid = p.oid\n          AND f2.name = 'Amplitude'\n          AND f2.value > 0.5\n    )\nORDER BY \n    p.probability DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p.oid, \n    p.probability, \n    f.value, \n    f.name, \n    f.fid, \n    f.version\nFROM \n    probability p\nINNER JOIN \n    feature f ON p.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.7\n    AND f.name = 'Multiband_period'\n    AND f.value BETWEEN 3 AND 10\n    AND EXISTS (\n        SELECT 1\n        FROM feature f2\n        WHERE f2.oid = p.oid\n          AND f2.name = 'Amplitude'\n          AND f2.value > 0.5\n    )\nORDER BY \n    p.probability DESC;\n```"
                },
                "in_toks": 4947,
                "out_toks": 183,
                "id": "chatcmpl-BgxqU3onwvB456pBBx2sP1FXdvxmG",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3630,
                "out_toks": 6,
                "id": "chatcmpl-BgrYXOhqqQE3Amzq1dgE4VK0QDM3V",
                "created": 1749555345,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 0,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version']",
                    "1": "['object', 'probability', 'feature', 'feature_version']"
                },
                "in_toks": 823,
                "out_toks": 28,
                "id": "chatcmpl-BgrYWVVZvdq4YSq9k9qtCqcKx4nN1",
                "created": 1749555344,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    p.oid, \n    p.probability, \n    f.value, \n    f.name, \n    f.fid, \n    f.version\nFROM \n    probability p\nINNER JOIN \n    feature f ON p.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.7\n    AND f.name = 'Multiband_period'\n    AND f.value BETWEEN 3 AND 10\n    AND EXISTS (\n        SELECT 1\n        FROM feature f2\n        WHERE f2.oid = p.oid\n          AND f2.name = 'Amplitude'\n          AND f2.value > 0.5\n    )\nORDER BY \n    p.probability DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p.oid, \n    p.probability, \n    f.value, \n    f.name, \n    f.fid, \n    f.version\nFROM \n    probability p\nINNER JOIN \n    feature f ON p.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.7\n    AND f.name = 'Multiband_period'\n    AND f.value BETWEEN 3 AND 10\n    AND EXISTS (\n        SELECT 1\n        FROM feature f2\n        WHERE f2.oid = p.oid\n          AND f2.name = 'Amplitude'\n          AND f2.value > 0.5\n    )\nORDER BY \n    p.probability DESC;\n```"
                },
                "in_toks": 4947,
                "out_toks": 183,
                "id": "chatcmpl-BgxqUnwrtGnfIR3mXCwdaa9zLzXpi",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3630,
                "out_toks": 6,
                "id": "chatcmpl-BgrYYrXXBNXvtMlaAcbSEUmI8BGu8",
                "created": 1749555346,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "28": {
        "0": {
            "req_id": 28,
            "experiment_id": "run_0",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['information_schema.tables']",
                    "1": "['information_schema.tables']"
                },
                "in_toks": 758,
                "out_toks": 10,
                "id": "chatcmpl-BgrYZC6s4535aAJb5wkbFADUwbRAg",
                "created": 1749555347,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce'\n  AND table_type = 'BASE TABLE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce'\n  AND table_type = 'BASE TABLE';\n```"
                },
                "in_toks": 1739,
                "out_toks": 30,
                "id": "chatcmpl-BgxqWGfvm9geuoSFNuvXF9j1Xa9yC",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 415,
                "out_toks": 6,
                "id": "chatcmpl-BgrYa48dmAZ3Ci2TpAqlE6beMMXN9",
                "created": 1749555348,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 28,
            "experiment_id": "run_1",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['information_schema.tables']",
                    "1": "['information_schema.tables']"
                },
                "in_toks": 758,
                "out_toks": 10,
                "id": "chatcmpl-BgrYZC6s4535aAJb5wkbFADUwbRAg",
                "created": 1749555347,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce'\n  AND table_type = 'BASE TABLE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce'\n  AND table_type = 'BASE TABLE';\n```"
                },
                "in_toks": 1739,
                "out_toks": 30,
                "id": "chatcmpl-BgxqWN1KLZE2y9mx25HIPGhPDX83g",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 415,
                "out_toks": 6,
                "id": "chatcmpl-BgrYcAbj68JvYd7nKU7ZqWQWnOMuy",
                "created": 1749555350,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "36": {
        "0": {
            "req_id": 36,
            "experiment_id": "run_0",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']",
                    "1": "['feature']"
                },
                "in_toks": 766,
                "out_toks": 6,
                "id": "chatcmpl-BgrYetSFFeq1tpzF7qTTB6IDaFDsi",
                "created": 1749555352,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid, name, value\nFROM feature\nWHERE oid = 'ZTF20aaelulu';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid, name, value\nFROM feature\nWHERE oid = 'ZTF20aaelulu';\n```"
                },
                "in_toks": 4172,
                "out_toks": 25,
                "id": "chatcmpl-BgxqXv0ZrzXYTap3YrCGIkXWOyGiG",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 2855,
                "out_toks": 6,
                "id": "chatcmpl-BgrYfFDiQQokXVhS3PwEeHb1QDX5W",
                "created": 1749555353,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 36,
            "experiment_id": "run_1",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']",
                    "1": "['feature']"
                },
                "in_toks": 766,
                "out_toks": 6,
                "id": "chatcmpl-BgrYetSFFeq1tpzF7qTTB6IDaFDsi",
                "created": 1749555352,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid, name, value\nFROM feature\nWHERE oid = 'ZTF20aaelulu';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid, name, value\nFROM feature\nWHERE oid = 'ZTF20aaelulu';\n```"
                },
                "in_toks": 4172,
                "out_toks": 25,
                "id": "chatcmpl-BgxqUXZw9T7paybQc5MbwY91pPBqK",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 2855,
                "out_toks": 6,
                "id": "chatcmpl-BgrYgPnMcRUXlDBbdF68l4L8k3IN2",
                "created": 1749555354,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "38": {
        "0": {
            "req_id": 38,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat']",
                    "1": "['object', 'probability', 'magstat']"
                },
                "in_toks": 804,
                "out_toks": 22,
                "id": "chatcmpl-BgrYhR4aZcgDY6N4xpKAF1oQoEhwD",
                "created": 1749555355,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\n(\n  SELECT p.*, o.*\n  FROM probability p\n  INNER JOIN object o ON p.oid = o.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.ranking = 1\n    AND p.probability > 0.6\n    AND o.ndet BETWEEN 30 AND 200\n  ORDER BY p.probability DESC\n  LIMIT 1000\n)\nUNION ALL\n(\n  SELECT p.*, o.*\n  FROM probability p\n  INNER JOIN object o ON p.oid = o.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'QSO'\n    AND p.ranking = 1\n    AND p.probability > 0.5\n    AND o.ndet BETWEEN 30 AND 200\n  ORDER BY p.probability DESC\n  LIMIT 1000\n)\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n(\n  SELECT p.*, o.*\n  FROM probability p\n  INNER JOIN object o ON p.oid = o.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.ranking = 1\n    AND p.probability > 0.6\n    AND o.ndet BETWEEN 30 AND 200\n  ORDER BY p.probability DESC\n  LIMIT 1000\n)\nUNION ALL\n(\n  SELECT p.*, o.*\n  FROM probability p\n  INNER JOIN object o ON p.oid = o.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'QSO'\n    AND p.ranking = 1\n    AND p.probability > 0.5\n    AND o.ndet BETWEEN 30 AND 200\n  ORDER BY p.probability DESC\n  LIMIT 1000\n)\n```"
                },
                "in_toks": 3162,
                "out_toks": 199,
                "id": "chatcmpl-BgxqUObUkxCYhD33Be2DhTWnparfE",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1845,
                "out_toks": 6,
                "id": "chatcmpl-BgrYjegrAFLBS4Sup39lT3XM8AgE3",
                "created": 1749555357,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 38,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat']",
                    "1": "['object', 'probability', 'magstat']"
                },
                "in_toks": 804,
                "out_toks": 22,
                "id": "chatcmpl-BgrYhR4aZcgDY6N4xpKAF1oQoEhwD",
                "created": 1749555355,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\n(\n  SELECT p.*, o.*\n  FROM probability p\n  INNER JOIN object o ON p.oid = o.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND o.ndet BETWEEN 30 AND 200\n  ORDER BY p.probability DESC\n  LIMIT 1000\n)\nUNION ALL\n(\n  SELECT p.*, o.*\n  FROM probability p\n  INNER JOIN object o ON p.oid = o.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'QSO'\n    AND p.probability > 0.5\n    AND o.ndet BETWEEN 30 AND 200\n  ORDER BY p.probability DESC\n  LIMIT 1000\n);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n(\n  SELECT p.*, o.*\n  FROM probability p\n  INNER JOIN object o ON p.oid = o.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n    AND o.ndet BETWEEN 30 AND 200\n  ORDER BY p.probability DESC\n  LIMIT 1000\n)\nUNION ALL\n(\n  SELECT p.*, o.*\n  FROM probability p\n  INNER JOIN object o ON p.oid = o.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'QSO'\n    AND p.probability > 0.5\n    AND o.ndet BETWEEN 30 AND 200\n  ORDER BY p.probability DESC\n  LIMIT 1000\n);\n```"
                },
                "in_toks": 3162,
                "out_toks": 199,
                "id": "chatcmpl-BgxqUMZhni2YlNkPhUaOpBK9tZk9o",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1845,
                "out_toks": 6,
                "id": "chatcmpl-BgrYj1FJ8U1S1CFShc1iGwmkriBgU",
                "created": 1749555357,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "24": {
        "0": {
            "req_id": 24,
            "experiment_id": "run_0",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 811,
                "out_toks": 6,
                "id": "chatcmpl-BgrYlOET9MTdY2h4OOXWv9cIuKaTH",
                "created": 1749555359,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n    ('source_1', 160.18301441363647, 33.0164673528409),\n    ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.*\nFROM object o\nJOIN catalog c ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)\nWHERE o.firstmjd >= 59976.0\n  AND o.firstmjd < 59983.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n    ('source_1', 160.18301441363647, 33.0164673528409),\n    ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.*\nFROM object o\nJOIN catalog c ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)\nWHERE o.firstmjd >= 59976.0\n  AND o.firstmjd < 59983.0;\n```"
                },
                "in_toks": 2297,
                "out_toks": 128,
                "id": "chatcmpl-BgxqUKi0xFBMldBibhbnOOIwql9yu",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 951,
                "out_toks": 6,
                "id": "chatcmpl-BgrYmpg2vvxBVbaAKWcJEoG3rouTB",
                "created": 1749555360,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 24,
            "experiment_id": "run_1",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 811,
                "out_toks": 6,
                "id": "chatcmpl-BgrYlOET9MTdY2h4OOXWv9cIuKaTH",
                "created": 1749555359,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n    ('source_1', 160.18301441363647, 33.0164673528409),\n    ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.*\nFROM object o\nJOIN catalog c ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)\nWHERE o.firstmjd >= 59976.0\n  AND o.firstmjd < 59983.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n    ('source_1', 160.18301441363647, 33.0164673528409),\n    ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.*\nFROM object o\nJOIN catalog c ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)\nWHERE o.firstmjd >= 59976.0\n  AND o.firstmjd < 59983.0;\n```"
                },
                "in_toks": 2297,
                "out_toks": 128,
                "id": "chatcmpl-BgxqY1cozli3UbZRpVHT3tp7TJwth",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 951,
                "out_toks": 6,
                "id": "chatcmpl-BgrYnQTiI3CrYti760tkb3AfPhSZx",
                "created": 1749555361,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "31": {
        "0": {
            "req_id": 31,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability', 'taxonomy']",
                    "1": "['object', 'feature', 'probability', 'taxonomy']"
                },
                "in_toks": 783,
                "out_toks": 26,
                "id": "chatcmpl-BgrYod7TCmasKGtWxm7NF7SmPKFs4",
                "created": 1749555362,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH features_pivot AS (\n  SELECT\n    oid,\n    jsonb_object_agg(feature_name, feature_value) AS features_json\n  FROM feature\n  GROUP BY oid\n)\nSELECT\n  o.oid,\n  o.gal_l,\n  o.gal_b,\n  p.class_name,\n  f.features_json\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nLEFT JOIN features_pivot f ON o.oid = f.oid\nWHERE o.firstmjd >= 59976.0\n  AND o.firstmjd < 59978.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH features_pivot AS (\n  SELECT\n    oid,\n    jsonb_object_agg(feature_name, feature_value) AS features_json\n  FROM feature\n  GROUP BY oid\n)\nSELECT\n  o.oid,\n  o.gal_l,\n  o.gal_b,\n  p.class_name,\n  f.features_json\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nLEFT JOIN features_pivot f ON o.oid = f.oid\nWHERE o.firstmjd >= 59976.0\n  AND o.firstmjd < 59978.0;\n```"
                },
                "in_toks": 2521,
                "out_toks": 148,
                "id": "chatcmpl-Bh2hryrgnvl3csIWoxPNsW8sEhUgD",
                "created": 1749598207,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 3584,
                "out_toks": 6,
                "id": "chatcmpl-BgrYpm4NqJ5extyVQwlgJC2c9HnWX",
                "created": 1749555363,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that fulfills the user request, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main object information, including the first detection time and galactic coordinates, is stored in the `object` table.\n     - Use `firstmjd` column to filter objects detected between February 1 and 2, 2023.\n     - Use `gal_l` and `gal_b` columns for galactic longitude and latitude, respectively.\n   - The classification information is in the `probability` table.\n     - Filter by `classifier_name = 'lc_classifier'` to get classifications from the light curve classifier.\n     - Use `class_name` to get the class assigned to each object.\n     - Use `ranking = 1` to get only the most likely classification.\n   - The features are stored in the `feature` table.\n     - Retrieve all feature columns for each object.\n     - The `feature` table contains multiple rows per object, one per feature, so these need to be pivoted or aggregated appropriately.\n\n2. **Define the Time Range Filter:**\n   - Use the `firstmjd` column in the `object` table.\n   - Filter for `firstmjd >= 59976.0` and `firstmjd < 59978.0` to cover February 1 and 2, 2023 (MJD dates inclusive of the start date and exclusive of the end date).\n\n3. **Join Tables Appropriately:**\n   - Join `object` and `probability` tables on `oid` to associate each object with its classification.\n   - Join `feature` table on `oid` to get the features for each object.\n   - Since `feature` has multiple rows per object (one per feature), consider how to present these features:\n     - Option 1: Return multiple rows per object, each with one feature name and value.\n     - Option 2: Aggregate features into a JSON or key-value structure per object.\n     - Option 3: Select only specific features if the user wants a fixed set.\n   - Since the user requests \"feature columns,\" the best approach is to pivot features into columns or return them as key-value pairs.\n\n4. **Apply Default Probability Conditions:**\n   - Filter `probability` table by `classifier_name = 'lc_classifier'`.\n   - Filter by `ranking = 1` to get the most likely class only.\n\n5. **Select Required Columns:**\n   - From `object`: `oid`, `gal_l`, `gal_b`.\n   - From `probability`: `class_name`.\n   - From `feature`: all feature names and their values for each object.\n\n6. **Handle Feature Data:**\n   - Since the `feature` table stores features in rows, to get feature columns, you need to pivot the data.\n   - Use a subquery or CTE to pivot features for each object into columns.\n   - Alternatively, aggregate features into a JSON object per object for easier retrieval.\n\n7. **Construct the Query Logic:**\n   - Start with filtering objects by `firstmjd` in the specified date range.\n   - Join with `probability` to get the classification, applying the default filters.\n   - Join or aggregate features for each object.\n   - Select the requested columns.\n\n8. **Ordering and Output:**\n   - Optionally order results by `firstmjd` or `oid` for clarity.\n   - Return all requested columns: galactic coordinates, features, class name, and object identifiers.\n\n9. **Summary of Steps:**\n   - Filter `object` by `firstmjd` between 59976.0 and 59978.0.\n   - Join with `probability` on `oid` where `classifier_name = 'lc_classifier'` and `ranking = 1`.\n   - Join or aggregate `feature` rows per `oid` to get feature columns.\n   - Select `oid`, `gal_l`, `gal_b`, `class_name`, and all feature columns.\n   - Return the result set.\n\nThis plan ensures the query returns the galactic coordinates, all features, classification class name, and object identifiers for objects first detected between February 1 and 2, 2023, classified by the light curve classifier with the highest ranking.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that fulfills the user request, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main object information, including the first detection time and galactic coordinates, is stored in the `object` table.\n     - Use `firstmjd` column to filter objects detected between February 1 and 2, 2023.\n     - Use `gal_l` and `gal_b` columns for galactic longitude and latitude, respectively.\n   - The classification information is in the `probability` table.\n     - Filter by `classifier_name = 'lc_classifier'` to get classifications from the light curve classifier.\n     - Use `class_name` to get the class assigned to each object.\n     - Use `ranking = 1` to get only the most likely classification.\n   - The features are stored in the `feature` table.\n     - Retrieve all feature columns for each object.\n     - The `feature` table contains multiple rows per object, one per feature, so these need to be pivoted or aggregated appropriately.\n\n2. **Define the Time Range Filter:**\n   - Use the `firstmjd` column in the `object` table.\n   - Filter for `firstmjd >= 59976.0` and `firstmjd < 59978.0` to cover February 1 and 2, 2023 (MJD dates inclusive of the start date and exclusive of the end date).\n\n3. **Join Tables Appropriately:**\n   - Join `object` and `probability` tables on `oid` to associate each object with its classification.\n   - Join `feature` table on `oid` to get the features for each object.\n   - Since `feature` has multiple rows per object (one per feature), consider how to present these features:\n     - Option 1: Return multiple rows per object, each with one feature name and value.\n     - Option 2: Aggregate features into a JSON or key-value structure per object.\n     - Option 3: Select only specific features if the user wants a fixed set.\n   - Since the user requests \"feature columns,\" the best approach is to pivot features into columns or return them as key-value pairs.\n\n4. **Apply Default Probability Conditions:**\n   - Filter `probability` table by `classifier_name = 'lc_classifier'`.\n   - Filter by `ranking = 1` to get the most likely class only.\n\n5. **Select Required Columns:**\n   - From `object`: `oid`, `gal_l`, `gal_b`.\n   - From `probability`: `class_name`.\n   - From `feature`: all feature names and their values for each object.\n\n6. **Handle Feature Data:**\n   - Since the `feature` table stores features in rows, to get feature columns, you need to pivot the data.\n   - Use a subquery or CTE to pivot features for each object into columns.\n   - Alternatively, aggregate features into a JSON object per object for easier retrieval.\n\n7. **Construct the Query Logic:**\n   - Start with filtering objects by `firstmjd` in the specified date range.\n   - Join with `probability` to get the classification, applying the default filters.\n   - Join or aggregate features for each object.\n   - Select the requested columns.\n\n8. **Ordering and Output:**\n   - Optionally order results by `firstmjd` or `oid` for clarity.\n   - Return all requested columns: galactic coordinates, features, class name, and object identifiers.\n\n9. **Summary of Steps:**\n   - Filter `object` by `firstmjd` between 59976.0 and 59978.0.\n   - Join with `probability` on `oid` where `classifier_name = 'lc_classifier'` and `ranking = 1`.\n   - Join or aggregate `feature` rows per `oid` to get feature columns.\n   - Select `oid`, `gal_l`, `gal_b`, `class_name`, and all feature columns.\n   - Return the result set.\n\nThis plan ensures the query returns the galactic coordinates, all features, classification class name, and object identifiers for objects first detected between February 1 and 2, 2023, classified by the light curve classifier with the highest ranking."
                },
                "in_toks": 5246,
                "out_toks": 893,
                "id": "chatcmpl-BgxqUrtDFKwEqXmBAoTT53CYDHeu4",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        },
        "1": {
            "req_id": 31,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability', 'taxonomy']",
                    "1": "['object', 'feature', 'probability', 'taxonomy']"
                },
                "in_toks": 783,
                "out_toks": 26,
                "id": "chatcmpl-BgrYod7TCmasKGtWxm7NF7SmPKFs4",
                "created": 1749555362,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\n-- Query to get galactic coordinates, features, class name, and object IDs for objects first detected between Feb 1 and 2, 2023,\n-- classified by the light curve classifier with ranking=1, pivoting features into columns.\n\nWITH filtered_objects AS (\n    SELECT oid, gal_l, gal_b\n    FROM object\n    WHERE firstmjd >= 59976.0 AND firstmjd < 59978.0\n),\nclassified_objects AS (\n    SELECT p.oid, p.class_name\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nfeatures_pivot AS (\n    SELECT\n        f.oid,\n        MAX(CASE WHEN f.name = 'amplitude' THEN f.value END) AS amplitude,\n        MAX(CASE WHEN f.name = 'period' THEN f.value END) AS period,\n        MAX(CASE WHEN f.name = 'skewness' THEN f.value END) AS skewness,\n        MAX(CASE WHEN f.name = 'kurtosis' THEN f.value END) AS kurtosis,\n        MAX(CASE WHEN f.name = 'median_mag' THEN f.value END) AS median_mag,\n        MAX(CASE WHEN f.name = 'std_dev' THEN f.value END) AS std_dev\n    FROM feature f\n    GROUP BY f.oid\n)\n\nSELECT \n    fo.oid,\n    fo.gal_l,\n    fo.gal_b,\n    co.class_name,\n    fp.amplitude,\n    fp.period,\n    fp.skewness,\n    fp.kurtosis,\n    fp.median_mag,\n    fp.std_dev\nFROM filtered_objects fo\nINNER JOIN classified_objects co ON fo.oid = co.oid\nLEFT JOIN features_pivot fp ON fo.oid = fp.oid\nORDER BY fo.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Query to get galactic coordinates, features, class name, and object IDs for objects first detected between Feb 1 and 2, 2023,\n-- classified by the light curve classifier with ranking=1, pivoting features into columns.\n\nWITH filtered_objects AS (\n    SELECT oid, gal_l, gal_b\n    FROM object\n    WHERE firstmjd >= 59976.0 AND firstmjd < 59978.0\n),\nclassified_objects AS (\n    SELECT p.oid, p.class_name\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nfeatures_pivot AS (\n    SELECT\n        f.oid,\n        MAX(CASE WHEN f.name = 'amplitude' THEN f.value END) AS amplitude,\n        MAX(CASE WHEN f.name = 'period' THEN f.value END) AS period,\n        MAX(CASE WHEN f.name = 'skewness' THEN f.value END) AS skewness,\n        MAX(CASE WHEN f.name = 'kurtosis' THEN f.value END) AS kurtosis,\n        MAX(CASE WHEN f.name = 'median_mag' THEN f.value END) AS median_mag,\n        MAX(CASE WHEN f.name = 'std_dev' THEN f.value END) AS std_dev\n    FROM feature f\n    GROUP BY f.oid\n)\n\nSELECT \n    fo.oid,\n    fo.gal_l,\n    fo.gal_b,\n    co.class_name,\n    fp.amplitude,\n    fp.period,\n    fp.skewness,\n    fp.kurtosis,\n    fp.median_mag,\n    fp.std_dev\nFROM filtered_objects fo\nINNER JOIN classified_objects co ON fo.oid = co.oid\nLEFT JOIN features_pivot fp ON fo.oid = fp.oid\nORDER BY fo.oid;\n```"
                },
                "in_toks": 2554,
                "out_toks": 383,
                "id": "chatcmpl-Bh2hs2Y3VQaR0IIJP4AydPhmLW9Tt",
                "created": 1749598208,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 3584,
                "out_toks": 6,
                "id": "chatcmpl-BgrYqIbSbDwFtwJEJiXC9jcKRZtQD",
                "created": 1749555364,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that fulfills the user request, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main table for object information is `object`.\n     - Relevant columns: `oid` (object identifier), `firstmjd` (time of first detection), `gal_l` (galactic longitude), and `gal_b` (galactic latitude).\n   - The classification information is stored in the `probability` table.\n     - Relevant columns: `oid` (object identifier), `class_name` (classification class), `classifier_name` (classifier used), `ranking` (class probability ranking).\n   - The features are stored in the `feature` table.\n     - Relevant columns: `oid` (object identifier), `name` (feature name), `value` (feature value).\n\n2. **Define the Time Range Filter:**\n   - The user wants objects first detected between February 1 and 2, 2023.\n   - Using the provided MJD dates, this corresponds to `firstmjd` between 59976.0 and 59977.0 (assuming the end date is exclusive or inclusive depending on interpretation; here, to cover February 1 and 2 fully, use 59976.0 \u2264 firstmjd < 59978.0).\n   - This filter will be applied on the `object.firstmjd` column.\n\n3. **Filter by Classifier and Ranking:**\n   - Only include classifications from the light curve classifier: `probability.classifier_name = 'lc_classifier'`.\n   - Only include the most likely class per object: `probability.ranking = 1`.\n\n4. **Join Conditions:**\n   - Join `object` and `probability` tables on `oid` to associate each object with its classification.\n   - Join `feature` table on `oid` to retrieve all features for each object.\n   - Since features are stored as multiple rows per object (one per feature), the query will need to handle this appropriately, either by returning multiple rows per object (one per feature) or by aggregating features into columns (pivot). The user request is to return \"feature columns,\" so the query should pivot or aggregate features into columns.\n   - To pivot features, select a set of relevant features or all features if feasible, and use conditional aggregation or a crosstab function to transform rows into columns.\n\n5. **Select Columns to Return:**\n   - From `object`: `oid`, `gal_l`, `gal_b`.\n   - From `probability`: `class_name`.\n   - From `feature`: multiple feature columns (each feature name as a column, with its corresponding value).\n   - If the user does not specify which features, include all features available for the selected objects.\n\n6. **Handle Feature Version and Bandpass:**\n   - The `feature` table includes `version` and `fid` columns.\n   - If the user does not specify a feature version or bandpass, select the latest or default version and all bands, or choose a specific version if known.\n   - To keep the query manageable, filter features by a specific version (e.g., the latest version) or include all versions if necessary.\n\n7. **Query Structure:**\n   - Start with filtering `object` by `firstmjd` in the specified range.\n   - Join with `probability` filtered by `classifier_name='lc_classifier'` and `ranking=1`.\n   - Join with `feature` filtered by the chosen version(s).\n   - Use aggregation or pivot to convert feature rows into columns.\n   - Select the required columns: `oid`, `gal_l`, `gal_b`, `class_name`, and feature columns.\n\n8. **Ordering and Output:**\n   - Optionally order results by `firstmjd` or `oid`.\n   - Return all matching objects with their galactic coordinates, classification, and features.\n\n9. **Performance Considerations:**\n   - Use indexes on `object.firstmjd`, `probability.oid`, and `feature.oid` for efficient joins and filtering.\n   - Limit the number of features if the dataset is large to avoid performance issues.\n   - Use appropriate filtering on `feature.version` to reduce data volume.\n\nBy following these steps, the resulting query will accurately retrieve the galactic coordinates, features, class names, and object identifiers for objects classified by the light curve classifier with first detections between February 1 and 2, 2023.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that fulfills the user request, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main table for object information is `object`.\n     - Relevant columns: `oid` (object identifier), `firstmjd` (time of first detection), `gal_l` (galactic longitude), and `gal_b` (galactic latitude).\n   - The classification information is stored in the `probability` table.\n     - Relevant columns: `oid` (object identifier), `class_name` (classification class), `classifier_name` (classifier used), `ranking` (class probability ranking).\n   - The features are stored in the `feature` table.\n     - Relevant columns: `oid` (object identifier), `name` (feature name), `value` (feature value).\n\n2. **Define the Time Range Filter:**\n   - The user wants objects first detected between February 1 and 2, 2023.\n   - Using the provided MJD dates, this corresponds to `firstmjd` between 59976.0 and 59977.0 (assuming the end date is exclusive or inclusive depending on interpretation; here, to cover February 1 and 2 fully, use 59976.0 \u2264 firstmjd < 59978.0).\n   - This filter will be applied on the `object.firstmjd` column.\n\n3. **Filter by Classifier and Ranking:**\n   - Only include classifications from the light curve classifier: `probability.classifier_name = 'lc_classifier'`.\n   - Only include the most likely class per object: `probability.ranking = 1`.\n\n4. **Join Conditions:**\n   - Join `object` and `probability` tables on `oid` to associate each object with its classification.\n   - Join `feature` table on `oid` to retrieve all features for each object.\n   - Since features are stored as multiple rows per object (one per feature), the query will need to handle this appropriately, either by returning multiple rows per object (one per feature) or by aggregating features into columns (pivot). The user request is to return \"feature columns,\" so the query should pivot or aggregate features into columns.\n   - To pivot features, select a set of relevant features or all features if feasible, and use conditional aggregation or a crosstab function to transform rows into columns.\n\n5. **Select Columns to Return:**\n   - From `object`: `oid`, `gal_l`, `gal_b`.\n   - From `probability`: `class_name`.\n   - From `feature`: multiple feature columns (each feature name as a column, with its corresponding value).\n   - If the user does not specify which features, include all features available for the selected objects.\n\n6. **Handle Feature Version and Bandpass:**\n   - The `feature` table includes `version` and `fid` columns.\n   - If the user does not specify a feature version or bandpass, select the latest or default version and all bands, or choose a specific version if known.\n   - To keep the query manageable, filter features by a specific version (e.g., the latest version) or include all versions if necessary.\n\n7. **Query Structure:**\n   - Start with filtering `object` by `firstmjd` in the specified range.\n   - Join with `probability` filtered by `classifier_name='lc_classifier'` and `ranking=1`.\n   - Join with `feature` filtered by the chosen version(s).\n   - Use aggregation or pivot to convert feature rows into columns.\n   - Select the required columns: `oid`, `gal_l`, `gal_b`, `class_name`, and feature columns.\n\n8. **Ordering and Output:**\n   - Optionally order results by `firstmjd` or `oid`.\n   - Return all matching objects with their galactic coordinates, classification, and features.\n\n9. **Performance Considerations:**\n   - Use indexes on `object.firstmjd`, `probability.oid`, and `feature.oid` for efficient joins and filtering.\n   - Limit the number of features if the dataset is large to avoid performance issues.\n   - Use appropriate filtering on `feature.version` to reduce data volume.\n\nBy following these steps, the resulting query will accurately retrieve the galactic coordinates, features, class names, and object identifiers for objects classified by the light curve classifier with first detections between February 1 and 2, 2023."
                },
                "in_toks": 5246,
                "out_toks": 926,
                "id": "chatcmpl-Bh1zn6aadxChnlbrMjEFYXf6nHCKE",
                "created": 1749595475,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        }
    },
    "33": {
        "0": {
            "req_id": 33,
            "experiment_id": "run_0",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']",
                    "1": "['detection']"
                },
                "in_toks": 854,
                "out_toks": 8,
                "id": "chatcmpl-BgrYriyOo1BwwxVHbWIDJcmoFgX6a",
                "created": 1749555365,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid, candid, mjd, fid, magpsf\nFROM detection\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid, candid, mjd, fid, magpsf\nFROM detection\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```"
                },
                "in_toks": 2377,
                "out_toks": 104,
                "id": "chatcmpl-BgxqWnJrlwQt4UTPJkx1gVg5wwmXH",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1060,
                "out_toks": 6,
                "id": "chatcmpl-BgrYsq9WSKZa7EVLhZYMLMvP3N6vD",
                "created": 1749555366,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 33,
            "experiment_id": "run_1",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']",
                    "1": "['detection']"
                },
                "in_toks": 854,
                "out_toks": 8,
                "id": "chatcmpl-BgrYriyOo1BwwxVHbWIDJcmoFgX6a",
                "created": 1749555365,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid, candid, mjd, fid, magpsf\nFROM detection\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid, candid, mjd, fid, magpsf\nFROM detection\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```"
                },
                "in_toks": 2377,
                "out_toks": 104,
                "id": "chatcmpl-BgxqWMDB5uTbuTCK3FwswGpfbvXlQ",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1060,
                "out_toks": 6,
                "id": "chatcmpl-BgrYsIC4PTGubMWgJYpMjBky23XVt",
                "created": 1749555366,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "6": {
        "0": {
            "req_id": 6,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 837,
                "out_toks": 30,
                "id": "chatcmpl-BgrYtdleuXdI7xZPsYjZXmrXYyfbw",
                "created": 1749555367,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH prob_snII AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SNII'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\nobj_time_filtered AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd <= 59944.0\n      AND lastmjd >= 58484.0\n      AND oid IN (SELECT oid FROM prob_snII)\n),\nmagstat_g AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1\n      AND dmdt_first > 0.5\n      AND ndet > 30\n      AND oid IN (SELECT oid FROM obj_time_filtered)\n),\nmagstat_r AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n      AND dmdt_first > 0.5\n      AND ndet > 30\n      AND (lastmjd - firstmjd) >= 100\n      AND oid IN (SELECT oid FROM obj_time_filtered)\n),\nmagstat_filtered AS (\n    SELECT oid\n    FROM magstat_g\n    INTERSECT\n    SELECT oid\n    FROM magstat_r\n),\nfinal_oids AS (\n    SELECT oid\n    FROM prob_snII\n    WHERE oid IN (SELECT oid FROM magstat_filtered)\n)\nSELECT d.oid,\n       d.candid,\n       d.magpsf,\n       d.sigmapsf,\n       d.fid AS f_id,\n       d.mjd\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM final_oids)\n  AND d.mjd BETWEEN 58484.0 AND 59944.0\nORDER BY d.oid, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH prob_snII AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SNII'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\nobj_time_filtered AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd <= 59944.0\n      AND lastmjd >= 58484.0\n      AND oid IN (SELECT oid FROM prob_snII)\n),\nmagstat_g AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1\n      AND dmdt_first > 0.5\n      AND ndet > 30\n      AND oid IN (SELECT oid FROM obj_time_filtered)\n),\nmagstat_r AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n      AND dmdt_first > 0.5\n      AND ndet > 30\n      AND (lastmjd - firstmjd) >= 100\n      AND oid IN (SELECT oid FROM obj_time_filtered)\n),\nmagstat_filtered AS (\n    SELECT oid\n    FROM magstat_g\n    INTERSECT\n    SELECT oid\n    FROM magstat_r\n),\nfinal_oids AS (\n    SELECT oid\n    FROM prob_snII\n    WHERE oid IN (SELECT oid FROM magstat_filtered)\n)\nSELECT d.oid,\n       d.candid,\n       d.magpsf,\n       d.sigmapsf,\n       d.fid AS f_id,\n       d.mjd\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM final_oids)\n  AND d.mjd BETWEEN 58484.0 AND 59944.0\nORDER BY d.oid, d.mjd;\n```"
                },
                "in_toks": 3185,
                "out_toks": 365,
                "id": "chatcmpl-Bh2hrhksusXIS3tsY4wjMk5TImLnQ",
                "created": 1749598207,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "advanced",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'advanced'}"
                },
                "in_toks": 2426,
                "out_toks": 6,
                "id": "chatcmpl-BgrYu0WWVwlhCf53ZbZC0A6T70IiY",
                "created": 1749555368,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main object information is in the `object` table.\n   - Classification probabilities are in the `probability` table.\n   - Light curve data (detections) are in the `detection` table.\n   - Initial rise rate and observation duration per band are in the `magstat` table.\n   \n   Columns needed:\n   - From `object`: `oid` (object identifier).\n   - From `detection`: `candid` (candidate identifier), `magpsf` (magnitude), `sigmapsf` (magnitude error), `fid` (band identifier, to be renamed as `f_id`), `mjd` (time).\n   - From `probability`: `class_name`, `probability`, `ranking`, `classifier_name`.\n   - From `magstat`: `fid`, `dmdt_first` (initial rise rate), `ndet` (number of detections), `firstmjd`, `lastmjd` (to calculate observation duration).\n\n2. **Apply Classification and Probability Filters:**\n   - Filter `probability` table for:\n     - `class_name = 'SNII'` (Supernova Type II).\n     - `classifier_name = 'lc_classifier'` (default classifier).\n     - `ranking = 1` (most likely class).\n     - `probability > 0.6`.\n   - This will give the set of object IDs (`oid`) classified as SNII with high confidence.\n\n3. **Filter Objects by Observation Time Range:**\n   - Use the `object` table to ensure the objects have detections within the time range corresponding to years 2019-2022.\n   - The Modified Julian Date (MJD) range is from 58484.0 (start of 2019) to 59944.0 (end of 2022).\n   - Filter objects where `firstmjd` and `lastmjd` overlap with this range, or more conservatively, where `firstmjd <= 59944.0` and `lastmjd >= 58484.0`.\n   - Join with the filtered `probability` results on `oid`.\n\n4. **Filter by Initial Rise Rate and Number of Detections in g and r Bands:**\n   - Use the `magstat` table to filter objects with:\n     - `fid` in (1, 2) corresponding to g and r bands.\n     - `dmdt_first > 0.5` mag/day (initial rise rate).\n     - `ndet > 30` (number of detections).\n     - Observation duration in r-band (`fid=2`) of at least 100 days, calculated as `lastmjd - firstmjd >= 100`.\n   - Since the initial rise rate and number of detections are band-specific, ensure these conditions are met for both g and r bands.\n   - This requires joining or intersecting the `magstat` entries for the same `oid` for both bands.\n   - To do this:\n     - Create two subqueries from `magstat` filtered by `fid=1` and `fid=2` respectively, applying the conditions on `dmdt_first` and `ndet`.\n     - For the r-band (`fid=2`), also apply the observation duration condition.\n     - Intersect the sets of `oid` from both subqueries to ensure the object meets criteria in both bands.\n\n5. **Combine Filters on Objects:**\n   - Join the filtered `probability` results (step 2) with the filtered `object` results (step 3).\n   - Join the result with the filtered `magstat` results (step 4) to ensure all conditions are met.\n   - This will yield the final list of `oid` that satisfy classification, probability, time range, initial rise rate, number of detections, and observation duration criteria.\n\n6. **Retrieve Detection Data for Selected Objects:**\n   - From the `detection` table, select:\n     - `oid` (object identifier).\n     - `candid` (candidate identifier).\n     - `magpsf` (magnitude).\n     - `sigmapsf` (magnitude error).\n     - `fid` (band identifier), rename as `f_id`.\n     - `mjd` (time of detection).\n   - Filter detections to include only those with `oid` in the final filtered set from step 5.\n   - Optionally, filter detections to the time range 2019-2022 (`mjd` between 58484.0 and 59944.0) to match the user\u2019s request.\n\n7. **Final Output:**\n   - Select the columns as specified: object identifier (`oid`), candidate identifier (`candid`), magnitudes (`magpsf`), magnitude errors (`sigmapsf`), band identifiers renamed as `f_id`, and time (`mjd`).\n   - Order the results by `oid` and `mjd` to present the light curve data in chronological order per object.\n\n8. **Summary of Query Structure:**\n   - Subquery 1: Filter `probability` for SNII with probability > 0.6 and ranking=1.\n   - Subquery 2: Filter `object` for time range overlap.\n   - Subquery 3a: Filter `magstat` for g-band with `dmdt_first > 0.5` and `ndet > 30`.\n   - Subquery 3b: Filter `magstat` for r-band with `dmdt_first > 0.5`, `ndet > 30`, and observation duration >= 100 days.\n   - Intersect subqueries 3a and 3b on `oid`.\n   - Join subqueries 1, 2, and the intersection of 3a and 3b on `oid`.\n   - Use the resulting `oid` list to filter `detection` table.\n   - Select and rename columns as requested.\n\nThis decomposition ensures the query is efficient, uses appropriate joins and intersections, applies all filters correctly, and returns the requested data with the correct column names and conditions.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify Relevant Tables and Columns:**\n   - The main object information is in the `object` table.\n   - Classification probabilities are in the `probability` table.\n   - Light curve data (detections) are in the `detection` table.\n   - Initial rise rate and observation duration per band are in the `magstat` table.\n   \n   Columns needed:\n   - From `object`: `oid` (object identifier).\n   - From `detection`: `candid` (candidate identifier), `magpsf` (magnitude), `sigmapsf` (magnitude error), `fid` (band identifier, to be renamed as `f_id`), `mjd` (time).\n   - From `probability`: `class_name`, `probability`, `ranking`, `classifier_name`.\n   - From `magstat`: `fid`, `dmdt_first` (initial rise rate), `ndet` (number of detections), `firstmjd`, `lastmjd` (to calculate observation duration).\n\n2. **Apply Classification and Probability Filters:**\n   - Filter `probability` table for:\n     - `class_name = 'SNII'` (Supernova Type II).\n     - `classifier_name = 'lc_classifier'` (default classifier).\n     - `ranking = 1` (most likely class).\n     - `probability > 0.6`.\n   - This will give the set of object IDs (`oid`) classified as SNII with high confidence.\n\n3. **Filter Objects by Observation Time Range:**\n   - Use the `object` table to ensure the objects have detections within the time range corresponding to years 2019-2022.\n   - The Modified Julian Date (MJD) range is from 58484.0 (start of 2019) to 59944.0 (end of 2022).\n   - Filter objects where `firstmjd` and `lastmjd` overlap with this range, or more conservatively, where `firstmjd <= 59944.0` and `lastmjd >= 58484.0`.\n   - Join with the filtered `probability` results on `oid`.\n\n4. **Filter by Initial Rise Rate and Number of Detections in g and r Bands:**\n   - Use the `magstat` table to filter objects with:\n     - `fid` in (1, 2) corresponding to g and r bands.\n     - `dmdt_first > 0.5` mag/day (initial rise rate).\n     - `ndet > 30` (number of detections).\n     - Observation duration in r-band (`fid=2`) of at least 100 days, calculated as `lastmjd - firstmjd >= 100`.\n   - Since the initial rise rate and number of detections are band-specific, ensure these conditions are met for both g and r bands.\n   - This requires joining or intersecting the `magstat` entries for the same `oid` for both bands.\n   - To do this:\n     - Create two subqueries from `magstat` filtered by `fid=1` and `fid=2` respectively, applying the conditions on `dmdt_first` and `ndet`.\n     - For the r-band (`fid=2`), also apply the observation duration condition.\n     - Intersect the sets of `oid` from both subqueries to ensure the object meets criteria in both bands.\n\n5. **Combine Filters on Objects:**\n   - Join the filtered `probability` results (step 2) with the filtered `object` results (step 3).\n   - Join the result with the filtered `magstat` results (step 4) to ensure all conditions are met.\n   - This will yield the final list of `oid` that satisfy classification, probability, time range, initial rise rate, number of detections, and observation duration criteria.\n\n6. **Retrieve Detection Data for Selected Objects:**\n   - From the `detection` table, select:\n     - `oid` (object identifier).\n     - `candid` (candidate identifier).\n     - `magpsf` (magnitude).\n     - `sigmapsf` (magnitude error).\n     - `fid` (band identifier), rename as `f_id`.\n     - `mjd` (time of detection).\n   - Filter detections to include only those with `oid` in the final filtered set from step 5.\n   - Optionally, filter detections to the time range 2019-2022 (`mjd` between 58484.0 and 59944.0) to match the user\u2019s request.\n\n7. **Final Output:**\n   - Select the columns as specified: object identifier (`oid`), candidate identifier (`candid`), magnitudes (`magpsf`), magnitude errors (`sigmapsf`), band identifiers renamed as `f_id`, and time (`mjd`).\n   - Order the results by `oid` and `mjd` to present the light curve data in chronological order per object.\n\n8. **Summary of Query Structure:**\n   - Subquery 1: Filter `probability` for SNII with probability > 0.6 and ranking=1.\n   - Subquery 2: Filter `object` for time range overlap.\n   - Subquery 3a: Filter `magstat` for g-band with `dmdt_first > 0.5` and `ndet > 30`.\n   - Subquery 3b: Filter `magstat` for r-band with `dmdt_first > 0.5`, `ndet > 30`, and observation duration >= 100 days.\n   - Intersect subqueries 3a and 3b on `oid`.\n   - Join subqueries 1, 2, and the intersection of 3a and 3b on `oid`.\n   - Use the resulting `oid` list to filter `detection` table.\n   - Select and rename columns as requested.\n\nThis decomposition ensures the query is efficient, uses appropriate joins and intersections, applies all filters correctly, and returns the requested data with the correct column names and conditions."
                },
                "in_toks": 4342,
                "out_toks": 1316,
                "id": "chatcmpl-BgxqZwBRgNeuId948wHVNNCeLLRiu",
                "created": 1749579527,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        },
        "1": {
            "req_id": 6,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 837,
                "out_toks": 30,
                "id": "chatcmpl-BgrYtdleuXdI7xZPsYjZXmrXYyfbw",
                "created": 1749555367,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH prob_snII AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SNII'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\nmagstat_r AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n      AND (lastmjd - firstmjd) >= 100\n),\nmagstat_g_rise AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1\n      AND dmdt_first > 0.5\n),\nmagstat_r_rise AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n      AND dmdt_first > 0.5\n),\nmagstat_rise_both AS (\n    SELECT oid\n    FROM magstat_g_rise\n    INTERSECT\n    SELECT oid\n    FROM magstat_r_rise\n),\nobjects_filtered AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN prob_snII p ON o.oid = p.oid\n    INNER JOIN magstat_r mr ON o.oid = mr.oid\n    INNER JOIN magstat_rise_both rb ON o.oid = rb.oid\n    WHERE o.ndet > 30\n      AND o.firstmjd <= 59944.0\n      AND o.lastmjd >= 58484.0\n)\nSELECT d.oid,\n       d.candid,\n       d.magpsf,\n       d.sigmapsf,\n       d.fid AS f_id,\n       d.mjd\nFROM detection d\nINNER JOIN objects_filtered ofil ON d.oid = ofil.oid\nORDER BY d.oid, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH prob_snII AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SNII'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\nmagstat_r AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n      AND (lastmjd - firstmjd) >= 100\n),\nmagstat_g_rise AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1\n      AND dmdt_first > 0.5\n),\nmagstat_r_rise AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n      AND dmdt_first > 0.5\n),\nmagstat_rise_both AS (\n    SELECT oid\n    FROM magstat_g_rise\n    INTERSECT\n    SELECT oid\n    FROM magstat_r_rise\n),\nobjects_filtered AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN prob_snII p ON o.oid = p.oid\n    INNER JOIN magstat_r mr ON o.oid = mr.oid\n    INNER JOIN magstat_rise_both rb ON o.oid = rb.oid\n    WHERE o.ndet > 30\n      AND o.firstmjd <= 59944.0\n      AND o.lastmjd >= 58484.0\n)\nSELECT d.oid,\n       d.candid,\n       d.magpsf,\n       d.sigmapsf,\n       d.fid AS f_id,\n       d.mjd\nFROM detection d\nINNER JOIN objects_filtered ofil ON d.oid = ofil.oid\nORDER BY d.oid, d.mjd;\n```"
                },
                "in_toks": 3054,
                "out_toks": 367,
                "id": "chatcmpl-Bh2hupET9m0r6iUqXbNM7U3Up06b9",
                "created": 1749598210,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "advanced",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'advanced'}"
                },
                "in_toks": 2426,
                "out_toks": 6,
                "id": "chatcmpl-BgrYudZNjdfHuxovg8vFyOrWC6qL5",
                "created": 1749555368,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify the Relevant Tables and Columns:**\n   - The main tables involved will be:\n     - `probability`: to filter objects classified as 'SNII' with probability > 0.6 and ranking = 1, classifier_name = 'lc_classifier'.\n     - `object`: to get the object identifier and to filter objects with number of detections (`ndet`) > 30.\n     - `magstat`: to filter objects with at least 100 days of observations in the r-band (filter id = 2).\n     - `detection`: to retrieve candidate identifier (`candid`), magnitudes (`magpsf` or corrected magnitudes), magnitude errors (`sigmapsf` or corrected errors), band identifiers (`fid`), and time (`mjd`).\n   \n2. **Filter Objects by Classification and Probability:**\n   - From the `probability` table:\n     - Select objects (`oid`) where `class_name` = 'SNII'.\n     - Use `classifier_name` = 'lc_classifier'.\n     - Use `ranking` = 1 to get the most likely class.\n     - Filter for `probability` > 0.6.\n   - This will give a list of candidate objects classified as SN II with high confidence.\n\n3. **Filter Objects by Number of Detections:**\n   - Join the filtered `probability` results with the `object` table on `oid`.\n   - Filter objects where `ndet` (total number of detections) > 30.\n\n4. **Filter Objects by Observation Duration in r-band:**\n   - Join the above result with the `magstat` table on `oid`.\n   - Filter for `fid` = 2 (r-band).\n   - Filter for objects where the difference between `lastmjd` and `firstmjd` in `magstat` is at least 100 days.\n     - This ensures the object has at least 100 days of observations in the r-band.\n\n5. **Filter Objects by Initial Rise Rate in g and r Bands:**\n   - The initial rise rate is given by `dmdt_first` in the `magstat` table.\n   - We need to ensure that for both g-band (`fid`=1) and r-band (`fid`=2), the `dmdt_first` is greater than 0.5 mag/day.\n   - Since `magstat` is per band, we need to:\n     - Create two subqueries or use a self-join on `magstat` filtered by `oid`:\n       - One for `fid`=1 with `dmdt_first` > 0.5.\n       - One for `fid`=2 with `dmdt_first` > 0.5.\n     - Intersect or join these subqueries on `oid` to get objects satisfying the rise rate condition in both bands.\n\n6. **Filter Objects by Time Range (2019-2022):**\n   - Use the `object` table's `firstmjd` and `lastmjd` columns to ensure the object was observed within the Modified Julian Date range corresponding to 2019-2022:\n     - `firstmjd` <= 59944.0 (end of 2022)\n     - `lastmjd` >= 58484.0 (start of 2019)\n   - This ensures the object has observations overlapping the requested time period.\n\n7. **Retrieve Detection Information:**\n   - Join the filtered list of objects with the `detection` table on `oid`.\n   - Retrieve the following columns:\n     - `oid` (object identifier)\n     - `candid` (candidate identifier)\n     - `magpsf` (magnitude)\n     - `sigmapsf` (magnitude error)\n     - `fid` (band identifier) \u2014 rename this column as `f_id` in the output\n     - `mjd` (time of detection)\n   - No additional filters on detections are specified, so include all detections for the filtered objects.\n\n8. **Final Output and Ordering:**\n   - Select the columns as specified.\n   - Rename `fid` as `f_id`.\n   - Optionally, order the results by `oid` and `mjd` to have detections sorted by object and time.\n\n9. **Summary of Joins and Filters:**\n   - Start with `probability` filtered by class, classifier, ranking, and probability.\n   - Join with `object` to filter by `ndet` and time range.\n   - Join with `magstat` twice or use subqueries to filter by initial rise rate in g and r bands and observation duration in r-band.\n   - Join with `detection` to retrieve detection-level data.\n   \n10. **Additional Notes:**\n    - Ensure that all joins use the `oid` column.\n    - Use INNER JOINs to ensure only objects meeting all criteria are included.\n    - Use the default conditions for the `probability` table as specified.\n    - Use the exact class name 'SNII' as per the database.\n    - Use the exact filter IDs: 1 for g-band, 2 for r-band.\n    - Use the MJD dates for the time range filter as provided.\n    - Rename `fid` to `f_id` in the final SELECT clause.\n\nBy following these steps, the resulting query will efficiently retrieve the requested information about SN II objects observed between 2019 and 2022, with the specified probability, rise rate, observation duration, and detection count, including detailed detection data with renamed band identifiers.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves the requested information from the ALeRCE database, follow this detailed decomposition plan:\n\n1. **Identify the Relevant Tables and Columns:**\n   - The main tables involved will be:\n     - `probability`: to filter objects classified as 'SNII' with probability > 0.6 and ranking = 1, classifier_name = 'lc_classifier'.\n     - `object`: to get the object identifier and to filter objects with number of detections (`ndet`) > 30.\n     - `magstat`: to filter objects with at least 100 days of observations in the r-band (filter id = 2).\n     - `detection`: to retrieve candidate identifier (`candid`), magnitudes (`magpsf` or corrected magnitudes), magnitude errors (`sigmapsf` or corrected errors), band identifiers (`fid`), and time (`mjd`).\n   \n2. **Filter Objects by Classification and Probability:**\n   - From the `probability` table:\n     - Select objects (`oid`) where `class_name` = 'SNII'.\n     - Use `classifier_name` = 'lc_classifier'.\n     - Use `ranking` = 1 to get the most likely class.\n     - Filter for `probability` > 0.6.\n   - This will give a list of candidate objects classified as SN II with high confidence.\n\n3. **Filter Objects by Number of Detections:**\n   - Join the filtered `probability` results with the `object` table on `oid`.\n   - Filter objects where `ndet` (total number of detections) > 30.\n\n4. **Filter Objects by Observation Duration in r-band:**\n   - Join the above result with the `magstat` table on `oid`.\n   - Filter for `fid` = 2 (r-band).\n   - Filter for objects where the difference between `lastmjd` and `firstmjd` in `magstat` is at least 100 days.\n     - This ensures the object has at least 100 days of observations in the r-band.\n\n5. **Filter Objects by Initial Rise Rate in g and r Bands:**\n   - The initial rise rate is given by `dmdt_first` in the `magstat` table.\n   - We need to ensure that for both g-band (`fid`=1) and r-band (`fid`=2), the `dmdt_first` is greater than 0.5 mag/day.\n   - Since `magstat` is per band, we need to:\n     - Create two subqueries or use a self-join on `magstat` filtered by `oid`:\n       - One for `fid`=1 with `dmdt_first` > 0.5.\n       - One for `fid`=2 with `dmdt_first` > 0.5.\n     - Intersect or join these subqueries on `oid` to get objects satisfying the rise rate condition in both bands.\n\n6. **Filter Objects by Time Range (2019-2022):**\n   - Use the `object` table's `firstmjd` and `lastmjd` columns to ensure the object was observed within the Modified Julian Date range corresponding to 2019-2022:\n     - `firstmjd` <= 59944.0 (end of 2022)\n     - `lastmjd` >= 58484.0 (start of 2019)\n   - This ensures the object has observations overlapping the requested time period.\n\n7. **Retrieve Detection Information:**\n   - Join the filtered list of objects with the `detection` table on `oid`.\n   - Retrieve the following columns:\n     - `oid` (object identifier)\n     - `candid` (candidate identifier)\n     - `magpsf` (magnitude)\n     - `sigmapsf` (magnitude error)\n     - `fid` (band identifier) \u2014 rename this column as `f_id` in the output\n     - `mjd` (time of detection)\n   - No additional filters on detections are specified, so include all detections for the filtered objects.\n\n8. **Final Output and Ordering:**\n   - Select the columns as specified.\n   - Rename `fid` as `f_id`.\n   - Optionally, order the results by `oid` and `mjd` to have detections sorted by object and time.\n\n9. **Summary of Joins and Filters:**\n   - Start with `probability` filtered by class, classifier, ranking, and probability.\n   - Join with `object` to filter by `ndet` and time range.\n   - Join with `magstat` twice or use subqueries to filter by initial rise rate in g and r bands and observation duration in r-band.\n   - Join with `detection` to retrieve detection-level data.\n   \n10. **Additional Notes:**\n    - Ensure that all joins use the `oid` column.\n    - Use INNER JOINs to ensure only objects meeting all criteria are included.\n    - Use the default conditions for the `probability` table as specified.\n    - Use the exact class name 'SNII' as per the database.\n    - Use the exact filter IDs: 1 for g-band, 2 for r-band.\n    - Use the MJD dates for the time range filter as provided.\n    - Rename `fid` to `f_id` in the final SELECT clause.\n\nBy following these steps, the resulting query will efficiently retrieve the requested information about SN II objects observed between 2019 and 2022, with the specified probability, rise rate, observation duration, and detection count, including detailed detection data with renamed band identifiers."
                },
                "in_toks": 4342,
                "out_toks": 1185,
                "id": "chatcmpl-BgxqYee0GMnuiHTUpnpasevCwgy8C",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        }
    },
    "21": {
        "0": {
            "req_id": 21,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 812,
                "out_toks": 14,
                "id": "chatcmpl-BgrYvqdBJ7WSCGHe5iCcR5QlR7rJm",
                "created": 1749555369,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*, p.probability, p.class_name\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n  AND o.ndet >= 30\n  AND (o.lastmjd - o.firstmjd) >= 200\n  AND p.probability > 0.5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*, p.probability, p.class_name\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n  AND o.ndet >= 30\n  AND (o.lastmjd - o.firstmjd) >= 200\n  AND p.probability > 0.5;\n```"
                },
                "in_toks": 2454,
                "out_toks": 107,
                "id": "chatcmpl-BgxqawEk4hj1QxkBybCTVfvC5ssQQ",
                "created": 1749579528,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1136,
                "out_toks": 6,
                "id": "chatcmpl-BgrYwDV8mEoqvrr8tXCohi4XgjjTn",
                "created": 1749555370,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 21,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 812,
                "out_toks": 14,
                "id": "chatcmpl-BgrYvqdBJ7WSCGHe5iCcR5QlR7rJm",
                "created": 1749555369,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*, p.class_name, p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n  AND o.ndet >= 30\n  AND (o.lastmjd - o.firstmjd) >= 200\n  AND p.probability > 0.5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*, p.class_name, p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n  AND o.ndet >= 30\n  AND (o.lastmjd - o.firstmjd) >= 200\n  AND p.probability > 0.5;\n```"
                },
                "in_toks": 2454,
                "out_toks": 107,
                "id": "chatcmpl-Bgxqa26au0RPzOoGDo8HWp5YV3wWQ",
                "created": 1749579528,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1136,
                "out_toks": 6,
                "id": "chatcmpl-BgrYxJHI4dEyENCZb9KcJ7ChkrwKp",
                "created": 1749555371,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "26": {
        "0": {
            "req_id": 26,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 780,
                "out_toks": 22,
                "id": "chatcmpl-BgrYxsQVZ2pyguijZfP1CAQgxeWcd",
                "created": 1749555371,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*\nFROM object o\nLEFT JOIN probability p ON o.oid = p.oid \n    AND p.classifier_name = 'stamp_classifier' \n    AND p.class_name = 'SN' \n    AND p.probability > 0.5\nWHERE o.firstmjd >= 59816.0 \n  AND o.firstmjd <= 59832.0\n  AND (p.oid IS NOT NULL OR o.ndet > 1);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nLEFT JOIN probability p ON o.oid = p.oid \n    AND p.classifier_name = 'stamp_classifier' \n    AND p.class_name = 'SN' \n    AND p.probability > 0.5\nWHERE o.firstmjd >= 59816.0 \n  AND o.firstmjd <= 59832.0\n  AND (p.oid IS NOT NULL OR o.ndet > 1);\n```"
                },
                "in_toks": 3003,
                "out_toks": 100,
                "id": "chatcmpl-BgxqUdXW5viorzPdQlVVcKXzGNupm",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1652,
                "out_toks": 6,
                "id": "chatcmpl-BgrZ0ndArNdm4NLNHrFCQTWhfEcBe",
                "created": 1749555374,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 26,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 780,
                "out_toks": 22,
                "id": "chatcmpl-BgrYxsQVZ2pyguijZfP1CAQgxeWcd",
                "created": 1749555371,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*\nFROM object o\nLEFT JOIN probability p ON o.oid = p.oid \n    AND p.classifier_name = 'stamp_classifier' \n    AND p.class_name = 'SN' \n    AND p.probability > 0.5\nWHERE o.firstmjd >= 59816.0 \n  AND o.firstmjd <= 59832.0\n  AND (p.oid IS NOT NULL OR o.ndet > 1);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nLEFT JOIN probability p ON o.oid = p.oid \n    AND p.classifier_name = 'stamp_classifier' \n    AND p.class_name = 'SN' \n    AND p.probability > 0.5\nWHERE o.firstmjd >= 59816.0 \n  AND o.firstmjd <= 59832.0\n  AND (p.oid IS NOT NULL OR o.ndet > 1);\n```"
                },
                "in_toks": 3003,
                "out_toks": 100,
                "id": "chatcmpl-Bgxqbhx0KjqGXeRrQyq9nfqh589h4",
                "created": 1749579529,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1652,
                "out_toks": 6,
                "id": "chatcmpl-BgrZ1uTK9E4vhD5RtRrSpqiXvy8vF",
                "created": 1749555375,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "29": {
        "0": {
            "req_id": 29,
            "experiment_id": "run_0",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']",
                    "1": "['ps1_ztf']"
                },
                "in_toks": 840,
                "out_toks": 14,
                "id": "chatcmpl-BgrZ2w8qBoXYo7apvjpVwADQCHPYM",
                "created": 1749555376,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq');\n```"
                },
                "in_toks": 2569,
                "out_toks": 82,
                "id": "chatcmpl-BgxqV1NL2bY6ctnNkNz7tAgEZzhkA",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1251,
                "out_toks": 6,
                "id": "chatcmpl-BgrZ5cz9Uu6Z8wASJL48TM8z954AL",
                "created": 1749555379,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 29,
            "experiment_id": "run_1",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']",
                    "1": "['ps1_ztf']"
                },
                "in_toks": 840,
                "out_toks": 14,
                "id": "chatcmpl-BgrZ2w8qBoXYo7apvjpVwADQCHPYM",
                "created": 1749555376,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq');\n```"
                },
                "in_toks": 2569,
                "out_toks": 82,
                "id": "chatcmpl-BgxqVPAnRI8g8LC7G8SmkCLN6BelK",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1251,
                "out_toks": 6,
                "id": "chatcmpl-BgrZ7ad8n4mPapdNg8tiip5HHyKCv",
                "created": 1749555381,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "52": {
        "0": {
            "req_id": 52,
            "experiment_id": "run_0",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 788,
                "out_toks": 12,
                "id": "chatcmpl-BgrZ7uUsvSphVBed2Idn5AEFKpucX",
                "created": 1749555381,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```"
                },
                "in_toks": 2456,
                "out_toks": 40,
                "id": "chatcmpl-BgxqWa0Ty7F5FQXkjRVhWzEXaJDJX",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1138,
                "out_toks": 6,
                "id": "chatcmpl-BgrZAVTtI14YV7Pz9exTnd18bUKat",
                "created": 1749555384,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 52,
            "experiment_id": "run_1",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 788,
                "out_toks": 12,
                "id": "chatcmpl-BgrZ7uUsvSphVBed2Idn5AEFKpucX",
                "created": 1749555381,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```"
                },
                "in_toks": 2456,
                "out_toks": 40,
                "id": "chatcmpl-BgxqWwiYw1dUGKRXAcpvJUGkKwXW9",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1138,
                "out_toks": 6,
                "id": "chatcmpl-BgrZBBi6XmxZQ2Zrpgeo2zaeYDDxi",
                "created": 1749555385,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "109": {
        "0": {
            "req_id": 109,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 826,
                "out_toks": 20,
                "id": "chatcmpl-BgrZCvuLFPKEbZVC4doCcyjPyb7a8",
                "created": 1749555386,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.classifier_version, \n    p.class_name, \n    p.probability, \n    f.value AS LinearTrend_value, \n    f.fid AS LinearTrend_fid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.deltajd > 1\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.classifier_version, \n    p.class_name, \n    p.probability, \n    f.value AS LinearTrend_value, \n    f.fid AS LinearTrend_fid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.deltajd > 1\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\nLIMIT 10;\n```"
                },
                "in_toks": 4899,
                "out_toks": 146,
                "id": "chatcmpl-BgxqXrnZwYeB5n5wyE2ChEfmbdyTN",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3581,
                "out_toks": 6,
                "id": "chatcmpl-BgrZDIo4vD9MfPe44rQR5543rH6kp",
                "created": 1749555387,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 109,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 826,
                "out_toks": 20,
                "id": "chatcmpl-BgrZCvuLFPKEbZVC4doCcyjPyb7a8",
                "created": 1749555386,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.classifier_version, \n    p.class_name, \n    p.probability, \n    f.value, \n    f.fid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.deltajd > 1\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.classifier_version, \n    p.class_name, \n    p.probability, \n    f.value, \n    f.fid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.deltajd > 1\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\nLIMIT 10;\n```"
                },
                "in_toks": 4899,
                "out_toks": 137,
                "id": "chatcmpl-BgxqXMvYvXf6emdd7rV4TuymdxSdW",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3581,
                "out_toks": 6,
                "id": "chatcmpl-BgrZEiUidiFk5I2AQgpEnm1Pur55k",
                "created": 1749555388,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "49": {
        "0": {
            "req_id": 49,
            "experiment_id": "run_0",
            "pred_tables": [
                "feature",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'object']",
                    "1": "['feature', 'object']"
                },
                "in_toks": 778,
                "out_toks": 12,
                "id": "chatcmpl-BgrZEDDoaQfHRkqfSGp15w60fUOVO",
                "created": 1749555388,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1;  -- fid=1 corresponds to the g band\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1;  -- fid=1 corresponds to the g band\n```"
                },
                "in_toks": 4668,
                "out_toks": 47,
                "id": "chatcmpl-BgxqUyY6Vzzc5N994sxk9AXe93axQ",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3350,
                "out_toks": 6,
                "id": "chatcmpl-BgrZF7IhjdSJnovkoFp4MGgfTvx41",
                "created": 1749555389,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 49,
            "experiment_id": "run_1",
            "pred_tables": [
                "feature",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'object']",
                    "1": "['feature', 'object']"
                },
                "in_toks": 778,
                "out_toks": 12,
                "id": "chatcmpl-BgrZEDDoaQfHRkqfSGp15w60fUOVO",
                "created": 1749555388,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1;  -- fid=1 corresponds to the g band\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1;  -- fid=1 corresponds to the g band\n```"
                },
                "in_toks": 4668,
                "out_toks": 47,
                "id": "chatcmpl-BgxqUwJcyyl44mDhJlhluxUnHzRzP",
                "created": 1749579522,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3350,
                "out_toks": 6,
                "id": "chatcmpl-BgrZGU32tf11zgUXO1g70xigGZXsf",
                "created": 1749555390,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "46": {
        "0": {
            "req_id": 46,
            "experiment_id": "run_0",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']",
                    "1": "['detection']"
                },
                "in_toks": 767,
                "out_toks": 8,
                "id": "chatcmpl-BgrZHsKVLM8dmrGigIPy9M0d9570r",
                "created": 1749555391,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;\n```"
                },
                "in_toks": 2291,
                "out_toks": 26,
                "id": "chatcmpl-Bgxqa3P4cTVuW6dTe1Ru1L9JF68GS",
                "created": 1749579528,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 973,
                "out_toks": 6,
                "id": "chatcmpl-BgrZICeSGA2AD0te7JDi5nNAkzRLL",
                "created": 1749555392,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 46,
            "experiment_id": "run_1",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']",
                    "1": "['detection']"
                },
                "in_toks": 767,
                "out_toks": 8,
                "id": "chatcmpl-BgrZHsKVLM8dmrGigIPy9M0d9570r",
                "created": 1749555391,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;\n```"
                },
                "in_toks": 2291,
                "out_toks": 26,
                "id": "chatcmpl-BgxqVQj6pWGHXfgQH1jrcO7gmj5Zw",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 973,
                "out_toks": 6,
                "id": "chatcmpl-BgrZJWavlWZPoZmODGBOTEHD5H86N",
                "created": 1749555393,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "93": {
        "0": {
            "req_id": 93,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat']",
                    "1": "['probability', 'magstat', 'object']"
                },
                "in_toks": 807,
                "out_toks": 19,
                "id": "chatcmpl-BgrZKYQ5oETlAYL3AnUxV6V8fQDss",
                "created": 1749555394,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT p.*, m.*\nFROM probability p\nINNER JOIN magstat m ON p.oid = m.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT p.*, m.*\nFROM probability p\nINNER JOIN magstat m ON p.oid = m.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```"
                },
                "in_toks": 2683,
                "out_toks": 74,
                "id": "chatcmpl-BgxqV4vQ3JO3mvMpWSVKYIUVHMWUB",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1366,
                "out_toks": 6,
                "id": "chatcmpl-BgrZLhLbJxraBwa68dcETV04zD0dE",
                "created": 1749555395,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 93,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "magstat",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat']",
                    "1": "['probability', 'magstat', 'object']"
                },
                "in_toks": 807,
                "out_toks": 19,
                "id": "chatcmpl-BgrZKYQ5oETlAYL3AnUxV6V8fQDss",
                "created": 1749555394,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT p.*, m.*\nFROM probability p\nINNER JOIN magstat m ON p.oid = m.oid\nWHERE p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT p.*, m.*\nFROM probability p\nINNER JOIN magstat m ON p.oid = m.oid\nWHERE p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```"
                },
                "in_toks": 3165,
                "out_toks": 74,
                "id": "chatcmpl-BgxqW1JuUfI6UEUCU4Sl38xgHZ8gY",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1848,
                "out_toks": 6,
                "id": "chatcmpl-BgrZLUhfRzAg4GTjmovwHchKKypxz",
                "created": 1749555395,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "62": {
        "0": {
            "req_id": 62,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-BgrZMQnzAjyUKwgkvZEve6pthhDOh",
                "created": 1749555396,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    oid, \n    classifier_name, \n    classifier_version, \n    class_name, \n    probability, \n    ranking\nFROM \n    probability\nWHERE \n    oid = 'ZTF21aadoizf'\nORDER BY \n    classifier_name ASC, \n    probability DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid, \n    classifier_name, \n    classifier_version, \n    class_name, \n    probability, \n    ranking\nFROM \n    probability\nWHERE \n    oid = 'ZTF21aadoizf'\nORDER BY \n    classifier_name ASC, \n    probability DESC;\n```"
                },
                "in_toks": 1953,
                "out_toks": 64,
                "id": "chatcmpl-BgxqVqjZ0e7FRdJ6jBZpXzvwM4lCT",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 635,
                "out_toks": 6,
                "id": "chatcmpl-BgrZNdrvlxEfxlUrJ41s46KWunZPq",
                "created": 1749555397,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 62,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-BgrZMQnzAjyUKwgkvZEve6pthhDOh",
                "created": 1749555396,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    oid, \n    classifier_name, \n    classifier_version, \n    class_name, \n    probability, \n    ranking\nFROM \n    probability\nWHERE \n    oid = 'ZTF21aadoizf'\nORDER BY \n    classifier_name ASC, \n    probability DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid, \n    classifier_name, \n    classifier_version, \n    class_name, \n    probability, \n    ranking\nFROM \n    probability\nWHERE \n    oid = 'ZTF21aadoizf'\nORDER BY \n    classifier_name ASC, \n    probability DESC;\n```"
                },
                "in_toks": 1953,
                "out_toks": 64,
                "id": "chatcmpl-BgxqWJdQKJS5DBU7AeBGmEBnlT21w",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 635,
                "out_toks": 6,
                "id": "chatcmpl-BgrZOR50EUjZexYk9NO7RFm0cpUEi",
                "created": 1749555398,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "95": {
        "0": {
            "req_id": 95,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "xmatch",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'feature', 'feature_version']",
                    "1": "['object', 'xmatch', 'feature', 'feature_version']"
                },
                "in_toks": 852,
                "out_toks": 28,
                "id": "chatcmpl-BgrZO8b1Di20OiL8sWhp3M06aemT2",
                "created": 1749555398,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n),\nselected_xmatch AS (\n    SELECT \n        x.oid,\n        x.oid_catalog,\n        x.dist\n    FROM xmatch x\n    JOIN selected_oids so ON x.oid = so.oid\n),\nselected_features AS (\n    SELECT \n        f.oid,\n        f.name,\n        f.value\n    FROM feature f\n    JOIN selected_oids so ON f.oid = so.oid\n    WHERE f.name IN ('W1-W2', 'g-W2', 'r-W2')\n      AND f.version = 'lc_classifier_1.2.1-P'\n)\nSELECT \n    xm.oid AS ztf_oid,\n    xm.oid_catalog,\n    xm.dist,\n    sf.name AS feature_name,\n    sf.value AS feature_value\nFROM selected_xmatch xm\nJOIN selected_features sf ON xm.oid = sf.oid\nORDER BY xm.oid_catalog, sf.name;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n),\nselected_xmatch AS (\n    SELECT \n        x.oid,\n        x.oid_catalog,\n        x.dist\n    FROM xmatch x\n    JOIN selected_oids so ON x.oid = so.oid\n),\nselected_features AS (\n    SELECT \n        f.oid,\n        f.name,\n        f.value\n    FROM feature f\n    JOIN selected_oids so ON f.oid = so.oid\n    WHERE f.name IN ('W1-W2', 'g-W2', 'r-W2')\n      AND f.version = 'lc_classifier_1.2.1-P'\n)\nSELECT \n    xm.oid AS ztf_oid,\n    xm.oid_catalog,\n    xm.dist,\n    sf.name AS feature_name,\n    sf.value AS feature_value\nFROM selected_xmatch xm\nJOIN selected_features sf ON xm.oid = sf.oid\nORDER BY xm.oid_catalog, sf.name;\n```"
                },
                "in_toks": 4906,
                "out_toks": 227,
                "id": "chatcmpl-BgxqXDWPudfBRAk4wwg5Ta0B2wD4N",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3588,
                "out_toks": 6,
                "id": "chatcmpl-BgrZQtauNul38wz5SfOwxNyaJQhuZ",
                "created": 1749555400,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 95,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "xmatch",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'feature', 'feature_version']",
                    "1": "['object', 'xmatch', 'feature', 'feature_version']"
                },
                "in_toks": 852,
                "out_toks": 28,
                "id": "chatcmpl-BgrZO8b1Di20OiL8sWhp3M06aemT2",
                "created": 1749555398,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH selected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n),\nselected_features AS (\n    SELECT f.oid, f.name, f.value\n    FROM feature f\n    JOIN selected_objects so ON f.oid = so.oid\n    WHERE f.name IN ('W1-W2', 'g-W2', 'r-W2')\n      AND f.version = 'lc_classifier_1.2.1-P'\n)\nSELECT \n    x.oid AS ztf_oid,\n    x.oid_catalog,\n    x.dist,\n    sf.name AS feature_name,\n    sf.value AS feature_value\nFROM xmatch x\nJOIN selected_objects so ON x.oid = so.oid\nJOIN selected_features sf ON sf.oid = x.oid\nORDER BY x.oid_catalog, sf.name;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n),\nselected_features AS (\n    SELECT f.oid, f.name, f.value\n    FROM feature f\n    JOIN selected_objects so ON f.oid = so.oid\n    WHERE f.name IN ('W1-W2', 'g-W2', 'r-W2')\n      AND f.version = 'lc_classifier_1.2.1-P'\n)\nSELECT \n    x.oid AS ztf_oid,\n    x.oid_catalog,\n    x.dist,\n    sf.name AS feature_name,\n    sf.value AS feature_value\nFROM xmatch x\nJOIN selected_objects so ON x.oid = so.oid\nJOIN selected_features sf ON sf.oid = x.oid\nORDER BY x.oid_catalog, sf.name;\n```"
                },
                "in_toks": 4906,
                "out_toks": 188,
                "id": "chatcmpl-BgxqY4WADRKe99KGV8UhZdqTdiG0N",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3588,
                "out_toks": 6,
                "id": "chatcmpl-BgrZRbv60pYao6kKglkP2r1CFIaw4",
                "created": 1749555401,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "85": {
        "0": {
            "req_id": 85,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'dataquality']",
                    "1": "['object', 'detection', 'dataquality']"
                },
                "in_toks": 795,
                "out_toks": 22,
                "id": "chatcmpl-BgrZSlrKWPTrsadNeOlfG2qnoje1Y",
                "created": 1749555402,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    dq.*\nFROM detection d\nINNER JOIN dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid AND d.fid = dq.fid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    dq.*\nFROM detection d\nINNER JOIN dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid AND d.fid = dq.fid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;\n```"
                },
                "in_toks": 3598,
                "out_toks": 89,
                "id": "chatcmpl-BgxqYAvIeEhn5IF2YSfcp89mgnaaF",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 2280,
                "out_toks": 6,
                "id": "chatcmpl-BgrZUvxGWJvzjmNTgCbQD6zse3ETG",
                "created": 1749555404,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 85,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'dataquality']",
                    "1": "['object', 'detection', 'dataquality']"
                },
                "in_toks": 795,
                "out_toks": 22,
                "id": "chatcmpl-BgrZSlrKWPTrsadNeOlfG2qnoje1Y",
                "created": 1749555402,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    dq.*\nFROM detection d\nINNER JOIN dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid AND d.fid = dq.fid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    dq.*\nFROM detection d\nINNER JOIN dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid AND d.fid = dq.fid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;\n```"
                },
                "in_toks": 3598,
                "out_toks": 89,
                "id": "chatcmpl-BgxqZnaBumxgNNGs4VfcQOtGMaHZI",
                "created": 1749579527,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 2280,
                "out_toks": 6,
                "id": "chatcmpl-BgrZUp9JyW9Vd7lRnysDB6obHArWz",
                "created": 1749555404,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "98": {
        "0": {
            "req_id": 98,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'allwise']",
                    "1": "['object', 'probability', 'xmatch', 'allwise']"
                },
                "in_toks": 785,
                "out_toks": 30,
                "id": "chatcmpl-BgrZVx2mKV2bKHeTdf0Ij58Sv7j1y",
                "created": 1749555405,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT DISTINCT x.*, a.*\nFROM probability p\nINNER JOIN xmatch x ON p.oid = x.oid\nINNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE p.class_name = 'QSO'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7\nLIMIT 200;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT DISTINCT x.*, a.*\nFROM probability p\nINNER JOIN xmatch x ON p.oid = x.oid\nINNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE p.class_name = 'QSO'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7\nLIMIT 200;\n```"
                },
                "in_toks": 3239,
                "out_toks": 89,
                "id": "chatcmpl-BgxqV7p8dCVjmVebKjbb6aUX9vwSi",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1921,
                "out_toks": 6,
                "id": "chatcmpl-BgrZYni33IWyGWFHIMIUQ9KuQOoze",
                "created": 1749555408,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 98,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'allwise']",
                    "1": "['object', 'probability', 'xmatch', 'allwise']"
                },
                "in_toks": 785,
                "out_toks": 30,
                "id": "chatcmpl-BgrZVx2mKV2bKHeTdf0Ij58Sv7j1y",
                "created": 1749555405,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT DISTINCT x.*, a.*\nFROM probability p\nINNER JOIN xmatch x ON p.oid = x.oid\nINNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE p.class_name = 'QSO'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7\nLIMIT 200;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT DISTINCT x.*, a.*\nFROM probability p\nINNER JOIN xmatch x ON p.oid = x.oid\nINNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE p.class_name = 'QSO'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7\nLIMIT 200;\n```"
                },
                "in_toks": 3239,
                "out_toks": 89,
                "id": "chatcmpl-BgxqVXuMQznvCjGvtKLnYasLebleU",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1921,
                "out_toks": 6,
                "id": "chatcmpl-BgrZZAQiFmz6MJBLI2aRCwWyhderF",
                "created": 1749555409,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "82": {
        "0": {
            "req_id": 82,
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']",
                    "1": "['xmatch', 'allwise']"
                },
                "in_toks": 786,
                "out_toks": 16,
                "id": "chatcmpl-BgrZa1zjigGPCyBbBY7NhnBCBVghO",
                "created": 1749555410,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH catalog (oid_catalog) AS (\n    VALUES \n    ('J175005.63-141341.8'),\n    ('J072933.88+030810.4')\n)\nSELECT x.*\nFROM xmatch x\nINNER JOIN catalog c ON x.oid_catalog = c.oid_catalog\nORDER BY x.dist;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH catalog (oid_catalog) AS (\n    VALUES \n    ('J175005.63-141341.8'),\n    ('J072933.88+030810.4')\n)\nSELECT x.*\nFROM xmatch x\nINNER JOIN catalog c ON x.oid_catalog = c.oid_catalog\nORDER BY x.dist;\n```"
                },
                "in_toks": 2574,
                "out_toks": 70,
                "id": "chatcmpl-BgxqVVcnNO9zI35lCEXSsQP67qMgQ",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1256,
                "out_toks": 6,
                "id": "chatcmpl-BgrZcqKDnpwRZ7XO91opr8GEfT9eG",
                "created": 1749555412,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 82,
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']",
                    "1": "['xmatch', 'allwise']"
                },
                "in_toks": 786,
                "out_toks": 16,
                "id": "chatcmpl-BgrZa1zjigGPCyBbBY7NhnBCBVghO",
                "created": 1749555410,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH catalog (oid_catalog) AS (\n    VALUES \n    ('J175005.63-141341.8'),\n    ('J072933.88+030810.4')\n)\nSELECT x.*\nFROM xmatch x\nJOIN catalog c ON x.oid_catalog = c.oid_catalog\nORDER BY x.dist;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH catalog (oid_catalog) AS (\n    VALUES \n    ('J175005.63-141341.8'),\n    ('J072933.88+030810.4')\n)\nSELECT x.*\nFROM xmatch x\nJOIN catalog c ON x.oid_catalog = c.oid_catalog\nORDER BY x.dist;\n```"
                },
                "in_toks": 2574,
                "out_toks": 69,
                "id": "chatcmpl-BgxqXBzXP7i4OxAfaMIgjlnXyjt5R",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1256,
                "out_toks": 6,
                "id": "chatcmpl-BgrZcnHE9eggG4rBGYd2diM50InnP",
                "created": 1749555412,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "64": {
        "0": {
            "req_id": 64,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-BgrZdEu7nwUhJxcVVCrqm97Tg0zXv",
                "created": 1749555413,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid AS \"ZTF identifier\", classifier_name, classifier_version, class_name, probability\nFROM probability\nWHERE ranking = 1\n  AND probability > 0.95\n  AND classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid AS \"ZTF identifier\", classifier_name, classifier_version, class_name, probability\nFROM probability\nWHERE ranking = 1\n  AND probability > 0.95\n  AND classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nLIMIT 1000;\n```"
                },
                "in_toks": 1958,
                "out_toks": 60,
                "id": "chatcmpl-BgxqXnoCZX8UU5yW59EYmfjai1Stl",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 640,
                "out_toks": 6,
                "id": "chatcmpl-BgrZfUns82sTWOl9XSSwYCh1yWw6T",
                "created": 1749555415,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 64,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-BgrZdEu7nwUhJxcVVCrqm97Tg0zXv",
                "created": 1749555413,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid AS ztf_identifier, classifier_name, classifier_version, class_name, probability\nFROM probability\nWHERE ranking = 1\n  AND probability > 0.95\n  AND classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid AS ztf_identifier, classifier_name, classifier_version, class_name, probability\nFROM probability\nWHERE ranking = 1\n  AND probability > 0.95\n  AND classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nLIMIT 1000;\n```"
                },
                "in_toks": 1958,
                "out_toks": 59,
                "id": "chatcmpl-BgxqVren2NUicA1PMFLk5AcxSSX2X",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 640,
                "out_toks": 6,
                "id": "chatcmpl-BgrZgm6yrif2UlvjXRpbflqgY384C",
                "created": 1749555416,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "87": {
        "0": {
            "req_id": 87,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'gaia_ztf']",
                    "1": "['probability', 'gaia_ztf']"
                },
                "in_toks": 826,
                "out_toks": 22,
                "id": "chatcmpl-BgrZg1JfeQ5blKCAYCy02mtOa5F8F",
                "created": 1749555416,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT p.*, g.*\nFROM probability p\nINNER JOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('LPV', 'E')\n  AND p.probability > 0.7\n  AND g.unique1 = false\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT p.*, g.*\nFROM probability p\nINNER JOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('LPV', 'E')\n  AND p.probability > 0.7\n  AND g.unique1 = false\nLIMIT 50;\n```"
                },
                "in_toks": 2203,
                "out_toks": 104,
                "id": "chatcmpl-BgxqVJeTCDnToBiRZvmiqekpLP5Nl",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 885,
                "out_toks": 6,
                "id": "chatcmpl-BgrZhcPP0uNMzDVxOTuamwjZ0vI55",
                "created": 1749555417,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 87,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'gaia_ztf']",
                    "1": "['probability', 'gaia_ztf']"
                },
                "in_toks": 826,
                "out_toks": 22,
                "id": "chatcmpl-BgrZg1JfeQ5blKCAYCy02mtOa5F8F",
                "created": 1749555416,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT p.*, g.*\nFROM probability p\nINNER JOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('LPV', 'E')\n  AND p.probability > 0.7\n  AND g.unique1 = false\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT p.*, g.*\nFROM probability p\nINNER JOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('LPV', 'E')\n  AND p.probability > 0.7\n  AND g.unique1 = false\nLIMIT 50;\n```"
                },
                "in_toks": 2203,
                "out_toks": 104,
                "id": "chatcmpl-BgxqVc0dUJH4pg71awbUfAVNH4A5Q",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 885,
                "out_toks": 6,
                "id": "chatcmpl-BgrZiZRu8ahSNcWyihaFslslnjvEb",
                "created": 1749555418,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "108": {
        "0": {
            "req_id": 108,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 816,
                "out_toks": 14,
                "id": "chatcmpl-BgrZiQ0WxqgfRsCPxXAY522ih86ge",
                "created": 1749555418,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.probability, \n    (90 - abs(o.meandec)) AS gal_b  -- Approximate Galactic latitude from declination (not exact, as true galactic latitude requires coordinate transformation)\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet > 20\n    AND p.class_name = 'bogus'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\n    AND p.ranking = 1\nORDER BY \n    o.oid\nLIMIT 15;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.probability, \n    (90 - abs(o.meandec)) AS gal_b  -- Approximate Galactic latitude from declination (not exact, as true galactic latitude requires coordinate transformation)\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet > 20\n    AND p.class_name = 'bogus'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\n    AND p.ranking = 1\nORDER BY \n    o.oid\nLIMIT 15;\n```"
                },
                "in_toks": 2457,
                "out_toks": 162,
                "id": "chatcmpl-BgxqVquqg09kFvJd0fQo6yelhaz4x",
                "created": 1749579523,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1140,
                "out_toks": 6,
                "id": "chatcmpl-BgrZj6JO7fJPF9WOZJOWEX0siOblH",
                "created": 1749555419,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 108,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 816,
                "out_toks": 14,
                "id": "chatcmpl-BgrZiQ0WxqgfRsCPxXAY522ih86ge",
                "created": 1749555418,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.probability, \n    (90 - ABS(o.meandec)) AS gal_b  -- Approximate Galactic latitude from declination (not exact, but no galactic coordinate in schema)\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet > 20\n    AND p.class_name = 'bogus'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\n    AND p.ranking = 1\nORDER BY \n    o.oid\nLIMIT 15;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.probability, \n    (90 - ABS(o.meandec)) AS gal_b  -- Approximate Galactic latitude from declination (not exact, but no galactic coordinate in schema)\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet > 20\n    AND p.class_name = 'bogus'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.9\n    AND p.ranking = 1\nORDER BY \n    o.oid\nLIMIT 15;\n```"
                },
                "in_toks": 2457,
                "out_toks": 161,
                "id": "chatcmpl-BgxqWtEE1RdJoROEjIURsxnajkrSt",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1140,
                "out_toks": 6,
                "id": "chatcmpl-BgrZkK8mHWcTVXqTMVFk92Wa36luy",
                "created": 1749555420,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "65": {
        "0": {
            "req_id": 65,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 800,
                "out_toks": 8,
                "id": "chatcmpl-BgrZkR3VCwDRhX1Fjkzn0HoUaWEgZ",
                "created": 1749555420,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;\n```"
                },
                "in_toks": 1959,
                "out_toks": 53,
                "id": "chatcmpl-BgxqZLOgpVD77yPdUN4YspjZAsm59",
                "created": 1749579527,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 642,
                "out_toks": 6,
                "id": "chatcmpl-BgrZntet9o06YFSfscddfg9LCcYHT",
                "created": 1749555423,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 65,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 800,
                "out_toks": 8,
                "id": "chatcmpl-BgrZkR3VCwDRhX1Fjkzn0HoUaWEgZ",
                "created": 1749555420,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;\n```"
                },
                "in_toks": 1959,
                "out_toks": 53,
                "id": "chatcmpl-BgxqarywKiRSwcDsDUe3LFDFLp1wo",
                "created": 1749579528,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 642,
                "out_toks": 6,
                "id": "chatcmpl-BgrZo2sqEqxIgO76DmFhfQwRO06a2",
                "created": 1749555424,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "101": {
        "0": {
            "req_id": 101,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'xmatch', 'allwise']",
                    "1": "['probability', 'xmatch', 'allwise']"
                },
                "in_toks": 812,
                "out_toks": 24,
                "id": "chatcmpl-BgrZo5ARLLD92kPjAfHjGSlbT2Hcy",
                "created": 1749555424,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT probability.*, xmatch.*, allwise.*\nFROM probability\nINNER JOIN xmatch ON probability.oid = xmatch.oid\nINNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog\nWHERE probability.classifier_name = 'lc_classifier'\n  AND probability.class_name = 'LPV'\n  AND probability.ranking = 1\n  AND probability.probability > 0.5\n  AND allwise.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT probability.*, xmatch.*, allwise.*\nFROM probability\nINNER JOIN xmatch ON probability.oid = xmatch.oid\nINNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog\nWHERE probability.classifier_name = 'lc_classifier'\n  AND probability.class_name = 'LPV'\n  AND probability.ranking = 1\n  AND probability.probability > 0.5\n  AND allwise.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```"
                },
                "in_toks": 2784,
                "out_toks": 107,
                "id": "chatcmpl-Bgxqac8bi1dF8g0xfotwnYbGpu53f",
                "created": 1749579528,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1466,
                "out_toks": 6,
                "id": "chatcmpl-BgrZqUbPeexQ7pZgO2mIzKXqRZXoF",
                "created": 1749555426,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 101,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'xmatch', 'allwise']",
                    "1": "['probability', 'xmatch', 'allwise']"
                },
                "in_toks": 812,
                "out_toks": 24,
                "id": "chatcmpl-BgrZo5ARLLD92kPjAfHjGSlbT2Hcy",
                "created": 1749555424,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT probability.*, xmatch.*, allwise.*\nFROM probability\nINNER JOIN xmatch ON probability.oid = xmatch.oid\nINNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog\nWHERE probability.classifier_name = 'lc_classifier'\n  AND probability.class_name = 'LPV'\n  AND probability.ranking = 1\n  AND probability.probability > 0.5\n  AND allwise.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT probability.*, xmatch.*, allwise.*\nFROM probability\nINNER JOIN xmatch ON probability.oid = xmatch.oid\nINNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog\nWHERE probability.classifier_name = 'lc_classifier'\n  AND probability.class_name = 'LPV'\n  AND probability.ranking = 1\n  AND probability.probability > 0.5\n  AND allwise.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```"
                },
                "in_toks": 2784,
                "out_toks": 107,
                "id": "chatcmpl-BgxqaHfRdx6C32J98bIP1EC8qz3yC",
                "created": 1749579528,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1466,
                "out_toks": 6,
                "id": "chatcmpl-BgrZrMHbnLYDICl4frffiMrd9IzaI",
                "created": 1749555427,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "88": {
        "0": {
            "req_id": 88,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 803,
                "out_toks": 14,
                "id": "chatcmpl-BgrZsK66tToEq5NuddbMCcEQz5mWB",
                "created": 1749555428,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    o.meanra, \n    o.meandec, \n    p.classifier_version, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'bogus'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 20\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    o.meanra, \n    o.meandec, \n    p.classifier_version, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'bogus'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 20\nLIMIT 50;\n```"
                },
                "in_toks": 2445,
                "out_toks": 109,
                "id": "chatcmpl-Bgxqb90ig3dIUn2ym8dPZ0HtQQuIV",
                "created": 1749579529,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1127,
                "out_toks": 6,
                "id": "chatcmpl-BgrZtSSu2oQLBeweG3189mH7zvibJ",
                "created": 1749555429,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 88,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 803,
                "out_toks": 14,
                "id": "chatcmpl-BgrZsK66tToEq5NuddbMCcEQz5mWB",
                "created": 1749555428,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    o.meanra, \n    o.meandec, \n    p.classifier_version, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'bogus'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 20\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    o.meanra, \n    o.meandec, \n    p.classifier_version, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'bogus'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 20\nLIMIT 50;\n```"
                },
                "in_toks": 2445,
                "out_toks": 109,
                "id": "chatcmpl-BgxqXdgQ98L3SkVNlqdIkxdSaajJC",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1127,
                "out_toks": 6,
                "id": "chatcmpl-BgrZvwA7TbWmtXaFT5wN86R6x9emm",
                "created": 1749555431,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "70": {
        "0": {
            "req_id": 70,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-BgrZwTNh24QsqYfNS6kxjyY2UsIls",
                "created": 1749555432,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';\n```"
                },
                "in_toks": 2586,
                "out_toks": 21,
                "id": "chatcmpl-BgxqYofmrlU34ThGTYHSRpXdGIcIH",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1268,
                "out_toks": 6,
                "id": "chatcmpl-BgrZx1h8LsA5p91SfLwHsJEDIwpHp",
                "created": 1749555433,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 70,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-BgrZwTNh24QsqYfNS6kxjyY2UsIls",
                "created": 1749555432,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';\n```"
                },
                "in_toks": 2586,
                "out_toks": 21,
                "id": "chatcmpl-BgxqZEBmt8q2YSbUJhctLSgwsv6Qd",
                "created": 1749579527,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1268,
                "out_toks": 6,
                "id": "chatcmpl-BgrZyGvLI6E6mnAMv73faZk3QDVaX",
                "created": 1749555434,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "53": {
        "0": {
            "req_id": 53,
            "experiment_id": "run_0",
            "pred_tables": [
                "non_detection",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection', 'object']",
                    "1": "['non_detection', 'object']"
                },
                "in_toks": 773,
                "out_toks": 14,
                "id": "chatcmpl-BgrZy5tXqLkMB8xUujTJrqUSvWwaA",
                "created": 1749555434,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT mjd, fid, oid, diffmaglim\nFROM non_detection\nWHERE oid = 'ZTF18adqxemz';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT mjd, fid, oid, diffmaglim\nFROM non_detection\nWHERE oid = 'ZTF18adqxemz';\n```"
                },
                "in_toks": 2349,
                "out_toks": 32,
                "id": "chatcmpl-BgxqZYbUaYIqE4twKhjO60mZUlmt8",
                "created": 1749579527,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1031,
                "out_toks": 6,
                "id": "chatcmpl-Bgra0oppootpWmVhXQbVpZPjLXwM8",
                "created": 1749555436,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 53,
            "experiment_id": "run_1",
            "pred_tables": [
                "non_detection",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection', 'object']",
                    "1": "['non_detection', 'object']"
                },
                "in_toks": 773,
                "out_toks": 14,
                "id": "chatcmpl-BgrZy5tXqLkMB8xUujTJrqUSvWwaA",
                "created": 1749555434,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT mjd, fid, oid, diffmaglim\nFROM non_detection\nWHERE oid = 'ZTF18adqxemz';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT mjd, fid, oid, diffmaglim\nFROM non_detection\nWHERE oid = 'ZTF18adqxemz';\n```"
                },
                "in_toks": 2349,
                "out_toks": 32,
                "id": "chatcmpl-BgxqaGa5eyqYFe9quL45iNjcpDGID",
                "created": 1749579528,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1031,
                "out_toks": 6,
                "id": "chatcmpl-Bgra1ikyIVjILDBkKuHHF6mIKaDqo",
                "created": 1749555437,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "77": {
        "0": {
            "req_id": 77,
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 790,
                "out_toks": 12,
                "id": "chatcmpl-Bgra2FzDMKKlf20hpfuE0CxUeAqw1",
                "created": 1749555438,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```"
                },
                "in_toks": 1928,
                "out_toks": 41,
                "id": "chatcmpl-BgxqWqT5lkvTUf2BorKiArHFPy4sN",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 610,
                "out_toks": 6,
                "id": "chatcmpl-Bgra4VlBijoCBXD36hJmBA0lscnUt",
                "created": 1749555440,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 77,
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 790,
                "out_toks": 12,
                "id": "chatcmpl-Bgra2FzDMKKlf20hpfuE0CxUeAqw1",
                "created": 1749555438,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IN ('213673', '49894')\n  AND ssdistnr = 0\nORDER BY oid, candid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IN ('213673', '49894')\n  AND ssdistnr = 0\nORDER BY oid, candid;\n```"
                },
                "in_toks": 1928,
                "out_toks": 41,
                "id": "chatcmpl-Bh1zpTTGMfNf2aksp2ElAbQV2VopN",
                "created": 1749595477,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 610,
                "out_toks": 6,
                "id": "chatcmpl-Bgra5MHHppZXku4jotgUfwZzLqQOY",
                "created": 1749555441,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "105": {
        "0": {
            "req_id": 105,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'detection']",
                    "1": "['object', 'probability', 'ps1_ztf', 'detection']"
                },
                "in_toks": 886,
                "out_toks": 36,
                "id": "chatcmpl-Bgra6l9nA5QXpokue7zsozycyWvDn",
                "created": 1749555442,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH selected_oids AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    INNER JOIN ps1_ztf ps1 ON p.oid = ps1.oid\n    INNER JOIN detection d ON p.oid = d.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND ps1.distpsnr1 < 2\n      AND ABS(ps1.sgscore1 - d.rb) < 0.5\n    GROUP BY p.oid, p.probability\n    LIMIT 50\n)\nSELECT \n    so.oid,\n    so.probability,\n    d.candid,\n    d.fid,\n    dq.chisq AS reduced_chisq,  -- Assuming reduced chi-square is stored in dataquality.chipsf or similar; no explicit reduced chi-square column in detection, so using chipsf from dataquality as proxy\n    d.rb AS sgscore_sextractor,\n    ps1.objectidps1,\n    ps1.sgscore1,\n    ps1.distpsnr1\nFROM selected_oids so\nINNER JOIN detection d ON so.oid = d.oid\nLEFT JOIN dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid\nINNER JOIN ps1_ztf ps1 ON so.oid = ps1.oid\nORDER BY so.oid, d.candid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_oids AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    INNER JOIN ps1_ztf ps1 ON p.oid = ps1.oid\n    INNER JOIN detection d ON p.oid = d.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND ps1.distpsnr1 < 2\n      AND ABS(ps1.sgscore1 - d.rb) < 0.5\n    GROUP BY p.oid, p.probability\n    LIMIT 50\n)\nSELECT \n    so.oid,\n    so.probability,\n    d.candid,\n    d.fid,\n    dq.chisq AS reduced_chisq,  -- Assuming reduced chi-square is stored in dataquality.chipsf or similar; no explicit reduced chi-square column in detection, so using chipsf from dataquality as proxy\n    d.rb AS sgscore_sextractor,\n    ps1.objectidps1,\n    ps1.sgscore1,\n    ps1.distpsnr1\nFROM selected_oids so\nINNER JOIN detection d ON so.oid = d.oid\nLEFT JOIN dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid\nINNER JOIN ps1_ztf ps1 ON so.oid = ps1.oid\nORDER BY so.oid, d.candid;\n```"
                },
                "in_toks": 3020,
                "out_toks": 340,
                "id": "chatcmpl-Bh2hrk1xhUIUuWe5PSesGg8woJCrG",
                "created": 1749598207,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 2512,
                "out_toks": 6,
                "id": "chatcmpl-Bgra7age7RcQaLgk4UBpO751zXh9b",
                "created": 1749555443,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves up to 50 ZTF objects meeting the specified conditions, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - From the user request, the main tables involved are:\n     - `probability`: to filter objects classified as AGN with probability > 0.7, classifier version 'hierarchical_rf_1.1.0', classifier_name 'lc_classifier', and ranking = 1.\n     - `ps1_ztf`: to get the nearest PS1 source information, including star/galaxy score and distance to the nearest PS1 source.\n     - `detection`: to get candidate identifiers, filter identifiers, and star/galaxy score from SExtractor (likely stored in a column related to star/galaxy score; since the schema does not explicitly mention a star/galaxy score from SExtractor, it might be stored in the `rb` or another relevant column\u2014this needs clarification or assumption).\n     - `object`: to get the ZTF object identifier (oid).\n   \n2. **Define Selection Criteria:**\n   - Probability conditions:\n     - `probability.class_name = 'AGN'`\n     - `probability.classifier_name = 'lc_classifier'`\n     - `probability.classifier_version = 'hierarchical_rf_1.1.0'`\n     - `probability.ranking = 1`\n     - `probability.probability > 0.7`\n   - Distance to nearest PS1 source:\n     - `ps1_ztf.distpsnr1 < 2` (distance in arcseconds)\n   - Difference between star/galaxy score from PS1 and star/galaxy score from SExtractor less than 0.5:\n     - The PS1 star/galaxy score is `ps1_ztf.sgscore1`.\n     - The SExtractor star/galaxy score is not explicitly defined in the schema; assuming it is stored in the `detection.rb` column (ZTF real bogus score) or another column. Since the user explicitly requests star/galaxy score from SExtractor, and the schema does not provide a direct column, this needs to be clarified or assumed to be `detection.rb`.\n     - The condition is: `ABS(ps1_ztf.sgscore1 - detection.rb) < 0.5`.\n   \n3. **Determine Columns to Return:**\n   - For the ZTF object:\n     - `object.oid` (ZTF identifier)\n     - `probability.probability` (probability of being AGN)\n   - For each epoch (detection):\n     - `detection.candid` (candidate identifier)\n     - `detection.fid` (filter identifier)\n     - Reduced chi-square: This column is not explicitly present in the schema. It might be a derived or stored value under a different name or not available. If not available, this needs to be clarified or omitted.\n     - Star/galaxy score from SExtractor: assumed to be `detection.rb` or another column if specified.\n     - For the nearest PS1 source:\n       - `ps1_ztf.objectidps1` (identifier of the nearest PS1 source)\n       - `ps1_ztf.sgscore1` (PS1 star/galaxy score)\n       - `ps1_ztf.distpsnr1` (distance to nearest PS1 source)\n   \n4. **Establish Table Joins:**\n   - Join `probability` with `object` on `oid`.\n   - Join `ps1_ztf` with `object` on `oid`.\n   - Join `detection` with `object` on `oid`.\n   - This will allow retrieving all required columns and applying filters.\n   \n5. **Apply Filters in WHERE Clause:**\n   - Filter on `probability` table for class_name, classifier_name, classifier_version, ranking, and probability.\n   - Filter on `ps1_ztf.distpsnr1 < 2`.\n   - Filter on the absolute difference between `ps1_ztf.sgscore1` and `detection.rb` less than 0.5.\n   \n6. **Limit the Number of Results:**\n   - Since the user requests at most 50 objects, apply a limit of 50 on the number of distinct objects.\n   - Because multiple detections (epochs) per object can exist, the query should limit the number of objects first, then retrieve all detections for those objects.\n   - This can be done by:\n     - First selecting up to 50 `oid`s that satisfy the conditions.\n     - Then retrieving all detections for those `oid`s.\n   \n7. **Ordering and Sorting:**\n   - The user does not specify ordering, so default ordering can be by probability descending or by object identifier.\n   \n8. **Final Output Structure:**\n   - The query should return rows with columns:\n     - `oid` (ZTF object identifier)\n     - `probability` (probability of AGN classification)\n     - `candid` (candidate identifier for each detection)\n     - `fid` (filter identifier)\n     - Reduced chi-square (if available; otherwise, note its absence)\n     - Star/galaxy score from SExtractor (assumed `detection.rb`)\n     - `objectidps1` (nearest PS1 source identifier)\n     - `sgscore1` (PS1 star/galaxy score)\n     - `distpsnr1` (distance to nearest PS1 source)\n   \n9. **Additional Considerations:**\n   - Verify the presence and meaning of the reduced chi-square column; if not present, clarify or omit.\n   - Confirm the correct column for the star/galaxy score from SExtractor; if not available, clarify or omit.\n   - Ensure that the joins do not multiply rows unnecessarily; use appropriate join types (INNER JOIN) and conditions.\n   - Use indexes on `probability.oid`, `ps1_ztf.oid`, and `detection.oid` for performance.\n   - Use subqueries or CTEs to first filter the 50 objects, then join to detections and PS1 data.\n   \nBy following these steps, the resulting query will efficiently retrieve up to 50 ZTF objects classified as AGN with high confidence, close to a PS1 source, and with similar star/galaxy scores between PS1 and SExtractor, including detailed detection epoch information.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves up to 50 ZTF objects meeting the specified conditions, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - From the user request, the main tables involved are:\n     - `probability`: to filter objects classified as AGN with probability > 0.7, classifier version 'hierarchical_rf_1.1.0', classifier_name 'lc_classifier', and ranking = 1.\n     - `ps1_ztf`: to get the nearest PS1 source information, including star/galaxy score and distance to the nearest PS1 source.\n     - `detection`: to get candidate identifiers, filter identifiers, and star/galaxy score from SExtractor (likely stored in a column related to star/galaxy score; since the schema does not explicitly mention a star/galaxy score from SExtractor, it might be stored in the `rb` or another relevant column\u2014this needs clarification or assumption).\n     - `object`: to get the ZTF object identifier (oid).\n   \n2. **Define Selection Criteria:**\n   - Probability conditions:\n     - `probability.class_name = 'AGN'`\n     - `probability.classifier_name = 'lc_classifier'`\n     - `probability.classifier_version = 'hierarchical_rf_1.1.0'`\n     - `probability.ranking = 1`\n     - `probability.probability > 0.7`\n   - Distance to nearest PS1 source:\n     - `ps1_ztf.distpsnr1 < 2` (distance in arcseconds)\n   - Difference between star/galaxy score from PS1 and star/galaxy score from SExtractor less than 0.5:\n     - The PS1 star/galaxy score is `ps1_ztf.sgscore1`.\n     - The SExtractor star/galaxy score is not explicitly defined in the schema; assuming it is stored in the `detection.rb` column (ZTF real bogus score) or another column. Since the user explicitly requests star/galaxy score from SExtractor, and the schema does not provide a direct column, this needs to be clarified or assumed to be `detection.rb`.\n     - The condition is: `ABS(ps1_ztf.sgscore1 - detection.rb) < 0.5`.\n   \n3. **Determine Columns to Return:**\n   - For the ZTF object:\n     - `object.oid` (ZTF identifier)\n     - `probability.probability` (probability of being AGN)\n   - For each epoch (detection):\n     - `detection.candid` (candidate identifier)\n     - `detection.fid` (filter identifier)\n     - Reduced chi-square: This column is not explicitly present in the schema. It might be a derived or stored value under a different name or not available. If not available, this needs to be clarified or omitted.\n     - Star/galaxy score from SExtractor: assumed to be `detection.rb` or another column if specified.\n     - For the nearest PS1 source:\n       - `ps1_ztf.objectidps1` (identifier of the nearest PS1 source)\n       - `ps1_ztf.sgscore1` (PS1 star/galaxy score)\n       - `ps1_ztf.distpsnr1` (distance to nearest PS1 source)\n   \n4. **Establish Table Joins:**\n   - Join `probability` with `object` on `oid`.\n   - Join `ps1_ztf` with `object` on `oid`.\n   - Join `detection` with `object` on `oid`.\n   - This will allow retrieving all required columns and applying filters.\n   \n5. **Apply Filters in WHERE Clause:**\n   - Filter on `probability` table for class_name, classifier_name, classifier_version, ranking, and probability.\n   - Filter on `ps1_ztf.distpsnr1 < 2`.\n   - Filter on the absolute difference between `ps1_ztf.sgscore1` and `detection.rb` less than 0.5.\n   \n6. **Limit the Number of Results:**\n   - Since the user requests at most 50 objects, apply a limit of 50 on the number of distinct objects.\n   - Because multiple detections (epochs) per object can exist, the query should limit the number of objects first, then retrieve all detections for those objects.\n   - This can be done by:\n     - First selecting up to 50 `oid`s that satisfy the conditions.\n     - Then retrieving all detections for those `oid`s.\n   \n7. **Ordering and Sorting:**\n   - The user does not specify ordering, so default ordering can be by probability descending or by object identifier.\n   \n8. **Final Output Structure:**\n   - The query should return rows with columns:\n     - `oid` (ZTF object identifier)\n     - `probability` (probability of AGN classification)\n     - `candid` (candidate identifier for each detection)\n     - `fid` (filter identifier)\n     - Reduced chi-square (if available; otherwise, note its absence)\n     - Star/galaxy score from SExtractor (assumed `detection.rb`)\n     - `objectidps1` (nearest PS1 source identifier)\n     - `sgscore1` (PS1 star/galaxy score)\n     - `distpsnr1` (distance to nearest PS1 source)\n   \n9. **Additional Considerations:**\n   - Verify the presence and meaning of the reduced chi-square column; if not present, clarify or omit.\n   - Confirm the correct column for the star/galaxy score from SExtractor; if not available, clarify or omit.\n   - Ensure that the joins do not multiply rows unnecessarily; use appropriate join types (INNER JOIN) and conditions.\n   - Use indexes on `probability.oid`, `ps1_ztf.oid`, and `detection.oid` for performance.\n   - Use subqueries or CTEs to first filter the 50 objects, then join to detections and PS1 data.\n   \nBy following these steps, the resulting query will efficiently retrieve up to 50 ZTF objects classified as AGN with high confidence, close to a PS1 source, and with similar star/galaxy scores between PS1 and SExtractor, including detailed detection epoch information."
                },
                "in_toks": 4120,
                "out_toks": 1343,
                "id": "chatcmpl-BgxqXTvQ2iiGBg1nCsc1xj8cGvviM",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        },
        "1": {
            "req_id": 105,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'detection']",
                    "1": "['object', 'probability', 'ps1_ztf', 'detection']"
                },
                "in_toks": 886,
                "out_toks": 36,
                "id": "chatcmpl-Bgra6l9nA5QXpokue7zsozycyWvDn",
                "created": 1749555442,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH filtered_oids AS (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN ps1_ztf ps1 ON p.oid = ps1.oid\n    INNER JOIN detection d ON p.oid = d.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND ps1.distpsnr1 < 2\n      AND ABS(ps1.sgscore1 - d.classtar) < 0.5\n    GROUP BY p.oid\n    LIMIT 50\n)\nSELECT \n    p.oid,\n    p.probability,\n    d.candid,\n    d.fid,\n    d.chipsf,\n    d.classtar,\n    ps1.objectidps1,\n    ps1.sgscore1,\n    ps1.distpsnr1\nFROM filtered_oids fo\nINNER JOIN probability p ON fo.oid = p.oid\nINNER JOIN detection d ON fo.oid = d.oid\nINNER JOIN ps1_ztf ps1 ON fo.oid = ps1.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND ps1.distpsnr1 < 2\n  AND ABS(ps1.sgscore1 - d.classtar) < 0.5\nORDER BY p.probability DESC, p.oid, d.candid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH filtered_oids AS (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN ps1_ztf ps1 ON p.oid = ps1.oid\n    INNER JOIN detection d ON p.oid = d.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND ps1.distpsnr1 < 2\n      AND ABS(ps1.sgscore1 - d.classtar) < 0.5\n    GROUP BY p.oid\n    LIMIT 50\n)\nSELECT \n    p.oid,\n    p.probability,\n    d.candid,\n    d.fid,\n    d.chipsf,\n    d.classtar,\n    ps1.objectidps1,\n    ps1.sgscore1,\n    ps1.distpsnr1\nFROM filtered_oids fo\nINNER JOIN probability p ON fo.oid = p.oid\nINNER JOIN detection d ON fo.oid = d.oid\nINNER JOIN ps1_ztf ps1 ON fo.oid = ps1.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND ps1.distpsnr1 < 2\n  AND ABS(ps1.sgscore1 - d.classtar) < 0.5\nORDER BY p.probability DESC, p.oid, d.candid;\n```"
                },
                "in_toks": 3029,
                "out_toks": 374,
                "id": "chatcmpl-Bh2hukzOaeeyaKjpnOwmGfbLJWql7",
                "created": 1749598210,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "medium",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'medium'}"
                },
                "in_toks": 2512,
                "out_toks": 6,
                "id": "chatcmpl-Bgra8CUrNESeHWYcewbKEeg5duH5g",
                "created": 1749555444,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": "To generate a PostgreSQL query that retrieves up to 50 ZTF objects meeting the specified conditions, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - From the user request, the main tables involved are:\n     - `object`: for the ZTF object identifier (`oid`).\n     - `probability`: for classification probabilities, specifically for class 'AGN' with classifier version 'hierarchical_rf_1.1.0'.\n     - `ps1_ztf`: for information about the nearest Pan-STARRS1 (PS1) source, including star/galaxy score (`sgscore1`) and distance to the nearest PS1 source (`distpsnr1`).\n     - `detection`: for epoch-level data including candidate identifier (`candid`), filter identifier (`fid`), star/galaxy score from SExtractor (likely stored in a column such as `sgscore` or similar; since the schema does not explicitly mention SExtractor star/galaxy score, verify if it is stored in `detection` or if it needs to be inferred or joined from another table; if not available, clarify or assume it is in `detection` as `sgscore` or a similar column), and reduced chi-square (not explicitly listed in the schema, so check if it is stored under a different name or if it needs to be calculated or omitted if unavailable).\n   \n2. **Clarify Columns for SExtractor Star/Galaxy Score and Reduced Chi-Square:**\n   - Since the schema does not explicitly mention a column for the SExtractor star/galaxy score or reduced chi-square in the `detection` table, confirm if these are stored under different column names or if additional tables are needed.\n   - If these columns are not present, the query cannot retrieve them directly; the user should be informed or the query adjusted accordingly.\n   \n3. **Set Filtering Conditions:**\n   - From the `probability` table:\n     - Filter for `class_name = 'AGN'`.\n     - Filter for `classifier_name = 'lc_classifier'` (default condition).\n     - Filter for `classifier_version = 'hierarchical_rf_1.1.0'`.\n     - Filter for `probability > 0.7`.\n     - Filter for `ranking = 1` (default condition to get the most likely class).\n   - From the `ps1_ztf` table:\n     - Filter for `distpsnr1 < 2` (distance to nearest PS1 source less than 2 arcseconds).\n   - For the difference between the star/galaxy score from PS1 and SExtractor:\n     - Calculate the absolute difference between `sgscore1` (PS1 star/galaxy score) and the SExtractor star/galaxy score (assumed to be in `detection` or another table).\n     - Filter for this difference to be less than 0.5.\n   \n4. **Join Tables Appropriately:**\n   - Join `probability` with `object` on `oid` to get the ZTF object identifier.\n   - Join `ps1_ztf` on `oid` to get PS1 source information.\n   - Join `detection` on `oid` to get epoch-level data (candidate id, filter id, SExtractor star/galaxy score, reduced chi-square).\n   - Ensure that the joins are INNER JOINs to only include objects that have matching entries in all tables.\n   \n5. **Select Required Columns:**\n   - From `object` or `probability`:\n     - ZTF object identifier (`oid`).\n     - Probability of being AGN (`probability`).\n   - From `detection`:\n     - Candidate identifier (`candid`).\n     - Filter identifier (`fid`).\n     - Reduced chi-square (if available; otherwise, note its absence).\n     - SExtractor star/galaxy score (assumed column).\n   - From `ps1_ztf`:\n     - Identifier of the nearest PS1 source (`objectidps1`).\n     - PS1 star/galaxy score (`sgscore1`).\n     - Distance to nearest PS1 source (`distpsnr1`).\n   \n6. **Limit the Number of Results:**\n   - Limit the output to at most 50 distinct ZTF objects.\n   - Since multiple epochs per object are requested, decide whether to limit the total number of rows or the number of objects.\n   - To ensure at most 50 objects, use a subquery or CTE to first select the 50 objects meeting the conditions, then join to detections to get all epochs for those objects.\n   \n7. **Ordering and Presentation:**\n   - Optionally order the results by probability descending to prioritize the most probable AGN.\n   - Present the results with clear column aliases if needed for clarity.\n   \n8. **Summary of Steps to Implement in the Query:**\n   - Step 1: Filter `probability` for AGN class, classifier version, ranking=1, and probability > 0.7.\n   - Step 2: Join with `ps1_ztf` and filter for `distpsnr1 < 2`.\n   - Step 3: Join with `detection` and filter for absolute difference between `sgscore1` and SExtractor star/galaxy score < 0.5.\n   - Step 4: Select distinct `oid` from the above with a limit of 50.\n   - Step 5: Join back to `detection` and `ps1_ztf` to retrieve all epochs for those 50 objects.\n   - Step 6: Select the requested columns.\n   \n9. **Additional Considerations:**\n   - Verify the exact column name for the SExtractor star/galaxy score and reduced chi-square in the `detection` table or elsewhere.\n   - If reduced chi-square is not available, consider omitting it or clarifying with the user.\n   - Use appropriate indexes for performance, especially on `probability(oid)`, `ps1_ztf(oid)`, and `detection(oid)`.\n   - Use explicit filtering on `probability.classifier_name = 'lc_classifier'` as per default conditions.\n   \nBy following this decomposition plan, the resulting query will efficiently retrieve up to 50 ZTF objects classified as AGN with high confidence, close to a PS1 source, and with consistent star/galaxy scores between PS1 and SExtractor, including detailed epoch-level information.",
            "sql_query_plan_response": {
                "responses": {
                    "0": "To generate a PostgreSQL query that retrieves up to 50 ZTF objects meeting the specified conditions, the following detailed decomposition plan should be followed:\n\n1. **Identify Relevant Tables and Columns:**\n   - From the user request, the main tables involved are:\n     - `object`: for the ZTF object identifier (`oid`).\n     - `probability`: for classification probabilities, specifically for class 'AGN' with classifier version 'hierarchical_rf_1.1.0'.\n     - `ps1_ztf`: for information about the nearest Pan-STARRS1 (PS1) source, including star/galaxy score (`sgscore1`) and distance to the nearest PS1 source (`distpsnr1`).\n     - `detection`: for epoch-level data including candidate identifier (`candid`), filter identifier (`fid`), star/galaxy score from SExtractor (likely stored in a column such as `sgscore` or similar; since the schema does not explicitly mention SExtractor star/galaxy score, verify if it is stored in `detection` or if it needs to be inferred or joined from another table; if not available, clarify or assume it is in `detection` as `sgscore` or a similar column), and reduced chi-square (not explicitly listed in the schema, so check if it is stored under a different name or if it needs to be calculated or omitted if unavailable).\n   \n2. **Clarify Columns for SExtractor Star/Galaxy Score and Reduced Chi-Square:**\n   - Since the schema does not explicitly mention a column for the SExtractor star/galaxy score or reduced chi-square in the `detection` table, confirm if these are stored under different column names or if additional tables are needed.\n   - If these columns are not present, the query cannot retrieve them directly; the user should be informed or the query adjusted accordingly.\n   \n3. **Set Filtering Conditions:**\n   - From the `probability` table:\n     - Filter for `class_name = 'AGN'`.\n     - Filter for `classifier_name = 'lc_classifier'` (default condition).\n     - Filter for `classifier_version = 'hierarchical_rf_1.1.0'`.\n     - Filter for `probability > 0.7`.\n     - Filter for `ranking = 1` (default condition to get the most likely class).\n   - From the `ps1_ztf` table:\n     - Filter for `distpsnr1 < 2` (distance to nearest PS1 source less than 2 arcseconds).\n   - For the difference between the star/galaxy score from PS1 and SExtractor:\n     - Calculate the absolute difference between `sgscore1` (PS1 star/galaxy score) and the SExtractor star/galaxy score (assumed to be in `detection` or another table).\n     - Filter for this difference to be less than 0.5.\n   \n4. **Join Tables Appropriately:**\n   - Join `probability` with `object` on `oid` to get the ZTF object identifier.\n   - Join `ps1_ztf` on `oid` to get PS1 source information.\n   - Join `detection` on `oid` to get epoch-level data (candidate id, filter id, SExtractor star/galaxy score, reduced chi-square).\n   - Ensure that the joins are INNER JOINs to only include objects that have matching entries in all tables.\n   \n5. **Select Required Columns:**\n   - From `object` or `probability`:\n     - ZTF object identifier (`oid`).\n     - Probability of being AGN (`probability`).\n   - From `detection`:\n     - Candidate identifier (`candid`).\n     - Filter identifier (`fid`).\n     - Reduced chi-square (if available; otherwise, note its absence).\n     - SExtractor star/galaxy score (assumed column).\n   - From `ps1_ztf`:\n     - Identifier of the nearest PS1 source (`objectidps1`).\n     - PS1 star/galaxy score (`sgscore1`).\n     - Distance to nearest PS1 source (`distpsnr1`).\n   \n6. **Limit the Number of Results:**\n   - Limit the output to at most 50 distinct ZTF objects.\n   - Since multiple epochs per object are requested, decide whether to limit the total number of rows or the number of objects.\n   - To ensure at most 50 objects, use a subquery or CTE to first select the 50 objects meeting the conditions, then join to detections to get all epochs for those objects.\n   \n7. **Ordering and Presentation:**\n   - Optionally order the results by probability descending to prioritize the most probable AGN.\n   - Present the results with clear column aliases if needed for clarity.\n   \n8. **Summary of Steps to Implement in the Query:**\n   - Step 1: Filter `probability` for AGN class, classifier version, ranking=1, and probability > 0.7.\n   - Step 2: Join with `ps1_ztf` and filter for `distpsnr1 < 2`.\n   - Step 3: Join with `detection` and filter for absolute difference between `sgscore1` and SExtractor star/galaxy score < 0.5.\n   - Step 4: Select distinct `oid` from the above with a limit of 50.\n   - Step 5: Join back to `detection` and `ps1_ztf` to retrieve all epochs for those 50 objects.\n   - Step 6: Select the requested columns.\n   \n9. **Additional Considerations:**\n   - Verify the exact column name for the SExtractor star/galaxy score and reduced chi-square in the `detection` table or elsewhere.\n   - If reduced chi-square is not available, consider omitting it or clarifying with the user.\n   - Use appropriate indexes for performance, especially on `probability(oid)`, `ps1_ztf(oid)`, and `detection(oid)`.\n   - Use explicit filtering on `probability.classifier_name = 'lc_classifier'` as per default conditions.\n   \nBy following this decomposition plan, the resulting query will efficiently retrieve up to 50 ZTF objects classified as AGN with high confidence, close to a PS1 source, and with consistent star/galaxy scores between PS1 and SExtractor, including detailed epoch-level information."
                },
                "in_toks": 4120,
                "out_toks": 1352,
                "id": "chatcmpl-BgxqW4nvSUpECwcu4AqN3DNqjeKQT",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            }
        }
    },
    "86": {
        "0": {
            "req_id": 86,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'ps1_ztf']",
                    "1": "['probability', 'ps1_ztf']"
                },
                "in_toks": 835,
                "out_toks": 22,
                "id": "chatcmpl-Bgra85Ad9F5Y9uNwyjz09QQMX92eF",
                "created": 1749555444,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT p.*, ps.*\nFROM probability p\nINNER JOIN ps1_ztf ps ON p.oid = ps.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND p.probability > 0.6\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT p.*, ps.*\nFROM probability p\nINNER JOIN ps1_ztf ps ON p.oid = ps.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND p.probability > 0.6\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```"
                },
                "in_toks": 2748,
                "out_toks": 112,
                "id": "chatcmpl-BgxqW8Z3FhjG3QgwhUjWf9mlpE1x7",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1430,
                "out_toks": 6,
                "id": "chatcmpl-Bgra9ph3JqsRMv0EXdraCTjE5FseD",
                "created": 1749555445,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 86,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'ps1_ztf']",
                    "1": "['probability', 'ps1_ztf']"
                },
                "in_toks": 835,
                "out_toks": 22,
                "id": "chatcmpl-Bgra85Ad9F5Y9uNwyjz09QQMX92eF",
                "created": 1749555444,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT p.*, ps.*\nFROM probability p\nINNER JOIN ps1_ztf ps ON p.oid = ps.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND p.probability > 0.6\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT p.*, ps.*\nFROM probability p\nINNER JOIN ps1_ztf ps ON p.oid = ps.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND p.probability > 0.6\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```"
                },
                "in_toks": 2748,
                "out_toks": 112,
                "id": "chatcmpl-BgxqZi6qXogMC9icUgMDoOvuXm5eZ",
                "created": 1749579527,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1430,
                "out_toks": 6,
                "id": "chatcmpl-BgraAoRd62lUtLYLwoSBu4RYk6uyV",
                "created": 1749555446,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "41": {
        "0": {
            "req_id": 41,
            "experiment_id": "run_0",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 888,
                "out_toks": 8,
                "id": "chatcmpl-BgraBZ4HqqfvcvK600aMZGmoNy5kr",
                "created": 1749555447,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH catalog (id, obj_ra, obj_dec, r_deg) AS (\n    VALUES \n        ('id_1', 132.961, 41.397, 5.0/3600),  -- 5 arcsec to degrees\n        ('id_2', 139.01, 41.5653, 10.0/3600)  -- 10 arcsec to degrees\n)\nSELECT \n    c.id,\n    c.obj_ra,\n    c.obj_dec,\n    c.r_deg,\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro\nFROM \n    catalog c\nJOIN \n    allwise a\nON \n    q3c_radial_query(a.ra, a.dec, c.obj_ra, c.obj_dec, c.r_deg)\n;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH catalog (id, obj_ra, obj_dec, r_deg) AS (\n    VALUES \n        ('id_1', 132.961, 41.397, 5.0/3600),  -- 5 arcsec to degrees\n        ('id_2', 139.01, 41.5653, 10.0/3600)  -- 10 arcsec to degrees\n)\nSELECT \n    c.id,\n    c.obj_ra,\n    c.obj_dec,\n    c.r_deg,\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro\nFROM \n    catalog c\nJOIN \n    allwise a\nON \n    q3c_radial_query(a.ra, a.dec, c.obj_ra, c.obj_dec, c.r_deg)\n;\n```"
                },
                "in_toks": 2563,
                "out_toks": 182,
                "id": "chatcmpl-BgxqWAAjVXOfEvvw8eCepzfzNX8Nv",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1245,
                "out_toks": 6,
                "id": "chatcmpl-BgraDMQnnbtJAZ0jexvjlAZSauEDS",
                "created": 1749555449,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 41,
            "experiment_id": "run_1",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 888,
                "out_toks": 8,
                "id": "chatcmpl-BgraBZ4HqqfvcvK600aMZGmoNy5kr",
                "created": 1749555447,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS obj_ra, 41.397 AS obj_dec, 5.0/3600.0 AS r_deg\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600.0\n)\nSELECT \n    io.id,\n    io.obj_ra,\n    io.obj_dec,\n    io.r_deg,\n    aw.oid_catalog,\n    aw.ra,\n    aw.dec,\n    aw.w1mpro,\n    aw.w1sigmpro\nFROM input_objects io\nJOIN allwise aw\n  ON q3c_radial_query(aw.ra, aw.dec, io.obj_ra, io.obj_dec, io.r_deg)\n;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS obj_ra, 41.397 AS obj_dec, 5.0/3600.0 AS r_deg\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600.0\n)\nSELECT \n    io.id,\n    io.obj_ra,\n    io.obj_dec,\n    io.r_deg,\n    aw.oid_catalog,\n    aw.ra,\n    aw.dec,\n    aw.w1mpro,\n    aw.w1sigmpro\nFROM input_objects io\nJOIN allwise aw\n  ON q3c_radial_query(aw.ra, aw.dec, io.obj_ra, io.obj_dec, io.r_deg)\n;\n```"
                },
                "in_toks": 2563,
                "out_toks": 169,
                "id": "chatcmpl-BgxqaUKci3R5IPkEkhxfxtOWQHZ00",
                "created": 1749579528,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1245,
                "out_toks": 6,
                "id": "chatcmpl-BgraE35Fu0I5SQ2ZlqahXoW3e6UTr",
                "created": 1749555450,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "74": {
        "0": {
            "req_id": 74,
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 817,
                "out_toks": 12,
                "id": "chatcmpl-BgraG887lpF4w3CzAk1wPs1L6sDHs",
                "created": 1749555452,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    oid AS ztf_oid,\n    ssnamenr AS mpc_name,\n    ssmagnr AS mpc_magnitude\nFROM \n    ss_ztf\nWHERE \n    oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n    AND ssmagnr < 19.2\nORDER BY \n    ssmagnr DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS ztf_oid,\n    ssnamenr AS mpc_name,\n    ssmagnr AS mpc_magnitude\nFROM \n    ss_ztf\nWHERE \n    oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n    AND ssmagnr < 19.2\nORDER BY \n    ssmagnr DESC;\n```"
                },
                "in_toks": 1967,
                "out_toks": 94,
                "id": "chatcmpl-BgxqYyXkpMhDZtfNDQd4zIkoHUQSd",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 637,
                "out_toks": 6,
                "id": "chatcmpl-BgraIWbbjIVhFNOniOvcrBjiYWxHZ",
                "created": 1749555454,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 74,
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 817,
                "out_toks": 12,
                "id": "chatcmpl-BgraG887lpF4w3CzAk1wPs1L6sDHs",
                "created": 1749555452,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    oid AS ztf_oid,\n    ssnamenr AS mpc_name,\n    ssmagnr AS mpc_magnitude\nFROM \n    ss_ztf\nWHERE \n    oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n    AND ssmagnr < 19.2\nORDER BY \n    ssmagnr DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS ztf_oid,\n    ssnamenr AS mpc_name,\n    ssmagnr AS mpc_magnitude\nFROM \n    ss_ztf\nWHERE \n    oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n    AND ssmagnr < 19.2\nORDER BY \n    ssmagnr DESC;\n```"
                },
                "in_toks": 1967,
                "out_toks": 94,
                "id": "chatcmpl-BgxqY08mdb8G2A38zl0I53EogyQ5C",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 637,
                "out_toks": 6,
                "id": "chatcmpl-BgraJ07YTvNI70s6EZGkFJ8Dfmr7u",
                "created": 1749555455,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "97": {
        "0": {
            "req_id": 97,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 842,
                "out_toks": 14,
                "id": "chatcmpl-BgraJGRyXEEATIOW2Vn4qAM5L6NxD",
                "created": 1749555455,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    p_lc.oid AS \"ZTF identifier\",\n    p_stamp.probability AS prob_stamp_agn,\n    p_lc.probability AS prob_lc_lpv\nFROM \n    probability p_stamp\nINNER JOIN \n    probability p_lc ON p_stamp.oid = p_lc.oid\nWHERE \n    p_stamp.class_name = 'AGN'\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.6\n    AND p_stamp.ranking = 1\n    AND p_lc.class_name = 'LPV'\n    AND p_lc.classifier_name = 'lc_classifier'\n    AND p_lc.probability > 0.7\n    AND p_lc.ranking = 1\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p_lc.oid AS \"ZTF identifier\",\n    p_stamp.probability AS prob_stamp_agn,\n    p_lc.probability AS prob_lc_lpv\nFROM \n    probability p_stamp\nINNER JOIN \n    probability p_lc ON p_stamp.oid = p_lc.oid\nWHERE \n    p_stamp.class_name = 'AGN'\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.6\n    AND p_stamp.ranking = 1\n    AND p_lc.class_name = 'LPV'\n    AND p_lc.classifier_name = 'lc_classifier'\n    AND p_lc.probability > 0.7\n    AND p_lc.ranking = 1\nLIMIT 50;\n```"
                },
                "in_toks": 2484,
                "out_toks": 189,
                "id": "chatcmpl-BgxqbLdfewFmYy0ynirg5ao1amUZb",
                "created": 1749579529,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1166,
                "out_toks": 6,
                "id": "chatcmpl-BgraLzu91vBznJvV5qeuWd8UNDCYT",
                "created": 1749555457,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 97,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 842,
                "out_toks": 14,
                "id": "chatcmpl-BgraJGRyXEEATIOW2Vn4qAM5L6NxD",
                "created": 1749555455,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    p_lc.oid AS \"ZTF identifier\",\n    p_stamp.probability AS prob_stamp_agn,\n    p_lc.probability AS prob_lc_lpv\nFROM \n    probability p_stamp\nINNER JOIN \n    probability p_lc ON p_stamp.oid = p_lc.oid\nWHERE \n    p_stamp.class_name = 'AGN'\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.6\n    AND p_stamp.ranking = 1\n    AND p_lc.class_name = 'LPV'\n    AND p_lc.classifier_name = 'lc_classifier'\n    AND p_lc.probability > 0.7\n    AND p_lc.ranking = 1\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p_lc.oid AS \"ZTF identifier\",\n    p_stamp.probability AS prob_stamp_agn,\n    p_lc.probability AS prob_lc_lpv\nFROM \n    probability p_stamp\nINNER JOIN \n    probability p_lc ON p_stamp.oid = p_lc.oid\nWHERE \n    p_stamp.class_name = 'AGN'\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.6\n    AND p_stamp.ranking = 1\n    AND p_lc.class_name = 'LPV'\n    AND p_lc.classifier_name = 'lc_classifier'\n    AND p_lc.probability > 0.7\n    AND p_lc.ranking = 1\nLIMIT 50;\n```"
                },
                "in_toks": 2484,
                "out_toks": 189,
                "id": "chatcmpl-Bgxqc0iEuR8jEsSo7v02GwtRAvOzf",
                "created": 1749579530,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1166,
                "out_toks": 6,
                "id": "chatcmpl-BgraL9qjqzIJSPN4HcnVQnLe5Bd6g",
                "created": 1749555457,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "66": {
        "0": {
            "req_id": 66,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']",
                    "1": "['object', 'gaia_ztf']"
                },
                "in_toks": 770,
                "out_toks": 20,
                "id": "chatcmpl-BgraMaOZ8LnwZKKNKcg7FfVW3UW9p",
                "created": 1749555458,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid,\n    g.neargaia AS distance_to_nearest_gaia_arcsec,\n    g.maggaia AS gaia_magnitude\nFROM \n    object o\nJOIN \n    gaia_ztf g ON o.oid = g.oid\nWHERE \n    o.oid = 'ZTF22abftjko';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid,\n    g.neargaia AS distance_to_nearest_gaia_arcsec,\n    g.maggaia AS gaia_magnitude\nFROM \n    object o\nJOIN \n    gaia_ztf g ON o.oid = g.oid\nWHERE \n    o.oid = 'ZTF22abftjko';\n```"
                },
                "in_toks": 2444,
                "out_toks": 77,
                "id": "chatcmpl-BgxqZWuRhWgJhrsZIPwMQ0UQwRYOR",
                "created": 1749579527,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1127,
                "out_toks": 6,
                "id": "chatcmpl-BgraQDOse7cpI1vktT8gNYxQDm3dc",
                "created": 1749555462,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 66,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']",
                    "1": "['object', 'gaia_ztf']"
                },
                "in_toks": 770,
                "out_toks": 20,
                "id": "chatcmpl-BgraMaOZ8LnwZKKNKcg7FfVW3UW9p",
                "created": 1749555458,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid,\n    g.neargaia AS distance_to_nearest_gaia_arcsec,\n    g.maggaia AS gaia_magnitude\nFROM \n    object o\nJOIN \n    gaia_ztf g ON o.oid = g.oid\nWHERE \n    o.oid = 'ZTF22abftjko';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid,\n    g.neargaia AS distance_to_nearest_gaia_arcsec,\n    g.maggaia AS gaia_magnitude\nFROM \n    object o\nJOIN \n    gaia_ztf g ON o.oid = g.oid\nWHERE \n    o.oid = 'ZTF22abftjko';\n```"
                },
                "in_toks": 2444,
                "out_toks": 77,
                "id": "chatcmpl-BgxqcaOMwEQK9u5EdPQnyX8IGffVj",
                "created": 1749579530,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1127,
                "out_toks": 6,
                "id": "chatcmpl-BgraRQ76XMAPzxoJrWG2um7sBNFgo",
                "created": 1749555463,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "50": {
        "0": {
            "req_id": 50,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 809,
                "out_toks": 20,
                "id": "chatcmpl-BgraS3koVw0xiexmhwkSM5FycfSYb",
                "created": 1749555464,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid, name, value, fid\nFROM feature\nWHERE oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n  AND version = 'lc_classifier_1.2.1-P'\nORDER BY oid, fid, name;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid, name, value, fid\nFROM feature\nWHERE oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n  AND version = 'lc_classifier_1.2.1-P'\nORDER BY oid, fid, name;\n```"
                },
                "in_toks": 4750,
                "out_toks": 59,
                "id": "chatcmpl-BgxqWrzM8D6U78mTBwb0G1pti7NZj",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3432,
                "out_toks": 6,
                "id": "chatcmpl-BgraTF8Vc4b6Ebl7QGmufjf9JN9q4",
                "created": 1749555465,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 50,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 809,
                "out_toks": 20,
                "id": "chatcmpl-BgraS3koVw0xiexmhwkSM5FycfSYb",
                "created": 1749555464,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT oid, name, value, fid\nFROM feature\nWHERE oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n  AND version = 'lc_classifier_1.2.1-P'\nORDER BY oid, fid, name;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT oid, name, value, fid\nFROM feature\nWHERE oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n  AND version = 'lc_classifier_1.2.1-P'\nORDER BY oid, fid, name;\n```"
                },
                "in_toks": 4750,
                "out_toks": 59,
                "id": "chatcmpl-Bgxqadk6O3UOkk9yTbiUzPJOIXXI8",
                "created": 1749579528,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3432,
                "out_toks": 6,
                "id": "chatcmpl-BgraU3sC9M4NHC3S0dYXZVje5ZIvB",
                "created": 1749555466,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "91": {
        "0": {
            "req_id": 91,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 813,
                "out_toks": 20,
                "id": "chatcmpl-BgraU87RFgh3a5VLeMZQPkgftjjnI",
                "created": 1749555466,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    (fg.value - fr.value) AS delta_min_g_r_diffmag,\n    fw.value AS w1_w2,\n    fw.version\nFROM \n    object o\nJOIN \n    feature fw ON o.oid = fw.oid AND fw.name = 'W1-W2'\nJOIN \n    feature fg ON o.oid = fg.oid AND fg.name = 'min_mag' AND fg.fid = 1 AND fg.version = fw.version\nJOIN \n    feature fr ON o.oid = fr.oid AND fr.name = 'min_mag' AND fr.fid = 2 AND fr.version = fw.version\nWHERE \n    fw.value < 1\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    (fg.value - fr.value) AS delta_min_g_r_diffmag,\n    fw.value AS w1_w2,\n    fw.version\nFROM \n    object o\nJOIN \n    feature fw ON o.oid = fw.oid AND fw.name = 'W1-W2'\nJOIN \n    feature fg ON o.oid = fg.oid AND fg.name = 'min_mag' AND fg.fid = 1 AND fg.version = fw.version\nJOIN \n    feature fr ON o.oid = fr.oid AND fr.name = 'min_mag' AND fr.fid = 2 AND fr.version = fw.version\nWHERE \n    fw.value < 1\nLIMIT 100;\n```"
                },
                "in_toks": 4754,
                "out_toks": 159,
                "id": "chatcmpl-BgxqdfziwvRW470nWtC0BRWZ4O5FY",
                "created": 1749579531,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3436,
                "out_toks": 6,
                "id": "chatcmpl-BgraVycoireye0spf0pUyjzUtqLPE",
                "created": 1749555467,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 91,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 813,
                "out_toks": 20,
                "id": "chatcmpl-BgraU87RFgh3a5VLeMZQPkgftjjnI",
                "created": 1749555466,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    (fg.value - fr.value) AS delta_min_g_r_diffmag,\n    fw.value AS w1_w2,\n    fw.version\nFROM \n    object o\nJOIN \n    feature fw ON o.oid = fw.oid AND fw.name = 'W1-W2'\nJOIN \n    feature fg ON o.oid = fg.oid AND fg.name = 'min_mag' AND fg.fid = 1 AND fg.version = fw.version\nJOIN \n    feature fr ON o.oid = fr.oid AND fr.name = 'min_mag' AND fr.fid = 2 AND fr.version = fw.version\nWHERE \n    fw.value < 1\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    (fg.value - fr.value) AS delta_min_g_r_diffmag,\n    fw.value AS w1_w2,\n    fw.version\nFROM \n    object o\nJOIN \n    feature fw ON o.oid = fw.oid AND fw.name = 'W1-W2'\nJOIN \n    feature fg ON o.oid = fg.oid AND fg.name = 'min_mag' AND fg.fid = 1 AND fg.version = fw.version\nJOIN \n    feature fr ON o.oid = fr.oid AND fr.name = 'min_mag' AND fr.fid = 2 AND fr.version = fw.version\nWHERE \n    fw.value < 1\nLIMIT 100;\n```"
                },
                "in_toks": 4754,
                "out_toks": 159,
                "id": "chatcmpl-BgxqX568aFwuFK5nluzBIv4duW04A",
                "created": 1749579525,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 3436,
                "out_toks": 6,
                "id": "chatcmpl-BgraWWgDvQBEOmwiTGanc31ypLjb5",
                "created": 1749555468,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "68": {
        "0": {
            "req_id": 68,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']",
                    "1": "['object', 'ps1_ztf']"
                },
                "in_toks": 784,
                "out_toks": 20,
                "id": "chatcmpl-BgraXtphWEA47mwywcrwPLhACYdIk",
                "created": 1749555469,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    p.objectidps1 AS ps1_identifier,\n    p.sgmag1 AS g_band_magnitude,\n    p.sgscore1 AS star_galaxy_score,\n    p.distpsnr1 AS distance_to_ztf_object\nFROM ps1_ztf p\nWHERE p.oid = 'ZTF21abfrbnm';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p.objectidps1 AS ps1_identifier,\n    p.sgmag1 AS g_band_magnitude,\n    p.sgscore1 AS star_galaxy_score,\n    p.distpsnr1 AS distance_to_ztf_object\nFROM ps1_ztf p\nWHERE p.oid = 'ZTF21abfrbnm';\n```"
                },
                "in_toks": 2995,
                "out_toks": 76,
                "id": "chatcmpl-Bgxqhx5FH1f0VcSHihDSsZDzoxFVj",
                "created": 1749579535,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1677,
                "out_toks": 6,
                "id": "chatcmpl-BgraYHhSpL36PrchYHz2dFxzLgoYU",
                "created": 1749555470,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 68,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']",
                    "1": "['object', 'ps1_ztf']"
                },
                "in_toks": 784,
                "out_toks": 20,
                "id": "chatcmpl-BgraXtphWEA47mwywcrwPLhACYdIk",
                "created": 1749555469,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    p.objectidps1 AS ps1_identifier,\n    p.sgmag1 AS g_band_magnitude,\n    p.sgscore1 AS star_galaxy_score,\n    p.distpsnr1 AS distance_to_ztf_object\nFROM ps1_ztf p\nWHERE p.oid = 'ZTF21abfrbnm';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p.objectidps1 AS ps1_identifier,\n    p.sgmag1 AS g_band_magnitude,\n    p.sgscore1 AS star_galaxy_score,\n    p.distpsnr1 AS distance_to_ztf_object\nFROM ps1_ztf p\nWHERE p.oid = 'ZTF21abfrbnm';\n```"
                },
                "in_toks": 2995,
                "out_toks": 76,
                "id": "chatcmpl-BgxqWea0Fuiu5OYVB3E8Yp41OJgLL",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1677,
                "out_toks": 6,
                "id": "chatcmpl-BgraZfpuTeXIL4CxihOoW0U2dcKSI",
                "created": 1749555471,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "60": {
        "0": {
            "req_id": 60,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']",
                    "1": "['object', 'magstat']"
                },
                "in_toks": 812,
                "out_toks": 14,
                "id": "chatcmpl-BgraaVzHmug3IfKiHq9cwMLFzt0wR",
                "created": 1749555472,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    oid, \n    ndet, \n    dmdt_first, \n    dm_first\nFROM \n    magstat\nWHERE \n    oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND fid = 1  -- g band\n    AND ndubious = 0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid, \n    ndet, \n    dmdt_first, \n    dm_first\nFROM \n    magstat\nWHERE \n    oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND fid = 1  -- g band\n    AND ndubious = 0;\n```"
                },
                "in_toks": 2987,
                "out_toks": 83,
                "id": "chatcmpl-Bgxqi8RvQdiPKJVsWmvFTlmeL34VZ",
                "created": 1749579536,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1669,
                "out_toks": 6,
                "id": "chatcmpl-Bgral3ucZHbSvGIsl9W4IJB5o8O07",
                "created": 1749555483,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 60,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']",
                    "1": "['object', 'magstat']"
                },
                "in_toks": 812,
                "out_toks": 14,
                "id": "chatcmpl-BgraaVzHmug3IfKiHq9cwMLFzt0wR",
                "created": 1749555472,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    oid, \n    ndet, \n    dmdt_first, \n    dm_first\nFROM \n    magstat\nWHERE \n    oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND fid = 1  -- g band\n    AND ndubious = 0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid, \n    ndet, \n    dmdt_first, \n    dm_first\nFROM \n    magstat\nWHERE \n    oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND fid = 1  -- g band\n    AND ndubious = 0;\n```"
                },
                "in_toks": 2987,
                "out_toks": 83,
                "id": "chatcmpl-BgxqY03WIPUd3khCGpkh8iDOtNmj9",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1669,
                "out_toks": 6,
                "id": "chatcmpl-BgramLYhb2Hi7apEBv9AamUouaCif",
                "created": 1749555484,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "76": {
        "0": {
            "req_id": 76,
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf', 'object']"
                },
                "in_toks": 796,
                "out_toks": 15,
                "id": "chatcmpl-BgramvME2sgt51TCpeqIxYZ00FS20",
                "created": 1749555484,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\n-- Query to find ZTF objects within 1.5 arcsec of the Solar System object '115185' from MPC archive\n-- Using ss_ztf table for solar system objects and q3c_dist for distance calculation\nSELECT \n    s.oid AS ztf_identifier,\n    s.ssmagnr AS mpc_magnitude,\n    q3c_dist(o.ra, o.dec, ssd.ra, ssd.dec) * 3600 AS distance_arcsec  -- distance in arcseconds\nFROM \n    ss_ztf s\nJOIN \n    object o ON s.oid = o.oid\n-- Define the MPC object coordinates from ss_ztf for '115185'\nJOIN (\n    SELECT ra, dec \n    FROM object \n    WHERE oid IN (\n        SELECT oid FROM ss_ztf WHERE ssnamenr = '115185'\n    )\n    LIMIT 1\n) ssd ON q3c_join(o.ra, o.dec, ssd.ra, ssd.dec, 1.5/3600)  -- 1.5 arcsec radius converted to degrees\nWHERE \n    s.ssnamenr IS NOT NULL AND s.ssnamenr = '115185'\nORDER BY \n    distance_arcsec;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Query to find ZTF objects within 1.5 arcsec of the Solar System object '115185' from MPC archive\n-- Using ss_ztf table for solar system objects and q3c_dist for distance calculation\nSELECT \n    s.oid AS ztf_identifier,\n    s.ssmagnr AS mpc_magnitude,\n    q3c_dist(o.ra, o.dec, ssd.ra, ssd.dec) * 3600 AS distance_arcsec  -- distance in arcseconds\nFROM \n    ss_ztf s\nJOIN \n    object o ON s.oid = o.oid\n-- Define the MPC object coordinates from ss_ztf for '115185'\nJOIN (\n    SELECT ra, dec \n    FROM object \n    WHERE oid IN (\n        SELECT oid FROM ss_ztf WHERE ssnamenr = '115185'\n    )\n    LIMIT 1\n) ssd ON q3c_join(o.ra, o.dec, ssd.ra, ssd.dec, 1.5/3600)  -- 1.5 arcsec radius converted to degrees\nWHERE \n    s.ssnamenr IS NOT NULL AND s.ssnamenr = '115185'\nORDER BY \n    distance_arcsec;\n```"
                },
                "in_toks": 1934,
                "out_toks": 261,
                "id": "chatcmpl-BgxqYkUwoukHbLAyZQEA1ELA8I528",
                "created": 1749579526,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 616,
                "out_toks": 6,
                "id": "chatcmpl-Bgraoi4d4otVnJQ0qKJwuy9gsK3wo",
                "created": 1749555486,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 76,
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf', 'object']"
                },
                "in_toks": 796,
                "out_toks": 15,
                "id": "chatcmpl-BgramvME2sgt51TCpeqIxYZ00FS20",
                "created": 1749555484,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\n-- Query to find ZTF objects within 1.5 arcsec (0.0004167 degrees) of the Solar System object '115185' from MPC archive\nWITH mpc_object AS (\n    -- Assuming we have the coordinates of the MPC object '115185' from the ss_ztf table or similar\n    SELECT meanra, meandec\n    FROM object o\n    INNER JOIN ss_ztf ss ON o.oid = ss.oid\n    WHERE ss.ssnamenr = '115185'\n    LIMIT 1\n)\nSELECT \n    o.oid AS ztf_identifier,\n    ss.ssmagnr AS mpc_magnitude,\n    q3c_dist(o.meanra, o.meandec, m.meanra, m.meandec) * 3600 AS distance_arcsec -- distance in arcseconds\nFROM \n    object o\nINNER JOIN ss_ztf ss ON o.oid = ss.oid\nCROSS JOIN mpc_object m\nWHERE \n    q3c_radial_query(o.meanra, o.meandec, m.meanra, m.meandec, 0.0004167) -- 1.5 arcsec in degrees\nORDER BY \n    distance_arcsec;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Query to find ZTF objects within 1.5 arcsec (0.0004167 degrees) of the Solar System object '115185' from MPC archive\nWITH mpc_object AS (\n    -- Assuming we have the coordinates of the MPC object '115185' from the ss_ztf table or similar\n    SELECT meanra, meandec\n    FROM object o\n    INNER JOIN ss_ztf ss ON o.oid = ss.oid\n    WHERE ss.ssnamenr = '115185'\n    LIMIT 1\n)\nSELECT \n    o.oid AS ztf_identifier,\n    ss.ssmagnr AS mpc_magnitude,\n    q3c_dist(o.meanra, o.meandec, m.meanra, m.meandec) * 3600 AS distance_arcsec -- distance in arcseconds\nFROM \n    object o\nINNER JOIN ss_ztf ss ON o.oid = ss.oid\nCROSS JOIN mpc_object m\nWHERE \n    q3c_radial_query(o.meanra, o.meandec, m.meanra, m.meandec, 0.0004167) -- 1.5 arcsec in degrees\nORDER BY \n    distance_arcsec;\n```"
                },
                "in_toks": 2416,
                "out_toks": 261,
                "id": "chatcmpl-BgxqoqIg9PFeYYn0VASRoXrfabQPw",
                "created": 1749579542,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1098,
                "out_toks": 6,
                "id": "chatcmpl-Bgrapx4Sm2HDEmTaNyPprOWDkdWvw",
                "created": 1749555487,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    },
    "44": {
        "0": {
            "req_id": 44,
            "experiment_id": "run_0",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 806,
                "out_toks": 8,
                "id": "chatcmpl-BgraqdLXUlaSstFFD729MvfXy2ufa",
                "created": 1749555488,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM dataquality\nWHERE oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND chipsf < 3\nORDER BY oid ASC, scorr DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM dataquality\nWHERE oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND chipsf < 3\nORDER BY oid ASC, scorr DESC;\n```"
                },
                "in_toks": 2579,
                "out_toks": 48,
                "id": "chatcmpl-BgxqqHrSlPIVLJQaY1fXjwgXO40hg",
                "created": 1749579544,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1261,
                "out_toks": 6,
                "id": "chatcmpl-Bgrargh7ygPErPg504eZdCPnVMn0y",
                "created": 1749555489,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        },
        "1": {
            "req_id": 44,
            "experiment_id": "run_1",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 806,
                "out_toks": 8,
                "id": "chatcmpl-BgraqdLXUlaSstFFD729MvfXy2ufa",
                "created": 1749555488,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM dataquality\nWHERE oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND chipsf < 3\nORDER BY oid ASC, scorr DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM dataquality\nWHERE oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND chipsf < 3\nORDER BY oid ASC, scorr DESC;\n```"
                },
                "in_toks": 2579,
                "out_toks": 48,
                "id": "chatcmpl-BgxqWm2YxlrTu1AMwJroWm9ZKf3ZC",
                "created": 1749579524,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "pred_diff": "simple",
            "diff_response": {
                "responses": {
                    "0": "{'class': 'simple'}"
                },
                "in_toks": 1261,
                "out_toks": 6,
                "id": "chatcmpl-BgrarJprTWthekmbqi1FwLDIekuhQ",
                "created": 1749555489,
                "model": "gpt-4.1-mini-2025-04-14"
            },
            "sql_query_plan": null,
            "sql_query_plan_response": null
        }
    }
}