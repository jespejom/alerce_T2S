{"id": "batch_req_68a4aef9a0b881909614c20de3a27cc0", "custom_id": "8-5", "response": {"status_code": 200, "request_id": "9b72ad7ef37ee8db4bd142b3da0ac8a8", "body": {"id": "chatcmpl-C6JoK1KsH1e68w5Atp40IlpPl7y51", "object": "chat.completion", "created": 1755622156, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n    -- Classification conditions\n    (probability.classifier_name = 'stamp_classifier' \n     AND probability.class_name = 'SN' \n     AND probability.probability > 0.5)\n    -- Detection condition\n    OR object.ndet >= 2\n    -- Time range condition\n    AND object.firstmjd BETWEEN 60173.0 AND 60177.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2806, "completion_tokens": 102, "total_tokens": 2908, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aef986c88190aa61ae109144b63f", "custom_id": "8-6", "response": {"status_code": 200, "request_id": "1ecd1547438006a096f343f45efb4d88", "body": {"id": "chatcmpl-C6JoaM7saMSmUA3PT6G2Qbu9uhiDX", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE probability.classifier_name = 'stamp_classifier'\n  AND probability.class_name = 'SN'\n  AND probability.ranking = 1\n  AND (probability.probability > 0.5 OR object.ndet >= 2)\n  AND object.firstmjd BETWEEN 60173.0 AND 60177.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2920, "completion_tokens": 89, "total_tokens": 3009, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aef9c7c081908d3c9e64150ab6c2", "custom_id": "8-7", "response": {"status_code": 200, "request_id": "da78ad1cd7fede88c0ca4e4077d5b5fb", "body": {"id": "chatcmpl-C6Jpm4V9oqc8tKjKuMwDM1Mwje5tU", "object": "chat.completion", "created": 1755622246, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE probability.ranking = 1\n  AND probability.classifier_name = 'stamp_classifier'\n  AND probability.class_name = 'SN'\n  AND object.firstmjd >= 60173.0\n  AND object.firstmjd <= 60177.0\n  AND (probability.probability > 0.5 OR object.ndet >= 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2816, "completion_tokens": 96, "total_tokens": 2912, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4aef9a958819089508ba391ae8e1e", "custom_id": "8-8", "response": {"status_code": 200, "request_id": "7d39773b819d745c65ce89970759810a", "body": {"id": "chatcmpl-C6Jpmp1QZt8ngTZocNFaA7UdQYIkO", "object": "chat.completion", "created": 1755622246, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n    (\n        (probability.classifier_name = 'stamp_classifier' AND \n         probability.class_name = 'SN' AND \n         probability.probability > 0.5)\n        OR \n        (object.ndet >= 2)\n    )\n    AND object.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND probability.ranking = 1; -- Default condition for most likely probabilities\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2921, "completion_tokens": 110, "total_tokens": 3031, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aef99d8c8190ad74832bd20136c6", "custom_id": "8-9", "response": {"status_code": 200, "request_id": "127fb6b1563ba612ada730380e8d8192", "body": {"id": "chatcmpl-C6Jpm8EYPFxfEnciGspZnhhy7c11T", "object": "chat.completion", "created": 1755622246, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE probability.classifier_name = 'stamp_classifier' -- Default condition for classifier\n  AND probability.class_name = 'SN' -- Specific class name condition\n  AND probability.ranking = 1 -- Default condition for most likely classification\n  AND object.firstmjd BETWEEN 60173.0 AND 60177.0 -- Time range condition\n  AND (probability.probability > 0.5 OR object.ndet >= 2); -- Combined probability and detection conditions\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2778, "completion_tokens": 119, "total_tokens": 2897, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aef998f08190afc197fdc033c10c", "custom_id": "27-5", "response": {"status_code": 200, "request_id": "9c971f3c1a8163e8e8f56173dcd36ce6", "body": {"id": "chatcmpl-C6JoK43goicMvvph0oJnGhdLEYR5H", "object": "chat.completion", "created": 1755622156, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability\nON \n    object.oid = probability.oid\nWHERE \n    probability.ranking = 1 -- Default condition to only return the most likely probabilities\n    AND probability.classifier_name = 'lc_classifier' -- Default condition to use the light curve classifier\n    AND probability.class_name = 'CEP' -- Filter for Cepheid class\n    AND probability.probability > 0.76 -- Filter for probability greater than 0.76\n    AND object.ndet >= 100 -- Filter for objects with 100 or more detections\nORDER BY \n    probability.probability DESC; -- Order by probability in descending order\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2620, "completion_tokens": 217, "total_tokens": 2837, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aef998a481908d661dfe06b71e5a", "custom_id": "27-6", "response": {"status_code": 200, "request_id": "af6203a65d32b2b33258271e9bc519f6", "body": {"id": "chatcmpl-C6JoK3d4Zl1yw7dur7Fu6pu3bUPnO", "object": "chat.completion", "created": 1755622156, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability\nON \n    object.oid = probability.oid\nWHERE \n    probability.ranking = 1 -- Default condition: most likely probabilities\n    AND probability.classifier_name = 'lc_classifier' -- Default condition: light curve classifier\n    AND object.ndet >= 100 -- User-specified condition: 100 or more detections\n    AND probability.class_name = 'CEP' -- User-specified condition: class name is 'CEP'\n    AND probability.probability > 0.76; -- User-specified condition: probability greater than 0.76\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 204, "total_tokens": 2915, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aef99fc08190872538ab20fc8bf8", "custom_id": "27-7", "response": {"status_code": 200, "request_id": "fa773a41b8605bf00a43461665b3c8fc", "body": {"id": "chatcmpl-C6JoKA0vhTTjDMqj4VNg7rTdVuCgp", "object": "chat.completion", "created": 1755622156, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability \nON \n    object.oid = probability.oid\nWHERE \n    probability.ranking = 1 -- Most likely probabilities\n    AND probability.classifier_name = 'lc_classifier' -- Light curve classifier\n    AND probability.class_name = 'CEP' -- Classified as Cepheid\n    AND probability.probability > 0.76 -- Probability larger than 0.76\n    AND object.ndet >= 100 -- 100 or more detections\nORDER BY \n    probability.probability DESC; -- Order by probability in descending order\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2539, "completion_tokens": 199, "total_tokens": 2738, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aef9aaac81909c9c0ac285da7200", "custom_id": "27-8", "response": {"status_code": 200, "request_id": "8745cf9f10a44d27eeb699d2feae91c8", "body": {"id": "chatcmpl-C6JoOnn9zsW5l7z1TdFH9lL6YLQ27", "object": "chat.completion", "created": 1755622160, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability \nON \n    object.oid = probability.oid\nWHERE \n    probability.ranking = 1 -- Default condition to get the most likely probabilities\n    AND probability.classifier_name = 'lc_classifier' -- Default condition to use the light curve classifier\n    AND probability.class_name = 'CEP' -- User-specified condition for Cepheid classification\n    AND probability.probability > 0.76 -- User-specified condition for probability threshold\n    AND object.ndet >= 100; -- User-specified condition for the number of detections\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2716, "completion_tokens": 200, "total_tokens": 2916, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aef9a0c88190a682bd5bbfd67975", "custom_id": "27-9", "response": {"status_code": 200, "request_id": "2bd7423e53a797f2bcc29c1d72fba5f7", "body": {"id": "chatcmpl-C6JoOkY9xYDSvClaXHPc9Du4orNAu", "object": "chat.completion", "created": 1755622160, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability \nON \n    object.oid = probability.oid\nWHERE \n    object.ndet >= 100\n    AND probability.ranking = 1\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.class_name = 'CEP'\n    AND probability.probability > 0.76;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2744, "completion_tokens": 151, "total_tokens": 2895, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefa85548190b22f91cfd2fb0910", "custom_id": "17-5", "response": {"status_code": 200, "request_id": "f2013fe9695dcbc0b1e085da0fdcd9a9", "body": {"id": "chatcmpl-C6JoPlze1uuqzRlNzoN3VKWyrW9s6", "object": "chat.completion", "created": 1755622161, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Identify objects showing variability in the r band\nr_band_variability AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_objects ao ON f.oid = ao.oid\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 2\n      AND f.value > 0\n),\n\n-- Step 3: Exclude objects with detections or variability in the g band\ng_band_exclusions AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_objects ao ON f.oid = ao.oid\n    WHERE (f.name = 'n_det' AND f.fid = 1 AND f.value > 0)\n       OR (f.name = 'ExcessVar' AND f.fid = 1 AND f.value > 0)\n),\n\n-- Step 4: Filter objects meeting all conditions\nfiltered_objects AS (\n    SELECT oid\n    FROM r_band_variability\n    WHERE oid NOT IN (SELECT oid FROM g_band_exclusions)\n)\n\n-- Step 5: Retrieve features for the remaining objects and order by feature value\nSELECT f.oid, f.name, f.value\nFROM feature f\nINNER JOIN filtered_objects fo ON f.oid = fo.oid\nORDER BY f.value ASC, f.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3048, "completion_tokens": 331, "total_tokens": 3379, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefa6a24819092a1bc5415610c52", "custom_id": "17-6", "response": {"status_code": 200, "request_id": "3ed26bc5cdaad37977679d15210c4594", "body": {"id": "chatcmpl-C6JoP0Yd5th00Lod2JK2XLorGJ3lG", "object": "chat.completion", "created": 1755622161, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Identify objects showing variability in the r band\nr_band_variability AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE feature_name = 'ExcessVar'\n      AND fid = 2\n      AND value > 0\n),\n\n-- Step 3: Identify objects with no detections or no variability in the g band\ng_band_no_detections_or_variability AS (\n    SELECT DISTINCT oid\n    FROM magstat\n    WHERE fid = 1\n      AND ndet = 0\n    UNION\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE feature_name = 'ExcessVar'\n      AND fid = 1\n      AND value = 0\n),\n\n-- Step 4: Combine results to find objects meeting all conditions\nfiltered_objects AS (\n    SELECT oid\n    FROM agn_objects\n    INTERSECT\n    SELECT oid\n    FROM r_band_variability\n    INTERSECT\n    SELECT oid\n    FROM g_band_no_detections_or_variability\n)\n\n-- Step 5: Retrieve features for the filtered objects and order by value\nSELECT f.*\nFROM feature f\nINNER JOIN filtered_objects fo ON f.oid = fo.oid\nORDER BY f.value ASC, f.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3134, "completion_tokens": 315, "total_tokens": 3449, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefa7870819092633ce45d96a250", "custom_id": "17-7", "response": {"status_code": 200, "request_id": "730d893acd5cc7cdac15254f6e6363b7", "body": {"id": "chatcmpl-C6JoRpUzvBFPh3DNSJZJ8hQnjBdDT", "object": "chat.completion", "created": 1755622163, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Identify objects showing variability in the r band\nvariability_r_band AS (\n    SELECT DISTINCT feature.oid\n    FROM feature\n    INNER JOIN agn_objects ON feature.oid = agn_objects.oid\n    WHERE feature.name = 'ExcessVar'\n      AND feature.fid = 2\n      AND feature.value > 0\n),\n\n-- Step 3: Exclude objects with detections or variability in the g band\nexclude_g_band AS (\n    SELECT DISTINCT feature.oid\n    FROM feature\n    INNER JOIN agn_objects ON feature.oid = agn_objects.oid\n    WHERE (feature.name = 'n_det' AND feature.fid = 1 AND feature.value > 0)\n       OR (feature.name = 'ExcessVar' AND feature.fid = 1 AND feature.value > 0)\n),\n\n-- Step 4: Combine results for AGN objects with variability in r band but no detections or variability in g band\nfiltered_objects AS (\n    SELECT oid\n    FROM variability_r_band\n    WHERE oid NOT IN (SELECT oid FROM exclude_g_band)\n)\n\n-- Step 5: Retrieve features and order results\nSELECT feature.*\nFROM feature\nINNER JOIN filtered_objects ON feature.oid = filtered_objects.oid\nORDER BY feature.value ASC, feature.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3054, "completion_tokens": 328, "total_tokens": 3382, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefaf19481908b8c669352aeed4d", "custom_id": "17-8", "response": {"status_code": 200, "request_id": "9f577d20997c0e596628a2a4a2b12bce", "body": {"id": "chatcmpl-C6JoSx3pbi5Jhz2XYIQqyFlqV6IS3", "object": "chat.completion", "created": 1755622164, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Identify objects showing variability in the r band\nr_band_variability AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_objects ao ON f.oid = ao.oid\n    WHERE f.fid = 2 -- r band\n      AND f.feature_name = 'ExcessVar'\n      AND f.value > 0\n),\n\n-- Step 3: Exclude objects with detections or variability in the g band\ng_band_exclusions AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.fid = 1 -- g band\n      AND (\n          (f.feature_name = 'n_det' AND f.value > 0) OR\n          (f.feature_name = 'ExcessVar' AND f.value > 0)\n      )\n),\n\n-- Step 4: Filter objects that meet the conditions\nfiltered_objects AS (\n    SELECT oid\n    FROM r_band_variability\n    WHERE oid NOT IN (SELECT oid FROM g_band_exclusions)\n),\n\n-- Step 5: Retrieve features for the filtered objects\nfeatures_for_filtered_objects AS (\n    SELECT f.*\n    FROM feature f\n    INNER JOIN filtered_objects fo ON f.oid = fo.oid\n)\n\n-- Final Query: Order features by value and results by oid\nSELECT *\nFROM features_for_filtered_objects\nORDER BY value ASC, oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3136, "completion_tokens": 340, "total_tokens": 3476, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefa6e5c8190bbbfffd18bb918bc", "custom_id": "17-9", "response": {"status_code": 200, "request_id": "229798bae2d718302a876e0fc213debb", "body": {"id": "chatcmpl-C6JoTIPp6jqkxtBEbByaHxtDdE8il", "object": "chat.completion", "created": 1755622165, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Identify objects showing variability in the r band\nr_band_variability AS (\n    SELECT DISTINCT feature.oid\n    FROM feature\n    INNER JOIN agn_objects ON feature.oid = agn_objects.oid\n    WHERE feature.name = 'ExcessVar'\n      AND feature.fid = 2\n      AND feature.value > 0\n),\n\n-- Step 3: Exclude objects with detections or variability in the g band\ng_band_exclusions AS (\n    SELECT DISTINCT feature.oid\n    FROM feature\n    INNER JOIN agn_objects ON feature.oid = agn_objects.oid\n    WHERE (feature.name = 'n_det' AND feature.fid = 1)\n       OR (feature.name = 'ExcessVar' AND feature.fid = 1 AND feature.value > 0)\n),\n\n-- Step 4: Filter objects that meet the criteria\nfiltered_objects AS (\n    SELECT oid\n    FROM r_band_variability\n    WHERE oid NOT IN (SELECT oid FROM g_band_exclusions)\n)\n\n-- Step 5: Retrieve and order features for the filtered objects\nSELECT feature.*\nFROM feature\nINNER JOIN filtered_objects ON feature.oid = filtered_objects.oid\nORDER BY feature.value ASC, feature.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3046, "completion_tokens": 314, "total_tokens": 3360, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefac26881909a81a7af8b891c80", "custom_id": "1-5", "response": {"status_code": 200, "request_id": "0c3a045d25bb38bb7f7fd6e8a3595c5f", "body": {"id": "chatcmpl-C6Joe6mqpDE5wHIomEgUhRmzCFEp7", "object": "chat.completion", "created": 1755622176, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\nlong_light_curves AS (\n    SELECT oid\n    FROM object\n    WHERE deltajd >= 365\n),\ndetections_per_band AS (\n    SELECT oid\n    FROM feature\n    WHERE name = 'n_det'\n      AND value >= 20\n),\ng_band_variations AS (\n    SELECT oid\n    FROM feature\n    WHERE name = 'delta_mag_fid'\n      AND fid = 1\n      AND value > 1\n),\nr_band_variations AS (\n    SELECT oid\n    FROM feature\n    WHERE name = 'delta_mag_fid'\n      AND fid = 2\n      AND value > 0.5\n),\nfiltered_objects AS (\n    SELECT oid\n    FROM agn_objects\n    INTERSECT\n    SELECT oid\n    FROM long_light_curves\n    INTERSECT\n    SELECT oid\n    FROM detections_per_band\n    INTERSECT\n    SELECT oid\n    FROM g_band_variations\n    INTERSECT\n    SELECT oid\n    FROM r_band_variations\n)\nSELECT \n    o.oid,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    f.version AS feature_version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS max_mag_g,\n    MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS min_mag_g,\n    MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS delta_mag_g,\n    MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS max_mag_r,\n    MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS min_mag_r,\n    MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS delta_mag_r\nFROM \n    filtered_objects fo\nINNER JOIN \n    object o ON fo.oid = o.oid\nINNER JOIN \n    feature f ON fo.oid = f.oid\nINNER JOIN \n    detection d ON fo.oid = d.oid\nGROUP BY \n    o.oid, f.name, f.value, f.version, f.fid, o.meanra, o.meandec, o.ndet\nORDER BY \n    o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3408, "completion_tokens": 594, "total_tokens": 4002, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefa913c819088eb9b95fb58424a", "custom_id": "1-6", "response": {"status_code": 200, "request_id": "5e1310d93fd779714d635adb36b2c44c", "body": {"id": "chatcmpl-C6JoaASUUZlQmbYzLsETYVjkxfYp0", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN with a probability larger than 0.6\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\n\n-- Step 2: Filter objects with light curves covering at least one year\nobjects_with_lightcurve AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.g_r_max_corr, o.g_r_mean_corr\n    FROM object o\n    INNER JOIN agn_objects ao ON o.oid = ao.oid\n    WHERE (o.lastmjd - o.firstmjd) >= 365\n),\n\n-- Step 3: Filter objects with at least 20 detections in at least one band\nobjects_with_detections AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN objects_with_lightcurve owlc ON f.oid = owlc.oid\n    WHERE f.name = 'n_det' AND f.value >= 20\n),\n\n-- Step 4: Filter objects with variations larger than 1 magnitude in the g band and larger than 0.5 in the r band\nobjects_with_variations AS (\n    SELECT DISTINCT f1.oid\n    FROM feature f1\n    INNER JOIN feature f2 ON f1.oid = f2.oid\n    WHERE f1.name = 'delta_mag_fid' AND f1.fid = 1 AND f1.value > 1 -- g band\n      AND f2.name = 'delta_mag_fid' AND f2.fid = 2 AND f2.value > 0.5 -- r band\n),\n\n-- Step 5: Combine all conditions\nfiltered_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.g_r_max_corr, o.g_r_mean_corr\n    FROM objects_with_lightcurve o\n    INNER JOIN objects_with_detections od ON o.oid = od.oid\n    INNER JOIN objects_with_variations ov ON o.oid = ov.oid\n),\n\n-- Step 6: Retrieve feature information\nfeature_info AS (\n    SELECT f.oid, f.name, f.value, f.version, f.fid AS feature_fid\n    FROM feature f\n    INNER JOIN filtered_objects fo ON f.oid = fo.oid\n),\n\n-- Step 7: Retrieve detection information and calculate magnitude variations\ndetection_info AS (\n    SELECT d.oid, \n           d.fid AS detection_fid,\n           MAX(d.magpsf_corr) AS max_mag,\n           MIN(d.magpsf_corr) AS min_mag,\n           (MAX(d.magpsf_corr) - MIN(d.magpsf_corr)) AS delta_mag\n    FROM detection d\n    INNER JOIN filtered_objects fo ON d.oid = fo.oid\n    WHERE d.corrected = TRUE\n    GROUP BY d.oid, d.fid\n)\n\n-- Final Query: Combine all results\nSELECT fo.oid, \n       fo.meanra, \n       fo.meandec, \n       fo.ndet, \n       fo.g_r_max_corr, \n       fo.g_r_mean_corr,\n       fi.name, \n       fi.value, \n       fi.version, \n       fi.feature_fid,\n       di.detection_fid, \n       di.max_mag, \n       di.min_mag, \n       di.delta_mag\nFROM filtered_objects fo\nINNER JOIN feature_info fi ON fo.oid = fi.oid\nINNER JOIN detection_info di ON fo.oid = di.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3417, "completion_tokens": 763, "total_tokens": 4180, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefa983881908478409929385e70", "custom_id": "1-7", "response": {"status_code": 200, "request_id": "ca275bd1c39ab66aea27fb7b5ccbc332", "body": {"id": "chatcmpl-C6JoYWj4DImzrg5EhwHHb3Q9e3Occ", "object": "chat.completion", "created": 1755622170, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    -- Step 1: Filter objects classified as AGN with a probability > 0.6\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.6\n),\nobjects_with_lightcurve AS (\n    -- Step 2: Filter objects with light curves covering at least one year\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    INNER JOIN agn_objects ao ON o.oid = ao.oid\n    WHERE o.lastmjd - o.firstmjd >= 365\n),\nobjects_with_detections AS (\n    -- Step 3: Filter objects with at least 20 detections in at least one band\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN objects_with_lightcurve owlc ON f.oid = owlc.oid\n    WHERE f.name = 'n_det'\n      AND f.value >= 20\n),\ng_band_variations AS (\n    -- Step 4.1: Filter objects with variations > 1 magnitude in the g band\n    SELECT f.oid, f.value AS delta_mag_g\n    FROM feature f\n    INNER JOIN objects_with_detections owd ON f.oid = owd.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 1\n      AND f.value > 1\n),\nr_band_variations AS (\n    -- Step 4.2: Filter objects with variations > 0.5 magnitude in the r band\n    SELECT f.oid, f.value AS delta_mag_r\n    FROM feature f\n    INNER JOIN objects_with_detections owd ON f.oid = owd.oid\n    WHERE f.name = 'delta_mag_fid'\n      AND f.fid = 2\n      AND f.value > 0.5\n),\nfiltered_objects AS (\n    -- Step 4.3: Retain objects that meet both g and r band variation conditions\n    SELECT g.oid, g.delta_mag_g, r.delta_mag_r\n    FROM g_band_variations g\n    INNER JOIN r_band_variations r ON g.oid = r.oid\n)\n-- Step 5: Retrieve the required columns\nSELECT \n    fo.oid,\n    owlc.meanra,\n    owlc.meandec,\n    owlc.ndet,\n    f.name,\n    f.value,\n    f.version,\n    f.fid AS feature_fid,\n    fo.delta_mag_g,\n    fo.delta_mag_r\nFROM filtered_objects fo\nINNER JOIN objects_with_lightcurve owlc ON fo.oid = owlc.oid\nINNER JOIN feature f ON fo.oid = f.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3408, "completion_tokens": 604, "total_tokens": 4012, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefa8e44819089e73d8914ef377d", "custom_id": "1-8", "response": {"status_code": 200, "request_id": "8079c511c3b38398103c81b57900a4b5", "body": {"id": "chatcmpl-C6JoaqyQzjc5WtpJjYNkiOcEsq3ne", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN with a probability > 0.6\nWITH agn_objects AS (\n    SELECT \n        probability.oid\n    FROM \n        probability\n    WHERE \n        probability.class_name = 'AGN'\n        AND probability.classifier_name = 'lc_classifier'\n        AND probability.ranking = 1\n        AND probability.probability > 0.6\n),\n\n-- Step 2: Filter objects with light curves covering at least one year\nobjects_with_lightcurve AS (\n    SELECT \n        object.oid,\n        object.meanra,\n        object.meandec,\n        object.ndet,\n        object.g_r_max_corr,\n        object.g_r_mean_corr\n    FROM \n        object\n    INNER JOIN \n        agn_objects\n    ON \n        object.oid = agn_objects.oid\n    WHERE \n        object.lastmjd - object.firstmjd >= 365\n),\n\n-- Step 3: Filter objects with at least 20 detections in at least one band\nobjects_with_detections AS (\n    SELECT \n        DISTINCT feature.oid\n    FROM \n        feature\n    INNER JOIN \n        objects_with_lightcurve\n    ON \n        feature.oid = objects_with_lightcurve.oid\n    WHERE \n        feature.name = 'n_det'\n        AND feature.value >= 20\n),\n\n-- Step 4: Filter objects with variations larger than 1 magnitude in g band and larger than 0.5 in r band\nobjects_with_variations AS (\n    SELECT \n        feature.oid\n    FROM \n        feature\n    INNER JOIN \n        objects_with_detections\n    ON \n        feature.oid = objects_with_detections.oid\n    WHERE \n        (feature.name = 'delta_mag_fid' AND feature.fid = 1 AND feature.value > 1) -- g band\n        OR\n        (feature.name = 'delta_mag_fid' AND feature.fid = 2 AND feature.value > 0.5) -- r band\n    GROUP BY \n        feature.oid\n    HAVING \n        COUNT(DISTINCT feature.fid) = 2 -- Ensure both g and r band conditions are met\n)\n\n-- Final Query: Retrieve required columns\nSELECT \n    obj.oid,\n    obj.meanra,\n    obj.meandec,\n    obj.ndet,\n    obj.g_r_max_corr,\n    obj.g_r_mean_corr,\n    feat.name,\n    feat.value,\n    feat.version,\n    feat.fid AS feature_fid,\n    MAX(CASE WHEN feat.fid = 1 THEN feat.value END) - MIN(CASE WHEN feat.fid = 1 THEN feat.value END) AS delta_mag_g,\n    MAX(CASE WHEN feat.fid = 2 THEN feat.value END) - MIN(CASE WHEN feat.fid = 2 THEN feat.value END) AS delta_mag_r\nFROM \n    objects_with_variations AS var\nINNER JOIN \n    objects_with_lightcurve AS obj\nON \n    var.oid = obj.oid\nINNER JOIN \n    feature AS feat\nON \n    var.oid = feat.oid\nWHERE \n    feat.name IN ('delta_mag_fid', 'n_det')\nGROUP BY \n    obj.oid, obj.meanra, obj.meandec, obj.ndet, obj.g_r_max_corr, obj.g_r_mean_corr, feat.name, feat.value, feat.version, feat.fid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3477, "completion_tokens": 713, "total_tokens": 4190, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefacb0c81908659e592dbf9c77f", "custom_id": "1-9", "response": {"status_code": 200, "request_id": "5da9660f6de58b2d3920e5061acd037e", "body": {"id": "chatcmpl-C6JofSe9s5n2CuOjnGfFN0Yax3UAd", "object": "chat.completion", "created": 1755622177, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    -- Step 1: Filter objects classified as AGN with a probability > 0.6\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\nobjects_with_lightcurve AS (\n    -- Step 2: Filter objects with light curves covering at least one year\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.g_r_max_corr, o.g_r_mean_corr\n    FROM object o\n    INNER JOIN agn_objects ao ON o.oid = ao.oid\n    WHERE (o.lastmjd - o.firstmjd) >= 365\n),\nobjects_with_detections AS (\n    -- Step 3: Filter objects with at least 20 detections in one band\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN objects_with_lightcurve owlc ON f.oid = owlc.oid\n    WHERE f.name = 'n_det' AND f.value >= 20\n),\nobjects_with_variations AS (\n    -- Step 4: Filter objects with variations larger than 1 magnitude in g band and 0.5 in r band\n    SELECT f_g.oid\n    FROM (\n        SELECT f.oid\n        FROM feature f\n        WHERE f.name = 'delta_mag_fid' AND f.fid = 1 AND f.value > 1\n    ) f_g\n    INNER JOIN (\n        SELECT f.oid\n        FROM feature f\n        WHERE f.name = 'delta_mag_fid' AND f.fid = 2 AND f.value > 0.5\n    ) f_r ON f_g.oid = f_r.oid\n),\nfinal_objects AS (\n    -- Combine all filters\n    SELECT DISTINCT owd.oid\n    FROM objects_with_detections owd\n    INNER JOIN objects_with_variations owv ON owd.oid = owv.oid\n)\n-- Step 5: Retrieve required columns\nSELECT \n    f.oid,\n    f.name,\n    f.value,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS max_mag_g,\n    MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS min_mag_g,\n    MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS max_mag_r,\n    MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS min_mag_r,\n    (MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END)) AS delta_mag_g,\n    (MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END)) AS delta_mag_r\nFROM final_objects fo\nINNER JOIN feature f ON fo.oid = f.oid\nINNER JOIN object o ON fo.oid = o.oid\nINNER JOIN detection d ON fo.oid = d.oid\nGROUP BY f.oid, f.name, f.value, f.version, f.fid, o.meanra, o.meandec, o.ndet;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3604, "completion_tokens": 744, "total_tokens": 4348, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefb6d688190a5e6b4a81185ce3b", "custom_id": "16-5", "response": {"status_code": 200, "request_id": "50548ba0a4b6384eef423fe23d69b4b5", "body": {"id": "chatcmpl-C6JoLZLTWRj9mfuigBBsymYx6HzgC", "object": "chat.completion", "created": 1755622157, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH step1 AS (\n    -- Step 1: Filter objects based on the stamp_classifier and class 'SN'\n    SELECT \n        p.oid, \n        p.probability\n    FROM \n        probability p\n    WHERE \n        p.classifier_name = 'stamp_classifier' \n        AND p.class_name = 'SN' \n        AND p.ranking = 1\n),\nstep2 AS (\n    -- Step 2: Filter objects with their first detection in the first two days of September\n    SELECT \n        o.oid\n    FROM \n        object o\n    WHERE \n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nstep3 AS (\n    -- Step 3: Identify objects that qualify as fast risers\n    SELECT \n        d.oid, \n        d.fid, \n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) AS dm_dt\n    FROM \n        detection d\n    INNER JOIN (\n        SELECT \n            oid, \n            fid, \n            MAX(mjd) AS mjd, \n            diffmaglim\n        FROM \n            detection\n        WHERE \n            isdiffpos = 0\n        GROUP BY \n            oid, fid, diffmaglim\n    ) nd\n    ON \n        d.oid = nd.oid \n        AND d.fid = nd.fid \n        AND d.mjd > nd.mjd\n    WHERE \n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) >= 0.25\n),\nstep4 AS (\n    -- Step 4: Combine the filters from Steps 1, 2, and 3\n    SELECT \n        s1.oid, \n        s1.probability, \n        s3.fid, \n        s3.dm_dt\n    FROM \n        step1 s1\n    INNER JOIN \n        step2 s2 ON s1.oid = s2.oid\n    INNER JOIN \n        step3 s3 ON s1.oid = s3.oid\n),\nlight_curves AS (\n    -- Step 5: Retrieve light curves (non-detections only) for the filtered objects\n    SELECT \n        nd.oid, \n        nd.mjd, \n        nd.fid, \n        nd.diffmaglim\n    FROM \n        detection nd\n    WHERE \n        nd.oid IN (SELECT oid FROM step4)\n),\nmagstat_details AS (\n    -- Step 6: Retrieve additional details from the magstat table\n    SELECT \n        m.oid, \n        m.fid AS magstat_fid\n    FROM \n        magstat m\n    WHERE \n        m.oid IN (SELECT oid FROM step4)\n)\n-- Step 7: Finalize the query\nSELECT \n    s4.oid, \n    s4.probability, \n    s4.fid, \n    s4.dm_dt, \n    lc.mjd, \n    lc.diffmaglim, \n    lc.fid AS light_curve_fid, \n    ms.magstat_fid\nFROM \n    step4 s4\nLEFT JOIN \n    light_curves lc ON s4.oid = lc.oid\nLEFT JOIN \n    magstat_details ms ON s4.oid = ms.oid\nORDER BY \n    s4.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3406, "completion_tokens": 713, "total_tokens": 4119, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefb49a48190a7b9a6cbccb51e63", "custom_id": "16-6", "response": {"status_code": 200, "request_id": "78bc628406e02a0645af9e5b44c12faf", "body": {"id": "chatcmpl-C6JoNMPD1yu1AIN1I6jTWytTj5hMy", "object": "chat.completion", "created": 1755622159, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects based on the highest probability in the 'stamp_classifier' for class 'SN'\nWITH probability_filter AS (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND class_name = 'SN' \n        AND ranking = 1\n),\n\n-- Step 2: Filter objects with their first detection in the first two days of September\nfirst_detection_filter AS (\n    SELECT \n        oid, \n        firstmjd\n    FROM \n        object\n    WHERE \n        firstmjd BETWEEN 60188.0 AND 60189.0\n),\n\n-- Step 3: Identify objects that qualify as fast risers\nfast_risers AS (\n    SELECT \n        d.oid,\n        d.mjd AS detection_mjd,\n        nd.mjd AS non_detection_mjd,\n        d.magpsf AS detection_magpsf,\n        nd.diffmaglim AS non_detection_diffmaglim,\n        d.fid\n    FROM \n        detection d\n    INNER JOIN \n        (SELECT \n            oid, \n            fid, \n            MAX(mjd) AS mjd, \n            diffmaglim\n         FROM \n            detection\n         WHERE \n            isdiffpos = 0\n         GROUP BY \n            oid, fid, diffmaglim) nd\n    ON \n        d.oid = nd.oid \n        AND d.fid = nd.fid \n        AND d.mjd > nd.mjd\n    WHERE \n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) >= 0.25\n),\n\n-- Step 4: Combine filters from Steps 1, 2, and 3\nfiltered_objects AS (\n    SELECT \n        pf.oid, \n        pf.probability, \n        fdf.firstmjd, \n        fr.detection_mjd, \n        fr.non_detection_mjd, \n        fr.detection_magpsf, \n        fr.non_detection_diffmaglim, \n        fr.fid\n    FROM \n        probability_filter pf\n    INNER JOIN \n        first_detection_filter fdf\n    ON \n        pf.oid = fdf.oid\n    INNER JOIN \n        fast_risers fr\n    ON \n        pf.oid = fr.oid\n),\n\n-- Step 5: Retrieve light curves (non-detections only) for the filtered objects\nlight_curves AS (\n    SELECT \n        nd.oid, \n        nd.mjd, \n        nd.fid, \n        NULL AS magpsf, \n        NULL AS sigmapsf, \n        nd.diffmaglim\n    FROM \n        detection nd\n    WHERE \n        nd.oid IN (SELECT oid FROM filtered_objects)\n),\n\n-- Step 6: Retrieve additional information from the 'magstat' table\nmagstat_info AS (\n    SELECT \n        oid, \n        fid AS magstat_fid, \n        magmean_corr\n    FROM \n        magstat\n    WHERE \n        oid IN (SELECT oid FROM filtered_objects)\n)\n\n-- Step 7: Combine all results and format the output\nSELECT \n    fo.oid, \n    fo.probability, \n    fo.firstmjd, \n    fo.detection_mjd, \n    fo.non_detection_mjd, \n    fo.detection_magpsf, \n    fo.non_detection_diffmaglim, \n    fo.fid, \n    mi.magstat_fid, \n    mi.magmean_corr, \n    lc.mjd AS light_curve_mjd, \n    lc.fid AS light_curve_fid, \n    lc.magpsf AS light_curve_magpsf, \n    lc.sigmapsf AS light_curve_sigmapsf, \n    lc.diffmaglim AS light_curve_diffmaglim\nFROM \n    filtered_objects fo\nLEFT JOIN \n    magstat_info mi\nON \n    fo.oid = mi.oid\nLEFT JOIN \n    light_curves lc\nON \n    fo.oid = lc.oid\nORDER BY \n    fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3587, "completion_tokens": 852, "total_tokens": 4439, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefb80ac8190bbae3b035d55bfa6", "custom_id": "16-7", "response": {"status_code": 200, "request_id": "b481857c57c3eb79c10ceae4c2b69ffe", "body": {"id": "chatcmpl-C6JoLEbYFPytuZpAiYFhUOBYoJmy2", "object": "chat.completion", "created": 1755622157, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH stamp_classifier_sn AS (\n    -- Step 1: Filter objects based on the stamp classifier and class 'SN'\n    SELECT \n        p.oid, \n        p.probability\n    FROM \n        probability p\n    WHERE \n        p.classifier_name = 'stamp_classifier' \n        AND p.class_name = 'SN' \n        AND p.ranking = 1\n),\nfirst_detection_september AS (\n    -- Step 2: Filter objects with their first detection in the first two days of September\n    SELECT \n        o.oid\n    FROM \n        object o\n    WHERE \n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    -- Step 3: Identify objects that qualify as fast risers\n    SELECT \n        d.oid, \n        d.fid, \n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) AS dm_dt\n    FROM \n        detection d\n    INNER JOIN \n        (SELECT \n            oid, fid, MAX(mjd) AS mjd, diffmaglim\n         FROM \n            non_detection\n         GROUP BY \n            oid, fid, diffmaglim) nd\n    ON \n        d.oid = nd.oid \n        AND d.fid = nd.fid \n        AND nd.mjd < d.mjd\n    WHERE \n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) >= 0.25\n),\nfiltered_objects AS (\n    -- Step 4: Combine the filters from Steps 1, 2, and 3\n    SELECT \n        sc.oid, \n        sc.probability, \n        fr.fid, \n        fr.dm_dt\n    FROM \n        stamp_classifier_sn sc\n    INNER JOIN \n        first_detection_september fd\n    ON \n        sc.oid = fd.oid\n    INNER JOIN \n        fast_risers fr\n    ON \n        sc.oid = fr.oid\n),\nlight_curves AS (\n    -- Step 5: Retrieve light curves (detections and non-detections)\n    SELECT \n        d.oid, \n        d.mjd, \n        d.fid, \n        d.magpsf, \n        d.sigmapsf, \n        d.magap, \n        d.sigmagap, \n        d.diffmaglim, \n        d.rb, \n        d.drb\n    FROM \n        detection d\n    WHERE \n        d.oid IN (SELECT oid FROM filtered_objects)\n    UNION\n    SELECT \n        nd.oid, \n        nd.mjd, \n        nd.fid, \n        NULL AS magpsf, \n        NULL AS sigmapsf, \n        NULL AS magap, \n        NULL AS sigmagap, \n        nd.diffmaglim, \n        NULL AS rb, \n        NULL AS drb\n    FROM \n        non_detection nd\n    WHERE \n        nd.oid IN (SELECT oid FROM filtered_objects)\n),\nmagstat_data AS (\n    -- Step 6: Retrieve additional details from the magstat table\n    SELECT \n        m.oid, \n        m.fid AS magstat_fid, \n        m.magmean, \n        m.magmedian, \n        m.magmax, \n        m.magmin\n    FROM \n        magstat m\n    WHERE \n        m.oid IN (SELECT oid FROM filtered_objects)\n)\n-- Step 7: Combine all results\nSELECT \n    fo.oid, \n    fo.probability, \n    fo.fid, \n    fo.dm_dt, \n    lc.mjd, \n    lc.fid AS light_curve_fid, \n    lc.magpsf, \n    lc.sigmapsf, \n    lc.magap, \n    lc.sigmagap, \n    lc.diffmaglim, \n    lc.rb, \n    lc.drb, \n    ms.magstat_fid, \n    ms.magmean, \n    ms.magmedian, \n    ms.magmax, \n    ms.magmin\nFROM \n    filtered_objects fo\nINNER JOIN \n    light_curves lc\nON \n    fo.oid = lc.oid\nINNER JOIN \n    magstat_data ms\nON \n    fo.oid = ms.oid\nORDER BY \n    fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3502, "completion_tokens": 916, "total_tokens": 4418, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefb847c8190b9072b3a23dcc23b", "custom_id": "16-8", "response": {"status_code": 200, "request_id": "ca9eed96ef0531123f78c8f134a1f6c5", "body": {"id": "chatcmpl-C6JoLGGVW68fUvuhG9xQTRkCZM3uk", "object": "chat.completion", "created": 1755622157, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects based on the stamp classifier and class 'SN'\nWITH stamp_classifier_sn AS (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND class_name = 'SN' \n        AND ranking = 1\n),\n\n-- Step 2: Filter objects with their first detection in the first two days of September\nobjects_first_detection_september AS (\n    SELECT \n        oid\n    FROM \n        object\n    WHERE \n        firstmjd BETWEEN 60188.0 AND 60189.0\n),\n\n-- Step 3: Identify objects that qualify as fast risers\nfast_risers AS (\n    SELECT \n        d.oid, \n        d.fid, \n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) AS dm_dt\n    FROM \n        detection d\n    INNER JOIN \n        (SELECT \n            oid, \n            fid, \n            MAX(mjd) AS mjd, \n            diffmaglim\n         FROM \n            non_detection\n         GROUP BY \n            oid, fid, diffmaglim\n        ) nd\n    ON \n        d.oid = nd.oid AND d.fid = nd.fid AND nd.mjd < d.mjd\n    WHERE \n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) >= 0.25\n),\n\n-- Step 4: Combine results from Steps 1, 2, and 3\nfiltered_objects AS (\n    SELECT \n        sc.oid, \n        sc.probability, \n        fr.fid, \n        fr.dm_dt\n    FROM \n        stamp_classifier_sn sc\n    INNER JOIN \n        objects_first_detection_september ofds\n    ON \n        sc.oid = ofds.oid\n    INNER JOIN \n        fast_risers fr\n    ON \n        sc.oid = fr.oid\n),\n\n-- Step 5: Retrieve light curves (non-detections only) for the filtered objects\nlight_curves AS (\n    SELECT \n        nd.oid, \n        nd.mjd, \n        nd.fid, \n        nd.diffmaglim\n    FROM \n        non_detection nd\n    INNER JOIN \n        filtered_objects fo\n    ON \n        nd.oid = fo.oid\n),\n\n-- Step 6: Retrieve additional information from the magstat table\nmagstat_data AS (\n    SELECT \n        ms.oid, \n        ms.fid AS magstat_fid, \n        ms.magmean, \n        ms.magmedian, \n        ms.magmax, \n        ms.magmin\n    FROM \n        magstat ms\n    INNER JOIN \n        filtered_objects fo\n    ON \n        ms.oid = fo.oid\n)\n\n-- Step 7: Combine all results and format the output\nSELECT \n    fo.oid, \n    fo.probability, \n    fo.fid, \n    fo.dm_dt, \n    lc.mjd, \n    lc.fid AS light_curve_fid, \n    lc.diffmaglim, \n    ms.magstat_fid, \n    ms.magmean, \n    ms.magmedian, \n    ms.magmax, \n    ms.magmin\nFROM \n    filtered_objects fo\nINNER JOIN \n    light_curves lc\nON \n    fo.oid = lc.oid\nINNER JOIN \n    magstat_data ms\nON \n    fo.oid = ms.oid\nORDER BY \n    fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3588, "completion_tokens": 749, "total_tokens": 4337, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefb999c81908eecac65915f2f29", "custom_id": "16-9", "response": {"status_code": 200, "request_id": "31361fd9a12770f177e196d575e90fc6", "body": {"id": "chatcmpl-C6JoLd5SbfXe0JNcJCDybK8pUTLvd", "object": "chat.completion", "created": 1755622157, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects based on the highest probability in the stamp_classifier for class 'SN'\nWITH prob_filtered AS (\n    SELECT \n        oid, \n        probability \n    FROM \n        probability \n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND class_name = 'SN' \n        AND ranking = 1\n),\n\n-- Step 2: Filter objects with their first detection in the first two days of September\nobjects_filtered AS (\n    SELECT \n        oid, \n        firstmjd \n    FROM \n        object \n    WHERE \n        firstmjd >= 60188.0 \n        AND firstmjd < 60190.0\n),\n\n-- Step 3.1: Retrieve the first detection for each object and filter\nfirst_detections AS (\n    SELECT \n        oid, \n        fid, \n        MIN(mjd) AS mjd_first_detection, \n        MIN(magpsf) AS magpsf \n    FROM \n        detection \n    GROUP BY \n        oid, fid\n),\n\n-- Step 3.2: Retrieve the last non-detection before the first detection for each object and filter\nlast_non_detections AS (\n    SELECT \n        nd.oid, \n        nd.fid, \n        MAX(nd.mjd) AS mjd_last_non_detection, \n        MAX(nd.diffmaglim) AS diffmaglim \n    FROM \n        detection d\n    INNER JOIN \n        detection nd \n    ON \n        d.oid = nd.oid \n        AND nd.mjd < d.mjd \n    GROUP BY \n        nd.oid, nd.fid\n),\n\n-- Step 3.3: Calculate the rate of magnitude change and filter fast risers\nfast_risers AS (\n    SELECT \n        fd.oid, \n        fd.fid, \n        fd.mjd_first_detection, \n        ln.mjd_last_non_detection, \n        fd.magpsf, \n        ln.diffmaglim, \n        (ln.diffmaglim - fd.magpsf) / (fd.mjd_first_detection - ln.mjd_last_non_detection) AS rate \n    FROM \n        first_detections fd\n    INNER JOIN \n        last_non_detections ln \n    ON \n        fd.oid = ln.oid \n        AND fd.fid = ln.fid \n    WHERE \n        (ln.diffmaglim - fd.magpsf) / (fd.mjd_first_detection - ln.mjd_last_non_detection) >= 0.25\n),\n\n-- Step 4: Combine filters from Steps 1, 2, and 3\nfiltered_objects AS (\n    SELECT \n        pf.oid, \n        pf.probability, \n        fr.fid, \n        fr.mjd_first_detection, \n        fr.mjd_last_non_detection, \n        fr.magpsf, \n        fr.diffmaglim, \n        fr.rate \n    FROM \n        prob_filtered pf\n    INNER JOIN \n        objects_filtered of \n    ON \n        pf.oid = of.oid\n    INNER JOIN \n        fast_risers fr \n    ON \n        pf.oid = fr.oid\n),\n\n-- Step 5: Retrieve light curves (non-detections only) for the filtered objects\nlight_curves AS (\n    SELECT \n        nd.* \n    FROM \n        detection nd\n    INNER JOIN \n        filtered_objects fo \n    ON \n        nd.oid = fo.oid\n),\n\n-- Step 6: Retrieve additional information from the magstat table\nmagstat_info AS (\n    SELECT \n        ms.oid, \n        ms.fid AS magstat_fid \n    FROM \n        magstat ms\n    INNER JOIN \n        filtered_objects fo \n    ON \n        ms.oid = fo.oid\n)\n\n-- Step 7: Combine all results and format the output\nSELECT \n    fo.oid, \n    fo.probability, \n    fo.fid, \n    fo.mjd_first_detection, \n    fo.mjd_last_non_detection, \n    fo.magpsf, \n    fo.diffmaglim, \n    fo.rate AS initial_rise_estimate, \n    lc.*, \n    ms.magstat_fid \nFROM \n    filtered_objects fo\nLEFT JOIN \n    light_curves lc \nON \n    fo.oid = lc.oid\nLEFT JOIN \n    magstat_info ms \nON \n    fo.oid = ms.oid\nORDER BY \n    fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3695, "completion_tokens": 927, "total_tokens": 4622, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefb779481909ec5662a5c290f93", "custom_id": "14-5", "response": {"status_code": 200, "request_id": "1b2204778da8149ce1aefbf1be60f7ad", "body": {"id": "chatcmpl-C6JoT9qhruVnw3EIcLmb6u6PBpVUh", "object": "chat.completion", "created": 1755622165, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve the requested information for the given list of oids\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', \n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', \n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2964, "completion_tokens": 246, "total_tokens": 3210, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefba7d481908b64a275498569cb", "custom_id": "14-6", "response": {"status_code": 200, "request_id": "bd17047e33102841227c9691cf3372a0", "body": {"id": "chatcmpl-C6JoV8Ll6dMz6iGzd4gdrKbc9rwb2", "object": "chat.completion", "created": 1755622167, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',\n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',\n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3085, "completion_tokens": 229, "total_tokens": 3314, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefba36c81909da467fdde54f3bd", "custom_id": "14-7", "response": {"status_code": 200, "request_id": "116afc1317220d1506772a624262c1dc", "body": {"id": "chatcmpl-C6JoZVCrYKLFZkSXqeGFuPoJmcKBN", "object": "chat.completion", "created": 1755622171, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', \n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', \n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2956, "completion_tokens": 231, "total_tokens": 3187, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefba7f48190994daf5d48f97e70", "custom_id": "14-8", "response": {"status_code": 200, "request_id": "2bda3bdc6809b0205bedf189bf8397ee", "body": {"id": "chatcmpl-C6JoY4JUq37TwXSbe5StboQCfYWxj", "object": "chat.completion", "created": 1755622170, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', \n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', \n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2946, "completion_tokens": 231, "total_tokens": 3177, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefbdbc08190a9ad540476bf48e8", "custom_id": "14-9", "response": {"status_code": 200, "request_id": "2ded18e0fff74ffb83e957970e7e7dd0", "body": {"id": "chatcmpl-C6JoaKL0YJnRYMUT7efsORILQlXES", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve the requested information for the given list of oids\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', \n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', \n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2900, "completion_tokens": 246, "total_tokens": 3146, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4aefc27c4819088f7f30958de482d", "custom_id": "57-5", "response": {"status_code": 200, "request_id": "570b55f8c0bc208bfb27b50479b51091", "body": {"id": "chatcmpl-C6JoaKzyq0FzkEO0lRY5ZaMRXwiGe", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    -- Define the input objects with their coordinates and search radii\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 0.008333 AS search_radius\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 0.005556\n),\nztf_objects_id_1 AS (\n    -- Retrieve ZTF objects within 30 arcsec of id_1\n    SELECT \n        'id_1' AS identifier,\n        obj.oid,\n        obj.ndet,\n        obj.meanra,\n        obj.meandec,\n        obj.firstmjd,\n        obj.lastmjd\n    FROM object AS obj\n    WHERE q3c_radial_query(obj.meanra, obj.meandec, 354.67, 15.954, 0.008333)\n),\nztf_objects_id_2 AS (\n    -- Retrieve ZTF objects within 20 arcsec of id_2\n    SELECT \n        'id_2' AS identifier,\n        obj.oid,\n        obj.ndet,\n        obj.meanra,\n        obj.meandec,\n        obj.firstmjd,\n        obj.lastmjd\n    FROM object AS obj\n    WHERE q3c_radial_query(obj.meanra, obj.meandec, 20.7993, 1.00331, 0.005556)\n),\ncombined_ztf_objects AS (\n    -- Combine results from both spatial searches\n    SELECT * FROM ztf_objects_id_1\n    UNION ALL\n    SELECT * FROM ztf_objects_id_2\n)\n-- Combine input object information with ZTF object results and sort by last detection date\nSELECT \n    io.identifier,\n    io.ra AS input_ra,\n    io.dec AS input_dec,\n    io.search_radius,\n    ztf.oid,\n    ztf.ndet,\n    ztf.meanra AS ztf_meanra,\n    ztf.meandec AS ztf_meandec,\n    ztf.firstmjd\nFROM input_objects AS io\nJOIN combined_ztf_objects AS ztf\nON io.identifier = ztf.identifier\nORDER BY ztf.lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3194, "completion_tokens": 467, "total_tokens": 3661, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefc4ba88190ac5a39f698435fb4", "custom_id": "57-6", "response": {"status_code": 200, "request_id": "48f68af42f8d772475ce81597061eeb0", "body": {"id": "chatcmpl-C6JocnE51R5O3T2k4OFjC1s4dKUhp", "object": "chat.completion", "created": 1755622174, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 0.008333 AS search_radius\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 0.005556\n),\nztf_objects_id_1 AS (\n    SELECT \n        'id_1' AS identifier,\n        354.67 AS input_ra,\n        15.954 AS input_dec,\n        0.008333 AS search_radius,\n        oid,\n        ndet,\n        meanra,\n        meandec,\n        firstmjd,\n        lastmjd\n    FROM object\n    WHERE q3c_radial_query(meanra, meandec, 354.67, 15.954, 0.008333)\n),\nztf_objects_id_2 AS (\n    SELECT \n        'id_2' AS identifier,\n        20.7993 AS input_ra,\n        1.00331 AS input_dec,\n        0.005556 AS search_radius,\n        oid,\n        ndet,\n        meanra,\n        meandec,\n        firstmjd,\n        lastmjd\n    FROM object\n    WHERE q3c_radial_query(meanra, meandec, 20.7993, 1.00331, 0.005556)\n)\nSELECT \n    identifier,\n    input_ra AS ra,\n    input_dec AS dec,\n    search_radius,\n    oid AS ztf_identifier,\n    ndet AS number_of_detections,\n    meanra AS mean_ra,\n    meandec AS mean_dec,\n    firstmjd AS first_detection_date\nFROM (\n    SELECT * FROM ztf_objects_id_1\n    UNION ALL\n    SELECT * FROM ztf_objects_id_2\n) AS combined_results\nORDER BY lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3178, "completion_tokens": 398, "total_tokens": 3576, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefcd3688190a574a31e8bf6010f", "custom_id": "57-7", "response": {"status_code": 200, "request_id": "cb04bb2a0f0971fe9d3829a0836460fc", "body": {"id": "chatcmpl-C6JogyluQMXXBArChrKJt3JwHzAbI", "object": "chat.completion", "created": 1755622178, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Define the input objects and their search parameters\nWITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS search_radius\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600\n),\n-- Step 2: Perform spatial filtering for each input object\nfiltered_objects AS (\n    SELECT \n        io.identifier,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.search_radius,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM input_objects io\n    JOIN object o\n    ON q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)\n)\n-- Step 3: Retrieve the required columns and sort by last detection date\nSELECT \n    identifier,\n    input_ra AS ra,\n    input_dec AS dec,\n    search_radius,\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM filtered_objects\nORDER BY lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3257, "completion_tokens": 276, "total_tokens": 3533, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4aefc642481908e49e802bf0d554f", "custom_id": "57-8", "response": {"status_code": 200, "request_id": "515b414b5caf3f22e6ed0d619c1b3cfd", "body": {"id": "chatcmpl-C6JofYqh986OPUsC3QeUgmTyzSngk", "object": "chat.completion", "created": 1755622177, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 0.008333 AS search_radius\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 0.005556\n),\nztf_objects_id_1 AS (\n    SELECT \n        'id_1' AS identifier,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 0.008333)\n),\nztf_objects_id_2 AS (\n    SELECT \n        'id_2' AS identifier,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 0.005556)\n),\ncombined_ztf_objects AS (\n    SELECT * FROM ztf_objects_id_1\n    UNION ALL\n    SELECT * FROM ztf_objects_id_2\n)\nSELECT \n    io.identifier,\n    io.ra AS input_ra,\n    io.dec AS input_dec,\n    io.search_radius,\n    czo.oid AS ztf_identifier,\n    czo.ndet AS ztf_ndet,\n    czo.meanra AS ztf_meanra,\n    czo.meandec AS ztf_meandec,\n    czo.firstmjd AS ztf_firstmjd\nFROM input_objects io\nLEFT JOIN combined_ztf_objects czo\nON io.identifier = czo.identifier\nORDER BY czo.lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3265, "completion_tokens": 407, "total_tokens": 3672, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4aefc7b4c8190806f2db5fb334d8e", "custom_id": "57-9", "response": {"status_code": 200, "request_id": "1d8e355c9ff81212ea990fd1ffaf47e5", "body": {"id": "chatcmpl-C6Joho7nWOi7i7kzj5YRmzq6HFDOW", "object": "chat.completion", "created": 1755622179, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    -- Define the input objects with their coordinates and search radii\n    VALUES\n        ('id_1', 354.67, 15.954, 0.008333), -- 30 arcsec = 0.008333 degrees\n        ('id_2', 20.7993, 1.00331, 0.005556) -- 20 arcsec = 0.005556 degrees\n),\nspatial_search AS (\n    -- Perform spatial filtering for each input object using q3c_radial_query\n    SELECT\n        io.column1 AS source_id, -- Input object identifier\n        io.column2 AS ra, -- Input object RA\n        io.column3 AS dec, -- Input object Dec\n        io.column4 AS radius, -- Search radius in degrees\n        o.oid, -- ZTF object identifier\n        o.ndet, -- Number of detections\n        o.meanra, -- Mean RA of the ZTF object\n        o.meandec, -- Mean Dec of the ZTF object\n        o.firstmjd, -- First detection date\n        o.lastmjd -- Last detection date\n    FROM\n        input_objects io\n    INNER JOIN\n        object o\n    ON\n        q3c_radial_query(o.meanra, o.meandec, io.column2, io.column3, io.column4)\n)\n-- Combine results and sort by last detection date in descending order\nSELECT\n    source_id, -- Input object identifier\n    ra, -- Input object RA\n    dec, -- Input object Dec\n    radius, -- Search radius in degrees\n    oid, -- ZTF object identifier\n    ndet, -- Number of detections\n    meanra, -- Mean RA of the ZTF object\n    meandec, -- Mean Dec of the ZTF object\n    firstmjd -- First detection date\nFROM\n    spatial_search\nORDER BY\n    lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3191, "completion_tokens": 413, "total_tokens": 3604, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefc8210819097cf8564f6edc9cb", "custom_id": "89-5", "response": {"status_code": 200, "request_id": "a1578fb7e8cdcfd1431e1f65ed355e27", "body": {"id": "chatcmpl-C6JohZ8LuVanGFn8XX2ILI8kgbTU8", "object": "chat.completion", "created": 1755622179, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier\n-- with a probability greater than 0.7, returning all columns from the 'dataquality' table.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n      AND classifier_name = 'stamp_classifier'\n      AND probability > 0.7\n      AND ranking = 1\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2776, "completion_tokens": 106, "total_tokens": 2882, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefc90908190a76eb6b4238d9108", "custom_id": "89-6", "response": {"status_code": 200, "request_id": "0a2a4236c32fb377104d6575b3602805", "body": {"id": "chatcmpl-C6JoizWsbWNhEATaFl4solCC03nEB", "object": "chat.completion", "created": 1755622180, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier\n-- with a probability greater than 0.7, returning all columns from the 'dataquality' table.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n      AND classifier_name = 'stamp_classifier'\n      AND probability > 0.7\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2757, "completion_tokens": 99, "total_tokens": 2856, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefc838481908e3ce354e40e9ab0", "custom_id": "89-7", "response": {"status_code": 200, "request_id": "d29c1b70ba027af146568141421392bb", "body": {"id": "chatcmpl-C6JokQJggMT3lLu5iw2XVqGSWAcNF", "object": "chat.completion", "created": 1755622182, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier\n-- with a probability greater than 0.7, returning all columns from the 'dataquality' table.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n      AND classifier_name = 'stamp_classifier'\n      AND ranking = 1\n      AND probability > 0.7\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2593, "completion_tokens": 106, "total_tokens": 2699, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefc86d88190ac0ed567754e5c4d", "custom_id": "89-8", "response": {"status_code": 200, "request_id": "aa386bb9640f5df59b7c81860bc7c1cb", "body": {"id": "chatcmpl-C6Jol0gI9k8rNwDAGt1FsPxseX4Yt", "object": "chat.completion", "created": 1755622183, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier\n-- with a probability greater than 0.7, returning all columns from the 'dataquality' table.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n      AND classifier_name = 'stamp_classifier'\n      AND probability > 0.7\n      AND ranking = 1\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2744, "completion_tokens": 106, "total_tokens": 2850, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefcc58481908fcba741681e013f", "custom_id": "89-9", "response": {"status_code": 200, "request_id": "2819fca120dc2a9040c8a012e831e860", "body": {"id": "chatcmpl-C6JonDHvntzgnYa69FPVpWZMLJOup", "object": "chat.completion", "created": 1755622185, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier\n-- with a probability greater than 0.7, returning all columns from the 'dataquality' table.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n      AND classifier_name = 'stamp_classifier'\n      AND probability > 0.7\n      AND ranking = 1\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2708, "completion_tokens": 106, "total_tokens": 2814, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefd1c8c819086e5088148c8abd4", "custom_id": "103-5", "response": {"status_code": 200, "request_id": "4e98ee7c2c06430165271cad8c9a7018", "body": {"id": "chatcmpl-C6JoVSCzP05ID5WIEzUOKne5MyDW1", "object": "chat.completion", "created": 1755622167, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT *\nFROM object\nINNER JOIN (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n) prob_filtered ON object.oid = prob_filtered.oid\nINNER JOIN (\n    SELECT ps1.oid, ps1.distpsnr1\n    FROM ps1_ztf ps1\n    WHERE ps1.distpsnr1 > 5\n) ps1_filtered ON object.oid = ps1_filtered.oid\nORDER BY ps1_filtered.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3283, "completion_tokens": 190, "total_tokens": 3473, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefd22c88190b043e00fd1614922", "custom_id": "103-6", "response": {"status_code": 200, "request_id": "dd1edcb903d69c002ec772ecdbc642b0", "body": {"id": "chatcmpl-C6JoWty8PV3BULp0LuOhoj38pCiM9", "object": "chat.completion", "created": 1755622168, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects based on the distance to the nearest PS1 source\nWITH ps1_filtered AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE distpsnr1 > 5\n),\n-- Step 2: Filter objects based on classification probability\nprobability_filtered AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.7\n      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n),\n-- Step 3: Combine the filters from Step 1 and Step 2\ncombined_filtered AS (\n    SELECT ps1_filtered.oid\n    FROM ps1_filtered\n    INNER JOIN probability_filtered\n    ON ps1_filtered.oid = probability_filtered.oid\n)\n-- Step 4: Retrieve all columns from the 'object', 'probability', and 'ps1_ztf' tables\nSELECT *\nFROM object\nINNER JOIN probability\nON object.oid = probability.oid\nINNER JOIN ps1_ztf\nON object.oid = ps1_ztf.oid\nWHERE object.oid IN (SELECT oid FROM combined_filtered)\n  AND probability.ranking = 1\n  AND probability.classifier_name = 'lc_classifier'\nORDER BY ps1_ztf.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3206, "completion_tokens": 297, "total_tokens": 3503, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefd5640819096013bc58c625dcf", "custom_id": "103-7", "response": {"status_code": 200, "request_id": "53c000c269a7d2e2267d4c6b294d4dd5", "body": {"id": "chatcmpl-C6JoV4isCfHb1MC8VXoBY06PLZy5i", "object": "chat.completion", "created": 1755622167, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects based on the distance to the nearest PS1 source\nWITH ps1_filtered AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE distpsnr1 > 5\n),\n-- Step 2: Filter objects based on classification probability\nprobability_filtered AS (\n    SELECT oid\n    FROM probability\n    WHERE probability > 0.7\n      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n),\n-- Step 3: Combine the results from Step 1 and Step 2\ncombined_filtered AS (\n    SELECT ps1_filtered.oid\n    FROM ps1_filtered\n    INNER JOIN probability_filtered\n    ON ps1_filtered.oid = probability_filtered.oid\n)\n-- Step 4: Retrieve all columns from the 'object', 'probability', and 'ps1_ztf' tables\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nINNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid\nWHERE object.oid IN (SELECT oid FROM combined_filtered)\nORDER BY ps1_ztf.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3140, "completion_tokens": 275, "total_tokens": 3415, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefd5d288190940fa25888d2f08d", "custom_id": "103-8", "response": {"status_code": 200, "request_id": "8b7f9e36500ae768e055e9257b183155", "body": {"id": "chatcmpl-C6JoVXxlN1Wjm78gyu0OErTr0bYLW", "object": "chat.completion", "created": 1755622167, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT *\nFROM object\nINNER JOIN (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n) prob_filtered ON object.oid = prob_filtered.oid\nINNER JOIN (\n    SELECT oid, distpsnr1\n    FROM ps1_ztf\n    WHERE distpsnr1 > 5\n) ps1_filtered ON object.oid = ps1_filtered.oid\nORDER BY ps1_filtered.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3375, "completion_tokens": 181, "total_tokens": 3556, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefd65248190bea95dcbfcb6dcf9", "custom_id": "103-9", "response": {"status_code": 200, "request_id": "65a385bee105eb442175fce7929834ed", "body": {"id": "chatcmpl-C6JoVlDh7jA2N2YMqFj2woNZa2M54", "object": "chat.completion", "created": 1755622167, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT *\nFROM object\nINNER JOIN (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n) prob_filtered ON object.oid = prob_filtered.oid\nINNER JOIN (\n    SELECT ps1_ztf.oid, ps1_ztf.distpsnr1\n    FROM ps1_ztf\n    WHERE ps1_ztf.distpsnr1 > 5\n) ps1_filtered ON object.oid = ps1_filtered.oid\nORDER BY ps1_filtered.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3232, "completion_tokens": 197, "total_tokens": 3429, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefd68d881908efb63681d2b0d29", "custom_id": "99-5", "response": {"status_code": 200, "request_id": "2e2f512b5ca4a41a1f301242129fd2db", "body": {"id": "chatcmpl-C6JoZlbicDXTJV0yU2sVbxHvRSYuw", "object": "chat.completion", "created": 1755622171, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with a first detection date later than mjd=60310,\n-- classified as 'asteroid' with a probability of 1 in the stamp classifier,\n-- and return all columns from the 'forced_photometry' table, ordered by the first detection date.\n\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability = 1\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2772, "completion_tokens": 166, "total_tokens": 2938, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefd759c8190986c24b6978d6d85", "custom_id": "99-6", "response": {"status_code": 200, "request_id": "a413878a0e3a3436b14970fad83e40b3", "body": {"id": "chatcmpl-C6Joad7ErRk2Eh4Bqhgm8gLOu2mej", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with a first detection date later than mjd=60310 days,\n-- a probability of 1 of being classified as an 'asteroid' by the 'stamp_classifier',\n-- ordered by the first detection date, and returning all columns from the 'forced_photometry' table.\n\nSELECT fp.*\nFROM object o\nINNER JOIN probability p\n    ON o.oid = p.oid\nINNER JOIN forced_photometry fp\n    ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability = 1\n  AND p.ranking = 1 -- Default condition for the probability table\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2989, "completion_tokens": 181, "total_tokens": 3170, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefd88b08190b8860ae9f926bcf4", "custom_id": "99-7", "response": {"status_code": 200, "request_id": "c001f0ee9fd199f8c4ba918115968bf4", "body": {"id": "chatcmpl-C6JocipnPGuxgEfk5buLDMwgwdS4B", "object": "chat.completion", "created": 1755622174, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with specific conditions and return all columns from the 'forced_photometry' table\nSELECT *\nFROM forced_photometry\nWHERE oid IN (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p\n    ON o.oid = p.oid\n    WHERE o.firstmjd > 60310\n      AND p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability = 1\n      AND p.ranking = 1\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2805, "completion_tokens": 137, "total_tokens": 2942, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4aefdb94081909aa533539d4c3469", "custom_id": "99-8", "response": {"status_code": 200, "request_id": "caeb29c9457477ecd5c3b217bb9b4cb7", "body": {"id": "chatcmpl-C6Jogg9WfsAIdsnPJ33N72Hehr4Rz", "object": "chat.completion", "created": 1755622178, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with a first detection date later than mjd=60310 days,\n-- a probability of 1 of being classified as an asteroid by the stamp classifier,\n-- ordered by the first detection date, and returning all columns from the 'forced_photometry' table.\n\nSELECT *\nFROM forced_photometry\nWHERE oid IN (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p\n    ON o.oid = p.oid\n    WHERE o.firstmjd > 60310\n      AND p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability = 1\n      AND p.ranking = 1\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2923, "completion_tokens": 173, "total_tokens": 3096, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefdaee48190afaeab8af798b00a", "custom_id": "99-9", "response": {"status_code": 200, "request_id": "8892df3c85eb8b279106910b9d31fc0a", "body": {"id": "chatcmpl-C6JodlyHP0CuF9WVM2bCVhVcjla8M", "object": "chat.completion", "created": 1755622175, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with a first detection date later than mjd=60310 days,\n-- a probability of 1 of being classified as an asteroid in the stamp classifier,\n-- ordered by the first detection date, and returning all columns from the 'forced_photometry' table.\n\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability = 1\n  AND p.ranking = 1 -- Default condition for the most likely classification\nORDER BY o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2866, "completion_tokens": 173, "total_tokens": 3039, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefe1c888190ab463c3a589a4714", "custom_id": "92-5", "response": {"status_code": 200, "request_id": "c0c633ef7761a3f5660e417035c218b9", "body": {"id": "chatcmpl-C6JoguxOSTUApKHQLj7r11HOPt5CL", "object": "chat.completion", "created": 1755622178, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 500 ZTF objects with at least 10 detections in the g band (fid = 1),\n-- no dubious corrections in that filter, and include probabilities with ranking 1 for the light curve classifier.\n\nSELECT \n    p.oid, -- ZTF identifier\n    p.classifier_version, -- Classifier version\n    p.class_name, -- Class name\n    p.probability -- Probability\nFROM \n    probability p\nINNER JOIN (\n    SELECT \n        d.oid\n    FROM \n        detection d\n    WHERE \n        d.fid = 1 -- g band\n        AND d.dubious = FALSE -- No dubious corrections\n    GROUP BY \n        d.oid\n    HAVING \n        COUNT(d.oid) >= 10 -- At least 10 detections\n) filtered_detections\nON \n    p.oid = filtered_detections.oid\nWHERE \n    p.ranking = 1 -- Most likely class\n    AND p.classifier_name = 'lc_classifier' -- Light curve classifier\nORDER BY \n    p.oid ASC -- Order by ZTF identifier\nLIMIT 500; -- Limit to at most 500 objects\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2992, "completion_tokens": 252, "total_tokens": 3244, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefe29a48190807b2c2250390f31", "custom_id": "92-6", "response": {"status_code": 200, "request_id": "df9652da7854196021a1384c976d3e39", "body": {"id": "chatcmpl-C6Joi6aeadYaxGERkPMo1YqSjlcWd", "object": "chat.completion", "created": 1755622180, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find ZTF objects with at least 10 detections in the g band (fid = 1),\n-- no dubious corrections, and include probabilities with ranking 1 for the light curve classifier.\n-- The result is limited to 500 rows and ordered by oid.\n\nSELECT \n    p.oid, -- ZTF identifier\n    p.classifier_version, -- Classifier version\n    p.class_name, -- Class name\n    p.probability -- Probability\nFROM \n    probability p\nINNER JOIN (\n    SELECT \n        d.oid\n    FROM \n        detection d\n    WHERE \n        d.fid = 1 -- g band filter\n        AND d.dubious = FALSE -- No dubious corrections\n    GROUP BY \n        d.oid\n    HAVING \n        COUNT(d.oid) >= 10 -- At least 10 detections\n) filtered_detections\nON \n    p.oid = filtered_detections.oid\nWHERE \n    p.ranking = 1 -- Only include probabilities with ranking 1\n    AND p.classifier_name = 'lc_classifier' -- Light curve classifier\nORDER BY \n    p.oid -- Order by ZTF identifier\nLIMIT 500; -- Limit to 500 results\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2930, "completion_tokens": 261, "total_tokens": 3191, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefe2bd481908a3318cb866f7cb3", "custom_id": "92-7", "response": {"status_code": 200, "request_id": "a4b3cc620ac8773fedd3fefa711ed588", "body": {"id": "chatcmpl-C6JohavzhFLIV7AeGj6Rw69L9mOLd", "object": "chat.completion", "created": 1755622179, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid,  -- ZTF identifier\n    p.classifier_version,  -- Classifier version\n    p.class_name,  -- Class name\n    p.probability  -- Probability\nFROM \n    object o\nINNER JOIN \n    (SELECT oid\n     FROM detection\n     WHERE fid = 1  -- g band\n       AND dubious = FALSE  -- No dubious corrections\n     GROUP BY oid\n     HAVING COUNT(oid) >= 10) d\nON o.oid = d.oid\nINNER JOIN \n    probability p\nON o.oid = p.oid\nWHERE \n    p.ranking = 1  -- Most likely probabilities\n    AND p.classifier_name = 'lc_classifier'  -- Light curve classifier\nORDER BY \n    o.oid ASC  -- Order by ZTF identifier\nLIMIT 500;  -- Limit to 500 results\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2788, "completion_tokens": 191, "total_tokens": 2979, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefe52bc8190bd44573e7c068b9b", "custom_id": "92-8", "response": {"status_code": 200, "request_id": "f2fd32fa6981798036087486554d33f9", "body": {"id": "chatcmpl-C6Joh3gFoLRD2REy9oP5wYD0362oi", "object": "chat.completion", "created": 1755622179, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find ZTF objects with at least 10 detections in the g band, no dubious corrections, and classification probabilities with ranking 1 for the light curve classifier\nSELECT \n    o.oid, \n    p.classifier_version, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    (SELECT oid\n     FROM detection\n     WHERE fid = 1 AND dubious = FALSE\n     GROUP BY oid\n     HAVING COUNT(oid) >= 10) d\nON o.oid = d.oid\nINNER JOIN \n    probability p\nON o.oid = p.oid\nWHERE \n    p.ranking = 1 \n    AND p.classifier_name = 'lc_classifier'\nORDER BY \n    o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3000, "completion_tokens": 172, "total_tokens": 3172, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefe459c8190aefbd62eb09b4206", "custom_id": "92-9", "response": {"status_code": 200, "request_id": "692dac974c40f2c9eb6787099b674e53", "body": {"id": "chatcmpl-C6JonEmEPydU0nxFwAIKxYJE4bSeO", "object": "chat.completion", "created": 1755622185, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    p.oid, \n    p.classifier_version, \n    p.class_name, \n    p.probability\nFROM \n    probability p\nINNER JOIN (\n    SELECT \n        d.oid\n    FROM \n        detection d\n    WHERE \n        d.fid = 1 -- g band\n        AND d.dubious = FALSE -- no dubious corrections\n    GROUP BY \n        d.oid\n    HAVING \n        COUNT(d.oid) >= 10 -- at least 10 detections\n) filtered_detections ON p.oid = filtered_detections.oid\nWHERE \n    p.ranking = 1 -- most likely class\n    AND p.classifier_name = 'lc_classifier' -- light curve classifier\nORDER BY \n    p.oid ASC\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2852, "completion_tokens": 172, "total_tokens": 3024, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4aefe743c81908ba5e3655952f1e2", "custom_id": "102-5", "response": {"status_code": 200, "request_id": "7dfc65f634dfe6308b403bdd70d825ca", "body": {"id": "chatcmpl-C6JokwPjeC2g5UKYtuuqVrfXULlX9", "object": "chat.completion", "created": 1755622182, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the conditions\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN allwise a ON p.oid = a.oid_catalog\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.6\n      AND a.w1mpro BETWEEN 12 AND 13\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2997, "completion_tokens": 117, "total_tokens": 3114, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4aefe4c648190851424d762428cfa", "custom_id": "102-6", "response": {"status_code": 200, "request_id": "9a2ff90d1a8482dffcac34f8fea24e42", "body": {"id": "chatcmpl-C6JoksiYdcBaNoGTAfJIUY81HGNAE", "object": "chat.completion", "created": 1755622182, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the given conditions\nSELECT magstat.*\nFROM probability\nINNER JOIN allwise ON probability.oid = allwise.oid_catalog\nINNER JOIN magstat ON probability.oid = magstat.oid\nWHERE probability.class_name = 'AGN'\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\n  AND probability.probability > 0.6\n  AND allwise.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3068, "completion_tokens": 116, "total_tokens": 3184, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4aefe71e88190a34cea6eeb664435", "custom_id": "102-7", "response": {"status_code": 200, "request_id": "e290990be0e11307bacc6503ff0de494", "body": {"id": "chatcmpl-C6JomUACfmTbvfLcMTI5moNeTlD5c", "object": "chat.completion", "created": 1755622184, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the given conditions\nSELECT magstat.*\nFROM probability\nINNER JOIN allwise ON probability.oid = allwise.oid_catalog\nINNER JOIN magstat ON probability.oid = magstat.oid\nWHERE probability.class_name = 'AGN'\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\n  AND probability.probability > 0.6\n  AND allwise.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3006, "completion_tokens": 116, "total_tokens": 3122, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefe8cec8190bdf0cb410c54a521", "custom_id": "102-8", "response": {"status_code": 200, "request_id": "4279ef07a42d7dfa79e0af6d2cb00ce9", "body": {"id": "chatcmpl-C6Jon2fU78cdr6B5cRsWeMGJ81TNP", "object": "chat.completion", "created": 1755622185, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the given conditions\nSELECT magstat.*\nFROM probability\nINNER JOIN allwise ON probability.oid = allwise.oid_catalog\nINNER JOIN magstat ON probability.oid = magstat.oid\nWHERE probability.class_name = 'AGN'\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\n  AND probability.probability > 0.6\n  AND allwise.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2975, "completion_tokens": 116, "total_tokens": 3091, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefeb104819094eb4ad5fd6f3e6f", "custom_id": "102-9", "response": {"status_code": 200, "request_id": "4813d1bf66506ef34555a91ce22e9450", "body": {"id": "chatcmpl-C6JooWZxp5lxrev1D7khTOhvRS24O", "object": "chat.completion", "created": 1755622186, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the conditions\nSELECT magstat.*\nFROM probability\nINNER JOIN allwise ON probability.oid = allwise.oid_catalog\nINNER JOIN magstat ON probability.oid = magstat.oid\nWHERE probability.ranking = 1\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.class_name = 'AGN'\n  AND probability.probability > 0.6\n  AND allwise.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2866, "completion_tokens": 115, "total_tokens": 2981, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeff1a4081908791d61e36d5a8bc", "custom_id": "104-5", "response": {"status_code": 200, "request_id": "bc5106b1e44f387aab26f7447dd6d445", "body": {"id": "chatcmpl-C6JoYN4lTz7IHQkomPkM0lOtoUxji", "object": "chat.completion", "created": 1755622170, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query to retrieve ZTF objects classified as asteroids with the specified conditions\nSELECT \n    p.oid AS ztf_object_id, \n    d.candid AS candidate_id, \n    ss.ssdistnr AS distance_to_nearest_sso, \n    ss.ssmagnr AS mpc_archive_magnitude, \n    ss.ssnamenr AS sso_name, \n    d.fid AS filter_id, \n    d.fwhm AS fwhm_sextractor, \n    d.ncalib AS ps1_calibrators_count, \n    d.exptime AS exposure_time\nFROM \n    probability p\nINNER JOIN \n    detection d ON p.oid = d.oid\nINNER JOIN \n    ss_ztf ss ON p.oid = ss.oid\nWHERE \n    p.classifier_name = 'stamp_classifier' \n    AND p.classifier_version = 'stamp_classifier_1.0.4' \n    AND p.class_name = 'asteroid' \n    AND p.probability > 0.9 \n    AND p.ranking = 1\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3213, "completion_tokens": 235, "total_tokens": 3448, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeff166c8190b08d6a257a01d94c", "custom_id": "104-6", "response": {"status_code": 200, "request_id": "7f100929b2528c9cbb9207439c954c28", "body": {"id": "chatcmpl-C6JoYO7nebCx3S6XGacWrIakYTVja", "object": "chat.completion", "created": 1755622170, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter the probability table for objects classified as 'asteroid' with the specified conditions\nWITH filtered_probability AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND class_name = 'asteroid'\n      AND probability > 0.9\n      AND ranking = 1\n),\n-- Step 2: Join with the ss_ztf table to retrieve Solar System object information\nss_ztf_info AS (\n    SELECT s.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr\n    FROM ss_ztf s\n    INNER JOIN filtered_probability fp ON s.oid = fp.oid\n),\n-- Step 3: Join with the detection table to retrieve candidate-related information\ndetection_info AS (\n    SELECT d.candid, d.fid, d.fwhm, d.ncalib, d.exptime\n    FROM detection d\n    INNER JOIN ss_ztf_info szi ON d.candid = szi.candid\n)\n-- Step 4: Combine the results and select the required columns\nSELECT \n    szi.oid AS ztf_identifier,\n    szi.candid AS candidate_identifier,\n    szi.ssdistnr AS distance_to_nearest_solar_system_object,\n    szi.ssmagnr AS mpc_archive_magnitude,\n    szi.ssnamenr AS solar_system_object_name,\n    di.fid AS filter_identifier,\n    di.fwhm AS fwhm_from_sextractor,\n    di.ncalib AS number_of_ps1_calibrators_used,\n    di.exptime AS exposure_time\nFROM ss_ztf_info szi\nINNER JOIN detection_info di ON szi.candid = di.candid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3097, "completion_tokens": 391, "total_tokens": 3488, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeff090c8190ba70e302b7514606", "custom_id": "104-7", "response": {"status_code": 200, "request_id": "4366017c6a3f119ae2bd51dc4bcba1a1", "body": {"id": "chatcmpl-C6Joas1Sk9BIlwonnvmz8EWJmYc8G", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter the probability table for asteroid classification\nWITH filtered_probability AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND class_name = 'asteroid'\n      AND probability > 0.9\n      AND ranking = 1\n),\n\n-- Step 2: Join with the ss_ztf table to retrieve Solar System object information\nss_ztf_info AS (\n    SELECT ss.oid, ss.candid, ss.ssdistnr, ss.ssmagnr, ss.ssnamenr\n    FROM ss_ztf AS ss\n    INNER JOIN filtered_probability AS fp\n    ON ss.oid = fp.oid\n),\n\n-- Step 3: Join with the detection table to retrieve candidate-related information\ndetection_info AS (\n    SELECT d.candid, d.fid, d.fwhm, d.ncalib, d.exptime\n    FROM detection AS d\n    INNER JOIN ss_ztf_info AS si\n    ON d.candid = si.candid\n)\n\n-- Step 4: Combine the results and limit the output\nSELECT si.oid, si.candid, si.ssdistnr, si.ssmagnr, si.ssnamenr, \n       di.fid, di.fwhm, di.ncalib, di.exptime\nFROM ss_ztf_info AS si\nINNER JOIN detection_info AS di\nON si.candid = di.candid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3229, "completion_tokens": 325, "total_tokens": 3554, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeff252481909f04dbb4e6c968a9", "custom_id": "104-8", "response": {"status_code": 200, "request_id": "0383fb2061ce52a74c4c4ec6a1834386", "body": {"id": "chatcmpl-C6JoYcbeBWWdrWwFtN7VJyE8zwWiN", "object": "chat.completion", "created": 1755622170, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve ZTF objects classified as asteroids with the specified conditions\nSELECT \n    ss_ztf.oid, \n    ss_ztf.candid, \n    ss_ztf.ssdistnr, \n    ss_ztf.ssmagnr, \n    ss_ztf.ssnamenr, \n    detection.fid, \n    detection.fwhm, \n    detection.ncalib, \n    detection.exptime\nFROM \n    (SELECT oid \n     FROM probability \n     WHERE \n         probability.classifier_name = 'stamp_classifier' AND \n         probability.classifier_version = 'stamp_classifier_1.0.4' AND \n         probability.class_name = 'asteroid' AND \n         probability.probability > 0.9 AND \n         probability.ranking = 1\n    ) AS filtered_probabilities\nINNER JOIN ss_ztf \n    ON filtered_probabilities.oid = ss_ztf.oid\nINNER JOIN detection \n    ON ss_ztf.candid = detection.candid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3247, "completion_tokens": 224, "total_tokens": 3471, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeff3d888190a2158ce9b45feded", "custom_id": "104-9", "response": {"status_code": 200, "request_id": "4b3a1dd1a7925c551d1f5c5618fde7c3", "body": {"id": "chatcmpl-C6JoZFIdTV15vpEWtv7CbwQgQjmCt", "object": "chat.completion", "created": 1755622171, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter the probability table for ZTF objects classified as asteroids with a probability > 0.9\n-- Step 2: Join with the ss_ztf table to retrieve Solar System object information\n-- Step 3: Join with the detection table to retrieve candidate-related information\n-- Step 4: Limit the results to at most 30 objects\n\nSELECT \n    ss_ztf.oid, -- Identifier of the ZTF object\n    ss_ztf.candid, -- Unique candidate identifier\n    ss_ztf.ssdistnr, -- Distance to the nearest Solar System object\n    ss_ztf.ssmagnr, -- MPC archive magnitude of the nearest Solar System object\n    ss_ztf.ssnamenr, -- Name of the nearest Solar System object\n    detection.fid, -- Filter identifier\n    detection.fwhm, -- FWHM from SExtractor\n    detection.ncalib, -- Number of PS1 calibrators used\n    detection.exptime -- Exposure time\nFROM \n    (SELECT oid \n     FROM probability\n     WHERE \n         classifier_name = 'stamp_classifier' AND \n         classifier_version = 'stamp_classifier_1.0.4' AND \n         class_name = 'asteroid' AND \n         probability > 0.9 AND \n         ranking = 1) AS filtered_probabilities\nINNER JOIN ss_ztf \n    ON filtered_probabilities.oid = ss_ztf.oid\nINNER JOIN detection \n    ON ss_ztf.oid = detection.oid AND ss_ztf.candid = detection.candid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3390, "completion_tokens": 341, "total_tokens": 3731, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeff46408190bdf9221258ac8d37", "custom_id": "107-5", "response": {"status_code": 200, "request_id": "39efa8332ccd9260d6f85ed6b0fe7413", "body": {"id": "chatcmpl-C6JocXYra5E1Ss0jHcjpCKbU1VKBT", "object": "chat.completion", "created": 1755622174, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query to retrieve ZTF objects satisfying the specified conditions\nSELECT \n    obj.oid AS ztf_identifier, \n    obj.ndet AS number_of_detections, \n    obj.firstmjd AS first_detection_date, \n    obj.lastmjd AS last_detection_date, \n    prob.probability AS classification_probability, \n    ss.candid AS candidate_identifier, \n    ss.ssdistnr AS distance_to_mpc_object, \n    ss.ssnamenr AS mpc_name, \n    det.mjd AS detection_date, \n    det.fid AS filter_identifier\nFROM \n    object obj\nINNER JOIN \n    probability prob\n    ON obj.oid = prob.oid\nINNER JOIN \n    ss_ztf ss\n    ON obj.oid = ss.oid\nINNER JOIN \n    detection det\n    ON obj.oid = det.oid\nWHERE \n    obj.ndet > 500 -- Objects with more than 500 detections\n    AND prob.class_name = 'asteroid' -- Classified as asteroid\n    AND prob.classifier_name = 'stamp_classifier' -- Using stamp classifier\n    AND prob.classifier_version = 'stamp_classifier_1.0.4' -- Specific classifier version\n    AND prob.probability > 0.5 -- Probability greater than 0.5\n    AND prob.ranking = 1 -- Most likely classification\n    AND ss.ssdistnr < 2 -- Distance to nearest Solar System object below 2 arcsec\nORDER BY \n    obj.firstmjd ASC -- Order by first detection date\nLIMIT 10; -- Limit results to at most 10\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3170, "completion_tokens": 342, "total_tokens": 3512, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeff53f08190bd5a789fac0156fb", "custom_id": "107-6", "response": {"status_code": 200, "request_id": "26429d0b6c121876cb611fea2b197baa", "body": {"id": "chatcmpl-C6JodHEcRdmgjwWAvchXf399R8C3g", "object": "chat.completion", "created": 1755622175, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT \n        o.oid, \n        o.ndet, \n        o.firstmjd, \n        o.lastmjd\n    FROM \n        object o\n    WHERE \n        o.ndet > 500\n),\nfiltered_probabilities AS (\n    SELECT \n        p.oid, \n        p.probability\n    FROM \n        probability p\n    WHERE \n        p.class_name = 'asteroid' \n        AND p.classifier_name = 'stamp_classifier' \n        AND p.classifier_version = 'stamp_classifier_1.0.4' \n        AND p.probability > 0.5 \n        AND p.ranking = 1\n),\nfiltered_ss_ztf AS (\n    SELECT \n        s.oid, \n        s.candid, \n        s.ssdistnr, \n        s.ssnamenr\n    FROM \n        ss_ztf s\n    WHERE \n        s.ssdistnr < 2\n),\nfiltered_detections AS (\n    SELECT \n        d.oid, \n        d.mjd, \n        d.fid\n    FROM \n        detection d\n)\nSELECT \n    fo.oid AS ztf_identifier, \n    fo.ndet AS number_of_detections, \n    fo.firstmjd AS first_detection_date, \n    fo.lastmjd AS last_detection_date, \n    fp.probability, \n    fs.candid AS candidate_identifier, \n    fs.ssdistnr AS distance_to_mpc_object, \n    fs.ssnamenr AS mpc_name, \n    fd.mjd AS detection_date, \n    fd.fid AS filter_identifier\nFROM \n    filtered_objects fo\nINNER JOIN \n    filtered_probabilities fp ON fo.oid = fp.oid\nINNER JOIN \n    filtered_ss_ztf fs ON fo.oid = fs.oid\nINNER JOIN \n    filtered_detections fd ON fo.oid = fd.oid\nORDER BY \n    fo.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3203, "completion_tokens": 423, "total_tokens": 3626, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeff6c888190813203d21d67a326", "custom_id": "107-7", "response": {"status_code": 200, "request_id": "b68b79bc480ae54fce6782fa3e9b9113", "body": {"id": "chatcmpl-C6JofVtzYUdtv3Uu4GtXxO6cFk5Ji", "object": "chat.completion", "created": 1755622177, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT \n        o.oid, \n        o.ndet, \n        o.firstmjd, \n        o.lastmjd\n    FROM \n        object o\n    WHERE \n        o.ndet > 500\n),\nfiltered_probabilities AS (\n    SELECT \n        p.oid, \n        p.probability\n    FROM \n        probability p\n    WHERE \n        p.class_name = 'asteroid' \n        AND p.classifier_name = 'stamp_classifier' \n        AND p.classifier_version = 'stamp_classifier_1.0.4' \n        AND p.probability > 0.5 \n        AND p.ranking = 1\n),\nfiltered_ss_ztf AS (\n    SELECT \n        d.oid, \n        d.candid, \n        d.ssdistnr, \n        d.ssnamenr\n    FROM \n        detection d\n    WHERE \n        d.ssdistnr < 2\n),\ncombined_results AS (\n    SELECT \n        fo.oid, \n        fo.ndet, \n        fo.firstmjd, \n        fo.lastmjd, \n        fp.probability, \n        ssztf.candid, \n        ssztf.ssdistnr, \n        ssztf.ssnamenr\n    FROM \n        filtered_objects fo\n    INNER JOIN \n        filtered_probabilities fp \n        ON fo.oid = fp.oid\n    INNER JOIN \n        filtered_ss_ztf ssztf \n        ON fo.oid = ssztf.oid\n),\nfinal_results AS (\n    SELECT \n        cr.oid, \n        cr.ndet, \n        cr.firstmjd, \n        cr.lastmjd, \n        cr.probability, \n        cr.candid, \n        cr.ssdistnr, \n        cr.ssnamenr, \n        d.mjd, \n        d.fid\n    FROM \n        combined_results cr\n    INNER JOIN \n        detection d \n        ON cr.oid = d.oid\n)\nSELECT \n    oid AS ztf_identifier, \n    ndet AS number_of_detections, \n    firstmjd AS first_detection_date, \n    lastmjd AS last_detection_date, \n    probability, \n    candid AS candidate_identifier, \n    ssdistnr AS distance_to_mpc_object, \n    ssnamenr AS mpc_name, \n    mjd AS detection_date, \n    fid AS filter_identifier\nFROM \n    final_results\nORDER BY \n    first_detection_date ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3782, "completion_tokens": 536, "total_tokens": 4318, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeff6c788190ba8a73783a24e710", "custom_id": "107-8", "response": {"status_code": 200, "request_id": "ecbd35085dee5b155d323f528af8ef61", "body": {"id": "chatcmpl-C6Johu8rrUTXHbJw4fj0IEIMvDw26", "object": "chat.completion", "created": 1755622179, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    o.firstmjd AS first_detection_date,\n    o.lastmjd AS last_detection_date,\n    p.probability,\n    s.candid AS candidate_identifier,\n    s.ssdistnr AS distance_to_mpc_object,\n    s.ssnamenr AS mpc_name,\n    d.mjd AS detection_date,\n    d.fid AS filter_identifier\nFROM \n    object o\nINNER JOIN \n    probability p\n    ON o.oid = p.oid\nINNER JOIN \n    ss_ztf s\n    ON o.oid = s.oid\nINNER JOIN \n    detection d\n    ON o.oid = d.oid\nWHERE \n    o.ndet > 500\n    AND p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.probability > 0.5\n    AND s.ssdistnr < 2\nORDER BY \n    o.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3676, "completion_tokens": 245, "total_tokens": 3921, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4aeffa50c8190986fa9884f501229", "custom_id": "107-9", "response": {"status_code": 200, "request_id": "78085d6e9f40e2e10ef1fe9147dab064", "body": {"id": "chatcmpl-C6JoiH5wfNPrNwZvnPaeA365NEBnR", "object": "chat.completion", "created": 1755622180, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT \n        object.oid, \n        object.ndet, \n        object.firstmjd, \n        object.lastmjd\n    FROM \n        object\n    WHERE \n        object.ndet > 500\n),\nfiltered_probabilities AS (\n    SELECT \n        probability.oid, \n        probability.probability\n    FROM \n        probability\n    WHERE \n        probability.class_name = 'asteroid'\n        AND probability.classifier_name = 'stamp_classifier'\n        AND probability.classifier_version = 'stamp_classifier_1.0.4'\n        AND probability.probability > 0.5\n        AND probability.ranking = 1\n),\nfiltered_ss_ztf AS (\n    SELECT \n        ss_ztf.oid, \n        ss_ztf.candid, \n        ss_ztf.ssdistnr, \n        ss_ztf.ssnamenr\n    FROM \n        ss_ztf\n    WHERE \n        ss_ztf.ssdistnr < 2\n),\nfiltered_detections AS (\n    SELECT \n        detection.oid, \n        detection.mjd, \n        detection.fid\n    FROM \n        detection\n)\nSELECT \n    filtered_objects.oid AS ztf_identifier,\n    filtered_objects.ndet AS number_of_detections,\n    filtered_objects.firstmjd AS first_detection_date,\n    filtered_objects.lastmjd AS last_detection_date,\n    filtered_probabilities.probability AS classification_probability,\n    filtered_ss_ztf.candid AS candidate_identifier,\n    filtered_ss_ztf.ssdistnr AS distance_to_mpc_object,\n    filtered_ss_ztf.ssnamenr AS mpc_name,\n    filtered_detections.mjd AS detection_date,\n    filtered_detections.fid AS filter_identifier\nFROM \n    filtered_objects\nINNER JOIN \n    filtered_probabilities\nON \n    filtered_objects.oid = filtered_probabilities.oid\nINNER JOIN \n    filtered_ss_ztf\nON \n    filtered_objects.oid = filtered_ss_ztf.oid\nINNER JOIN \n    filtered_detections\nON \n    filtered_objects.oid = filtered_detections.oid\nORDER BY \n    filtered_objects.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3188, "completion_tokens": 467, "total_tokens": 3655, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aeffe37c8190919327b6e0af3f33", "custom_id": "84-5", "response": {"status_code": 200, "request_id": "0075a249b9c962773bf368cbf2fdee6d", "body": {"id": "chatcmpl-C6K4RyEjhXwomE8qgJT2ox7AXm4ln", "object": "chat.completion", "created": 1755623155, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)\nSELECT \n    object.oid AS ztf_oid, -- Identifier of the ZTF object\n    xmatch.oid_catalog AS allwise_oid, -- Identifier of the ALLWISE counterpart\n    xmatch.dist AS distance, -- Distance between the ZTF object and the ALLWISE counterpart\n    allwise.w1mpro, -- Magnitude in WISE filter W1\n    allwise.w2mpro, -- Magnitude in WISE filter W2\n    allwise.w3mpro, -- Magnitude in WISE filter W3\n    allwise.w4mpro -- Magnitude in WISE filter W4\nFROM \n    object\nINNER JOIN \n    xmatch ON object.oid = xmatch.oid -- Join to find ALLWISE counterparts\nINNER JOIN \n    allwise ON xmatch.oid_catalog = allwise.oid_catalog -- Join to retrieve ALLWISE information\nWHERE \n    object.oid = 'ZTF19aascdol'; -- Filter for the specific ZTF object\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2897, "completion_tokens": 236, "total_tokens": 3133, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4aefff2dc81909081150f52936fec", "custom_id": "84-6", "response": {"status_code": 200, "request_id": "abe41f44a4d8fb5823f6cca10a419d62", "body": {"id": "chatcmpl-C6JoiBtOsLGEosLR7qTw8Od94Aqdf", "object": "chat.completion", "created": 1755622180, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve the requested information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)\nSELECT \n    o.oid AS ztf_oid, -- Identifier in ZTF\n    a.oid_catalog AS allwise_oid, -- Identifier in ALLWISE\n    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS distance, -- Distance between counterparts\n    a.w1mpro AS W1, -- Magnitude in WISE W1 filter\n    a.w2mpro AS W2, -- Magnitude in WISE W2 filter\n    a.w3mpro AS W3, -- Magnitude in WISE W3 filter\n    a.w4mpro AS W4 -- Magnitude in WISE W4 filter\nFROM \n    object o\nINNER JOIN \n    allwise a\nON \n    q3c_join(o.meanra, o.meandec, a.ra, a.dec, 0.00138889) -- Spatial cross-match with a 5 arcsecond radius\nWHERE \n    o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF object\nORDER BY \n    distance ASC; -- Sort by distance to prioritize closest matches\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3065, "completion_tokens": 267, "total_tokens": 3332, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af000e008190a6e73b9f08e6555a", "custom_id": "84-7", "response": {"status_code": 200, "request_id": "2695bccf129c424358429fa2be96b9cd", "body": {"id": "chatcmpl-C6JomnIk1VuUtreqkGOO8vPW7exNp", "object": "chat.completion", "created": 1755622184, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)\nSELECT \n    xmatch.oid AS ztf_oid, -- Identifier of the ZTF object\n    allwise.oid_catalog AS allwise_oid, -- Identifier of the ALLWISE counterpart\n    xmatch.dist AS distance, -- Distance between the ZTF object and the ALLWISE counterpart\n    allwise.w1mpro AS W1, -- Magnitude in WISE filter W1\n    allwise.w2mpro AS W2, -- Magnitude in WISE filter W2\n    allwise.w3mpro AS W3, -- Magnitude in WISE filter W3\n    allwise.w4mpro AS W4 -- Magnitude in WISE filter W4\nFROM \n    xmatch\nINNER JOIN \n    allwise ON xmatch.oid_catalog = allwise.oid_catalog -- Join to get ALLWISE information\nWHERE \n    xmatch.oid = 'ZTF19aascdol'; -- Filter for the specific ZTF object\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2689, "completion_tokens": 228, "total_tokens": 2917, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af00016881909d4157a03a24bda4", "custom_id": "84-8", "response": {"status_code": 200, "request_id": "9b7003d2666edd1a6bdc5179652a3cb3", "body": {"id": "chatcmpl-C6JonqopeuTJQf9CpeWHFzgSMYJzx", "object": "chat.completion", "created": 1755622185, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)\nSELECT \n    o.oid AS ztf_oid, -- ZTF object identifier\n    a.oid_catalog AS allwise_oid, -- ALLWISE catalog identifier\n    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS distance, -- Distance between counterparts\n    a.w1mpro, -- Magnitude in WISE W1 filter\n    a.w2mpro, -- Magnitude in WISE W2 filter\n    a.w3mpro, -- Magnitude in WISE W3 filter\n    a.w4mpro -- Magnitude in WISE W4 filter\nFROM \n    object o\nINNER JOIN \n    allwise a\nON \n    q3c_join(o.meanra, o.meandec, a.ra, a.dec, 0.00139) -- Cross-match within 5 arcseconds (0.00139 degrees)\nWHERE \n    o.oid = 'ZTF19aascdol'; -- Filter for the specific ZTF object\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2991, "completion_tokens": 239, "total_tokens": 3230, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4af0023e88190b9c4caebd1f3c0a3", "custom_id": "84-9", "response": {"status_code": 200, "request_id": "06830f11fe9fde9ee90934b8f27ad98c", "body": {"id": "chatcmpl-C6JooisuA60UPbAU95keuZ2IOM7pw", "object": "chat.completion", "created": 1755622186, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT \n    object.oid AS ztf_oid, \n    allwise.oid_catalog AS allwise_oid, \n    q3c_dist(object.meanra, object.meandec, allwise.ra, allwise.dec) AS distance, \n    allwise.w1mpro, \n    allwise.w2mpro, \n    allwise.w3mpro, \n    allwise.w4mpro\nFROM \n    object\nINNER JOIN \n    xmatch ON object.oid = xmatch.ztf_oid\nINNER JOIN \n    allwise ON xmatch.allwise_oid = allwise.oid_catalog\nWHERE \n    object.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3062, "completion_tokens": 150, "total_tokens": 3212, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af0023d48190b2664c6ce4aea16b", "custom_id": "96-5", "response": {"status_code": 200, "request_id": "cf52ffac7e2478a0bcd7228e28101396", "body": {"id": "chatcmpl-C6JorWSUYcriaxVMvDcpHR4AY7oED", "object": "chat.completion", "created": 1755622189, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nWITH ss_objects AS (\n    -- Step 1: Filter the ss_ztf table for the specified Solar System identifiers\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n),\ndetections_within_2arcsec AS (\n    -- Step 2: Retrieve detections within 2 arcseconds of the Solar System identifiers\n    SELECT \n        d.*,\n        ss.*\n    FROM detection d\n    INNER JOIN ss_objects ss ON d.oid = ss.oid\n    WHERE q3c_radial_query(d.ra, d.dec, ss.ra, ss.dec, 2/3600.0) -- 2 arcseconds converted to degrees\n)\n-- Step 3: Select the required columns and sort the results\nSELECT \n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_identifier,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM detections_within_2arcsec d\nORDER BY ss.ssnamenr ASC, d.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2895, "completion_tokens": 247, "total_tokens": 3142, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af0036188190b6d808812c2e383a", "custom_id": "96-6", "response": {"status_code": 200, "request_id": "aff1b843e0496f895c229f565b8432f9", "body": {"id": "chatcmpl-C6JoqyLoUxIw5tpeNNmqV5qgkMNu9", "object": "chat.completion", "created": 1755622188, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'\nSELECT \n    ss_ztf.*, -- All columns from the ss_ztf table\n    detection.mjd, -- Detection date\n    detection.fid, -- Filter identifier\n    detection.isdiffpos, -- Is difference positive flag\n    detection.ra, -- Right Ascension\n    detection.dec, -- Declination\n    detection.magpsf, -- Difference magnitude\n    detection.sigmapsf -- Difference magnitude uncertainty\nFROM \n    ss_ztf\nINNER JOIN \n    detection ON ss_ztf.oid = detection.oid -- Join on object identifier\nWHERE \n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System identifiers\n    AND q3c_radial_query(ss_ztf.ra, ss_ztf.dec, detection.ra, detection.dec, 2/3600.0) -- Spatial query for 2 arcseconds\nORDER BY \n    ss_ztf.ssnamenr, -- Sort by Solar System object name\n    detection.mjd; -- Sort by detection date\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 259, "total_tokens": 2876, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af0051e881908f18d45d3757db85", "custom_id": "96-7", "response": {"status_code": 200, "request_id": "361a75c06a86223d98efc23fc10dcdb8", "body": {"id": "chatcmpl-C6Jot6iTasumSQdYCLl0EP5uRLC4B", "object": "chat.completion", "created": 1755622191, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT \n    ss_ztf.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra,\n    detection.dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM \n    ss_ztf\nINNER JOIN \n    detection \nON \n    ss_ztf.oid = detection.oid\nWHERE \n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\n    AND q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra, ss_ztf.dec, 0.0005556)\nORDER BY \n    ss_ztf.ssnamenr ASC, \n    detection.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3033, "completion_tokens": 160, "total_tokens": 3193, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af006c2c8190b38319dd2aeba685", "custom_id": "96-8", "response": {"status_code": 200, "request_id": "faa6a59eec15e68b262f47a2670af2ec", "body": {"id": "chatcmpl-C6JosKC41ZPOBG8WR41MaRwvBazJM", "object": "chat.completion", "created": 1755622190, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT \n    ss_ztf.*, \n    detection.mjd, \n    detection.fid, \n    detection.isdiffpos, \n    detection.ra, \n    detection.dec, \n    detection.magpsf, \n    detection.sigmapsf\nFROM \n    ss_ztf\nINNER JOIN \n    detection \nON \n    ss_ztf.oid = detection.oid\nWHERE \n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\n    AND q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra, ss_ztf.dec, 2/3600.0)\nORDER BY \n    ss_ztf.ssnamenr, \n    detection.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2876, "completion_tokens": 165, "total_tokens": 3041, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af009ef88190be4fb82672ba2306", "custom_id": "96-9", "response": {"status_code": 200, "request_id": "e5596ee27b626d2a8d59f7547d64afda", "body": {"id": "chatcmpl-C6JovpXUclSl2ch1y4TV597Gilu2t", "object": "chat.completion", "created": 1755622193, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'\nSELECT \n    ss_ztf.*, -- All columns from the 'ss_ztf' table\n    detection.mjd, -- Detection date\n    detection.fid, -- Filter identifier\n    detection.isdiffpos, -- Is difference positive flag\n    detection.ra, -- Right Ascension\n    detection.dec, -- Declination\n    detection.magpsf, -- Difference magnitude\n    detection.sigmapsf -- Difference magnitude uncertainty\nFROM \n    ss_ztf\nINNER JOIN \n    detection ON ss_ztf.oid = detection.oid -- Join on object identifier\nWHERE \n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System identifiers\n    AND q3c_radial_query(ss_ztf.ra, ss_ztf.dec, detection.ra, detection.dec, 0.0005556) -- Spatial query for 2 arcseconds proximity\nORDER BY \n    ss_ztf.ssnamenr, -- Sort by Solar System object name\n    detection.mjd; -- Sort by detection date\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2587, "completion_tokens": 261, "total_tokens": 2848, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af00d180819088721dc2abe2ea0d", "custom_id": "94-5", "response": {"status_code": 200, "request_id": "7a0673194eda1240c010a17660ea65f5", "body": {"id": "chatcmpl-C6JoaAwBd0E34Kblpw6mZ5yJVfgzV", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects that had a change in the reference\n-- Limit the result to at most 50 rows\n\nSELECT *\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2473, "completion_tokens": 69, "total_tokens": 2542, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af028cf88190974fcf4b625083ab", "custom_id": "94-6", "response": {"status_code": 200, "request_id": "8486b3e0e1525cd1a6933f90d42986c7", "body": {"id": "chatcmpl-C6Joakq9U6LNzTxmwYl0VAWK3XeER", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from 'object' and 'reference' tables for ZTF objects with a reference change, limited to 50 rows\nSELECT *\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2369, "completion_tokens": 60, "total_tokens": 2429, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af00e5b08190873b76cb8a076693", "custom_id": "94-7", "response": {"status_code": 200, "request_id": "dc17fd875bbcdf46bdd21b71ed32ff5f", "body": {"id": "chatcmpl-C6JoevRPpvqbQWoybpVyn89YWZaWs", "object": "chat.completion", "created": 1755622176, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve all columns from 'object' and 'reference' tables for ZTF objects with a reference change, limited to 50 rows\nSELECT *\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2466, "completion_tokens": 62, "total_tokens": 2528, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af010ba881908e0177da4c42c256", "custom_id": "94-8", "response": {"status_code": 200, "request_id": "b86ebdf99b124fbcb6a7f9eda0c04b4c", "body": {"id": "chatcmpl-C6JolN3FyRkn9ZedhJwGZK9zONeLM", "object": "chat.completion", "created": 1755622183, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve all columns from 'object' and 'reference' tables for ZTF objects with a change in the reference\n-- Limited to 50 rows\nSELECT *\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2389, "completion_tokens": 65, "total_tokens": 2454, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af0112d48190a9abac34b44d0df1", "custom_id": "94-9", "response": {"status_code": 200, "request_id": "cbfab1f48dc73ba3e97f02df951f9749", "body": {"id": "chatcmpl-C6JoaQmtrzwPbeUA5bNeu8jk4b9nb", "object": "chat.completion", "created": 1755622172, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from 'object' and 'reference' tables for ZTF objects with a change in the reference\n-- Limit the result to 50 rows\nSELECT *\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2413, "completion_tokens": 65, "total_tokens": 2478, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af00f730819087cbf34ba934e639", "custom_id": "90-5", "response": {"status_code": 200, "request_id": "0fc49fa7302e0a23e40c963102ab6d49", "body": {"id": "chatcmpl-C6K4RyOukeSR6MfArgdumqUz7sNW6", "object": "chat.completion", "created": 1755623155, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 100 ZTF objects with a multiband period lower than 5 days\n-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table\n-- for the light curve classifier with rankings either 1 or 2.\n\nSELECT p.*\nFROM probability p\nINNER JOIN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n) f ON p.oid = f.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2868, "completion_tokens": 157, "total_tokens": 3025, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af011ba481909095ff2f08cbdc4c", "custom_id": "90-6", "response": {"status_code": 200, "request_id": "dc5f52e1b11f1ad9670947887dd9a4f7", "body": {"id": "chatcmpl-C6JoevkdgG6W3Sa57IOIFOpdHOTGj", "object": "chat.completion", "created": 1755622176, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 100 ZTF objects with a multiband period lower than 5 days\n-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table\n-- for the light curve classifier with rankings 1 or 2.\n\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3081, "completion_tokens": 140, "total_tokens": 3221, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4af01249881908115257ab7914fe9", "custom_id": "90-7", "response": {"status_code": 200, "request_id": "c68bda85094113ccddb3cd6d2aedf733", "body": {"id": "chatcmpl-C6JojIEzA05voiiiWNBQxmRnqANMY", "object": "chat.completion", "created": 1755622181, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM probability\nWHERE classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\n  AND oid IN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n  )\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2956, "completion_tokens": 79, "total_tokens": 3035, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af0153088190adc4dbecdfdcacde", "custom_id": "90-8", "response": {"status_code": 200, "request_id": "71fde1e16229afe888ce13e97d422d98", "body": {"id": "chatcmpl-C6Jonm8fP0LsFuWUo6KUFTIg1tkKc", "object": "chat.completion", "created": 1755622185, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM probability\nWHERE oid IN (\n    SELECT oid \n    FROM feature\n    WHERE name = 'Multiband_period' \n      AND value < 5 \n      AND version = 'lc_classifier_1.2.1-P'\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2866, "completion_tokens": 77, "total_tokens": 2943, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af027f548190b73c6481c754a6f5", "custom_id": "90-9", "response": {"status_code": 200, "request_id": "0faa2c5eefba0435f43a06cc2ac3593e", "body": {"id": "chatcmpl-C6JoneQ3do9S9Iei58K1op54JFBOo", "object": "chat.completion", "created": 1755622185, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*\nFROM probability p\nINNER JOIN (\n    SELECT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = 'lc_classifier_1.2.1-P'\n) filtered_features ON p.oid = filtered_features.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2732, "completion_tokens": 99, "total_tokens": 2831, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af028770819086d8db396c29da15", "custom_id": "100-5", "response": {"status_code": 200, "request_id": "6f4fc84b2b143bd7ea88eff95b0423a2", "body": {"id": "chatcmpl-C6JooyxsPHOP9klt7m6MJOzug7INv", "object": "chat.completion", "created": 1755622186, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    magpsf, \n    sigmapsf, \n    diffmaglim, \n    NULL AS mag, \n    NULL AS e_mag, \n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    NULL AS isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    NULL AS mag, \n    NULL AS e_mag, \n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    mag, \n    e_mag, \n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3655, "completion_tokens": 302, "total_tokens": 3957, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4af02abd081909f70d276e2b7bab1", "custom_id": "100-6", "response": {"status_code": 200, "request_id": "10e5004dfa2275f18d9fa4074380be6f", "body": {"id": "chatcmpl-C6JoqBEI4UWpW6Gs4yPw9JmCXWcYo", "object": "chat.completion", "created": 1755622188, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\n-- The query combines data from the detection, non_detection, and forced_photometry tables into a single output table.\n\nSELECT \n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    magpsf,\n    sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid,\n    mjd,\n    fid,\n    NULL AS isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    diffmaglim,\n    NULL AS mag,\n    NULL AS e_mag,\n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    NULL AS magpsf,\n    NULL AS sigmapsf,\n    NULL AS diffmaglim,\n    mag,\n    e_mag,\n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3615, "completion_tokens": 301, "total_tokens": 3916, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af02ca6c819092549e29bef81d8a", "custom_id": "100-7", "response": {"status_code": 200, "request_id": "395664b22b63e042b594441c092755dd", "body": {"id": "chatcmpl-C6Jot5UoIPB9nBse2i3jOW9EMtqAq", "object": "chat.completion", "created": 1755622191, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    isdiffpos AS isdiffpos_flag,\n    magpsf AS detection_difference_magnitude,\n    sigmapsf AS detection_difference_magnitude_uncertainty,\n    diffmaglim AS five_sigma_magnitude_limit,\n    NULL AS forced_difference_magnitude,\n    NULL AS forced_difference_magnitude_uncertainty,\n    'detection' AS table\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    NULL AS isdiffpos_flag,\n    NULL AS detection_difference_magnitude,\n    NULL AS detection_difference_magnitude_uncertainty,\n    diffmaglim AS five_sigma_magnitude_limit,\n    NULL AS forced_difference_magnitude,\n    NULL AS forced_difference_magnitude_uncertainty,\n    'non_detection' AS table\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    isdiffpos AS isdiffpos_flag,\n    NULL AS detection_difference_magnitude,\n    NULL AS detection_difference_magnitude_uncertainty,\n    diffmaglim AS five_sigma_magnitude_limit,\n    mag AS forced_difference_magnitude,\n    e_mag AS forced_difference_magnitude_uncertainty,\n    'forced_photometry' AS table\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY epoch_date;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3468, "completion_tokens": 371, "total_tokens": 3839, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4af02cfa881908e3cb0b714e572fb", "custom_id": "100-8", "response": {"status_code": 200, "request_id": "d5573c721817a6e871809257a49dc17b", "body": {"id": "chatcmpl-C6JoxMbjvM4WlUZ4QQ5CFtxZUQQ5f", "object": "chat.completion", "created": 1755622195, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    magpsf, \n    sigmapsf, \n    diffmaglim, \n    mag_corr, \n    e_mag_corr, \n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    NULL AS isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    NULL AS mag_corr, \n    NULL AS e_mag_corr, \n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    mag_corr, \n    e_mag_corr, \n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3631, "completion_tokens": 304, "total_tokens": 3935, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af02d9148190be16c08161978f97", "custom_id": "100-9", "response": {"status_code": 200, "request_id": "8db92e204fc8792fda85de4947e5e26e", "body": {"id": "chatcmpl-C6Jp1qkcJvwd51JxQUX2uimyGExj1", "object": "chat.completion", "created": 1755622199, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    magpsf AS \"detection difference magnitude\",\n    sigmapsf AS \"detection difference magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced difference magnitude uncertainty\",\n    'detection' AS \"table\"\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    NULL AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"detection difference magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    NULL AS \"forced difference magnitude\",\n    NULL AS \"forced difference magnitude uncertainty\",\n    'non_detection' AS \"table\"\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid AS \"ZTF identifier\",\n    mjd AS \"epoch date\",\n    fid AS \"filter identifier\",\n    isdiffpos AS \"isdiffpos flag\",\n    NULL AS \"detection difference magnitude\",\n    NULL AS \"detection difference magnitude uncertainty\",\n    diffmaglim AS \"5-sigma magnitude limit\",\n    mag AS \"forced difference magnitude\",\n    e_mag AS \"forced difference magnitude uncertainty\",\n    'forced_photometry' AS \"table\"\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY \"epoch date\";\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3641, "completion_tokens": 384, "total_tokens": 4025, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af02d8408190b84f2e6dcfd39e19", "custom_id": "106-5", "response": {"status_code": 200, "request_id": "78c7f3827962e726fcde9c7671285aba", "body": {"id": "chatcmpl-C6JotyjJkIOFaIrI8TCFuAGzwimH5", "object": "chat.completion", "created": 1755622191, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH object_filter AS (\n    SELECT oid, ndet, firstmjd\n    FROM object\n    WHERE ndet > 10\n),\nstamp_classifier_filter AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE class_name = 'bogus'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n),\nlc_classifier_filter AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n)\nSELECT o.oid, o.ndet, o.firstmjd, s.prob_stamp_bogus, l.prob_lc_transient\nFROM object_filter o\nINNER JOIN stamp_classifier_filter s ON o.oid = s.oid\nINNER JOIN lc_classifier_filter l ON o.oid = l.oid\nORDER BY s.prob_stamp_bogus DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3840, "completion_tokens": 226, "total_tokens": 4066, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af02e458819082d7547fe6d2f794", "custom_id": "106-6", "response": {"status_code": 200, "request_id": "19eb7822833b9d6eb65595232ed29fcd", "body": {"id": "chatcmpl-C6Jp66pg3WdeljluRuqNejdBeF9YM", "object": "chat.completion", "created": 1755622204, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects with more than 10 detections\nWITH filtered_objects AS (\n    SELECT oid, ndet, firstmjd\n    FROM object\n    WHERE ndet > 10\n),\n\n-- Step 2: Filter probabilities for the stamp classifier\nstamp_classifier AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'bogus'\n      AND probability > 0.7\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND ranking = 1\n),\n\n-- Step 3: Filter probabilities for the light curve classifier top level\nlc_classifier_top AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_top'\n      AND class_name = 'Transient'\n      AND probability > 0.9\n      AND ranking = 1\n)\n\n-- Step 4: Combine the results and select the required columns\nSELECT \n    fo.oid,\n    fo.ndet,\n    fo.firstmjd,\n    sc.prob_stamp_bogus,\n    lc.prob_lc_transient\nFROM filtered_objects fo\nINNER JOIN stamp_classifier sc ON fo.oid = sc.oid\nINNER JOIN lc_classifier_top lc ON fo.oid = lc.oid\nORDER BY sc.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3211, "completion_tokens": 295, "total_tokens": 3506, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4af03041c81908f839498e21cf51e", "custom_id": "106-7", "response": {"status_code": 200, "request_id": "e149bca62cb9e548b3b5b97cb7465512", "body": {"id": "chatcmpl-C6JpBN1Hj2FqLWKaCFRf4rJ5Ke6h4", "object": "chat.completion", "created": 1755622209, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery 1: Filter objects with more than 10 detections\nWITH object_filter AS (\n    SELECT oid, ndet, firstmjd\n    FROM object\n    WHERE ndet > 10\n),\n\n-- Subquery 2: Filter probabilities for 'bogus' in the stamp classifier\nstamp_classifier_filter AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE class_name = 'bogus'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n),\n\n-- Subquery 3: Filter probabilities for 'Transient' in the light curve classifier top level\nlc_classifier_filter AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n)\n\n-- Final Query: Join the subqueries and apply sorting and limit\nSELECT \n    obj.oid,\n    obj.ndet,\n    obj.firstmjd,\n    stamp.prob_stamp_bogus,\n    lc.prob_lc_transient\nFROM object_filter obj\nINNER JOIN stamp_classifier_filter stamp ON obj.oid = stamp.oid\nINNER JOIN lc_classifier_filter lc ON obj.oid = lc.oid\nORDER BY stamp.prob_stamp_bogus DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3798, "completion_tokens": 300, "total_tokens": 4098, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af0370ec81909293ab0be983460e", "custom_id": "106-8", "response": {"status_code": 200, "request_id": "ec9f444ade40f0decddfd19fe4804389", "body": {"id": "chatcmpl-C6JovSUhnsL1lUIdx36RWvqymVg1D", "object": "chat.completion", "created": 1755622193, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects with more than 10 detections\nWITH filtered_objects AS (\n    SELECT oid, ndet, firstmjd\n    FROM object\n    WHERE ndet > 10\n),\n\n-- Step 2: Filter probabilities for the stamp classifier\nstamp_classifier AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'bogus'\n      AND probability > 0.7\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND ranking = 1\n),\n\n-- Step 3: Filter probabilities for the light curve classifier top level\nlc_classifier_top AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_top'\n      AND class_name = 'Transient'\n      AND probability > 0.9\n      AND ranking = 1\n)\n\n-- Step 4: Combine results using INNER JOINs\nSELECT \n    fo.oid,\n    fo.ndet,\n    fo.firstmjd,\n    sc.prob_stamp_bogus,\n    lc.prob_lc_transient\nFROM filtered_objects fo\nINNER JOIN stamp_classifier sc ON fo.oid = sc.oid\nINNER JOIN lc_classifier_top lc ON fo.oid = lc.oid\nORDER BY fo.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3350, "completion_tokens": 293, "total_tokens": 3643, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4af037cac8190a2b24e8faa5ab249", "custom_id": "106-9", "response": {"status_code": 200, "request_id": "64d9fd1db6e75d576a5d033de0e1b4b6", "body": {"id": "chatcmpl-C6K4RmIhthnAxCRZu3enBbPplv384", "object": "chat.completion", "created": 1755623155, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects with more than 10 detections\nWITH filtered_objects AS (\n    SELECT oid, ndet, firstmjd\n    FROM object\n    WHERE ndet > 10\n),\n-- Step 2: Filter probabilities for the stamp classifier\nstamp_classifier AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'bogus'\n      AND probability > 0.7\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND ranking = 1\n),\n-- Step 3: Filter probabilities for the light curve classifier top level\nlc_classifier_top AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_top'\n      AND class_name = 'Transient'\n      AND probability > 0.9\n      AND ranking = 1\n)\n-- Step 4: Combine the filters using INNER JOINs\nSELECT \n    fo.oid,\n    fo.ndet,\n    fo.firstmjd,\n    sc.prob_stamp_bogus,\n    lc.prob_lc_transient\nFROM filtered_objects fo\nINNER JOIN stamp_classifier sc ON fo.oid = sc.oid\nINNER JOIN lc_classifier_top lc ON fo.oid = lc.oid\n-- Step 5: Order the results by the ZTF identifier of objects classified as bogus in the stamp classifier\nORDER BY fo.oid\n-- Step 6: Limit the number of results to 30\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3271, "completion_tokens": 331, "total_tokens": 3602, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af0382648190be70692884aa3d0e", "custom_id": "39-5", "response": {"status_code": 200, "request_id": "145b0445897192233951ee64c2cf0249", "body": {"id": "chatcmpl-C6JozshgDiGvaSVmeOW6xV765WVOJ", "object": "chat.completion", "created": 1755622197, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery 1: Filter objects classified as 'CV/Nova' by the 'lc_classifier_stochastic' classifier with ranking = 1\nWITH classified_objects AS (\n    SELECT \n        oid\n    FROM \n        probability\n    WHERE \n        class_name = 'CV/Nova'\n        AND classifier_name = 'lc_classifier_stochastic'\n        AND ranking = 1\n),\n\n-- Subquery 2: Filter objects with ndet <= 50 from the object table\nfiltered_objects AS (\n    SELECT \n        oid\n    FROM \n        object\n    WHERE \n        ndet <= 50\n),\n\n-- Subquery 3: Filter detections in the r-band (fid = 2) and calculate the maximum rise in PSF corrected magnitude\nr_band_detections AS (\n    SELECT \n        oid,\n        candid,\n        fid,\n        ra,\n        dec,\n        magpsf,\n        sigmapsf,\n        magpsf_corr,\n        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise\n    FROM \n        detection\n    WHERE \n        fid = 2\n    GROUP BY \n        oid, candid, fid, ra, dec, magpsf, sigmapsf, magpsf_corr\n)\n\n-- Final Query: Combine the subqueries and retrieve the required columns\nSELECT \n    r.oid,\n    r.candid,\n    r.fid AS f_id,\n    r.ra,\n    r.dec,\n    r.magpsf,\n    r.sigmapsf,\n    r.magpsf_corr,\n    r.max_rise\nFROM \n    r_band_detections r\nINNER JOIN \n    classified_objects c ON r.oid = c.oid\nINNER JOIN \n    filtered_objects f ON r.oid = f.oid\nORDER BY \n    r.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3310, "completion_tokens": 386, "total_tokens": 3696, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af03acd48190b1b7ed1fc9ce1fe3", "custom_id": "39-6", "response": {"status_code": 200, "request_id": "a003539f82254d70e4afea685fffcc96", "body": {"id": "chatcmpl-C6JpOaeOWam6TLX3t2qme0MX9pXGT", "object": "chat.completion", "created": 1755622222, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nWITH classification_filter AS (\n    SELECT \n        oid\n    FROM \n        probability\n    WHERE \n        ranking = 1\n        AND classifier_name = 'lc_classifier_stochastic'\n        AND class_name = 'CV/Nova'\n),\nobject_filter AS (\n    SELECT \n        oid\n    FROM \n        object\n    WHERE \n        ndet <= 50\n),\ndetection_filter AS (\n    SELECT \n        oid,\n        candid,\n        fid AS f_id,\n        ra,\n        dec,\n        magpsf,\n        sigmapsf,\n        magpsf_corr\n    FROM \n        detection\n    WHERE \n        fid = 2 -- r-band filter\n),\nmax_rise_calculation AS (\n    SELECT \n        oid,\n        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise\n    FROM \n        detection\n    WHERE \n        fid = 2 -- r-band filter\n    GROUP BY \n        oid\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    mrc.max_rise\nFROM \n    detection_filter d\nINNER JOIN \n    classification_filter cf ON d.oid = cf.oid\nINNER JOIN \n    object_filter of ON d.oid = of.oid\nINNER JOIN \n    max_rise_calculation mrc ON d.oid = mrc.oid\nORDER BY \n    d.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3451, "completion_tokens": 330, "total_tokens": 3781, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af03f0748190bda3df9165b3f298", "custom_id": "39-7", "response": {"status_code": 200, "request_id": "ef340811a62aa89e51d11ee85b5eda8c", "body": {"id": "chatcmpl-C6JpSmdtoxIYAcf8O0MSryW7TQIlh", "object": "chat.completion", "created": 1755622226, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT \n    obj.oid AS object_identifier,\n    det.candid AS candidate_identifier,\n    det.fid AS f_id,\n    det.ra AS coordinates_ra,\n    det.dec AS coordinates_dec,\n    det.magpsf AS magnitude,\n    det.sigmapsf AS magnitude_errors,\n    det.magpsf_corr AS corrected_difference_magnitude_r_band,\n    (MAX(det.magpsf_corr) - MIN(det.magpsf_corr)) AS max_rise_from_minimum\nFROM \n    object obj\nINNER JOIN \n    probability prob\n    ON obj.oid = prob.oid\nINNER JOIN \n    detection det\n    ON obj.oid = det.oid\nWHERE \n    prob.class_name = 'CV/Nova'\n    AND prob.ranking = 1\n    AND prob.classifier_name = 'lc_classifier_stochastic'\n    AND obj.ndet <= 50\n    AND det.fid = 2\nGROUP BY \n    obj.oid, det.candid, det.fid, det.ra, det.dec, det.magpsf, det.sigmapsf, det.magpsf_corr\nORDER BY \n    obj.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3426, "completion_tokens": 247, "total_tokens": 3673, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_68a4af03a224819092b2860195781bec", "custom_id": "39-8", "response": {"status_code": 200, "request_id": "d6f1bf9b441129f903e2326cf0a4c669", "body": {"id": "chatcmpl-C6JpWkQPGaTTZ75yIzUCbhh7K5bIO", "object": "chat.completion", "created": 1755622230, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nWITH classified_objects AS (\n    SELECT \n        p.oid\n    FROM \n        probability p\n    WHERE \n        p.ranking = 1\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.class_name = 'CV/Nova'\n),\nfiltered_objects AS (\n    SELECT \n        o.oid\n    FROM \n        object o\n    INNER JOIN \n        classified_objects co\n    ON \n        o.oid = co.oid\n    WHERE \n        o.ndet <= 50\n),\nr_band_detections AS (\n    SELECT \n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.magpsf_corr\n    FROM \n        detection d\n    INNER JOIN \n        filtered_objects fo\n    ON \n        d.oid = fo.oid\n    WHERE \n        d.fid = 2\n),\nmax_rise_calculation AS (\n    SELECT \n        oid,\n        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise\n    FROM \n        r_band_detections\n    GROUP BY \n        oid\n)\nSELECT \n    rbd.oid,\n    rbd.candid,\n    rbd.f_id,\n    rbd.ra,\n    rbd.dec,\n    rbd.magpsf,\n    rbd.sigmapsf,\n    rbd.magpsf_corr,\n    mrc.max_rise\nFROM \n    r_band_detections rbd\nINNER JOIN \n    max_rise_calculation mrc\nON \n    rbd.oid = mrc.oid\nORDER BY \n    rbd.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3486, "completion_tokens": 372, "total_tokens": 3858, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_6bdaf6345e"}}, "error": null}
{"id": "batch_req_68a4af03a1d081909a30422a4bccc62e", "custom_id": "39-9", "response": {"status_code": 200, "request_id": "2699fb87b8d41321664c9b5f2f5cf7aa", "body": {"id": "chatcmpl-C6Jozms1S0T8QXelsEFcLqQGfmWqz", "object": "chat.completion", "created": 1755622197, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery 1: Filter objects classified as 'CV/Nova' by the 'lc_classifier_stochastic' classifier with ranking = 1\nWITH classified_objects AS (\n    SELECT \n        p.oid\n    FROM \n        probability p\n    WHERE \n        p.class_name = 'CV/Nova'\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.ranking = 1\n),\n\n-- Subquery 2: Filter detections in the r-band filter (fid = 2) and calculate the maximum rise in magnitude\nr_band_detections AS (\n    SELECT \n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.magpsf_corr,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS max_rise\n    FROM \n        detection d\n    WHERE \n        d.fid = 2 -- r-band filter\n    GROUP BY \n        d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n),\n\n-- Subquery 3: Filter objects with a number of detections (ndet) of at most 50\nfiltered_objects AS (\n    SELECT \n        o.oid\n    FROM \n        object o\n    WHERE \n        o.ndet <= 50\n)\n\n-- Final Query: Combine all subqueries and retrieve the required columns\nSELECT \n    r.oid,\n    r.candid,\n    r.f_id,\n    r.ra,\n    r.dec,\n    r.magpsf,\n    r.sigmapsf,\n    r.magpsf_corr,\n    r.max_rise\nFROM \n    r_band_detections r\nINNER JOIN \n    classified_objects c ON r.oid = c.oid\nINNER JOIN \n    filtered_objects f ON r.oid = f.oid\nORDER BY \n    r.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3365, "completion_tokens": 430, "total_tokens": 3795, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
