{"id": "batch_req_689e3368dc308190ab993b7e23077905", "custom_id": "8-0", "response": {"status_code": 200, "request_id": "9f722e87d9294f22e4cca2caa2b105bd", "body": {"id": "chatcmpl-C4XIv3iHCzOkIdt66ARNpCi8kn7Rq", "object": "chat.completion", "created": 1755197369, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object o\nLEFT JOIN probability p ON o.oid = p.oid\nWHERE \n    -- Time range condition\n    o.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND (\n        -- Classification conditions\n        (p.class_name = 'SN' \n         AND p.classifier_name = 'stamp_classifier' \n         AND p.probability > 0.5\n         AND p.ranking = 1)\n        OR\n        -- Detection condition\n        o.ndet >= 2\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2909, "completion_tokens": 118, "total_tokens": 3027, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3368e71c81909c2973347a72ecd3", "custom_id": "8-1", "response": {"status_code": 200, "request_id": "3f23db895f9d35b87dd704711a1c9d3e", "body": {"id": "chatcmpl-C4XK1sOQo4wQ0z7CScQ7p4h31YvJo", "object": "chat.completion", "created": 1755197437, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n    (\n        (probability.classifier_name = 'stamp_classifier' \n         AND probability.class_name = 'SN' \n         AND probability.probability > 0.5)\n        OR object.ndet >= 2\n    )\n    AND object.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND probability.ranking = 1; -- Ensures only the most likely probabilities are considered\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2952, "completion_tokens": 110, "total_tokens": 3062, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3368dd2481909b4339e7b6cbca90", "custom_id": "8-2", "response": {"status_code": 200, "request_id": "b5dcf8c74b0f0a7c5f0f50093a121bec", "body": {"id": "chatcmpl-C4XK2ZFoaSviwLKQstquGHYOtCqNT", "object": "chat.completion", "created": 1755197438, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object o\nLEFT JOIN probability p\nON o.oid = p.oid\nWHERE \n    (\n        (p.classifier_name = 'stamp_classifier' AND \n         p.class_name = 'SN' AND \n         p.probability > 0.5 AND \n         p.ranking = 1)\n        OR \n        (o.ndet >= 2)\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2870, "completion_tokens": 104, "total_tokens": 2974, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3368dc44819085cb5c9e22bb8160", "custom_id": "8-3", "response": {"status_code": 200, "request_id": "58ce860b4ca4307128d1db119abd5460", "body": {"id": "chatcmpl-C4XK1pwSzUvShyWrt4qSQAhjDNQYr", "object": "chat.completion", "created": 1755197437, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE probability.class_name = 'SN' -- classified as 'SN'\n  AND probability.classifier_name = 'stamp_classifier' -- classified by the stamp classifier\n  AND probability.ranking = 1 -- only the most likely classification\n  AND object.firstmjd BETWEEN 60173.0 AND 60177.0 -- first detection between August 17 and August 21\n  AND (probability.probability > 0.5 OR object.ndet >= 2); -- probability > 0.5 OR at least 2 detections\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2729, "completion_tokens": 134, "total_tokens": 2863, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3368e18c8190b80567967da2c5c0", "custom_id": "8-4", "response": {"status_code": 200, "request_id": "79c34b06cda37bb40b68c4ebf0796615", "body": {"id": "chatcmpl-C4XIvWxkaft9mA2o4yW72GwgALqQP", "object": "chat.completion", "created": 1755197369, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n    (\n        (probability.classifier_name = 'stamp_classifier' \n         AND probability.class_name = 'SN' \n         AND probability.probability > 0.5)\n        OR object.ndet >= 2\n    )\n    AND object.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND probability.ranking = 1; -- Default condition for probability table\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2804, "completion_tokens": 106, "total_tokens": 2910, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3368d5788190821dad30fa2fba2e", "custom_id": "27-0", "response": {"status_code": 200, "request_id": "6591d6670380e35c326f0e8dcca85a4b", "body": {"id": "chatcmpl-C4XIvwAOEMeG33nfey9AxGSQj6YA3", "object": "chat.completion", "created": 1755197369, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability\nON \n    object.oid = probability.oid\nWHERE \n    probability.ranking = 1 -- Only the most likely probabilities\n    AND probability.classifier_name = 'lc_classifier' -- Use the light curve classifier\n    AND probability.class_name = 'CEP' -- Most likely to be Cepheid\n    AND probability.probability > 0.76 -- Probability larger than 0.76\n    AND object.ndet >= 100; -- Objects with 100 or more detections\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2592, "completion_tokens": 190, "total_tokens": 2782, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3368ddf48190a53e79826c7dd96c", "custom_id": "27-1", "response": {"status_code": 200, "request_id": "9c11c6f33182e30a79a189baa8b7bfcd", "body": {"id": "chatcmpl-C4XIvIYv6cxwMuO3gX6vMTNTvxpto", "object": "chat.completion", "created": 1755197369, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability\nON \n    object.oid = probability.oid\nWHERE \n    object.ndet >= 100\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1\n    AND probability.class_name = 'CEP'\n    AND probability.probability > 0.76;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2690, "completion_tokens": 151, "total_tokens": 2841, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3368d92c8190b62358d60acbe152", "custom_id": "27-2", "response": {"status_code": 200, "request_id": "c64111dbeab232e7b063cd87347ac2a6", "body": {"id": "chatcmpl-C4XJ0mFGLRvM86qcIQzeO05ZT6pUA", "object": "chat.completion", "created": 1755197374, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability \nON \n    object.oid = probability.oid\nWHERE \n    object.ndet >= 100\n    AND probability.class_name = 'CEP'\n    AND probability.probability > 0.76\n    AND probability.ranking = 1\n    AND probability.classifier_name = 'lc_classifier';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2761, "completion_tokens": 151, "total_tokens": 2912, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e33691a0c8190a6ff0f33b4eb9b01", "custom_id": "27-3", "response": {"status_code": 200, "request_id": "be8422fcf9bbe7b966d155dbf34dcba2", "body": {"id": "chatcmpl-C4XJ0eCAjLCNzUho4IqdKnPQpnu2e", "object": "chat.completion", "created": 1755197374, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability \nON \n    object.oid = probability.oid\nWHERE \n    object.ndet >= 100\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.class_name = 'CEP'\n    AND probability.ranking = 1\n    AND probability.probability > 0.76;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2882, "completion_tokens": 151, "total_tokens": 3033, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3368d2b8819083087e700222c85d", "custom_id": "27-4", "response": {"status_code": 200, "request_id": "4b86139d053ca4a92ab489b6d7c06aea", "body": {"id": "chatcmpl-C4XJ0JCzjtRdIFDqTgrLShel9KVVe", "object": "chat.completion", "created": 1755197374, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability\nON \n    object.oid = probability.oid\nWHERE \n    probability.ranking = 1 -- Default condition to get the most likely probabilities\n    AND probability.classifier_name = 'lc_classifier' -- Default condition to use the light curve classifier\n    AND probability.class_name = 'CEP' -- User-specified condition for Cepheid classification\n    AND probability.probability > 0.76 -- User-specified condition for probability threshold\n    AND object.ndet >= 100 -- User-specified condition for number of detections\nORDER BY \n    probability.probability DESC; -- Optional: Order by probability in descending order\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2540, "completion_tokens": 218, "total_tokens": 2758, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336995d081908a1e18d1de0b9d0e", "custom_id": "17-0", "response": {"status_code": 200, "request_id": "b0b36b82137764b7990fd42fc74aca13", "body": {"id": "chatcmpl-C4XJ0WhKF4lcVmzsPoHlkJ84neQE3", "object": "chat.completion", "created": 1755197374, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n),\n\n-- Step 2: Identify objects showing variability in the r band\nvariability_r_band AS (\n    SELECT DISTINCT feature.oid\n    FROM feature\n    INNER JOIN agn_objects ON feature.oid = agn_objects.oid\n    WHERE feature.name = 'ExcessVar'\n      AND feature.fid = 2\n      AND feature.value > 0\n),\n\n-- Step 3: Identify objects with no detections or no variability in the g band\nno_variability_g_band AS (\n    SELECT DISTINCT feature.oid\n    FROM feature\n    INNER JOIN agn_objects ON feature.oid = agn_objects.oid\n    WHERE feature.name = 'ExcessVar'\n      AND feature.fid = 1\n      AND feature.value <= 0\n),\nno_detections_g_band AS (\n    SELECT DISTINCT agn_objects.oid\n    FROM agn_objects\n    LEFT JOIN detection ON agn_objects.oid = detection.oid AND detection.fid = 1\n    WHERE detection.oid IS NULL\n),\nno_g_band_objects AS (\n    SELECT oid\n    FROM no_variability_g_band\n    UNION\n    SELECT oid\n    FROM no_detections_g_band\n),\n\n-- Step 4: Combine results to find objects satisfying both conditions\nfiltered_objects AS (\n    SELECT oid\n    FROM variability_r_band\n    INTERSECT\n    SELECT oid\n    FROM no_g_band_objects\n)\n\n-- Step 5: Retrieve features for the filtered objects and order results\nSELECT feature.*\nFROM feature\nINNER JOIN filtered_objects ON feature.oid = filtered_objects.oid\nORDER BY feature.value ASC, feature.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3054, "completion_tokens": 393, "total_tokens": 3447, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3369bb5081909e8c9ddd0f9ddac1", "custom_id": "17-1", "response": {"status_code": 200, "request_id": "fba351174e9ae4e2fdb60b09107c9695", "body": {"id": "chatcmpl-C4XJ1vj1GRazlAixS3fPIYX2qr2ni", "object": "chat.completion", "created": 1755197375, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Identify objects showing variability in the r band\nr_band_variability AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE fid = 2 -- r band\n      AND (feature_name = 'Amplitude' AND value > 0\n           OR feature_name = 'ExcessVar' AND value > 0)\n),\n\n-- Step 3: Exclude objects with detections or variability in the g band\ng_band_exclusions AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE fid = 1 -- g band\n      AND (feature_name = 'Amplitude' AND value > 0\n           OR feature_name = 'n_det' AND value > 0)\n),\n\n-- Step 4: Combine AGN objects with r band variability and exclude g band detections/variability\nfiltered_objects AS (\n    SELECT oid\n    FROM agn_objects\n    INNER JOIN r_band_variability USING (oid)\n    WHERE oid NOT IN (SELECT oid FROM g_band_exclusions)\n)\n\n-- Step 5: Retrieve features and order by value and oid\nSELECT *\nFROM feature\nWHERE oid IN (SELECT oid FROM filtered_objects)\nORDER BY value ASC, oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3105, "completion_tokens": 300, "total_tokens": 3405, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e33699df4819095c8876c8624eb4c", "custom_id": "17-2", "response": {"status_code": 200, "request_id": "8b9e3cb27d2a3920962a425112dd0510", "body": {"id": "chatcmpl-C4XJ4ayZcgEbdOEsnedGgpdHpz2BT", "object": "chat.completion", "created": 1755197378, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n),\n\n-- Step 2: Identify objects showing variability in the r band\nvariability_r_band AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE fid = 2 -- r band\n      AND value > 0 -- Variability feature greater than 0\n),\n\n-- Step 3: Identify objects with no detections or no variability in the g band\nno_detections_or_no_variability_g_band AS (\n    SELECT DISTINCT oid\n    FROM feature\n    WHERE fid = 1 -- g band\n      AND (name = 'n_det' AND value = 0 -- No detections\n           OR name IN ('Std', 'ExcessVar') AND value = 0) -- No variability\n),\n\n-- Step 4: Combine the results\nfiltered_objects AS (\n    SELECT oid\n    FROM agn_objects\n    INTERSECT\n    SELECT oid\n    FROM variability_r_band\n    INTERSECT\n    SELECT oid\n    FROM no_detections_or_no_variability_g_band\n)\n\n-- Step 5: Retrieve features and order by their value\nSELECT f.*\nFROM feature f\nINNER JOIN filtered_objects fo ON f.oid = fo.oid\nORDER BY f.value ASC, f.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3132, "completion_tokens": 308, "total_tokens": 3440, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3369a07081909595c84652e5fe06", "custom_id": "17-3", "response": {"status_code": 200, "request_id": "7f78e1f21f04c5b7515fcd8e33c8195a", "body": {"id": "chatcmpl-C4XJ45Mb5a8sRQYXojCx96eSYuFGd", "object": "chat.completion", "created": 1755197378, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Step 2: Identify objects showing variability in the r band\nvariability_r_band AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_objects ao ON f.oid = ao.oid\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 2 -- r band\n      AND f.value > 0\n),\n\n-- Step 3: Identify objects with no variability in the g band\nno_variability_g_band AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_objects ao ON f.oid = ao.oid\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 1 -- g band\n      AND f.value = 0\n),\n\n-- Step 3.2: Identify objects with no detections in the g band\nno_detections_g_band AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    INNER JOIN agn_objects ao ON d.oid = ao.oid\n    WHERE d.fid = 1 -- g band\n    GROUP BY d.oid\n    HAVING COUNT(*) = 0\n),\n\n-- Step 4: Combine results from Steps 3 and 3.2\nno_variability_or_detections_g_band AS (\n    SELECT oid FROM no_variability_g_band\n    UNION\n    SELECT oid FROM no_detections_g_band\n),\n\n-- Step 5: Combine results from Steps 2 and 4\nfiltered_objects AS (\n    SELECT oid\n    FROM variability_r_band\n    INTERSECT\n    SELECT oid\n    FROM no_variability_or_detections_g_band\n),\n\n-- Step 6: Retrieve features for the filtered objects\nfeatures_for_filtered_objects AS (\n    SELECT f.oid, f.name, f.value\n    FROM feature f\n    INNER JOIN filtered_objects fo ON f.oid = fo.oid\n)\n\n-- Step 7: Order features by their value and final query by oid\nSELECT *\nFROM features_for_filtered_objects\nORDER BY oid, value ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3171, "completion_tokens": 484, "total_tokens": 3655, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336a248081908f2a7736ae40556d", "custom_id": "17-4", "response": {"status_code": 200, "request_id": "c417950442fd716d8e1ae28bb553d9d6", "body": {"id": "chatcmpl-C4XJ5abpii3TWj6mecq3LsR6iES6i", "object": "chat.completion", "created": 1755197379, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n),\n\n-- Step 2: Identify objects showing variability in the r band\nr_band_variability AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_objects ao ON f.oid = ao.oid\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 2\n      AND f.value > 0\n),\n\n-- Step 3: Identify objects with no detections or no variability in the g band\ng_band_no_variability AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    INNER JOIN agn_objects ao ON f.oid = ao.oid\n    WHERE f.name = 'ExcessVar'\n      AND f.fid = 1\n      AND f.value <= 0\n),\ng_band_no_detections AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    INNER JOIN agn_objects ao ON d.oid = ao.oid\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(d.oid) = 0\n),\n\n-- Combine results for g band conditions\ng_band_conditions AS (\n    SELECT oid FROM g_band_no_variability\n    UNION\n    SELECT oid FROM g_band_no_detections\n),\n\n-- Step 4: Combine results from r band variability and g band conditions\nfinal_objects AS (\n    SELECT oid\n    FROM r_band_variability\n    INTERSECT\n    SELECT oid\n    FROM g_band_conditions\n)\n\n-- Step 5: Retrieve features and order by their value\nSELECT f.*\nFROM feature f\nINNER JOIN final_objects fo ON f.oid = fo.oid\nORDER BY f.value ASC, f.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3198, "completion_tokens": 408, "total_tokens": 3606, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e33699fc481909c59a2ae173eb283", "custom_id": "1-0", "response": {"status_code": 200, "request_id": "1b0e5fb4d39f3eb96dae81278aeee1c2", "body": {"id": "chatcmpl-C4XJ5bluh5Xc9yuHLOdIEGTROthWs", "object": "chat.completion", "created": 1755197379, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    -- Step 1: Filter objects classified as AGN with a probability larger than 0.6\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\nlight_curve_objects AS (\n    -- Step 2: Filter objects with light curves covering at least one year\n    SELECT oid\n    FROM object\n    WHERE (lastmjd - firstmjd) >= 365\n),\ndetections_objects AS (\n    -- Step 3: Filter objects with at least 20 detections in at least one band\n    SELECT DISTINCT oid\n    FROM detection\n    WHERE ndet >= 20\n),\nmagnitude_variation_g AS (\n    -- Step 4.1: Filter objects with variations larger than 1 magnitude in the g band\n    SELECT oid\n    FROM detection\n    WHERE fid = 1\n    GROUP BY oid\n    HAVING (MAX(magpsf_corr) - MIN(magpsf_corr)) > 1\n),\nmagnitude_variation_r AS (\n    -- Step 4.2: Filter objects with variations larger than 0.5 magnitude in the r band\n    SELECT oid\n    FROM detection\n    WHERE fid = 2\n    GROUP BY oid\n    HAVING (MAX(magpsf_corr) - MIN(magpsf_corr)) > 0.5\n),\nfiltered_objects AS (\n    -- Combine all conditions\n    SELECT DISTINCT o.oid\n    FROM agn_objects o\n    INNER JOIN light_curve_objects lc ON o.oid = lc.oid\n    INNER JOIN detections_objects d ON o.oid = d.oid\n    INNER JOIN magnitude_variation_g g ON o.oid = g.oid\n    INNER JOIN magnitude_variation_r r ON o.oid = r.oid\n),\nfeature_data AS (\n    -- Retrieve feature data for filtered objects\n    SELECT f.oid, f.name, f.value, f.version, f.fid AS feature_fid\n    FROM feature f\n    INNER JOIN filtered_objects fo ON f.oid = fo.oid\n),\ndetection_data AS (\n    -- Retrieve detection data for filtered objects\n    SELECT d.oid, \n           d.fid AS detection_fid,\n           MAX(d.magpsf_corr) AS max_mag,\n           MIN(d.magpsf_corr) AS min_mag,\n           (MAX(d.magpsf_corr) - MIN(d.magpsf_corr)) AS delta_mag\n    FROM detection d\n    INNER JOIN filtered_objects fo ON d.oid = fo.oid\n    GROUP BY d.oid, d.fid\n)\n-- Final query: Combine all data and retrieve required columns\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       f.name,\n       f.value,\n       f.version,\n       f.feature_fid,\n       d.detection_fid,\n       d.max_mag,\n       d.min_mag,\n       d.delta_mag\nFROM object o\nINNER JOIN filtered_objects fo ON o.oid = fo.oid\nINNER JOIN feature_data f ON o.oid = f.oid\nINNER JOIN detection_data d ON o.oid = d.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3634, "completion_tokens": 688, "total_tokens": 4322, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3369aa448190a60e1eb267f1b5a2", "custom_id": "1-1", "response": {"status_code": 200, "request_id": "1dc75ecc3a16e5ae445a3743ca401260", "body": {"id": "chatcmpl-C4XJ61kSNBHqJapwa9q6A05jI73X2", "object": "chat.completion", "created": 1755197380, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    SELECT \n        p.oid\n    FROM \n        probability p\n    WHERE \n        p.class_name = 'AGN'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.probability > 0.6\n),\nlight_curve_objects AS (\n    SELECT \n        o.oid\n    FROM \n        object o\n    WHERE \n        (o.lastmjd - o.firstmjd) >= 365\n),\ndetections_objects AS (\n    SELECT \n        DISTINCT f.oid\n    FROM \n        feature f\n    WHERE \n        f.name = 'n_det'\n        AND f.value >= 20\n),\ng_band_variations AS (\n    SELECT \n        d.oid,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_g\n    FROM \n        detection d\n    WHERE \n        d.fid = 1\n    GROUP BY \n        d.oid\n    HAVING \n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) > 1\n),\nr_band_variations AS (\n    SELECT \n        d.oid,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_r\n    FROM \n        detection d\n    WHERE \n        d.fid = 2\n    GROUP BY \n        d.oid\n    HAVING \n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) > 0.5\n),\nfiltered_objects AS (\n    SELECT \n        o.oid\n    FROM \n        agn_objects o\n    INNER JOIN \n        light_curve_objects lc ON o.oid = lc.oid\n    INNER JOIN \n        detections_objects d ON o.oid = d.oid\n    INNER JOIN \n        g_band_variations g ON o.oid = g.oid\n    INNER JOIN \n        r_band_variations r ON o.oid = r.oid\n)\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    f.name,\n    f.value,\n    f.version,\n    f.fid AS feature_fid,\n    g.delta_mag_g,\n    r.delta_mag_r\nFROM \n    filtered_objects fo\nINNER JOIN \n    object o ON fo.oid = o.oid\nINNER JOIN \n    feature f ON fo.oid = f.oid\nLEFT JOIN \n    g_band_variations g ON fo.oid = g.oid\nLEFT JOIN \n    r_band_variations r ON fo.oid = r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3565, "completion_tokens": 551, "total_tokens": 4116, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3369953c8190b93f74709066bf17", "custom_id": "1-2", "response": {"status_code": 200, "request_id": "f11617841386ac9f796ebf370a6323d1", "body": {"id": "chatcmpl-C4XJ8mMgufFmWzqvdLoHYEvqJQHTp", "object": "chat.completion", "created": 1755197382, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    -- Step 1: Filter objects classified as AGN with a probability > 0.6\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\nlight_curve_span AS (\n    -- Step 2: Filter objects with light curves covering at least one year\n    SELECT oid\n    FROM object\n    WHERE (lastmjd - firstmjd) >= 365\n),\ndetections_per_band AS (\n    -- Step 3: Filter objects with at least 20 detections in at least one band\n    SELECT oid\n    FROM detection\n    GROUP BY oid, fid\n    HAVING COUNT(candid) >= 20\n),\ng_band_variation AS (\n    -- Step 4.1: Filter objects with variations > 1 magnitude in the g band (fid = 1)\n    SELECT oid\n    FROM detection\n    WHERE fid = 1\n    GROUP BY oid\n    HAVING (MAX(magpsf_corr) - MIN(magpsf_corr)) > 1\n),\nr_band_variation AS (\n    -- Step 4.2: Filter objects with variations > 0.5 magnitude in the r band (fid = 2)\n    SELECT oid\n    FROM detection\n    WHERE fid = 2\n    GROUP BY oid\n    HAVING (MAX(magpsf_corr) - MIN(magpsf_corr)) > 0.5\n),\nfiltered_objects AS (\n    -- Step 5: Combine all filters to retrieve the final list of objects\n    SELECT oid\n    FROM agn_objects\n    INTERSECT\n    SELECT oid FROM light_curve_span\n    INTERSECT\n    SELECT oid FROM detections_per_band\n    INTERSECT\n    SELECT oid FROM g_band_variation\n    INTERSECT\n    SELECT oid FROM r_band_variation\n),\ng_band_features AS (\n    -- Step 6.1: Retrieve g band features (fid = 1)\n    SELECT\n        oid,\n        'g_band' AS name,\n        MAX(magpsf_corr) AS max_mag,\n        MIN(magpsf_corr) AS min_mag,\n        (MAX(magpsf_corr) - MIN(magpsf_corr)) AS delta_mag,\n        1 AS detection_fid\n    FROM detection\n    WHERE fid = 1\n    GROUP BY oid\n),\nr_band_features AS (\n    -- Step 6.2: Retrieve r band features (fid = 2)\n    SELECT\n        oid,\n        'r_band' AS name,\n        MAX(magpsf_corr) AS max_mag,\n        MIN(magpsf_corr) AS min_mag,\n        (MAX(magpsf_corr) - MIN(magpsf_corr)) AS delta_mag,\n        2 AS detection_fid\n    FROM detection\n    WHERE fid = 2\n    GROUP BY oid\n)\n-- Step 7: Retrieve the required information for the selected objects\nSELECT\n    o.oid,\n    f.name,\n    f.value,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    d.min_mag,\n    d.max_mag,\n    d.delta_mag\nFROM filtered_objects fo\nINNER JOIN object o ON fo.oid = o.oid\nINNER JOIN feature f ON fo.oid = f.oid\nINNER JOIN (\n    SELECT * FROM g_band_features\n    UNION ALL\n    SELECT * FROM r_band_features\n) d ON fo.oid = d.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3710, "completion_tokens": 768, "total_tokens": 4478, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3369c0508190bd0eaff0b04f6b2f", "custom_id": "1-3", "response": {"status_code": 200, "request_id": "3102b53275bbd3d47530b88603451fcf", "body": {"id": "chatcmpl-C4XJ936qhgs9KtniPPREZ3XVyviCr", "object": "chat.completion", "created": 1755197383, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    -- Step 1: Filter objects classified as AGN with a probability > 0.6\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n      AND probability > 0.6\n),\nlight_curve_span AS (\n    -- Step 2: Filter objects with light curves covering at least one year\n    SELECT oid\n    FROM object\n    WHERE deltajd >= 365\n      AND oid IN (SELECT oid FROM agn_objects)\n),\ndetections_per_band AS (\n    -- Step 3: Filter objects with at least 20 detections in at least one band\n    SELECT oid\n    FROM detection\n    GROUP BY oid, fid\n    HAVING COUNT(oid) >= 20\n),\nfiltered_objects AS (\n    -- Combine results from previous steps\n    SELECT DISTINCT oid\n    FROM light_curve_span\n    WHERE oid IN (SELECT oid FROM detections_per_band)\n),\ng_band_variation AS (\n    -- Step 4: Filter objects with variations > 1 magnitude in the g band\n    SELECT oid\n    FROM detection\n    WHERE fid = 1\n    GROUP BY oid\n    HAVING MAX(magpsf_corr) - MIN(magpsf_corr) > 1\n),\nr_band_variation AS (\n    -- Step 4: Filter objects with variations > 0.5 magnitude in the r band\n    SELECT oid\n    FROM detection\n    WHERE fid = 2\n    GROUP BY oid\n    HAVING MAX(magpsf_corr) - MIN(magpsf_corr) > 0.5\n),\nfinal_objects AS (\n    -- Combine all conditions\n    SELECT DISTINCT oid\n    FROM filtered_objects\n    WHERE oid IN (SELECT oid FROM g_band_variation)\n      AND oid IN (SELECT oid FROM r_band_variation)\n),\nfeature_data AS (\n    -- Retrieve feature data for final objects\n    SELECT f.oid, f.name, f.value, f.version, f.fid AS feature_fid\n    FROM feature f\n    INNER JOIN final_objects fo ON f.oid = fo.oid\n),\nobject_data AS (\n    -- Retrieve object data for final objects\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    INNER JOIN final_objects fo ON o.oid = fo.oid\n),\ndetection_data AS (\n    -- Retrieve detection data for final objects\n    SELECT \n        d.oid,\n        d.fid AS detection_fid,\n        MAX(d.magpsf_corr) AS max_mag,\n        MIN(d.magpsf_corr) AS min_mag,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag\n    FROM detection d\n    INNER JOIN final_objects fo ON d.oid = fo.oid\n    GROUP BY d.oid, d.fid\n)\n-- Final query combining all data\nSELECT \n    fd.oid,\n    fd.name,\n    fd.value,\n    fd.version,\n    fd.feature_fid,\n    od.meanra,\n    od.meandec,\n    od.ndet,\n    dd.detection_fid,\n    dd.max_mag,\n    dd.min_mag,\n    dd.delta_mag\nFROM feature_data fd\nINNER JOIN object_data od ON fd.oid = od.oid\nINNER JOIN detection_data dd ON fd.oid = dd.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3355, "completion_tokens": 723, "total_tokens": 4078, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3369e4d48190be9656e850ae064d", "custom_id": "1-4", "response": {"status_code": 200, "request_id": "3c8c4a1b6c599d7741a25f7bf122da8b", "body": {"id": "chatcmpl-C4XJ2rjebBoIfIrbND2ydxMzrkkn9", "object": "chat.completion", "created": 1755197376, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    -- Step 1: Filter objects classified as AGN with a probability > 0.6\n    SELECT \n        p.oid\n    FROM \n        probability p\n    WHERE \n        p.class_name = 'AGN'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.probability > 0.6\n),\nobjects_with_lightcurve AS (\n    -- Step 2: Filter objects with light curves covering at least one year\n    SELECT \n        o.oid, o.meanra, o.meandec, o.ndet\n    FROM \n        object o\n    INNER JOIN \n        agn_objects ao ON o.oid = ao.oid\n    WHERE \n        o.lastmjd - o.firstmjd >= 365\n),\nobjects_with_detections AS (\n    -- Step 3: Filter objects with at least 20 detections in at least one band\n    SELECT \n        d.oid\n    FROM \n        detection d\n    INNER JOIN \n        objects_with_lightcurve ol ON d.oid = ol.oid\n    GROUP BY \n        d.oid, d.fid\n    HAVING \n        COUNT(d.ndet) >= 20\n),\ng_band_variations AS (\n    -- Step 4.1: Filter objects with variations > 1 magnitude in the g band\n    SELECT \n        f.oid, \n        MAX(f.value) AS max_mag_g, \n        MIN(f.value) AS min_mag_g, \n        MAX(f.value) - MIN(f.value) AS delta_mag_g\n    FROM \n        feature f\n    INNER JOIN \n        objects_with_detections od ON f.oid = od.oid\n    WHERE \n        f.name IN ('max_mag', 'min_mag') AND f.fid = 1\n    GROUP BY \n        f.oid\n    HAVING \n        MAX(f.value) - MIN(f.value) > 1\n),\nr_band_variations AS (\n    -- Step 4.2: Filter objects with variations > 0.5 magnitude in the r band\n    SELECT \n        f.oid, \n        MAX(f.value) AS max_mag_r, \n        MIN(f.value) AS min_mag_r, \n        MAX(f.value) - MIN(f.value) AS delta_mag_r\n    FROM \n        feature f\n    INNER JOIN \n        objects_with_detections od ON f.oid = od.oid\n    WHERE \n        f.name IN ('max_mag', 'min_mag') AND f.fid = 2\n    GROUP BY \n        f.oid\n    HAVING \n        MAX(f.value) - MIN(f.value) > 0.5\n),\nfinal_objects AS (\n    -- Step 4.3: Combine g and r band variations\n    SELECT \n        g.oid, \n        g.max_mag_g, g.min_mag_g, g.delta_mag_g, \n        r.max_mag_r, r.min_mag_r, r.delta_mag_r\n    FROM \n        g_band_variations g\n    INNER JOIN \n        r_band_variations r ON g.oid = r.oid\n)\n-- Step 5: Retrieve the required columns\nSELECT \n    fo.oid, \n    f.value, \n    f.name, \n    f.version, \n    f.fid AS feature_fid, \n    ol.meanra, \n    ol.meandec, \n    ol.ndet, \n    fo.max_mag_g, \n    fo.min_mag_g, \n    fo.delta_mag_g, \n    fo.max_mag_r, \n    fo.min_mag_r, \n    fo.delta_mag_r\nFROM \n    final_objects fo\nINNER JOIN \n    objects_with_lightcurve ol ON fo.oid = ol.oid\nINNER JOIN \n    feature f ON fo.oid = f.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3487, "completion_tokens": 807, "total_tokens": 4294, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336a57d08190ba074a2b0cfb9b54", "custom_id": "16-0", "response": {"status_code": 200, "request_id": "1b09eecdd9cd196e275949f2dff2f3e7", "body": {"id": "chatcmpl-C4XJ1IztP6BPGeeTxWwe0MLHt1Qyh", "object": "chat.completion", "created": 1755197375, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects based on the stamp_classifier with the highest probability for class 'SN'\nWITH stamp_classifier_sn AS (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND class_name = 'SN' \n        AND ranking = 1\n),\n\n-- Step 2: Filter objects with their first detection in the first two days of September\nfirst_detection_september AS (\n    SELECT \n        oid\n    FROM \n        object\n    WHERE \n        firstmjd >= 60188.0 \n        AND firstmjd < 60190.0\n),\n\n-- Step 3: Identify objects that qualify as fast risers\nfast_risers AS (\n    SELECT \n        d.oid, \n        d.fid, \n        d.mjd AS mjd_first_detection, \n        d.magpsf, \n        nd.mjd AS mjd_last_non_detection, \n        nd.diffmaglim,\n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) AS rate_of_change\n    FROM \n        detection d\n    INNER JOIN \n        (\n            SELECT \n                oid, \n                fid, \n                MAX(mjd) AS mjd, \n                diffmaglim\n            FROM \n                non_detection\n            GROUP BY \n                oid, fid, diffmaglim\n        ) nd\n    ON \n        d.oid = nd.oid \n        AND d.fid = nd.fid \n        AND nd.mjd < d.mjd\n    WHERE \n        (nd.diffmaglim - d.magpsf) / (d.mjd - nd.mjd) >= 0.25\n),\n\n-- Step 4: Combine filters from Steps 1, 2, and 3\nfiltered_objects AS (\n    SELECT \n        sc.oid, \n        sc.probability, \n        fr.fid, \n        fr.mjd_first_detection, \n        fr.mjd_last_non_detection, \n        fr.magpsf, \n        fr.diffmaglim, \n        fr.rate_of_change\n    FROM \n        stamp_classifier_sn sc\n    INNER JOIN \n        first_detection_september fd\n    ON \n        sc.oid = fd.oid\n    INNER JOIN \n        fast_risers fr\n    ON \n        sc.oid = fr.oid\n),\n\n-- Step 5: Retrieve light curves (non-detections only) for the filtered objects\nlight_curves AS (\n    SELECT \n        nd.oid, \n        nd.mjd, \n        nd.fid, \n        nd.diffmaglim\n    FROM \n        non_detection nd\n    INNER JOIN \n        filtered_objects fo\n    ON \n        nd.oid = fo.oid\n),\n\n-- Step 6: Retrieve additional information from the magstat table\nmagstat_info AS (\n    SELECT \n        ms.oid, \n        ms.fid AS magstat_fid\n    FROM \n        magstat ms\n    INNER JOIN \n        filtered_objects fo\n    ON \n        ms.oid = fo.oid\n)\n\n-- Step 7: Combine all results and format the output\nSELECT \n    fo.oid, \n    fo.probability, \n    lc.fid, \n    lc.mjd, \n    lc.diffmaglim, \n    mi.magstat_fid, \n    fo.mjd_first_detection, \n    fo.mjd_last_non_detection, \n    fo.magpsf, \n    fo.diffmaglim AS last_diffmaglim, \n    fo.rate_of_change\nFROM \n    filtered_objects fo\nINNER JOIN \n    light_curves lc\nON \n    fo.oid = lc.oid\nINNER JOIN \n    magstat_info mi\nON \n    fo.oid = mi.oid\nORDER BY \n    fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3640, "completion_tokens": 807, "total_tokens": 4447, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336a49a081908e282080e222a109", "custom_id": "16-1", "response": {"status_code": 200, "request_id": "9ec590e52d273b34bbd352262328a2d7", "body": {"id": "chatcmpl-C4XJ2kSFPkQ29sNYGtOBPLtSIrPlV", "object": "chat.completion", "created": 1755197376, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects based on the 'stamp_classifier' and class 'SN'\nWITH stamp_classifier_sn AS (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND class_name = 'SN' \n        AND ranking = 1\n),\n\n-- Step 2: Filter objects with their first detection in the first two days of September\nobjects_in_september AS (\n    SELECT \n        oid\n    FROM \n        object\n    WHERE \n        firstmjd BETWEEN 60188.0 AND 60189.0\n),\n\n-- Step 3: Identify objects that qualify as \"fast risers\"\nfirst_detections AS (\n    SELECT \n        oid, \n        fid, \n        MIN(mjd) AS mjd_first_detection, \n        magpsf\n    FROM \n        detection\n    GROUP BY \n        oid, fid\n),\nlast_non_detections AS (\n    SELECT \n        nd.oid, \n        nd.fid, \n        MAX(nd.mjd) AS mjd_last_non_detection, \n        nd.diffmaglim\n    FROM \n        non_detection nd\n    INNER JOIN \n        first_detections fd \n        ON nd.oid = fd.oid AND nd.fid = fd.fid AND nd.mjd < fd.mjd_first_detection\n    GROUP BY \n        nd.oid, nd.fid\n),\nfast_risers AS (\n    SELECT \n        fd.oid, \n        fd.fid, \n        fd.mjd_first_detection, \n        fd.magpsf, \n        lnd.mjd_last_non_detection, \n        lnd.diffmaglim,\n        (lnd.diffmaglim - fd.magpsf) / (fd.mjd_first_detection - lnd.mjd_last_non_detection) AS dm_dt\n    FROM \n        first_detections fd\n    INNER JOIN \n        last_non_detections lnd \n        ON fd.oid = lnd.oid AND fd.fid = lnd.fid\n    WHERE \n        (lnd.diffmaglim - fd.magpsf) / (fd.mjd_first_detection - lnd.mjd_last_non_detection) >= 0.25\n),\n\n-- Step 4: Combine results from Steps 1, 2, and 3\nfiltered_objects AS (\n    SELECT \n        sc.oid, \n        sc.probability, \n        fr.fid, \n        fr.mjd_first_detection, \n        fr.magpsf, \n        fr.mjd_last_non_detection, \n        fr.diffmaglim\n    FROM \n        stamp_classifier_sn sc\n    INNER JOIN \n        objects_in_september os \n        ON sc.oid = os.oid\n    INNER JOIN \n        fast_risers fr \n        ON sc.oid = fr.oid\n),\n\n-- Step 5: Retrieve light curves (non-detections only)\nlight_curves AS (\n    SELECT \n        nd.oid, \n        nd.mjd, \n        nd.fid, \n        nd.diffmaglim, \n        'non-detection' AS detection_type\n    FROM \n        non_detection nd\n    INNER JOIN \n        filtered_objects fo \n        ON nd.oid = fo.oid\n),\n\n-- Step 6: Retrieve additional information from the 'magstat' table\nmagstat_info AS (\n    SELECT \n        oid, \n        fid AS magstat_fid, \n        magmean_corr\n    FROM \n        magstat\n    WHERE \n        oid IN (SELECT oid FROM filtered_objects)\n)\n\n-- Step 7: Combine all results and apply final formatting\nSELECT \n    fo.oid, \n    fo.probability, \n    fo.fid, \n    fo.mjd_first_detection, \n    fo.magpsf, \n    fo.mjd_last_non_detection, \n    fo.diffmaglim, \n    lc.mjd AS light_curve_mjd, \n    lc.fid AS light_curve_fid, \n    lc.diffmaglim AS light_curve_diffmaglim, \n    lc.detection_type, \n    mi.magstat_fid, \n    mi.magmean_corr\nFROM \n    filtered_objects fo\nLEFT JOIN \n    light_curves lc \n    ON fo.oid = lc.oid\nLEFT JOIN \n    magstat_info mi \n    ON fo.oid = mi.oid\nORDER BY \n    fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3619, "completion_tokens": 920, "total_tokens": 4539, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336a64b48190bb474e118659637a", "custom_id": "16-2", "response": {"status_code": 200, "request_id": "b96e18fb6159bedbb2308ae14e42613b", "body": {"id": "chatcmpl-C4XJ2X7LC1HHFNYCRaV77hXg1eZir", "object": "chat.completion", "created": 1755197376, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH stamp_classifier_sn AS (\n    -- Step 1: Filter objects based on the stamp_classifier with the highest probability for class 'SN'\n    SELECT \n        p.oid, \n        p.probability\n    FROM \n        probability p\n    WHERE \n        p.classifier_name = 'stamp_classifier' \n        AND p.class_name = 'SN' \n        AND p.ranking = 1\n),\nfirst_detection_september AS (\n    -- Step 2: Filter objects with their first detection in the first two days of September\n    SELECT \n        o.oid, \n        o.firstmjd\n    FROM \n        object o\n    WHERE \n        o.firstmjd >= 60188.0 \n        AND o.firstmjd < 60190.0\n),\nfast_risers AS (\n    -- Step 3: Identify objects that qualify as fast risers\n    WITH first_detections AS (\n        SELECT \n            d.oid, \n            d.fid, \n            MIN(d.mjd) AS first_detection_mjd, \n            d.magpsf\n        FROM \n            detection d\n        GROUP BY \n            d.oid, d.fid\n    ),\n    last_non_detections AS (\n        SELECT \n            nd.oid, \n            nd.fid, \n            MAX(nd.mjd) AS last_non_detection_mjd, \n            nd.diffmaglim\n        FROM \n            non_detection nd\n        INNER JOIN \n            first_detections fd \n            ON nd.oid = fd.oid AND nd.fid = fd.fid AND nd.mjd < fd.first_detection_mjd\n        GROUP BY \n            nd.oid, nd.fid\n    )\n    SELECT \n        fd.oid, \n        fd.fid, \n        fd.first_detection_mjd, \n        lnd.last_non_detection_mjd, \n        fd.magpsf, \n        lnd.diffmaglim\n    FROM \n        first_detections fd\n    INNER JOIN \n        last_non_detections lnd \n        ON fd.oid = lnd.oid AND fd.fid = lnd.fid\n    WHERE \n        (lnd.diffmaglim - fd.magpsf) / (fd.first_detection_mjd - lnd.last_non_detection_mjd) >= 0.25\n),\nfiltered_objects AS (\n    -- Step 4: Combine results from Steps 1, 2, and 3\n    SELECT \n        sc.oid, \n        sc.probability, \n        fr.fid, \n        fr.first_detection_mjd, \n        fr.last_non_detection_mjd, \n        fr.magpsf, \n        fr.diffmaglim\n    FROM \n        stamp_classifier_sn sc\n    INNER JOIN \n        first_detection_september fds \n        ON sc.oid = fds.oid\n    INNER JOIN \n        fast_risers fr \n        ON sc.oid = fr.oid\n),\nlight_curves AS (\n    -- Step 5: Retrieve light curves (non-detections only) for the filtered objects\n    SELECT \n        nd.oid, \n        nd.mjd, \n        nd.fid, \n        nd.diffmaglim\n    FROM \n        non_detection nd\n    INNER JOIN \n        filtered_objects fo \n        ON nd.oid = fo.oid\n),\nmagstat_data AS (\n    -- Step 6: Retrieve additional information from the magstat table\n    SELECT \n        ms.oid, \n        ms.fid AS magstat_fid\n    FROM \n        magstat ms\n    INNER JOIN \n        filtered_objects fo \n        ON ms.oid = fo.oid\n)\n-- Step 7: Combine all results and finalize the query\nSELECT \n    fo.oid, \n    fo.probability, \n    lc.mjd, \n    lc.fid, \n    lc.diffmaglim, \n    fo.fid AS detection_fid, \n    fo.first_detection_mjd, \n    fo.last_non_detection_mjd, \n    fo.magpsf, \n    fo.diffmaglim, \n    ms.magstat_fid\nFROM \n    filtered_objects fo\nINNER JOIN \n    light_curves lc \n    ON fo.oid = lc.oid\nINNER JOIN \n    magstat_data ms \n    ON fo.oid = ms.oid\nORDER BY \n    fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3680, "completion_tokens": 912, "total_tokens": 4592, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336a633481909bfc0ab64a4e50d5", "custom_id": "16-3", "response": {"status_code": 200, "request_id": "73a0375eac83f0626b04d00c13681172", "body": {"id": "chatcmpl-C4XJ21lKzhXqQX4KfUiAnkV3AbqjN", "object": "chat.completion", "created": 1755197376, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects based on the stamp_classifier highest probability for class 'SN'\nWITH stamp_classifier_sn AS (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND class_name = 'SN' \n        AND ranking = 1\n),\n\n-- Step 2: Filter objects with their first detection in the first two days of September\nobjects_in_september AS (\n    SELECT \n        oid, \n        firstmjd\n    FROM \n        object\n    WHERE \n        firstmjd >= 60188.0 \n        AND firstmjd < 60190.0\n),\n\n-- Step 3.1: Retrieve the first detection for each object\nfirst_detections AS (\n    SELECT \n        oid, \n        fid, \n        MIN(mjd) AS mjd_first_detection, \n        MIN(magpsf) AS magpsf_first_detection\n    FROM \n        detection\n    GROUP BY \n        oid, fid\n),\n\n-- Step 3.2: Retrieve the last non-detection before the first detection for each object\nlast_non_detections AS (\n    SELECT \n        nd.oid, \n        nd.fid, \n        MAX(nd.mjd) AS mjd_last_non_detection, \n        MAX(nd.diffmaglim) AS diffmaglim_last_non_detection\n    FROM \n        detection d\n    INNER JOIN \n        non_detection nd \n        ON d.oid = nd.oid AND nd.fid = d.fid\n    WHERE \n        nd.mjd < d.mjd\n    GROUP BY \n        nd.oid, nd.fid\n),\n\n-- Step 3.3: Combine first detections and last non-detections to calculate the rate of magnitude change\nfast_risers AS (\n    SELECT \n        fd.oid, \n        fd.fid, \n        fd.mjd_first_detection, \n        ln.mjd_last_non_detection, \n        (ln.diffmaglim_last_non_detection - fd.magpsf_first_detection) / \n        (fd.mjd_first_detection - ln.mjd_last_non_detection) AS rate\n    FROM \n        first_detections fd\n    INNER JOIN \n        last_non_detections ln \n        ON fd.oid = ln.oid AND fd.fid = ln.fid\n    WHERE \n        (ln.diffmaglim_last_non_detection - fd.magpsf_first_detection) / \n        (fd.mjd_first_detection - ln.mjd_last_non_detection) >= 0.25\n),\n\n-- Step 4: Combine results from Steps 1, 2, and 3\nfiltered_objects AS (\n    SELECT \n        sc.oid, \n        sc.probability, \n        fr.fid, \n        fr.mjd_first_detection, \n        fr.mjd_last_non_detection, \n        fr.rate\n    FROM \n        stamp_classifier_sn sc\n    INNER JOIN \n        objects_in_september os \n        ON sc.oid = os.oid\n    INNER JOIN \n        fast_risers fr \n        ON sc.oid = fr.oid\n),\n\n-- Step 5: Retrieve light curves (non-detections only) for the filtered objects\nlight_curves AS (\n    SELECT \n        nd.oid, \n        nd.mjd, \n        nd.fid, \n        nd.diffmaglim\n    FROM \n        non_detection nd\n    INNER JOIN \n        filtered_objects fo \n        ON nd.oid = fo.oid\n),\n\n-- Step 6: Retrieve additional information from the magstat table\nmagstat_info AS (\n    SELECT \n        ms.oid, \n        ms.fid AS magstat_fid\n    FROM \n        magstat ms\n    INNER JOIN \n        filtered_objects fo \n        ON ms.oid = fo.oid\n)\n\n-- Step 7: Combine all results and format the output\nSELECT \n    fo.oid, \n    fo.probability, \n    fo.fid, \n    fo.mjd_first_detection, \n    fo.mjd_last_non_detection, \n    fo.rate, \n    lc.mjd AS light_curve_mjd, \n    lc.fid AS light_curve_fid, \n    lc.diffmaglim AS light_curve_diffmaglim, \n    mi.magstat_fid\nFROM \n    filtered_objects fo\nLEFT JOIN \n    light_curves lc \n    ON fo.oid = lc.oid\nLEFT JOIN \n    magstat_info mi \n    ON fo.oid = mi.oid\nORDER BY \n    fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3696, "completion_tokens": 951, "total_tokens": 4647, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336a5dfc81909c0442fd4369610e", "custom_id": "16-4", "response": {"status_code": 200, "request_id": "7c610066beb455b8dac73b2b3e82d2e6", "body": {"id": "chatcmpl-C4XJ8wndZQwZLFNqk4cH3uiXoB7Fk", "object": "chat.completion", "created": 1755197382, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH stamp_classifier_sn AS (\n    -- Step 1: Filter objects based on the stamp_classifier with the highest probability for class 'SN'\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND class_name = 'SN' \n        AND ranking = 1\n),\nfirst_detection_september AS (\n    -- Step 2: Filter objects with their first detection in the first two days of September\n    SELECT \n        oid, \n        firstmjd\n    FROM \n        object\n    WHERE \n        firstmjd >= 60188.0 \n        AND firstmjd < 60190.0\n),\nfast_risers AS (\n    -- Step 3: Identify objects that qualify as fast risers\n    WITH first_detections AS (\n        SELECT \n            oid, \n            fid, \n            MIN(mjd) AS mjd_first_detection, \n            MIN(magpsf) AS magpsf\n        FROM \n            detection\n        GROUP BY \n            oid, fid\n    ),\n    last_non_detections AS (\n        SELECT \n            nd.oid, \n            nd.fid, \n            MAX(nd.mjd) AS mjd_last_non_detection, \n            MAX(nd.diffmaglim) AS diffmaglim\n        FROM \n            non_detection nd\n        INNER JOIN \n            first_detections fd \n            ON nd.oid = fd.oid AND nd.fid = fd.fid AND nd.mjd < fd.mjd_first_detection\n        GROUP BY \n            nd.oid, nd.fid\n    )\n    SELECT \n        fd.oid, \n        fd.fid, \n        fd.mjd_first_detection, \n        ln.mjd_last_non_detection, \n        fd.magpsf, \n        ln.diffmaglim\n    FROM \n        first_detections fd\n    INNER JOIN \n        last_non_detections ln \n        ON fd.oid = ln.oid AND fd.fid = ln.fid\n    WHERE \n        (ln.diffmaglim - fd.magpsf) / (fd.mjd_first_detection - ln.mjd_last_non_detection) >= 0.25\n),\nfiltered_objects AS (\n    -- Step 4: Combine filters from Steps 1, 2, and 3\n    SELECT \n        sc.oid, \n        sc.probability, \n        fr.fid, \n        fr.mjd_first_detection, \n        fr.mjd_last_non_detection, \n        fr.magpsf, \n        fr.diffmaglim\n    FROM \n        stamp_classifier_sn sc\n    INNER JOIN \n        first_detection_september fd \n        ON sc.oid = fd.oid\n    INNER JOIN \n        fast_risers fr \n        ON sc.oid = fr.oid\n),\nlight_curves AS (\n    -- Step 5: Retrieve light curves (including only non-detections) for the filtered objects\n    SELECT \n        nd.oid, \n        nd.mjd, \n        nd.fid, \n        nd.diffmaglim\n    FROM \n        non_detection nd\n    INNER JOIN \n        filtered_objects fo \n        ON nd.oid = fo.oid\n),\nmagstat_info AS (\n    -- Step 6: Retrieve additional information from the magstat table\n    SELECT \n        oid, \n        fid AS magstat_fid\n    FROM \n        magstat\n    WHERE \n        oid IN (SELECT oid FROM filtered_objects)\n)\n-- Step 7: Combine all results and format the output\nSELECT \n    fo.oid, \n    fo.probability, \n    lc.fid, \n    lc.diffmaglim, \n    mi.magstat_fid, \n    fo.mjd_first_detection, \n    fo.mjd_last_non_detection, \n    fo.magpsf, \n    fo.diffmaglim\nFROM \n    filtered_objects fo\nINNER JOIN \n    light_curves lc \n    ON fo.oid = lc.oid\nINNER JOIN \n    magstat_info mi \n    ON fo.oid = mi.oid\nORDER BY \n    fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3699, "completion_tokens": 862, "total_tokens": 4561, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336a69dc8190895c9d170e7e82fc", "custom_id": "19-2", "response": {"status_code": 200, "request_id": "7c5369ebecd5ceeaf96b82726f6cf759", "body": {"id": "chatcmpl-C4XY3DT6nYXtHSke1avT3I5mlwKmQ", "object": "chat.completion", "created": 1755198307, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    probability.class_name, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability \nON \n    object.oid = probability.oid\nWHERE \n    object.firstmjd BETWEEN 59274.0 AND 59305.0 -- Filter objects detected between March 1st and April 1st, 2021\n    AND object.ndet <= 1 -- Filter objects with at most one detection\n    AND probability.class_name = 'asteroid' -- Filter objects classified as 'asteroid'\n    AND probability.classifier_name = 'stamp_classifier' -- Use the stamp classifier\n    AND probability.ranking = 1 -- Only consider the most likely classification\n    AND probability.probability > 0.7; -- Ensure the classification probability is greater than 0.7\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3076, "completion_tokens": 204, "total_tokens": 3280, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336a6cc48190a531f1a88003b748", "custom_id": "14-0", "response": {"status_code": 200, "request_id": "1f485f35d3100fccab27ea79a5bc8d68", "body": {"id": "chatcmpl-C4XJ96z9q6cv4pQs0DQKlM5PGwZT1", "object": "chat.completion", "created": 1755197383, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', \n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', \n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3115, "completion_tokens": 231, "total_tokens": 3346, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336a81dc8190851b3d3f10b83f81", "custom_id": "14-1", "response": {"status_code": 200, "request_id": "92bb0488d9df7942b7f1d54d71eb5e76", "body": {"id": "chatcmpl-C4XJ9u6vhJ9ilI1flBqeUgH3LSNtx", "object": "chat.completion", "created": 1755197383, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', \n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', \n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2986, "completion_tokens": 231, "total_tokens": 3217, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336aa6388190a9a7fb2ff115773f", "custom_id": "14-2", "response": {"status_code": 200, "request_id": "49148dcfe36a53ee949f3c12c10457b1", "body": {"id": "chatcmpl-C4XJBKr1WP73vn2jofO3wzaYZJUn5", "object": "chat.completion", "created": 1755197385, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve the requested information for the given list of oids\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', \n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', \n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3099, "completion_tokens": 246, "total_tokens": 3345, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ae4748190a28d04b472b826aa", "custom_id": "14-3", "response": {"status_code": 200, "request_id": "ca1aad971f0d0ebf9d00fd43cfccc8f8", "body": {"id": "chatcmpl-C4XJBxtOONwqP5An7K7oMa9f2eUmQ", "object": "chat.completion", "created": 1755197385, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve the requested information for the given list of oids\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    p.sgscore1, \n    p.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf p ON d.oid = p.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', \n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', \n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3071, "completion_tokens": 241, "total_tokens": 3312, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336b0f208190bc4754e9b48b3f2a", "custom_id": "14-4", "response": {"status_code": 200, "request_id": "2811c09d943b6aa9b4c9260abf9de27e", "body": {"id": "chatcmpl-C4XJDNrcX4Fp4fbbSrHpTiAlCn8O5", "object": "chat.completion", "created": 1755197387, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve the requested information for the specified oids\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',\n              'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',\n              'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3017, "completion_tokens": 242, "total_tokens": 3259, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336b21a88190b890397884d665ea", "custom_id": "57-0", "response": {"status_code": 200, "request_id": "34109119fc8f7d4a93b9f93d4538e58c", "body": {"id": "chatcmpl-C4XJDyKew67WJJwK52YCA88k9lGac", "object": "chat.completion", "created": 1755197387, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS source_id, 354.67 AS ra, 15.954 AS dec, 0.008333 AS radius\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 0.005556\n),\nztf_objects_id_1 AS (\n    SELECT \n        'id_1' AS source_id,\n        354.67 AS input_ra,\n        15.954 AS input_dec,\n        0.008333 AS search_radius,\n        oid,\n        ndet,\n        meanra,\n        meandec,\n        firstmjd,\n        lastmjd\n    FROM object\n    WHERE q3c_radial_query(meanra, meandec, 354.67, 15.954, 0.008333)\n),\nztf_objects_id_2 AS (\n    SELECT \n        'id_2' AS source_id,\n        20.7993 AS input_ra,\n        1.00331 AS input_dec,\n        0.005556 AS search_radius,\n        oid,\n        ndet,\n        meanra,\n        meandec,\n        firstmjd,\n        lastmjd\n    FROM object\n    WHERE q3c_radial_query(meanra, meandec, 20.7993, 1.00331, 0.005556)\n)\nSELECT \n    source_id,\n    input_ra AS ra,\n    input_dec AS dec,\n    search_radius AS radius,\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM (\n    SELECT * FROM ztf_objects_id_1\n    UNION ALL\n    SELECT * FROM ztf_objects_id_2\n) AS combined_results\nORDER BY lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3225, "completion_tokens": 383, "total_tokens": 3608, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336b1f008190a36b674aadf7e5a5", "custom_id": "57-1", "response": {"status_code": 200, "request_id": "1e1f6a1f07615fbe358854237bf917b0", "body": {"id": "chatcmpl-C4XJFKIVcgfF7qP0sbjKYGxRnlsbq", "object": "chat.completion", "created": 1755197389, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS search_radius\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600\n),\nztf_objects_id_1 AS (\n    SELECT \n        'id_1' AS identifier,\n        354.67 AS input_ra,\n        15.954 AS input_dec,\n        30.0 / 3600 AS search_radius,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0 / 3600)\n),\nztf_objects_id_2 AS (\n    SELECT \n        'id_2' AS identifier,\n        20.7993 AS input_ra,\n        1.00331 AS input_dec,\n        20.0 / 3600 AS search_radius,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0 / 3600)\n)\nSELECT \n    identifier,\n    input_ra AS ra,\n    input_dec AS dec,\n    search_radius,\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM (\n    SELECT * FROM ztf_objects_id_1\n    UNION\n    SELECT * FROM ztf_objects_id_2\n) combined_results\nORDER BY lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3239, "completion_tokens": 414, "total_tokens": 3653, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336b1b2881909d82370cee7ea3aa", "custom_id": "57-2", "response": {"status_code": 200, "request_id": "57a3bdd310602a5f19a75c9b7d8762d4", "body": {"id": "chatcmpl-C4XJF3mD1F8ETAUqcJ43fSqRKkLSl", "object": "chat.completion", "created": 1755197389, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT \n        'id_1' AS source_id, \n        354.67 AS ra, \n        15.954 AS dec, \n        0.008333 AS radius -- 30 arcsec in degrees\n    UNION ALL\n    SELECT \n        'id_2' AS source_id, \n        20.7993 AS ra, \n        1.00331 AS dec, \n        0.005556 AS radius -- 20 arcsec in degrees\n),\nztf_objects AS (\n    SELECT \n        io.source_id, \n        io.ra AS input_ra, \n        io.dec AS input_dec, \n        io.radius, \n        o.oid, \n        o.ndet, \n        o.meanra, \n        o.meandec, \n        o.firstmjd, \n        o.lastmjd\n    FROM \n        input_objects io\n    INNER JOIN \n        object o\n    ON \n        q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.radius)\n)\nSELECT \n    source_id, \n    input_ra AS ra, \n    input_dec AS dec, \n    radius, \n    oid, \n    ndet, \n    meanra, \n    meandec, \n    firstmjd\nFROM \n    ztf_objects\nORDER BY \n    lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3187, "completion_tokens": 296, "total_tokens": 3483, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336b1f808190b3d2780de1c6b228", "custom_id": "57-3", "response": {"status_code": 200, "request_id": "f31e24b95eefcbb63e7de6604a8de135", "body": {"id": "chatcmpl-C4XJGV0K2amiTRXSBNog5Mdg2ATRE", "object": "chat.completion", "created": 1755197390, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT \n        'id_1' AS identifier, \n        354.67 AS ra, \n        15.954 AS dec, \n        0.008333 AS search_radius -- 30 arcsec in degrees\n    UNION ALL\n    SELECT \n        'id_2' AS identifier, \n        20.7993 AS ra, \n        1.00331 AS dec, \n        0.005556 AS search_radius -- 20 arcsec in degrees\n),\nztf_objects AS (\n    SELECT \n        io.identifier,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.search_radius,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM \n        input_objects io\n    INNER JOIN \n        object o\n    ON \n        q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)\n)\nSELECT \n    identifier,\n    input_ra AS ra,\n    input_dec AS dec,\n    search_radius,\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM \n    ztf_objects\nORDER BY \n    lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3166, "completion_tokens": 280, "total_tokens": 3446, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336b221c819084756d66d5dde2e8", "custom_id": "57-4", "response": {"status_code": 200, "request_id": "55cb81eddaaef0e97a9da53270b2e2e4", "body": {"id": "chatcmpl-C4XJGUMCwX8ds3rHGGW7b4vcqkAyP", "object": "chat.completion", "created": 1755197390, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS search_radius\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600\n),\nztf_objects_id_1 AS (\n    SELECT \n        'id_1' AS identifier,\n        354.67 AS input_ra,\n        15.954 AS input_dec,\n        30.0 / 3600 AS search_radius,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, 354.67, 15.954, 30.0 / 3600)\n),\nztf_objects_id_2 AS (\n    SELECT \n        'id_2' AS identifier,\n        20.7993 AS input_ra,\n        1.00331 AS input_dec,\n        20.0 / 3600 AS search_radius,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        o.lastmjd\n    FROM object o\n    WHERE q3c_radial_query(o.meanra, o.meandec, 20.7993, 1.00331, 20.0 / 3600)\n)\nSELECT \n    identifier,\n    input_ra AS ra,\n    input_dec AS dec,\n    search_radius,\n    oid,\n    ndet,\n    meanra,\n    meandec,\n    firstmjd\nFROM (\n    SELECT * FROM ztf_objects_id_1\n    UNION ALL\n    SELECT * FROM ztf_objects_id_2\n) combined_results\nORDER BY lastmjd DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3148, "completion_tokens": 415, "total_tokens": 3563, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336b41d88190b2519cfbcad54cd8", "custom_id": "89-0", "response": {"status_code": 200, "request_id": "2b43d9b60a261051143876d7803aa318", "body": {"id": "chatcmpl-C4XJHItuAPIL741T7iO8ciEuhoLwx", "object": "chat.completion", "created": 1755197391, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') with a probability > 0.7\n-- using the stamp classifier, and return all columns from the 'dataquality' table.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2638, "completion_tokens": 106, "total_tokens": 2744, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336b3e808190b267ca0e5281f626", "custom_id": "89-1", "response": {"status_code": 200, "request_id": "a56de94269aa104b6c58632e61180680", "body": {"id": "chatcmpl-C4XJKjVT5AXXTPn8ymq5ummTRjAnR", "object": "chat.completion", "created": 1755197394, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier\n-- with a probability greater than 0.7, returning all columns from the 'dataquality' table.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n      AND classifier_name = 'stamp_classifier'\n      AND probability > 0.7\n      AND ranking = 1\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2578, "completion_tokens": 106, "total_tokens": 2684, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336b5bb88190835bcba9739339c7", "custom_id": "89-2", "response": {"status_code": 200, "request_id": "26a2e063611882c076fb765bd551ea02", "body": {"id": "chatcmpl-C4XJKVjBvr0Uv7my4VsJt2RHpA4VU", "object": "chat.completion", "created": 1755197394, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') with a probability > 0.7 in the stamp classifier\n-- and return all columns from the 'dataquality' table for such objects.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2630, "completion_tokens": 108, "total_tokens": 2738, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336bb06481908f4bf87ac5c05774", "custom_id": "89-3", "response": {"status_code": 200, "request_id": "481ade1f27189a709a03edafa54ceb9b", "body": {"id": "chatcmpl-C4XJJ9vlQ6LcHN6q3gEdtmVNabjNR", "object": "chat.completion", "created": 1755197393, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier\n-- with a probability greater than 0.7, returning all columns from the 'dataquality' table.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n      AND classifier_name = 'stamp_classifier'\n      AND probability > 0.7\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2685, "completion_tokens": 99, "total_tokens": 2784, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336bc8e881909f2b837b45abf90b", "custom_id": "89-4", "response": {"status_code": 200, "request_id": "0a7221743a19295a44e24624d148378b", "body": {"id": "chatcmpl-C4XJKmdbT0swsUc2ynWn3KOmdBnvK", "object": "chat.completion", "created": 1755197394, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects classified as supernovae ('SN') with a probability > 0.7 in the stamp classifier\n-- and return all columns from the 'dataquality' table for such objects.\n\nSELECT *\nFROM dataquality\nINNER JOIN (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n      AND probability > 0.7\n) AS filtered_probabilities\nON dataquality.oid = filtered_probabilities.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2658, "completion_tokens": 124, "total_tokens": 2782, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336bdc508190bda96468315e67a7", "custom_id": "103-0", "response": {"status_code": 200, "request_id": "1dd8bb4a5aa1dec166f2f06afc5b65a5", "body": {"id": "chatcmpl-C4XJJ51qeUXUFOwtjjpKbns2BCMWx", "object": "chat.completion", "created": 1755197393, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nINNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid\nWHERE ps1_ztf.distpsnr1 > 5\n  AND probability.ranking = 1\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.probability > 0.7\n  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\nORDER BY ps1_ztf.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3205, "completion_tokens": 134, "total_tokens": 3339, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336bdc3c81908ace608a57e74258", "custom_id": "103-1", "response": {"status_code": 200, "request_id": "6759d2392d31924f73c41cd79182f357", "body": {"id": "chatcmpl-C4XJJF93efNiKo7WLCI5jhGhsR5vl", "object": "chat.completion", "created": 1755197393, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT *\nFROM object\nINNER JOIN (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n) prob_filtered ON object.oid = prob_filtered.oid\nINNER JOIN (\n    SELECT oid, distpsnr1\n    FROM ps1_ztf\n    WHERE distpsnr1 > 5\n) ps1_filtered ON object.oid = ps1_filtered.oid\nORDER BY ps1_filtered.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3176, "completion_tokens": 181, "total_tokens": 3357, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336bda788190b65be2928c2a4e68", "custom_id": "103-2", "response": {"status_code": 200, "request_id": "68f876080641ea16245be4d16f6bc712", "body": {"id": "chatcmpl-C4XJJay5XzT2dgdg5JORmO7Td0fbz", "object": "chat.completion", "created": 1755197393, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT *\nFROM object\nINNER JOIN (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n) prob_filtered ON object.oid = prob_filtered.oid\nINNER JOIN (\n    SELECT oid, distpsnr1\n    FROM ps1_ztf\n    WHERE distpsnr1 > 5\n) ps1_filtered ON object.oid = ps1_filtered.oid\nORDER BY ps1_filtered.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3277, "completion_tokens": 181, "total_tokens": 3458, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336be3508190bf206eb7d0720cb3", "custom_id": "103-3", "response": {"status_code": 200, "request_id": "5f35c9114d22c8cf9af5389250fe52fe", "body": {"id": "chatcmpl-C4XJNSuZSfpWjqYkf8YjKFmXlHrur", "object": "chat.completion", "created": 1755197397, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT *\nFROM object\nINNER JOIN (\n    SELECT oid, distpsnr1\n    FROM ps1_ztf\n    WHERE distpsnr1 > 5\n) ps1_filtered ON object.oid = ps1_filtered.oid\nINNER JOIN (\n    SELECT oid, class_name, classifier_name, classifier_version, probability, ranking\n    FROM probability\n    WHERE probability > 0.7\n      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n) prob_filtered ON object.oid = prob_filtered.oid\nORDER BY ps1_filtered.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3235, "completion_tokens": 160, "total_tokens": 3395, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336becdc819093ac08c91ac5ffc5", "custom_id": "103-4", "response": {"status_code": 200, "request_id": "b477fdaaaa53373f4e78067dd14478e7", "body": {"id": "chatcmpl-C4XJNNasyUHX93DhtFsq5IiIKAtpR", "object": "chat.completion", "created": 1755197397, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT *\nFROM object\nINNER JOIN (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n) prob_filtered ON object.oid = prob_filtered.oid\nINNER JOIN (\n    SELECT oid, distpsnr1\n    FROM ps1_ztf\n    WHERE distpsnr1 > 5\n) ps1_filtered ON object.oid = ps1_filtered.oid\nORDER BY ps1_filtered.distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3254, "completion_tokens": 181, "total_tokens": 3435, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336bf1e48190a7a8d22eb9791ea5", "custom_id": "99-0", "response": {"status_code": 200, "request_id": "3becbea01c8b2a9dd1c2a9562001ec76", "body": {"id": "chatcmpl-C4XJOihJEwcjktJV4NJYWO1VOYyXw", "object": "chat.completion", "created": 1755197398, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from the 'forced_photometry' table for ZTF objects\n-- that have a first detection date later than mjd=60310 days and a probability of 1\n-- of being classified as an asteroid in the stamp classifier, ordered by the first detection date.\n-- Limit the results to at most 10 objects.\n\nSELECT *\nFROM forced_photometry\nWHERE oid IN (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p\n    ON o.oid = p.oid\n    WHERE o.firstmjd > 60310\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability = 1\n      AND p.ranking = 1\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2646, "completion_tokens": 179, "total_tokens": 2825, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336c158c8190800953eb69fc488b", "custom_id": "99-1", "response": {"status_code": 200, "request_id": "a04f23860023cdcbdb81c7cdeef58ec6", "body": {"id": "chatcmpl-C4XJOptJJHnr06S4Ha2bXK2aRWg9k", "object": "chat.completion", "created": 1755197398, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with specific conditions and return all columns from the 'forced_photometry' table\nSELECT *\nFROM forced_photometry\nWHERE oid IN (\n    SELECT object.oid\n    FROM object\n    INNER JOIN probability\n    ON object.oid = probability.oid\n    WHERE object.firstmjd > 60310\n      AND probability.class_name = 'asteroid'\n      AND probability.probability = 1\n      AND probability.classifier_name = 'stamp_classifier'\n      AND probability.ranking = 1\n    ORDER BY object.firstmjd ASC\n    LIMIT 10\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2871, "completion_tokens": 135, "total_tokens": 3006, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336c2b0c8190aa36b1200f687873", "custom_id": "99-2", "response": {"status_code": 200, "request_id": "eb93e991d8652515026f622c290c6c04", "body": {"id": "chatcmpl-C4XJQPAGP5HDtdyNoV4OjEdfQInLv", "object": "chat.completion", "created": 1755197400, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with a first detection date later than mjd=60310 days,\n-- a probability of 1 of being classified as an asteroid by the stamp classifier,\n-- ordered by the first detection date, and returning all columns from the 'forced_photometry' table.\n\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability = 1\n  AND p.ranking = 1\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2965, "completion_tokens": 166, "total_tokens": 3131, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336c952081909c53200896848669", "custom_id": "99-3", "response": {"status_code": 200, "request_id": "f615eb16758c67770c9e52843d421d05", "body": {"id": "chatcmpl-C4XJQ6PUE5nQkcKRGbOKX9ONy3h3P", "object": "chat.completion", "created": 1755197400, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with specific conditions and return all columns from the 'forced_photometry' table\nSELECT *\nFROM forced_photometry\nWHERE oid IN (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p\n    ON o.oid = p.oid\n    WHERE o.firstmjd > 60310\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability = 1\n      AND p.ranking = 1\n    ORDER BY o.firstmjd ASC\n    LIMIT 10\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2848, "completion_tokens": 137, "total_tokens": 2985, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336c9284819098f48f83e270a941", "custom_id": "99-4", "response": {"status_code": 200, "request_id": "e4245b0f670dab5b9ada4d6c8b3d018d", "body": {"id": "chatcmpl-C4XJShv35fPrGAmHg0fp5MZutAse6", "object": "chat.completion", "created": 1755197402, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with a first detection date later than mjd=60310,\n-- classified as 'asteroid' with a probability of 1 in the stamp classifier,\n-- ordered by the first detection date, and returning all columns from the 'forced_photometry' table.\n\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability = 1\n  AND p.ranking = 1 -- Default condition for the most likely classification\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2746, "completion_tokens": 174, "total_tokens": 2920, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ca1dc8190bf5d73e012df49c2", "custom_id": "92-0", "response": {"status_code": 200, "request_id": "008fe7d0d728a3e4e772e8abb6fa8a5f", "body": {"id": "chatcmpl-C4XJSuIZUo6mkt94SUwiZOLocE8S5", "object": "chat.completion", "created": 1755197402, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    p.classifier_version, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    (SELECT oid \n     FROM detection \n     WHERE fid = 1 AND dubious = FALSE \n     GROUP BY oid \n     HAVING COUNT(oid) >= 10) d\nON o.oid = d.oid\nINNER JOIN \n    probability p\nON o.oid = p.oid\nWHERE \n    p.ranking = 1 \n    AND p.classifier_name = 'lc_classifier'\nORDER BY \n    o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 136, "total_tokens": 3152, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ca01c8190b960cc326d5079aa", "custom_id": "92-1", "response": {"status_code": 200, "request_id": "a0ae45df1266e017a85ce6db0d693b9e", "body": {"id": "chatcmpl-C4XJShE2opLMjcQ15DHmpdnOAeebu", "object": "chat.completion", "created": 1755197402, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find ZTF objects with at least 10 detections in the g band (fid = 1),\n-- no dubious corrections in that filter, and include classification probabilities\n-- with ranking 1 for the light curve classifier. The results are limited to 500 rows.\n\nSELECT \n    obj.oid AS ztf_identifier, \n    prob.classifier_version, \n    prob.class_name, \n    prob.probability\nFROM \n    object obj\nINNER JOIN \n    (SELECT \n         det.oid\n     FROM \n         detection det\n     WHERE \n         det.fid = 1 -- g band\n         AND det.dubious = FALSE -- no dubious corrections\n     GROUP BY \n         det.oid\n     HAVING \n         COUNT(det.oid) >= 10 -- at least 10 detections\n    ) filtered_detections\nON \n    obj.oid = filtered_detections.oid\nINNER JOIN \n    probability prob\nON \n    obj.oid = prob.oid\nWHERE \n    prob.ranking = 1 -- most likely class\n    AND prob.classifier_name = 'lc_classifier' -- light curve classifier\nORDER BY \n    obj.oid ASC\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2809, "completion_tokens": 256, "total_tokens": 3065, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ca16c8190bc2b58d8f12c2097", "custom_id": "92-2", "response": {"status_code": 200, "request_id": "7ebc28626c8c0695a445771b0de1869b", "body": {"id": "chatcmpl-C4XJUYlF3lqy3RwPr0eVDDiSLO6wt", "object": "chat.completion", "created": 1755197404, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find ZTF objects with at least 10 detections in the g-band, no dubious corrections, and probabilities with ranking 1 for the light curve classifier\nSELECT \n    p.oid, \n    p.classifier_version, \n    p.class_name, \n    p.probability\nFROM \n    probability p\nINNER JOIN (\n    SELECT \n        d.oid\n    FROM \n        detection d\n    WHERE \n        d.fid = 1 -- g-band filter\n        AND d.dubious = FALSE -- no dubious corrections\n    GROUP BY \n        d.oid\n    HAVING \n        COUNT(*) >= 10 -- at least 10 detections\n) filtered_objects ON p.oid = filtered_objects.oid\nWHERE \n    p.ranking = 1 -- most likely classification\n    AND p.classifier_name = 'lc_classifier' -- light curve classifier\nORDER BY \n    p.oid ASC\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2771, "completion_tokens": 201, "total_tokens": 2972, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336caafc8190bd56881a4d121789", "custom_id": "92-3", "response": {"status_code": 200, "request_id": "24398d242fc638d00beb9dac53f5c7df", "body": {"id": "chatcmpl-C4XJUs6rvinIbhC6Szi9qbt1DZO1H", "object": "chat.completion", "created": 1755197404, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 500 ZTF objects with at least 10 detections in the g band,\n-- no dubious corrections in that filter, and include probabilities with ranking 1\n-- for the light curve classifier. The results are ordered by oid.\n\nSELECT \n    o.oid, \n    p.classifier_version, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    (SELECT \n         oid\n     FROM \n         detection\n     WHERE \n         fid = 1 -- g band\n         AND dubious = FALSE\n     GROUP BY \n         oid\n     HAVING \n         COUNT(oid) >= 10 -- at least 10 detections\n    ) d ON o.oid = d.oid\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1 -- most likely class\n    AND p.classifier_name = 'lc_classifier' -- light curve classifier\nORDER BY \n    o.oid ASC\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2815, "completion_tokens": 221, "total_tokens": 3036, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336caed08190b2cae73f2f55fb2e", "custom_id": "92-4", "response": {"status_code": 200, "request_id": "c79c5a10da4a69d5085f6ac03dc759e2", "body": {"id": "chatcmpl-C4XJVCaf8MikdQm8eBwc8dfe4rixp", "object": "chat.completion", "created": 1755197405, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    p.oid, \n    p.classifier_version, \n    p.class_name, \n    p.probability\nFROM \n    probability p\nINNER JOIN (\n    SELECT \n        d.oid\n    FROM \n        detection d\n    WHERE \n        d.fid = 1 -- g band\n        AND d.dubious = FALSE -- no dubious corrections\n    GROUP BY \n        d.oid\n    HAVING \n        COUNT(d.oid) >= 10 -- at least 10 detections\n) filtered_detections ON p.oid = filtered_detections.oid\nWHERE \n    p.ranking = 1 -- most likely class\n    AND p.classifier_name = 'lc_classifier' -- light curve classifier\nORDER BY \n    p.oid ASC\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2919, "completion_tokens": 172, "total_tokens": 3091, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336cab908190b4f7962e3993ee39", "custom_id": "102-0", "response": {"status_code": 200, "request_id": "1b7a0becfcb637fbdd5f42a2ce35f995", "body": {"id": "chatcmpl-C4XJVjfVC6lSJS5dM6IySPIOiasnz", "object": "chat.completion", "created": 1755197405, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the given conditions\nSELECT magstat.*\nFROM magstat\nINNER JOIN (\n    SELECT probability.oid\n    FROM probability\n    INNER JOIN allwise ON probability.oid = allwise.oid_catalog\n    WHERE probability.class_name = 'AGN'\n      AND probability.classifier_name = 'lc_classifier'\n      AND probability.ranking = 1\n      AND probability.probability > 0.6\n      AND allwise.w1mpro BETWEEN 12 AND 13\n) filtered_objects ON magstat.oid = filtered_objects.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3010, "completion_tokens": 132, "total_tokens": 3142, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ccc488190ae14d7fff9f9f138", "custom_id": "102-1", "response": {"status_code": 200, "request_id": "38cd21872939a4f0b2ef19bba5df853b", "body": {"id": "chatcmpl-C4XJWaciQfhOA3whw80W51Sepmav2", "object": "chat.completion", "created": 1755197406, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the given conditions\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN allwise a ON p.oid = a.oid_catalog\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND a.w1mpro BETWEEN 12 AND 13\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3040, "completion_tokens": 118, "total_tokens": 3158, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336cfd688190927c5c250c1195f8", "custom_id": "102-2", "response": {"status_code": 200, "request_id": "cab9792e3d1a5c0a1ca6236a4668eb23", "body": {"id": "chatcmpl-C4XJYhsaR5obzX85zQIw1LBsGIee5", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the conditions\nSELECT magstat.*\nFROM magstat\nINNER JOIN (\n    SELECT probability.oid\n    FROM probability\n    INNER JOIN allwise ON probability.oid = allwise.oid_catalog\n    WHERE probability.class_name = 'AGN'\n      AND probability.classifier_name = 'lc_classifier'\n      AND probability.ranking = 1\n      AND probability.probability > 0.6\n      AND allwise.w1mpro BETWEEN 12 AND 13\n) filtered_objects ON magstat.oid = filtered_objects.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2889, "completion_tokens": 131, "total_tokens": 3020, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336d4cfc81909135713c0c8c2053", "custom_id": "102-3", "response": {"status_code": 200, "request_id": "8e7bc439e067f5cb325cc3e087a743c6", "body": {"id": "chatcmpl-C4XJX7PFlWvDqpL5HplMZ6cGKoucN", "object": "chat.completion", "created": 1755197407, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the given conditions\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN allwise a ON p.oid = a.oid_catalog\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.6\n      AND a.w1mpro BETWEEN 12 AND 13\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2933, "completion_tokens": 118, "total_tokens": 3051, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336d53cc81908041f39b0c5c84d3", "custom_id": "102-4", "response": {"status_code": 200, "request_id": "080d5c840ea0ebf1ff35e6eb64393cc5", "body": {"id": "chatcmpl-C4XJXcYlmHMOlNkTvWgdwc4M6JfPk", "object": "chat.completion", "created": 1755197407, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 50 ZTF objects that satisfy the given conditions\nSELECT magstat.*\nFROM probability\nINNER JOIN allwise ON probability.oid = allwise.oid_catalog\nINNER JOIN magstat ON probability.oid = magstat.oid\nWHERE probability.class_name = 'AGN'\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.ranking = 1\n  AND probability.probability > 0.6\n  AND allwise.w1mpro BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2930, "completion_tokens": 116, "total_tokens": 3046, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336d5fb48190bf30f90f386c3460", "custom_id": "104-0", "response": {"status_code": 200, "request_id": "186df0114437df3dcc1049006a99249f", "body": {"id": "chatcmpl-C4XJY3Jwboh6kBeZQ2UAnTl0UiceE", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT \n    ss_ztf.oid, \n    ss_ztf.candid, \n    ss_ztf.ssdistnr, \n    ss_ztf.ssmagnr, \n    ss_ztf.ssnamenr, \n    detection.fid, \n    detection.fwhm, \n    detection.ncalib, \n    detection.exptime\nFROM (\n    SELECT oid \n    FROM probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND classifier_version = 'stamp_classifier_1.0.4' \n        AND class_name = 'asteroid' \n        AND probability > 0.9 \n        AND ranking = 1\n) AS filtered_probabilities\nINNER JOIN ss_ztf ON filtered_probabilities.oid = ss_ztf.oid\nINNER JOIN detection ON ss_ztf.oid = detection.oid AND ss_ztf.candid = detection.candid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3342, "completion_tokens": 206, "total_tokens": 3548, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336d534481908ff46a8129384208", "custom_id": "104-1", "response": {"status_code": 200, "request_id": "9803b8a2d2f8547d0a47054263322892", "body": {"id": "chatcmpl-C4XJXTqD7n7ZEjtZCCdv7CUwndcAB", "object": "chat.completion", "created": 1755197407, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter the probability table for asteroid classification\nWITH filtered_probability AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND class_name = 'asteroid'\n      AND probability > 0.9\n      AND ranking = 1\n),\n-- Step 2: Join with the ss_ztf table to retrieve Solar System object information\nss_ztf_info AS (\n    SELECT ss.oid, ss.candid, ss.ssdistnr, ss.ssmagnr, ss.ssnamenr\n    FROM ss_ztf AS ss\n    INNER JOIN filtered_probability AS fp\n    ON ss.oid = fp.oid\n),\n-- Step 3: Join with the detection table to retrieve candidate-related information\ndetection_info AS (\n    SELECT d.candid, d.fid, d.fwhm, d.ncalib, d.exptime\n    FROM detection AS d\n    INNER JOIN ss_ztf_info AS si\n    ON d.candid = si.candid\n)\n-- Step 4: Combine all the required columns and limit the results\nSELECT si.oid, si.candid, si.ssdistnr, si.ssmagnr, si.ssnamenr, \n       di.fid, di.fwhm, di.ncalib, di.exptime\nFROM ss_ztf_info AS si\nINNER JOIN detection_info AS di\nON si.candid = di.candid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3205, "completion_tokens": 327, "total_tokens": 3532, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336d6dec8190999227081f792a60", "custom_id": "104-2", "response": {"status_code": 200, "request_id": "77b1a2430a47c7e5d5a384970761e808", "body": {"id": "chatcmpl-C4XJXLxzcC3V5SwHYzeGex48IVSpd", "object": "chat.completion", "created": 1755197407, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    ss_ztf.oid AS ztf_object_id,\n    ss_ztf.candid AS candidate_id,\n    ss_ztf.ssdistnr AS distance_to_nearest_sso,\n    ss_ztf.ssmagnr AS mpc_archive_magnitude,\n    ss_ztf.ssnamenr AS sso_name,\n    detection.fid AS filter_id,\n    detection.fwhm AS fwhm_sextractor,\n    detection.ncalib AS ps1_calibrators_count,\n    detection.exptime AS exposure_time\nFROM \n    probability\nINNER JOIN \n    ss_ztf ON probability.oid = ss_ztf.oid\nINNER JOIN \n    detection ON ss_ztf.candid = detection.candid\nWHERE \n    probability.classifier_name = 'stamp_classifier'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'\n    AND probability.class_name = 'asteroid'\n    AND probability.probability > 0.9\n    AND probability.ranking = 1\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3289, "completion_tokens": 225, "total_tokens": 3514, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336d713c8190906f08b398d35ac6", "custom_id": "104-3", "response": {"status_code": 200, "request_id": "06fbd3029d18f6a11be8fecd66ab71f4", "body": {"id": "chatcmpl-C4XJb5yHiCgEsmmgGVMcW39Zef8ZC", "object": "chat.completion", "created": 1755197411, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query to retrieve ZTF objects classified as asteroids with probability > 0.9\nSELECT \n    ss_ztf.oid, \n    ss_ztf.candid, \n    ss_ztf.ssdistnr, \n    ss_ztf.ssmagnr, \n    ss_ztf.ssnamenr, \n    detection.fid, \n    detection.fwhm, \n    detection.ncalib, \n    detection.exptime\nFROM \n    (SELECT oid \n     FROM probability \n     WHERE ranking = 1 \n       AND classifier_name = 'stamp_classifier' \n       AND classifier_version = 'stamp_classifier_1.0.4' \n       AND probability > 0.9) AS filtered_probabilities\nINNER JOIN ss_ztf \n    ON filtered_probabilities.oid = ss_ztf.oid\nINNER JOIN detection \n    ON ss_ztf.candid = detection.candid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3110, "completion_tokens": 203, "total_tokens": 3313, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336d61888190a3d4bc74a14a04d2", "custom_id": "104-4", "response": {"status_code": 200, "request_id": "3631009510d5e68c8c29b61345d5e64a", "body": {"id": "chatcmpl-C4XJbWsy6mq6vp4n65IgHpqdiJUEp", "object": "chat.completion", "created": 1755197411, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    ss_ztf.oid AS ztf_object_id,\n    ss_ztf.candid AS candidate_id,\n    ss_ztf.ssdistnr AS distance_to_nearest_sso,\n    ss_ztf.ssmagnr AS mpc_archive_magnitude,\n    ss_ztf.ssnamenr AS sso_name,\n    detection.fid AS filter_id,\n    detection.fwhm AS fwhm_sextractor,\n    detection.ncalib AS ps1_calibrators_used,\n    detection.exptime AS exposure_time\nFROM \n    (SELECT oid \n     FROM probability \n     WHERE \n         class_name = 'asteroid' \n         AND classifier_name = 'stamp_classifier' \n         AND classifier_version = 'stamp_classifier_1.0.4' \n         AND probability > 0.9 \n         AND ranking = 1\n    ) AS filtered_probabilities\nINNER JOIN ss_ztf \n    ON filtered_probabilities.oid = ss_ztf.oid\nINNER JOIN detection \n    ON ss_ztf.candid = detection.candid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 234, "total_tokens": 3514, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336d70788190a78ee1e3c61c93c0", "custom_id": "107-0", "response": {"status_code": 200, "request_id": "0edd32f5d3d1bd7273d95b4fadd04760", "body": {"id": "chatcmpl-C4XJcZXzl6MGHZ131fTW1YBsOHfNq", "object": "chat.completion", "created": 1755197412, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT \n    obj.oid AS ztf_identifier,\n    obj.ndet AS number_of_detections,\n    obj.firstmjd AS first_detection_date,\n    obj.lastmjd AS last_detection_date,\n    prob.probability,\n    ss.candid AS candidate_identifier,\n    ss.ssdistnr AS distance_to_mpc_object,\n    ss.ssnamenr AS mpc_name,\n    det.mjd AS detection_date,\n    det.fid AS filter_identifier\nFROM \n    object obj\nINNER JOIN \n    probability prob\n    ON obj.oid = prob.oid\nINNER JOIN \n    ss_ztf ss\n    ON obj.oid = ss.oid\nINNER JOIN \n    detection det\n    ON obj.oid = det.oid\nWHERE \n    obj.ndet > 500\n    AND prob.class_name = 'asteroid'\n    AND prob.classifier_name = 'stamp_classifier'\n    AND prob.classifier_version = 'stamp_classifier_1.0.4'\n    AND prob.probability > 0.5\n    AND prob.ranking = 1\n    AND ss.ssdistnr < 2\nORDER BY \n    obj.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3786, "completion_tokens": 257, "total_tokens": 4043, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336d963c8190ac6ee71eba9c5e2c", "custom_id": "107-1", "response": {"status_code": 200, "request_id": "c01e0e2fab8a49ed2429a180de1dd871", "body": {"id": "chatcmpl-C4XJcHb1gU9cmYoKLgttghZmvpjL5", "object": "chat.completion", "created": 1755197412, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT \n    obj.oid AS ztf_identifier,\n    obj.ndet AS number_of_detections,\n    obj.firstmjd AS first_detection_date,\n    obj.lastmjd AS last_detection_date,\n    prob.probability AS classification_probability,\n    ssztf.candid AS candidate_identifier,\n    ssztf.ssdistnr AS distance_to_nearest_solar_system_object,\n    ssztf.ssnamenr AS mpc_name,\n    det.mjd AS detection_date,\n    det.fid AS filter_identifier\nFROM \n    object obj\nINNER JOIN \n    probability prob\n    ON obj.oid = prob.oid\nINNER JOIN \n    ss_ztf ssztf\n    ON obj.oid = ssztf.oid\nINNER JOIN \n    detection det\n    ON obj.oid = det.oid\nWHERE \n    obj.ndet > 500\n    AND prob.class_name = 'asteroid'\n    AND prob.classifier_name = 'stamp_classifier'\n    AND prob.classifier_version = 'stamp_classifier_1.0.4'\n    AND prob.probability > 0.5\n    AND prob.ranking = 1\n    AND ssztf.ssdistnr < 2\nORDER BY \n    obj.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3237, "completion_tokens": 276, "total_tokens": 3513, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336db9448190b61d36178e0980f8", "custom_id": "107-2", "response": {"status_code": 200, "request_id": "1b69279a08df9e79e7c0d12d2ce0d1aa", "body": {"id": "chatcmpl-C4XJcWFXt77zqGppJvTxYSsNEeZcI", "object": "chat.completion", "created": 1755197412, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT \n        o.oid, \n        o.ndet, \n        o.firstmjd, \n        o.lastmjd\n    FROM \n        object o\n    WHERE \n        o.ndet > 500\n),\nfiltered_probabilities AS (\n    SELECT \n        p.oid, \n        p.probability\n    FROM \n        probability p\n    WHERE \n        p.class_name = 'asteroid' \n        AND p.classifier_name = 'stamp_classifier' \n        AND p.classifier_version = 'stamp_classifier_1.0.4' \n        AND p.probability > 0.5 \n        AND p.ranking = 1\n),\nfiltered_ss_ztf AS (\n    SELECT \n        s.oid, \n        s.candid, \n        s.ssdistnr, \n        s.ssnamenr\n    FROM \n        ss_ztf s\n    WHERE \n        s.ssdistnr < 2\n)\nSELECT \n    o.oid AS ztf_identifier, \n    o.ndet AS number_of_detections, \n    o.firstmjd AS first_detection_date, \n    o.lastmjd AS last_detection_date, \n    p.probability, \n    s.candid AS candidate_identifier, \n    s.ssdistnr AS distance_to_mpc_object, \n    s.ssnamenr AS mpc_name, \n    d.mjd AS detection_date, \n    d.fid AS filter_identifier\nFROM \n    filtered_objects o\nINNER JOIN \n    filtered_probabilities p ON o.oid = p.oid\nINNER JOIN \n    filtered_ss_ztf s ON o.oid = s.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nORDER BY \n    o.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3326, "completion_tokens": 386, "total_tokens": 3712, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336e0df081908624c91bad9a339d", "custom_id": "107-3", "response": {"status_code": 200, "request_id": "0ee3aff48dc533a7c8299a80a00e7274", "body": {"id": "chatcmpl-C4XJfxbzOnUoQpC5f3giVwdDbaCF2", "object": "chat.completion", "created": 1755197415, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT oid, ndet, firstmjd, lastmjd\n    FROM object\n    WHERE ndet > 500\n),\nfiltered_probabilities AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    INNER JOIN filtered_objects o ON p.oid = o.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.5\n),\nfiltered_ss_ztf AS (\n    SELECT s.candid, s.ssdistnr, s.ssnamenr, s.oid\n    FROM ss_ztf s\n    INNER JOIN filtered_probabilities p ON s.oid = p.oid\n    WHERE s.ssdistnr < 2\n),\nfiltered_detections AS (\n    SELECT d.oid, d.mjd, d.fid, d.candid\n    FROM detection d\n    INNER JOIN filtered_ss_ztf s ON d.candid = s.candid\n)\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    o.firstmjd AS first_detection_date,\n    o.lastmjd AS last_detection_date,\n    p.probability,\n    s.candid AS candidate_identifier,\n    s.ssdistnr AS distance_to_mpc_object,\n    s.ssnamenr AS mpc_name,\n    d.mjd AS detection_date,\n    d.fid AS filter_identifier\nFROM filtered_objects o\nINNER JOIN filtered_probabilities p ON o.oid = p.oid\nINNER JOIN filtered_ss_ztf s ON o.oid = s.oid\nINNER JOIN filtered_detections d ON o.oid = d.oid\nORDER BY o.firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3697, "completion_tokens": 398, "total_tokens": 4095, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ea3f4819084b893e4620376e0", "custom_id": "107-4", "response": {"status_code": 200, "request_id": "ac79b649dee44e976ede3903ad4d3df3", "body": {"id": "chatcmpl-C4XJfA4AKUQ3ssTKm3CCdiDOZy3UB", "object": "chat.completion", "created": 1755197415, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT \n        o.oid, \n        o.ndet, \n        o.firstmjd, \n        o.lastmjd\n    FROM \n        object o\n    WHERE \n        o.ndet > 500\n),\nfiltered_probabilities AS (\n    SELECT \n        p.oid, \n        p.probability\n    FROM \n        probability p\n    WHERE \n        p.class_name = 'asteroid' AND \n        p.classifier_name = 'stamp_classifier' AND \n        p.classifier_version = 'stamp_classifier_1.0.4' AND \n        p.probability > 0.5 AND \n        p.ranking = 1\n),\nfiltered_ss_ztf AS (\n    SELECT \n        s.oid, \n        s.candid, \n        s.ssdistnr, \n        s.ssnamenr\n    FROM \n        ss_ztf s\n    WHERE \n        s.ssdistnr < 2\n),\njoined_results AS (\n    SELECT \n        fo.oid, \n        fo.ndet, \n        fo.firstmjd, \n        fo.lastmjd, \n        fp.probability, \n        fs.candid, \n        fs.ssdistnr, \n        fs.ssnamenr\n    FROM \n        filtered_objects fo\n    INNER JOIN \n        filtered_probabilities fp\n    ON \n        fo.oid = fp.oid\n    INNER JOIN \n        filtered_ss_ztf fs\n    ON \n        fo.oid = fs.oid\n),\nfinal_results AS (\n    SELECT \n        jr.oid, \n        jr.ndet, \n        jr.firstmjd, \n        jr.lastmjd, \n        jr.probability, \n        jr.candid, \n        jr.ssdistnr, \n        jr.ssnamenr, \n        d.mjd, \n        d.fid\n    FROM \n        joined_results jr\n    INNER JOIN \n        detection d\n    ON \n        jr.oid = d.oid AND \n        jr.candid = d.candid\n)\nSELECT \n    *\nFROM \n    final_results\nORDER BY \n    firstmjd ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3249, "completion_tokens": 460, "total_tokens": 3709, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336e1a4081908e0992d679ce9e49", "custom_id": "84-0", "response": {"status_code": 200, "request_id": "f207c5eeecced673245c3d5431efa480", "body": {"id": "chatcmpl-C4XJgYHsN1K4ilizuxuQQPSNS7rau", "object": "chat.completion", "created": 1755197416, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)\nSELECT \n    o.oid AS ztf_identifier, -- ZTF object identifier\n    a.oid_catalog AS allwise_identifier, -- ALLWISE catalog identifier\n    x.dist AS distance_between_counterparts, -- Distance between ZTF and ALLWISE counterparts\n    a.w1mpro AS w1_magnitude, -- Magnitude in WISE W1 filter\n    a.w2mpro AS w2_magnitude, -- Magnitude in WISE W2 filter\n    a.w3mpro AS w3_magnitude, -- Magnitude in WISE W3 filter\n    a.w4mpro AS w4_magnitude -- Magnitude in WISE W4 filter\nFROM \n    object o\nINNER JOIN \n    xmatch x ON o.oid = x.oid\nINNER JOIN \n    allwise a ON x.oid_catalog = a.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol'; -- Filter for the specific ZTF object\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2812, "completion_tokens": 232, "total_tokens": 3044, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336e267c81908831865c9367a32e", "custom_id": "84-1", "response": {"status_code": 200, "request_id": "72cc8ae784732ac2cbbe2a042e9e2379", "body": {"id": "chatcmpl-C4XJgx39Rj7rkzMLImqhgiNQZsIjt", "object": "chat.completion", "created": 1755197416, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)\nSELECT \n    xmatch.oid AS ztf_oid, -- ZTF object identifier\n    xmatch.oid_catalog AS allwise_oid, -- ALLWISE catalog identifier\n    xmatch.dist AS distance_arcsec, -- Distance between counterparts in arcseconds\n    allwise.w1mpro, -- Magnitude in WISE W1 filter\n    allwise.w2mpro, -- Magnitude in WISE W2 filter\n    allwise.w3mpro, -- Magnitude in WISE W3 filter\n    allwise.w4mpro -- Magnitude in WISE W4 filter\nFROM \n    xmatch\nINNER JOIN \n    allwise ON xmatch.oid_catalog = allwise.oid_catalog -- Join xmatch with allwise using oid_catalog\nWHERE \n    xmatch.oid = 'ZTF19aascdol'; -- Filter for the specific ZTF object\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2820, "completion_tokens": 212, "total_tokens": 3032, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336e429081908aec8e6b18ceead0", "custom_id": "84-2", "response": {"status_code": 200, "request_id": "cfe8334a725a7b3ffe92efb378b9eba1", "body": {"id": "chatcmpl-C4XJh9YmOfnhr8quHFCeuFGk5laMR", "object": "chat.completion", "created": 1755197417, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)\nSELECT \n    o.oid AS ztf_object_id, -- ZTF object identifier\n    xm.oid_catalog AS allwise_object_id, -- ALLWISE object identifier\n    xm.dist AS distance_arcsec, -- Distance between counterparts in arcseconds\n    aw.w1mpro, -- Magnitude in WISE W1 filter\n    aw.w2mpro, -- Magnitude in WISE W2 filter\n    aw.w3mpro, -- Magnitude in WISE W3 filter\n    aw.w4mpro -- Magnitude in WISE W4 filter\nFROM \n    object o\nINNER JOIN \n    xmatch xm ON o.oid = xm.oid -- Join with xmatch table to get ALLWISE matches\nINNER JOIN \n    allwise aw ON xm.oid_catalog = aw.oid_catalog -- Join with allwise table to get magnitudes\nWHERE \n    o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF object\nORDER BY \n    xm.dist ASC; -- Order by distance in ascending order\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2682, "completion_tokens": 248, "total_tokens": 2930, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336e3bc88190aca91f1e0febf8f0", "custom_id": "84-3", "response": {"status_code": 200, "request_id": "a611af98f01a48a72f6ba0be1600bbd4", "body": {"id": "chatcmpl-C4XJj1DRpSKpiF68uiJ7NCBVIb5Xh", "object": "chat.completion", "created": 1755197419, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)\nSELECT \n    object.oid AS ztf_identifier, -- ZTF object identifier\n    allwise.oid_catalog AS allwise_identifier, -- ALLWISE catalog identifier\n    xmatch.dist AS distance_between_counterparts, -- Distance between counterparts in arcseconds\n    allwise.w1mpro AS W1_magnitude, -- Magnitude in WISE W1 filter\n    allwise.w2mpro AS W2_magnitude, -- Magnitude in WISE W2 filter\n    allwise.w3mpro AS W3_magnitude, -- Magnitude in WISE W3 filter\n    allwise.w4mpro AS W4_magnitude -- Magnitude in WISE W4 filter\nFROM \n    object\nINNER JOIN \n    xmatch ON object.oid = xmatch.oid -- Join with xmatch table to get cross-match information\nINNER JOIN \n    allwise ON xmatch.oid_catalog = allwise.oid_catalog -- Join with allwise table to get catalog information\nWHERE \n    object.oid = 'ZTF19aascdol'; -- Filter for the specific ZTF object\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2807, "completion_tokens": 257, "total_tokens": 3064, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336e4f948190a8e8f4739d51f13a", "custom_id": "84-4", "response": {"status_code": 200, "request_id": "53b180c5a206dbeb1f989684f745a443", "body": {"id": "chatcmpl-C4XJj0mC5GwxZFKIfatK6aYzCLlAG", "object": "chat.completion", "created": 1755197419, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)\nSELECT \n    object.oid AS ztf_identifier, -- ZTF object identifier\n    xmatch.oid_catalog AS allwise_identifier, -- ALLWISE catalog identifier\n    xmatch.ang_dist AS distance_between_counterparts, -- Angular distance between counterparts\n    allwise.w1mpro, -- Magnitude in WISE filter W1\n    allwise.w2mpro, -- Magnitude in WISE filter W2\n    allwise.w3mpro, -- Magnitude in WISE filter W3\n    allwise.w4mpro  -- Magnitude in WISE filter W4\nFROM \n    object\nINNER JOIN \n    xmatch ON object.oid = xmatch.oid -- Join with xmatch table on ZTF object identifier\nINNER JOIN \n    allwise ON xmatch.oid_catalog = allwise.oid_catalog -- Join with allwise table on ALLWISE catalog identifier\nWHERE \n    object.oid = 'ZTF19aascdol' -- Filter for the specific ZTF object\nORDER BY \n    xmatch.ang_dist ASC; -- Sort results by distance in ascending order\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2864, "completion_tokens": 259, "total_tokens": 3123, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ed53c8190a2818a82791d8392", "custom_id": "96-0", "response": {"status_code": 200, "request_id": "85e289b595e87706528765d8fb943135", "body": {"id": "chatcmpl-C4XJkLgfhk9iGmMCc9h99JnGoFltV", "object": "chat.completion", "created": 1755197420, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nWITH filtered_ss_ztf AS (\n    -- Step 1: Filter the Solar System Identifiers in the ss_ztf Table\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n),\nspatial_detections AS (\n    -- Step 3: Perform a Spatial Query to Find Nearby Detections\n    SELECT d.*\n    FROM detection d\n    INNER JOIN filtered_ss_ztf ssz ON q3c_radial_query(d.ra, d.dec, ssz.ra, ssz.dec, 0.0005556)\n)\n-- Step 6: Combine the Results\nSELECT \n    ssz.*, -- All columns from the ss_ztf table\n    d.mjd, -- Detection date\n    d.fid, -- Filter identifier\n    d.isdiffpos, -- isdiffpos flag\n    d.ra, -- RA coordinate\n    d.dec, -- Dec coordinate\n    d.magpsf, -- Difference magnitude\n    d.sigmapsf -- Difference magnitude uncertainty\nFROM filtered_ss_ztf ssz\nINNER JOIN spatial_detections d ON ssz.oid = d.oid\n-- Step 5: Sort the Results\nORDER BY ssz.ssnamenr ASC, d.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2974, "completion_tokens": 279, "total_tokens": 3253, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336e646c8190b87073a76f596ce4", "custom_id": "96-1", "response": {"status_code": 200, "request_id": "5a7d5fb8bfe220ac8d079492b4327bb4", "body": {"id": "chatcmpl-C4XJkstlbUPmIcGYnE3XM7NdBFlwD", "object": "chat.completion", "created": 1755197420, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nWITH ss_objects AS (\n    -- Step 1: Filter the ss_ztf table for the specified Solar System identifiers\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n),\ndetections_within_2arcsec AS (\n    -- Step 3: Perform a spatial query to find detections within 2 arcseconds\n    SELECT d.*\n    FROM detection d\n    INNER JOIN ss_objects ss\n    ON q3c_radial_query(d.ra, d.dec, ss.ra, ss.dec, 2/3600.0) -- 2 arcseconds converted to degrees\n)\n-- Step 6: Combine the results and select the required columns\nSELECT \n    ss.*, \n    d.mjd AS detection_date, \n    d.fid AS filter_identifier, \n    d.isdiffpos, \n    d.ra, \n    d.dec, \n    d.magpsf, \n    d.sigmapsf\nFROM ss_objects ss\nINNER JOIN detections_within_2arcsec d\nON ss.oid = d.oid\n-- Step 7: Sort the results\nORDER BY ss.ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3045, "completion_tokens": 261, "total_tokens": 3306, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336e853081909d4f480b3347a20f", "custom_id": "96-2", "response": {"status_code": 200, "request_id": "ed9c7f5a029e1e1710cdc23f4a8a6bf9", "body": {"id": "chatcmpl-C4XJYrIxRFOp51OLffu7Mgw4yooK3", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH catalog AS (\n    -- Define the Solar System objects of interest with their coordinates\n    SELECT '2003FP134' AS source_id, 0.0 AS ra, 0.0 AS dec -- Replace 0.0 with actual RA and DEC for 2003FP134\n    UNION ALL\n    SELECT '2009UK56' AS source_id, 0.0 AS ra, 0.0 AS dec -- Replace 0.0 with actual RA and DEC for 2009UK56\n),\nfiltered_ss_ztf AS (\n    -- Filter the ss_ztf table for the specified Solar System objects\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n),\nspatial_match AS (\n    -- Perform a spatial cross-match between the catalog and detection tables\n    SELECT d.*\n    FROM catalog c\n    JOIN detection d\n    ON q3c_join(c.ra, c.dec, d.ra, d.dec, 0.0005556) -- 2 arcseconds in degrees\n),\njoined_data AS (\n    -- Join the filtered ss_ztf table with the spatially matched detections\n    SELECT \n        ss_ztf.*,\n        detection.mjd,\n        detection.fid,\n        detection.isdiffpos,\n        detection.ra,\n        detection.dec,\n        detection.magpsf,\n        detection.sigmapsf\n    FROM filtered_ss_ztf\n    INNER JOIN spatial_match AS detection\n    ON filtered_ss_ztf.oid = detection.oid\n)\n-- Select the required columns and sort the results\nSELECT *\nFROM joined_data\nORDER BY ssnamenr, mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3099, "completion_tokens": 355, "total_tokens": 3454, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ec15081909725d659aa0f5ef6", "custom_id": "96-3", "response": {"status_code": 200, "request_id": "31b87552fe48fd0f353f7050c8fac206", "body": {"id": "chatcmpl-C4XJkP8wbKK5nqDVZxEb5BimKxeTX", "object": "chat.completion", "created": 1755197420, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nWITH ss_objects AS (\n    -- Step 1: Filter the ss_ztf table for the specified Solar System identifiers\n    SELECT *\n    FROM ss_ztf\n    WHERE ssnamenr IN ('2003FP134', '2009UK56')\n),\ndetections_within_2arcsec AS (\n    -- Step 3: Perform a spatial query to find detections within 2 arcseconds\n    SELECT d.*\n    FROM detection d\n    INNER JOIN ss_objects ss\n    ON q3c_radial_query(d.ra, d.dec, ss.ra, ss.dec, 2/3600.0) -- 2 arcseconds converted to degrees\n)\n-- Step 4: Select the required columns and combine results\nSELECT \n    ss.*, \n    d.mjd AS detection_date, \n    d.fid AS filter_identifier, \n    d.isdiffpos, \n    d.ra, \n    d.dec, \n    d.magpsf, \n    d.sigmapsf\nFROM ss_objects ss\nINNER JOIN detections_within_2arcsec d\nON ss.oid = d.oid\n-- Step 6: Sort the results\nORDER BY ss.ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2888, "completion_tokens": 260, "total_tokens": 3148, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ed1a08190acd0e336d60f2c7d", "custom_id": "96-4", "response": {"status_code": 200, "request_id": "69fc898f0737bfda5cb00907c6f85814", "body": {"id": "chatcmpl-C4XJYTSQ8HWqnUDSohWB41Zc5mosB", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- [FINAL QUERY HERE]\nSELECT \n    ss_ztf.*,\n    detection.mjd,\n    detection.fid,\n    detection.isdiffpos,\n    detection.ra,\n    detection.dec,\n    detection.magpsf,\n    detection.sigmapsf\nFROM \n    ss_ztf\nINNER JOIN \n    detection\nON \n    ss_ztf.oid = detection.oid\nWHERE \n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\n    AND q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra, ss_ztf.dec, 2/3600.0)\nORDER BY \n    ss_ztf.ssnamenr ASC, \n    detection.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3008, "completion_tokens": 163, "total_tokens": 3171, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336ef2e48190a9ef7899f93ff598", "custom_id": "94-0", "response": {"status_code": 200, "request_id": "8341401234974242cb789eba1716ade5", "body": {"id": "chatcmpl-C4XJYX9ie3hv5cCOqDJiGsKcH59Ej", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from 'object' and 'reference' tables for ZTF objects with a reference change\n-- Limit the result to 50 rows\nSELECT *\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2367, "completion_tokens": 63, "total_tokens": 2430, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336f0fcc8190ab781d8586011e03", "custom_id": "94-1", "response": {"status_code": 200, "request_id": "643824506c848ba5588a5ab38d8a2816", "body": {"id": "chatcmpl-C4XJYwhwD40pHFopOFnaysolog0HL", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from 'object' and 'reference' tables for ZTF objects with a reference change\n-- Limit the result to 50 rows\nSELECT *\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2477, "completion_tokens": 63, "total_tokens": 2540, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336f59ec8190a165d3311e184ccc", "custom_id": "94-2", "response": {"status_code": 200, "request_id": "f091afb6f0c8bdc2905dab484ba91d37", "body": {"id": "chatcmpl-C4XJYGqd8qwBmDT02b4qvMJVHETh8", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from 'object' and 'reference' tables for ZTF objects with a reference change\n-- Limit the result to 50 rows\nSELECT *\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2367, "completion_tokens": 63, "total_tokens": 2430, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336f0e908190943e3fb788b20d8e", "custom_id": "94-3", "response": {"status_code": 200, "request_id": "8a2ca5a3d3f2bb109069bd4ca73d807b", "body": {"id": "chatcmpl-C4XJbbyIskekyGqhVfyWMQBBM5rnQ", "object": "chat.completion", "created": 1755197411, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from 'object' and 'reference' tables for ZTF objects with a reference change\n-- Limit the result to 50 rows\nSELECT *\nFROM object\nINNER JOIN reference ON object.oid = reference.oid\nWHERE object.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2439, "completion_tokens": 63, "total_tokens": 2502, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336f2d24819098ee07244b5d2456", "custom_id": "94-4", "response": {"status_code": 200, "request_id": "e6b23e6144e84787a59fee3cb18d8d20", "body": {"id": "chatcmpl-C4XJc5AybjkOCUJVEKe2V9P7qsWSA", "object": "chat.completion", "created": 1755197412, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from the 'object' table for ZTF objects that had a change in the reference\nSELECT * \nFROM object\nWHERE reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2501, "completion_tokens": 42, "total_tokens": 2543, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e337006ac8190a39c95c2ef3d8752", "custom_id": "90-0", "response": {"status_code": 200, "request_id": "26b0c19bf76ee0dbe6c77da2e520c8cd", "body": {"id": "chatcmpl-C4XJc7qNTsVdVMRzJPyL2OS49lIKm", "object": "chat.completion", "created": 1755197412, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 100 ZTF objects with a multiband period lower than 5 days\n-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table\n-- for the light curve classifier with rankings either 1 or 2.\n\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3081, "completion_tokens": 141, "total_tokens": 3222, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336f57748190b0be1deb838e2917", "custom_id": "90-1", "response": {"status_code": 200, "request_id": "ff01d638c0d48859dfa3be21fe1f7708", "body": {"id": "chatcmpl-C4XJdKTewuwAn22EKzKMFy45fbL1Z", "object": "chat.completion", "created": 1755197413, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 100 ZTF objects with a multiband period lower than 5 days\n-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table\n-- for the light curve classifier with rankings either 1 or 2.\n\nSELECT p.*\nFROM probability p\nINNER JOIN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n) f ON p.oid = f.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2868, "completion_tokens": 157, "total_tokens": 3025, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336f90ec81909cfd3166e0a266fe", "custom_id": "90-2", "response": {"status_code": 200, "request_id": "5f94a226906a2d228a2366f502aadaab", "body": {"id": "chatcmpl-C4XJdpuVrdb6qCoiw9CgglVBLv4HS", "object": "chat.completion", "created": 1755197413, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 100 ZTF objects with a multiband period lower than 5 days\n-- in the 'lc_classifier_1.2.1-P' feature version. Returns all columns from the 'probability' table\n-- for such objects, including only data for the light curve classifier, with rankings either 1 or 2.\n\nSELECT p.*\nFROM probability p\nINNER JOIN (\n    SELECT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = 'lc_classifier_1.2.1-P'\n) filtered_features\nON p.oid = filtered_features.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2770, "completion_tokens": 174, "total_tokens": 2944, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336f94108190ba23060e7c6725a3", "custom_id": "90-3", "response": {"status_code": 200, "request_id": "1b49683138fe32c4044f4a37b61b2fee", "body": {"id": "chatcmpl-C4XJfHwrxQvjuAntFV5mlWFxklfQr", "object": "chat.completion", "created": 1755197415, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 100 ZTF objects with a multiband period lower than 5 days\n-- in the 'lc_classifier_1.2.1-P' feature version. Returns all columns from the 'probability' table\n-- for such objects, including only data for the light curve classifier, with rankings either 1 or 2.\n\nSELECT p.*\nFROM probability p\nINNER JOIN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n      AND value < 5\n      AND version = 'lc_classifier_1.2.1-P'\n) f ON p.oid = f.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2916, "completion_tokens": 165, "total_tokens": 3081, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336f90748190a3dbdb9c091803b9", "custom_id": "90-4", "response": {"status_code": 200, "request_id": "d1ec606e13c55a0cd0ecf06fb002cc94", "body": {"id": "chatcmpl-C4XJfviPUQftWJvlomCXzt4STqbxe", "object": "chat.completion", "created": 1755197415, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM probability\nWHERE oid IN (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = 'lc_classifier_1.2.1-P'\n)\nAND classifier_name = 'lc_classifier'\nAND ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2880, "completion_tokens": 83, "total_tokens": 2963, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336fd2588190ade3e9582ee8b9b1", "custom_id": "100-0", "response": {"status_code": 200, "request_id": "752b46f3d0d3b2e489e704433cf20455", "body": {"id": "chatcmpl-C4XJggC33u2hcUZAFJbb7S2pxbgbY", "object": "chat.completion", "created": 1755197416, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    magpsf AS detection_mag, \n    sigmapsf AS detection_mag_uncertainty, \n    diffmaglim, \n    NULL AS forced_mag, \n    NULL AS forced_mag_uncertainty, \n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    NULL AS isdiffpos, \n    NULL AS detection_mag, \n    NULL AS detection_mag_uncertainty, \n    diffmaglim, \n    NULL AS forced_mag, \n    NULL AS forced_mag_uncertainty, \n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    NULL AS detection_mag, \n    NULL AS detection_mag_uncertainty, \n    diffmaglim, \n    mag AS forced_mag, \n    e_mag AS forced_mag_uncertainty, \n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3375, "completion_tokens": 328, "total_tokens": 3703, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336fceb0819088cd33da324533e6", "custom_id": "100-1", "response": {"status_code": 200, "request_id": "bfde005a08a902ddaae6aec05c2def4a", "body": {"id": "chatcmpl-C4XJgDRK6THjkUq4YlYy8cHbA5tbW", "object": "chat.completion", "created": 1755197416, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\n-- with the specified columns and a column indicating the table of origin.\n\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    isdiffpos AS isdiffpos_flag,\n    magpsf AS detection_difference_magnitude,\n    sigmapsf AS detection_difference_magnitude_uncertainty,\n    diffmaglim AS five_sigma_magnitude_limit,\n    NULL AS forced_difference_magnitude,\n    NULL AS forced_difference_magnitude_uncertainty,\n    'detection' AS table\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION\n\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    NULL AS isdiffpos_flag,\n    NULL AS detection_difference_magnitude,\n    NULL AS detection_difference_magnitude_uncertainty,\n    diffmaglim AS five_sigma_magnitude_limit,\n    NULL AS forced_difference_magnitude,\n    NULL AS forced_difference_magnitude_uncertainty,\n    'non_detection' AS table\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION\n\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    isdiffpos AS isdiffpos_flag,\n    NULL AS detection_difference_magnitude,\n    NULL AS detection_difference_magnitude_uncertainty,\n    diffmaglim AS five_sigma_magnitude_limit,\n    mag AS forced_difference_magnitude,\n    e_mag AS forced_difference_magnitude_uncertainty,\n    'forced_photometry' AS table\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY epoch_date;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3426, "completion_tokens": 383, "total_tokens": 3809, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336fdd7c81908bbfb2a873630e27", "custom_id": "100-2", "response": {"status_code": 200, "request_id": "f20842f61de0c2791f09b92426bcaa86", "body": {"id": "chatcmpl-C4XJhuSR8i1a2aiFolQUwF7rDCMaM", "object": "chat.completion", "created": 1755197417, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\n-- Combine data from detection, non_detection, and forced_photometry tables into a single output table\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    magpsf, \n    sigmapsf, \n    diffmaglim, \n    NULL AS mag_corr, \n    NULL AS e_mag_corr, \n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    NULL AS isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    NULL AS mag_corr, \n    NULL AS e_mag_corr, \n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    mag_corr, \n    e_mag_corr, \n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3459, "completion_tokens": 326, "total_tokens": 3785, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e336fe9f08190b3636578302c24b9", "custom_id": "100-3", "response": {"status_code": 200, "request_id": "83d48c7a2215fc6d769d0c2b63a0f09f", "body": {"id": "chatcmpl-C4XJiepOLXquwjii0sUL31YeVnJgH", "object": "chat.completion", "created": 1755197418, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\n-- and return all epochs in the same output table with the specified columns.\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    magpsf, \n    sigmapsf, \n    diffmaglim, \n    NULL AS mag, \n    NULL AS e_mag, \n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    NULL AS isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    NULL AS mag, \n    NULL AS e_mag, \n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    mag, \n    e_mag, \n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3428, "completion_tokens": 316, "total_tokens": 3744, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e33707e348190aca3f7519124135c", "custom_id": "100-4", "response": {"status_code": 200, "request_id": "ec69ad6917230494e1936995a880a87d", "body": {"id": "chatcmpl-C4XJiYg7deIAI532sVPj22KgW1hka", "object": "chat.completion", "created": 1755197418, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'\n-- and return all epochs in the same output table with the specified columns.\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    magpsf, \n    sigmapsf, \n    NULL AS mag, \n    NULL AS e_mag, \n    diffmaglim, \n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    NULL AS isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    NULL AS mag, \n    NULL AS e_mag, \n    diffmaglim, \n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    mag AS mag, \n    e_mag AS e_mag, \n    diffmaglim, \n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3340, "completion_tokens": 321, "total_tokens": 3661, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e337014388190a3aeab9c8517b66d", "custom_id": "106-0", "response": {"status_code": 200, "request_id": "af548a2f31fe8b724466488711d1d751", "body": {"id": "chatcmpl-C4XJkAJH8Ffpy5yI3KxPvZGzDW5Og", "object": "chat.completion", "created": 1755197420, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects with more than 10 detections\nWITH filtered_objects AS (\n    SELECT oid, ndet, firstmjd\n    FROM object\n    WHERE ndet > 10\n),\n\n-- Step 2: Filter probabilities for the stamp classifier\nstamp_classifier_filter AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE class_name = 'bogus'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n      AND ranking = 1\n),\n\n-- Step 3: Filter probabilities for the light curve classifier top level\nlc_classifier_filter AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n      AND ranking = 1\n)\n\n-- Step 4: Combine the filters using INNER JOINs and select the required columns\nSELECT \n    fo.oid,\n    fo.ndet,\n    fo.firstmjd,\n    scf.prob_stamp_bogus,\n    lcf.prob_lc_transient\nFROM filtered_objects fo\nINNER JOIN stamp_classifier_filter scf ON fo.oid = scf.oid\nINNER JOIN lc_classifier_filter lcf ON fo.oid = lcf.oid\nORDER BY fo.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3234, "completion_tokens": 307, "total_tokens": 3541, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e337058b481908f4aa2b2f08d2680", "custom_id": "106-1", "response": {"status_code": 200, "request_id": "bde3404b93ec54f888855c02ac6a619c", "body": {"id": "chatcmpl-C4XJkBm0EWLbL6hHKt4DOVqHnB9AD", "object": "chat.completion", "created": 1755197420, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query to find ZTF objects satisfying the given conditions\nSELECT \n    o.oid AS ztf_identifier, \n    o.ndet AS number_of_detections, \n    o.firstmjd AS first_detection_date, \n    p1.probability AS prob_stamp_bogus, \n    p2.probability AS prob_lc_transient\nFROM \n    object o\nINNER JOIN \n    probability p1 \n    ON o.oid = p1.oid\n    AND p1.class_name = 'bogus'\n    AND p1.classifier_name = 'stamp_classifier'\n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.probability > 0.7\nINNER JOIN \n    probability p2 \n    ON o.oid = p2.oid\n    AND p2.class_name = 'Transient'\n    AND p2.classifier_name = 'lc_classifier_top'\n    AND p2.probability > 0.9\nWHERE \n    o.ndet > 10\nORDER BY \n    o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3513, "completion_tokens": 235, "total_tokens": 3748, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3370471c8190bcee1d47e21bb0d8", "custom_id": "106-2", "response": {"status_code": 200, "request_id": "55b8c11a8206ca91af4584d6facae514", "body": {"id": "chatcmpl-C4XJl6jyCikix50B6N5Ad1tff8SKR", "object": "chat.completion", "created": 1755197421, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects with more than 10 detections\nWITH filtered_objects AS (\n    SELECT oid, ndet, firstmjd\n    FROM object\n    WHERE ndet > 10\n),\n-- Step 2: Filter probabilities for the stamp classifier\nstamp_classifier AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE class_name = 'bogus'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n),\n-- Step 3: Filter probabilities for the light curve classifier top level\nlc_classifier_top AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n)\n-- Step 4: Combine the results using INNER JOINs\nSELECT \n    fo.oid, \n    fo.ndet, \n    fo.firstmjd, \n    sc.prob_stamp_bogus, \n    lc.prob_lc_transient\nFROM filtered_objects fo\nINNER JOIN stamp_classifier sc ON fo.oid = sc.oid\nINNER JOIN lc_classifier_top lc ON fo.oid = lc.oid\n-- Step 5: Order the results by the ZTF identifier of objects classified as bogus in the stamp classifier\nORDER BY fo.oid\n-- Step 6: Limit the number of results to 30\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3286, "completion_tokens": 321, "total_tokens": 3607, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e33705e788190a641757616b1a3a1", "custom_id": "106-3", "response": {"status_code": 200, "request_id": "52ffedec10931420aed1fe6e73d54fb1", "body": {"id": "chatcmpl-C4XJYd1cBvee9gdhg2ATsaQ6ODV8d", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query to retrieve ZTF objects based on the specified conditions\nSELECT \n    o.oid, \n    o.ndet, \n    o.firstmjd, \n    p_stamp.probability AS prob_stamp_bogus, \n    p_lc.probability AS prob_lc_transient\nFROM \n    object o\nINNER JOIN \n    probability p_stamp\n    ON o.oid = p_stamp.oid\n    AND p_stamp.class_name = 'bogus'\n    AND p_stamp.classifier_name = 'stamp_classifier'\n    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp.probability > 0.7\nINNER JOIN \n    probability p_lc\n    ON o.oid = p_lc.oid\n    AND p_lc.class_name = 'Transient'\n    AND p_lc.classifier_name = 'lc_classifier_top'\n    AND p_lc.probability > 0.9\nWHERE \n    o.ndet > 10\nORDER BY \n    p_stamp.probability DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3478, "completion_tokens": 231, "total_tokens": 3709, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e33708b3c8190adedb6d55cd2e0ef", "custom_id": "106-4", "response": {"status_code": 200, "request_id": "178b7ccf0bc0906c3cdebf1313b81e58", "body": {"id": "chatcmpl-C4XJZqjaWIMz3zCNx4ktS5UfGyc1Q", "object": "chat.completion", "created": 1755197409, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects with more than 10 detections\nWITH filtered_objects AS (\n    SELECT oid, ndet, firstmjd\n    FROM object\n    WHERE ndet > 10\n),\n-- Step 2: Filter probabilities for the stamp classifier\nstamp_classifier AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name = 'bogus'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n      AND ranking = 1\n),\n-- Step 3: Filter probabilities for the light curve classifier top level\nlc_classifier_top AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_top'\n      AND class_name = 'Transient'\n      AND probability > 0.9\n      AND ranking = 1\n)\n-- Step 4: Combine the filters using INNER JOINs\nSELECT \n    fo.oid,\n    fo.ndet,\n    fo.firstmjd,\n    sc.prob_stamp_bogus,\n    lc.prob_lc_transient\nFROM filtered_objects fo\nINNER JOIN stamp_classifier sc ON fo.oid = sc.oid\nINNER JOIN lc_classifier_top lc ON fo.oid = lc.oid\n-- Step 5: Order the results by ZTF identifier of objects classified as bogus in the stamp classifier\nORDER BY fo.oid\n-- Step 6: Limit the results to at most 30\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3180, "completion_tokens": 330, "total_tokens": 3510, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3370a93c819098056ff0d949ec5d", "custom_id": "39-0", "response": {"status_code": 200, "request_id": "28140b352652f185bffcb9cd16ceea1e", "body": {"id": "chatcmpl-C4XJZ8ADXOVS4mvCb5g9T74J8b3S8", "object": "chat.completion", "created": 1755197409, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter objects classified as 'CV/Nova' by the 'lc_classifier_stochastic' classifier\nWITH classified_objects AS (\n    SELECT \n        p.oid\n    FROM \n        probability p\n    WHERE \n        p.ranking = 1\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.class_name = 'CV/Nova'\n),\n\n-- Subquery to filter objects with ndet <= 50\nfiltered_objects AS (\n    SELECT \n        o.oid\n    FROM \n        object o\n    INNER JOIN \n        classified_objects co ON o.oid = co.oid\n    WHERE \n        o.ndet <= 50\n),\n\n-- Subquery to filter detections in the r-band and calculate the maximum rise in corrected PSF magnitude\nr_band_detections AS (\n    SELECT \n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.magpsf_corr,\n        MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid) AS max_rise\n    FROM \n        detection d\n    INNER JOIN \n        filtered_objects fo ON d.oid = fo.oid\n    WHERE \n        d.fid = 2 -- r-band filter\n)\n\n-- Final query to retrieve the required columns and limit the results to 1000 rows\nSELECT \n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    magpsf,\n    sigmapsf,\n    magpsf_corr,\n    max_rise\nFROM \n    r_band_detections\nORDER BY \n    oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3401, "completion_tokens": 377, "total_tokens": 3778, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3370a76081908eb91f8bd8b2c0d8", "custom_id": "39-1", "response": {"status_code": 200, "request_id": "c9a611f93bbf6589edea5cb0b7cd8563", "body": {"id": "chatcmpl-C4XJYgMBKQuBMu42cv1tQD5w4iZkZ", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nWITH classification_filter AS (\n    SELECT \n        p.oid\n    FROM \n        probability p\n    WHERE \n        p.ranking = 1\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.class_name = 'CV/Nova'\n),\nobject_filter AS (\n    SELECT \n        o.oid\n    FROM \n        object o\n    INNER JOIN \n        classification_filter cf\n    ON \n        o.oid = cf.oid\n    WHERE \n        o.ndet <= 50\n),\ndetection_filter AS (\n    SELECT \n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.magpsf_corr\n    FROM \n        detection d\n    INNER JOIN \n        object_filter ofilt\n    ON \n        d.oid = ofilt.oid\n    WHERE \n        d.fid = 2 -- r-band filter\n),\nmagnitude_rise AS (\n    SELECT \n        df.oid,\n        MAX(df.magpsf_corr) - MIN(df.magpsf_corr) AS max_rise\n    FROM \n        detection_filter df\n    GROUP BY \n        df.oid\n)\nSELECT \n    df.oid AS object_identifier,\n    df.candid AS candidate_identifier,\n    df.f_id AS filter_id,\n    df.ra AS coordinates_ra,\n    df.dec AS coordinates_dec,\n    df.magpsf AS magnitude,\n    df.sigmapsf AS magnitude_errors,\n    df.magpsf_corr AS corrected_difference_magnitude,\n    mr.max_rise AS maximum_rise_from_minimum\nFROM \n    detection_filter df\nINNER JOIN \n    magnitude_rise mr\nON \n    df.oid = mr.oid\nORDER BY \n    df.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3396, "completion_tokens": 390, "total_tokens": 3786, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3370bf248190abeb195a56b983d0", "custom_id": "39-2", "response": {"status_code": 200, "request_id": "ab28a9bb9e8aac61f3b408aeb5835b56", "body": {"id": "chatcmpl-C4XJYIkHzkTw2US24XvjeCGrenpgr", "object": "chat.completion", "created": 1755197408, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nWITH classified_objects AS (\n    SELECT \n        p.oid\n    FROM \n        probability p\n    WHERE \n        p.ranking = 1\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.class_name = 'CV/Nova'\n),\nfiltered_objects AS (\n    SELECT \n        o.oid\n    FROM \n        object o\n    INNER JOIN \n        classified_objects co\n    ON \n        o.oid = co.oid\n    WHERE \n        o.ndet <= 50\n),\nr_band_detections AS (\n    SELECT \n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.magpsf_corr\n    FROM \n        detection d\n    INNER JOIN \n        filtered_objects fo\n    ON \n        d.oid = fo.oid\n    WHERE \n        d.fid = 2 -- r-band filter\n),\nmagnitude_rise AS (\n    SELECT \n        oid,\n        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise\n    FROM \n        r_band_detections\n    GROUP BY \n        oid\n)\nSELECT \n    rbd.oid,\n    rbd.candid,\n    rbd.f_id,\n    rbd.ra,\n    rbd.dec,\n    rbd.magpsf,\n    rbd.sigmapsf,\n    rbd.magpsf_corr,\n    mr.max_rise\nFROM \n    r_band_detections rbd\nINNER JOIN \n    magnitude_rise mr\nON \n    rbd.oid = mr.oid\nORDER BY \n    rbd.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3432, "completion_tokens": 370, "total_tokens": 3802, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3370c3fc81909e4e167ab6c57aec", "custom_id": "39-3", "response": {"status_code": 200, "request_id": "070ddab2b1f60b88514d42f5e6e1395a", "body": {"id": "chatcmpl-C4XJcBc4fCG86mQQX0a4UfHJwK5RQ", "object": "chat.completion", "created": 1755197412, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT \n    d.oid AS object_identifier,\n    d.candid AS candidate_identifier,\n    d.fid AS f_id,\n    d.ra AS coordinates_ra,\n    d.dec AS coordinates_dec,\n    d.magpsf AS magnitude,\n    d.sigmapsf AS magnitude_errors,\n    d.magpsf_corr AS corrected_magnitude,\n    (MAX(d.magpsf_corr) - MIN(d.magpsf_corr)) AS max_rise_from_min\nFROM \n    detection d\nINNER JOIN \n    object o ON d.oid = o.oid\nINNER JOIN \n    (SELECT oid \n     FROM probability \n     WHERE class_name = 'CV/Nova' \n       AND classifier_name = 'lc_classifier_stochastic' \n       AND ranking = 1) p ON o.oid = p.oid\nWHERE \n    o.ndet <= 50\n    AND d.fid = 2 -- r-band filter\nGROUP BY \n    d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\nORDER BY \n    d.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3284, "completion_tokens": 247, "total_tokens": 3531, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
{"id": "batch_req_689e3370e7108190b6f25dea8862b140", "custom_id": "39-4", "response": {"status_code": 200, "request_id": "7db66cb180860b3563b79f3441e36a84", "body": {"id": "chatcmpl-C4XJdEqX0IA03eQWuFs0gUYWhKCRO", "object": "chat.completion", "created": 1755197413, "model": "gpt-4o-2024-11-20", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Final Query\nSELECT \n    d.oid, \n    d.candid, \n    d.fid AS f_id, \n    d.ra, \n    d.dec, \n    d.magpsf, \n    d.sigmapsf, \n    d.magpsf_corr, \n    (MAX(d.magpsf_corr) - MIN(d.magpsf_corr)) AS max_rise_from_min\nFROM \n    detection d\nINNER JOIN \n    (SELECT \n         o.oid\n     FROM \n         object o\n     INNER JOIN \n         (SELECT \n              p.oid\n          FROM \n              probability p\n          WHERE \n              p.class_name = 'CV/Nova' \n              AND p.classifier_name = 'lc_classifier_stochastic' \n              AND p.ranking = 1\n         ) AS filtered_probabilities\n     ON \n         o.oid = filtered_probabilities.oid\n     WHERE \n         o.ndet <= 50\n    ) AS filtered_objects\nON \n    d.oid = filtered_objects.oid\nWHERE \n    d.fid = 2 -- r-band filter\nGROUP BY \n    d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\nORDER BY \n    d.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3379, "completion_tokens": 284, "total_tokens": 3663, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f0e307537d"}}, "error": null}
