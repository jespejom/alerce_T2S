{"id": "batch_req_68f952602f448190959b3570e67ccd27", "custom_id": "8-2", "response": {"status_code": 200, "request_id": "9eeb2f03d8769767c5e9f6e150cdeed8", "body": {"id": "chatcmpl-CTaoFDsMzKg9kOnCDNE7AjMtK12sS", "object": "chat.completion", "created": 1761169043, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE probability.class_name = 'SN'\n  AND probability.classifier_name = 'stamp_classifier'\n  AND object.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND (probability.probability > 0.5 OR object.ndet >= 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3230, "completion_tokens": 80, "total_tokens": 3310, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95260551081909e9c7b1414e4263b", "custom_id": "8-3", "response": {"status_code": 200, "request_id": "32446952ff64c3c2ade3f8c9963d4a37", "body": {"id": "chatcmpl-CTaoFkVdUq8kJUftRAMOwbTYGMwW3", "object": "chat.completion", "created": 1761169043, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE object.firstmjd BETWEEN 60173.0 AND 60177.0\n  AND probability.class_name = 'SN'\n  AND probability.classifier_name = 'stamp_classifier'\n  AND probability.ranking = 1\n  AND (probability.probability > 0.5 OR object.ndet >= 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3213, "completion_tokens": 89, "total_tokens": 3302, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526025b08190a4149ad1dd979266", "custom_id": "8-4", "response": {"status_code": 200, "request_id": "9fdacca027f27654eebb482559410849", "body": {"id": "chatcmpl-CTaoIOkyc5Ttr914D75S6CtMEqpA0", "object": "chat.completion", "created": 1761169046, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE object.firstmjd BETWEEN 60173.0 AND 60177.0\nAND probability.class_name = 'SN'\nAND probability.classifier_name = 'stamp_classifier'\nAND (probability.probability > 0.5 OR object.ndet >= 2)\nAND probability.ranking = 1; -- Ensures only the most likely class is considered\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3131, "completion_tokens": 97, "total_tokens": 3228, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_def8a90fd4"}}, "error": null}
{"id": "batch_req_68f952602a2881909117de1e88ce1cf5", "custom_id": "27-2", "response": {"status_code": 200, "request_id": "2e095d47e2d61db912c9b30ebb7822a6", "body": {"id": "chatcmpl-CTaoMDczhSe3AmAc35QSsWVYYTpOf", "object": "chat.completion", "created": 1761169050, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability ON object.oid = probability.oid\nWHERE \n    object.ndet >= 100\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.class_name = 'CEP'\n    AND probability.ranking = 1\n    AND probability.probability > 0.76;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3266, "completion_tokens": 148, "total_tokens": 3414, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952604ba481909fa6297b4e3b77dd", "custom_id": "27-3", "response": {"status_code": 200, "request_id": "2799d8bcd348b759c838915f5f4720cd", "body": {"id": "chatcmpl-CTaoR4aSxOB5pYqcyrpMfWr0cexFF", "object": "chat.completion", "created": 1761169055, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_max, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 100\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'CEP'\n    AND p.ranking = 1\n    AND p.probability > 0.76;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3241, "completion_tokens": 150, "total_tokens": 3391, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95260301081909a1e2403003e087e", "custom_id": "27-4", "response": {"status_code": 200, "request_id": "799241ca8e6414793a88a5aa796c1159", "body": {"id": "chatcmpl-CTaoRWmEGWUyiH24ZvKTnsinyNvVR", "object": "chat.completion", "created": 1761169055, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    object.meanra, \n    object.meandec, \n    object.ndet, \n    object.firstmjd, \n    object.deltajd, \n    object.g_r_max, \n    probability.classifier_name, \n    probability.class_name, \n    probability.ranking, \n    probability.probability\nFROM \n    object\nINNER JOIN \n    probability ON object.oid = probability.oid\nWHERE \n    object.ndet >= 100\n    AND probability.class_name = 'CEP'\n    AND probability.probability > 0.76\n    AND probability.ranking = 1\n    AND probability.classifier_name = 'lc_classifier';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3222, "completion_tokens": 148, "total_tokens": 3370, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952602a108190bf6eb3c3924c0f41", "custom_id": "17-2", "response": {"status_code": 200, "request_id": "739e18876e0e554d99c40c8f1f0731db", "body": {"id": "chatcmpl-CTaocPDAa6SyckZeOsxu5UhRsXKad", "object": "chat.completion", "created": 1761169066, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n),\nr_band_variability AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n      AND magsigma > 0\n      AND oid IN (SELECT oid FROM agn_objects)\n),\ng_band_no_variability AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1\n      AND (ndet = 0 OR magsigma = 0)\n      AND oid IN (SELECT oid FROM agn_objects)\n),\nfinal_oids AS (\n    SELECT oid\n    FROM r_band_variability\n    INTERSECT\n    SELECT oid\n    FROM g_band_no_variability\n)\nSELECT *\nFROM magstat\nWHERE oid IN (SELECT oid FROM final_oids)\nORDER BY magsigma ASC, oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3484, "completion_tokens": 196, "total_tokens": 3680, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_def8a90fd4"}}, "error": null}
{"id": "batch_req_68f95260f2988190ae413f5d5634a917", "custom_id": "17-3", "response": {"status_code": 200, "request_id": "346f90b30bfc176eab7c9e1f2396c7da", "body": {"id": "chatcmpl-CTaocdc5xh3bMhpnqx24mpHMKP2rf", "object": "chat.completion", "created": 1761169066, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query to filter objects classified as AGN\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Sub-query to check for variability in the r band\nvariability_r_band AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2 -- r band\n      AND magsigma > 0 -- Assuming variability is indicated by non-zero dispersion\n      AND oid IN (SELECT oid FROM agn_objects)\n),\n\n-- Sub-query to check for no detections or no variability in the g band\nno_variability_g_band AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1 -- g band\n      AND (ndet = 0 OR magsigma = 0) -- No detections or no variability\n      AND oid IN (SELECT oid FROM agn_objects)\n),\n\n-- Combine sub-queries to find common oids\ncombined_features AS (\n    SELECT oid\n    FROM variability_r_band\n    INTERSECT\n    SELECT oid\n    FROM no_variability_g_band\n)\n\n-- Final query to retrieve object information and order results\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM combined_features)\nORDER BY o.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3522, "completion_tokens": 280, "total_tokens": 3802, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f9526028488190a6d1bcae00693793", "custom_id": "17-4", "response": {"status_code": 200, "request_id": "d86eaa80271f3134a5bfd2de806c9f1b", "body": {"id": "chatcmpl-CTaoipFqv4etv45nCyHgRNwSByxD9", "object": "chat.completion", "created": 1761169072, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n),\nr_band_variability AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n      AND magsigma > 0 -- Assuming variability is determined by magsigma being greater than 0\n),\ng_band_no_variability AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1\n      AND (ndet = 0 OR magsigma <= 0) -- No detections or no variability\n),\nfiltered_objects AS (\n    SELECT oid\n    FROM agn_objects\n    INTERSECT\n    SELECT oid\n    FROM r_band_variability\n    INTERSECT\n    SELECT oid\n    FROM g_band_no_variability\n)\nSELECT *\nFROM filtered_objects\nORDER BY oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3608, "completion_tokens": 192, "total_tokens": 3800, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526034588190a4b48bbd144c0823", "custom_id": "34-2", "response": {"status_code": 200, "request_id": "f76edcbafb3c9e603acb5c97935c67a8", "body": {"id": "chatcmpl-CTap2XhqtOPOdpe0sJZx0DWCrD0fN", "object": "chat.completion", "created": 1761169092, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- This query retrieves the feature information for 'Amplitude' or 'Multiband_period' for the specified list of oids.\nSELECT * \nFROM feature\nWHERE oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')\nAND name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3230, "completion_tokens": 135, "total_tokens": 3365, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95260ba248190ac49effa327258d2", "custom_id": "34-3", "response": {"status_code": 200, "request_id": "fe789e500820ef3559516487a6c0c203", "body": {"id": "chatcmpl-CTaqcGDmRZ6kqfqBbHpJLWfnY7kNX", "object": "chat.completion", "created": 1761169190, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH oid_list AS (\n    SELECT unnest(ARRAY['ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy']) AS oid\n),\namplitude_features AS (\n    SELECT f.*\n    FROM feature f\n    INNER JOIN oid_list oids ON f.oid = oids.oid\n    WHERE f.name = 'Amplitude'\n),\nmultiband_period_features AS (\n    SELECT f.*\n    FROM feature f\n    INNER JOIN oid_list oids ON f.oid = oids.oid\n    WHERE f.name = 'Multiband_period'\n),\nunion_features AS (\n    SELECT * FROM amplitude_features\n    UNION\n    SELECT * FROM multiband_period_features\n),\nintersect_oids AS (\n    SELECT oid\n    FROM amplitude_features\n    INTERSECT\n    SELECT oid\n    FROM multiband_period_features\n)\nSELECT uf.*\nFROM union_features uf\nINNER JOIN intersect_oids io ON uf.oid = io.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3598, "completion_tokens": 269, "total_tokens": 3867, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95260c3fc8190ab02179cdc9a4091", "custom_id": "34-4", "response": {"status_code": 200, "request_id": "76e8b0aa7d230ad849ab130ac78c5dce", "body": {"id": "chatcmpl-CTaoDfpwiLuNIKtXoy2hQ2lkOaXoW", "object": "chat.completion", "created": 1761169041, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- This query retrieves the information of the features 'Amplitude' or 'Multiband_period' for the specified list of oids.\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')\nAND name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3228, "completion_tokens": 135, "total_tokens": 3363, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95260b7588190a2633b1b6770eaed", "custom_id": "1-2", "response": {"status_code": 200, "request_id": "b25c472c766781e8150a9238af67d9cf", "body": {"id": "chatcmpl-CTaqeAv7msgIkVSbEhOZhNYjLuNjp", "object": "chat.completion", "created": 1761169192, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND (o.lastmjd - o.firstmjd) >= 365\n),\ng_band_variation AS (\n    SELECT d.oid, MAX(d.magpsf_corr) AS max_mag_g, MIN(d.magpsf_corr) AS min_mag_g\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING (MAX(d.magpsf_corr) - MIN(d.magpsf_corr)) > 1\n),\nr_band_variation AS (\n    SELECT d.oid, MAX(d.magpsf_corr) AS max_mag_r, MIN(d.magpsf_corr) AS min_mag_r\n    FROM detection d\n    WHERE d.fid = 2\n    GROUP BY d.oid\n    HAVING (MAX(d.magpsf_corr) - MIN(d.magpsf_corr)) > 0.5\n),\nfeature_info AS (\n    SELECT f.oid, f.name, f.value, f.version, f.fid AS feature_fid\n    FROM feature f\n    INNER JOIN filtered_objects fo ON f.oid = fo.oid\n)\nSELECT fo.oid, fi.name, fi.value, fi.version, fi.feature_fid, fo.meanra, fo.meandec, fo.ndet,\n       gbv.max_mag_g, gbv.min_mag_g, (gbv.max_mag_g - gbv.min_mag_g) AS delta_mag_g,\n       rbv.max_mag_r, rbv.min_mag_r, (rbv.max_mag_r - rbv.min_mag_r) AS delta_mag_r\nFROM filtered_objects fo\nINNER JOIN g_band_variation gbv ON fo.oid = gbv.oid\nINNER JOIN r_band_variation rbv ON fo.oid = rbv.oid\nINNER JOIN feature_info fi ON fo.oid = fi.oid\nWHERE fo.ndet >= 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3640, "completion_tokens": 475, "total_tokens": 4115, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95260a8d081909294ae5f5c2b5ee9", "custom_id": "1-3", "response": {"status_code": 200, "request_id": "3d50b53c0865a966eda8bbf97efc1856", "body": {"id": "chatcmpl-CTaqfjhrTdCXpnCQQ9NUKkpBwAEVx", "object": "chat.completion", "created": 1761169193, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_probabilities AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND probability > 0.6\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\nfiltered_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    INNER JOIN filtered_probabilities fp ON o.oid = fp.oid\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndet >= 20\n),\ng_band_variations AS (\n    SELECT oid, MAX(magpsf_corr) - MIN(magpsf_corr) AS delta_mag_g\n    FROM detection\n    WHERE fid = 1\n    GROUP BY oid\n    HAVING MAX(magpsf_corr) - MIN(magpsf_corr) > 1\n),\nr_band_variations AS (\n    SELECT oid, MAX(magpsf_corr) - MIN(magpsf_corr) AS delta_mag_r\n    FROM detection\n    WHERE fid = 2\n    GROUP BY oid\n    HAVING MAX(magpsf_corr) - MIN(magpsf_corr) > 0.5\n),\nfeature_info AS (\n    SELECT oid, value, name, version, fid AS feature_fid\n    FROM feature\n)\nSELECT fo.oid, fi.value, fi.name, fi.version, fi.feature_fid, fo.meanra, fo.meandec, fo.ndet,\n       g.delta_mag_g, r.delta_mag_r\nFROM filtered_objects fo\nINNER JOIN g_band_variations g ON fo.oid = g.oid\nINNER JOIN r_band_variations r ON fo.oid = r.oid\nINNER JOIN feature_info fi ON fo.oid = fi.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3757, "completion_tokens": 385, "total_tokens": 4142, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95260c3588190830daed5a6d7fe13", "custom_id": "1-4", "response": {"status_code": 200, "request_id": "66b237a6774968908d9160fe749064ac", "body": {"id": "chatcmpl-CTaqi51vrapvIMIesuemViviUmCCl", "object": "chat.completion", "created": 1761169196, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH probability_subquery AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND probability > 0.6\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\nobject_subquery AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    INNER JOIN probability_subquery p ON o.oid = p.oid\n    WHERE o.deltajd >= 365\n      AND o.ndet >= 20\n),\ng_band_variation AS (\n    SELECT d.oid, MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_g\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING MAX(d.magpsf_corr) - MIN(d.magpsf_corr) > 1\n),\nr_band_variation AS (\n    SELECT d.oid, MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_r\n    FROM detection d\n    WHERE d.fid = 2\n    GROUP BY d.oid\n    HAVING MAX(d.magpsf_corr) - MIN(d.magpsf_corr) > 0.5\n),\nfeature_subquery AS (\n    SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid\n    FROM feature f\n    INNER JOIN probability_subquery p ON f.oid = p.oid\n)\nSELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,\n       g.delta_mag_g, r.delta_mag_r\nFROM object_subquery o\nINNER JOIN g_band_variation g ON o.oid = g.oid\nINNER JOIN r_band_variation r ON o.oid = r.oid\nINNER JOIN feature_subquery f ON o.oid = f.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3684, "completion_tokens": 418, "total_tokens": 4102, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95260cc788190baa16027626ab1ef", "custom_id": "16-2", "response": {"status_code": 200, "request_id": "ee48396391347c6cc4506aec8640b69c", "body": {"id": "chatcmpl-CTaoEHuDqTJiDHg1QutGSOFsqycuo", "object": "chat.completion", "created": 1761169042, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH first_detection AS (\n    SELECT oid\n    FROM detection\n    WHERE mjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT oid\n    FROM magstat\n    WHERE dmdt_first >= 0.25\n),\nsn_probabilities AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'SN'\n    AND ranking = 1\n    AND classifier_name = 'stamp_classifier'\n),\nfiltered_oids AS (\n    SELECT oid\n    FROM first_detection\n    INTERSECT\n    SELECT oid\n    FROM fast_risers\n    INTERSECT\n    SELECT oid\n    FROM sn_probabilities\n)\nSELECT d.oid, p.probability, d.fid, d.diffmaglim, m.fid AS magstat_fid, m.dmdt_first\nFROM detection d\nINNER JOIN filtered_oids fo ON d.oid = fo.oid\nINNER JOIN sn_probabilities p ON d.oid = p.oid\nINNER JOIN magstat m ON d.oid = m.oid\nWHERE d.oid IN (SELECT oid FROM filtered_oids)\nORDER BY d.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3855, "completion_tokens": 252, "total_tokens": 4107, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f95260b99c81909d0570f9ae6b3949", "custom_id": "16-3", "response": {"status_code": 200, "request_id": "875be98a98e935fb055e5fe2cfb5fdbf", "body": {"id": "chatcmpl-CTaoEqJXURHTJrknuArA7N96QaCVn", "object": "chat.completion", "created": 1761169042, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n      AND p.ranking = 1\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n),\nfast_risers AS (\n    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first\n    FROM magstat m\n    WHERE m.dmdt_first >= 0.25\n),\nlight_curves AS (\n    SELECT d.oid, d.fid, d.diffmaglim\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n)\nSELECT fo.oid, p.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first\nFROM filtered_objects fo\nINNER JOIN probability p ON fo.oid = p.oid\nINNER JOIN fast_risers fr ON fo.oid = fr.oid\nLEFT JOIN light_curves lc ON fo.oid = lc.oid\nORDER BY fo.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3674, "completion_tokens": 257, "total_tokens": 3931, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526261d881908f4a124a159f18fc", "custom_id": "16-4", "response": {"status_code": 200, "request_id": "2aa08640e542d14751c60c1ca619c420", "body": {"id": "chatcmpl-CTb30eFgAtrouMwGpmzsajp6nz8w9", "object": "chat.completion", "created": 1761169958, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first AS initial_rise_estimate\n    FROM magstat m\n    WHERE m.dmdt_first >= 0.25\n),\nsn_probabilities AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.ranking = 1\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n)\nSELECT o.oid, sp.probability, d.fid, d.diffmaglim, fr.magstat_fid, fr.initial_rise_estimate\nFROM filtered_objects o\nINNER JOIN sn_probabilities sp ON o.oid = sp.oid\nINNER JOIN fast_risers fr ON o.oid = fr.oid\nINNER JOIN detection d ON o.oid = d.oid\nORDER BY o.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3731, "completion_tokens": 246, "total_tokens": 3977, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95260e93c8190a25ae1e19775dead", "custom_id": "19-2", "response": {"status_code": 200, "request_id": "65aa2b2cb8f732c7fac2dbaa99f39c03", "body": {"id": "chatcmpl-CTaoDEJ1TZDpXEBsbos5QEKgemIUh", "object": "chat.completion", "created": 1761169041, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.firstmjd BETWEEN 59274.0 AND 59305.0\n    AND o.ndet <= 1\n    AND p.class_name = 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.probability > 0.7\n    AND p.ranking = 1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3283, "completion_tokens": 142, "total_tokens": 3425, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95261413c8190a5c9770ec7a124e2", "custom_id": "19-3", "response": {"status_code": 200, "request_id": "464b69e4fabfad9e69895e8745fe48f9", "body": {"id": "chatcmpl-CTaoK79axSJbgasvFRpUjBxDk4dWT", "object": "chat.completion", "created": 1761169048, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.firstmjd BETWEEN 59274.0 AND 59305.0  -- Filter for objects detected between March 1st and April 1st, 2021\n    AND o.ndet <= 1  -- Filter for objects with at most one detection\n    AND p.class_name = 'asteroid'  -- Filter for objects classified as 'asteroid'\n    AND p.classifier_name = 'stamp_classifier'  -- Use the stamp classifier\n    AND p.probability > 0.7  -- Filter for probability greater than 0.7\n    AND p.ranking = 1;  -- Ensure only the most likely probabilities are returned\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3268, "completion_tokens": 212, "total_tokens": 3480, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_def8a90fd4"}}, "error": null}
{"id": "batch_req_68f9526145748190a1f3b4838b64d885", "custom_id": "14-2", "response": {"status_code": 200, "request_id": "0eb985d1371be2aff408a86d662619f7", "body": {"id": "chatcmpl-CTaoMBlVJMCsrE1EZKd9NfGK70ZHB", "object": "chat.completion", "created": 1761169050, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\nFROM detection d\nJOIN ps1_ztf p ON d.oid = p.oid\nWHERE d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\nAND d.drb > 0.5\nAND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3621, "completion_tokens": 193, "total_tokens": 3814, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952627c04819090766892be5cd16a", "custom_id": "14-3", "response": {"status_code": 200, "request_id": "9e484b586a1889f3cdc99c28815ec0de", "body": {"id": "chatcmpl-CTaoS3zWwiWY19mQOQvscsFJXVMkI", "object": "chat.completion", "created": 1761169056, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_detections AS (\n    SELECT \n        d.oid, \n        d.candid, \n        d.fid, \n        d.mjd, \n        d.magpsf, \n        d.sigmapsf, \n        d.has_stamp, \n        d.drb\n    FROM \n        detection d\n    WHERE \n        d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n        AND d.drb > 0.5\n),\njoined_data AS (\n    SELECT \n        fd.oid, \n        fd.candid, \n        fd.fid, \n        fd.mjd, \n        fd.magpsf, \n        fd.sigmapsf, \n        fd.has_stamp, \n        fd.drb, \n        pz.sgscore1, \n        pz.distpsnr1\n    FROM \n        filtered_detections fd\n    INNER JOIN \n        ps1_ztf pz ON fd.oid = pz.oid AND fd.candid = pz.candid\n)\nSELECT \n    oid, \n    candid, \n    fid, \n    mjd, \n    magpsf, \n    sigmapsf, \n    has_stamp, \n    drb, \n    sgscore1, \n    distpsnr1\nFROM \n    joined_data\nWHERE \n    sgscore1 < 0.5 OR distpsnr1 < 1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3724, "completion_tokens": 371, "total_tokens": 4095, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95261616c8190835760ee6ee5c179", "custom_id": "14-4", "response": {"status_code": 200, "request_id": "a222c9b516888865904c905e43c79616", "body": {"id": "chatcmpl-CTaoUQOSuUi6xeYXgcdsOmEulM2Ni", "object": "chat.completion", "created": 1761169058, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid, \n    d.candid, \n    d.fid, \n    d.mjd, \n    d.magpsf, \n    d.sigmapsf, \n    d.has_stamp, \n    d.drb, \n    pz.sgscore1, \n    pz.distpsnr1\nFROM \n    detection d\nINNER JOIN \n    ps1_ztf pz ON d.oid = pz.oid\nWHERE \n    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n    AND d.drb > 0.5\n    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1)\n```\n", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3592, "completion_tokens": 228, "total_tokens": 3820, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f9526152d88190a2a0e29c2ff76250", "custom_id": "89-2", "response": {"status_code": 200, "request_id": "afb6712b0ce267179d78ee3c5055ec6d", "body": {"id": "chatcmpl-CTaodRBgF9vmvU5TliDDLdHzqAj3U", "object": "chat.completion", "created": 1761169067, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- The user requested to find ZTF objects with a probability larger than 0.7 of being supernovae in the stamp classifier.\n-- The query will return all columns from the 'dataquality' table for such objects, limited to 50 results.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n    AND classifier_name = 'stamp_classifier'\n    AND probability > 0.7\n    AND ranking = 1\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3156, "completion_tokens": 112, "total_tokens": 3268, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952621430819092f92d27e99ddf3f", "custom_id": "89-3", "response": {"status_code": 200, "request_id": "f3a3650aa27240b644db2609d3243404", "body": {"id": "chatcmpl-CTaoecOuiFd7YXCtXxRZxDpSLXAul", "object": "chat.completion", "created": 1761169068, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- The query retrieves at most 50 ZTF objects with a probability greater than 0.7 of being classified as supernovae ('SN') using the 'stamp_classifier'.\n-- It returns all columns from the 'dataquality' table for these objects.\n\nSELECT * \nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n    AND classifier_name = 'stamp_classifier'\n    AND probability > 0.7\n    AND ranking = 1\n    LIMIT 50\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3123, "completion_tokens": 114, "total_tokens": 3237, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95261521c8190a47d3ca10a96a477", "custom_id": "89-4", "response": {"status_code": 200, "request_id": "c6c749eb29ac2edc61419d6f9a34af13", "body": {"id": "chatcmpl-CTaovVXlqEiS3aFbb4rMirxG8oHU5", "object": "chat.completion", "created": 1761169085, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- This query retrieves at most 50 ZTF objects classified as supernovae with a probability greater than 0.7 using the 'stamp_classifier'.\n-- It returns all columns from the 'dataquality' table for these objects.\n\nSELECT *\nFROM dataquality\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n      AND classifier_name = 'stamp_classifier'\n      AND probability > 0.7\n      AND ranking = 1\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3156, "completion_tokens": 107, "total_tokens": 3263, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952617af48190abe2bf60a8ee1674", "custom_id": "103-2", "response": {"status_code": 200, "request_id": "e6bb8a3d8eab26b19fc30fa48bc4e8c2", "body": {"id": "chatcmpl-CTaopLfrcR3Yv5iYdMlzVaOCqkwRI", "object": "chat.completion", "created": 1761169079, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery 1: Filter probabilities for non-supernova classes with probability > 0.7\nWITH filtered_probabilities AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND probability > 0.7\n),\n-- Subquery 2: Filter objects with distance to nearest PS1 source > 5 arcsec\nfiltered_ps1_ztf AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE distpsnr1 > 5\n)\n-- Final query: Join the filtered results with the object table\nSELECT *\nFROM object\nINNER JOIN filtered_probabilities ON object.oid = filtered_probabilities.oid\nINNER JOIN filtered_ps1_ztf ON object.oid = filtered_ps1_ztf.oid\nORDER BY distpsnr1 ASC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3599, "completion_tokens": 210, "total_tokens": 3809, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952618f948190bcb294441783113c", "custom_id": "103-3", "response": {"status_code": 200, "request_id": "656628d49e649a4147c006588932e44c", "body": {"id": "chatcmpl-CTaos4658bn8s90WvkVEjSwvA91SL", "object": "chat.completion", "created": 1761169082, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery 1: Filter the probability table for non-supernova classes with probability > 0.7\nWITH filtered_probability AS (\n    SELECT *\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.7\n      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n),\n\n-- Subquery 2: Filter the ps1_ztf table for objects with distpsnr1 > 5\nfiltered_ps1_ztf AS (\n    SELECT *\n    FROM ps1_ztf\n    WHERE distpsnr1 > 5\n)\n\n-- Final query: Join the filtered subqueries with the object table\nSELECT o.*, fp.*, pz.*\nFROM object o\nINNER JOIN filtered_probability fp ON o.oid = fp.oid\nINNER JOIN filtered_ps1_ztf pz ON o.oid = pz.oid\nORDER BY pz.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3546, "completion_tokens": 218, "total_tokens": 3764, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f9526214fc8190ad79bcbfb02ff44f", "custom_id": "103-4", "response": {"status_code": 200, "request_id": "27c4953b80bae07a5d17f53381139e6c", "body": {"id": "chatcmpl-CTb3hXjeyYRejZeOznJlSXzAi7O7E", "object": "chat.completion", "created": 1761170001, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM (\n    SELECT o.*, p.*, ps.*\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    INNER JOIN ps1_ztf ps ON o.oid = ps.oid\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND ps.distpsnr1 > 5\n    ORDER BY ps.distpsnr1\n    LIMIT 200\n) AS result;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3567, "completion_tokens": 140, "total_tokens": 3707, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95262141481909c5561990878a3f5", "custom_id": "99-2", "response": {"status_code": 200, "request_id": "d35c5ce8d1fcfa47851cf8d162dee5b5", "body": {"id": "chatcmpl-CTap0Lz4cfDXEl35eqzyLQmvxrntV", "object": "chat.completion", "created": 1761169090, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from the forced_photometry table for objects with specific conditions\nSELECT fp.*\nFROM probability p\nINNER JOIN object o ON p.oid = o.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability = 1\n  AND p.ranking = 1\n  AND o.firstmjd > 60310\nORDER BY o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3191, "completion_tokens": 118, "total_tokens": 3309, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526211b48190b9ed40f6ffc176d3", "custom_id": "99-3", "response": {"status_code": 200, "request_id": "da201359eda9875d665e0b3dccdb18c2", "body": {"id": "chatcmpl-CTaoFoRU1NFOVsfUDAYsNij4ps3NV", "object": "chat.completion", "created": 1761169043, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find at most 10 ZTF objects with specific conditions and return all columns from the 'forced_photometry' table\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.probability = 1\n  AND p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\nORDER BY o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3271, "completion_tokens": 129, "total_tokens": 3400, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952624b908190a57e73a266b597cd", "custom_id": "99-4", "response": {"status_code": 200, "request_id": "736c94dbac506a87c9c0cea66ff99765", "body": {"id": "chatcmpl-CTaoFvfmw0VCjG9EsVzeJ6kOIuX8b", "object": "chat.completion", "created": 1761169043, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from the forced_photometry table for objects with specific conditions\nSELECT fp.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN forced_photometry fp ON o.oid = fp.oid\nWHERE o.firstmjd > 60310\n  AND p.class_name = 'asteroid'\n  AND p.probability = 1\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\nORDER BY o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3208, "completion_tokens": 118, "total_tokens": 3326, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952622a088190952434082855ac18", "custom_id": "92-2", "response": {"status_code": 200, "request_id": "4a304e6efcb6f3e310c4a24c6c641245", "body": {"id": "chatcmpl-CTaoFWUXWlTmdX16EVxfRh1gmHy0r", "object": "chat.completion", "created": 1761169043, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\", \n    p.classifier_version, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    (SELECT oid \n     FROM detection \n     WHERE fid = 1 AND dubious = FALSE \n     GROUP BY oid \n     HAVING COUNT(*) >= 10) d ON o.oid = d.oid\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1 \n    AND p.classifier_name = 'lc_classifier'\nORDER BY \n    o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3381, "completion_tokens": 137, "total_tokens": 3518, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952624e4081909a56306c95900178", "custom_id": "92-3", "response": {"status_code": 200, "request_id": "7671a2d570cc61382153da747b860009", "body": {"id": "chatcmpl-CTaoFdhpBC2VcXz4OA4b0iGOF4Epp", "object": "chat.completion", "created": 1761169043, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH detection_filter AS (\n    SELECT oid\n    FROM detection\n    WHERE fid = 1 AND dubious = FALSE\n    GROUP BY oid\n    HAVING COUNT(*) >= 10\n)\nSELECT o.oid, p.classifier_version, p.class_name, p.probability\nFROM object o\nINNER JOIN detection_filter df ON o.oid = df.oid\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.ranking = 1 AND p.classifier_name = 'lc_classifier'\nORDER BY o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3422, "completion_tokens": 120, "total_tokens": 3542, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f952625b048190b68a7547514245cc", "custom_id": "92-4", "response": {"status_code": 200, "request_id": "d24bb0121270d140e7454f230abff4a6", "body": {"id": "chatcmpl-CTaoGZ0lu7JCP62kGS6wSNwhheOcB", "object": "chat.completion", "created": 1761169044, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    p.classifier_version, \n    p.class_name, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    (SELECT oid \n     FROM detection \n     WHERE fid = 1 AND dubious = FALSE \n     GROUP BY oid \n     HAVING COUNT(*) >= 10) d ON o.oid = d.oid\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.ranking = 1 \n    AND p.classifier_name = 'lc_classifier'\nORDER BY \n    o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3441, "completion_tokens": 132, "total_tokens": 3573, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526296888190ac6c21d0b2045c57", "custom_id": "102-2", "response": {"status_code": 200, "request_id": "93fd488fe30f53ebcfd956e23c43755e", "body": {"id": "chatcmpl-CTaoOL1SYV12PXfPRPpjYO3EpJcPv", "object": "chat.completion", "created": 1761169052, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- This query retrieves at most 50 ZTF objects that have a probability larger than 0.6 of being an AGN in the light curve classifier\n-- and a WISE W1 magnitude between 12 and 13. It returns all columns from the 'magstat' table for such objects.\n\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN allwise a ON p.oid = a.oid\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND a.w1mpro BETWEEN 12 AND 13\n    LIMIT 50\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3196, "completion_tokens": 163, "total_tokens": 3359, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_def8a90fd4"}}, "error": null}
{"id": "batch_req_68f95262a0848190b1bfbf33cdd9416d", "custom_id": "102-3", "response": {"status_code": 200, "request_id": "61791c41eb504cbf8e1cf22a0cba51d2", "body": {"id": "chatcmpl-CTaoSd9TQBvtYmnxgkUodLAaWip3X", "object": "chat.completion", "created": 1761169056, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- This query retrieves at most 50 ZTF objects that have a probability larger than 0.6 of being an AGN in the light curve classifier\n-- and a WISE W1 magnitude between 12 and 13. It returns all columns from the 'magstat' table for such objects.\n\nSELECT magstat.*\nFROM magstat\nINNER JOIN (\n    SELECT probability.oid\n    FROM probability\n    INNER JOIN allwise ON probability.oid = allwise.oid\n    WHERE probability.class_name = 'AGN'\n      AND probability.probability > 0.6\n      AND probability.ranking = 1\n      AND probability.classifier_name = 'lc_classifier'\n      AND allwise.w1mpro BETWEEN 12 AND 13\n) AS filtered_objects ON magstat.oid = filtered_objects.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 177, "total_tokens": 3302, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95262aa948190a5279759f0533acf", "custom_id": "102-4", "response": {"status_code": 200, "request_id": "afc8da33b0c30c74f53d19883b9ae965", "body": {"id": "chatcmpl-CTaoSmrYzCxozWIIaqNnttml7rGeh", "object": "chat.completion", "created": 1761169056, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM magstat\nWHERE oid IN (\n    SELECT p.oid\n    FROM probability p\n    INNER JOIN allwise a ON p.oid = a.oid_catalog\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND a.w1mpro BETWEEN 12 AND 13\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3250, "completion_tokens": 101, "total_tokens": 3351, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f95262a4688190a0fb48d7ff82575a", "custom_id": "104-2", "response": {"status_code": 200, "request_id": "abecdd04290b6a2d332cf06ef9b1afca", "body": {"id": "chatcmpl-CTaoTFbTdzshKRxrObOJnCKb64kx1", "object": "chat.completion", "created": 1761169057, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    p.oid, \n    d.candid, \n    ss.ssdistnr, \n    ss.ssmagnr, \n    ss.ssnamenr, \n    d.fid, \n    d.fwhm, \n    d.ncalib, \n    d.exptime\nFROM \n    (SELECT oid \n     FROM probability \n     WHERE class_name = 'asteroid' \n       AND classifier_name = 'stamp_classifier' \n       AND classifier_version = 'stamp_classifier_1.0.4' \n       AND probability > 0.9 \n       AND ranking = 1) AS p\nINNER JOIN \n    ss_ztf AS ss ON p.oid = ss.oid\nINNER JOIN \n    detection AS d ON p.oid = d.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3634, "completion_tokens": 172, "total_tokens": 3806, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95262abc081909e15e8419f8eb7e9", "custom_id": "104-3", "response": {"status_code": 200, "request_id": "f92daa5ba575a5ba15ee15c72d243953", "body": {"id": "chatcmpl-CTaoUuH3QRznyr8j6qT3HbrDLHMRQ", "object": "chat.completion", "created": 1761169058, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter the probability table for objects classified as asteroids with the specified conditions\nWITH probability_filter AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'asteroid'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.9\n    LIMIT 30\n)\n\n-- Main query to join the filtered probability with ss_ztf and detection tables\nSELECT \n    ss_ztf.oid AS ztf_object_id,\n    detection.candid AS candidate_id,\n    ss_ztf.ssdistnr AS distance_from_nearest_solar_system_object,\n    ss_ztf.ssmagnr AS mpc_archive_magnitude,\n    ss_ztf.ssnamenr AS nearest_solar_system_object_name,\n    detection.fid AS filter_identifier,\n    detection.fwhm AS fwhm_sextractor,\n    detection.ncal_ps1 AS number_of_ps1_calibrators,\n    detection.exptime AS exposure_time\nFROM \n    probability_filter\nINNER JOIN \n    ss_ztf ON probability_filter.oid = ss_ztf.oid\nINNER JOIN \n    detection ON ss_ztf.oid = detection.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3614, "completion_tokens": 264, "total_tokens": 3878, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95262d5e08190b5762e8fb35c9b3e", "custom_id": "104-4", "response": {"status_code": 200, "request_id": "cb1f9f52cb6a37a00b55a2569ccb710d", "body": {"id": "chatcmpl-CTaobBc7bLPfmYm7UEC6VFgp7LOJ8", "object": "chat.completion", "created": 1761169065, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    p.oid, \n    d.candid, \n    s.ssdistnr, \n    s.ssmagnr, \n    s.ssnamenr, \n    d.fid, \n    d.fwhm, \n    d.ncalib, \n    d.exptime\nFROM \n    (SELECT oid \n     FROM probability \n     WHERE ranking = 1 \n       AND classifier_name = 'stamp_classifier' \n       AND classifier_version = 'stamp_classifier_1.0.4' \n       AND class_name = 'asteroid' \n       AND probability > 0.9\n     LIMIT 30) AS p\nINNER JOIN ss_ztf AS s ON p.oid = s.oid\nINNER JOIN detection AS d ON s.candid = d.candid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3532, "completion_tokens": 169, "total_tokens": 3701, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95262ea60819098e463252ed5e96b", "custom_id": "107-2", "response": {"status_code": 200, "request_id": "06dda6310c36127d8f6ef8b86f1ec964", "body": {"id": "chatcmpl-CTaoeqU82jAx5ZDJL23jMTckyuvpb", "object": "chat.completion", "created": 1761169068, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    o.firstmjd, \n    o.lastmjd, \n    p.probability, \n    s.candid, \n    s.ssdistnr, \n    s.ssnamenr, \n    d.mjd, \n    d.fid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    ss_ztf s ON o.oid = s.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    o.ndet > 500\n    AND p.probability > 0.5\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.ranking = 1\n    AND s.ssdistnr < 2\nORDER BY \n    o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3651, "completion_tokens": 209, "total_tokens": 3860, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95262f3148190ab87312a8855dcba", "custom_id": "107-3", "response": {"status_code": 200, "request_id": "8ce8e463615a7d6be53833410db63b1b", "body": {"id": "chatcmpl-CTaohUhHtXZC3FOsV0lAa6GV94BZP", "object": "chat.completion", "created": 1761169071, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    o.firstmjd, \n    o.lastmjd, \n    p.probability, \n    d.candid, \n    d.ssdistnr, \n    d.ssnamenr, \n    d.mjd, \n    d.fid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nWHERE \n    o.ndet > 500\n    AND p.probability > 0.5\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND d.ssdistnr < 2\nORDER BY \n    o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3571, "completion_tokens": 182, "total_tokens": 3753, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f95262e1848190b36c6b49c4e77d7c", "custom_id": "107-4", "response": {"status_code": 200, "request_id": "dae0e4cce372b19e31bee4189151c6ca", "body": {"id": "chatcmpl-CTaojiNChhnMdtBZiMTPl9bpyDTA2", "object": "chat.completion", "created": 1761169073, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH probability_filtered AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'asteroid'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.5\n      AND ranking = 1\n),\nobject_filtered AS (\n    SELECT oid, ndet, firstmjd, lastmjd\n    FROM object\n    WHERE ndet > 500\n),\ndetection_filtered AS (\n    SELECT oid, candid, mjd, fid\n    FROM detection\n),\nss_ztf_filtered AS (\n    SELECT candid, ssdistnr, ssnamenr\n    FROM ss_ztf\n    WHERE ssdistnr < 2\n)\nSELECT o.oid AS \"ZTF identifier\", \n       o.ndet AS \"number of detections\", \n       o.firstmjd AS \"first detection date\", \n       o.lastmjd AS \"last detection date\", \n       p.probability AS \"probability\", \n       d.candid AS \"candidate identifier\", \n       s.ssdistnr AS \"distance between ZTF object and MPC object\", \n       s.ssnamenr AS \"MPC name\", \n       d.mjd AS \"detection date\", \n       d.fid AS \"filter identifier\"\nFROM object_filtered o\nINNER JOIN probability_filtered p ON o.oid = p.oid\nINNER JOIN detection_filtered d ON o.oid = d.oid\nINNER JOIN ss_ztf_filtered s ON d.candid = s.candid\nORDER BY o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3631, "completion_tokens": 340, "total_tokens": 3971, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f9526411648190bce3605116c4bfa6", "custom_id": "84-2", "response": {"status_code": 200, "request_id": "46baf1efe5d35ee59d23f93b6ebbbf91", "body": {"id": "chatcmpl-CTaokXWFR8kmCezwASwaNd3Uf1QVS", "object": "chat.completion", "created": 1761169074, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    x.oid, \n    x.oid_catalog, \n    x.dist, \n    a.w1mpro, \n    a.w2mpro, \n    a.w3mpro, \n    a.w4mpro\nFROM \n    xmatch x\nINNER JOIN \n    allwise a ON x.oid_catalog = a.oid_catalog\nWHERE \n    x.oid = 'ZTF19aascdol' \n    AND x.catid = 'ALLWISE'; -- Ensure the match is with the ALLWISE catalog\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3260, "completion_tokens": 117, "total_tokens": 3377, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f9526324b48190a6019f9dcd19b854", "custom_id": "84-4", "response": {"status_code": 200, "request_id": "706d13dd5a0f0458bc60a65f5bae03b2", "body": {"id": "chatcmpl-CTap0v1q7xpJ6PYm8dGbUWfiwWgy0", "object": "chat.completion", "created": 1761169090, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    x.oid, \n    x.oid_catalog, \n    x.dist, \n    a.w1mpro, \n    a.w2mpro, \n    a.w3mpro, \n    a.w4mpro\nFROM \n    xmatch x\nINNER JOIN \n    allwise a ON x.oid_catalog = a.oid_catalog\nWHERE \n    x.oid = 'ZTF19aascdol'\n    AND x.catid = 'ALLWISE' -- Ensure the match is with the ALLWISE catalog\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3330, "completion_tokens": 116, "total_tokens": 3446, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526322a08190aeb1707ebd4a16f1", "custom_id": "96-2", "response": {"status_code": 200, "request_id": "7dc4db235c144b72ec8806c48165e600", "body": {"id": "chatcmpl-CTap37AkfEj9KiekqK2euY4RD2eoP", "object": "chat.completion", "created": 1761169093, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve detections for ZTF objects within 2 arcseconds of specified Solar System identifiers\nSELECT \n    ss_ztf.*, \n    detection.mjd, \n    detection.fid, \n    detection.isdiffpos, \n    detection.ra, \n    detection.dec, \n    detection.magpsf, \n    detection.sigmapsf\nFROM \n    ss_ztf\nJOIN \n    detection ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, detection.ra, detection.dec, 0.0005556)\nWHERE \n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\nORDER BY \n    ss_ztf.ssnamenr, \n    detection.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3291, "completion_tokens": 163, "total_tokens": 3454, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526335e481909f28b8839988c7e0", "custom_id": "96-3", "response": {"status_code": 200, "request_id": "6a8d5c68aa0275f2cd1dc9553372a4d6", "body": {"id": "chatcmpl-CTapCXVLeXvOxRxfO1CK8d3kAylx5", "object": "chat.completion", "created": 1761169102, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    ss_ztf.*, \n    detection.mjd, \n    detection.fid, \n    detection.isdiffpos, \n    detection.ra, \n    detection.dec, \n    detection.magpsf, \n    detection.sigmapsf\nFROM \n    ss_ztf\nINNER JOIN \n    detection ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, detection.ra, detection.dec, 2/3600.0)\nWHERE \n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\nORDER BY \n    ss_ztf.ssnamenr, \n    detection.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3271, "completion_tokens": 144, "total_tokens": 3415, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526343d481909edd6daeb630d123", "custom_id": "96-4", "response": {"status_code": 200, "request_id": "7e7f16288ff8a9984833236c11d5216c", "body": {"id": "chatcmpl-CTapJNdka14NSQz2p0VltW0x9TteG", "object": "chat.completion", "created": 1761169109, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve detections for ZTF objects within 2 arcseconds of specified solar system objects\nSELECT \n    ss_ztf.*, \n    detection.mjd, \n    detection.fid, \n    detection.isdiffpos, \n    detection.ra, \n    detection.dec, \n    detection.magpsf, \n    detection.sigmapsf\nFROM \n    ss_ztf\nINNER JOIN \n    detection ON q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra, ss_ztf.dec, 2/3600.0)\nWHERE \n    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')\nORDER BY \n    ss_ztf.ssnamenr, \n    detection.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3309, "completion_tokens": 166, "total_tokens": 3475, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f952632c94819090204e180a6dfbcc", "custom_id": "94-2", "response": {"status_code": 200, "request_id": "b1d36c03387b7eea8f46ef5b49f9dd65", "body": {"id": "chatcmpl-CTaoHOPc59AVOVpmoBPnCXlZQCLfL", "object": "chat.completion", "created": 1761169045, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- The query retrieves all columns from the 'object' table for ZTF objects that had a change in the reference.\n-- It limits the result to at most 50 rows.\n\nSELECT * \nFROM object\nWHERE reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3031, "completion_tokens": 56, "total_tokens": 3087, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526357c88190b88c40f378a4c860", "custom_id": "94-3", "response": {"status_code": 200, "request_id": "9ba8f0dcadb8cc9aa979ab7f30e35512", "body": {"id": "chatcmpl-CTaoHp0a71QtuZBmPuXOmSwbWuox9", "object": "chat.completion", "created": 1761169045, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- The query retrieves all columns from the 'object' table for ZTF objects that had a change in the reference.\n-- It limits the result to at most 50 rows.\n\nSELECT * \nFROM object\nWHERE reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3031, "completion_tokens": 56, "total_tokens": 3087, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95263602c8190999b05c6c082c067", "custom_id": "94-4", "response": {"status_code": 200, "request_id": "262c954f3b08455348ad9fd8c653a6ff", "body": {"id": "chatcmpl-CTaoHYRl5tnjRAlp8hYJrRTBme2NV", "object": "chat.completion", "created": 1761169045, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- The query retrieves all columns from the 'object' table for ZTF objects that had a change in the reference.\n-- It limits the result to at most 50 rows.\n\nSELECT *\nFROM object\nWHERE reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3031, "completion_tokens": 55, "total_tokens": 3086, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952636db48190a5e13e71fb89474e", "custom_id": "90-2", "response": {"status_code": 200, "request_id": "9a3e07532feac5db6789387965e596ea", "body": {"id": "chatcmpl-CTaoHsRn50NhFVHvkfYwTn205qcB7", "object": "chat.completion", "created": 1761169045, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*\nFROM probability p\nINNER JOIN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n    AND version = 'lc_classifier_1.2.1-P'\n    AND value < 5\n) f ON p.oid = f.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3123, "completion_tokens": 90, "total_tokens": 3213, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f952637724819086203a3852359731", "custom_id": "90-3", "response": {"status_code": 200, "request_id": "24a17cce7cbac514741d96fb5dfa3c93", "body": {"id": "chatcmpl-CTaoHNJPCMw7EDACcbHLUHMPXvOc5", "object": "chat.completion", "created": 1761169045, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Create a temporary result set of object IDs with Multiband_period < 5 days and the specified feature version\nWITH filtered_objects AS (\n    SELECT oid\n    FROM feature\n    WHERE feature_name = 'Multiband_period'\n      AND feature_value < 5\n      AND feature_version = 'lc_classifier_1.2.1-P'\n)\n\n-- Select all columns from the probability table for objects that meet the classification criteria\nSELECT *\nFROM probability\nWHERE oid IN (SELECT oid FROM filtered_objects)\n  AND classifier_name = 'lc_classifier'\n  AND ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3192, "completion_tokens": 131, "total_tokens": 3323, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95263ad8081909fc7353dc622a261", "custom_id": "90-4", "response": {"status_code": 200, "request_id": "b51c9d56ffef426f0025f7e5cbcbd63a", "body": {"id": "chatcmpl-CTaoMHtUBTNkHGVWJWluMNBqvIxGq", "object": "chat.completion", "created": 1761169050, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*\nFROM probability p\nINNER JOIN (\n    SELECT oid\n    FROM feature\n    WHERE name = 'Multiband_period'\n    AND value < 5\n    AND version = 'lc_classifier_1.2.1-P'\n) f ON p.oid = f.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking IN (1, 2)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3170, "completion_tokens": 90, "total_tokens": 3260, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95263d1908190af620a58e48235f9", "custom_id": "100-2", "response": {"status_code": 200, "request_id": "5b9c06a34cb2660bcf3598ad0d764753", "body": {"id": "chatcmpl-CTaoM6rmQmEc1XFRhJdtaWHlqhYoU", "object": "chat.completion", "created": 1761169050, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery for detection table\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    magpsf, \n    sigmapsf, \n    diffmaglim, \n    NULL AS mag, \n    NULL AS e_mag, \n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Subquery for non_detection table\nSELECT \n    oid, \n    mjd, \n    fid, \n    NULL AS isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    NULL AS mag, \n    NULL AS e_mag, \n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Subquery for forced_photometry table\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    NULL AS diffmaglim, \n    mag, \n    e_mag, \n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3645, "completion_tokens": 295, "total_tokens": 3940, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f95263acc88190aa3641121fea0764", "custom_id": "100-3", "response": {"status_code": 200, "request_id": "dc43e60ff3cce49afe95f5802a78a6ab", "body": {"id": "chatcmpl-CTaoNnGqh7IRGPNPETptUXMgTK81D", "object": "chat.completion", "created": 1761169051, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery for detection table\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    isdiffpos,\n    magpsf AS detection_difference_magnitude,\n    sigmapsf AS detection_difference_magnitude_uncertainty,\n    diffmaglim AS five_sigma_magnitude_limit,\n    NULL AS forced_difference_magnitude,\n    NULL AS forced_difference_magnitude_uncertainty,\n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Subquery for non_detection table\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    NULL AS isdiffpos,\n    NULL AS detection_difference_magnitude,\n    NULL AS detection_difference_magnitude_uncertainty,\n    diffmaglim AS five_sigma_magnitude_limit,\n    NULL AS forced_difference_magnitude,\n    NULL AS forced_difference_magnitude_uncertainty,\n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Subquery for forced_photometry table\nSELECT \n    oid AS ztf_identifier,\n    mjd AS epoch_date,\n    fid AS filter_identifier,\n    isdiffpos,\n    NULL AS detection_difference_magnitude,\n    NULL AS detection_difference_magnitude_uncertainty,\n    NULL AS five_sigma_magnitude_limit,\n    mag AS forced_difference_magnitude,\n    e_mag AS forced_difference_magnitude_uncertainty,\n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    epoch_date;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3591, "completion_tokens": 364, "total_tokens": 3955, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f95263ba1481908daefd3a7e0e389e", "custom_id": "100-4", "response": {"status_code": 200, "request_id": "a6d2d9aabac5619cbba256fade3a822d", "body": {"id": "chatcmpl-CTaoN1OFBP1JGhw5UZLA6zo8CrdZ8", "object": "chat.completion", "created": 1761169051, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery for detection table\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    magpsf, \n    sigmapsf, \n    diffmaglim, \n    NULL AS mag, \n    NULL AS e_mag, \n    'detection' AS table\nFROM \n    detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Subquery for non_detection table\nSELECT \n    oid, \n    mjd, \n    fid, \n    NULL AS isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    diffmaglim, \n    NULL AS mag, \n    NULL AS e_mag, \n    'non_detection' AS table\nFROM \n    non_detection\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Subquery for forced_photometry table\nSELECT \n    oid, \n    mjd, \n    fid, \n    isdiffpos, \n    NULL AS magpsf, \n    NULL AS sigmapsf, \n    NULL AS diffmaglim, \n    mag, \n    e_mag, \n    'forced_photometry' AS table\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aamtvxb'\n\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3660, "completion_tokens": 295, "total_tokens": 3955, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95263d0508190ab521dc6d54cc6bb", "custom_id": "106-2", "response": {"status_code": 200, "request_id": "a9832a801acd444c37f2ff53e7ebb88b", "body": {"id": "chatcmpl-CTaoP6yevYR56M3P5gXLueFD1XYoU", "object": "chat.completion", "created": 1761169053, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH stamp_classifier AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE class_name = 'bogus'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n),\nlc_classifier_top AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n)\nSELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient\nFROM object o\nINNER JOIN stamp_classifier sc ON o.oid = sc.oid\nINNER JOIN lc_classifier_top lc ON o.oid = lc.oid\nWHERE o.ndet > 10\nORDER BY sc.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3693, "completion_tokens": 198, "total_tokens": 3891, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f95263fccc81908151b74b1eaee7c5", "custom_id": "106-3", "response": {"status_code": 200, "request_id": "b17e5b9d22775c122b8304008233d226", "body": {"id": "chatcmpl-CTaoU1uv9uc6sJhfjIeIPSK05Nf6M", "object": "chat.completion", "created": 1761169058, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH stamp_classifier AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE class_name = 'bogus'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n),\nlc_classifier_top AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n)\nSELECT o.oid AS ZTF_identifier, o.ndet AS number_of_detections, o.firstmjd AS first_detection_date, \n       sc.prob_stamp_bogus, lc.prob_lc_transient\nFROM object o\nINNER JOIN stamp_classifier sc ON o.oid = sc.oid\nINNER JOIN lc_classifier_top lc ON o.oid = lc.oid\nWHERE o.ndet > 10\nORDER BY sc.prob_stamp_bogus\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3659, "completion_tokens": 218, "total_tokens": 3877, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95263f6888190bbd833c18978e0cf", "custom_id": "106-4", "response": {"status_code": 200, "request_id": "5ccf6fff5fca6df9bb4529e6f32ea11a", "body": {"id": "chatcmpl-CTaohQjGBhM8rCg1C9ZEubpvlRxTM", "object": "chat.completion", "created": 1761169071, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH stamp_classifier AS (\n    SELECT oid, probability AS prob_stamp_bogus\n    FROM probability\n    WHERE class_name = 'bogus'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.7\n),\nlc_classifier_top AS (\n    SELECT oid, probability AS prob_lc_transient\n    FROM probability\n    WHERE class_name = 'Transient'\n      AND classifier_name = 'lc_classifier_top'\n      AND probability > 0.9\n)\nSELECT o.oid AS \"ZTF identifier\", o.ndet AS \"number of detections\", o.firstmjd AS \"first detection date\", \n       sc.prob_stamp_bogus, lc.prob_lc_transient\nFROM object o\nINNER JOIN stamp_classifier sc ON o.oid = sc.oid\nINNER JOIN lc_classifier_top lc ON o.oid = lc.oid\nWHERE o.ndet > 10\nORDER BY sc.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3641, "completion_tokens": 216, "total_tokens": 3857, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f95263ec0c8190b24f70bec491325f", "custom_id": "39-2", "response": {"status_code": 200, "request_id": "2413fae5bc45ef7ddf37318b95867e33", "body": {"id": "chatcmpl-CTaov7lrYOqc9iyH23taVfaKZu5NF", "object": "chat.completion", "created": 1761169085, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH probability_filtered AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND class_name = 'CV/Nova'\n      AND classifier_name = 'lc_classifier_stochastic'\n),\nobject_filtered AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 50\n),\nmagstat_filtered AS (\n    SELECT oid, magmean_corr\n    FROM magstat\n    WHERE fid = 2\n),\ndetection_stats AS (\n    SELECT oid, candid, fid, ra, dec, magpsf, sigmapsf, magpsf_corr,\n           (MAX(magpsf) - MIN(magpsf)) AS max_rise_from_min\n    FROM detection\n    WHERE fid = 2\n    GROUP BY oid, candid, fid, ra, dec, magpsf, sigmapsf, magpsf_corr\n)\nSELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, \n       m.magmean_corr, d.magpsf_corr, d.max_rise_from_min\nFROM detection_stats d\nINNER JOIN probability_filtered p ON d.oid = p.oid\nINNER JOIN object_filtered o ON d.oid = o.oid\nINNER JOIN magstat_filtered m ON d.oid = m.oid\nORDER BY d.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3649, "completion_tokens": 294, "total_tokens": 3943, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_cbf1785567"}}, "error": null}
{"id": "batch_req_68f95263f8248190904c32be1ae35025", "custom_id": "39-3", "response": {"status_code": 200, "request_id": "ac9b9a4c2af45d582f45bc15dc564510", "body": {"id": "chatcmpl-CTap191L5WQCs3RER8wTFYT8RBCgB", "object": "chat.completion", "created": 1761169091, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH cv_nova_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n),\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN cv_nova_objects cno ON o.oid = cno.oid\n    WHERE o.ndet <= 50\n),\ndetection_info AS (\n    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf\n    FROM detection d\n    INNER JOIN filtered_objects fo ON d.oid = fo.oid\n    WHERE d.fid = 2\n),\nmagstat_info AS (\n    SELECT m.oid, m.magmean_corr\n    FROM magstat m\n    INNER JOIN filtered_objects fo ON m.oid = fo.oid\n    WHERE m.fid = 2\n),\nmax_rise_info AS (\n    SELECT d.oid, MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM detection d\n    INNER JOIN filtered_objects fo ON d.oid = fo.oid\n    WHERE d.fid = 2\n    GROUP BY d.oid\n)\nSELECT di.oid, di.candid, di.f_id, di.ra, di.dec, di.magpsf, di.sigmapsf, mi.magmean_corr, mri.max_rise\nFROM detection_info di\nINNER JOIN magstat_info mi ON di.oid = mi.oid\nINNER JOIN max_rise_info mri ON di.oid = mri.oid\nORDER BY di.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3651, "completion_tokens": 371, "total_tokens": 4022, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
{"id": "batch_req_68f9526429c481908811903bf417cbcf", "custom_id": "39-4", "response": {"status_code": 200, "request_id": "fa437126f6f7d79db69ec64040143725", "body": {"id": "chatcmpl-CTap2ciusfaorSsF1NwPfOUyQxwqZ", "object": "chat.completion", "created": 1761169092, "model": "gpt-4o-2024-08-06", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH classified_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'CV/Nova'\n      AND classifier_name = 'lc_classifier_stochastic'\n      AND ranking = 1\n),\nfiltered_objects AS (\n    SELECT o.oid, o.ndet\n    FROM object o\n    INNER JOIN classified_objects co ON o.oid = co.oid\n    WHERE o.ndet <= 50\n),\ndetection_info AS (\n    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf\n    FROM detection d\n    INNER JOIN filtered_objects fo ON d.oid = fo.oid\n    WHERE d.fid = 2\n),\nmagstat_info AS (\n    SELECT m.oid, m.magmean_corr\n    FROM magstat m\n    INNER JOIN filtered_objects fo ON m.oid = fo.oid\n    WHERE m.fid = 2\n),\nmax_rise_info AS (\n    SELECT oid, MAX(magpsf) - MIN(magpsf) AS max_rise\n    FROM detection\n    WHERE fid = 2\n    GROUP BY oid\n)\nSELECT di.oid, di.candid, di.f_id, di.ra, di.dec, di.magpsf, di.sigmapsf, mi.magmean_corr, mri.max_rise\nFROM detection_info di\nINNER JOIN magstat_info mi ON di.oid = mi.oid\nINNER JOIN max_rise_info mri ON di.oid = mri.oid\nORDER BY di.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3657, "completion_tokens": 339, "total_tokens": 3996, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f64f290af2"}}, "error": null}
