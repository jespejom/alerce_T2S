{"id": "batch_req_6880f893d2208190adecaa76ba300fec", "custom_id": "86-0", "response": {"status_code": 200, "request_id": "99ceb381cf1a993939a612acb702b751", "body": {"id": "chatcmpl-BwVCxPuclSxhmCjZYw9VEhNRx8RU8", "object": "chat.completion", "created": 1753282687, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select object OIDs with probability > 0.6 for classes 'CEP', 'DSCT', or 'RRL' in 'lc_classifier' with specified version\nWITH selected_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('CEP', 'DSCT', 'RRL')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.6\n),\n-- Subquery to select OIDs with closest PS1 object having star/galaxy score > 0.8\nps1_filtered AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE sgscore1 > 0.8\n)\n-- Main query to join the above conditions and retrieve all columns from 'probability' and 'ps1_ztf'\nSELECT p.*, ps1.*\nFROM probability p\nJOIN selected_objects so ON p.oid = so.oid\nJOIN ps1_ztf ps1 ON p.oid = ps1.oid\nWHERE ps1.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2855, "completion_tokens": 253, "total_tokens": 3108, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f893b560819087c7207678e339c7", "custom_id": "86-1", "response": {"status_code": 200, "request_id": "27b9d468c8d2bd1f0c074b333fa3ed39", "body": {"id": "chatcmpl-BwVCxie1oksZpcaxJ8n5wixFXxqDJ", "object": "chat.completion", "created": 1753282687, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to get object OIDs with probability > 0.6 for Cepheid, Delta Scuti, or RR Lyrae in the specified classifier\n    SELECT DISTINCT probability.oid\n    FROM probability\n    WHERE probability.class_name IN ('CEP', 'DSCT', 'RRL')\n      AND probability.classifier_name = 'lc_classifier'\n      AND probability.classifier_version = 'hierarchical_rf_1.1.0'\n      AND probability.probability > 0.6\n      AND probability.ranking = 1 -- Most probable class\n) AS filtered_oids\nJOIN probability p ON filtered_oids.oid = p.oid\nJOIN ps1_ztf ps ON filtered_oids.oid = ps.oid\nWHERE ps.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2855, "completion_tokens": 199, "total_tokens": 3054, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f893c53c8190b10d9ce239563758", "custom_id": "53-0", "response": {"status_code": 200, "request_id": "ae674d7cbda6ac5521b869a56944449f", "body": {"id": "chatcmpl-BwVCx16mvh0EFxcIGhvuQZxNKECv9", "object": "chat.completion", "created": 1753282687, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve date, filter ID, object ID, and 5-sigma magnitude limit for non-detections of the specified object\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1974, "completion_tokens": 89, "total_tokens": 2063, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f893c6988190a082506895777435", "custom_id": "53-1", "response": {"status_code": 200, "request_id": "233f71490037ed14a1e2a30d16f84310", "body": {"id": "chatcmpl-BwVCxM956ENQ8DUdmkhZR48jZQQPf", "object": "chat.completion", "created": 1753282687, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1974, "completion_tokens": 62, "total_tokens": 2036, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f893c68881908c737ee070475655", "custom_id": "36-0", "response": {"status_code": 200, "request_id": "a6bd0d522985e0187845b3cd0c9050f7", "body": {"id": "chatcmpl-BwVBzzgDTPgqauZQP9ZcyLZCUB6vz", "object": "chat.completion", "created": 1753282627, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4828, "completion_tokens": 56, "total_tokens": 4884, "prompt_tokens_details": {"cached_tokens": 4608, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f893c73c8190acf1ce8b1461c7ac", "custom_id": "36-1", "response": {"status_code": 200, "request_id": "9242e4dd088094fddf3b1051fa256a5d", "body": {"id": "chatcmpl-BwVBzQWTvUtKScmAgnMrDqvjIjXbn", "object": "chat.completion", "created": 1753282627, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4828, "completion_tokens": 56, "total_tokens": 4884, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f893c184819095d2ca3e10b3eb08", "custom_id": "91-0", "response": {"status_code": 200, "request_id": "426915d0ac8ebeb0a9bc48434fa60403", "body": {"id": "chatcmpl-BwVC0N5wDEQuibwXyWtPlgOIqpzbF", "object": "chat.completion", "created": 1753282628, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with W1-W2 color less than 1, including specified columns\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.magsigma - f_r.magsigma) AS mag_diff_g_r, -- difference between min g- and r-band difference magnitudes\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid\nJOIN \n    feature f_g ON o.oid = f_g.oid AND f_g.name = 'magmin' AND f_g.fid = 1\nJOIN \n    feature f_r ON o.oid = f_r.oid AND f_r.name = 'magmin' AND f_r.fid = 2\nWHERE \n    f_w1_w2.name = 'W1-W2' AND\n    f_w1_w2.value < 1\n    AND\n    -- Retrieve the feature version for W1-W2\n    f_w1_w2.version IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5691, "completion_tokens": 254, "total_tokens": 5945, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f893cb848190ac1ae23857dddcda", "custom_id": "91-1", "response": {"status_code": 200, "request_id": "49a8cce36c2af90d5333fd79cc7b2114", "body": {"id": "chatcmpl-BwVC04oax0qaekRipKplm1fq6o9aj", "object": "chat.completion", "created": 1753282628, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with W1-W2 color less than 1, including specified columns and limit to 100 results\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.magsigma - f_r.magsigma) AS mag_diff_g_r,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\nJOIN \n    feature f_g ON o.oid = f_g.oid AND f_g.name = 'magdiff_g'\nJOIN \n    feature f_r ON o.oid = f_r.oid AND f_r.name = 'magdiff_r'\nWHERE \n    f_w1_w2.value < 1\n    AND f_g.name = 'magdiff_g'\n    AND f_r.name = 'magdiff_r'\n    AND f_g.fid = 1 -- g-band\n    AND f_r.fid = 2 -- r-band\n    AND f_w1_w2.version = (SELECT version FROM feature_version ORDER BY version DESC LIMIT 1)\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5691, "completion_tokens": 273, "total_tokens": 5964, "prompt_tokens_details": {"cached_tokens": 5504, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f893be2481908f6f9060e6a40e33", "custom_id": "0-0", "response": {"status_code": 200, "request_id": "1f3040abc2cb6e32efde1d64ae1a5fdc", "body": {"id": "chatcmpl-BwVC0NUcHOZeqMHyTefLniraJWsmN", "object": "chat.completion", "created": 1753282628, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high probability of being YSOs and exhibiting periodicity\nSELECT \n    o.oid,\n    p.probability AS yso_probability,\n    f.value AS feature_value,\n    f.name AS feature_name,\n    f.fid AS filter_id,\n    f.version AS feature_version\nFROM \n    object o\n-- Subquery to get the probability of YSO classification with ranking=1 (most likely)\nJOIN (\n    SELECT \n        p1.oid,\n        p1.probability\n    FROM \n        probability p1\n    WHERE \n        p1.class_name = 'YSO'\n        AND p1.classifier_name = 'lc_classifier'\n        AND p1.ranking = 1\n        AND p1.probability > 0.7\n) p ON o.oid = p.oid\n-- Subquery to get features related to period and amplitude\nJOIN (\n    SELECT \n        f1.oid,\n        f1.value,\n        f1.name,\n        f1.fid,\n        f1.version\n    FROM \n        feature f1\n    WHERE \n        (f1.name = 'Multiband_period' AND f1.value BETWEEN 3 AND 10)\n        OR (f1.name = 'Amplitude' AND f1.value > 0.5)\n) f ON o.oid = f.oid\n-- Join to magstat to filter for objects with some periodicity (e.g., 'Periodic' class in top classifier)\nJOIN (\n    SELECT \n        p2.oid\n    FROM \n        probability p2\n    WHERE \n        p2.class_name = 'Periodic'\n        AND p2.classifier_name = 'lc_classifier_top'\n        AND p2.ranking = 1\n) p_periodic ON o.oid = p_periodic.oid\nORDER BY \n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5771, "completion_tokens": 389, "total_tokens": 6160, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f893fb5881909bc99886454e7aec", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "f0c4daf8e5f78b14fbf8934c7917c941", "body": {"id": "chatcmpl-BwVC18PXzaStfGdwdMKAIdvS5exxC", "object": "chat.completion", "created": 1753282629, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high probability of being YSOs and exhibiting periodicity\nSELECT \n    o.oid,\n    p.probability AS possibility,\n    f.value AS feature_value,\n    f.name AS feature_name,\n    f.fid AS filter_id,\n    f.version AS feature_version\nFROM \n    object o\n-- Subquery to get the probability of YSO classification with ranking=1 (most likely)\nJOIN (\n    SELECT \n        p1.oid,\n        p1.probability\n    FROM \n        probability p1\n    WHERE \n        p1.class_name = 'YSO'\n        AND p1.classifier_name = 'lc_classifier'\n        AND p1.ranking = 1\n        AND p1.probability > 0.7\n) p ON o.oid = p.oid\n-- Subquery to get features related to period and amplitude\nJOIN (\n    SELECT \n        f1.oid,\n        f1.value,\n        f1.name,\n        f1.fid,\n        f1.version\n    FROM \n        feature f1\n    WHERE \n        (f1.name = 'Multiband_period' AND f1.value BETWEEN 3 AND 10)\n        OR (f1.name = 'Amplitude' AND f1.value > 0.5)\n) f ON o.oid = f.oid\n-- Filter objects that have both period and amplitude features satisfying the conditions\nWHERE \n    -- Ensure object has both features\n    EXISTS (\n        SELECT 1 FROM feature f2\n        WHERE f2.oid = o.oid\n        AND (\n            (f2.name = 'Multiband_period' AND f2.value BETWEEN 3 AND 10)\n            OR (f2.name = 'Amplitude' AND f2.value > 0.5)\n        )\n    )\nORDER BY \n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5771, "completion_tokens": 390, "total_tokens": 6161, "prompt_tokens_details": {"cached_tokens": 5632, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f8944134819086ae48d03a2567c4", "custom_id": "70-0", "response": {"status_code": 200, "request_id": "82000da522198c55df39c5b870f1b140", "body": {"id": "chatcmpl-BwVC2AbFcMWyQ0N6PsQxqV55a9eVp", "object": "chat.completion", "created": 1753282630, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2211, "completion_tokens": 22, "total_tokens": 2233, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f894428481908b1652cbeec24946", "custom_id": "70-1", "response": {"status_code": 200, "request_id": "3f3beca9cebd324b00f54f25db9393b3", "body": {"id": "chatcmpl-BwVC3r4S4uRx6k8qAAzpfWIDaeogY", "object": "chat.completion", "created": 1753282631, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2211, "completion_tokens": 22, "total_tokens": 2233, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f8943f608190a66da8e2c85640e1", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "388ddbe91042e72ccf62c39508fffbff", "body": {"id": "chatcmpl-BwVC3QCiOWushoDGmZPr9nGWpJsLT", "object": "chat.completion", "created": 1753282631, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant object and detection information for objects classified as SN II with specified conditions\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n      AND p.probability > 0.6\n),\ncandidate_ids AS (\n    SELECT DISTINCT d.candid, d.oid, d.mjd, d.ra, d.dec, d.magpsf, d.sigmapsf, d.fid\n    FROM detection d\n    JOIN sn_ii_objects s ON d.oid = s.oid\n    WHERE d.mjd BETWEEN '2019-01-01' AND '2022-12-31'\n),\nmag_stats AS (\n    SELECT m.oid, m.fid, m.magmean, m.magmean_corr\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM sn_ii_objects)\n),\nrise_rates AS (\n    SELECT\n        d1.oid,\n        d1.candid,\n        d1.mjd,\n        d1.magpsf,\n        d1.sigmapsf,\n        d1.fid,\n        -- Calculate initial rise rate as change in magnitude over time between first two detections\n        (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS initial_rise_rate\n    FROM detection d1\n    JOIN detection d2 ON d1.oid = d2.oid AND d2.mjd > d1.mjd\n    WHERE d1.mjd = (\n        SELECT MIN(mjd) FROM detection WHERE oid = d1.oid\n    )\n    LIMIT 1\n),\nfiltered_objects AS (\n    SELECT s.oid\n    FROM sn_ii_objects s\n    JOIN rise_rates r ON s.oid = r.oid\n    WHERE r.initial_rise_rate > 0.5\n      AND (r.fid IN (1, 2)) -- g and r bands\n),\ndetection_time_series AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n      AND d.mjd IS NOT NULL\n),\nfinal_result AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.fid\n    FROM detection_time_series d\n    JOIN candidate_ids c ON d.candid = c.candid AND d.oid = c.oid\n)\nSELECT\n    c.oid,\n    c.candid,\n    c.mjd,\n    c.magpsf,\n    c.sigmapsf,\n    c.fid\nFROM final_result c\nORDER BY c.oid, c.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6307, "completion_tokens": 642, "total_tokens": 6949, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f89433f08190ba02af3d0666de67", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "20dc1dd4d0875ee228d34f4d319af011", "body": {"id": "chatcmpl-BwVC314Rn0d7tQ4Sq7Oyqs5IGH3yq", "object": "chat.completion", "created": 1753282631, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant columns from detection and magstat tables for objects classified as SN II\nWITH sn_ii_objects AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.probability\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.class_name = 'SNII'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier' AND class_name='SNII')\n        AND p.ranking = 1\n        AND p.probability > 0.6\n        AND o.firstmjd BETWEEN 58484 AND 58873 -- Corresponds to 2019-01-01 to 2022-12-31\n)\nSELECT\n    d.oid,\n    d.candid,\n    m.magmean,\n    m.magmean_corr,\n    -- Estimate initial rise rate as the difference in magnitude over the time difference\n    (d.mjd - (SELECT MIN(mjd) FROM detection WHERE oid=d.oid AND mjd <= d.mjd AND fid IN (1,2))) AS initial_rise_estimate,\n    d.fid AS band_id,\n    d.mjd\nFROM\n    detection d\nJOIN\n    magstat m ON d.oid = m.oid AND d.fid = m.fid\nWHERE\n    d.oid IN (SELECT oid FROM sn_ii_objects)\n    AND d.mjd BETWEEN 58484 AND 58873\n    AND d.n_pos > 50\n    AND (\n        (d.fid = 1 AND (d.mjd - (SELECT MIN(mjd) FROM detection WHERE oid=d.oid AND mjd <= d.mjd AND fid=1))) > 0.5\n        OR\n        (d.fid = 2 AND (d.mjd - (SELECT MIN(mjd) FROM detection WHERE oid=d.oid AND mjd <= d.mjd AND fid=2))) > 0.5\n    )\nORDER BY\n    d.oid, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6307, "completion_tokens": 449, "total_tokens": 6756, "prompt_tokens_details": {"cached_tokens": 6144, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f8944af881908b49aa643288170b", "custom_id": "46-0", "response": {"status_code": 200, "request_id": "f560fb2e1ddf0b8de45fe68f95f91557", "body": {"id": "chatcmpl-BwVC0mI9v9jPtDLmY4wsM16uwuaUQ", "object": "chat.completion", "created": 1753282628, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2398, "completion_tokens": 28, "total_tokens": 2426, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f89433688190b093aa26887c838e", "custom_id": "46-1", "response": {"status_code": 200, "request_id": "85d0350d0116d37c6a96de9b200079ed", "body": {"id": "chatcmpl-BwVC3d8wjf1xL1VtHAxsvsZKyasOb", "object": "chat.completion", "created": 1753282631, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2398, "completion_tokens": 28, "total_tokens": 2426, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f8943ac08190a47041d178b9ad2e", "custom_id": "60-0", "response": {"status_code": 200, "request_id": "4fc6a05cf1bfa4ea96156ed467b859c7", "body": {"id": "chatcmpl-BwVC1wwkbY68cuiTm1tvOV93SdZrz", "object": "chat.completion", "created": 1753282629, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns for objects with given ZTF identifiers, filtering for 'g' band (fid=1) and zero dubious points\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1\n    AND m.ndubious = 0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2612, "completion_tokens": 150, "total_tokens": 2762, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f89443a08190b42a56fee9ae4529", "custom_id": "60-1", "response": {"status_code": 200, "request_id": "4462d4813c660ae5022977dde583a656", "body": {"id": "chatcmpl-BwVBzszBQsGWns3Ox6LpOXHLsebGm", "object": "chat.completion", "created": 1753282627, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns for objects with given ZTF identifiers, filtering for 'ndubious' = 0 and 'fid' corresponding to g band (assumed to be 1)\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    magstat m\nJOIN \n    object o ON m.oid = o.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1\n    AND m.ndubious = 0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2612, "completion_tokens": 160, "total_tokens": 2772, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f8945dec8190b543a2c0c680a7b3", "custom_id": "97-0", "response": {"status_code": 200, "request_id": "7562515077cf0ea0bc0a3ad81735cabf", "body": {"id": "chatcmpl-BwVC0P1tBjStJGfr965E2FJ0TVF8b", "object": "chat.completion", "created": 1753282628, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_objects AS (\n    SELECT\n        o.oid,\n        p_stamp.probability AS prob_stamp_agn,\n        p_lc.probability AS prob_lc_lpv\n    FROM\n        object o\n    WHERE\n        -- Retrieve object OID\n        -- Filter for objects with probability > 0.6 of being AGN in stamp_classifier_1.0.4\n        (SELECT probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'AGN' AND p.classifier_name = 'stamp_classifier' AND p.classifier_version = 'stamp_classifier_1.0.4') > 0.6\n        AND\n        -- Filter for objects with probability > 0.7 of being LPV in the light curve classifier\n        (SELECT probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'LPV' AND p.classifier_name = 'lc_classifier' AND p.classifier_version = 'latest') > 0.7\n    LIMIT 50\n),\nprobabilities AS (\n    SELECT\n        o.oid,\n        -- Get the probability of AGN from stamp_classifier_1.0.4\n        (SELECT probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'AGN' AND p.classifier_name = 'stamp_classifier' AND p.classifier_version = 'stamp_classifier_1.0.4') AS prob_stamp_agn,\n        -- Get the probability of LPV from the light curve classifier\n        (SELECT probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'LPV' AND p.classifier_name = 'lc_classifier' AND p.classifier_version = 'latest') AS prob_lc_lpv\n    FROM\n        object o\n    WHERE\n        o.oid IN (SELECT oid FROM selected_objects)\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn,\n    prob_lc_lpv\nFROM\n    probabilities;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2636, "completion_tokens": 417, "total_tokens": 3053, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6880f89473788190a090f64af7709f47", "custom_id": "97-1", "response": {"status_code": 200, "request_id": "869ee8c22bcd766dba16c97d53810cf3", "body": {"id": "chatcmpl-BwVC1yFre9otzCrb0eCBXyQzh14Ir", "object": "chat.completion", "created": 1753282629, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 50 objects with specified classification probabilities\nSELECT \n    o.oid AS ztf_id,\n    p_stamp.probability AS prob_stamp_agn,\n    p_lc.probability AS prob_lc_lpv\nFROM \n    object o\n-- Subquery to get the highest probability of being AGN in the stamp classifier version 'stamp_classifier_1.0.4'\nJOIN (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier_1.0.4'\n        AND class_name = 'AGN'\n        AND ranking = 1\n        AND probability > 0.6\n) p_stamp ON o.oid = p_stamp.oid\n-- Subquery to get the highest probability of being LPV in the light curve classifier\nJOIN (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND class_name = 'LPV'\n        AND ranking = 1\n        AND probability > 0.7\n) p_lc ON o.oid = p_lc.oid\n-- Limit the result to 50 objects\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2591, "completion_tokens": 258, "total_tokens": 2849, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
