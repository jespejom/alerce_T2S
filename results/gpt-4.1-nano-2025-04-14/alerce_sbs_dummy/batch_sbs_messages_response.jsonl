{"id": "batch_req_6838295a2b4c8190b64e4bf5788313e9", "custom_id": "86-0", "response": {"status_code": 200, "request_id": "c441a1956b9b02d2c5e5a94bec727a8a", "body": {"id": "chatcmpl-BcTt0OQd3McViVlBzM7XLlYyacZzz", "object": "chat.completion", "created": 1748511046, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high probability of being Cepheid, delta Scuti, or RR Lyrae\nWITH filtered_prob AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'hierarchical_rf_1.1.0'\n      AND p.ranking = 1\n      AND p.probability > 0.6\n      AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n)\n-- Join with ps1_ztf to filter objects with star/galaxy score > 0.8\nSELECT p.*, ps1.*\nFROM probability p\nJOIN ps1_ztf ps1 ON p.oid = ps1.oid\nWHERE p.oid IN (SELECT oid FROM filtered_prob)\n  AND ps1.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1666, "completion_tokens": 177, "total_tokens": 1843, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a37948190947770f10b3e5bb4", "custom_id": "86-1", "response": {"status_code": 200, "request_id": "e91f7ac951680ca4aa6125227b491734", "body": {"id": "chatcmpl-BcTt0hd2U4XXdvpa5ZHoPQgmahbO8", "object": "chat.completion", "created": 1748511046, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select objects with high probability (>0.6) of being Cepheid, DSCT, or RRL\nWITH high_prob_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'hierarchical_rf_1.1.0'\n      AND ranking = 1\n      AND class_name IN ('CEP', 'DSCT', 'RRL')\n      AND probability > 0.6\n)\n-- Main query to join with ps1_ztf and filter by star/galaxy score\nSELECT p.*, ps.*\nFROM probability p\nJOIN ps1_ztf ps ON p.oid = ps.oid\nWHERE p.oid IN (SELECT oid FROM high_prob_objects)\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1666, "completion_tokens": 167, "total_tokens": 1833, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a42788190aabbd87cec4c03fe", "custom_id": "91-1", "response": {"status_code": 200, "request_id": "be04e9b583138065df3ae035b22c843d", "body": {"id": "chatcmpl-BcTt1ROicJNrDpmUTSy3vcaE8Lq1I", "object": "chat.completion", "created": 1748511047, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH w1_w2_feature AS (\n    SELECT f.oid, f.value AS w1_w2, f.version\n    FROM feature f\n    WHERE f.name = 'W1-W2'\n),\ng_r_max_feature AS (\n    SELECT f.oid, MIN(f.value) AS min_g_r_max\n    FROM feature f\n    WHERE f.name = 'g-r_max'\n    GROUP BY f.oid\n),\nr_w2_feature AS (\n    SELECT f.oid, MIN(f.value) AS min_r_w2\n    FROM feature f\n    WHERE f.name = 'r-W2'\n    GROUP BY f.oid\n)\nSELECT o.oid, o.ndet, \n       (g.min_g_r_max - r.min_r_w2) AS g_r_diff,\n       w.w1_w2, w.version\nFROM object o\nJOIN w1_w2_feature w ON o.oid = w.oid\nJOIN g_r_max_feature g ON o.oid = g.oid\nJOIN r_w2_feature r ON o.oid = r.oid\nWHERE w.w1_w2 < 1\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1644, "completion_tokens": 239, "total_tokens": 1883, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a4d888190a366bb0ac7b0540a", "custom_id": "0-0", "response": {"status_code": 200, "request_id": "1895c9ffea441b36a05b3cd3ef2bd3e3", "body": {"id": "chatcmpl-BcTt49PZ2MWILGT6VxGxIsj3ltJvR", "object": "chat.completion", "created": 1748511050, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery for objects likely to be YSOs with probability > 0.7\nWITH yso_candidates AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n),\n-- Subquery for objects with high probability of being periodic\nperiodic_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'Periodic'\n      AND p.classifier_name = 'lc_classifier_top'\n      AND p.ranking = 1\n),\n-- Filter objects that are both YSO candidates and periodic\nobjects_with_periodicity AS (\n    SELECT y.oid, y.probability\n    FROM yso_candidates y\n    INNER JOIN periodic_candidates p ON y.oid = p.oid\n),\n-- Retrieve features for these objects\nfeatures AS (\n    SELECT f.oid, f.name, f.value, f.fid, f.version\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM objects_with_periodicity)\n),\n-- Filter for photometric period between 3 and 10 days\nperiod_features AS (\n    SELECT oid, value AS period_value, fid, version\n    FROM features\n    WHERE name = 'Multiband_period'\n      AND value BETWEEN 3 AND 10\n),\n-- Filter for amplitude greater than 0.5 mag\namplitude_features AS (\n    SELECT oid, value AS amplitude_value, fid, version\n    FROM features\n    WHERE name = 'Amplitude'\n      AND value > 0.5\n)\n-- Final selection, joining all conditions and sorting by probability descending\nSELECT\n    y.oid,\n    y.probability,\n    pf.period_value AS value,\n    'Multiband_period' AS name,\n    pf.fid,\n    pf.version\nFROM objects_with_periodicity y\nJOIN period_features pf ON y.oid = pf.oid\nJOIN amplitude_features af ON y.oid = af.oid\nORDER BY y.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1654, "completion_tokens": 449, "total_tokens": 2103, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a57d081909ae342234bc3aa33", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "e16bfba55fd84181fa63595a5bb2b8ff", "body": {"id": "chatcmpl-BcTt60oFppskObddja4rIMLu2O9Ht", "object": "chat.completion", "created": 1748511052, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select objects with high probability of being YSOs\nWITH yso_candidates AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n),\n-- Subquery to find objects with periodic features between 3 and 10 days\nperiodic_objects AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name IN ('Multiband_period') -- assuming 'Multiband_period' indicates period features\n      AND f.value BETWEEN 3 AND 10\n      AND f.fid IN (1, 2, 3) -- assuming fid 1, 2, 3 correspond to g, r, i bands\n),\n-- Subquery to find objects with amplitude variation greater than 0.5 mag\namplitude_objects AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Amplitude' -- assuming 'Amplitude' indicates variation amplitude\n      AND f.value > 0.5\n)\n-- Final selection joining all conditions\nSELECT\n    yso_candidates.oid,\n    yso_candidates.probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM yso_candidates\nJOIN feature f ON yso_candidates.oid = f.oid\nWHERE f.oid IN (SELECT oid FROM periodic_objects)\n  AND f.oid IN (SELECT oid FROM amplitude_objects)\nORDER BY yso_candidates.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1654, "completion_tokens": 345, "total_tokens": 1999, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a63508190a5cf7c883f3409dd", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "83bda1344d039ec56dcdc3a515fad064", "body": {"id": "chatcmpl-BcTt9ndHvs0z4TOJ4Ku7hkrR64ynU", "object": "chat.completion", "created": 1748511055, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as SN II with high probability and sufficient detections within 2019-2022\nWITH classified_objects AS (\n    SELECT p.oid\n    FROM probability p\n    JOIN taxonomy t ON p.classifier_name = t.classifier_name AND p.classifier_version = t.classifier_version\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nobjects_time_window AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 58549 AND 59958 -- MJD for 2019-01-01 to 2022-12-31\n      AND o.lastmjd BETWEEN 58549 AND 59958\n),\nobjects_detection_counts AS (\n    SELECT o.oid, o.ndet\n    FROM object o\n    WHERE o.ndet > 50\n),\nlight_curve_data AS (\n    SELECT\n        d.oid,\n        d.candidate_id,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.fid\n    FROM detection d\n    WHERE d.fid IN (1, 2) -- g and r bands\n      AND d.magpsf IS NOT NULL\n      AND d.sigmapsf IS NOT NULL\n),\nearly_detections AS (\n    SELECT\n        lcd.oid,\n        lcd.candidate_id,\n        lcd.mjd,\n        lcd.magpsf,\n        lcd.sigmapsf,\n        lcd.fid,\n        ROW_NUMBER() OVER (PARTITION BY lcd.oid, lcd.fid ORDER BY lcd.mjd) AS rn\n    FROM light_curve_data lcd\n),\ninitial_rise_estimates AS (\n    SELECT\n        ed.oid,\n        ed.fid,\n        -- Calculate the slope of early detections (e.g., first 3 detections)\n        -- Using linear regression: slope = covariance / variance\n        -- For simplicity, approximate with a linear fit over first few points\n        -- Here, we use a simple approach: difference between first and third detection divided by time difference\n        ( (SELECT magpsf FROM early_detections ed2 WHERE ed2.oid = ed.oid AND ed2.fid = ed.fid AND ed2.rn = 3) - \n          (SELECT magpsf FROM", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "length"}], "usage": {"prompt_tokens": 1648, "completion_tokens": 512, "total_tokens": 2160, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a6e9081909be7ea5fef029039", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "c59c13fd06a19ef67925710b71b73a72", "body": {"id": "chatcmpl-BcTtCU9G69iBbnZu3y4eMxFM1Hhb6", "object": "chat.completion", "created": 1748511058, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for 2019-2022 in Julian Date\nWITH date_range AS (\n    SELECT \n        -- Julian date for 2019-01-01\n        2458484.5 AS start_mjd,\n        -- Julian date for 2022-12-31\n        2459945.5 AS end_mjd\n),\n-- Select objects classified as SN II with probability > 0.6, ranking 1, and detection count > 50 within the date range\nclassified_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN taxonomy t ON p.classifier_name = t.classifier_name AND p.classifier_version = t.classifier_version\n    WHERE p.class_name = 'SNII'\n      AND p.ranking = 1\n      AND p.probability > 0.6\n      AND o.ndet > 50\n      AND o.firstmjd <= (SELECT end_mjd FROM date_range)\n      AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n),\n-- Select detections for the classified objects\ndetections AS (\n    SELECT d.oid, d.mjd, d.magpsf, d.sigmapsf, d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM classified_objects)\n),\n-- Calculate initial rise rate for each object in g and r bands\nrise_rates AS (\n    SELECT \n        d.oid,\n        -- Filter detections for g-band (fid = 1) and r-band (fid = 2)\n        MAX(CASE WHEN d.fid = 1 THEN d.mjd END) AS max_mjd_g,\n        MAX(CASE WHEN d.fid = 2 THEN d.mjd END) AS max_mjd_r,\n        -- Calculate initial rise in g-band\n        (MIN(CASE WHEN d.fid = 1 THEN d.mjd END) - (SELECT firstmjd FROM object o WHERE o.oid = d.oid)) AS t_rise_g,\n        -- Calculate initial rise in r-band\n        (MIN(CASE WHEN d.fid = 2 THEN d.mjd END) - (SELECT firstmjd FROM object o WHERE o.oid = d.oid)) AS t_rise_r,\n        -- Magnitudes at first detection in g and r\n        (SELECT magpsf FROM detection d2 WHERE d2", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "length"}], "usage": {"prompt_tokens": 1647, "completion_tokens": 512, "total_tokens": 2159, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a79c8819096c5d231ada77f17", "custom_id": "60-0", "response": {"status_code": 200, "request_id": "29947e14a2f0e60f6810882e6b4f04f4", "body": {"id": "chatcmpl-BcTtFnw5P7h4YZ411uZ6dYZ9ro6aH", "object": "chat.completion", "created": 1748511061, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH object_ids AS (\n    SELECT unnest(ARRAY['ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk']) AS oid\n)\nSELECT\n    m.oid,\n    m.ndet,\n    m.dmdt_first,\n    m.dm_first\nFROM\n    object_ids o\nJOIN\n    magstat m ON o.oid = m.oid\nWHERE\n    m.fid = 1 -- g band\n    AND m.ndubious = 0; -- zero dubious corrections", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1551, "completion_tokens": 114, "total_tokens": 1665, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a84808190aa93ec2153c0f1f6", "custom_id": "60-1", "response": {"status_code": 200, "request_id": "35c8a22449c59d239eb32e064b609086", "body": {"id": "chatcmpl-BcTtHoxRLj7ot1mJeDqUfJbv26DOk", "object": "chat.completion", "created": 1748511063, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH ztf_ids AS (\n    SELECT unnest(ARRAY['ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk']) AS oid\n)\nSELECT\n    ztf_ids.oid,\n    m.ndet,\n    m.dm_first,\n    m.magfirst\nFROM\n    ztf_ids\nJOIN\n    magstat m ON ztf_ids.oid = m.oid\nWHERE\n    m.fid = 1 -- g band\n    AND m.ndubious = 0; -- zero dubious corrections", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1630, "completion_tokens": 117, "total_tokens": 1747, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a9058819089dc674e1870c734", "custom_id": "97-0", "response": {"status_code": 200, "request_id": "c0cc0a6dfecc904613b0d46817cfd4c9", "body": {"id": "chatcmpl-BcTtI1wseyOHrSR035xJwdKYqeGmF", "object": "chat.completion", "created": 1748511064, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with specified probabilities for AGN and LPV classes\nSELECT \n    o.oid AS ztf_identifier,\n    p_agn.probability AS prob_stamp_agn,\n    p_lpv.probability AS prob_lc_lpv\nFROM \n    object o\nJOIN \n    -- Subquery for AGN probability in stamp classifier\n    (\n        SELECT \n            oid, probability\n        FROM \n            probability\n        WHERE \n            classifier_name = 'stamp_classifier_1.0.4'\n            AND class_name = 'AGN'\n            AND ranking = 1\n            AND probability > 0.6\n    ) p_agn ON o.oid = p_agn.oid\nJOIN \n    -- Subquery for LPV probability in light curve classifier\n    (\n        SELECT \n            oid, probability\n        FROM \n            probability\n        WHERE \n            classifier_name = 'lc_classifier'\n            AND class_name = 'LPV'\n            AND ranking = 1\n            AND probability > 0.7\n    ) p_lpv ON o.oid = p_lpv.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1673, "completion_tokens": 236, "total_tokens": 1909, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
{"id": "batch_req_6838295a9e94819099b877c17f374ecb", "custom_id": "97-1", "response": {"status_code": 200, "request_id": "7cdc4c03672f1a381355fa0174d6b900", "body": {"id": "chatcmpl-BcTt1XaIw9624J22Y0VU7QYCEYbAQ", "object": "chat.completion", "created": 1748511047, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_probs AS (\n    SELECT\n        p1.oid,\n        p1.probability AS prob_stamp_agn,\n        p2.probability AS prob_lc_lpv\n    FROM\n        probability p1\n    JOIN\n        probability p2 ON p1.oid = p2.oid\n    WHERE\n        p1.classifier_name = 'stamp_classifier_1.0.4'\n        AND p1.class_name = 'AGN'\n        AND p1.ranking = 1\n        AND p1.probability > 0.6\n        AND p2.classifier_name = 'lc_classifier'\n        AND p2.class_name = 'LPV'\n        AND p2.ranking = 1\n        AND p2.probability > 0.7\n)\nSELECT\n    o.oid AS ztf_identifier,\n    fp.prob_stamp_agn,\n    fp.prob_lc_lpv\nFROM\n    filtered_probs fp\nJOIN\n    object o ON fp.oid = o.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1673, "completion_tokens": 222, "total_tokens": 1895, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_8fd43718b3"}}, "error": null}
