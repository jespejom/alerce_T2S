{"id": "batch_req_68382f914f408190ab016670d115d8a5", "custom_id": "91-0", "response": {"status_code": 200, "request_id": "df00f6389d4a78f66862b641ddd68602", "body": {"id": "chatcmpl-BcUEJSEhZWFuLx2Af3aHnMREES7zr", "object": "chat.completion", "created": 1748512367, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select ZTF objects with W1-W2 color less than 1, including specific properties\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    -- Calculate difference between g-r_max and r-r_max (assuming g-r_max and r-r_max are features)\n    (f_g_r_max.value - f_r_r_max.value) AS mag_diff_g_r,\n    -- W1-W2 feature value renamed as w1_w2\n    f_w1_w2.value AS w1_w2,\n    -- Feature version for W1-W2\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature for g-r_max (g-band g-r_max)\nJOIN \n    feature f_g_r_max ON o.oid = f_g_r_max.oid AND f_g_r_max.name = 'g-r_max' AND f_g_r_max.fid = 1\n-- Join with feature for r-r_max (r-band g-r_max)\nJOIN \n    feature f_r_r_max ON o.oid = f_r_r_max.oid AND f_r_r_max.name = 'g-r_max' AND f_r_r_max.fid = 2\n-- Join with feature for W1-W2 color\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4789, "completion_tokens": 342, "total_tokens": 5131, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_68382f915dd48190a998411d49537bbb", "custom_id": "91-1", "response": {"status_code": 200, "request_id": "1e44cda8836fcaad489e70320cf727fa", "body": {"id": "chatcmpl-BcUIwlGMasfaY2TAyfEWAZefDfOXY", "object": "chat.completion", "created": 1748512654, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with 'W1-W2' color less than 1, including relevant features and statistics\nWITH w1_w2_feature AS (\n    SELECT f.oid, f.value AS w1_w2, f.version\n    FROM feature f\n    WHERE f.name = 'W1-W2'\n),\ng_r_max_feature AS (\n    SELECT f.oid, f.value AS g_r_max\n    FROM feature f\n    WHERE f.name = 'g-r_max'\n),\nr_w2_feature AS (\n    SELECT f.oid, f.value AS r_w2\n    FROM feature f\n    WHERE f.name = 'r-W2'\n),\nobject_detection_counts AS (\n    -- Count total detections per object from magstat table\n    SELECT oid, COUNT(*) AS ndet\n    FROM magstat\n    GROUP BY oid\n)\nSELECT \n    o.oid, \n    odc.ndet, \n    (g.g_r_max - r.r_w2) AS g_r_diff, \n    w.w1_w2 AS w1_w2, \n    w.version\nFROM object o\n-- Join with detection counts\nJOIN object_detection_counts odc ON o.oid = odc.oid\n-- Join with W1-W2 feature\nJOIN w1_w2_feature w ON o.oid = w.oid\n-- Join with g-r_max feature\nJOIN g_r_max_feature g ON o.oid = g.oid\n-- Join with r-W2 feature\nJOIN r_w2_feature r ON o.oid = r.oid\n-- Filter objects where W1-W2 color is less than 1\nWHERE w.w1_w2 < 1\n-- Limit to 100 results for performance\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4648, "completion_tokens": 362, "total_tokens": 5010, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_68382f916fe48190b46c0258720a9517", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "7212ac2fd0862a5d7bb79658580e2202", "body": {"id": "chatcmpl-BcUEKtqDs3jC3zkvmjb1HtbTqBWP8", "object": "chat.completion", "created": 1748512368, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high probability of being YSOs, with additional constraints to optimize query performance\nWITH yso_candidates AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n),\n-- Find objects with periodic features between 3 and 10 days in any band\nperiodic_objects AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Multiband_period'\n      AND f.value BETWEEN 3 AND 10\n      AND f.fid IN (1, 2, 3) -- bands g, r, i\n),\n-- Find objects with amplitude variation greater than 0.5 mag\namplitude_objects AS (\n    SELECT DISTINCT f.oid\n    FROM feature f\n    WHERE f.name = 'Amplitude'\n      AND f.value > 0.5\n)\n-- Join all conditions to get final list\nSELECT\n    yso_candidates.oid,\n    yso_candidates.probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM yso_candidates\nJOIN feature f ON yso_candidates.oid = f.oid\nWHERE f.oid IN (SELECT oid FROM periodic_objects)\n  AND f.oid IN (SELECT oid FROM amplitude_objects)\n  -- Additional join to ensure the object also has the probability condition\n  AND f.oid IN (SELECT oid FROM probability p WHERE p.oid = yso_candidates.oid AND p.probability > 0.7)\nORDER BY yso_candidates.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4877, "completion_tokens": 363, "total_tokens": 5240, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_68382f918054819088eb1ab6fbd18c03", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "83b17b218f244e95861d6310e264987f", "body": {"id": "chatcmpl-BcUELoEmA3LgiYkWaHd0eBtsO8vxX", "object": "chat.completion", "created": 1748512369, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Corrected SQL query with proper syntax, table/column references, and comments\nWITH classified_objects AS (\n    SELECT p.oid\n    FROM probability p\n    JOIN taxonomy t ON p.classifier_name = t.classifier_name AND p.classifier_version = t.classifier_version\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nobjects_time_window AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 58549 AND 59958 -- 2019-01-01 to 2022-12-31\n      AND o.lastmjd BETWEEN 58549 AND 59958\n),\nobjects_detection_counts AS (\n    SELECT o.oid, o.ndet\n    FROM object o\n    WHERE o.ndet > 50\n),\nlight_curve_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.fid\n    FROM detection d\n    WHERE d.fid IN (1, 2) -- g and r bands\n      AND d.magpsf IS NOT NULL\n      AND d.sigmapsf IS NOT NULL\n),\nearly_detections AS (\n    SELECT\n        lcd.oid,\n        lcd.candid,\n        lcd.mjd,\n        lcd.magpsf,\n        lcd.sigmapsf,\n        lcd.fid,\n        ROW_NUMBER() OVER (PARTITION BY lcd.oid, lcd.fid ORDER BY lcd.mjd) AS rn\n    FROM light_curve_data lcd\n),\ninitial_rise_estimates AS (\n    SELECT\n        ed.oid,\n        ed.fid,\n        -- Approximate initial rise rate: difference between 3rd and 1st detection divided by time difference\n        -- Ensure that the 3rd detection exists\n        ( \n            (SELECT magpsf FROM early_detections ed2 WHERE ed2.oid = ed.oid AND ed2.fid = ed.fid AND ed2.rn = 3)\n            - (SELECT magpsf FROM early_detections ed1 WHERE ed1.oid = ed.oid AND ed1.fid = ed.fid AND ed1.rn = 1)\n        ) / NULLIF(\n            (\n                (SELECT mj", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "length"}], "usage": {"prompt_tokens": 5715, "completion_tokens": 512, "total_tokens": 6227, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_68382f9190d48190ba242f0f5b8075b4", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "65c170e864cce217656039064fc1c355", "body": {"id": "chatcmpl-BcUENW9D4y6HQyxP24SDCJyhauF5O", "object": "chat.completion", "created": 1748512371, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Corrected SQL query with proper syntax, schema references, and comments\nWITH date_range AS (\n    SELECT \n        2458484.5 AS start_mjd, -- Julian date for 2019-01-01\n        2459945.5 AS end_mjd  -- Julian date for 2022-12-31\n),\nclassified_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN taxonomy t ON p.classifier_name = t.classifier_name AND p.classifier_version = t.classifier_version\n    WHERE p.class_name = 'SNII' -- Class name for Type II Supernovae\n      AND p.ranking = 1\n      AND p.probability > 0.6\n      AND o.ndet > 50\n      AND o.firstmjd <= (SELECT end_mjd FROM date_range)\n      AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n),\ndetections AS (\n    SELECT d.oid, d.mjd, d.magpsf, d.sigmapsf, d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM classified_objects)\n),\nrise_rates AS (\n    SELECT \n        d.oid,\n        -- Max detection time in g-band (fid=1)\n        MAX(CASE WHEN d.fid = 1 THEN d.mjd END) AS max_mjd_g,\n        -- Max detection time in r-band (fid=2)\n        MAX(CASE WHEN d.fid = 2 THEN d.mjd END) AS max_mjd_r,\n        -- First detection time in g-band\n        MIN(CASE WHEN d.fid = 1 THEN d.mjd END) AS first_mjd_g,\n        -- First detection time in r-band\n        MIN(CASE WHEN d.fid = 2 THEN d.mjd END) AS first_mjd_r\n    FROM detection d\n    GROUP BY d.oid\n),\ninitial_rise AS (\n    SELECT \n        o.oid,\n        -- Calculate initial rise time in g-band (time from first detection to first detection in g)\n        (frg.first_mjd_g - o.firstmjd) AS t_rise_g,\n        -- Calculate initial rise time in r-band\n        (frr.first_mjd_r - o.firstmjd) AS t_rise_r,\n        -- Magnitude at first detection in g-band\n        (", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "length"}], "usage": {"prompt_tokens": 5744, "completion_tokens": 512, "total_tokens": 6256, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
