{"id": "batch_req_68432ff485e481908241d27635343e18", "custom_id": "86-0", "response": {"status_code": 200, "request_id": "918fcbaf0ef28b4f70f27160863fb849", "body": {"id": "chatcmpl-BfVrJKxu3pqN0gmRYYcJaTtwyB8DM", "object": "chat.completion", "created": 1749233613, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, pz.*\nFROM (\n    -- Subquery to find object OIDs with probability > 0.6 for any of the specified classes in the hierarchical_rf_1.1.0 classifier\n    SELECT DISTINCT prob.oid\n    FROM probability prob\n    WHERE prob.class_name IN ('Cepheid', 'DSCT', 'RRL')\n      AND prob.classifier_name = 'lc_classifier_top'\n      AND prob.classifier_version = 'hierarchical_rf_1.1.0'\n      AND prob.probability > 0.6\n) AS filtered_oids\nJOIN probability p ON p.oid = filtered_oids.oid\nJOIN ps1_ztf pz ON pz.oid = filtered_oids.oid\nWHERE pz.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3353, "completion_tokens": 194, "total_tokens": 3547, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff490a88190b73b341c5f73454c", "custom_id": "86-1", "response": {"status_code": 200, "request_id": "b05901bf584d8d64033bb11a1acfb724", "body": {"id": "chatcmpl-BfVrRj4FcMZgI2JXx3Vlwy3hkWkXp", "object": "chat.completion", "created": 1749233621, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, pz.*\nFROM (\n    -- Subquery to get object OIDs with probability > 0.6 for any of the specified classes in the hierarchical_rf_1.1.0 classifier\n    SELECT DISTINCT prob.oid\n    FROM probability prob\n    WHERE prob.class_name IN ('Cepheid', 'DSCT', 'RRL')\n      AND prob.classifier_name = 'lc_classifier_top'\n      AND prob.classifier_version = 'hierarchical_rf_1.1.0'\n      AND prob.probability > 0.6\n) AS filtered_oids\nJOIN probability p ON p.oid = filtered_oids.oid\nJOIN ps1_ztf pz ON pz.oid = filtered_oids.oid\nWHERE pz.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3353, "completion_tokens": 194, "total_tokens": 3547, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff49be4819096034e2d0c2f0914", "custom_id": "53-0", "response": {"status_code": 200, "request_id": "589833258e434cf964037cf571ca082d", "body": {"id": "chatcmpl-BfVrTSHntEI3hl9gTMsCi5Si7MvZF", "object": "chat.completion", "created": 1749233623, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve date, filter ID, object ID, and 5-sigma magnitude limit for all non-detections of the specified object\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit_5sigma\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1989, "completion_tokens": 93, "total_tokens": 2082, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff4a6c08190943134da73823538", "custom_id": "53-1", "response": {"status_code": 200, "request_id": "672f90446342dd2c4e9525154b587577", "body": {"id": "chatcmpl-BfVrUotlVJgk6OrYQ7Yp1TjKx5iYD", "object": "chat.completion", "created": 1749233624, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve date, filter ID, object ID, and 5-sigma magnitude limit for all non-detections of the specified object\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1989, "completion_tokens": 90, "total_tokens": 2079, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff4b1b88190b596e7bfb8f49ee2", "custom_id": "36-0", "response": {"status_code": 200, "request_id": "0bcb74d32bc0d7d6c853b7f344d3d652", "body": {"id": "chatcmpl-BfVrNkgJkDT3SRUJ3caKQnXE7BJ7d", "object": "chat.completion", "created": 1749233617, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the object oid, feature name, and feature value for the specified object\nSELECT \n    o.oid,\n    f.name,\n    f.value\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.oid = 'ZTF20aaelulu';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4777, "completion_tokens": 71, "total_tokens": 4848, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff4bd5c819091105497e715d42d", "custom_id": "36-1", "response": {"status_code": 200, "request_id": "1f874169d9f56800339cb2da377f6e18", "body": {"id": "chatcmpl-BfVrJJv49ySIZNheuIlu3peDtn5fk", "object": "chat.completion", "created": 1749233613, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the object oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4777, "completion_tokens": 57, "total_tokens": 4834, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff4c86c819085424e892d89ff73", "custom_id": "91-0", "response": {"status_code": 200, "request_id": "5729d068afd08ebd53b72af4dee19937", "body": {"id": "chatcmpl-BfVrJLqv0GsNHIxTaPFqhE9M7NkLT", "object": "chat.completion", "created": 1749233613, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select ZTF objects with 'W1-W2' color lower than 1, including specified columns\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.value - f_r.value) AS mag_diff_g_r,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r difference features\nJOIN \n    feature f_g ON o.oid = f_g.oid AND f_g.name = 'g-r_max' AND f_g.fid = 13\nJOIN \n    feature f_r ON o.oid = f_r.oid AND f_r.name = 'r-W2' AND f_r.fid = 12\n-- Join with feature table to get 'W1-W2' feature\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2' AND f_w1_w2.fid = 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4825, "completion_tokens": 260, "total_tokens": 5085, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff4d370819087336fdf9aacc114", "custom_id": "91-1", "response": {"status_code": 200, "request_id": "5ff9d01f07cda38cdb964a0d43572613", "body": {"id": "chatcmpl-BfVrJ6f5bWEwWN1XGdtlpijsOxlJg", "object": "chat.completion", "created": 1749233613, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select ZTF objects with 'W1-W2' color lower than 1, including specified columns\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.value - f_r.value) AS mag_diff_g_r,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table for g-band feature\nJOIN \n    feature f_g ON o.oid = f_g.oid AND f_g.name = 'g-r_max' AND f_g.fid = 1\n-- Join with feature table for r-band feature\nJOIN \n    feature f_r ON o.oid = f_r.oid AND f_r.name = 'g-r_max' AND f_r.fid = 2\n-- Join with feature table for W1-W2 feature\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2' AND f_w1_w2.fid = 1\n-- Filter for objects where W1-W2 color is less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4989, "completion_tokens": 281, "total_tokens": 5270, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff4dec88190aa5a11c763548716", "custom_id": "0-0", "response": {"status_code": 200, "request_id": "1af7ef9e362ae99671d21a5bc51e5517", "body": {"id": "chatcmpl-BfVrLoZqRaG8TuKtkDji0AmkP08u1", "object": "chat.completion", "created": 1749233615, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity with specified criteria\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.ranking,\n        f.name AS feature_name,\n        f.value,\n        f.fid AS filter_id,\n        f.version AS feature_version\n    FROM\n        probability p\n    JOIN\n        feature f ON p.oid = f.oid\n    WHERE\n        p.class_name = 'YSO'\n        AND p.probability > 0.7\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n        AND p.ranking = 1\n        AND f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n        AND EXISTS (\n            SELECT 1\n            FROM feature f2\n            WHERE\n                f2.oid = p.oid\n                AND f2.name = 'Amplitude'\n                AND f2.value > 0.5\n        )\n)\nSELECT\n    oid,\n    possibility,\n    class_name,\n    feature_name,\n    value,\n    filter_id,\n    feature_version\nFROM\n    yso_prob\nORDER BY\n    possibility DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5018, "completion_tokens": 281, "total_tokens": 5299, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff4ea5c8190b956792c9ba3b9ee", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "ec92e7930a728f01c3db27fcd5f83a31", "body": {"id": "chatcmpl-BfVrOt0UfDUi7OR80b3K6pEN5dgJm", "object": "chat.completion", "created": 1749233618, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity with specified criteria\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        f.name AS feature_name,\n        f.value AS feature_value,\n        f.fid AS filter_id,\n        f.version AS feature_version\n    FROM\n        probability p\n    JOIN\n        feature f ON p.oid = f.oid\n    WHERE\n        p.class_name = 'YSO'\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n        AND p.ranking = 1\n        AND f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n        AND EXISTS (\n            SELECT 1\n            FROM feature f2\n            WHERE\n                f2.oid = p.oid\n                AND f2.name = 'Amplitude'\n                AND f2.value > 0.5\n        )\n)\nSELECT\n    oid,\n    possibility,\n    class_name,\n    feature_name,\n    feature_value,\n    filter_id,\n    feature_version\nFROM\n    yso_prob\nORDER BY\n    possibility DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5018, "completion_tokens": 283, "total_tokens": 5301, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff4f6608190b3038bdf82b81dbf", "custom_id": "70-0", "response": {"status_code": 200, "request_id": "572521c4fb3a99f4ccbcd20bb33e57d8", "body": {"id": "chatcmpl-BfVrKlq8o8x6ymWp5T8Ve78QsVls7", "object": "chat.completion", "created": 1749233614, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns for the object with oid 'ZTF22aayjqah' from the reference table\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2708, "completion_tokens": 44, "total_tokens": 2752, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff5014c81909405fdccd180ca7c", "custom_id": "70-1", "response": {"status_code": 200, "request_id": "cbe669a35c0cd7df28e2ed5aec30718c", "body": {"id": "chatcmpl-BfVrLiftJnqk8lhdiPpqQjbvlJQ56", "object": "chat.completion", "created": 1749233615, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns for the object with oid 'ZTF22aayjqah' from the reference table\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2708, "completion_tokens": 44, "total_tokens": 2752, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff50bd08190a4cfc4a59c7edf3f", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "5fd99f87bcf0ae7e8b4b96649607827d", "body": {"id": "chatcmpl-BfVrNodp0jXx9ei5Ku9FqSax4Nzih", "object": "chat.completion", "created": 1749233617, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant information for objects classified as SN II with specified conditions\nWITH sn_ii_objects AS (\n    SELECT o.oid, p.oid, p.class_name, p.probability, p.ranking\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 2458600 AND 2459580 -- Corresponds roughly to 2019-2022\n),\nsn_ii_candidates AS (\n    SELECT d.candid, d.oid, d.mjd, d.ra, d.dec, d.magpsf, d.sigmapsf, d.fid\n    FROM detection d\n    JOIN sn_ii_objects s ON d.oid = s.oid\n    WHERE d.mjd BETWEEN 2458600 AND 2459580\n),\nmag_stats AS (\n    SELECT ms.oid, ms.fid, ms.magmax, ms.magmax_corr, ms.dm_first, ms.dmdt_first\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM sn_ii_objects)\n),\nrise_rates AS (\n    SELECT\n        s.oid,\n        -- Calculate initial rise rate as mag change over time in days\n        CASE WHEN COUNT(*) > 1 THEN\n            (MAX(ms.magmax) - MIN(ms.magmax)) / NULLIF(MAX(d.mjd) - MIN(d.mjd), 0)\n        ELSE NULL END AS initial_rise_rate\n    FROM sn_ii_candidates d\n    JOIN magstat ms ON d.oid = ms.oid\n    WHERE ms.fid IN (1, 2) -- g and r bands\n    GROUP BY s.oid\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS ndet\n    FROM detection\n    GROUP BY oid\n)\nSELECT\n    o.oid,\n    c.candid,\n    m.magmax,\n    m.sigmapsf,\n    m.dm_first,\n    c.fid\nFROM sn_ii_objects o\nJOIN sn_ii_candidates c ON o.oid = c.oid\nJOIN magstat m ON o.oid = m.oid AND m.fid = c.fid\nJOIN rise_rates r ON o.oid = r.oid\nJOIN detection_counts d ON o.oid = d.oid\nWHERE\n    r.initial_rise_rate > 0.5\n    AND d.ndet > 50\n    AND c.mjd BETWEEN 2458600 AND 2459580;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3845, "completion_tokens": 560, "total_tokens": 4405, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff5174081908cd45711293d6061", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "e9bb367dfbda9b8ff4ca756db30b23ac", "body": {"id": "chatcmpl-BfVrQEcr5P1WVVOt9DNVEFosukwV7", "object": "chat.completion", "created": 1749233620, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant information for objects classified as SN II with specified conditions\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNIII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN '2019-01-01' AND '2022-12-31'\n      AND o.ndet > 50\n),\nrise_rates AS (\n    SELECT\n        m.oid,\n        -- Calculate initial rise rate as change in magnitude over time between first and second detection\n        (m.magfirst - m.maglast) / NULLIF((m.lastmjd - m.firstmjd), 0) AS rise_rate\n    FROM magstat m\n    WHERE m.ndet >= 2\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    -- Estimate initial rise as the difference between first and last magnitude divided by time\n    (m.magfirst - m.maglast) / NULLIF((m.lastmjd - m.firstmjd), 0) AS initial_rise,\n    d.fid\nFROM detection d\nJOIN sn_ii_objects s ON d.oid = s.oid\nJOIN magstat m ON d.oid = m.oid AND d.mjd BETWEEN '2019-01-01' AND '2022-12-31' AND m.ndet > 0\nWHERE\n    -- Filter for g-band (fid=1) and r-band (fid=2)\n    d.fid IN (1, 2)\n    AND -- Calculate rise rate for each band\n    (\n        -- For g-band\n        (d.fid = 1 AND \n         (SELECT (magfirst - maglast) / NULLIF((lastmjd - firstmjd), 0) FROM magstat WHERE oid = d.oid AND fid = 1) > 0.5)\n        OR\n        -- For r-band\n        (d.fid = 2 AND \n         (SELECT (magfirst - maglast) / NULLIF((lastmjd - firstmjd), 0) FROM magstat WHERE oid = d.oid AND fid = 2) > 0.5)\n    )\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3845, "completion_tokens": 521, "total_tokens": 4366, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff5234c8190a971b529ae0f23df", "custom_id": "46-0", "response": {"status_code": 200, "request_id": "36a05df1f8c42dcf79e2145c31c8b6db", "body": {"id": "chatcmpl-BfVrTTCx20LQv5wYgGhtrrhPSLgTX", "object": "chat.completion", "created": 1749233623, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2413, "completion_tokens": 26, "total_tokens": 2439, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff52ddc819082f1d34ac73a0ee5", "custom_id": "46-1", "response": {"status_code": 200, "request_id": "dc5d7e6c3c21ce8918be5006029e2ab5", "body": {"id": "chatcmpl-BfVrQoOjnnJIpYqTLdvDBOwLXT70E", "object": "chat.completion", "created": 1749233620, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2413, "completion_tokens": 28, "total_tokens": 2441, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff537dc8190936f522541e163a0", "custom_id": "60-0", "response": {"status_code": 200, "request_id": "e65b05680a4f7407bedd1a079c1b5fe2", "body": {"id": "chatcmpl-BfVrLEZTh1M5q7ogY88PKyGYyTGMm", "object": "chat.completion", "created": 1749233615, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns for objects with given ZTF identifiers, filtering for g band (fid=2) and zero dubious corrections\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 2\n    AND m.ndubious = 0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3109, "completion_tokens": 148, "total_tokens": 3257, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff5427881908108570012f0c6d4", "custom_id": "60-1", "response": {"status_code": 200, "request_id": "cb4e681806d3df445bb906e73d73a4e9", "body": {"id": "chatcmpl-BfVrLwlqyNP4yshxXiNhCD8PD94Ch", "object": "chat.completion", "created": 1749233615, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns for objects with given ZTF identifiers, filtering for g band (fid=1) and ndubious=0\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1\n    AND m.ndubious = 0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3109, "completion_tokens": 150, "total_tokens": 3259, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff54dbc8190b2ccc141a3d13ef6", "custom_id": "97-0", "response": {"status_code": 200, "request_id": "8ce6c41660bb6d6b3ed804bb25ef3fe9", "body": {"id": "chatcmpl-BfVrKIr2GVoLlxqlsygQ9hCSLl186", "object": "chat.completion", "created": 1749233614, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 50 objects with specified classification probabilities\nSELECT \n    o.oid AS ztf_id,\n    p_stamp.probability AS prob_stamp_agn,\n    p_lc.probability AS prob_lc_lpv\nFROM \n    object o\n-- Subquery to get the most probable AGN classification from stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        p.oid,\n        p.probability\n    FROM \n        probability p\n    WHERE \n        p.class_name = 'AGN'\n        AND p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.ranking = 1\n        AND p.probability > 0.6\n) p_stamp ON o.oid = p_stamp.oid\n-- Subquery to get the most probable LPV classification from lc_classifier\nJOIN (\n    SELECT \n        p.oid,\n        p.probability\n    FROM \n        probability p\n    WHERE \n        p.class_name = 'LPV'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n) p_lc ON o.oid = p_lc.oid\n-- Limit the result to 50 objects\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2606, "completion_tokens": 275, "total_tokens": 2881, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_68432ff55a3c81908d145d9c5925d2dc", "custom_id": "97-1", "response": {"status_code": 200, "request_id": "ea5e2dc5bfd90cc1bc5423203b9f0e96", "body": {"id": "chatcmpl-BfVrK9j2dkj1IrdbVk72qn8rUbiso", "object": "chat.completion", "created": 1749233614, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 50 objects with specified classification probabilities\nSELECT \n    o.oid AS ztf_id,\n    p_stamp.probability AS prob_stamp_agn,\n    p_lc.probability AS prob_lc_lpv\nFROM \n    object o\n-- Subquery to get the most probable AGN classification from stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        p1.oid,\n        p1.probability\n    FROM \n        probability p1\n    WHERE \n        p1.class_name = 'AGN'\n        AND p1.classifier_name = 'stamp_classifier'\n        AND p1.classifier_version = 'stamp_classifier_1.0.4'\n        AND p1.ranking = 1\n) p_stamp ON o.oid = p_stamp.oid\n-- Subquery to get the most probable LPV classification from lc_classifier\nJOIN (\n    SELECT \n        p2.oid,\n        p2.probability\n    FROM \n        probability p2\n    WHERE \n        p2.class_name = 'LPV'\n        AND p2.classifier_name = 'lc_classifier'\n        AND p2.ranking = 1\n) p_lc ON o.oid = p_lc.oid\nWHERE \n    p_stamp.probability > 0.6\n    AND p_lc.probability > 0.7\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2606, "completion_tokens": 294, "total_tokens": 2900, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
