{"id": "batch_req_6843374e6b6c8190b2fd40ee405b0152", "custom_id": "91-0", "response": {"status_code": 200, "request_id": "4189d1884e045d5c56d78a41c8f17d6f", "body": {"id": "chatcmpl-BfWM8AsI7CWuD9LaFHmVP6VjikntT", "object": "chat.completion", "created": 1749235524, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select ZTF objects with 'W1-W2' color lower than 1, including specified columns\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.value - f_r.value) AS mag_diff_g_r,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_max feature (g-band: fid=13, r-band: fid=12)\nJOIN \n    feature f_g ON o.oid = f_g.oid AND f_g.name = 'g-r_max' AND f_g.fid = 13\nJOIN \n    feature f_r ON o.oid = f_r.oid AND f_r.name = 'r-W2' AND f_r.fid = 12\n-- Join with feature table to get 'W1-W2' feature (fid=1)\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2' AND f_w1_w2.fid = 1\n-- Add condition to filter objects with 'W1-W2' color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit results to 100 rows for performance\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3947, "completion_tokens": 300, "total_tokens": 4247, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_6843374e77948190bc5cc749cabbe0b6", "custom_id": "91-1", "response": {"status_code": 200, "request_id": "c329c21c5d763c222526c76ae234793f", "body": {"id": "chatcmpl-BfWMDlZgezk17I3MSzRJ6lY50coD6", "object": "chat.completion", "created": 1749235529, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select ZTF objects with 'W1-W2' color lower than 1, including specified columns\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.value - f_r.value) AS mag_diff_g_r,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table for g-band feature (g-r_max, fid=1)\nJOIN \n    feature f_g ON o.oid = f_g.oid \n        AND f_g.name = 'g-r_max' \n        AND f_g.fid = 1\n-- Join with feature table for r-band feature (g-r_max, fid=2)\nJOIN \n    feature f_r ON o.oid = f_r.oid \n        AND f_r.name = 'g-r_max' \n        AND f_r.fid = 2\n-- Join with feature table for W1-W2 feature (name='W1-W2', fid=1)\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid \n        AND f_w1_w2.name = 'W1-W2' \n        AND f_w1_w2.fid = 1\n-- Filter for objects where W1-W2 color is less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4151, "completion_tokens": 320, "total_tokens": 4471, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_6843374e829481908a03602228624e53", "custom_id": "0-0", "response": {"status_code": 200, "request_id": "e3fb1cb386e0157ec38fa6d68fb56c5c", "body": {"id": "chatcmpl-BfWMAzMztGww0ot3BXy3XncAI4ABQ", "object": "chat.completion", "created": 1749235526, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity with specified criteria\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.ranking,\n        f.name AS feature_name,\n        f.value,\n        f.fid AS filter_id,\n        f.version AS feature_version\n    FROM\n        probability p\n    JOIN\n        feature f ON p.oid = f.oid\n    WHERE\n        p.class_name = 'YSO'\n        AND p.probability > 0.7\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n        AND p.ranking = 1\n        -- Filter for the period feature\n        AND f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n        -- Ensure the object has a significant amplitude indicating variability\n        AND EXISTS (\n            SELECT 1\n            FROM feature f2\n            WHERE\n                f2.oid = p.oid\n                AND f2.name = 'Amplitude'\n                AND f2.value > 0.5\n        )\n        -- Additional condition: check for the presence of a periodicity feature with high significance\n        AND EXISTS (\n            SELECT 1\n            FROM feature f3\n            WHERE\n                f3.oid = p.oid\n                AND f3.name = 'Multiband_period'\n                AND f3.value IS NOT NULL\n        )\n)\nSELECT\n    oid,\n    possibility,\n    class_name,\n    feature_name,\n    value,\n    filter_id,\n    feature_version\nFROM\n    yso_prob\nORDER BY\n    possibility DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4117, "completion_tokens": 370, "total_tokens": 4487, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_6843374e8c1c81909dba2f6347bf86d1", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "85764e74dd7d8892c70777e32b98bda0", "body": {"id": "chatcmpl-BfWMDJasBGKzD7qXgKYKGn41GXm02", "object": "chat.completion", "created": 1749235529, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Optimized query to retrieve objects likely to be YSOs with periodicity and amplitude criteria, using nested subqueries to improve performance\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        f.name AS feature_name,\n        f.value AS feature_value,\n        f.fid AS filter_id,\n        f.version AS feature_version\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'YSO'\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n        AND p.ranking = 1\n        AND EXISTS (\n            SELECT 1\n            FROM feature f\n            WHERE\n                f.oid = p.oid\n                AND f.name = 'Period_band'\n                AND f.value BETWEEN 3 AND 10\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM feature f2\n            WHERE\n                f2.oid = p.oid\n                AND f2.name = 'Amplitude'\n                AND f2.value > 0.5\n        )\n)\nSELECT\n    oid,\n    possibility,\n    class_name,\n    feature_name,\n    feature_value,\n    filter_id,\n    feature_version\nFROM\n    yso_prob\nORDER BY\n    possibility DESC;\n", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4122, "completion_tokens": 302, "total_tokens": 4424, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_6843374e97c08190bee1f5d808bd1dfe", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "555deb0e96e9c68e0f9669f78225025c", "body": {"id": "chatcmpl-BfWMFgsYrvxk4kqZFHWt1KbyVQnUc", "object": "chat.completion", "created": 1749235531, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant information for objects classified as SN II with specified conditions\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 2458600 AND 2459580 -- roughly 2019-2022\n),\nsn_ii_candidates AS (\n    SELECT d.candid, d.oid, d.mjd, d.ra, d.dec, d.magpsf, d.sigmapsf, d.fid\n    FROM detection d\n    JOIN sn_ii_objects s ON d.oid = s.oid\n    WHERE d.mjd BETWEEN 2458600 AND 2459580\n),\nmag_stats AS (\n    SELECT ms.oid, ms.fid, ms.magmax, ms.magmax_corr, ms.dm_first, ms.dmdt_first\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM sn_ii_objects)\n),\nrise_rates AS (\n    SELECT\n        s.oid,\n        -- Calculate initial rise rate as mag change over time in days for g and r bands\n        CASE WHEN COUNT(*) > 1 THEN\n            (MAX(ms.magmax) - MIN(ms.magmax)) / NULLIF(MAX(d.mjd) - MIN(d.mjd), 0)\n        ELSE NULL END AS initial_rise_rate\n    FROM sn_ii_candidates d\n    JOIN magstat ms ON d.oid = ms.oid AND ms.fid IN (1, 2) -- g and r bands\n    JOIN sn_ii_objects s ON d.oid = s.oid\n    GROUP BY s.oid\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS ndet\n    FROM detection\n    GROUP BY oid\n)\nSELECT\n    o.oid,\n    c.candid,\n    m.magmax,\n    m.sigmapsf,\n    m.dm_first,\n    c.fid\nFROM sn_ii_objects o\nJOIN sn_ii_candidates c ON o.oid = c.oid\nJOIN magstat m ON o.oid = m.oid AND m.fid = c.fid\nJOIN rise_rates r ON o.oid = r.oid\nJOIN detection_counts d ON o.oid = d.oid\nWHERE\n    r.initial_rise_rate > 0.5\n    AND d.ndet > 50\n    AND c.mjd BETWEEN 2458600 AND 2459580;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3363, "completion_tokens": 559, "total_tokens": 3922, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_6843374ea3f881908a66d15dbfc83be9", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "97f73fc0b5a010d93564a6e535669e7f", "body": {"id": "chatcmpl-BfWM95uQajqVN6lyB9IrUtISiYL88", "object": "chat.completion", "created": 1749235525, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant information for objects classified as SN II with specified conditions\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII' -- Corrected class_name to 'SNII' for Type II supernovae\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58849 AND 59923 -- Corresponds to 2019-01-01 to 2022-12-31 in MJD\n      AND o.ndet > 50\n),\nrise_rates AS (\n    SELECT\n        m.oid,\n        -- Calculate initial rise rate as change in magnitude over time between first and last detection in the band\n        (m.magfirst - m.maglast) / NULLIF((m.lastmjd - m.firstmjd), 0) AS rise_rate\n    FROM magstat m\n    WHERE m.ndet >= 2\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    -- Estimate initial rise as the difference between first and last magnitude divided by time\n    (m.magfirst - m.maglast) / NULLIF((m.lastmjd - m.firstmjd), 0) AS initial_rise,\n    d.fid\nFROM detection d\nJOIN sn_ii_objects s ON d.oid = s.oid\nJOIN magstat m ON d.oid = m.oid AND m.fid = d.fid\nWHERE\n    -- Filter for g-band (fid=1) and r-band (fid=2)\n    d.fid IN (1, 2)\n    AND d.mjd BETWEEN 58849 AND 59923 -- Corresponds to 2019-01-01 to 2022-12-31 in MJD\n    AND m.ndet > 0\n    AND (\n        -- For g-band\n        (d.fid = 1 AND \n         (SELECT (magfirst - maglast) / NULLIF((lastmjd - firstmjd), 0)\n          FROM magstat\n          WHERE oid = d.oid AND fid = 1) > 0.5)\n        OR\n        -- For r-band\n        (d.fid = 2 AND \n         (SELECT (magfirst - maglast) / NULLIF((lastmjd - firstmjd), 0)\n          FROM magstat\n          WHERE oid = d.oid AND fid = 2) > 0.5)\n    )\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3292, "completion_tokens": 574, "total_tokens": 3866, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
