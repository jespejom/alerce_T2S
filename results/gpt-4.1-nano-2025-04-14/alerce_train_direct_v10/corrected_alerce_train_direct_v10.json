{
    "13": {
        "0": {
            "req_id": "13",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 780,
                "out_toks": 14,
                "id": "chatcmpl-BgxtHGjZx69n48yGwtDqvIN6SPMGs",
                "created": 1749579695,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS\n  (SELECT 59914.0 AS start_mjd, -- December 1, 2022\n 60217.0 AS end_mjd -- September 1, 2023\n) -- Select objects classified as Supernovae (SNe) with first detection within the specified date range\n\nSELECT p.class_name AS probability_class,\n       o.lastmjd,\n       o.firstmjd,\n       o.oid\nFROM OBJECT o\nJOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'SN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1 -- most probable class\n\n  AND o.firstmjd BETWEEN\n    (SELECT start_mjd\n     FROM date_range) AND\n    (SELECT end_mjd\n     FROM date_range);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS\n  (SELECT 59914.0 AS start_mjd, -- December 1, 2022\n 60217.0 AS end_mjd -- September 1, 2023\n) -- Select objects classified as Supernovae (SNe) with first detection within the specified date range\n\nSELECT p.class_name AS probability_class,\n       o.lastmjd,\n       o.firstmjd,\n       o.oid\nFROM OBJECT o\nJOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'SN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1 -- most probable class\n\n  AND o.firstmjd BETWEEN\n    (SELECT start_mjd\n     FROM date_range) AND\n    (SELECT end_mjd\n     FROM date_range);"
                },
                "in_toks": 2592,
                "out_toks": 206,
                "id": "chatcmpl-Bgxu4KoelKs83bu51r2vHfLMDhPad",
                "created": 1749579744,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "13",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 780,
                "out_toks": 14,
                "id": "chatcmpl-BgxtHGjZx69n48yGwtDqvIN6SPMGs",
                "created": 1749579695,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS\n  (SELECT 59914.0 AS start_mjd,\n          60217.0 AS end_mjd), -- Select objects first detected within the specified date range\nsne_objects AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN\n       (SELECT start_mjd\n        FROM date_range) AND\n       (SELECT end_mjd\n        FROM date_range) ), -- Retrieve the most probable class (ranking=1) for each object, focusing on SNe\nsne_probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability\n   FROM probability p\n   WHERE p.class_name LIKE 'SN%' -- Assuming all SNe classes start with 'SN'\n\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1 ), -- Join objects with their probabilities, filtering for objects classified as SNe\nsne_objects_with_prob AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.lastmjd,\n          p.class_name,\n          p.probability\n   FROM sne_objects o\n   JOIN sne_probabilities p ON o.oid = p.oid), -- Filter for objects with high probability of being SNe (e.g., probability > 0.5)\nfiltered_sne AS\n  (SELECT oid,\n          class_name,\n          firstmjd,\n          lastmjd\n   FROM sne_objects_with_prob\n   WHERE probability > 0.5 ) -- Final selection: return class, first and last detection dates, and object IDs\n\nSELECT class_name,\n       lastmjd,\n       firstmjd,\n       oid\nFROM filtered_sne;",
            "sql_response": {
                "responses": {
                    "0": "-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS\n  (SELECT 59914.0 AS start_mjd,\n          60217.0 AS end_mjd), -- Select objects first detected within the specified date range\nsne_objects AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN\n       (SELECT start_mjd\n        FROM date_range) AND\n       (SELECT end_mjd\n        FROM date_range) ), -- Retrieve the most probable class (ranking=1) for each object, focusing on SNe\nsne_probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability\n   FROM probability p\n   WHERE p.class_name LIKE 'SN%' -- Assuming all SNe classes start with 'SN'\n\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1 ), -- Join objects with their probabilities, filtering for objects classified as SNe\nsne_objects_with_prob AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.lastmjd,\n          p.class_name,\n          p.probability\n   FROM sne_objects o\n   JOIN sne_probabilities p ON o.oid = p.oid), -- Filter for objects with high probability of being SNe (e.g., probability > 0.5)\nfiltered_sne AS\n  (SELECT oid,\n          class_name,\n          firstmjd,\n          lastmjd\n   FROM sne_objects_with_prob\n   WHERE probability > 0.5 ) -- Final selection: return class, first and last detection dates, and object IDs\n\nSELECT class_name,\n       lastmjd,\n       firstmjd,\n       oid\nFROM filtered_sne;"
                },
                "in_toks": 1716,
                "out_toks": 387,
                "id": "chatcmpl-BgyPfJaAnOHyw2xa8eRGlDSveMdzZ",
                "created": 1749581703,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS\n  (SELECT 59914.0 AS start_mjd,\n          60217.0 AS end_mjd), -- Select objects classified as Supernovae (SNe) with first detection within the specified date range\nsne_objects AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN\n       (SELECT start_mjd\n        FROM date_range) AND\n       (SELECT end_mjd\n        FROM date_range) ), -- Retrieve the most probable class (ranking=1) for each object, focusing on SNe\nsne_probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability\n   FROM probability p\n   WHERE p.class_name LIKE 'SN%' -- Assuming all SNe classes start with 'SN'\n\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1 ), -- Join objects with their probabilities\nRESULT AS\n  (SELECT sp.class_name,\n          o.firstmjd,\n          o.lastmjd,\n          o.oid\n   FROM sne_objects o\n   JOIN sne_probabilities sp ON o.oid = sp.oid)\nSELECT class_name,\n       lastmjd,\n       firstmjd,\n       oid\nFROM RESULT;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS\n  (SELECT 59914.0 AS start_mjd,\n          60217.0 AS end_mjd), -- Select objects classified as Supernovae (SNe) with first detection within the specified date range\nsne_objects AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.lastmjd\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN\n       (SELECT start_mjd\n        FROM date_range) AND\n       (SELECT end_mjd\n        FROM date_range) ), -- Retrieve the most probable class (ranking=1) for each object, focusing on SNe\nsne_probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability\n   FROM probability p\n   WHERE p.class_name LIKE 'SN%' -- Assuming all SNe classes start with 'SN'\n\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1 ), -- Join objects with their probabilities\nRESULT AS\n  (SELECT sp.class_name,\n          o.firstmjd,\n          o.lastmjd,\n          o.oid\n   FROM sne_objects o\n   JOIN sne_probabilities sp ON o.oid = sp.oid)\nSELECT class_name,\n       lastmjd,\n       firstmjd,\n       oid\nFROM RESULT;"
                },
                "in_toks": 2592,
                "out_toks": 292,
                "id": "chatcmpl-Bgxu7cXYcjFa2WXVdPAM7d6jDFYlY",
                "created": 1749579747,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "10": {
        "0": {
            "req_id": "10",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 816,
                "out_toks": 14,
                "id": "chatcmpl-BgxtIVCC5ash1WcsLfm2Lc0fzrZU6",
                "created": 1749579696,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn_candidates AS\n  (SELECT p1.oid,\n          p1.probability AS SN_prob\n   FROM probability p1\n   WHERE p1.class_name = 'SNIa'\n     AND p1.ranking = 1\n     AND p1.classifier_name = 'lc_classifier' ),\n     cv_candidates AS\n  (SELECT p2.oid,\n          p2.probability AS CV_prob\n   FROM probability p2\n   WHERE p2.class_name = 'CV/Nova'\n     AND p2.ranking = 2\n     AND p2.classifier_name = 'lc_classifier' ),\n     matched_objects AS\n  (SELECT sn.oid,\n          sn.SN_prob,\n          cv.CV_prob\n   FROM sn_candidates sn\n   JOIN cv_candidates cv ON sn.oid = cv.oid),\n     filtered_objects AS\n  (SELECT oid,\n          SN_prob,\n          CV_prob\n   FROM matched_objects\n   WHERE ABS(SN_prob - CV_prob) < 0.1 )\nSELECT oid,\n       SN_prob AS \"SN_prob\",\n       CV_prob AS \"CV_prob\"\nFROM filtered_objects;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn_candidates AS\n  (SELECT p1.oid,\n          p1.probability AS SN_prob\n   FROM probability p1\n   WHERE p1.class_name = 'SNIa'\n     AND p1.ranking = 1\n     AND p1.classifier_name = 'lc_classifier' ),\n     cv_candidates AS\n  (SELECT p2.oid,\n          p2.probability AS CV_prob\n   FROM probability p2\n   WHERE p2.class_name = 'CV/Nova'\n     AND p2.ranking = 2\n     AND p2.classifier_name = 'lc_classifier' ),\n     matched_objects AS\n  (SELECT sn.oid,\n          sn.SN_prob,\n          cv.CV_prob\n   FROM sn_candidates sn\n   JOIN cv_candidates cv ON sn.oid = cv.oid),\n     filtered_objects AS\n  (SELECT oid,\n          SN_prob,\n          CV_prob\n   FROM matched_objects\n   WHERE ABS(SN_prob - CV_prob) < 0.1 )\nSELECT oid,\n       SN_prob AS \"SN_prob\",\n       CV_prob AS \"CV_prob\"\nFROM filtered_objects;"
                },
                "in_toks": 2582,
                "out_toks": 225,
                "id": "chatcmpl-BgxuEpSwIRAG7tXNfW8glUmsaMaJ5",
                "created": 1749579754,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "10",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 816,
                "out_toks": 14,
                "id": "chatcmpl-BgxtIVCC5ash1WcsLfm2Lc0fzrZU6",
                "created": 1749579696,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve object IDs and probabilities for objects classified as SNIa with ranking=1 and CV/Nova with ranking=2\nWITH sn_candidates AS\n  (SELECT p.oid,\n          p.probability AS SN_prob\n   FROM probability p\n   WHERE p.class_name = 'SNIa'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1 ),\n     cv_candidates AS\n  (SELECT p.oid,\n          p.probability AS CV_prob\n   FROM probability p\n   WHERE p.class_name = 'CV/Nova'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 2 ),\n     joined_probs AS\n  (SELECT sn.oid,\n          sn.SN_prob,\n          cv.CV_prob,\n          ABS(sn.SN_prob - cv.CV_prob) AS prob_diff\n   FROM sn_candidates sn\n   JOIN cv_candidates cv ON sn.oid = cv.oid)\nSELECT oid,\n       SN_prob,\n       CV_prob\nFROM joined_probs\nWHERE prob_diff < 0.1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve object IDs and probabilities for objects classified as SNIa with ranking=1 and CV/Nova with ranking=2\nWITH sn_candidates AS\n  (SELECT p.oid,\n          p.probability AS SN_prob\n   FROM probability p\n   WHERE p.class_name = 'SNIa'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 1 ),\n     cv_candidates AS\n  (SELECT p.oid,\n          p.probability AS CV_prob\n   FROM probability p\n   WHERE p.class_name = 'CV/Nova'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.ranking = 2 ),\n     joined_probs AS\n  (SELECT sn.oid,\n          sn.SN_prob,\n          cv.CV_prob,\n          ABS(sn.SN_prob - cv.CV_prob) AS prob_diff\n   FROM sn_candidates sn\n   JOIN cv_candidates cv ON sn.oid = cv.oid)\nSELECT oid,\n       SN_prob,\n       CV_prob\nFROM joined_probs\nWHERE prob_diff < 0.1;"
                },
                "in_toks": 2582,
                "out_toks": 228,
                "id": "chatcmpl-BgxuH64u0DSwZlJFJ1SpocO0kcOF8",
                "created": 1749579757,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "15": {
        "0": {
            "req_id": "15",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 831,
                "out_toks": 30,
                "id": "chatcmpl-BgxtICCHIpI2TEq1HNokIpgTGGprI",
                "created": 1749579696,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "WITH first_detections AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          p.class_name,\n          p.probability,\n          p.ranking,\n          d.candid,\n          d.fid AS detection_fid,\n          d.mjd,\n          d.magpsf,\n          m.magfirst,\n          m.maglast,\n          m.dmdt_first\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   JOIN detection d ON o.oid = d.oid\n   JOIN magstat m ON o.oid = m.oid\n   AND m.fid = d.fid\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 60188.0 AND 60189.0\n     AND d.mjd = o.firstmjd ),\n     max_prob AS\n  (SELECT p.oid,\n          MAX(p.probability) AS max_probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n   GROUP BY p.oid),\n     candidate_objects AS\n  (SELECT fd.oid,\n          fd.candid,\n          fd.detection_fid,\n          fd.mjd,\n          fd.magfirst,\n          fd.maglast,\n          fd.dmdt_first,\n          mp.max_probability\n   FROM first_detections fd\n   JOIN max_prob mp ON fd.oid = mp.oid\n   WHERE mp.max_probability =\n       (SELECT MAX(p2.probability)\n        FROM probability p2\n        WHERE p2.oid = fd.oid\n          AND p2.classifier_name = 'stamp_classifier' ) ),\n     fast_risers AS\n  (SELECT co.oid,\n          co.candid,\n          co.detection_fid,\n          co.mjd,\n          co.magfirst,\n          co.maglast,\n          co.dmdt_first,\n          p.probability AS stamp_prob,\n          lc_prob.probability AS lc_probability,\n          co.dmdt_first AS initial_rise\n   FROM candidate_objects co\n   JOIN probability p ON co.oid = p.oid\n   AND p.class_name = 'SN'\n   AND p.classifier_name = 'stamp_classifier'\n   AND p.ranking = 1\n   LEFT JOIN probability lc_prob ON co.oid = lc_prob.oid\n   AND lc_prob.class_name = 'SN'\n   AND lc_prob.classifier_name = 'lc_classifier_top'\n   AND lc_prob.ranking = 1\n   WHERE co.dmdt_first >= 0.25 )\nSELECT fr.oid,\n       fr.stamp_prob,\n       fr.initial_rise,\n       fr.detection_fid,\n       fr.candid,\n       m.fid AS magstat_fid\nFROM fast_risers fr\nJOIN magstat m ON fr.oid = m.oid\nAND m.fid = fr.detection_fid\nORDER BY fr.oid;",
            "sql_response": {
                "responses": {
                    "0": "WITH first_detections AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          p.class_name,\n          p.probability,\n          p.ranking,\n          d.candid,\n          d.fid AS detection_fid,\n          d.mjd,\n          d.magpsf,\n          m.magfirst,\n          m.maglast,\n          m.dmdt_first\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   JOIN detection d ON o.oid = d.oid\n   JOIN magstat m ON o.oid = m.oid\n   AND m.fid = d.fid\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 60188.0 AND 60189.0\n     AND d.mjd = o.firstmjd ),\n     max_prob AS\n  (SELECT p.oid,\n          MAX(p.probability) AS max_probability\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n   GROUP BY p.oid),\n     candidate_objects AS\n  (SELECT fd.oid,\n          fd.candid,\n          fd.detection_fid,\n          fd.mjd,\n          fd.magfirst,\n          fd.maglast,\n          fd.dmdt_first,\n          mp.max_probability\n   FROM first_detections fd\n   JOIN max_prob mp ON fd.oid = mp.oid\n   WHERE mp.max_probability =\n       (SELECT MAX(p2.probability)\n        FROM probability p2\n        WHERE p2.oid = fd.oid\n          AND p2.classifier_name = 'stamp_classifier' ) ),\n     fast_risers AS\n  (SELECT co.oid,\n          co.candid,\n          co.detection_fid,\n          co.mjd,\n          co.magfirst,\n          co.maglast,\n          co.dmdt_first,\n          p.probability AS stamp_prob,\n          lc_prob.probability AS lc_probability,\n          co.dmdt_first AS initial_rise\n   FROM candidate_objects co\n   JOIN probability p ON co.oid = p.oid\n   AND p.class_name = 'SN'\n   AND p.classifier_name = 'stamp_classifier'\n   AND p.ranking = 1\n   LEFT JOIN probability lc_prob ON co.oid = lc_prob.oid\n   AND lc_prob.class_name = 'SN'\n   AND lc_prob.classifier_name = 'lc_classifier_top'\n   AND lc_prob.ranking = 1\n   WHERE co.dmdt_first >= 0.25 )\nSELECT fr.oid,\n       fr.stamp_prob,\n       fr.initial_rise,\n       fr.detection_fid,\n       fr.candid,\n       m.fid AS magstat_fid\nFROM fast_risers fr\nJOIN magstat m ON fr.oid = m.oid\nAND m.fid = fr.detection_fid\nORDER BY fr.oid;"
                },
                "in_toks": 3485,
                "out_toks": 635,
                "id": "chatcmpl-BgyPjGx8vE5iHBpDdUUqpjoNq1BEj",
                "created": 1749581707,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH first_detections AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          p.class_name,\n          p.probability,\n          p.ranking,\n          d.candid,\n          d.fid AS detection_fid,\n          d.mjd,\n          d.magpsf,\n          m.magfirst,\n          m.maglast,\n          m.dmdt_first\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   JOIN detection d ON o.oid = d.oid\n   JOIN magstat m ON o.oid = m.oid\n   AND m.fid = d.fid\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 60188.0 AND 60189.0\n     AND d.mjd = o.firstmjd ),\n     max_prob AS\n  (SELECT oid,\n          MAX(probability) AS max_probability\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n   GROUP BY oid),\n     candidate_objects AS\n  (SELECT fd.oid,\n          fd.candid,\n          fd.detection_fid,\n          fd.mjd,\n          fd.magfirst,\n          fd.maglast,\n          fd.dmdt_first,\n          mp.max_probability\n   FROM first_detections fd\n   JOIN max_prob mp ON fd.oid = mp.oid\n   WHERE mp.max_probability =\n       (SELECT MAX(probability)\n        FROM probability p2\n        WHERE p2.oid = fd.oid\n          AND p2.classifier_name = 'stamp_classifier' ) ),\n     fast_risers AS\n  (SELECT co.oid,\n          co.candid,\n          co.detection_fid,\n          co.mjd,\n          co.magfirst,\n          co.maglast,\n          co.dmdt_first,\n          p.probability AS stamp_prob,\n          lc_prob.probability AS lc_probability,\n          co.dmdt_first AS initial_rise\n   FROM candidate_objects co\n   JOIN probability p ON co.oid = p.oid\n   AND p.class_name = 'SN'\n   AND p.classifier_name = 'stamp_classifier'\n   AND p.ranking = 1\n   LEFT JOIN probability lc_prob ON co.oid = lc_prob.oid\n   AND lc_prob.class_name = 'SN'\n   AND lc_prob.classifier_name = 'lc_classifier_top'\n   AND lc_prob.ranking = 1\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND co.dmdt_first >= 0.25 )\nSELECT oid,\n       stamp_prob,\n       initial_rise,\n       detection_fid,\n       candid,\n       magstat_fid\nFROM fast_risers\nJOIN magstat m ON fast_risers.oid = m.oid\nAND m.fid = fast_risers.detection_fid\nORDER BY oid;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH first_detections AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          p.class_name,\n          p.probability,\n          p.ranking,\n          d.candid,\n          d.fid AS detection_fid,\n          d.mjd,\n          d.magpsf,\n          m.magfirst,\n          m.maglast,\n          m.dmdt_first\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   JOIN detection d ON o.oid = d.oid\n   JOIN magstat m ON o.oid = m.oid\n   AND m.fid = d.fid\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 60188.0 AND 60189.0\n     AND d.mjd = o.firstmjd ),\n     max_prob AS\n  (SELECT oid,\n          MAX(probability) AS max_probability\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n   GROUP BY oid),\n     candidate_objects AS\n  (SELECT fd.oid,\n          fd.candid,\n          fd.detection_fid,\n          fd.mjd,\n          fd.magfirst,\n          fd.maglast,\n          fd.dmdt_first,\n          mp.max_probability\n   FROM first_detections fd\n   JOIN max_prob mp ON fd.oid = mp.oid\n   WHERE mp.max_probability =\n       (SELECT MAX(probability)\n        FROM probability p2\n        WHERE p2.oid = fd.oid\n          AND p2.classifier_name = 'stamp_classifier' ) ),\n     fast_risers AS\n  (SELECT co.oid,\n          co.candid,\n          co.detection_fid,\n          co.mjd,\n          co.magfirst,\n          co.maglast,\n          co.dmdt_first,\n          p.probability AS stamp_prob,\n          lc_prob.probability AS lc_probability,\n          co.dmdt_first AS initial_rise\n   FROM candidate_objects co\n   JOIN probability p ON co.oid = p.oid\n   AND p.class_name = 'SN'\n   AND p.classifier_name = 'stamp_classifier'\n   AND p.ranking = 1\n   LEFT JOIN probability lc_prob ON co.oid = lc_prob.oid\n   AND lc_prob.class_name = 'SN'\n   AND lc_prob.classifier_name = 'lc_classifier_top'\n   AND lc_prob.ranking = 1\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND co.dmdt_first >= 0.25 )\nSELECT oid,\n       stamp_prob,\n       initial_rise,\n       detection_fid,\n       candid,\n       magstat_fid\nFROM fast_risers\nJOIN magstat m ON fast_risers.oid = m.oid\nAND m.fid = fast_risers.detection_fid\nORDER BY oid;"
                },
                "in_toks": 3941,
                "out_toks": 670,
                "id": "chatcmpl-BgxuKloQQGgA1sddBRDiVuyQrQ65k",
                "created": 1749579760,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "15",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 831,
                "out_toks": 30,
                "id": "chatcmpl-BgxtICCHIpI2TEq1HNokIpgTGGprI",
                "created": 1749579696,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select object identifiers, probabilities for class 'SN' in stamp classifier, and detection details\nWITH first_detections AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          p.probability AS sn_probability,\n          p.ranking,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 60188.0 AND 60189.0 ),\n     max_prob AS\n  (SELECT oid,\n          MAX(probability) AS max_probability\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n   GROUP BY oid),\n     fast_risers AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          p.probability AS sn_probability,\n          p.ranking,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version, -- Calculate initial rise estimate\n (m.magfirst - m.maglast) / NULLIF((o.firstmjd - m.firstmjd), 0.0) AS initial_rise\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   JOIN magstat m ON o.oid = m.oid\n   AND m.fid = 2 -- assuming filter 2 (r-band) for initial rise\n\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 60188.0 AND 60189.0\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = o.oid\n          AND d.mjd = o.firstmjd )\n     AND (m.magfirst - m.maglast) >= 0.25 * (o.firstmjd - (o.mjdendhist - o.mjdstarthist)) )\nSELECT fr.oid,\n       fr.sn_probability,\n       d.candid,\n       d.fid AS detection_fid,\n       m.fid AS magstat_fid,\n       fr.initial_rise\nFROM fast_risers fr\nJOIN detection d ON fr.oid = d.oid\nAND d.mjd = fr.firstmjd\nJOIN magstat m ON fr.oid = m.oid\nAND m.fid = 2 -- assuming filter 2 (r-band) for magstat\nORDER BY fr.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select object identifiers, probabilities for class 'SN' in stamp classifier, and detection details\nWITH first_detections AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          p.probability AS sn_probability,\n          p.ranking,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 60188.0 AND 60189.0 ),\n     max_prob AS\n  (SELECT oid,\n          MAX(probability) AS max_probability\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n   GROUP BY oid),\n     fast_risers AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.ndet,\n          o.meanra,\n          o.meandec,\n          p.probability AS sn_probability,\n          p.ranking,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version, -- Calculate initial rise estimate\n (m.magfirst - m.maglast) / NULLIF((o.firstmjd - m.firstmjd), 0.0) AS initial_rise\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   JOIN magstat m ON o.oid = m.oid\n   AND m.fid = 2 -- assuming filter 2 (r-band) for initial rise\n\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 60188.0 AND 60189.0\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = o.oid\n          AND d.mjd = o.firstmjd )\n     AND (m.magfirst - m.maglast) >= 0.25 * (o.firstmjd - (o.mjdendhist - o.mjdstarthist)) )\nSELECT fr.oid,\n       fr.sn_probability,\n       d.candid,\n       d.fid AS detection_fid,\n       m.fid AS magstat_fid,\n       fr.initial_rise\nFROM fast_risers fr\nJOIN detection d ON fr.oid = d.oid\nAND d.mjd = fr.firstmjd\nJOIN magstat m ON fr.oid = m.oid\nAND m.fid = 2 -- assuming filter 2 (r-band) for magstat\nORDER BY fr.oid;"
                },
                "in_toks": 3941,
                "out_toks": 609,
                "id": "chatcmpl-BgxuUEUcxPjTNgfdxqjbp1HoM9DsF",
                "created": 1749579770,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "4": {
        "0": {
            "req_id": "4",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 817,
                "out_toks": 30,
                "id": "chatcmpl-BgxtJCK9o86mW9yZHNPw3jLkzc5YJ",
                "created": 1749579697,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Select relevant information for objects classified as SN II with specified conditions\nWITH snii_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE -- Filter objects with at least 50 detections\n o.ndet > 50 -- Filter objects with last detection within 2019-2022 (approximate MJD range)\n\n     AND o.lastmjd BETWEEN 58500 AND 59900 -- Ensure the object has > 0.6 probability of being SN II in the specified classifier\n\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIi'\n          AND p.classifier_name = 'lc_classifier_stochastic'\n          AND p.probability > 0.6 ) ),\n     detections AS\n  (SELECT d.candid,\n          d.oid,\n          d.mjd,\n          d.fid,\n          d.magpsf,\n          d.sigmapsf,\n          d.ra,\n          d.dec\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     first_detections AS\n  (-- Get the first detection per object\n SELECT d.oid,\n        MIN(d.mjd) AS first_mjd, -- Use DISTINCT ON to get magpsf at first detection\n DISTINCT ON (d.oid) d.magpsf AS mag_at_first, -- Also get the first detection's magpsf\n\n     (SELECT magpsf\n      FROM detection d2\n      WHERE d2.oid = d.oid\n        AND d2.mjd = MIN(d.mjd)\n      LIMIT 1) AS mag_at_first\n   FROM detection d\n   GROUP BY d.oid)\nSELECT d.candid,\n       d.oid,\n       d.mjd,\n       d.fid AS band_id,\n       d.magpsf AS magnitude,\n       d.sigmapsf AS magnitude_error, -- Compute initial rise rate: (mag - mag at first detection) / (mjd - first_mjd)\n CASE\n     WHEN (d.mjd - fd.first_mjd) != 0 THEN (d.magpsf - fd.mag_at_first) / (d.mjd - fd.first_mjd)\n     ELSE NULL\n END AS initial_rise_rate\nFROM detections d\nJOIN first_detections fd ON d.oid = fd.oid\nAND d.mjd = fd.first_mjd\nWHERE d.fid IN (1,\n                2) -- Filter for g-band (1) and r-band (2)\n\n  AND -- Initial rise rate greater than 0.5 mag/day\n CASE\n     WHEN (d.mjd - fd.first_mjd) != 0 THEN (d.magpsf - fd.mag_at_first) / (d.mjd - fd.first_mjd)\n     ELSE NULL\n END > 0.5;",
            "sql_response": {
                "responses": {
                    "0": "-- Select relevant information for objects classified as SN II with specified conditions\nWITH snii_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE -- Filter objects with at least 50 detections\n o.ndet > 50 -- Filter objects with last detection within 2019-2022 (approximate MJD range)\n\n     AND o.lastmjd BETWEEN 58500 AND 59900 -- Ensure the object has > 0.6 probability of being SN II in the specified classifier\n\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIi'\n          AND p.classifier_name = 'lc_classifier_stochastic'\n          AND p.probability > 0.6 ) ),\n     detections AS\n  (SELECT d.candid,\n          d.oid,\n          d.mjd,\n          d.fid,\n          d.magpsf,\n          d.sigmapsf,\n          d.ra,\n          d.dec\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     first_detections AS\n  (-- Get the first detection per object\n SELECT d.oid,\n        MIN(d.mjd) AS first_mjd, -- Use DISTINCT ON to get magpsf at first detection\n DISTINCT ON (d.oid) d.magpsf AS mag_at_first, -- Also get the first detection's magpsf\n\n     (SELECT magpsf\n      FROM detection d2\n      WHERE d2.oid = d.oid\n        AND d2.mjd = MIN(d.mjd)\n      LIMIT 1) AS mag_at_first\n   FROM detection d\n   GROUP BY d.oid)\nSELECT d.candid,\n       d.oid,\n       d.mjd,\n       d.fid AS band_id,\n       d.magpsf AS magnitude,\n       d.sigmapsf AS magnitude_error, -- Compute initial rise rate: (mag - mag at first detection) / (mjd - first_mjd)\n CASE\n     WHEN (d.mjd - fd.first_mjd) != 0 THEN (d.magpsf - fd.mag_at_first) / (d.mjd - fd.first_mjd)\n     ELSE NULL\n END AS initial_rise_rate\nFROM detections d\nJOIN first_detections fd ON d.oid = fd.oid\nAND d.mjd = fd.first_mjd\nWHERE d.fid IN (1,\n                2) -- Filter for g-band (1) and r-band (2)\n\n  AND -- Initial rise rate greater than 0.5 mag/day\n CASE\n     WHEN (d.mjd - fd.first_mjd) != 0 THEN (d.magpsf - fd.mag_at_first) / (d.mjd - fd.first_mjd)\n     ELSE NULL\n END > 0.5;"
                },
                "in_toks": 3347,
                "out_toks": 617,
                "id": "chatcmpl-BgyPrf27uL6E2laUoKB3EdRkIqtD3",
                "created": 1749581715,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select relevant information for objects classified as SN II with specified conditions\nWITH snii_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE -- Filter objects with at least 50 detections\n o.ndet > 50 -- Filter objects with last detection within 2019-2022 (MJD range approximately 58500 to 59900)\n\n     AND o.lastmjd BETWEEN 58500 AND 59900 -- Ensure the object has a probability > 0.6 of being SN II in the 'lc_classifier_stochastic' classifier\n\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIi'\n          AND p.classifier_name = 'lc_classifier_stochastic'\n          AND p.probability > 0.6 ) ),\n     detections AS\n  (SELECT d.candid,\n          d.oid,\n          d.mjd,\n          d.fid,\n          d.magpsf,\n          d.sigmapsf,\n          d.ra,\n          d.dec\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM snii_objects) )\nSELECT d.candid,\n       d.oid,\n       d.mjd,\n       d.fid AS band_id,\n       d.magpsf AS magnitude,\n       d.sigmapsf AS magnitude_error, -- Estimate initial rise as the difference in magnitude over the time difference\n -- For simplicity, assume the earliest detection per object as the start point\n -- and compute the rate as (mag - mag at first detection) / (mjd - firstmjd)\n -- This requires a subquery to get the first detection per object\n (d.magpsf - first_d.magpsf) / NULLIF(d.mjd - first_d.mjd, 0) AS initial_rise_rate\nFROM detections d\nJOIN\n  (SELECT oid,\n          MIN(mjd) AS first_mjd,\n          FIRST_VALUE(magpsf) OVER (PARTITION BY oid\n                                    ORDER BY mjd) AS mag_at_first\n   FROM detection\n   GROUP BY oid) first_d ON d.oid = first_d.oid\nAND d.mjd = first_d.first_mjd\nWHERE -- Filter for band 1 (g-band) and band 2 (r-band)\n d.fid IN (1,\n           2) -- Initial rise rate greater than 0.5 mag/day\n\n  AND ((d.magpsf - first_d.magpsf) / NULLIF(d.mjd - first_d.first_mjd, 0)) > 0.5",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select relevant information for objects classified as SN II with specified conditions\nWITH snii_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE -- Filter objects with at least 50 detections\n o.ndet > 50 -- Filter objects with last detection within 2019-2022 (MJD range approximately 58500 to 59900)\n\n     AND o.lastmjd BETWEEN 58500 AND 59900 -- Ensure the object has a probability > 0.6 of being SN II in the 'lc_classifier_stochastic' classifier\n\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIi'\n          AND p.classifier_name = 'lc_classifier_stochastic'\n          AND p.probability > 0.6 ) ),\n     detections AS\n  (SELECT d.candid,\n          d.oid,\n          d.mjd,\n          d.fid,\n          d.magpsf,\n          d.sigmapsf,\n          d.ra,\n          d.dec\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM snii_objects) )\nSELECT d.candid,\n       d.oid,\n       d.mjd,\n       d.fid AS band_id,\n       d.magpsf AS magnitude,\n       d.sigmapsf AS magnitude_error, -- Estimate initial rise as the difference in magnitude over the time difference\n -- For simplicity, assume the earliest detection per object as the start point\n -- and compute the rate as (mag - mag at first detection) / (mjd - firstmjd)\n -- This requires a subquery to get the first detection per object\n (d.magpsf - first_d.magpsf) / NULLIF(d.mjd - first_d.mjd, 0) AS initial_rise_rate\nFROM detections d\nJOIN\n  (SELECT oid,\n          MIN(mjd) AS first_mjd,\n          FIRST_VALUE(magpsf) OVER (PARTITION BY oid\n                                    ORDER BY mjd) AS mag_at_first\n   FROM detection\n   GROUP BY oid) first_d ON d.oid = first_d.oid\nAND d.mjd = first_d.first_mjd\nWHERE -- Filter for band 1 (g-band) and band 2 (r-band)\n d.fid IN (1,\n           2) -- Initial rise rate greater than 0.5 mag/day\n\n  AND ((d.magpsf - first_d.magpsf) / NULLIF(d.mjd - first_d.first_mjd, 0)) > 0.5"
                },
                "in_toks": 3848,
                "out_toks": 557,
                "id": "chatcmpl-BgxucwUfYo2N9d6IHst6urJ96gX53",
                "created": 1749579778,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "4",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 817,
                "out_toks": 30,
                "id": "chatcmpl-BgxtJCK9o86mW9yZHNPw3jLkzc5YJ",
                "created": 1749579697,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with explicit table aliases and unambiguous column references\nWITH snii_objects AS\n  (SELECT o.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.ndet > 50\n     AND o.firstmjd BETWEEN 2458600 AND 2459580 -- roughly 2019-2022\n),\n     detections AS\n  (SELECT d.oid,\n          d.candid,\n          d.mjd,\n          d.fid,\n          d.magpsf,\n          d.sigmapsf\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     magstats AS\n  (SELECT m.oid,\n          m.fid,\n          m.magmean,\n          m.sigmadm_first,\n          m.firstmjd\n   FROM magstat m\n   WHERE m.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     rise_rates AS\n  (SELECT d1.oid,\n          (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS initial_rise_rate,\n          d1.mjd AS start_mjd,\n          d1.fid AS band\n   FROM detections d1\n   JOIN detections d2 ON d1.oid = d2.oid\n   AND d2.mjd > d1.mjd\n   WHERE d2.mjd - d1.mjd <= 10 -- limit to early rise phase\n),\n     filtered_rise AS\n  (SELECT oid,\n          start_mjd,\n          band,\n          initial_rise_rate\n   FROM rise_rates\n   WHERE initial_rise_rate > 0.5 ),\n     FINAL AS\n  (SELECT o.oid,\n          d.candid,\n          d.mjd,\n          d.magpsf,\n          d.sigmapsf,\n          m.magmean,\n          m.sigmadm_first,\n          m.firstmjd,\n          d.fid AS band\n   FROM snii_objects o\n   JOIN detections d ON o.oid = d.oid\n   JOIN magstats m ON o.oid = m.oid\n   AND m.fid = d.fid\n   JOIN filtered_rise f ON o.oid = f.oid\n   AND f.band = d.fid)\nSELECT oid,\n       candid,\n       magpsf,\n       sigmapsf,\n       firstmjd,\n       band\nFROM FINAL\nORDER BY firstmjd;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with explicit table aliases and unambiguous column references\nWITH snii_objects AS\n  (SELECT o.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.ndet > 50\n     AND o.firstmjd BETWEEN 2458600 AND 2459580 -- roughly 2019-2022\n),\n     detections AS\n  (SELECT d.oid,\n          d.candid,\n          d.mjd,\n          d.fid,\n          d.magpsf,\n          d.sigmapsf\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     magstats AS\n  (SELECT m.oid,\n          m.fid,\n          m.magmean,\n          m.sigmadm_first,\n          m.firstmjd\n   FROM magstat m\n   WHERE m.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     rise_rates AS\n  (SELECT d1.oid,\n          (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS initial_rise_rate,\n          d1.mjd AS start_mjd,\n          d1.fid AS band\n   FROM detections d1\n   JOIN detections d2 ON d1.oid = d2.oid\n   AND d2.mjd > d1.mjd\n   WHERE d2.mjd - d1.mjd <= 10 -- limit to early rise phase\n),\n     filtered_rise AS\n  (SELECT oid,\n          start_mjd,\n          band,\n          initial_rise_rate\n   FROM rise_rates\n   WHERE initial_rise_rate > 0.5 ),\n     FINAL AS\n  (SELECT o.oid,\n          d.candid,\n          d.mjd,\n          d.magpsf,\n          d.sigmapsf,\n          m.magmean,\n          m.sigmadm_first,\n          m.firstmjd,\n          d.fid AS band\n   FROM snii_objects o\n   JOIN detections d ON o.oid = d.oid\n   JOIN magstats m ON o.oid = m.oid\n   AND m.fid = d.fid\n   JOIN filtered_rise f ON o.oid = f.oid\n   AND f.band = d.fid)\nSELECT oid,\n       candid,\n       magpsf,\n       sigmapsf,\n       firstmjd,\n       band\nFROM FINAL\nORDER BY firstmjd;"
                },
                "in_toks": 3381,
                "out_toks": 567,
                "id": "chatcmpl-BgyPxh7vpmccuIqTmMN3M1fierWzh",
                "created": 1749581721,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select relevant information for objects classified as SN II with specified conditions\nWITH snii_objects AS\n  (SELECT o.oid,\n          p.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.ndet > 50\n     AND o.firstmjd BETWEEN 2458600 AND 2459580 -- Corresponds roughly to 2019-2022\n),\n     detections AS\n  (SELECT d.oid,\n          d.candid,\n          d.mjd,\n          d.fid,\n          d.magpsf,\n          d.sigmapsf\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     magstats AS\n  (SELECT m.oid,\n          m.fid,\n          m.magmean,\n          m.sigmadm_first,\n          m.firstmjd\n   FROM magstat m\n   WHERE m.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     rise_rates AS\n  (SELECT d1.oid,\n          (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS initial_rise_rate,\n          d1.mjd AS start_mjd,\n          d1.fid AS band\n   FROM detections d1\n   JOIN detections d2 ON d1.oid = d2.oid\n   AND d2.mjd > d1.mjd\n   WHERE d2.mjd - d1.mjd <= 10 -- Limit to early rise phase\n),\n     filtered_rise AS\n  (SELECT oid,\n          start_mjd,\n          band,\n          initial_rise_rate\n   FROM rise_rates\n   WHERE initial_rise_rate > 0.5 ),\n     FINAL AS\n  (SELECT o.oid,\n          d.candid,\n          d.mjd,\n          d.magpsf,\n          d.sigmapsf,\n          m.magmean,\n          m.sigmadm_first,\n          m.firstmjd,\n          f.band\n   FROM snii_objects o\n   JOIN detections d ON o.oid = d.oid\n   JOIN magstats m ON o.oid = m.oid\n   AND m.fid = d.fid\n   JOIN filtered_rise f ON o.oid = f.oid\n   AND f.band = d.fid)\nSELECT oid,\n       candid,\n       magpsf,\n       sigmapsf,\n       firstmjd,\n       band\nFROM FINAL\nORDER BY firstmjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select relevant information for objects classified as SN II with specified conditions\nWITH snii_objects AS\n  (SELECT o.oid,\n          p.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.ndet > 50\n     AND o.firstmjd BETWEEN 2458600 AND 2459580 -- Corresponds roughly to 2019-2022\n),\n     detections AS\n  (SELECT d.oid,\n          d.candid,\n          d.mjd,\n          d.fid,\n          d.magpsf,\n          d.sigmapsf\n   FROM detection d\n   WHERE d.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     magstats AS\n  (SELECT m.oid,\n          m.fid,\n          m.magmean,\n          m.sigmadm_first,\n          m.firstmjd\n   FROM magstat m\n   WHERE m.oid IN\n       (SELECT oid\n        FROM snii_objects) ),\n     rise_rates AS\n  (SELECT d1.oid,\n          (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS initial_rise_rate,\n          d1.mjd AS start_mjd,\n          d1.fid AS band\n   FROM detections d1\n   JOIN detections d2 ON d1.oid = d2.oid\n   AND d2.mjd > d1.mjd\n   WHERE d2.mjd - d1.mjd <= 10 -- Limit to early rise phase\n),\n     filtered_rise AS\n  (SELECT oid,\n          start_mjd,\n          band,\n          initial_rise_rate\n   FROM rise_rates\n   WHERE initial_rise_rate > 0.5 ),\n     FINAL AS\n  (SELECT o.oid,\n          d.candid,\n          d.mjd,\n          d.magpsf,\n          d.sigmapsf,\n          m.magmean,\n          m.sigmadm_first,\n          m.firstmjd,\n          f.band\n   FROM snii_objects o\n   JOIN detections d ON o.oid = d.oid\n   JOIN magstats m ON o.oid = m.oid\n   AND m.fid = d.fid\n   JOIN filtered_rise f ON o.oid = f.oid\n   AND f.band = d.fid)\nSELECT oid,\n       candid,\n       magpsf,\n       sigmapsf,\n       firstmjd,\n       band\nFROM FINAL\nORDER BY firstmjd;"
                },
                "in_toks": 3848,
                "out_toks": 560,
                "id": "chatcmpl-BgxukgcjqpqSDSTNuR4Ia5SuROXPt",
                "created": 1749579786,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "25": {
        "0": {
            "req_id": "25",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 14,
                "id": "chatcmpl-BgxtK6YeLIZ0OIGKSL1OeJRyCZKOT",
                "created": 1749579698,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)),\n     candidate_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE (-- Check if first detection is within the first 7 days of February 2023 (MJD 59976 to 59982)\n o.firstmjd BETWEEN 59976 AND 59982) ),\n     probabilities AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.probability > 0.4\n     AND p.ranking = 1 ),\n     spatial_objects AS\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT oid\n        FROM candidate_objects) ),\n     matched_objects AS\n  (SELECT so.oid\n   FROM spatial_objects so\n   JOIN sources s ON q3c_join(so.meanra, so.meandec, s.column2, s.column3, 10)),\n     final_objects AS\n  (SELECT mo.oid\n   FROM matched_objects mo\n   JOIN probabilities p ON mo.oid = p.oid)\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM final_objects);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)),\n     candidate_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE (-- Check if first detection is within the first 7 days of February 2023 (MJD 59976 to 59982)\n o.firstmjd BETWEEN 59976 AND 59982) ),\n     probabilities AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.probability > 0.4\n     AND p.ranking = 1 ),\n     spatial_objects AS\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec\n   FROM OBJECT o\n   WHERE o.oid IN\n       (SELECT oid\n        FROM candidate_objects) ),\n     matched_objects AS\n  (SELECT so.oid\n   FROM spatial_objects so\n   JOIN sources s ON q3c_join(so.meanra, so.meandec, s.column2, s.column3, 10)),\n     final_objects AS\n  (SELECT mo.oid\n   FROM matched_objects mo\n   JOIN probabilities p ON mo.oid = p.oid)\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM final_objects);"
                },
                "in_toks": 2620,
                "out_toks": 312,
                "id": "chatcmpl-BgxusUqXYTzgoHrqKXxGvwvbuVbvL",
                "created": 1749579794,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "25",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 14,
                "id": "chatcmpl-BgxtK6YeLIZ0OIGKSL1OeJRyCZKOT",
                "created": 1749579698,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Define source positions with their coordinates\nWITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)), -- Select objects with first detection within the first 7 days of February (MJD 59976 to 59983)\ncandidate_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0 ), -- Select objects with SN class probability > 0.4 and ranking=1 from the stamp_classifier\nprobabilities AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.probability > 0.4\n     AND p.ranking = 1 ), -- Find objects within 10 degrees of each source position\nspatial_matches AS\n  (SELECT DISTINCT o.oid\n   FROM OBJECT o\n   JOIN sources s ON TRUE\n   WHERE q3c_join(o.meanra, o.meandec, s.column2, s.column3, 10) ) -- Final selection: objects that meet spatial, temporal, and probability criteria\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM spatial_matches)\n  AND o.oid IN\n    (SELECT oid\n     FROM probabilities);",
            "sql_response": {
                "responses": {
                    "0": "-- Define source positions with their coordinates\nWITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)), -- Select objects with first detection within the first 7 days of February (MJD 59976 to 59983)\ncandidate_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0 ), -- Select objects with SN class probability > 0.4 and ranking=1 from the stamp_classifier\nprobabilities AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.probability > 0.4\n     AND p.ranking = 1 ), -- Find objects within 10 degrees of each source position\nspatial_matches AS\n  (SELECT DISTINCT o.oid\n   FROM OBJECT o\n   JOIN sources s ON TRUE\n   WHERE q3c_join(o.meanra, o.meandec, s.column2, s.column3, 10) ) -- Final selection: objects that meet spatial, temporal, and probability criteria\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM spatial_matches)\n  AND o.oid IN\n    (SELECT oid\n     FROM probabilities);"
                },
                "in_toks": 1716,
                "out_toks": 318,
                "id": "chatcmpl-BgyQ4yJWHBYLaZKU7UCp2tL9DqH7i",
                "created": 1749581728,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)),\n     candidate_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE (-- Check if first detection is within 7 days of Feb 1 (MJD 59976.0)\n o.firstmjd BETWEEN 59976.0 AND 59983.0) ),\n     probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.probability > 0.4\n     AND p.ranking = 1 ),\n     spatial_matches AS\n  (SELECT DISTINCT o.oid\n   FROM OBJECT o\n   JOIN sources s ON TRUE\n   WHERE q3c_join(o.meanra, o.meandec, s.column2, s.column3, 10) )\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM spatial_matches)\n  AND o.oid IN\n    (SELECT oid\n     FROM probabilities);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)),\n     candidate_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE (-- Check if first detection is within 7 days of Feb 1 (MJD 59976.0)\n o.firstmjd BETWEEN 59976.0 AND 59983.0) ),\n     probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.class_name = 'SN'\n     AND p.probability > 0.4\n     AND p.ranking = 1 ),\n     spatial_matches AS\n  (SELECT DISTINCT o.oid\n   FROM OBJECT o\n   JOIN sources s ON TRUE\n   WHERE q3c_join(o.meanra, o.meandec, s.column2, s.column3, 10) )\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM spatial_matches)\n  AND o.oid IN\n    (SELECT oid\n     FROM probabilities);"
                },
                "in_toks": 2620,
                "out_toks": 274,
                "id": "chatcmpl-Bgxuxr7Eqa20e9IxxtgD4Ze3SQfI4",
                "created": 1749579799,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "7": {
        "0": {
            "req_id": "7",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 773,
                "out_toks": 14,
                "id": "chatcmpl-BgxtMfWfAU5KAuGlcL6mYDoKY4XmJ",
                "created": 1749579700,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select object identifiers and probabilities for objects with most likely class 'SN' in stamp_classifier\n\nSELECT o.oid,\n       p.probability\nFROM\n  (-- Subquery to get OIDs with top-ranked probability class 'SN' in stamp_classifier\n SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND p.oid IN\n       (-- Subquery to get objects with first detection in January 2023\n SELECT o.oid\n        FROM OBJECT o\n        WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0 ) ) AS sn_objects\nJOIN probability p ON sn_objects.oid = p.oid\nJOIN OBJECT o ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'SN';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select object identifiers and probabilities for objects with most likely class 'SN' in stamp_classifier\n\nSELECT o.oid,\n       p.probability\nFROM\n  (-- Subquery to get OIDs with top-ranked probability class 'SN' in stamp_classifier\n SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'SN'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND p.oid IN\n       (-- Subquery to get objects with first detection in January 2023\n SELECT o.oid\n        FROM OBJECT o\n        WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0 ) ) AS sn_objects\nJOIN probability p ON sn_objects.oid = p.oid\nJOIN OBJECT o ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'SN';"
                },
                "in_toks": 2569,
                "out_toks": 208,
                "id": "chatcmpl-Bgxv14sas0TerHj2gEI1kkmYYLzvx",
                "created": 1749579803,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "7",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 773,
                "out_toks": 14,
                "id": "chatcmpl-BgxtMfWfAU5KAuGlcL6mYDoKY4XmJ",
                "created": 1749579700,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Select object identifiers and probabilities for objects whose most likely class is 'SN' in stamp_classifier\n-- and that had their first detection in January 2023, optimizing with nested queries and explicit conditions.\n WITH ranked_probabilities AS\n  (-- Subquery to rank classes for each object based on probability ranking\n SELECT p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking,\n        ROW_NUMBER() OVER (PARTITION BY p.oid\n                           ORDER BY p.ranking) AS rn\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking <= 3 -- Ensure at least top 3 classes are considered for more specificity\n)\nSELECT rp.oid,\n       rp.probability\nFROM ranked_probabilities rp\nJOIN OBJECT o ON o.oid = rp.oid\nWHERE rp.rn = 1 -- Most probable class per object\n\n  AND rp.class_name = 'SN' -- Most likely class is SN\n\n  AND o.firstmjd BETWEEN 59945.0 AND 59975.0 -- First detection in January 2023\n\n  AND rp.ranking = 1; -- Confirm the class is the top-ranked class",
            "sql_response": {
                "responses": {
                    "0": "-- Select object identifiers and probabilities for objects whose most likely class is 'SN' in stamp_classifier\n-- and that had their first detection in January 2023, optimizing with nested queries and explicit conditions.\n WITH ranked_probabilities AS\n  (-- Subquery to rank classes for each object based on probability ranking\n SELECT p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking,\n        ROW_NUMBER() OVER (PARTITION BY p.oid\n                           ORDER BY p.ranking) AS rn\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking <= 3 -- Ensure at least top 3 classes are considered for more specificity\n)\nSELECT rp.oid,\n       rp.probability\nFROM ranked_probabilities rp\nJOIN OBJECT o ON o.oid = rp.oid\nWHERE rp.rn = 1 -- Most probable class per object\n\n  AND rp.class_name = 'SN' -- Most likely class is SN\n\n  AND o.firstmjd BETWEEN 59945.0 AND 59975.0 -- First detection in January 2023\n\n  AND rp.ranking = 1; -- Confirm the class is the top-ranked class"
                },
                "in_toks": 1485,
                "out_toks": 267,
                "id": "chatcmpl-BgyQ7tXbnPNuy9IDcgEVizdpdX4pK",
                "created": 1749581731,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select object identifiers and probabilities for objects with most likely class 'SN' in stamp_classifier\n\nSELECT p.oid,\n       p.probability\nFROM\n  (-- Subquery to get the most probable class for each object in stamp_classifier\n SELECT probability.oid,\n        probability.class_name,\n        probability.probability,\n        ROW_NUMBER() OVER (PARTITION BY probability.oid\n                           ORDER BY probability.ranking) AS rn\n   FROM probability\n   WHERE probability.classifier_name = 'stamp_classifier' ) p\nWHERE p.rn = 1 -- Most probable class\n\n  AND p.class_name = 'SN' -- Most likely class is SN\n\n  AND EXISTS\n    (-- Check if the object's first detection was in January 2023\n SELECT 1\n     FROM OBJECT o\n     WHERE o.oid = p.oid\n       AND o.firstmjd BETWEEN 59945.0 AND 59975.0 );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select object identifiers and probabilities for objects with most likely class 'SN' in stamp_classifier\n\nSELECT p.oid,\n       p.probability\nFROM\n  (-- Subquery to get the most probable class for each object in stamp_classifier\n SELECT probability.oid,\n        probability.class_name,\n        probability.probability,\n        ROW_NUMBER() OVER (PARTITION BY probability.oid\n                           ORDER BY probability.ranking) AS rn\n   FROM probability\n   WHERE probability.classifier_name = 'stamp_classifier' ) p\nWHERE p.rn = 1 -- Most probable class\n\n  AND p.class_name = 'SN' -- Most likely class is SN\n\n  AND EXISTS\n    (-- Check if the object's first detection was in January 2023\n SELECT 1\n     FROM OBJECT o\n     WHERE o.oid = p.oid\n       AND o.firstmjd BETWEEN 59945.0 AND 59975.0 );"
                },
                "in_toks": 2569,
                "out_toks": 194,
                "id": "chatcmpl-Bgxv408qArUp0Fgs6cLskJXYdGKNf",
                "created": 1749579806,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "2": {
        "0": {
            "req_id": "2",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']",
                    "1": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 760,
                "out_toks": 20,
                "id": "chatcmpl-BgxtNu3HCxFILReNpkHcdhL4y2Sss",
                "created": 1749579701,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query to retrieve objects classified as YSO with high confidence based on their lightcurve classification probabilities\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to select object IDs with YSO classification, high probability, and specific classifier names\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'YSO'\n       AND p.classifier_name IN ('lc_classifier',\n                                 'lc_classifier_top',\n                                 'lc_classifier_transient',\n                                 'lc_classifier_stochastic',\n                                 'lc_classifier_periodic')\n       AND p.probability > 0.7\n       AND p.ranking = 1 -- Additional conditions to optimize query performance\n\n       AND p.oid IS NOT NULL ) -- Optional: limit the date range if needed to reduce query scope\n-- For example, uncomment and adjust the following line if date filtering is desired\n-- AND o.firstmjd >= <start_mjd> AND o.lastmjd <= <end_mjd>",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query to retrieve objects classified as YSO with high confidence based on their lightcurve classification probabilities\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to select object IDs with YSO classification, high probability, and specific classifier names\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'YSO'\n       AND p.classifier_name IN ('lc_classifier',\n                                 'lc_classifier_top',\n                                 'lc_classifier_transient',\n                                 'lc_classifier_stochastic',\n                                 'lc_classifier_periodic')\n       AND p.probability > 0.7\n       AND p.ranking = 1 -- Additional conditions to optimize query performance\n\n       AND p.oid IS NOT NULL ) -- Optional: limit the date range if needed to reduce query scope\n-- For example, uncomment and adjust the following line if date filtering is desired\n-- AND o.firstmjd >= <start_mjd> AND o.lastmjd <= <end_mjd>"
                },
                "in_toks": 1400,
                "out_toks": 214,
                "id": "chatcmpl-BgyQANSvi4gO3UR4UN8R9E1blYSh6",
                "created": 1749581734,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve object IDs classified as YSO by the light curve classifier with probability > 0.7\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to select OIDs with YSO classification and probability > 0.7\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'YSO'\n       AND p.classifier_name IN ('lc_classifier',\n                                 'lc_classifier_top',\n                                 'lc_classifier_transient',\n                                 'lc_classifier_stochastic',\n                                 'lc_classifier_periodic')\n       AND p.probability > 0.7\n       AND p.ranking = 1 );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve object IDs classified as YSO by the light curve classifier with probability > 0.7\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to select OIDs with YSO classification and probability > 0.7\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'YSO'\n       AND p.classifier_name IN ('lc_classifier',\n                                 'lc_classifier_top',\n                                 'lc_classifier_transient',\n                                 'lc_classifier_stochastic',\n                                 'lc_classifier_periodic')\n       AND p.probability > 0.7\n       AND p.ranking = 1 );"
                },
                "in_toks": 2572,
                "out_toks": 135,
                "id": "chatcmpl-Bgxv7o3VqKtGeSDydD3RgTuXrjQki",
                "created": 1749579809,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "2",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']",
                    "1": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 760,
                "out_toks": 20,
                "id": "chatcmpl-BgxtNu3HCxFILReNpkHcdhL4y2Sss",
                "created": 1749579701,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve object IDs classified as YSO with high probability (>0.7) in the light curve classifier\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to select OIDs with YSO classification probability > 0.7\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'YSO'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.7\n       AND p.ranking = 1 -- Most probable class\n);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve object IDs classified as YSO with high probability (>0.7) in the light curve classifier\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to select OIDs with YSO classification probability > 0.7\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'YSO'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.7\n       AND p.ranking = 1 -- Most probable class\n);"
                },
                "in_toks": 2572,
                "out_toks": 116,
                "id": "chatcmpl-Bgxv9DB1FkOQfEodBuecr2jD9oygs",
                "created": 1749579811,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "3": {
        "0": {
            "req_id": "3",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 764,
                "out_toks": 14,
                "id": "chatcmpl-BgxtOZDxMjfcpstDbRBRCVcsoZPNo",
                "created": 1749579702,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'YSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.7\n     AND p.ranking = 1 -- most probable class\n) -- Select objects from the object table that are in the yso_objects set and last detected in June 2023\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM yso_objects)\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'YSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.7\n     AND p.ranking = 1 -- most probable class\n) -- Select objects from the object table that are in the yso_objects set and last detected in June 2023\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM yso_objects)\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;"
                },
                "in_toks": 2552,
                "out_toks": 151,
                "id": "chatcmpl-BgxvBmKhm4Rf7mgG79AYIobGHM8ma",
                "created": 1749579813,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "3",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 764,
                "out_toks": 14,
                "id": "chatcmpl-BgxtOZDxMjfcpstDbRBRCVcsoZPNo",
                "created": 1749579702,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'YSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.7\n     AND p.ranking = 1 -- most probable class\n) -- Select objects from the object table that are in the yso_objects set and last detected in June 2023\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM yso_objects)\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'YSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.7\n     AND p.ranking = 1 -- most probable class\n) -- Select objects from the object table that are in the yso_objects set and last detected in June 2023\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM yso_objects)\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;"
                },
                "in_toks": 2552,
                "out_toks": 151,
                "id": "chatcmpl-BgxvDRe3WFNtiIO0wqgEqLtDMkc63",
                "created": 1749579815,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "23": {
        "0": {
            "req_id": "23",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 787,
                "out_toks": 14,
                "id": "chatcmpl-BgxtOEBkRmKi5sQn7DIkCY0zl7J3F",
                "created": 1749579702,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query to retrieve objects most likely to be classified as \"SNIa\", \"SNIbc\", \"SNII\", or \"SLSN\" with probability > 0.2,\n-- including all classification probabilities, while avoiding timeout issues by limiting the dataset early.\n WITH filtered_probabilities AS\n  (-- Select probabilities for specified classes with probability > 0.2 and classifier 'lc_classifier'\n SELECT p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name IN ('SNIa',\n                          'SNIbc',\n                          'SNII',\n                          'SLSN')\n     AND p.probability > 0.2\n     AND p.ranking = 1 -- Focus on the most likely class per object to reduce dataset size\n),\n      candidate_objects AS\n  (-- Identify objects that have at least one high-probability classification\n SELECT DISTINCT oid\n   FROM filtered_probabilities) -- Retrieve all classification probabilities for these candidate objects\n\nSELECT o.oid,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM OBJECT o\nJOIN probability p ON o.oid = p.oid\nWHERE o.oid IN\n    (SELECT oid\n     FROM candidate_objects)\n  AND p.classifier_name = 'lc_classifier' -- Optional: order by object ID and class ranking for clarity\nORDER BY o.oid,\n         p.ranking;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query to retrieve objects most likely to be classified as \"SNIa\", \"SNIbc\", \"SNII\", or \"SLSN\" with probability > 0.2,\n-- including all classification probabilities, while avoiding timeout issues by limiting the dataset early.\n WITH filtered_probabilities AS\n  (-- Select probabilities for specified classes with probability > 0.2 and classifier 'lc_classifier'\n SELECT p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name IN ('SNIa',\n                          'SNIbc',\n                          'SNII',\n                          'SLSN')\n     AND p.probability > 0.2\n     AND p.ranking = 1 -- Focus on the most likely class per object to reduce dataset size\n),\n      candidate_objects AS\n  (-- Identify objects that have at least one high-probability classification\n SELECT DISTINCT oid\n   FROM filtered_probabilities) -- Retrieve all classification probabilities for these candidate objects\n\nSELECT o.oid,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM OBJECT o\nJOIN probability p ON o.oid = p.oid\nWHERE o.oid IN\n    (SELECT oid\n     FROM candidate_objects)\n  AND p.classifier_name = 'lc_classifier' -- Optional: order by object ID and class ranking for clarity\nORDER BY o.oid,\n         p.ranking;"
                },
                "in_toks": 1492,
                "out_toks": 304,
                "id": "chatcmpl-BgyQCKfEDzvLS5gIbHikXbz7zuAHm",
                "created": 1749581736,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS\n  (SELECT o.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name IN ('SNIa',\n                          'SNIbc',\n                          'SNII',\n                          'SLSN')\n     AND p.probability > 0.2 ) -- Retrieve all probabilities for these objects, including all class probabilities\n\nSELECT o.oid,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM OBJECT o\nJOIN probability p ON o.oid = p.oid\nWHERE o.oid IN\n    (SELECT DISTINCT oid\n     FROM object_probabilities)\nORDER BY o.oid,\n         p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS\n  (SELECT o.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name IN ('SNIa',\n                          'SNIbc',\n                          'SNII',\n                          'SLSN')\n     AND p.probability > 0.2 ) -- Retrieve all probabilities for these objects, including all class probabilities\n\nSELECT o.oid,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM OBJECT o\nJOIN probability p ON o.oid = p.oid\nWHERE o.oid IN\n    (SELECT DISTINCT oid\n     FROM object_probabilities)\nORDER BY o.oid,\n         p.ranking;"
                },
                "in_toks": 2565,
                "out_toks": 206,
                "id": "chatcmpl-BgxvGgJvLJYieIRUVA8psZJmnSpVK",
                "created": 1749579818,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "23",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 787,
                "out_toks": 14,
                "id": "chatcmpl-BgxtOEBkRmKi5sQn7DIkCY0zl7J3F",
                "created": 1749579702,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query to retrieve objects most likely to be classified as \"SNIa\", \"SNIbc\", \"SNII\", or \"SLSN\" with probability > 0.2\n-- and include all classification probabilities, avoiding timeout issues by simplifying the query\n WITH filtered_probabilities AS\n  (-- Select probabilities for specified classes with probability > 0.2, classifier 'lc_classifier', and ranking=1 for most likely classification\n SELECT p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name IN ('SNIa',\n                          'SNIbc',\n                          'SNII',\n                          'SLSN')\n     AND p.probability > 0.2\n     AND p.ranking = 1 -- Focus on the top-ranked class per object for efficiency\n),\n      object_ids AS\n  (-- Get distinct object IDs from the filtered probabilities\n SELECT DISTINCT oid\n   FROM filtered_probabilities) -- Retrieve all classification probabilities for these objects and classes\n\nSELECT o.oid,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM object_ids oi\nJOIN OBJECT o ON o.oid = oi.oid\nJOIN probability p ON p.oid = o.oid\nWHERE p.class_name IN ('SNIa',\n                       'SNIbc',\n                       'SNII',\n                       'SLSN')\n  AND p.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.2\nORDER BY o.oid,\n         p.class_name,\n         p.ranking;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query to retrieve objects most likely to be classified as \"SNIa\", \"SNIbc\", \"SNII\", or \"SLSN\" with probability > 0.2\n-- and include all classification probabilities, avoiding timeout issues by simplifying the query\n WITH filtered_probabilities AS\n  (-- Select probabilities for specified classes with probability > 0.2, classifier 'lc_classifier', and ranking=1 for most likely classification\n SELECT p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name IN ('SNIa',\n                          'SNIbc',\n                          'SNII',\n                          'SLSN')\n     AND p.probability > 0.2\n     AND p.ranking = 1 -- Focus on the top-ranked class per object for efficiency\n),\n      object_ids AS\n  (-- Get distinct object IDs from the filtered probabilities\n SELECT DISTINCT oid\n   FROM filtered_probabilities) -- Retrieve all classification probabilities for these objects and classes\n\nSELECT o.oid,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM object_ids oi\nJOIN OBJECT o ON o.oid = oi.oid\nJOIN probability p ON p.oid = o.oid\nWHERE p.class_name IN ('SNIa',\n                       'SNIbc',\n                       'SNII',\n                       'SLSN')\n  AND p.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.2\nORDER BY o.oid,\n         p.class_name,\n         p.ranking;"
                },
                "in_toks": 1496,
                "out_toks": 345,
                "id": "chatcmpl-BgyQJ3sn1wAbMchHYNELs5s8RU70C",
                "created": 1749581743,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS\n  (SELECT o.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name IN ('SNIa',\n                          'SNIbc',\n                          'SNII',\n                          'SLSN')\n     AND p.probability > 0.2 ) -- Retrieve all probabilities for these objects and classes\n\nSELECT o.oid,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM OBJECT o\nJOIN probability p ON o.oid = p.oid\nWHERE o.oid IN\n    (SELECT DISTINCT oid\n     FROM object_probabilities)\nORDER BY o.oid,\n         p.class_name,\n         p.ranking;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS\n  (SELECT o.oid,\n          p.class_name,\n          p.probability,\n          p.ranking\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.classifier_name = 'lc_classifier'\n     AND p.class_name IN ('SNIa',\n                          'SNIbc',\n                          'SNII',\n                          'SLSN')\n     AND p.probability > 0.2 ) -- Retrieve all probabilities for these objects and classes\n\nSELECT o.oid,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM OBJECT o\nJOIN probability p ON o.oid = p.oid\nWHERE o.oid IN\n    (SELECT DISTINCT oid\n     FROM object_probabilities)\nORDER BY o.oid,\n         p.class_name,\n         p.ranking;"
                },
                "in_toks": 2565,
                "out_toks": 208,
                "id": "chatcmpl-BgxvJfP4ZTlky8lSuas997HC6KiAh",
                "created": 1749579821,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "32": {
        "0": {
            "req_id": "32",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 777,
                "out_toks": 12,
                "id": "chatcmpl-BgxtP4nEYLElxcaUeoo2b3ix60kqr",
                "created": 1749579703,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\n\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj',\n              'ZTF21aaqosfm',\n              'ZTF21aaqosfs',\n              'ZTF21aaqosff',\n              'ZTF21aaqoski',\n              'ZTF21aaqoskz',\n              'ZTF21aaqosfo',\n              'ZTF21aaqosly',\n              'ZTF21aaqosgi',\n              'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\n\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj',\n              'ZTF21aaqosfm',\n              'ZTF21aaqosfs',\n              'ZTF21aaqosff',\n              'ZTF21aaqoski',\n              'ZTF21aaqoskz',\n              'ZTF21aaqosfo',\n              'ZTF21aaqosly',\n              'ZTF21aaqosgi',\n              'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;"
                },
                "in_toks": 2124,
                "out_toks": 143,
                "id": "chatcmpl-BgxvMxaLr70s0wCwkQ2eAUzYcllje",
                "created": 1749579824,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "32",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 777,
                "out_toks": 12,
                "id": "chatcmpl-BgxtP4nEYLElxcaUeoo2b3ix60kqr",
                "created": 1749579703,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\n\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj',\n              'ZTF21aaqosfm',\n              'ZTF21aaqosfs',\n              'ZTF21aaqosff',\n              'ZTF21aaqoski',\n              'ZTF21aaqoskz',\n              'ZTF21aaqosfo',\n              'ZTF21aaqosly',\n              'ZTF21aaqosgi',\n              'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\n\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj',\n              'ZTF21aaqosfm',\n              'ZTF21aaqosfs',\n              'ZTF21aaqosff',\n              'ZTF21aaqoski',\n              'ZTF21aaqoskz',\n              'ZTF21aaqosfo',\n              'ZTF21aaqosly',\n              'ZTF21aaqosgi',\n              'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;"
                },
                "in_toks": 2124,
                "out_toks": 143,
                "id": "chatcmpl-BgxvOgEE9jxJuIOKjD9VkQ23GRnOH",
                "created": 1749579826,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "20": {
        "0": {
            "req_id": "20",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 778,
                "out_toks": 22,
                "id": "chatcmpl-BgxtQrMng8MVqzPWts971mAb0RVoA",
                "created": 1749579704,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to find OIDs with RRL classification probability > 0.55\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'RRL'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.55\n       AND p.ranking = 1 )\n  AND o.ndet >= 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to find OIDs with RRL classification probability > 0.55\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'RRL'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.55\n       AND p.ranking = 1 )\n  AND o.ndet >= 100;"
                },
                "in_toks": 3092,
                "out_toks": 120,
                "id": "chatcmpl-BgxvRqdQhXeOtO2jx5A91bus6RxfD",
                "created": 1749579829,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "20",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 778,
                "out_toks": 22,
                "id": "chatcmpl-BgxtQrMng8MVqzPWts971mAb0RVoA",
                "created": 1749579704,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to find OIDs with RRL classification probability > 0.55\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'RRL'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.55\n       AND p.ranking = 1 )\n  AND o.ndet >= 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to find OIDs with RRL classification probability > 0.55\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'RRL'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.55\n       AND p.ranking = 1 )\n  AND o.ndet >= 100;"
                },
                "in_toks": 3092,
                "out_toks": 120,
                "id": "chatcmpl-BgxvTIZBqEsqs1MdgOClY99gD6wFv",
                "created": 1749579831,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "18": {
        "0": {
            "req_id": "18",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 911,
                "out_toks": 22,
                "id": "chatcmpl-BgxtSThEHAzi5RyetnOyN9d93vMvw",
                "created": 1749579706,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper JOINs and table references, following the schema and guidelines\n -- Query for AGN sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nJOIN probability p ON p.oid = o.oid\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'AGN'\n  AND p.probability > 0.95\nUNION -- Query for QSO sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nJOIN probability p ON p.oid = o.oid\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'QSO'\n  AND p.probability > 0.95\nUNION -- Query for Blazar sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nJOIN probability p ON p.oid = o.oid\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'Blazar'\n  AND p.probability > 0.8;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper JOINs and table references, following the schema and guidelines\n -- Query for AGN sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nJOIN probability p ON p.oid = o.oid\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'AGN'\n  AND p.probability > 0.95\nUNION -- Query for QSO sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nJOIN probability p ON p.oid = o.oid\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'QSO'\n  AND p.probability > 0.95\nUNION -- Query for Blazar sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nJOIN probability p ON p.oid = o.oid\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'Blazar'\n  AND p.probability > 0.8;"
                },
                "in_toks": 2577,
                "out_toks": 442,
                "id": "chatcmpl-BgyQMngIazAV6sVlVYN6A7czKjbyK",
                "created": 1749581746,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Query for AGN sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'AGN'\n  AND p.probability > 0.95\nUNION -- Query for QSO sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'QSO'\n  AND p.probability > 0.95\nUNION -- Query for Blazar sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'Blazar'\n  AND p.probability > 0.8;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Query for AGN sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'AGN'\n  AND p.probability > 0.95\nUNION -- Query for QSO sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'QSO'\n  AND p.probability > 0.95\nUNION -- Query for Blazar sources classified by the light curve classifier with specified filters\n\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM OBJECT o\nWHERE o.ndet >= 40\n  AND o.deltajd >= 200\n  AND p.oid = o.oid\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'Blazar'\n  AND p.probability > 0.8;"
                },
                "in_toks": 3225,
                "out_toks": 441,
                "id": "chatcmpl-BgxvV8hf90g3T0osY3D3KUw8xo3p7",
                "created": 1749579833,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "18",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 911,
                "out_toks": 22,
                "id": "chatcmpl-BgxtSThEHAzi5RyetnOyN9d93vMvw",
                "created": 1749579706,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table references and syntax, including comments for clarity\n\n  (-- Query for AGN sources classified by the light curve classifier with specified filters\n SELECT o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        'lc_classifier' AS classifier_name,\n        p.class_name,\n        p.ranking,\n        p.probability\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.95 )\nUNION\n  (-- Query for QSO sources classified by the light curve classifier with specified filters\n SELECT o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        'lc_classifier' AS classifier_name,\n        p.class_name,\n        p.ranking,\n        p.probability\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'QSO'\n     AND p.probability > 0.95 )\nUNION\n  (-- Query for Blazar sources classified by the light curve classifier with specified filters\n SELECT o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        'lc_classifier' AS classifier_name,\n        p.class_name,\n        p.ranking,\n        p.probability\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'Blazar'\n     AND p.probability > 0.8 );",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table references and syntax, including comments for clarity\n\n  (-- Query for AGN sources classified by the light curve classifier with specified filters\n SELECT o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        'lc_classifier' AS classifier_name,\n        p.class_name,\n        p.ranking,\n        p.probability\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'AGN'\n     AND p.probability > 0.95 )\nUNION\n  (-- Query for QSO sources classified by the light curve classifier with specified filters\n SELECT o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        'lc_classifier' AS classifier_name,\n        p.class_name,\n        p.ranking,\n        p.probability\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'QSO'\n     AND p.probability > 0.95 )\nUNION\n  (-- Query for Blazar sources classified by the light curve classifier with specified filters\n SELECT o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        'lc_classifier' AS classifier_name,\n        p.class_name,\n        p.ranking,\n        p.probability\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND p.classifier_name = 'lc_classifier'\n     AND p.class_name = 'Blazar'\n     AND p.probability > 0.8 );"
                },
                "in_toks": 2713,
                "out_toks": 472,
                "id": "chatcmpl-BgyQR0O3t4KiUxlvqAE7uSLvkAsMV",
                "created": 1749581751,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Query for AGN sources classified by the light curve classifier with specified filters\n\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          o.ndet,\n          o.firstmjd,\n          o.deltajd,\n          'lc_classifier' AS classifier_name,\n          p.class_name,\n          p.ranking,\n          p.probability\n   FROM OBJECT o\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.95 ) )\nUNION -- Query for QSO sources classified by the light curve classifier with specified filters\n\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          o.ndet,\n          o.firstmjd,\n          o.deltajd,\n          'lc_classifier' AS classifier_name,\n          p.class_name,\n          p.ranking,\n          p.probability\n   FROM OBJECT o\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'QSO'\n          AND p.probability > 0.95 ) )\nUNION -- Query for Blazar sources classified by the light curve classifier with specified filters\n\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          o.ndet,\n          o.firstmjd,\n          o.deltajd,\n          'lc_classifier' AS classifier_name,\n          p.class_name,\n          p.ranking,\n          p.probability\n   FROM OBJECT o\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'Blazar'\n          AND p.probability > 0.8 ) );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Query for AGN sources classified by the light curve classifier with specified filters\n\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          o.ndet,\n          o.firstmjd,\n          o.deltajd,\n          'lc_classifier' AS classifier_name,\n          p.class_name,\n          p.ranking,\n          p.probability\n   FROM OBJECT o\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.95 ) )\nUNION -- Query for QSO sources classified by the light curve classifier with specified filters\n\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          o.ndet,\n          o.firstmjd,\n          o.deltajd,\n          'lc_classifier' AS classifier_name,\n          p.class_name,\n          p.ranking,\n          p.probability\n   FROM OBJECT o\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'QSO'\n          AND p.probability > 0.95 ) )\nUNION -- Query for Blazar sources classified by the light curve classifier with specified filters\n\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          o.ndet,\n          o.firstmjd,\n          o.deltajd,\n          'lc_classifier' AS classifier_name,\n          p.class_name,\n          p.ranking,\n          p.probability\n   FROM OBJECT o\n   WHERE o.ndet >= 40\n     AND o.deltajd >= 200\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.classifier_name = 'lc_classifier'\n          AND p.class_name = 'Blazar'\n          AND p.probability > 0.8 ) );"
                },
                "in_toks": 3225,
                "out_toks": 507,
                "id": "chatcmpl-BgxvamiB2q4Qn5j9ITgahO5Oarkpb",
                "created": 1749579838,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "35": {
        "0": {
            "req_id": "35",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 752,
                "out_toks": 8,
                "id": "chatcmpl-BgxtTlX82K0t83ku6mJQh8ZPo5l9D",
                "created": 1749579707,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;"
                },
                "in_toks": 2036,
                "out_toks": 18,
                "id": "chatcmpl-BgxvgEb1ohQEDjhn2otS5ewayN1vK",
                "created": 1749579844,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "35",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 752,
                "out_toks": 8,
                "id": "chatcmpl-BgxtTlX82K0t83ku6mJQh8ZPo5l9D",
                "created": 1749579707,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;"
                },
                "in_toks": 2036,
                "out_toks": 18,
                "id": "chatcmpl-BgxvhesU5hFahNeHfspyn0zsZqQ9v",
                "created": 1749579845,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "11": {
        "0": {
            "req_id": "11",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']",
                    "1": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 791,
                "out_toks": 36,
                "id": "chatcmpl-BgxtUIo5uEqgXnYs1odhmsnO4mmOx",
                "created": 1749579708,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select object identifiers, maximum g-r difference, maximum magnitude, and filter id\n\nSELECT o.oid,\n       f.value AS g_r_max,\n       m.magmax,\n       m.fid\nFROM OBJECT o -- Join with feature table to get g-r_max\nJOIN feature f ON o.oid = f.oid\nAND f.name = 'g-r_max' -- Join with magstat to get maximum magnitude\nJOIN magstat m ON o.oid = m.oid\nAND m.magmax =\n  (SELECT MAX(magmax)\n   FROM magstat\n   WHERE oid = o.oid ) -- Filter for Type Ia SNe\nJOIN probability p ON o.oid = p.oid\nAND p.class_name = 'SNIa'\nAND p.ranking = 1\nAND p.classifier_name = 'lc_classifier' -- Filter for first detection in September last year\n\nWHERE o.firstmjd BETWEEN 60188.0 AND 60217.0 -- Peak magnitude above 19\n\n  AND m.magmax > 19 -- g-r color at maximum below 1\n\n  AND f.name = 'g-r_max'\n  AND f.value < 1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select object identifiers, maximum g-r difference, maximum magnitude, and filter id\n\nSELECT o.oid,\n       f.value AS g_r_max,\n       m.magmax,\n       m.fid\nFROM OBJECT o -- Join with feature table to get g-r_max\nJOIN feature f ON o.oid = f.oid\nAND f.name = 'g-r_max' -- Join with magstat to get maximum magnitude\nJOIN magstat m ON o.oid = m.oid\nAND m.magmax =\n  (SELECT MAX(magmax)\n   FROM magstat\n   WHERE oid = o.oid ) -- Filter for Type Ia SNe\nJOIN probability p ON o.oid = p.oid\nAND p.class_name = 'SNIa'\nAND p.ranking = 1\nAND p.classifier_name = 'lc_classifier' -- Filter for first detection in September last year\n\nWHERE o.firstmjd BETWEEN 60188.0 AND 60217.0 -- Peak magnitude above 19\n\n  AND m.magmax > 19 -- g-r color at maximum below 1\n\n  AND f.name = 'g-r_max'\n  AND f.value < 1;"
                },
                "in_toks": 6283,
                "out_toks": 256,
                "id": "chatcmpl-BgxvjxSDA0MlXDSHCbWvFTf8jdPf4",
                "created": 1749579847,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "11",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']",
                    "1": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 791,
                "out_toks": 36,
                "id": "chatcmpl-BgxtUIo5uEqgXnYs1odhmsnO4mmOx",
                "created": 1749579708,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user conditions\n-- Select object details for Type Ia SNe with specific conditions\n\nSELECT o.oid,\n       f.magmax,\n       f.magmax_corr,\n       f.g_r_max,\n       d.fid\nFROM OBJECT o\nJOIN feature f ON o.oid = f.oid\nAND f.name = 'g-r_max' -- Ensure feature is g-r_max\nJOIN detection d ON o.oid = d.oid\nWHERE -- Object classified as SN with class name 'SN' in probability table for the stamp_classifier\n EXISTS\n    (SELECT 1\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.ranking = 1 )\n  AND -- First detection in September (assuming MJD between 60188 and 60217)\n o.firstmjd BETWEEN 60188 AND 60217\n  AND -- Peak magnitude (magmax or magmax_corr) is above 19\n (f.magmax > 19\n  OR f.magmax_corr > 19)\n  AND -- g-r color at maximum is below 1\n f.g_r_max < 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user conditions\n-- Select object details for Type Ia SNe with specific conditions\n\nSELECT o.oid,\n       f.magmax,\n       f.magmax_corr,\n       f.g_r_max,\n       d.fid\nFROM OBJECT o\nJOIN feature f ON o.oid = f.oid\nAND f.name = 'g-r_max' -- Ensure feature is g-r_max\nJOIN detection d ON o.oid = d.oid\nWHERE -- Object classified as SN with class name 'SN' in probability table for the stamp_classifier\n EXISTS\n    (SELECT 1\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.ranking = 1 )\n  AND -- First detection in September (assuming MJD between 60188 and 60217)\n o.firstmjd BETWEEN 60188 AND 60217\n  AND -- Peak magnitude (magmax or magmax_corr) is above 19\n (f.magmax > 19\n  OR f.magmax_corr > 19)\n  AND -- g-r color at maximum is below 1\n f.g_r_max < 1;"
                },
                "in_toks": 5116,
                "out_toks": 257,
                "id": "chatcmpl-BgyQWO4nwnXV1Jtbm4dQgEDfQie3H",
                "created": 1749581756,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select object details for Type Ia SNe with specific conditions\n\nSELECT o.oid,\n       f.magmax,\n       f.magmax_corr,\n       f.g_r_max,\n       d.fid\nFROM OBJECT o\nJOIN feature f ON o.oid = f.oid\nWHERE -- Object classified as SN with class name 'SN' in probability table for the stamp_classifier\n EXISTS\n    (SELECT 1\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.ranking = 1 )\n  AND -- First detection in September (mjd between 60188 and 60217)\n o.firstmjd BETWEEN 60188 AND 60217\n  AND -- Peak magnitude (magmax or magmax_corr) is above 19\n (f.magmax > 19\n  OR f.magmax_corr > 19)\n  AND -- g-r color at maximum is below 1\n f.g_r_max < 1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select object details for Type Ia SNe with specific conditions\n\nSELECT o.oid,\n       f.magmax,\n       f.magmax_corr,\n       f.g_r_max,\n       d.fid\nFROM OBJECT o\nJOIN feature f ON o.oid = f.oid\nWHERE -- Object classified as SN with class name 'SN' in probability table for the stamp_classifier\n EXISTS\n    (SELECT 1\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.ranking = 1 )\n  AND -- First detection in September (mjd between 60188 and 60217)\n o.firstmjd BETWEEN 60188 AND 60217\n  AND -- Peak magnitude (magmax or magmax_corr) is above 19\n (f.magmax > 19\n  OR f.magmax_corr > 19)\n  AND -- g-r color at maximum is below 1\n f.g_r_max < 1;"
                },
                "in_toks": 6283,
                "out_toks": 232,
                "id": "chatcmpl-BgxvoxuLjqUuumOiL80POuMI2RmYC",
                "created": 1749579852,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "9": {
        "0": {
            "req_id": "9",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 862,
                "out_toks": 14,
                "id": "chatcmpl-BgxtUyX5zmOkEpIE7NqGb2yMVlQl0",
                "created": 1749579708,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define the search radius in degrees (1000 arcmin = 16.6667 degrees)\nWITH center AS\n  (SELECT 39.97 AS ra_center,\n          -1.5768 AS dec_center), -- Select objects with first detection in July 2023\nobjects_in_july AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          o.stellar,\n          o.ndet,\n          o.g_r_max,\n          o.g_r_mean,\n          o.step_id_corr\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 60126.0 AND 60156.0 ), -- Filter objects within the specified radius from the center\nspatial_filtered AS\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          c.ra_center,\n          c.dec_center,\n          q3c_dist(o.meanra, o.meandec, c.ra_center, c.dec_center) AS dist\n   FROM objects_in_july o,\n        center c\n   WHERE q3c_dist(o.meanra, o.meandec, c.ra_center, c.dec_center) <= 16.6667 ), -- Filter objects with sgscore1 < 0.3\nsgscore_filtered AS\n  (SELECT s.oid\n   FROM probability s\n   WHERE s.oid IN\n       (SELECT oid\n        FROM spatial_filtered)\n     AND s.class_name = 'sgscore1'\n     AND s.probability < 0.3 ), -- Get the highest probability class for each object in the stamp classifier\ntop_probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.classifier_name,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ), -- Exclude objects where the top class is 'Asteroid' or 'Bogus'\nvalid_objects AS\n  (SELECT tp.oid,\n          tp.class_name,\n          tp.probability,\n          tp.classifier_name,\n          tp.ranking\n   FROM top_probabilities tp\n   WHERE tp.class_name NOT IN ('Asteroid',\n                               'Bogus') ) -- Final selection of object identifiers with required conditions\n\nSELECT sp.oid,\n       o.g_r_max AS value,\n       o.step_id_corr AS name,\n       o.g_r_mean AS VERSION,\n       o.meanra,\n       o.meandec,\n       sp.dist\nFROM spatial_filtered sp\nJOIN OBJECT o ON sp.oid = o.oid\nJOIN sgscore_filtered s ON s.oid = sp.oid\nJOIN valid_objects v ON v.oid = sp.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define the search radius in degrees (1000 arcmin = 16.6667 degrees)\nWITH center AS\n  (SELECT 39.97 AS ra_center,\n          -1.5768 AS dec_center), -- Select objects with first detection in July 2023\nobjects_in_july AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          o.stellar,\n          o.ndet,\n          o.g_r_max,\n          o.g_r_mean,\n          o.step_id_corr\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 60126.0 AND 60156.0 ), -- Filter objects within the specified radius from the center\nspatial_filtered AS\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          c.ra_center,\n          c.dec_center,\n          q3c_dist(o.meanra, o.meandec, c.ra_center, c.dec_center) AS dist\n   FROM objects_in_july o,\n        center c\n   WHERE q3c_dist(o.meanra, o.meandec, c.ra_center, c.dec_center) <= 16.6667 ), -- Filter objects with sgscore1 < 0.3\nsgscore_filtered AS\n  (SELECT s.oid\n   FROM probability s\n   WHERE s.oid IN\n       (SELECT oid\n        FROM spatial_filtered)\n     AND s.class_name = 'sgscore1'\n     AND s.probability < 0.3 ), -- Get the highest probability class for each object in the stamp classifier\ntop_probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.classifier_name,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ), -- Exclude objects where the top class is 'Asteroid' or 'Bogus'\nvalid_objects AS\n  (SELECT tp.oid,\n          tp.class_name,\n          tp.probability,\n          tp.classifier_name,\n          tp.ranking\n   FROM top_probabilities tp\n   WHERE tp.class_name NOT IN ('Asteroid',\n                               'Bogus') ) -- Final selection of object identifiers with required conditions\n\nSELECT sp.oid,\n       o.g_r_max AS value,\n       o.step_id_corr AS name,\n       o.g_r_mean AS VERSION,\n       o.meanra,\n       o.meandec,\n       sp.dist\nFROM spatial_filtered sp\nJOIN OBJECT o ON sp.oid = o.oid\nJOIN sgscore_filtered s ON s.oid = sp.oid\nJOIN valid_objects v ON v.oid = sp.oid;"
                },
                "in_toks": 2669,
                "out_toks": 550,
                "id": "chatcmpl-Bgxvrk2raUcmhUWNwq4qm5fjo8Jwh",
                "created": 1749579855,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "9",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 862,
                "out_toks": 14,
                "id": "chatcmpl-BgxtUyX5zmOkEpIE7NqGb2yMVlQl0",
                "created": 1749579708,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Define the search radius in degrees (1000 arcmin = 16.6667 degrees)\nWITH center AS\n  (SELECT 39.97 AS ra,\n          -1.5768 AS dec),\n     objects_in_july AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          o.sgscore1\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 60126.0 AND 60156.0 ),\n     spatial_objects AS\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          q3c_dist(c.ra, c.dec, o.meanra, o.meandec) AS dist\n   FROM objects_in_july o,\n        center c\n   WHERE q3c_join(c.ra, c.dec, o.meanra, o.meandec, 16.6667) ),\n     probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.ranking,\n          p.classifier_name,\n          p.classifier_version\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ),\n     filtered_probs AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.classifier_version\n   FROM probabilities p\n   WHERE p.class_name NOT IN ('Asteroid',\n                              'Bogus') ) -- Final selection with all conditions applied\n\nSELECT s.oid,\n       p.probability AS value,\n       p.class_name AS name,\n       p.classifier_version AS VERSION,\n       o.meanra,\n       o.meandec,\n       o.oid AS source_id,\n       s.dist\nFROM spatial_objects s\nJOIN filtered_probs p ON s.oid = p.oid\nJOIN OBJECT o ON o.oid = s.oid\nWHERE o.sgscore1 < 0.3\n  AND s.dist <= 16.6667; -- within 1000 arcmin radius from the center",
            "sql_response": {
                "responses": {
                    "0": "-- Define the search radius in degrees (1000 arcmin = 16.6667 degrees)\nWITH center AS\n  (SELECT 39.97 AS ra,\n          -1.5768 AS dec),\n     objects_in_july AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          o.sgscore1\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 60126.0 AND 60156.0 ),\n     spatial_objects AS\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          q3c_dist(c.ra, c.dec, o.meanra, o.meandec) AS dist\n   FROM objects_in_july o,\n        center c\n   WHERE q3c_join(c.ra, c.dec, o.meanra, o.meandec, 16.6667) ),\n     probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.ranking,\n          p.classifier_name,\n          p.classifier_version\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ),\n     filtered_probs AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.classifier_version\n   FROM probabilities p\n   WHERE p.class_name NOT IN ('Asteroid',\n                              'Bogus') ) -- Final selection with all conditions applied\n\nSELECT s.oid,\n       p.probability AS value,\n       p.class_name AS name,\n       p.classifier_version AS VERSION,\n       o.meanra,\n       o.meandec,\n       o.oid AS source_id,\n       s.dist\nFROM spatial_objects s\nJOIN filtered_probs p ON s.oid = p.oid\nJOIN OBJECT o ON o.oid = s.oid\nWHERE o.sgscore1 < 0.3\n  AND s.dist <= 16.6667; -- within 1000 arcmin radius from the center"
                },
                "in_toks": 2109,
                "out_toks": 422,
                "id": "chatcmpl-BgyQZJlfYkIQh9kTSSno4lm4bqsHC",
                "created": 1749581759,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define the search radius in degrees (1000 arcmin = 16.16667 degrees)\nWITH center AS\n  (SELECT 39.97 AS ra,\n          -1.5768 AS dec), -- Select objects with first detection in July 2023\nobjects_in_july AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          o.stellarscore,\n          o.sgscore1\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 60126.0 AND 60156.0 ), -- Filter objects within the specified radius from the center\nspatial_objects AS\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          q3c_dist(c.ra, c.dec, o.meanra, o.meandec) AS dist\n   FROM objects_in_july o,\n        center c\n   WHERE q3c_join(c.ra, c.dec, o.meanra, o.meandec, 16.16667) ), -- Get the highest probability class for each object in the stamp classifier\nprobabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.ranking,\n          p.classifier_name,\n          p.classifier_version\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ), -- Filter objects where the highest probability class is not 'Asteroid' or 'Bogus'\nfiltered_probs AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.classifier_version\n   FROM probabilities p\n   WHERE p.class_name NOT IN ('Asteroid',\n                              'Bogus') ), -- Join all filters and select final columns\n\nSELECT s.oid,\n       p.probability AS value,\n       p.class_name AS name,\n       p.classifier_version AS VERSION,\n       o.meanra,\n       o.meandec, -- Assuming 'source' identifier is the object ID for this context\n o.oid AS source_id,\n s.dist\nFROM spatial_objects s\nJOIN filtered_probs p ON s.oid = p.oid\nJOIN OBJECT o ON o.oid = s.oid\nWHERE o.sgscore1 < 0.3;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define the search radius in degrees (1000 arcmin = 16.16667 degrees)\nWITH center AS\n  (SELECT 39.97 AS ra,\n          -1.5768 AS dec), -- Select objects with first detection in July 2023\nobjects_in_july AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.meanra,\n          o.meandec,\n          o.stellarscore,\n          o.sgscore1\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 60126.0 AND 60156.0 ), -- Filter objects within the specified radius from the center\nspatial_objects AS\n  (SELECT o.oid,\n          o.meanra,\n          o.meandec,\n          q3c_dist(c.ra, c.dec, o.meanra, o.meandec) AS dist\n   FROM objects_in_july o,\n        center c\n   WHERE q3c_join(c.ra, c.dec, o.meanra, o.meandec, 16.16667) ), -- Get the highest probability class for each object in the stamp classifier\nprobabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.ranking,\n          p.classifier_name,\n          p.classifier_version\n   FROM probability p\n   WHERE p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ), -- Filter objects where the highest probability class is not 'Asteroid' or 'Bogus'\nfiltered_probs AS\n  (SELECT p.oid,\n          p.class_name,\n          p.probability,\n          p.classifier_version\n   FROM probabilities p\n   WHERE p.class_name NOT IN ('Asteroid',\n                              'Bogus') ), -- Join all filters and select final columns\n\nSELECT s.oid,\n       p.probability AS value,\n       p.class_name AS name,\n       p.classifier_version AS VERSION,\n       o.meanra,\n       o.meandec, -- Assuming 'source' identifier is the object ID for this context\n o.oid AS source_id,\n s.dist\nFROM spatial_objects s\nJOIN filtered_probs p ON s.oid = p.oid\nJOIN OBJECT o ON o.oid = s.oid\nWHERE o.sgscore1 < 0.3;"
                },
                "in_toks": 2669,
                "out_toks": 468,
                "id": "chatcmpl-BgxvyWqUR6hVwjv6vafgVdcdWfLd7",
                "created": 1749579862,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "5": {
        "0": {
            "req_id": "5",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection']",
                    "1": "['object', 'probability', 'feature', 'detection']"
                },
                "in_toks": 833,
                "out_toks": 28,
                "id": "chatcmpl-BgxtVzEHqNRiS3eymtpRSbCB1z6mE",
                "created": 1749579709,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select object and detection information along with feature details, renaming 'fid' to 'feature_fid'\n\nSELECT o.oid,\n       d.candid AS detection_candid,\n       f.name AS feature_name,\n       f.value AS feature_value,\n       d.magpsf AS psf_magnitude,\n       d.sigmapsf AS magnitude_error,\n       f.fid AS feature_fid -- renamed as per user request\nFROM OBJECT o\nJOIN detection d ON o.oid = d.oid\nJOIN feature f ON o.oid = f.oid\nWHERE -- Filter objects classified as SN II with probability > 0.6\n o.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'SNII'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.6 ) -- Filter objects with more than 50 detections\n\n  AND o.ndet > 50 -- Filter objects with g-band magnitude difference > 2\n\n  AND\n    (SELECT MAX(magpsf) - MIN(magpsf)\n     FROM detection\n     WHERE oid = o.oid\n       AND fid = 1 -- fid=1 corresponds to g-band\n ) > 2\nORDER BY o.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select object and detection information along with feature details, renaming 'fid' to 'feature_fid'\n\nSELECT o.oid,\n       d.candid AS detection_candid,\n       f.name AS feature_name,\n       f.value AS feature_value,\n       d.magpsf AS psf_magnitude,\n       d.sigmapsf AS magnitude_error,\n       f.fid AS feature_fid -- renamed as per user request\nFROM OBJECT o\nJOIN detection d ON o.oid = d.oid\nJOIN feature f ON o.oid = f.oid\nWHERE -- Filter objects classified as SN II with probability > 0.6\n o.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'SNII'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.6 ) -- Filter objects with more than 50 detections\n\n  AND o.ndet > 50 -- Filter objects with g-band magnitude difference > 2\n\n  AND\n    (SELECT MAX(magpsf) - MIN(magpsf)\n     FROM detection\n     WHERE oid = o.oid\n       AND fid = 1 -- fid=1 corresponds to g-band\n ) > 2\nORDER BY o.oid;"
                },
                "in_toks": 5579,
                "out_toks": 286,
                "id": "chatcmpl-Bgxw5NhQtQTMd5tTfd7cJjptu9ZhO",
                "created": 1749579869,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "5",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection']",
                    "1": "['object', 'probability', 'feature', 'detection']"
                },
                "in_toks": 833,
                "out_toks": 28,
                "id": "chatcmpl-BgxtVzEHqNRiS3eymtpRSbCB1z6mE",
                "created": 1749579709,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select object and detection information along with feature details, renaming 'fid' to 'feature_fid'\n\nSELECT o.oid,\n       d.candid AS detection_candid,\n       f.name AS feature_name,\n       f.value AS feature_value,\n       d.magpsf,\n       d.sigmapsf,\n       d.ra,\n       d.dec, -- Rename 'fid' to 'feature_fid'\n f.fid AS feature_fid\nFROM OBJECT o\nJOIN detection d ON o.oid = d.oid\nJOIN feature f ON o.oid = f.oid -- Subquery to filter objects classified as SN II with probability > 0.6\n\nWHERE o.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'SNII'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.6\n       AND p.ranking = 1 ) -- Filter objects with more than 50 detections\nAND o.ndet > 50 -- Filter objects with g-band magnitude difference greater than 2\nAND\n    (SELECT MAX(magpsf)\n     FROM detection\n     WHERE oid = o.oid\n       AND fid = 1) -\n    (SELECT MIN(magpsf)\n     FROM detection\n     WHERE oid = o.oid\n       AND fid = 1) > 2\nORDER BY o.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select object and detection information along with feature details, renaming 'fid' to 'feature_fid'\n\nSELECT o.oid,\n       d.candid AS detection_candid,\n       f.name AS feature_name,\n       f.value AS feature_value,\n       d.magpsf,\n       d.sigmapsf,\n       d.ra,\n       d.dec, -- Rename 'fid' to 'feature_fid'\n f.fid AS feature_fid\nFROM OBJECT o\nJOIN detection d ON o.oid = d.oid\nJOIN feature f ON o.oid = f.oid -- Subquery to filter objects classified as SN II with probability > 0.6\n\nWHERE o.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'SNII'\n       AND p.classifier_name = 'lc_classifier'\n       AND p.probability > 0.6\n       AND p.ranking = 1 ) -- Filter objects with more than 50 detections\nAND o.ndet > 50 -- Filter objects with g-band magnitude difference greater than 2\nAND\n    (SELECT MAX(magpsf)\n     FROM detection\n     WHERE oid = o.oid\n       AND fid = 1) -\n    (SELECT MIN(magpsf)\n     FROM detection\n     WHERE oid = o.oid\n       AND fid = 1) > 2\nORDER BY o.oid;"
                },
                "in_toks": 5579,
                "out_toks": 308,
                "id": "chatcmpl-Bgxw9saa3JeSTbRbe9q4RKyMR3B5t",
                "created": 1749579873,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "0": {
        "0": {
            "req_id": "0",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 823,
                "out_toks": 20,
                "id": "chatcmpl-BgxtXbpu2XqwzRLCmwCFiuhrsEuTv",
                "created": 1749579711,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\n-- Select objects with high probability of being YSO and showing periodicity with specified period and amplitude\nWITH yso_prob AS\n  (-- Select objects with probability > 0.7 of being YSO and top ranking\n SELECT p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        p.ranking\n   FROM probability p\n   WHERE p.class_name = 'YSO'\n     AND p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top',\n                               'lc_classifier_transient',\n                               'lc_classifier_stochastic',\n                               'lc_classifier_periodic',\n                               'stamp_classifier')\n     AND p.ranking = 1\n     AND p.probability > 0.7 ),\n     periodic_objects AS\n  (-- Select objects with multiband period between 3 and 10 days\n SELECT o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        f.value AS period_value,\n        f.name AS feature_name,\n        f.fid,\n        f.version AS feature_version\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'Multiband_period'\n     AND f.value BETWEEN 3 AND 10 ),\n     amplitude_objects AS\n  (-- Select objects with amplitude greater than 0.5\n SELECT o.oid,\n        f.value AS amplitude_value,\n        f.name AS feature_name,\n        f.fid,\n        f.version AS feature_version\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'Amplitude'\n     AND f.value > 0.5 ) -- Final selection: objects with high YSO probability, periodicity in desired range, and amplitude > 0.5\n\nSELECT p.oid,\n       p.possibility,\n       f.value AS feature_value,\n       f.name AS feature_name,\n       f.fid,\n       f.version AS feature_version\nFROM yso_prob p\nJOIN periodic_objects po ON p.oid = po.oid\nJOIN amplitude_objects ao ON p.oid = ao.oid\nJOIN feature f ON p.oid = f.oid\nWHERE f.name IN ('Multiband_period',\n                 'Amplitude')\n  AND ((f.name = 'Multiband_period'\n        AND f.value BETWEEN 3 AND 10)\n       OR (f.name = 'Amplitude'\n           AND f.value > 0.5))\nORDER BY p.possibility DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\n-- Select objects with high probability of being YSO and showing periodicity with specified period and amplitude\nWITH yso_prob AS\n  (-- Select objects with probability > 0.7 of being YSO and top ranking\n SELECT p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        p.ranking\n   FROM probability p\n   WHERE p.class_name = 'YSO'\n     AND p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top',\n                               'lc_classifier_transient',\n                               'lc_classifier_stochastic',\n                               'lc_classifier_periodic',\n                               'stamp_classifier')\n     AND p.ranking = 1\n     AND p.probability > 0.7 ),\n     periodic_objects AS\n  (-- Select objects with multiband period between 3 and 10 days\n SELECT o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        f.value AS period_value,\n        f.name AS feature_name,\n        f.fid,\n        f.version AS feature_version\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'Multiband_period'\n     AND f.value BETWEEN 3 AND 10 ),\n     amplitude_objects AS\n  (-- Select objects with amplitude greater than 0.5\n SELECT o.oid,\n        f.value AS amplitude_value,\n        f.name AS feature_name,\n        f.fid,\n        f.version AS feature_version\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'Amplitude'\n     AND f.value > 0.5 ) -- Final selection: objects with high YSO probability, periodicity in desired range, and amplitude > 0.5\n\nSELECT p.oid,\n       p.possibility,\n       f.value AS feature_value,\n       f.name AS feature_name,\n       f.fid,\n       f.version AS feature_version\nFROM yso_prob p\nJOIN periodic_objects po ON p.oid = po.oid\nJOIN amplitude_objects ao ON p.oid = ao.oid\nJOIN feature f ON p.oid = f.oid\nWHERE f.name IN ('Multiband_period',\n                 'Amplitude')\n  AND ((f.name = 'Multiband_period'\n        AND f.value BETWEEN 3 AND 10)\n       OR (f.name = 'Amplitude'\n           AND f.value > 0.5))\nORDER BY p.possibility DESC;"
                },
                "in_toks": 4463,
                "out_toks": 534,
                "id": "chatcmpl-BgyQepquGhYgDVvfoz5xitRHmqYIO",
                "created": 1749581764,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with high probability of being YSO and showing periodicity\nWITH yso_prob AS\n  (SELECT p.oid,\n          p.probability AS possibility,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          p.ranking\n   FROM probability p\n   WHERE p.class_name = 'YSO'\n     AND p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top',\n                               'lc_classifier_transient',\n                               'lc_classifier_stochastic',\n                               'lc_classifier_periodic',\n                               'stamp_classifier')\n     AND p.ranking = 1\n     AND p.probability > 0.7 ),\n     periodic_objects AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.lastmjd,\n          f.name AS feature_name,\n          f.value,\n          f.fid,\n          f.version AS feature_version\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'Multiband_period'\n     AND f.value BETWEEN 3 AND 10 ),\n     amplitude_objects AS\n  (SELECT o.oid,\n          f.value,\n          f.name,\n          f.fid,\n          f.version AS feature_version\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'Amplitude'\n     AND f.value > 0.5 )\nSELECT yso_prob.oid,\n       yso_prob.possibility,\n       f.value,\n       f.name,\n       f.fid,\n       f.feature_version\nFROM yso_prob\nJOIN periodic_objects p ON yso_prob.oid = p.oid\nJOIN amplitude_objects a ON yso_prob.oid = a.oid\nJOIN feature f ON yso_prob.oid = f.oid\nWHERE f.name IN ('Multiband_period',\n                 'Amplitude')\nORDER BY yso_prob.possibility DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with high probability of being YSO and showing periodicity\nWITH yso_prob AS\n  (SELECT p.oid,\n          p.probability AS possibility,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          p.ranking\n   FROM probability p\n   WHERE p.class_name = 'YSO'\n     AND p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top',\n                               'lc_classifier_transient',\n                               'lc_classifier_stochastic',\n                               'lc_classifier_periodic',\n                               'stamp_classifier')\n     AND p.ranking = 1\n     AND p.probability > 0.7 ),\n     periodic_objects AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.lastmjd,\n          f.name AS feature_name,\n          f.value,\n          f.fid,\n          f.version AS feature_version\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'Multiband_period'\n     AND f.value BETWEEN 3 AND 10 ),\n     amplitude_objects AS\n  (SELECT o.oid,\n          f.value,\n          f.name,\n          f.fid,\n          f.version AS feature_version\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'Amplitude'\n     AND f.value > 0.5 )\nSELECT yso_prob.oid,\n       yso_prob.possibility,\n       f.value,\n       f.name,\n       f.fid,\n       f.feature_version\nFROM yso_prob\nJOIN periodic_objects p ON yso_prob.oid = p.oid\nJOIN amplitude_objects a ON yso_prob.oid = a.oid\nJOIN feature f ON yso_prob.oid = f.oid\nWHERE f.name IN ('Multiband_period',\n                 'Amplitude')\nORDER BY yso_prob.possibility DESC;"
                },
                "in_toks": 5020,
                "out_toks": 432,
                "id": "chatcmpl-BgxwE2bDVsuK85gJMnmwd9fc9GnS3",
                "created": 1749579878,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "0",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 823,
                "out_toks": 20,
                "id": "chatcmpl-BgxtXbpu2XqwzRLCmwCFiuhrsEuTv",
                "created": 1749579711,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with high probability of being YSO and showing periodicity\n\nSELECT o.oid,\n       p.probability AS possibility,\n       f.value,\n       f.name AS feature_name,\n       f.fid AS filter_id,\n       f.version AS feature_version\nFROM OBJECT o -- Subquery to get the probability of being YSO with ranking=1 (most likely)\nJOIN\n  (SELECT oid,\n          probability\n   FROM probability\n   WHERE class_name = 'YSO'\n     AND classifier_name IN ('lc_classifier',\n                             'lc_classifier_top',\n                             'lc_classifier_transient',\n                             'lc_classifier_stochastic',\n                             'lc_classifier_periodic',\n                             'stamp_classifier')\n     AND ranking = 1 ) p ON o.oid = p.oid -- Subquery to get features related to periodicity and amplitude\nJOIN feature f ON o.oid = f.oid\nWHERE -- Filter for features indicating period between 3 and 10 days\n f.name = 'Multiband_period'\n  AND f.value BETWEEN 3 AND 10 -- Filter for features indicating variation amplitude greater than 0.5 mag\n\n  AND f.name = 'delta_mag_fid'\n  AND f.value > 0.5 -- Ensure the feature is from the relevant band (e.g., fid=1 for g band, or include multiple if needed)\n\n  AND f.fid = 1 -- Filter for objects with probability > 0.7\n\n  AND p.probability > 0.7\nORDER BY p.probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with high probability of being YSO and showing periodicity\n\nSELECT o.oid,\n       p.probability AS possibility,\n       f.value,\n       f.name AS feature_name,\n       f.fid AS filter_id,\n       f.version AS feature_version\nFROM OBJECT o -- Subquery to get the probability of being YSO with ranking=1 (most likely)\nJOIN\n  (SELECT oid,\n          probability\n   FROM probability\n   WHERE class_name = 'YSO'\n     AND classifier_name IN ('lc_classifier',\n                             'lc_classifier_top',\n                             'lc_classifier_transient',\n                             'lc_classifier_stochastic',\n                             'lc_classifier_periodic',\n                             'stamp_classifier')\n     AND ranking = 1 ) p ON o.oid = p.oid -- Subquery to get features related to periodicity and amplitude\nJOIN feature f ON o.oid = f.oid\nWHERE -- Filter for features indicating period between 3 and 10 days\n f.name = 'Multiband_period'\n  AND f.value BETWEEN 3 AND 10 -- Filter for features indicating variation amplitude greater than 0.5 mag\n\n  AND f.name = 'delta_mag_fid'\n  AND f.value > 0.5 -- Ensure the feature is from the relevant band (e.g., fid=1 for g band, or include multiple if needed)\n\n  AND f.fid = 1 -- Filter for objects with probability > 0.7\n\n  AND p.probability > 0.7\nORDER BY p.probability DESC;"
                },
                "in_toks": 5020,
                "out_toks": 336,
                "id": "chatcmpl-BgxwLrM0xQP06bUqGoSkNxvPt10Th",
                "created": 1749579885,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "28": {
        "0": {
            "req_id": "28",
            "experiment_id": "run_0",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['information_schema.tables']",
                    "1": "['information_schema.tables']"
                },
                "in_toks": 758,
                "out_toks": 10,
                "id": "chatcmpl-BgxtYeWeOiSPslzYAxHT2cxbHTevF",
                "created": 1749579712,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all table names in the 'alerce' schema\n\nSELECT TABLE_NAME\nFROM information_schema.tables\nWHERE table_schema = 'alerce';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all table names in the 'alerce' schema\n\nSELECT TABLE_NAME\nFROM information_schema.tables\nWHERE table_schema = 'alerce';"
                },
                "in_toks": 1864,
                "out_toks": 34,
                "id": "chatcmpl-BgxwQhwcRPQ5qnVYhYR49nSTSShP6",
                "created": 1749579890,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "28",
            "experiment_id": "run_1",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['information_schema.tables']",
                    "1": "['information_schema.tables']"
                },
                "in_toks": 758,
                "out_toks": 10,
                "id": "chatcmpl-BgxtYeWeOiSPslzYAxHT2cxbHTevF",
                "created": 1749579712,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all table names in the 'alerce' schema\n\nSELECT TABLE_NAME\nFROM information_schema.tables\nWHERE table_schema = 'alerce';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all table names in the 'alerce' schema\n\nSELECT TABLE_NAME\nFROM information_schema.tables\nWHERE table_schema = 'alerce';"
                },
                "in_toks": 1864,
                "out_toks": 34,
                "id": "chatcmpl-BgxwRQbowvfXnMMNX148fsRtjHJfb",
                "created": 1749579891,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "36": {
        "0": {
            "req_id": "36",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'detection']",
                    "1": "['object', 'feature', 'detection']"
                },
                "in_toks": 766,
                "out_toks": 20,
                "id": "chatcmpl-BgxtYv0fQeyxVAmmiCioTmhmRV5Lc",
                "created": 1749579712,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT f.oid,\n       f.name,\n       f.value\nFROM feature f\nWHERE f.oid = 'ZTF20aaelulu';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT f.oid,\n       f.name,\n       f.value\nFROM feature f\nWHERE f.oid = 'ZTF20aaelulu';"
                },
                "in_toks": 5328,
                "out_toks": 32,
                "id": "chatcmpl-BgxwS95ze3sLgBrkqEMSwB2f9JffP",
                "created": 1749579892,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "36",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'detection']",
                    "1": "['object', 'feature', 'detection']"
                },
                "in_toks": 766,
                "out_toks": 20,
                "id": "chatcmpl-BgxtYv0fQeyxVAmmiCioTmhmRV5Lc",
                "created": 1749579712,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT f.oid,\n       f.name,\n       f.value\nFROM feature f\nWHERE f.oid = 'ZTF20aaelulu';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT f.oid,\n       f.name,\n       f.value\nFROM feature f\nWHERE f.oid = 'ZTF20aaelulu';"
                },
                "in_toks": 5328,
                "out_toks": 32,
                "id": "chatcmpl-BgxwT2yGv8N9OnCUBHuCYUvpP9QVZ",
                "created": 1749579893,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "38": {
        "0": {
            "req_id": "38",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 804,
                "out_toks": 22,
                "id": "chatcmpl-BgxtZ29mG47j2qsR3EPEnNnVDdIhW",
                "created": 1749579713,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Retrieve top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS\n  (SELECT o.*\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE p.class_name = 'AGN'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1 -- Limit to top 1000 based on probability\n\n   ORDER BY p.probability DESC\n   LIMIT 1000), -- Retrieve top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS\n  (SELECT o.*\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE p.class_name = 'QSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.5\n     AND p.ranking = 1 -- Limit to top 1000 based on probability\n\n   ORDER BY p.probability DESC\n   LIMIT 1000) -- Select objects that are in both AGN and QSO candidate sets with detection counts between 30 and 200\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT agn.oid\n     FROM agn_candidates agn\n     JOIN qso_candidates qso ON agn.oid = qso.oid)\n  AND o.ndet BETWEEN 30 AND 200;",
            "sql_response": {
                "responses": {
                    "0": "-- Retrieve top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS\n  (SELECT o.*\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE p.class_name = 'AGN'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1 -- Limit to top 1000 based on probability\n\n   ORDER BY p.probability DESC\n   LIMIT 1000), -- Retrieve top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS\n  (SELECT o.*\n   FROM OBJECT o\n   JOIN probability p ON p.oid = o.oid\n   WHERE p.class_name = 'QSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.5\n     AND p.ranking = 1 -- Limit to top 1000 based on probability\n\n   ORDER BY p.probability DESC\n   LIMIT 1000) -- Select objects that are in both AGN and QSO candidate sets with detection counts between 30 and 200\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT agn.oid\n     FROM agn_candidates agn\n     JOIN qso_candidates qso ON agn.oid = qso.oid)\n  AND o.ndet BETWEEN 30 AND 200;"
                },
                "in_toks": 2528,
                "out_toks": 325,
                "id": "chatcmpl-BgyQlfsj4bMPh9OjfN2ppsPuXiXyp",
                "created": 1749581771,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS\n  (SELECT o.*\n   FROM OBJECT o\n   WHERE EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1 )\n   ORDER BY\n     (SELECT p.probability\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.class_name = 'AGN'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n      LIMIT 1) DESC\n   LIMIT 1000), -- Retrieve top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS\n  (SELECT o.*\n   FROM OBJECT o\n   WHERE EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'QSO'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 )\n   ORDER BY\n     (SELECT p.probability\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.class_name = 'QSO'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n      LIMIT 1) DESC\n   LIMIT 1000) -- Select objects that are in both AGN and QSO candidate sets with detection counts between 30 and 200\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT o1.oid\n     FROM agn_candidates o1\n     JOIN qso_candidates o2 ON o1.oid = o2.oid)\n  AND o.ndet BETWEEN 30 AND 200;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS\n  (SELECT o.*\n   FROM OBJECT o\n   WHERE EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1 )\n   ORDER BY\n     (SELECT p.probability\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.class_name = 'AGN'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n      LIMIT 1) DESC\n   LIMIT 1000), -- Retrieve top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS\n  (SELECT o.*\n   FROM OBJECT o\n   WHERE EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'QSO'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 )\n   ORDER BY\n     (SELECT p.probability\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.class_name = 'QSO'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n      LIMIT 1) DESC\n   LIMIT 1000) -- Select objects that are in both AGN and QSO candidate sets with detection counts between 30 and 200\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT o1.oid\n     FROM agn_candidates o1\n     JOIN qso_candidates o2 ON o1.oid = o2.oid)\n  AND o.ndet BETWEEN 30 AND 200;"
                },
                "in_toks": 3118,
                "out_toks": 438,
                "id": "chatcmpl-BgxwURukPNTKzKQDQLgMYgx4dQD3a",
                "created": 1749579894,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "38",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 804,
                "out_toks": 22,
                "id": "chatcmpl-BgxtZ29mG47j2qsR3EPEnNnVDdIhW",
                "created": 1749579713,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Optimized query to retrieve top 1000 AGN and QSO candidates with probability > 0.6 and 0.5 respectively,\n-- having between 30 and 200 detections, ordered by maximum probability.\nWITH candidate_probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.classifier_name,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top')\n     AND p.ranking = 1 -- Focus on the top-ranked probability per object\n\n     AND ((p.class_name = 'AGN'\n           AND p.probability > 0.6)\n          OR (p.class_name = 'QSO'\n              AND p.probability > 0.5)) ),\n     candidate_detection_counts AS\n  (SELECT d.oid,\n          COUNT(*) AS detection_count\n   FROM detection d\n   GROUP BY d.oid\n   HAVING COUNT(*) BETWEEN 30 AND 200),\n     filtered_candidates AS\n  (SELECT cp.oid\n   FROM candidate_probabilities cp\n   JOIN candidate_detection_counts dc ON cp.oid = dc.oid)\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM filtered_candidates)\n  AND EXISTS\n    (SELECT 1\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name IN ('QSO',\n                            'AGN')\n       AND p.classifier_name IN ('lc_classifier',\n                                 'lc_classifier_top')\n       AND p.ranking = 1\n       AND ((p.class_name = 'AGN'\n             AND p.probability > 0.6)\n            OR (p.class_name = 'QSO'\n                AND p.probability > 0.5)) )\nORDER BY\n  (SELECT MAX(p.probability)\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.class_name IN ('QSO',\n                          'AGN')\n     AND p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top') ) DESC\nLIMIT 1000;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized query to retrieve top 1000 AGN and QSO candidates with probability > 0.6 and 0.5 respectively,\n-- having between 30 and 200 detections, ordered by maximum probability.\nWITH candidate_probabilities AS\n  (SELECT p.oid,\n          p.class_name,\n          p.classifier_name,\n          p.probability,\n          p.ranking\n   FROM probability p\n   WHERE p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top')\n     AND p.ranking = 1 -- Focus on the top-ranked probability per object\n\n     AND ((p.class_name = 'AGN'\n           AND p.probability > 0.6)\n          OR (p.class_name = 'QSO'\n              AND p.probability > 0.5)) ),\n     candidate_detection_counts AS\n  (SELECT d.oid,\n          COUNT(*) AS detection_count\n   FROM detection d\n   GROUP BY d.oid\n   HAVING COUNT(*) BETWEEN 30 AND 200),\n     filtered_candidates AS\n  (SELECT cp.oid\n   FROM candidate_probabilities cp\n   JOIN candidate_detection_counts dc ON cp.oid = dc.oid)\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM filtered_candidates)\n  AND EXISTS\n    (SELECT 1\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name IN ('QSO',\n                            'AGN')\n       AND p.classifier_name IN ('lc_classifier',\n                                 'lc_classifier_top')\n       AND p.ranking = 1\n       AND ((p.class_name = 'AGN'\n             AND p.probability > 0.6)\n            OR (p.class_name = 'QSO'\n                AND p.probability > 0.5)) )\nORDER BY\n  (SELECT MAX(p.probability)\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.class_name IN ('QSO',\n                          'AGN')\n     AND p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top') ) DESC\nLIMIT 1000;"
                },
                "in_toks": 2346,
                "out_toks": 444,
                "id": "chatcmpl-BgyQo616nbaL1Z7tLzQmzvc514CwP",
                "created": 1749581774,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH agn_qso_candidates AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name IN ('QSO',\n                               'AGN')\n          AND p.classifier_name IN ('lc_classifier',\n                                    'lc_classifier_top')\n          AND p.probability > CASE\n                                  WHEN p.class_name = 'QSO' THEN 0.5\n                                  ELSE 0.6\n                              END )\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = o.oid\n        GROUP BY d.oid\n        HAVING COUNT(*) BETWEEN 30 AND 200) )\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM agn_qso_candidates)\n  AND EXISTS\n    (SELECT 1\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name IN ('QSO',\n                            'AGN')\n       AND p.classifier_name IN ('lc_classifier',\n                                 'lc_classifier_top')\n       AND p.probability > CASE\n                               WHEN p.class_name = 'QSO' THEN 0.5\n                               ELSE 0.6\n                           END )\nORDER BY\n  (SELECT MAX(p.probability)\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.class_name IN ('QSO',\n                          'AGN')\n     AND p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top') ) DESC\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH agn_qso_candidates AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name IN ('QSO',\n                               'AGN')\n          AND p.classifier_name IN ('lc_classifier',\n                                    'lc_classifier_top')\n          AND p.probability > CASE\n                                  WHEN p.class_name = 'QSO' THEN 0.5\n                                  ELSE 0.6\n                              END )\n     AND EXISTS\n       (SELECT 1\n        FROM detection d\n        WHERE d.oid = o.oid\n        GROUP BY d.oid\n        HAVING COUNT(*) BETWEEN 30 AND 200) )\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM agn_qso_candidates)\n  AND EXISTS\n    (SELECT 1\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name IN ('QSO',\n                            'AGN')\n       AND p.classifier_name IN ('lc_classifier',\n                                 'lc_classifier_top')\n       AND p.probability > CASE\n                               WHEN p.class_name = 'QSO' THEN 0.5\n                               ELSE 0.6\n                           END )\nORDER BY\n  (SELECT MAX(p.probability)\n   FROM probability p\n   WHERE p.oid = o.oid\n     AND p.class_name IN ('QSO',\n                          'AGN')\n     AND p.classifier_name IN ('lc_classifier',\n                               'lc_classifier_top') ) DESC\nLIMIT 1000;"
                },
                "in_toks": 3118,
                "out_toks": 324,
                "id": "chatcmpl-BgxwbjFvQ4usEmRTI6J7CoxZLQOWw",
                "created": 1749579901,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "24": {
        "0": {
            "req_id": "24",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 811,
                "out_toks": 21,
                "id": "chatcmpl-Bgxta30ppH2gS9wNAcart7kOxZyWM",
                "created": 1749579714,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Define the source data with their RA and Dec\nWITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)), -- Assign source_id, ra, dec from the source data\nobject_positions AS\n  (SELECT (row_number() OVER ())::text AS source_id, -- Generate a source_id for each row\n v.column2 AS ra,\n v.column3 AS dec\n   FROM\n     (SELECT *\n      FROM sources) AS v), -- Select objects within 10 degrees of each source and with first detection in the first 7 days of February\ncandidate_objects AS\n  (SELECT o.oid,\n          o.firstmjd\n   FROM OBJECT o\n   JOIN object_positions sp ON q3c_join(o.meanra, o.meandec, sp.ra, sp.dec, 10)\n   WHERE -- First detection within the first 7 days of February (Julian date 59976 to 59982)\n o.firstmjd BETWEEN 59976.0 AND 59982.0 ) -- Retrieve full object info for selected objects\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM candidate_objects);",
            "sql_response": {
                "responses": {
                    "0": "-- Define the source data with their RA and Dec\nWITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)), -- Assign source_id, ra, dec from the source data\nobject_positions AS\n  (SELECT (row_number() OVER ())::text AS source_id, -- Generate a source_id for each row\n v.column2 AS ra,\n v.column3 AS dec\n   FROM\n     (SELECT *\n      FROM sources) AS v), -- Select objects within 10 degrees of each source and with first detection in the first 7 days of February\ncandidate_objects AS\n  (SELECT o.oid,\n          o.firstmjd\n   FROM OBJECT o\n   JOIN object_positions sp ON q3c_join(o.meanra, o.meandec, sp.ra, sp.dec, 10)\n   WHERE -- First detection within the first 7 days of February (Julian date 59976 to 59982)\n o.firstmjd BETWEEN 59976.0 AND 59982.0 ) -- Retrieve full object info for selected objects\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM candidate_objects);"
                },
                "in_toks": 2176,
                "out_toks": 297,
                "id": "chatcmpl-BgyQv5DBvULiwhW7KvQemq5fS3PMZ",
                "created": 1749581781,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)),\n     object_positions AS\n  (SELECT source_id,\n          ra, dec\n   FROM sources),\n     candidate_objects AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.firstmjd - 59976.0 AS days_since_feb01\n   FROM OBJECT o\n   WHERE -- Select objects within 10 degrees of each source\n EXISTS\n       (SELECT 1\n        FROM object_positions sp\n        WHERE q3c_join(o.meanra, o.meandec, sp.ra, sp.dec, 10) )\n     AND -- First detection within the first 7 days of February\n o.firstmjd BETWEEN 59976.0 AND 59982.0 )\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM candidate_objects);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)),\n     object_positions AS\n  (SELECT source_id,\n          ra, dec\n   FROM sources),\n     candidate_objects AS\n  (SELECT o.oid,\n          o.firstmjd,\n          o.firstmjd - 59976.0 AS days_since_feb01\n   FROM OBJECT o\n   WHERE -- Select objects within 10 degrees of each source\n EXISTS\n       (SELECT 1\n        FROM object_positions sp\n        WHERE q3c_join(o.meanra, o.meandec, sp.ra, sp.dec, 10) )\n     AND -- First detection within the first 7 days of February\n o.firstmjd BETWEEN 59976.0 AND 59982.0 )\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT oid\n     FROM candidate_objects);"
                },
                "in_toks": 3154,
                "out_toks": 243,
                "id": "chatcmpl-BgxwiZlmOTqNqwsjM2cbqWAEpnDaH",
                "created": 1749579908,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "24",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 811,
                "out_toks": 21,
                "id": "chatcmpl-Bgxta30ppH2gS9wNAcart7kOxZyWM",
                "created": 1749579714,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)),\n     matched_objects AS\n  (SELECT o.*\n   FROM OBJECT o\n   JOIN sources s ON TRUE\n   WHERE -- Spatial query: objects within 10 degrees of each source\n EXISTS\n       (SELECT 1\n        FROM sources s2\n        WHERE q3c_join(o.meanra, o.meandec, s2.column2, s2.column3, 10) )\n     AND -- Temporal condition: first detection within the first 7 days of February (mjd 59976 to 59982)\n o.firstmjd BETWEEN 59976 AND 59982 )\nSELECT *\nFROM matched_objects;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sources AS (\n                 VALUES ('source_1',\n                         160.18301441363647,\n                         33.0164673528409), ('source_2',\n                                             174.21524897555543,\n                                             44.83789535222221)),\n     matched_objects AS\n  (SELECT o.*\n   FROM OBJECT o\n   JOIN sources s ON TRUE\n   WHERE -- Spatial query: objects within 10 degrees of each source\n EXISTS\n       (SELECT 1\n        FROM sources s2\n        WHERE q3c_join(o.meanra, o.meandec, s2.column2, s2.column3, 10) )\n     AND -- Temporal condition: first detection within the first 7 days of February (mjd 59976 to 59982)\n o.firstmjd BETWEEN 59976 AND 59982 )\nSELECT *\nFROM matched_objects;"
                },
                "in_toks": 5037,
                "out_toks": 187,
                "id": "chatcmpl-BgxwmegxjqE7RFVP98ZSckp3edEPo",
                "created": 1749579912,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "31": {
        "0": {
            "req_id": "31",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']",
                    "1": "['object', 'feature', 'probability']"
                },
                "in_toks": 783,
                "out_toks": 20,
                "id": "chatcmpl-BgxtbvUBDbUKpwFNbmYW33KwpxdaF",
                "created": 1749579715,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define a temporary table with the coordinates of the sources to cross-match\nWITH CATALOG (source_id,\n              ra, dec) AS (\n                           VALUES ('source1',\n                                   0.0,\n                                   0.0)-- Placeholder, replace or extend as needed\n) -- Select objects with their galactic coordinates, features, class name, and object ID\n\nSELECT -- Convert equatorial coordinates (ra, dec) to galactic coordinates (gal_b, gal_l)\n q3c_gal_b(object.meanra, object.meandec) AS gal_b,\n q3c_gal_l(object.meanra, object.meandec) AS gal_l,\n feature.*, -- All feature columns\n prob.class_name,\n object.oid\nFROM OBJECT\nJOIN feature ON feature.oid = object.oid\nJOIN probability prob ON prob.oid = object.oid\nWHERE -- Filter for the most probable class from the light curve classifier\n prob.classifier_name = 'lc_classifier'\n  AND prob.ranking = 1\n  AND -- Filter objects first detected between Feb 1 and Feb 2, 2023\n object.firstmjd BETWEEN 59976.0 AND 59978.0",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define a temporary table with the coordinates of the sources to cross-match\nWITH CATALOG (source_id,\n              ra, dec) AS (\n                           VALUES ('source1',\n                                   0.0,\n                                   0.0)-- Placeholder, replace or extend as needed\n) -- Select objects with their galactic coordinates, features, class name, and object ID\n\nSELECT -- Convert equatorial coordinates (ra, dec) to galactic coordinates (gal_b, gal_l)\n q3c_gal_b(object.meanra, object.meandec) AS gal_b,\n q3c_gal_l(object.meanra, object.meandec) AS gal_l,\n feature.*, -- All feature columns\n prob.class_name,\n object.oid\nFROM OBJECT\nJOIN feature ON feature.oid = object.oid\nJOIN probability prob ON prob.oid = object.oid\nWHERE -- Filter for the most probable class from the light curve classifier\n prob.classifier_name = 'lc_classifier'\n  AND prob.ranking = 1\n  AND -- Filter objects first detected between Feb 1 and Feb 2, 2023\n object.firstmjd BETWEEN 59976.0 AND 59978.0"
                },
                "in_toks": 5036,
                "out_toks": 264,
                "id": "chatcmpl-BgxwoaFvsN0OwNnuoSPkCkKkvgzDp",
                "created": 1749579914,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "31",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']",
                    "1": "['object', 'feature', 'probability']"
                },
                "in_toks": 783,
                "out_toks": 20,
                "id": "chatcmpl-BgxtbvUBDbUKpwFNbmYW33KwpxdaF",
                "created": 1749579715,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define a temporary table with the coordinates of the sources to cross-match\nWITH CATALOG (source_id,\n              ra, dec) AS (\n                           VALUES ('source1',\n                                   0.0,\n                                   0.0)-- Placeholder, replace or extend as needed\n) -- Select objects with their galactic coordinates, features, class name, and object ID\n\nSELECT obj.meanra,\n       obj.meandec, -- Convert equatorial coordinates to galactic coordinates\n -- Assuming the existence of a function to convert RA/Dec to galactic coordinates\n -- If such a function is not available, this part needs to be implemented or adjusted accordingly\n -- For illustration, assuming a function 'eq_to_gal' exists:\n eq_to_gal(obj.meanra, obj.meandec) AS (gal_l,\n                                        gal_b),\n feat.*,\n prob.class_name,\n obj.oid\nFROM OBJECT obj\nJOIN feature feat ON feat.oid = obj.oid\nJOIN probability prob ON prob.oid = obj.oid\nWHERE -- Filter for the most probable class with ranking=1\n prob.ranking = 1\n  AND prob.classifier_name = 'lc_classifier'\n  AND prob.classifier_version =\n    (SELECT MAX(classifier_version)\n     FROM probability p2\n     WHERE p2.oid = prob.oid\n       AND p2.classifier_name = 'lc_classifier' ) -- Filter objects first detected between February 1 and 2, 2023\n\n  AND obj.firstmjd BETWEEN 59976.0 AND 59978.0 -- Spatial cross-match with the catalog (if needed)\n\n  AND q3c_radial_query(obj.meanra, obj.meandec,\n                         (SELECT ra\n                          FROM CATALOG\n                          LIMIT 1),\n                         (SELECT dec\n                          FROM CATALOG\n                          LIMIT 1), 1.0);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define a temporary table with the coordinates of the sources to cross-match\nWITH CATALOG (source_id,\n              ra, dec) AS (\n                           VALUES ('source1',\n                                   0.0,\n                                   0.0)-- Placeholder, replace or extend as needed\n) -- Select objects with their galactic coordinates, features, class name, and object ID\n\nSELECT obj.meanra,\n       obj.meandec, -- Convert equatorial coordinates to galactic coordinates\n -- Assuming the existence of a function to convert RA/Dec to galactic coordinates\n -- If such a function is not available, this part needs to be implemented or adjusted accordingly\n -- For illustration, assuming a function 'eq_to_gal' exists:\n eq_to_gal(obj.meanra, obj.meandec) AS (gal_l,\n                                        gal_b),\n feat.*,\n prob.class_name,\n obj.oid\nFROM OBJECT obj\nJOIN feature feat ON feat.oid = obj.oid\nJOIN probability prob ON prob.oid = obj.oid\nWHERE -- Filter for the most probable class with ranking=1\n prob.ranking = 1\n  AND prob.classifier_name = 'lc_classifier'\n  AND prob.classifier_version =\n    (SELECT MAX(classifier_version)\n     FROM probability p2\n     WHERE p2.oid = prob.oid\n       AND p2.classifier_name = 'lc_classifier' ) -- Filter objects first detected between February 1 and 2, 2023\n\n  AND obj.firstmjd BETWEEN 59976.0 AND 59978.0 -- Spatial cross-match with the catalog (if needed)\n\n  AND q3c_radial_query(obj.meanra, obj.meandec,\n                         (SELECT ra\n                          FROM CATALOG\n                          LIMIT 1),\n                         (SELECT dec\n                          FROM CATALOG\n                          LIMIT 1), 1.0);"
                },
                "in_toks": 5036,
                "out_toks": 394,
                "id": "chatcmpl-BgxwsFbOXZlg4nL4htcnpjQlvmYet",
                "created": 1749579918,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "33": {
        "0": {
            "req_id": "33",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']",
                    "1": "['object', 'detection']"
                },
                "in_toks": 854,
                "out_toks": 14,
                "id": "chatcmpl-BgxtbTlWi9QT8G2nktoVRARts29YT",
                "created": 1749579715,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\n\nSELECT d.oid,\n       d.candid,\n       d.mjd,\n       d.fid,\n       d.magpsf\nFROM detection d\nWHERE d.oid IN ('ZTF21aaqosfj',\n                'ZTF21aaqoski',\n                'ZTF21aaqoskz',\n                'ZTF21aaqosly',\n                'ZTF21aaqosmj',\n                'ZTF21aaqosmi',\n                'ZTF21aaqosmk',\n                'ZTF21aaqosmm',\n                'ZTF21aaqosmp',\n                'ZTF21aaqosmq');",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\n\nSELECT d.oid,\n       d.candid,\n       d.mjd,\n       d.fid,\n       d.magpsf\nFROM detection d\nWHERE d.oid IN ('ZTF21aaqosfj',\n                'ZTF21aaqoski',\n                'ZTF21aaqoskz',\n                'ZTF21aaqosly',\n                'ZTF21aaqosmj',\n                'ZTF21aaqosmi',\n                'ZTF21aaqosmk',\n                'ZTF21aaqosmm',\n                'ZTF21aaqosmp',\n                'ZTF21aaqosmq');"
                },
                "in_toks": 2984,
                "out_toks": 159,
                "id": "chatcmpl-Bgxwy7r9UUCzKF2M6p9VsoCwqargb",
                "created": 1749579924,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "33",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']",
                    "1": "['object', 'detection']"
                },
                "in_toks": 854,
                "out_toks": 14,
                "id": "chatcmpl-BgxtbTlWi9QT8G2nktoVRARts29YT",
                "created": 1749579715,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\n\nSELECT d.oid,\n       d.candid,\n       d.mjd,\n       d.fid,\n       d.magpsf\nFROM detection d\nWHERE d.oid IN ('ZTF21aaqosfj',\n                'ZTF21aaqoski',\n                'ZTF21aaqoskz',\n                'ZTF21aaqosly',\n                'ZTF21aaqosmj',\n                'ZTF21aaqosmi',\n                'ZTF21aaqosmk',\n                'ZTF21aaqosmm',\n                'ZTF21aaqosmp',\n                'ZTF21aaqosmq');",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\n\nSELECT d.oid,\n       d.candid,\n       d.mjd,\n       d.fid,\n       d.magpsf\nFROM detection d\nWHERE d.oid IN ('ZTF21aaqosfj',\n                'ZTF21aaqoski',\n                'ZTF21aaqoskz',\n                'ZTF21aaqosly',\n                'ZTF21aaqosmj',\n                'ZTF21aaqosmi',\n                'ZTF21aaqosmk',\n                'ZTF21aaqosmm',\n                'ZTF21aaqosmp',\n                'ZTF21aaqosmq');"
                },
                "in_toks": 2984,
                "out_toks": 146,
                "id": "chatcmpl-Bgxx0PHvDz18V0Y7sRiaUIgn2pt1p",
                "created": 1749579926,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "6": {
        "0": {
            "req_id": "6",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 837,
                "out_toks": 22,
                "id": "chatcmpl-BgxtcvaHNyIk4fQu4qSrU9LSI4Iic",
                "created": 1749579716,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and error analysis\nWITH sn2_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n     AND o.ndet > 30 ),\n     candidate_ids AS\n  (SELECT DISTINCT c.candid\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects) ),\n     light_curve AS\n  (SELECT c.oid,\n          c.candid,\n          c.mjd,\n          c.magpsf,\n          c.sigmapsf,\n          c.fid AS f_id\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND c.mjd BETWEEN 58484.0 AND 59944.0 ),\n     rise_rates AS\n  (SELECT lc1.oid,\n          lc1.candid, -- Use lc1.mjd as start time\n lc1.mjd AS mjd1,\n lc1.magpsf AS mag1, -- Use lc2.mjd as end time\n lc2.mjd AS mjd2,\n lc2.magpsf AS mag2, -- Calculate rise rate as change in magnitude over change in time\n (lc2.magpsf - lc1.magpsf) / (lc2.mjd - lc1.mjd) AS rise_rate\n   FROM light_curve lc1\n   JOIN light_curve lc2 ON lc1.oid = lc2.oid\n   AND lc1.candid = lc2.candid\n   WHERE lc2.mjd > lc1.mjd ),\n     initial_rise AS\n  (SELECT oid,\n          candid, -- Find earliest detection time for each object-candidate pair\n MIN(mjd1) AS start_mjd, -- Find latest detection time for each object-candidate pair\n MAX(mjd2) AS end_mjd, -- Compute average rise rate for positive rise rates\n AVG(rise_rate) FILTER (\n                        WHERE rise_rate > 0) AS avg_rise_rate\n   FROM rise_rates\n   GROUP BY oid,\n            candid),\n     filtered_detections AS\n  (SELECT c.*\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND c.mjd BETWEEN 58484.0 AND 59944.0 )\nSELECT c.oid,\n       c.candid,\n       c.mjd,\n       c.magpsf,\n       c.sigmapsf,\n       c.f_id\nFROM filtered_detections c\nJOIN initial_rise ir ON c.oid = ir.oid\nAND c.candid = ir.candid\nWHERE ir.avg_rise_rate > 0.5\n  AND c.f_id IN (1,\n                 2)\n  AND c.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.ndet >= 100);",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and error analysis\nWITH sn2_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n     AND o.ndet > 30 ),\n     candidate_ids AS\n  (SELECT DISTINCT c.candid\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects) ),\n     light_curve AS\n  (SELECT c.oid,\n          c.candid,\n          c.mjd,\n          c.magpsf,\n          c.sigmapsf,\n          c.fid AS f_id\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND c.mjd BETWEEN 58484.0 AND 59944.0 ),\n     rise_rates AS\n  (SELECT lc1.oid,\n          lc1.candid, -- Use lc1.mjd as start time\n lc1.mjd AS mjd1,\n lc1.magpsf AS mag1, -- Use lc2.mjd as end time\n lc2.mjd AS mjd2,\n lc2.magpsf AS mag2, -- Calculate rise rate as change in magnitude over change in time\n (lc2.magpsf - lc1.magpsf) / (lc2.mjd - lc1.mjd) AS rise_rate\n   FROM light_curve lc1\n   JOIN light_curve lc2 ON lc1.oid = lc2.oid\n   AND lc1.candid = lc2.candid\n   WHERE lc2.mjd > lc1.mjd ),\n     initial_rise AS\n  (SELECT oid,\n          candid, -- Find earliest detection time for each object-candidate pair\n MIN(mjd1) AS start_mjd, -- Find latest detection time for each object-candidate pair\n MAX(mjd2) AS end_mjd, -- Compute average rise rate for positive rise rates\n AVG(rise_rate) FILTER (\n                        WHERE rise_rate > 0) AS avg_rise_rate\n   FROM rise_rates\n   GROUP BY oid,\n            candid),\n     filtered_detections AS\n  (SELECT c.*\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND c.mjd BETWEEN 58484.0 AND 59944.0 )\nSELECT c.oid,\n       c.candid,\n       c.mjd,\n       c.magpsf,\n       c.sigmapsf,\n       c.f_id\nFROM filtered_detections c\nJOIN initial_rise ir ON c.oid = ir.oid\nAND c.candid = ir.candid\nWHERE ir.avg_rise_rate > 0.5\n  AND c.f_id IN (1,\n                 2)\n  AND c.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.ndet >= 100);"
                },
                "in_toks": 3008,
                "out_toks": 653,
                "id": "chatcmpl-BgyQzvtILWVyoB9s5KLPQpM8USSpQ",
                "created": 1749581785,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn2_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n     AND o.ndet > 30 ),\n     candidate_ids AS\n  (SELECT DISTINCT c.candid\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects) ),\n     light_curve AS\n  (SELECT c.oid,\n          c.candid,\n          c.mjd,\n          c.magpsf,\n          c.sigmapsf,\n          c.fid AS f_id\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND c.mjd BETWEEN 58484.0 AND 59944.0 ),\n     rise_rates AS\n  (SELECT lc1.oid,\n          lc1.candid,\n          lc1.mjd AS mjd1,\n          lc1.magpsf AS mag1,\n          lc2.mjd AS mjd2,\n          lc2.magpsf AS mag2,\n          (lc2.magpsf - lc1.magpsf) / (lc2.mjd - lc1.mjd) AS rise_rate\n   FROM light_curve lc1\n   JOIN light_curve lc2 ON lc1.oid = lc2.oid\n   AND lc1.candid = lc2.candid\n   WHERE lc2.mjd > lc1.mjd ),\n     initial_rise AS\n  (SELECT oid,\n          candid,\n          MIN(mjd) AS start_mjd,\n          MAX(mjd) AS end_mjd,\n          AVG(rise_rate) FILTER (\n                                 WHERE rise_rate > 0) AS avg_rise_rate\n   FROM rise_rates\n   GROUP BY oid,\n            candid),\n     filtered_detections AS\n  (SELECT c.*\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND c.mjd BETWEEN 58484.0 AND 59944.0 )\nSELECT c.oid,\n       c.candid,\n       c.mjd,\n       c.magpsf,\n       c.sigmapsf,\n       c.f_id\nFROM filtered_detections c\nJOIN initial_rise ir ON c.oid = ir.oid\nAND c.candid = ir.candid\nWHERE ir.avg_rise_rate > 0.5\n  AND c.f_id IN (1,\n                 2)\n  AND c.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.ndet >= 100 );",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn2_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n     AND o.ndet > 30 ),\n     candidate_ids AS\n  (SELECT DISTINCT c.candid\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects) ),\n     light_curve AS\n  (SELECT c.oid,\n          c.candid,\n          c.mjd,\n          c.magpsf,\n          c.sigmapsf,\n          c.fid AS f_id\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND c.mjd BETWEEN 58484.0 AND 59944.0 ),\n     rise_rates AS\n  (SELECT lc1.oid,\n          lc1.candid,\n          lc1.mjd AS mjd1,\n          lc1.magpsf AS mag1,\n          lc2.mjd AS mjd2,\n          lc2.magpsf AS mag2,\n          (lc2.magpsf - lc1.magpsf) / (lc2.mjd - lc1.mjd) AS rise_rate\n   FROM light_curve lc1\n   JOIN light_curve lc2 ON lc1.oid = lc2.oid\n   AND lc1.candid = lc2.candid\n   WHERE lc2.mjd > lc1.mjd ),\n     initial_rise AS\n  (SELECT oid,\n          candid,\n          MIN(mjd) AS start_mjd,\n          MAX(mjd) AS end_mjd,\n          AVG(rise_rate) FILTER (\n                                 WHERE rise_rate > 0) AS avg_rise_rate\n   FROM rise_rates\n   GROUP BY oid,\n            candid),\n     filtered_detections AS\n  (SELECT c.*\n   FROM detection c\n   WHERE c.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND c.mjd BETWEEN 58484.0 AND 59944.0 )\nSELECT c.oid,\n       c.candid,\n       c.mjd,\n       c.magpsf,\n       c.sigmapsf,\n       c.f_id\nFROM filtered_detections c\nJOIN initial_rise ir ON c.oid = ir.oid\nAND c.candid = ir.candid\nWHERE ir.avg_rise_rate > 0.5\n  AND c.f_id IN (1,\n                 2)\n  AND c.oid IN\n    (SELECT o.oid\n     FROM OBJECT o\n     WHERE o.ndet >= 100 );"
                },
                "in_toks": 3189,
                "out_toks": 577,
                "id": "chatcmpl-Bgxx4tCV9CLJCevqP1XjrAqTKpJiq",
                "created": 1749579930,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "6",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 837,
                "out_toks": 22,
                "id": "chatcmpl-BgxtcvaHNyIk4fQu4qSrU9LSI4Iic",
                "created": 1749579716,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Optimized and corrected SQL query with nested subqueries to improve performance and ensure proper filtering\nWITH sn2_objects AS\n  (-- Select objects classified as SN II with high probability and ranking 1\n SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n     AND o.ndet > 30 ),\n     rise_rates AS\n  (-- Calculate initial rise rates between pairs of detections in g and r bands within 100 days\n SELECT d1.oid,\n        (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS rise_rate,\n        d1.mjd AS start_mjd,\n        d2.mjd AS end_mjd\n   FROM detection d1\n   JOIN detection d2 ON d1.oid = d2.oid\n   WHERE d1.fid IN (1,\n                    2)\n     AND d2.fid IN (1,\n                    2) -- g and r bands\n\n     AND d1.mjd < d2.mjd\n     AND d2.mjd - d1.mjd <= 100 -- initial rise period limit\n\n     AND d1.magpsf IS NOT NULL\n     AND d2.magpsf IS NOT NULL ),\n     initial_rise AS\n  (-- Select objects with average rise rate > 0.5 mag/day\n SELECT oid,\n        AVG(rise_rate) AS avg_rise_rate\n   FROM rise_rates\n   GROUP BY oid\n   HAVING AVG(rise_rate) > 0.5),\n     object_observations AS\n  (-- Gather detection data for objects of interest within the date range\n SELECT d.oid,\n        d.candid,\n        d.mjd,\n        d.fid AS f_id,\n        d.magpsf,\n        d.sigmapsf,\n        o.firstmjd,\n        o.lastmjd\n   FROM detection d\n   JOIN OBJECT o ON d.oid = o.oid\n   WHERE o.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND d.mjd BETWEEN 58484.0 AND 59944.0 ) -- Final selection of detection data with relevant properties\n\nSELECT oo.oid,\n       oo.candid AS candidate_id,\n       oo.magpsf,\n       oo.sigmapsf,\n       oo.f_id AS band,\n       oo.mjd AS TIME\nFROM object_observations oo\nJOIN initial_rise ir ON oo.oid = ir.oid\nORDER BY oo.oid,\n         oo.mjd;",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized and corrected SQL query with nested subqueries to improve performance and ensure proper filtering\nWITH sn2_objects AS\n  (-- Select objects classified as SN II with high probability and ranking 1\n SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n     AND o.ndet > 30 ),\n     rise_rates AS\n  (-- Calculate initial rise rates between pairs of detections in g and r bands within 100 days\n SELECT d1.oid,\n        (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS rise_rate,\n        d1.mjd AS start_mjd,\n        d2.mjd AS end_mjd\n   FROM detection d1\n   JOIN detection d2 ON d1.oid = d2.oid\n   WHERE d1.fid IN (1,\n                    2)\n     AND d2.fid IN (1,\n                    2) -- g and r bands\n\n     AND d1.mjd < d2.mjd\n     AND d2.mjd - d1.mjd <= 100 -- initial rise period limit\n\n     AND d1.magpsf IS NOT NULL\n     AND d2.magpsf IS NOT NULL ),\n     initial_rise AS\n  (-- Select objects with average rise rate > 0.5 mag/day\n SELECT oid,\n        AVG(rise_rate) AS avg_rise_rate\n   FROM rise_rates\n   GROUP BY oid\n   HAVING AVG(rise_rate) > 0.5),\n     object_observations AS\n  (-- Gather detection data for objects of interest within the date range\n SELECT d.oid,\n        d.candid,\n        d.mjd,\n        d.fid AS f_id,\n        d.magpsf,\n        d.sigmapsf,\n        o.firstmjd,\n        o.lastmjd\n   FROM detection d\n   JOIN OBJECT o ON d.oid = o.oid\n   WHERE o.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND d.mjd BETWEEN 58484.0 AND 59944.0 ) -- Final selection of detection data with relevant properties\n\nSELECT oo.oid,\n       oo.candid AS candidate_id,\n       oo.magpsf,\n       oo.sigmapsf,\n       oo.f_id AS band,\n       oo.mjd AS TIME\nFROM object_observations oo\nJOIN initial_rise ir ON oo.oid = ir.oid\nORDER BY oo.oid,\n         oo.mjd;"
                },
                "in_toks": 2707,
                "out_toks": 586,
                "id": "chatcmpl-BgyR73FGf0I2dO2t4ULEnmEhUs2sP",
                "created": 1749581793,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn2_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n     AND o.ndet > 30 ),\n     rise_rates AS\n  (SELECT d1.oid,\n          (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS rise_rate,\n          d1.mjd AS start_mjd,\n          d2.mjd AS end_mjd\n   FROM detection d1\n   JOIN detection d2 ON d1.oid = d2.oid\n   WHERE d1.fid IN (1,\n                    2) -- g and r bands\n\n     AND d2.fid IN (1,\n                    2)\n     AND d1.mjd < d2.mjd\n     AND d2.mjd - d1.mjd <= 100 -- limit to initial rise period\n\n     AND d1.magpsf IS NOT NULL\n     AND d2.magpsf IS NOT NULL ),\n     initial_rise AS\n  (SELECT oid,\n          AVG(rise_rate) AS avg_rise_rate\n   FROM rise_rates\n   GROUP BY oid\n   HAVING AVG(rise_rate) > 0.5),\n     object_observations AS\n  (SELECT d.oid,\n          d.candid,\n          d.mjd,\n          d.fid AS f_id,\n          d.magpsf,\n          d.sigmapsf,\n          o.firstmjd,\n          o.lastmjd\n   FROM detection d\n   JOIN OBJECT o ON d.oid = o.oid\n   WHERE o.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND d.mjd BETWEEN 58484.0 AND 59944.0 )\nSELECT oo.oid,\n       oo.candid AS candidate_id,\n       oo.magpsf,\n       oo.sigmapsf,\n       oo.f_id AS band,\n       oo.mjd AS TIME\nFROM object_observations oo\nJOIN initial_rise ir ON oo.oid = ir.oid\nORDER BY oo.oid,\n         oo.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn2_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   WHERE p.class_name = 'SNII'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.6\n     AND p.ranking = 1\n     AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n     AND o.ndet > 30 ),\n     rise_rates AS\n  (SELECT d1.oid,\n          (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS rise_rate,\n          d1.mjd AS start_mjd,\n          d2.mjd AS end_mjd\n   FROM detection d1\n   JOIN detection d2 ON d1.oid = d2.oid\n   WHERE d1.fid IN (1,\n                    2) -- g and r bands\n\n     AND d2.fid IN (1,\n                    2)\n     AND d1.mjd < d2.mjd\n     AND d2.mjd - d1.mjd <= 100 -- limit to initial rise period\n\n     AND d1.magpsf IS NOT NULL\n     AND d2.magpsf IS NOT NULL ),\n     initial_rise AS\n  (SELECT oid,\n          AVG(rise_rate) AS avg_rise_rate\n   FROM rise_rates\n   GROUP BY oid\n   HAVING AVG(rise_rate) > 0.5),\n     object_observations AS\n  (SELECT d.oid,\n          d.candid,\n          d.mjd,\n          d.fid AS f_id,\n          d.magpsf,\n          d.sigmapsf,\n          o.firstmjd,\n          o.lastmjd\n   FROM detection d\n   JOIN OBJECT o ON d.oid = o.oid\n   WHERE o.oid IN\n       (SELECT oid\n        FROM sn2_objects)\n     AND d.mjd BETWEEN 58484.0 AND 59944.0 )\nSELECT oo.oid,\n       oo.candid AS candidate_id,\n       oo.magpsf,\n       oo.sigmapsf,\n       oo.f_id AS band,\n       oo.mjd AS TIME\nFROM object_observations oo\nJOIN initial_rise ir ON oo.oid = ir.oid\nORDER BY oo.oid,\n         oo.mjd;"
                },
                "in_toks": 3189,
                "out_toks": 505,
                "id": "chatcmpl-BgxxBiS9jnwpCcnSScAru4mfbaw3q",
                "created": 1749579937,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "21": {
        "0": {
            "req_id": "21",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 812,
                "out_toks": 20,
                "id": "chatcmpl-Bgxtc2JICyhIr3PLkzlVMm61pr7Nw",
                "created": 1749579716,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select object information for sources classified as AGN, QSO, or Blazar\nWITH selected_objects AS\n  (SELECT o.*\n   FROM OBJECT o\n   WHERE -- Filter objects with at least 30 detections\n o.ndet >= 30\n     AND -- Filter objects with a time span between first and last detection >= 200 days\n (o.lastmjd - o.firstmjd) >= 200\n     AND -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in the lc_classifier\n EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name IN ('QSO',\n                               'AGN',\n                               'Blazar')\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.5 ) )\nSELECT *\nFROM selected_objects;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select object information for sources classified as AGN, QSO, or Blazar\nWITH selected_objects AS\n  (SELECT o.*\n   FROM OBJECT o\n   WHERE -- Filter objects with at least 30 detections\n o.ndet >= 30\n     AND -- Filter objects with a time span between first and last detection >= 200 days\n (o.lastmjd - o.firstmjd) >= 200\n     AND -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in the lc_classifier\n EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name IN ('QSO',\n                               'AGN',\n                               'Blazar')\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.5 ) )\nSELECT *\nFROM selected_objects;"
                },
                "in_toks": 5010,
                "out_toks": 198,
                "id": "chatcmpl-BgxxIIXYT9CqXanTtu5iKMZO7vnVY",
                "created": 1749579944,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "21",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 812,
                "out_toks": 20,
                "id": "chatcmpl-Bgxtc2JICyhIr3PLkzlVMm61pr7Nw",
                "created": 1749579716,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH classified_objects AS\n  (SELECT o.*\n   FROM OBJECT o\n   WHERE EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name IN ('AGN',\n                               'QSO',\n                               'Blazar')\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.5 )\n     AND o.ndet >= 30\n     AND (o.lastmjd - o.firstmjd) >= 200 )\nSELECT *\nFROM classified_objects;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH classified_objects AS\n  (SELECT o.*\n   FROM OBJECT o\n   WHERE EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name IN ('AGN',\n                               'QSO',\n                               'Blazar')\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.5 )\n     AND o.ndet >= 30\n     AND (o.lastmjd - o.firstmjd) >= 200 )\nSELECT *\nFROM classified_objects;"
                },
                "in_toks": 5010,
                "out_toks": 143,
                "id": "chatcmpl-BgxxLdqYV1dI5sijXSk8LNIw8T6Zc",
                "created": 1749579947,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "26": {
        "0": {
            "req_id": "26",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 780,
                "out_toks": 22,
                "id": "chatcmpl-BgxtdLwCkd7YlQKo1uK36WB3CoL5t",
                "created": 1749579717,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH object_time_filtered AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE firstmjd BETWEEN 59816.0 AND 59832.0 )\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to find objects classified as supernova with probability > 0.5 by stamp classifier\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.probability > 0.5\n       AND p.oid IN\n         (SELECT oid\n          FROM object_time_filtered) )\n  OR o.oid IN\n    (-- Subquery to find objects with more than one detection\n SELECT oid\n     FROM detection\n     GROUP BY oid\n     HAVING COUNT(*) > 1)",
            "original_sql_response": {
                "responses": {
                    "0": "WITH object_time_filtered AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE firstmjd BETWEEN 59816.0 AND 59832.0 )\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (-- Subquery to find objects classified as supernova with probability > 0.5 by stamp classifier\n SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.probability > 0.5\n       AND p.oid IN\n         (SELECT oid\n          FROM object_time_filtered) )\n  OR o.oid IN\n    (-- Subquery to find objects with more than one detection\n SELECT oid\n     FROM detection\n     GROUP BY oid\n     HAVING COUNT(*) > 1)"
                },
                "in_toks": 3128,
                "out_toks": 172,
                "id": "chatcmpl-BgxxN1JWZxFBNWnkRYaWQavOyhpIQ",
                "created": 1749579949,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "26",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 780,
                "out_toks": 22,
                "id": "chatcmpl-BgxtdLwCkd7YlQKo1uK36WB3CoL5t",
                "created": 1749579717,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0 ) -- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT fo.oid\n     FROM filtered_objects fo\n     WHERE EXISTS\n         (SELECT 1\n          FROM probability p\n          WHERE p.oid = fo.oid\n            AND p.class_name = 'SN'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.probability > 0.5 )\n     UNION -- Or objects with more than one detection\n SELECT fo.oid\n     FROM filtered_objects fo\n     WHERE\n         (SELECT COUNT(*)\n          FROM detection d\n          WHERE d.oid = fo.oid ) > 1 );",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS\n  (SELECT o.oid\n   FROM OBJECT o\n   WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0 ) -- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\n\nSELECT o.*\nFROM OBJECT o\nWHERE o.oid IN\n    (SELECT fo.oid\n     FROM filtered_objects fo\n     WHERE EXISTS\n         (SELECT 1\n          FROM probability p\n          WHERE p.oid = fo.oid\n            AND p.class_name = 'SN'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.probability > 0.5 )\n     UNION -- Or objects with more than one detection\n SELECT fo.oid\n     FROM filtered_objects fo\n     WHERE\n         (SELECT COUNT(*)\n          FROM detection d\n          WHERE d.oid = fo.oid ) > 1 );"
                },
                "in_toks": 3128,
                "out_toks": 234,
                "id": "chatcmpl-BgxxRio3d1DuR32R5bttMkDp4RdsI",
                "created": 1749579953,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "29": {
        "0": {
            "req_id": "29",
            "experiment_id": "run_0",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']",
                    "1": "['ps1_ztf']"
                },
                "in_toks": 840,
                "out_toks": 14,
                "id": "chatcmpl-Bgxtdn05HsFpnXfio7pWSSJmzQI5H",
                "created": 1749579717,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select specific columns from ps1_ztf for given oids\n\nSELECT oid,\n       sgmag1,\n       srmag1,\n       simag1,\n       szmag1,\n       sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv',\n              'ZTF21aasqvza',\n              'ZTF19adcftfw',\n              'ZTF19aaxqrku',\n              'ZTF19adceucq');",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select specific columns from ps1_ztf for given oids\n\nSELECT oid,\n       sgmag1,\n       srmag1,\n       simag1,\n       szmag1,\n       sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv',\n              'ZTF21aasqvza',\n              'ZTF19adcftfw',\n              'ZTF19aaxqrku',\n              'ZTF19adceucq');"
                },
                "in_toks": 2694,
                "out_toks": 104,
                "id": "chatcmpl-BgxxUiSVmehwRbnGP1HDlIoI0oDID",
                "created": 1749579956,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "29",
            "experiment_id": "run_1",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']",
                    "1": "['ps1_ztf']"
                },
                "in_toks": 840,
                "out_toks": 14,
                "id": "chatcmpl-Bgxtdn05HsFpnXfio7pWSSJmzQI5H",
                "created": 1749579717,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select specified columns from ps1_ztf for given list of oids\n\nSELECT oid,\n       sgmag1,\n       srmag1,\n       simag1,\n       szmag1,\n       sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv',\n              'ZTF21aasqvza',\n              'ZTF19adcftfw',\n              'ZTF19aaxqrku',\n              'ZTF19adceucq');",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select specified columns from ps1_ztf for given list of oids\n\nSELECT oid,\n       sgmag1,\n       srmag1,\n       simag1,\n       szmag1,\n       sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv',\n              'ZTF21aasqvza',\n              'ZTF19adcftfw',\n              'ZTF19aaxqrku',\n              'ZTF19adceucq');"
                },
                "in_toks": 2694,
                "out_toks": 106,
                "id": "chatcmpl-BgxxWLPzBU94qnhmXqfzzcJ2gWpkx",
                "created": 1749579958,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "52": {
        "0": {
            "req_id": "52",
            "experiment_id": "run_0",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 788,
                "out_toks": 12,
                "id": "chatcmpl-BgxtejHMVGjCv0HzZTgauZKoAQZPz",
                "created": 1749579718,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\n\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu',\n              'ZTF22abpxoyy')\n  AND procstatus = '0';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\n\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu',\n              'ZTF22abpxoyy')\n  AND procstatus = '0';"
                },
                "in_toks": 2581,
                "out_toks": 58,
                "id": "chatcmpl-BgxxY54CFKgi6t9F4IOGxturap9Zt",
                "created": 1749579960,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "52",
            "experiment_id": "run_1",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 788,
                "out_toks": 12,
                "id": "chatcmpl-BgxtejHMVGjCv0HzZTgauZKoAQZPz",
                "created": 1749579718,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\n\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu',\n              'ZTF22abpxoyy')\n  AND procstatus = '0';",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\n\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu',\n              'ZTF22abpxoyy')\n  AND procstatus = '0';"
                },
                "in_toks": 2581,
                "out_toks": 58,
                "id": "chatcmpl-BgxxZBW0rVIDQgfpjSc7uQHPW30FA",
                "created": 1749579961,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "109": {
        "0": {
            "req_id": "109",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']",
                    "1": "['object', 'feature', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 20,
                "id": "chatcmpl-BgxtgdhYETjqfVBnWSxaostZ0RxgM",
                "created": 1749579720,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select up to 10 objects where LinearTrend > 5 and the detection time span > 1 day\nWITH selected_objects AS\n  (SELECT o.oid,\n          o.ndet,\n          f.name AS feature_name,\n          f.value AS feature_value,\n          f.fid AS filter_id,\n          p.class_name,\n          p.classifier_version,\n          p.probability\n   FROM OBJECT o -- Filter objects with detection span > 1 day\n\n   WHERE (o.lastmjd - o.firstmjd) > 1 -- Join with feature table to get LinearTrend feature\n\n     JOIN feature f ON o.oid = f.oid\n     AND f.name = 'LinearTrend' -- Join with probability table to get top-ranked class (ranking=1)\n\n     JOIN probability p ON o.oid = p.oid\n     AND p.ranking = 1 -- Filter for LinearTrend > 5\n WHERE f.value > 5 ) -- Limit to 10 results\n\nSELECT oid AS \"ZTF Identifier\",\n       ndet AS \"Number of Detections\",\n       classifier_version AS \"Classifier Version\",\n       class_name AS \"Class\",\n       probability AS \"Probability\",\n       feature_value AS \"LinearTrend Value\",\n       filter_id AS \"Filter ID\"\nFROM selected_objects\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select up to 10 objects where LinearTrend > 5 and the detection time span > 1 day\nWITH selected_objects AS\n  (SELECT o.oid,\n          o.ndet,\n          f.name AS feature_name,\n          f.value AS feature_value,\n          f.fid AS filter_id,\n          p.class_name,\n          p.classifier_version,\n          p.probability\n   FROM OBJECT o -- Filter objects with detection span > 1 day\n\n   WHERE (o.lastmjd - o.firstmjd) > 1 -- Join with feature table to get LinearTrend feature\n\n     JOIN feature f ON o.oid = f.oid\n     AND f.name = 'LinearTrend' -- Join with probability table to get top-ranked class (ranking=1)\n\n     JOIN probability p ON o.oid = p.oid\n     AND p.ranking = 1 -- Filter for LinearTrend > 5\n WHERE f.value > 5 ) -- Limit to 10 results\n\nSELECT oid AS \"ZTF Identifier\",\n       ndet AS \"Number of Detections\",\n       classifier_version AS \"Classifier Version\",\n       class_name AS \"Class\",\n       probability AS \"Probability\",\n       feature_value AS \"LinearTrend Value\",\n       filter_id AS \"Filter ID\"\nFROM selected_objects\nLIMIT 10;"
                },
                "in_toks": 5025,
                "out_toks": 279,
                "id": "chatcmpl-BgxxbPS3dDO2OSHL2xrEJ59ipwXlv",
                "created": 1749579963,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "109",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']",
                    "1": "['object', 'feature', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 20,
                "id": "chatcmpl-BgxtgdhYETjqfVBnWSxaostZ0RxgM",
                "created": 1749579720,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with LinearTrend > 5 and delta between last and first detection > 1 day\nWITH filtered_objects AS\n  (SELECT o.oid,\n          o.ndet,\n          f.version AS feature_version,\n          f.name AS feature_name,\n          f.value AS feature_value,\n          f.fid AS filter_id\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'LinearTrend'\n     AND f.value > 5\n     AND (o.lastmjd - o.firstmjd) > 1 ) -- Retrieve the top 10 objects based on the criteria\n\nSELECT fo.oid AS ztf_identifier,\n       fo.ndet AS number_of_detections,\n       p.class_name AS classifier_class,\n       p.classifier_version,\n       p.probability,\n       fo.feature_version,\n       fo.feature_value,\n       fo.filter_id\nFROM filtered_objects fo\nJOIN probability p ON fo.oid = p.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = fo.feature_version\nORDER BY fo.feature_value DESC\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with LinearTrend > 5 and delta between last and first detection > 1 day\nWITH filtered_objects AS\n  (SELECT o.oid,\n          o.ndet,\n          f.version AS feature_version,\n          f.name AS feature_name,\n          f.value AS feature_value,\n          f.fid AS filter_id\n   FROM OBJECT o\n   JOIN feature f ON o.oid = f.oid\n   WHERE f.name = 'LinearTrend'\n     AND f.value > 5\n     AND (o.lastmjd - o.firstmjd) > 1 ) -- Retrieve the top 10 objects based on the criteria\n\nSELECT fo.oid AS ztf_identifier,\n       fo.ndet AS number_of_detections,\n       p.class_name AS classifier_class,\n       p.classifier_version,\n       p.probability,\n       fo.feature_version,\n       fo.feature_value,\n       fo.filter_id\nFROM filtered_objects fo\nJOIN probability p ON fo.oid = p.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = fo.feature_version\nORDER BY fo.feature_value DESC\nLIMIT 10;"
                },
                "in_toks": 5025,
                "out_toks": 251,
                "id": "chatcmpl-BgxxeFyJKjF0kthUBorId2IUc8p6K",
                "created": 1749579966,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "49": {
        "0": {
            "req_id": "49",
            "experiment_id": "run_0",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']",
                    "1": "['feature']"
                },
                "in_toks": 778,
                "out_toks": 6,
                "id": "chatcmpl-BgxtgJClSggK5EJxezvI5gLNokY20",
                "created": 1749579720,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all features in the 'feature' table for specified objects and g band\n\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm',\n              'ZTF20abxgxjd')\n  AND fid = 1; -- fid=1 corresponds to the g band",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all features in the 'feature' table for specified objects and g band\n\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm',\n              'ZTF20abxgxjd')\n  AND fid = 1; -- fid=1 corresponds to the g band"
                },
                "in_toks": 4310,
                "out_toks": 63,
                "id": "chatcmpl-BgxxiHE5pXXJrRy0HSlB9ChWPqDa4",
                "created": 1749579970,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "49",
            "experiment_id": "run_1",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']",
                    "1": "['feature']"
                },
                "in_toks": 778,
                "out_toks": 6,
                "id": "chatcmpl-BgxtgJClSggK5EJxezvI5gLNokY20",
                "created": 1749579720,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all features in the 'feature' table for specified objects and the g band (fid=1)\n\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm',\n              'ZTF20abxgxjd')\n  AND fid = 1;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all features in the 'feature' table for specified objects and the g band (fid=1)\n\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm',\n              'ZTF20abxgxjd')\n  AND fid = 1;"
                },
                "in_toks": 4310,
                "out_toks": 58,
                "id": "chatcmpl-BgxxjuTbdHed5G1FJcjJKLWYvvbZm",
                "created": 1749579971,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "46": {
        "0": {
            "req_id": "46",
            "experiment_id": "run_0",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']",
                    "1": "['detection']"
                },
                "in_toks": 767,
                "out_toks": 8,
                "id": "chatcmpl-BgxthVh3PMzxk5Eu1EEwzRHZhfr4k",
                "created": 1749579721,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;"
                },
                "in_toks": 2416,
                "out_toks": 28,
                "id": "chatcmpl-Bgxxk75Li7O8XpSaKdKRHVBHx8a6o",
                "created": 1749579972,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "46",
            "experiment_id": "run_1",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']",
                    "1": "['detection']"
                },
                "in_toks": 767,
                "out_toks": 8,
                "id": "chatcmpl-BgxthVh3PMzxk5Eu1EEwzRHZhfr4k",
                "created": 1749579721,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;"
                },
                "in_toks": 2416,
                "out_toks": 28,
                "id": "chatcmpl-BgxxloJqgM09YyAGa4lKqqghLslat",
                "created": 1749579973,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "93": {
        "0": {
            "req_id": "93",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat']",
                    "1": "['probability', 'magstat']"
                },
                "in_toks": 807,
                "out_toks": 16,
                "id": "chatcmpl-BgxthDKpxXmvqw3m8Ki7tYo7DbdlD",
                "created": 1749579721,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve object IDs where 'asteroid' is the top-ranked class in 'stamp_classifier'\nWITH top_asteroid_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'asteroid'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n   LIMIT 10) -- Select all columns from 'probability' and 'magstat' for these objects\n\nSELECT p.*,\n       m.*\nFROM probability p\nJOIN magstat m ON p.oid = m.oid\nWHERE p.oid IN\n    (SELECT oid\n     FROM top_asteroid_objects)\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve object IDs where 'asteroid' is the top-ranked class in 'stamp_classifier'\nWITH top_asteroid_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'asteroid'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n   LIMIT 10) -- Select all columns from 'probability' and 'magstat' for these objects\n\nSELECT p.*,\n       m.*\nFROM probability p\nJOIN magstat m ON p.oid = m.oid\nWHERE p.oid IN\n    (SELECT oid\n     FROM top_asteroid_objects)\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;"
                },
                "in_toks": 2808,
                "out_toks": 151,
                "id": "chatcmpl-BgxxnX4WTHEyZOffzhQjBWd4EoFU5",
                "created": 1749579975,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "93",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat']",
                    "1": "['probability', 'magstat']"
                },
                "in_toks": 807,
                "out_toks": 16,
                "id": "chatcmpl-BgxthDKpxXmvqw3m8Ki7tYo7DbdlD",
                "created": 1749579721,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve object IDs where 'asteroid' is the top-ranked class in 'stamp_classifier'\nWITH top_asteroid_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'asteroid'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n   LIMIT 10) -- Select all columns from 'probability' and 'magstat' for these objects\n\nSELECT p.*,\n       m.*\nFROM probability p\nJOIN magstat m ON p.oid = m.oid\nWHERE p.oid IN\n    (SELECT oid\n     FROM top_asteroid_objects)\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve object IDs where 'asteroid' is the top-ranked class in 'stamp_classifier'\nWITH top_asteroid_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'asteroid'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n   LIMIT 10) -- Select all columns from 'probability' and 'magstat' for these objects\n\nSELECT p.*,\n       m.*\nFROM probability p\nJOIN magstat m ON p.oid = m.oid\nWHERE p.oid IN\n    (SELECT oid\n     FROM top_asteroid_objects)\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;"
                },
                "in_toks": 2808,
                "out_toks": 151,
                "id": "chatcmpl-BgxxpYUfX6087DAhLAypHWU7zmWKI",
                "created": 1749579977,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "62": {
        "0": {
            "req_id": "62",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-BgxtiwbNtzB6fFH6N7bB14mg1zsPx",
                "created": 1749579722,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT p.oid,\n       p.classifier_name,\n       p.classifier_version,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM probability p\nWHERE p.oid = 'ZTF21aadoizf'\nORDER BY p.classifier_name ASC,\n         p.probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT p.oid,\n       p.classifier_name,\n       p.classifier_version,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM probability p\nWHERE p.oid = 'ZTF21aadoizf'\nORDER BY p.classifier_name ASC,\n         p.probability DESC;"
                },
                "in_toks": 2078,
                "out_toks": 78,
                "id": "chatcmpl-BgxxrXgqm7i8kO5be9Ft4DsBmMZF3",
                "created": 1749579979,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "62",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-BgxtiwbNtzB6fFH6N7bB14mg1zsPx",
                "created": 1749579722,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT p.oid,\n       p.classifier_name,\n       p.classifier_version,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM\n  (SELECT oid\n   FROM probability\n   WHERE oid = 'ZTF21aadoizf' ) AS sub\nJOIN probability p ON sub.oid = p.oid\nORDER BY p.classifier_name ASC,\n         p.probability DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT p.oid,\n       p.classifier_name,\n       p.classifier_version,\n       p.class_name,\n       p.probability,\n       p.ranking\nFROM\n  (SELECT oid\n   FROM probability\n   WHERE oid = 'ZTF21aadoizf' ) AS sub\nJOIN probability p ON sub.oid = p.oid\nORDER BY p.classifier_name ASC,\n         p.probability DESC;"
                },
                "in_toks": 2078,
                "out_toks": 92,
                "id": "chatcmpl-BgxxttaZgtXiedjB15F2XLlGu89UW",
                "created": 1749579981,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "95": {
        "0": {
            "req_id": "95",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "xmatch",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'feature']",
                    "1": "['object', 'xmatch', 'feature']"
                },
                "in_toks": 852,
                "out_toks": 20,
                "id": "chatcmpl-BgxtihjvZtVYuWKl7pH2ryWcIuYOe",
                "created": 1749579722,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\nWITH ztf_objects AS\n  (-- Select object IDs for the specified ZTF objects\n SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF19aazhdoy',\n                 'ZTF17aaaqqtd') ),\n     matches AS\n  (-- Retrieve all xmatch entries for these objects\n SELECT xm.oid AS ztf_oid,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist\n   FROM xmatch xm\n   JOIN ztf_objects zo ON xm.oid = zo.oid),\n     features AS\n  (-- Retrieve specified features for these objects with the given version\n SELECT f.oid,\n        f.name,\n        f.value\n   FROM feature f\n   WHERE f.version = 'lc_classifier_1.2.1-P'\n     AND f.name IN ('W1-W2',\n                    'g-W2',\n                    'r-W2')\n     AND f.oid IN\n       (SELECT oid\n        FROM ztf_objects) ) -- Join matches and features on object ID, and order results\n\nSELECT m.ztf_oid,\n       m.catid,\n       m.oid_catalog,\n       m.dist,\n       f.name AS feature_name,\n       f.value AS feature_value\nFROM matches m\nLEFT JOIN features f ON m.ztf_oid = f.oid\nORDER BY m.ztf_oid,\n         f.name;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\nWITH ztf_objects AS\n  (-- Select object IDs for the specified ZTF objects\n SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF19aazhdoy',\n                 'ZTF17aaaqqtd') ),\n     matches AS\n  (-- Retrieve all xmatch entries for these objects\n SELECT xm.oid AS ztf_oid,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist\n   FROM xmatch xm\n   JOIN ztf_objects zo ON xm.oid = zo.oid),\n     features AS\n  (-- Retrieve specified features for these objects with the given version\n SELECT f.oid,\n        f.name,\n        f.value\n   FROM feature f\n   WHERE f.version = 'lc_classifier_1.2.1-P'\n     AND f.name IN ('W1-W2',\n                    'g-W2',\n                    'r-W2')\n     AND f.oid IN\n       (SELECT oid\n        FROM ztf_objects) ) -- Join matches and features on object ID, and order results\n\nSELECT m.ztf_oid,\n       m.catid,\n       m.oid_catalog,\n       m.dist,\n       f.name AS feature_name,\n       f.value AS feature_value\nFROM matches m\nLEFT JOIN features f ON m.ztf_oid = f.oid\nORDER BY m.ztf_oid,\n         f.name;"
                },
                "in_toks": 4205,
                "out_toks": 290,
                "id": "chatcmpl-BgyRDn1okKGdUfcMcXbNyfPGOwYzz",
                "created": 1749581799,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve matches and features for specified ZTF objects, joining on object ID\nWITH ztf_objects AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF19aazhdoy',\n                 'ZTF17aaaqqtd') ),\n     matches AS\n  (SELECT xm.oid AS ztf_oid,\n          xm.catid,\n          xm.oid_catalog,\n          xm.dist\n   FROM xmatch xm\n   JOIN ztf_objects zo ON xm.oid = zo.oid),\n     features AS\n  (SELECT f.oid,\n          f.name,\n          f.value\n   FROM feature f\n   WHERE f.version = 'lc_classifier_1.2.1-P'\n     AND f.name IN ('W1-W2',\n                    'g-W2',\n                    'r-W2')\n     AND f.oid IN\n       (SELECT oid\n        FROM ztf_objects) ) -- Select combined results with sorting\n\nSELECT m.oid AS ztf_oid,\n       m.catid,\n       m.oid_catalog,\n       m.dist,\n       f.name AS feature_name,\n       f.value AS feature_value\nFROM matches m\nJOIN features f ON m.oid = f.oid\nORDER BY m.oid,\n         f.name;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve matches and features for specified ZTF objects, joining on object ID\nWITH ztf_objects AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF19aazhdoy',\n                 'ZTF17aaaqqtd') ),\n     matches AS\n  (SELECT xm.oid AS ztf_oid,\n          xm.catid,\n          xm.oid_catalog,\n          xm.dist\n   FROM xmatch xm\n   JOIN ztf_objects zo ON xm.oid = zo.oid),\n     features AS\n  (SELECT f.oid,\n          f.name,\n          f.value\n   FROM feature f\n   WHERE f.version = 'lc_classifier_1.2.1-P'\n     AND f.name IN ('W1-W2',\n                    'g-W2',\n                    'r-W2')\n     AND f.oid IN\n       (SELECT oid\n        FROM ztf_objects) ) -- Select combined results with sorting\n\nSELECT m.oid AS ztf_oid,\n       m.catid,\n       m.oid_catalog,\n       m.dist,\n       f.name AS feature_name,\n       f.value AS feature_value\nFROM matches m\nJOIN features f ON m.oid = f.oid\nORDER BY m.oid,\n         f.name;"
                },
                "in_toks": 4979,
                "out_toks": 253,
                "id": "chatcmpl-Bgxxv31caK32h2Noa9epQNKIexqDY",
                "created": 1749579983,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "95",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "xmatch",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'feature']",
                    "1": "['object', 'xmatch', 'feature']"
                },
                "in_toks": 852,
                "out_toks": 20,
                "id": "chatcmpl-BgxtihjvZtVYuWKl7pH2ryWcIuYOe",
                "created": 1749579722,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve matches and features for specified ZTF objects, joining on object ID\nWITH ztf_objects AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF19aazhdoy',\n                 'ZTF17aaaqqtd') ),\n     matches AS\n  (SELECT xm.oid,\n          xm.catid,\n          xm.oid_catalog,\n          xm.dist\n   FROM xmatch xm\n   JOIN ztf_objects zo ON xm.oid = zo.oid),\n     features AS\n  (SELECT f.oid,\n          f.name,\n          f.value\n   FROM feature f\n   WHERE f.oid IN\n       (SELECT oid\n        FROM ztf_objects)\n     AND f.version = 'lc_classifier_1.2.1-P'\n     AND f.name IN ('W1-W2',\n                    'g-W2',\n                    'r-W2') )\nSELECT m.oid AS ztf_identifier,\n       m.catid AS catalog_identifier,\n       m.oid_catalog AS catalog_object_id,\n       m.dist AS distance_arcsec,\n       f.name AS feature_name,\n       f.value AS feature_value\nFROM matches m\nJOIN features f ON m.oid = f.oid\nORDER BY m.oid,\n         f.name;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve matches and features for specified ZTF objects, joining on object ID\nWITH ztf_objects AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF19aazhdoy',\n                 'ZTF17aaaqqtd') ),\n     matches AS\n  (SELECT xm.oid,\n          xm.catid,\n          xm.oid_catalog,\n          xm.dist\n   FROM xmatch xm\n   JOIN ztf_objects zo ON xm.oid = zo.oid),\n     features AS\n  (SELECT f.oid,\n          f.name,\n          f.value\n   FROM feature f\n   WHERE f.oid IN\n       (SELECT oid\n        FROM ztf_objects)\n     AND f.version = 'lc_classifier_1.2.1-P'\n     AND f.name IN ('W1-W2',\n                    'g-W2',\n                    'r-W2') )\nSELECT m.oid AS ztf_identifier,\n       m.catid AS catalog_identifier,\n       m.oid_catalog AS catalog_object_id,\n       m.dist AS distance_arcsec,\n       f.name AS feature_name,\n       f.value AS feature_value\nFROM matches m\nJOIN features f ON m.oid = f.oid\nORDER BY m.oid,\n         f.name;"
                },
                "in_toks": 4979,
                "out_toks": 247,
                "id": "chatcmpl-Bgxxyw0nyhOxnYy9FODZmnOAY6apP",
                "created": 1749579986,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "85": {
        "0": {
            "req_id": "85",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'dataquality']",
                    "1": "['object', 'detection', 'dataquality']"
                },
                "in_toks": 795,
                "out_toks": 22,
                "id": "chatcmpl-BgxtiT9GhF7Xuq99d5pQPOPLDZCKz",
                "created": 1749579722,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all detections for the specified object, sorted by detection date\n\nSELECT d.mjd AS detection_date,\n       d.isdiffpos,\n       d.magpsf AS difference_magnitude,\n       d.sigmapsf AS magnitude_uncertainty,\n       dq.*\nFROM detection d\nJOIN dataquality dq ON d.candid = dq.candid\nAND d.oid = dq.oid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all detections for the specified object, sorted by detection date\n\nSELECT d.mjd AS detection_date,\n       d.isdiffpos,\n       d.magpsf AS difference_magnitude,\n       d.sigmapsf AS magnitude_uncertainty,\n       dq.*\nFROM detection d\nJOIN dataquality dq ON d.candid = dq.candid\nAND d.oid = dq.oid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;"
                },
                "in_toks": 3723,
                "out_toks": 112,
                "id": "chatcmpl-Bgxy1M8WWBaJrDR07OOsavmVWEh2a",
                "created": 1749579989,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "85",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'dataquality']",
                    "1": "['object', 'detection', 'dataquality']"
                },
                "in_toks": 795,
                "out_toks": 22,
                "id": "chatcmpl-BgxtiT9GhF7Xuq99d5pQPOPLDZCKz",
                "created": 1749579722,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve all detections for the specified object, sorted by detection date\n\nSELECT d.mjd AS detection_date,\n       d.isdiffpos,\n       d.magpsf AS difference_magnitude,\n       d.sigmapsf AS magnitude_uncertainty,\n       dq.*\nFROM detection d\nJOIN dataquality dq ON d.candid = dq.candid\nAND d.oid = dq.oid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve all detections for the specified object, sorted by detection date\n\nSELECT d.mjd AS detection_date,\n       d.isdiffpos,\n       d.magpsf AS difference_magnitude,\n       d.sigmapsf AS magnitude_uncertainty,\n       dq.*\nFROM detection d\nJOIN dataquality dq ON d.candid = dq.candid\nAND d.oid = dq.oid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;"
                },
                "in_toks": 3723,
                "out_toks": 112,
                "id": "chatcmpl-Bgxy3PNe62fBjU67ILEucZsgFMzzD",
                "created": 1749579991,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "98": {
        "0": {
            "req_id": "98",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'allwise']",
                    "1": "['object', 'probability', 'xmatch', 'allwise']"
                },
                "in_toks": 785,
                "out_toks": 30,
                "id": "chatcmpl-BgxtjF3ALhWdlJAcTN6ivWhFndsF3",
                "created": 1749579723,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Subquery to select up to 200 object IDs with probability > 0.7 of being a QSO in the lc_classifier\nWITH qso_objects AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.class_name = 'QSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.7\n   LIMIT 200) -- Main query to retrieve all columns from xmatch and allwise for these objects\n\nSELECT xm.*,\n       aw.*\nFROM xmatch xm\nLEFT JOIN allwise aw ON xm.oid_catalog = aw.oid_catalog\nWHERE xm.oid IN\n    (SELECT oid\n     FROM qso_objects);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Subquery to select up to 200 object IDs with probability > 0.7 of being a QSO in the lc_classifier\nWITH qso_objects AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.class_name = 'QSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.7\n   LIMIT 200) -- Main query to retrieve all columns from xmatch and allwise for these objects\n\nSELECT xm.*,\n       aw.*\nFROM xmatch xm\nLEFT JOIN allwise aw ON xm.oid_catalog = aw.oid_catalog\nWHERE xm.oid IN\n    (SELECT oid\n     FROM qso_objects);"
                },
                "in_toks": 3364,
                "out_toks": 145,
                "id": "chatcmpl-Bgxy564K6IIo2cOZE6gbtlmJzHtgz",
                "created": 1749579993,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "98",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'allwise']",
                    "1": "['object', 'probability', 'xmatch', 'allwise']"
                },
                "in_toks": 785,
                "out_toks": 30,
                "id": "chatcmpl-BgxtjF3ALhWdlJAcTN6ivWhFndsF3",
                "created": 1749579723,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Subquery to select up to 200 object IDs with probability > 0.7 of being a QSO in the lc_classifier\nWITH qso_objects AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.class_name = 'QSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.7\n   LIMIT 200) -- Main query to retrieve all columns from xmatch and allwise for these objects\n\nSELECT xm.*,\n       aw.*\nFROM xmatch xm\nJOIN allwise aw ON xm.oid_catalog = aw.oid_catalog\nWHERE xm.oid IN\n    (SELECT oid\n     FROM qso_objects);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Subquery to select up to 200 object IDs with probability > 0.7 of being a QSO in the lc_classifier\nWITH qso_objects AS\n  (SELECT DISTINCT p.oid\n   FROM probability p\n   WHERE p.class_name = 'QSO'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.7\n   LIMIT 200) -- Main query to retrieve all columns from xmatch and allwise for these objects\n\nSELECT xm.*,\n       aw.*\nFROM xmatch xm\nJOIN allwise aw ON xm.oid_catalog = aw.oid_catalog\nWHERE xm.oid IN\n    (SELECT oid\n     FROM qso_objects);"
                },
                "in_toks": 3364,
                "out_toks": 144,
                "id": "chatcmpl-Bgxy8v0SGSQ1R73QN8OwAw2cXXtGb",
                "created": 1749579996,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "82": {
        "0": {
            "req_id": "82",
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 786,
                "out_toks": 8,
                "id": "chatcmpl-BgxtkyxrgEf4oA9nJImb63pX0Y4go",
                "created": 1749579724,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8',\n                      'J072933.88+030810.4')\nORDER BY dist;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8',\n                      'J072933.88+030810.4')\nORDER BY dist;"
                },
                "in_toks": 2000,
                "out_toks": 42,
                "id": "chatcmpl-BgxyAH4GmdGlV38j890pmyPBuhp0K",
                "created": 1749579998,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "82",
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 786,
                "out_toks": 8,
                "id": "chatcmpl-BgxtkyxrgEf4oA9nJImb63pX0Y4go",
                "created": 1749579724,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8',\n                      'J072933.88+030810.4')\nORDER BY dist;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8',\n                      'J072933.88+030810.4')\nORDER BY dist;"
                },
                "in_toks": 2000,
                "out_toks": 42,
                "id": "chatcmpl-BgxyNkxdaAnoLTseM8ZmTgZTPY9aH",
                "created": 1749580011,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "64": {
        "0": {
            "req_id": "64",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-BgxtkBwOZNOTKwS13GmIQOjUDeruk",
                "created": 1749579724,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query to avoid timeout by filtering with explicit conditions and using a CTE for clarity\nWITH filtered_prob AS\n  (SELECT *\n   FROM probability\n   WHERE probability > 0.95\n     AND classifier_name IN ('lc_classifier_top',\n                             'stamp_classifier')\n     AND ranking = 1 -- Assuming we want the top-ranked class per classifier\n)\nSELECT p.oid AS \"ZTF identifier\",\n       p.classifier_name AS \"classifier name\",\n       p.classifier_version AS \"classifier version\",\n       p.class_name AS \"class name\",\n       p.probability AS \"probability\"\nFROM filtered_prob p\nORDER BY p.probability DESC\nLIMIT 1000;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query to avoid timeout by filtering with explicit conditions and using a CTE for clarity\nWITH filtered_prob AS\n  (SELECT *\n   FROM probability\n   WHERE probability > 0.95\n     AND classifier_name IN ('lc_classifier_top',\n                             'stamp_classifier')\n     AND ranking = 1 -- Assuming we want the top-ranked class per classifier\n)\nSELECT p.oid AS \"ZTF identifier\",\n       p.classifier_name AS \"classifier name\",\n       p.classifier_version AS \"classifier version\",\n       p.class_name AS \"class name\",\n       p.probability AS \"probability\"\nFROM filtered_prob p\nORDER BY p.probability DESC\nLIMIT 1000;"
                },
                "in_toks": 1010,
                "out_toks": 144,
                "id": "chatcmpl-BgyRG6RbKCdmo8keQft4h9kHeD2Xv",
                "created": 1749581802,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select up to 1000 probability entries with probability > 0.95\n\nSELECT p.oid AS \"ZTF identifier\",\n       p.classifier_name AS \"classifier name\",\n       p.classifier_version AS \"classifier version\",\n       p.class_name AS \"class name\",\n       p.probability AS \"probability\"\nFROM\n  (SELECT *\n   FROM probability\n   WHERE probability > 0.95\n     AND classifier_name IN ('lc_classifier_top',\n                             'stamp_classifier') ) p -- Order by probability descending to prioritize highest probabilities\nORDER BY p.probability DESC -- Limit to 1000 rows\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select up to 1000 probability entries with probability > 0.95\n\nSELECT p.oid AS \"ZTF identifier\",\n       p.classifier_name AS \"classifier name\",\n       p.classifier_version AS \"classifier version\",\n       p.class_name AS \"class name\",\n       p.probability AS \"probability\"\nFROM\n  (SELECT *\n   FROM probability\n   WHERE probability > 0.95\n     AND classifier_name IN ('lc_classifier_top',\n                             'stamp_classifier') ) p -- Order by probability descending to prioritize highest probabilities\nORDER BY p.probability DESC -- Limit to 1000 rows\nLIMIT 1000;"
                },
                "in_toks": 2083,
                "out_toks": 137,
                "id": "chatcmpl-BgxyQgHKBCkEj7OuljhezIBIUtoQh",
                "created": 1749580014,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "64",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-BgxtkBwOZNOTKwS13GmIQOjUDeruk",
                "created": 1749579724,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query to retrieve up to 1000 entries with probability > 0.95 in specified classifiers\n-- Added condition to filter for ranking=1 to improve performance and relevance\n-- Used nested subqueries to limit the dataset early and reduce processing time\n\nSELECT p.oid AS \"ZTF identifier\",\n       p.classifier_name,\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probability p\nWHERE p.probability > 0.95\n  AND p.ranking = 1 -- Focus on top-ranked classes for relevance\n\n  AND p.oid IN\n    (-- Subquery to select OIDs with probability > 0.95 in either classifier\n SELECT DISTINCT oid\n     FROM probability\n     WHERE classifier_name IN ('lc_classifier_top',\n                               'stamp_classifier')\n       AND probability > 0.95\n       AND ranking = 1 -- Ensure we're considering top-ranked entries for efficiency\n )\nLIMIT 1000;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query to retrieve up to 1000 entries with probability > 0.95 in specified classifiers\n-- Added condition to filter for ranking=1 to improve performance and relevance\n-- Used nested subqueries to limit the dataset early and reduce processing time\n\nSELECT p.oid AS \"ZTF identifier\",\n       p.classifier_name,\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probability p\nWHERE p.probability > 0.95\n  AND p.ranking = 1 -- Focus on top-ranked classes for relevance\n\n  AND p.oid IN\n    (-- Subquery to select OIDs with probability > 0.95 in either classifier\n SELECT DISTINCT oid\n     FROM probability\n     WHERE classifier_name IN ('lc_classifier_top',\n                               'stamp_classifier')\n       AND probability > 0.95\n       AND ranking = 1 -- Ensure we're considering top-ranked entries for efficiency\n )\nLIMIT 1000;"
                },
                "in_toks": 1046,
                "out_toks": 201,
                "id": "chatcmpl-BgyRIGZOrjTQem6FCaPvGyPdtF8qa",
                "created": 1749581804,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select up to 1000 probability entries with probability > 0.95\n\nSELECT p.oid AS \"ZTF identifier\",\n       p.classifier_name,\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM\n  (-- Subquery to get OIDs with probability > 0.95 in 'lc_classifier_top' or 'stamp_classifier'\n SELECT DISTINCT oid\n   FROM probability\n   WHERE (classifier_name = 'lc_classifier_top'\n          OR classifier_name = 'stamp_classifier')\n     AND probability > 0.95 ) AS filtered_oids\nJOIN probability p ON p.oid = filtered_oids.oid\nWHERE p.probability > 0.95\nLIMIT 1000;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select up to 1000 probability entries with probability > 0.95\n\nSELECT p.oid AS \"ZTF identifier\",\n       p.classifier_name,\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM\n  (-- Subquery to get OIDs with probability > 0.95 in 'lc_classifier_top' or 'stamp_classifier'\n SELECT DISTINCT oid\n   FROM probability\n   WHERE (classifier_name = 'lc_classifier_top'\n          OR classifier_name = 'stamp_classifier')\n     AND probability > 0.95 ) AS filtered_oids\nJOIN probability p ON p.oid = filtered_oids.oid\nWHERE p.probability > 0.95\nLIMIT 1000;"
                },
                "in_toks": 2083,
                "out_toks": 157,
                "id": "chatcmpl-BgxyT5NFkZOvLD90I3oihRqPHGzY3",
                "created": 1749580017,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "87": {
        "0": {
            "req_id": "87",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'gaia_ztf']",
                    "1": "['probability', 'gaia_ztf']"
                },
                "in_toks": 826,
                "out_toks": 22,
                "id": "chatcmpl-Bgxtl69aGgY6lUzWNbwovfzL7h1o5",
                "created": 1749579725,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\nWITH selected_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name IN ('LPV',\n                          'E')\n     AND p.classifier_name = 'lc_classifier'\n     AND p.classifier_version = 'hierarchical_rf_1.1.0'\n     AND p.probability > 0.7\n   GROUP BY p.oid) -- Retrieve all columns from 'probability' and 'gaia_ztf' for these objects where Gaia object has not changed\n\nSELECT p.*,\n       g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN\n    (SELECT oid\n     FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\nWITH selected_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name IN ('LPV',\n                          'E')\n     AND p.classifier_name = 'lc_classifier'\n     AND p.classifier_version = 'hierarchical_rf_1.1.0'\n     AND p.probability > 0.7\n   GROUP BY p.oid) -- Retrieve all columns from 'probability' and 'gaia_ztf' for these objects where Gaia object has not changed\n\nSELECT p.*,\n       g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN\n    (SELECT oid\n     FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;"
                },
                "in_toks": 2328,
                "out_toks": 184,
                "id": "chatcmpl-BgxyWvQTEx87mxkq4c2UW85YSmcgO",
                "created": 1749580020,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "87",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'gaia_ztf']",
                    "1": "['probability', 'gaia_ztf']"
                },
                "in_toks": 826,
                "out_toks": 22,
                "id": "chatcmpl-Bgxtl69aGgY6lUzWNbwovfzL7h1o5",
                "created": 1749579725,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\nWITH selected_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name IN ('LPV',\n                          'E')\n     AND p.classifier_name = 'lc_classifier'\n     AND p.classifier_version = 'hierarchical_rf_1.1.0'\n     AND p.probability > 0.7\n   GROUP BY p.oid), -- Retrieve probability details for selected objects\nprob_data AS\n  (SELECT p.*\n   FROM probability p\n   JOIN selected_objects so ON p.oid = so.oid), -- Retrieve Gaia data for selected objects\ngaia_data AS\n  (SELECT g.*\n   FROM gaia_ztf g\n   JOIN selected_objects so ON g.oid = so.oid) -- Final selection: all columns from probability and gaia_ztf, limit 50\n\nSELECT p.*,\n       g.*\nFROM prob_data p\nJOIN gaia_data g ON p.oid = g.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\nWITH selected_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name IN ('LPV',\n                          'E')\n     AND p.classifier_name = 'lc_classifier'\n     AND p.classifier_version = 'hierarchical_rf_1.1.0'\n     AND p.probability > 0.7\n   GROUP BY p.oid), -- Retrieve probability details for selected objects\nprob_data AS\n  (SELECT p.*\n   FROM probability p\n   JOIN selected_objects so ON p.oid = so.oid), -- Retrieve Gaia data for selected objects\ngaia_data AS\n  (SELECT g.*\n   FROM gaia_ztf g\n   JOIN selected_objects so ON g.oid = so.oid) -- Final selection: all columns from probability and gaia_ztf, limit 50\n\nSELECT p.*,\n       g.*\nFROM prob_data p\nJOIN gaia_data g ON p.oid = g.oid\nLIMIT 50;"
                },
                "in_toks": 2328,
                "out_toks": 232,
                "id": "chatcmpl-Bgxya7q1uKRaDDbFX3T5YijBlqwXe",
                "created": 1749580024,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "108": {
        "0": {
            "req_id": "108",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 816,
                "out_toks": 20,
                "id": "chatcmpl-BgxtlmMUrDC2ViUcUOp3gJ21EYJFQ",
                "created": 1749579725,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select at most 15 objects with more than 20 detections and high probability of being bogus\nWITH selected_objects AS\n  (SELECT o.oid,\n          o.ndet,\n          p.probability,\n          o.gal_b\n   FROM OBJECT o\n   WHERE o.ndet > 20\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'bogus'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n          AND p.ranking = 1 ) )\nSELECT oid AS \"ZTF identifier\",\n       ndet AS \"number of detections\",\n\n  (SELECT probability\n   FROM probability p\n   WHERE p.oid = selected_objects.oid\n     AND p.class_name = 'bogus'\n     AND p.classifier_name='stamp_classifier'\n     AND p.classifier_version='stamp_classifier_1.0.4'\n     AND p.ranking=1) AS probability,\n       gal_b\nFROM selected_objects\nORDER BY oid\nLIMIT 15;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select at most 15 objects with more than 20 detections and high probability of being bogus\nWITH selected_objects AS\n  (SELECT o.oid,\n          o.ndet,\n          p.probability,\n          o.gal_b\n   FROM OBJECT o\n   WHERE o.ndet > 20\n     AND EXISTS\n       (SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'bogus'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n          AND p.ranking = 1 ) )\nSELECT oid AS \"ZTF identifier\",\n       ndet AS \"number of detections\",\n\n  (SELECT probability\n   FROM probability p\n   WHERE p.oid = selected_objects.oid\n     AND p.class_name = 'bogus'\n     AND p.classifier_name='stamp_classifier'\n     AND p.classifier_version='stamp_classifier_1.0.4'\n     AND p.ranking=1) AS probability,\n       gal_b\nFROM selected_objects\nORDER BY oid\nLIMIT 15;"
                },
                "in_toks": 5013,
                "out_toks": 245,
                "id": "chatcmpl-BgxydiMiIOIDObTvUVeh0kcoPUi8z",
                "created": 1749580027,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "108",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 816,
                "out_toks": 20,
                "id": "chatcmpl-BgxtlmMUrDC2ViUcUOp3gJ21EYJFQ",
                "created": 1749579725,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with more than 20 detections and high probability of being bogus\nWITH selected_objects AS\n  (SELECT o.oid,\n          o.ndet,\n          p.probability,\n          o.gal_b\n   FROM OBJECT o\n   WHERE o.ndet > 20\n     AND o.oid IN\n       (-- Subquery to get object OIDs with probability > 0.9 for 'bogus' class in 'stamp_classifier_1.0.4'\n SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'bogus'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 15) )\nSELECT o.oid AS \"ZTF identifier\",\n       o.ndet AS \"number of detections\",\n       p.probability,\n       o.gal_b\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'bogus'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.probability > 0.9\nORDER BY o.oid\nLIMIT 15;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with more than 20 detections and high probability of being bogus\nWITH selected_objects AS\n  (SELECT o.oid,\n          o.ndet,\n          p.probability,\n          o.gal_b\n   FROM OBJECT o\n   WHERE o.ndet > 20\n     AND o.oid IN\n       (-- Subquery to get object OIDs with probability > 0.9 for 'bogus' class in 'stamp_classifier_1.0.4'\n SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'bogus'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 15) )\nSELECT o.oid AS \"ZTF identifier\",\n       o.ndet AS \"number of detections\",\n       p.probability,\n       o.gal_b\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'bogus'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.probability > 0.9\nORDER BY o.oid\nLIMIT 15;"
                },
                "in_toks": 5013,
                "out_toks": 275,
                "id": "chatcmpl-BgxyhpvxcvY96U403CWOALtzxvRke",
                "created": 1749580031,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "65": {
        "0": {
            "req_id": "65",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 800,
                "out_toks": 8,
                "id": "chatcmpl-BgxtmJSOgA8nsrr9Vj6OxnGR7POEH",
                "created": 1749579726,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT *\nFROM\n  (SELECT *\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n     AND class_name IN ('asteroid',\n                        'bogus')\n     AND probability BETWEEN 0.7 AND 0.99\n   ORDER BY oid DESC\n   LIMIT 500) sub;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT *\nFROM\n  (SELECT *\n   FROM probability\n   WHERE classifier_name = 'stamp_classifier'\n     AND class_name IN ('asteroid',\n                        'bogus')\n     AND probability BETWEEN 0.7 AND 0.99\n   ORDER BY oid DESC\n   LIMIT 500) sub;"
                },
                "in_toks": 2084,
                "out_toks": 65,
                "id": "chatcmpl-BgxylLzGpH5bhHSiHtHYc8iFdC6EO",
                "created": 1749580035,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "65",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 800,
                "out_toks": 8,
                "id": "chatcmpl-BgxtmJSOgA8nsrr9Vj6OxnGR7POEH",
                "created": 1749579726,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select up to 500 rows from the probability table where class_name is 'asteroid' or 'bogus'\n-- and probability is between 0.7 and 0.99, ordered by oid in descending order\n\nSELECT *\nFROM probability\nWHERE class_name IN ('asteroid',\n                     'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\n  AND classifier_name = 'stamp_classifier'\nORDER BY oid DESC\nLIMIT 500;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select up to 500 rows from the probability table where class_name is 'asteroid' or 'bogus'\n-- and probability is between 0.7 and 0.99, ordered by oid in descending order\n\nSELECT *\nFROM probability\nWHERE class_name IN ('asteroid',\n                     'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\n  AND classifier_name = 'stamp_classifier'\nORDER BY oid DESC\nLIMIT 500;"
                },
                "in_toks": 2084,
                "out_toks": 99,
                "id": "chatcmpl-BgxymsDwISnmDlWCIYa4STwHwva1K",
                "created": 1749580036,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "101": {
        "0": {
            "req_id": "101",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'xmatch', 'allwise']",
                    "1": "['probability', 'xmatch', 'allwise']"
                },
                "in_toks": 812,
                "out_toks": 24,
                "id": "chatcmpl-Bgxtnq814omXrrpKJJtxHtaeDh4Zl",
                "created": 1749579727,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with probability > 0.5 of being a long period variable in the light curve classifier\nWITH selected_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'LPV'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.5\n     AND p.ranking = 1\n   LIMIT 100) -- Retrieve all columns from 'probability', 'xmatch', and 'allwise' for these objects\n\nSELECT p.*,\n       x.*,\n       a.*\nFROM probability p\nJOIN selected_objects s ON p.oid = s.oid\nLEFT JOIN xmatch x ON p.oid = x.oid\nLEFT JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE p.oid IN\n    (SELECT oid\n     FROM selected_objects);",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with probability > 0.5 of being a long period variable in the light curve classifier\nWITH selected_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'LPV'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.5\n     AND p.ranking = 1\n   LIMIT 100) -- Retrieve all columns from 'probability', 'xmatch', and 'allwise' for these objects\n\nSELECT p.*,\n       x.*,\n       a.*\nFROM probability p\nJOIN selected_objects s ON p.oid = s.oid\nLEFT JOIN xmatch x ON p.oid = x.oid\nLEFT JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE p.oid IN\n    (SELECT oid\n     FROM selected_objects);"
                },
                "in_toks": 2909,
                "out_toks": 178,
                "id": "chatcmpl-BgxyomKMYG1hF5O0BqWHgqwGTmscy",
                "created": 1749580038,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "101",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'xmatch', 'allwise']",
                    "1": "['probability', 'xmatch', 'allwise']"
                },
                "in_toks": 812,
                "out_toks": 24,
                "id": "chatcmpl-Bgxtnq814omXrrpKJJtxHtaeDh4Zl",
                "created": 1749579727,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\nWITH lpv_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'LPV'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.5\n   LIMIT 100) -- Retrieve all columns from 'probability', 'xmatch', and 'allwise' for these objects\n\nSELECT p.*,\n       x.*,\n       a.*\nFROM probability p\nJOIN lpv_objects l ON p.oid = l.oid\nLEFT JOIN xmatch x ON p.oid = x.oid\nLEFT JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE a.w1mpro BETWEEN 7 AND 8\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\nWITH lpv_objects AS\n  (SELECT p.oid\n   FROM probability p\n   WHERE p.class_name = 'LPV'\n     AND p.classifier_name = 'lc_classifier'\n     AND p.probability > 0.5\n   LIMIT 100) -- Retrieve all columns from 'probability', 'xmatch', and 'allwise' for these objects\n\nSELECT p.*,\n       x.*,\n       a.*\nFROM probability p\nJOIN lpv_objects l ON p.oid = l.oid\nLEFT JOIN xmatch x ON p.oid = x.oid\nLEFT JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE a.w1mpro BETWEEN 7 AND 8\nLIMIT 100;"
                },
                "in_toks": 2909,
                "out_toks": 180,
                "id": "chatcmpl-BgxyqAdCPFmKayOYNjAOM6js3VWX1",
                "created": 1749580040,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "88": {
        "0": {
            "req_id": "88",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection', 'stamp', 'pipeline']"
                },
                "in_toks": 803,
                "out_toks": 28,
                "id": "chatcmpl-Bgxtnhtazj8yC08ec3On84sbMJdh9",
                "created": 1749579727,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- The original query is likely timing out due to the large dataset and lack of filtering conditions on the probability table.\n-- To optimize, we will:\n-- 1. Add explicit filters on the probability table, including class_name, classifier_name, ranking, and probability thresholds.\n-- 2. Use nested subqueries to reduce the dataset early.\n-- 3. Ensure the join conditions are efficient.\n-- 4. Limit the number of rows early if possible.\n WITH stamp_bogus AS\n  (-- Select objects with 'bogus' class, classifier 'stamp_classifier', ranking 1, and a high probability threshold for relevance\n SELECT p.oid,\n        p.classifier_version,\n        p.probability\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND p.probability > 0.8 -- added threshold to filter for high-confidence classifications\n),\n      object_detection_counts AS\n  (-- Count detections per object and compute mean RA/Dec\n SELECT o.oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(o.meanra) AS mean_ra,\n        AVG(o.meandec) AS mean_dec\n   FROM OBJECT o\n   JOIN detection d ON o.oid = d.oid\n   GROUP BY o.oid\n   HAVING COUNT(d.candid) >= 20) -- Join filtered objects with their classification info\n\nSELECT o.oid AS ztf_id,\n       odc.detection_count,\n       odc.mean_ra,\n       odc.mean_dec,\n       sb.classifier_version,\n       sb.probability\nFROM object_detection_counts odc\nJOIN OBJECT o ON odc.oid = o.oid\nJOIN stamp_bogus sb ON o.oid = sb.oid -- Limit to 50 results for performance\nLIMIT 50;",
            "sql_response": {
                "responses": {
                    "0": "-- The original query is likely timing out due to the large dataset and lack of filtering conditions on the probability table.\n-- To optimize, we will:\n-- 1. Add explicit filters on the probability table, including class_name, classifier_name, ranking, and probability thresholds.\n-- 2. Use nested subqueries to reduce the dataset early.\n-- 3. Ensure the join conditions are efficient.\n-- 4. Limit the number of rows early if possible.\n WITH stamp_bogus AS\n  (-- Select objects with 'bogus' class, classifier 'stamp_classifier', ranking 1, and a high probability threshold for relevance\n SELECT p.oid,\n        p.classifier_version,\n        p.probability\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1\n     AND p.probability > 0.8 -- added threshold to filter for high-confidence classifications\n),\n      object_detection_counts AS\n  (-- Count detections per object and compute mean RA/Dec\n SELECT o.oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(o.meanra) AS mean_ra,\n        AVG(o.meandec) AS mean_dec\n   FROM OBJECT o\n   JOIN detection d ON o.oid = d.oid\n   GROUP BY o.oid\n   HAVING COUNT(d.candid) >= 20) -- Join filtered objects with their classification info\n\nSELECT o.oid AS ztf_id,\n       odc.detection_count,\n       odc.mean_ra,\n       odc.mean_dec,\n       sb.classifier_version,\n       sb.probability\nFROM object_detection_counts odc\nJOIN OBJECT o ON odc.oid = o.oid\nJOIN stamp_bogus sb ON o.oid = sb.oid -- Limit to 50 results for performance\nLIMIT 50;"
                },
                "in_toks": 2110,
                "out_toks": 394,
                "id": "chatcmpl-BgyRLQ2zmm78mdUgSLnr28gDRZrN3",
                "created": 1749581807,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH stamp_bogus AS\n  (SELECT p.oid,\n          p.classifier_version,\n          p.probability\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ),\n     object_detection_counts AS\n  (SELECT o.oid,\n          COUNT(d.candid) AS detection_count,\n          AVG(o.meanra) AS mean_ra,\n          AVG(o.meandec) AS mean_dec\n   FROM OBJECT o\n   JOIN detection d ON o.oid = d.oid\n   GROUP BY o.oid\n   HAVING COUNT(d.candid) >= 20)\nSELECT o.oid AS ztf_id,\n       odc.detection_count,\n       odc.mean_ra,\n       odc.mean_dec,\n       sb.classifier_version,\n       sb.probability\nFROM object_detection_counts odc\nJOIN OBJECT o ON odc.oid = o.oid\nJOIN stamp_bogus sb ON o.oid = sb.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH stamp_bogus AS\n  (SELECT p.oid,\n          p.classifier_version,\n          p.probability\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ),\n     object_detection_counts AS\n  (SELECT o.oid,\n          COUNT(d.candid) AS detection_count,\n          AVG(o.meanra) AS mean_ra,\n          AVG(o.meandec) AS mean_dec\n   FROM OBJECT o\n   JOIN detection d ON o.oid = d.oid\n   GROUP BY o.oid\n   HAVING COUNT(d.candid) >= 20)\nSELECT o.oid AS ztf_id,\n       odc.detection_count,\n       odc.mean_ra,\n       odc.mean_dec,\n       sb.classifier_version,\n       sb.probability\nFROM object_detection_counts odc\nJOIN OBJECT o ON odc.oid = o.oid\nJOIN stamp_bogus sb ON o.oid = sb.oid\nLIMIT 50;"
                },
                "in_toks": 3118,
                "out_toks": 219,
                "id": "chatcmpl-BgxytXIKk2WvyWuBJdPIyGpunGr84",
                "created": 1749580043,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "88",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "stamp",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection', 'stamp', 'pipeline']"
                },
                "in_toks": 803,
                "out_toks": 28,
                "id": "chatcmpl-Bgxtnhtazj8yC08ec3On84sbMJdh9",
                "created": 1749579727,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table references and aliases, ensuring all columns are correctly qualified\nWITH top_bogus_objects AS\n  (SELECT p.oid,\n          p.classifier_version,\n          p.probability\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ),\n     object_detection_counts AS\n  (SELECT o.oid,\n          COUNT(d.candid) AS detection_count,\n          AVG(o.meanra) AS mean_ra,\n          AVG(o.meandec) AS mean_dec\n   FROM OBJECT o\n   JOIN detection d ON o.oid = d.oid\n   GROUP BY o.oid\n   HAVING COUNT(d.candid) >= 20)\nSELECT o.oid AS ztf_id,\n       odc.detection_count,\n       odc.mean_ra,\n       odc.mean_dec,\n       tbv.classifier_version,\n       tbv.probability\nFROM object_detection_counts odc\nJOIN top_bogus_objects tbv ON odc.oid = tbv.oid\nJOIN OBJECT o ON o.oid = odc.oid\nLIMIT 50;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table references and aliases, ensuring all columns are correctly qualified\nWITH top_bogus_objects AS\n  (SELECT p.oid,\n          p.classifier_version,\n          p.probability\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ),\n     object_detection_counts AS\n  (SELECT o.oid,\n          COUNT(d.candid) AS detection_count,\n          AVG(o.meanra) AS mean_ra,\n          AVG(o.meandec) AS mean_dec\n   FROM OBJECT o\n   JOIN detection d ON o.oid = d.oid\n   GROUP BY o.oid\n   HAVING COUNT(d.candid) >= 20)\nSELECT o.oid AS ztf_id,\n       odc.detection_count,\n       odc.mean_ra,\n       odc.mean_dec,\n       tbv.classifier_version,\n       tbv.probability\nFROM object_detection_counts odc\nJOIN top_bogus_objects tbv ON odc.oid = tbv.oid\nJOIN OBJECT o ON o.oid = odc.oid\nLIMIT 50;"
                },
                "in_toks": 2210,
                "out_toks": 246,
                "id": "chatcmpl-BgyRPb2Nbri3Is42raTL1lTQJI9U9",
                "created": 1749581811,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select objects with 'bogus' class as top-ranked in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH top_bogus_objects AS\n  (SELECT p.oid,\n          p.classifier_version,\n          p.probability\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ),\n     object_detection_counts AS\n  (SELECT o.oid,\n          COUNT(d.candid) AS detection_count,\n          AVG(o.meanra) AS mean_ra,\n          AVG(o.meandec) AS mean_dec\n   FROM OBJECT o\n   JOIN detection d ON o.oid = d.oid\n   GROUP BY o.oid\n   HAVING COUNT(d.candid) >= 20)\nSELECT o.oid AS ztf_id,\n       odc.detection_count,\n       odc.mean_ra,\n       odc.mean_dec,\n       tbv.classifier_version,\n       tbv.probability\nFROM object_detection_counts odc\nJOIN top_bogus_objects tbv ON odc.oid = tbv.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select objects with 'bogus' class as top-ranked in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH top_bogus_objects AS\n  (SELECT p.oid,\n          p.classifier_version,\n          p.probability\n   FROM probability p\n   WHERE p.class_name = 'bogus'\n     AND p.classifier_name = 'stamp_classifier'\n     AND p.ranking = 1 ),\n     object_detection_counts AS\n  (SELECT o.oid,\n          COUNT(d.candid) AS detection_count,\n          AVG(o.meanra) AS mean_ra,\n          AVG(o.meandec) AS mean_dec\n   FROM OBJECT o\n   JOIN detection d ON o.oid = d.oid\n   GROUP BY o.oid\n   HAVING COUNT(d.candid) >= 20)\nSELECT o.oid AS ztf_id,\n       odc.detection_count,\n       odc.mean_ra,\n       odc.mean_dec,\n       tbv.classifier_version,\n       tbv.probability\nFROM object_detection_counts odc\nJOIN top_bogus_objects tbv ON odc.oid = tbv.oid\nLIMIT 50;"
                },
                "in_toks": 3196,
                "out_toks": 245,
                "id": "chatcmpl-Bgxyw0mZnWcXbSZcXbjHkavlZVszO",
                "created": 1749580046,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "70": {
        "0": {
            "req_id": "70",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-BgxtoMvJTCKu8eVdAk1g6vO9LlwPO",
                "created": 1749579728,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';"
                },
                "in_toks": 2711,
                "out_toks": 22,
                "id": "chatcmpl-BgxyzyybKBbgP0VZPIitHfwAFrrOh",
                "created": 1749580049,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "70",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-BgxtoMvJTCKu8eVdAk1g6vO9LlwPO",
                "created": 1749579728,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';"
                },
                "in_toks": 2711,
                "out_toks": 22,
                "id": "chatcmpl-Bgxz06GalX7jobLjFsROOwcYbl5l3",
                "created": 1749580050,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "53": {
        "0": {
            "req_id": "53",
            "experiment_id": "run_0",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']",
                    "1": "['non_detection']"
                },
                "in_toks": 773,
                "out_toks": 8,
                "id": "chatcmpl-BgxtqkYopU9z3VfktyYPDMhujyYJp",
                "created": 1749579730,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT nd.mjd AS date,\n       nd.fid AS filter_id,\n       nd.oid AS ztf_id,\n       nd.diffmaglim AS mag_limit\nFROM non_detection nd\nWHERE nd.oid = 'ZTF18adqxemz';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT nd.mjd AS date,\n       nd.fid AS filter_id,\n       nd.oid AS ztf_id,\n       nd.diffmaglim AS mag_limit\nFROM non_detection nd\nWHERE nd.oid = 'ZTF18adqxemz';"
                },
                "in_toks": 1992,
                "out_toks": 62,
                "id": "chatcmpl-Bgxz1iRgdAfP8FVnGsSnjH9SNJgrH",
                "created": 1749580051,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "53",
            "experiment_id": "run_1",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']",
                    "1": "['non_detection']"
                },
                "in_toks": 773,
                "out_toks": 8,
                "id": "chatcmpl-BgxtqkYopU9z3VfktyYPDMhujyYJp",
                "created": 1749579730,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT nd.mjd AS date,\n       nd.fid AS filter_id,\n       nd.oid AS ztf_id,\n       nd.diffmaglim AS mag_limit\nFROM non_detection nd\nWHERE nd.oid = 'ZTF18adqxemz';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT nd.mjd AS date,\n       nd.fid AS filter_id,\n       nd.oid AS ztf_id,\n       nd.diffmaglim AS mag_limit\nFROM non_detection nd\nWHERE nd.oid = 'ZTF18adqxemz';"
                },
                "in_toks": 1992,
                "out_toks": 62,
                "id": "chatcmpl-Bgxz2mPZY5mh0yOf5kKX5oRDnC3w3",
                "created": 1749580052,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "77": {
        "0": {
            "req_id": "77",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 790,
                "out_toks": 12,
                "id": "chatcmpl-BgxtrN64glCtyfOFg9B0CchHeBiqx",
                "created": 1749579731,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query to find all ss_ztf objects at zero distance from specified Solar System identifiers\nWITH ss_ids AS\n  (SELECT '213673' AS ss_name\n   UNION ALL SELECT '49894')\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND EXISTS\n    (SELECT 1\n     FROM ss_ids\n     WHERE ss_ztf.oid = ss_ids.ss_name )\nORDER BY oid,\n         candid;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query to find all ss_ztf objects at zero distance from specified Solar System identifiers\nWITH ss_ids AS\n  (SELECT '213673' AS ss_name\n   UNION ALL SELECT '49894')\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND EXISTS\n    (SELECT 1\n     FROM ss_ids\n     WHERE ss_ztf.oid = ss_ids.ss_name )\nORDER BY oid,\n         candid;"
                },
                "in_toks": 1314,
                "out_toks": 100,
                "id": "chatcmpl-BgyRSzmDAtoYClrXi2gxXfWc8cfT7",
                "created": 1749581814,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define a temporary table with the specified Solar System identifiers\nWITH ss_ids AS\n  (SELECT '213673' AS ss_name\n   UNION ALL SELECT '49894') -- Select all ZTF objects from ss_ztf that are at zero distance from any of the specified Solar System objects\n\nSELECT *\nFROM ss_ztf\nWHERE EXISTS\n    (SELECT 1\n     FROM ss_ids\n     WHERE q3c_radial_query(\n                              (SELECT oid\n                               FROM OBJECT\n                               WHERE oid = ss_ztf.oid), -- placeholder for object oid\n\n                              (SELECT oid\n                               FROM OBJECT\n                               WHERE oid = ss_ztf.oid), -- placeholder for object oid\n\n                              (SELECT oid\n                               FROM OBJECT\n                               WHERE oid = ss_ztf.oid), -- placeholder for object oid\n\n                              (SELECT oid\n                               FROM OBJECT\n                               WHERE oid = ss_ztf.oid), -- placeholder for object oid\n 0)\n       AND ss_ztf.ssdistnr = 0 )\nORDER BY candid,\n         oid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define a temporary table with the specified Solar System identifiers\nWITH ss_ids AS\n  (SELECT '213673' AS ss_name\n   UNION ALL SELECT '49894') -- Select all ZTF objects from ss_ztf that are at zero distance from any of the specified Solar System objects\n\nSELECT *\nFROM ss_ztf\nWHERE EXISTS\n    (SELECT 1\n     FROM ss_ids\n     WHERE q3c_radial_query(\n                              (SELECT oid\n                               FROM OBJECT\n                               WHERE oid = ss_ztf.oid), -- placeholder for object oid\n\n                              (SELECT oid\n                               FROM OBJECT\n                               WHERE oid = ss_ztf.oid), -- placeholder for object oid\n\n                              (SELECT oid\n                               FROM OBJECT\n                               WHERE oid = ss_ztf.oid), -- placeholder for object oid\n\n                              (SELECT oid\n                               FROM OBJECT\n                               WHERE oid = ss_ztf.oid), -- placeholder for object oid\n 0)\n       AND ss_ztf.ssdistnr = 0 )\nORDER BY candid,\n         oid;"
                },
                "in_toks": 2053,
                "out_toks": 212,
                "id": "chatcmpl-Bgxz3Uthk2k8OXhCPRvBxTzBpjlAG",
                "created": 1749580053,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "77",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 790,
                "out_toks": 12,
                "id": "chatcmpl-BgxtrN64glCtyfOFg9B0CchHeBiqx",
                "created": 1749579731,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\nWITH target_ss_ids AS\n  (-- Select the specified solar system identifiers\n SELECT unnest(ARRAY['213673', '49894']) AS ss_name),\n     ss_coords AS\n  (-- Retrieve the magnitude (used as ra) and distance (used as dec) for these identifiers\n SELECT ss_name,\n        ssmagnr AS ra,\n        ssdistnr AS dec\n   FROM ss_ztf\n   WHERE ss_name IN ('213673',\n                     '49894') ),\n     matching_objects AS\n  (-- Select objects at zero distance from any of the specified solar system objects\n SELECT z.*\n   FROM ss_ztf z\n   JOIN ss_coords c ON z.ssdistnr = 0\n   AND z.ssnamenr = c.ss_name) -- Return all columns, sorted by object identifier and candidate identifier\n\nSELECT *\nFROM matching_objects\nORDER BY oid,\n         candid;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\nWITH target_ss_ids AS\n  (-- Select the specified solar system identifiers\n SELECT unnest(ARRAY['213673', '49894']) AS ss_name),\n     ss_coords AS\n  (-- Retrieve the magnitude (used as ra) and distance (used as dec) for these identifiers\n SELECT ss_name,\n        ssmagnr AS ra,\n        ssdistnr AS dec\n   FROM ss_ztf\n   WHERE ss_name IN ('213673',\n                     '49894') ),\n     matching_objects AS\n  (-- Select objects at zero distance from any of the specified solar system objects\n SELECT z.*\n   FROM ss_ztf z\n   JOIN ss_coords c ON z.ssdistnr = 0\n   AND z.ssnamenr = c.ss_name) -- Return all columns, sorted by object identifier and candidate identifier\n\nSELECT *\nFROM matching_objects\nORDER BY oid,\n         candid;"
                },
                "in_toks": 1252,
                "out_toks": 195,
                "id": "chatcmpl-BgyRTWgJ95vZO8RluyFmLY2srDCJ2",
                "created": 1749581815,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define a temporary table with the solar system identifiers and their coordinates\nWITH ss_sources AS\n  (SELECT '213673' AS ss_name,\n          NULL::double precision AS ra,\n          NULL::double precision AS dec\n   UNION ALL SELECT '49894',\n                    NULL,\n                    NULL), -- Retrieve the coordinates for the specified solar system identifiers\nss_coords AS\n  (SELECT ss_name,\n          ssmagnr AS ra,\n          ssdistnr AS dec\n   FROM ss_ztf\n   WHERE ss_name IN ('213673',\n                     '49894') ), -- Select ZTF objects that are at zero distance from any of the specified solar system objects\nmatching_objects AS\n  (SELECT z.*\n   FROM ss_ztf z\n   JOIN ss_coords c ON q3c_join(z.oid, z.oid, c.ra, c.dec, 0)) -- Return all columns, sorted by 'oid' and 'candid'\n\nSELECT *\nFROM matching_objects\nORDER BY oid,\n         candid;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define a temporary table with the solar system identifiers and their coordinates\nWITH ss_sources AS\n  (SELECT '213673' AS ss_name,\n          NULL::double precision AS ra,\n          NULL::double precision AS dec\n   UNION ALL SELECT '49894',\n                    NULL,\n                    NULL), -- Retrieve the coordinates for the specified solar system identifiers\nss_coords AS\n  (SELECT ss_name,\n          ssmagnr AS ra,\n          ssdistnr AS dec\n   FROM ss_ztf\n   WHERE ss_name IN ('213673',\n                     '49894') ), -- Select ZTF objects that are at zero distance from any of the specified solar system objects\nmatching_objects AS\n  (SELECT z.*\n   FROM ss_ztf z\n   JOIN ss_coords c ON q3c_join(z.oid, z.oid, c.ra, c.dec, 0)) -- Return all columns, sorted by 'oid' and 'candid'\n\nSELECT *\nFROM matching_objects\nORDER BY oid,\n         candid;"
                },
                "in_toks": 2053,
                "out_toks": 207,
                "id": "chatcmpl-Bgxz6LpFTCwgzZC92ckc0fHkGaP22",
                "created": 1749580056,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "105": {
        "0": {
            "req_id": "105",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'xmatch']",
                    "1": "['object', 'probability', 'xmatch', 'ps1_ztf', 'feature']"
                },
                "in_toks": 886,
                "out_toks": 39,
                "id": "chatcmpl-BgxtrVXgQWzwUBFKkj80ZMLlk6BV6",
                "created": 1749579731,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table references and alias usage, along with added comments for clarity\nWITH selected_objects AS\n  (SELECT o.oid,\n          p.probability\n   FROM OBJECT o -- Main object table\n\n   JOIN probability p ON o.oid = p.oid -- Join with probability table to get AGN probability\n\n   AND p.class_name = 'AGN'\n   AND p.classifier_name = 'lc_classifier'\n   AND p.classifier_version = 'hierarchical_rf_1.1.0'\n   AND p.ranking = 1\n   AND p.probability > 0.7\n   JOIN ps1_ztf ps ON o.oid = ps.oid -- Join with ps1_ztf to get nearest PS1 source info\n\n   WHERE ps.distpsnr1 < 2 -- Distance to nearest PS1 source less than 2 arcsec\n\n     AND ABS(ps.sgscore1 - ps.sgscore2) < 0.5 -- Difference in star/galaxy scores less than 0.5\n) -- Select detection details and PS1 info for the selected objects\n\nSELECT o.oid AS ztf_object_id,\n       so.probability,\n       d.candid,\n       d.filterid,\n       d.chi2,\n       d.sgscore,\n       d.det_id,\n       ps.objectidps1,\n       ps.sgscore1,\n       ps.distpsnr1\nFROM selected_objects so\nJOIN OBJECT o ON so.oid = o.oid -- Join with object table to get object info\nJOIN detection d ON o.oid = d.oid -- Join with detection table for detection details\nJOIN ps1_ztf ps ON o.oid = ps.oid -- Join with ps1_ztf to get nearest PS1 source info\n\nWHERE d.candid = ps.candid -- Filter detections matching the candidate in PS1\n\n  AND d.filterid = ps.objectidps1 -- Match filter ID with PS1 object ID\nLIMIT 50; -- Limit to 50 objects",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table references and alias usage, along with added comments for clarity\nWITH selected_objects AS\n  (SELECT o.oid,\n          p.probability\n   FROM OBJECT o -- Main object table\n\n   JOIN probability p ON o.oid = p.oid -- Join with probability table to get AGN probability\n\n   AND p.class_name = 'AGN'\n   AND p.classifier_name = 'lc_classifier'\n   AND p.classifier_version = 'hierarchical_rf_1.1.0'\n   AND p.ranking = 1\n   AND p.probability > 0.7\n   JOIN ps1_ztf ps ON o.oid = ps.oid -- Join with ps1_ztf to get nearest PS1 source info\n\n   WHERE ps.distpsnr1 < 2 -- Distance to nearest PS1 source less than 2 arcsec\n\n     AND ABS(ps.sgscore1 - ps.sgscore2) < 0.5 -- Difference in star/galaxy scores less than 0.5\n) -- Select detection details and PS1 info for the selected objects\n\nSELECT o.oid AS ztf_object_id,\n       so.probability,\n       d.candid,\n       d.filterid,\n       d.chi2,\n       d.sgscore,\n       d.det_id,\n       ps.objectidps1,\n       ps.sgscore1,\n       ps.distpsnr1\nFROM selected_objects so\nJOIN OBJECT o ON so.oid = o.oid -- Join with object table to get object info\nJOIN detection d ON o.oid = d.oid -- Join with detection table for detection details\nJOIN ps1_ztf ps ON o.oid = ps.oid -- Join with ps1_ztf to get nearest PS1 source info\n\nWHERE d.candid = ps.candid -- Filter detections matching the candidate in PS1\n\n  AND d.filterid = ps.objectidps1 -- Match filter ID with PS1 object ID\nLIMIT 50; -- Limit to 50 objects"
                },
                "in_toks": 2851,
                "out_toks": 422,
                "id": "chatcmpl-BgyRXXq6LDPvvGm8cxkbv0DIWQdQp",
                "created": 1749581819,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select at most 50 objects satisfying the specified conditions\nWITH selected_objects AS\n  (SELECT o.oid,\n          p.probability\n   FROM OBJECT o -- Subquery to get the probability of being an AGN with the specified classifier and ranking=1\n\n   JOIN\n     (SELECT oid,\n             probability\n      FROM probability\n      WHERE class_name = 'AGN'\n        AND classifier_name = 'lc_classifier'\n        AND classifier_version = 'hierarchical_rf_1.1.0'\n        AND ranking = 1\n        AND probability > 0.7 ) p ON o.oid = p.oid -- Subquery to get the nearest PS1 source within 2 arcsec\n\n   JOIN ps1_ztf ps ON o.oid = ps.oid\n   WHERE ps.distpsnr1 < 2 -- Filter objects where the difference in star/galaxy scores is less than 0.5\n\n     AND ABS(ps.sgscore1 - ps.sgscore2) < 0.5 )\nSELECT o.oid AS ztf_object_id,\n       p.probability, -- Retrieve detection details for each detection related to the object\n d.candid,\n d.filterid,\n d.chi2,\n d.sgscore,\n d.det_id,\n ps.objectidps1,\n ps.sgscore1,\n ps.distpsnr1\nFROM selected_objects so\nJOIN OBJECT o ON so.oid = o.oid -- Join with detection table to get detection details\nJOIN detection d ON o.oid = d.oid -- Join with ps1_ztf for nearest PS1 source info\nJOIN ps1_ztf ps ON o.oid = ps.oid -- Filter detections to include only those with the same candidate and filter as in the alert\n\nWHERE d.candid = ps.candid\n  AND d.filterid = ps.objectidps1 -- Limit to 50 objects\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select at most 50 objects satisfying the specified conditions\nWITH selected_objects AS\n  (SELECT o.oid,\n          p.probability\n   FROM OBJECT o -- Subquery to get the probability of being an AGN with the specified classifier and ranking=1\n\n   JOIN\n     (SELECT oid,\n             probability\n      FROM probability\n      WHERE class_name = 'AGN'\n        AND classifier_name = 'lc_classifier'\n        AND classifier_version = 'hierarchical_rf_1.1.0'\n        AND ranking = 1\n        AND probability > 0.7 ) p ON o.oid = p.oid -- Subquery to get the nearest PS1 source within 2 arcsec\n\n   JOIN ps1_ztf ps ON o.oid = ps.oid\n   WHERE ps.distpsnr1 < 2 -- Filter objects where the difference in star/galaxy scores is less than 0.5\n\n     AND ABS(ps.sgscore1 - ps.sgscore2) < 0.5 )\nSELECT o.oid AS ztf_object_id,\n       p.probability, -- Retrieve detection details for each detection related to the object\n d.candid,\n d.filterid,\n d.chi2,\n d.sgscore,\n d.det_id,\n ps.objectidps1,\n ps.sgscore1,\n ps.distpsnr1\nFROM selected_objects so\nJOIN OBJECT o ON so.oid = o.oid -- Join with detection table to get detection details\nJOIN detection d ON o.oid = d.oid -- Join with ps1_ztf for nearest PS1 source info\nJOIN ps1_ztf ps ON o.oid = ps.oid -- Filter detections to include only those with the same candidate and filter as in the alert\n\nWHERE d.candid = ps.candid\n  AND d.filterid = ps.objectidps1 -- Limit to 50 objects\nLIMIT 50;"
                },
                "in_toks": 3520,
                "out_toks": 417,
                "id": "chatcmpl-BgxzAXAclTxDa6bF00D73Qp8i02B2",
                "created": 1749580060,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "105",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "ps1_ztf",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'xmatch']",
                    "1": "['object', 'probability', 'xmatch', 'ps1_ztf', 'feature']"
                },
                "in_toks": 886,
                "out_toks": 39,
                "id": "chatcmpl-BgxtrVXgQWzwUBFKkj80ZMLlk6BV6",
                "created": 1749579731,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with explicit table aliases and column references to resolve ambiguity\nWITH selected_objects AS\n  (SELECT o.oid,\n          p.probability,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          pm.distpsnr1,\n          pm.sgscore1\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   LEFT JOIN ps1_ztf pm ON o.oid = pm.oid\n   WHERE p.class_name = 'QSO' -- AGN class\n\n     AND p.classifier_name = 'lc_classifier'\n     AND p.classifier_version = 'hierarchical_rf_1.1.0'\n     AND p.probability > 0.7\n     AND pm.distpsnr1 < 2 -- distance to nearest PS1 source less than 2 arcsec\n\n     AND ABS(pm.sgscore1 -\n               (SELECT f2.value\n                FROM feature f2\n                WHERE f2.oid = o.oid\n                  AND f2.name = 'sgscore1' )) < 0.5 )\nSELECT o.oid AS ztf_object_id,\n       p.probability, -- Retrieve specific features for the object\n -- Candidate\n\n  (SELECT f.value\n   FROM feature f\n   WHERE f.oid = o.oid\n     AND f.name = 'candidate') AS candidate, -- Filter identifier\n\n  (SELECT f.value\n   FROM feature f\n   WHERE f.oid = o.oid\n     AND f.name = 'filter') AS filter_id, -- Reduced chi-square\n\n  (SELECT f.value\n   FROM feature f\n   WHERE f.oid = o.oid\n     AND f.name = 'reduced_chi2') AS reduced_chi2, -- Star/galaxy score from SExtractor\n\n  (SELECT f.value\n   FROM feature f\n   WHERE f.oid = o.oid\n     AND f.name = 'sgscore1') AS sgscore_sextractor, -- PS1 star/galaxy score\n pm.sgscore1 AS ps1_sgscore, -- Distance to nearest PS1 source\n pm.distpsnr1 AS ps1_distance\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN ps1_ztf pm ON o.oid = pm.oid\nLIMIT 50;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with explicit table aliases and column references to resolve ambiguity\nWITH selected_objects AS\n  (SELECT o.oid,\n          p.probability,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          pm.distpsnr1,\n          pm.sgscore1\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   LEFT JOIN ps1_ztf pm ON o.oid = pm.oid\n   WHERE p.class_name = 'QSO' -- AGN class\n\n     AND p.classifier_name = 'lc_classifier'\n     AND p.classifier_version = 'hierarchical_rf_1.1.0'\n     AND p.probability > 0.7\n     AND pm.distpsnr1 < 2 -- distance to nearest PS1 source less than 2 arcsec\n\n     AND ABS(pm.sgscore1 -\n               (SELECT f2.value\n                FROM feature f2\n                WHERE f2.oid = o.oid\n                  AND f2.name = 'sgscore1' )) < 0.5 )\nSELECT o.oid AS ztf_object_id,\n       p.probability, -- Retrieve specific features for the object\n -- Candidate\n\n  (SELECT f.value\n   FROM feature f\n   WHERE f.oid = o.oid\n     AND f.name = 'candidate') AS candidate, -- Filter identifier\n\n  (SELECT f.value\n   FROM feature f\n   WHERE f.oid = o.oid\n     AND f.name = 'filter') AS filter_id, -- Reduced chi-square\n\n  (SELECT f.value\n   FROM feature f\n   WHERE f.oid = o.oid\n     AND f.name = 'reduced_chi2') AS reduced_chi2, -- Star/galaxy score from SExtractor\n\n  (SELECT f.value\n   FROM feature f\n   WHERE f.oid = o.oid\n     AND f.name = 'sgscore1') AS sgscore_sextractor, -- PS1 star/galaxy score\n pm.sgscore1 AS ps1_sgscore, -- Distance to nearest PS1 source\n pm.distpsnr1 AS ps1_distance\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN ps1_ztf pm ON o.oid = pm.oid\nLIMIT 50;"
                },
                "in_toks": 5914,
                "out_toks": 484,
                "id": "chatcmpl-BgyRbTeR2e4ONznwN14YrseTEWvDX",
                "created": 1749581823,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select at most 50 objects satisfying the specified conditions\nWITH selected_objects AS\n  (SELECT o.oid,\n          p.probability,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          pm.distpsnr1,\n          pm.sgscore1,\n          pm.oid,\n          f.name AS feature_name,\n          f.value AS feature_value,\n          f.fid,\n          f.oid AS feature_oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   LEFT JOIN ps1_ztf pm ON o.oid = pm.oid\n   LEFT JOIN feature f ON o.oid = f.oid\n   WHERE p.class_name = 'QSO' -- AGN class\n\n     AND p.classifier_name = 'lc_classifier'\n     AND p.classifier_version = 'hierarchical_rf_1.1.0'\n     AND p.probability > 0.7\n     AND pm.distpsnr1 < 2 -- distance to nearest PS1 source less than 2 arcsec\n\n     AND ABS(pm.sgscore1 -\n               (SELECT sgscore1\n                FROM feature\n                WHERE oid = o.oid\n                  AND name = 'sgscore1')) < 0.5 )\nSELECT o.oid AS ztf_object_id,\n       p.probability, -- Retrieve features for each epoch (candidate, filter, chi2, sgscore)\n -- Assuming features are stored with different 'name' for each epoch, candidate, filter, chi2, sgscore\n -- For simplicity, select features with specific naming conventions or assume features are stored per epoch\n -- Here, we select all features related to the object\n -- For detailed epoch info, additional schema info would be needed; assuming features are stored per epoch\n -- For demonstration, select features with specific names\n -- Candidate and filter identifiers are not explicitly stored in the schema; assuming they are in feature 'name'\n -- For the purpose of this query, we will include features with names 'candidate', 'filter', 'reduced_chi2', 'sgscore_sextractor'\n -- If not available, this part should be adjusted accordingly\n -- Note: Adjust feature names as per actual schema if different\n -- For now, include all features for the object\n -- The user requested specific columns, so we will select them accordingly\n -- For simplicity, we will join features as subqueries\n -- Candidate\n\n  (SELECT value\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'candidate') AS candidate, -- Filter identifier\n\n  (SELECT value\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'filter') AS filter_id, -- Reduced chi-square\n\n  (SELECT value\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'reduced_chi2') AS reduced_chi2, -- Star/galaxy score from SExtractor\n\n  (SELECT value\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'sgscore1') AS sgscore_sextractor, -- PS1 star/galaxy score\n pm.sgscore1 AS ps1_sgscore, -- Distance to nearest PS1 source\n pm.distpsnr1 AS ps1_distance\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN ps1_ztf pm ON o.oid = pm.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select at most 50 objects satisfying the specified conditions\nWITH selected_objects AS\n  (SELECT o.oid,\n          p.probability,\n          p.class_name,\n          p.classifier_name,\n          p.classifier_version,\n          pm.distpsnr1,\n          pm.sgscore1,\n          pm.oid,\n          f.name AS feature_name,\n          f.value AS feature_value,\n          f.fid,\n          f.oid AS feature_oid\n   FROM OBJECT o\n   JOIN probability p ON o.oid = p.oid\n   LEFT JOIN ps1_ztf pm ON o.oid = pm.oid\n   LEFT JOIN feature f ON o.oid = f.oid\n   WHERE p.class_name = 'QSO' -- AGN class\n\n     AND p.classifier_name = 'lc_classifier'\n     AND p.classifier_version = 'hierarchical_rf_1.1.0'\n     AND p.probability > 0.7\n     AND pm.distpsnr1 < 2 -- distance to nearest PS1 source less than 2 arcsec\n\n     AND ABS(pm.sgscore1 -\n               (SELECT sgscore1\n                FROM feature\n                WHERE oid = o.oid\n                  AND name = 'sgscore1')) < 0.5 )\nSELECT o.oid AS ztf_object_id,\n       p.probability, -- Retrieve features for each epoch (candidate, filter, chi2, sgscore)\n -- Assuming features are stored with different 'name' for each epoch, candidate, filter, chi2, sgscore\n -- For simplicity, select features with specific naming conventions or assume features are stored per epoch\n -- Here, we select all features related to the object\n -- For detailed epoch info, additional schema info would be needed; assuming features are stored per epoch\n -- For demonstration, select features with specific names\n -- Candidate and filter identifiers are not explicitly stored in the schema; assuming they are in feature 'name'\n -- For the purpose of this query, we will include features with names 'candidate', 'filter', 'reduced_chi2', 'sgscore_sextractor'\n -- If not available, this part should be adjusted accordingly\n -- Note: Adjust feature names as per actual schema if different\n -- For now, include all features for the object\n -- The user requested specific columns, so we will select them accordingly\n -- For simplicity, we will join features as subqueries\n -- Candidate\n\n  (SELECT value\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'candidate') AS candidate, -- Filter identifier\n\n  (SELECT value\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'filter') AS filter_id, -- Reduced chi-square\n\n  (SELECT value\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'reduced_chi2') AS reduced_chi2, -- Star/galaxy score from SExtractor\n\n  (SELECT value\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'sgscore1') AS sgscore_sextractor, -- PS1 star/galaxy score\n pm.sgscore1 AS ps1_sgscore, -- Distance to nearest PS1 source\n pm.distpsnr1 AS ps1_distance\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN ps1_ztf pm ON o.oid = pm.oid\nLIMIT 50;"
                },
                "in_toks": 5951,
                "out_toks": 732,
                "id": "chatcmpl-BgxzFkPbaEaesGjXzsL13qJaCjYTg",
                "created": 1749580065,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "86": {
        "0": {
            "req_id": "86",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 835,
                "out_toks": 28,
                "id": "chatcmpl-BgxttN3yMzwDp6kX0WzqqySCzSbeL",
                "created": 1749579733,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\n\nSELECT p.*,\n       pz.*\nFROM\n  (-- Subquery to get object OIDs with probability > 0.6 for Cepheid, Delta Scuti, or RR Lyrae\n SELECT DISTINCT prob.oid\n   FROM probability prob\n   WHERE prob.class_name IN ('CEP',\n                             'DSCT',\n                             'RRL')\n     AND prob.classifier_name = 'lc_classifier'\n     AND prob.classifier_version = 'hierarchical_rf_1.1.0'\n     AND prob.probability > 0.6\n     AND prob.ranking = 1 -- Ensure selecting the most probable class per object\n) AS filtered_objects\nJOIN OBJECT o ON o.oid = filtered_objects.oid\nJOIN probability p ON p.oid = o.oid\nAND p.class_name IN ('CEP',\n                     'DSCT',\n                     'RRL') -- Focus on relevant classes\n\nAND p.classifier_name = 'lc_classifier'\nAND p.classifier_version = 'hierarchical_rf_1.1.0'\nAND p.ranking = 1 -- Ensure the probability corresponds to the top class\nJOIN ps1_ztf pz ON pz.oid = o.oid\nWHERE pz.sgscore1 > 0.8\nLIMIT 100;",
            "sql_response": {
                "responses": {
                    "0": "-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\n\nSELECT p.*,\n       pz.*\nFROM\n  (-- Subquery to get object OIDs with probability > 0.6 for Cepheid, Delta Scuti, or RR Lyrae\n SELECT DISTINCT prob.oid\n   FROM probability prob\n   WHERE prob.class_name IN ('CEP',\n                             'DSCT',\n                             'RRL')\n     AND prob.classifier_name = 'lc_classifier'\n     AND prob.classifier_version = 'hierarchical_rf_1.1.0'\n     AND prob.probability > 0.6\n     AND prob.ranking = 1 -- Ensure selecting the most probable class per object\n) AS filtered_objects\nJOIN OBJECT o ON o.oid = filtered_objects.oid\nJOIN probability p ON p.oid = o.oid\nAND p.class_name IN ('CEP',\n                     'DSCT',\n                     'RRL') -- Focus on relevant classes\n\nAND p.classifier_name = 'lc_classifier'\nAND p.classifier_version = 'hierarchical_rf_1.1.0'\nAND p.ranking = 1 -- Ensure the probability corresponds to the top class\nJOIN ps1_ztf pz ON pz.oid = o.oid\nWHERE pz.sgscore1 > 0.8\nLIMIT 100;"
                },
                "in_toks": 2313,
                "out_toks": 283,
                "id": "chatcmpl-BgyRgRAUQa4iwi548Hebr4fVYpcU9",
                "created": 1749581828,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\n\nSELECT p.*,\n       pz.*\nFROM\n  (-- Subquery to get object OIDs with probability > 0.6 for Cepheid, Delta Scuti, or RR Lyrae in the specified classifier\n SELECT DISTINCT prob.oid\n   FROM probability prob\n   WHERE prob.class_name IN ('CEP',\n                             'DSCT',\n                             'RRL')\n     AND prob.classifier_name = 'lc_classifier'\n     AND prob.classifier_version = 'hierarchical_rf_1.1.0'\n     AND prob.probability > 0.6 ) AS filtered_objects\nJOIN OBJECT o ON o.oid = filtered_objects.oid\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf pz ON pz.oid = o.oid\nWHERE pz.sgscore1 > 0.8\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\n\nSELECT p.*,\n       pz.*\nFROM\n  (-- Subquery to get object OIDs with probability > 0.6 for Cepheid, Delta Scuti, or RR Lyrae in the specified classifier\n SELECT DISTINCT prob.oid\n   FROM probability prob\n   WHERE prob.class_name IN ('CEP',\n                             'DSCT',\n                             'RRL')\n     AND prob.classifier_name = 'lc_classifier'\n     AND prob.classifier_version = 'hierarchical_rf_1.1.0'\n     AND prob.probability > 0.6 ) AS filtered_objects\nJOIN OBJECT o ON o.oid = filtered_objects.oid\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf pz ON pz.oid = o.oid\nWHERE pz.sgscore1 > 0.8\nLIMIT 100;"
                },
                "in_toks": 3355,
                "out_toks": 199,
                "id": "chatcmpl-BgxzNBNcVBacuAkLJtjLP1WeRKBuB",
                "created": 1749580073,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "86",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 835,
                "out_toks": 28,
                "id": "chatcmpl-BgxttN3yMzwDp6kX0WzqqySCzSbeL",
                "created": 1749579733,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\n\nSELECT p.*,\n       ps.*\nFROM\n  (-- Subquery to get object OIDs with probability > 0.6 for specified classes in 'lc_classifier' with ranking=1\n SELECT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND classifier_version = 'hierarchical_rf_1.1.0'\n     AND class_name IN ('Cepheid',\n                        'DSCT',\n                        'RRL')\n     AND probability > 0.6\n     AND ranking = 1 ) AS sub\nJOIN OBJECT o ON o.oid = sub.oid\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('Cepheid',\n                       'DSCT',\n                       'RRL')\n  AND p.probability > 0.6\n  AND ps.sgscore1 > 0.8\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\n\nSELECT p.*,\n       ps.*\nFROM\n  (-- Subquery to get object OIDs with probability > 0.6 for specified classes in 'lc_classifier' with ranking=1\n SELECT oid\n   FROM probability\n   WHERE classifier_name = 'lc_classifier'\n     AND classifier_version = 'hierarchical_rf_1.1.0'\n     AND class_name IN ('Cepheid',\n                        'DSCT',\n                        'RRL')\n     AND probability > 0.6\n     AND ranking = 1 ) AS sub\nJOIN OBJECT o ON o.oid = sub.oid\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.class_name IN ('Cepheid',\n                       'DSCT',\n                       'RRL')\n  AND p.probability > 0.6\n  AND ps.sgscore1 > 0.8\nLIMIT 100;"
                },
                "in_toks": 3355,
                "out_toks": 253,
                "id": "chatcmpl-BgxzQn0FZrUOokBmva5bV0cVLPeTL",
                "created": 1749580076,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "41": {
        "0": {
            "req_id": "41",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']",
                    "1": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 888,
                "out_toks": 22,
                "id": "chatcmpl-Bgxtua4pWZalqiakLMiS6BdlcG0R3",
                "created": 1749579734,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS\n  (SELECT 'id_1' AS id,\n          132.961 AS ra,\n          41.397 AS dec,\n          5.0 / 3600 AS r_deg -- 5 arcsec in degrees\n\n   UNION ALL SELECT 'id_2',\n                    139.01,\n                    41.5653,\n                    10.0 / 3600 -- 10 arcsec in degrees\n)\nSELECT io.id AS id,\n       io.ra AS obj_ra,\n       io.dec AS obj_dec,\n       io.r_deg AS r_deg,\n       aw.oid_catalog AS wise_id,\n       aw.ra AS wise_ra,\n       aw.dec AS wise_dec,\n       aw.w1mpro AS w1_mag,\n       aw.w1sigmpro AS w1_mag_err\nFROM input_objects io\nJOIN allwise aw ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS\n  (SELECT 'id_1' AS id,\n          132.961 AS ra,\n          41.397 AS dec,\n          5.0 / 3600 AS r_deg -- 5 arcsec in degrees\n\n   UNION ALL SELECT 'id_2',\n                    139.01,\n                    41.5653,\n                    10.0 / 3600 -- 10 arcsec in degrees\n)\nSELECT io.id AS id,\n       io.ra AS obj_ra,\n       io.dec AS obj_dec,\n       io.r_deg AS r_deg,\n       aw.oid_catalog AS wise_id,\n       aw.ra AS wise_ra,\n       aw.dec AS wise_dec,\n       aw.w1mpro AS w1_mag,\n       aw.w1sigmpro AS w1_mag_err\nFROM input_objects io\nJOIN allwise aw ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg);"
                },
                "in_toks": 3283,
                "out_toks": 201,
                "id": "chatcmpl-BgxzTUIEcxo6PT7ZMMGIiotzVSylU",
                "created": 1749580079,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "41",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']",
                    "1": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 888,
                "out_toks": 22,
                "id": "chatcmpl-Bgxtua4pWZalqiakLMiS6BdlcG0R3",
                "created": 1749579734,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\nWITH input_objects AS\n  (-- Define the two input objects with their coordinates and search radii in degrees\n SELECT 'id_1' AS id,\n        132.961 AS ra,\n        41.397 AS dec,\n        5.0 / 3600 AS r_deg -- 5 arcsec in degrees\n\n   UNION ALL SELECT 'id_2',\n                    139.01,\n                    41.5653,\n                    10.0 / 3600 -- 10 arcsec in degrees\n),\n     search_results AS\n  (-- For each input object, find ALLWISE objects within the specified radius\n SELECT io.id AS input_id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog AS wise_id,\n        aw.ra AS wise_ra,\n        aw.dec AS wise_dec,\n        aw.w1mpro AS w1_mag,\n        aw.w1sigmpro AS w1_uncertainty\n   FROM input_objects io -- Use the q3c_join function to find all allwise objects within the radius\n -- Note: q3c_join is a common spatial function; assuming it exists in the database\n\n   JOIN allwise aw ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg))\nSELECT input_id AS id,\n       obj_ra,\n       obj_dec,\n       r_deg,\n       wise_id,\n       wise_ra,\n       wise_dec,\n       w1_mag,\n       w1_uncertainty\nFROM search_results;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\nWITH input_objects AS\n  (-- Define the two input objects with their coordinates and search radii in degrees\n SELECT 'id_1' AS id,\n        132.961 AS ra,\n        41.397 AS dec,\n        5.0 / 3600 AS r_deg -- 5 arcsec in degrees\n\n   UNION ALL SELECT 'id_2',\n                    139.01,\n                    41.5653,\n                    10.0 / 3600 -- 10 arcsec in degrees\n),\n     search_results AS\n  (-- For each input object, find ALLWISE objects within the specified radius\n SELECT io.id AS input_id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog AS wise_id,\n        aw.ra AS wise_ra,\n        aw.dec AS wise_dec,\n        aw.w1mpro AS w1_mag,\n        aw.w1sigmpro AS w1_uncertainty\n   FROM input_objects io -- Use the q3c_join function to find all allwise objects within the radius\n -- Note: q3c_join is a common spatial function; assuming it exists in the database\n\n   JOIN allwise aw ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg))\nSELECT input_id AS id,\n       obj_ra,\n       obj_dec,\n       r_deg,\n       wise_id,\n       wise_ra,\n       wise_dec,\n       w1_mag,\n       w1_uncertainty\nFROM search_results;"
                },
                "in_toks": 2447,
                "out_toks": 344,
                "id": "chatcmpl-BgyRjaJaOYeX4Q7LLuuQTXpTVKGPi",
                "created": 1749581831,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS\n  (SELECT 'id_1' AS id,\n          132.961 AS ra,\n          41.397 AS dec,\n          5.0 / 3600 AS r_deg -- 5 arcsec in degrees\n\n   UNION ALL SELECT 'id_2',\n                    139.01,\n                    41.5653,\n                    10.0 / 3600 -- 10 arcsec in degrees\n),\n     search_results AS\n  (SELECT io.id AS id,\n          io.ra AS obj_ra,\n          io.dec AS obj_dec,\n          io.r_deg AS r_deg,\n          aw.oid_catalog AS wise_id,\n          aw.ra AS wise_ra,\n          aw.dec AS wise_dec,\n          aw.w1mpro AS w1_mag,\n          aw.w1sigmpro AS w1_uncertainty\n   FROM input_objects io\n   JOIN allwise aw ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg))\nSELECT id,\n       obj_ra,\n       obj_dec,\n       r_deg,\n       oid_catalog AS wise_catalog_id,\n       wise_ra,\n       wise_dec,\n       w1_mag,\n       w1_uncertainty\nFROM search_results;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS\n  (SELECT 'id_1' AS id,\n          132.961 AS ra,\n          41.397 AS dec,\n          5.0 / 3600 AS r_deg -- 5 arcsec in degrees\n\n   UNION ALL SELECT 'id_2',\n                    139.01,\n                    41.5653,\n                    10.0 / 3600 -- 10 arcsec in degrees\n),\n     search_results AS\n  (SELECT io.id AS id,\n          io.ra AS obj_ra,\n          io.dec AS obj_dec,\n          io.r_deg AS r_deg,\n          aw.oid_catalog AS wise_id,\n          aw.ra AS wise_ra,\n          aw.dec AS wise_dec,\n          aw.w1mpro AS w1_mag,\n          aw.w1sigmpro AS w1_uncertainty\n   FROM input_objects io\n   JOIN allwise aw ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg))\nSELECT id,\n       obj_ra,\n       obj_dec,\n       r_deg,\n       oid_catalog AS wise_catalog_id,\n       wise_ra,\n       wise_dec,\n       w1_mag,\n       w1_uncertainty\nFROM search_results;"
                },
                "in_toks": 3283,
                "out_toks": 252,
                "id": "chatcmpl-BgxzVGGPGxikZAsX6u2uwbYa9kRuP",
                "created": 1749580081,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "74": {
        "0": {
            "req_id": "74",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 817,
                "out_toks": 12,
                "id": "chatcmpl-BgxtxZgFHEJPfWuU7s4x3TUg0d1pJ",
                "created": 1749579737,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\nWITH ztf_objects AS\n  (-- Select the specified ZTF object identifiers\n SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abmaqeh',\n                 'ZTF18abwxduj',\n                 'ZTF19aactlln') ),\n     matched_objects AS\n  (-- Join with ss_ztf to get MPC info for these objects\n SELECT z.oid AS ztf_oid,\n        s.ssnamenr,\n        s.ssmagnr\n   FROM ztf_objects z\n   LEFT JOIN ss_ztf s ON z.oid = s.oid) -- Filter for MPC objects brighter than magnitude 19.2 and order by magnitude descending\n\nSELECT ztf_oid,\n       ssnamenr,\n       ssmagnr\nFROM matched_objects\nWHERE ssmagnr < 19.2\nORDER BY ssmagnr DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\nWITH ztf_objects AS\n  (-- Select the specified ZTF object identifiers\n SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abmaqeh',\n                 'ZTF18abwxduj',\n                 'ZTF19aactlln') ),\n     matched_objects AS\n  (-- Join with ss_ztf to get MPC info for these objects\n SELECT z.oid AS ztf_oid,\n        s.ssnamenr,\n        s.ssmagnr\n   FROM ztf_objects z\n   LEFT JOIN ss_ztf s ON z.oid = s.oid) -- Filter for MPC objects brighter than magnitude 19.2 and order by magnitude descending\n\nSELECT ztf_oid,\n       ssnamenr,\n       ssmagnr\nFROM matched_objects\nWHERE ssmagnr < 19.2\nORDER BY ssmagnr DESC;"
                },
                "in_toks": 1224,
                "out_toks": 194,
                "id": "chatcmpl-BgyRoW0TOol88DQF0bjaQpspEudj5",
                "created": 1749581836,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS\n  (SELECT oid,\n          candid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abmaqeh',\n                 'ZTF18abwxduj',\n                 'ZTF19aactlln') ), -- Join with ss_ztf to get MPC object info for these objects\nmatched_objects AS\n  (SELECT z.oid AS ztf_oid,\n          z.candid,\n          s.ssnamenr,\n          s.ssmagnr\n   FROM ztf_objects z\n   LEFT JOIN ss_ztf s ON z.oid = s.oid) -- Select MPC objects with magnitude brighter than 19.2 (i.e., ssmagnr < 19.2)\n\nSELECT ztf_oid,\n       candid,\n       ssnamenr,\n       ssmagnr\nFROM matched_objects\nWHERE ssmagnr < 19.2\nORDER BY ssmagnr DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS\n  (SELECT oid,\n          candid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abmaqeh',\n                 'ZTF18abwxduj',\n                 'ZTF19aactlln') ), -- Join with ss_ztf to get MPC object info for these objects\nmatched_objects AS\n  (SELECT z.oid AS ztf_oid,\n          z.candid,\n          s.ssnamenr,\n          s.ssmagnr\n   FROM ztf_objects z\n   LEFT JOIN ss_ztf s ON z.oid = s.oid) -- Select MPC objects with magnitude brighter than 19.2 (i.e., ssmagnr < 19.2)\n\nSELECT ztf_oid,\n       candid,\n       ssnamenr,\n       ssmagnr\nFROM matched_objects\nWHERE ssmagnr < 19.2\nORDER BY ssmagnr DESC;"
                },
                "in_toks": 2092,
                "out_toks": 210,
                "id": "chatcmpl-BgxzYcEHmSdMjRv23lrovKKIhzYbc",
                "created": 1749580084,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "74",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 817,
                "out_toks": 12,
                "id": "chatcmpl-BgxtxZgFHEJPfWuU7s4x3TUg0d1pJ",
                "created": 1749579737,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- The error occurs because the 'OBJECT' table and the 'candid' column do not exist in the provided schema.\n-- Instead, we should use the 'object' table (lowercase) and its 'oid' column.\n-- Also, since the user wants to find MPC objects brighter than 19.2 mag, we need to filter based on 'ssmagnr' in 'ss_ztf'.\n-- The 'ss_ztf' table links 'oid' to the nearest solar system object info, including 'ssnamenr' and 'ssmagnr'.\n-- The query will select the specified ZTF objects, join with 'ss_ztf' to get MPC info, filter by brightness, and sort accordingly.\n WITH ztf_objects AS\n  (-- Select the OIDs of the specified ZTF objects\n SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abmaqeh',\n                 'ZTF18abwxduj',\n                 'ZTF19aactlln') )\nSELECT ztf_objects.oid AS ztf_oid,\n       s.ssnamenr AS mpc_name,\n       s.ssmagnr AS mpc_magnitude\nFROM ztf_objects\nLEFT JOIN ss_ztf s ON ztf_objects.oid = s.oid\nWHERE s.ssmagnr < 19.2 -- Filter for MPC objects brighter than 19.2 mag\nORDER BY s.ssmagnr DESC; -- Sort by MPC magnitude in descending order",
            "sql_response": {
                "responses": {
                    "0": "-- The error occurs because the 'OBJECT' table and the 'candid' column do not exist in the provided schema.\n-- Instead, we should use the 'object' table (lowercase) and its 'oid' column.\n-- Also, since the user wants to find MPC objects brighter than 19.2 mag, we need to filter based on 'ssmagnr' in 'ss_ztf'.\n-- The 'ss_ztf' table links 'oid' to the nearest solar system object info, including 'ssnamenr' and 'ssmagnr'.\n-- The query will select the specified ZTF objects, join with 'ss_ztf' to get MPC info, filter by brightness, and sort accordingly.\n WITH ztf_objects AS\n  (-- Select the OIDs of the specified ZTF objects\n SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abmaqeh',\n                 'ZTF18abwxduj',\n                 'ZTF19aactlln') )\nSELECT ztf_objects.oid AS ztf_oid,\n       s.ssnamenr AS mpc_name,\n       s.ssmagnr AS mpc_magnitude\nFROM ztf_objects\nLEFT JOIN ss_ztf s ON ztf_objects.oid = s.oid\nWHERE s.ssmagnr < 19.2 -- Filter for MPC objects brighter than 19.2 mag\nORDER BY s.ssmagnr DESC; -- Sort by MPC magnitude in descending order"
                },
                "in_toks": 1224,
                "out_toks": 315,
                "id": "chatcmpl-BgyRqZD0hU8oajLghnSgQlkAkeBYw",
                "created": 1749581838,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS\n  (SELECT oid,\n          candid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abmaqeh',\n                 'ZTF18abwxduj',\n                 'ZTF19aactlln') ), -- Join with ss_ztf to get MPC object info for these objects\nmatched_ss AS\n  (SELECT z.oid AS ztf_oid,\n          z.candid,\n          s.ssnamenr,\n          s.ssmagnr\n   FROM ztf_objects z\n   LEFT JOIN ss_ztf s ON z.oid = s.oid) -- Select MPC objects with magnitude brighter than 19.2 (i.e., ssmagnr < 19.2)\n\nSELECT ztf_oid,\n       candid,\n       ssnamenr,\n       ssmagnr\nFROM matched_ss\nWHERE ssmagnr < 19.2\nORDER BY ssmagnr DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS\n  (SELECT oid,\n          candid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abmaqeh',\n                 'ZTF18abwxduj',\n                 'ZTF19aactlln') ), -- Join with ss_ztf to get MPC object info for these objects\nmatched_ss AS\n  (SELECT z.oid AS ztf_oid,\n          z.candid,\n          s.ssnamenr,\n          s.ssmagnr\n   FROM ztf_objects z\n   LEFT JOIN ss_ztf s ON z.oid = s.oid) -- Select MPC objects with magnitude brighter than 19.2 (i.e., ssmagnr < 19.2)\n\nSELECT ztf_oid,\n       candid,\n       ssnamenr,\n       ssmagnr\nFROM matched_ss\nWHERE ssmagnr < 19.2\nORDER BY ssmagnr DESC;"
                },
                "in_toks": 2092,
                "out_toks": 210,
                "id": "chatcmpl-Bgxzbai9rdGBnQ1a8N4h73bfzcXC9",
                "created": 1749580087,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "97": {
        "0": {
            "req_id": "97",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 842,
                "out_toks": 14,
                "id": "chatcmpl-BgxtyODOJYesoxHAGTKOnPOttWAPi",
                "created": 1749579738,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve up to 50 ZTF objects with specified classification probabilities\n\nSELECT o.oid AS ztf_id,\n       p_stamp.probability AS prob_stamp_agn,\n       p_lc.probability AS prob_lc_lpv\nFROM OBJECT o -- Subquery to get the most probable AGN classification from the stamp classifier\nJOIN\n  (SELECT p1.oid,\n          p1.probability\n   FROM probability p1\n   WHERE p1.class_name = 'AGN'\n     AND p1.classifier_name = 'stamp_classifier'\n     AND p1.classifier_version = 'stamp_classifier_1.0.4'\n     AND p1.ranking = 1\n     AND p1.probability > 0.6 ) p_stamp ON o.oid = p_stamp.oid -- Subquery to get the LPV probability from the light curve classifier\nJOIN\n  (SELECT p2.oid,\n          p2.probability\n   FROM probability p2\n   WHERE p2.class_name = 'LPV'\n     AND p2.classifier_name = 'lc_classifier'\n     AND p2.ranking = 1\n     AND p2.probability > 0.7 ) p_lc ON o.oid = p_lc.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve up to 50 ZTF objects with specified classification probabilities\n\nSELECT o.oid AS ztf_id,\n       p_stamp.probability AS prob_stamp_agn,\n       p_lc.probability AS prob_lc_lpv\nFROM OBJECT o -- Subquery to get the most probable AGN classification from the stamp classifier\nJOIN\n  (SELECT p1.oid,\n          p1.probability\n   FROM probability p1\n   WHERE p1.class_name = 'AGN'\n     AND p1.classifier_name = 'stamp_classifier'\n     AND p1.classifier_version = 'stamp_classifier_1.0.4'\n     AND p1.ranking = 1\n     AND p1.probability > 0.6 ) p_stamp ON o.oid = p_stamp.oid -- Subquery to get the LPV probability from the light curve classifier\nJOIN\n  (SELECT p2.oid,\n          p2.probability\n   FROM probability p2\n   WHERE p2.class_name = 'LPV'\n     AND p2.classifier_name = 'lc_classifier'\n     AND p2.ranking = 1\n     AND p2.probability > 0.7 ) p_lc ON o.oid = p_lc.oid\nLIMIT 50;"
                },
                "in_toks": 2609,
                "out_toks": 291,
                "id": "chatcmpl-BgxzerRylbO9Y9YgIJcckgPC9KztK",
                "created": 1749580090,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "97",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 842,
                "out_toks": 14,
                "id": "chatcmpl-BgxtyODOJYesoxHAGTKOnPOttWAPi",
                "created": 1749579738,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve up to 50 ZTF objects with specified classification probabilities\n\nSELECT o.oid AS ztf_identifier,\n       p_stamp.probability AS prob_stamp_agn,\n       p_lc.probability AS prob_lc_lpv\nFROM OBJECT o -- Subquery to get the most probable AGN classification from the stamp_classifier\n\nWHERE o.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'AGN'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4'\n       AND p.probability > 0.6\n     ORDER BY p.ranking\n     LIMIT 50) -- Join to get the LPV probability from the light curve classifier\nJOIN probability p_lc ON o.oid = p_lc.oid WHERE p_lc.class_name = 'LPV'\n  AND p_lc.classifier_name = 'lc_classifier'\n  AND p_lc.probability > 0.7\nORDER BY o.oid\nLIMIT 50;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve up to 50 ZTF objects with specified classification probabilities\n\nSELECT o.oid AS ztf_identifier,\n       p_stamp.probability AS prob_stamp_agn,\n       p_lc.probability AS prob_lc_lpv\nFROM OBJECT o -- Subquery to get the most probable AGN classification from the stamp_classifier\n\nWHERE o.oid IN\n    (SELECT p.oid\n     FROM probability p\n     WHERE p.class_name = 'AGN'\n       AND p.classifier_name = 'stamp_classifier'\n       AND p.classifier_version = 'stamp_classifier_1.0.4'\n       AND p.probability > 0.6\n     ORDER BY p.ranking\n     LIMIT 50) -- Join to get the LPV probability from the light curve classifier\nJOIN probability p_lc ON o.oid = p_lc.oid WHERE p_lc.class_name = 'LPV'\n  AND p_lc.classifier_name = 'lc_classifier'\n  AND p_lc.probability > 0.7\nORDER BY o.oid\nLIMIT 50;"
                },
                "in_toks": 2609,
                "out_toks": 251,
                "id": "chatcmpl-Bgxzh4SxKdjiYQk8zbFsVsslLGJgB",
                "created": 1749580093,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "66": {
        "0": {
            "req_id": "66",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']",
                    "1": "['object', 'gaia_ztf']"
                },
                "in_toks": 770,
                "out_toks": 20,
                "id": "chatcmpl-BgxtzCUru1kYmFtrvWxRbLHCKGcfO",
                "created": 1749579739,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH nearest_gaia AS\n  (SELECT g.oid AS ztf_oid,\n          q3c_dist(o.meanra, o.meandec, g.neargaia, 0) AS distance_deg,\n          g.maggaia\n   FROM OBJECT o,\n               gaia_ztf g\n   WHERE o.oid = 'ZTF22abftjko'\n     AND g.oid = o.oid\n   ORDER BY q3c_dist(o.meanra, o.meandec, g.neargaia, 0)\n   LIMIT 1)\nSELECT ztf_oid,\n       distance_deg,\n       maggaia\nFROM nearest_gaia;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH nearest_gaia AS\n  (SELECT g.oid AS ztf_oid,\n          q3c_dist(o.meanra, o.meandec, g.neargaia, 0) AS distance_deg,\n          g.maggaia\n   FROM OBJECT o,\n               gaia_ztf g\n   WHERE o.oid = 'ZTF22abftjko'\n     AND g.oid = o.oid\n   ORDER BY q3c_dist(o.meanra, o.meandec, g.neargaia, 0)\n   LIMIT 1)\nSELECT ztf_oid,\n       distance_deg,\n       maggaia\nFROM nearest_gaia;"
                },
                "in_toks": 2569,
                "out_toks": 151,
                "id": "chatcmpl-Bgxzkkad0PA233IO8GcX6dZ0ktMmp",
                "created": 1749580096,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "66",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']",
                    "1": "['object', 'gaia_ztf']"
                },
                "in_toks": 770,
                "out_toks": 20,
                "id": "chatcmpl-BgxtzCUru1kYmFtrvWxRbLHCKGcfO",
                "created": 1749579739,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH nearest_gaia AS\n  (SELECT g.oid AS ztf_oid,\n          q3c_dist(o.meanra, o.meandec, g.neargaia, 0) AS distance_deg,\n          g.maggaia\n   FROM OBJECT o,\n               gaia_ztf g\n   WHERE o.oid = 'ZTF22abftjko'\n     AND g.oid = o.oid\n   ORDER BY q3c_dist(o.meanra, o.meandec, g.neargaia, 0)\n   LIMIT 1)\nSELECT ztf_oid,\n       distance_deg,\n       maggaia\nFROM nearest_gaia;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH nearest_gaia AS\n  (SELECT g.oid AS ztf_oid,\n          q3c_dist(o.meanra, o.meandec, g.neargaia, 0) AS distance_deg,\n          g.maggaia\n   FROM OBJECT o,\n               gaia_ztf g\n   WHERE o.oid = 'ZTF22abftjko'\n     AND g.oid = o.oid\n   ORDER BY q3c_dist(o.meanra, o.meandec, g.neargaia, 0)\n   LIMIT 1)\nSELECT ztf_oid,\n       distance_deg,\n       maggaia\nFROM nearest_gaia;"
                },
                "in_toks": 2569,
                "out_toks": 151,
                "id": "chatcmpl-Bgxzm6RODdapFPJ9gatcMWANB7NWD",
                "created": 1749580098,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "50": {
        "0": {
            "req_id": "50",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']",
                    "1": "['object', 'feature', 'probability']"
                },
                "in_toks": 809,
                "out_toks": 20,
                "id": "chatcmpl-Bgxtz3gPUBK6xXYnmFM62u5DK8Pwx",
                "created": 1749579739,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve features for specified objects with version 'lc_classifier_1.2.1-P'\n\nSELECT o.oid AS \"ZTF identifier\",\n       f.name AS \"feature name\",\n       f.value,\n       f.fid AS \"filter identifier\"\nFROM feature f\nJOIN OBJECT o ON f.oid = o.oid\nWHERE o.oid IN ('ZTF21aaqytjr',\n                'ZTF23abkhwgb')\n  AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY o.oid,\n         f.fid,\n         f.name;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve features for specified objects with version 'lc_classifier_1.2.1-P'\n\nSELECT o.oid AS \"ZTF identifier\",\n       f.name AS \"feature name\",\n       f.value,\n       f.fid AS \"filter identifier\"\nFROM feature f\nJOIN OBJECT o ON f.oid = o.oid\nWHERE o.oid IN ('ZTF21aaqytjr',\n                'ZTF23abkhwgb')\n  AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY o.oid,\n         f.fid,\n         f.name;"
                },
                "in_toks": 5008,
                "out_toks": 135,
                "id": "chatcmpl-Bgxzot6ClcXyw0c6mpinCJpWiWYDK",
                "created": 1749580100,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "50",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']",
                    "1": "['object', 'feature', 'probability']"
                },
                "in_toks": 809,
                "out_toks": 20,
                "id": "chatcmpl-Bgxtz3gPUBK6xXYnmFM62u5DK8Pwx",
                "created": 1749579739,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Retrieve features for specified objects with version 'lc_classifier_1.2.1-P'\n\nSELECT o.oid AS \"ZTF identifier\",\n       f.name AS \"feature name\",\n       f.value,\n       f.fid AS \"filter identifier\"\nFROM feature f\nJOIN OBJECT o ON f.oid = o.oid\nWHERE o.oid IN ('ZTF21aaqytjr',\n                'ZTF23abkhwgb')\n  AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY o.oid,\n         f.fid,\n         f.name;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Retrieve features for specified objects with version 'lc_classifier_1.2.1-P'\n\nSELECT o.oid AS \"ZTF identifier\",\n       f.name AS \"feature name\",\n       f.value,\n       f.fid AS \"filter identifier\"\nFROM feature f\nJOIN OBJECT o ON f.oid = o.oid\nWHERE o.oid IN ('ZTF21aaqytjr',\n                'ZTF23abkhwgb')\n  AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY o.oid,\n         f.fid,\n         f.name;"
                },
                "in_toks": 5008,
                "out_toks": 135,
                "id": "chatcmpl-BgxzqKOKzWai7PbyV5UHBJQvjUfhk",
                "created": 1749580102,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "91": {
        "0": {
            "req_id": "91",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']",
                    "1": "['object', 'feature', 'xmatch', 'allwise', 'feature_version']"
                },
                "in_toks": 813,
                "out_toks": 24,
                "id": "chatcmpl-Bgxu00o6VkV07vJHKE3JsURXE8MDm",
                "created": 1749579740,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Select ZTF objects with 'W1-W2' color less than 1, including detection count and magnitude differences\n\nSELECT o.oid AS ztf_identifier,\n       o.ndet AS number_of_detections,\n       (f_g_r_min.value - f_g_r_max.value) AS mag_diff_g_r,\n       f_w1_w2.value AS w1_w2,\n       f_w1_w2.version AS feature_version\nFROM OBJECT o -- Join to get 'g-r_min' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'g-r_min'\n   LIMIT 1) f_g_r_min ON TRUE -- Join to get 'g-r_max' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'g-r_max'\n   LIMIT 1) f_g_r_max ON TRUE -- Join to get 'W1-W2' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'W1-W2'\n   LIMIT 1) f_w1_w2 ON TRUE -- Filter objects where 'W1-W2' color is less than 1\n\nWHERE f_w1_w2.value < 1 -- Limit to 100 results for performance\nLIMIT 100;",
            "sql_response": {
                "responses": {
                    "0": "-- Select ZTF objects with 'W1-W2' color less than 1, including detection count and magnitude differences\n\nSELECT o.oid AS ztf_identifier,\n       o.ndet AS number_of_detections,\n       (f_g_r_min.value - f_g_r_max.value) AS mag_diff_g_r,\n       f_w1_w2.value AS w1_w2,\n       f_w1_w2.version AS feature_version\nFROM OBJECT o -- Join to get 'g-r_min' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'g-r_min'\n   LIMIT 1) f_g_r_min ON TRUE -- Join to get 'g-r_max' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'g-r_max'\n   LIMIT 1) f_g_r_max ON TRUE -- Join to get 'W1-W2' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'W1-W2'\n   LIMIT 1) f_w1_w2 ON TRUE -- Filter objects where 'W1-W2' color is less than 1\n\nWHERE f_w1_w2.value < 1 -- Limit to 100 results for performance\nLIMIT 100;"
                },
                "in_toks": 4042,
                "out_toks": 318,
                "id": "chatcmpl-BgyRumtLb0NekqCcVgymkBNwzI5Ws",
                "created": 1749581842,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select specified columns from object and feature tables\n\nSELECT o.oid AS ztf_identifier,\n       o.ndet AS number_of_detections,\n       (f_g_r_min.value - f_g_r_max.value) AS mag_diff_g_r,\n       f_w1_w2.value AS w1_w2,\n       f_w1_w2.version AS feature_version\nFROM OBJECT o -- Subquery to get the 'g-r_min' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'g-r_min'\n   LIMIT 1) f_g_r_min ON TRUE -- Subquery to get the 'g-r_max' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'g-r_max'\n   LIMIT 1) f_g_r_max ON TRUE -- Subquery to get the 'W1-W2' feature value and version\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'W1-W2'\n   LIMIT 1) f_w1_w2 ON TRUE -- Filter objects where 'W1-W2' feature value is less than 1\n\nWHERE f_w1_w2.value < 1 -- Limit the result to 100 rows\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select specified columns from object and feature tables\n\nSELECT o.oid AS ztf_identifier,\n       o.ndet AS number_of_detections,\n       (f_g_r_min.value - f_g_r_max.value) AS mag_diff_g_r,\n       f_w1_w2.value AS w1_w2,\n       f_w1_w2.version AS feature_version\nFROM OBJECT o -- Subquery to get the 'g-r_min' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'g-r_min'\n   LIMIT 1) f_g_r_min ON TRUE -- Subquery to get the 'g-r_max' feature value\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'g-r_max'\n   LIMIT 1) f_g_r_max ON TRUE -- Subquery to get the 'W1-W2' feature value and version\nJOIN LATERAL\n  (SELECT value,\n          VERSION\n   FROM feature\n   WHERE oid = o.oid\n     AND name = 'W1-W2'\n   LIMIT 1) f_w1_w2 ON TRUE -- Filter objects where 'W1-W2' feature value is less than 1\n\nWHERE f_w1_w2.value < 1 -- Limit the result to 100 rows\nLIMIT 100;"
                },
                "in_toks": 4827,
                "out_toks": 306,
                "id": "chatcmpl-BgxzsSeMHEl095jmONC3XMCC8zftf",
                "created": 1749580104,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "91",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "xmatch",
                "allwise",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']",
                    "1": "['object', 'feature', 'xmatch', 'allwise', 'feature_version']"
                },
                "in_toks": 813,
                "out_toks": 24,
                "id": "chatcmpl-Bgxu00o6VkV07vJHKE3JsURXE8MDm",
                "created": 1749579740,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select ZTF object ID, number of detections, difference between min g-r and r-g magnitudes, W1-W2 color, and feature version\n\nSELECT o.oid AS ztf_id,\n       o.ndet AS num_detections,\n       (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n       f_w1_w2.value AS w1_w2,\n       f_w1_w2.version AS feature_version\nFROM OBJECT o -- Subquery to get the minimum g-r difference magnitude\nLEFT JOIN feature f_g_r_min ON o.oid = f_g_r_min.oid\nAND f_g_r_min.name = 'g-r_max' -- assuming 'g-r_max' is the relevant feature\nLEFT JOIN feature f_r_g_min ON o.oid = f_r_g_min.oid\nAND f_r_g_min.name = 'g-r_max' -- same feature, same name, for simplicity\nLEFT JOIN feature f_w1_w2 ON o.oid = f_w1_w2.oid\nAND f_w1_w2.name = 'W1-W2'\nWHERE f_w1_w2.value < 1\nLIMIT 100;",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select ZTF object ID, number of detections, difference between min g-r and r-g magnitudes, W1-W2 color, and feature version\n\nSELECT o.oid AS ztf_id,\n       o.ndet AS num_detections,\n       (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n       f_w1_w2.value AS w1_w2,\n       f_w1_w2.version AS feature_version\nFROM OBJECT o -- Subquery to get the minimum g-r difference magnitude\nLEFT JOIN feature f_g_r_min ON o.oid = f_g_r_min.oid\nAND f_g_r_min.name = 'g-r_max' -- assuming 'g-r_max' is the relevant feature\nLEFT JOIN feature f_r_g_min ON o.oid = f_r_g_min.oid\nAND f_r_g_min.name = 'g-r_max' -- same feature, same name, for simplicity\nLEFT JOIN feature f_w1_w2 ON o.oid = f_w1_w2.oid\nAND f_w1_w2.name = 'W1-W2'\nWHERE f_w1_w2.value < 1\nLIMIT 100;"
                },
                "in_toks": 5691,
                "out_toks": 257,
                "id": "chatcmpl-BgxzwBrtwgaqSLUpt3D9BxY0MIr1d",
                "created": 1749580108,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "68": {
        "0": {
            "req_id": "68",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']",
                    "1": "['object', 'ps1_ztf']"
                },
                "in_toks": 784,
                "out_toks": 20,
                "id": "chatcmpl-Bgxu08rKdQ5yrSWXjtE74Q6tM5Mqz",
                "created": 1749579740,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH nearest_ps1 AS\n  (SELECT p.oid,\n          p.candid,\n          p.objectidps1,\n          p.sgmag1,\n          p.sgscore1,\n          p.distpsnr1\n   FROM ps1_ztf p\n   WHERE p.oid = 'ZTF21abfrbnm'\n   ORDER BY p.distpsnr1\n   LIMIT 1)\nSELECT objectidps1,\n       sgmag1,\n       sgscore1,\n       distpsnr1\nFROM nearest_ps1;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH nearest_ps1 AS\n  (SELECT p.oid,\n          p.candid,\n          p.objectidps1,\n          p.sgmag1,\n          p.sgscore1,\n          p.distpsnr1\n   FROM ps1_ztf p\n   WHERE p.oid = 'ZTF21abfrbnm'\n   ORDER BY p.distpsnr1\n   LIMIT 1)\nSELECT objectidps1,\n       sgmag1,\n       sgscore1,\n       distpsnr1\nFROM nearest_ps1;"
                },
                "in_toks": 3120,
                "out_toks": 121,
                "id": "chatcmpl-BgxzzNbTYhfvmzrLve49kpUKfDTny",
                "created": 1749580111,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "68",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']",
                    "1": "['object', 'ps1_ztf']"
                },
                "in_toks": 784,
                "out_toks": 20,
                "id": "chatcmpl-Bgxu08rKdQ5yrSWXjtE74Q6tM5Mqz",
                "created": 1749579740,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH nearest_ps1 AS\n  (SELECT p.objectidps1,\n          p.sgmag1,\n          p.sgscore1,\n          p.distpsnr1\n   FROM ps1_ztf p\n   WHERE p.oid = 'ZTF21abfrbnm'\n   ORDER BY p.distpsnr1\n   LIMIT 1)\nSELECT *\nFROM nearest_ps1;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH nearest_ps1 AS\n  (SELECT p.objectidps1,\n          p.sgmag1,\n          p.sgscore1,\n          p.distpsnr1\n   FROM ps1_ztf p\n   WHERE p.oid = 'ZTF21abfrbnm'\n   ORDER BY p.distpsnr1\n   LIMIT 1)\nSELECT *\nFROM nearest_ps1;"
                },
                "in_toks": 3120,
                "out_toks": 87,
                "id": "chatcmpl-Bgy01lfTlIm7HKDhQi1gJRLy0cHT3",
                "created": 1749580113,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "60": {
        "0": {
            "req_id": "60",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']",
                    "1": "['object', 'magstat']"
                },
                "in_toks": 812,
                "out_toks": 14,
                "id": "chatcmpl-Bgxu1zZjuQwjXkuUOkDQY1ezvVibJ",
                "created": 1749579741,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select the ZTF identifier, number of detections, initial rise estimate, and first difference magnitude\n\nSELECT o.oid AS \"ZTF identifier\",\n       m.ndet AS \"number of detections\",\n       m.dmdt_first AS \"initial rise estimate\",\n       m.dm_first AS \"first difference magnitude\"\nFROM OBJECT o\nJOIN magstat m ON o.oid = m.oid\nWHERE o.oid IN ('ZTF20adadshh',\n                'ZTF21aaabvit',\n                'ZTF21aaabvjk')\n  AND m.fid = 1 -- g band\n\n  AND m.ndubious = 0; -- zero dubious corrections",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select the ZTF identifier, number of detections, initial rise estimate, and first difference magnitude\n\nSELECT o.oid AS \"ZTF identifier\",\n       m.ndet AS \"number of detections\",\n       m.dmdt_first AS \"initial rise estimate\",\n       m.dm_first AS \"first difference magnitude\"\nFROM OBJECT o\nJOIN magstat m ON o.oid = m.oid\nWHERE o.oid IN ('ZTF20adadshh',\n                'ZTF21aaabvit',\n                'ZTF21aaabvjk')\n  AND m.fid = 1 -- g band\n\n  AND m.ndubious = 0; -- zero dubious corrections"
                },
                "in_toks": 3112,
                "out_toks": 151,
                "id": "chatcmpl-Bgy03a80lleh32mNTVADO2rJtnkV6",
                "created": 1749580115,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "60",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']",
                    "1": "['object', 'magstat']"
                },
                "in_toks": 812,
                "out_toks": 14,
                "id": "chatcmpl-Bgxu1zZjuQwjXkuUOkDQY1ezvVibJ",
                "created": 1749579741,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "-- Select the ZTF identifier, number of detections, initial rise estimate, and first difference magnitude\n\nSELECT o.oid AS \"ZTF identifier\",\n       m.ndet AS \"number of detections\",\n       m.dmdt_first AS \"initial rise estimate\",\n       m.dm_first AS \"first difference magnitude\"\nFROM OBJECT o\nJOIN magstat m ON o.oid = m.oid\nWHERE o.oid IN ('ZTF20adadshh',\n                'ZTF21aaabvit',\n                'ZTF21aaabvjk')\n  AND m.fid = 1 -- g band\n\n  AND m.ndubious = 0; -- zero dubious corrections",
            "original_sql_response": {
                "responses": {
                    "0": "-- Select the ZTF identifier, number of detections, initial rise estimate, and first difference magnitude\n\nSELECT o.oid AS \"ZTF identifier\",\n       m.ndet AS \"number of detections\",\n       m.dmdt_first AS \"initial rise estimate\",\n       m.dm_first AS \"first difference magnitude\"\nFROM OBJECT o\nJOIN magstat m ON o.oid = m.oid\nWHERE o.oid IN ('ZTF20adadshh',\n                'ZTF21aaabvit',\n                'ZTF21aaabvjk')\n  AND m.fid = 1 -- g band\n\n  AND m.ndubious = 0; -- zero dubious corrections"
                },
                "in_toks": 3112,
                "out_toks": 151,
                "id": "chatcmpl-Bgy05WKDYzzEplWUaFyAadpBYunAa",
                "created": 1749580117,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "76": {
        "0": {
            "req_id": "76",
            "experiment_id": "run_0",
            "pred_tables": [
                "gaia_ztf",
                "ss_ztf",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf', 'ss_ztf', 'object']",
                    "1": "['gaia_ztf', 'ss_ztf', 'object']"
                },
                "in_toks": 796,
                "out_toks": 32,
                "id": "chatcmpl-Bgxu2dOk7iOCxxFK5Z7pX2GyntEQP",
                "created": 1749579742,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table references and syntax\nWITH mpc_object AS\n  (SELECT oid,\n          ssmagnr,\n          ssnamenr\n   FROM ss_ztf\n   WHERE ssnamenr = '115185' )\nSELECT o.oid AS ztf_object_id,\n       g.maggaiabright AS mpc_magnitude,\n       q3c_dist(o.meanra, o.meandec, c.ra, c.dec) AS distance_deg\nFROM OBJECT o -- Join with the subquery for the MPC object\nJOIN mpc_object c ON TRUE -- Join with Gaia ZTF objects based on matching oid\nJOIN gaia_ztf g ON g.oid = o.oid -- Filter objects within 1.5 arcsec (converted to degrees)\n\nWHERE q3c_join(o.meanra, o.meandec, c.ra, c.dec, 1.5/3600) -- Order results by distance\nORDER BY distance_deg;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table references and syntax\nWITH mpc_object AS\n  (SELECT oid,\n          ssmagnr,\n          ssnamenr\n   FROM ss_ztf\n   WHERE ssnamenr = '115185' )\nSELECT o.oid AS ztf_object_id,\n       g.maggaiabright AS mpc_magnitude,\n       q3c_dist(o.meanra, o.meandec, c.ra, c.dec) AS distance_deg\nFROM OBJECT o -- Join with the subquery for the MPC object\nJOIN mpc_object c ON TRUE -- Join with Gaia ZTF objects based on matching oid\nJOIN gaia_ztf g ON g.oid = o.oid -- Filter objects within 1.5 arcsec (converted to degrees)\n\nWHERE q3c_join(o.meanra, o.meandec, c.ra, c.dec, 1.5/3600) -- Order results by distance\nORDER BY distance_deg;"
                },
                "in_toks": 1709,
                "out_toks": 203,
                "id": "chatcmpl-BgyRyoHpO0b8nr5T3UVjnXXVsDdVP",
                "created": 1749581846,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH mpc_object AS\n  (SELECT oid,\n          ssmagnr,\n          ssnamenr\n   FROM ss_ztf\n   WHERE ssnamenr = '115185' )\nSELECT o.oid AS ztf_object_id,\n       g.maggaiabright AS mpc_magnitude,\n       q3c_dist(o.meanra, o.meandec, c.ra, c.dec) AS distance_deg\nFROM OBJECT o,\n\n  (SELECT *\n   FROM mpc_object) c\nJOIN gaia_ztf g ON g.oid = o.oid\nWHERE q3c_join(o.meanra, o.meandec, c.ra, c.dec, 1.5/3600) -- 1.5 arcsec converted to degrees\nORDER BY distance_deg;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH mpc_object AS\n  (SELECT oid,\n          ssmagnr,\n          ssnamenr\n   FROM ss_ztf\n   WHERE ssnamenr = '115185' )\nSELECT o.oid AS ztf_object_id,\n       g.maggaiabright AS mpc_magnitude,\n       q3c_dist(o.meanra, o.meandec, c.ra, c.dec) AS distance_deg\nFROM OBJECT o,\n\n  (SELECT *\n   FROM mpc_object) c\nJOIN gaia_ztf g ON g.oid = o.oid\nWHERE q3c_join(o.meanra, o.meandec, c.ra, c.dec, 1.5/3600) -- 1.5 arcsec converted to degrees\nORDER BY distance_deg;"
                },
                "in_toks": 2758,
                "out_toks": 169,
                "id": "chatcmpl-Bgy0762ByG2DiAV8uTP5jg9G0mOcF",
                "created": 1749580119,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "76",
            "experiment_id": "run_1",
            "pred_tables": [
                "gaia_ztf",
                "ss_ztf",
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf', 'ss_ztf', 'object']",
                    "1": "['gaia_ztf', 'ss_ztf', 'object']"
                },
                "in_toks": 796,
                "out_toks": 32,
                "id": "chatcmpl-Bgxu2dOk7iOCxxFK5Z7pX2GyntEQP",
                "created": 1749579742,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper references and subquery handling\nWITH mpc_object AS\n  (-- Select the object with ssnamenr '115185' from ss_ztf\n SELECT oid,\n        ssmagnr,\n        ssnamenr\n   FROM ss_ztf\n   WHERE ssnamenr = '115185' ),\n     mpc_coords AS\n  (-- Retrieve the meanra and meandec for the object with the specific oid\n SELECT o.meanra,\n        o.meandec\n   FROM OBJECT o\n   WHERE o.oid =\n       (SELECT oid\n        FROM mpc_object\n        LIMIT 1) -- ensure only one row\n)\nSELECT o.oid AS ztf_object_id,\n       gaia.maggaiabright AS mpc_magnitude, -- Calculate angular distance between ZTF object and MPC object\n q3c_dist(o.meanra, o.meandec, mpc_coords.meanra, mpc_coords.meandec) AS distance_deg\nFROM OBJECT o\nJOIN gaia_ztf gaia ON gaia.oid = o.oid\nCROSS JOIN mpc_coords\nWHERE -- Filter objects within 1.5 arcsec (converted to degrees)\n q3c_join(o.meanra, o.meandec, mpc_coords.meanra, mpc_coords.meandec, 1.5/3600)\nORDER BY distance_deg;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper references and subquery handling\nWITH mpc_object AS\n  (-- Select the object with ssnamenr '115185' from ss_ztf\n SELECT oid,\n        ssmagnr,\n        ssnamenr\n   FROM ss_ztf\n   WHERE ssnamenr = '115185' ),\n     mpc_coords AS\n  (-- Retrieve the meanra and meandec for the object with the specific oid\n SELECT o.meanra,\n        o.meandec\n   FROM OBJECT o\n   WHERE o.oid =\n       (SELECT oid\n        FROM mpc_object\n        LIMIT 1) -- ensure only one row\n)\nSELECT o.oid AS ztf_object_id,\n       gaia.maggaiabright AS mpc_magnitude, -- Calculate angular distance between ZTF object and MPC object\n q3c_dist(o.meanra, o.meandec, mpc_coords.meanra, mpc_coords.meandec) AS distance_deg\nFROM OBJECT o\nJOIN gaia_ztf gaia ON gaia.oid = o.oid\nCROSS JOIN mpc_coords\nWHERE -- Filter objects within 1.5 arcsec (converted to degrees)\n q3c_join(o.meanra, o.meandec, mpc_coords.meanra, mpc_coords.meandec, 1.5/3600)\nORDER BY distance_deg;"
                },
                "in_toks": 1703,
                "out_toks": 297,
                "id": "chatcmpl-BgyS1jrcwgq2UEZi7gMGlhnQO2Vdl",
                "created": 1749581849,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH mpc_object AS\n  (SELECT oid,\n          ssmagnr,\n          ssnamenr\n   FROM ss_ztf\n   WHERE ssnamenr = '115185' )\nSELECT o.oid AS ztf_object_id,\n       gaia.maggaiabright AS mpc_magnitude,\n       q3c_dist(o.meanra, o.meandec, mpc_obj.meanra, mpc_obj.meandec) AS distance_deg\nFROM OBJECT o,\n            gaia_ztf gaia,\n\n  (SELECT meanra,\n          meandec\n   FROM OBJECT\n   WHERE oid =\n       (SELECT oid\n        FROM ss_ztf\n        WHERE ssnamenr = '115185')) AS mpc_obj\nWHERE q3c_join(o.meanra, o.meandec, mpc_obj.meanra, mpc_obj.meandec, 1.5/3600) -- 1.5 arcsec converted to degrees\nORDER BY distance_deg;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH mpc_object AS\n  (SELECT oid,\n          ssmagnr,\n          ssnamenr\n   FROM ss_ztf\n   WHERE ssnamenr = '115185' )\nSELECT o.oid AS ztf_object_id,\n       gaia.maggaiabright AS mpc_magnitude,\n       q3c_dist(o.meanra, o.meandec, mpc_obj.meanra, mpc_obj.meandec) AS distance_deg\nFROM OBJECT o,\n            gaia_ztf gaia,\n\n  (SELECT meanra,\n          meandec\n   FROM OBJECT\n   WHERE oid =\n       (SELECT oid\n        FROM ss_ztf\n        WHERE ssnamenr = '115185')) AS mpc_obj\nWHERE q3c_join(o.meanra, o.meandec, mpc_obj.meanra, mpc_obj.meandec, 1.5/3600) -- 1.5 arcsec converted to degrees\nORDER BY distance_deg;"
                },
                "in_toks": 2758,
                "out_toks": 200,
                "id": "chatcmpl-Bgy0AGJmZ0QxDEi3czxm38mjhVMyE",
                "created": 1749580122,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "44": {
        "0": {
            "req_id": "44",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 806,
                "out_toks": 14,
                "id": "chatcmpl-Bgxu33Bfv6BpO9sp7N6IX3AwlJblI",
                "created": 1749579743,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_objects AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abfcszi',\n                 'ZTF21aaqwjlz') )\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN\n    (SELECT oid\n     FROM selected_objects)\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC,\n         dq.scorr DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_objects AS\n  (SELECT oid\n   FROM OBJECT\n   WHERE oid IN ('ZTF20abfcszi',\n                 'ZTF21aaqwjlz') )\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN\n    (SELECT oid\n     FROM selected_objects)\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC,\n         dq.scorr DESC;"
                },
                "in_toks": 3186,
                "out_toks": 82,
                "id": "chatcmpl-Bgy0DEWLJf6Xv2mgtj5KyxwngsdHu",
                "created": 1749580125,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "44",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 806,
                "out_toks": 14,
                "id": "chatcmpl-Bgxu33Bfv6BpO9sp7N6IX3AwlJblI",
                "created": 1749579743,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT dq.*\nFROM\n  (SELECT *\n   FROM dataquality\n   WHERE oid IN ('ZTF20abfcszi',\n                 'ZTF21aaqwjlz') ) dq\nWHERE dq.chipsf < 3\nORDER BY dq.oid ASC,\n         dq.scorr DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT dq.*\nFROM\n  (SELECT *\n   FROM dataquality\n   WHERE oid IN ('ZTF20abfcszi',\n                 'ZTF21aaqwjlz') ) dq\nWHERE dq.chipsf < 3\nORDER BY dq.oid ASC,\n         dq.scorr DESC;"
                },
                "in_toks": 3186,
                "out_toks": 64,
                "id": "chatcmpl-Bgy0E2VlJSfqFNpFaQDUQ3Nv59iE0",
                "created": 1749580126,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    }
}