{
    "13": {
        "0": {
            "req_id": 13,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 780,
                "out_toks": 14,
                "id": "chatcmpl-Be0PjcobAnc4OUZECZwm5wqqtYZ1x",
                "created": 1748874411,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe classes\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM sne_objects)\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\n-- Final selection: object OID, class probability, first detection, last detection\nSELECT\n    sp.class_name AS probability_class,\n    so.lastmjd,\n    so.firstmjd,\n    so.oid\nFROM sne_probabilities sp\nJOIN sne_objects so ON sp.oid = so.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe classes\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM sne_objects)\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\n-- Final selection: object OID, class probability, first detection, last detection\nSELECT\n    sp.class_name AS probability_class,\n    so.lastmjd,\n    so.firstmjd,\n    so.oid\nFROM sne_probabilities sp\nJOIN sne_objects so ON sp.oid = so.oid;\n```"
                },
                "in_toks": 1694,
                "out_toks": 284,
                "id": "chatcmpl-BhN05iOx0vzdK6JcVGNDaXXlSR4dp",
                "created": 1749676217,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe classes\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM sne_objects)\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\n-- Final selection: object OID, class probability, first detection, last detection\nSELECT\n    sp.class_name AS probability_class,\n    so.lastmjd,\n    so.firstmjd,\n    so.oid\nFROM sne_probabilities sp\nJOIN sne_objects so ON sp.oid = so.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe classes\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM sne_objects)\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\n-- Final selection: object OID, class probability, first detection, last detection\nSELECT\n    sp.class_name AS probability_class,\n    so.lastmjd,\n    so.firstmjd,\n    so.oid\nFROM sne_probabilities sp\nJOIN sne_objects so ON sp.oid = so.oid;\n```"
                    }
                },
                "in_toks": 2607,
                "out_toks": 284,
                "id": "chatcmpl-Be0QlSzlR2m9U0jsxYQ603cjKiTZX",
                "created": 1748874475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 13,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 780,
                "out_toks": 14,
                "id": "chatcmpl-Be0PjcobAnc4OUZECZwm5wqqtYZ1x",
                "created": 1748874411,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.oid IN (SELECT oid FROM sne_objects)\n      AND (\n        p.class_name LIKE 'SN%'\n        AND (\n          p.class_name LIKE 'SNIa' OR\n          p.class_name LIKE 'SNIbc' OR\n          p.class_name LIKE 'SNII' OR\n          p.class_name LIKE 'SLSN'\n        )\n      )\n)\n-- Final selection with object OID, class probability, first and last detection dates\nSELECT \n    sp.class_name AS class_probability,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    o.oid\nFROM sne_objects o\nJOIN sne_probabilities sp ON o.oid = sp.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.oid IN (SELECT oid FROM sne_objects)\n      AND (\n        p.class_name LIKE 'SN%'\n        AND (\n          p.class_name LIKE 'SNIa' OR\n          p.class_name LIKE 'SNIbc' OR\n          p.class_name LIKE 'SNII' OR\n          p.class_name LIKE 'SLSN'\n        )\n      )\n)\n-- Final selection with object OID, class probability, first and last detection dates\nSELECT \n    sp.class_name AS class_probability,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    o.oid\nFROM sne_objects o\nJOIN sne_probabilities sp ON o.oid = sp.oid;\n```"
                },
                "in_toks": 1761,
                "out_toks": 331,
                "id": "chatcmpl-BhN05ehzpZaVX8twrNVTqHEHXlaB3",
                "created": 1749676217,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name LIKE 'SN%'\n      AND p.class_name LIKE 'SNIa' OR p.class_name LIKE 'SNIbc' OR p.class_name LIKE 'SNII' OR p.class_name LIKE 'SLSN'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM sne_objects)\n)\n-- Final selection with object OID, class probability, first and last detection dates\nSELECT \n    sp.class_name AS class_probability,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    o.oid\nFROM sne_objects o\nJOIN sne_probabilities sp ON o.oid = sp.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name LIKE 'SN%'\n      AND p.class_name LIKE 'SNIa' OR p.class_name LIKE 'SNIbc' OR p.class_name LIKE 'SNII' OR p.class_name LIKE 'SLSN'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM sne_objects)\n)\n-- Final selection with object OID, class probability, first and last detection dates\nSELECT \n    sp.class_name AS class_probability,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    o.oid\nFROM sne_objects o\nJOIN sne_probabilities sp ON o.oid = sp.oid;\n```"
                    }
                },
                "in_toks": 2607,
                "out_toks": 317,
                "id": "chatcmpl-Be0QlEVBerKOgWN5dp7fYc6cl2zyH",
                "created": 1748874475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "13",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 780,
                "out_toks": 7,
                "id": "chatcmpl-BhLhX8K0snisAx9dLivHcFNvnEOue",
                "created": 1749671223,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name LIKE 'SN%'            -- Focus on classes starting with 'SN'\n      AND p.class_name LIKE 'SNe%'           -- Ensure class is related to supernovae\n      AND p.ranking = 1                      -- Select the top-ranked (most probable) class\n      AND p.oid IN (SELECT oid FROM sne_objects) -- Only objects within the date range\n)\n-- Final selection: object id, class probability, first and last detection dates\nSELECT \n    sp.class_name AS class_probability,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    o.oid\nFROM sne_probabilities sp\nJOIN object o ON o.oid = sp.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name LIKE 'SN%'            -- Focus on classes starting with 'SN'\n      AND p.class_name LIKE 'SNe%'           -- Ensure class is related to supernovae\n      AND p.ranking = 1                      -- Select the top-ranked (most probable) class\n      AND p.oid IN (SELECT oid FROM sne_objects) -- Only objects within the date range\n)\n-- Final selection: object id, class probability, first and last detection dates\nSELECT \n    sp.class_name AS class_probability,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    o.oid\nFROM sne_probabilities sp\nJOIN object o ON o.oid = sp.oid;\n```"
                },
                "in_toks": 1695,
                "out_toks": 325,
                "id": "chatcmpl-BhN05Ve4so3FT5eakpNMsOLxKADfj",
                "created": 1749676217,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name LIKE 'SN%'\n      AND p.class_name LIKE 'SNe%'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM sne_objects)\n)\n-- Final selection: object id, class probability, first and last detection dates\nSELECT \n    sp.class_name AS class_probability,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    o.oid\nFROM sne_probabilities sp\nJOIN object o ON o.oid = sp.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name LIKE 'SN%'\n      AND p.class_name LIKE 'SNe%'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM sne_objects)\n)\n-- Final selection: object id, class probability, first and last detection dates\nSELECT \n    sp.class_name AS class_probability,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    o.oid\nFROM sne_probabilities sp\nJOIN object o ON o.oid = sp.oid;\n```"
                },
                "in_toks": 2607,
                "out_toks": 285,
                "id": "chatcmpl-BhLx1xLeMtAIymNrrnB7BJcgenqyW",
                "created": 1749672183,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "13",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 780,
                "out_toks": 7,
                "id": "chatcmpl-BhLhX55tD0sTKg5l3UekaBYwlzyQl",
                "created": 1749671223,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe classes\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM sne_objects)\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\n-- Final selection: object OID, class probability, first detection, last detection\nSELECT\n    sp.class_name AS probability_class,\n    so.lastmjd,\n    so.firstmjd,\n    so.oid\nFROM sne_probabilities sp\nJOIN sne_objects so ON sp.oid = so.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe classes\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM sne_objects)\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\n-- Final selection: object OID, class probability, first detection, last detection\nSELECT\n    sp.class_name AS probability_class,\n    so.lastmjd,\n    so.firstmjd,\n    so.oid\nFROM sne_probabilities sp\nJOIN sne_objects so ON sp.oid = so.oid;\n```"
                },
                "in_toks": 1694,
                "out_toks": 284,
                "id": "chatcmpl-BhN0FMlcXW5SEbozV9cXM2bLBxmxj",
                "created": 1749676227,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe classes\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM sne_objects)\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\n-- Final selection: object OID, class probability, first detection, last detection\nSELECT\n    sp.class_name AS probability_class,\n    so.lastmjd,\n    so.firstmjd,\n    so.oid\nFROM sne_probabilities sp\nJOIN sne_objects so ON sp.oid = so.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe classes\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM sne_objects)\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\n-- Final selection: object OID, class probability, first detection, last detection\nSELECT\n    sp.class_name AS probability_class,\n    so.lastmjd,\n    so.firstmjd,\n    so.oid\nFROM sne_probabilities sp\nJOIN sne_objects so ON sp.oid = so.oid;\n```"
                },
                "in_toks": 2607,
                "out_toks": 284,
                "id": "chatcmpl-BhLkgkSdjHdKezv3Ch6iTIie1G2Gy",
                "created": 1749671418,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "10": {
        "0": {
            "req_id": 10,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 816,
                "out_toks": 14,
                "id": "chatcmpl-Be0PkwSwkkZTSPSckz1e96KVr9n77",
                "created": 1748874412,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects classified as SNIa with ranking=1 and CV/Nova with ranking=2, where the probability difference is less than 0.1\nWITH selected_objects AS (\n    -- Find objects with SNIa ranking=1\n    SELECT p1.oid\n    FROM probability p1\n    WHERE p1.class_name = 'SNIa'\n      AND p1.classifier_name = 'lc_classifier'\n      AND p1.ranking = 1\n    INTERSECT\n    -- Find objects with CV/Nova ranking=2\n    SELECT p2.oid\n    FROM probability p2\n    WHERE p2.class_name = 'CV/Nova'\n      AND p2.classifier_name = 'lc_classifier'\n      AND p2.ranking = 2\n),\nprobabilities AS (\n    -- Retrieve probabilities for selected objects\n    SELECT\n        o.oid,\n        -- Use DISTINCT ON to ensure only one row per object for each class\n        -- Get probability for SNIa with ranking=1\n        (SELECT p1.probability\n         FROM probability p1\n         WHERE p1.oid = o.oid\n           AND p1.class_name = 'SNIa'\n           AND p1.classifier_name = 'lc_classifier'\n           AND p1.ranking = 1\n         LIMIT 1) AS SN_prob,\n        -- Get probability for CV/Nova with ranking=2\n        (SELECT p2.probability\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.class_name = 'CV/Nova'\n           AND p2.classifier_name = 'lc_classifier'\n           AND p2.ranking = 2\n         LIMIT 1) AS CV_prob\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_objects)\n),\nfiltered_objects AS (\n    -- Filter objects where the absolute difference between probabilities is less than 0.1\n    SELECT\n        oid,\n        SN_prob,\n        CV_prob\n    FROM probabilities\n    WHERE SN_prob IS NOT NULL\n      AND CV_prob IS NOT NULL\n      AND ABS(SN_prob - CV_prob) < 0.1\n)\n-- Return object IDs and probabilities with specified column names\nSELECT\n    oid,\n    SN_prob AS \"SN_prob\",\n    CV_prob AS \"CV_prob\"\nFROM filtered_objects;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as SNIa with ranking=1 and CV/Nova with ranking=2, where the probability difference is less than 0.1\nWITH selected_objects AS (\n    -- Find objects with SNIa ranking=1\n    SELECT p1.oid\n    FROM probability p1\n    WHERE p1.class_name = 'SNIa'\n      AND p1.classifier_name = 'lc_classifier'\n      AND p1.ranking = 1\n    INTERSECT\n    -- Find objects with CV/Nova ranking=2\n    SELECT p2.oid\n    FROM probability p2\n    WHERE p2.class_name = 'CV/Nova'\n      AND p2.classifier_name = 'lc_classifier'\n      AND p2.ranking = 2\n),\nprobabilities AS (\n    -- Retrieve probabilities for selected objects\n    SELECT\n        o.oid,\n        -- Use DISTINCT ON to ensure only one row per object for each class\n        -- Get probability for SNIa with ranking=1\n        (SELECT p1.probability\n         FROM probability p1\n         WHERE p1.oid = o.oid\n           AND p1.class_name = 'SNIa'\n           AND p1.classifier_name = 'lc_classifier'\n           AND p1.ranking = 1\n         LIMIT 1) AS SN_prob,\n        -- Get probability for CV/Nova with ranking=2\n        (SELECT p2.probability\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.class_name = 'CV/Nova'\n           AND p2.classifier_name = 'lc_classifier'\n           AND p2.ranking = 2\n         LIMIT 1) AS CV_prob\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_objects)\n),\nfiltered_objects AS (\n    -- Filter objects where the absolute difference between probabilities is less than 0.1\n    SELECT\n        oid,\n        SN_prob,\n        CV_prob\n    FROM probabilities\n    WHERE SN_prob IS NOT NULL\n      AND CV_prob IS NOT NULL\n      AND ABS(SN_prob - CV_prob) < 0.1\n)\n-- Return object IDs and probabilities with specified column names\nSELECT\n    oid,\n    SN_prob AS \"SN_prob\",\n    CV_prob AS \"CV_prob\"\nFROM filtered_objects;\n```"
                },
                "in_toks": 1832,
                "out_toks": 494,
                "id": "chatcmpl-BhN05CtpQLwgMHlmUK1jOFwuvwivz",
                "created": 1749676217,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select objects with specified classifications and rankings\nWITH selected_objects AS (\n    SELECT\n        p1.oid\n    FROM\n        probability p1\n    WHERE\n        p1.class_name = 'SNIa'\n        AND p1.classifier_name = 'lc_classifier'\n        AND p1.ranking = 1\n    INTERSECT\n    SELECT\n        p2.oid\n    FROM\n        probability p2\n    WHERE\n        p2.class_name = 'CV/Nova'\n        AND p2.classifier_name = 'lc_classifier'\n        AND p2.ranking = 2\n),\n-- Subquery to get probabilities for selected objects\nprobabilities AS (\n    SELECT\n        o.oid,\n        -- Get probability for SNIa with ranking=1\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS SN_prob,\n        -- Get probability for CV/Nova with ranking=2\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS CV_prob\n    FROM\n        object o\n    WHERE\n        o.oid IN (SELECT oid FROM selected_objects)\n),\n-- Filter objects where the difference between probabilities is less than 0.1\nfiltered_objects AS (\n    SELECT\n        oid,\n        SN_prob,\n        CV_prob\n    FROM\n        probabilities\n    WHERE\n        ABS(SN_prob - CV_prob) < 0.1\n)\n-- Final selection with specified column names\nSELECT\n    oid,\n    SN_prob AS \"SN_prob\",\n    CV_prob AS \"CV_prob\"\nFROM\n    filtered_objects;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Subquery to select objects with specified classifications and rankings\nWITH selected_objects AS (\n    SELECT\n        p1.oid\n    FROM\n        probability p1\n    WHERE\n        p1.class_name = 'SNIa'\n        AND p1.classifier_name = 'lc_classifier'\n        AND p1.ranking = 1\n    INTERSECT\n    SELECT\n        p2.oid\n    FROM\n        probability p2\n    WHERE\n        p2.class_name = 'CV/Nova'\n        AND p2.classifier_name = 'lc_classifier'\n        AND p2.ranking = 2\n),\n-- Subquery to get probabilities for selected objects\nprobabilities AS (\n    SELECT\n        o.oid,\n        -- Get probability for SNIa with ranking=1\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS SN_prob,\n        -- Get probability for CV/Nova with ranking=2\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS CV_prob\n    FROM\n        object o\n    WHERE\n        o.oid IN (SELECT oid FROM selected_objects)\n),\n-- Filter objects where the difference between probabilities is less than 0.1\nfiltered_objects AS (\n    SELECT\n        oid,\n        SN_prob,\n        CV_prob\n    FROM\n        probabilities\n    WHERE\n        ABS(SN_prob - CV_prob) < 0.1\n)\n-- Final selection with specified column names\nSELECT\n    oid,\n    SN_prob AS \"SN_prob\",\n    CV_prob AS \"CV_prob\"\nFROM\n    filtered_objects;\n```"
                    }
                },
                "in_toks": 2597,
                "out_toks": 376,
                "id": "chatcmpl-Be0QuxmNJMiZ9mWFDMgfkYMpX3hPP",
                "created": 1748874484,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 10,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 816,
                "out_toks": 14,
                "id": "chatcmpl-Be0PkwSwkkZTSPSckz1e96KVr9n77",
                "created": 1748874412,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects that have both SNIa (ranking=1) and CV/Nova (ranking=2) classifications in the lc_classifier\nWITH selected_objects AS (\n    SELECT\n        p_oid.oid\n    FROM\n        (SELECT oid FROM probability WHERE class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS p_oid\n    JOIN\n        (SELECT oid FROM probability WHERE class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS p_cvn\n    ON p_oid.oid = p_cvn.oid\n),\n-- Retrieve probabilities for SNIa and CV/Nova for these objects\nprobabilities AS (\n    SELECT\n        o.oid,\n        -- Get probability for SNIa (ranking=1)\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS SN_prob,\n        -- Get probability for CV/Nova (ranking=2)\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS CV_prob\n    FROM\n        selected_objects o\n),\n-- Filter objects where the absolute difference between probabilities is less than 0.1\nfiltered AS (\n    SELECT\n        oid,\n        SN_prob,\n        CV_prob\n    FROM\n        probabilities\n    WHERE\n        ABS(SN_prob - CV_prob) < 0.1\n)\n-- Output object IDs with their respective probabilities\nSELECT\n    oid,\n    SN_prob AS \"SN_prob\",\n    CV_prob AS \"CV_prob\"\nFROM\n    filtered;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects that have both SNIa (ranking=1) and CV/Nova (ranking=2) classifications in the lc_classifier\nWITH selected_objects AS (\n    SELECT\n        p_oid.oid\n    FROM\n        (SELECT oid FROM probability WHERE class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS p_oid\n    JOIN\n        (SELECT oid FROM probability WHERE class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS p_cvn\n    ON p_oid.oid = p_cvn.oid\n),\n-- Retrieve probabilities for SNIa and CV/Nova for these objects\nprobabilities AS (\n    SELECT\n        o.oid,\n        -- Get probability for SNIa (ranking=1)\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS SN_prob,\n        -- Get probability for CV/Nova (ranking=2)\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS CV_prob\n    FROM\n        selected_objects o\n),\n-- Filter objects where the absolute difference between probabilities is less than 0.1\nfiltered AS (\n    SELECT\n        oid,\n        SN_prob,\n        CV_prob\n    FROM\n        probabilities\n    WHERE\n        ABS(SN_prob - CV_prob) < 0.1\n)\n-- Output object IDs with their respective probabilities\nSELECT\n    oid,\n    SN_prob AS \"SN_prob\",\n    CV_prob AS \"CV_prob\"\nFROM\n    filtered;\n```"
                },
                "in_toks": 1825,
                "out_toks": 368,
                "id": "chatcmpl-BhN07W6eT6A9BJc8lkOyjyg8xD5oN",
                "created": 1749676219,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select objects with SNIa (ranking=1) and CV/Nova (ranking=2) in the lc_classifier\nWITH selected_objects AS (\n    SELECT\n        p_oid.oid\n    FROM\n        (SELECT oid FROM probability WHERE class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS p_oid\n    JOIN\n        (SELECT oid FROM probability WHERE class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS p_cvn\n    ON p_oid.oid = p_cvn.oid\n),\n-- Subquery to get probabilities for SNIa and CV/Nova for these objects\nprobabilities AS (\n    SELECT\n        o.oid,\n        -- Get probability for SNIa (ranking=1)\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS SN_prob,\n        -- Get probability for CV/Nova (ranking=2)\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS CV_prob\n    FROM\n        selected_objects o\n),\n-- Filter objects where the difference between probabilities is less than 0.1\nfiltered AS (\n    SELECT\n        oid,\n        SN_prob,\n        CV_prob\n    FROM\n        probabilities\n    WHERE\n        ABS(SN_prob - CV_prob) < 0.1\n)\n-- Final output with object IDs and probabilities\nSELECT\n    oid,\n    SN_prob,\n    CV_prob\nFROM\n    filtered;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Subquery to select objects with SNIa (ranking=1) and CV/Nova (ranking=2) in the lc_classifier\nWITH selected_objects AS (\n    SELECT\n        p_oid.oid\n    FROM\n        (SELECT oid FROM probability WHERE class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS p_oid\n    JOIN\n        (SELECT oid FROM probability WHERE class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS p_cvn\n    ON p_oid.oid = p_cvn.oid\n),\n-- Subquery to get probabilities for SNIa and CV/Nova for these objects\nprobabilities AS (\n    SELECT\n        o.oid,\n        -- Get probability for SNIa (ranking=1)\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) AS SN_prob,\n        -- Get probability for CV/Nova (ranking=2)\n        (SELECT probability FROM probability WHERE oid = o.oid AND class_name = 'CV/Nova' AND classifier_name = 'lc_classifier' AND ranking = 2) AS CV_prob\n    FROM\n        selected_objects o\n),\n-- Filter objects where the difference between probabilities is less than 0.1\nfiltered AS (\n    SELECT\n        oid,\n        SN_prob,\n        CV_prob\n    FROM\n        probabilities\n    WHERE\n        ABS(SN_prob - CV_prob) < 0.1\n)\n-- Final output with object IDs and probabilities\nSELECT\n    oid,\n    SN_prob,\n    CV_prob\nFROM\n    filtered;\n```"
                    }
                },
                "in_toks": 2597,
                "out_toks": 362,
                "id": "chatcmpl-Be0QuasnaF8TzzQQ1BCAeHNur4BA1",
                "created": 1748874484,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "10",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 816,
                "out_toks": 7,
                "id": "chatcmpl-BhLhYua3YubGX7JjbMOCDykuGgDfB",
                "created": 1749671224,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select objects with specific classifications and rankings in the lc_classifier\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n      AND (\n        (p.class_name = 'SNIa' AND p.ranking = 1)\n        OR (p.class_name = 'CV/Nova' AND p.ranking = 2)\n      )\n    GROUP BY p.oid\n    HAVING\n      -- Ensure both classes are present for the object\n      COUNT(DISTINCT CASE WHEN p.class_name = 'SNIa' AND p.ranking = 1 THEN 1 END) > 0\n      AND COUNT(DISTINCT CASE WHEN p.class_name = 'CV/Nova' AND p.ranking = 2 THEN 1 END) > 0\n)\n\n-- Main query to retrieve oids and probabilities with the specified conditions\nSELECT\n    so.oid,\n    -- Retrieve the probability for SNIa (ranking=1)\n    (SELECT p1.probability\n     FROM probability p1\n     WHERE p1.oid = so.oid\n       AND p1.class_name = 'SNIa'\n       AND p1.ranking = 1\n       AND p1.classifier_name = 'lc_classifier'\n       AND p1.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n    ) AS SN_prob,\n    -- Retrieve the probability for CV/Nova (ranking=2)\n    (SELECT p2.probability\n     FROM probability p2\n     WHERE p2.oid = so.oid\n       AND p2.class_name = 'CV/Nova'\n       AND p2.ranking = 2\n       AND p2.classifier_name = 'lc_classifier'\n       AND p2.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n    ) AS CV_prob\nFROM selected_objects so\nWHERE\n    -- Ensure the difference between the probabilities is less than 0.1\n    ABS(\n        (SELECT p1.probability\n         FROM probability p1\n         WHERE p1.oid = so.oid\n           AND p1.class_name = 'SNIa'\n           AND p1.ranking = 1\n           AND p1.classifier_name = 'lc_classifier'\n           AND p1.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n        )\n        -\n        (SELECT p2.probability\n         FROM probability p2\n         WHERE p2.oid = so.oid\n           AND p2.class_name = 'CV/Nova'\n           AND p2.ranking = 2\n           AND p2.classifier_name = 'lc_classifier'\n           AND p2.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n        )\n    ) < 0.1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select objects with specific classifications and rankings in the lc_classifier\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n      AND (\n        (p.class_name = 'SNIa' AND p.ranking = 1)\n        OR (p.class_name = 'CV/Nova' AND p.ranking = 2)\n      )\n    GROUP BY p.oid\n    HAVING\n      -- Ensure both classes are present for the object\n      COUNT(DISTINCT CASE WHEN p.class_name = 'SNIa' AND p.ranking = 1 THEN 1 END) > 0\n      AND COUNT(DISTINCT CASE WHEN p.class_name = 'CV/Nova' AND p.ranking = 2 THEN 1 END) > 0\n)\n\n-- Main query to retrieve oids and probabilities with the specified conditions\nSELECT\n    so.oid,\n    -- Retrieve the probability for SNIa (ranking=1)\n    (SELECT p1.probability\n     FROM probability p1\n     WHERE p1.oid = so.oid\n       AND p1.class_name = 'SNIa'\n       AND p1.ranking = 1\n       AND p1.classifier_name = 'lc_classifier'\n       AND p1.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n    ) AS SN_prob,\n    -- Retrieve the probability for CV/Nova (ranking=2)\n    (SELECT p2.probability\n     FROM probability p2\n     WHERE p2.oid = so.oid\n       AND p2.class_name = 'CV/Nova'\n       AND p2.ranking = 2\n       AND p2.classifier_name = 'lc_classifier'\n       AND p2.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n    ) AS CV_prob\nFROM selected_objects so\nWHERE\n    -- Ensure the difference between the probabilities is less than 0.1\n    ABS(\n        (SELECT p1.probability\n         FROM probability p1\n         WHERE p1.oid = so.oid\n           AND p1.class_name = 'SNIa'\n           AND p1.ranking = 1\n           AND p1.classifier_name = 'lc_classifier'\n           AND p1.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n        )\n        -\n        (SELECT p2.probability\n         FROM probability p2\n         WHERE p2.oid = so.oid\n           AND p2.class_name = 'CV/Nova'\n           AND p2.ranking = 2\n           AND p2.classifier_name = 'lc_classifier'\n           AND p2.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n        )\n    ) < 0.1;\n```"
                },
                "in_toks": 2597,
                "out_toks": 639,
                "id": "chatcmpl-BhLx2YI6X52x9aZzTpLIc1V1V6P2J",
                "created": 1749672184,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "10",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 816,
                "out_toks": 7,
                "id": "chatcmpl-BhLhZspYYHCtPD8eIyJazBZObeHIP",
                "created": 1749671225,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with classifications 'SNIa' and 'CV/Nova' at rankings 1 and 2 respectively, for the latest classifier version\nWITH latest_classifier_version AS (\n    SELECT MAX(classifier_version) AS max_version\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n),\nselected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    JOIN latest_classifier_version lcv ON p.classifier_version = lcv.max_version\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking IN (1, 2)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n),\n-- Retrieve probabilities for SNIa and CV/Nova for selected objects, ensuring the latest classifier version\nprobabilities AS (\n    SELECT p.oid,\n           MAX(CASE WHEN p.class_name = 'SNIa' THEN p.probability END) AS SN_prob,\n           MAX(CASE WHEN p.class_name = 'CV/Nova' THEN p.probability END) AS CV_prob\n    FROM probability p\n    JOIN latest_classifier_version lcv ON p.classifier_version = lcv.max_version\n    WHERE p.oid IN (SELECT oid FROM selected_objects)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n      AND p.classifier_name = 'lc_classifier'\n    GROUP BY p.oid\n)\n-- Final selection of objects where the difference between probabilities is less than 0.1\nSELECT o.oid,\n       p.SN_prob,\n       p.CV_prob\nFROM object o\nJOIN probabilities p ON o.oid = p.oid\nWHERE ABS(p.SN_prob - p.CV_prob) < 0.1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with classifications 'SNIa' and 'CV/Nova' at rankings 1 and 2 respectively, for the latest classifier version\nWITH latest_classifier_version AS (\n    SELECT MAX(classifier_version) AS max_version\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n),\nselected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    JOIN latest_classifier_version lcv ON p.classifier_version = lcv.max_version\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking IN (1, 2)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n),\n-- Retrieve probabilities for SNIa and CV/Nova for selected objects, ensuring the latest classifier version\nprobabilities AS (\n    SELECT p.oid,\n           MAX(CASE WHEN p.class_name = 'SNIa' THEN p.probability END) AS SN_prob,\n           MAX(CASE WHEN p.class_name = 'CV/Nova' THEN p.probability END) AS CV_prob\n    FROM probability p\n    JOIN latest_classifier_version lcv ON p.classifier_version = lcv.max_version\n    WHERE p.oid IN (SELECT oid FROM selected_objects)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n      AND p.classifier_name = 'lc_classifier'\n    GROUP BY p.oid\n)\n-- Final selection of objects where the difference between probabilities is less than 0.1\nSELECT o.oid,\n       p.SN_prob,\n       p.CV_prob\nFROM object o\nJOIN probabilities p ON o.oid = p.oid\nWHERE ABS(p.SN_prob - p.CV_prob) < 0.1;\n```"
                },
                "in_toks": 1796,
                "out_toks": 360,
                "id": "chatcmpl-BhN03lmx83hBwQTkMahjzOiLczmOE",
                "created": 1749676215,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select objects with specific classifications and rankings in the lc_classifier\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n      AND p.ranking IN (1, 2)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n),\n-- Subquery to get probabilities for SNIa and CV/Nova for the selected objects\nprobabilities AS (\n    SELECT\n        p.oid,\n        MAX(CASE WHEN p.class_name = 'SNIa' THEN p.probability END) AS SN_prob,\n        MAX(CASE WHEN p.class_name = 'CV/Nova' THEN p.probability END) AS CV_prob\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_objects)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n    GROUP BY p.oid\n)\n-- Final selection with probability difference condition\nSELECT\n    o.oid,\n    p.SN_prob,\n    p.CV_prob\nFROM object o\nJOIN probabilities p ON o.oid = p.oid\nWHERE ABS(p.SN_prob - p.CV_prob) < 0.1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select objects with specific classifications and rankings in the lc_classifier\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n      AND p.ranking IN (1, 2)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n),\n-- Subquery to get probabilities for SNIa and CV/Nova for the selected objects\nprobabilities AS (\n    SELECT\n        p.oid,\n        MAX(CASE WHEN p.class_name = 'SNIa' THEN p.probability END) AS SN_prob,\n        MAX(CASE WHEN p.class_name = 'CV/Nova' THEN p.probability END) AS CV_prob\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_objects)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n    GROUP BY p.oid\n)\n-- Final selection with probability difference condition\nSELECT\n    o.oid,\n    p.SN_prob,\n    p.CV_prob\nFROM object o\nJOIN probabilities p ON o.oid = p.oid\nWHERE ABS(p.SN_prob - p.CV_prob) < 0.1;\n```"
                },
                "in_toks": 2597,
                "out_toks": 317,
                "id": "chatcmpl-BhLx2bFedWcyt00TR7FW35Scw5crt",
                "created": 1749672184,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "15": {
        "0": {
            "req_id": 15,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection', 'magstat']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection', 'magstat']"
                    }
                },
                "in_toks": 831,
                "out_toks": 30,
                "id": "chatcmpl-Be0PlZcdQ9vOysZhnmz39OHyepV1O",
                "created": 1748874413,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, filter IDs, candid, magstat filter ID, and initial rise estimate\nWITH object_candidates AS (\n    SELECT\n        o.oid,\n        -- Get the top probability for stamp_classifier where class_name='SN' and ranking=1\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'SN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.ranking = 1\n         LIMIT 1) AS stamp_sn_prob,\n        -- Get the first detection in the first 2 days of September (mjd between 60188.0 and 60190.0)\n        (SELECT MIN(d.mjd)\n         FROM detection d\n         WHERE d.oid = o.oid\n           AND d.mjd BETWEEN 60188.0 AND 60190.0) AS first_detection_mjd\n    FROM object o\n),\nfast_risers AS (\n    SELECT\n        ac.oid,\n        ac.stamp_sn_prob,\n        ac.first_detection_mjd,\n        -- Get the filter ID of the first detection\n        (SELECT d.fid\n         FROM detection d\n         WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd\n         LIMIT 1) AS first_fid,\n        -- Get the last non-detection magnitude before the first detection in the same filter\n        (SELECT magstat.magmax_corr\n         FROM magstat\n         WHERE magstat.oid = ac.oid\n           AND magstat.firstmjd < ac.first_detection_mjd\n           AND magstat.ndet > 0\n           AND magstat.mjdendhist < ac.first_detection_mjd\n           AND magstat.fid = (SELECT d.fid FROM detection d WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd LIMIT 1)\n         ORDER BY magstat.mjdendhist DESC\n         LIMIT 1) AS last_non_detection_mag,\n        -- Get the last mjd of non-detections in the same filter before first detection\n        (SELECT magstat.lastmjd\n         FROM magstat\n         WHERE magstat.oid = ac.oid\n           AND magstat.ndet > 0\n           AND magstat.firstmjd < ac.first_detection_mjd\n           AND magstat.fid = (SELECT d.fid FROM detection d WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd LIMIT 1)\n         ORDER BY magstat.lastmjd DESC\n         LIMIT 1) AS last_mjd_non_detection\n    FROM object_candidates ac\n    WHERE ac.first_detection_mjd IS NOT NULL\n),\ninitial_rise AS (\n    SELECT\n        fr.oid,\n        -- Calculate the initial rise rate: (magmax_corr - last_non_detection_mag) / (first_detection_mjd - last_mjd_non_detection)\n        -- Ensure denominator is positive to avoid division by zero\n        CASE WHEN fr.last_mjd_non_detection IS NOT NULL AND (fr.first_detection_mjd - fr.last_mjd_non_detection) > 0\n             THEN (fr.magmax_corr - fr.last_non_detection_mag) / (fr.first_detection_mjd - fr.last_mjd_non_detection)\n             ELSE NULL\n        END AS initial_rise_rate\n    FROM fast_risers fr\n    WHERE fr.last_non_detection_mag IS NOT NULL\n      AND fr.last_mjd_non_detection IS NOT NULL\n      AND (fr.first_detection_mjd - fr.last_mjd_non_detection) > 0\n)\nSELECT\n    o.oid,\n    -- Get the maximum stamp classifier probability for class 'SN'\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1) AS stamp_classifier_prob,\n    -- Get detections for the object\n    d.candid,\n    d.fid AS detection_fid,\n    -- Get the filter ID from magstat as 'magstat_fid'\n    ms.fid AS magstat_fid,\n    -- Initial rise rate\n    ir.initial_rise_rate\nFROM object o\nJOIN detection d ON d.oid = o.oid\nJOIN magstat ms ON ms.oid = o.oid AND ms.fid = d.fid\nJOIN object_candidates oc ON oc.oid = o.oid\nJOIN initial_rise ir ON ir.oid = o.oid\nWHERE\n    -- Highest probability in stamp classifier is for class 'SN' (probability > 0)\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1) IS NOT NULL\n    AND -- First detection in the first 2 days of September\n    oc.first_detection_mjd BETWEEN 60188.0 AND 60190.0\n    AND -- Object qualifies as a fast riser (initial rise rate >= 0.25 mag/day)\n    ir.initial_rise_rate >= 0.25\nORDER BY o.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, filter IDs, candid, magstat filter ID, and initial rise estimate\nWITH object_candidates AS (\n    SELECT\n        o.oid,\n        -- Get the top probability for stamp_classifier where class_name='SN' and ranking=1\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'SN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.ranking = 1\n         LIMIT 1) AS stamp_sn_prob,\n        -- Get the first detection in the first 2 days of September (mjd between 60188.0 and 60190.0)\n        (SELECT MIN(d.mjd)\n         FROM detection d\n         WHERE d.oid = o.oid\n           AND d.mjd BETWEEN 60188.0 AND 60190.0) AS first_detection_mjd\n    FROM object o\n),\nfast_risers AS (\n    SELECT\n        ac.oid,\n        ac.stamp_sn_prob,\n        ac.first_detection_mjd,\n        -- Get the filter ID of the first detection\n        (SELECT d.fid\n         FROM detection d\n         WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd\n         LIMIT 1) AS first_fid,\n        -- Get the last non-detection magnitude before the first detection in the same filter\n        (SELECT magstat.magmax_corr\n         FROM magstat\n         WHERE magstat.oid = ac.oid\n           AND magstat.firstmjd < ac.first_detection_mjd\n           AND magstat.ndet > 0\n           AND magstat.mjdendhist < ac.first_detection_mjd\n           AND magstat.fid = (SELECT d.fid FROM detection d WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd LIMIT 1)\n         ORDER BY magstat.mjdendhist DESC\n         LIMIT 1) AS last_non_detection_mag,\n        -- Get the last mjd of non-detections in the same filter before first detection\n        (SELECT magstat.lastmjd\n         FROM magstat\n         WHERE magstat.oid = ac.oid\n           AND magstat.ndet > 0\n           AND magstat.firstmjd < ac.first_detection_mjd\n           AND magstat.fid = (SELECT d.fid FROM detection d WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd LIMIT 1)\n         ORDER BY magstat.lastmjd DESC\n         LIMIT 1) AS last_mjd_non_detection\n    FROM object_candidates ac\n    WHERE ac.first_detection_mjd IS NOT NULL\n),\ninitial_rise AS (\n    SELECT\n        fr.oid,\n        -- Calculate the initial rise rate: (magmax_corr - last_non_detection_mag) / (first_detection_mjd - last_mjd_non_detection)\n        -- Ensure denominator is positive to avoid division by zero\n        CASE WHEN fr.last_mjd_non_detection IS NOT NULL AND (fr.first_detection_mjd - fr.last_mjd_non_detection) > 0\n             THEN (fr.magmax_corr - fr.last_non_detection_mag) / (fr.first_detection_mjd - fr.last_mjd_non_detection)\n             ELSE NULL\n        END AS initial_rise_rate\n    FROM fast_risers fr\n    WHERE fr.last_non_detection_mag IS NOT NULL\n      AND fr.last_mjd_non_detection IS NOT NULL\n      AND (fr.first_detection_mjd - fr.last_mjd_non_detection) > 0\n)\nSELECT\n    o.oid,\n    -- Get the maximum stamp classifier probability for class 'SN'\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1) AS stamp_classifier_prob,\n    -- Get detections for the object\n    d.candid,\n    d.fid AS detection_fid,\n    -- Get the filter ID from magstat as 'magstat_fid'\n    ms.fid AS magstat_fid,\n    -- Initial rise rate\n    ir.initial_rise_rate\nFROM object o\nJOIN detection d ON d.oid = o.oid\nJOIN magstat ms ON ms.oid = o.oid AND ms.fid = d.fid\nJOIN object_candidates oc ON oc.oid = o.oid\nJOIN initial_rise ir ON ir.oid = o.oid\nWHERE\n    -- Highest probability in stamp classifier is for class 'SN' (probability > 0)\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1) IS NOT NULL\n    AND -- First detection in the first 2 days of September\n    oc.first_detection_mjd BETWEEN 60188.0 AND 60190.0\n    AND -- Object qualifies as a fast riser (initial rise rate >= 0.25 mag/day)\n    ir.initial_rise_rate >= 0.25\nORDER BY o.oid;\n```"
                },
                "in_toks": 4594,
                "out_toks": 1122,
                "id": "chatcmpl-BhN04zsrZr5Xg2uxKG8M8cBEYlRep",
                "created": 1749676216,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, filter IDs, candid, magstat filter ID, and initial rise estimate\nWITH object_candidates AS (\n    SELECT\n        o.oid,\n        -- Get the top probability for stamp_classifier where class_name='SN' and ranking=1\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'SN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.ranking = 1\n         LIMIT 1) AS stamp_sn_prob,\n        -- Get the first detection in the first 2 days of September (mjd between 60188.0 and 60190.0)\n        (SELECT MIN(d.mjd)\n         FROM detection d\n         WHERE d.oid = o.oid\n           AND d.mjd BETWEEN 60188.0 AND 60190.0) AS first_detection_mjd\n    FROM object o\n),\nfast_risers AS (\n    SELECT\n        ac.oid,\n        ac.stamp_sn_prob,\n        ac.first_detection_mjd,\n        -- Calculate the initial rise: difference in magnitude divided by time difference\n        -- First, get the last non-detection magnitude before the first detection in the same filter\n        (SELECT magstat.magmax_corr\n         FROM magstat\n         WHERE magstat.oid = ac.oid\n           AND magstat.firstmjd < ac.first_detection_mjd\n           AND magstat.ndet > 0\n           AND magstat.mjdendhist < ac.first_detection_mjd\n           AND magstat.fid = (SELECT d.fid FROM detection d WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd LIMIT 1)\n         ORDER BY magstat.mjdendhist DESC\n         LIMIT 1) AS last_non_detection_mag,\n        -- Get the filter ID of the first detection\n        (SELECT d.fid\n         FROM detection d\n         WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd\n         LIMIT 1) AS first_fid\n    FROM object_candidates ac\n    WHERE ac.first_detection_mjd IS NOT NULL\n),\ninitial_rise AS (\n    SELECT\n        fr.oid,\n        -- Compute the initial rise rate: (magmax_corr - last_non_detection_mag) / (first_detection_mjd - last_mjd_non_detection)\n        -- For simplicity, approximate last_mjd_non_detection as the mjd of the last non-detection before first detection\n        (fr.last_non_detection_mag - fr.magmax_corr) / (fr.first_detection_mjd - (SELECT magstat.lastmjd FROM magstat WHERE magstat.oid = fr.oid AND magstat.ndet > 0 AND magstat.firstmjd < fr.first_detection_mjd AND magstat.fid = fr.first_fid ORDER BY magstat.lastmjd DESC LIMIT 1))\n        AS initial_rise_rate\n    FROM fast_risers fr\n    WHERE fr.last_non_detection_mag IS NOT NULL\n      AND (fr.first_detection_mjd - (SELECT magstat.lastmjd FROM magstat WHERE magstat.oid = fr.oid AND magstat.ndet > 0 AND magstat.firstmjd < fr.first_detection_mjd AND magstat.fid = fr.first_fid ORDER BY magstat.lastmjd DESC LIMIT 1))) > 0\n      AND ((fr.last_non_detection_mag - fr.magmax_corr) / (fr.first_detection_mjd - (SELECT magstat.lastmjd FROM magstat WHERE magstat.oid = fr.oid AND magstat.ndet > 0 AND magstat.firstmjd < fr.first_detection_mjd AND magstat.fid = fr.first_fid ORDER BY magstat.lastmjd DESC LIMIT 1))) >= 0.25\n)\nSELECT\n    o.oid,\n    -- Get the maximum stamp classifier probability for class 'SN'\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1) AS stamp_classifier_prob,\n    -- Get detections for the object\n    d.candid,\n    d.fid AS detection_fid,\n    -- Get the filter ID from magstat as 'magstat_fid'\n    ms.fid AS magstat_fid,\n    -- Initial rise rate\n    ir.initial_rise_rate\nFROM object o\nJOIN detection d ON d.oid = o.oid\nJOIN magstat ms ON ms.oid = o.oid AND ms.fid = d.fid\nJOIN object_candidates oc ON oc.oid = o.oid\nJOIN initial_rise ir ON ir.oid = o.oid\nWHERE\n    -- Highest probability in stamp classifier is for class 'SN' (probability > 0)\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1) IS NOT NULL\n    AND\n    -- First detection in the first 2 days of September\n    oc.first_detection_mjd BETWEEN 60188.0 AND 60190.0\n    AND\n    -- Object qualifies as a fast riser (initial rise rate >= 0.25 mag/day)\n    ir.initial_rise_rate >= 0.25\nORDER BY o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, filter IDs, candid, magstat filter ID, and initial rise estimate\nWITH object_candidates AS (\n    SELECT\n        o.oid,\n        -- Get the top probability for stamp_classifier where class_name='SN' and ranking=1\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'SN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.ranking = 1\n         LIMIT 1) AS stamp_sn_prob,\n        -- Get the first detection in the first 2 days of September (mjd between 60188.0 and 60190.0)\n        (SELECT MIN(d.mjd)\n         FROM detection d\n         WHERE d.oid = o.oid\n           AND d.mjd BETWEEN 60188.0 AND 60190.0) AS first_detection_mjd\n    FROM object o\n),\nfast_risers AS (\n    SELECT\n        ac.oid,\n        ac.stamp_sn_prob,\n        ac.first_detection_mjd,\n        -- Calculate the initial rise: difference in magnitude divided by time difference\n        -- First, get the last non-detection magnitude before the first detection in the same filter\n        (SELECT magstat.magmax_corr\n         FROM magstat\n         WHERE magstat.oid = ac.oid\n           AND magstat.firstmjd < ac.first_detection_mjd\n           AND magstat.ndet > 0\n           AND magstat.mjdendhist < ac.first_detection_mjd\n           AND magstat.fid = (SELECT d.fid FROM detection d WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd LIMIT 1)\n         ORDER BY magstat.mjdendhist DESC\n         LIMIT 1) AS last_non_detection_mag,\n        -- Get the filter ID of the first detection\n        (SELECT d.fid\n         FROM detection d\n         WHERE d.oid = ac.oid AND d.mjd = ac.first_detection_mjd\n         LIMIT 1) AS first_fid\n    FROM object_candidates ac\n    WHERE ac.first_detection_mjd IS NOT NULL\n),\ninitial_rise AS (\n    SELECT\n        fr.oid,\n        -- Compute the initial rise rate: (magmax_corr - last_non_detection_mag) / (first_detection_mjd - last_mjd_non_detection)\n        -- For simplicity, approximate last_mjd_non_detection as the mjd of the last non-detection before first detection\n        (fr.last_non_detection_mag - fr.magmax_corr) / (fr.first_detection_mjd - (SELECT magstat.lastmjd FROM magstat WHERE magstat.oid = fr.oid AND magstat.ndet > 0 AND magstat.firstmjd < fr.first_detection_mjd AND magstat.fid = fr.first_fid ORDER BY magstat.lastmjd DESC LIMIT 1))\n        AS initial_rise_rate\n    FROM fast_risers fr\n    WHERE fr.last_non_detection_mag IS NOT NULL\n      AND (fr.first_detection_mjd - (SELECT magstat.lastmjd FROM magstat WHERE magstat.oid = fr.oid AND magstat.ndet > 0 AND magstat.firstmjd < fr.first_detection_mjd AND magstat.fid = fr.first_fid ORDER BY magstat.lastmjd DESC LIMIT 1))) > 0\n      AND ((fr.last_non_detection_mag - fr.magmax_corr) / (fr.first_detection_mjd - (SELECT magstat.lastmjd FROM magstat WHERE magstat.oid = fr.oid AND magstat.ndet > 0 AND magstat.firstmjd < fr.first_detection_mjd AND magstat.fid = fr.first_fid ORDER BY magstat.lastmjd DESC LIMIT 1))) >= 0.25\n)\nSELECT\n    o.oid,\n    -- Get the maximum stamp classifier probability for class 'SN'\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1) AS stamp_classifier_prob,\n    -- Get detections for the object\n    d.candid,\n    d.fid AS detection_fid,\n    -- Get the filter ID from magstat as 'magstat_fid'\n    ms.fid AS magstat_fid,\n    -- Initial rise rate\n    ir.initial_rise_rate\nFROM object o\nJOIN detection d ON d.oid = o.oid\nJOIN magstat ms ON ms.oid = o.oid AND ms.fid = d.fid\nJOIN object_candidates oc ON oc.oid = o.oid\nJOIN initial_rise ir ON ir.oid = o.oid\nWHERE\n    -- Highest probability in stamp classifier is for class 'SN' (probability > 0)\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid\n       AND p.class_name = 'SN'\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1) IS NOT NULL\n    AND\n    -- First detection in the first 2 days of September\n    oc.first_detection_mjd BETWEEN 60188.0 AND 60190.0\n    AND\n    -- Object qualifies as a fast riser (initial rise rate >= 0.25 mag/day)\n    ir.initial_rise_rate >= 0.25\nORDER BY o.oid;\n```"
                    }
                },
                "in_toks": 3956,
                "out_toks": 1176,
                "id": "chatcmpl-Be0Qv4E88C0UN4u5HYIYmTKquXJK2",
                "created": 1748874485,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 15,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection', 'magstat']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection', 'magstat']"
                    }
                },
                "in_toks": 831,
                "out_toks": 30,
                "id": "chatcmpl-Be0PlZcdQ9vOysZhnmz39OHyepV1O",
                "created": 1748874413,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers, probabilities for class SN in stamp classifier, light curve detections, and initial rise estimate\nWITH first_detections AS (\n    -- Select objects with first detection in the first 2 days of September 2023 (MJD 60188.0 to 60189.0)\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nmax_stamp_prob AS (\n    -- Select objects with highest probability for class SN in stamp classifier (ranking=1)\n    SELECT\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\ndetections AS (\n    -- All detections for objects\n    SELECT\n        d.candid,\n        d.oid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM detection d\n),\nmagstats AS (\n    -- Magstat info for objects, including magfirst and firstmjd per band\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.magsigma,\n        m.firstmjd\n    FROM magstat m\n),\ninitial_rise AS (\n    -- Calculate initial rise rate for detections at first detection epoch\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        m.magfirst,\n        m.firstmjd,\n        -- Compute rise rate: change in magnitude over time from first detection\n        (m.magfirst - d.magpsf) / NULLIF((m.firstmjd - d.mjd), 0) AS rise_rate\n    FROM detections d\n    JOIN magstats m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd = m.firstmjd\n),\nfast_risers AS (\n    -- Filter for objects with rise rate >= 0.25 mag/day\n    SELECT\n        ir.oid,\n        ir.candid,\n        ir.fid,\n        ir.mjd,\n        ir.magpsf,\n        ir.sigmapsf,\n        ir.rise_rate\n    FROM initial_rise ir\n    WHERE ir.rise_rate >= 0.25\n)\n-- Final selection combining all info\nSELECT\n    fd.oid,\n    mp.probability AS stamp_classifier_probability,\n    d.candid,\n    d.fid,\n    m.magstat_fid,\n    fr.rise_rate AS initial_rise_estimate\nFROM first_detections fd\nJOIN max_stamp_prob mp ON fd.oid = mp.oid\nJOIN detections d ON fd.oid = d.oid AND d.mjd = fd.firstmjd\nJOIN magstats m ON fd.oid = m.oid AND d.fid = m.fid\nJOIN fast_risers fr ON fd.oid = fr.oid\nORDER BY fd.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities for class SN in stamp classifier, light curve detections, and initial rise estimate\nWITH first_detections AS (\n    -- Select objects with first detection in the first 2 days of September 2023 (MJD 60188.0 to 60189.0)\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nmax_stamp_prob AS (\n    -- Select objects with highest probability for class SN in stamp classifier (ranking=1)\n    SELECT\n        p.oid,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\ndetections AS (\n    -- All detections for objects\n    SELECT\n        d.candid,\n        d.oid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM detection d\n),\nmagstats AS (\n    -- Magstat info for objects, including magfirst and firstmjd per band\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.magsigma,\n        m.firstmjd\n    FROM magstat m\n),\ninitial_rise AS (\n    -- Calculate initial rise rate for detections at first detection epoch\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        m.magfirst,\n        m.firstmjd,\n        -- Compute rise rate: change in magnitude over time from first detection\n        (m.magfirst - d.magpsf) / NULLIF((m.firstmjd - d.mjd), 0) AS rise_rate\n    FROM detections d\n    JOIN magstats m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd = m.firstmjd\n),\nfast_risers AS (\n    -- Filter for objects with rise rate >= 0.25 mag/day\n    SELECT\n        ir.oid,\n        ir.candid,\n        ir.fid,\n        ir.mjd,\n        ir.magpsf,\n        ir.sigmapsf,\n        ir.rise_rate\n    FROM initial_rise ir\n    WHERE ir.rise_rate >= 0.25\n)\n-- Final selection combining all info\nSELECT\n    fd.oid,\n    mp.probability AS stamp_classifier_probability,\n    d.candid,\n    d.fid,\n    m.magstat_fid,\n    fr.rise_rate AS initial_rise_estimate\nFROM first_detections fd\nJOIN max_stamp_prob mp ON fd.oid = mp.oid\nJOIN detections d ON fd.oid = d.oid AND d.mjd = fd.firstmjd\nJOIN magstats m ON fd.oid = m.oid AND d.fid = m.fid\nJOIN fast_risers fr ON fd.oid = fr.oid\nORDER BY fd.oid;\n```"
                },
                "in_toks": 3483,
                "out_toks": 694,
                "id": "chatcmpl-BhN06iwIuuVAodmiRbUaiSOAxKPrt",
                "created": 1749676218,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers, probabilities for class SN in stamp classifier, light curve detections, and initial rise estimate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nmax_stamp_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.ranking\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\ndetections AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM detection d\n),\nmagstats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.magsigma,\n        m.firstmjd\n    FROM magstat m\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        m.magfirst,\n        m.firstmjd,\n        (m.magfirst - d.magpsf) / (m.firstmjd - d.mjd) AS rise_rate\n    FROM detections d\n    JOIN magstats m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd = m.firstmjd\n),\nfast_risers AS (\n    SELECT\n        fr.oid,\n        fr.candid,\n        fr.fid,\n        fr.mjd,\n        fr.magpsf,\n        fr.sigmapsf,\n        fr.rise_rate\n    FROM initial_rise fr\n    WHERE fr.rise_rate >= 0.25\n)\nSELECT\n    f.oid,\n    mp.probability AS stamp_classifier_probability,\n    d.candid,\n    d.fid,\n    m.magstat_fid,\n    fr.rise_rate AS initial_rise_estimate\nFROM first_detections f\nJOIN max_stamp_prob mp ON f.oid = mp.oid\nJOIN detections d ON f.oid = d.oid AND d.mjd = f.firstmjd\nJOIN magstats m ON f.oid = m.oid AND d.fid = m.fid\nJOIN fast_risers fr ON f.oid = fr.oid\nORDER BY f.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object identifiers, probabilities for class SN in stamp classifier, light curve detections, and initial rise estimate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nmax_stamp_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.ranking\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\ndetections AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM detection d\n),\nmagstats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.magsigma,\n        m.firstmjd\n    FROM magstat m\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        m.magfirst,\n        m.firstmjd,\n        (m.magfirst - d.magpsf) / (m.firstmjd - d.mjd) AS rise_rate\n    FROM detections d\n    JOIN magstats m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd = m.firstmjd\n),\nfast_risers AS (\n    SELECT\n        fr.oid,\n        fr.candid,\n        fr.fid,\n        fr.mjd,\n        fr.magpsf,\n        fr.sigmapsf,\n        fr.rise_rate\n    FROM initial_rise fr\n    WHERE fr.rise_rate >= 0.25\n)\nSELECT\n    f.oid,\n    mp.probability AS stamp_classifier_probability,\n    d.candid,\n    d.fid,\n    m.magstat_fid,\n    fr.rise_rate AS initial_rise_estimate\nFROM first_detections f\nJOIN max_stamp_prob mp ON f.oid = mp.oid\nJOIN detections d ON f.oid = d.oid AND d.mjd = f.firstmjd\nJOIN magstats m ON f.oid = m.oid AND d.fid = m.fid\nJOIN fast_risers fr ON f.oid = fr.oid\nORDER BY f.oid;\n```"
                    }
                },
                "in_toks": 3956,
                "out_toks": 565,
                "id": "chatcmpl-Be0Qv0tJyLJqGBLjLEfpySNqYIBNL",
                "created": 1748874485,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "15",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 831,
                "out_toks": 15,
                "id": "chatcmpl-BhLhaUeHsqIzNfbaQZKev1iiOuKpt",
                "created": 1749671226,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT\n        oid,\n        stamp_prob\n    FROM\n        stamp_probs\n),\nfirst_detection AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM first_detection)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.magsigma,\n        m.firstmjd\n    FROM\n        magstat m\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        m.magfirst,\n        m.firstmjd,\n        -- Calculate the initial rise as the difference in magnitude divided by the time difference\n        CASE\n            WHEN\n                -- Find previous detection for the same object and candidate\n                (SELECT mjd FROM detection d2 WHERE d2.candid = d.candid AND d2.oid = d.oid AND d2.mjd < d.mjd ORDER BY d2.mjd DESC LIMIT 1) IS NOT NULL\n            THEN\n                -- Compute the difference in magnitude over the time difference\n                (d.magpsf - m.magfirst) / ((d.mjd) - (SELECT mjd FROM detection d2 WHERE d2.candid = d.candid AND d2.oid = d.oid AND d2.mjd < d.mjd ORDER BY d2.mjd DESC LIMIT 1))\n            ELSE NULL\n        END AS initial_rise_estimate\n    FROM\n        detections d\n    JOIN\n        magstat_info m ON d.oid = m.oid\n    WHERE\n        d.mjd = (\n            SELECT MIN(mjd)\n            FROM detection d2\n            WHERE d2.oid = d.oid AND d2.mjd >= 60188.0 AND d2.mjd <= 60189.0\n        )\n)\nSELECT\n    sp.oid,\n    sp.stamp_prob,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    m.magstat_fid,\n    ir.initial_rise_estimate\nFROM\n    max_stamp_probs sp\nJOIN\n    first_detection fd ON sp.oid = fd.oid\nJOIN\n    detection d ON sp.oid = d.oid\nJOIN\n    magstat m ON d.oid = m.oid AND d.fid = m.fid\nJOIN\n    initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\nWHERE\n    sp.stamp_prob = (\n        SELECT MAX(stamp_prob) FROM max_stamp_probs WHERE oid = sp.oid\n    )\n    AND sp.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'SN'\n          AND classifier_name = 'stamp_classifier'\n          AND ranking = 1\n    )\n    AND fd.firstmjd BETWEEN 60188.0 AND 60189.0\n    -- Ensure the object qualifies as a fast riser: magnitude increase >= 25% of the time interval\n    AND (\n        (m.magfirst - (\n            SELECT magpsf FROM detection d2\n            WHERE d2.candid = d.candid AND d2.oid = d.oid AND d2.mjd < d.mjd\n            ORDER BY d2.mjd DESC LIMIT 1\n        )) >= 0.25 * (\n            d.mjd - (\n                SELECT mjd FROM detection d2\n                WHERE d2.candid = d.candid AND d2.oid = d.oid AND d2.mjd < d.mjd\n                ORDER BY d2.mjd DESC LIMIT 1\n            )\n        )\n    )\nORDER BY\n    sp.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT\n        oid,\n        stamp_prob\n    FROM\n        stamp_probs\n),\nfirst_detection AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM first_detection)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.magsigma,\n        m.firstmjd\n    FROM\n        magstat m\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        m.magfirst,\n        m.firstmjd,\n        -- Calculate the initial rise as the difference in magnitude divided by the time difference\n        CASE\n            WHEN\n                -- Find previous detection for the same object and candidate\n                (SELECT mjd FROM detection d2 WHERE d2.candid = d.candid AND d2.oid = d.oid AND d2.mjd < d.mjd ORDER BY d2.mjd DESC LIMIT 1) IS NOT NULL\n            THEN\n                -- Compute the difference in magnitude over the time difference\n                (d.magpsf - m.magfirst) / ((d.mjd) - (SELECT mjd FROM detection d2 WHERE d2.candid = d.candid AND d2.oid = d.oid AND d2.mjd < d.mjd ORDER BY d2.mjd DESC LIMIT 1))\n            ELSE NULL\n        END AS initial_rise_estimate\n    FROM\n        detections d\n    JOIN\n        magstat_info m ON d.oid = m.oid\n    WHERE\n        d.mjd = (\n            SELECT MIN(mjd)\n            FROM detection d2\n            WHERE d2.oid = d.oid AND d2.mjd >= 60188.0 AND d2.mjd <= 60189.0\n        )\n)\nSELECT\n    sp.oid,\n    sp.stamp_prob,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    m.magstat_fid,\n    ir.initial_rise_estimate\nFROM\n    max_stamp_probs sp\nJOIN\n    first_detection fd ON sp.oid = fd.oid\nJOIN\n    detection d ON sp.oid = d.oid\nJOIN\n    magstat m ON d.oid = m.oid AND d.fid = m.fid\nJOIN\n    initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\nWHERE\n    sp.stamp_prob = (\n        SELECT MAX(stamp_prob) FROM max_stamp_probs WHERE oid = sp.oid\n    )\n    AND sp.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'SN'\n          AND classifier_name = 'stamp_classifier'\n          AND ranking = 1\n    )\n    AND fd.firstmjd BETWEEN 60188.0 AND 60189.0\n    -- Ensure the object qualifies as a fast riser: magnitude increase >= 25% of the time interval\n    AND (\n        (m.magfirst - (\n            SELECT magpsf FROM detection d2\n            WHERE d2.candid = d.candid AND d2.oid = d.oid AND d2.mjd < d.mjd\n            ORDER BY d2.mjd DESC LIMIT 1\n        )) >= 0.25 * (\n            d.mjd - (\n                SELECT mjd FROM detection d2\n                WHERE d2.candid = d.candid AND d2.oid = d.oid AND d2.mjd < d.mjd\n                ORDER BY d2.mjd DESC LIMIT 1\n            )\n        )\n    )\nORDER BY\n    sp.oid;\n```"
                },
                "in_toks": 4174,
                "out_toks": 988,
                "id": "chatcmpl-BhN08MEITPWxlfwzCUfhEddPqk4M5",
                "created": 1749676220,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT\n        oid,\n        stamp_prob\n    FROM\n        stamp_probs\n),\nfirst_detection AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM first_detection)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.magsigma,\n        m.firstmjd\n    FROM\n        magstat m\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.fid,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        m.magfirst,\n        m.firstmjd,\n        -- Calculate the initial rise as the difference in magnitude divided by the time difference\n        CASE\n            WHEN (m.firstmjd - (SELECT mjd FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1)) > 0\n                 AND (d.mjd - (SELECT mjd FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1)) > 0\n            THEN\n                (d.magpsf - m.magfirst) / ((d.mjd - m.firstmjd))\n            ELSE NULL\n        END AS initial_rise_estimate\n    FROM\n        detections d\n    JOIN\n        magstat_info m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE\n        d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= 60188.0 AND mjd <= 60189.0)\n)\nSELECT\n    sp.oid,\n    sp.stamp_prob,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    m.magstat_fid,\n    ir.initial_rise_estimate\nFROM\n    max_stamp_probs sp\nJOIN\n    first_detection fd ON sp.oid = fd.oid\nJOIN\n    detections d ON sp.oid = d.oid\nJOIN\n    magstat_info m ON d.oid = m.oid AND d.fid = m.fid\nJOIN\n    initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\nWHERE\n    sp.stamp_prob = (SELECT MAX(stamp_prob) FROM max_stamp_probs WHERE oid = sp.oid)\n    AND sp.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'SN'\n        AND classifier_name = 'stamp_classifier'\n        AND ranking = 1\n    )\n    AND fd.firstmjd BETWEEN 60188.0 AND 60189.0\n    AND (\n        -- Ensure the object qualifies as a fast riser\n        (m.magfirst - (SELECT magpsf FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1)) >= 0.25 * (d.mjd - (SELECT mjd FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1))\n    )\nORDER BY\n    sp.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT\n        oid,\n        stamp_prob\n    FROM\n        stamp_probs\n),\nfirst_detection AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM first_detection)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.magsigma,\n        m.firstmjd\n    FROM\n        magstat m\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.fid,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        m.magfirst,\n        m.firstmjd,\n        -- Calculate the initial rise as the difference in magnitude divided by the time difference\n        CASE\n            WHEN (m.firstmjd - (SELECT mjd FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1)) > 0\n                 AND (d.mjd - (SELECT mjd FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1)) > 0\n            THEN\n                (d.magpsf - m.magfirst) / ((d.mjd - m.firstmjd))\n            ELSE NULL\n        END AS initial_rise_estimate\n    FROM\n        detections d\n    JOIN\n        magstat_info m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE\n        d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= 60188.0 AND mjd <= 60189.0)\n)\nSELECT\n    sp.oid,\n    sp.stamp_prob,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    m.magstat_fid,\n    ir.initial_rise_estimate\nFROM\n    max_stamp_probs sp\nJOIN\n    first_detection fd ON sp.oid = fd.oid\nJOIN\n    detections d ON sp.oid = d.oid\nJOIN\n    magstat_info m ON d.oid = m.oid AND d.fid = m.fid\nJOIN\n    initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\nWHERE\n    sp.stamp_prob = (SELECT MAX(stamp_prob) FROM max_stamp_probs WHERE oid = sp.oid)\n    AND sp.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'SN'\n        AND classifier_name = 'stamp_classifier'\n        AND ranking = 1\n    )\n    AND fd.firstmjd BETWEEN 60188.0 AND 60189.0\n    AND (\n        -- Ensure the object qualifies as a fast riser\n        (m.magfirst - (SELECT magpsf FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1)) >= 0.25 * (d.mjd - (SELECT mjd FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1))\n    )\nORDER BY\n    sp.oid;\n```"
                },
                "in_toks": 3956,
                "out_toks": 899,
                "id": "chatcmpl-BhLkgGVS5K5m8ztegCqt2m7IGyeWW",
                "created": 1749671418,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "15",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 831,
                "out_toks": 15,
                "id": "chatcmpl-BhLha5NgS9kjZfYHIrOqeomFKOXG0",
                "created": 1749671226,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, filter IDs, candid, magstat filter ID, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT p.oid,\n           p.probability AS stamp_prob,\n           p.ranking\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT oid,\n           stamp_prob\n    FROM stamp_probs\n),\nfirst_detections AS (\n    SELECT o.oid,\n           o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections_in_time AS (\n    SELECT d.candid,\n           d.oid,\n           d.fid,\n           d.mjd,\n           d.magpsf,\n           d.sigmapsf,\n           d.ra,\n           d.dec\n    FROM detection d\n    JOIN first_detections fd ON d.oid = fd.oid\n    WHERE d.mjd = fd.firstmjd\n),\nmagstat_in_time AS (\n    SELECT m.oid,\n           m.fid AS magstat_fid,\n           m.magmean,\n           m.magfirst\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT d.oid,\n           d.fid,\n           d.candid,\n           d.mjd,\n           d.magpsf,\n           d.sigmapsf,\n           d.ra,\n           d.dec,\n           -- Calculate the initial rise as the difference between the first detection magnitude and the magfirst from magstat\n           (m.magfirst - d.magpsf) / NULLIF((d.mjd - fd.firstmjd), 0) AS initial_rise\n    FROM detections_in_time d\n    JOIN magstat_in_time m ON d.oid = m.oid AND d.fid = m.fid\n    JOIN first_detections fd ON d.oid = fd.oid\n),\nfast_risers AS (\n    SELECT o.oid,\n           sp.stamp_prob,\n           d.candid,\n           d.fid,\n           m.magstat_fid,\n           ir.initial_rise\n    FROM first_detections o\n    JOIN max_stamp_probs sp ON o.oid = sp.oid\n    JOIN detections_in_time d ON o.oid = d.oid\n    JOIN magstat_in_time m ON o.oid = m.oid AND d.fid = m.fid\n    JOIN initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\n    WHERE sp.stamp_prob = (SELECT MAX(stamp_prob) FROM stamp_probs WHERE oid = o.oid)\n      AND sp.ranking = 1\n      AND ir.initial_rise >= 0.25\n)\nSELECT\n    oid,\n    stamp_prob,\n    candid,\n    fid,\n    magstat_fid,\n    initial_rise\nFROM fast_risers\nORDER BY oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, filter IDs, candid, magstat filter ID, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT p.oid,\n           p.probability AS stamp_prob,\n           p.ranking\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT oid,\n           stamp_prob\n    FROM stamp_probs\n),\nfirst_detections AS (\n    SELECT o.oid,\n           o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections_in_time AS (\n    SELECT d.candid,\n           d.oid,\n           d.fid,\n           d.mjd,\n           d.magpsf,\n           d.sigmapsf,\n           d.ra,\n           d.dec\n    FROM detection d\n    JOIN first_detections fd ON d.oid = fd.oid\n    WHERE d.mjd = fd.firstmjd\n),\nmagstat_in_time AS (\n    SELECT m.oid,\n           m.fid AS magstat_fid,\n           m.magmean,\n           m.magfirst\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT d.oid,\n           d.fid,\n           d.candid,\n           d.mjd,\n           d.magpsf,\n           d.sigmapsf,\n           d.ra,\n           d.dec,\n           -- Calculate the initial rise as the difference between the first detection magnitude and the magfirst from magstat\n           (m.magfirst - d.magpsf) / NULLIF((d.mjd - fd.firstmjd), 0) AS initial_rise\n    FROM detections_in_time d\n    JOIN magstat_in_time m ON d.oid = m.oid AND d.fid = m.fid\n    JOIN first_detections fd ON d.oid = fd.oid\n),\nfast_risers AS (\n    SELECT o.oid,\n           sp.stamp_prob,\n           d.candid,\n           d.fid,\n           m.magstat_fid,\n           ir.initial_rise\n    FROM first_detections o\n    JOIN max_stamp_probs sp ON o.oid = sp.oid\n    JOIN detections_in_time d ON o.oid = d.oid\n    JOIN magstat_in_time m ON o.oid = m.oid AND d.fid = m.fid\n    JOIN initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\n    WHERE sp.stamp_prob = (SELECT MAX(stamp_prob) FROM stamp_probs WHERE oid = o.oid)\n      AND sp.ranking = 1\n      AND ir.initial_rise >= 0.25\n)\nSELECT\n    oid,\n    stamp_prob,\n    candid,\n    fid,\n    magstat_fid,\n    initial_rise\nFROM fast_risers\nORDER BY oid;\n```"
                },
                "in_toks": 3737,
                "out_toks": 650,
                "id": "chatcmpl-BhN041kcoVWfkrCgye4q1ubHA9mZ4",
                "created": 1749676216,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, filter IDs, candid, magstat filter ID, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT\n        oid,\n        stamp_prob\n    FROM\n        stamp_probs\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections_in_time AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM\n        detection d\n    JOIN\n        first_detections fd ON d.oid = fd.oid\n    WHERE\n        d.mjd = fd.firstmjd\n),\nmagstat_in_time AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.mjd AS magstat_mjd\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.fid,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec,\n        -- Calculate the initial rise as the difference between the first detection magnitude and the last non-detection magnitude divided by the time difference\n        -- Assuming last non-detection magnitude is available or can be approximated; since not provided, we use magfirst from magstat\n        (m.magfirst - d.magpsf) / NULLIF((d.mjd - 60188.0), 0) AS initial_rise\n    FROM\n        detections_in_time d\n    JOIN\n        magstat_in_time m ON d.oid = m.oid AND d.fid = m.fid\n),\nfast_risers AS (\n    SELECT\n        o.oid,\n        sp.stamp_prob,\n        d.candid,\n        d.fid,\n        m.magstat_fid,\n        ir.initial_rise\n    FROM\n        first_detections o\n    JOIN\n        max_stamp_probs sp ON o.oid = sp.oid\n    JOIN\n        detections_in_time d ON o.oid = d.oid\n    JOIN\n        magstat_in_time m ON o.oid = m.oid AND d.fid = m.fid\n    JOIN\n        initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\n    WHERE\n        sp.stamp_prob = (SELECT MAX(stamp_prob) FROM stamp_probs WHERE oid = o.oid)\n        AND sp.ranking = 1\n        AND ir.initial_rise >= 0.25\n)\nSELECT\n    oid,\n    stamp_prob,\n    candid,\n    fid,\n    magstat_fid,\n    initial_rise\nFROM\n    fast_risers\nORDER BY\n    oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, filter IDs, candid, magstat filter ID, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT\n        oid,\n        stamp_prob\n    FROM\n        stamp_probs\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections_in_time AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM\n        detection d\n    JOIN\n        first_detections fd ON d.oid = fd.oid\n    WHERE\n        d.mjd = fd.firstmjd\n),\nmagstat_in_time AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.mjd AS magstat_mjd\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.fid,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec,\n        -- Calculate the initial rise as the difference between the first detection magnitude and the last non-detection magnitude divided by the time difference\n        -- Assuming last non-detection magnitude is available or can be approximated; since not provided, we use magfirst from magstat\n        (m.magfirst - d.magpsf) / NULLIF((d.mjd - 60188.0), 0) AS initial_rise\n    FROM\n        detections_in_time d\n    JOIN\n        magstat_in_time m ON d.oid = m.oid AND d.fid = m.fid\n),\nfast_risers AS (\n    SELECT\n        o.oid,\n        sp.stamp_prob,\n        d.candid,\n        d.fid,\n        m.magstat_fid,\n        ir.initial_rise\n    FROM\n        first_detections o\n    JOIN\n        max_stamp_probs sp ON o.oid = sp.oid\n    JOIN\n        detections_in_time d ON o.oid = d.oid\n    JOIN\n        magstat_in_time m ON o.oid = m.oid AND d.fid = m.fid\n    JOIN\n        initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\n    WHERE\n        sp.stamp_prob = (SELECT MAX(stamp_prob) FROM stamp_probs WHERE oid = o.oid)\n        AND sp.ranking = 1\n        AND ir.initial_rise >= 0.25\n)\nSELECT\n    oid,\n    stamp_prob,\n    candid,\n    fid,\n    magstat_fid,\n    initial_rise\nFROM\n    fast_risers\nORDER BY\n    oid;\n```"
                },
                "in_toks": 3956,
                "out_toks": 732,
                "id": "chatcmpl-BhLkgD3z4Qe3viXz54uOfipKrY3AF",
                "created": 1749671418,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "4": {
        "0": {
            "req_id": 4,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection', 'magstat']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection', 'magstat']"
                    }
                },
                "in_toks": 817,
                "out_toks": 30,
                "id": "chatcmpl-Be0Pm06YBrCsTajk4iMDZmmAsGS14",
                "created": 1748874414,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object and detection details for SN II objects with specified conditions\nWITH sn2_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNIIn' -- SN II class\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 2458600 AND 2459580 -- years 2019-2022 in MJD\n      AND o.ndet > 50\n),\nsn2_detections AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.ra, d.dec, d.fid\n    FROM detection d\n    JOIN sn2_objects so ON d.oid = so.oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    -- Use window functions to get first detection time and magnitude per object\n    FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) AS first_mjd,\n    FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) AS first_mag,\n    -- Calculate initial rise rate (mag/day) if at least two detections exist\n    CASE\n        WHEN COUNT(*) OVER (PARTITION BY d.oid) >= 2 THEN\n            (\n                LAST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd)\n            ) / (\n                LAST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd)\n            )\n        ELSE NULL\n    END AS initial_rise_rate,\n    d.fid\nFROM sn2_detections d\nWHERE\n    -- Filter for g (fid=1) and r (fid=2) bands\n    d.fid IN (1, 2)\n    -- Ensure initial rise rate exceeds 0.5 mag/day\n    AND (\n        CASE\n            WHEN COUNT(*) OVER (PARTITION BY d.oid) >= 2 THEN\n                (\n                    LAST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd)\n                ) / (\n                    LAST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd)\n                )\n            ELSE 0\n        END\n    ) > 0.5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object and detection details for SN II objects with specified conditions\nWITH sn2_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNIIn' -- SN II class\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 2458600 AND 2459580 -- years 2019-2022 in MJD\n      AND o.ndet > 50\n),\nsn2_detections AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.ra, d.dec, d.fid\n    FROM detection d\n    JOIN sn2_objects so ON d.oid = so.oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    -- Use window functions to get first detection time and magnitude per object\n    FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) AS first_mjd,\n    FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) AS first_mag,\n    -- Calculate initial rise rate (mag/day) if at least two detections exist\n    CASE\n        WHEN COUNT(*) OVER (PARTITION BY d.oid) >= 2 THEN\n            (\n                LAST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd)\n            ) / (\n                LAST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd)\n            )\n        ELSE NULL\n    END AS initial_rise_rate,\n    d.fid\nFROM sn2_detections d\nWHERE\n    -- Filter for g (fid=1) and r (fid=2) bands\n    d.fid IN (1, 2)\n    -- Ensure initial rise rate exceeds 0.5 mag/day\n    AND (\n        CASE\n            WHEN COUNT(*) OVER (PARTITION BY d.oid) >= 2 THEN\n                (\n                    LAST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd)\n                ) / (\n                    LAST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd)\n                )\n            ELSE 0\n        END\n    ) > 0.5;\n```"
                },
                "in_toks": 3500,
                "out_toks": 630,
                "id": "chatcmpl-BhN06t7nPming9Jjrt0KnE1qnuPog",
                "created": 1749676218,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object and detection details for SN II objects with specified conditions\nWITH sn2_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNIIn' -- SN II class\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 2458600 AND 2459580 -- years 2019-2022 in MJD\n      AND o.ndet > 50\n),\nsn2_detections AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.ra, d.dec, d.fid\n    FROM detection d\n    JOIN sn2_objects so ON d.oid = so.oid\n)\nSELECT\n    so.oid,\n    d.candid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    -- Estimate initial rise rate (mag/day) as difference in magnitude over time between first and second detection\n    -- For simplicity, assume the earliest detection as initial point\n    -- Use window functions to get first detection per object\n    FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) AS first_mjd,\n    FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) AS first_mag,\n    -- Calculate initial rise rate if second detection exists\n    CASE\n        WHEN COUNT(*) OVER (PARTITION BY d.oid) >= 2 THEN\n            (LAST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd))\n            / (LAST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd))\n        ELSE NULL\n    END AS initial_rise_rate,\n    d.fid\nFROM sn2_detections d\nWHERE\n    -- Filter for g and r bands (fid=1 and 2)\n    d.fid IN (1, 2)\n    -- Calculate initial rise rate > 0.5 mag/day\n    AND (\n        CASE\n            WHEN COUNT(*) OVER (PARTITION BY d.oid) >= 2 THEN\n                (LAST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd))\n                / (LAST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd))\n            ELSE 0\n        END\n    ) > 0.5\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object and detection details for SN II objects with specified conditions\nWITH sn2_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNIIn' -- SN II class\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 2458600 AND 2459580 -- years 2019-2022 in MJD\n      AND o.ndet > 50\n),\nsn2_detections AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.ra, d.dec, d.fid\n    FROM detection d\n    JOIN sn2_objects so ON d.oid = so.oid\n)\nSELECT\n    so.oid,\n    d.candid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    -- Estimate initial rise rate (mag/day) as difference in magnitude over time between first and second detection\n    -- For simplicity, assume the earliest detection as initial point\n    -- Use window functions to get first detection per object\n    FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) AS first_mjd,\n    FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) AS first_mag,\n    -- Calculate initial rise rate if second detection exists\n    CASE\n        WHEN COUNT(*) OVER (PARTITION BY d.oid) >= 2 THEN\n            (LAST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd))\n            / (LAST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd))\n        ELSE NULL\n    END AS initial_rise_rate,\n    d.fid\nFROM sn2_detections d\nWHERE\n    -- Filter for g and r bands (fid=1 and 2)\n    d.fid IN (1, 2)\n    -- Calculate initial rise rate > 0.5 mag/day\n    AND (\n        CASE\n            WHEN COUNT(*) OVER (PARTITION BY d.oid) >= 2 THEN\n                (LAST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd))\n                / (LAST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) - FIRST_VALUE(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd))\n            ELSE 0\n        END\n    ) > 0.5\n```"
                    }
                },
                "in_toks": 3863,
                "out_toks": 642,
                "id": "chatcmpl-Be0R1w83ZwukiO799rqHTl7lpzXB4",
                "created": 1748874491,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 4,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection', 'magstat']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection', 'magstat']"
                    }
                },
                "in_toks": 817,
                "out_toks": 30,
                "id": "chatcmpl-Be0Pm06YBrCsTajk4iMDZmmAsGS14",
                "created": 1748874414,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object and detection details for SN II objects with specified conditions\nSELECT \n    o.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    mstat.dmdt_first AS initial_rise_rate,\n    d.fid\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    magstat mstat ON o.oid = mstat.oid AND mstat.fid = d.fid\nWHERE \n    -- Filter for SN II class with probability > 0.6\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNII'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n    AND \n    -- Filter for objects classified as SN II\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNII'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n    AND \n    -- Filter for initial rise rate > 0.5 mag/day\n    mstat.dmdt_first > 0.5\n    AND \n    -- Filter for detections in 2019-2022\n    o.firstmjd BETWEEN 2458600 AND 2459900\n    AND \n    -- Filter for total number of detections > 50\n    o.ndet > 50\n    AND \n    -- Filter for band (fid) being g (1) or r (2)\n    d.fid IN (1, 2)\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object and detection details for SN II objects with specified conditions\nSELECT \n    o.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    mstat.dmdt_first AS initial_rise_rate,\n    d.fid\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    magstat mstat ON o.oid = mstat.oid AND mstat.fid = d.fid\nWHERE \n    -- Filter for SN II class with probability > 0.6\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNII'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n    AND \n    -- Filter for objects classified as SN II\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNII'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n    AND \n    -- Filter for initial rise rate > 0.5 mag/day\n    mstat.dmdt_first > 0.5\n    AND \n    -- Filter for detections in 2019-2022\n    o.firstmjd BETWEEN 2458600 AND 2459900\n    AND \n    -- Filter for total number of detections > 50\n    o.ndet > 50\n    AND \n    -- Filter for band (fid) being g (1) or r (2)\n    d.fid IN (1, 2)\n```"
                    }
                },
                "in_toks": 3863,
                "out_toks": 414,
                "id": "chatcmpl-Be0R1mgd3eFTrt6wCgXJ7xlEeF0iH",
                "created": 1748874491,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "4",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 817,
                "out_toks": 15,
                "id": "chatcmpl-BhLhbLNAPxeFqzN8qjDeoPa29CZnL",
                "created": 1749671227,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select relevant information for SN II objects with specified conditions\nWITH snii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484 AND 58824 -- Corresponds to years 2019-2022\n),\nsnii_candidates AS (\n    SELECT c.candid,\n           c.oid,\n           c.mjd,\n           c.ra,\n           c.dec,\n           c.magpsf,\n           c.sigmapsf,\n           c.fid\n    FROM detection c\n    WHERE c.oid IN (SELECT oid FROM snii_objects)\n),\nmag_stats AS (\n    SELECT m.oid,\n           m.fid,\n           m.magmean,\n           m.magmean_corr,\n           m.dmdt_first\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM snii_objects)\n),\ndetections_count AS (\n    SELECT oid,\n           COUNT(*) AS ndet\n    FROM detection\n    GROUP BY oid\n)\n-- Main query to retrieve desired info with filters\nSELECT \n    c.oid,\n    c.candid,\n    c.mjd,\n    c.magpsf,\n    c.sigmapsf,\n    c.fid AS band_id,\n    m.magmean,\n    m.magmean_corr,\n    m.dmdt_first AS initial_rise_rate,\n    d.ndet\nFROM snii_candidates c\nJOIN mag_stats m ON c.oid = m.oid AND c.fid = m.fid\nJOIN detections_count d ON c.oid = d.oid\nWHERE d.ndet > 50\n  AND c.mjd BETWEEN 58484 AND 58824\n  AND m.dmdt_first > 0.5\n  AND c.fid IN (1, 2); -- g and r bands\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant information for SN II objects with specified conditions\nWITH snii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484 AND 58824 -- Corresponds to years 2019-2022\n),\nsnii_candidates AS (\n    SELECT c.candid,\n           c.oid,\n           c.mjd,\n           c.ra,\n           c.dec,\n           c.magpsf,\n           c.sigmapsf,\n           c.fid\n    FROM detection c\n    WHERE c.oid IN (SELECT oid FROM snii_objects)\n),\nmag_stats AS (\n    SELECT m.oid,\n           m.fid,\n           m.magmean,\n           m.magmean_corr,\n           m.dmdt_first\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM snii_objects)\n),\ndetections_count AS (\n    SELECT oid,\n           COUNT(*) AS ndet\n    FROM detection\n    GROUP BY oid\n)\n-- Main query to retrieve desired info with filters\nSELECT \n    c.oid,\n    c.candid,\n    c.mjd,\n    c.magpsf,\n    c.sigmapsf,\n    c.fid AS band_id,\n    m.magmean,\n    m.magmean_corr,\n    m.dmdt_first AS initial_rise_rate,\n    d.ndet\nFROM snii_candidates c\nJOIN mag_stats m ON c.oid = m.oid AND c.fid = m.fid\nJOIN detections_count d ON c.oid = d.oid\nWHERE d.ndet > 50\n  AND c.mjd BETWEEN 58484 AND 58824\n  AND m.dmdt_first > 0.5\n  AND c.fid IN (1, 2); -- g and r bands\n```"
                },
                "in_toks": 3227,
                "out_toks": 430,
                "id": "chatcmpl-BhN055tCeKuSfsdtqdQ2ZvuujmipC",
                "created": 1749676217,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant information for SN II objects with specified conditions\nWITH snii_objects AS (\n    SELECT o.oid, p.oid, p.class_name, p.probability, p.ranking\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484 AND 58824 -- Corresponds to years 2019-2022\n),\nsnii_candidates AS (\n    SELECT c.candid, c.oid, c.mjd, c.ra, c.dec, c.magpsf, c.sigmapsf, c.fid\n    FROM detection c\n    WHERE c.oid IN (SELECT oid FROM snii_objects)\n),\nmag_stats AS (\n    SELECT m.oid, m.fid, m.magmean, m.magmean_corr, m.dmdt_first\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM snii_objects)\n),\ndetections_count AS (\n    SELECT oid, COUNT(*) AS ndet\n    FROM detection\n    GROUP BY oid\n),\ninitial_rise AS (\n    SELECT s.oid, s.fid, s.mjd, s.magpsf, s.sigmapsf, s.dmdt_first\n    FROM magstat s\n    WHERE s.oid IN (SELECT oid FROM snii_objects)\n      AND s.dmdt_first > 0.5\n)\nSELECT \n    c.oid,\n    c.candid,\n    c.mjd,\n    c.magpsf,\n    c.sigmapsf,\n    c.fid AS band_id,\n    m.magmean,\n    m.magmean_corr,\n    m.dmdt_first AS initial_rise_rate,\n    d.ndet\nFROM snii_candidates c\nJOIN mag_stats m ON c.oid = m.oid AND c.fid = m.fid\nJOIN detections_count d ON c.oid = d.oid\nWHERE d.ndet > 50\n  AND c.mjd BETWEEN 58484 AND 58824\n  AND m.dmdt_first > 0.5\n  AND c.fid IN (1, 2); -- g and r bands\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant information for SN II objects with specified conditions\nWITH snii_objects AS (\n    SELECT o.oid, p.oid, p.class_name, p.probability, p.ranking\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484 AND 58824 -- Corresponds to years 2019-2022\n),\nsnii_candidates AS (\n    SELECT c.candid, c.oid, c.mjd, c.ra, c.dec, c.magpsf, c.sigmapsf, c.fid\n    FROM detection c\n    WHERE c.oid IN (SELECT oid FROM snii_objects)\n),\nmag_stats AS (\n    SELECT m.oid, m.fid, m.magmean, m.magmean_corr, m.dmdt_first\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM snii_objects)\n),\ndetections_count AS (\n    SELECT oid, COUNT(*) AS ndet\n    FROM detection\n    GROUP BY oid\n),\ninitial_rise AS (\n    SELECT s.oid, s.fid, s.mjd, s.magpsf, s.sigmapsf, s.dmdt_first\n    FROM magstat s\n    WHERE s.oid IN (SELECT oid FROM snii_objects)\n      AND s.dmdt_first > 0.5\n)\nSELECT \n    c.oid,\n    c.candid,\n    c.mjd,\n    c.magpsf,\n    c.sigmapsf,\n    c.fid AS band_id,\n    m.magmean,\n    m.magmean_corr,\n    m.dmdt_first AS initial_rise_rate,\n    d.ndet\nFROM snii_candidates c\nJOIN mag_stats m ON c.oid = m.oid AND c.fid = m.fid\nJOIN detections_count d ON c.oid = d.oid\nWHERE d.ndet > 50\n  AND c.mjd BETWEEN 58484 AND 58824\n  AND m.dmdt_first > 0.5\n  AND c.fid IN (1, 2); -- g and r bands\n```"
                },
                "in_toks": 3863,
                "out_toks": 494,
                "id": "chatcmpl-BhLkghnM1LQ2FF6iZVVnHf6QuPX5N",
                "created": 1749671418,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "4",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 817,
                "out_toks": 15,
                "id": "chatcmpl-BhLhbqNJgc5NsFcazSCIhusLicz10",
                "created": 1749671227,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select relevant information for SN II objects with specified conditions, optimized for performance\nWITH snii_objects AS (\n    -- Get object OIDs with classification as SN II, probability > 0.6, and ranking=1, with additional probability conditions\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIi'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.probability IS NOT NULL -- ensure probability is not null\n),\nfiltered_objects AS (\n    -- Filter objects with more than 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 50\n),\ncandidate_ids AS (\n    -- Get candidate IDs for objects in filtered_objects\n    SELECT d.candid, d.oid, d.mjd, d.fid, d.magpsf, d.sigmapsf, d.ra, d.dec\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\nlight_curve_stats AS (\n    -- Calculate first and last detection times and magnitudes per object and band\n    SELECT\n        c.oid,\n        c.candid,\n        c.mjd,\n        c.fid,\n        c.magpsf,\n        c.sigmapsf,\n        c.ra,\n        c.dec,\n        -- First detection time per object and band\n        FIRST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mjd,\n        -- First detection magnitude per object and band\n        FIRST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mag,\n        -- Last detection time per object and band\n        LAST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mjd,\n        -- Last detection magnitude per object and band\n        LAST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mag\n    FROM candidate_ids c\n),\nrise_rates AS (\n    -- Calculate initial rise rate (mag/day) for each object and band, avoiding division by zero\n    SELECT\n        oid,\n        candid,\n        first_mjd,\n        last_mjd,\n        first_mag,\n        last_mag,\n        CASE WHEN (last_mjd - first_mjd) > 0 THEN (last_mag - first_mag) / (last_mjd - first_mjd) ELSE NULL END AS rise_rate\n    FROM light_curve_stats\n),\nfinal_objects AS (\n    -- Filter objects with rise rate > 0.5 mag/day\n    SELECT DISTINCT o.oid\n    FROM rise_rates o\n    WHERE o.rise_rate > 0.5\n)\n-- Final selection of detection details for objects matching all criteria\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.ra,\n    d.dec\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM final_objects)\n  AND d.mjd BETWEEN 2019 AND 2022\n  AND d.fid IN (1, 2) -- g and r bands\n  AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = d.oid\n        AND p.class_name = 'SNIi'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.6\n        AND p.ranking = 1\n        AND p.probability IS NOT NULL -- ensure probability is valid\n  )\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant information for SN II objects with specified conditions, optimized for performance\nWITH snii_objects AS (\n    -- Get object OIDs with classification as SN II, probability > 0.6, and ranking=1, with additional probability conditions\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIi'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.probability IS NOT NULL -- ensure probability is not null\n),\nfiltered_objects AS (\n    -- Filter objects with more than 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 50\n),\ncandidate_ids AS (\n    -- Get candidate IDs for objects in filtered_objects\n    SELECT d.candid, d.oid, d.mjd, d.fid, d.magpsf, d.sigmapsf, d.ra, d.dec\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\nlight_curve_stats AS (\n    -- Calculate first and last detection times and magnitudes per object and band\n    SELECT\n        c.oid,\n        c.candid,\n        c.mjd,\n        c.fid,\n        c.magpsf,\n        c.sigmapsf,\n        c.ra,\n        c.dec,\n        -- First detection time per object and band\n        FIRST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mjd,\n        -- First detection magnitude per object and band\n        FIRST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mag,\n        -- Last detection time per object and band\n        LAST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mjd,\n        -- Last detection magnitude per object and band\n        LAST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mag\n    FROM candidate_ids c\n),\nrise_rates AS (\n    -- Calculate initial rise rate (mag/day) for each object and band, avoiding division by zero\n    SELECT\n        oid,\n        candid,\n        first_mjd,\n        last_mjd,\n        first_mag,\n        last_mag,\n        CASE WHEN (last_mjd - first_mjd) > 0 THEN (last_mag - first_mag) / (last_mjd - first_mjd) ELSE NULL END AS rise_rate\n    FROM light_curve_stats\n),\nfinal_objects AS (\n    -- Filter objects with rise rate > 0.5 mag/day\n    SELECT DISTINCT o.oid\n    FROM rise_rates o\n    WHERE o.rise_rate > 0.5\n)\n-- Final selection of detection details for objects matching all criteria\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.ra,\n    d.dec\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM final_objects)\n  AND d.mjd BETWEEN 2019 AND 2022\n  AND d.fid IN (1, 2) -- g and r bands\n  AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = d.oid\n        AND p.class_name = 'SNIi'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.6\n        AND p.ranking = 1\n        AND p.probability IS NOT NULL -- ensure probability is valid\n  )\n```"
                },
                "in_toks": 3826,
                "out_toks": 826,
                "id": "chatcmpl-BhN08zLTER5xtkXGgsLI3PTWNweOJ",
                "created": 1749676220,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant information for SN II objects with specified conditions\nWITH snii_objects AS (\n    -- Get object OIDs with classification as SN II, probability > 0.6, and ranking=1\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIi'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nfiltered_objects AS (\n    -- Filter objects with more than 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 50\n),\ncandidate_ids AS (\n    -- Get candidate IDs for objects in filtered_objects\n    SELECT d.candid, d.oid, d.mjd, d.fid, d.magpsf, d.sigmapsf, d.ra, d.dec\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\nlight_curve_stats AS (\n    -- Calculate initial rise estimate and rate for each object and band\n    SELECT\n        c.oid,\n        c.candid,\n        c.mjd,\n        c.fid,\n        c.magpsf,\n        c.sigmapsf,\n        c.ra,\n        c.dec,\n        -- Get first detection time per object and band\n        FIRST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mjd,\n        -- Get first detection magnitude per object and band\n        FIRST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mag,\n        -- Get last detection time per object and band\n        LAST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mjd,\n        -- Get last detection magnitude per object and band\n        LAST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mag\n    FROM candidate_ids c\n),\nrise_rates AS (\n    -- Calculate initial rise rate (mag/day) for each object and band\n    SELECT\n        oid,\n        candid,\n        first_mjd,\n        last_mjd,\n        first_mag,\n        last_mag,\n        -- Avoid division by zero\n        CASE WHEN (last_mjd - first_mjd) > 0 THEN (last_mag - first_mag) / (last_mjd - first_mjd) ELSE NULL END AS rise_rate\n    FROM light_curve_stats\n),\nfinal_objects AS (\n    -- Filter objects with rise rate > 0.5 mag/day\n    SELECT DISTINCT o.oid\n    FROM rise_rates o\n    WHERE o.rise_rate > 0.5\n)\n-- Final selection of object and detection details with required filters\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.ra,\n    d.dec\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM final_objects)\n  AND d.mjd BETWEEN 2019 AND 2022\n  AND d.fid IN (1, 2) -- g and r bands\n  AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = d.oid\n        AND p.class_name = 'SNIi'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.6\n        AND p.ranking = 1\n  )\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant information for SN II objects with specified conditions\nWITH snii_objects AS (\n    -- Get object OIDs with classification as SN II, probability > 0.6, and ranking=1\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIi'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nfiltered_objects AS (\n    -- Filter objects with more than 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 50\n),\ncandidate_ids AS (\n    -- Get candidate IDs for objects in filtered_objects\n    SELECT d.candid, d.oid, d.mjd, d.fid, d.magpsf, d.sigmapsf, d.ra, d.dec\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\nlight_curve_stats AS (\n    -- Calculate initial rise estimate and rate for each object and band\n    SELECT\n        c.oid,\n        c.candid,\n        c.mjd,\n        c.fid,\n        c.magpsf,\n        c.sigmapsf,\n        c.ra,\n        c.dec,\n        -- Get first detection time per object and band\n        FIRST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mjd,\n        -- Get first detection magnitude per object and band\n        FIRST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mag,\n        -- Get last detection time per object and band\n        LAST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mjd,\n        -- Get last detection magnitude per object and band\n        LAST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mag\n    FROM candidate_ids c\n),\nrise_rates AS (\n    -- Calculate initial rise rate (mag/day) for each object and band\n    SELECT\n        oid,\n        candid,\n        first_mjd,\n        last_mjd,\n        first_mag,\n        last_mag,\n        -- Avoid division by zero\n        CASE WHEN (last_mjd - first_mjd) > 0 THEN (last_mag - first_mag) / (last_mjd - first_mjd) ELSE NULL END AS rise_rate\n    FROM light_curve_stats\n),\nfinal_objects AS (\n    -- Filter objects with rise rate > 0.5 mag/day\n    SELECT DISTINCT o.oid\n    FROM rise_rates o\n    WHERE o.rise_rate > 0.5\n)\n-- Final selection of object and detection details with required filters\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.ra,\n    d.dec\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM final_objects)\n  AND d.mjd BETWEEN 2019 AND 2022\n  AND d.fid IN (1, 2) -- g and r bands\n  AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = d.oid\n        AND p.class_name = 'SNIi'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.6\n        AND p.ranking = 1\n  )\n```"
                },
                "in_toks": 3863,
                "out_toks": 790,
                "id": "chatcmpl-BhLksLjZDS6mw9HR70Iu012YUdNdT",
                "created": 1749671430,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "25": {
        "0": {
            "req_id": 25,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "stamp"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'stamp']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'stamp']"
                    }
                },
                "in_toks": 826,
                "out_toks": 20,
                "id": "chatcmpl-Be0PtY0j8ahZ2TRLnPu7wJuKgVM3k",
                "created": 1748874421,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\nobjects_near_sources AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON true\n    WHERE EXISTS (\n        SELECT 1\n        FROM sources s2\n        WHERE q3c_join(o.meanra, o.meandec, s2.column2, s2.column3, 10)\n    )\n),\nobjects_in_time_window AS (\n    SELECT o.*\n    FROM objects_near_sources o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT o.*\nFROM objects_in_time_window o\nJOIN object_with_prob p ON o.oid = p.oid;",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\nobjects_near_sources AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON true\n    WHERE EXISTS (\n        SELECT 1\n        FROM sources s2\n        WHERE q3c_join(o.meanra, o.meandec, s2.column2, s2.column3, 10)\n    )\n),\nobjects_in_time_window AS (\n    SELECT o.*\n    FROM objects_near_sources o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT o.*\nFROM objects_in_time_window o\nJOIN object_with_prob p ON o.oid = p.oid;"
                    }
                },
                "in_toks": 2636,
                "out_toks": 275,
                "id": "chatcmpl-Be0R12ernN9lhUSIGXlv1wvJKwBx6",
                "created": 1748874491,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 25,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "stamp"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'stamp']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'stamp']"
                    }
                },
                "in_toks": 826,
                "out_toks": 20,
                "id": "chatcmpl-Be0PtY0j8ahZ2TRLnPu7wJuKgVM3k",
                "created": 1748874421,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Define source positions with their names, RA, and Dec\nWITH sources AS (\n    SELECT * FROM (VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n    ) AS s(source_name, ra, dec)\n),\n-- Select objects with SN class probability > 0.4, ranking=1, and classifier 'stamp_classifier'\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\n-- Find objects within 10 degrees of each source position\nobjects_near_sources AS (\n    SELECT o.*\n    FROM object o\n    CROSS JOIN sources s\n    WHERE -- Use q3c_join for angular distance within 10 degrees\n        q3c_join(o.meanra, o.meandec, s.ra, s.dec, 10)\n),\n-- Filter objects whose first detection (firstmjd) is within the first 7 days of February 2023\nobjects_in_time_window AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\n-- Final selection: objects near sources, with SN probability > 0.4, ranking=1, and first detection in the specified time window\nSELECT DISTINCT o.*\nFROM objects_near_sources o\nJOIN object_with_prob p ON o.oid = p.oid\nWHERE o.firstmjd BETWEEN 59976.0 AND 59983.0;",
            "sql_response": {
                "responses": {
                    "0": "-- Define source positions with their names, RA, and Dec\nWITH sources AS (\n    SELECT * FROM (VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n    ) AS s(source_name, ra, dec)\n),\n-- Select objects with SN class probability > 0.4, ranking=1, and classifier 'stamp_classifier'\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\n-- Find objects within 10 degrees of each source position\nobjects_near_sources AS (\n    SELECT o.*\n    FROM object o\n    CROSS JOIN sources s\n    WHERE -- Use q3c_join for angular distance within 10 degrees\n        q3c_join(o.meanra, o.meandec, s.ra, s.dec, 10)\n),\n-- Filter objects whose first detection (firstmjd) is within the first 7 days of February 2023\nobjects_in_time_window AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\n-- Final selection: objects near sources, with SN probability > 0.4, ranking=1, and first detection in the specified time window\nSELECT DISTINCT o.*\nFROM objects_near_sources o\nJOIN object_with_prob p ON o.oid = p.oid\nWHERE o.firstmjd BETWEEN 59976.0 AND 59983.0;"
                },
                "in_toks": 1888,
                "out_toks": 401,
                "id": "chatcmpl-BhN08Xyfv603QfXI2w6cp4essfVmt",
                "created": 1749676220,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\nobjects_near_sources AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON true\n    WHERE EXISTS (\n        SELECT 1\n        FROM sources s2\n        WHERE s2.source_id = s.source_id\n        AND q3c_join(o.meanra, o.meandec, s2.column2, s2.column3, 10)\n    )\n),\nobjects_in_time_window AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT DISTINCT o.*\nFROM objects_near_sources o\nJOIN object_with_prob p ON o.oid = p.oid\nWHERE EXISTS (\n    SELECT 1\n    FROM object o2\n    WHERE o2.oid = o.oid\n      AND o2.firstmjd BETWEEN 59976.0 AND 59983.0\n);",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\nobjects_near_sources AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON true\n    WHERE EXISTS (\n        SELECT 1\n        FROM sources s2\n        WHERE s2.source_id = s.source_id\n        AND q3c_join(o.meanra, o.meandec, s2.column2, s2.column3, 10)\n    )\n),\nobjects_in_time_window AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT DISTINCT o.*\nFROM objects_near_sources o\nJOIN object_with_prob p ON o.oid = p.oid\nWHERE EXISTS (\n    SELECT 1\n    FROM object o2\n    WHERE o2.oid = o.oid\n      AND o2.firstmjd BETWEEN 59976.0 AND 59983.0\n);"
                    }
                },
                "in_toks": 2636,
                "out_toks": 330,
                "id": "chatcmpl-Be0R6zuEm0eSSZudnes2oIny7W4wC",
                "created": 1748874496,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "25",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 7,
                "id": "chatcmpl-BhLhdRqFp6F63OV8GVYCjORUWnBEA",
                "created": 1749671229,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\ncandidate_objects AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON TRUE\n    WHERE EXISTS (\n        SELECT 1\n        FROM object_with_prob op\n        WHERE op.oid = o.oid\n    )\n    AND (\n        q3c_radial_query(o.meanra, o.meandec, s.column2, s.column3, 10)\n    )\n),\nfirst_detection_window AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT DISTINCT c.*\nFROM candidate_objects c\nJOIN first_detection_window fd ON c.oid = fd.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\ncandidate_objects AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON TRUE\n    WHERE EXISTS (\n        SELECT 1\n        FROM object_with_prob op\n        WHERE op.oid = o.oid\n    )\n    AND (\n        q3c_radial_query(o.meanra, o.meandec, s.column2, s.column3, 10)\n    )\n),\nfirst_detection_window AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT DISTINCT c.*\nFROM candidate_objects c\nJOIN first_detection_window fd ON c.oid = fd.oid;"
                },
                "in_toks": 2635,
                "out_toks": 285,
                "id": "chatcmpl-BhLkrnco1ePMVR4dhLVEb2YoGVDr1",
                "created": 1749671429,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "25",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 7,
                "id": "chatcmpl-BhLheyiGWvhF4MEbnLZawP6eb7oLr",
                "created": 1749671230,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\ncandidate_objects AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON TRUE\n    WHERE EXISTS (\n        SELECT 1\n        FROM object_with_prob op\n        WHERE op.oid = o.oid\n    )\n    AND (\n        q3c_radial_query(o.meanra, o.meandec, s.column2, s.column3, 10)\n    )\n),\nfirst_detection_window AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT DISTINCT c.*\nFROM candidate_objects c\nJOIN first_detection_window fd ON c.oid = fd.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\ncandidate_objects AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON TRUE\n    WHERE EXISTS (\n        SELECT 1\n        FROM object_with_prob op\n        WHERE op.oid = o.oid\n    )\n    AND (\n        q3c_radial_query(o.meanra, o.meandec, s.column2, s.column3, 10)\n    )\n),\nfirst_detection_window AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT DISTINCT c.*\nFROM candidate_objects c\nJOIN first_detection_window fd ON c.oid = fd.oid;"
                },
                "in_toks": 2635,
                "out_toks": 285,
                "id": "chatcmpl-BhLkvgvVTRaTl88O4tPclgsWLwaLT",
                "created": 1749671433,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "7": {
        "0": {
            "req_id": 7,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 773,
                "out_toks": 14,
                "id": "chatcmpl-Be0Pu8JbMHDKfXSLAybtbn0qNcyhy",
                "created": 1748874422,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers and probabilities for objects with most likely class 'SN' in stamp_classifier\nWITH stamp_objects AS (\n    SELECT\n        o.oid,\n        p.probability\n    FROM\n        object o\n    -- Join with probability table to find the top-ranked 'SN' classification for each object\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        -- Filter objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\n        o.firstmjd BETWEEN 59945.0 AND 59975.0\n        -- Ensure the probability entry corresponds to class 'SN', classifier 'stamp_classifier', and top rank\n        AND p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n)\n-- Select object IDs and their corresponding probabilities\nSELECT\n    so.oid,\n    so.probability\nFROM\n    stamp_objects so;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers and probabilities for objects with most likely class 'SN' in stamp_classifier\nWITH stamp_objects AS (\n    SELECT\n        o.oid,\n        p.probability\n    FROM\n        object o\n    -- Join with probability table to find the top-ranked 'SN' classification for each object\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        -- Filter objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\n        o.firstmjd BETWEEN 59945.0 AND 59975.0\n        -- Ensure the probability entry corresponds to class 'SN', classifier 'stamp_classifier', and top rank\n        AND p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n)\n-- Select object IDs and their corresponding probabilities\nSELECT\n    so.oid,\n    so.probability\nFROM\n    stamp_objects so;\n```"
                },
                "in_toks": 1523,
                "out_toks": 212,
                "id": "chatcmpl-BhN082OGmahdgs8uPYgsKZ2qizGrt",
                "created": 1749676220,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers and probabilities for objects with most likely class 'SN' in stamp_classifier\nWITH stamp_objects AS (\n    SELECT\n        o.oid,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\n        o.firstmjd BETWEEN 59945.0 AND 59975.0\n        -- Subquery to get the top-ranked probability for each object in stamp_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'SN'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.ranking = 1\n        )\n)\nSELECT\n    so.oid,\n    p.probability\nFROM\n    stamp_objects so\nJOIN\n    probability p ON so.oid = p.oid\nWHERE\n    p.class_name = 'SN'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object identifiers and probabilities for objects with most likely class 'SN' in stamp_classifier\nWITH stamp_objects AS (\n    SELECT\n        o.oid,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\n        o.firstmjd BETWEEN 59945.0 AND 59975.0\n        -- Subquery to get the top-ranked probability for each object in stamp_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'SN'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.ranking = 1\n        )\n)\nSELECT\n    so.oid,\n    p.probability\nFROM\n    stamp_objects so\nJOIN\n    probability p ON so.oid = p.oid\nWHERE\n    p.class_name = 'SN'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1;\n```"
                    }
                },
                "in_toks": 2584,
                "out_toks": 237,
                "id": "chatcmpl-Be0R377vXBkDKTcl4UP4nt8iux7t3",
                "created": 1748874493,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 7,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 773,
                "out_toks": 14,
                "id": "chatcmpl-Be0Pu8JbMHDKfXSLAybtbn0qNcyhy",
                "created": 1748874422,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers and probabilities for objects classified as SN by the stamp classifier\nWITH stamp_sn AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n)\nSELECT o.oid, s.probability\nFROM object o\nJOIN stamp_sn s ON o.oid = s.oid\nWHERE o.firstmjd BETWEEN 59945.0 AND 59975.0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object identifiers and probabilities for objects classified as SN by the stamp classifier\nWITH stamp_sn AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.ranking = 1\n)\nSELECT o.oid, s.probability\nFROM object o\nJOIN stamp_sn s ON o.oid = s.oid\nWHERE o.firstmjd BETWEEN 59945.0 AND 59975.0;\n```"
                    }
                },
                "in_toks": 2584,
                "out_toks": 116,
                "id": "chatcmpl-Be0R32RkI8a63W1Ey44Vt5M8ByxDP",
                "created": 1748874493,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "7",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 773,
                "out_toks": 7,
                "id": "chatcmpl-BhLhfBR8JkaV3xlH3SNfYHTof38LX",
                "created": 1749671231,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- Additional condition to ensure high confidence in classification\n),\n-- Select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\n-- Join with the subquery for SN objects to optimize filtering\nJOIN stamp_sn_objects sso ON p.oid = sso.oid\n-- Join with the subquery for objects with first detection in January 2023\nJOIN objects_january_2023 ojan ON p.oid = ojan.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- Additional condition to ensure high confidence in classification\n),\n-- Select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\n-- Join with the subquery for SN objects to optimize filtering\nJOIN stamp_sn_objects sso ON p.oid = sso.oid\n-- Join with the subquery for objects with first detection in January 2023\nJOIN objects_january_2023 ojan ON p.oid = ojan.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1;\n```"
                },
                "in_toks": 1531,
                "out_toks": 278,
                "id": "chatcmpl-BhN0BFFSebo31txr2xqtmRaDaSkUB",
                "created": 1749676223,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\n-- Subquery to select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM stamp_sn_objects)\n  AND p.oid IN (SELECT oid FROM objects_january_2023)\n  AND p.classifier_name = 'stamp_classifier';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\n-- Subquery to select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM stamp_sn_objects)\n  AND p.oid IN (SELECT oid FROM objects_january_2023)\n  AND p.classifier_name = 'stamp_classifier';\n```"
                },
                "in_toks": 2584,
                "out_toks": 211,
                "id": "chatcmpl-BhLmDoOgwLbKqDi89VikurnT4xk2C",
                "created": 1749671513,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "7",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 773,
                "out_toks": 7,
                "id": "chatcmpl-BhLhgCrDpSFcXTft5mxw2JwPCmtyB",
                "created": 1749671232,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- Additional condition to ensure high confidence in classification\n),\n-- Select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM stamp_sn_objects)\n  AND p.oid IN (SELECT oid FROM objects_january_2023)\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1\n  AND p.probability > 0.5; -- Ensuring the probability indicates a confident classification\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- Additional condition to ensure high confidence in classification\n),\n-- Select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM stamp_sn_objects)\n  AND p.oid IN (SELECT oid FROM objects_january_2023)\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1\n  AND p.probability > 0.5; -- Ensuring the probability indicates a confident classification\n```"
                },
                "in_toks": 1531,
                "out_toks": 266,
                "id": "chatcmpl-BhN07FXe4kYp4RzKHD9oEH0yEgAys",
                "created": 1749676219,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\n-- Subquery to select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM stamp_sn_objects)\n  AND p.oid IN (SELECT oid FROM objects_january_2023)\n  AND p.classifier_name = 'stamp_classifier';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\n-- Subquery to select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM stamp_sn_objects)\n  AND p.oid IN (SELECT oid FROM objects_january_2023)\n  AND p.classifier_name = 'stamp_classifier';\n```"
                },
                "in_toks": 2584,
                "out_toks": 211,
                "id": "chatcmpl-BhLuZCWZPQAw3DIQiDy7JxpUDGEz7",
                "created": 1749672031,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "2": {
        "0": {
            "req_id": 2,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'taxonomy']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'taxonomy']"
                    }
                },
                "in_toks": 760,
                "out_toks": 20,
                "id": "chatcmpl-Be0PvhxJP7qsDCeOOK3T7XrK4KN4a",
                "created": 1748874423,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve object IDs classified as YSO with probability > 0.7 in the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve object IDs classified as YSO with probability > 0.7 in the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```"
                    }
                },
                "in_toks": 2587,
                "out_toks": 92,
                "id": "chatcmpl-Be0R4IcjBf4eaIvhLMGovenNmSN7Y",
                "created": 1748874494,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 2,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'taxonomy']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'taxonomy']"
                    }
                },
                "in_toks": 760,
                "out_toks": 20,
                "id": "chatcmpl-Be0PvhxJP7qsDCeOOK3T7XrK4KN4a",
                "created": 1748874423,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve object IDs classified as YSO with probability > 0.7 in the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve object IDs classified as YSO with probability > 0.7 in the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```"
                    }
                },
                "in_toks": 2587,
                "out_toks": 92,
                "id": "chatcmpl-Be0R3ZY8Ooa6P2UuRo3LKV9glCoxA",
                "created": 1748874493,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "2",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 760,
                "out_toks": 10,
                "id": "chatcmpl-BhLhg424pY6ueK3DiIn8FgiSR0n47",
                "created": 1749671232,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers classified as YSO with probability > 0.7\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to find OIDs with YSO classification probability > 0.7\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers classified as YSO with probability > 0.7\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to find OIDs with YSO classification probability > 0.7\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```"
                },
                "in_toks": 4974,
                "out_toks": 106,
                "id": "chatcmpl-BhLrciee2ubVS7UTcrDvAfU2olkwV",
                "created": 1749671848,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "2",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 760,
                "out_toks": 10,
                "id": "chatcmpl-BhLhhp9PKaZM7i0q4jykikSfWk5fF",
                "created": 1749671233,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers classified as YSO with probability > 0.7\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to find OIDs with YSO classification probability > 0.7\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers classified as YSO with probability > 0.7\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to find OIDs with YSO classification probability > 0.7\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```"
                },
                "in_toks": 4974,
                "out_toks": 106,
                "id": "chatcmpl-BhLrLJehn7P6fUwR31hK9VubcqJnn",
                "created": 1749671831,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "3": {
        "0": {
            "req_id": 3,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 764,
                "out_toks": 14,
                "id": "chatcmpl-Be0PwwVWA4mTood8MmXqLfSNh71Cy",
                "created": 1748874424,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with classification as YSO, probability > 0.7, and last detection in June\nWITH yso_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n),\nlast_detection_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.lastmjd BETWEEN 60096.0 AND 60125.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.oid IN (SELECT oid FROM last_detection_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object OIDs with classification as YSO, probability > 0.7, and last detection in June\nWITH yso_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n),\nlast_detection_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.lastmjd BETWEEN 60096.0 AND 60125.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.oid IN (SELECT oid FROM last_detection_objects);\n```"
                    }
                },
                "in_toks": 2567,
                "out_toks": 158,
                "id": "chatcmpl-Be0R6CRxuvVD10JDiOen3FHaRC7mR",
                "created": 1748874496,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 3,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 764,
                "out_toks": 14,
                "id": "chatcmpl-Be0PwwVWA4mTood8MmXqLfSNh71Cy",
                "created": 1748874424,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs with classification as YSO, probability > 0.7, and last detection in June\nWITH yso_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n),\nlast_june_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.lastmjd BETWEEN 60096.0 AND 60125.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.oid IN (SELECT oid FROM last_june_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object IDs with classification as YSO, probability > 0.7, and last detection in June\nWITH yso_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n),\nlast_june_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.lastmjd BETWEEN 60096.0 AND 60125.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.oid IN (SELECT oid FROM last_june_objects);\n```"
                    }
                },
                "in_toks": 2567,
                "out_toks": 159,
                "id": "chatcmpl-Be0R6y9SEOIJKiVxMKBJVIqT9KjpD",
                "created": 1748874496,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "3",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 764,
                "out_toks": 7,
                "id": "chatcmpl-BhLhhX4dFfxToByTL296MCpTwK7Gn",
                "created": 1749671233,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'YSO'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.7\n          AND p.ranking = 1\n    )\n)\n-- Filter objects that were last detected in June (MJD between 60096 and 60125)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.mjdendhist BETWEEN 60096.0 AND 60125.0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'YSO'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.7\n          AND p.ranking = 1\n    )\n)\n-- Filter objects that were last detected in June (MJD between 60096 and 60125)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.mjdendhist BETWEEN 60096.0 AND 60125.0;\n```"
                },
                "in_toks": 2567,
                "out_toks": 171,
                "id": "chatcmpl-BhLsBbv1r2RD5sQmtX9DbCaYCADtA",
                "created": 1749671883,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "3",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 764,
                "out_toks": 7,
                "id": "chatcmpl-BhLhit391KCEeSiyf4vLDnKsqMku5",
                "created": 1749671234,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'YSO'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.7\n          AND p.ranking = 1\n    )\n)\n-- Filter objects that were last detected in June (MJD between 60096 and 60125)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.mjdendhist BETWEEN 60096.0 AND 60125.0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'YSO'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.7\n          AND p.ranking = 1\n    )\n)\n-- Filter objects that were last detected in June (MJD between 60096 and 60125)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.mjdendhist BETWEEN 60096.0 AND 60125.0;\n```"
                },
                "in_toks": 2567,
                "out_toks": 171,
                "id": "chatcmpl-BhLl3I7wQW6SSWS2Zcal9YmxdFBXP",
                "created": 1749671441,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "23": {
        "0": {
            "req_id": 23,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 787,
                "out_toks": 14,
                "id": "chatcmpl-Be0PynCbVYHm3V4aUsrCisYX4G6U5",
                "created": 1748874426,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n        AND p.ranking = 1 -- Focus on the most probable classification per object\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM\n    object o\nJOIN\n    probability p ON o.oid = p.oid\nWHERE\n    p.oid IN (\n        SELECT DISTINCT oid FROM object_probabilities\n    )\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Ensure class filter consistency\n    AND p.probability > 0.2 -- Maintain probability threshold\n    AND p.ranking = 1 -- Limit to top-ranked classification for efficiency\nORDER BY\n    o.oid,\n    p.class_name,\n    p.ranking;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n        AND p.ranking = 1 -- Focus on the most probable classification per object\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM\n    object o\nJOIN\n    probability p ON o.oid = p.oid\nWHERE\n    p.oid IN (\n        SELECT DISTINCT oid FROM object_probabilities\n    )\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Ensure class filter consistency\n    AND p.probability > 0.2 -- Maintain probability threshold\n    AND p.ranking = 1 -- Limit to top-ranked classification for efficiency\nORDER BY\n    o.oid,\n    p.class_name,\n    p.ranking;\n```"
                },
                "in_toks": 1515,
                "out_toks": 275,
                "id": "chatcmpl-BhN05QqAKU5ivBmJdhEq5XNGCAWgj",
                "created": 1749676217,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM\n    object o\nJOIN\n    probability p ON o.oid = p.oid\nWHERE\n    o.oid IN (\n        SELECT DISTINCT oid FROM object_probabilities\n    )\nORDER BY\n    o.oid,\n    p.class_name,\n    p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM\n    object o\nJOIN\n    probability p ON o.oid = p.oid\nWHERE\n    o.oid IN (\n        SELECT DISTINCT oid FROM object_probabilities\n    )\nORDER BY\n    o.oid,\n    p.class_name,\n    p.ranking;\n```"
                    }
                },
                "in_toks": 2580,
                "out_toks": 208,
                "id": "chatcmpl-Be0R6CmRNAXAjKZysQTDhphYMY5mN",
                "created": 1748874496,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 23,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 787,
                "out_toks": 14,
                "id": "chatcmpl-Be0PynCbVYHm3V4aUsrCisYX4G6U5",
                "created": 1748874426,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with their classification probabilities for specified classes, optimizing for performance\nWITH object_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n        AND p.ranking = 1 -- Focus on the most probable classification per object\n)\n-- Retrieve object details along with their classification probabilities\nSELECT\n    o.oid,\n    o.firstmjd,\n    o.lastmjd,\n    o.ndet,\n    o.g_r_max,\n    o.meanra,\n    o.meandec,\n    op.class_name,\n    op.probability,\n    op.ranking\nFROM\n    object o\nJOIN\n    object_probabilities op ON o.oid = op.oid\n-- Optional: filter objects based on date ranges or other criteria if needed\nORDER BY\n    o.oid, op.ranking;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with their classification probabilities for specified classes, optimizing for performance\nWITH object_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n        AND p.ranking = 1 -- Focus on the most probable classification per object\n)\n-- Retrieve object details along with their classification probabilities\nSELECT\n    o.oid,\n    o.firstmjd,\n    o.lastmjd,\n    o.ndet,\n    o.g_r_max,\n    o.meanra,\n    o.meandec,\n    op.class_name,\n    op.probability,\n    op.ranking\nFROM\n    object o\nJOIN\n    object_probabilities op ON o.oid = op.oid\n-- Optional: filter objects based on date ranges or other criteria if needed\nORDER BY\n    o.oid, op.ranking;\n```"
                },
                "in_toks": 1511,
                "out_toks": 241,
                "id": "chatcmpl-BhN067ivFwiyWOFuKi7RQ7jqpMcyh",
                "created": 1749676218,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    o.firstmjd,\n    o.lastmjd,\n    o.ndet,\n    o.g_r_max,\n    o.meanra,\n    o.meandec,\n    op.class_name,\n    op.probability,\n    op.ranking\nFROM\n    object o\nJOIN\n    object_probabilities op ON o.oid = op.oid\nORDER BY\n    o.oid, op.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    o.firstmjd,\n    o.lastmjd,\n    o.ndet,\n    o.g_r_max,\n    o.meanra,\n    o.meandec,\n    op.class_name,\n    op.probability,\n    op.ranking\nFROM\n    object o\nJOIN\n    object_probabilities op ON o.oid = op.oid\nORDER BY\n    o.oid, op.ranking;\n```"
                    }
                },
                "in_toks": 2580,
                "out_toks": 204,
                "id": "chatcmpl-Be0R6ha56BrQnzXOMB4fw8oa8nJu3",
                "created": 1748874496,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "23",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 787,
                "out_toks": 7,
                "id": "chatcmpl-BhLhkVPLVrugYh1Vu3KjRnhU0GsIW",
                "created": 1749671236,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n        AND p.ranking = 1 -- Focus on the most likely classification per object\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM\n    object o\nJOIN\n    probability p ON o.oid = p.oid\nWHERE\n    p.oid IN (\n        SELECT DISTINCT oid FROM object_probabilities\n    )\n    AND p.classifier_name = 'lc_classifier' -- Ensure classifier consistency\n    AND p.probability > 0.2 -- Maintain probability threshold\n    AND p.ranking = 1 -- Focus on the top-ranked classification\nORDER BY\n    o.oid,\n    p.ranking;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n        AND p.ranking = 1 -- Focus on the most likely classification per object\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM\n    object o\nJOIN\n    probability p ON o.oid = p.oid\nWHERE\n    p.oid IN (\n        SELECT DISTINCT oid FROM object_probabilities\n    )\n    AND p.classifier_name = 'lc_classifier' -- Ensure classifier consistency\n    AND p.probability > 0.2 -- Maintain probability threshold\n    AND p.ranking = 1 -- Focus on the top-ranked classification\nORDER BY\n    o.oid,\n    p.ranking;\n```"
                },
                "in_toks": 1505,
                "out_toks": 254,
                "id": "chatcmpl-BhN084aBWeotFxuAcThEC6SX0Jpvb",
                "created": 1749676220,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM\n    object o\nJOIN\n    probability p ON o.oid = p.oid\nWHERE\n    o.oid IN (\n        SELECT DISTINCT oid FROM object_probabilities\n    )\nORDER BY\n    o.oid,\n    p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM\n    object o\nJOIN\n    probability p ON o.oid = p.oid\nWHERE\n    o.oid IN (\n        SELECT DISTINCT oid FROM object_probabilities\n    )\nORDER BY\n    o.oid,\n    p.ranking;\n```"
                },
                "in_toks": 2580,
                "out_toks": 203,
                "id": "chatcmpl-BhLl3OvdZpOVOK7qznq1JmlS5DSRA",
                "created": 1749671441,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "23",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 787,
                "out_toks": 7,
                "id": "chatcmpl-BhLhlytDhu2yDuV40HrfTGNrgVBjH",
                "created": 1749671237,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with the highest probability (ranking=1) for classes 'SNIa', 'SNIbc', 'SNII', 'SLSN' in 'lc_classifier' with probability > 0.2\nWITH top_probabilities AS (\n    SELECT\n        p.oid\n    FROM\n        probability p\n    WHERE\n        p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Target classes\n        AND p.classifier_name = 'lc_classifier' -- Specific classifier\n        AND p.probability > 0.2 -- Probability threshold\n        AND p.ranking = 1 -- Highest probability class per object\n    GROUP BY p.oid -- Ensure unique objects\n)\n-- Retrieve all probability entries for these objects to get full classification info\nSELECT\n    p.*\nFROM\n    probability p\nWHERE\n    p.oid IN (SELECT oid FROM top_probabilities);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with the highest probability (ranking=1) for classes 'SNIa', 'SNIbc', 'SNII', 'SLSN' in 'lc_classifier' with probability > 0.2\nWITH top_probabilities AS (\n    SELECT\n        p.oid\n    FROM\n        probability p\n    WHERE\n        p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Target classes\n        AND p.classifier_name = 'lc_classifier' -- Specific classifier\n        AND p.probability > 0.2 -- Probability threshold\n        AND p.ranking = 1 -- Highest probability class per object\n    GROUP BY p.oid -- Ensure unique objects\n)\n-- Retrieve all probability entries for these objects to get full classification info\nSELECT\n    p.*\nFROM\n    probability p\nWHERE\n    p.oid IN (SELECT oid FROM top_probabilities);\n```"
                },
                "in_toks": 1470,
                "out_toks": 199,
                "id": "chatcmpl-BhN0CQgV60QjQotR5QVOyj5QzEd3C",
                "created": 1749676224,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to get object OIDs with the highest probability for classes 'SNIa', 'SNIbc', 'SNII', 'SLSN' in 'lc_classifier' with probability > 0.2\nWITH top_probabilities AS (\n    SELECT\n        p.oid\n    FROM\n        probability p\n    WHERE\n        p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.2\n    -- Select the object with the highest probability for each class\n    AND p.ranking = 1\n)\n-- Main query to retrieve all probabilities for objects identified above\nSELECT\n    p.*\nFROM\n    probability p\nWHERE\n    p.oid IN (SELECT oid FROM top_probabilities);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to get object OIDs with the highest probability for classes 'SNIa', 'SNIbc', 'SNII', 'SLSN' in 'lc_classifier' with probability > 0.2\nWITH top_probabilities AS (\n    SELECT\n        p.oid\n    FROM\n        probability p\n    WHERE\n        p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.2\n    -- Select the object with the highest probability for each class\n    AND p.ranking = 1\n)\n-- Main query to retrieve all probabilities for objects identified above\nSELECT\n    p.*\nFROM\n    probability p\nWHERE\n    p.oid IN (SELECT oid FROM top_probabilities);\n```"
                },
                "in_toks": 2580,
                "out_toks": 182,
                "id": "chatcmpl-BhLl2LOgoDhTvxub5hA3HjeVcCs0Y",
                "created": 1749671440,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "32": {
        "0": {
            "req_id": 32,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'ss_ztf']"
                    },
                    "1": {
                        "response": "['object', 'ss_ztf']"
                    }
                },
                "in_toks": 777,
                "out_toks": 18,
                "id": "chatcmpl-Be0PyEZyL3uL8iBp441Tgh5WKI9ha",
                "created": 1748874426,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of asteroid candidate oids\nWITH asteroid_oids AS (\n    VALUES \n        ('ZTF21aaqosfj'),\n        ('ZTF21aaqosfm'),\n        ('ZTF21aaqosfs'),\n        ('ZTF21aaqosff'),\n        ('ZTF21aaqoski'),\n        ('ZTF21aaqoskz'),\n        ('ZTF21aaqosfo'),\n        ('ZTF21aaqosly'),\n        ('ZTF21aaqosgi'),\n        ('ZTF21aaqospe')\n)\n\n-- Select data from ss_ztf for the specified oids with positive ssdistnr\nSELECT s.*\nFROM ss_ztf s\nJOIN asteroid_oids a ON s.oid = a.column1\nWHERE s.ssdistnr > 0\nORDER BY s.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define the list of asteroid candidate oids\nWITH asteroid_oids AS (\n    VALUES \n        ('ZTF21aaqosfj'),\n        ('ZTF21aaqosfm'),\n        ('ZTF21aaqosfs'),\n        ('ZTF21aaqosff'),\n        ('ZTF21aaqoski'),\n        ('ZTF21aaqoskz'),\n        ('ZTF21aaqosfo'),\n        ('ZTF21aaqosly'),\n        ('ZTF21aaqosgi'),\n        ('ZTF21aaqospe')\n)\n\n-- Select data from ss_ztf for the specified oids with positive ssdistnr\nSELECT s.*\nFROM ss_ztf s\nJOIN asteroid_oids a ON s.oid = a.column1\nWHERE s.ssdistnr > 0\nORDER BY s.oid;\n```"
                    }
                },
                "in_toks": 2621,
                "out_toks": 174,
                "id": "chatcmpl-Be0RC7acRXPoX9zjpIgUWSPxauZrZ",
                "created": 1748874502,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 32,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'ss_ztf']"
                    },
                    "1": {
                        "response": "['object', 'ss_ztf']"
                    }
                },
                "in_toks": 777,
                "out_toks": 18,
                "id": "chatcmpl-Be0PyEZyL3uL8iBp441Tgh5WKI9ha",
                "created": 1748874426,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of asteroid candidate oids\nWITH asteroid_oids AS (\n    VALUES \n        ('ZTF21aaqosfj'),\n        ('ZTF21aaqosfm'),\n        ('ZTF21aaqosfs'),\n        ('ZTF21aaqosff'),\n        ('ZTF21aaqoski'),\n        ('ZTF21aaqoskz'),\n        ('ZTF21aaqosfo'),\n        ('ZTF21aaqosly'),\n        ('ZTF21aaqosgi'),\n        ('ZTF21aaqospe')\n)\n\n-- Select data from ss_ztf for the specified oids with positive ssdistnr\nSELECT s.*\nFROM ss_ztf s\nJOIN asteroid_oids a ON s.oid = a.column1\nWHERE s.ssdistnr > 0\nORDER BY s.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define the list of asteroid candidate oids\nWITH asteroid_oids AS (\n    VALUES \n        ('ZTF21aaqosfj'),\n        ('ZTF21aaqosfm'),\n        ('ZTF21aaqosfs'),\n        ('ZTF21aaqosff'),\n        ('ZTF21aaqoski'),\n        ('ZTF21aaqoskz'),\n        ('ZTF21aaqosfo'),\n        ('ZTF21aaqosly'),\n        ('ZTF21aaqosgi'),\n        ('ZTF21aaqospe')\n)\n\n-- Select data from ss_ztf for the specified oids with positive ssdistnr\nSELECT s.*\nFROM ss_ztf s\nJOIN asteroid_oids a ON s.oid = a.column1\nWHERE s.ssdistnr > 0\nORDER BY s.oid;\n```"
                    }
                },
                "in_toks": 2621,
                "out_toks": 174,
                "id": "chatcmpl-Be0RANYBdGXNNrJQYbRuDlr0bgNBH",
                "created": 1748874500,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "32",
            "experiment_id": "run_2",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 777,
                "out_toks": 6,
                "id": "chatcmpl-BhLhmbj2G6fSG7CJQyTwL0qycNDO8",
                "created": 1749671238,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    'ZTF21aaqosfj',\n    'ZTF21aaqosfm',\n    'ZTF21aaqosfs',\n    'ZTF21aaqosff',\n    'ZTF21aaqoski',\n    'ZTF21aaqoskz',\n    'ZTF21aaqosfo',\n    'ZTF21aaqosly',\n    'ZTF21aaqosgi',\n    'ZTF21aaqospe'\n)\nAND ssdistnr > 0\nORDER BY oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    'ZTF21aaqosfj',\n    'ZTF21aaqosfm',\n    'ZTF21aaqosfs',\n    'ZTF21aaqosff',\n    'ZTF21aaqoski',\n    'ZTF21aaqoskz',\n    'ZTF21aaqosfo',\n    'ZTF21aaqosly',\n    'ZTF21aaqosgi',\n    'ZTF21aaqospe'\n)\nAND ssdistnr > 0\nORDER BY oid;\n```"
                },
                "in_toks": 2139,
                "out_toks": 143,
                "id": "chatcmpl-BhLl3874hYJ8c3Tj0RzwA3aYuy72t",
                "created": 1749671441,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "32",
            "experiment_id": "run_3",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 777,
                "out_toks": 6,
                "id": "chatcmpl-BhLhmcatPbHBrNn6A8iWMY6CR21GW",
                "created": 1749671238,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    'ZTF21aaqosfj',\n    'ZTF21aaqosfm',\n    'ZTF21aaqosfs',\n    'ZTF21aaqosff',\n    'ZTF21aaqoski',\n    'ZTF21aaqoskz',\n    'ZTF21aaqosfo',\n    'ZTF21aaqosly',\n    'ZTF21aaqosgi',\n    'ZTF21aaqospe'\n)\nAND ssdistnr > 0\nORDER BY oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    'ZTF21aaqosfj',\n    'ZTF21aaqosfm',\n    'ZTF21aaqosfs',\n    'ZTF21aaqosff',\n    'ZTF21aaqoski',\n    'ZTF21aaqoskz',\n    'ZTF21aaqosfo',\n    'ZTF21aaqosly',\n    'ZTF21aaqosgi',\n    'ZTF21aaqospe'\n)\nAND ssdistnr > 0\nORDER BY oid;\n```"
                },
                "in_toks": 2139,
                "out_toks": 143,
                "id": "chatcmpl-BhLl55pjBsvuq7D8X8x2lMe6slkVd",
                "created": 1749671443,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "20": {
        "0": {
            "req_id": 20,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 778,
                "out_toks": 22,
                "id": "chatcmpl-Be0Q0I7ljEnmLHu94iE17kmN5Qhi3",
                "created": 1748874428,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE EXISTS (\n    -- Subquery to check for probability of RRL in the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n)\nAND o.ndet >= 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE EXISTS (\n    -- Subquery to check for probability of RRL in the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n)\nAND o.ndet >= 100;\n```"
                    }
                },
                "in_toks": 3107,
                "out_toks": 115,
                "id": "chatcmpl-Be0REa9vKFJ8YeLaQPD5Cm15A1JNN",
                "created": 1748874504,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 20,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 778,
                "out_toks": 22,
                "id": "chatcmpl-Be0Q0I7ljEnmLHu94iE17kmN5Qhi3",
                "created": 1748874428,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as RRL (RR Lyrae) with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to find object IDs with probability > 0.55 for RRL in the light curve classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n      AND p.ranking = 1\n)\nAND o.ndet >= 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects classified as RRL (RR Lyrae) with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to find object IDs with probability > 0.55 for RRL in the light curve classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n      AND p.ranking = 1\n)\nAND o.ndet >= 100;\n```"
                    }
                },
                "in_toks": 3107,
                "out_toks": 130,
                "id": "chatcmpl-Be0RE60rPSyM1dWqcuU505uPktOo4",
                "created": 1748874504,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "20",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 778,
                "out_toks": 11,
                "id": "chatcmpl-BhLhnomeC3rwUhisKZ8rdIBUrSRzv",
                "created": 1749671239,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE EXISTS (\n    -- Subquery to find the probability of class 'RRL' for the object with the specified classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n)\nAND o.ndet >= 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE EXISTS (\n    -- Subquery to find the probability of class 'RRL' for the object with the specified classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n)\nAND o.ndet >= 100;\n```"
                },
                "in_toks": 3107,
                "out_toks": 120,
                "id": "chatcmpl-BhLl9lhNrD8HOzAHKWrL63Ix4UlCm",
                "created": 1749671447,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "20",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 778,
                "out_toks": 11,
                "id": "chatcmpl-BhLhntgCpmbVNvakExzXFKEUdjioy",
                "created": 1749671239,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE EXISTS (\n    -- Subquery to check for probability of RRL in the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n)\nAND o.ndet >= 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE EXISTS (\n    -- Subquery to check for probability of RRL in the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n)\nAND o.ndet >= 100;\n```"
                },
                "in_toks": 3107,
                "out_toks": 115,
                "id": "chatcmpl-BhLlC4Vm9K2IQ1w3zSVexsetSpevr",
                "created": 1749671450,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "18": {
        "0": {
            "req_id": 18,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 911,
                "out_toks": 22,
                "id": "chatcmpl-Be0Q1skR77sDVOwUEAgD4KmVsQ27n",
                "created": 1748874429,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Query for AGN classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('QSO', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for QSO classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for Blazar classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'QSO')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.95\n          AND p2.ranking = 1\n    );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Query for AGN classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('QSO', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for QSO classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for Blazar classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'QSO')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.95\n          AND p2.ranking = 1\n    );\n```"
                },
                "in_toks": 3040,
                "out_toks": 691,
                "id": "chatcmpl-BhN0861R1s1bpJjiQYrz37aExtQmh",
                "created": 1749676220,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Query for AGN classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('QSO', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for QSO classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for Blazar classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'QSO')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.95\n          AND p2.ranking = 1\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Query for AGN classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('QSO', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for QSO classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for Blazar classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'QSO')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.95\n          AND p2.ranking = 1\n    );\n```"
                    }
                },
                "in_toks": 3240,
                "out_toks": 655,
                "id": "chatcmpl-Be0REiAzeZi8YMnSxtrd0n02L9KgQ",
                "created": 1748874504,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 18,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 911,
                "out_toks": 22,
                "id": "chatcmpl-Be0Q1skR77sDVOwUEAgD4KmVsQ27n",
                "created": 1748874429,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Query for AGN sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for QSO sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'QSO'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for Blazar sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'Blazar'\n    AND p.probability > 0.8\n    AND p.ranking = 1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Query for AGN sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for QSO sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'QSO'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for Blazar sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'Blazar'\n    AND p.probability > 0.8\n    AND p.ranking = 1;\n```"
                },
                "in_toks": 2678,
                "out_toks": 483,
                "id": "chatcmpl-BhN0FvTGzfMixZ32DNhGBFVAgqvcg",
                "created": 1749676227,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Query for AGN sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.oid = o.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for QSO sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.oid = o.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'QSO'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for Blazar sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.oid = o.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'Blazar'\n    AND p.probability > 0.8\n    AND p.ranking = 1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Query for AGN sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.oid = o.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for QSO sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.oid = o.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'QSO'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for Blazar sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.mjdendhist - o.mjdstarthist >= 200\n    AND p.oid = o.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'Blazar'\n    AND p.probability > 0.8\n    AND p.ranking = 1;\n```"
                    }
                },
                "in_toks": 3240,
                "out_toks": 477,
                "id": "chatcmpl-Be0RFpZihNzd2vCfcB7RzSFcaSAU6",
                "created": 1748874505,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "18",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 911,
                "out_toks": 11,
                "id": "chatcmpl-BhLhoToRPiv9r6HXB7zdOi4YcZtsy",
                "created": 1749671240,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Query for AGN sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for QSO sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for Blazar sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Query for AGN sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for QSO sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n\nUNION\n\n-- Query for Blazar sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1;\n```"
                },
                "in_toks": 2847,
                "out_toks": 450,
                "id": "chatcmpl-BhN0EEGGYq3JiEPjq0Q8caHnH2mQA",
                "created": 1749676226,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Query for AGN sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND o.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND probability > 0.95\n          AND ranking = 1\n    )\n\nUNION\n\n-- Query for QSO sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND o.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'QSO'\n          AND classifier_name = 'lc_classifier'\n          AND probability > 0.95\n          AND ranking = 1\n    )\n\nUNION\n\n-- Query for Blazar sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND o.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'Blazar'\n          AND classifier_name = 'lc_classifier'\n          AND probability > 0.8\n          AND ranking = 1\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Query for AGN sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND o.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND probability > 0.95\n          AND ranking = 1\n    )\n\nUNION\n\n-- Query for QSO sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND o.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'QSO'\n          AND classifier_name = 'lc_classifier'\n          AND probability > 0.95\n          AND ranking = 1\n    )\n\nUNION\n\n-- Query for Blazar sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND o.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'Blazar'\n          AND classifier_name = 'lc_classifier'\n          AND probability > 0.8\n          AND ranking = 1\n    );\n```"
                },
                "in_toks": 3240,
                "out_toks": 560,
                "id": "chatcmpl-BhLlDM29Smm1cylobeDXgppFahS6y",
                "created": 1749671451,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "18",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 911,
                "out_toks": 11,
                "id": "chatcmpl-BhLhoeWCDIHypCnyU7nB5lGHfByJC",
                "created": 1749671240,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Query for AGN classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('QSO', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for QSO classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for Blazar classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'QSO')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.95\n          AND p2.ranking = 1\n    );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Query for AGN classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('QSO', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for QSO classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for Blazar classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nJOIN probability p ON p.oid = o.oid\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'QSO')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.95\n          AND p2.ranking = 1\n    );\n```"
                },
                "in_toks": 3040,
                "out_toks": 691,
                "id": "chatcmpl-BhN07tMXuZnFBKpIqhV8xheeBGVoZ",
                "created": 1749676219,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Query for AGN classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('QSO', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for QSO classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for Blazar classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'QSO')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.95\n          AND p2.ranking = 1\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Query for AGN classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('QSO', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for QSO classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for Blazar classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'QSO')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.95\n          AND p2.ranking = 1\n    );\n```"
                },
                "in_toks": 3240,
                "out_toks": 655,
                "id": "chatcmpl-BhLlHeTfLitq7xaZcmzTDqRQ6Hymh",
                "created": 1749671455,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "35": {
        "0": {
            "req_id": 35,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability']"
                    },
                    "1": {
                        "response": "['probability']"
                    }
                },
                "in_toks": 752,
                "out_toks": 8,
                "id": "chatcmpl-Be0Q1o5WaHIqNHPP1pNEq5724ABqA",
                "created": 1748874429,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```"
                    }
                },
                "in_toks": 2051,
                "out_toks": 32,
                "id": "chatcmpl-Be0RFGIN05AQ1wuT2WQlnSFefTBeA",
                "created": 1748874505,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 35,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability']"
                    },
                    "1": {
                        "response": "['probability']"
                    }
                },
                "in_toks": 752,
                "out_toks": 8,
                "id": "chatcmpl-Be0Q1o5WaHIqNHPP1pNEq5724ABqA",
                "created": 1748874429,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```"
                    }
                },
                "in_toks": 2051,
                "out_toks": 32,
                "id": "chatcmpl-Be0RFmDdEshsLiZ1bFVYmZuZpu3UO",
                "created": 1748874505,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "35",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 752,
                "out_toks": 4,
                "id": "chatcmpl-BhLhp9ew3b4bxcFtff9o4t6EEzLfH",
                "created": 1749671241,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```"
                },
                "in_toks": 2051,
                "out_toks": 32,
                "id": "chatcmpl-BhLllx7jBqEMDqezSNhZmMEM7rABI",
                "created": 1749671485,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "35",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 752,
                "out_toks": 4,
                "id": "chatcmpl-BhLhpul3sHwoRXJ6KqztQUGR54WvE",
                "created": 1749671241,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```"
                },
                "in_toks": 2051,
                "out_toks": 32,
                "id": "chatcmpl-BhLm13sa5b705xXHCwF9MsHBNKrfJ",
                "created": 1749671501,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "11": {
        "0": {
            "req_id": 11,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection', 'magstat', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature', 'detection', 'magstat']"
                    }
                },
                "in_toks": 791,
                "out_toks": 36,
                "id": "chatcmpl-Be0Q3TRwuwWSY6pcmtxnJHcQTB7zO",
                "created": 1748874431,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user conditions\nSELECT \n    o.oid,\n    -- Retrieve the maximum magnitude in the light curve for the object\n    f.magmax,\n    -- Retrieve the corrected maximum magnitude in the light curve for the object\n    f.magmax_corr,\n    -- Filter identifier (e.g., 'g-r_max_corr')\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Confirm the object is classified as SNIa with highest probability (ranking=1) in the 'lc_classifier'\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n    -- First detection occurred last September (assuming 2023: mjd between 60188 and 60217)\n    AND o.firstmjd BETWEEN 60188 AND 60217\n    -- Peak magnitude in the light curve is brighter than 19\n    AND f.magmax < 19\n    -- Focus on the feature representing g-r color at maximum (corrected)\n    AND f.name = 'g-r_max_corr'\n    -- g-r color at maximum is below 1\n    AND f.value < 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user conditions\nSELECT \n    o.oid,\n    -- Retrieve the maximum magnitude in the light curve for the object\n    f.magmax,\n    -- Retrieve the corrected maximum magnitude in the light curve for the object\n    f.magmax_corr,\n    -- Filter identifier (e.g., 'g-r_max_corr')\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Confirm the object is classified as SNIa with highest probability (ranking=1) in the 'lc_classifier'\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n    -- First detection occurred last September (assuming 2023: mjd between 60188 and 60217)\n    AND o.firstmjd BETWEEN 60188 AND 60217\n    -- Peak magnitude in the light curve is brighter than 19\n    AND f.magmax < 19\n    -- Focus on the feature representing g-r color at maximum (corrected)\n    AND f.name = 'g-r_max_corr'\n    -- g-r color at maximum is below 1\n    AND f.value < 1;"
                },
                "in_toks": 5116,
                "out_toks": 293,
                "id": "chatcmpl-BhN0CpTpgVvtRDF22Sj6qxHJ2az5S",
                "created": 1749676224,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nSELECT \n    o.oid,\n    f.magmax,\n    f.magmax_corr,\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for SNe Ia classification in the 'lc_classifier' with ranking=1 (most probable)\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n    -- First detection in September 2022 (mjd between 60188 and 60217)\n    AND o.firstmjd BETWEEN 60188 AND 60217\n    -- Peak magnitude brighter than 19\n    AND f.magmax < 19\n    -- g-r color at maximum less than 1\n    AND f.name = 'g-r_max_corr'\n    AND f.value < 1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nSELECT \n    o.oid,\n    f.magmax,\n    f.magmax_corr,\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for SNe Ia classification in the 'lc_classifier' with ranking=1 (most probable)\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n    -- First detection in September 2022 (mjd between 60188 and 60217)\n    AND o.firstmjd BETWEEN 60188 AND 60217\n    -- Peak magnitude brighter than 19\n    AND f.magmax < 19\n    -- g-r color at maximum less than 1\n    AND f.name = 'g-r_max_corr'\n    AND f.value < 1;\n```"
                    }
                },
                "in_toks": 6299,
                "out_toks": 226,
                "id": "chatcmpl-Be0RFIcIernBE4FpoGJKj3KcAG0nB",
                "created": 1748874505,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 11,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection', 'magstat', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature', 'detection', 'magstat']"
                    }
                },
                "in_toks": 791,
                "out_toks": 36,
                "id": "chatcmpl-Be0Q3TRwuwWSY6pcmtxnJHcQTB7zO",
                "created": 1748874431,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table references and aliases, ensuring all columns are correctly referenced\n-- and subqueries are properly joined. Also, added comments for clarity.\n\n-- Select objects classified as SNe Ia with specific conditions\nWITH first_detection_september AS (\n    -- Find objects with first detection in r-band last September\n    SELECT o.oid\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.fid = 2 -- r-band\n      AND o.firstmjd BETWEEN 60188.0 AND 60217.0 -- last September date range\n),\nsn_classification AS (\n    -- Select objects classified as SNIa with top ranking\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n),\npeak_magnitude AS (\n    -- Find objects with maximum magnitude (peak brightness) below 19\n    SELECT oid, magmax AS max_mag\n    FROM magstat\n    WHERE magmax < 19\n),\ng_r_color AS (\n    -- Select objects with g-r color at maximum less than 1\n    SELECT o.oid, o.g_r_max\n    FROM object o\n    WHERE o.g_r_max < 1\n)\n-- Main query: join all conditions to get desired objects\nSELECT o.oid, o.g_r_max, pm.max_mag, m.fid\nFROM object o\n-- Join with first detection in September\nJOIN first_detection_september fds ON o.oid = fds.oid\n-- Join with classification as SNIa\nJOIN sn_classification sc ON o.oid = sc.oid\n-- Join with peak magnitude condition\nJOIN peak_magnitude pm ON o.oid = pm.oid\n-- Join with g-r color condition\nJOIN g_r_color gr ON o.oid = gr.oid;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table references and aliases, ensuring all columns are correctly referenced\n-- and subqueries are properly joined. Also, added comments for clarity.\n\n-- Select objects classified as SNe Ia with specific conditions\nWITH first_detection_september AS (\n    -- Find objects with first detection in r-band last September\n    SELECT o.oid\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.fid = 2 -- r-band\n      AND o.firstmjd BETWEEN 60188.0 AND 60217.0 -- last September date range\n),\nsn_classification AS (\n    -- Select objects classified as SNIa with top ranking\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n),\npeak_magnitude AS (\n    -- Find objects with maximum magnitude (peak brightness) below 19\n    SELECT oid, magmax AS max_mag\n    FROM magstat\n    WHERE magmax < 19\n),\ng_r_color AS (\n    -- Select objects with g-r color at maximum less than 1\n    SELECT o.oid, o.g_r_max\n    FROM object o\n    WHERE o.g_r_max < 1\n)\n-- Main query: join all conditions to get desired objects\nSELECT o.oid, o.g_r_max, pm.max_mag, m.fid\nFROM object o\n-- Join with first detection in September\nJOIN first_detection_september fds ON o.oid = fds.oid\n-- Join with classification as SNIa\nJOIN sn_classification sc ON o.oid = sc.oid\n-- Join with peak magnitude condition\nJOIN peak_magnitude pm ON o.oid = pm.oid\n-- Join with g-r color condition\nJOIN g_r_color gr ON o.oid = gr.oid;\n"
                },
                "in_toks": 5202,
                "out_toks": 428,
                "id": "chatcmpl-BhN098xOODR2fLet2b3vH4rgmTrQR",
                "created": 1749676221,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nWITH first_detection_september AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.fid = 2 -- r-band\n      AND o.firstmjd BETWEEN 60188.0 AND 60217.0 -- first detection last September\n),\nsn_classification AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n),\npeak_magnitude AS (\n    SELECT oid, magmax AS max_mag\n    FROM magstat\n    WHERE magmax < 19\n),\ng_r_color AS (\n    SELECT o.oid, g_r_max\n    FROM object o\n    WHERE g_r_max < 1\n)\nSELECT o.oid, m.g_r_max, m.max_mag, m.fid\nFROM object o\nJOIN first_detection_september fds ON o.oid = fds.oid\nJOIN sn_classification sc ON o.oid = sc.oid\nJOIN peak_magnitude pm ON o.oid = pm.oid\nJOIN g_r_color gr ON o.oid = gr.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nWITH first_detection_september AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.fid = 2 -- r-band\n      AND o.firstmjd BETWEEN 60188.0 AND 60217.0 -- first detection last September\n),\nsn_classification AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n),\npeak_magnitude AS (\n    SELECT oid, magmax AS max_mag\n    FROM magstat\n    WHERE magmax < 19\n),\ng_r_color AS (\n    SELECT o.oid, g_r_max\n    FROM object o\n    WHERE g_r_max < 1\n)\nSELECT o.oid, m.g_r_max, m.max_mag, m.fid\nFROM object o\nJOIN first_detection_september fds ON o.oid = fds.oid\nJOIN sn_classification sc ON o.oid = sc.oid\nJOIN peak_magnitude pm ON o.oid = pm.oid\nJOIN g_r_color gr ON o.oid = gr.oid;\n```"
                    }
                },
                "in_toks": 6299,
                "out_toks": 296,
                "id": "chatcmpl-Be0RGGYrnFYiYS28PdjFEEVIuS3fm",
                "created": 1748874506,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "11",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 791,
                "out_toks": 18,
                "id": "chatcmpl-BhLhqKVh4WXdNAl0V2WP5BlLZk5Ma",
                "created": 1749671242,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user conditions\nSELECT \n    o.oid,\n    -- Retrieve the maximum magnitude in the light curve for the object\n    f.magmax,\n    -- Retrieve the corrected maximum magnitude\n    f.magmax_corr,\n    -- Filter identifier (e.g., 'g-r_max_corr')\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Confirm the object is classified as Type Ia Supernova with highest probability\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n          AND p.ranking = 1\n    )\n    -- First detection occurred last September (assuming MJD range 60188 to 60217)\n    AND o.firstmjd BETWEEN 60188 AND 60217\n    -- Peak magnitude above 19\n    AND f.magmax > 19\n    -- The feature name for g-r color at maximum is 'g-r_max_corr'\n    AND f.name = 'g-r_max_corr'\n    -- g-r color at maximum below 1\n    AND f.value < 1;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user conditions\nSELECT \n    o.oid,\n    -- Retrieve the maximum magnitude in the light curve for the object\n    f.magmax,\n    -- Retrieve the corrected maximum magnitude\n    f.magmax_corr,\n    -- Filter identifier (e.g., 'g-r_max_corr')\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Confirm the object is classified as Type Ia Supernova with highest probability\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n          AND p.ranking = 1\n    )\n    -- First detection occurred last September (assuming MJD range 60188 to 60217)\n    AND o.firstmjd BETWEEN 60188 AND 60217\n    -- Peak magnitude above 19\n    AND f.magmax > 19\n    -- The feature name for g-r color at maximum is 'g-r_max_corr'\n    AND f.name = 'g-r_max_corr'\n    -- g-r color at maximum below 1\n    AND f.value < 1;\n"
                },
                "in_toks": 5138,
                "out_toks": 291,
                "id": "chatcmpl-BhN0BZeYEVkAB3U8tdDoatTQvQbch",
                "created": 1749676223,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nSELECT \n    o.oid,\n    f.magmax,\n    f.magmax_corr,\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for SNe Ia in the classification probabilities\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n          AND p.ranking = 1\n    )\n    AND -- First detection in September (mjd between 60188 and 60217)\n    o.firstmjd BETWEEN 60188 AND 60217\n    AND -- Peak magnitude above 19\n    f.magmax > 19\n    AND -- g-r color at maximum below 1\n    f.name = 'g-r_max_corr'\n    AND f.value < 1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nSELECT \n    o.oid,\n    f.magmax,\n    f.magmax_corr,\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for SNe Ia in the classification probabilities\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n          AND p.ranking = 1\n    )\n    AND -- First detection in September (mjd between 60188 and 60217)\n    o.firstmjd BETWEEN 60188 AND 60217\n    AND -- Peak magnitude above 19\n    f.magmax > 19\n    AND -- g-r color at maximum below 1\n    f.name = 'g-r_max_corr'\n    AND f.value < 1;\n```"
                },
                "in_toks": 6299,
                "out_toks": 234,
                "id": "chatcmpl-BhLm4BLhQHwEYLtg33iyUisquFUxN",
                "created": 1749671504,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "11",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 791,
                "out_toks": 18,
                "id": "chatcmpl-BhLhq8Tt8Hc4kExO6aK9nDfh8XjyC",
                "created": 1749671242,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user requirements\nSELECT \n    o.oid,\n    -- Retrieve the maximum g-r difference at maximum brightness\n    o.g_r_max,\n    -- Retrieve the g-r color at maximum brightness (corrected)\n    o.g_r_max_corr,\n    -- Filter ID: the band in which the maximum magnitude was observed\n    -- Since feature table uses 'name' for feature names, and 'fid' for band, we join with feature table to get filter info\n    -- But as per schema, 'feature' table has 'name', 'value', 'fid', etc.\n    -- To get the filter ID for the maximum magnitude, we need to find the feature with name 'magmax' for the object\n    -- and then get its 'fid' (filter id)\n    -- So, we join with feature table again to get the filter id for 'magmax'\n    f_max_fid.fid AS filter_id\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nJOIN \n    feature f ON o.oid = f.oid AND f.name = 'magmax'\n-- Join to get the filter id corresponding to the maximum magnitude feature\nLEFT JOIN \n    (SELECT oid, fid FROM feature WHERE name = 'magmax') f_max_fid ON o.oid = f_max_fid.oid\nWHERE \n    -- Filter for objects classified as SNe Ia with highest probability (ranking=1)\n    p.class_name = 'SNIa'\n    AND p.ranking = 1\n    AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    -- First detection in September (mjd between 60188 and 60217)\n    AND o.firstmjd BETWEEN 60188 AND 60217\n    -- Peak magnitude below 19\n    f.value < 19\n    -- g-r color at maximum below 1\n    -- Since 'g-r_max' is a feature, join again to get its value\n    AND EXISTS (\n        SELECT 1\n        FROM feature fr\n        WHERE fr.oid = o.oid\n          AND fr.name = 'g-r_max'\n          AND fr.value < 1\n    )\n    -- Ensure the feature corresponds to the maximum magnitude (by matching 'magmax' feature)\n    AND f.name = 'magmax'\n    -- Optional: ensure the 'fid' (filter id) is not null\n    AND f_max_fid.fid IS NOT NULL;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user requirements\nSELECT \n    o.oid,\n    -- Retrieve the maximum g-r difference at maximum brightness\n    o.g_r_max,\n    -- Retrieve the g-r color at maximum brightness (corrected)\n    o.g_r_max_corr,\n    -- Filter ID: the band in which the maximum magnitude was observed\n    -- Since feature table uses 'name' for feature names, and 'fid' for band, we join with feature table to get filter info\n    -- But as per schema, 'feature' table has 'name', 'value', 'fid', etc.\n    -- To get the filter ID for the maximum magnitude, we need to find the feature with name 'magmax' for the object\n    -- and then get its 'fid' (filter id)\n    -- So, we join with feature table again to get the filter id for 'magmax'\n    f_max_fid.fid AS filter_id\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nJOIN \n    feature f ON o.oid = f.oid AND f.name = 'magmax'\n-- Join to get the filter id corresponding to the maximum magnitude feature\nLEFT JOIN \n    (SELECT oid, fid FROM feature WHERE name = 'magmax') f_max_fid ON o.oid = f_max_fid.oid\nWHERE \n    -- Filter for objects classified as SNe Ia with highest probability (ranking=1)\n    p.class_name = 'SNIa'\n    AND p.ranking = 1\n    AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    -- First detection in September (mjd between 60188 and 60217)\n    AND o.firstmjd BETWEEN 60188 AND 60217\n    -- Peak magnitude below 19\n    f.value < 19\n    -- g-r color at maximum below 1\n    -- Since 'g-r_max' is a feature, join again to get its value\n    AND EXISTS (\n        SELECT 1\n        FROM feature fr\n        WHERE fr.oid = o.oid\n          AND fr.name = 'g-r_max'\n          AND fr.value < 1\n    )\n    -- Ensure the feature corresponds to the maximum magnitude (by matching 'magmax' feature)\n    AND f.name = 'magmax'\n    -- Optional: ensure the 'fid' (filter id) is not null\n    AND f_max_fid.fid IS NOT NULL;\n"
                },
                "in_toks": 5252,
                "out_toks": 544,
                "id": "chatcmpl-BhN0D8ebXepb1RJXIU1JIrbTZjz1p",
                "created": 1749676225,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nSELECT \n    o.oid,\n    f.magmax,\n    f.magmax_corr,\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for SNe Ia in the probability table with ranking=1 (most probable)\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNIa'\n          AND p.ranking = 1\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n    AND -- First detection in September (mjd between 60188 and 60217)\n    o.firstmjd BETWEEN 60188 AND 60217\n    AND -- Peak magnitude (magmax) below 19\n    f.magmax < 19\n    AND -- g-r color at maximum (g-r_max) below 1\n    f.name = 'g-r_max'\n    AND -- Ensure the feature corresponds to the maximum magnitude\n    f.value = (\n        SELECT MAX(f2.value)\n        FROM feature f2\n        WHERE f2.oid = o.oid AND f2.name = 'magmax'\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nSELECT \n    o.oid,\n    f.magmax,\n    f.magmax_corr,\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for SNe Ia in the probability table with ranking=1 (most probable)\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNIa'\n          AND p.ranking = 1\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n    AND -- First detection in September (mjd between 60188 and 60217)\n    o.firstmjd BETWEEN 60188 AND 60217\n    AND -- Peak magnitude (magmax) below 19\n    f.magmax < 19\n    AND -- g-r color at maximum (g-r_max) below 1\n    f.name = 'g-r_max'\n    AND -- Ensure the feature corresponds to the maximum magnitude\n    f.value = (\n        SELECT MAX(f2.value)\n        FROM feature f2\n        WHERE f2.oid = o.oid AND f2.name = 'magmax'\n    );\n```"
                },
                "in_toks": 6299,
                "out_toks": 290,
                "id": "chatcmpl-BhLm4kVTCbispHrSZjm7MABWA3c3X",
                "created": 1749671504,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "9": {
        "0": {
            "req_id": 9,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 862,
                "out_toks": 14,
                "id": "chatcmpl-Be0Q4Wcddp895J16usMORs2fERkyR",
                "created": 1748874432,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with their first detection in July 2023, within 1000 arcmin of Abell 370, with sgscore1<0.3,\n-- and exclude classes 'Asteroid' and 'Bogus' based on the highest stamp classifier probability.\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = (\n               SELECT MAX(p2.classifier_version)\n               FROM probability p2\n               WHERE p2.oid = o.oid\n                 AND p2.class_name = 'stamp_classifier'\n           )\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the highest probability\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (\n               SELECT MAX(p3.classifier_version)\n               FROM probability p3\n               WHERE p3.oid = o.oid\n                 AND p3.class_name = 'stamp_classifier'\n           )\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name\n    FROM object o\n    WHERE \n        -- First detection in July 2023: MJD between 60126.0 and 60156.0\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        -- Within 1000 arcmin (~16.6667 degrees) of Abell 370 at RA=39.97, Dec=-1.5768\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.6667)\n        -- Sgscore1 less than 0.3\n        AND o.sgscore1 < 0.3\n)\nSELECT \n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    -- Retrieve the classifier version for the selected class\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate the distance from the object to the cluster center\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\n-- Filter out objects where no valid class probability was found\nWHERE \n    so.max_stamp_prob IS NOT NULL\n    -- Exclude classes 'Asteroid' and 'Bogus' (case-insensitive)\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with their first detection in July 2023, within 1000 arcmin of Abell 370, with sgscore1<0.3,\n-- and exclude classes 'Asteroid' and 'Bogus' based on the highest stamp classifier probability.\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = (\n               SELECT MAX(p2.classifier_version)\n               FROM probability p2\n               WHERE p2.oid = o.oid\n                 AND p2.class_name = 'stamp_classifier'\n           )\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the highest probability\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (\n               SELECT MAX(p3.classifier_version)\n               FROM probability p3\n               WHERE p3.oid = o.oid\n                 AND p3.class_name = 'stamp_classifier'\n           )\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name\n    FROM object o\n    WHERE \n        -- First detection in July 2023: MJD between 60126.0 and 60156.0\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        -- Within 1000 arcmin (~16.6667 degrees) of Abell 370 at RA=39.97, Dec=-1.5768\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.6667)\n        -- Sgscore1 less than 0.3\n        AND o.sgscore1 < 0.3\n)\nSELECT \n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    -- Retrieve the classifier version for the selected class\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate the distance from the object to the cluster center\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\n-- Filter out objects where no valid class probability was found\nWHERE \n    so.max_stamp_prob IS NOT NULL\n    -- Exclude classes 'Asteroid' and 'Bogus' (case-insensitive)\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```"
                },
                "in_toks": 2306,
                "out_toks": 715,
                "id": "chatcmpl-BhN0Bmxz3TOa3ucW90VG3INLaGt5i",
                "created": 1749676223,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name IN ('stamp_classifier')\n           AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability p2 WHERE p2.oid = o.oid AND p2.classifier_name='stamp_classifier')\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the highest probability\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name IN ('stamp_classifier')\n           AND p2.classifier_version = (SELECT MAX(classifier_version) FROM probability p3 WHERE p3.oid = p2.oid AND p3.classifier_name='stamp_classifier')\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name,\n        -- Retrieve the 'sgscore1' value\n        o.sgscore1\n    FROM object o\n    WHERE \n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT \n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    (SELECT p.classifier_version FROM probability p WHERE p.oid = so.oid AND p.class_name = so.class_name AND p.classifier_name='stamp_classifier' ORDER BY p.ranking LIMIT 1) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate the distance using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE \n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name IN ('stamp_classifier')\n           AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability p2 WHERE p2.oid = o.oid AND p2.classifier_name='stamp_classifier')\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the highest probability\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name IN ('stamp_classifier')\n           AND p2.classifier_version = (SELECT MAX(classifier_version) FROM probability p3 WHERE p3.oid = p2.oid AND p3.classifier_name='stamp_classifier')\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name,\n        -- Retrieve the 'sgscore1' value\n        o.sgscore1\n    FROM object o\n    WHERE \n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT \n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    (SELECT p.classifier_version FROM probability p WHERE p.oid = so.oid AND p.class_name = so.class_name AND p.classifier_name='stamp_classifier' ORDER BY p.ranking LIMIT 1) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate the distance using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE \n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```"
                    }
                },
                "in_toks": 2684,
                "out_toks": 528,
                "id": "chatcmpl-Be0RICpjrRRoStqGoCu16R2HBFQfv",
                "created": 1748874508,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 9,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 862,
                "out_toks": 14,
                "id": "chatcmpl-Be0Q4Wcddp895J16usMORs2fERkyR",
                "created": 1748874432,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with their first detection in July 2023, within 1000 arcmin of Abell 370, with sgscore1<0.3,\n-- and exclude classes 'asteroid' and 'bogus' based on the highest probability in 'stamp_classifier'.\n\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in 'stamp_classifier' for the object\n        p1.probability AS value,\n        -- Retrieve the class name corresponding to the highest probability\n        p1.class_name AS name,\n        -- Retrieve the classifier version for the highest probability\n        p1.classifier_version AS version,\n        -- Calculate the distance from the center of Abell 370\n        q3c_dist(39.97, -1.5768, o.meanra, o.meandec) AS dist\n    FROM object o\n    -- Join with probability table to get the top class for each object\n    JOIN (\n        SELECT \n            p.oid,\n            p.class_name,\n            p.classifier_version,\n            p.probability,\n            p.ranking,\n            ROW_NUMBER() OVER (PARTITION BY p.oid ORDER BY p.ranking) AS rn\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n    ) p1 ON p1.oid = o.oid AND p1.rn = 1\n    WHERE \n        -- First detection in July 2023: MJD between 60126 and 60156\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        -- Within 1000 arcmin radius of Abell 370\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 1000.0)\n        -- At least one detection\n        AND o.ndet > 0\n        -- sgscore1 < 0.3 (assuming 'sigmara' or 'sigmadec' as proxy; since 'sigma1' does not exist)\n        AND o.sigmara < 0.3\n)\nSELECT \n    oid,\n    value,\n    name,\n    version,\n    meanra,\n    meandec,\n    -- Source identifier is the object id\n    oid AS source,\n    dist\nFROM selected_objects\n-- Exclude objects with highest probability class 'asteroid' or 'bogus'\nWHERE \n    LOWER(name) NOT IN ('asteroid', 'bogus');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with their first detection in July 2023, within 1000 arcmin of Abell 370, with sgscore1<0.3,\n-- and exclude classes 'asteroid' and 'bogus' based on the highest probability in 'stamp_classifier'.\n\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in 'stamp_classifier' for the object\n        p1.probability AS value,\n        -- Retrieve the class name corresponding to the highest probability\n        p1.class_name AS name,\n        -- Retrieve the classifier version for the highest probability\n        p1.classifier_version AS version,\n        -- Calculate the distance from the center of Abell 370\n        q3c_dist(39.97, -1.5768, o.meanra, o.meandec) AS dist\n    FROM object o\n    -- Join with probability table to get the top class for each object\n    JOIN (\n        SELECT \n            p.oid,\n            p.class_name,\n            p.classifier_version,\n            p.probability,\n            p.ranking,\n            ROW_NUMBER() OVER (PARTITION BY p.oid ORDER BY p.ranking) AS rn\n        FROM probability p\n        WHERE p.classifier_name = 'stamp_classifier'\n    ) p1 ON p1.oid = o.oid AND p1.rn = 1\n    WHERE \n        -- First detection in July 2023: MJD between 60126 and 60156\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        -- Within 1000 arcmin radius of Abell 370\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 1000.0)\n        -- At least one detection\n        AND o.ndet > 0\n        -- sgscore1 < 0.3 (assuming 'sigmara' or 'sigmadec' as proxy; since 'sigma1' does not exist)\n        AND o.sigmara < 0.3\n)\nSELECT \n    oid,\n    value,\n    name,\n    version,\n    meanra,\n    meandec,\n    -- Source identifier is the object id\n    oid AS source,\n    dist\nFROM selected_objects\n-- Exclude objects with highest probability class 'asteroid' or 'bogus'\nWHERE \n    LOWER(name) NOT IN ('asteroid', 'bogus');\n```"
                },
                "in_toks": 2147,
                "out_toks": 535,
                "id": "chatcmpl-BhN0GfELuLap8SiQ2V4Qns00FSKcc",
                "created": 1749676228,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name = 'stamp_classifier'\n         ORDER BY p.ranking\n         LIMIT 1) AS value,\n        -- Retrieve the class name corresponding to the highest probability\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n         ORDER BY p2.ranking\n         LIMIT 1) AS name,\n        -- Retrieve the classifier version for the highest probability\n        (SELECT p3.classifier_version\n         FROM probability p3\n         WHERE p3.oid = o.oid\n           AND p3.classifier_name = 'stamp_classifier'\n         ORDER BY p3.ranking\n         LIMIT 1) AS version,\n        -- Calculate the distance from the center of Abell 370\n        q3c_dist(39.97, -1.5768, o.meanra, o.meandec) AS dist\n    FROM object o\n    WHERE \n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.ndet > 0\n        AND o.sigma1 < 0.3\n)\nSELECT \n    oid,\n    value,\n    name,\n    version,\n    meanra,\n    meandec,\n    -- Retrieve the object identifier as source\n    oid AS source,\n    dist\nFROM selected_objects\nWHERE \n    -- Exclude objects with highest probability class 'Asteroid' or 'Bogus'\n    name NOT IN ('asteroid', 'bogus');\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name = 'stamp_classifier'\n         ORDER BY p.ranking\n         LIMIT 1) AS value,\n        -- Retrieve the class name corresponding to the highest probability\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n         ORDER BY p2.ranking\n         LIMIT 1) AS name,\n        -- Retrieve the classifier version for the highest probability\n        (SELECT p3.classifier_version\n         FROM probability p3\n         WHERE p3.oid = o.oid\n           AND p3.classifier_name = 'stamp_classifier'\n         ORDER BY p3.ranking\n         LIMIT 1) AS version,\n        -- Calculate the distance from the center of Abell 370\n        q3c_dist(39.97, -1.5768, o.meanra, o.meandec) AS dist\n    FROM object o\n    WHERE \n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.ndet > 0\n        AND o.sigma1 < 0.3\n)\nSELECT \n    oid,\n    value,\n    name,\n    version,\n    meanra,\n    meandec,\n    -- Retrieve the object identifier as source\n    oid AS source,\n    dist\nFROM selected_objects\nWHERE \n    -- Exclude objects with highest probability class 'Asteroid' or 'Bogus'\n    name NOT IN ('asteroid', 'bogus');\n```"
                    }
                },
                "in_toks": 2684,
                "out_toks": 438,
                "id": "chatcmpl-Be0RG9t66eCxv7THZcBGO2XOS23L1",
                "created": 1748874506,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "9",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 862,
                "out_toks": 7,
                "id": "chatcmpl-BhLhr21P0qpmL0Jw2hMqLSzYMf51l",
                "created": 1749671243,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with their first detection in July 2023, within 1000 arcmin of Abell 370, sgscore1<0.3,\n-- and with the highest stamp classifier probability not for 'Asteroid' or 'Bogus'.\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = (\n               SELECT MAX(p2.classifier_version)\n               FROM probability p2\n               WHERE p2.oid = p.oid\n                 AND p2.classifier_name = p.classifier_name\n           )\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (\n               SELECT MAX(p3.classifier_version)\n               FROM probability p3\n               WHERE p3.oid = p2.oid\n                 AND p3.classifier_name = p2.classifier_name\n           )\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0 -- July 2023 in MJD\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 1000.0) -- radius in arcmin\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    -- Retrieve the classifier version for the selected class\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance from the center of Abell 370\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with their first detection in July 2023, within 1000 arcmin of Abell 370, sgscore1<0.3,\n-- and with the highest stamp classifier probability not for 'Asteroid' or 'Bogus'.\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = (\n               SELECT MAX(p2.classifier_version)\n               FROM probability p2\n               WHERE p2.oid = p.oid\n                 AND p2.classifier_name = p.classifier_name\n           )\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (\n               SELECT MAX(p3.classifier_version)\n               FROM probability p3\n               WHERE p3.oid = p2.oid\n                 AND p3.classifier_name = p2.classifier_name\n           )\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0 -- July 2023 in MJD\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 1000.0) -- radius in arcmin\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    -- Retrieve the classifier version for the selected class\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance from the center of Abell 370\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```"
                },
                "in_toks": 2337,
                "out_toks": 632,
                "id": "chatcmpl-BhN0IT0F7tgXO3Gu1rWzsQXnqDRgH",
                "created": 1749676230,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name IN ('stamp_classifier')\n           AND p.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p2\n                                       WHERE p2.oid = p.oid\n                                         AND p2.classifier_name = p.classifier_name)\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p3\n                                       WHERE p3.oid = p2.oid\n                                         AND p3.classifier_name = p2.classifier_name)\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name,\n        -- Retrieve sgscore1\n        o.sgscore1\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name IN ('stamp_classifier')\n           AND p.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p2\n                                       WHERE p2.oid = p.oid\n                                         AND p2.classifier_name = p.classifier_name)\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p3\n                                       WHERE p3.oid = p2.oid\n                                         AND p3.classifier_name = p2.classifier_name)\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name,\n        -- Retrieve sgscore1\n        o.sgscore1\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```"
                },
                "in_toks": 2684,
                "out_toks": 555,
                "id": "chatcmpl-BhLmIH8SjkcHoZCHc4k1tWnsSR4UA",
                "created": 1749671518,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "9",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 862,
                "out_toks": 7,
                "id": "chatcmpl-BhLhrneqLCR4aq7xSQZRyXRhiKw6H",
                "created": 1749671243,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with their first detection in July 2023, within 1000 arcmin of Abell 370, sgscore1<0.3,\n-- and with the highest stamp classifier probability not for 'Asteroid' or 'Bogus'.\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = (\n               SELECT MAX(p2.classifier_version)\n               FROM probability p2\n               WHERE p2.oid = p.oid\n                 AND p2.classifier_name = p.classifier_name\n           )\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.class_name = 'stamp_classifier'\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (\n               SELECT MAX(p3.classifier_version)\n               FROM probability p3\n               WHERE p3.oid = p2.oid\n                 AND p3.classifier_name = p2.classifier_name\n           )\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    -- Retrieve the classifier version for the class with highest probability\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance from the center of Abell 370 using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with their first detection in July 2023, within 1000 arcmin of Abell 370, sgscore1<0.3,\n-- and with the highest stamp classifier probability not for 'Asteroid' or 'Bogus'.\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = (\n               SELECT MAX(p2.classifier_version)\n               FROM probability p2\n               WHERE p2.oid = p.oid\n                 AND p2.classifier_name = p.classifier_name\n           )\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.class_name = 'stamp_classifier'\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (\n               SELECT MAX(p3.classifier_version)\n               FROM probability p3\n               WHERE p3.oid = p2.oid\n                 AND p3.classifier_name = p2.classifier_name\n           )\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    -- Retrieve the classifier version for the class with highest probability\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance from the center of Abell 370 using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```"
                },
                "in_toks": 2337,
                "out_toks": 636,
                "id": "chatcmpl-BhN0CDq3qXZL3MkHxXazrM76ddc6B",
                "created": 1749676224,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name IN ('stamp_classifier')\n           AND p.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p2\n                                       WHERE p2.oid = p.oid\n                                         AND p2.classifier_name = p.classifier_name)\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p3\n                                       WHERE p3.oid = p2.oid\n                                         AND p3.classifier_name = p2.classifier_name)\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name,\n        -- Retrieve sgscore1\n        o.sgscore1\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name IN ('stamp_classifier')\n           AND p.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p2\n                                       WHERE p2.oid = p.oid\n                                         AND p2.classifier_name = p.classifier_name)\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p3\n                                       WHERE p3.oid = p2.oid\n                                         AND p3.classifier_name = p2.classifier_name)\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name,\n        -- Retrieve sgscore1\n        o.sgscore1\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```"
                },
                "in_toks": 2684,
                "out_toks": 555,
                "id": "chatcmpl-BhLme5arDuV38DPkxY1lD9gvzULom",
                "created": 1749671540,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "5": {
        "0": {
            "req_id": 5,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'feature', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature', 'detection']"
                    }
                },
                "in_toks": 833,
                "out_toks": 28,
                "id": "chatcmpl-Be0Q5c7JkipQ8tEdl8WzrmdzOr1jB",
                "created": 1748874433,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object and detection identifiers, feature details, and detection magnitudes with specified conditions\nSELECT \n    o.oid AS object_id,\n    d.candid AS candidate_id,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf AS psf_magnitude,\n    d.sigmapsf AS magnitude_error,\n    d.fid AS feature_fid -- renamed as per user request\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter objects classified as SN II with probability > 0.6 and ranking = 1 (most probable)\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNII'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n    -- Filter objects with more than 50 detections\n    AND o.ndet > 50\n    -- Filter objects with g-band magnitude difference > 2\n    AND (\n        SELECT MAX(magpsf) - MIN(magpsf)\n        FROM detection\n        WHERE oid = o.oid AND fid = 1\n    ) > 2\nORDER BY \n    o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object and detection identifiers, feature details, and detection magnitudes with specified conditions\nSELECT \n    o.oid AS object_id,\n    d.candid AS candidate_id,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf AS psf_magnitude,\n    d.sigmapsf AS magnitude_error,\n    d.fid AS feature_fid -- renamed as per user request\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter objects classified as SN II with probability > 0.6 and ranking = 1 (most probable)\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNII'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n    -- Filter objects with more than 50 detections\n    AND o.ndet > 50\n    -- Filter objects with g-band magnitude difference > 2\n    AND (\n        SELECT MAX(magpsf) - MIN(magpsf)\n        FROM detection\n        WHERE oid = o.oid AND fid = 1\n    ) > 2\nORDER BY \n    o.oid;\n```"
                    }
                },
                "in_toks": 5594,
                "out_toks": 293,
                "id": "chatcmpl-Be0RFkG9W2oqyN7mIIoOSTXUvKGrQ",
                "created": 1748874505,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 5,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'feature', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature', 'detection']"
                    }
                },
                "in_toks": 833,
                "out_toks": 28,
                "id": "chatcmpl-Be0Q5c7JkipQ8tEdl8WzrmdzOr1jB",
                "created": 1748874433,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    d.oid,\n    d.candid AS candidate_id,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf AS psf_magnitude,\n    d.sigmapsf AS magnitude_error,\n    d.fid AS feature_fid -- renamed as per user request\nFROM \n    detection d\nJOIN \n    feature f ON d.oid = f.oid\nWHERE \n    d.oid IN (\n        SELECT \n            p.oid\n        FROM \n            probability p\n        WHERE \n            p.class_name = 'SNIIs' -- Assuming 'SN II' corresponds to 'SNII' in class_name\n            AND p.classifier_name = 'lc_classifier'\n            AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n            AND p.probability > 0.6\n    )\n  AND \n    d.oid IN (\n        SELECT \n            o.oid\n        FROM \n            object o\n        WHERE \n            o.ndet > 50\n            AND (SELECT MAX(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) > 2\n    )\nORDER BY \n    d.oid;",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "SELECT \n    d.oid,\n    d.candid AS candidate_id,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf AS psf_magnitude,\n    d.sigmapsf AS magnitude_error,\n    d.fid AS feature_fid -- renamed as per user request\nFROM \n    detection d\nJOIN \n    feature f ON d.oid = f.oid\nWHERE \n    d.oid IN (\n        SELECT \n            p.oid\n        FROM \n            probability p\n        WHERE \n            p.class_name = 'SNIIs' -- Assuming 'SN II' corresponds to 'SNII' in class_name\n            AND p.classifier_name = 'lc_classifier'\n            AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n            AND p.probability > 0.6\n    )\n  AND \n    d.oid IN (\n        SELECT \n            o.oid\n        FROM \n            object o\n        WHERE \n            o.ndet > 50\n            AND (SELECT MAX(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) > 2\n    )\nORDER BY \n    d.oid;"
                    }
                },
                "in_toks": 5594,
                "out_toks": 280,
                "id": "chatcmpl-Be0RIqN3tqZuEb6dpX656EK9SS1TU",
                "created": 1748874508,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "5",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection']"
                },
                "in_toks": 833,
                "out_toks": 14,
                "id": "chatcmpl-BhLhs7XDNE09Cccublji5GI5ipPKi",
                "created": 1749671244,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object and detection information along with feature details, filtering objects classified as SN II with probability > 0.6,\n-- having more than 50 detections, and a magnitude difference > 2 in the g-band, ordered by object id.\n\nSELECT \n    o.oid,\n    d.candid AS detection_candid,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf,\n    d.sigmapsf,\n    d.ra,\n    d.dec,\n    -- Rename 'fid' column as 'feature_fid'\n    f.fid AS feature_fid\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for objects classified as SN II with probability > 0.6\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNII'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n    )\n    -- Filter for objects with more than 50 detections\n    AND o.ndet > 50\n    -- Filter for objects with magnitude difference > 2 in g-band\n    AND (\n        SELECT MAX(f2.value) - MIN(f3.value)\n        FROM feature f2\n        JOIN feature f3 ON f2.oid = f3.oid AND f2.name = f3.name\n        WHERE f2.oid = o.oid AND f2.fid = 1 AND f3.fid = 1 AND f2.name = 'mag'\n    ) > 2\nORDER BY \n    o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object and detection information along with feature details, filtering objects classified as SN II with probability > 0.6,\n-- having more than 50 detections, and a magnitude difference > 2 in the g-band, ordered by object id.\n\nSELECT \n    o.oid,\n    d.candid AS detection_candid,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf,\n    d.sigmapsf,\n    d.ra,\n    d.dec,\n    -- Rename 'fid' column as 'feature_fid'\n    f.fid AS feature_fid\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for objects classified as SN II with probability > 0.6\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNII'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n    )\n    -- Filter for objects with more than 50 detections\n    AND o.ndet > 50\n    -- Filter for objects with magnitude difference > 2 in g-band\n    AND (\n        SELECT MAX(f2.value) - MIN(f3.value)\n        FROM feature f2\n        JOIN feature f3 ON f2.oid = f3.oid AND f2.name = f3.name\n        WHERE f2.oid = o.oid AND f2.fid = 1 AND f3.fid = 1 AND f2.name = 'mag'\n    ) > 2\nORDER BY \n    o.oid;\n```"
                },
                "in_toks": 5594,
                "out_toks": 363,
                "id": "chatcmpl-BhLn9hos1uDebWXAwOoAFA5pWc620",
                "created": 1749671571,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "5",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection']"
                },
                "in_toks": 833,
                "out_toks": 14,
                "id": "chatcmpl-BhLhulhZ5APMR15i5LMmPcirYgqeP",
                "created": 1749671246,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object and detection information along with feature details, renaming 'fid' to 'feature_fid'\nSELECT \n    o.oid,\n    d.candid AS detection_candid,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf AS psf_magnitude,\n    d.sigmapsf AS magnitude_error,\n    -- Rename 'fid' column as 'feature_fid'\n    d.fid AS feature_fid\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\n-- Subquery to filter objects classified as SN II with probability > 0.6\nWHERE \n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE \n            p.class_name = 'SNII'\n            AND p.classifier_name = 'lc_classifier'\n            AND p.probability > 0.6\n            AND p.ranking = 1\n    )\n-- Filter objects with more than 50 detections\nAND \n    o.ndet > 50\n-- Filter objects with magnitude variation in g-band greater than 2\nAND \n    (SELECT MAX(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) > 2\nORDER BY \n    o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object and detection information along with feature details, renaming 'fid' to 'feature_fid'\nSELECT \n    o.oid,\n    d.candid AS detection_candid,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf AS psf_magnitude,\n    d.sigmapsf AS magnitude_error,\n    -- Rename 'fid' column as 'feature_fid'\n    d.fid AS feature_fid\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\n-- Subquery to filter objects classified as SN II with probability > 0.6\nWHERE \n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE \n            p.class_name = 'SNII'\n            AND p.classifier_name = 'lc_classifier'\n            AND p.probability > 0.6\n            AND p.ranking = 1\n    )\n-- Filter objects with more than 50 detections\nAND \n    o.ndet > 50\n-- Filter objects with magnitude variation in g-band greater than 2\nAND \n    (SELECT MAX(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) > 2\nORDER BY \n    o.oid;\n```"
                },
                "in_toks": 5594,
                "out_toks": 310,
                "id": "chatcmpl-BhLnF2XacHr7ZTH8a97GfVnZvWeA8",
                "created": 1749671577,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "0": {
        "0": {
            "req_id": 0,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature']"
                    }
                },
                "in_toks": 823,
                "out_toks": 20,
                "id": "chatcmpl-Be0Q6M4hLCEQxATKnOJkTbQlIKWFL",
                "created": 1748874434,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        f.name,\n        f.value,\n        f.fid,\n        f.version\n    FROM\n        probability p\n    JOIN\n        feature f ON p.oid = f.oid\n    WHERE\n        p.class_name = 'YSO'\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n        AND p.ranking = 1\n        AND f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n        AND EXISTS (\n            SELECT 1\n            FROM feature f2\n            WHERE\n                f2.oid = p.oid\n                AND f2.name = 'Amplitude'\n                AND f2.value > 0.5\n        )\n)\nSELECT\n    oid,\n    possibility,\n    class_name,\n    name,\n    value,\n    fid,\n    version\nFROM\n    yso_prob\nORDER BY\n    possibility DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        f.name,\n        f.value,\n        f.fid,\n        f.version\n    FROM\n        probability p\n    JOIN\n        feature f ON p.oid = f.oid\n    WHERE\n        p.class_name = 'YSO'\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n        AND p.ranking = 1\n        AND f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n        AND EXISTS (\n            SELECT 1\n            FROM feature f2\n            WHERE\n                f2.oid = p.oid\n                AND f2.name = 'Amplitude'\n                AND f2.value > 0.5\n        )\n)\nSELECT\n    oid,\n    possibility,\n    class_name,\n    name,\n    value,\n    fid,\n    version\nFROM\n    yso_prob\nORDER BY\n    possibility DESC;\n```"
                    }
                },
                "in_toks": 5036,
                "out_toks": 264,
                "id": "chatcmpl-Be0RHiu6GbyxpC77g8MdxV3Y7XJQb",
                "created": 1748874507,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 0,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature']"
                    }
                },
                "in_toks": 823,
                "out_toks": 20,
                "id": "chatcmpl-Be0Q6M4hLCEQxATKnOJkTbQlIKWFL",
                "created": 1748874434,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'YSO'\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n        AND p.ranking = 1\n        AND p.probability > 0.7\n),\nperiodic_objects AS (\n    SELECT\n        o.oid,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n),\namplitude_objects AS (\n    SELECT\n        o.oid,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Amplitude'\n        AND f.value > 0.5\n)\nSELECT\n    yso.oid,\n    yso.possibility,\n    f.value,\n    f.name AS feature_name,\n    f.fid,\n    f.version\nFROM\n    yso_prob yso\nJOIN\n    periodic_objects p ON yso.oid = p.oid\nJOIN\n    amplitude_objects a ON yso.oid = a.oid\nJOIN\n    feature f ON yso.oid = f.oid\nWHERE\n    f.name IN ('Period_band', 'Amplitude')\nORDER BY\n    yso.possibility DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'YSO'\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n        AND p.ranking = 1\n        AND p.probability > 0.7\n),\nperiodic_objects AS (\n    SELECT\n        o.oid,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n),\namplitude_objects AS (\n    SELECT\n        o.oid,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Amplitude'\n        AND f.value > 0.5\n)\nSELECT\n    yso.oid,\n    yso.possibility,\n    f.value,\n    f.name AS feature_name,\n    f.fid,\n    f.version\nFROM\n    yso_prob yso\nJOIN\n    periodic_objects p ON yso.oid = p.oid\nJOIN\n    amplitude_objects a ON yso.oid = a.oid\nJOIN\n    feature f ON yso.oid = f.oid\nWHERE\n    f.name IN ('Period_band', 'Amplitude')\nORDER BY\n    yso.possibility DESC;\n```"
                    }
                },
                "in_toks": 5036,
                "out_toks": 401,
                "id": "chatcmpl-Be0RJ4T89w8RDAplporYmhWtHcJay",
                "created": 1748874509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "0",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 823,
                "out_toks": 10,
                "id": "chatcmpl-BhLhvaSAAn2qfwtHNSG0TgcKW0m5C",
                "created": 1749671247,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with high probability of being YSOs and exhibiting periodicity\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'YSO'\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n        AND p.ranking = 1\n        AND p.probability > 0.7\n),\nperiodic_objects AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version AS feature_version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n),\namplitude_objects AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version AS feature_version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Amplitude'\n        AND f.value > 0.5\n)\nSELECT\n    yso_prob.oid,\n    yso_prob.possibility,\n    yso_prob.class_name,\n    yso_prob.classifier_name,\n    yso_prob.classifier_version,\n    f.value AS feature_value,\n    f.name AS feature_name,\n    f.fid AS filter_id,\n    f.version AS feature_version\nFROM\n    yso_prob\nJOIN\n    periodic_objects po ON yso_prob.oid = po.oid\nJOIN\n    amplitude_objects ao ON yso_prob.oid = ao.oid\nJOIN\n    feature f ON yso_prob.oid = f.oid\nWHERE\n    f.name IN ('Period_band', 'Amplitude')\nORDER BY\n    yso_prob.possibility DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with high probability of being YSOs and exhibiting periodicity\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'YSO'\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n        AND p.ranking = 1\n        AND p.probability > 0.7\n),\nperiodic_objects AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version AS feature_version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n),\namplitude_objects AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version AS feature_version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Amplitude'\n        AND f.value > 0.5\n)\nSELECT\n    yso_prob.oid,\n    yso_prob.possibility,\n    yso_prob.class_name,\n    yso_prob.classifier_name,\n    yso_prob.classifier_version,\n    f.value AS feature_value,\n    f.name AS feature_name,\n    f.fid AS filter_id,\n    f.version AS feature_version\nFROM\n    yso_prob\nJOIN\n    periodic_objects po ON yso_prob.oid = po.oid\nJOIN\n    amplitude_objects ao ON yso_prob.oid = ao.oid\nJOIN\n    feature f ON yso_prob.oid = f.oid\nWHERE\n    f.name IN ('Period_band', 'Amplitude')\nORDER BY\n    yso_prob.possibility DESC;\n```"
                },
                "in_toks": 5036,
                "out_toks": 478,
                "id": "chatcmpl-BhLnQxvTz5tHvvlAIloI9gAYLIn2n",
                "created": 1749671588,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "0",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 823,
                "out_toks": 10,
                "id": "chatcmpl-BhLhw0VDZJGrsNHuJheVifWwPLPHV",
                "created": 1749671248,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity with specified conditions\nSELECT \n    o.oid,\n    p.probability AS possibility,\n    f.value,\n    f.name AS feature_name,\n    f.fid AS filter_id,\n    f.version AS feature_version\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    AND p.probability > 0.7\n    AND f.name = 'Period_band'\n    AND f.value BETWEEN 3 AND 10\n    AND EXISTS (\n        SELECT 1\n        FROM feature f2\n        WHERE \n            f2.oid = o.oid\n            AND f2.name = 'Amplitude'\n            AND f2.value > 0.5\n    )\nORDER BY \n    p.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity with specified conditions\nSELECT \n    o.oid,\n    p.probability AS possibility,\n    f.value,\n    f.name AS feature_name,\n    f.fid AS filter_id,\n    f.version AS feature_version\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    AND p.probability > 0.7\n    AND f.name = 'Period_band'\n    AND f.value BETWEEN 3 AND 10\n    AND EXISTS (\n        SELECT 1\n        FROM feature f2\n        WHERE \n            f2.oid = o.oid\n            AND f2.name = 'Amplitude'\n            AND f2.value > 0.5\n    )\nORDER BY \n    p.probability DESC;\n```"
                },
                "in_toks": 5036,
                "out_toks": 238,
                "id": "chatcmpl-BhLnWrC4bgFMABLJkrHpoWCQyQjVg",
                "created": 1749671594,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "28": {
        "0": {
            "req_id": 28,
            "experiment_id": "run_0",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['information_schema.tables']"
                    },
                    "1": {
                        "response": "['information_schema.tables']"
                    }
                },
                "in_toks": 758,
                "out_toks": 10,
                "id": "chatcmpl-Be0Q7VIFkHLheH32QsgFhtPDkvA5i",
                "created": 1748874435,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```"
                    }
                },
                "in_toks": 1879,
                "out_toks": 34,
                "id": "chatcmpl-Be0RKehxitSoSXJj5xopIa7LndU8Z",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 28,
            "experiment_id": "run_1",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['information_schema.tables']"
                    },
                    "1": {
                        "response": "['information_schema.tables']"
                    }
                },
                "in_toks": 758,
                "out_toks": 10,
                "id": "chatcmpl-Be0Q7VIFkHLheH32QsgFhtPDkvA5i",
                "created": 1748874435,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```"
                    }
                },
                "in_toks": 1879,
                "out_toks": 34,
                "id": "chatcmpl-Be0RJc0Spj0ArLzszgJcnuSQc7OXx",
                "created": 1748874509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "28",
            "experiment_id": "run_2",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['information_schema.tables']"
                },
                "in_toks": 758,
                "out_toks": 5,
                "id": "chatcmpl-BhLhxUEyDpEKOdMtQHrU0qaVhvZU6",
                "created": 1749671249,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```"
                },
                "in_toks": 1879,
                "out_toks": 34,
                "id": "chatcmpl-BhLnZVUL53WHU9UFOuWF3KvHrtcYn",
                "created": 1749671597,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "28",
            "experiment_id": "run_3",
            "pred_tables": [
                "information_schema.tables"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['information_schema.tables']"
                },
                "in_toks": 758,
                "out_toks": 5,
                "id": "chatcmpl-BhLhxLsTuKFBLdpIRNDLvYqlcwsOB",
                "created": 1749671249,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```"
                },
                "in_toks": 1879,
                "out_toks": 34,
                "id": "chatcmpl-BhLlWI0mcYiQn9CFL2LedeQ9FM7zk",
                "created": 1749671470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "36": {
        "0": {
            "req_id": 36,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'feature']"
                    }
                },
                "in_toks": 766,
                "out_toks": 16,
                "id": "chatcmpl-Be0Q8Zv8EeBdz8kBZCnYhzJ2JFqTO",
                "created": 1748874436,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the object oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select the object oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```"
                    }
                },
                "in_toks": 5343,
                "out_toks": 57,
                "id": "chatcmpl-Be0RMt8iIJ8JGdzFuynrvGKsqew66",
                "created": 1748874512,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 36,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'feature']"
                    }
                },
                "in_toks": 766,
                "out_toks": 16,
                "id": "chatcmpl-Be0Q8Zv8EeBdz8kBZCnYhzJ2JFqTO",
                "created": 1748874436,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the object oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select the object oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```"
                    }
                },
                "in_toks": 4795,
                "out_toks": 57,
                "id": "chatcmpl-Be0RIELLhE8UauxdLgh7uVLqRYsQ7",
                "created": 1748874508,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "36",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'detection']"
                },
                "in_toks": 766,
                "out_toks": 10,
                "id": "chatcmpl-BhLhyyrq35m23eB7TNnCmwAZgL5VU",
                "created": 1749671250,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the object oid, feature names, and feature values for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object oid, feature names, and feature values for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```"
                },
                "in_toks": 5343,
                "out_toks": 57,
                "id": "chatcmpl-BhLlWnYgjDp93rxsexefrpYifNI2R",
                "created": 1749671470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "36",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 766,
                "out_toks": 6,
                "id": "chatcmpl-BhLhyrQtw9MFOJ5eiIK4pvT4Akbv8",
                "created": 1749671250,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the object oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```"
                },
                "in_toks": 4795,
                "out_toks": 57,
                "id": "chatcmpl-BhLlVWiWZNMNTrtG39yEz7FeoB131",
                "created": 1749671469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "38": {
        "0": {
            "req_id": 38,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 804,
                "out_toks": 22,
                "id": "chatcmpl-Be0Q97BBjTq76FQfT3u5WqD3hNb3I",
                "created": 1748874437,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detection counts between 30 and 200 and present in AGN candidates\nagn_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet BETWEEN 30 AND 200\n      AND o.oid IN (SELECT oid FROM agn_candidates)\n),\n-- Filter objects with detection counts between 30 and 200 and present in QSO candidates\nqso_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet BETWEEN 30 AND 200\n      AND o.oid IN (SELECT oid FROM qso_candidates)\n)\n-- Final selection: objects that are either AGN or QSO candidates with detection counts in range\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM agn_filtered)\n   OR o.oid IN (SELECT oid FROM qso_filtered);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detection counts between 30 and 200 and present in AGN candidates\nagn_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet BETWEEN 30 AND 200\n      AND o.oid IN (SELECT oid FROM agn_candidates)\n),\n-- Filter objects with detection counts between 30 and 200 and present in QSO candidates\nqso_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet BETWEEN 30 AND 200\n      AND o.oid IN (SELECT oid FROM qso_candidates)\n)\n-- Final selection: objects that are either AGN or QSO candidates with detection counts in range\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM agn_filtered)\n   OR o.oid IN (SELECT oid FROM qso_filtered);\n```"
                },
                "in_toks": 2470,
                "out_toks": 425,
                "id": "chatcmpl-BhN0IdbawIRyGkqTRIRFE0qP8iEUK",
                "created": 1749676230,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detection counts between 30 and 200\nagn_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet BETWEEN 30 AND 200\n    AND o.oid IN (SELECT oid FROM agn_candidates)\n),\nqso_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet BETWEEN 30 AND 200\n    AND o.oid IN (SELECT oid FROM qso_candidates)\n)\n-- Final selection of objects that meet all criteria\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM agn_filtered)\n   OR o.oid IN (SELECT oid FROM qso_filtered);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detection counts between 30 and 200\nagn_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet BETWEEN 30 AND 200\n    AND o.oid IN (SELECT oid FROM agn_candidates)\n),\nqso_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet BETWEEN 30 AND 200\n    AND o.oid IN (SELECT oid FROM qso_candidates)\n)\n-- Final selection of objects that meet all criteria\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM agn_filtered)\n   OR o.oid IN (SELECT oid FROM qso_filtered);\n```"
                    }
                },
                "in_toks": 3133,
                "out_toks": 390,
                "id": "chatcmpl-Be0RJU2C0MSBKKLeaQMyfDvzIX7xH",
                "created": 1748874509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 38,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 804,
                "out_toks": 22,
                "id": "chatcmpl-Be0Q97BBjTq76FQfT3u5WqD3hNb3I",
                "created": 1748874437,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      -- Additional conditions to refine selection, e.g., date range or other relevant filters can be added here\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.5\n      AND p.ranking = 1\n      -- Additional conditions to refine selection, e.g., date range or other relevant filters can be added here\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter AGN objects with detections between 30 and 200\nagn_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\n-- Filter QSO objects with detections between 30 and 200\nqso_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Final combined selection of AGN and QSO objects\nSELECT * FROM agn_filtered\nUNION\nSELECT * FROM qso_filtered;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      -- Additional conditions to refine selection, e.g., date range or other relevant filters can be added here\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.5\n      AND p.ranking = 1\n      -- Additional conditions to refine selection, e.g., date range or other relevant filters can be added here\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter AGN objects with detections between 30 and 200\nagn_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\n-- Filter QSO objects with detections between 30 and 200\nqso_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Final combined selection of AGN and QSO objects\nSELECT * FROM agn_filtered\nUNION\nSELECT * FROM qso_filtered;\n```"
                },
                "in_toks": 2522,
                "out_toks": 478,
                "id": "chatcmpl-BhN0CfL59ECXbuGKPdrRoo4E5S9ZX",
                "created": 1749676224,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detections between 30 and 200\nagn_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\nqso_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Final selection combining both AGN and QSO objects\nSELECT * FROM agn_filtered\nUNION\nSELECT * FROM qso_filtered;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detections between 30 and 200\nagn_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\nqso_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Final selection combining both AGN and QSO objects\nSELECT * FROM agn_filtered\nUNION\nSELECT * FROM qso_filtered;\n```"
                    }
                },
                "in_toks": 3133,
                "out_toks": 417,
                "id": "chatcmpl-Be0RJaHT4qKIzDAHACxCA9BzvinD7",
                "created": 1748874509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "38",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 804,
                "out_toks": 11,
                "id": "chatcmpl-BhLhzDAAyiO57lGZWRPBWYLhqmaft",
                "created": 1749671251,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detections between 30 and 200\nagn_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\nqso_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Combine the results\nSELECT * FROM agn_filtered\nUNION ALL\nSELECT * FROM qso_filtered;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detections between 30 and 200\nagn_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\nqso_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Combine the results\nSELECT * FROM agn_filtered\nUNION ALL\nSELECT * FROM qso_filtered;\n```"
                },
                "in_toks": 3133,
                "out_toks": 411,
                "id": "chatcmpl-BhLlVCEQBWqpKQdUHPihejlpdlYc7",
                "created": 1749671469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "38",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 804,
                "out_toks": 11,
                "id": "chatcmpl-BhLi02Qb6KnmNdmipVOZb9ZmlZ7DG",
                "created": 1749671252,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n),\n-- Filter objects with detection counts between 30 and 200 for AGN candidates\nagn_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\n-- Filter objects with detection counts between 30 and 200 for QSO candidates\nqso_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Final selection of objects that meet all criteria\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM agn_filtered)\n   OR o.oid IN (SELECT oid FROM qso_filtered);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n),\n-- Filter objects with detection counts between 30 and 200 for AGN candidates\nagn_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\n-- Filter objects with detection counts between 30 and 200 for QSO candidates\nqso_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Final selection of objects that meet all criteria\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM agn_filtered)\n   OR o.oid IN (SELECT oid FROM qso_filtered);\n```"
                },
                "in_toks": 2416,
                "out_toks": 355,
                "id": "chatcmpl-BhN0D2u9dNOJvrYZnNLFBM55cpAcR",
                "created": 1749676225,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detection counts between 30 and 200\nagn_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\nqso_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Final selection of objects that meet all criteria\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM agn_filtered)\n   OR o.oid IN (SELECT oid FROM qso_filtered);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detection counts between 30 and 200\nagn_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\nqso_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Final selection of objects that meet all criteria\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM agn_filtered)\n   OR o.oid IN (SELECT oid FROM qso_filtered);\n```"
                },
                "in_toks": 3133,
                "out_toks": 364,
                "id": "chatcmpl-BhLlXL9ZuqyoQq9UCCth3ebv740ue",
                "created": 1749671471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "24": {
        "0": {
            "req_id": 24,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 811,
                "out_toks": 22,
                "id": "chatcmpl-Be0QA1kbshb7q8B2Ov1sEDCJl5jaQ",
                "created": 1748874438,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON true\n    WHERE q3c_join(o.meanra, o.meandec, s.column2, s.column3, 10)\n      AND o.firstmjd BETWEEN 59976.0 AND 59982.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM filtered_objects);",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON true\n    WHERE q3c_join(o.meanra, o.meandec, s.column2, s.column3, 10)\n      AND o.firstmjd BETWEEN 59976.0 AND 59982.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM filtered_objects);"
                    }
                },
                "in_toks": 3169,
                "out_toks": 143,
                "id": "chatcmpl-Be0RJV8KRtLUANuNMYu0JmpjaA4sg",
                "created": 1748874509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 24,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 811,
                "out_toks": 22,
                "id": "chatcmpl-Be0QA1kbshb7q8B2Ov1sEDCJl5jaQ",
                "created": 1748874438,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Define the source positions with their names, right ascension, and declination\nWITH sources AS (\n    SELECT * FROM (VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n    ) AS t(source_name, ra, dec)\n),\n-- Calculate the time window for the first 7 days of February 2023 in MJD\ntime_window AS (\n    SELECT\n        -- MJD for 1st February 2023 00:00:00 UTC\n        EXTRACT(JULIAN FROM TIMESTAMP '2023-02-01 00:00:00') AS mjd_start,\n        -- MJD for 8th February 2023 00:00:00 UTC (exclusive upper bound)\n        EXTRACT(JULIAN FROM TIMESTAMP '2023-02-08 00:00:00') AS mjd_end\n)\nSELECT o.*, p.*, d.*\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nJOIN sources s ON TRUE\nCROSS JOIN time_window tw\nWHERE\n    -- Use q3c_join to find objects within 10 degrees of source positions\n    q3c_join(s.ra, s.dec, o.meanra, o.meandec, 10)\n    -- Filter detections to those within the first 7 days of February 2023\n    AND d.mjd >= tw.mjd_start\n    AND d.mjd < tw.mjd_end\n    -- Ensure detection is after the object's first detection\n    AND d.mjd >= o.firstmjd\n    -- Limit to detections within 7 days after first detection\n    AND d.mjd <= o.firstmjd + 7\n    -- Filter for class 'Transient' and classifier 'lc_classifier_top' with top ranking\n    AND p.class_name = 'Transient'\n    AND p.classifier_name = 'lc_classifier_top'\n    AND p.ranking = 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Define the source positions with their names, right ascension, and declination\nWITH sources AS (\n    SELECT * FROM (VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n    ) AS t(source_name, ra, dec)\n),\n-- Calculate the time window for the first 7 days of February 2023 in MJD\ntime_window AS (\n    SELECT\n        -- MJD for 1st February 2023 00:00:00 UTC\n        EXTRACT(JULIAN FROM TIMESTAMP '2023-02-01 00:00:00') AS mjd_start,\n        -- MJD for 8th February 2023 00:00:00 UTC (exclusive upper bound)\n        EXTRACT(JULIAN FROM TIMESTAMP '2023-02-08 00:00:00') AS mjd_end\n)\nSELECT o.*, p.*, d.*\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nJOIN sources s ON TRUE\nCROSS JOIN time_window tw\nWHERE\n    -- Use q3c_join to find objects within 10 degrees of source positions\n    q3c_join(s.ra, s.dec, o.meanra, o.meandec, 10)\n    -- Filter detections to those within the first 7 days of February 2023\n    AND d.mjd >= tw.mjd_start\n    AND d.mjd < tw.mjd_end\n    -- Ensure detection is after the object's first detection\n    AND d.mjd >= o.firstmjd\n    -- Limit to detections within 7 days after first detection\n    AND d.mjd <= o.firstmjd + 7\n    -- Filter for class 'Transient' and classifier 'lc_classifier_top' with top ranking\n    AND p.class_name = 'Transient'\n    AND p.classifier_name = 'lc_classifier_top'\n    AND p.ranking = 1;"
                },
                "in_toks": 2153,
                "out_toks": 447,
                "id": "chatcmpl-BhN0JFEozGe6bnKFz5kD6VWBCEC59",
                "created": 1749676231,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.*, p.*, d.*\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nJOIN sources s ON TRUE\nWHERE s.column1 = s.source_name\n  AND q3c_join(s.column2, s.column3, o.meanra, o.meandec, 10)\n  AND d.mjd BETWEEN 59976.0 AND 59983.0\n  AND d.mjd >= o.firstmjd\n  AND d.mjd <= o.firstmjd + 7\n  AND p.class_name = 'Transient'\n  AND p.classifier_name = 'lc_classifier_top'\n  AND p.ranking = 1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nWITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.*, p.*, d.*\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nJOIN sources s ON TRUE\nWHERE s.column1 = s.source_name\n  AND q3c_join(s.column2, s.column3, o.meanra, o.meandec, 10)\n  AND d.mjd BETWEEN 59976.0 AND 59983.0\n  AND d.mjd >= o.firstmjd\n  AND d.mjd <= o.firstmjd + 7\n  AND p.class_name = 'Transient'\n  AND p.classifier_name = 'lc_classifier_top'\n  AND p.ranking = 1;\n```"
                    }
                },
                "in_toks": 3169,
                "out_toks": 209,
                "id": "chatcmpl-Be0RJiYIHyT2PHMZs97WxjUaesaeZ",
                "created": 1748874509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "24",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 811,
                "out_toks": 10,
                "id": "chatcmpl-BhLi0hbvtuo7GSpoJMF7LLSAQXXkV",
                "created": 1749671252,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.oid, o.firstmjd, o.mjdstarthist, o.mjdendhist, o.firstmjd, o.mjdendhist\nFROM object o\nJOIN sources s ON true\nWHERE q3c_join(s.column2, s.column3, o.meanra, o.meandec, 10)\nAND o.firstmjd BETWEEN 59976.0 AND 59983.0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.oid, o.firstmjd, o.mjdstarthist, o.mjdendhist, o.firstmjd, o.mjdendhist\nFROM object o\nJOIN sources s ON true\nWHERE q3c_join(s.column2, s.column3, o.meanra, o.meandec, 10)\nAND o.firstmjd BETWEEN 59976.0 AND 59983.0;\n```"
                },
                "in_toks": 5053,
                "out_toks": 146,
                "id": "chatcmpl-BhLlfR1R0tlKQK6S8ALFVuIYPVrhJ",
                "created": 1749671479,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "24",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 811,
                "out_toks": 10,
                "id": "chatcmpl-BhLi1mLkVdTJkXBjP6uFiejJ4xPEu",
                "created": 1749671253,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.oid, o.firstmjd, o.meanra, o.meandec\nFROM object o\nJOIN sources s ON true\nWHERE q3c_radial_query(o.meanra, o.meandec, s.column2, s.column3, 10)\nAND o.firstmjd BETWEEN 59976.0 AND 59983.0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.oid, o.firstmjd, o.meanra, o.meandec\nFROM object o\nJOIN sources s ON true\nWHERE q3c_radial_query(o.meanra, o.meandec, s.column2, s.column3, 10)\nAND o.firstmjd BETWEEN 59976.0 AND 59983.0;\n```"
                },
                "in_toks": 5053,
                "out_toks": 134,
                "id": "chatcmpl-BhLlgTqZzCOSjeJmrPzuryM9NWZmg",
                "created": 1749671480,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "31": {
        "0": {
            "req_id": 31,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'feature', 'probability']"
                    }
                },
                "in_toks": 783,
                "out_toks": 20,
                "id": "chatcmpl-Be0QBHmj9PuPjRZpEURLfP3jQ7Brl",
                "created": 1748874439,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detection_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for classified objects\nSELECT\n    o.meanra AS galactic_longitude,\n    o.meandec AS galactic_latitude,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM\n    first_detection_objects fdo\nJOIN\n    object o ON o.oid = fdo.oid\nJOIN\n    feature f ON f.oid = o.oid\nJOIN\n    probability p ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\n    AND p.ranking = 1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detection_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for classified objects\nSELECT\n    o.meanra AS galactic_longitude,\n    o.meandec AS galactic_latitude,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM\n    first_detection_objects fdo\nJOIN\n    object o ON o.oid = fdo.oid\nJOIN\n    feature f ON f.oid = o.oid\nJOIN\n    probability p ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\n    AND p.ranking = 1;\n```"
                    }
                },
                "in_toks": 5051,
                "out_toks": 230,
                "id": "chatcmpl-Be0RKBYe9FweT0wmOeUiQDQGdVZ8u",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 31,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'feature', 'probability']"
                    }
                },
                "in_toks": 783,
                "out_toks": 20,
                "id": "chatcmpl-Be0QBHmj9PuPjRZpEURLfP3jQ7Brl",
                "created": 1748874439,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detection_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for classified objects\nSELECT\n    o.meanra AS ra,\n    o.meandec AS dec,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM\n    first_detection_objects fdo\nJOIN\n    object o ON o.oid = fdo.oid\nLEFT JOIN\n    feature f ON f.oid = o.oid\nLEFT JOIN\n    probability p ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\nORDER BY\n    o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detection_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for classified objects\nSELECT\n    o.meanra AS ra,\n    o.meandec AS dec,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM\n    first_detection_objects fdo\nJOIN\n    object o ON o.oid = fdo.oid\nLEFT JOIN\n    feature f ON f.oid = o.oid\nLEFT JOIN\n    probability p ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\nORDER BY\n    o.oid;\n```"
                    }
                },
                "in_toks": 5051,
                "out_toks": 225,
                "id": "chatcmpl-Be0RKnOzxgISBVs43wbLhCi4Ypvpr",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "31",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']"
                },
                "in_toks": 783,
                "out_toks": 10,
                "id": "chatcmpl-BhLi2BQubnmTOBJNqbicpNXnaQ930",
                "created": 1749671254,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detection_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for classified objects\nSELECT\n    o.meanra AS ra,\n    o.meandec AS dec,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM\n    first_detection_objects fdo\nJOIN\n    object o ON o.oid = fdo.oid\nLEFT JOIN\n    feature f ON f.oid = o.oid\nLEFT JOIN\n    probability p ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\nORDER BY\n    o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detection_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for classified objects\nSELECT\n    o.meanra AS ra,\n    o.meandec AS dec,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM\n    first_detection_objects fdo\nJOIN\n    object o ON o.oid = fdo.oid\nLEFT JOIN\n    feature f ON f.oid = o.oid\nLEFT JOIN\n    probability p ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\nORDER BY\n    o.oid;\n```"
                },
                "in_toks": 5051,
                "out_toks": 225,
                "id": "chatcmpl-BhLlkIcvl4SC7ooWzKqtWgtqUDF5R",
                "created": 1749671484,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "31",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']"
                },
                "in_toks": 783,
                "out_toks": 10,
                "id": "chatcmpl-BhLi2uWiXlr8KmB4xG322Qko3vEOC",
                "created": 1749671254,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for these objects\nSELECT \n    o.meanra AS ra,\n    o.meandec AS dec,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM \n    first_detected_objects fdo\nJOIN \n    object o ON o.oid = fdo.oid\nLEFT JOIN \n    feature f ON f.oid = o.oid\nLEFT JOIN \n    probability p ON p.oid = o.oid\nWHERE \n    p.classifier_name = 'lc_classifier' AND\n    p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\nORDER BY \n    o.oid, f.name;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for these objects\nSELECT \n    o.meanra AS ra,\n    o.meandec AS dec,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM \n    first_detected_objects fdo\nJOIN \n    object o ON o.oid = fdo.oid\nLEFT JOIN \n    feature f ON f.oid = o.oid\nLEFT JOIN \n    probability p ON p.oid = o.oid\nWHERE \n    p.classifier_name = 'lc_classifier' AND\n    p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\nORDER BY \n    o.oid, f.name;\n```"
                },
                "in_toks": 5051,
                "out_toks": 231,
                "id": "chatcmpl-BhLlowbNUAXNesWotnPLkha1oSKQs",
                "created": 1749671488,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "33": {
        "0": {
            "req_id": 33,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'detection']"
                    }
                },
                "in_toks": 854,
                "out_toks": 14,
                "id": "chatcmpl-Be0QBweVVaqEfEhyBjDJ4zrUTjUYx",
                "created": 1748874439,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```"
                    }
                },
                "in_toks": 2999,
                "out_toks": 146,
                "id": "chatcmpl-Be0RLrgQ0IraSlmsiCLkFFfza8aL3",
                "created": 1748874511,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 33,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'detection']"
                    }
                },
                "in_toks": 854,
                "out_toks": 14,
                "id": "chatcmpl-Be0QBweVVaqEfEhyBjDJ4zrUTjUYx",
                "created": 1748874439,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```"
                    }
                },
                "in_toks": 2999,
                "out_toks": 146,
                "id": "chatcmpl-Be0RJBCJkbelptIB6YG6Wjv8dvAyz",
                "created": 1748874509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "33",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 854,
                "out_toks": 7,
                "id": "chatcmpl-BhLi3yOYMu6UL7d07T12CFWtUY5VI",
                "created": 1749671255,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```"
                },
                "in_toks": 2999,
                "out_toks": 146,
                "id": "chatcmpl-BhLlrwjfNjTHvXGEpzwld938w3kHx",
                "created": 1749671491,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "33",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 854,
                "out_toks": 7,
                "id": "chatcmpl-BhLi3e9qqWB04Bk0C7R3Si4scbwmZ",
                "created": 1749671255,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```"
                },
                "in_toks": 2999,
                "out_toks": 146,
                "id": "chatcmpl-BhLlyqBxZ6WTeet9T4HxSgZbAg1jU",
                "created": 1749671498,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "6": {
        "0": {
            "req_id": 6,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 837,
                "out_toks": 22,
                "id": "chatcmpl-Be0QCqqbYOy5PJ0BaXk2kTUdo3eel",
                "created": 1748874440,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object and detection details for objects classified as SN II in 2019-2022\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n),\nsn_ii_detections AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.fid AS f_id\n    FROM detection d\n    JOIN sn_ii_objects o ON d.oid = o.oid\n),\nrise_rates AS (\n    SELECT\n        d1.oid,\n        (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS rise_rate,\n        d1.mjd AS start_mjd,\n        d2.mjd AS end_mjd\n    FROM sn_ii_detections d1\n    JOIN sn_ii_detections d2 ON d1.oid = d2.oid AND d2.mjd > d1.mjd\n    WHERE d1.f_id IN (1, 2) AND d2.f_id IN (1, 2)\n),\ninitial_rise AS (\n    SELECT\n        oid,\n        AVG(rise_rate) AS avg_rise_rate\n    FROM rise_rates\n    WHERE (end_mjd - start_mjd) <= 30 -- consider rise over up to 30 days\n    GROUP BY oid\n),\nobservation_stats AS (\n    SELECT\n        d.oid,\n        COUNT(*) FILTER (WHERE d.f_id = 2) AS r_band_detections,\n        COUNT(*) AS total_detections\n    FROM sn_ii_detections d\n    GROUP BY d.oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    d.f_id\nFROM sn_ii_detections d\nJOIN object o ON d.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nJOIN initial_rise ir ON o.oid = ir.oid\nJOIN observation_stats os ON o.oid = os.oid\nWHERE p.class_name = 'SNII'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.6\n  AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n  AND ir.avg_rise_rate > 0.5\n  AND os.r_band_detections >= 100\n  AND os.total_detections > 30\n  AND d.f_id IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object and detection details for objects classified as SN II in 2019-2022\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n),\nsn_ii_detections AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.fid AS f_id\n    FROM detection d\n    JOIN sn_ii_objects o ON d.oid = o.oid\n),\nrise_rates AS (\n    SELECT\n        d1.oid,\n        (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd) AS rise_rate,\n        d1.mjd AS start_mjd,\n        d2.mjd AS end_mjd\n    FROM sn_ii_detections d1\n    JOIN sn_ii_detections d2 ON d1.oid = d2.oid AND d2.mjd > d1.mjd\n    WHERE d1.f_id IN (1, 2) AND d2.f_id IN (1, 2)\n),\ninitial_rise AS (\n    SELECT\n        oid,\n        AVG(rise_rate) AS avg_rise_rate\n    FROM rise_rates\n    WHERE (end_mjd - start_mjd) <= 30 -- consider rise over up to 30 days\n    GROUP BY oid\n),\nobservation_stats AS (\n    SELECT\n        d.oid,\n        COUNT(*) FILTER (WHERE d.f_id = 2) AS r_band_detections,\n        COUNT(*) AS total_detections\n    FROM sn_ii_detections d\n    GROUP BY d.oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    d.f_id\nFROM sn_ii_detections d\nJOIN object o ON d.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nJOIN initial_rise ir ON o.oid = ir.oid\nJOIN observation_stats os ON o.oid = os.oid\nWHERE p.class_name = 'SNII'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.6\n  AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n  AND ir.avg_rise_rate > 0.5\n  AND os.r_band_detections >= 100\n  AND os.total_detections > 30\n  AND d.f_id IN (1, 2);\n```"
                    }
                },
                "in_toks": 3204,
                "out_toks": 615,
                "id": "chatcmpl-Be0RJdmQa8WyVrDbGVEF2IT11xXGj",
                "created": 1748874509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 6,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 837,
                "out_toks": 22,
                "id": "chatcmpl-Be0QCqqbYOy5PJ0BaXk2kTUdo3eel",
                "created": 1748874440,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object and detection details for objects classified as SN II in 2019-2022\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd >= 58484.0\n      AND o.lastmjd <= 59944.0\n),\nsn_ii_detections AS (\n    SELECT d.candid, d.oid, d.mjd, d.fid AS f_id, d.magpsf, d.sigmapsf\n    FROM detection d\n    JOIN sn_ii_objects s ON d.oid = s.oid\n    WHERE d.mjd BETWEEN 58484.0 AND 59944.0\n),\n-- Calculate initial rise rate in g and r bands\nrise_rates AS (\n    SELECT\n        oid,\n        -- Calculate rise rate in g-band (fid=1)\n        CASE\n            WHEN COUNT(CASE WHEN f_id = 1 THEN 1 END) >= 2 THEN\n                (MAX(magpsf) FILTER (WHERE f_id = 1) - MIN(magpsf) FILTER (WHERE f_id = 1))\n                / NULLIF(MAX(mjd) FILTER (WHERE f_id = 1) - MIN(mjd) FILTER (WHERE f_id = 1), 0)\n            ELSE NULL\n        END AS rise_rate_g,\n        -- Calculate rise rate in r-band (fid=2)\n        CASE\n            WHEN COUNT(CASE WHEN f_id = 2 THEN 1 END) >= 2 THEN\n                (MAX(magpsf) FILTER (WHERE f_id = 2) - MIN(magpsf) FILTER (WHERE f_id = 2))\n                / NULLIF(MAX(mjd) FILTER (WHERE f_id = 2) - MIN(mjd) FILTER (WHERE f_id = 2), 0)\n            ELSE NULL\n        END AS rise_rate_r,\n        -- Count number of r-band detections\n        COUNT(CASE WHEN f_id = 2 THEN 1 END) AS n_r_detections,\n        -- Count total days of observations in r-band\n        (MAX(mjd) FILTER (WHERE f_id = 2) - MIN(mjd) FILTER (WHERE f_id = 2)) AS r_band_days\n    FROM sn_ii_detections\n    GROUP BY oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.f_id,\n    d.magpsf,\n    d.sigmapsf\nFROM sn_ii_detections d\nJOIN rise_rates r ON d.oid = r.oid\nWHERE\n    -- Initial rise rate > 0.5 mag/day in g and r bands\n    (r.rise_rate_g IS NULL OR r.rise_rate_g > 0.5)\n    AND (r.rise_rate_r IS NULL OR r.rise_rate_r > 0.5)\n    -- At least 100 days of observations in r-band\n    AND r.r_band_days >= 100\n    -- Number of r-band detections > 30\n    AND r.n_r_detections > 30\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object and detection details for objects classified as SN II in 2019-2022\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd >= 58484.0\n      AND o.lastmjd <= 59944.0\n),\nsn_ii_detections AS (\n    SELECT d.candid, d.oid, d.mjd, d.fid AS f_id, d.magpsf, d.sigmapsf\n    FROM detection d\n    JOIN sn_ii_objects s ON d.oid = s.oid\n    WHERE d.mjd BETWEEN 58484.0 AND 59944.0\n),\n-- Calculate initial rise rate in g and r bands\nrise_rates AS (\n    SELECT\n        oid,\n        -- Calculate rise rate in g-band (fid=1)\n        CASE\n            WHEN COUNT(CASE WHEN f_id = 1 THEN 1 END) >= 2 THEN\n                (MAX(magpsf) FILTER (WHERE f_id = 1) - MIN(magpsf) FILTER (WHERE f_id = 1))\n                / NULLIF(MAX(mjd) FILTER (WHERE f_id = 1) - MIN(mjd) FILTER (WHERE f_id = 1), 0)\n            ELSE NULL\n        END AS rise_rate_g,\n        -- Calculate rise rate in r-band (fid=2)\n        CASE\n            WHEN COUNT(CASE WHEN f_id = 2 THEN 1 END) >= 2 THEN\n                (MAX(magpsf) FILTER (WHERE f_id = 2) - MIN(magpsf) FILTER (WHERE f_id = 2))\n                / NULLIF(MAX(mjd) FILTER (WHERE f_id = 2) - MIN(mjd) FILTER (WHERE f_id = 2), 0)\n            ELSE NULL\n        END AS rise_rate_r,\n        -- Count number of r-band detections\n        COUNT(CASE WHEN f_id = 2 THEN 1 END) AS n_r_detections,\n        -- Count total days of observations in r-band\n        (MAX(mjd) FILTER (WHERE f_id = 2) - MIN(mjd) FILTER (WHERE f_id = 2)) AS r_band_days\n    FROM sn_ii_detections\n    GROUP BY oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.f_id,\n    d.magpsf,\n    d.sigmapsf\nFROM sn_ii_detections d\nJOIN rise_rates r ON d.oid = r.oid\nWHERE\n    -- Initial rise rate > 0.5 mag/day in g and r bands\n    (r.rise_rate_g IS NULL OR r.rise_rate_g > 0.5)\n    AND (r.rise_rate_r IS NULL OR r.rise_rate_r > 0.5)\n    -- At least 100 days of observations in r-band\n    AND r.r_band_days >= 100\n    -- Number of r-band detections > 30\n    AND r.n_r_detections > 30\n```"
                    }
                },
                "in_toks": 3204,
                "out_toks": 712,
                "id": "chatcmpl-Be0RJJnI2fS8xITbrSRT1LPvvbxpn",
                "created": 1748874509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "6",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 837,
                "out_toks": 15,
                "id": "chatcmpl-BhLi3eRPrrQh9YyRgPfqINlzoJvkx",
                "created": 1749671255,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object and detection details for objects classified as SN II in 2019-2022\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n),\ndetection_filtered AS (\n    SELECT d.candid, d.oid, d.mjd, d.ra, d.dec, d.magpsf, d.sigmapsf, d.fid AS f_id\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_ii_objects)\n      AND d.mjd BETWEEN 58484.0 AND 59944.0\n),\nmagstat_r AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.sigmadm_first, ms.dmdt_first, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM sn_ii_objects)\n      AND ms.fid IN (1, 2) -- g and r bands\n),\nrise_rates AS (\n    SELECT\n        m.oid,\n        m.fid AS f_id,\n        -- Calculate initial rise rate: change in magnitude over time\n        CASE\n            WHEN d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL AND (d2.mjd - d1.mjd) > 0\n                THEN (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd)\n            ELSE NULL\n        END AS rise_rate\n    FROM\n        (SELECT DISTINCT oid, f_id FROM magstat_r) m\n        LEFT JOIN detection_filtered d1 ON m.oid = d1.oid AND m.f_id = d1.f_id\n        LEFT JOIN detection_filtered d2 ON m.oid = d2.oid AND m.f_id = d2.f_id AND d2.mjd > d1.mjd\n    WHERE\n        d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL\n),\nobjects_with_rise AS (\n    SELECT DISTINCT oid\n    FROM rise_rates\n    WHERE rise_rate > 0.5\n),\ndetection_final AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.f_id\n    FROM detection_filtered d\n    WHERE d.oid IN (SELECT oid FROM objects_with_rise)\n),\nmagstat_r_days AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM objects_with_rise)\n),\nobservation_days AS (\n    SELECT\n        oid,\n        MAX(CASE WHEN f_id = 2 THEN lastmjd END) AS last_mjd_r,\n        MIN(CASE WHEN f_id = 2 THEN firstmjd END) AS first_mjd_r\n    FROM magstat_r_days\n    GROUP BY oid\n),\nobjects_with_observations AS (\n    SELECT oid\n    FROM observation_days\n    WHERE (last_mjd_r - first_mjd_r) >= 100\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS ndet_r\n    FROM detection_filtered\n    WHERE f_id = 2\n    GROUP BY oid\n),\nfinal_objects AS (\n    SELECT o.oid\n    FROM objects_with_rise o\n    JOIN objects_with_observations ob ON o.oid = ob.oid\n    JOIN detection_counts dc ON o.oid = dc.oid\n    WHERE dc.ndet_r > 30\n)\n-- Final selection of detection data with required filters\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    d.f_id\nFROM detection_final d\nWHERE d.oid IN (SELECT oid FROM final_objects)\nORDER BY d.oid, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object and detection details for objects classified as SN II in 2019-2022\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n),\ndetection_filtered AS (\n    SELECT d.candid, d.oid, d.mjd, d.ra, d.dec, d.magpsf, d.sigmapsf, d.fid AS f_id\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_ii_objects)\n      AND d.mjd BETWEEN 58484.0 AND 59944.0\n),\nmagstat_r AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.sigmadm_first, ms.dmdt_first, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM sn_ii_objects)\n      AND ms.fid IN (1, 2) -- g and r bands\n),\nrise_rates AS (\n    SELECT\n        m.oid,\n        m.fid AS f_id,\n        -- Calculate initial rise rate: change in magnitude over time\n        CASE\n            WHEN d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL AND (d2.mjd - d1.mjd) > 0\n                THEN (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd)\n            ELSE NULL\n        END AS rise_rate\n    FROM\n        (SELECT DISTINCT oid, f_id FROM magstat_r) m\n        LEFT JOIN detection_filtered d1 ON m.oid = d1.oid AND m.f_id = d1.f_id\n        LEFT JOIN detection_filtered d2 ON m.oid = d2.oid AND m.f_id = d2.f_id AND d2.mjd > d1.mjd\n    WHERE\n        d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL\n),\nobjects_with_rise AS (\n    SELECT DISTINCT oid\n    FROM rise_rates\n    WHERE rise_rate > 0.5\n),\ndetection_final AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.f_id\n    FROM detection_filtered d\n    WHERE d.oid IN (SELECT oid FROM objects_with_rise)\n),\nmagstat_r_days AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM objects_with_rise)\n),\nobservation_days AS (\n    SELECT\n        oid,\n        MAX(CASE WHEN f_id = 2 THEN lastmjd END) AS last_mjd_r,\n        MIN(CASE WHEN f_id = 2 THEN firstmjd END) AS first_mjd_r\n    FROM magstat_r_days\n    GROUP BY oid\n),\nobjects_with_observations AS (\n    SELECT oid\n    FROM observation_days\n    WHERE (last_mjd_r - first_mjd_r) >= 100\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS ndet_r\n    FROM detection_filtered\n    WHERE f_id = 2\n    GROUP BY oid\n),\nfinal_objects AS (\n    SELECT o.oid\n    FROM objects_with_rise o\n    JOIN objects_with_observations ob ON o.oid = ob.oid\n    JOIN detection_counts dc ON o.oid = dc.oid\n    WHERE dc.ndet_r > 30\n)\n-- Final selection of detection data with required filters\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    d.f_id\nFROM detection_final d\nWHERE d.oid IN (SELECT oid FROM final_objects)\nORDER BY d.oid, d.mjd;\n```"
                },
                "in_toks": 4134,
                "out_toks": 871,
                "id": "chatcmpl-BhN0D9sGdZdTDueZ9Vmp39Doi64Sy",
                "created": 1749676225,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object and detection details for objects classified as SN II in 2019-2022\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n),\ndetection_filtered AS (\n    SELECT d.candid, d.oid, d.mjd, d.ra, d.dec, d.magpsf, d.sigmapsf, d.fid AS f_id\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_ii_objects)\n      AND d.mjd BETWEEN 58484.0 AND 59944.0\n),\nmagstat_r AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.sigmadm_first, ms.dmdt_first, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM sn_ii_objects)\n      AND ms.fid IN (1, 2) -- g and r bands\n),\nrise_rates AS (\n    SELECT\n        oid,\n        f_id,\n        -- Calculate initial rise rate: change in magnitude over time\n        CASE\n            WHEN d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL AND (d2.mjd - d1.mjd) > 0\n                THEN (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd)\n            ELSE NULL\n        END AS rise_rate\n    FROM\n        (SELECT DISTINCT oid, f_id FROM magstat_r) m\n        LEFT JOIN detection_filtered d1 ON m.oid = d1.oid AND m.f_id = d1.f_id\n        LEFT JOIN detection_filtered d2 ON m.oid = d2.oid AND m.f_id = d2.f_id AND d2.mjd > d1.mjd\n    WHERE\n        d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL\n),\nobjects_with_rise AS (\n    SELECT DISTINCT oid\n    FROM rise_rates\n    WHERE rise_rate > 0.5\n),\ndetection_final AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.f_id\n    FROM detection_filtered d\n    WHERE d.oid IN (SELECT oid FROM objects_with_rise)\n),\nmagstat_r_days AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM objects_with_rise)\n),\nobservation_days AS (\n    SELECT\n        oid,\n        MAX(CASE WHEN f_id = 2 THEN lastmjd END) AS last_mjd_r,\n        MIN(CASE WHEN f_id = 2 THEN firstmjd END) AS first_mjd_r\n    FROM magstat_r_days\n    GROUP BY oid\n),\nobjects_with_observations AS (\n    SELECT oid\n    FROM observation_days\n    WHERE (last_mjd_r - first_mjd_r) >= 100\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS ndet_r\n    FROM detection_filtered\n    WHERE f_id = 2\n    GROUP BY oid\n),\nfinal_objects AS (\n    SELECT o.oid\n    FROM objects_with_rise o\n    JOIN objects_with_observations ob ON o.oid = ob.oid\n    JOIN detection_counts dc ON o.oid = dc.oid\n    WHERE dc.ndet_r > 30\n)\n-- Final selection of detection data with required filters\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    d.f_id\nFROM detection_final d\nWHERE d.oid IN (SELECT oid FROM final_objects)\nORDER BY d.oid, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object and detection details for objects classified as SN II in 2019-2022\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n),\ndetection_filtered AS (\n    SELECT d.candid, d.oid, d.mjd, d.ra, d.dec, d.magpsf, d.sigmapsf, d.fid AS f_id\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_ii_objects)\n      AND d.mjd BETWEEN 58484.0 AND 59944.0\n),\nmagstat_r AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.sigmadm_first, ms.dmdt_first, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM sn_ii_objects)\n      AND ms.fid IN (1, 2) -- g and r bands\n),\nrise_rates AS (\n    SELECT\n        oid,\n        f_id,\n        -- Calculate initial rise rate: change in magnitude over time\n        CASE\n            WHEN d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL AND (d2.mjd - d1.mjd) > 0\n                THEN (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd)\n            ELSE NULL\n        END AS rise_rate\n    FROM\n        (SELECT DISTINCT oid, f_id FROM magstat_r) m\n        LEFT JOIN detection_filtered d1 ON m.oid = d1.oid AND m.f_id = d1.f_id\n        LEFT JOIN detection_filtered d2 ON m.oid = d2.oid AND m.f_id = d2.f_id AND d2.mjd > d1.mjd\n    WHERE\n        d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL\n),\nobjects_with_rise AS (\n    SELECT DISTINCT oid\n    FROM rise_rates\n    WHERE rise_rate > 0.5\n),\ndetection_final AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.f_id\n    FROM detection_filtered d\n    WHERE d.oid IN (SELECT oid FROM objects_with_rise)\n),\nmagstat_r_days AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM objects_with_rise)\n),\nobservation_days AS (\n    SELECT\n        oid,\n        MAX(CASE WHEN f_id = 2 THEN lastmjd END) AS last_mjd_r,\n        MIN(CASE WHEN f_id = 2 THEN firstmjd END) AS first_mjd_r\n    FROM magstat_r_days\n    GROUP BY oid\n),\nobjects_with_observations AS (\n    SELECT oid\n    FROM observation_days\n    WHERE (last_mjd_r - first_mjd_r) >= 100\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS ndet_r\n    FROM detection_filtered\n    WHERE f_id = 2\n    GROUP BY oid\n),\nfinal_objects AS (\n    SELECT o.oid\n    FROM objects_with_rise o\n    JOIN objects_with_observations ob ON o.oid = ob.oid\n    JOIN detection_counts dc ON o.oid = dc.oid\n    WHERE dc.ndet_r > 30\n)\n-- Final selection of detection data with required filters\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    d.f_id\nFROM detection_final d\nWHERE d.oid IN (SELECT oid FROM final_objects)\nORDER BY d.oid, d.mjd;\n```"
                },
                "in_toks": 3921,
                "out_toks": 865,
                "id": "chatcmpl-BhLlyCQIyUpmqqf1NSHFaI2ZERMIJ",
                "created": 1749671498,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "6",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 837,
                "out_toks": 11,
                "id": "chatcmpl-BhLi4iKJ51jW7lckQ9k5DV9HqTM79",
                "created": 1749671256,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant information from detection and object tables for objects classified as SN II\nWITH sn_ii_objects AS (\n    SELECT\n        o.oid,\n        p.oid AS prob_oid,\n        p.class_name,\n        p.classifier_name,\n        p.probability,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.fid AS band_id,\n        d.ra,\n        d.dec\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        p.class_name = 'SNII'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.6\n        AND d.mjd BETWEEN 58484.0 AND 59944.0\n),\n-- Filter objects with sufficient r-band observations and detections\nfiltered_objects AS (\n    SELECT\n        oid\n    FROM\n        sn_ii_objects\n    WHERE\n        band_id = 2 -- r-band\n    GROUP BY\n        oid\n    HAVING\n        COUNT(*) >= 100\n        AND COUNT(DISTINCT candid) > 30\n),\n-- Calculate initial rise rate for each object in g and r bands\nrise_rates AS (\n    SELECT\n        o.oid,\n        -- For each object, find the earliest and latest detection in g-band\n        MIN(CASE WHEN d.fid = 1 THEN d.mjd END) AS g_start_mjd,\n        MAX(CASE WHEN d.fid = 1 THEN d.mjd END) AS g_end_mjd,\n        -- For r-band\n        MIN(CASE WHEN d.fid = 2 THEN d.mjd END) AS r_start_mjd,\n        MAX(CASE WHEN d.fid = 2 THEN d.mjd END) AS r_end_mjd,\n        -- Corresponding magnitudes\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf END) AS g_min_mag,\n        MIN(CASE WHEN d.fid = 2 THEN d.magpsf END) AS r_min_mag\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        o.oid IN (SELECT oid FROM filtered_objects)\n    GROUP BY\n        o.oid\n),\n-- Calculate rise rates in mag/day for g and r bands\nrise_rate_calc AS (\n    SELECT\n        oid,\n        CASE WHEN g_end_mjd IS NOT NULL AND g_start_mjd IS NOT NULL AND (g_end_mjd - g_start_mjd) > 0\n            THEN (g_min_mag - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 1 AND mjd BETWEEN g_start_mjd AND g_end_mjd))\n                 / (g_end_mjd - g_start_mjd)\n            ELSE NULL\n        END AS g_rise_rate,\n        CASE WHEN r_end_mjd IS NOT NULL AND r_start_mjd IS NOT NULL AND (r_end_mjd - r_start_mjd) > 0\n            THEN (r_min_mag - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 2 AND mjd BETWEEN r_start_mjd AND r_end_mjd))\n                 / (r_end_mjd - r_start_mjd)\n            ELSE NULL\n        END AS r_rise_rate\n    FROM\n        rise_rates o\n),\n-- Select objects with initial rise rate > 0.5 mag/day in g and r bands\nobjects_with_rise AS (\n    SELECT\n        o.oid\n    FROM\n        rise_rate_calc o\n    WHERE\n        (g_rise_rate > 0.5 OR r_rise_rate > 0.5)\n)\n-- Final selection of detections for objects meeting all criteria\nSELECT\n    d.oid,\n    d.candid AS candidate_id,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid AS band_id,\n    d.mjd\nFROM\n    detection d\nJOIN\n    objects_with_rise o ON d.oid = o.oid\nWHERE\n    d.mjd BETWEEN 58484.0 AND 59944.0\nORDER BY\n    d.oid, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant information from detection and object tables for objects classified as SN II\nWITH sn_ii_objects AS (\n    SELECT\n        o.oid,\n        p.oid AS prob_oid,\n        p.class_name,\n        p.classifier_name,\n        p.probability,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.fid AS band_id,\n        d.ra,\n        d.dec\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        p.class_name = 'SNII'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.6\n        AND d.mjd BETWEEN 58484.0 AND 59944.0\n),\n-- Filter objects with sufficient r-band observations and detections\nfiltered_objects AS (\n    SELECT\n        oid\n    FROM\n        sn_ii_objects\n    WHERE\n        band_id = 2 -- r-band\n    GROUP BY\n        oid\n    HAVING\n        COUNT(*) >= 100\n        AND COUNT(DISTINCT candid) > 30\n),\n-- Calculate initial rise rate for each object in g and r bands\nrise_rates AS (\n    SELECT\n        o.oid,\n        -- For each object, find the earliest and latest detection in g-band\n        MIN(CASE WHEN d.fid = 1 THEN d.mjd END) AS g_start_mjd,\n        MAX(CASE WHEN d.fid = 1 THEN d.mjd END) AS g_end_mjd,\n        -- For r-band\n        MIN(CASE WHEN d.fid = 2 THEN d.mjd END) AS r_start_mjd,\n        MAX(CASE WHEN d.fid = 2 THEN d.mjd END) AS r_end_mjd,\n        -- Corresponding magnitudes\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf END) AS g_min_mag,\n        MIN(CASE WHEN d.fid = 2 THEN d.magpsf END) AS r_min_mag\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        o.oid IN (SELECT oid FROM filtered_objects)\n    GROUP BY\n        o.oid\n),\n-- Calculate rise rates in mag/day for g and r bands\nrise_rate_calc AS (\n    SELECT\n        oid,\n        CASE WHEN g_end_mjd IS NOT NULL AND g_start_mjd IS NOT NULL AND (g_end_mjd - g_start_mjd) > 0\n            THEN (g_min_mag - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 1 AND mjd BETWEEN g_start_mjd AND g_end_mjd))\n                 / (g_end_mjd - g_start_mjd)\n            ELSE NULL\n        END AS g_rise_rate,\n        CASE WHEN r_end_mjd IS NOT NULL AND r_start_mjd IS NOT NULL AND (r_end_mjd - r_start_mjd) > 0\n            THEN (r_min_mag - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 2 AND mjd BETWEEN r_start_mjd AND r_end_mjd))\n                 / (r_end_mjd - r_start_mjd)\n            ELSE NULL\n        END AS r_rise_rate\n    FROM\n        rise_rates o\n),\n-- Select objects with initial rise rate > 0.5 mag/day in g and r bands\nobjects_with_rise AS (\n    SELECT\n        o.oid\n    FROM\n        rise_rate_calc o\n    WHERE\n        (g_rise_rate > 0.5 OR r_rise_rate > 0.5)\n)\n-- Final selection of detections for objects meeting all criteria\nSELECT\n    d.oid,\n    d.candid AS candidate_id,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid AS band_id,\n    d.mjd\nFROM\n    detection d\nJOIN\n    objects_with_rise o ON d.oid = o.oid\nWHERE\n    d.mjd BETWEEN 58484.0 AND 59944.0\nORDER BY\n    d.oid, d.mjd;\n```"
                },
                "in_toks": 3204,
                "out_toks": 914,
                "id": "chatcmpl-BhLm2OTjYM513Sv3cSF0JqMbiKiVD",
                "created": 1749671502,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "21": {
        "0": {
            "req_id": 21,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature']"
                    }
                },
                "in_toks": 812,
                "out_toks": 20,
                "id": "chatcmpl-Be0QDT3xLb8MZUwZ0zLJkzcTteNLc",
                "created": 1748874441,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.5\n    )\n    AND o.ndet >= 30\n    AND (o.lastmjd - o.firstmjd) >= 200\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.5\n    )\n    AND o.ndet >= 30\n    AND (o.lastmjd - o.firstmjd) >= 200\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM selected_objects);\n```"
                    }
                },
                "in_toks": 5026,
                "out_toks": 158,
                "id": "chatcmpl-Be0RKUPj2miLpDqyVYwnIeuH4e6Ts",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 21,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature']"
                    }
                },
                "in_toks": 812,
                "out_toks": 20,
                "id": "chatcmpl-Be0QDT3xLb8MZUwZ0zLJkzcTteNLc",
                "created": 1748874441,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Filter objects with at least 30 detections\n        o.ndet >= 30\n        -- Filter objects with a time span between first and last detection >= 200 days\n        AND (o.lastmjd - o.firstmjd) >= 200\n        -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in lc_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n              AND p.classifier_name = 'lc_classifier'\n              AND p.probability > 0.5\n        )\n)\n-- Retrieve all columns for the selected objects\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Filter objects with at least 30 detections\n        o.ndet >= 30\n        -- Filter objects with a time span between first and last detection >= 200 days\n        AND (o.lastmjd - o.firstmjd) >= 200\n        -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in lc_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n              AND p.classifier_name = 'lc_classifier'\n              AND p.probability > 0.5\n        )\n)\n-- Retrieve all columns for the selected objects\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM selected_objects);\n```"
                    }
                },
                "in_toks": 5026,
                "out_toks": 221,
                "id": "chatcmpl-Be0RKGEIVr4UtoRuGQEvjmEDd9sxg",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "21",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 812,
                "out_toks": 10,
                "id": "chatcmpl-BhLi5aXKQHGEkoLGHRrlp7Nv5kPIz",
                "created": 1749671257,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Filter objects with at least 30 detections\n        o.ndet >= 30\n        -- Filter objects with a time span between first and last detection >= 200 days\n        AND (o.lastmjd - o.firstmjd) >= 200\n        -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in lc_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n              AND p.classifier_name = 'lc_classifier'\n              AND p.probability > 0.5\n        )\n)\n-- Retrieve all columns for the selected objects\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Filter objects with at least 30 detections\n        o.ndet >= 30\n        -- Filter objects with a time span between first and last detection >= 200 days\n        AND (o.lastmjd - o.firstmjd) >= 200\n        -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in lc_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n              AND p.classifier_name = 'lc_classifier'\n              AND p.probability > 0.5\n        )\n)\n-- Retrieve all columns for the selected objects\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 5026,
                "out_toks": 221,
                "id": "chatcmpl-BhLmN3ZNtGLHuF3bfLyk4vKd3byU6",
                "created": 1749671523,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "21",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 812,
                "out_toks": 10,
                "id": "chatcmpl-BhLi5nsmZnpTfemWC2PrpGcIyYFGf",
                "created": 1749671257,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Filter objects with at least 30 detections\n        o.ndet >= 30\n        -- Filter objects with a time span between first and last detection >= 200 days\n        AND (o.lastmjd - o.firstmjd) >= 200\n        -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in lc_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n              AND p.classifier_name = 'lc_classifier'\n              AND p.probability > 0.5\n        )\n)\n-- Retrieve all columns for the selected objects\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Filter objects with at least 30 detections\n        o.ndet >= 30\n        -- Filter objects with a time span between first and last detection >= 200 days\n        AND (o.lastmjd - o.firstmjd) >= 200\n        -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in lc_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n              AND p.classifier_name = 'lc_classifier'\n              AND p.probability > 0.5\n        )\n)\n-- Retrieve all columns for the selected objects\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 5026,
                "out_toks": 221,
                "id": "chatcmpl-BhLmQOYQTLLEO6HCm5l38j7CSPV6h",
                "created": 1749671526,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "26": {
        "0": {
            "req_id": 26,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 780,
                "out_toks": 22,
                "id": "chatcmpl-Be0QEdO9DMHJBCmlPTllZi1e5Kozk",
                "created": 1748874442,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n),\n-- Retrieve objects classified as 'SN' by the stamp classifier with probability > 0.5\nsn_probabilities AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n),\n-- Retrieve objects with more than one detection\nobjects_multiple_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 1\n)\n-- Final selection: objects that meet either classification or detection criteria\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid FROM filtered_objects\n)\nAND (\n    o.oid IN (SELECT oid FROM sn_probabilities)\n    OR o.oid IN (SELECT oid FROM objects_multiple_detections)\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n),\n-- Retrieve objects classified as 'SN' by the stamp classifier with probability > 0.5\nsn_probabilities AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n),\n-- Retrieve objects with more than one detection\nobjects_multiple_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 1\n)\n-- Final selection: objects that meet either classification or detection criteria\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid FROM filtered_objects\n)\nAND (\n    o.oid IN (SELECT oid FROM sn_probabilities)\n    OR o.oid IN (SELECT oid FROM objects_multiple_detections)\n);\n```"
                    }
                },
                "in_toks": 3143,
                "out_toks": 251,
                "id": "chatcmpl-Be0RKzLFiN0f4KUXvOQHRKEiGDAzS",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 26,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection']"
                    }
                },
                "in_toks": 780,
                "out_toks": 22,
                "id": "chatcmpl-Be0QEdO9DMHJBCmlPTllZi1e5Kozk",
                "created": 1748874442,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n)\n-- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = fo.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n    )\n)\n-- Or objects with more than one detection\nOR o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    WHERE (\n        SELECT COUNT(*) FROM detection d WHERE d.oid = fo.oid\n    ) > 1\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n)\n-- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = fo.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n    )\n)\n-- Or objects with more than one detection\nOR o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    WHERE (\n        SELECT COUNT(*) FROM detection d WHERE d.oid = fo.oid\n    ) > 1\n);\n```"
                    }
                },
                "in_toks": 3143,
                "out_toks": 237,
                "id": "chatcmpl-Be0RKuTBsireOs0qoVhqMIAl7Diab",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "26",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 780,
                "out_toks": 11,
                "id": "chatcmpl-BhLi6uGuCFBMbdhJfUlIBBVdon7kL",
                "created": 1749671258,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n)\n-- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    JOIN probability p ON fo.oid = p.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n)\n-- Or objects with more than one detection\nOR o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    JOIN detection d ON fo.oid = d.oid\n    GROUP BY fo.oid\n    HAVING COUNT(d.candid) > 1\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n)\n-- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    JOIN probability p ON fo.oid = p.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n)\n-- Or objects with more than one detection\nOR o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    JOIN detection d ON fo.oid = d.oid\n    GROUP BY fo.oid\n    HAVING COUNT(d.candid) > 1\n);\n```"
                },
                "in_toks": 3143,
                "out_toks": 231,
                "id": "chatcmpl-BhLmTWKVKdp45lMyAB7rHFPBdhDNo",
                "created": 1749671529,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "26",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 780,
                "out_toks": 11,
                "id": "chatcmpl-BhLi6fm41ROIxthzUgVNL4hwM7D3m",
                "created": 1749671258,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n)\n-- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    JOIN probability p ON p.oid = fo.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n)\n-- Or objects with more than one detection\nOR o.oid IN (\n    SELECT o2.oid\n    FROM object o2\n    WHERE o2.ndet > 1\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n)\n-- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    JOIN probability p ON p.oid = fo.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n)\n-- Or objects with more than one detection\nOR o.oid IN (\n    SELECT o2.oid\n    FROM object o2\n    WHERE o2.ndet > 1\n);\n```"
                },
                "in_toks": 3143,
                "out_toks": 210,
                "id": "chatcmpl-BhLmhLKTV8G2NuFXVtiPW3aOULSWN",
                "created": 1749671543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "29": {
        "0": {
            "req_id": 29,
            "experiment_id": "run_0",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['ps1_ztf']"
                    },
                    "1": {
                        "response": "['ps1_ztf']"
                    }
                },
                "in_toks": 840,
                "out_toks": 14,
                "id": "chatcmpl-Be0QFZu7fZX2obp7g0rbhTgQfeY6T",
                "created": 1748874443,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);"
                    }
                },
                "in_toks": 2710,
                "out_toks": 109,
                "id": "chatcmpl-Be0RKB9dMH7MrbR2BlCHsgKGgvZo7",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 29,
            "experiment_id": "run_1",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['ps1_ztf']"
                    },
                    "1": {
                        "response": "['ps1_ztf']"
                    }
                },
                "in_toks": 840,
                "out_toks": 14,
                "id": "chatcmpl-Be0QFZu7fZX2obp7g0rbhTgQfeY6T",
                "created": 1748874443,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);"
                    }
                },
                "in_toks": 2710,
                "out_toks": 109,
                "id": "chatcmpl-Be0RKlH227irPrejSXTfeYN5nZ9J8",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "29",
            "experiment_id": "run_2",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']"
                },
                "in_toks": 840,
                "out_toks": 7,
                "id": "chatcmpl-BhLi7wvbvc1yJgH3YYcawZGMC5KgI",
                "created": 1749671259,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);"
                },
                "in_toks": 2710,
                "out_toks": 109,
                "id": "chatcmpl-BhLmlkGrwEsjKNlKHjFvzjzh3rQ59",
                "created": 1749671547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "29",
            "experiment_id": "run_3",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']"
                },
                "in_toks": 840,
                "out_toks": 7,
                "id": "chatcmpl-BhLi728WTyjrXcOQw6JLYvf7dWI7z",
                "created": 1749671259,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);"
                },
                "in_toks": 2710,
                "out_toks": 109,
                "id": "chatcmpl-BhLmrVEunGEYjV1tzptuL46qRAGeR",
                "created": 1749671553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "52": {
        "0": {
            "req_id": 52,
            "experiment_id": "run_0",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['forced_photometry']"
                    },
                    "1": {
                        "response": "['forced_photometry']"
                    }
                },
                "in_toks": 788,
                "out_toks": 12,
                "id": "chatcmpl-Be0QGVyGX2gm4W6TFevh3j4s5uaRy",
                "created": 1748874444,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```"
                    }
                },
                "in_toks": 2597,
                "out_toks": 58,
                "id": "chatcmpl-Be0RKMu9huy2wylJTctQVnCywOEP2",
                "created": 1748874510,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 52,
            "experiment_id": "run_1",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['forced_photometry']"
                    },
                    "1": {
                        "response": "['forced_photometry']"
                    }
                },
                "in_toks": 788,
                "out_toks": 12,
                "id": "chatcmpl-Be0QGVyGX2gm4W6TFevh3j4s5uaRy",
                "created": 1748874444,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```"
                    }
                },
                "in_toks": 2597,
                "out_toks": 58,
                "id": "chatcmpl-Be0RM64RUGJhjvOomndyUSsCcmNNa",
                "created": 1748874512,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "52",
            "experiment_id": "run_2",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 788,
                "out_toks": 6,
                "id": "chatcmpl-BhLi8Ew6sIrP2rk0aQtcou3emVfEc",
                "created": 1749671260,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```"
                },
                "in_toks": 2597,
                "out_toks": 58,
                "id": "chatcmpl-BhLmrYmYEp4q3fJX6YXbE6af9VRjH",
                "created": 1749671553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "52",
            "experiment_id": "run_3",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 788,
                "out_toks": 6,
                "id": "chatcmpl-BhLi80vGlXl3Dx9Z1XlRYcJn7zeWC",
                "created": 1749671260,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```"
                },
                "in_toks": 2597,
                "out_toks": 58,
                "id": "chatcmpl-BhLujzo5yu3ZFRZf15ss0UvV20dSM",
                "created": 1749672041,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "109": {
        "0": {
            "req_id": 109,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'feature', 'probability']"
                    }
                },
                "in_toks": 826,
                "out_toks": 20,
                "id": "chatcmpl-Be0QHIWlkks8tIr3wFPLpWwtQCeYD",
                "created": 1748874445,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class,\n    p.probability,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier' \n    AND p.ranking = 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.lastmjd - o.firstmjd > 1\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class,\n    p.probability,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier' \n    AND p.ranking = 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.lastmjd - o.firstmjd > 1\nLIMIT 10;"
                    }
                },
                "in_toks": 5040,
                "out_toks": 149,
                "id": "chatcmpl-Be0ROScHoEBHnUL5D0RvPPW3V7D7Y",
                "created": 1748874514,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 109,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'feature', 'probability']"
                    }
                },
                "in_toks": 826,
                "out_toks": 20,
                "id": "chatcmpl-Be0QHIWlkks8tIr3wFPLpWwtQCeYD",
                "created": 1748874445,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class_at_rank_1,\n    p.probability AS probability_at_rank_1,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.lastmjd - o.firstmjd > 1\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class_at_rank_1,\n    p.probability AS probability_at_rank_1,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.lastmjd - o.firstmjd > 1\nLIMIT 10;"
                    }
                },
                "in_toks": 5040,
                "out_toks": 158,
                "id": "chatcmpl-Be0RNziD0RR6lLwgDR0EYuSr9iYNe",
                "created": 1748874513,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "109",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 10,
                "id": "chatcmpl-BhLi91NwinCkccyynOqcifxEP1FJX",
                "created": 1749671261,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class_at_rank_1,\n    p.probability AS probability_at_rank_1,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier' AND\n    p.ranking = 1 AND\n    f.name = 'LinearTrend' AND\n    f.value > 5 AND\n    o.lastmjd - o.firstmjd > 1\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class_at_rank_1,\n    p.probability AS probability_at_rank_1,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier' AND\n    p.ranking = 1 AND\n    f.name = 'LinearTrend' AND\n    f.value > 5 AND\n    o.lastmjd - o.firstmjd > 1\nLIMIT 10;"
                },
                "in_toks": 5040,
                "out_toks": 160,
                "id": "chatcmpl-BhLqmo686UkXAn70PbIiS31AxzyIz",
                "created": 1749671796,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "109",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']"
                },
                "in_toks": 826,
                "out_toks": 10,
                "id": "chatcmpl-BhLi9xyz1cEtVxk3dT4vmRipQTyRI",
                "created": 1749671261,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class,\n    p.probability,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier' \n    AND p.ranking = 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.lastmjd - o.firstmjd > 1\nLIMIT 10;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class,\n    p.probability,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier' \n    AND p.ranking = 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.lastmjd - o.firstmjd > 1\nLIMIT 10;"
                },
                "in_toks": 5040,
                "out_toks": 149,
                "id": "chatcmpl-BhLrRg4azEwuHhN2xc1ICwNN77nKM",
                "created": 1749671837,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "49": {
        "0": {
            "req_id": 49,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature']"
                    },
                    "1": {
                        "response": "['feature']"
                    }
                },
                "in_toks": 778,
                "out_toks": 9,
                "id": "chatcmpl-Be0QHfEpxoY0TEyqBqHrDR4HPjTwM",
                "created": 1748874445,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all features in the 'feature' table for specified objects and g band\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1; -- fid=1 corresponds to the g band\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve all features in the 'feature' table for specified objects and g band\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1; -- fid=1 corresponds to the g band\n```"
                    }
                },
                "in_toks": 4808,
                "out_toks": 63,
                "id": "chatcmpl-Be0RO8dm4wdYHFkFVEobFXnXQGIPD",
                "created": 1748874514,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 49,
            "experiment_id": "run_1",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature']"
                    },
                    "1": {
                        "response": "['feature']"
                    }
                },
                "in_toks": 778,
                "out_toks": 9,
                "id": "chatcmpl-Be0QHfEpxoY0TEyqBqHrDR4HPjTwM",
                "created": 1748874445,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all feature rows for specified objects with features in the g band\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1; -- fid=1 corresponds to the g band\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve all feature rows for specified objects with features in the g band\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1; -- fid=1 corresponds to the g band\n```"
                    }
                },
                "in_toks": 4326,
                "out_toks": 61,
                "id": "chatcmpl-Be0RNc4uYkKb7o6lJzFFbxaQLl8xE",
                "created": 1748874513,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "49",
            "experiment_id": "run_2",
            "pred_tables": [
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature']"
                },
                "in_toks": 778,
                "out_toks": 3,
                "id": "chatcmpl-BhLiAjbiwBSJBBaQMyqNNXVqFbuvZ",
                "created": 1749671262,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all feature rows for specified objects with features in the g band\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1; -- fid=1 corresponds to the g band\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all feature rows for specified objects with features in the g band\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1; -- fid=1 corresponds to the g band\n```"
                },
                "in_toks": 4326,
                "out_toks": 61,
                "id": "chatcmpl-BhLsmUXD11O8RI9GeNbskIVoSQh9V",
                "created": 1749671920,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "49",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 778,
                "out_toks": 6,
                "id": "chatcmpl-BhLiAttmlLtKCM7clT1ttpjkRHFNl",
                "created": 1749671262,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all features in the 'feature' table for specified objects and the g band (fid=1)\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all features in the 'feature' table for specified objects and the g band (fid=1)\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1;\n```"
                },
                "in_toks": 4808,
                "out_toks": 58,
                "id": "chatcmpl-BhLsuorZZ7CGeCnkM2eZPkjZv9gcE",
                "created": 1749671928,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "46": {
        "0": {
            "req_id": 46,
            "experiment_id": "run_0",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['detection']"
                    },
                    "1": {
                        "response": "['detection']"
                    }
                },
                "in_toks": 767,
                "out_toks": 8,
                "id": "chatcmpl-Be0QIj5wL2MLwLyrPOtEhzKW0GJiQ",
                "created": 1748874446,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```"
                    }
                },
                "in_toks": 2431,
                "out_toks": 28,
                "id": "chatcmpl-Be0RO5OM0L75owjk0piHSChmYqUXZ",
                "created": 1748874514,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 46,
            "experiment_id": "run_1",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['detection']"
                    },
                    "1": {
                        "response": "['detection']"
                    }
                },
                "in_toks": 767,
                "out_toks": 8,
                "id": "chatcmpl-Be0QIj5wL2MLwLyrPOtEhzKW0GJiQ",
                "created": 1748874446,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```"
                    }
                },
                "in_toks": 2431,
                "out_toks": 28,
                "id": "chatcmpl-Be0RQOcC2XHLAukT6mFe4ciT4NCuJ",
                "created": 1748874516,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "46",
            "experiment_id": "run_2",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']"
                },
                "in_toks": 767,
                "out_toks": 4,
                "id": "chatcmpl-BhLiB6hNWTQbPOxLp2FU3Uk6cUmjd",
                "created": 1749671263,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```"
                },
                "in_toks": 2431,
                "out_toks": 28,
                "id": "chatcmpl-BhLlq0tIIGJf2aMpybueLSmrnPf1Z",
                "created": 1749671490,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "46",
            "experiment_id": "run_3",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']"
                },
                "in_toks": 767,
                "out_toks": 4,
                "id": "chatcmpl-BhLiBmleQZrwlhiw1KLspFKKCNfkw",
                "created": 1749671263,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```"
                },
                "in_toks": 2431,
                "out_toks": 28,
                "id": "chatcmpl-BhLlqjAZcewtnKfhiMV2GVRLt7UBJ",
                "created": 1749671490,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "93": {
        "0": {
            "req_id": 93,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability', 'magstat']"
                    },
                    "1": {
                        "response": "['probability', 'magstat']"
                    }
                },
                "in_toks": 807,
                "out_toks": 16,
                "id": "chatcmpl-Be0QJpknGsNRgfWgaQgfeHMqxWX5W",
                "created": 1748874447,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object IDs where 'asteroid' is ranked 1 in the stamp_classifier with specific probability conditions\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'asteroid'\n      AND classifier_name = 'stamp_classifier'\n      AND ranking = 1\n      AND probability >= 0.8 -- Ensuring high confidence in classification\n      AND classifier_version = '2023' -- Specify the classifier version if known, or remove if not applicable\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = sub.oid\nWHERE m.corrected = TRUE\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.probability >= 0.8 -- Consistent probability threshold\n  AND p.classifier_version = '2023' -- Match classifier version for consistency\n  AND m.ndet > 0 -- Ensure the object has detections\n  AND m.ndubious = 0 -- Filter out dubious points for cleaner data\nORDER BY p.oid\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object IDs where 'asteroid' is ranked 1 in the stamp_classifier with specific probability conditions\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'asteroid'\n      AND classifier_name = 'stamp_classifier'\n      AND ranking = 1\n      AND probability >= 0.8 -- Ensuring high confidence in classification\n      AND classifier_version = '2023' -- Specify the classifier version if known, or remove if not applicable\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = sub.oid\nWHERE m.corrected = TRUE\n  AND p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.probability >= 0.8 -- Consistent probability threshold\n  AND p.classifier_version = '2023' -- Match classifier version for consistency\n  AND m.ndet > 0 -- Ensure the object has detections\n  AND m.ndubious = 0 -- Filter out dubious points for cleaner data\nORDER BY p.oid\nLIMIT 10;\n```"
                },
                "in_toks": 1570,
                "out_toks": 272,
                "id": "chatcmpl-BhN0HOq2BRgRZp9FHSskPj6662N6c",
                "created": 1749676229,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object IDs where 'asteroid' is ranked 1 in the stamp_classifier\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'asteroid'\n      AND classifier_name = 'stamp_classifier'\n      AND ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = sub.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object IDs where 'asteroid' is ranked 1 in the stamp_classifier\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'asteroid'\n      AND classifier_name = 'stamp_classifier'\n      AND ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = sub.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```"
                    }
                },
                "in_toks": 2823,
                "out_toks": 130,
                "id": "chatcmpl-Be0RObYxaFdS7JTKIqFGNjz9u6u6s",
                "created": 1748874514,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 93,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability', 'magstat']"
                    },
                    "1": {
                        "response": "['probability', 'magstat']"
                    }
                },
                "in_toks": 807,
                "out_toks": 16,
                "id": "chatcmpl-Be0QJpknGsNRgfWgaQgfeHMqxWX5W",
                "created": 1748874447,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object OIDs where 'asteroid' is the top-ranked class in the stamp_classifier\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = p.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object OIDs where 'asteroid' is the top-ranked class in the stamp_classifier\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = p.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```"
                    }
                },
                "in_toks": 2823,
                "out_toks": 141,
                "id": "chatcmpl-Be0RP5Si9sXjMcFQh38AZYRxFa9gt",
                "created": 1748874515,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "93",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat']"
                },
                "in_toks": 807,
                "out_toks": 8,
                "id": "chatcmpl-BhLiCUPNA6txhGD8iCs8zGpSQi2Y8",
                "created": 1749671264,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object OIDs where 'asteroid' is the top-ranked class in the stamp_classifier\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = p.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object OIDs where 'asteroid' is the top-ranked class in the stamp_classifier\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = p.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```"
                },
                "in_toks": 2823,
                "out_toks": 141,
                "id": "chatcmpl-BhLlp5OgULYJbx830yHugVFGFtNwg",
                "created": 1749671489,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "93",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat']"
                },
                "in_toks": 807,
                "out_toks": 8,
                "id": "chatcmpl-BhLiCH7mDKTw9kIsufMJMI0e6EX6I",
                "created": 1749671264,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object OIDs where 'asteroid' is the top-ranked class in the stamp_classifier\n    SELECT DISTINCT prob.oid\n    FROM probability prob\n    WHERE prob.class_name = 'asteroid'\n      AND prob.classifier_name = 'stamp_classifier'\n      AND prob.ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = sub.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object OIDs where 'asteroid' is the top-ranked class in the stamp_classifier\n    SELECT DISTINCT prob.oid\n    FROM probability prob\n    WHERE prob.class_name = 'asteroid'\n      AND prob.classifier_name = 'stamp_classifier'\n      AND prob.ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = sub.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```"
                },
                "in_toks": 2823,
                "out_toks": 141,
                "id": "chatcmpl-BhLlpsrnPwOSOyb1dglli46v9FsaT",
                "created": 1749671489,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "62": {
        "0": {
            "req_id": 62,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability']"
                    },
                    "1": {
                        "response": "['probability']"
                    }
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-Be0QJ27csv4458vjSoKk5ZIyWz9xR",
                "created": 1748874447,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    p.oid,\n    p.classifier_name,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM \n    probability p\nWHERE \n    p.oid = 'ZTF21aadoizf'\nORDER BY \n    p.classifier_name ASC,\n    p.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nSELECT \n    p.oid,\n    p.classifier_name,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM \n    probability p\nWHERE \n    p.oid = 'ZTF21aadoizf'\nORDER BY \n    p.classifier_name ASC,\n    p.probability DESC;\n```"
                    }
                },
                "in_toks": 2093,
                "out_toks": 78,
                "id": "chatcmpl-Be0RowIwP33LAdbdFRcWgJZqUDjeF",
                "created": 1748874540,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 62,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability']"
                    },
                    "1": {
                        "response": "['probability']"
                    }
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-Be0QJ27csv4458vjSoKk5ZIyWz9xR",
                "created": 1748874447,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the probability table for the given object ID\nSELECT \n    oid,\n    classifier_name,\n    classifier_version,\n    class_name,\n    probability,\n    ranking\nFROM \n    probability\nWHERE \n    oid = 'ZTF21aadoizf'\nORDER BY \n    classifier_name ASC,\n    probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select specified columns from the probability table for the given object ID\nSELECT \n    oid,\n    classifier_name,\n    classifier_version,\n    class_name,\n    probability,\n    ranking\nFROM \n    probability\nWHERE \n    oid = 'ZTF21aadoizf'\nORDER BY \n    classifier_name ASC,\n    probability DESC;\n```"
                    }
                },
                "in_toks": 2093,
                "out_toks": 72,
                "id": "chatcmpl-Be0RU2zEXNB2Tl1TBboIVZQVCXIFT",
                "created": 1748874520,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "62",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 4,
                "id": "chatcmpl-BhLiDS9xkvruwihaIex0yy68dzW7D",
                "created": 1749671265,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    p.oid,\n    p.classifier_name,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM \n    probability p\nWHERE \n    p.oid = 'ZTF21aadoizf'\nORDER BY \n    p.classifier_name ASC,\n    p.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p.oid,\n    p.classifier_name,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM \n    probability p\nWHERE \n    p.oid = 'ZTF21aadoizf'\nORDER BY \n    p.classifier_name ASC,\n    p.probability DESC;\n```"
                },
                "in_toks": 2093,
                "out_toks": 78,
                "id": "chatcmpl-BhLlp5m02lGl8aBvSpFLSt3RvKo3f",
                "created": 1749671489,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "62",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 4,
                "id": "chatcmpl-BhLiD1QwqrfVfe64YOLJ6qyprwoU0",
                "created": 1749671265,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    p.oid,\n    p.classifier_name,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM \n    probability p\nWHERE \n    p.oid = 'ZTF21aadoizf'\nORDER BY \n    p.classifier_name ASC,\n    p.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    p.oid,\n    p.classifier_name,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM \n    probability p\nWHERE \n    p.oid = 'ZTF21aadoizf'\nORDER BY \n    p.classifier_name ASC,\n    p.probability DESC;\n```"
                },
                "in_toks": 2093,
                "out_toks": 78,
                "id": "chatcmpl-BhLluACBjZ175B6jls8RjE8JogZJe",
                "created": 1749671494,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "95": {
        "0": {
            "req_id": 95,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "xmatch",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'xmatch', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'xmatch', 'feature']"
                    }
                },
                "in_toks": 852,
                "out_toks": 20,
                "id": "chatcmpl-Be0QKLEqAtKG4Ew9riWBc5wwpPO9h",
                "created": 1748874448,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    SELECT unnest(ARRAY['ZTF19aazhdoy', 'ZTF17aaaqqtd']) AS oid\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        xm.catid AS catalog_id,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.oid\n    JOIN \n        xmatch xm ON xm.oid = o.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and features, version 'lc_classifier_1.2.1-P'\nfeatures AS (\n    SELECT \n        o.oid AS ztf_oid,\n        f.name AS feature_name,\n        f.value\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.oid\n    JOIN \n        feature f ON f.oid = o.oid\n    WHERE \n        f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches and features on object identifier, then order the results\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.feature_name,\n    f.value\nFROM \n    matches m\nLEFT JOIN \n    features f ON m.ztf_oid = f.ztf_oid\nORDER BY \n    m.oid_catalog, f.feature_name;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    SELECT unnest(ARRAY['ZTF19aazhdoy', 'ZTF17aaaqqtd']) AS oid\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        xm.catid AS catalog_id,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.oid\n    JOIN \n        xmatch xm ON xm.oid = o.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and features, version 'lc_classifier_1.2.1-P'\nfeatures AS (\n    SELECT \n        o.oid AS ztf_oid,\n        f.name AS feature_name,\n        f.value\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.oid\n    JOIN \n        feature f ON f.oid = o.oid\n    WHERE \n        f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches and features on object identifier, then order the results\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.feature_name,\n    f.value\nFROM \n    matches m\nLEFT JOIN \n    features f ON m.ztf_oid = f.ztf_oid\nORDER BY \n    m.oid_catalog, f.feature_name;\n```"
                },
                "in_toks": 4390,
                "out_toks": 368,
                "id": "chatcmpl-BhN0Kd0LBGVRo83ckclD5Y6GKDP6b",
                "created": 1749676232,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        xm.catid AS catalog_id,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.oid\n    JOIN \n        xmatch xm ON xm.oid = o.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and features, version 'lc_classifier_1.2.1-P'\nfeatures AS (\n    SELECT \n        o.oid AS ztf_oid,\n        f.name AS feature_name,\n        f.value\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.oid\n    JOIN \n        feature f ON f.oid = o.oid\n    WHERE \n        f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches and features on object identifier, then order the results\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.feature_name,\n    f.value\nFROM \n    matches m\nLEFT JOIN \n    features f ON m.ztf_oid = f.ztf_oid\nORDER BY \n    m.oid_catalog, f.feature_name;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        xm.catid AS catalog_id,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.oid\n    JOIN \n        xmatch xm ON xm.oid = o.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and features, version 'lc_classifier_1.2.1-P'\nfeatures AS (\n    SELECT \n        o.oid AS ztf_oid,\n        f.name AS feature_name,\n        f.value\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.oid\n    JOIN \n        feature f ON f.oid = o.oid\n    WHERE \n        f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches and features on object identifier, then order the results\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.feature_name,\n    f.value\nFROM \n    matches m\nLEFT JOIN \n    features f ON m.ztf_oid = f.ztf_oid\nORDER BY \n    m.oid_catalog, f.feature_name;\n```"
                    }
                },
                "in_toks": 4995,
                "out_toks": 364,
                "id": "chatcmpl-Be0Rl0UpxuozEgsWHm4JhIWXLrma1",
                "created": 1748874537,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 95,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "xmatch",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'xmatch', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'xmatch', 'feature']"
                    }
                },
                "in_toks": 852,
                "out_toks": 20,
                "id": "chatcmpl-Be0QKLEqAtKG4Ew9riWBc5wwpPO9h",
                "created": 1748874448,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\n-- Select matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        xm.oid,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        xmatch xm\n    JOIN \n        ztf_objects z ON xm.oid = z.column1\n),\n-- Select features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and version\nfeatures AS (\n    SELECT \n        f.oid,\n        f.name,\n        f.value\n    FROM \n        feature f\n    WHERE \n        f.oid IN (SELECT oid FROM ztf_objects)\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches with features on object ID\nSELECT \n    m.oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM \n    matches m\nJOIN \n    features f ON m.oid = f.oid\nORDER BY \n    m.oid, f.name;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\n-- Select matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        xm.oid,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        xmatch xm\n    JOIN \n        ztf_objects z ON xm.oid = z.column1\n),\n-- Select features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and version\nfeatures AS (\n    SELECT \n        f.oid,\n        f.name,\n        f.value\n    FROM \n        feature f\n    WHERE \n        f.oid IN (SELECT oid FROM ztf_objects)\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches with features on object ID\nSELECT \n    m.oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM \n    matches m\nJOIN \n    features f ON m.oid = f.oid\nORDER BY \n    m.oid, f.name;\n```"
                    }
                },
                "in_toks": 4995,
                "out_toks": 296,
                "id": "chatcmpl-Be0RZHiXhDWGdNY2NVUCWig7ZCgP7",
                "created": 1748874525,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "95",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "xmatch",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'feature']"
                },
                "in_toks": 852,
                "out_toks": 10,
                "id": "chatcmpl-BhLiF1AKm7y7ohjQTWPvLtdcwiFJI",
                "created": 1749671267,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\nztf_ids AS (\n    SELECT * FROM ztf_objects\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        xm.catid AS catalog_id,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        object o\n    JOIN \n        xmatch xm ON o.oid = xm.oid\n    WHERE \n        o.oid IN (SELECT * FROM ztf_ids)\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and classifier version\nfeatures AS (\n    SELECT \n        f.oid AS ztf_oid,\n        f.name AS feature_name,\n        f.value\n    FROM \n        feature f\n    WHERE \n        f.oid IN (SELECT * FROM ztf_ids)\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches and features on object identifier, and prepare final output\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.feature_name,\n    f.value\nFROM \n    matches m\nJOIN \n    features f ON m.ztf_oid = f.oid\nORDER BY \n    m.oid_catalog, f.feature_name;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\nztf_ids AS (\n    SELECT * FROM ztf_objects\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        xm.catid AS catalog_id,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        object o\n    JOIN \n        xmatch xm ON o.oid = xm.oid\n    WHERE \n        o.oid IN (SELECT * FROM ztf_ids)\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and classifier version\nfeatures AS (\n    SELECT \n        f.oid AS ztf_oid,\n        f.name AS feature_name,\n        f.value\n    FROM \n        feature f\n    WHERE \n        f.oid IN (SELECT * FROM ztf_ids)\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches and features on object identifier, and prepare final output\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.feature_name,\n    f.value\nFROM \n    matches m\nJOIN \n    features f ON m.ztf_oid = f.oid\nORDER BY \n    m.oid_catalog, f.feature_name;\n```"
                },
                "in_toks": 4336,
                "out_toks": 345,
                "id": "chatcmpl-BhN0Hz78sOnxy8VNQaE5cJwEbXqR0",
                "created": 1749676229,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\nztf_ids AS (\n    SELECT * FROM ztf_objects\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        xm.catid AS catalog_id,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        object o\n    JOIN \n        xmatch xm ON o.oid = xm.oid\n    WHERE \n        o.oid IN (SELECT * FROM ztf_ids)\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and classifier version\nfeatures AS (\n    SELECT \n        f.oid AS ztf_oid,\n        f.name AS feature_name,\n        f.value\n    FROM \n        feature f\n    WHERE \n        f.oid IN (SELECT * FROM ztf_ids)\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches and features on object identifier, and prepare final output\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.feature_name,\n    f.value\nFROM \n    matches m\nJOIN \n    features f ON m.ztf_oid = f.oid\nORDER BY \n    m.oid_catalog, f.feature_name;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\nztf_ids AS (\n    SELECT * FROM ztf_objects\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        xm.catid AS catalog_id,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        object o\n    JOIN \n        xmatch xm ON o.oid = xm.oid\n    WHERE \n        o.oid IN (SELECT * FROM ztf_ids)\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and classifier version\nfeatures AS (\n    SELECT \n        f.oid AS ztf_oid,\n        f.name AS feature_name,\n        f.value\n    FROM \n        feature f\n    WHERE \n        f.oid IN (SELECT * FROM ztf_ids)\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches and features on object identifier, and prepare final output\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.feature_name,\n    f.value\nFROM \n    matches m\nJOIN \n    features f ON m.ztf_oid = f.oid\nORDER BY \n    m.oid_catalog, f.feature_name;\n```"
                },
                "in_toks": 4995,
                "out_toks": 345,
                "id": "chatcmpl-BhLlveBM7FHwXIZcee6nQdwNAEnl6",
                "created": 1749671495,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "95",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "xmatch",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'feature']"
                },
                "in_toks": 852,
                "out_toks": 10,
                "id": "chatcmpl-BhLiFMVSHiS4bUCPXEbqDfYYPUm81",
                "created": 1749671267,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\n-- Retrieve object details for the specified ZTF objects\nobjects_cte AS (\n    SELECT o.oid\n    FROM object o\n    JOIN ztf_objects z ON o.oid = z.column1\n),\n-- Retrieve matches for the specified objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        x.catid,\n        x.oid_catalog,\n        x.dist\n    FROM \n        objects_cte o\n    JOIN \n        xmatch x ON x.oid = o.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and feature version\nfeatures AS (\n    SELECT \n        o.oid AS ztf_oid,\n        f.name,\n        f.value,\n        f.oid\n    FROM \n        objects_cte o\n    JOIN \n        feature f ON f.oid = o.oid\n    WHERE \n        f.name IN ('W1-W2', 'g-W2', 'r-W2')\n        AND f.version = 'lc_classifier_1.2.1-P'\n)\n-- Final join to combine matches and features, ordered as requested\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.catid AS catalog_identifier,\n    m.oid_catalog AS catalog_object_id,\n    m.dist AS distance_arcsec,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM \n    matches m\nLEFT JOIN \n    features f ON f.oid = m.oid_catalog\nORDER BY \n    m.oid_catalog, f.name;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\n-- Retrieve object details for the specified ZTF objects\nobjects_cte AS (\n    SELECT o.oid\n    FROM object o\n    JOIN ztf_objects z ON o.oid = z.column1\n),\n-- Retrieve matches for the specified objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        x.catid,\n        x.oid_catalog,\n        x.dist\n    FROM \n        objects_cte o\n    JOIN \n        xmatch x ON x.oid = o.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and feature version\nfeatures AS (\n    SELECT \n        o.oid AS ztf_oid,\n        f.name,\n        f.value,\n        f.oid\n    FROM \n        objects_cte o\n    JOIN \n        feature f ON f.oid = o.oid\n    WHERE \n        f.name IN ('W1-W2', 'g-W2', 'r-W2')\n        AND f.version = 'lc_classifier_1.2.1-P'\n)\n-- Final join to combine matches and features, ordered as requested\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.catid AS catalog_identifier,\n    m.oid_catalog AS catalog_object_id,\n    m.dist AS distance_arcsec,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM \n    matches m\nLEFT JOIN \n    features f ON f.oid = m.oid_catalog\nORDER BY \n    m.oid_catalog, f.name;\n```"
                },
                "in_toks": 4360,
                "out_toks": 372,
                "id": "chatcmpl-BhN0E8xJkCFknFvmrpRQMUWyX5Plv",
                "created": 1749676226,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        x.catid,\n        x.oid_catalog,\n        x.dist\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.value\n    JOIN \n        xmatch x ON x.oid = o.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and feature version\nfeatures AS (\n    SELECT \n        o.oid AS ztf_oid,\n        f.name,\n        f.value,\n        f.oid\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.value\n    JOIN \n        feature f ON f.oid = o.oid\n    WHERE \n        f.name IN ('W1-W2', 'g-W2', 'r-W2')\n        AND f.version = 'lc_classifier_1.2.1-P'\n)\n-- Join matches and features, and prepare final output\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.catid AS catalog_identifier,\n    m.oid_catalog AS catalog_object_id,\n    m.dist AS distance_arcsec,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM \n    matches m\nJOIN \n    features f ON f.oid = (SELECT oid FROM object WHERE oid = m.oid_catalog)\nORDER BY \n    m.oid_catalog, f.name;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        x.catid,\n        x.oid_catalog,\n        x.dist\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.value\n    JOIN \n        xmatch x ON x.oid = o.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and feature version\nfeatures AS (\n    SELECT \n        o.oid AS ztf_oid,\n        f.name,\n        f.value,\n        f.oid\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.value\n    JOIN \n        feature f ON f.oid = o.oid\n    WHERE \n        f.name IN ('W1-W2', 'g-W2', 'r-W2')\n        AND f.version = 'lc_classifier_1.2.1-P'\n)\n-- Join matches and features, and prepare final output\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.catid AS catalog_identifier,\n    m.oid_catalog AS catalog_object_id,\n    m.dist AS distance_arcsec,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM \n    matches m\nJOIN \n    features f ON f.oid = (SELECT oid FROM object WHERE oid = m.oid_catalog)\nORDER BY \n    m.oid_catalog, f.name;\n```"
                },
                "in_toks": 4995,
                "out_toks": 364,
                "id": "chatcmpl-BhLlzc2kCd603ObMkV2gGblZoQuIy",
                "created": 1749671499,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "85": {
        "0": {
            "req_id": 85,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'detection', 'dataquality']"
                    },
                    "1": {
                        "response": "['object', 'detection', 'dataquality']"
                    }
                },
                "in_toks": 795,
                "out_toks": 22,
                "id": "chatcmpl-Be0QL1sgpEJDy1nw0lotEgUr4lX88",
                "created": 1748874449,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```"
                    }
                },
                "in_toks": 3738,
                "out_toks": 112,
                "id": "chatcmpl-Be0RZpDPi4sjB9LGA3Zw98z0weqFp",
                "created": 1748874525,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 85,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'detection', 'dataquality']"
                    },
                    "1": {
                        "response": "['object', 'detection', 'dataquality']"
                    }
                },
                "in_toks": 795,
                "out_toks": 22,
                "id": "chatcmpl-Be0QL1sgpEJDy1nw0lotEgUr4lX88",
                "created": 1748874449,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```"
                    }
                },
                "in_toks": 3738,
                "out_toks": 112,
                "id": "chatcmpl-Be0RaS0B6hliErUEyRG5lwV3xiJhr",
                "created": 1748874526,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "85",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "detection",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'dataquality']"
                },
                "in_toks": 795,
                "out_toks": 11,
                "id": "chatcmpl-BhLiGGKzHnbsnMB1w0WL3ujk5tp3p",
                "created": 1749671268,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```"
                },
                "in_toks": 3738,
                "out_toks": 104,
                "id": "chatcmpl-BhLlzPzZXrdi8P8WRCg1IdpLbAXlG",
                "created": 1749671499,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "85",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "detection",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'dataquality']"
                },
                "in_toks": 795,
                "out_toks": 11,
                "id": "chatcmpl-BhLiGOKLNjYLILCecq0NMgh01Kmza",
                "created": 1749671268,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```"
                },
                "in_toks": 3738,
                "out_toks": 104,
                "id": "chatcmpl-BhLm1UdofScgjyXp3SCwopXoLziV6",
                "created": 1749671501,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "98": {
        "0": {
            "req_id": 98,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'xmatch', 'allwise']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'xmatch', 'allwise']"
                    }
                },
                "in_toks": 785,
                "out_toks": 30,
                "id": "chatcmpl-Be0QM4BInPCHaT8U5pQJ8ehA9UVdw",
                "created": 1748874450,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 200 distinct ZTF objects with a probability > 0.7 of being a QSO in the lc_classifier\nWITH qso_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n    LIMIT 200\n)\n-- Retrieve matching information from xmatch and allwise tables for these objects\nSELECT xm.*, aw.*\nFROM qso_objects q\nJOIN xmatch xm ON xm.oid = q.oid\nLEFT JOIN allwise aw ON aw.oid_catalog = xm.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 200 distinct ZTF objects with a probability > 0.7 of being a QSO in the lc_classifier\nWITH qso_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n    LIMIT 200\n)\n-- Retrieve matching information from xmatch and allwise tables for these objects\nSELECT xm.*, aw.*\nFROM qso_objects q\nJOIN xmatch xm ON xm.oid = q.oid\nLEFT JOIN allwise aw ON aw.oid_catalog = xm.oid;\n```"
                    }
                },
                "in_toks": 3379,
                "out_toks": 156,
                "id": "chatcmpl-Be0RbOoQh3j9MT5Ylzd12BYXN2sQq",
                "created": 1748874527,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 98,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'xmatch', 'allwise']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'xmatch', 'allwise']"
                    }
                },
                "in_toks": 785,
                "out_toks": 30,
                "id": "chatcmpl-Be0QM4BInPCHaT8U5pQJ8ehA9UVdw",
                "created": 1748874450,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 200 distinct ZTF objects with high probability (>0.7) of being a QSO according to the lc_classifier\nWITH high_prob_qso AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n    LIMIT 200\n)\n-- Retrieve all columns from xmatch and allwise for these objects\nSELECT xm.*, aw.*\nFROM high_prob_qso hpq\nJOIN xmatch xm ON xm.oid = hpq.oid\nJOIN allwise aw ON aw.oid_catalog = xm.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 200 distinct ZTF objects with high probability (>0.7) of being a QSO according to the lc_classifier\nWITH high_prob_qso AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n    LIMIT 200\n)\n-- Retrieve all columns from xmatch and allwise for these objects\nSELECT xm.*, aw.*\nFROM high_prob_qso hpq\nJOIN xmatch xm ON xm.oid = hpq.oid\nJOIN allwise aw ON aw.oid_catalog = xm.oid;\n```"
                    }
                },
                "in_toks": 3379,
                "out_toks": 159,
                "id": "chatcmpl-Be0RbU2npaN1pL72fXfnOTPTOWTt0",
                "created": 1748874527,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "98",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'allwise']"
                },
                "in_toks": 785,
                "out_toks": 15,
                "id": "chatcmpl-BhLiHattQExsDDECBNhTc1m3zSpUJ",
                "created": 1749671269,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 200 distinct objects with high probability (>0.7) of being a QSO in the lc_classifier\nWITH high_prob_qso AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n    LIMIT 200\n)\n-- Retrieve matching information from xmatch and allwise tables for these objects\nSELECT \n    x.oid, x.catid, x.oid_catalog, x.dist, x.class_catalog, x.period,\n    aw.oid_catalog, aw.ra, aw.dec, aw.w1mpro, aw.w2mpro, aw.w3mpro, aw.w4mpro,\n    aw.w1sigmpro, aw.w2sigmpro, aw.w3sigmpro, aw.w4sigmpro,\n    aw.j_m_2mass, aw.h_m_2mass, aw.k_m_2mass,\n    aw.j_msig_2mass, aw.h_msig_2mass, aw.k_msig_2mass\nFROM \n    xmatch x\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    x.oid IN (SELECT oid FROM high_prob_qso);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 200 distinct objects with high probability (>0.7) of being a QSO in the lc_classifier\nWITH high_prob_qso AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n    LIMIT 200\n)\n-- Retrieve matching information from xmatch and allwise tables for these objects\nSELECT \n    x.oid, x.catid, x.oid_catalog, x.dist, x.class_catalog, x.period,\n    aw.oid_catalog, aw.ra, aw.dec, aw.w1mpro, aw.w2mpro, aw.w3mpro, aw.w4mpro,\n    aw.w1sigmpro, aw.w2sigmpro, aw.w3sigmpro, aw.w4sigmpro,\n    aw.j_m_2mass, aw.h_m_2mass, aw.k_m_2mass,\n    aw.j_msig_2mass, aw.h_msig_2mass, aw.k_msig_2mass\nFROM \n    xmatch x\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    x.oid IN (SELECT oid FROM high_prob_qso);\n```"
                },
                "in_toks": 3379,
                "out_toks": 294,
                "id": "chatcmpl-BhLm3QnEsjXdmWmmTjwfINL8RFceR",
                "created": 1749671503,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "98",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'allwise']"
                },
                "in_toks": 785,
                "out_toks": 15,
                "id": "chatcmpl-BhLiIJHSgkLk0oOX8m05eIZ5YuFgN",
                "created": 1749671270,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 200 distinct ZTF objects with high probability (>0.7) of being a QSO according to the lc_classifier\nWITH high_prob_qso AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n    LIMIT 200\n)\n-- Retrieve all columns from xmatch and allwise tables for these objects\nSELECT xm.*, aw.*\nFROM xmatch xm\nJOIN high_prob_qso hp ON xm.oid = hp.oid\nLEFT JOIN allwise aw ON aw.oid_catalog = xm.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 200 distinct ZTF objects with high probability (>0.7) of being a QSO according to the lc_classifier\nWITH high_prob_qso AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n    LIMIT 200\n)\n-- Retrieve all columns from xmatch and allwise tables for these objects\nSELECT xm.*, aw.*\nFROM xmatch xm\nJOIN high_prob_qso hp ON xm.oid = hp.oid\nLEFT JOIN allwise aw ON aw.oid_catalog = xm.oid;\n```"
                },
                "in_toks": 3379,
                "out_toks": 155,
                "id": "chatcmpl-BhLm2kKaTDW1N3O1yEpjFfbnRoPHQ",
                "created": 1749671502,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "82": {
        "0": {
            "req_id": 82,
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['xmatch']"
                    },
                    "1": {
                        "response": "['xmatch']"
                    }
                },
                "in_toks": 786,
                "out_toks": 8,
                "id": "chatcmpl-Be0QNQ0wbAGH2cIyqX67LsqDBPLxe",
                "created": 1748874451,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```"
                    }
                },
                "in_toks": 2015,
                "out_toks": 42,
                "id": "chatcmpl-Be0RbFrDJtyStTk4VFSn7FKQAWfEO",
                "created": 1748874527,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 82,
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['xmatch']"
                    },
                    "1": {
                        "response": "['xmatch']"
                    }
                },
                "in_toks": 786,
                "out_toks": 8,
                "id": "chatcmpl-Be0QNQ0wbAGH2cIyqX67LsqDBPLxe",
                "created": 1748874451,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```"
                    }
                },
                "in_toks": 2015,
                "out_toks": 42,
                "id": "chatcmpl-Be0RbKxS8DzIkPk3gLCLho2iZCOts",
                "created": 1748874527,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "82",
            "experiment_id": "run_2",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 786,
                "out_toks": 4,
                "id": "chatcmpl-BhLiIQPFWEjPW9CuEA8z5MtCGp9j3",
                "created": 1749671270,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```"
                },
                "in_toks": 2015,
                "out_toks": 42,
                "id": "chatcmpl-BhLm2FvCP9zOxrRNX2Glu0tKb0qGB",
                "created": 1749671502,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "82",
            "experiment_id": "run_3",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 786,
                "out_toks": 4,
                "id": "chatcmpl-BhLiJt8zzWOe7AG0RHWyCcJTj8Y33",
                "created": 1749671271,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```"
                },
                "in_toks": 2015,
                "out_toks": 42,
                "id": "chatcmpl-BhLm4KXuDuaE93oRWC7HrAlEhYxcR",
                "created": 1749671504,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "64": {
        "0": {
            "req_id": 64,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability']"
                    },
                    "1": {
                        "response": "['probability']"
                    }
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-Be0QNdidEKNJjHCuLG5TWLb33pZsL",
                "created": 1748874451,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 1000 probability entries with probability > 0.95\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability\nFROM (\n    SELECT * FROM probability\n    WHERE probability > 0.95\n) p\nWHERE p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 1000 probability entries with probability > 0.95\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability\nFROM (\n    SELECT * FROM probability\n    WHERE probability > 0.95\n) p\nWHERE p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nLIMIT 1000;\n```"
                    }
                },
                "in_toks": 2098,
                "out_toks": 108,
                "id": "chatcmpl-Be0Rb8FcXCRrZIm9Hrlf6ofPAp3H8",
                "created": 1748874527,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 64,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability']"
                    },
                    "1": {
                        "response": "['probability']"
                    }
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-Be0QNdidEKNJjHCuLG5TWLb33pZsL",
                "created": 1748874451,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 1000 entries from the probability table where the probability exceeds 0.95\n-- in either 'lc_classifier_top' or 'stamp_classifier' classifiers, with additional filtering\n-- to optimize query performance and ensure relevant conditions are met.\n\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability AS \"probability\"\nFROM (\n    -- Subquery to filter relevant classifier entries with probability > 0.95\n    SELECT *\n    FROM probability\n    WHERE \n        -- Filter for specific classifiers\n        classifier_name IN ('lc_classifier_top', 'stamp_classifier')\n        -- Filter for high probability\n        AND probability > 0.95\n        -- Additional condition: focus on top-ranked classes to improve relevance and performance\n        AND ranking = 1\n) p\n-- Order by probability descending to prioritize higher probabilities\nORDER BY p.probability DESC\n-- Limit to 1000 rows to prevent timeout and manage result size\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 1000 entries from the probability table where the probability exceeds 0.95\n-- in either 'lc_classifier_top' or 'stamp_classifier' classifiers, with additional filtering\n-- to optimize query performance and ensure relevant conditions are met.\n\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability AS \"probability\"\nFROM (\n    -- Subquery to filter relevant classifier entries with probability > 0.95\n    SELECT *\n    FROM probability\n    WHERE \n        -- Filter for specific classifiers\n        classifier_name IN ('lc_classifier_top', 'stamp_classifier')\n        -- Filter for high probability\n        AND probability > 0.95\n        -- Additional condition: focus on top-ranked classes to improve relevance and performance\n        AND ranking = 1\n) p\n-- Order by probability descending to prioritize higher probabilities\nORDER BY p.probability DESC\n-- Limit to 1000 rows to prevent timeout and manage result size\nLIMIT 1000;\n```"
                },
                "in_toks": 1039,
                "out_toks": 236,
                "id": "chatcmpl-BhN0Lr4goE06ZY0Sgpw1FVAQJSSvB",
                "created": 1749676233,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 1000 probability entries with probability > 0.95 in either 'lc_classifier_top' or 'stamp_classifier'\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability AS \"probability\"\nFROM (\n    SELECT * FROM probability\n    WHERE (classifier_name IN ('lc_classifier_top', 'stamp_classifier'))\n      AND probability > 0.95\n) p\n-- Order by probability descending to prioritize higher probabilities\nORDER BY p.probability DESC\n-- Limit to 1000 rows\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 1000 probability entries with probability > 0.95 in either 'lc_classifier_top' or 'stamp_classifier'\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability AS \"probability\"\nFROM (\n    SELECT * FROM probability\n    WHERE (classifier_name IN ('lc_classifier_top', 'stamp_classifier'))\n      AND probability > 0.95\n) p\n-- Order by probability descending to prioritize higher probabilities\nORDER BY p.probability DESC\n-- Limit to 1000 rows\nLIMIT 1000;\n```"
                    }
                },
                "in_toks": 2098,
                "out_toks": 149,
                "id": "chatcmpl-Be0RcOtqqHXWW37r7sWeE6GpTape8",
                "created": 1748874528,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "64",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 798,
                "out_toks": 4,
                "id": "chatcmpl-BhLiJECNDRWAde1LQjvjWD34TC6wU",
                "created": 1749671271,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 1000 entries from the probability table with probability > 0.95\n-- and classifier_name in ('lc_classifier_top', 'stamp_classifier')\n-- Only include entries with the top ranking (ranking=1) to ensure the most relevant class per object and classifier\n-- Use a subquery to filter for the maximum ranking per object, classifier, and class to optimize performance\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability AS \"probability\"\nFROM \n    probability p\nWHERE \n    p.probability > 0.95\n    AND p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\n    AND p.ranking = 1 -- Ensure only the top-ranked class per object and classifier\n    AND p.oid IN (\n        -- Subquery to limit to objects with at least one class probability > 0.95 in the specified classifiers\n        SELECT oid FROM probability\n        WHERE \n            probability > 0.95\n            AND classifier_name IN ('lc_classifier_top', 'stamp_classifier')\n            AND ranking = 1\n        LIMIT 1000 -- Limit to 1000 objects to optimize query\n    )\nORDER BY \n    p.probability DESC\nLIMIT 1000; -- Final limit to ensure no more than 1000 rows are returned\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 1000 entries from the probability table with probability > 0.95\n-- and classifier_name in ('lc_classifier_top', 'stamp_classifier')\n-- Only include entries with the top ranking (ranking=1) to ensure the most relevant class per object and classifier\n-- Use a subquery to filter for the maximum ranking per object, classifier, and class to optimize performance\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability AS \"probability\"\nFROM \n    probability p\nWHERE \n    p.probability > 0.95\n    AND p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\n    AND p.ranking = 1 -- Ensure only the top-ranked class per object and classifier\n    AND p.oid IN (\n        -- Subquery to limit to objects with at least one class probability > 0.95 in the specified classifiers\n        SELECT oid FROM probability\n        WHERE \n            probability > 0.95\n            AND classifier_name IN ('lc_classifier_top', 'stamp_classifier')\n            AND ranking = 1\n        LIMIT 1000 -- Limit to 1000 objects to optimize query\n    )\nORDER BY \n    p.probability DESC\nLIMIT 1000; -- Final limit to ensure no more than 1000 rows are returned\n```"
                },
                "in_toks": 980,
                "out_toks": 307,
                "id": "chatcmpl-BhN0PV2UOmcoIZA2Q7Fq5ZLiJITNI",
                "created": 1749676237,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 1000 probability entries with probability > 0.95\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability AS \"probability\"\nFROM \n    probability p\nWHERE \n    p.probability > 0.95\n    AND p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nORDER BY \n    p.probability DESC\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 1000 probability entries with probability > 0.95\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability AS \"probability\"\nFROM \n    probability p\nWHERE \n    p.probability > 0.95\n    AND p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nORDER BY \n    p.probability DESC\nLIMIT 1000;\n```"
                },
                "in_toks": 2098,
                "out_toks": 122,
                "id": "chatcmpl-BhLm7xfG5FWMuttWOcdjXQEsyhYf2",
                "created": 1749671507,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "64",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 798,
                "out_toks": 4,
                "id": "chatcmpl-BhLiKAtZHWKivlJBtF7mHTJ9Nl2k9",
                "created": 1749671272,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 1000 probability entries with probability > 0.95\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability\nFROM (\n    SELECT * FROM probability\n    WHERE probability > 0.95\n) p\nWHERE p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 1000 probability entries with probability > 0.95\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability\nFROM (\n    SELECT * FROM probability\n    WHERE probability > 0.95\n) p\nWHERE p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nLIMIT 1000;\n```"
                },
                "in_toks": 2098,
                "out_toks": 108,
                "id": "chatcmpl-BhLm9Add80fnapqbz789OKTEp40xj",
                "created": 1749671509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "87": {
        "0": {
            "req_id": 87,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability', 'gaia_ztf']"
                    },
                    "1": {
                        "response": "['probability', 'gaia_ztf']"
                    }
                },
                "in_toks": 826,
                "out_toks": 22,
                "id": "chatcmpl-Be0QOVr71W2OJdepSitvYNe7qwBiZ",
                "created": 1748874452,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    GROUP BY p.oid\n    HAVING COUNT(DISTINCT p.class_name) = 2 -- ensure both classes meet the probability threshold\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    GROUP BY p.oid\n    HAVING COUNT(DISTINCT p.class_name) = 2 -- ensure both classes meet the probability threshold\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```"
                    }
                },
                "in_toks": 2343,
                "out_toks": 203,
                "id": "chatcmpl-Be0Re8CqIZ9NKV50Kfq7onZblwbof",
                "created": 1748874530,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 87,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability', 'gaia_ztf']"
                    },
                    "1": {
                        "response": "['probability', 'gaia_ztf']"
                    }
                },
                "in_toks": 826,
                "out_toks": 22,
                "id": "chatcmpl-Be0QOVr71W2OJdepSitvYNe7qwBiZ",
                "created": 1748874452,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the ranking is 1 (most probable class)\n    AND p.ranking = 1\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the ranking is 1 (most probable class)\n    AND p.ranking = 1\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```"
                    }
                },
                "in_toks": 2343,
                "out_toks": 195,
                "id": "chatcmpl-Be0RftyQold6nmYONIMGiCzjxvFjj",
                "created": 1748874531,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "87",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'gaia_ztf']"
                },
                "in_toks": 826,
                "out_toks": 11,
                "id": "chatcmpl-BhLiKVckGdF3JruFkpkZm6VzLd5lW",
                "created": 1749671272,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the ranking is 1 (most probable class)\n    AND p.ranking = 1\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the ranking is 1 (most probable class)\n    AND p.ranking = 1\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2343,
                "out_toks": 195,
                "id": "chatcmpl-BhLmBoAIFqWQmiRJLnYDODUcfoetK",
                "created": 1749671511,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "87",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'gaia_ztf']"
                },
                "in_toks": 826,
                "out_toks": 11,
                "id": "chatcmpl-BhLiKUpZrQofW1B2tIaZRFWHGQuF3",
                "created": 1749671272,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the ranking is 1 (most probable class)\n    AND p.ranking = 1\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the ranking is 1 (most probable class)\n    AND p.ranking = 1\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2343,
                "out_toks": 195,
                "id": "chatcmpl-BhLmH6wOq26iXh2mf1FZ0xOuIVMJ6",
                "created": 1749671517,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "108": {
        "0": {
            "req_id": 108,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature']"
                    }
                },
                "in_toks": 816,
                "out_toks": 20,
                "id": "chatcmpl-Be0QPqv1H98BrMabHlrlJ2edGMb6i",
                "created": 1748874453,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 15 objects with more than 20 detections and high probability of being bogus\nWITH selected_objects AS (\n    SELECT o.oid, o.ndet, p.probability, o.gal_b\n    FROM object o\n    WHERE o.ndet > 20\n      AND o.oid IN (\n        -- Subquery to get object OIDs with probability > 0.9 for 'bogus' class in specified classifier\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'bogus'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 15\n      )\n)\nSELECT oid AS \"ZTF identifier\", ndet AS \"number of detections\", probability, gal_b\nFROM selected_objects\nORDER BY oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 15 objects with more than 20 detections and high probability of being bogus\nWITH selected_objects AS (\n    SELECT o.oid, o.ndet, p.probability, o.gal_b\n    FROM object o\n    WHERE o.ndet > 20\n      AND o.oid IN (\n        -- Subquery to get object OIDs with probability > 0.9 for 'bogus' class in specified classifier\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'bogus'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 15\n      )\n)\nSELECT oid AS \"ZTF identifier\", ndet AS \"number of detections\", probability, gal_b\nFROM selected_objects\nORDER BY oid;\n```"
                    }
                },
                "in_toks": 5029,
                "out_toks": 196,
                "id": "chatcmpl-Be0RjNwZQiNfKNuRxjPMy2kndPeDe",
                "created": 1748874535,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 108,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'feature']"
                    }
                },
                "in_toks": 816,
                "out_toks": 20,
                "id": "chatcmpl-Be0QPqv1H98BrMabHlrlJ2edGMb6i",
                "created": 1748874453,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 15 objects with more than 20 detections and high probability of being bogus\nWITH selected_objects AS (\n    SELECT o.oid, o.ndet, p.probability, o.gal_b\n    FROM object o\n    WHERE o.ndet > 20\n      AND o.oid IN (\n        -- Subquery to get object IDs with probability > 0.9 for 'bogus' in stamp_classifier_1.0.4\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'bogus'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 15\n    )\n)\nSELECT o.oid AS \"ZTF identifier\", o.ndet AS \"number of detections\", p.probability, o.gal_b\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'bogus'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.probability > 0.9\nORDER BY o.oid\nLIMIT 15;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 15 objects with more than 20 detections and high probability of being bogus\nWITH selected_objects AS (\n    SELECT o.oid, o.ndet, p.probability, o.gal_b\n    FROM object o\n    WHERE o.ndet > 20\n      AND o.oid IN (\n        -- Subquery to get object IDs with probability > 0.9 for 'bogus' in stamp_classifier_1.0.4\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'bogus'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 15\n    )\n)\nSELECT o.oid AS \"ZTF identifier\", o.ndet AS \"number of detections\", p.probability, o.gal_b\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'bogus'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.classifier_version = 'stamp_classifier_1.0.4'\n  AND p.probability > 0.9\nORDER BY o.oid\nLIMIT 15;\n```"
                    }
                },
                "in_toks": 5029,
                "out_toks": 276,
                "id": "chatcmpl-Be0Rfd3XSLA9vKs645DadDICyQKSf",
                "created": 1748874531,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "108",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']"
                },
                "in_toks": 816,
                "out_toks": 11,
                "id": "chatcmpl-BhLiLL0Zq9vQkf58hIj9gbjvTZkvH",
                "created": 1749671273,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 15 objects with more than 20 detections and a high probability of being bogus\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        p.probability,\n        -- Calculate galactic latitude from mean RA and Dec\n        -- Assuming the existence of a function to convert equatorial to galactic coordinates\n        -- If not available, this part may need adjustment based on available functions\n        -- For now, we will assume a placeholder function 'eq_to_gal_lat' exists\n        -- If such function does not exist, this line should be replaced accordingly\n        -- Alternatively, omit 'gal_b' if conversion is not possible\n        -- Here, we proceed with a placeholder\n        -- Replace 'eq_to_gal_lat' with actual conversion if available\n        -- For demonstration, we will set gal_b as NULL\n        NULL AS gal_b\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.class_name = 'bogus'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.probability > 0.9\n        AND o.ndet > 20\n    ORDER BY\n        o.oid\n    LIMIT 15\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    probability AS \"probability\",\n    -- Placeholder for galactic latitude; replace with actual calculation if available\n    gal_b\nFROM\n    selected_objects;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 15 objects with more than 20 detections and a high probability of being bogus\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        p.probability,\n        -- Calculate galactic latitude from mean RA and Dec\n        -- Assuming the existence of a function to convert equatorial to galactic coordinates\n        -- If not available, this part may need adjustment based on available functions\n        -- For now, we will assume a placeholder function 'eq_to_gal_lat' exists\n        -- If such function does not exist, this line should be replaced accordingly\n        -- Alternatively, omit 'gal_b' if conversion is not possible\n        -- Here, we proceed with a placeholder\n        -- Replace 'eq_to_gal_lat' with actual conversion if available\n        -- For demonstration, we will set gal_b as NULL\n        NULL AS gal_b\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.class_name = 'bogus'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.probability > 0.9\n        AND o.ndet > 20\n    ORDER BY\n        o.oid\n    LIMIT 15\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    probability AS \"probability\",\n    -- Placeholder for galactic latitude; replace with actual calculation if available\n    gal_b\nFROM\n    selected_objects;\n```"
                },
                "in_toks": 3145,
                "out_toks": 341,
                "id": "chatcmpl-BhLmMuvzrhDJ713F3RB2znzBucKW1",
                "created": 1749671522,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "108",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']"
                },
                "in_toks": 816,
                "out_toks": 10,
                "id": "chatcmpl-BhLiO3XxEzkQk31fAYXZDEY9HH0Kg",
                "created": 1749671276,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 15 objects with more than 20 detections and high probability of being bogus\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    p.probability AS \"probability\",\n    o.gal_b AS \"Galactic latitude\"\nFROM \n    object o\nWHERE \n    o.ndet > 20\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE \n            p.oid = o.oid\n            AND p.class_name = 'bogus'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.classifier_version = 'stamp_classifier_1.0.4'\n            AND p.probability > 0.9\n    )\nORDER BY \n    o.oid\nLIMIT 15;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 15 objects with more than 20 detections and high probability of being bogus\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    p.probability AS \"probability\",\n    o.gal_b AS \"Galactic latitude\"\nFROM \n    object o\nWHERE \n    o.ndet > 20\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE \n            p.oid = o.oid\n            AND p.class_name = 'bogus'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.classifier_version = 'stamp_classifier_1.0.4'\n            AND p.probability > 0.9\n    )\nORDER BY \n    o.oid\nLIMIT 15;\n```"
                },
                "in_toks": 5029,
                "out_toks": 175,
                "id": "chatcmpl-BhLmS6itzVcl0zVtiKRGGlmJgHSYS",
                "created": 1749671528,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "65": {
        "0": {
            "req_id": 65,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability']"
                    },
                    "1": {
                        "response": "['probability']"
                    }
                },
                "in_toks": 800,
                "out_toks": 8,
                "id": "chatcmpl-Be0QQjsXCrqBCDMIDwvWzGT3Fgms2",
                "created": 1748874454,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;\n```"
                    }
                },
                "in_toks": 2099,
                "out_toks": 73,
                "id": "chatcmpl-Be0Rf1bsvVlOUAj1OZof9iYlZ13a4",
                "created": 1748874531,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 65,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability']"
                    },
                    "1": {
                        "response": "['probability']"
                    }
                },
                "in_toks": 800,
                "out_toks": 8,
                "id": "chatcmpl-Be0QQjsXCrqBCDMIDwvWzGT3Fgms2",
                "created": 1748874454,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM (\n    SELECT *\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name IN ('asteroid', 'bogus')\n      AND probability BETWEEN 0.7 AND 0.99\n    ORDER BY oid DESC\n) sub\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM (\n    SELECT *\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name IN ('asteroid', 'bogus')\n      AND probability BETWEEN 0.7 AND 0.99\n    ORDER BY oid DESC\n) sub\nLIMIT 500;\n```"
                    }
                },
                "in_toks": 2099,
                "out_toks": 84,
                "id": "chatcmpl-Be0RfUESKqE6M23VeAyVTFgxB0T0u",
                "created": 1748874531,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "65",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 800,
                "out_toks": 4,
                "id": "chatcmpl-BhLiPNxP9A58Pi3H37h8VYa2JbLco",
                "created": 1749671277,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM (\n    SELECT *\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name IN ('asteroid', 'bogus')\n      AND probability BETWEEN 0.7 AND 0.99\n    ORDER BY oid DESC\n) sub\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM (\n    SELECT *\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name IN ('asteroid', 'bogus')\n      AND probability BETWEEN 0.7 AND 0.99\n    ORDER BY oid DESC\n) sub\nLIMIT 500;\n```"
                },
                "in_toks": 2099,
                "out_toks": 84,
                "id": "chatcmpl-BhLls6FG5oDU323obRbO00K7nktse",
                "created": 1749671492,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "65",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 800,
                "out_toks": 4,
                "id": "chatcmpl-BhLiQZXA1UEUSY85Da8apKdEKMBEy",
                "created": 1749671278,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;\n```"
                },
                "in_toks": 2099,
                "out_toks": 73,
                "id": "chatcmpl-BhLlsOxNBv1bOZCLXLH4ll7BYXvGS",
                "created": 1749671492,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "101": {
        "0": {
            "req_id": 101,
            "experiment_id": "run_0",
            "pred_tables": [
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability', 'xmatch', 'allwise']"
                    },
                    "1": {
                        "response": "['probability', 'xmatch', 'allwise']"
                    }
                },
                "in_toks": 812,
                "out_toks": 24,
                "id": "chatcmpl-Be0QQnHXnDwIysJVybOcTwgwuzR4M",
                "created": 1748874454,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT p.*, x.*, w.*\nFROM probability p\nJOIN xmatch x ON p.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT p.*, x.*, w.*\nFROM probability p\nJOIN xmatch x ON p.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```"
                    }
                },
                "in_toks": 2924,
                "out_toks": 183,
                "id": "chatcmpl-Be0RfXzuabwZYsy3KNRzPiOTbb03y",
                "created": 1748874531,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 101,
            "experiment_id": "run_1",
            "pred_tables": [
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['probability', 'xmatch', 'allwise']"
                    },
                    "1": {
                        "response": "['probability', 'xmatch', 'allwise']"
                    }
                },
                "in_toks": 812,
                "out_toks": 24,
                "id": "chatcmpl-Be0QQnHXnDwIysJVybOcTwgwuzR4M",
                "created": 1748874454,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT\n    p.*, -- all columns from probability table\n    x.*, -- all columns from xmatch table\n    w.*  -- all columns from allwise table\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nJOIN xmatch x ON so.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT\n    p.*, -- all columns from probability table\n    x.*, -- all columns from xmatch table\n    w.*  -- all columns from allwise table\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nJOIN xmatch x ON so.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```"
                    }
                },
                "in_toks": 2924,
                "out_toks": 211,
                "id": "chatcmpl-Be0RfdOuGSYEXGDS9x1R61VW6STfJ",
                "created": 1748874531,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "101",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'xmatch', 'allwise']"
                },
                "in_toks": 812,
                "out_toks": 12,
                "id": "chatcmpl-BhLiRSdLQMRpibp8wSi1781cS4CL5",
                "created": 1749671279,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT\n    p.*, -- all columns from probability table\n    x.*, -- all columns from xmatch table\n    w.*  -- all columns from allwise table\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nJOIN xmatch x ON so.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT\n    p.*, -- all columns from probability table\n    x.*, -- all columns from xmatch table\n    w.*  -- all columns from allwise table\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nJOIN xmatch x ON so.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```"
                },
                "in_toks": 2924,
                "out_toks": 211,
                "id": "chatcmpl-BhLluvxQkTF46w6FrAQcRk7zjw7NT",
                "created": 1749671494,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "101",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'xmatch', 'allwise']"
                },
                "in_toks": 812,
                "out_toks": 12,
                "id": "chatcmpl-BhLiSADgYWdreMKHuQthAr4MjqCOu",
                "created": 1749671280,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT\n    p.*, -- all columns from probability table\n    x.*, -- all columns from xmatch table\n    w.*  -- all columns from allwise table\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nJOIN xmatch x ON so.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT\n    p.*, -- all columns from probability table\n    x.*, -- all columns from xmatch table\n    w.*  -- all columns from allwise table\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nJOIN xmatch x ON so.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```"
                },
                "in_toks": 2924,
                "out_toks": 211,
                "id": "chatcmpl-BhLlsuuZv605FOnoZvnwNH0lCuOcG",
                "created": 1749671492,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "88": {
        "0": {
            "req_id": 88,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "stamp"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection', 'stamp']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection', 'stamp']"
                    }
                },
                "in_toks": 803,
                "out_toks": 28,
                "id": "chatcmpl-Be0QRphzTUmxCGy6PRbRkorCtLRfi",
                "created": 1748874455,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects classified as 'bogus' with ranking 1 in the stamp_classifier, with at least 20 detections\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      -- Additional conditions to ensure query efficiency and relevance\n      AND p.probability > 0.5 -- optional: filter for higher confidence, adjust as needed\n),\n-- Filter objects with at least 20 detections\nfiltered_objects AS (\n    SELECT o.oid, o.ndet, o.meanra, o.meandec, bo.classifier_version, bo.probability\n    FROM object o\n    JOIN bogus_objects bo ON o.oid = bo.oid\n    WHERE o.ndet >= 20\n)\n-- Final selection with limited rows\nSELECT\n    o.oid AS \"ZTF Identifier\",\n    o.ndet AS \"Number of Detections\",\n    -- Format mean RA and Dec as a string\n    (o.meanra::TEXT || ', ' || o.meandec::TEXT) AS \"Mean RA, Dec\",\n    bo.classifier_version AS \"Classifier Version\",\n    bo.probability AS \"Probability\"\nFROM filtered_objects o\nJOIN bogus_objects bo ON o.oid = bo.oid\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as 'bogus' with ranking 1 in the stamp_classifier, with at least 20 detections\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      -- Additional conditions to ensure query efficiency and relevance\n      AND p.probability > 0.5 -- optional: filter for higher confidence, adjust as needed\n),\n-- Filter objects with at least 20 detections\nfiltered_objects AS (\n    SELECT o.oid, o.ndet, o.meanra, o.meandec, bo.classifier_version, bo.probability\n    FROM object o\n    JOIN bogus_objects bo ON o.oid = bo.oid\n    WHERE o.ndet >= 20\n)\n-- Final selection with limited rows\nSELECT\n    o.oid AS \"ZTF Identifier\",\n    o.ndet AS \"Number of Detections\",\n    -- Format mean RA and Dec as a string\n    (o.meanra::TEXT || ', ' || o.meandec::TEXT) AS \"Mean RA, Dec\",\n    bo.classifier_version AS \"Classifier Version\",\n    bo.probability AS \"Probability\"\nFROM filtered_objects o\nJOIN bogus_objects bo ON o.oid = bo.oid\nLIMIT 50;\n```"
                },
                "in_toks": 2189,
                "out_toks": 315,
                "id": "chatcmpl-BhN0H0qsr4J6VhKu5Bbpk3b4bx0Ox",
                "created": 1749676229,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as 'bogus' with ranking 1 in the stamp_classifier\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\n-- Filter objects with at least 20 detections\nfiltered_objects AS (\n    SELECT o.oid, o.ndet, o.meanra, o.meandec, bo.classifier_version, bo.probability\n    FROM object o\n    JOIN bogus_objects bo ON o.oid = bo.oid\n    WHERE o.ndet >= 20\n)\n-- Limit to 50 results\nSELECT\n    o.oid AS \"ZTF Identifier\",\n    o.ndet AS \"Number of Detections\",\n    (o.meanra || ', ' || o.meandec) AS \"Mean RA, Dec\",\n    bo.classifier_version AS \"Classifier Version\",\n    bo.probability AS \"Probability\"\nFROM filtered_objects o\nJOIN bogus_objects bo ON o.oid = bo.oid\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects classified as 'bogus' with ranking 1 in the stamp_classifier\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\n-- Filter objects with at least 20 detections\nfiltered_objects AS (\n    SELECT o.oid, o.ndet, o.meanra, o.meandec, bo.classifier_version, bo.probability\n    FROM object o\n    JOIN bogus_objects bo ON o.oid = bo.oid\n    WHERE o.ndet >= 20\n)\n-- Limit to 50 results\nSELECT\n    o.oid AS \"ZTF Identifier\",\n    o.ndet AS \"Number of Detections\",\n    (o.meanra || ', ' || o.meandec) AS \"Mean RA, Dec\",\n    bo.classifier_version AS \"Classifier Version\",\n    bo.probability AS \"Probability\"\nFROM filtered_objects o\nJOIN bogus_objects bo ON o.oid = bo.oid\nLIMIT 50;\n```"
                    }
                },
                "in_toks": 3134,
                "out_toks": 258,
                "id": "chatcmpl-Be0Rf2M7q92enSxizPUWIt3vruKLV",
                "created": 1748874531,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 88,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "stamp"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'detection', 'stamp']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'detection', 'stamp']"
                    }
                },
                "in_toks": 803,
                "out_toks": 28,
                "id": "chatcmpl-Be0QRphzTUmxCGy6PRbRkorCtLRfi",
                "created": 1748874455,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, limit to 50 results\nWITH bogus_objects AS (\n    -- Filter probability table for 'bogus' class, classifier 'stamp_classifier', ranking 1, and probability > 0.5 for relevance\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- optional: filter for higher confidence\n),\nobject_counts AS (\n    -- Count detections per object and compute mean RA/Dec\n    SELECT o.oid,\n           COUNT(d.candid) AS detection_count,\n           AVG(o.meanra) AS mean_ra,\n           AVG(o.meandec) AS mean_dec\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n)\n-- Join to get object info, classification info, and filter by detection count\nSELECT o.oid AS ztf_id,\n       oc.detection_count,\n       o.meanra,\n       o.meandec,\n       p.classifier_version,\n       p.probability\nFROM object_counts oc\nJOIN object o ON oc.oid = o.oid\nJOIN bogus_objects p ON o.oid = p.oid\nWHERE oc.detection_count >= 20\n-- Limit to 50 results for performance\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, limit to 50 results\nWITH bogus_objects AS (\n    -- Filter probability table for 'bogus' class, classifier 'stamp_classifier', ranking 1, and probability > 0.5 for relevance\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- optional: filter for higher confidence\n),\nobject_counts AS (\n    -- Count detections per object and compute mean RA/Dec\n    SELECT o.oid,\n           COUNT(d.candid) AS detection_count,\n           AVG(o.meanra) AS mean_ra,\n           AVG(o.meandec) AS mean_dec\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n)\n-- Join to get object info, classification info, and filter by detection count\nSELECT o.oid AS ztf_id,\n       oc.detection_count,\n       o.meanra,\n       o.meandec,\n       p.classifier_version,\n       p.probability\nFROM object_counts oc\nJOIN object o ON oc.oid = o.oid\nJOIN bogus_objects p ON o.oid = p.oid\nWHERE oc.detection_count >= 20\n-- Limit to 50 results for performance\nLIMIT 50;\n```"
                },
                "in_toks": 2173,
                "out_toks": 341,
                "id": "chatcmpl-BhN0FAvMK8kvNGNGSoxqQnln7S045",
                "created": 1749676227,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nobject_counts AS (\n    SELECT o.oid, COUNT(d.candid) AS detection_count, AVG(o.meanra) AS mean_ra, AVG(o.meandec) AS mean_dec\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n)\nSELECT o.oid AS ztf_id, oc.detection_count, \n       o.meanra, o.meandec, \n       p.classifier_version, p.probability\nFROM object_counts oc\nJOIN object o ON oc.oid = o.oid\nJOIN bogus_objects p ON o.oid = p.oid\nWHERE oc.detection_count >= 20\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nobject_counts AS (\n    SELECT o.oid, COUNT(d.candid) AS detection_count, AVG(o.meanra) AS mean_ra, AVG(o.meandec) AS mean_dec\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n)\nSELECT o.oid AS ztf_id, oc.detection_count, \n       o.meanra, o.meandec, \n       p.classifier_version, p.probability\nFROM object_counts oc\nJOIN object o ON oc.oid = o.oid\nJOIN bogus_objects p ON o.oid = p.oid\nWHERE oc.detection_count >= 20\nLIMIT 50;\n```"
                    }
                },
                "in_toks": 3134,
                "out_toks": 249,
                "id": "chatcmpl-Be0RksifeCJxdgxxHbPRDHtgddh37",
                "created": 1748874536,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "88",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "stamp"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'stamp']"
                },
                "in_toks": 803,
                "out_toks": 14,
                "id": "chatcmpl-BhLiSekEyxp2savqpePyoOyfb5Zv6",
                "created": 1749671280,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH bogus_objects AS (\n    SELECT\n        p.oid,\n        COUNT(d.candid) AS num_detections,\n        AVG(o.meanra) AS mean_ra,\n        AVG(o.meandec) AS mean_dec,\n        p.classifier_version,\n        p.probability\n    FROM\n        probability p\n    JOIN\n        object o ON p.oid = o.oid\n    JOIN\n        detection d ON d.oid = o.oid\n    WHERE\n        p.class_name = 'bogus'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n    GROUP BY\n        p.oid, p.classifier_version, p.probability\n    HAVING\n        COUNT(d.candid) >= 20\n)\nSELECT\n    oid AS ztf_object_id,\n    num_detections,\n    mean_ra,\n    mean_dec,\n    classifier_version,\n    probability\nFROM\n    bogus_objects\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH bogus_objects AS (\n    SELECT\n        p.oid,\n        COUNT(d.candid) AS num_detections,\n        AVG(o.meanra) AS mean_ra,\n        AVG(o.meandec) AS mean_dec,\n        p.classifier_version,\n        p.probability\n    FROM\n        probability p\n    JOIN\n        object o ON p.oid = o.oid\n    JOIN\n        detection d ON d.oid = o.oid\n    WHERE\n        p.class_name = 'bogus'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n    GROUP BY\n        p.oid, p.classifier_version, p.probability\n    HAVING\n        COUNT(d.candid) >= 20\n)\nSELECT\n    oid AS ztf_object_id,\n    num_detections,\n    mean_ra,\n    mean_dec,\n    classifier_version,\n    probability\nFROM\n    bogus_objects\nLIMIT 50;\n```"
                },
                "in_toks": 3134,
                "out_toks": 237,
                "id": "chatcmpl-BhLludg6qBmf2PQ9yoOIt1a5Bpp0a",
                "created": 1749671494,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "88",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "stamp"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'stamp']"
                },
                "in_toks": 803,
                "out_toks": 14,
                "id": "chatcmpl-BhLiTHKzYFbarV2VJjnPhy3daPG6X",
                "created": 1749671281,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\n\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nobject_counts AS (\n    SELECT o.oid, COUNT(d.candid) AS detection_count, AVG(o.meanra) AS mean_ra, AVG(o.meandec) AS mean_dec\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n)\nSELECT \n    o.oid AS ztf_id,\n    oc.detection_count,\n    -- Create a point with mean RA and Dec\n    ST_MakePoint(oc.mean_ra, oc.mean_dec) AS mean_ra_dec,\n    p.classifier_version,\n    p.probability\nFROM object_counts oc\nJOIN bogus_objects p ON oc.oid = p.oid\n-- Filter objects with at least 20 detections\nWHERE oc.detection_count >= 20\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\n\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nobject_counts AS (\n    SELECT o.oid, COUNT(d.candid) AS detection_count, AVG(o.meanra) AS mean_ra, AVG(o.meandec) AS mean_dec\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n)\nSELECT \n    o.oid AS ztf_id,\n    oc.detection_count,\n    -- Create a point with mean RA and Dec\n    ST_MakePoint(oc.mean_ra, oc.mean_dec) AS mean_ra_dec,\n    p.classifier_version,\n    p.probability\nFROM object_counts oc\nJOIN bogus_objects p ON oc.oid = p.oid\n-- Filter objects with at least 20 detections\nWHERE oc.detection_count >= 20\nLIMIT 50;\n```"
                },
                "in_toks": 2124,
                "out_toks": 270,
                "id": "chatcmpl-BhN0G9mektaCTwZP4yYN3hKPLE8v1",
                "created": 1749676228,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nobject_counts AS (\n    SELECT o.oid, COUNT(d.candid) AS detection_count, AVG(o.meanra) AS mean_ra, AVG(o.meandec) AS mean_dec\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n)\nSELECT \n    o.oid AS ztf_id,\n    oc.detection_count,\n    ST_MakePoint(oc.mean_ra, oc.mean_dec) AS mean_ra_dec,\n    p.classifier_version,\n    p.probability\nFROM object_counts oc\nJOIN bogus_objects p ON oc.oid = p.oid\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nobject_counts AS (\n    SELECT o.oid, COUNT(d.candid) AS detection_count, AVG(o.meanra) AS mean_ra, AVG(o.meandec) AS mean_dec\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n)\nSELECT \n    o.oid AS ztf_id,\n    oc.detection_count,\n    ST_MakePoint(oc.mean_ra, oc.mean_dec) AS mean_ra_dec,\n    p.classifier_version,\n    p.probability\nFROM object_counts oc\nJOIN bogus_objects p ON oc.oid = p.oid\nLIMIT 50;\n```"
                },
                "in_toks": 3134,
                "out_toks": 239,
                "id": "chatcmpl-BhLlv7irwpCmZkvXtOpr33V6aB2y1",
                "created": 1749671495,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "70": {
        "0": {
            "req_id": 70,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'reference']"
                    },
                    "1": {
                        "response": "['object', 'reference']"
                    }
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-Be0QSwQiAV0F2IL5tnC9lnsaMXp9c",
                "created": 1748874456,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all columns for the object with oid 'ZTF22aayjqah' from the reference table\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve all columns for the object with oid 'ZTF22aayjqah' from the reference table\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';\n```"
                    }
                },
                "in_toks": 2726,
                "out_toks": 44,
                "id": "chatcmpl-Be0RgZZznvVk1ggJYW02pBNG8uYYn",
                "created": 1748874532,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 70,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'reference']"
                    },
                    "1": {
                        "response": "['object', 'reference']"
                    }
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-Be0QSwQiAV0F2IL5tnC9lnsaMXp9c",
                "created": 1748874456,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```"
                    }
                },
                "in_toks": 2726,
                "out_toks": 22,
                "id": "chatcmpl-Be0RgFsqLto3SyoYFjO7Gcgc7sJQz",
                "created": 1748874532,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "70",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 762,
                "out_toks": 6,
                "id": "chatcmpl-BhLiTD31847WTLl2hHIP3AaLCjkI0",
                "created": 1749671281,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```"
                },
                "in_toks": 2726,
                "out_toks": 22,
                "id": "chatcmpl-BhLlwmN5nfcuut4gvvN0voDO10QnK",
                "created": 1749671496,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "70",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 762,
                "out_toks": 6,
                "id": "chatcmpl-BhLiUkpTsPriEFNtFDpCbkHbjkBLQ",
                "created": 1749671282,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```"
                },
                "in_toks": 2726,
                "out_toks": 22,
                "id": "chatcmpl-BhLm3tadTEZEjtek8IMyOk9asdUqJ",
                "created": 1749671503,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "53": {
        "0": {
            "req_id": 53,
            "experiment_id": "run_0",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['non_detection']"
                    },
                    "1": {
                        "response": "['non_detection']"
                    }
                },
                "in_toks": 773,
                "out_toks": 8,
                "id": "chatcmpl-Be0QTbZkSejkFMUcQGX8kF4BcHb4Z",
                "created": 1748874457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```"
                    }
                },
                "in_toks": 2007,
                "out_toks": 62,
                "id": "chatcmpl-Be0Rgdi74XAWC3JnCtSMqjFkSyQPG",
                "created": 1748874532,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 53,
            "experiment_id": "run_1",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['non_detection']"
                    },
                    "1": {
                        "response": "['non_detection']"
                    }
                },
                "in_toks": 773,
                "out_toks": 8,
                "id": "chatcmpl-Be0QTbZkSejkFMUcQGX8kF4BcHb4Z",
                "created": 1748874457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```"
                    }
                },
                "in_toks": 2007,
                "out_toks": 62,
                "id": "chatcmpl-Be0Rmt2gJWO96ck5IzdUqjpTfRr2i",
                "created": 1748874538,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "53",
            "experiment_id": "run_2",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 773,
                "out_toks": 4,
                "id": "chatcmpl-BhLiV2SLZKCRBloPkTl4USM0rVx1u",
                "created": 1749671283,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```"
                },
                "in_toks": 2007,
                "out_toks": 62,
                "id": "chatcmpl-BhLm5X13UOkrE5pYnIjb5fvDm4Mza",
                "created": 1749671505,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "53",
            "experiment_id": "run_3",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 773,
                "out_toks": 4,
                "id": "chatcmpl-BhLiWcm1TG61grm0JZKkMKow39p0Y",
                "created": 1749671284,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```"
                },
                "in_toks": 2007,
                "out_toks": 62,
                "id": "chatcmpl-BhLm68YSKCV0btn807OMRaEq8o33V",
                "created": 1749671506,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "77": {
        "0": {
            "req_id": 77,
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['ss_ztf']"
                    },
                    "1": {
                        "response": "['ss_ztf']"
                    }
                },
                "in_toks": 790,
                "out_toks": 12,
                "id": "chatcmpl-Be0QTyH2Dy7K0kl1X719RjRvRzMY5",
                "created": 1748874457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from ss_ztf where the object is at zero distance from specified solar system identifiers\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from ss_ztf where the object is at zero distance from specified solar system identifiers\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```"
                    }
                },
                "in_toks": 2068,
                "out_toks": 63,
                "id": "chatcmpl-Be0RlRs4KRjmoEPIEhB9uB9Qzkouw",
                "created": 1748874537,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 77,
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['ss_ztf']"
                    },
                    "1": {
                        "response": "['ss_ztf']"
                    }
                },
                "in_toks": 790,
                "out_toks": 12,
                "id": "chatcmpl-Be0QTyH2Dy7K0kl1X719RjRvRzMY5",
                "created": 1748874457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from ss_ztf where the object oid matches either of the specified Solar System identifiers\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    -- Subquery to find oids with zero distance to the specified Solar System identifiers\n    SELECT s1.oid\n    FROM ss_ztf s1\n    JOIN ss_ztf s2 ON s1.oid = s2.oid\n    WHERE s2.ssnamenr IN ('213673', '49894')\n      AND s1.ssdistnr = 0\n)\nORDER BY candid, oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from ss_ztf where the object oid matches either of the specified Solar System identifiers\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    -- Subquery to find oids with zero distance to the specified Solar System identifiers\n    SELECT s1.oid\n    FROM ss_ztf s1\n    JOIN ss_ztf s2 ON s1.oid = s2.oid\n    WHERE s2.ssnamenr IN ('213673', '49894')\n      AND s1.ssdistnr = 0\n)\nORDER BY candid, oid;\n```"
                },
                "in_toks": 1166,
                "out_toks": 127,
                "id": "chatcmpl-BhN0MwK6z8piAEiVZE63KbnCfensx",
                "created": 1749676234,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from ss_ztf where the object oid matches either of the specified Solar System identifiers\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    -- Subquery to find oids with zero distance to the specified Solar System identifiers\n    SELECT s1.oid\n    FROM ss_ztf s1\n    JOIN ss_ztf s2 ON s1.oid = s2.oid\n    WHERE s2.ssnamenr IN ('213673', '49894')\n      AND q3c_dist(\n            (SELECT ra FROM object WHERE oid = s1.oid),\n            (SELECT dec FROM object WHERE oid = s1.oid),\n            (SELECT ra FROM object WHERE oid = s2.oid),\n            (SELECT dec FROM object WHERE oid = s2.oid)\n          ) = 0\n)\nORDER BY candid, oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from ss_ztf where the object oid matches either of the specified Solar System identifiers\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    -- Subquery to find oids with zero distance to the specified Solar System identifiers\n    SELECT s1.oid\n    FROM ss_ztf s1\n    JOIN ss_ztf s2 ON s1.oid = s2.oid\n    WHERE s2.ssnamenr IN ('213673', '49894')\n      AND q3c_dist(\n            (SELECT ra FROM object WHERE oid = s1.oid),\n            (SELECT dec FROM object WHERE oid = s1.oid),\n            (SELECT ra FROM object WHERE oid = s2.oid),\n            (SELECT dec FROM object WHERE oid = s2.oid)\n          ) = 0\n)\nORDER BY candid, oid;\n```"
                    }
                },
                "in_toks": 2068,
                "out_toks": 184,
                "id": "chatcmpl-Be0RmPYpM123bJ2wPSXj1WrVGIT48",
                "created": 1748874538,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "77",
            "experiment_id": "run_2",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 790,
                "out_toks": 6,
                "id": "chatcmpl-BhLiWwDcrWZHZYuahaaDwCiydFuJK",
                "created": 1749671284,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from ss_ztf where the object is at zero distance from specified solar system identifiers\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from ss_ztf where the object is at zero distance from specified solar system identifiers\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```"
                },
                "in_toks": 2068,
                "out_toks": 63,
                "id": "chatcmpl-BhLmGKl98yGenwA4noYSANsNR7K3E",
                "created": 1749671516,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "77",
            "experiment_id": "run_3",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 790,
                "out_toks": 6,
                "id": "chatcmpl-BhLiX9hjK64etyIwXxsLJ38tpBt6Z",
                "created": 1749671285,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from ss_ztf where the object is at zero distance from specified solar system identifiers\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from ss_ztf where the object is at zero distance from specified solar system identifiers\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```"
                },
                "in_toks": 2068,
                "out_toks": 63,
                "id": "chatcmpl-BhLm9LwRDBkZNFjovWN962An5OGyr",
                "created": 1749671509,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "105": {
        "0": {
            "req_id": 105,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'ps1_ztf']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'ps1_ztf']"
                    }
                },
                "in_toks": 886,
                "out_toks": 28,
                "id": "chatcmpl-Be0QUBGjwhLoXjhAOD8rYsyRKfiNC",
                "created": 1748874458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Filter objects with probability > 0.7 of being AGN in the specified classifier\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n      -- Ensure the object has a nearest PS1 source within 2 arcsec\n      AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p1\n        WHERE p1.oid = o.oid\n          AND p1.distpsnr1 < 2\n    )\n    -- Check the star/galaxy score difference condition\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p1\n        WHERE p1.oid = o.oid\n          AND ABS(p1.sgscore1 - p1.sgscore2) < 0.5\n    )\n    LIMIT 50\n)\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    d.sgscore,\n    d.candid AS epoch_id,\n    d.filterid AS filter_id,\n    d.chi2red AS reduced_chi2,\n    d.sgscore AS sextractor_sgscore,\n    p1.candid AS nearest_ps1_source_id,\n    p1.sgscore1 AS ps1_sgscore,\n    p1.distpsnr1 AS distance_ps1\nFROM selected_objects so\nJOIN object o ON so.oid = o.oid\nJOIN detection d ON o.oid = d.oid\nJOIN ps1_ztf p1 ON o.oid = p1.oid\nWHERE p1.distpsnr1 < 2\n  AND ABS(p1.sgscore1 - p1.sgscore2) < 0.5\nORDER BY p.probability DESC\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Filter objects with probability > 0.7 of being AGN in the specified classifier\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n      -- Ensure the object has a nearest PS1 source within 2 arcsec\n      AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p1\n        WHERE p1.oid = o.oid\n          AND p1.distpsnr1 < 2\n    )\n    -- Check the star/galaxy score difference condition\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p1\n        WHERE p1.oid = o.oid\n          AND ABS(p1.sgscore1 - p1.sgscore2) < 0.5\n    )\n    LIMIT 50\n)\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    d.sgscore,\n    d.candid AS epoch_id,\n    d.filterid AS filter_id,\n    d.chi2red AS reduced_chi2,\n    d.sgscore AS sextractor_sgscore,\n    p1.candid AS nearest_ps1_source_id,\n    p1.sgscore1 AS ps1_sgscore,\n    p1.distpsnr1 AS distance_ps1\nFROM selected_objects so\nJOIN object o ON so.oid = o.oid\nJOIN detection d ON o.oid = d.oid\nJOIN ps1_ztf p1 ON o.oid = p1.oid\nWHERE p1.distpsnr1 < 2\n  AND ABS(p1.sgscore1 - p1.sgscore2) < 0.5\nORDER BY p.probability DESC\nLIMIT 50;\n```"
                },
                "in_toks": 3009,
                "out_toks": 458,
                "id": "chatcmpl-BhN0RKCD2Io56s3VlY8d46JZ5a4cw",
                "created": 1749676239,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Filter objects with probability > 0.7 of being AGN in the specified classifier\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the object has a nearest PS1 source within 2 arcsec\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p1\n        WHERE p1.oid = o.oid\n          AND p1.distpsnr1 < 2\n    )\n    -- Check the star/galaxy score difference condition\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p1\n        WHERE p1.oid = o.oid\n          AND ABS(p1.sgscore1 - (SELECT sgscore FROM psf_sextractor WHERE oid = o.oid LIMIT 1)) < 0.5\n    )\n    LIMIT 50\n)\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    d.sgscore,\n    d.candid AS epoch_id,\n    d.filterid AS filter_id,\n    d.chi2red AS reduced_chi2,\n    d.sgscore AS sextractor_sgscore,\n    p1.candid AS nearest_ps1_source_id,\n    p1.sgscore1 AS ps1_sgscore,\n    p1.distpsnr1 AS distance_ps1\nFROM selected_objects so\nJOIN object o ON so.oid = o.oid\nJOIN detection d ON o.oid = d.oid\nJOIN ps1_ztf p1 ON o.oid = p1.oid\nWHERE p1.distpsnr1 < 2\n  AND ABS(p1.sgscore1 - (SELECT sgscore FROM psf_sextractor WHERE oid = o.oid LIMIT 1)) < 0.5\nORDER BY p.probability DESC\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Filter objects with probability > 0.7 of being AGN in the specified classifier\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the object has a nearest PS1 source within 2 arcsec\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p1\n        WHERE p1.oid = o.oid\n          AND p1.distpsnr1 < 2\n    )\n    -- Check the star/galaxy score difference condition\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf p1\n        WHERE p1.oid = o.oid\n          AND ABS(p1.sgscore1 - (SELECT sgscore FROM psf_sextractor WHERE oid = o.oid LIMIT 1)) < 0.5\n    )\n    LIMIT 50\n)\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    d.sgscore,\n    d.candid AS epoch_id,\n    d.filterid AS filter_id,\n    d.chi2red AS reduced_chi2,\n    d.sgscore AS sextractor_sgscore,\n    p1.candid AS nearest_ps1_source_id,\n    p1.sgscore1 AS ps1_sgscore,\n    p1.distpsnr1 AS distance_ps1\nFROM selected_objects so\nJOIN object o ON so.oid = o.oid\nJOIN detection d ON o.oid = d.oid\nJOIN ps1_ztf p1 ON o.oid = p1.oid\nWHERE p1.distpsnr1 < 2\n  AND ABS(p1.sgscore1 - (SELECT sgscore FROM psf_sextractor WHERE oid = o.oid LIMIT 1)) < 0.5\nORDER BY p.probability DESC\nLIMIT 50;\n```"
                    }
                },
                "in_toks": 3422,
                "out_toks": 486,
                "id": "chatcmpl-Be0RlldiGj6rfYYJKsZvJ88k2xcIV",
                "created": 1748874537,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 105,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'ps1_ztf']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'ps1_ztf']"
                    }
                },
                "in_toks": 886,
                "out_toks": 28,
                "id": "chatcmpl-Be0QUBGjwhLoXjhAOD8rYsyRKfiNC",
                "created": 1748874458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Join with probability table to filter objects with probability > 0.7 of being AGN\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n      -- Ensure the nearest PS1 source is within 2 arcsec\n      AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf ps\n        WHERE ps.oid = o.oid\n          AND q3c_join(o.meanra, o.meandec, ps.objectidps1, ps.objectidps1, 2.0)\n      )\n      -- Check the star/galaxy score difference condition\n      AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf ps\n        WHERE ps.oid = o.oid\n          AND ps.nmtchps > 0\n          AND ABS(ps.sgscore1 - \n            -- Use the sgscore1 from ps1_ztf as per schema\n            ps.sgscore1\n          ) < 0.5\n      )\n    LIMIT 50\n)\n-- Retrieve candidate detections and associated information for selected objects\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    d.sgscore,\n    d.candid AS epoch_id,\n    d.filterid AS filter_id,\n    d.chi2red AS reduced_chi2,\n    d.sgscore AS sextractor_sgscore,\n    ps.objectidps1 AS nearest_ps1_id,\n    ps.sgscore1 AS ps1_sgscore,\n    ps.distpsnr1 AS distance_ps1\nFROM selected_objects so\nJOIN object o ON so.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nLEFT JOIN ps1_ztf ps ON o.oid = ps.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.7\n  -- Ensure the nearest PS1 source is within 2 arcsec\n  AND q3c_join(o.meanra, o.meandec, ps.objectidps1, ps.objectidps1, 2.0)\n  -- Check the star/galaxy score difference condition\n  AND ABS(ps.sgscore1 - ps.sgscore1) < 0.5\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Join with probability table to filter objects with probability > 0.7 of being AGN\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n      -- Ensure the nearest PS1 source is within 2 arcsec\n      AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf ps\n        WHERE ps.oid = o.oid\n          AND q3c_join(o.meanra, o.meandec, ps.objectidps1, ps.objectidps1, 2.0)\n      )\n      -- Check the star/galaxy score difference condition\n      AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf ps\n        WHERE ps.oid = o.oid\n          AND ps.nmtchps > 0\n          AND ABS(ps.sgscore1 - \n            -- Use the sgscore1 from ps1_ztf as per schema\n            ps.sgscore1\n          ) < 0.5\n      )\n    LIMIT 50\n)\n-- Retrieve candidate detections and associated information for selected objects\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    d.sgscore,\n    d.candid AS epoch_id,\n    d.filterid AS filter_id,\n    d.chi2red AS reduced_chi2,\n    d.sgscore AS sextractor_sgscore,\n    ps.objectidps1 AS nearest_ps1_id,\n    ps.sgscore1 AS ps1_sgscore,\n    ps.distpsnr1 AS distance_ps1\nFROM selected_objects so\nJOIN object o ON so.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nLEFT JOIN ps1_ztf ps ON o.oid = ps.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.7\n  -- Ensure the nearest PS1 source is within 2 arcsec\n  AND q3c_join(o.meanra, o.meandec, ps.objectidps1, ps.objectidps1, 2.0)\n  -- Check the star/galaxy score difference condition\n  AND ABS(ps.sgscore1 - ps.sgscore1) < 0.5\nLIMIT 50;\n```"
                },
                "in_toks": 3222,
                "out_toks": 611,
                "id": "chatcmpl-BhN0MobaTBKVLsZqT2Xkv6ZtvnzFD",
                "created": 1749676234,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Filter objects with probability > 0.7 of being AGN in the specified classifier\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the nearest PS1 source is within 2 arcsec\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf ps\n        WHERE ps.oid = o.oid\n          AND q3c_join(o.meanra, o.meandec, ps.objectidps1, ps.objectidps1, 2.0)\n    )\n    -- Check the star/galaxy score difference condition\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf ps\n        WHERE ps.oid = o.oid\n          AND ps.nmtchps > 0\n          AND ABS(ps.sgscore1 - (SELECT sgscore FROM psf_sextractor WHERE oid = o.oid LIMIT 1)) < 0.5\n    )\n    LIMIT 50\n)\n-- Retrieve candidate detections and associated information for selected objects\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    d.sgscore,\n    d.candid AS epoch_id,\n    d.filterid AS filter_id,\n    d.chi2red AS reduced_chi2,\n    d.sgscore AS sextractor_sgscore,\n    ps.objectidps1 AS nearest_ps1_id,\n    ps.sgscore1 AS ps1_sgscore,\n    ps.distpsnr1 AS distance_ps1\nFROM selected_objects so\nJOIN object o ON so.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nLEFT JOIN ps1_ztf ps ON o.oid = ps.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.7\n  AND q3c_join(o.meanra, o.meandec, ps.objectidps1, ps.objectidps1, 2.0)\n  AND ABS(ps.sgscore1 - (SELECT sgscore FROM psf_sextractor WHERE oid = o.oid LIMIT 1)) < 0.5\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Filter objects with probability > 0.7 of being AGN in the specified classifier\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the nearest PS1 source is within 2 arcsec\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf ps\n        WHERE ps.oid = o.oid\n          AND q3c_join(o.meanra, o.meandec, ps.objectidps1, ps.objectidps1, 2.0)\n    )\n    -- Check the star/galaxy score difference condition\n    AND EXISTS (\n        SELECT 1\n        FROM ps1_ztf ps\n        WHERE ps.oid = o.oid\n          AND ps.nmtchps > 0\n          AND ABS(ps.sgscore1 - (SELECT sgscore FROM psf_sextractor WHERE oid = o.oid LIMIT 1)) < 0.5\n    )\n    LIMIT 50\n)\n-- Retrieve candidate detections and associated information for selected objects\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    d.sgscore,\n    d.candid AS epoch_id,\n    d.filterid AS filter_id,\n    d.chi2red AS reduced_chi2,\n    d.sgscore AS sextractor_sgscore,\n    ps.objectidps1 AS nearest_ps1_id,\n    ps.sgscore1 AS ps1_sgscore,\n    ps.distpsnr1 AS distance_ps1\nFROM selected_objects so\nJOIN object o ON so.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nLEFT JOIN ps1_ztf ps ON o.oid = ps.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.7\n  AND q3c_join(o.meanra, o.meandec, ps.objectidps1, ps.objectidps1, 2.0)\n  AND ABS(ps.sgscore1 - (SELECT sgscore FROM psf_sextractor WHERE oid = o.oid LIMIT 1)) < 0.5\nLIMIT 50;\n```"
                    }
                },
                "in_toks": 3422,
                "out_toks": 592,
                "id": "chatcmpl-Be0RmFuvyoNQ5AVlD6B5Uuy5hGKHO",
                "created": 1748874538,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "105",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'reference']"
                },
                "in_toks": 886,
                "out_toks": 17,
                "id": "chatcmpl-BhLiXuHgLIatZt1HvTix8vHZiKBkM",
                "created": 1749671285,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    -- Get objects with probability > 0.7 of being AGN from the specified classifier\n    SELECT o.oid, p.probability\n    FROM object o\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        ORDER BY ranking ASC\n        LIMIT 1\n    ) p ON o.oid = p.oid\n    WHERE p.probability > 0.7\n),\nps1_sources AS (\n    -- Get PS1 source info for objects\n    SELECT oid, objectidps1, sgscore1, distpsnr1\n    FROM ps1_ztf\n),\n-- Filter objects based on PS1 proximity and star/galaxy score difference\nfiltered_objects AS (\n    SELECT so.oid, so.probability\n    FROM selected_objects so\n    JOIN ps1_sources ps ON so.oid = ps.oid\n    -- Ensure nearest PS1 source is within 2 arcsec\n    WHERE ps.distpsnr1 < 2\n      -- Compare PS1 star/galaxy score with the score from object table\n      AND ABS(ps.sgscore1 - (\n            -- Retrieve the star/galaxy score from object table for the object\n            SELECT sgscore\n            FROM object\n            WHERE oid = so.oid\n        )) < 0.5\n),\n-- Retrieve detection details for the selected objects\ndetections AS (\n    SELECT d.oid, d.candid, d.fid, d.chi, d.sgscore\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\n-- Retrieve object info for the selected objects\nobjects_info AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n)\n-- Final selection with all required columns\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.fid,\n    d.chi AS reduced_chi_square,\n    d.sgscore AS sextractor_sgscore,\n    ps.objectidps1,\n    ps.sgscore1 AS ps1_sgscore,\n    ps.distpsnr1 AS ps1_distance\nFROM filtered_objects fo\nJOIN probability p ON fo.oid = p.oid\n  AND p.class_name = 'AGN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\nJOIN objects_info o ON fo.oid = o.oid\nLEFT JOIN detections d ON o.oid = d.oid\nLEFT JOIN ps1_sources ps ON o.oid = ps.oid\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    -- Get objects with probability > 0.7 of being AGN from the specified classifier\n    SELECT o.oid, p.probability\n    FROM object o\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        ORDER BY ranking ASC\n        LIMIT 1\n    ) p ON o.oid = p.oid\n    WHERE p.probability > 0.7\n),\nps1_sources AS (\n    -- Get PS1 source info for objects\n    SELECT oid, objectidps1, sgscore1, distpsnr1\n    FROM ps1_ztf\n),\n-- Filter objects based on PS1 proximity and star/galaxy score difference\nfiltered_objects AS (\n    SELECT so.oid, so.probability\n    FROM selected_objects so\n    JOIN ps1_sources ps ON so.oid = ps.oid\n    -- Ensure nearest PS1 source is within 2 arcsec\n    WHERE ps.distpsnr1 < 2\n      -- Compare PS1 star/galaxy score with the score from object table\n      AND ABS(ps.sgscore1 - (\n            -- Retrieve the star/galaxy score from object table for the object\n            SELECT sgscore\n            FROM object\n            WHERE oid = so.oid\n        )) < 0.5\n),\n-- Retrieve detection details for the selected objects\ndetections AS (\n    SELECT d.oid, d.candid, d.fid, d.chi, d.sgscore\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\n-- Retrieve object info for the selected objects\nobjects_info AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n)\n-- Final selection with all required columns\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.fid,\n    d.chi AS reduced_chi_square,\n    d.sgscore AS sextractor_sgscore,\n    ps.objectidps1,\n    ps.sgscore1 AS ps1_sgscore,\n    ps.distpsnr1 AS ps1_distance\nFROM filtered_objects fo\nJOIN probability p ON fo.oid = p.oid\n  AND p.class_name = 'AGN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\nJOIN objects_info o ON fo.oid = o.oid\nLEFT JOIN detections d ON o.oid = d.oid\nLEFT JOIN ps1_sources ps ON o.oid = ps.oid\nLIMIT 50;\n```"
                },
                "in_toks": 3543,
                "out_toks": 610,
                "id": "chatcmpl-BhN0LuR6SIY5GohHk8Vcbd5Nryrxu",
                "created": 1749676233,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Subquery to get the top probability for AGN in the specified classifier\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        ORDER BY ranking ASC\n        LIMIT 1\n    ) p ON o.oid = p.oid\n    -- Filter objects with probability > 0.7\n    WHERE p.probability > 0.7\n),\nps1_sources AS (\n    SELECT oid, objectidps1, sgscore1, distpsnr1\n    FROM ps1_ztf\n),\n-- Filter objects based on PS1 proximity and star/galaxy score difference\nfiltered_objects AS (\n    SELECT so.oid, so.probability\n    FROM selected_objects so\n    JOIN ps1_sources ps ON so.oid = ps.oid\n    WHERE ps.distpsnr1 < 2\n      AND ABS(ps.sgscore1 - (SELECT sgscore FROM object WHERE oid = so.oid)) < 0.5\n),\n-- Retrieve detection details for the selected objects\ndetections AS (\n    SELECT d.oid, d.candid, d.fid, d.chi, d.sgscore\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\n-- Retrieve object info for the selected objects\nobjects_info AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n)\n-- Final selection with all required columns\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.fid,\n    d.chi AS reduced_chi_square,\n    d.sgscore AS sextractor_sgscore,\n    ps.objectidps1,\n    ps.sgscore1 AS ps1_sgscore,\n    ps.distpsnr1 AS ps1_distance\nFROM filtered_objects fo\nJOIN probability p ON fo.oid = p.oid AND p.class_name = 'AGN' AND p.classifier_name = 'lc_classifier' AND p.classifier_version = 'hierarchical_rf_1.1.0'\nJOIN objects_info o ON fo.oid = o.oid\nLEFT JOIN detections d ON o.oid = d.oid\nLEFT JOIN ps1_sources ps ON o.oid = ps.oid\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Subquery to get the top probability for AGN in the specified classifier\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        ORDER BY ranking ASC\n        LIMIT 1\n    ) p ON o.oid = p.oid\n    -- Filter objects with probability > 0.7\n    WHERE p.probability > 0.7\n),\nps1_sources AS (\n    SELECT oid, objectidps1, sgscore1, distpsnr1\n    FROM ps1_ztf\n),\n-- Filter objects based on PS1 proximity and star/galaxy score difference\nfiltered_objects AS (\n    SELECT so.oid, so.probability\n    FROM selected_objects so\n    JOIN ps1_sources ps ON so.oid = ps.oid\n    WHERE ps.distpsnr1 < 2\n      AND ABS(ps.sgscore1 - (SELECT sgscore FROM object WHERE oid = so.oid)) < 0.5\n),\n-- Retrieve detection details for the selected objects\ndetections AS (\n    SELECT d.oid, d.candid, d.fid, d.chi, d.sgscore\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\n-- Retrieve object info for the selected objects\nobjects_info AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n)\n-- Final selection with all required columns\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.fid,\n    d.chi AS reduced_chi_square,\n    d.sgscore AS sextractor_sgscore,\n    ps.objectidps1,\n    ps.sgscore1 AS ps1_sgscore,\n    ps.distpsnr1 AS ps1_distance\nFROM filtered_objects fo\nJOIN probability p ON fo.oid = p.oid AND p.class_name = 'AGN' AND p.classifier_name = 'lc_classifier' AND p.classifier_version = 'hierarchical_rf_1.1.0'\nJOIN objects_info o ON fo.oid = o.oid\nLEFT JOIN detections d ON o.oid = d.oid\nLEFT JOIN ps1_sources ps ON o.oid = ps.oid\nLIMIT 50;\n```"
                },
                "in_toks": 3788,
                "out_toks": 551,
                "id": "chatcmpl-BhLmE3v6mxdXg898LCEQbjhXN0rio",
                "created": 1749671514,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "105",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf",
                "xmatch",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf', 'xmatch', 'feature']"
                },
                "in_toks": 886,
                "out_toks": 21,
                "id": "chatcmpl-BhLiaIsrhVgKQ5goyssjimOZSZyPq",
                "created": 1749671288,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 50 objects satisfying the specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Subquery to get the top probability of being an AGN in the hierarchical_rf_1.1.0 classifier\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        -- Use ROW_NUMBER() with a window function to rank probabilities per object\n        -- Note: PostgreSQL uses ROW_NUMBER() OVER (...) instead of QUALIFY\n        WINDOW rn AS (PARTITION BY oid ORDER BY probability DESC)\n    ) p ON o.oid = p.oid\n    WHERE p.probability > 0.7\n),\nranked_probs AS (\n    SELECT\n        oid,\n        probability,\n        ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n),\ntop_prob AS (\n    SELECT oid, probability\n    FROM ranked_probs\n    WHERE rn = 1\n),\nnearest_ps1 AS (\n    SELECT\n        xm.oid,\n        xm.objectidps1,\n        xm.sgscore1,\n        xm.dist\n    FROM xmatch xm\n    WHERE xm.catid = 'PS1'\n      AND xm.dist < 2\n),\n-- Assuming 'sgscore1' from PS1 is stored in ps1_ztf\n-- For SExtractor score, assuming it's stored in feature table with name 'sgscore1' and fid=1\nfeature_ps1 AS (\n    SELECT o.oid, f.value AS sgscore_ps1\n    FROM object o\n    LEFT JOIN feature f ON o.oid = f.oid AND f.name = 'sgscore1' AND f.fid = 1\n    WHERE f.version = 'ps1_version_placeholder' -- replace with actual version if known\n),\nfeature_sextractor AS (\n    SELECT o.oid, f.value AS sgscore_sextractor\n    FROM object o\n    LEFT JOIN feature f ON o.oid = f.oid AND f.name = 'sgscore1' AND f.fid = 1\n    WHERE f.version = 'sextractor_version_placeholder' -- replace with actual version if known\n)\nSELECT\n    o.oid AS ztf_object_id,\n    tp.probability,\n    -- Epoch info: candidate, filterid, reduced chi-square\n    -- Assuming detection table exists; if not, replace or remove\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    -- sgscore from SExtractor\n    f_sex.value AS sgscore_sextractor,\n    -- PS1 nearest source info\n    np.objectidps1,\n    np.sgscore1 AS ps1_sgscore,\n    np.dist AS ps1_distance\nFROM selected_objects so\nJOIN top_prob tp ON so.oid = tp.oid\nLEFT JOIN object o ON o.oid = so.oid\nLEFT JOIN detection d ON o.oid = d.oid\nLEFT JOIN feature f_sex ON o.oid = f_sex.oid AND f_sex.name = 'sgscore1' AND f_sex.fid = 1\nLEFT JOIN nearest_ps1 np ON o.oid = np.oid\nLEFT JOIN feature f_ps1 ON o.oid = f_ps1.oid AND f_ps1.name = 'sgscore1' AND f_ps1.fid = 1\nLEFT JOIN feature_ps1 fp ON o.oid = fp.oid\nWHERE\n    -- Conditions for star/galaxy score difference\n    (f_ps1.sgscore_ps1 - f_sex.value) < 0.5\nORDER BY tp.probability DESC\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 50 objects satisfying the specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Subquery to get the top probability of being an AGN in the hierarchical_rf_1.1.0 classifier\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        -- Use ROW_NUMBER() with a window function to rank probabilities per object\n        -- Note: PostgreSQL uses ROW_NUMBER() OVER (...) instead of QUALIFY\n        WINDOW rn AS (PARTITION BY oid ORDER BY probability DESC)\n    ) p ON o.oid = p.oid\n    WHERE p.probability > 0.7\n),\nranked_probs AS (\n    SELECT\n        oid,\n        probability,\n        ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n),\ntop_prob AS (\n    SELECT oid, probability\n    FROM ranked_probs\n    WHERE rn = 1\n),\nnearest_ps1 AS (\n    SELECT\n        xm.oid,\n        xm.objectidps1,\n        xm.sgscore1,\n        xm.dist\n    FROM xmatch xm\n    WHERE xm.catid = 'PS1'\n      AND xm.dist < 2\n),\n-- Assuming 'sgscore1' from PS1 is stored in ps1_ztf\n-- For SExtractor score, assuming it's stored in feature table with name 'sgscore1' and fid=1\nfeature_ps1 AS (\n    SELECT o.oid, f.value AS sgscore_ps1\n    FROM object o\n    LEFT JOIN feature f ON o.oid = f.oid AND f.name = 'sgscore1' AND f.fid = 1\n    WHERE f.version = 'ps1_version_placeholder' -- replace with actual version if known\n),\nfeature_sextractor AS (\n    SELECT o.oid, f.value AS sgscore_sextractor\n    FROM object o\n    LEFT JOIN feature f ON o.oid = f.oid AND f.name = 'sgscore1' AND f.fid = 1\n    WHERE f.version = 'sextractor_version_placeholder' -- replace with actual version if known\n)\nSELECT\n    o.oid AS ztf_object_id,\n    tp.probability,\n    -- Epoch info: candidate, filterid, reduced chi-square\n    -- Assuming detection table exists; if not, replace or remove\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    -- sgscore from SExtractor\n    f_sex.value AS sgscore_sextractor,\n    -- PS1 nearest source info\n    np.objectidps1,\n    np.sgscore1 AS ps1_sgscore,\n    np.dist AS ps1_distance\nFROM selected_objects so\nJOIN top_prob tp ON so.oid = tp.oid\nLEFT JOIN object o ON o.oid = so.oid\nLEFT JOIN detection d ON o.oid = d.oid\nLEFT JOIN feature f_sex ON o.oid = f_sex.oid AND f_sex.name = 'sgscore1' AND f_sex.fid = 1\nLEFT JOIN nearest_ps1 np ON o.oid = np.oid\nLEFT JOIN feature f_ps1 ON o.oid = f_ps1.oid AND f_ps1.name = 'sgscore1' AND f_ps1.fid = 1\nLEFT JOIN feature_ps1 fp ON o.oid = fp.oid\nWHERE\n    -- Conditions for star/galaxy score difference\n    (f_ps1.sgscore_ps1 - f_sex.value) < 0.5\nORDER BY tp.probability DESC\nLIMIT 50;\n```"
                },
                "in_toks": 6003,
                "out_toks": 834,
                "id": "chatcmpl-BhN0JqN8XfUVWQxhAL8alDOijjsSh",
                "created": 1749676231,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select at most 50 objects satisfying the specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Subquery to get the top probability of being an AGN in the hierarchical_rf_1.1.0 classifier\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        -- Rank probabilities to get the most probable class per object\n        QUALIFY ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) = 1\n    ) p ON o.oid = p.oid\n    WHERE p.probability > 0.7\n),\nnearest_ps1 AS (\n    SELECT\n        xm.oid,\n        xm.oid_catalog,\n        xm.dist,\n        ps1.sgscore1,\n        ps1.objectidps1\n    FROM xmatch xm\n    JOIN ps1_ztf ps1 ON xm.oid = ps1.oid\n    WHERE xm.catid = 'PS1'\n      AND xm.dist < 2\n),\nstar_galaxy_score_diff AS (\n    SELECT\n        o.oid,\n        -- Assuming 'sgscore1' from PS1 and 'sgscore1' from SExtractor are available\n        -- For SExtractor score, assuming it's stored in feature table with name 'sgscore1' and fid=1\n        -- If not, this part needs adjustment based on actual feature storage\n        (f_ps1.value - f_sextractor.value) AS sgscore_diff\n    FROM selected_objects so\n    JOIN object o ON so.oid = o.oid\n    LEFT JOIN feature f_ps1 ON o.oid = f_ps1.oid AND f_ps1.name = 'sgscore1' AND f_ps1.fid = 1\n    LEFT JOIN feature f_sextractor ON o.oid = f_sextractor.oid AND f_sextractor.name = 'sgscore1' AND f_sextractor.fid = 1\n    WHERE f_ps1.version = 'ps1_version_placeholder' -- replace with actual version if known\n      AND f_sextractor.version = 'sextractor_version_placeholder' -- replace with actual version if known\n)\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    -- Epoch details: candidate and filter_id, reduced chi-square, sgscore from SExtractor\n    -- Assuming epoch info is stored in detection table, which is not provided, so this is a placeholder\n    -- Replace with actual epoch table if available\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    -- sgscore from SExtractor, assuming stored in feature table\n    f_sextractor.value AS sgscore_sextractor,\n    -- PS1 nearest source info\n    np.objectidps1,\n    np.sgscore1 AS ps1_sgscore,\n    np.dist AS ps1_distance\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN detection d ON o.oid = d.oid\nLEFT JOIN feature f_sextractor ON o.oid = f_sextractor.oid AND f_sextractor.name = 'sgscore1' AND f_sextractor.fid = 1\nLEFT JOIN nearest_ps1 np ON o.oid = np.oid\nWHERE\n    -- Conditions for star/galaxy score difference\n    (f_ps1.value - f_sextractor.value) < 0.5\nORDER BY p.probability DESC\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 50 objects satisfying the specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Subquery to get the top probability of being an AGN in the hierarchical_rf_1.1.0 classifier\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        -- Rank probabilities to get the most probable class per object\n        QUALIFY ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) = 1\n    ) p ON o.oid = p.oid\n    WHERE p.probability > 0.7\n),\nnearest_ps1 AS (\n    SELECT\n        xm.oid,\n        xm.oid_catalog,\n        xm.dist,\n        ps1.sgscore1,\n        ps1.objectidps1\n    FROM xmatch xm\n    JOIN ps1_ztf ps1 ON xm.oid = ps1.oid\n    WHERE xm.catid = 'PS1'\n      AND xm.dist < 2\n),\nstar_galaxy_score_diff AS (\n    SELECT\n        o.oid,\n        -- Assuming 'sgscore1' from PS1 and 'sgscore1' from SExtractor are available\n        -- For SExtractor score, assuming it's stored in feature table with name 'sgscore1' and fid=1\n        -- If not, this part needs adjustment based on actual feature storage\n        (f_ps1.value - f_sextractor.value) AS sgscore_diff\n    FROM selected_objects so\n    JOIN object o ON so.oid = o.oid\n    LEFT JOIN feature f_ps1 ON o.oid = f_ps1.oid AND f_ps1.name = 'sgscore1' AND f_ps1.fid = 1\n    LEFT JOIN feature f_sextractor ON o.oid = f_sextractor.oid AND f_sextractor.name = 'sgscore1' AND f_sextractor.fid = 1\n    WHERE f_ps1.version = 'ps1_version_placeholder' -- replace with actual version if known\n      AND f_sextractor.version = 'sextractor_version_placeholder' -- replace with actual version if known\n)\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    -- Epoch details: candidate and filter_id, reduced chi-square, sgscore from SExtractor\n    -- Assuming epoch info is stored in detection table, which is not provided, so this is a placeholder\n    -- Replace with actual epoch table if available\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    -- sgscore from SExtractor, assuming stored in feature table\n    f_sextractor.value AS sgscore_sextractor,\n    -- PS1 nearest source info\n    np.objectidps1,\n    np.sgscore1 AS ps1_sgscore,\n    np.dist AS ps1_distance\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN detection d ON o.oid = d.oid\nLEFT JOIN feature f_sextractor ON o.oid = f_sextractor.oid AND f_sextractor.name = 'sgscore1' AND f_sextractor.fid = 1\nLEFT JOIN nearest_ps1 np ON o.oid = np.oid\nWHERE\n    -- Conditions for star/galaxy score difference\n    (f_ps1.value - f_sextractor.value) < 0.5\nORDER BY p.probability DESC\nLIMIT 50;\n```"
                },
                "in_toks": 5967,
                "out_toks": 769,
                "id": "chatcmpl-BhLmWPamairTl2tFfALhmoxwFnjIt",
                "created": 1749671532,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "86": {
        "0": {
            "req_id": 86,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'ps1_ztf']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'ps1_ztf']"
                    }
                },
                "in_toks": 835,
                "out_toks": 28,
                "id": "chatcmpl-Be0QVDEMX9gUvZIcOKpZkPSe6RUJ3",
                "created": 1748874459,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.6 for classes Cepheid, DSCT, or RRL in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('CEP', 'DSCT', 'RRL')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.6\n    ORDER BY p.oid\n    LIMIT 100\n)\nSELECT p.*, ps.*\nFROM probability p\nJOIN object o ON p.oid = o.oid\nJOIN ps1_ztf ps ON p.oid = ps.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND ps.sgscore1 > 0.8;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.6 for classes Cepheid, DSCT, or RRL in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('CEP', 'DSCT', 'RRL')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.6\n    ORDER BY p.oid\n    LIMIT 100\n)\nSELECT p.*, ps.*\nFROM probability p\nJOIN object o ON p.oid = o.oid\nJOIN ps1_ztf ps ON p.oid = ps.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND ps.sgscore1 > 0.8;\n```"
                    }
                },
                "in_toks": 3371,
                "out_toks": 201,
                "id": "chatcmpl-Be0Rm0Qh8Fa16sUfQas4GEeukt5OY",
                "created": 1748874538,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 86,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability', 'ps1_ztf']"
                    },
                    "1": {
                        "response": "['object', 'probability', 'ps1_ztf']"
                    }
                },
                "in_toks": 835,
                "out_toks": 28,
                "id": "chatcmpl-Be0QVDEMX9gUvZIcOKpZkPSe6RUJ3",
                "created": 1748874459,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to select object IDs with probability > 0.6 for any of the specified classes in the hierarchical_rf_1.1.0 classifier\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n      AND class_name IN ('Cepheid', 'DSCT', 'RRL')\n      AND probability > 0.6\n      AND ranking = 1 -- Ensure selecting the top-ranked class per object for clarity and efficiency\n) AS filtered_probs\nJOIN object o ON o.oid = filtered_probs.oid\nJOIN probability p ON p.oid = o.oid\n  AND p.class_name IN ('Cepheid', 'DSCT', 'RRL')\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.6\n  AND p.ranking = 1 -- Consistent with subquery to focus on top class per object\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE ps.sgscore1 > 0.8\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to select object IDs with probability > 0.6 for any of the specified classes in the hierarchical_rf_1.1.0 classifier\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n      AND class_name IN ('Cepheid', 'DSCT', 'RRL')\n      AND probability > 0.6\n      AND ranking = 1 -- Ensure selecting the top-ranked class per object for clarity and efficiency\n) AS filtered_probs\nJOIN object o ON o.oid = filtered_probs.oid\nJOIN probability p ON p.oid = o.oid\n  AND p.class_name IN ('Cepheid', 'DSCT', 'RRL')\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.6\n  AND p.ranking = 1 -- Consistent with subquery to focus on top class per object\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE ps.sgscore1 > 0.8\nLIMIT 100;\n```"
                },
                "in_toks": 2406,
                "out_toks": 285,
                "id": "chatcmpl-BhN0JA4BlT1VawQBhOrIk7kPew1Lo",
                "created": 1749676231,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to select object IDs with probability > 0.6 for any of the specified classes in the hierarchical_rf_1.1.0 classifier\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n      AND class_name IN ('Cepheid', 'DSCT', 'RRL')\n      AND probability > 0.6\n) AS filtered_probs\nJOIN object o ON o.oid = filtered_probs.oid\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE p.class_name IN ('Cepheid', 'DSCT', 'RRL')\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.6\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to select object IDs with probability > 0.6 for any of the specified classes in the hierarchical_rf_1.1.0 classifier\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n      AND class_name IN ('Cepheid', 'DSCT', 'RRL')\n      AND probability > 0.6\n) AS filtered_probs\nJOIN object o ON o.oid = filtered_probs.oid\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE p.class_name IN ('Cepheid', 'DSCT', 'RRL')\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.6\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```"
                    }
                },
                "in_toks": 3371,
                "out_toks": 243,
                "id": "chatcmpl-Be0RmaPXXEHb9jb6XO3KiJFynZlQj",
                "created": 1748874538,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "86",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 835,
                "out_toks": 14,
                "id": "chatcmpl-BhLibUNEzNfarU7jDEC8y4s6OYM6G",
                "created": 1749671289,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to get object OIDs with probability > 0.6 for classes Cepheid, delta Scuti, or RR Lyrae\n    SELECT DISTINCT prob.oid\n    FROM probability prob\n    WHERE prob.class_name IN ('CEP', 'DSCT', 'RRL')\n      AND prob.classifier_name = 'lc_classifier'\n      AND prob.classifier_version = 'hierarchical_rf_1.1.0'\n      AND prob.probability > 0.6\n      AND prob.ranking = 1\n) AS filtered_oids\nJOIN probability p ON p.oid = filtered_oids.oid\nJOIN ps1_ztf ps ON ps.oid = filtered_oids.oid\nWHERE ps.sgscore1 > 0.8\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to get object OIDs with probability > 0.6 for classes Cepheid, delta Scuti, or RR Lyrae\n    SELECT DISTINCT prob.oid\n    FROM probability prob\n    WHERE prob.class_name IN ('CEP', 'DSCT', 'RRL')\n      AND prob.classifier_name = 'lc_classifier'\n      AND prob.classifier_version = 'hierarchical_rf_1.1.0'\n      AND prob.probability > 0.6\n      AND prob.ranking = 1\n) AS filtered_oids\nJOIN probability p ON p.oid = filtered_oids.oid\nJOIN ps1_ztf ps ON ps.oid = filtered_oids.oid\nWHERE ps.sgscore1 > 0.8\nLIMIT 100;\n```"
                },
                "in_toks": 3371,
                "out_toks": 193,
                "id": "chatcmpl-BhLmZFYGCJYafzPCuAY1JFTj7nqMZ",
                "created": 1749671535,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "86",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 835,
                "out_toks": 14,
                "id": "chatcmpl-BhLicw95OoWAXQqYfSdQHvCKcl5kx",
                "created": 1749671290,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to select object IDs with probability > 0.6 for Cepheid, Delta Scuti, or RR Lyrae in the specified classifier\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n      AND class_name IN ('CEP', 'DSCT', 'RRL')\n      AND probability > 0.6\n) AS sub\nJOIN object AS o ON o.oid = sub.oid\nJOIN probability AS p ON p.oid = o.oid\nJOIN ps1_ztf AS ps ON ps.oid = o.oid\nWHERE p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to select object IDs with probability > 0.6 for Cepheid, Delta Scuti, or RR Lyrae in the specified classifier\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n      AND class_name IN ('CEP', 'DSCT', 'RRL')\n      AND probability > 0.6\n) AS sub\nJOIN object AS o ON o.oid = sub.oid\nJOIN probability AS p ON p.oid = o.oid\nJOIN ps1_ztf AS ps ON ps.oid = o.oid\nWHERE p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```"
                },
                "in_toks": 3371,
                "out_toks": 238,
                "id": "chatcmpl-BhLmxbrZeXXdywWtf20FaJPqfOZlZ",
                "created": 1749671559,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "41": {
        "0": {
            "req_id": 41,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'xmatch', 'allwise']"
                    },
                    "1": {
                        "response": "['object', 'xmatch', 'allwise']"
                    }
                },
                "in_toks": 888,
                "out_toks": 22,
                "id": "chatcmpl-Be0QXm7awL3CNZ73pgkIdKZNxnOtH",
                "created": 1748874461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0/3600 AS r_deg -- 5 arcsec converted to degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600 -- 10 arcsec converted to degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_uncertainty\n    FROM input_objects io\n    JOIN allwise aw ON\n        q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_Mag\",\n    mag_uncertainty AS \"W1_Mag_Uncertainty\"\nFROM search_results;",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0/3600 AS r_deg -- 5 arcsec converted to degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600 -- 10 arcsec converted to degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_uncertainty\n    FROM input_objects io\n    JOIN allwise aw ON\n        q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_Mag\",\n    mag_uncertainty AS \"W1_Mag_Uncertainty\"\nFROM search_results;"
                    }
                },
                "in_toks": 3298,
                "out_toks": 270,
                "id": "chatcmpl-Be0Rm0Xvgd1FtIvWm334oJ6I8XGJM",
                "created": 1748874538,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 41,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'xmatch', 'allwise']"
                    },
                    "1": {
                        "response": "['object', 'xmatch', 'allwise']"
                    }
                },
                "in_toks": 888,
                "out_toks": 22,
                "id": "chatcmpl-Be0QXm7awL3CNZ73pgkIdKZNxnOtH",
                "created": 1748874461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0/3600 AS r_deg -- 5 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600 -- 10 arcsec in degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_uncertainty\n    FROM input_objects io\n    JOIN allwise aw ON q3c_join(aw.ra, aw.dec, io.ra, io.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_catalog_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_magnitude\",\n    mag_uncertainty AS \"W1_uncertainty\"\nFROM search_results;",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0/3600 AS r_deg -- 5 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600 -- 10 arcsec in degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_uncertainty\n    FROM input_objects io\n    JOIN allwise aw ON q3c_join(aw.ra, aw.dec, io.ra, io.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_catalog_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_magnitude\",\n    mag_uncertainty AS \"W1_uncertainty\"\nFROM search_results;"
                    }
                },
                "in_toks": 3298,
                "out_toks": 267,
                "id": "chatcmpl-Be0RmtCYrM3aXXxgYPnPOUXb8lpO7",
                "created": 1748874538,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "41",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 888,
                "out_toks": 11,
                "id": "chatcmpl-BhLieKqFhj1qMGliKOdyFKriCZbkL",
                "created": 1749671292,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0 / 3600 AS r_deg -- 5 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0 / 3600 -- 10 arcsec in degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_err_w1\n    FROM input_objects io\n    JOIN allwise aw\n        ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_Mag\",\n    mag_err_w1 AS \"W1_Mag_Error\"\nFROM search_results;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0 / 3600 AS r_deg -- 5 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0 / 3600 -- 10 arcsec in degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_err_w1\n    FROM input_objects io\n    JOIN allwise aw\n        ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_Mag\",\n    mag_err_w1 AS \"W1_Mag_Error\"\nFROM search_results;"
                },
                "in_toks": 3298,
                "out_toks": 269,
                "id": "chatcmpl-BhLn6lOEnfg20jgaLgJF9vq09hE2n",
                "created": 1749671568,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "41",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 888,
                "out_toks": 11,
                "id": "chatcmpl-BhLifl3vzzSZrkqy0ntqq3tRSW924",
                "created": 1749671293,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0/3600 AS r_deg -- 5 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600 -- 10 arcsec in degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_uncertainty\n    FROM input_objects io\n    JOIN allwise aw ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_catalog_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_magnitude\",\n    mag_uncertainty AS \"W1_magnitude_uncertainty\"\nFROM search_results;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0/3600 AS r_deg -- 5 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600 -- 10 arcsec in degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_uncertainty\n    FROM input_objects io\n    JOIN allwise aw ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_catalog_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_magnitude\",\n    mag_uncertainty AS \"W1_magnitude_uncertainty\"\nFROM search_results;"
                },
                "in_toks": 3298,
                "out_toks": 268,
                "id": "chatcmpl-BhLn60WGRLLt4JnKMWLHclEzUg6Yl",
                "created": 1749671568,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "74": {
        "0": {
            "req_id": 74,
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['ss_ztf']"
                    },
                    "1": {
                        "response": "['ss_ztf']"
                    }
                },
                "in_toks": 817,
                "out_toks": 12,
                "id": "chatcmpl-Be0QYHIgAuGXXX7VC1PIHSw9gV8vx",
                "created": 1748874462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a Common Table Expression (CTE) with the specified ZTF objects\nWITH ztf_ids AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n)\n-- Select relevant data from ss_ztf, joining with the ztf_ids CTE\nSELECT \n    ztf_ids.column2 AS ztf_object_id, -- ZTF identifier\n    sss.ssnamenr AS mpc_object_id,   -- MPC object identifier\n    sss.ssmagnr AS mpc_magnitude    -- MPC magnitude\nFROM \n    ztf_ids\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.column1 -- Match by ZTF object OID\nWHERE \n    sss.ssmagnr < 19.2 -- Brightness condition\nORDER BY \n    sss.ssmagnr DESC; -- Sort by magnitude descending\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a Common Table Expression (CTE) with the specified ZTF objects\nWITH ztf_ids AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n)\n-- Select relevant data from ss_ztf, joining with the ztf_ids CTE\nSELECT \n    ztf_ids.column2 AS ztf_object_id, -- ZTF identifier\n    sss.ssnamenr AS mpc_object_id,   -- MPC object identifier\n    sss.ssmagnr AS mpc_magnitude    -- MPC magnitude\nFROM \n    ztf_ids\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.column1 -- Match by ZTF object OID\nWHERE \n    sss.ssmagnr < 19.2 -- Brightness condition\nORDER BY \n    sss.ssmagnr DESC; -- Sort by magnitude descending\n```"
                },
                "in_toks": 1157,
                "out_toks": 233,
                "id": "chatcmpl-BhN0PVuIuPsHXiTqMNAE6x9D9LwiS",
                "created": 1749676237,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf, matching by object OID\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf, matching by object OID\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```"
                    }
                },
                "in_toks": 2107,
                "out_toks": 213,
                "id": "chatcmpl-Be0RngA5SmxjZcpiRObUMXMMiDXXg",
                "created": 1748874539,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 74,
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['ss_ztf']"
                    },
                    "1": {
                        "response": "['ss_ztf']"
                    }
                },
                "in_toks": 817,
                "out_toks": 12,
                "id": "chatcmpl-Be0QYHIgAuGXXX7VC1PIHSw9gV8vx",
                "created": 1748874462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_ids AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n)\n-- Select relevant data by joining with ss_ztf\nSELECT \n    ztf_ids.column2 AS ztf_object_id,        -- ZTF object identifier\n    ss.ssnamnr AS mpc_object_id,             -- MPC object identifier\n    ss.ssmagnr AS mpc_magnitude             -- MPC magnitude\nFROM \n    ztf_ids\nJOIN \n    ss_ztf ss ON ss.oid = ztf_ids.column1   -- Join on ZTF object OID\nWHERE \n    ss.ssmagnr < 19.2                        -- Brightness condition\nORDER BY \n    ss.ssmagnr DESC;                        -- Sort by magnitude descending\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_ids AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n)\n-- Select relevant data by joining with ss_ztf\nSELECT \n    ztf_ids.column2 AS ztf_object_id,        -- ZTF object identifier\n    ss.ssnamnr AS mpc_object_id,             -- MPC object identifier\n    ss.ssmagnr AS mpc_magnitude             -- MPC magnitude\nFROM \n    ztf_ids\nJOIN \n    ss_ztf ss ON ss.oid = ztf_ids.column1   -- Join on ZTF object OID\nWHERE \n    ss.ssmagnr < 19.2                        -- Brightness condition\nORDER BY \n    ss.ssmagnr DESC;                        -- Sort by magnitude descending\n```"
                },
                "in_toks": 1139,
                "out_toks": 219,
                "id": "chatcmpl-BhN0NKugkebTdF3XUNpgXSMrG1Ndm",
                "created": 1749676235,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf\nSELECT \n    ztf.ztf_identifier AS ztf_object_id,\n    ss.ssnamnr AS mpc_object_id,\n    ss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects ztf\nJOIN \n    ss_ztf ss ON ss.oid = ztf.ztf_oid\nWHERE \n    ss.ssmagnr < 19.2\nORDER BY \n    ss.ssmagnr DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf\nSELECT \n    ztf.ztf_identifier AS ztf_object_id,\n    ss.ssnamnr AS mpc_object_id,\n    ss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects ztf\nJOIN \n    ss_ztf ss ON ss.oid = ztf.ztf_oid\nWHERE \n    ss.ssmagnr < 19.2\nORDER BY \n    ss.ssmagnr DESC;\n```"
                    }
                },
                "in_toks": 2107,
                "out_toks": 204,
                "id": "chatcmpl-Be0RnotApdt4Se7EdgEnH7riHMGyh",
                "created": 1748874539,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "74",
            "experiment_id": "run_2",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 817,
                "out_toks": 6,
                "id": "chatcmpl-BhLigqdhGoUyjGr0u6p6HNqyjZTW6",
                "created": 1749671294,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary table with the specified ZTF objects using VALUES and aliasing correctly\nWITH ztf_objects (ztf_oid, ztf_identifier) AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n)\n\n-- Select ZTF object identifiers, corresponding MPC object IDs, and MPC magnitudes\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_objects.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF objects using VALUES and aliasing correctly\nWITH ztf_objects (ztf_oid, ztf_identifier) AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n)\n\n-- Select ZTF object identifiers, corresponding MPC object IDs, and MPC magnitudes\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_objects.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```"
                },
                "in_toks": 1157,
                "out_toks": 208,
                "id": "chatcmpl-BhN0KsZmbkA9k9FbpqEoc7mjWqXO9",
                "created": 1749676232,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf, matching by object OID\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf, matching by object OID\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```"
                },
                "in_toks": 2107,
                "out_toks": 213,
                "id": "chatcmpl-BhLn7mvJVdn5hM9CbLaOMCKOgdS6C",
                "created": 1749671569,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "74",
            "experiment_id": "run_3",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 817,
                "out_toks": 6,
                "id": "chatcmpl-BhLignjZzOxVzHBTwmdACeiHA9jhT",
                "created": 1749671294,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary table with the specified ZTF objects using VALUES and aliasing correctly\nWITH ztf_objects (ztf_oid, ztf_identifier) AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n)\n\n-- Select ZTF object identifiers, corresponding MPC object IDs, and MPC magnitudes\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_objects.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF objects using VALUES and aliasing correctly\nWITH ztf_objects (ztf_oid, ztf_identifier) AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n)\n\n-- Select ZTF object identifiers, corresponding MPC object IDs, and MPC magnitudes\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_objects.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```"
                },
                "in_toks": 1157,
                "out_toks": 208,
                "id": "chatcmpl-BhN0LxFXuuStEbmkcTlgnwfqN9EVJ",
                "created": 1749676233,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf, matching by object OID\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf, matching by object OID\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```"
                },
                "in_toks": 2107,
                "out_toks": 213,
                "id": "chatcmpl-BhLnE0unEWtaTjGeEVxgLT9QBzlWt",
                "created": 1749671576,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "97": {
        "0": {
            "req_id": 97,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 842,
                "out_toks": 14,
                "id": "chatcmpl-Be0QY3odIiFHuknHZrChWucTC1bnN",
                "created": 1748874462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4') AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p2.probability\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.class_name = 'LPV'\n           AND p2.classifier_name = 'lc_classifier') AS prob_lc_lpv\n    FROM object o\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn AS \"prob_stamp_agn\",\n    prob_lc_lpv AS \"prob_lc_lpv\"\nFROM selected_objects\nWHERE\n    prob_stamp_agn > 0.6\n    AND prob_lc_lpv > 0.7\nORDER BY prob_stamp_agn DESC, prob_lc_lpv DESC\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4') AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p2.probability\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.class_name = 'LPV'\n           AND p2.classifier_name = 'lc_classifier') AS prob_lc_lpv\n    FROM object o\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn AS \"prob_stamp_agn\",\n    prob_lc_lpv AS \"prob_lc_lpv\"\nFROM selected_objects\nWHERE\n    prob_stamp_agn > 0.6\n    AND prob_lc_lpv > 0.7\nORDER BY prob_stamp_agn DESC, prob_lc_lpv DESC\nLIMIT 50;\n```"
                    }
                },
                "in_toks": 2624,
                "out_toks": 273,
                "id": "chatcmpl-Be0Rn6p92t5upzRPQmGA57UUfjnN0",
                "created": 1748874539,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 97,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'probability']"
                    }
                },
                "in_toks": 842,
                "out_toks": 14,
                "id": "chatcmpl-Be0QY3odIiFHuknHZrChWucTC1bnN",
                "created": 1748874462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n         LIMIT 1) AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier'\n         LIMIT 1) AS prob_lc_lpv\n    FROM object o\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn,\n    prob_lc_lpv\nFROM selected_objects\nWHERE\n    prob_stamp_agn > 0.6\n    AND prob_lc_lpv > 0.7\nORDER BY prob_stamp_agn DESC\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n         LIMIT 1) AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier'\n         LIMIT 1) AS prob_lc_lpv\n    FROM object o\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn,\n    prob_lc_lpv\nFROM selected_objects\nWHERE\n    prob_stamp_agn > 0.6\n    AND prob_lc_lpv > 0.7\nORDER BY prob_stamp_agn DESC\nLIMIT 50;\n```"
                    }
                },
                "in_toks": 2624,
                "out_toks": 258,
                "id": "chatcmpl-Be0Ro44SpVDb4UjZDMczTaKJ9qFRc",
                "created": 1748874540,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "97",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 842,
                "out_toks": 7,
                "id": "chatcmpl-BhLigcEZOPaCqrFLvoF5xzQjlA8bY",
                "created": 1749671294,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n         LIMIT 1) AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier'\n         LIMIT 1) AS prob_lc_lpv\n    FROM object o\n    WHERE\n        -- Ensure the object has probabilities above the thresholds\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4') > 0.6\n        AND\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier') > 0.7\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn AS \"prob_stamp_agn\",\n    prob_lc_lpv AS \"prob_lc_lpv\"\nFROM selected_objects\nWHERE prob_stamp_agn IS NOT NULL AND prob_lc_lpv IS NOT NULL\nORDER BY prob_stamp_agn DESC, prob_lc_lpv DESC\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n         LIMIT 1) AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier'\n         LIMIT 1) AS prob_lc_lpv\n    FROM object o\n    WHERE\n        -- Ensure the object has probabilities above the thresholds\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4') > 0.6\n        AND\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier') > 0.7\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn AS \"prob_stamp_agn\",\n    prob_lc_lpv AS \"prob_lc_lpv\"\nFROM selected_objects\nWHERE prob_stamp_agn IS NOT NULL AND prob_lc_lpv IS NOT NULL\nORDER BY prob_stamp_agn DESC, prob_lc_lpv DESC\nLIMIT 50;\n```"
                },
                "in_toks": 2624,
                "out_toks": 403,
                "id": "chatcmpl-BhLlvy6ENoXy7qGLTDVsrdeTo18MH",
                "created": 1749671495,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "97",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 842,
                "out_toks": 7,
                "id": "chatcmpl-BhLihfj9UD7tE2GBK1nLQv9sFgyKn",
                "created": 1749671295,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n         LIMIT 1) AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier'\n         LIMIT 1) AS prob_lc_lpv\n    FROM object o\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn,\n    prob_lc_lpv\nFROM selected_objects\nWHERE\n    prob_stamp_agn > 0.6\n    AND prob_lc_lpv > 0.7\nORDER BY prob_stamp_agn DESC\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n         LIMIT 1) AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier'\n         LIMIT 1) AS prob_lc_lpv\n    FROM object o\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn,\n    prob_lc_lpv\nFROM selected_objects\nWHERE\n    prob_stamp_agn > 0.6\n    AND prob_lc_lpv > 0.7\nORDER BY prob_stamp_agn DESC\nLIMIT 50;\n```"
                },
                "in_toks": 2624,
                "out_toks": 258,
                "id": "chatcmpl-BhLlw0bQzbOYPkEzOB0oYNYA1t706",
                "created": 1749671496,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "66": {
        "0": {
            "req_id": 66,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'gaia_ztf']"
                    },
                    "1": {
                        "response": "['object', 'gaia_ztf']"
                    }
                },
                "in_toks": 770,
                "out_toks": 20,
                "id": "chatcmpl-Be0QZRhnvsLl6hQN9ZEl6UV0jiIV6",
                "created": 1748874463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object, including the distance, Gaia magnitude, and ZTF object ID\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT\n        g.oid AS ztf_oid,\n        q3c_dist(z.meanra, z.meandec, g.neargaia, 0) AS distance_deg,\n        g.maggaia\n    FROM\n        ztf_object z,\n        gaia_ztf g\n    ORDER BY\n        q3c_dist(z.meanra, z.meandec, g.neargaia, 0)\n    LIMIT 1\n)\nSELECT\n    ztf_oid,\n    distance_deg,\n    maggaia\nFROM\n    nearest_gaia;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object, including the distance, Gaia magnitude, and ZTF object ID\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT\n        g.oid AS ztf_oid,\n        q3c_dist(z.meanra, z.meandec, g.neargaia, 0) AS distance_deg,\n        g.maggaia\n    FROM\n        ztf_object z,\n        gaia_ztf g\n    ORDER BY\n        q3c_dist(z.meanra, z.meandec, g.neargaia, 0)\n    LIMIT 1\n)\nSELECT\n    ztf_oid,\n    distance_deg,\n    maggaia\nFROM\n    nearest_gaia;\n```"
                    }
                },
                "in_toks": 2584,
                "out_toks": 186,
                "id": "chatcmpl-Be0RpvOsxNWUQH9pvteAEQvBaFOpB",
                "created": 1748874541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 66,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'gaia_ztf']"
                    },
                    "1": {
                        "response": "['object', 'gaia_ztf']"
                    }
                },
                "in_toks": 770,
                "out_toks": 20,
                "id": "chatcmpl-Be0QZRhnvsLl6hQN9ZEl6UV0jiIV6",
                "created": 1748874463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object with the specified ID to get its meanra and meandec\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\n-- Find the nearest Gaia object based on angular distance\nnearest_gaia AS (\n    SELECT \n        g.oid AS ztf_oid,\n        g.candid,\n        g.neargaia,\n        g.maggaiabright,\n        -- Calculate angular distance using the provided Gaia source distance in arcseconds\n        g.neargaia AS distance_arcsec\n    FROM gaia_ztf g\n    CROSS JOIN ztf_object z\n    -- Order by the Gaia source distance to find the closest\n    ORDER BY g.neargaia\n    LIMIT 1\n)\n-- Select the ZTF object ID, the distance to the nearest Gaia source, and the Gaia magnitude\nSELECT \n    ztf_oid,\n    distance_arcsec AS distance,\n    maggaiabright AS mag_gaia\nFROM nearest_gaia;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object with the specified ID to get its meanra and meandec\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\n-- Find the nearest Gaia object based on angular distance\nnearest_gaia AS (\n    SELECT \n        g.oid AS ztf_oid,\n        g.candid,\n        g.neargaia,\n        g.maggaiabright,\n        -- Calculate angular distance using the provided Gaia source distance in arcseconds\n        g.neargaia AS distance_arcsec\n    FROM gaia_ztf g\n    CROSS JOIN ztf_object z\n    -- Order by the Gaia source distance to find the closest\n    ORDER BY g.neargaia\n    LIMIT 1\n)\n-- Select the ZTF object ID, the distance to the nearest Gaia source, and the Gaia magnitude\nSELECT \n    ztf_oid,\n    distance_arcsec AS distance,\n    maggaiabright AS mag_gaia\nFROM nearest_gaia;\n```"
                },
                "in_toks": 1614,
                "out_toks": 224,
                "id": "chatcmpl-BhN0PQyNu9HilYYEM4QUNC43ojYIh",
                "created": 1749676237,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT g.oid AS ztf_oid, g.candid, g.neargaia, g.maggaia,\n           q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance\n    FROM gaia_ztf g\n    CROSS JOIN ztf_object z\n    ORDER BY distance\n    LIMIT 1\n)\nSELECT ztf_oid, distance, magggaia\nFROM nearest_gaia;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT g.oid AS ztf_oid, g.candid, g.neargaia, g.maggaia,\n           q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance\n    FROM gaia_ztf g\n    CROSS JOIN ztf_object z\n    ORDER BY distance\n    LIMIT 1\n)\nSELECT ztf_oid, distance, magggaia\nFROM nearest_gaia;\n```"
                    }
                },
                "in_toks": 2584,
                "out_toks": 159,
                "id": "chatcmpl-Be0RqqAIxrOTrNtelr8aFiAEo9H05",
                "created": 1748874542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "66",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']"
                },
                "in_toks": 770,
                "out_toks": 10,
                "id": "chatcmpl-BhLijtA1TyH5SIZG6OsHz9u1KlAXC",
                "created": 1749671297,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\n-- Calculate the angular distance between the ZTF object and all Gaia sources\ngaia_distances AS (\n    SELECT \n        g.oid AS gaia_oid,\n        g.candid,\n        g.neargaia,\n        g.maggaia,\n        -- Use q3c_dist to compute the angular separation in degrees\n        q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n)\n-- Select the closest Gaia source based on the computed distance\nSELECT \n    gaia_oid AS gaia_object_id,\n    distance_deg AS distance_in_degrees,\n    maggaia AS Gaia_magnitude\nFROM gaia_distances\nORDER BY distance_deg\nLIMIT 1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\n-- Calculate the angular distance between the ZTF object and all Gaia sources\ngaia_distances AS (\n    SELECT \n        g.oid AS gaia_oid,\n        g.candid,\n        g.neargaia,\n        g.maggaia,\n        -- Use q3c_dist to compute the angular separation in degrees\n        q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n)\n-- Select the closest Gaia source based on the computed distance\nSELECT \n    gaia_oid AS gaia_object_id,\n    distance_deg AS distance_in_degrees,\n    maggaia AS Gaia_magnitude\nFROM gaia_distances\nORDER BY distance_deg\nLIMIT 1;\n```"
                },
                "in_toks": 1547,
                "out_toks": 228,
                "id": "chatcmpl-BhN0Lo9S5WwJWwGlewiUgOBnw65os",
                "created": 1749676233,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT g.oid AS ztf_oid, g.candid, g.neargaia, g.maggaia,\n           q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n    ORDER BY distance_deg\n    LIMIT 1\n)\nSELECT ztf_oid, distance_deg AS distance_in_degrees, maggaia AS Gaia_magnitude\nFROM nearest_gaia;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT g.oid AS ztf_oid, g.candid, g.neargaia, g.maggaia,\n           q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n    ORDER BY distance_deg\n    LIMIT 1\n)\nSELECT ztf_oid, distance_deg AS distance_in_degrees, maggaia AS Gaia_magnitude\nFROM nearest_gaia;\n```"
                },
                "in_toks": 2584,
                "out_toks": 172,
                "id": "chatcmpl-BhLlvx1BkazSo7LFIXrRYeOyVjnyk",
                "created": 1749671495,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "66",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']"
                },
                "in_toks": 770,
                "out_toks": 10,
                "id": "chatcmpl-BhLikyX7PcD6koFgk9oOPc2GcGc9u",
                "created": 1749671298,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\n-- Calculate the angular distance between the ZTF object and all Gaia objects\ngaia_distances AS (\n    SELECT \n        g.oid AS gaia_oid,\n        g.candid,\n        g.neargaia,\n        g.maggaia,\n        -- Use q3c_dist to compute the angular distance in degrees\n        q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n)\n-- Select the Gaia object with the minimum distance\nSELECT \n    gaia_oid AS ztf_oid,\n    distance_deg AS distance_in_degrees,\n    maggaia AS Gaia_magnitude\nFROM gaia_distances\nORDER BY distance_deg\nLIMIT 1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\n-- Calculate the angular distance between the ZTF object and all Gaia objects\ngaia_distances AS (\n    SELECT \n        g.oid AS gaia_oid,\n        g.candid,\n        g.neargaia,\n        g.maggaia,\n        -- Use q3c_dist to compute the angular distance in degrees\n        q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n)\n-- Select the Gaia object with the minimum distance\nSELECT \n    gaia_oid AS ztf_oid,\n    distance_deg AS distance_in_degrees,\n    maggaia AS Gaia_magnitude\nFROM gaia_distances\nORDER BY distance_deg\nLIMIT 1;\n```"
                },
                "in_toks": 1547,
                "out_toks": 225,
                "id": "chatcmpl-BhN0Kr1g5o1lMaZW6HmVoKwaXBqya",
                "created": 1749676232,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT g.oid AS ztf_oid, g.candid, g.neargaia, g.maggaia,\n           q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n    ORDER BY distance_deg\n    LIMIT 1\n)\nSELECT ztf_oid, distance_deg AS distance_in_degrees, maggaia AS Gaia_magnitude\nFROM nearest_gaia;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT g.oid AS ztf_oid, g.candid, g.neargaia, g.maggaia,\n           q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n    ORDER BY distance_deg\n    LIMIT 1\n)\nSELECT ztf_oid, distance_deg AS distance_in_degrees, maggaia AS Gaia_magnitude\nFROM nearest_gaia;\n```"
                },
                "in_toks": 2584,
                "out_toks": 172,
                "id": "chatcmpl-BhLlvrmtVzCesyHEvSrVd8D6jgtIi",
                "created": 1749671495,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "50": {
        "0": {
            "req_id": 50,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'feature', 'probability']"
                    }
                },
                "in_toks": 809,
                "out_toks": 20,
                "id": "chatcmpl-Be0Qa1FVYc77B6TTky4iruATnubWr",
                "created": 1748874464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifier, feature name, feature value, and filter identifier\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"value\",\n    f.fid AS \"filter identifier\"\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object identifier, feature name, feature value, and filter identifier\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"value\",\n    f.fid AS \"filter identifier\"\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```"
                    }
                },
                "in_toks": 5023,
                "out_toks": 130,
                "id": "chatcmpl-Be0RqIyaHsZljPSrqY75z29nr3WPq",
                "created": 1748874542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 50,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature', 'probability']"
                    },
                    "1": {
                        "response": "['object', 'feature', 'probability']"
                    }
                },
                "in_toks": 809,
                "out_toks": 20,
                "id": "chatcmpl-Be0Qa1FVYc77B6TTky4iruATnubWr",
                "created": 1748874464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifier, feature name, feature value, and filter identifier\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"value\",\n    f.fid AS \"filter identifier\"\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select object identifier, feature name, feature value, and filter identifier\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"value\",\n    f.fid AS \"filter identifier\"\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```"
                    }
                },
                "in_toks": 5023,
                "out_toks": 130,
                "id": "chatcmpl-Be0RqdHJMunMLrLapcuUs9uTdm5KR",
                "created": 1748874542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "50",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']"
                },
                "in_toks": 809,
                "out_toks": 10,
                "id": "chatcmpl-BhLilH5ZkM5ovQZtDtDX4PqCv2AZM",
                "created": 1749671299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve features for specified objects with version 'lc_classifier_1.2.1-P'\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\"\nFROM \n    feature f\nJOIN \n    object o ON f.oid = o.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve features for specified objects with version 'lc_classifier_1.2.1-P'\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\"\nFROM \n    feature f\nJOIN \n    object o ON f.oid = o.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```"
                },
                "in_toks": 5023,
                "out_toks": 131,
                "id": "chatcmpl-BhLlx4HTRGOumU4lo2nYDdjfrAeev",
                "created": 1749671497,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "50",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "feature",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'probability']"
                },
                "in_toks": 809,
                "out_toks": 10,
                "id": "chatcmpl-BhLilq9bgpKcz3XsTgWNw7RGFdDzO",
                "created": 1749671299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the specified features for the given objects with version 'lc_classifier_1.2.1-P'\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\"\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the specified features for the given objects with version 'lc_classifier_1.2.1-P'\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\"\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```"
                },
                "in_toks": 5023,
                "out_toks": 134,
                "id": "chatcmpl-BhLm3XQVhMhMz33xBefgTPCMFGd1L",
                "created": 1749671503,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "91": {
        "0": {
            "req_id": 91,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'feature']"
                    }
                },
                "in_toks": 813,
                "out_toks": 12,
                "id": "chatcmpl-Be0QaiYxtMcwu3zr4TbXLW3h4iynh",
                "created": 1748874464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-band difference magnitudes, W1-W2 color, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_max.value - f_r_max.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get the maximum g-r difference magnitude\nJOIN \n    feature f_g_r_max ON o.oid = f_g_r_max.oid \n    AND f_g_r_max.name = 'g-r_max' \n    AND f_g_r_max.fid = 13\n-- Join with feature table to get the maximum r-band magnitude\nJOIN \n    feature f_r_max ON o.oid = f_r_max.oid \n    AND f_r_max.name = 'max_mag' \n    AND f_r_max.fid = 2\n-- Join with feature table to get the W1-W2 color\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid \n    AND f_w1_w2.name = 'W1-W2' \n    AND f_w1_w2.fid = 1\n-- Filter for objects with W1-W2 color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit the result to 100 rows for performance\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-band difference magnitudes, W1-W2 color, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_max.value - f_r_max.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get the maximum g-r difference magnitude\nJOIN \n    feature f_g_r_max ON o.oid = f_g_r_max.oid \n    AND f_g_r_max.name = 'g-r_max' \n    AND f_g_r_max.fid = 13\n-- Join with feature table to get the maximum r-band magnitude\nJOIN \n    feature f_r_max ON o.oid = f_r_max.oid \n    AND f_r_max.name = 'max_mag' \n    AND f_r_max.fid = 2\n-- Join with feature table to get the W1-W2 color\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid \n    AND f_w1_w2.name = 'W1-W2' \n    AND f_w1_w2.fid = 1\n-- Filter for objects with W1-W2 color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit the result to 100 rows for performance\nLIMIT 100;\n```"
                },
                "in_toks": 4011,
                "out_toks": 329,
                "id": "chatcmpl-BhN0L08C6uV31jU1yrVMSWH0T17i5",
                "created": 1749676233,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-band difference magnitudes, W1-W2 color, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_min_g_r.value - f_r_band.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get the minimum g-r difference magnitude\nJOIN \n    feature f_min_g_r ON o.oid = f_min_g_r.oid AND f_min_g_r.name = 'g-r_max' AND f_min_g_r.fid = 13\n-- Join with feature table to get the r-band difference magnitude\nJOIN \n    feature f_r_band ON o.oid = f_r_band.oid AND f_r_band.name = 'g-r_max' AND f_r_band.fid = 2\n-- Join with feature table to get the W1-W2 color\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2' AND f_w1_w2.fid = 1\nWHERE \n    f_w1_w2.value < 1\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-band difference magnitudes, W1-W2 color, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_min_g_r.value - f_r_band.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get the minimum g-r difference magnitude\nJOIN \n    feature f_min_g_r ON o.oid = f_min_g_r.oid AND f_min_g_r.name = 'g-r_max' AND f_min_g_r.fid = 13\n-- Join with feature table to get the r-band difference magnitude\nJOIN \n    feature f_r_band ON o.oid = f_r_band.oid AND f_r_band.name = 'g-r_max' AND f_r_band.fid = 2\n-- Join with feature table to get the W1-W2 color\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2' AND f_w1_w2.fid = 1\nWHERE \n    f_w1_w2.value < 1\nLIMIT 100;\n```"
                    }
                },
                "in_toks": 4843,
                "out_toks": 292,
                "id": "chatcmpl-Be0RqXaBU6J1aFbihdASEcaMlt8mD",
                "created": 1748874542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 91,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'feature']"
                    },
                    "1": {
                        "response": "['object', 'feature']"
                    }
                },
                "in_toks": 813,
                "out_toks": 12,
                "id": "chatcmpl-Be0QaiYxtMcwu3zr4TbXLW3h4iynh",
                "created": 1748874464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 color, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_min_g_r.value - f_min_r_g.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Subquery to get the minimum g-r difference magnitude feature\nJOIN \n    feature f_min_g_r ON o.oid = f_min_g_r.oid AND f_min_g_r.name = 'g-r_max'\nJOIN \n    feature f_min_r_g ON o.oid = f_min_r_g.oid AND f_min_r_g.name = 'r-W2'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\nWHERE \n    -- Filter objects where W1-W2 color is less than 1\n    f_w1_w2.value < 1\n-- Limit the result to at most 100 rows\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 color, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_min_g_r.value - f_min_r_g.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Subquery to get the minimum g-r difference magnitude feature\nJOIN \n    feature f_min_g_r ON o.oid = f_min_g_r.oid AND f_min_g_r.name = 'g-r_max'\nJOIN \n    feature f_min_r_g ON o.oid = f_min_r_g.oid AND f_min_r_g.name = 'r-W2'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\nWHERE \n    -- Filter objects where W1-W2 color is less than 1\n    f_w1_w2.value < 1\n-- Limit the result to at most 100 rows\nLIMIT 100;\n```"
                    }
                },
                "in_toks": 4843,
                "out_toks": 261,
                "id": "chatcmpl-Be0RrGssgDQobAq3W33YZ09MzesDg",
                "created": 1748874543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "91",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 813,
                "out_toks": 6,
                "id": "chatcmpl-BhLim05qaYLZI04uSlnxwkX1lXgP1",
                "created": 1749671300,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r-g_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 feature value less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r-g_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 feature value less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```"
                },
                "in_toks": 3956,
                "out_toks": 265,
                "id": "chatcmpl-BhN0P408xNBC2uRMh3ixVZKeTXG4L",
                "created": 1749676237,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 feature value less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 feature value less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```"
                },
                "in_toks": 4843,
                "out_toks": 264,
                "id": "chatcmpl-BhLm36VzirqXf3qzbpi3WLOT3xC5S",
                "created": 1749671503,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "91",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 813,
                "out_toks": 6,
                "id": "chatcmpl-BhLinJnGHBKkdx173borCDc2X2ol2",
                "created": 1749671301,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r-g_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r-g_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```"
                },
                "in_toks": 3954,
                "out_toks": 264,
                "id": "chatcmpl-BhN0Mf9UwuaVnqDN7w2bZeVWpWRQD",
                "created": 1749676234,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```"
                },
                "in_toks": 4843,
                "out_toks": 263,
                "id": "chatcmpl-BhLmBjfUzwj720x679bAVrQpq7SAH",
                "created": 1749671511,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "68": {
        "0": {
            "req_id": 68,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'ps1_ztf']"
                    },
                    "1": {
                        "response": "['object', 'ps1_ztf']"
                    }
                },
                "in_toks": 784,
                "out_toks": 20,
                "id": "chatcmpl-Be0QbV3EprNrlfNl9aItwbZTiAMZ2",
                "created": 1748874465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.oid,\n        p.candid,\n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        p.distpsnr1\n    FROM ps1_ztf p\n    JOIN ztf_object z ON q3c_dist(z.meanra, z.meandec, p.sgmag1, p.srmag1) = (\n        SELECT MIN(q3c_dist(z.meanra, z.meandec, p2.sgmag1, p2.srmag1))\n        FROM ps1_ztf p2\n        WHERE p2.oid = z.oid\n    )\n    WHERE p.oid = 'ZTF21abfrbnm'\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distpsnr1 AS distance_arcsec\nFROM nearest_ps1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.oid,\n        p.candid,\n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        p.distpsnr1\n    FROM ps1_ztf p\n    JOIN ztf_object z ON q3c_dist(z.meanra, z.meandec, p.sgmag1, p.srmag1) = (\n        SELECT MIN(q3c_dist(z.meanra, z.meandec, p2.sgmag1, p2.srmag1))\n        FROM ps1_ztf p2\n        WHERE p2.oid = z.oid\n    )\n    WHERE p.oid = 'ZTF21abfrbnm'\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distpsnr1 AS distance_arcsec\nFROM nearest_ps1;\n```"
                    }
                },
                "in_toks": 3136,
                "out_toks": 266,
                "id": "chatcmpl-Be0Rrpf1e5C0fmMuSrEbOGhv0EVnT",
                "created": 1748874543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 68,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'ps1_ztf']"
                    },
                    "1": {
                        "response": "['object', 'ps1_ztf']"
                    }
                },
                "in_toks": 784,
                "out_toks": 20,
                "id": "chatcmpl-Be0QbV3EprNrlfNl9aItwbZTiAMZ2",
                "created": 1748874465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        -- Calculate angular distance between the ZTF object and PS1 source\n        -- Using the haversine formula or similar approximation for small angles\n        -- Since the schema does not specify a function, we compute the angular separation manually\n        -- Convert degrees to radians for calculation\n        (\n            -- Difference in RA in radians\n            radians(p.objectidps1) - radians(o.meanra)\n        ) AS delta_ra_rad,\n        (\n            -- Difference in Dec in radians\n            radians(p.objectidps1) - radians(o.meandec)\n        ) AS delta_dec_rad,\n        -- Approximate angular distance in radians\n        sqrt(\n            power(sin((radians(p.objectidps1) - radians(o.meanra)) / 2), 2) +\n            cos(radians(o.meanra)) * cos(radians(p.objectidps1)) *\n            power(sin((radians(p.objectidps1) - radians(o.meandec)) / 2), 2)\n        ) AS distance_rad\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        -- Order by the calculated angular distance\n        sqrt(\n            power(sin((radians(p.objectidps1) - radians(o.meanra)) / 2), 2) +\n            cos(radians(o.meanra)) * cos(radians(p.objectidps1)) *\n            power(sin((radians(p.objectidps1) - radians(o.meandec)) / 2), 2)\n        )\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    -- Convert distance from radians to degrees\n    degrees(distance_rad) AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        -- Calculate angular distance between the ZTF object and PS1 source\n        -- Using the haversine formula or similar approximation for small angles\n        -- Since the schema does not specify a function, we compute the angular separation manually\n        -- Convert degrees to radians for calculation\n        (\n            -- Difference in RA in radians\n            radians(p.objectidps1) - radians(o.meanra)\n        ) AS delta_ra_rad,\n        (\n            -- Difference in Dec in radians\n            radians(p.objectidps1) - radians(o.meandec)\n        ) AS delta_dec_rad,\n        -- Approximate angular distance in radians\n        sqrt(\n            power(sin((radians(p.objectidps1) - radians(o.meanra)) / 2), 2) +\n            cos(radians(o.meanra)) * cos(radians(p.objectidps1)) *\n            power(sin((radians(p.objectidps1) - radians(o.meandec)) / 2), 2)\n        ) AS distance_rad\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        -- Order by the calculated angular distance\n        sqrt(\n            power(sin((radians(p.objectidps1) - radians(o.meanra)) / 2), 2) +\n            cos(radians(o.meanra)) * cos(radians(p.objectidps1)) *\n            power(sin((radians(p.objectidps1) - radians(o.meandec)) / 2), 2)\n        )\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    -- Convert distance from radians to degrees\n    degrees(distance_rad) AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```"
                },
                "in_toks": 2240,
                "out_toks": 472,
                "id": "chatcmpl-BhN0P0DOYWPATgTuRKBV2yfPpL9AN",
                "created": 1749676237,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec)\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec)\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```"
                    }
                },
                "in_toks": 3136,
                "out_toks": 207,
                "id": "chatcmpl-Be0Rr6l6sptdU5JVviecn5HPVo3o8",
                "created": 1748874543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "68",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']"
                },
                "in_toks": 784,
                "out_toks": 10,
                "id": "chatcmpl-BhLioanWcO9S3FkmkxlNhLiPmktoF",
                "created": 1749671302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        -- Calculate angular distance using the haversine formula or similar approximation\n        -- Since the schema does not specify a function like q3c_dist, we compute the distance manually\n        -- Convert degrees to radians for calculation\n        6371 * acos(\n            cos(radians(o.meanra)) * cos(radians(p.objectidps1)) * cos(radians(p.objectidps1) - radians(o.meandec))\n            + sin(radians(o.meanra)) * sin(radians(p.objectidps1))\n        ) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        -- Order by the calculated distance to find the nearest source\n        6371 * acos(\n            cos(radians(o.meanra)) * cos(radians(p.objectidps1)) * cos(radians(p.objectidps1) - radians(o.meandec))\n            + sin(radians(o.meanra)) * sin(radians(p.objectidps1))\n        )\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        -- Calculate angular distance using the haversine formula or similar approximation\n        -- Since the schema does not specify a function like q3c_dist, we compute the distance manually\n        -- Convert degrees to radians for calculation\n        6371 * acos(\n            cos(radians(o.meanra)) * cos(radians(p.objectidps1)) * cos(radians(p.objectidps1) - radians(o.meandec))\n            + sin(radians(o.meanra)) * sin(radians(p.objectidps1))\n        ) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        -- Order by the calculated distance to find the nearest source\n        6371 * acos(\n            cos(radians(o.meanra)) * cos(radians(p.objectidps1)) * cos(radians(p.objectidps1) - radians(o.meandec))\n            + sin(radians(o.meanra)) * sin(radians(p.objectidps1))\n        )\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```"
                },
                "in_toks": 2240,
                "out_toks": 352,
                "id": "chatcmpl-BhN0Re6OuYC2DBZGKVJiM8sWlkJTE",
                "created": 1749676239,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec)\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec)\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```"
                },
                "in_toks": 3136,
                "out_toks": 207,
                "id": "chatcmpl-BhLmCFZN6gHWD5J9LbCS9STSQJeB8",
                "created": 1749671512,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "68",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']"
                },
                "in_toks": 784,
                "out_toks": 10,
                "id": "chatcmpl-BhLioX0RIPc0wViDXPYCNRZownkcV",
                "created": 1749671302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the PS1 source information for the closest source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        -- Calculate angular distance using the haversine formula or similar approximation\n        -- Since the schema does not specify a function, we compute the distance manually\n        -- Convert degrees to radians for calculation\n        (\n            acos(\n                sin(radians(o.meanra)) * sin(radians(p.objectidps1)) +\n                cos(radians(o.meanra)) * cos(radians(p.objectidps1)) * cos(radians(o.meandec) - radians(p.sgmag1))\n            )\n        ) AS distance_rad\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        -- Order by the calculated angular distance\n        distance_rad\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    -- Convert distance from radians to degrees\n    degrees(distance_rad) AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the PS1 source information for the closest source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        -- Calculate angular distance using the haversine formula or similar approximation\n        -- Since the schema does not specify a function, we compute the distance manually\n        -- Convert degrees to radians for calculation\n        (\n            acos(\n                sin(radians(o.meanra)) * sin(radians(p.objectidps1)) +\n                cos(radians(o.meanra)) * cos(radians(p.objectidps1)) * cos(radians(o.meandec) - radians(p.sgmag1))\n            )\n        ) AS distance_rad\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        -- Order by the calculated angular distance\n        distance_rad\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    -- Convert distance from radians to degrees\n    degrees(distance_rad) AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```"
                },
                "in_toks": 2236,
                "out_toks": 292,
                "id": "chatcmpl-BhN0M2n29fOS11w2hLOyqPkfpuENP",
                "created": 1749676234,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the PS1 source information for the closest source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec)\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the PS1 source information for the closest source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec)\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```"
                },
                "in_toks": 3136,
                "out_toks": 205,
                "id": "chatcmpl-BhLmFRuCfCi2lXj4ra1yRMdfRuX95",
                "created": 1749671515,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "60": {
        "0": {
            "req_id": 60,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'magstat']"
                    },
                    "1": {
                        "response": "['object', 'magstat']"
                    }
                },
                "in_toks": 812,
                "out_toks": 14,
                "id": "chatcmpl-Be0QcIKjpdkW88O9ZmaxWTde6uKUO",
                "created": 1748874466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```"
                    }
                },
                "in_toks": 3127,
                "out_toks": 125,
                "id": "chatcmpl-Be0RrC07liIWrVRABodHthNBSk65o",
                "created": 1748874543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 60,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'magstat']"
                    },
                    "1": {
                        "response": "['object', 'magstat']"
                    }
                },
                "in_toks": 812,
                "out_toks": 14,
                "id": "chatcmpl-Be0QcIKjpdkW88O9ZmaxWTde6uKUO",
                "created": 1748874466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the ZTF identifier, number of detections, initial rise estimate, and first difference magnitude\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select the ZTF identifier, number of detections, initial rise estimate, and first difference magnitude\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```"
                    }
                },
                "in_toks": 3127,
                "out_toks": 146,
                "id": "chatcmpl-Be0RsAO8zNel0hyOxmN3ifENBYm1a",
                "created": 1748874544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "60",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']"
                },
                "in_toks": 812,
                "out_toks": 7,
                "id": "chatcmpl-BhLipHrLeKzudg1WCxevD7U4LhFQH",
                "created": 1749671303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```"
                },
                "in_toks": 3127,
                "out_toks": 125,
                "id": "chatcmpl-BhLmfym4GJobSU2Sm3JAS4q8C2sFu",
                "created": 1749671541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "60",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'magstat']"
                },
                "in_toks": 812,
                "out_toks": 7,
                "id": "chatcmpl-BhLipavnRLOxmiwA20dwdA8ZxsPSK",
                "created": 1749671303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```"
                },
                "in_toks": 3127,
                "out_toks": 125,
                "id": "chatcmpl-BhLmoYS4l8cW61yjQvXKciI2ntbaI",
                "created": 1749671550,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "76": {
        "0": {
            "req_id": 76,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "ss_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'ss_ztf', 'xmatch']"
                    },
                    "1": {
                        "response": "['object', 'ss_ztf', 'xmatch']"
                    }
                },
                "in_toks": 796,
                "out_toks": 26,
                "id": "chatcmpl-Be0Qdfj5mdcHNz1rZGNc8MVrabLYO",
                "created": 1748874467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query to find ZTF objects within 1.5 arcsec of the MPC object '115185'\nWITH mpc_object AS (\n    SELECT \n        ssmagnr, -- magnitude of the MPC object\n        meanra,  -- right ascension of the MPC object\n        meandec  -- declination of the MPC object\n    FROM ss_ztf\n    WHERE oid = '115185'\n)\nSELECT \n    o.oid AS ztf_object_id,\n    o.g_r_max AS mpc_magnitude,\n    -- Calculate angular distance between ZTF object and MPC object using q3c_dist\n    q3c_dist(o.meanra, o.meandec, c.meanra, c.meandec) AS distance_arcsec\nFROM \n    object o,\n    mpc_object c\nWHERE \n    -- Filter ZTF objects within 1.5 arcsec of the MPC object\n    q3c_join(o.meanra, o.meandec, c.meanra, c.meandec, 1.5/3600)\nORDER BY \n    distance_arcsec;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query to find ZTF objects within 1.5 arcsec of the MPC object '115185'\nWITH mpc_object AS (\n    SELECT \n        ssmagnr, -- magnitude of the MPC object\n        meanra,  -- right ascension of the MPC object\n        meandec  -- declination of the MPC object\n    FROM ss_ztf\n    WHERE oid = '115185'\n)\nSELECT \n    o.oid AS ztf_object_id,\n    o.g_r_max AS mpc_magnitude,\n    -- Calculate angular distance between ZTF object and MPC object using q3c_dist\n    q3c_dist(o.meanra, o.meandec, c.meanra, c.meandec) AS distance_arcsec\nFROM \n    object o,\n    mpc_object c\nWHERE \n    -- Filter ZTF objects within 1.5 arcsec of the MPC object\n    q3c_join(o.meanra, o.meandec, c.meanra, c.meandec, 1.5/3600)\nORDER BY \n    distance_arcsec;"
                },
                "in_toks": 1582,
                "out_toks": 230,
                "id": "chatcmpl-BhN0SaS7Y1dcN8GSMF9w5ZwrxTuLI",
                "created": 1749676240,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH mpc_object AS (\n    SELECT oid, ssmagnr\n    FROM ss_ztf\n    WHERE oid = '115185'\n)\nSELECT \n    o.oid AS ztf_object_id,\n    o.g_r_max AS mpc_magnitude,\n    q3c_dist(o.meanra, o.meandec, c.ra, c.dec) AS distance_arcsec\nFROM \n    object o,\n    (SELECT ra, dec FROM mpc_object) c\nWHERE \n    q3c_join(o.meanra, o.meandec, c.ra, c.dec, 1.5/3600) -- 1.5 arcsec converted to degrees\nORDER BY \n    distance_arcsec;",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "WITH mpc_object AS (\n    SELECT oid, ssmagnr\n    FROM ss_ztf\n    WHERE oid = '115185'\n)\nSELECT \n    o.oid AS ztf_object_id,\n    o.g_r_max AS mpc_magnitude,\n    q3c_dist(o.meanra, o.meandec, c.ra, c.dec) AS distance_arcsec\nFROM \n    object o,\n    (SELECT ra, dec FROM mpc_object) c\nWHERE \n    q3c_join(o.meanra, o.meandec, c.ra, c.dec, 1.5/3600) -- 1.5 arcsec converted to degrees\nORDER BY \n    distance_arcsec;"
                    }
                },
                "in_toks": 2669,
                "out_toks": 147,
                "id": "chatcmpl-Be0RsgDJT5ApwmwBFKooAm5hbN3KR",
                "created": 1748874544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": 76,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "ss_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'ss_ztf', 'xmatch']"
                    },
                    "1": {
                        "response": "['object', 'ss_ztf', 'xmatch']"
                    }
                },
                "in_toks": 796,
                "out_toks": 26,
                "id": "chatcmpl-Be0Qdfj5mdcHNz1rZGNc8MVrabLYO",
                "created": 1748874467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query to find ZTF objects within 1.5 arcsec of the MPC object '115185'\nWITH mpc_object AS (\n    SELECT \n        ssmagnr, -- magnitude of the MPC object\n        meanra,  -- right ascension of the MPC object\n        meandec  -- declination of the MPC object\n    FROM ss_ztf\n    WHERE oid = '115185'\n)\nSELECT \n    o.oid AS ztf_object_id,\n    o.g_r_max AS mpc_magnitude,\n    -- Calculate angular distance between ZTF object and MPC object using q3c_dist\n    q3c_dist(o.meanra, o.meandec, c.meanra, c.meandec) AS distance_arcsec\nFROM \n    object o,\n    mpc_object c\nWHERE \n    -- Filter ZTF objects within 1.5 arcsec of the MPC object\n    q3c_join(o.meanra, o.meandec, c.meanra, c.meandec, 1.5/3600)\nORDER BY \n    distance_arcsec;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query to find ZTF objects within 1.5 arcsec of the MPC object '115185'\nWITH mpc_object AS (\n    SELECT \n        ssmagnr, -- magnitude of the MPC object\n        meanra,  -- right ascension of the MPC object\n        meandec  -- declination of the MPC object\n    FROM ss_ztf\n    WHERE oid = '115185'\n)\nSELECT \n    o.oid AS ztf_object_id,\n    o.g_r_max AS mpc_magnitude,\n    -- Calculate angular distance between ZTF object and MPC object using q3c_dist\n    q3c_dist(o.meanra, o.meandec, c.meanra, c.meandec) AS distance_arcsec\nFROM \n    object o,\n    mpc_object c\nWHERE \n    -- Filter ZTF objects within 1.5 arcsec of the MPC object\n    q3c_join(o.meanra, o.meandec, c.meanra, c.meandec, 1.5/3600)\nORDER BY \n    distance_arcsec;"
                },
                "in_toks": 1582,
                "out_toks": 230,
                "id": "chatcmpl-BhN0OHHWNjuLBiY1wbuWhniI1wDDt",
                "created": 1749676236,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH mpc_object AS (\n    SELECT oid, ssmagnr\n    FROM ss_ztf\n    WHERE oid = '115185'\n)\nSELECT \n    o.oid AS ztf_object_id,\n    o.g_r_max AS mpc_magnitude,\n    q3c_dist(o.meanra, o.meandec, c.ra, c.dec) AS distance_arcsec\nFROM \n    object o,\n    (SELECT ra, dec FROM mpc_object) c\nWHERE \n    q3c_join(o.meanra, o.meandec, c.ra, c.dec, 1.5/3600) -- 1.5 arcsec converted to degrees\nORDER BY \n    distance_arcsec;",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "WITH mpc_object AS (\n    SELECT oid, ssmagnr\n    FROM ss_ztf\n    WHERE oid = '115185'\n)\nSELECT \n    o.oid AS ztf_object_id,\n    o.g_r_max AS mpc_magnitude,\n    q3c_dist(o.meanra, o.meandec, c.ra, c.dec) AS distance_arcsec\nFROM \n    object o,\n    (SELECT ra, dec FROM mpc_object) c\nWHERE \n    q3c_join(o.meanra, o.meandec, c.ra, c.dec, 1.5/3600) -- 1.5 arcsec converted to degrees\nORDER BY \n    distance_arcsec;"
                    }
                },
                "in_toks": 2669,
                "out_toks": 147,
                "id": "chatcmpl-Be0RsnE6xSkl2xZ0MxRBRAH14TP6E",
                "created": 1748874544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "76",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "ss_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf', 'xmatch']"
                },
                "in_toks": 796,
                "out_toks": 13,
                "id": "chatcmpl-BhLiqqX84vO5xcbKSTjB2lT0lKrMz",
                "created": 1749671304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the object for the Solar System object with oid '115185' from ss_ztf\nWITH mpc_object AS (\n    SELECT oid, ssmagnr, meanra, meandec\n    FROM ss_ztf\n    WHERE oid = '115185'\n),\n-- Select all ZTF objects that are within 1.5 arcsec of the MPC object\nzft_objects_with_distance AS (\n    SELECT \n        o.oid AS ztf_oid,\n        o.meanra,\n        o.meandec,\n        -- Calculate the angular distance in degrees between the object and the MPC object\n        q3c_dist(o.meanra, o.meandec, m.meanra, m.meandec) AS distance_deg\n    FROM object o\n    CROSS JOIN mpc_object m\n    -- Filter objects within 1.5 arcsec (convert arcsec to degrees: 1.5/3600)\n    WHERE q3c_dist(o.meanra, o.meandec, m.meanra, m.meandec) <= (1.5/3600)\n)\n-- Select the ZTF object ID, MPC magnitude, and distance, ordered by distance\nSELECT \n    ztf_oid,\n    ssmagnr,\n    -- Convert distance from degrees to arcseconds for clarity\n    q3c_dist(meanra, meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object)) * 3600 AS distance_arcsec\nFROM zft_objects_with_distance\nJOIN ss_ztf ON ss_ztf.oid = ztf_oid\nORDER BY distance_arcsec;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the object for the Solar System object with oid '115185' from ss_ztf\nWITH mpc_object AS (\n    SELECT oid, ssmagnr, meanra, meandec\n    FROM ss_ztf\n    WHERE oid = '115185'\n),\n-- Select all ZTF objects that are within 1.5 arcsec of the MPC object\nzft_objects_with_distance AS (\n    SELECT \n        o.oid AS ztf_oid,\n        o.meanra,\n        o.meandec,\n        -- Calculate the angular distance in degrees between the object and the MPC object\n        q3c_dist(o.meanra, o.meandec, m.meanra, m.meandec) AS distance_deg\n    FROM object o\n    CROSS JOIN mpc_object m\n    -- Filter objects within 1.5 arcsec (convert arcsec to degrees: 1.5/3600)\n    WHERE q3c_dist(o.meanra, o.meandec, m.meanra, m.meandec) <= (1.5/3600)\n)\n-- Select the ZTF object ID, MPC magnitude, and distance, ordered by distance\nSELECT \n    ztf_oid,\n    ssmagnr,\n    -- Convert distance from degrees to arcseconds for clarity\n    q3c_dist(meanra, meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object)) * 3600 AS distance_arcsec\nFROM zft_objects_with_distance\nJOIN ss_ztf ON ss_ztf.oid = ztf_oid\nORDER BY distance_arcsec;\n```"
                },
                "in_toks": 1790,
                "out_toks": 342,
                "id": "chatcmpl-BhN0QN309aydGJf1c3X2SWXM3n1ga",
                "created": 1749676238,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH mpc_object AS (\n    SELECT oid, ssmagnr\n    FROM ss_ztf\n    WHERE oid = '115185'\n),\nztf_objects AS (\n    SELECT o.oid AS ztf_oid, o.meanra, o.meandec\n    FROM object o\n    JOIN mpc_object m ON q3c_join(o.meanra, o.meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object), 1.5/3600)\n)\nSELECT ztf_oid, ssmagnr, q3c_dist(meanra, meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object)) AS distance_deg\nFROM ztf_objects\nJOIN ss_ztf ON ss_ztf.oid = ztf_objects.oid\nWHERE q3c_join(meanra, meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object), 1.5/3600)\nORDER BY distance_deg;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH mpc_object AS (\n    SELECT oid, ssmagnr\n    FROM ss_ztf\n    WHERE oid = '115185'\n),\nztf_objects AS (\n    SELECT o.oid AS ztf_oid, o.meanra, o.meandec\n    FROM object o\n    JOIN mpc_object m ON q3c_join(o.meanra, o.meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object), 1.5/3600)\n)\nSELECT ztf_oid, ssmagnr, q3c_dist(meanra, meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object)) AS distance_deg\nFROM ztf_objects\nJOIN ss_ztf ON ss_ztf.oid = ztf_objects.oid\nWHERE q3c_join(meanra, meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object), 1.5/3600)\nORDER BY distance_deg;\n```"
                },
                "in_toks": 2669,
                "out_toks": 224,
                "id": "chatcmpl-BhLms5jPDeilBzy9aX8NX03RRO22Z",
                "created": 1749671554,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "76",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "ss_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf', 'xmatch']"
                },
                "in_toks": 796,
                "out_toks": 13,
                "id": "chatcmpl-BhLirvG41ng4jkmZfPWJNCBEYx33H",
                "created": 1749671305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary table with the MPC object coordinates for '115185'\nWITH mpc_object AS (\n    SELECT \n        ssmagnr AS ra,        -- Use ssmagnr as RA (Right Ascension)\n        ssnamenr AS dec       -- Use ssnamenr as Dec (Declination)\n    FROM ss_ztf\n    WHERE oid = '115185'\n    LIMIT 1\n),\n-- Select ZTF objects within 1.5 arcsec of the MPC object\nztf_near_mpc AS (\n    SELECT \n        o.oid AS ztf_id,\n        s.ssmagnr AS mpc_magnitude,\n        -- Calculate angular distance in degrees between object and MPC object\n        q3c_dist(o.meanra, o.meandec, m.ra, m.dec) AS distance_deg\n    FROM \n        object o\n        CROSS JOIN mpc_object m\n        JOIN ss_ztf s ON s.oid = o.oid\n    WHERE \n        -- Filter objects within 1.5 arcsec (convert to degrees)\n        q3c_dist(o.meanra, o.meandec, m.ra, m.dec) <= 1.5 / 3600.0\n)\n-- Select and sort by distance in arcseconds\nSELECT \n    ztf_id,\n    mpc_magnitude,\n    distance_deg * 3600 AS distance_arcsec -- convert degrees to arcseconds\nFROM \n    ztf_near_mpc\nORDER BY \n    distance_deg;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the MPC object coordinates for '115185'\nWITH mpc_object AS (\n    SELECT \n        ssmagnr AS ra,        -- Use ssmagnr as RA (Right Ascension)\n        ssnamenr AS dec       -- Use ssnamenr as Dec (Declination)\n    FROM ss_ztf\n    WHERE oid = '115185'\n    LIMIT 1\n),\n-- Select ZTF objects within 1.5 arcsec of the MPC object\nztf_near_mpc AS (\n    SELECT \n        o.oid AS ztf_id,\n        s.ssmagnr AS mpc_magnitude,\n        -- Calculate angular distance in degrees between object and MPC object\n        q3c_dist(o.meanra, o.meandec, m.ra, m.dec) AS distance_deg\n    FROM \n        object o\n        CROSS JOIN mpc_object m\n        JOIN ss_ztf s ON s.oid = o.oid\n    WHERE \n        -- Filter objects within 1.5 arcsec (convert to degrees)\n        q3c_dist(o.meanra, o.meandec, m.ra, m.dec) <= 1.5 / 3600.0\n)\n-- Select and sort by distance in arcseconds\nSELECT \n    ztf_id,\n    mpc_magnitude,\n    distance_deg * 3600 AS distance_arcsec -- convert degrees to arcseconds\nFROM \n    ztf_near_mpc\nORDER BY \n    distance_deg;\n```"
                },
                "in_toks": 1785,
                "out_toks": 316,
                "id": "chatcmpl-BhN0QodCdIeJGQwgm8jc28UhYDnGX",
                "created": 1749676238,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the MPC object coordinates for '115185'\nWITH mpc_object AS (\n    SELECT ra, dec\n    FROM xmatch\n    WHERE oid_catalog = '115185'\n    LIMIT 1\n),\n-- Select ZTF objects within 1.5 arcsec of the MPC object\nztf_near_mpc AS (\n    SELECT \n        o.oid AS ztf_id,\n        s.ssmagnr AS mpc_magnitude,\n        q3c_dist(o.meanra, o.meandec, m.ra, m.dec) AS distance_deg\n    FROM \n        object o,\n        mpc_object m,\n        ss_ztf s\n    WHERE \n        q3c_join(o.meanra, o.meandec, m.ra, m.dec, 1.5/3600.0) -- 1.5 arcsec converted to degrees\n        AND s.oid = o.oid\n)\n-- Select and sort by distance\nSELECT \n    ztf_id,\n    mpc_magnitude,\n    distance_deg * 3600 AS distance_arcsec -- convert degrees to arcseconds\nFROM \n    ztf_near_mpc\nORDER BY \n    distance_deg;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the MPC object coordinates for '115185'\nWITH mpc_object AS (\n    SELECT ra, dec\n    FROM xmatch\n    WHERE oid_catalog = '115185'\n    LIMIT 1\n),\n-- Select ZTF objects within 1.5 arcsec of the MPC object\nztf_near_mpc AS (\n    SELECT \n        o.oid AS ztf_id,\n        s.ssmagnr AS mpc_magnitude,\n        q3c_dist(o.meanra, o.meandec, m.ra, m.dec) AS distance_deg\n    FROM \n        object o,\n        mpc_object m,\n        ss_ztf s\n    WHERE \n        q3c_join(o.meanra, o.meandec, m.ra, m.dec, 1.5/3600.0) -- 1.5 arcsec converted to degrees\n        AND s.oid = o.oid\n)\n-- Select and sort by distance\nSELECT \n    ztf_id,\n    mpc_magnitude,\n    distance_deg * 3600 AS distance_arcsec -- convert degrees to arcseconds\nFROM \n    ztf_near_mpc\nORDER BY \n    distance_deg;\n```"
                },
                "in_toks": 2669,
                "out_toks": 254,
                "id": "chatcmpl-BhLmyMz5Q7wjujUFzhxhE5TZQW1ih",
                "created": 1749671560,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "44": {
        "0": {
            "req_id": 44,
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'dataquality']"
                    },
                    "1": {
                        "response": "['object', 'dataquality']"
                    }
                },
                "in_toks": 806,
                "out_toks": 14,
                "id": "chatcmpl-Be0QegYOxvgiuoRhAlfqnxCYez8im",
                "created": 1748874468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```"
                    }
                },
                "in_toks": 3201,
                "out_toks": 75,
                "id": "chatcmpl-Be0RssPqAiiGTvSSpnCjFsXXRjvuP",
                "created": 1748874544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": 44,
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": {
                        "response": "['object', 'dataquality']"
                    },
                    "1": {
                        "response": "['object', 'dataquality']"
                    }
                },
                "in_toks": 806,
                "out_toks": 14,
                "id": "chatcmpl-Be0QegYOxvgiuoRhAlfqnxCYez8im",
                "created": 1748874468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": {
                        "response": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```"
                    }
                },
                "in_toks": 3201,
                "out_toks": 75,
                "id": "chatcmpl-Be0RxhdgFxUlMAIUfuu0iHGEHv9aR",
                "created": 1748874549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "44",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 806,
                "out_toks": 7,
                "id": "chatcmpl-BhLir7QLS8CVpAkcAEw0wvd1GhPIG",
                "created": 1749671305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```"
                },
                "in_toks": 3201,
                "out_toks": 75,
                "id": "chatcmpl-BhLmz2JpmGeImvUC19uRmNUayVH4A",
                "created": 1749671561,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "44",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']"
                },
                "in_toks": 806,
                "out_toks": 7,
                "id": "chatcmpl-BhLisWijgIMqgNP95HLweGQhWwEU6",
                "created": 1749671306,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```"
                },
                "in_toks": 3201,
                "out_toks": 75,
                "id": "chatcmpl-BhLn2wC4MPhCFADH2dTFf0x7MxH4n",
                "created": 1749671564,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    }
}