{"id": "batch_req_6849e167d0d481909871037530bc5f27", "custom_id": "13-2", "response": {"status_code": 200, "request_id": "cbb1656044d627c6d4524ad7c15bffe1", "body": {"id": "chatcmpl-BhLx1xLeMtAIymNrrnB7BJcgenqyW", "object": "chat.completion", "created": 1749672183, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name LIKE 'SN%'\n      AND p.class_name LIKE 'SNe%'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM sne_objects)\n)\n-- Final selection: object id, class probability, first and last detection dates\nSELECT \n    sp.class_name AS class_probability,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    o.oid\nFROM sne_probabilities sp\nJOIN object o ON o.oid = sp.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2607, "completion_tokens": 285, "total_tokens": 2892, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e167f10c8190b8ab198d1273f2a7", "custom_id": "13-3", "response": {"status_code": 200, "request_id": "b70686e3f0649b73f40d9f6a08c0f2b2", "body": {"id": "chatcmpl-BhLkgkSdjHdKezv3Ch6iTIie1G2Gy", "object": "chat.completion", "created": 1749671418, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range in MJD for December 1, 2022 to September 1, 2023\nWITH date_range AS (\n    SELECT 59914.0 AS start_mjd, 60217.0 AS end_mjd\n),\n-- Select objects classified as SNe with first detection within the specified date range\nsne_objects AS (\n    SELECT o.oid, o.firstmjd, o.lastmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Retrieve the most probable class (ranking=1) for these objects, focusing on SNe classes\nsne_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM sne_objects)\n      AND p.ranking = 1\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\n-- Final selection: object OID, class probability, first detection, last detection\nSELECT\n    sp.class_name AS probability_class,\n    so.lastmjd,\n    so.firstmjd,\n    so.oid\nFROM sne_probabilities sp\nJOIN sne_objects so ON sp.oid = so.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2607, "completion_tokens": 284, "total_tokens": 2891, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1680c28819099b7e64afb9a25d1", "custom_id": "10-2", "response": {"status_code": 200, "request_id": "9a93c377544a6d92c9e2f5e3149c41b2", "body": {"id": "chatcmpl-BhLx2YI6X52x9aZzTpLIc1V1V6P2J", "object": "chat.completion", "created": 1749672184, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select objects with specific classifications and rankings in the lc_classifier\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n      AND (\n        (p.class_name = 'SNIa' AND p.ranking = 1)\n        OR (p.class_name = 'CV/Nova' AND p.ranking = 2)\n      )\n    GROUP BY p.oid\n    HAVING\n      -- Ensure both classes are present for the object\n      COUNT(DISTINCT CASE WHEN p.class_name = 'SNIa' AND p.ranking = 1 THEN 1 END) > 0\n      AND COUNT(DISTINCT CASE WHEN p.class_name = 'CV/Nova' AND p.ranking = 2 THEN 1 END) > 0\n)\n\n-- Main query to retrieve oids and probabilities with the specified conditions\nSELECT\n    so.oid,\n    -- Retrieve the probability for SNIa (ranking=1)\n    (SELECT p1.probability\n     FROM probability p1\n     WHERE p1.oid = so.oid\n       AND p1.class_name = 'SNIa'\n       AND p1.ranking = 1\n       AND p1.classifier_name = 'lc_classifier'\n       AND p1.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n    ) AS SN_prob,\n    -- Retrieve the probability for CV/Nova (ranking=2)\n    (SELECT p2.probability\n     FROM probability p2\n     WHERE p2.oid = so.oid\n       AND p2.class_name = 'CV/Nova'\n       AND p2.ranking = 2\n       AND p2.classifier_name = 'lc_classifier'\n       AND p2.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n    ) AS CV_prob\nFROM selected_objects so\nWHERE\n    -- Ensure the difference between the probabilities is less than 0.1\n    ABS(\n        (SELECT p1.probability\n         FROM probability p1\n         WHERE p1.oid = so.oid\n           AND p1.class_name = 'SNIa'\n           AND p1.ranking = 1\n           AND p1.classifier_name = 'lc_classifier'\n           AND p1.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n        )\n        -\n        (SELECT p2.probability\n         FROM probability p2\n         WHERE p2.oid = so.oid\n           AND p2.class_name = 'CV/Nova'\n           AND p2.ranking = 2\n           AND p2.classifier_name = 'lc_classifier'\n           AND p2.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n        )\n    ) < 0.1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 639, "total_tokens": 3236, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16829688190971c318ccd3f8a60", "custom_id": "10-3", "response": {"status_code": 200, "request_id": "3817cb298a58013afa786510ccb8ed67", "body": {"id": "chatcmpl-BhLx2bFedWcyt00TR7FW35Scw5crt", "object": "chat.completion", "created": 1749672184, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select objects with specific classifications and rankings in the lc_classifier\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n      AND p.ranking IN (1, 2)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n),\n-- Subquery to get probabilities for SNIa and CV/Nova for the selected objects\nprobabilities AS (\n    SELECT\n        p.oid,\n        MAX(CASE WHEN p.class_name = 'SNIa' THEN p.probability END) AS SN_prob,\n        MAX(CASE WHEN p.class_name = 'CV/Nova' THEN p.probability END) AS CV_prob\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_objects)\n      AND p.class_name IN ('SNIa', 'CV/Nova')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name='lc_classifier')\n    GROUP BY p.oid\n)\n-- Final selection with probability difference condition\nSELECT\n    o.oid,\n    p.SN_prob,\n    p.CV_prob\nFROM object o\nJOIN probabilities p ON o.oid = p.oid\nWHERE ABS(p.SN_prob - p.CV_prob) < 0.1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 317, "total_tokens": 2914, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16847bc819083b08ffe3002001c", "custom_id": "15-2", "response": {"status_code": 200, "request_id": "5f93f21705fbdad11b69e1d6617c2508", "body": {"id": "chatcmpl-BhLkgGVS5K5m8ztegCqt2m7IGyeWW", "object": "chat.completion", "created": 1749671418, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT\n        oid,\n        stamp_prob\n    FROM\n        stamp_probs\n),\nfirst_detection AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM first_detection)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.magsigma,\n        m.firstmjd\n    FROM\n        magstat m\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.fid,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        m.magfirst,\n        m.firstmjd,\n        -- Calculate the initial rise as the difference in magnitude divided by the time difference\n        CASE\n            WHEN (m.firstmjd - (SELECT mjd FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1)) > 0\n                 AND (d.mjd - (SELECT mjd FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1)) > 0\n            THEN\n                (d.magpsf - m.magfirst) / ((d.mjd - m.firstmjd))\n            ELSE NULL\n        END AS initial_rise_estimate\n    FROM\n        detections d\n    JOIN\n        magstat_info m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE\n        d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= 60188.0 AND mjd <= 60189.0)\n)\nSELECT\n    sp.oid,\n    sp.stamp_prob,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    m.magstat_fid,\n    ir.initial_rise_estimate\nFROM\n    max_stamp_probs sp\nJOIN\n    first_detection fd ON sp.oid = fd.oid\nJOIN\n    detections d ON sp.oid = d.oid\nJOIN\n    magstat_info m ON d.oid = m.oid AND d.fid = m.fid\nJOIN\n    initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\nWHERE\n    sp.stamp_prob = (SELECT MAX(stamp_prob) FROM max_stamp_probs WHERE oid = sp.oid)\n    AND sp.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'SN'\n        AND classifier_name = 'stamp_classifier'\n        AND ranking = 1\n    )\n    AND fd.firstmjd BETWEEN 60188.0 AND 60189.0\n    AND (\n        -- Ensure the object qualifies as a fast riser\n        (m.magfirst - (SELECT magpsf FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1)) >= 0.25 * (d.mjd - (SELECT mjd FROM detection WHERE candid = d.candid AND oid = d.oid AND mjd < d.mjd ORDER BY mjd DESC LIMIT 1))\n    )\nORDER BY\n    sp.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3956, "completion_tokens": 899, "total_tokens": 4855, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16863d881908e827583ad560f41", "custom_id": "15-3", "response": {"status_code": 200, "request_id": "2790098c84e0ececac30e0e7db24391c", "body": {"id": "chatcmpl-BhLkgD3z4Qe3viXz54uOfipKrY3AF", "object": "chat.completion", "created": 1749671418, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers, highest stamp classifier probability for class 'SN', light curve detections, filter IDs, candid, magstat filter ID, and initial rise estimate\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n),\nmax_stamp_probs AS (\n    SELECT\n        oid,\n        stamp_prob\n    FROM\n        stamp_probs\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\ndetections_in_time AS (\n    SELECT\n        d.candid,\n        d.oid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec\n    FROM\n        detection d\n    JOIN\n        first_detections fd ON d.oid = fd.oid\n    WHERE\n        d.mjd = fd.firstmjd\n),\nmagstat_in_time AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magmean,\n        m.magfirst,\n        m.mjd AS magstat_mjd\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT\n        d.oid,\n        d.fid,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.ra,\n        d.dec,\n        -- Calculate the initial rise as the difference between the first detection magnitude and the last non-detection magnitude divided by the time difference\n        -- Assuming last non-detection magnitude is available or can be approximated; since not provided, we use magfirst from magstat\n        (m.magfirst - d.magpsf) / NULLIF((d.mjd - 60188.0), 0) AS initial_rise\n    FROM\n        detections_in_time d\n    JOIN\n        magstat_in_time m ON d.oid = m.oid AND d.fid = m.fid\n),\nfast_risers AS (\n    SELECT\n        o.oid,\n        sp.stamp_prob,\n        d.candid,\n        d.fid,\n        m.magstat_fid,\n        ir.initial_rise\n    FROM\n        first_detections o\n    JOIN\n        max_stamp_probs sp ON o.oid = sp.oid\n    JOIN\n        detections_in_time d ON o.oid = d.oid\n    JOIN\n        magstat_in_time m ON o.oid = m.oid AND d.fid = m.fid\n    JOIN\n        initial_rise ir ON d.oid = ir.oid AND d.candid = ir.candid\n    WHERE\n        sp.stamp_prob = (SELECT MAX(stamp_prob) FROM stamp_probs WHERE oid = o.oid)\n        AND sp.ranking = 1\n        AND ir.initial_rise >= 0.25\n)\nSELECT\n    oid,\n    stamp_prob,\n    candid,\n    fid,\n    magstat_fid,\n    initial_rise\nFROM\n    fast_risers\nORDER BY\n    oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3956, "completion_tokens": 732, "total_tokens": 4688, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16887908190af59c5e1811ffcf8", "custom_id": "4-2", "response": {"status_code": 200, "request_id": "2e3fc9f4e819f75028bac196ad9b6b8a", "body": {"id": "chatcmpl-BhLkghnM1LQ2FF6iZVVnHf6QuPX5N", "object": "chat.completion", "created": 1749671418, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant information for SN II objects with specified conditions\nWITH snii_objects AS (\n    SELECT o.oid, p.oid, p.class_name, p.probability, p.ranking\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484 AND 58824 -- Corresponds to years 2019-2022\n),\nsnii_candidates AS (\n    SELECT c.candid, c.oid, c.mjd, c.ra, c.dec, c.magpsf, c.sigmapsf, c.fid\n    FROM detection c\n    WHERE c.oid IN (SELECT oid FROM snii_objects)\n),\nmag_stats AS (\n    SELECT m.oid, m.fid, m.magmean, m.magmean_corr, m.dmdt_first\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM snii_objects)\n),\ndetections_count AS (\n    SELECT oid, COUNT(*) AS ndet\n    FROM detection\n    GROUP BY oid\n),\ninitial_rise AS (\n    SELECT s.oid, s.fid, s.mjd, s.magpsf, s.sigmapsf, s.dmdt_first\n    FROM magstat s\n    WHERE s.oid IN (SELECT oid FROM snii_objects)\n      AND s.dmdt_first > 0.5\n)\nSELECT \n    c.oid,\n    c.candid,\n    c.mjd,\n    c.magpsf,\n    c.sigmapsf,\n    c.fid AS band_id,\n    m.magmean,\n    m.magmean_corr,\n    m.dmdt_first AS initial_rise_rate,\n    d.ndet\nFROM snii_candidates c\nJOIN mag_stats m ON c.oid = m.oid AND c.fid = m.fid\nJOIN detections_count d ON c.oid = d.oid\nWHERE d.ndet > 50\n  AND c.mjd BETWEEN 58484 AND 58824\n  AND m.dmdt_first > 0.5\n  AND c.fid IN (1, 2); -- g and r bands\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3863, "completion_tokens": 494, "total_tokens": 4357, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e168a2848190b33732b5cabf757c", "custom_id": "4-3", "response": {"status_code": 200, "request_id": "a1f2442416589a3e5f24077891fbae67", "body": {"id": "chatcmpl-BhLksLjZDS6mw9HR70Iu012YUdNdT", "object": "chat.completion", "created": 1749671430, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant information for SN II objects with specified conditions\nWITH snii_objects AS (\n    -- Get object OIDs with classification as SN II, probability > 0.6, and ranking=1\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIi'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nfiltered_objects AS (\n    -- Filter objects with more than 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 50\n),\ncandidate_ids AS (\n    -- Get candidate IDs for objects in filtered_objects\n    SELECT d.candid, d.oid, d.mjd, d.fid, d.magpsf, d.sigmapsf, d.ra, d.dec\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\nlight_curve_stats AS (\n    -- Calculate initial rise estimate and rate for each object and band\n    SELECT\n        c.oid,\n        c.candid,\n        c.mjd,\n        c.fid,\n        c.magpsf,\n        c.sigmapsf,\n        c.ra,\n        c.dec,\n        -- Get first detection time per object and band\n        FIRST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mjd,\n        -- Get first detection magnitude per object and band\n        FIRST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd) AS first_mag,\n        -- Get last detection time per object and band\n        LAST_VALUE(c.mjd) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mjd,\n        -- Get last detection magnitude per object and band\n        LAST_VALUE(c.magpsf) OVER (PARTITION BY c.oid, c.fid ORDER BY c.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mag\n    FROM candidate_ids c\n),\nrise_rates AS (\n    -- Calculate initial rise rate (mag/day) for each object and band\n    SELECT\n        oid,\n        candid,\n        first_mjd,\n        last_mjd,\n        first_mag,\n        last_mag,\n        -- Avoid division by zero\n        CASE WHEN (last_mjd - first_mjd) > 0 THEN (last_mag - first_mag) / (last_mjd - first_mjd) ELSE NULL END AS rise_rate\n    FROM light_curve_stats\n),\nfinal_objects AS (\n    -- Filter objects with rise rate > 0.5 mag/day\n    SELECT DISTINCT o.oid\n    FROM rise_rates o\n    WHERE o.rise_rate > 0.5\n)\n-- Final selection of object and detection details with required filters\nSELECT\n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.ra,\n    d.dec\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM final_objects)\n  AND d.mjd BETWEEN 2019 AND 2022\n  AND d.fid IN (1, 2) -- g and r bands\n  AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = d.oid\n        AND p.class_name = 'SNIi'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.6\n        AND p.ranking = 1\n  )\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3863, "completion_tokens": 790, "total_tokens": 4653, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e168c6148190a0e8aef2dcc65ec1", "custom_id": "25-2", "response": {"status_code": 200, "request_id": "274c93aeb293283e28d8ab0f71063907", "body": {"id": "chatcmpl-BhLkrnco1ePMVR4dhLVEb2YoGVDr1", "object": "chat.completion", "created": 1749671429, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\ncandidate_objects AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON TRUE\n    WHERE EXISTS (\n        SELECT 1\n        FROM object_with_prob op\n        WHERE op.oid = o.oid\n    )\n    AND (\n        q3c_radial_query(o.meanra, o.meandec, s.column2, s.column3, 10)\n    )\n),\nfirst_detection_window AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT DISTINCT c.*\nFROM candidate_objects c\nJOIN first_detection_window fd ON c.oid = fd.oid;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 285, "total_tokens": 2920, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e168e30881908b51756011e9e7c8", "custom_id": "25-3", "response": {"status_code": 200, "request_id": "6b48d894acfbc5536dcd25f529ecb5aa", "body": {"id": "chatcmpl-BhLkvgvVTRaTl88O4tPclgsWLwaLT", "object": "chat.completion", "created": 1749671433, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n),\nobject_with_prob AS (\n    SELECT o.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.4\n      AND p.ranking = 1\n),\ncandidate_objects AS (\n    SELECT o.*\n    FROM object o\n    JOIN sources s ON TRUE\n    WHERE EXISTS (\n        SELECT 1\n        FROM object_with_prob op\n        WHERE op.oid = o.oid\n    )\n    AND (\n        q3c_radial_query(o.meanra, o.meandec, s.column2, s.column3, 10)\n    )\n),\nfirst_detection_window AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59983.0\n)\nSELECT DISTINCT c.*\nFROM candidate_objects c\nJOIN first_detection_window fd ON c.oid = fd.oid;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 285, "total_tokens": 2920, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16901108190a39ba076fe5f2990", "custom_id": "7-2", "response": {"status_code": 200, "request_id": "d946bfcd33afe20f5fda98a5d8418c82", "body": {"id": "chatcmpl-BhLmDoOgwLbKqDi89VikurnT4xk2C", "object": "chat.completion", "created": 1749671513, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\n-- Subquery to select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM stamp_sn_objects)\n  AND p.oid IN (SELECT oid FROM objects_january_2023)\n  AND p.classifier_name = 'stamp_classifier';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2584, "completion_tokens": 211, "total_tokens": 2795, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16921d48190a9fb769b77f32c98", "custom_id": "7-3", "response": {"status_code": 200, "request_id": "a3996b11dc0b60c13db244dbe8e31fbc", "body": {"id": "chatcmpl-BhLuZCWZPQAw3DIQiDy7JxpUDGEz7", "object": "chat.completion", "created": 1749672031, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select object IDs with the most probable class as 'SN' in the stamp_classifier\nWITH stamp_sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\n-- Subquery to select objects with first detection in January 2023 (MJD between 59945.0 and 59975.0)\nobjects_january_2023 AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59945.0 AND 59975.0\n)\n-- Main query to get object IDs and probabilities for objects meeting both conditions\nSELECT p.oid, p.probability\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM stamp_sn_objects)\n  AND p.oid IN (SELECT oid FROM objects_january_2023)\n  AND p.classifier_name = 'stamp_classifier';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2584, "completion_tokens": 211, "total_tokens": 2795, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16948088190af63271a23dd1670", "custom_id": "2-2", "response": {"status_code": 200, "request_id": "af4576c32455a4fc08b76ba19516e392", "body": {"id": "chatcmpl-BhLrciee2ubVS7UTcrDvAfU2olkwV", "object": "chat.completion", "created": 1749671848, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers classified as YSO with probability > 0.7\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to find OIDs with YSO classification probability > 0.7\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4974, "completion_tokens": 106, "total_tokens": 5080, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1696a748190ad0d76071eac3b95", "custom_id": "2-3", "response": {"status_code": 200, "request_id": "3b74c12506ade7c63c9d199484b6728c", "body": {"id": "chatcmpl-BhLrLJehn7P6fUwR31hK9VubcqJnn", "object": "chat.completion", "created": 1749671831, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers classified as YSO with probability > 0.7\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to find OIDs with YSO classification probability > 0.7\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'YSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4974, "completion_tokens": 106, "total_tokens": 5080, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1698a10819088ed625d239716b2", "custom_id": "3-2", "response": {"status_code": 200, "request_id": "2f7cffb98233b5eb72f5e9ed229380c1", "body": {"id": "chatcmpl-BhLsBbv1r2RD5sQmtX9DbCaYCADtA", "object": "chat.completion", "created": 1749671883, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'YSO'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.7\n          AND p.ranking = 1\n    )\n)\n-- Filter objects that were last detected in June (MJD between 60096 and 60125)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.mjdendhist BETWEEN 60096.0 AND 60125.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2567, "completion_tokens": 171, "total_tokens": 2738, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e169a6f08190b369e2840cbf7858", "custom_id": "3-3", "response": {"status_code": 200, "request_id": "47df0535aff02d325a19a293d2b6b92c", "body": {"id": "chatcmpl-BhLl3I7wQW6SSWS2Zcal9YmxdFBXP", "object": "chat.completion", "created": 1749671441, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object IDs classified as YSO with probability > 0.7 by the lc_classifier\nWITH yso_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'YSO'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.7\n          AND p.ranking = 1\n    )\n)\n-- Filter objects that were last detected in June (MJD between 60096 and 60125)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM yso_objects)\n  AND o.mjdendhist BETWEEN 60096.0 AND 60125.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2567, "completion_tokens": 171, "total_tokens": 2738, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e169c3a08190958b8cbb26b8c9df", "custom_id": "23-2", "response": {"status_code": 200, "request_id": "d462d7ca08a6e937b11de9332d579006", "body": {"id": "chatcmpl-BhLl3OvdZpOVOK7qznq1JmlS5DSRA", "object": "chat.completion", "created": 1749671441, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with their classification probabilities for specified classes\nWITH object_probabilities AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.probability > 0.2\n)\n-- Retrieve all probabilities for these objects and classes\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM\n    object o\nJOIN\n    probability p ON o.oid = p.oid\nWHERE\n    o.oid IN (\n        SELECT DISTINCT oid FROM object_probabilities\n    )\nORDER BY\n    o.oid,\n    p.ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2580, "completion_tokens": 203, "total_tokens": 2783, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e169f24c81909e329d0a2acd3c96", "custom_id": "23-3", "response": {"status_code": 200, "request_id": "74243b8fac367934ed283160a879effe", "body": {"id": "chatcmpl-BhLl2LOgoDhTvxub5hA3HjeVcCs0Y", "object": "chat.completion", "created": 1749671440, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to get object OIDs with the highest probability for classes 'SNIa', 'SNIbc', 'SNII', 'SLSN' in 'lc_classifier' with probability > 0.2\nWITH top_probabilities AS (\n    SELECT\n        p.oid\n    FROM\n        probability p\n    WHERE\n        p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.2\n    -- Select the object with the highest probability for each class\n    AND p.ranking = 1\n)\n-- Main query to retrieve all probabilities for objects identified above\nSELECT\n    p.*\nFROM\n    probability p\nWHERE\n    p.oid IN (SELECT oid FROM top_probabilities);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2580, "completion_tokens": 182, "total_tokens": 2762, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16a0f288190b18d2bf2d3af4598", "custom_id": "32-2", "response": {"status_code": 200, "request_id": "be175d4d32da2d8abdd56fae930862a3", "body": {"id": "chatcmpl-BhLl3874hYJ8c3Tj0RzwA3aYuy72t", "object": "chat.completion", "created": 1749671441, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    'ZTF21aaqosfj',\n    'ZTF21aaqosfm',\n    'ZTF21aaqosfs',\n    'ZTF21aaqosff',\n    'ZTF21aaqoski',\n    'ZTF21aaqoskz',\n    'ZTF21aaqosfo',\n    'ZTF21aaqosly',\n    'ZTF21aaqosgi',\n    'ZTF21aaqospe'\n)\nAND ssdistnr > 0\nORDER BY oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2139, "completion_tokens": 143, "total_tokens": 2282, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16a2bb08190aacec00b79db8e79", "custom_id": "32-3", "response": {"status_code": 200, "request_id": "cdd759cd5a1bf5f966116fef83b9378a", "body": {"id": "chatcmpl-BhLl55pjBsvuq7D8X8x2lMe6slkVd", "object": "chat.completion", "created": 1749671443, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select data from ss_ztf where oid is in the specified list and ssdistnr is positive\nSELECT *\nFROM ss_ztf\nWHERE oid IN (\n    'ZTF21aaqosfj',\n    'ZTF21aaqosfm',\n    'ZTF21aaqosfs',\n    'ZTF21aaqosff',\n    'ZTF21aaqoski',\n    'ZTF21aaqoskz',\n    'ZTF21aaqosfo',\n    'ZTF21aaqosly',\n    'ZTF21aaqosgi',\n    'ZTF21aaqospe'\n)\nAND ssdistnr > 0\nORDER BY oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2139, "completion_tokens": 143, "total_tokens": 2282, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16a47d88190b6bbddacc1480748", "custom_id": "20-2", "response": {"status_code": 200, "request_id": "6767a9b0665d6b3039ef1bb2355b44a0", "body": {"id": "chatcmpl-BhLl9lhNrD8HOzAHKWrL63Ix4UlCm", "object": "chat.completion", "created": 1749671447, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE EXISTS (\n    -- Subquery to find the probability of class 'RRL' for the object with the specified classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n)\nAND o.ndet >= 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3107, "completion_tokens": 120, "total_tokens": 3227, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16a646c81908c79a11bef99c9e8", "custom_id": "20-3", "response": {"status_code": 200, "request_id": "de849016174f8fa50a702f6cac674be6", "body": {"id": "chatcmpl-BhLlC4Vm9K2IQ1w3zSVexsetSpevr", "object": "chat.completion", "created": 1749671450, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as RRL with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nWHERE EXISTS (\n    -- Subquery to check for probability of RRL in the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'RRL'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.55\n)\nAND o.ndet >= 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3107, "completion_tokens": 115, "total_tokens": 3222, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16a89c08190ba3e87b688d89430", "custom_id": "18-2", "response": {"status_code": 200, "request_id": "c9568d8cf459ef1a977fcace11b089fd", "body": {"id": "chatcmpl-BhLlDM29Smm1cylobeDXgppFahS6y", "object": "chat.completion", "created": 1749671451, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query for AGN sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND o.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND probability > 0.95\n          AND ranking = 1\n    )\n\nUNION\n\n-- Query for QSO sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND o.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'QSO'\n          AND classifier_name = 'lc_classifier'\n          AND probability > 0.95\n          AND ranking = 1\n    )\n\nUNION\n\n-- Query for Blazar sources\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND o.oid IN (\n        SELECT oid FROM probability\n        WHERE class_name = 'Blazar'\n          AND classifier_name = 'lc_classifier'\n          AND probability > 0.8\n          AND ranking = 1\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3240, "completion_tokens": 560, "total_tokens": 3800, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16aac7c81908cc12ab4f6f4c3d5", "custom_id": "18-3", "response": {"status_code": 200, "request_id": "16fef02dd8da4a97fbbd0ddd556edcc5", "body": {"id": "chatcmpl-BhLlHeTfLitq7xaZcmzTDqRQ6Hymh", "object": "chat.completion", "created": 1749671455, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query for AGN classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('QSO', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for QSO classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.95\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'Blazar')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.8\n          AND p2.ranking = 1\n    )\nUNION\n-- Query for Blazar classification probabilities\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd AS firstMJD,\n    o.deltajd,\n    'lc_classifier' AS classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM object o\nWHERE \n    o.ndet >= 40\n    AND o.deltajd >= 200\n    AND p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.8\n    AND p.ranking = 1\n    AND EXISTS (\n        SELECT 1 FROM probability p2\n        WHERE p2.oid = o.oid\n          AND p2.class_name IN ('AGN', 'QSO')\n          AND p2.classifier_name = 'lc_classifier'\n          AND p2.probability > 0.95\n          AND p2.ranking = 1\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3240, "completion_tokens": 655, "total_tokens": 3895, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16add588190adb0aabd3c84b39b", "custom_id": "35-2", "response": {"status_code": 200, "request_id": "be8d8f8f0482e630f0d6915f8047acc4", "body": {"id": "chatcmpl-BhLllx7jBqEMDqezSNhZmMEM7rABI", "object": "chat.completion", "created": 1749671485, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2051, "completion_tokens": 32, "total_tokens": 2083, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16b08ec8190af673fb4b26c27aa", "custom_id": "35-3", "response": {"status_code": 200, "request_id": "fb491ccefcab2fe826b63c56e9c8753a", "body": {"id": "chatcmpl-BhLm13sa5b705xXHCwF9MsHBNKrfJ", "object": "chat.completion", "created": 1749671501, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the first 10 entries from the probability table ordered by oid\nSELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2051, "completion_tokens": 32, "total_tokens": 2083, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16b27a4819081bb96bdc1055e8d", "custom_id": "11-2", "response": {"status_code": 200, "request_id": "bbdf47183de2e91e30b7233ff09bc5e4", "body": {"id": "chatcmpl-BhLm4BLhQHwEYLtg33iyUisquFUxN", "object": "chat.completion", "created": 1749671504, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nSELECT \n    o.oid,\n    f.magmax,\n    f.magmax_corr,\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for SNe Ia in the classification probabilities\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n          AND p.ranking = 1\n    )\n    AND -- First detection in September (mjd between 60188 and 60217)\n    o.firstmjd BETWEEN 60188 AND 60217\n    AND -- Peak magnitude above 19\n    f.magmax > 19\n    AND -- g-r color at maximum below 1\n    f.name = 'g-r_max_corr'\n    AND f.value < 1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6299, "completion_tokens": 234, "total_tokens": 6533, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16b48dc8190a302d847459247b7", "custom_id": "11-3", "response": {"status_code": 200, "request_id": "dc08f58eca566a4df9d81318e91c93b5", "body": {"id": "chatcmpl-BhLm4kVTCbispHrSZjm7MABWA3c3X", "object": "chat.completion", "created": 1749671504, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as SNe Ia with specific conditions\nSELECT \n    o.oid,\n    f.magmax,\n    f.magmax_corr,\n    f.name AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for SNe Ia in the probability table with ranking=1 (most probable)\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNIa'\n          AND p.ranking = 1\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n    AND -- First detection in September (mjd between 60188 and 60217)\n    o.firstmjd BETWEEN 60188 AND 60217\n    AND -- Peak magnitude (magmax) below 19\n    f.magmax < 19\n    AND -- g-r color at maximum (g-r_max) below 1\n    f.name = 'g-r_max'\n    AND -- Ensure the feature corresponds to the maximum magnitude\n    f.value = (\n        SELECT MAX(f2.value)\n        FROM feature f2\n        WHERE f2.oid = o.oid AND f2.name = 'magmax'\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6299, "completion_tokens": 290, "total_tokens": 6589, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16b663c81909b3adca540706136", "custom_id": "9-2", "response": {"status_code": 200, "request_id": "d21708621fa86950dd8925cc993719eb", "body": {"id": "chatcmpl-BhLmIH8SjkcHoZCHc4k1tWnsSR4UA", "object": "chat.completion", "created": 1749671518, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name IN ('stamp_classifier')\n           AND p.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p2\n                                       WHERE p2.oid = p.oid\n                                         AND p2.classifier_name = p.classifier_name)\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p3\n                                       WHERE p3.oid = p2.oid\n                                         AND p3.classifier_name = p2.classifier_name)\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name,\n        -- Retrieve sgscore1\n        o.sgscore1\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2684, "completion_tokens": 555, "total_tokens": 3239, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16b910c8190b710b1615c5c8c65", "custom_id": "9-3", "response": {"status_code": 200, "request_id": "d581a86c9a48e3172a93573947aa5ca5", "body": {"id": "chatcmpl-BhLme5arDuV38DPkxY1lD9gvzULom", "object": "chat.completion", "created": 1749671540, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        -- Retrieve the highest probability in stamp_classifier that is not 'asteroid' or 'bogus'\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'stamp_classifier'\n           AND p.classifier_name IN ('stamp_classifier')\n           AND p.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p2\n                                       WHERE p2.oid = p.oid\n                                         AND p2.classifier_name = p.classifier_name)\n           AND p.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p.ranking\n         LIMIT 1\n        ) AS max_stamp_prob,\n        -- Retrieve the class name corresponding to the max probability in stamp_classifier\n        (SELECT p2.class_name\n         FROM probability p2\n         WHERE p2.oid = o.oid\n           AND p2.classifier_name = 'stamp_classifier'\n           AND p2.classifier_version = (SELECT MAX(classifier_version)\n                                       FROM probability p3\n                                       WHERE p3.oid = p2.oid\n                                         AND p3.classifier_name = p2.classifier_name)\n           AND p2.class_name NOT IN ('asteroid', 'bogus')\n         ORDER BY p2.ranking\n         LIMIT 1\n        ) AS class_name,\n        -- Retrieve sgscore1\n        o.sgscore1\n    FROM object o\n    WHERE\n        o.firstmjd BETWEEN 60126.0 AND 60156.0\n        AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n        AND o.sgscore1 < 0.3\n)\nSELECT\n    so.oid,\n    so.max_stamp_prob AS value,\n    so.class_name AS name,\n    (SELECT p.classifier_version\n     FROM probability p\n     WHERE p.oid = so.oid\n       AND p.class_name = so.class_name\n       AND p.classifier_name = 'stamp_classifier'\n     ORDER BY p.ranking\n     LIMIT 1\n    ) AS version,\n    so.meanra,\n    so.meandec,\n    -- Calculate distance using q3c_dist\n    q3c_dist(so.meanra, so.meandec, 39.97, -1.5768) AS dist\nFROM selected_objects so\nWHERE\n    so.max_stamp_prob IS NOT NULL\n    AND so.class_name NOT IN ('Asteroid', 'Bogus');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2684, "completion_tokens": 555, "total_tokens": 3239, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16baec481908a2a1c51769e0aa5", "custom_id": "5-2", "response": {"status_code": 200, "request_id": "a9053464a67a6af1b9c230225e16da51", "body": {"id": "chatcmpl-BhLn9hos1uDebWXAwOoAFA5pWc620", "object": "chat.completion", "created": 1749671571, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object and detection information along with feature details, filtering objects classified as SN II with probability > 0.6,\n-- having more than 50 detections, and a magnitude difference > 2 in the g-band, ordered by object id.\n\nSELECT \n    o.oid,\n    d.candid AS detection_candid,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf,\n    d.sigmapsf,\n    d.ra,\n    d.dec,\n    -- Rename 'fid' column as 'feature_fid'\n    f.fid AS feature_fid\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for objects classified as SN II with probability > 0.6\n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SNII'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n    )\n    -- Filter for objects with more than 50 detections\n    AND o.ndet > 50\n    -- Filter for objects with magnitude difference > 2 in g-band\n    AND (\n        SELECT MAX(f2.value) - MIN(f3.value)\n        FROM feature f2\n        JOIN feature f3 ON f2.oid = f3.oid AND f2.name = f3.name\n        WHERE f2.oid = o.oid AND f2.fid = 1 AND f3.fid = 1 AND f2.name = 'mag'\n    ) > 2\nORDER BY \n    o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5594, "completion_tokens": 363, "total_tokens": 5957, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16bcbec8190ace6b86cf5b6e866", "custom_id": "5-3", "response": {"status_code": 200, "request_id": "f6bf7846efd51fc63b8c4281ca91c00b", "body": {"id": "chatcmpl-BhLnF2XacHr7ZTH8a97GfVnZvWeA8", "object": "chat.completion", "created": 1749671577, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object and detection information along with feature details, renaming 'fid' to 'feature_fid'\nSELECT \n    o.oid,\n    d.candid AS detection_candid,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf AS psf_magnitude,\n    d.sigmapsf AS magnitude_error,\n    -- Rename 'fid' column as 'feature_fid'\n    d.fid AS feature_fid\nFROM \n    object o\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\n-- Subquery to filter objects classified as SN II with probability > 0.6\nWHERE \n    o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE \n            p.class_name = 'SNII'\n            AND p.classifier_name = 'lc_classifier'\n            AND p.probability > 0.6\n            AND p.ranking = 1\n    )\n-- Filter objects with more than 50 detections\nAND \n    o.ndet > 50\n-- Filter objects with magnitude variation in g-band greater than 2\nAND \n    (SELECT MAX(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) > 2\nORDER BY \n    o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5594, "completion_tokens": 310, "total_tokens": 5904, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16be77081909077dcf9ee01f57a", "custom_id": "0-2", "response": {"status_code": 200, "request_id": "33eda4f923a826ccbabb93aafd248ac4", "body": {"id": "chatcmpl-BhLnQxvTz5tHvvlAIloI9gAYLIn2n", "object": "chat.completion", "created": 1749671588, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high probability of being YSOs and exhibiting periodicity\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'YSO'\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n        AND p.ranking = 1\n        AND p.probability > 0.7\n),\nperiodic_objects AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version AS feature_version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Period_band'\n        AND f.value BETWEEN 3 AND 10\n),\namplitude_objects AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        f.name AS feature_name,\n        f.value,\n        f.fid,\n        f.version AS feature_version\n    FROM\n        object o\n    JOIN\n        feature f ON o.oid = f.oid\n    WHERE\n        f.name = 'Amplitude'\n        AND f.value > 0.5\n)\nSELECT\n    yso_prob.oid,\n    yso_prob.possibility,\n    yso_prob.class_name,\n    yso_prob.classifier_name,\n    yso_prob.classifier_version,\n    f.value AS feature_value,\n    f.name AS feature_name,\n    f.fid AS filter_id,\n    f.version AS feature_version\nFROM\n    yso_prob\nJOIN\n    periodic_objects po ON yso_prob.oid = po.oid\nJOIN\n    amplitude_objects ao ON yso_prob.oid = ao.oid\nJOIN\n    feature f ON yso_prob.oid = f.oid\nWHERE\n    f.name IN ('Period_band', 'Amplitude')\nORDER BY\n    yso_prob.possibility DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5036, "completion_tokens": 478, "total_tokens": 5514, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16c00988190afc36a068b437d53", "custom_id": "0-3", "response": {"status_code": 200, "request_id": "75ec567111adfb920eaaf21c747f9987", "body": {"id": "chatcmpl-BhLnWrC4bgFMABLJkrHpoWCQyQjVg", "object": "chat.completion", "created": 1749671594, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high probability of being YSO and exhibiting periodicity with specified conditions\nSELECT \n    o.oid,\n    p.probability AS possibility,\n    f.value,\n    f.name AS feature_name,\n    f.fid AS filter_id,\n    f.version AS feature_version\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    AND p.probability > 0.7\n    AND f.name = 'Period_band'\n    AND f.value BETWEEN 3 AND 10\n    AND EXISTS (\n        SELECT 1\n        FROM feature f2\n        WHERE \n            f2.oid = o.oid\n            AND f2.name = 'Amplitude'\n            AND f2.value > 0.5\n    )\nORDER BY \n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5036, "completion_tokens": 238, "total_tokens": 5274, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16c2a6c81909a0b0b48c6269c97", "custom_id": "28-2", "response": {"status_code": 200, "request_id": "81758a3ef029283f447508b182cdbe3a", "body": {"id": "chatcmpl-BhLnZVUL53WHU9UFOuWF3KvHrtcYn", "object": "chat.completion", "created": 1749671597, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1879, "completion_tokens": 34, "total_tokens": 1913, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16c477c8190b3aa34bc8755c0c2", "custom_id": "28-3", "response": {"status_code": 200, "request_id": "ad5b76ffefa8565315a7f3dd8827dd54", "body": {"id": "chatcmpl-BhLlWI0mcYiQn9CFL2LedeQ9FM7zk", "object": "chat.completion", "created": 1749671470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all table names in the 'alerce' schema\nSELECT table_name\nFROM information_schema.tables\nWHERE table_schema = 'alerce';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1879, "completion_tokens": 34, "total_tokens": 1913, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16c6ca8819096fbf91c31fdaf4f", "custom_id": "36-2", "response": {"status_code": 200, "request_id": "2528e59c7dea017bf8ec2e7bcbdc4250", "body": {"id": "chatcmpl-BhLlWnYgjDp93rxsexefrpYifNI2R", "object": "chat.completion", "created": 1749671470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the object oid, feature names, and feature values for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5343, "completion_tokens": 57, "total_tokens": 5400, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16c8f8881909d5736da2c8f5761", "custom_id": "36-3", "response": {"status_code": 200, "request_id": "b8aaf3b609cdadc8e3151a927feec762", "body": {"id": "chatcmpl-BhLlVWiWZNMNTrtG39yEz7FeoB131", "object": "chat.completion", "created": 1749671469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the object oid, feature name, and feature value for the specified object\nSELECT \n    f.oid,\n    f.name,\n    f.value\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF20aaelulu';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4795, "completion_tokens": 57, "total_tokens": 4852, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16ccba88190b6e14da8797e997f", "custom_id": "38-2", "response": {"status_code": 200, "request_id": "a82bb54b2a97999de3f23297b989d281", "body": {"id": "chatcmpl-BhLlVCEQBWqpKQdUHPihejlpdlYc7", "object": "chat.completion", "created": 1749671469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detections between 30 and 200\nagn_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\nqso_filtered AS (\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Combine the results\nSELECT * FROM agn_filtered\nUNION ALL\nSELECT * FROM qso_filtered;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3133, "completion_tokens": 411, "total_tokens": 3544, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16cf03081909abd3bc91893bd5c", "custom_id": "38-3", "response": {"status_code": 200, "request_id": "da364ff1d8246c07830222a3182cd6cd", "body": {"id": "chatcmpl-BhLlXL9ZuqyoQq9UCCth3ebv740ue", "object": "chat.completion", "created": 1749671471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ordered by probability descending\nWITH agn_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ordered by probability descending\nqso_candidates AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Filter objects with detection counts between 30 and 200\nagn_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n),\nqso_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM qso_candidates)\n      AND o.ndet BETWEEN 30 AND 200\n)\n-- Final selection of objects that meet all criteria\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM agn_filtered)\n   OR o.oid IN (SELECT oid FROM qso_filtered);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3133, "completion_tokens": 364, "total_tokens": 3497, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16d0dcc819093b952cdc2c0142a", "custom_id": "24-2", "response": {"status_code": 200, "request_id": "24d86b6c9786d67663b146d469271eac", "body": {"id": "chatcmpl-BhLlfR1R0tlKQK6S8ALFVuIYPVrhJ", "object": "chat.completion", "created": 1749671479, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.oid, o.firstmjd, o.mjdstarthist, o.mjdendhist, o.firstmjd, o.mjdendhist\nFROM object o\nJOIN sources s ON true\nWHERE q3c_join(s.column2, s.column3, o.meanra, o.meandec, 10)\nAND o.firstmjd BETWEEN 59976.0 AND 59983.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5053, "completion_tokens": 146, "total_tokens": 5199, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16d2a2c81908b11150112bdfd93", "custom_id": "24-3", "response": {"status_code": 200, "request_id": "49bee565cedb9537dc8a03e4f5784edc", "body": {"id": "chatcmpl-BhLlgTqZzCOSjeJmrPzuryM9NWZmg", "object": "chat.completion", "created": 1749671480, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH sources AS (\n    VALUES\n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.oid, o.firstmjd, o.meanra, o.meandec\nFROM object o\nJOIN sources s ON true\nWHERE q3c_radial_query(o.meanra, o.meandec, s.column2, s.column3, 10)\nAND o.firstmjd BETWEEN 59976.0 AND 59983.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5053, "completion_tokens": 134, "total_tokens": 5187, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16d5a408190a4c413192e5a496c", "custom_id": "31-2", "response": {"status_code": 200, "request_id": "5a769905f4cacef313bf9453d8d67989", "body": {"id": "chatcmpl-BhLlkIcvl4SC7ooWzKqtWgtqUDF5R", "object": "chat.completion", "created": 1749671484, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detection_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for classified objects\nSELECT\n    o.meanra AS ra,\n    o.meandec AS dec,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM\n    first_detection_objects fdo\nJOIN\n    object o ON o.oid = fdo.oid\nLEFT JOIN\n    feature f ON f.oid = o.oid\nLEFT JOIN\n    probability p ON p.oid = o.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\nORDER BY\n    o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5051, "completion_tokens": 225, "total_tokens": 5276, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16d7aa8819092c9a3d8bc7c3b60", "custom_id": "31-3", "response": {"status_code": 200, "request_id": "f8155c23c586f17a59f804f30b9b84d9", "body": {"id": "chatcmpl-BhLlowbNUAXNesWotnPLkha1oSKQs", "object": "chat.completion", "created": 1749671488, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define a temporary table with the object IDs of objects first detected between Feb 1 and Feb 2, 2023\nWITH first_detected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 59976.0 AND 59977.0\n)\n-- Select galactic coordinates, features, class name, and object identifiers for these objects\nSELECT \n    o.meanra AS ra,\n    o.meandec AS dec,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    p.class_name,\n    o.oid\nFROM \n    first_detected_objects fdo\nJOIN \n    object o ON o.oid = fdo.oid\nLEFT JOIN \n    feature f ON f.oid = o.oid\nLEFT JOIN \n    probability p ON p.oid = o.oid\nWHERE \n    p.classifier_name = 'lc_classifier' AND\n    p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE oid = o.oid AND classifier_name='lc_classifier')\nORDER BY \n    o.oid, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5051, "completion_tokens": 231, "total_tokens": 5282, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16d96108190a85c1cbc465ed6fd", "custom_id": "33-2", "response": {"status_code": 200, "request_id": "ed41531d5f62bceee2c2998453b16b23", "body": {"id": "chatcmpl-BhLlrwjfNjTHvXGEpzwld938w3kHx", "object": "chat.completion", "created": 1749671491, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2999, "completion_tokens": 146, "total_tokens": 3145, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16dd3708190bd0af89d8b167564", "custom_id": "33-3", "response": {"status_code": 200, "request_id": "48184f9108657405d13e7ca8996044d5", "body": {"id": "chatcmpl-BhLlyqBxZ6WTeet9T4HxSgZbAg1jU", "object": "chat.completion", "created": 1749671498, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select oid, candid, mjd, fid, magpsf from detection for specified oids\nSELECT \n    d.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2999, "completion_tokens": 146, "total_tokens": 3145, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16df1b48190863c2ede7931102d", "custom_id": "6-2", "response": {"status_code": 200, "request_id": "b1363cdcf06859bfbb4ae2a61f5c86a8", "body": {"id": "chatcmpl-BhLlyCQIyUpmqqf1NSHFaI2ZERMIJ", "object": "chat.completion", "created": 1749671498, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object and detection details for objects classified as SN II in 2019-2022\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58484.0 AND 59944.0\n),\ndetection_filtered AS (\n    SELECT d.candid, d.oid, d.mjd, d.ra, d.dec, d.magpsf, d.sigmapsf, d.fid AS f_id\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_ii_objects)\n      AND d.mjd BETWEEN 58484.0 AND 59944.0\n),\nmagstat_r AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.sigmadm_first, ms.dmdt_first, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM sn_ii_objects)\n      AND ms.fid IN (1, 2) -- g and r bands\n),\nrise_rates AS (\n    SELECT\n        oid,\n        f_id,\n        -- Calculate initial rise rate: change in magnitude over time\n        CASE\n            WHEN d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL AND (d2.mjd - d1.mjd) > 0\n                THEN (d2.magpsf - d1.magpsf) / (d2.mjd - d1.mjd)\n            ELSE NULL\n        END AS rise_rate\n    FROM\n        (SELECT DISTINCT oid, f_id FROM magstat_r) m\n        LEFT JOIN detection_filtered d1 ON m.oid = d1.oid AND m.f_id = d1.f_id\n        LEFT JOIN detection_filtered d2 ON m.oid = d2.oid AND m.f_id = d2.f_id AND d2.mjd > d1.mjd\n    WHERE\n        d1.mjd IS NOT NULL AND d2.mjd IS NOT NULL\n),\nobjects_with_rise AS (\n    SELECT DISTINCT oid\n    FROM rise_rates\n    WHERE rise_rate > 0.5\n),\ndetection_final AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.f_id\n    FROM detection_filtered d\n    WHERE d.oid IN (SELECT oid FROM objects_with_rise)\n),\nmagstat_r_days AS (\n    SELECT ms.oid, ms.ndet, ms.magmean, ms.fid\n    FROM magstat ms\n    WHERE ms.oid IN (SELECT oid FROM objects_with_rise)\n),\nobservation_days AS (\n    SELECT\n        oid,\n        MAX(CASE WHEN f_id = 2 THEN lastmjd END) AS last_mjd_r,\n        MIN(CASE WHEN f_id = 2 THEN firstmjd END) AS first_mjd_r\n    FROM magstat_r_days\n    GROUP BY oid\n),\nobjects_with_observations AS (\n    SELECT oid\n    FROM observation_days\n    WHERE (last_mjd_r - first_mjd_r) >= 100\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS ndet_r\n    FROM detection_filtered\n    WHERE f_id = 2\n    GROUP BY oid\n),\nfinal_objects AS (\n    SELECT o.oid\n    FROM objects_with_rise o\n    JOIN objects_with_observations ob ON o.oid = ob.oid\n    JOIN detection_counts dc ON o.oid = dc.oid\n    WHERE dc.ndet_r > 30\n)\n-- Final selection of detection data with required filters\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    d.f_id\nFROM detection_final d\nWHERE d.oid IN (SELECT oid FROM final_objects)\nORDER BY d.oid, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3921, "completion_tokens": 865, "total_tokens": 4786, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16e12c48190ad47ca7db78df09d", "custom_id": "6-3", "response": {"status_code": 200, "request_id": "b683d8f746b4f6cdd82fc5cb5d4f5a95", "body": {"id": "chatcmpl-BhLm2OTjYM513Sv3cSF0JqMbiKiVD", "object": "chat.completion", "created": 1749671502, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant information from detection and object tables for objects classified as SN II\nWITH sn_ii_objects AS (\n    SELECT\n        o.oid,\n        p.oid AS prob_oid,\n        p.class_name,\n        p.classifier_name,\n        p.probability,\n        d.candid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.fid AS band_id,\n        d.ra,\n        d.dec\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        p.class_name = 'SNII'\n        AND p.classifier_name = 'lc_classifier'\n        AND p.probability > 0.6\n        AND d.mjd BETWEEN 58484.0 AND 59944.0\n),\n-- Filter objects with sufficient r-band observations and detections\nfiltered_objects AS (\n    SELECT\n        oid\n    FROM\n        sn_ii_objects\n    WHERE\n        band_id = 2 -- r-band\n    GROUP BY\n        oid\n    HAVING\n        COUNT(*) >= 100\n        AND COUNT(DISTINCT candid) > 30\n),\n-- Calculate initial rise rate for each object in g and r bands\nrise_rates AS (\n    SELECT\n        o.oid,\n        -- For each object, find the earliest and latest detection in g-band\n        MIN(CASE WHEN d.fid = 1 THEN d.mjd END) AS g_start_mjd,\n        MAX(CASE WHEN d.fid = 1 THEN d.mjd END) AS g_end_mjd,\n        -- For r-band\n        MIN(CASE WHEN d.fid = 2 THEN d.mjd END) AS r_start_mjd,\n        MAX(CASE WHEN d.fid = 2 THEN d.mjd END) AS r_end_mjd,\n        -- Corresponding magnitudes\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf END) AS g_min_mag,\n        MIN(CASE WHEN d.fid = 2 THEN d.magpsf END) AS r_min_mag\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        o.oid IN (SELECT oid FROM filtered_objects)\n    GROUP BY\n        o.oid\n),\n-- Calculate rise rates in mag/day for g and r bands\nrise_rate_calc AS (\n    SELECT\n        oid,\n        CASE WHEN g_end_mjd IS NOT NULL AND g_start_mjd IS NOT NULL AND (g_end_mjd - g_start_mjd) > 0\n            THEN (g_min_mag - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 1 AND mjd BETWEEN g_start_mjd AND g_end_mjd))\n                 / (g_end_mjd - g_start_mjd)\n            ELSE NULL\n        END AS g_rise_rate,\n        CASE WHEN r_end_mjd IS NOT NULL AND r_start_mjd IS NOT NULL AND (r_end_mjd - r_start_mjd) > 0\n            THEN (r_min_mag - (SELECT MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 2 AND mjd BETWEEN r_start_mjd AND r_end_mjd))\n                 / (r_end_mjd - r_start_mjd)\n            ELSE NULL\n        END AS r_rise_rate\n    FROM\n        rise_rates o\n),\n-- Select objects with initial rise rate > 0.5 mag/day in g and r bands\nobjects_with_rise AS (\n    SELECT\n        o.oid\n    FROM\n        rise_rate_calc o\n    WHERE\n        (g_rise_rate > 0.5 OR r_rise_rate > 0.5)\n)\n-- Final selection of detections for objects meeting all criteria\nSELECT\n    d.oid,\n    d.candid AS candidate_id,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid AS band_id,\n    d.mjd\nFROM\n    detection d\nJOIN\n    objects_with_rise o ON d.oid = o.oid\nWHERE\n    d.mjd BETWEEN 58484.0 AND 59944.0\nORDER BY\n    d.oid, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3204, "completion_tokens": 914, "total_tokens": 4118, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16e31c081909497659f9d484052", "custom_id": "21-2", "response": {"status_code": 200, "request_id": "685be2357b18742b5f19e137b60cc0d2", "body": {"id": "chatcmpl-BhLmN3ZNtGLHuF3bfLyk4vKd3byU6", "object": "chat.completion", "created": 1749671523, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Filter objects with at least 30 detections\n        o.ndet >= 30\n        -- Filter objects with a time span between first and last detection >= 200 days\n        AND (o.lastmjd - o.firstmjd) >= 200\n        -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in lc_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n              AND p.classifier_name = 'lc_classifier'\n              AND p.probability > 0.5\n        )\n)\n-- Retrieve all columns for the selected objects\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5026, "completion_tokens": 221, "total_tokens": 5247, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16e51ac81909565f03bdb50dac6", "custom_id": "21-3", "response": {"status_code": 200, "request_id": "bbc34e4660b06a98884def8ccd5f405f", "body": {"id": "chatcmpl-BhLmQOYQTLLEO6HCm5l38j7CSPV6h", "object": "chat.completion", "created": 1749671526, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as AGN, QSO, or Blazar by the lc_classifier with probability > 0.5\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Filter objects with at least 30 detections\n        o.ndet >= 30\n        -- Filter objects with a time span between first and last detection >= 200 days\n        AND (o.lastmjd - o.firstmjd) >= 200\n        -- Filter objects with probability > 0.5 for classes AGN, QSO, or Blazar in lc_classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n              AND p.classifier_name = 'lc_classifier'\n              AND p.probability > 0.5\n        )\n)\n-- Retrieve all columns for the selected objects\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5026, "completion_tokens": 221, "total_tokens": 5247, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16e724c8190a3d53a7ad78ddde9", "custom_id": "26-2", "response": {"status_code": 200, "request_id": "70cf6ee72f7fc7e73a2961fdccfaceec", "body": {"id": "chatcmpl-BhLmTWKVKdp45lMyAB7rHFPBdhDNo", "object": "chat.completion", "created": 1749671529, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n)\n-- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    JOIN probability p ON fo.oid = p.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n)\n-- Or objects with more than one detection\nOR o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    JOIN detection d ON fo.oid = d.oid\n    GROUP BY fo.oid\n    HAVING COUNT(d.candid) > 1\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3143, "completion_tokens": 231, "total_tokens": 3374, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16e90908190bc3cc08bff99652a", "custom_id": "26-3", "response": {"status_code": 200, "request_id": "54f52f9c2a684d8498fe0a4b2ffd73d2", "body": {"id": "chatcmpl-BhLmhLKTV8G2NuFXVtiPW3aOULSWN", "object": "chat.completion", "created": 1749671543, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects that appeared between August 25, 2022 (mjd 59816.0) and September 10, 2022 (mjd 59832.0)\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n)\n-- Filter objects classified as supernova ('SN') by stamp_classifier with probability > 0.5\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT fo.oid\n    FROM filtered_objects fo\n    JOIN probability p ON p.oid = fo.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n)\n-- Or objects with more than one detection\nOR o.oid IN (\n    SELECT o2.oid\n    FROM object o2\n    WHERE o2.ndet > 1\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3143, "completion_tokens": 210, "total_tokens": 3353, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16f30f08190a0ea40b69ecbd9d1", "custom_id": "29-2", "response": {"status_code": 200, "request_id": "1d160310b8b35b432b51a60e476619bb", "body": {"id": "chatcmpl-BhLmlkGrwEsjKNlKHjFvzjzh3rQ59", "object": "chat.completion", "created": 1749671547, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2710, "completion_tokens": 109, "total_tokens": 2819, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16f55248190a1949b8ed86e5682", "custom_id": "29-3", "response": {"status_code": 200, "request_id": "17e703cb1b5c06e9e382e5df03c724e9", "body": {"id": "chatcmpl-BhLmrVEunGEYjV1tzptuL46qRAGeR", "object": "chat.completion", "created": 1749671553, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq')\n)\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN (SELECT oid FROM selected_oids);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2710, "completion_tokens": 109, "total_tokens": 2819, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16f7ff08190a1e2f00e9ebc081f", "custom_id": "52-2", "response": {"status_code": 200, "request_id": "e6efebd03e3c63a45eda3098fc15e85f", "body": {"id": "chatcmpl-BhLmrYmYEp4q3fJX6YXbE6af9VRjH", "object": "chat.completion", "created": 1749671553, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 58, "total_tokens": 2655, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16f9e7081908aff79fdb99624e6", "custom_id": "52-3", "response": {"status_code": 200, "request_id": "71ddcb9e6f4432f524c777493e5ea625", "body": {"id": "chatcmpl-BhLujzo5yu3ZFRZf15ss0UvV20dSM", "object": "chat.completion", "created": 1749672041, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all columns from forced_photometry for specified objects with procstatus '0'\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 58, "total_tokens": 2655, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16fb9cc8190b45c9d0ec2249941", "custom_id": "109-2", "response": {"status_code": 200, "request_id": "05123514d0a6c124871fa6c6ea655890", "body": {"id": "chatcmpl-BhLqmo686UkXAn70PbIiS31AxzyIz", "object": "chat.completion", "created": 1749671796, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class_at_rank_1,\n    p.probability AS probability_at_rank_1,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier' AND\n    p.ranking = 1 AND\n    f.name = 'LinearTrend' AND\n    f.value > 5 AND\n    o.lastmjd - o.firstmjd > 1\nLIMIT 10;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5040, "completion_tokens": 160, "total_tokens": 5200, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16fd5548190a5aa1db648546378", "custom_id": "109-3", "response": {"status_code": 200, "request_id": "7c41db25a7be1dd2f18eee56e8f0c834", "body": {"id": "chatcmpl-BhLrRg4azEwuHhN2xc1ICwNN77nKM", "object": "chat.completion", "created": 1749671837, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name AS class,\n    p.probability,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier' \n    AND p.ranking = 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.lastmjd - o.firstmjd > 1\nLIMIT 10;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5040, "completion_tokens": 149, "total_tokens": 5189, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e16ff0c88190b579c379f6302dd3", "custom_id": "49-2", "response": {"status_code": 200, "request_id": "3caaf033488f7f446a1140767c246f05", "body": {"id": "chatcmpl-BhLsmUXD11O8RI9GeNbskIVoSQh9V", "object": "chat.completion", "created": 1749671920, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all feature rows for specified objects with features in the g band\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1; -- fid=1 corresponds to the g band\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4326, "completion_tokens": 61, "total_tokens": 4387, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1700c7c8190b79c071687c9e7ba", "custom_id": "49-3", "response": {"status_code": 200, "request_id": "9a6499223cc512f873b2a89237f8d64f", "body": {"id": "chatcmpl-BhLsuorZZ7CGeCnkM2eZPkjZv9gcE", "object": "chat.completion", "created": 1749671928, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all features in the 'feature' table for specified objects and the g band (fid=1)\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4808, "completion_tokens": 58, "total_tokens": 4866, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e170329c8190929299748aa8fddd", "custom_id": "46-2", "response": {"status_code": 200, "request_id": "79eb8f896b06070f3ab2b77edeead92a", "body": {"id": "chatcmpl-BhLlq0tIIGJf2aMpybueLSmrnPf1Z", "object": "chat.completion", "created": 1749671490, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2431, "completion_tokens": 28, "total_tokens": 2459, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1705a948190873fcf74cf6b9f48", "custom_id": "46-3", "response": {"status_code": 200, "request_id": "7a4e9da1313cda9b28d08610ac155920", "body": {"id": "chatcmpl-BhLlqjAZcewtnKfhiMV2GVRLt7UBJ", "object": "chat.completion", "created": 1749671490, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM detection \nWHERE oid = 'ZTF23aaqmddq' \nORDER BY mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2431, "completion_tokens": 28, "total_tokens": 2459, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1707ed481908339bb34d65be214", "custom_id": "93-2", "response": {"status_code": 200, "request_id": "83777ff725689d461e1e233502343b0f", "body": {"id": "chatcmpl-BhLlp5OgULYJbx830yHugVFGFtNwg", "object": "chat.completion", "created": 1749671489, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object OIDs where 'asteroid' is the top-ranked class in the stamp_classifier\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = p.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2823, "completion_tokens": 141, "total_tokens": 2964, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1709b148190b8acde8d19529c35", "custom_id": "93-3", "response": {"status_code": 200, "request_id": "4f825ecfcd2a1dc8e81b244141ec7b8d", "body": {"id": "chatcmpl-BhLlpsrnPwOSOyb1dglli46v9FsaT", "object": "chat.completion", "created": 1749671489, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and magstat tables for objects that meet the specified conditions\nSELECT p.*, m.*\nFROM (\n    -- Subquery to find object OIDs where 'asteroid' is the top-ranked class in the stamp_classifier\n    SELECT DISTINCT prob.oid\n    FROM probability prob\n    WHERE prob.class_name = 'asteroid'\n      AND prob.classifier_name = 'stamp_classifier'\n      AND prob.ranking = 1\n) AS sub\nJOIN probability p ON p.oid = sub.oid\nJOIN magstat m ON m.oid = sub.oid\nWHERE m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2823, "completion_tokens": 141, "total_tokens": 2964, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e170c7c081908ed66802bf02db82", "custom_id": "62-2", "response": {"status_code": 200, "request_id": "467b080519bc0dcde199b417cc19487e", "body": {"id": "chatcmpl-BhLlp5m02lGl8aBvSpFLSt3RvKo3f", "object": "chat.completion", "created": 1749671489, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    p.oid,\n    p.classifier_name,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM \n    probability p\nWHERE \n    p.oid = 'ZTF21aadoizf'\nORDER BY \n    p.classifier_name ASC,\n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2093, "completion_tokens": 78, "total_tokens": 2171, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e170f99481909f5361684e145b77", "custom_id": "62-3", "response": {"status_code": 200, "request_id": "11c067fa67e5384c6b23c71b0d22f5fb", "body": {"id": "chatcmpl-BhLluACBjZ175B6jls8RjE8JogZJe", "object": "chat.completion", "created": 1749671494, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    p.oid,\n    p.classifier_name,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM \n    probability p\nWHERE \n    p.oid = 'ZTF21aadoizf'\nORDER BY \n    p.classifier_name ASC,\n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2093, "completion_tokens": 78, "total_tokens": 2171, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17114c481909e0bd5ab98271f51", "custom_id": "95-2", "response": {"status_code": 200, "request_id": "1ff211b9b14809e4b2d0cbe0d1588320", "body": {"id": "chatcmpl-BhLlveBM7FHwXIZcee6nQdwNAEnl6", "object": "chat.completion", "created": 1749671495, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\nztf_ids AS (\n    SELECT * FROM ztf_objects\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        xm.catid AS catalog_id,\n        xm.oid_catalog,\n        xm.dist\n    FROM \n        object o\n    JOIN \n        xmatch xm ON o.oid = xm.oid\n    WHERE \n        o.oid IN (SELECT * FROM ztf_ids)\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and classifier version\nfeatures AS (\n    SELECT \n        f.oid AS ztf_oid,\n        f.name AS feature_name,\n        f.value\n    FROM \n        feature f\n    WHERE \n        f.oid IN (SELECT * FROM ztf_ids)\n        AND f.version = 'lc_classifier_1.2.1-P'\n        AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n)\n-- Join matches and features on object identifier, and prepare final output\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance_arcsec,\n    f.feature_name,\n    f.value\nFROM \n    matches m\nJOIN \n    features f ON m.ztf_oid = f.oid\nORDER BY \n    m.oid_catalog, f.feature_name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4995, "completion_tokens": 345, "total_tokens": 5340, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1713d4c819099755251a0905a46", "custom_id": "95-3", "response": {"status_code": 200, "request_id": "13e454ec9d38108c4c6c0d08841e8594", "body": {"id": "chatcmpl-BhLlzc2kCd603ObMkV2gGblZoQuIy", "object": "chat.completion", "created": 1749671499, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define a temporary table with the specified ZTF object identifiers\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF19aazhdoy'),\n        ('ZTF17aaaqqtd')\n),\n-- Retrieve matches for the specified ZTF objects\nmatches AS (\n    SELECT \n        o.oid AS ztf_oid,\n        x.catid,\n        x.oid_catalog,\n        x.dist\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.value\n    JOIN \n        xmatch x ON x.oid = o.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' for the specified objects and feature version\nfeatures AS (\n    SELECT \n        o.oid AS ztf_oid,\n        f.name,\n        f.value,\n        f.oid\n    FROM \n        ztf_objects z\n    JOIN \n        object o ON o.oid = z.value\n    JOIN \n        feature f ON f.oid = o.oid\n    WHERE \n        f.name IN ('W1-W2', 'g-W2', 'r-W2')\n        AND f.version = 'lc_classifier_1.2.1-P'\n)\n-- Join matches and features, and prepare final output\nSELECT \n    m.ztf_oid AS ztf_identifier,\n    m.catid AS catalog_identifier,\n    m.oid_catalog AS catalog_object_id,\n    m.dist AS distance_arcsec,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM \n    matches m\nJOIN \n    features f ON f.oid = (SELECT oid FROM object WHERE oid = m.oid_catalog)\nORDER BY \n    m.oid_catalog, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4995, "completion_tokens": 364, "total_tokens": 5359, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17161e48190ad9170b262951934", "custom_id": "85-2", "response": {"status_code": 200, "request_id": "624a628998b9e07981e1bfbbf8f20700", "body": {"id": "chatcmpl-BhLlzPzZXrdi8P8WRCg1IdpLbAXlG", "object": "chat.completion", "created": 1749671499, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3738, "completion_tokens": 104, "total_tokens": 3842, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17182308190a116f92d64f2ae15", "custom_id": "85-3", "response": {"status_code": 200, "request_id": "b6a51634e54408a4c5d96bb70a8186cb", "body": {"id": "chatcmpl-BhLm1UdofScgjyXp3SCwopXoLziV6", "object": "chat.completion", "created": 1749671501, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all detections for the specified object, sorted by detection date\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS magnitude_uncertainty,\n    dq.*\nFROM \n    detection d\nJOIN \n    dataquality dq ON d.candid = dq.candid\nWHERE \n    d.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3738, "completion_tokens": 104, "total_tokens": 3842, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1719c8c819090516af053ff6a01", "custom_id": "98-2", "response": {"status_code": 200, "request_id": "9a81d2a44ddb82c6b945fde4be7eb88f", "body": {"id": "chatcmpl-BhLm3QnEsjXdmWmmTjwfINL8RFceR", "object": "chat.completion", "created": 1749671503, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 200 distinct objects with high probability (>0.7) of being a QSO in the lc_classifier\nWITH high_prob_qso AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n    LIMIT 200\n)\n-- Retrieve matching information from xmatch and allwise tables for these objects\nSELECT \n    x.oid, x.catid, x.oid_catalog, x.dist, x.class_catalog, x.period,\n    aw.oid_catalog, aw.ra, aw.dec, aw.w1mpro, aw.w2mpro, aw.w3mpro, aw.w4mpro,\n    aw.w1sigmpro, aw.w2sigmpro, aw.w3sigmpro, aw.w4sigmpro,\n    aw.j_m_2mass, aw.h_m_2mass, aw.k_m_2mass,\n    aw.j_msig_2mass, aw.h_msig_2mass, aw.k_msig_2mass\nFROM \n    xmatch x\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    x.oid IN (SELECT oid FROM high_prob_qso);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3379, "completion_tokens": 294, "total_tokens": 3673, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e171ba988190b1ccefb6a03d517e", "custom_id": "98-3", "response": {"status_code": 200, "request_id": "be86dd549d1a65ecccd46d21e96301cf", "body": {"id": "chatcmpl-BhLm2kKaTDW1N3O1yEpjFfbnRoPHQ", "object": "chat.completion", "created": 1749671502, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 200 distinct ZTF objects with high probability (>0.7) of being a QSO according to the lc_classifier\nWITH high_prob_qso AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n    LIMIT 200\n)\n-- Retrieve all columns from xmatch and allwise tables for these objects\nSELECT xm.*, aw.*\nFROM xmatch xm\nJOIN high_prob_qso hp ON xm.oid = hp.oid\nLEFT JOIN allwise aw ON aw.oid_catalog = xm.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3379, "completion_tokens": 155, "total_tokens": 3534, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e171e3d481909a252b41c4779c7d", "custom_id": "82-2", "response": {"status_code": 200, "request_id": "c7ec574c4b311db26a470e36b5dcce7d", "body": {"id": "chatcmpl-BhLm2FvCP9zOxrRNX2Glu0tKb0qGB", "object": "chat.completion", "created": 1749671502, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2015, "completion_tokens": 42, "total_tokens": 2057, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17212c881908069f39d01073d1b", "custom_id": "82-3", "response": {"status_code": 200, "request_id": "425da5370bab22e80a3172d3df715ff1", "body": {"id": "chatcmpl-BhLm4KXuDuaE93oRWC7HrAlEhYxcR", "object": "chat.completion", "created": 1749671504, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2015, "completion_tokens": 42, "total_tokens": 2057, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17235e8819099e254457aea3aa8", "custom_id": "64-2", "response": {"status_code": 200, "request_id": "c0d6c552c3bc3f449c572207e166ea33", "body": {"id": "chatcmpl-BhLm7xfG5FWMuttWOcdjXQEsyhYf2", "object": "chat.completion", "created": 1749671507, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 1000 probability entries with probability > 0.95\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability AS \"probability\"\nFROM \n    probability p\nWHERE \n    p.probability > 0.95\n    AND p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nORDER BY \n    p.probability DESC\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2098, "completion_tokens": 122, "total_tokens": 2220, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1725dd081909905702381affe2b", "custom_id": "64-3", "response": {"status_code": 200, "request_id": "99c6c1f30437b5f889c90e117a75d400", "body": {"id": "chatcmpl-BhLm9Add80fnapqbz789OKTEp40xj", "object": "chat.completion", "created": 1749671509, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 1000 probability entries with probability > 0.95\nSELECT \n    p.oid AS \"ZTF identifier\",\n    p.classifier_name AS \"classifier name\",\n    p.classifier_version AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability\nFROM (\n    SELECT * FROM probability\n    WHERE probability > 0.95\n) p\nWHERE p.classifier_name IN ('lc_classifier_top', 'stamp_classifier')\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2098, "completion_tokens": 108, "total_tokens": 2206, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1727e448190b1d70cad2ad444fc", "custom_id": "87-2", "response": {"status_code": 200, "request_id": "6b2a2ad52387e875c90eb454e2f022a3", "body": {"id": "chatcmpl-BhLmBoAIFqWQmiRJLnYDODUcfoetK", "object": "chat.completion", "created": 1749671511, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the ranking is 1 (most probable class)\n    AND p.ranking = 1\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 195, "total_tokens": 2538, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e172b3588190af89037ed5c18d27", "custom_id": "87-3", "response": {"status_code": 200, "request_id": "cdef91ee4fd6e6dc06224175a643652e", "body": {"id": "chatcmpl-BhLmH6wOq26iXh2mf1FZ0xOuIVMJ6", "object": "chat.completion", "created": 1749671517, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and gaia_ztf tables for objects meeting the specified conditions\nWITH selected_objects AS (\n    -- Retrieve object OIDs with probability > 0.7 for either 'LPV' or 'E' classes in the specified classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name IN ('LPV', 'E')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n    -- Ensure the ranking is 1 (most probable class)\n    AND p.ranking = 1\n)\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND g.unique1 = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 195, "total_tokens": 2538, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e172ce0c8190b294d1688391ccbf", "custom_id": "108-2", "response": {"status_code": 200, "request_id": "412641f085e494ab4903230be81514fb", "body": {"id": "chatcmpl-BhLmMuvzrhDJ713F3RB2znzBucKW1", "object": "chat.completion", "created": 1749671522, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 15 objects with more than 20 detections and a high probability of being bogus\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        p.probability,\n        -- Calculate galactic latitude from mean RA and Dec\n        -- Assuming the existence of a function to convert equatorial to galactic coordinates\n        -- If not available, this part may need adjustment based on available functions\n        -- For now, we will assume a placeholder function 'eq_to_gal_lat' exists\n        -- If such function does not exist, this line should be replaced accordingly\n        -- Alternatively, omit 'gal_b' if conversion is not possible\n        -- Here, we proceed with a placeholder\n        -- Replace 'eq_to_gal_lat' with actual conversion if available\n        -- For demonstration, we will set gal_b as NULL\n        NULL AS gal_b\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.class_name = 'bogus'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.probability > 0.9\n        AND o.ndet > 20\n    ORDER BY\n        o.oid\n    LIMIT 15\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    probability AS \"probability\",\n    -- Placeholder for galactic latitude; replace with actual calculation if available\n    gal_b\nFROM\n    selected_objects;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3145, "completion_tokens": 341, "total_tokens": 3486, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e172eda881909bedc715e0dba5bc", "custom_id": "108-3", "response": {"status_code": 200, "request_id": "ad595767029cdc5461e255081750c14e", "body": {"id": "chatcmpl-BhLmS6itzVcl0zVtiKRGGlmJgHSYS", "object": "chat.completion", "created": 1749671528, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 15 objects with more than 20 detections and high probability of being bogus\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    p.probability AS \"probability\",\n    o.gal_b AS \"Galactic latitude\"\nFROM \n    object o\nWHERE \n    o.ndet > 20\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE \n            p.oid = o.oid\n            AND p.class_name = 'bogus'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.classifier_version = 'stamp_classifier_1.0.4'\n            AND p.probability > 0.9\n    )\nORDER BY \n    o.oid\nLIMIT 15;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5029, "completion_tokens": 175, "total_tokens": 5204, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1730b648190b161f04b4479557f", "custom_id": "65-2", "response": {"status_code": 200, "request_id": "9d1c396a5b43e1d2d4b28cac4c9957a6", "body": {"id": "chatcmpl-BhLls6FG5oDU323obRbO00K7nktse", "object": "chat.completion", "created": 1749671492, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM (\n    SELECT *\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n      AND class_name IN ('asteroid', 'bogus')\n      AND probability BETWEEN 0.7 AND 0.99\n    ORDER BY oid DESC\n) sub\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2099, "completion_tokens": 84, "total_tokens": 2183, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17327a88190b67fcce9e613e66b", "custom_id": "65-3", "response": {"status_code": 200, "request_id": "42d63d1f2db6eea58f03a598dee2f91b", "body": {"id": "chatcmpl-BhLlsOxNBv1bOZCLXLH4ll7BYXvGS", "object": "chat.completion", "created": 1749671492, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 500 probability records for the stamp_classifier with specified class names and probability range\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2099, "completion_tokens": 73, "total_tokens": 2172, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e173734881909b9d434579bd8ddb", "custom_id": "101-2", "response": {"status_code": 200, "request_id": "35bc523f28a7366016ccae8e98e37c6d", "body": {"id": "chatcmpl-BhLluvxQkTF46w6FrAQcRk7zjw7NT", "object": "chat.completion", "created": 1749671494, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT\n    p.*, -- all columns from probability table\n    x.*, -- all columns from xmatch table\n    w.*  -- all columns from allwise table\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nJOIN xmatch x ON so.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2924, "completion_tokens": 211, "total_tokens": 3135, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1739bd081908e5a0464c088cd39", "custom_id": "101-3", "response": {"status_code": 200, "request_id": "d15f1c27a7da67fb1fe7138499523d2b", "body": {"id": "chatcmpl-BhLlsuuZv605FOnoZvnwNH0lCuOcG", "object": "chat.completion", "created": 1749671492, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.5 of being a Long Period Variable (LPV) in the light curve classifier\n-- and WISE W1 magnitude between 7 and 8, limiting to 100 results\nWITH selected_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'LPV'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n    LIMIT 100\n)\nSELECT\n    p.*, -- all columns from probability table\n    x.*, -- all columns from xmatch table\n    w.*  -- all columns from allwise table\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nJOIN xmatch x ON so.oid = x.oid\nJOIN allwise w ON x.oid_catalog = w.oid_catalog\nWHERE w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2924, "completion_tokens": 211, "total_tokens": 3135, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e173baf88190bd536ccdd899e1db", "custom_id": "88-2", "response": {"status_code": 200, "request_id": "6d3bcac2f74051c45adda6e3e3a6be57", "body": {"id": "chatcmpl-BhLludg6qBmf2PQ9yoOIt1a5Bpp0a", "object": "chat.completion", "created": 1749671494, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH bogus_objects AS (\n    SELECT\n        p.oid,\n        COUNT(d.candid) AS num_detections,\n        AVG(o.meanra) AS mean_ra,\n        AVG(o.meandec) AS mean_dec,\n        p.classifier_version,\n        p.probability\n    FROM\n        probability p\n    JOIN\n        object o ON p.oid = o.oid\n    JOIN\n        detection d ON d.oid = o.oid\n    WHERE\n        p.class_name = 'bogus'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n    GROUP BY\n        p.oid, p.classifier_version, p.probability\n    HAVING\n        COUNT(d.candid) >= 20\n)\nSELECT\n    oid AS ztf_object_id,\n    num_detections,\n    mean_ra,\n    mean_dec,\n    classifier_version,\n    probability\nFROM\n    bogus_objects\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3134, "completion_tokens": 237, "total_tokens": 3371, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e173d5cc8190988518c7f024c967", "custom_id": "88-3", "response": {"status_code": 200, "request_id": "be0ebc958899be1b444aeb8e66cf5d6c", "body": {"id": "chatcmpl-BhLlv7irwpCmZkvXtOpr33V6aB2y1", "object": "chat.completion", "created": 1749671495, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with 'bogus' class as ranking 1 in stamp_classifier, at least 20 detections, and limit to 50 results\nWITH bogus_objects AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'bogus'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nobject_counts AS (\n    SELECT o.oid, COUNT(d.candid) AS detection_count, AVG(o.meanra) AS mean_ra, AVG(o.meandec) AS mean_dec\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n)\nSELECT \n    o.oid AS ztf_id,\n    oc.detection_count,\n    ST_MakePoint(oc.mean_ra, oc.mean_dec) AS mean_ra_dec,\n    p.classifier_version,\n    p.probability\nFROM object_counts oc\nJOIN bogus_objects p ON oc.oid = p.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3134, "completion_tokens": 239, "total_tokens": 3373, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e173fea48190b438d42f5d1593b3", "custom_id": "70-2", "response": {"status_code": 200, "request_id": "5302d26dcc51134c4e1a7936c6af03fd", "body": {"id": "chatcmpl-BhLlwmN5nfcuut4gvvN0voDO10QnK", "object": "chat.completion", "created": 1749671496, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2726, "completion_tokens": 22, "total_tokens": 2748, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e174237c819088120c03146f8db8", "custom_id": "70-3", "response": {"status_code": 200, "request_id": "83643835715cf2219c78720bd696fa0a", "body": {"id": "chatcmpl-BhLm3tadTEZEjtek8IMyOk9asdUqJ", "object": "chat.completion", "created": 1749671503, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF22aayjqah';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2726, "completion_tokens": 22, "total_tokens": 2748, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17442f48190b5a24213b5a132a3", "custom_id": "53-2", "response": {"status_code": 200, "request_id": "c64152734d2922de672ed0b0870852f4", "body": {"id": "chatcmpl-BhLm5X13UOkrE5pYnIjb5fvDm4Mza", "object": "chat.completion", "created": 1749671505, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2007, "completion_tokens": 62, "total_tokens": 2069, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e174668c8190b90756e8d0d98153", "custom_id": "53-3", "response": {"status_code": 200, "request_id": "88bd013816dca4df68749d9c9a85bede", "body": {"id": "chatcmpl-BhLm68YSKCV0btn807OMRaEq8o33V", "object": "chat.completion", "created": 1749671506, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    nd.mjd AS date,\n    nd.fid AS filter_id,\n    nd.oid AS ztf_id,\n    nd.diffmaglim AS mag_limit\nFROM \n    non_detection nd\nWHERE \n    nd.oid = 'ZTF18adqxemz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2007, "completion_tokens": 62, "total_tokens": 2069, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17485a48190b3d00a5f5e20e62f", "custom_id": "77-2", "response": {"status_code": 200, "request_id": "6ddc65983fc0d65939c28ab3cb5c387f", "body": {"id": "chatcmpl-BhLmGKl98yGenwA4noYSANsNR7K3E", "object": "chat.completion", "created": 1749671516, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from ss_ztf where the object is at zero distance from specified solar system identifiers\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2068, "completion_tokens": 63, "total_tokens": 2131, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e174b0888190a5cb0b128040b58a", "custom_id": "77-3", "response": {"status_code": 200, "request_id": "4380fc11f0aa98ba9f3103a4b5e24be2", "body": {"id": "chatcmpl-BhLm9LwRDBkZNFjovWN962An5OGyr", "object": "chat.completion", "created": 1749671509, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from ss_ztf where the object is at zero distance from specified solar system identifiers\nSELECT *\nFROM ss_ztf\nWHERE ssdistnr = 0\n  AND ssnamenr IN ('213673', '49894')\nORDER BY oid, candid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2068, "completion_tokens": 63, "total_tokens": 2131, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e174cdac81909049d0dd1a127eeb", "custom_id": "105-2", "response": {"status_code": 200, "request_id": "fabfa64f4c31348f4c99f25f9848a748", "body": {"id": "chatcmpl-BhLmE3v6mxdXg898LCEQbjhXN0rio", "object": "chat.completion", "created": 1749671514, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 50 objects with specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Subquery to get the top probability for AGN in the specified classifier\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        ORDER BY ranking ASC\n        LIMIT 1\n    ) p ON o.oid = p.oid\n    -- Filter objects with probability > 0.7\n    WHERE p.probability > 0.7\n),\nps1_sources AS (\n    SELECT oid, objectidps1, sgscore1, distpsnr1\n    FROM ps1_ztf\n),\n-- Filter objects based on PS1 proximity and star/galaxy score difference\nfiltered_objects AS (\n    SELECT so.oid, so.probability\n    FROM selected_objects so\n    JOIN ps1_sources ps ON so.oid = ps.oid\n    WHERE ps.distpsnr1 < 2\n      AND ABS(ps.sgscore1 - (SELECT sgscore FROM object WHERE oid = so.oid)) < 0.5\n),\n-- Retrieve detection details for the selected objects\ndetections AS (\n    SELECT d.oid, d.candid, d.fid, d.chi, d.sgscore\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM filtered_objects)\n),\n-- Retrieve object info for the selected objects\nobjects_info AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n)\n-- Final selection with all required columns\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    d.candid,\n    d.fid,\n    d.chi AS reduced_chi_square,\n    d.sgscore AS sextractor_sgscore,\n    ps.objectidps1,\n    ps.sgscore1 AS ps1_sgscore,\n    ps.distpsnr1 AS ps1_distance\nFROM filtered_objects fo\nJOIN probability p ON fo.oid = p.oid AND p.class_name = 'AGN' AND p.classifier_name = 'lc_classifier' AND p.classifier_version = 'hierarchical_rf_1.1.0'\nJOIN objects_info o ON fo.oid = o.oid\nLEFT JOIN detections d ON o.oid = d.oid\nLEFT JOIN ps1_sources ps ON o.oid = ps.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3788, "completion_tokens": 551, "total_tokens": 4339, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e174f3b48190b32e027de370f436", "custom_id": "105-3", "response": {"status_code": 200, "request_id": "4b14205ee3f09bb2c38a1f8649606836", "body": {"id": "chatcmpl-BhLmWPamairTl2tFfALhmoxwFnjIt", "object": "chat.completion", "created": 1749671532, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 50 objects satisfying the specified conditions\nWITH selected_objects AS (\n    SELECT o.oid, p.probability\n    FROM object o\n    -- Subquery to get the top probability of being an AGN in the hierarchical_rf_1.1.0 classifier\n    JOIN (\n        SELECT oid, probability\n        FROM probability\n        WHERE class_name = 'AGN'\n          AND classifier_name = 'lc_classifier'\n          AND classifier_version = 'hierarchical_rf_1.1.0'\n        -- Rank probabilities to get the most probable class per object\n        QUALIFY ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) = 1\n    ) p ON o.oid = p.oid\n    WHERE p.probability > 0.7\n),\nnearest_ps1 AS (\n    SELECT\n        xm.oid,\n        xm.oid_catalog,\n        xm.dist,\n        ps1.sgscore1,\n        ps1.objectidps1\n    FROM xmatch xm\n    JOIN ps1_ztf ps1 ON xm.oid = ps1.oid\n    WHERE xm.catid = 'PS1'\n      AND xm.dist < 2\n),\nstar_galaxy_score_diff AS (\n    SELECT\n        o.oid,\n        -- Assuming 'sgscore1' from PS1 and 'sgscore1' from SExtractor are available\n        -- For SExtractor score, assuming it's stored in feature table with name 'sgscore1' and fid=1\n        -- If not, this part needs adjustment based on actual feature storage\n        (f_ps1.value - f_sextractor.value) AS sgscore_diff\n    FROM selected_objects so\n    JOIN object o ON so.oid = o.oid\n    LEFT JOIN feature f_ps1 ON o.oid = f_ps1.oid AND f_ps1.name = 'sgscore1' AND f_ps1.fid = 1\n    LEFT JOIN feature f_sextractor ON o.oid = f_sextractor.oid AND f_sextractor.name = 'sgscore1' AND f_sextractor.fid = 1\n    WHERE f_ps1.version = 'ps1_version_placeholder' -- replace with actual version if known\n      AND f_sextractor.version = 'sextractor_version_placeholder' -- replace with actual version if known\n)\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    -- Epoch details: candidate and filter_id, reduced chi-square, sgscore from SExtractor\n    -- Assuming epoch info is stored in detection table, which is not provided, so this is a placeholder\n    -- Replace with actual epoch table if available\n    d.candid,\n    d.filterid,\n    d.chi2red,\n    -- sgscore from SExtractor, assuming stored in feature table\n    f_sextractor.value AS sgscore_sextractor,\n    -- PS1 nearest source info\n    np.objectidps1,\n    np.sgscore1 AS ps1_sgscore,\n    np.dist AS ps1_distance\nFROM selected_objects o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN detection d ON o.oid = d.oid\nLEFT JOIN feature f_sextractor ON o.oid = f_sextractor.oid AND f_sextractor.name = 'sgscore1' AND f_sextractor.fid = 1\nLEFT JOIN nearest_ps1 np ON o.oid = np.oid\nWHERE\n    -- Conditions for star/galaxy score difference\n    (f_ps1.value - f_sextractor.value) < 0.5\nORDER BY p.probability DESC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5967, "completion_tokens": 769, "total_tokens": 6736, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e175111081909a9ed2926b8539b3", "custom_id": "86-2", "response": {"status_code": 200, "request_id": "ee87174dc737fd618cce8db444d68360", "body": {"id": "chatcmpl-BhLmZFYGCJYafzPCuAY1JFTj7nqMZ", "object": "chat.completion", "created": 1749671535, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to get object OIDs with probability > 0.6 for classes Cepheid, delta Scuti, or RR Lyrae\n    SELECT DISTINCT prob.oid\n    FROM probability prob\n    WHERE prob.class_name IN ('CEP', 'DSCT', 'RRL')\n      AND prob.classifier_name = 'lc_classifier'\n      AND prob.classifier_version = 'hierarchical_rf_1.1.0'\n      AND prob.probability > 0.6\n      AND prob.ranking = 1\n) AS filtered_oids\nJOIN probability p ON p.oid = filtered_oids.oid\nJOIN ps1_ztf ps ON ps.oid = filtered_oids.oid\nWHERE ps.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3371, "completion_tokens": 193, "total_tokens": 3564, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17531b88190bd7a0f6a34a3766b", "custom_id": "86-3", "response": {"status_code": 200, "request_id": "bbb8b4c73e91481872fcc2e8a441389f", "body": {"id": "chatcmpl-BhLmxbrZeXXdywWtf20FaJPqfOZlZ", "object": "chat.completion", "created": 1749671559, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects meeting the specified conditions\nSELECT p.*, ps.*\nFROM (\n    -- Subquery to select object IDs with probability > 0.6 for Cepheid, Delta Scuti, or RR Lyrae in the specified classifier\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n      AND class_name IN ('CEP', 'DSCT', 'RRL')\n      AND probability > 0.6\n) AS sub\nJOIN object AS o ON o.oid = sub.oid\nJOIN probability AS p ON p.oid = o.oid\nJOIN ps1_ztf AS ps ON ps.oid = o.oid\nWHERE p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND ps.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3371, "completion_tokens": 238, "total_tokens": 3609, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1754c708190a8d13453e57b450f", "custom_id": "41-2", "response": {"status_code": 200, "request_id": "ff41775a630dcc618595873f05009470", "body": {"id": "chatcmpl-BhLn6lOEnfg20jgaLgJF9vq09hE2n", "object": "chat.completion", "created": 1749671568, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0 / 3600 AS r_deg -- 5 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0 / 3600 -- 10 arcsec in degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_err_w1\n    FROM input_objects io\n    JOIN allwise aw\n        ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_Mag\",\n    mag_err_w1 AS \"W1_Mag_Error\"\nFROM search_results;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3298, "completion_tokens": 269, "total_tokens": 3567, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17567c881908ffb63f73bad7795", "custom_id": "41-3", "response": {"status_code": 200, "request_id": "90381bfd7f94f4bfa111365a0e7b8f86", "body": {"id": "chatcmpl-BhLn60WGRLLt4JnKMWLHclEzUg6Yl", "object": "chat.completion", "created": 1749671568, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0/3600 AS r_deg -- 5 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600 -- 10 arcsec in degrees\n),\nsearch_results AS (\n    SELECT\n        io.id AS id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg AS r_deg,\n        aw.oid_catalog,\n        aw.ra AS aw_ra,\n        aw.dec AS aw_dec,\n        aw.w1mpro AS mag_w1,\n        aw.w1sigmpro AS mag_uncertainty\n    FROM input_objects io\n    JOIN allwise aw ON q3c_join(io.ra, io.dec, aw.ra, aw.dec, io.r_deg)\n)\nSELECT\n    id,\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog AS \"ALLWISE_catalog_id\",\n    aw_ra AS \"RA\",\n    aw_dec AS \"Dec\",\n    mag_w1 AS \"W1_magnitude\",\n    mag_uncertainty AS \"W1_magnitude_uncertainty\"\nFROM search_results;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3298, "completion_tokens": 268, "total_tokens": 3566, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1758af88190acd083ca319edf56", "custom_id": "74-2", "response": {"status_code": 200, "request_id": "0d2715e70f191ebbf1dd8b8b57358932", "body": {"id": "chatcmpl-BhLn7mvJVdn5hM9CbLaOMCKOgdS6C", "object": "chat.completion", "created": 1749671569, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf, matching by object OID\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2107, "completion_tokens": 213, "total_tokens": 2320, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e175ba108190b457cae7b7ed27d9", "custom_id": "74-3", "response": {"status_code": 200, "request_id": "44b6aff0f0a70a78e4abaf1effe336bb", "body": {"id": "chatcmpl-BhLnE0unEWtaTjGeEVxgLT9QBzlWt", "object": "chat.completion", "created": 1749671576, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define a temporary table with the specified ZTF objects\nWITH ztf_objects AS (\n    VALUES \n        ('ZTF20abmaqeh', 'ZTF20abmaqeh'),\n        ('ZTF18abwxduj', 'ZTF18abwxduj'),\n        ('ZTF19aactlln', 'ZTF19aactlln')\n) AS ztf_ids(ztf_oid, ztf_identifier)\n\n-- Select all MPC objects brighter than 19.2 mag from ss_ztf, matching by object OID\nSELECT \n    ztf_identifier AS ztf_object_id,\n    sss.ssnamenr AS mpc_object_id,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    ztf_objects\nJOIN \n    ss_ztf sss ON sss.oid = ztf_ids.ztf_oid\nWHERE \n    sss.ssmagnr < 19.2\nORDER BY \n    sss.ssmagnr DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2107, "completion_tokens": 213, "total_tokens": 2320, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e175d7cc8190be13cc84a42c1a8c", "custom_id": "97-2", "response": {"status_code": 200, "request_id": "c38a0eea468ac04793cd353ff2febf2d", "body": {"id": "chatcmpl-BhLlvy6ENoXy7qGLTDVsrdeTo18MH", "object": "chat.completion", "created": 1749671495, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n         LIMIT 1) AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier'\n         LIMIT 1) AS prob_lc_lpv\n    FROM object o\n    WHERE\n        -- Ensure the object has probabilities above the thresholds\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4') > 0.6\n        AND\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier') > 0.7\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn AS \"prob_stamp_agn\",\n    prob_lc_lpv AS \"prob_lc_lpv\"\nFROM selected_objects\nWHERE prob_stamp_agn IS NOT NULL AND prob_lc_lpv IS NOT NULL\nORDER BY prob_stamp_agn DESC, prob_lc_lpv DESC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 403, "total_tokens": 3027, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e175f3688190bc22152903c1cae2", "custom_id": "97-3", "response": {"status_code": 200, "request_id": "cd9f0d21d650e5934ebefe4b80793863", "body": {"id": "chatcmpl-BhLlw0bQzbOYPkEzOB0oYNYA1t706", "object": "chat.completion", "created": 1749671496, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 50 objects with specified classification probabilities\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        -- Retrieve the probability of being an AGN from the stamp classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'AGN'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n         LIMIT 1) AS prob_stamp_agn,\n        -- Retrieve the probability of being an LPV from the light curve classifier\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'LPV'\n           AND p.classifier_name = 'lc_classifier'\n         LIMIT 1) AS prob_lc_lpv\n    FROM object o\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    prob_stamp_agn,\n    prob_lc_lpv\nFROM selected_objects\nWHERE\n    prob_stamp_agn > 0.6\n    AND prob_lc_lpv > 0.7\nORDER BY prob_stamp_agn DESC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2624, "completion_tokens": 258, "total_tokens": 2882, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1761ae4819097c95c5e1f3696cf", "custom_id": "66-2", "response": {"status_code": 200, "request_id": "f731a19e6c92389139a928dce092f65e", "body": {"id": "chatcmpl-BhLlvx1BkazSo7LFIXrRYeOyVjnyk", "object": "chat.completion", "created": 1749671495, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT g.oid AS ztf_oid, g.candid, g.neargaia, g.maggaia,\n           q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n    ORDER BY distance_deg\n    LIMIT 1\n)\nSELECT ztf_oid, distance_deg AS distance_in_degrees, maggaia AS Gaia_magnitude\nFROM nearest_gaia;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2584, "completion_tokens": 172, "total_tokens": 2756, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e17638708190b7972954253208b7", "custom_id": "66-3", "response": {"status_code": 200, "request_id": "ad2333690135f9857189f9c08cb77a9f", "body": {"id": "chatcmpl-BhLlvrmtVzCesyHEvSrVd8D6jgtIi", "object": "chat.completion", "created": 1749671495, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the nearest Gaia object to the specified ZTF object along with the distance and Gaia magnitude\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF22abftjko'\n),\nnearest_gaia AS (\n    SELECT g.oid AS ztf_oid, g.candid, g.neargaia, g.maggaia,\n           q3c_dist(z.meanra, z.meandec, g.neargaia, g.maggaia) AS distance_deg\n    FROM gaia_ztf g\n    JOIN ztf_object z ON TRUE\n    ORDER BY distance_deg\n    LIMIT 1\n)\nSELECT ztf_oid, distance_deg AS distance_in_degrees, maggaia AS Gaia_magnitude\nFROM nearest_gaia;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2584, "completion_tokens": 172, "total_tokens": 2756, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1765cd08190ac63c76a947998f7", "custom_id": "50-2", "response": {"status_code": 200, "request_id": "d46d171414fac7cb0450d8c88781d359", "body": {"id": "chatcmpl-BhLlx4HTRGOumU4lo2nYDdjfrAeev", "object": "chat.completion", "created": 1749671497, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve features for specified objects with version 'lc_classifier_1.2.1-P'\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\"\nFROM \n    feature f\nJOIN \n    object o ON f.oid = o.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5023, "completion_tokens": 131, "total_tokens": 5154, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1768b7c8190b031bf677a44727d", "custom_id": "50-3", "response": {"status_code": 200, "request_id": "66e0764680cb1318ec2cd37b9659386c", "body": {"id": "chatcmpl-BhLm3XQVhMhMz33xBefgTPCMFGd1L", "object": "chat.completion", "created": 1749671503, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the specified features for the given objects with version 'lc_classifier_1.2.1-P'\nSELECT \n    o.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\"\nFROM \n    object o\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n    AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY \n    o.oid, f.fid, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5023, "completion_tokens": 134, "total_tokens": 5157, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e176ae20819090e2e38e2cd4647d", "custom_id": "91-2", "response": {"status_code": 200, "request_id": "5ec1e24ec03f0c75e7107af1985b84f1", "body": {"id": "chatcmpl-BhLm36VzirqXf3qzbpi3WLOT3xC5S", "object": "chat.completion", "created": 1749671503, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 feature value less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4843, "completion_tokens": 264, "total_tokens": 5107, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e176c8a88190b3c9dfcfdb20b3b2", "custom_id": "91-3", "response": {"status_code": 200, "request_id": "e341513093d2bdd9b1a0a6aa73632e96", "body": {"id": "chatcmpl-BhLmBjfUzwj720x679bAVrQpq7SAH", "object": "chat.completion", "created": 1749671511, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select ZTF object identifier, number of detections, difference between min g-r and r-g magnitudes, W1-W2 feature value, and feature version\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g_r_min.value - f_r_g_min.value) AS mag_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table to get g-r_min, r_min, and W1-W2 features\nJOIN \n    feature f_g_r_min ON o.oid = f_g_r_min.oid AND f_g_r_min.name = 'g-r_min'\nJOIN \n    feature f_r_g_min ON o.oid = f_r_g_min.oid AND f_r_g_min.name = 'r-g_min'\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\n-- Filter for W1-W2 color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4843, "completion_tokens": 263, "total_tokens": 5106, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e176faa48190a043cc9c33cc9ecf", "custom_id": "68-2", "response": {"status_code": 200, "request_id": "5ecfa0ab7b34bf0fce529ba6d5deb838", "body": {"id": "chatcmpl-BhLmCFZN6gHWD5J9LbCS9STSQJeB8", "object": "chat.completion", "created": 1749671512, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the PS1 source information for the closest PS1 source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec)\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3136, "completion_tokens": 207, "total_tokens": 3343, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1771a04819090e78311ea0df976", "custom_id": "68-3", "response": {"status_code": 200, "request_id": "c2f29804a94cc9de58610cd182cc8c31", "body": {"id": "chatcmpl-BhLmFRuCfCi2lXj4ra1yRMdfRuX95", "object": "chat.completion", "created": 1749671515, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the PS1 source information for the closest source to the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF21abfrbnm'\n),\nnearest_ps1 AS (\n    SELECT \n        p.objectidps1,\n        p.sgmag1,\n        p.sgscore1,\n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec) AS distance_deg\n    FROM \n        ps1_ztf p,\n        ztf_object o\n    ORDER BY \n        q3c_dist(o.meanra, o.meandec, p.ra, p.dec)\n    LIMIT 1\n)\nSELECT \n    objectidps1 AS ps1_identifier,\n    sgmag1 AS g_band_magnitude,\n    sgscore1 AS star_galaxy_score,\n    distance_deg AS distance_to_ztf_object_deg\nFROM nearest_ps1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3136, "completion_tokens": 205, "total_tokens": 3341, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e177388c8190b83b1d86935c4631", "custom_id": "60-2", "response": {"status_code": 200, "request_id": "51869492994e4976214c59bb172412ff", "body": {"id": "chatcmpl-BhLmfym4GJobSU2Sm3JAS4q8C2sFu", "object": "chat.completion", "created": 1749671541, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3127, "completion_tokens": 125, "total_tokens": 3252, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1775a4c819086b99d38c78482e2", "custom_id": "60-3", "response": {"status_code": 200, "request_id": "0963999601a9769e39adadd7965381f1", "body": {"id": "chatcmpl-BhLmoYS4l8cW61yjQvXKciI2ntbaI", "object": "chat.completion", "created": 1749671550, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    m.ndet AS \"number of detections\",\n    m.dmdt_first AS \"initial rise estimate\",\n    m.dm_first AS \"first difference magnitude\"\nFROM \n    object o\nJOIN \n    magstat m ON o.oid = m.oid\nWHERE \n    o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n    AND m.fid = 1 -- g band\n    AND m.ndubious = 0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3127, "completion_tokens": 125, "total_tokens": 3252, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1777714819088b4cc140a50b129", "custom_id": "76-2", "response": {"status_code": 200, "request_id": "cade973279b7db27bf0c1a22e890a937", "body": {"id": "chatcmpl-BhLms5jPDeilBzy9aX8NX03RRO22Z", "object": "chat.completion", "created": 1749671554, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH mpc_object AS (\n    SELECT oid, ssmagnr\n    FROM ss_ztf\n    WHERE oid = '115185'\n),\nztf_objects AS (\n    SELECT o.oid AS ztf_oid, o.meanra, o.meandec\n    FROM object o\n    JOIN mpc_object m ON q3c_join(o.meanra, o.meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object), 1.5/3600)\n)\nSELECT ztf_oid, ssmagnr, q3c_dist(meanra, meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object)) AS distance_deg\nFROM ztf_objects\nJOIN ss_ztf ON ss_ztf.oid = ztf_objects.oid\nWHERE q3c_join(meanra, meandec, (SELECT meanra FROM mpc_object), (SELECT meandec FROM mpc_object), 1.5/3600)\nORDER BY distance_deg;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2669, "completion_tokens": 224, "total_tokens": 2893, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e177d5148190a597d48c9aace871", "custom_id": "76-3", "response": {"status_code": 200, "request_id": "dae01feb04fcbe92e2cf1020d4cb34fe", "body": {"id": "chatcmpl-BhLmyMz5Q7wjujUFzhxhE5TZQW1ih", "object": "chat.completion", "created": 1749671560, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define a temporary table with the MPC object coordinates for '115185'\nWITH mpc_object AS (\n    SELECT ra, dec\n    FROM xmatch\n    WHERE oid_catalog = '115185'\n    LIMIT 1\n),\n-- Select ZTF objects within 1.5 arcsec of the MPC object\nztf_near_mpc AS (\n    SELECT \n        o.oid AS ztf_id,\n        s.ssmagnr AS mpc_magnitude,\n        q3c_dist(o.meanra, o.meandec, m.ra, m.dec) AS distance_deg\n    FROM \n        object o,\n        mpc_object m,\n        ss_ztf s\n    WHERE \n        q3c_join(o.meanra, o.meandec, m.ra, m.dec, 1.5/3600.0) -- 1.5 arcsec converted to degrees\n        AND s.oid = o.oid\n)\n-- Select and sort by distance\nSELECT \n    ztf_id,\n    mpc_magnitude,\n    distance_deg * 3600 AS distance_arcsec -- convert degrees to arcseconds\nFROM \n    ztf_near_mpc\nORDER BY \n    distance_deg;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2669, "completion_tokens": 254, "total_tokens": 2923, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e177f0608190903ac484969debde", "custom_id": "44-2", "response": {"status_code": 200, "request_id": "3eed92db367f5e53745ae146eda97a8c", "body": {"id": "chatcmpl-BhLmz2JpmGeImvUC19uRmNUayVH4A", "object": "chat.completion", "created": 1749671561, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3201, "completion_tokens": 75, "total_tokens": 3276, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6849e1780f8c819097e9869031e66c5a", "custom_id": "44-3", "response": {"status_code": 200, "request_id": "91f67c451ed80669d854b46c88f7c7f1", "body": {"id": "chatcmpl-BhLn2wC4MPhCFADH2dTFf0x7MxH4n", "object": "chat.completion", "created": 1749671564, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from dataquality for specified objects with reduced chi-square < 3\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND dq.chipsf < 3\nORDER BY dq.oid ASC, dq.scorr DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3201, "completion_tokens": 75, "total_tokens": 3276, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
