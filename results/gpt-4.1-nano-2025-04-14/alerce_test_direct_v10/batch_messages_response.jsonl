{"id": "batch_req_6882a1326e5481908ca75a05687525d5", "custom_id": "8-0", "response": {"status_code": 200, "request_id": "b34fc9a3930b5d4d9cc5373920a6e051", "body": {"id": "chatcmpl-BwxFHdPBIjsUbmXZgegsiIn4aUyMv", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects that meet the above criteria or have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3118, "completion_tokens": 162, "total_tokens": 3280, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1324c04819094d5451c7b8a025e", "custom_id": "8-1", "response": {"status_code": 200, "request_id": "4f1c45024d88efd70046bf3e305d824e", "body": {"id": "chatcmpl-BwxFHEhe91vGbR5GRdSpDHjzUctY3", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve object OIDs classified as SN by the stamp classifier with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n    )\n    UNION\n    -- Include objects with at least two detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 2\n)\n-- Select all objects that meet either condition and were first classified as SN between August 17 and August 21\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM sn_objects)\n  AND firstmjd BETWEEN 60173.0 AND 60177.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3118, "completion_tokens": 183, "total_tokens": 3301, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13249288190ac92467cc5c224c0", "custom_id": "8-2", "response": {"status_code": 200, "request_id": "500ca14cc4264f47bb5aced9ec461aea", "body": {"id": "chatcmpl-BwxFDzYdF2iaoNEPDsBqSP9opi22B", "object": "chat.completion", "created": 1753390459, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n  AND o.ndet >= 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3163, "completion_tokens": 161, "total_tokens": 3324, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1324b508190b4a1dd49d0153d65", "custom_id": "8-3", "response": {"status_code": 200, "request_id": "f8b88180c1865260baa49e14b4ad0883", "body": {"id": "chatcmpl-BwxFFss8wmLx8cU41ywqyn9C0Gt0n", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5 or at least two detections\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Check if the object was first classified as SN by the stamp classifier\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'SN'\n              AND p.classifier_name = 'stamp_classifier'\n              AND p.probability > 0.5\n        )\n        AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Objects first classified as SN in the specified period with probability > 0.5\n    SELECT oid FROM sn_objects\n)\nOR o.ndet >= 2; -- Or objects with at least two detections\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3163, "completion_tokens": 207, "total_tokens": 3370, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1324f248190981f608826c4ab78", "custom_id": "8-4", "response": {"status_code": 200, "request_id": "4b55d6850b1acd1fc129ec92364db8eb", "body": {"id": "chatcmpl-BwxFFbENToHXQSbexftsnwIeXh9nD", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3163, "completion_tokens": 161, "total_tokens": 3324, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13257e4819092c6701d81dfa783", "custom_id": "8-5", "response": {"status_code": 200, "request_id": "4e388b5b686f03b9b7016d670d1de6c8", "body": {"id": "chatcmpl-BwxFG80TpowIgTkJ28uDqXpiRMZHG", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\n-- Select objects with at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3163, "completion_tokens": 168, "total_tokens": 3331, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132597881909d2e500946055da5", "custom_id": "8-6", "response": {"status_code": 200, "request_id": "7724d6efb84b7c40615d2df066e4ead9", "body": {"id": "chatcmpl-BwxFIZxloLZGCTn878DnxiNtfXM2X", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3163, "completion_tokens": 161, "total_tokens": 3324, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1324a448190b4024794689ac8ab", "custom_id": "8-7", "response": {"status_code": 200, "request_id": "8d55b280d0682b816c75305f552225b6", "body": {"id": "chatcmpl-BwxG9u2kzhFwkSi6bwNBJ2eRAmbFm", "object": "chat.completion", "created": 1753390517, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n      OR o.ndet >= 2\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3163, "completion_tokens": 146, "total_tokens": 3309, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13285f08190857598dbf0ca28b7", "custom_id": "8-8", "response": {"status_code": 200, "request_id": "e5768c3d9e825ad44b074ab745999a93", "body": {"id": "chatcmpl-BwxFK2XGBcCEJPkVHfpb28345GXdK", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\n-- Select objects with at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3163, "completion_tokens": 168, "total_tokens": 3331, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13247ec8190b9de5782dcb1b89b", "custom_id": "8-9", "response": {"status_code": 200, "request_id": "57119a0535b6c4d395055d1a18b685fa", "body": {"id": "chatcmpl-BwxFBROFXO7iSAQwhLwDzF7G4IbKv", "object": "chat.completion", "created": 1753390457, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5 or at least two detections\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n      OR o.ndet >= 2\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3163, "completion_tokens": 159, "total_tokens": 3322, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132c6488190b43d6b2528765f73", "custom_id": "27-0", "response": {"status_code": 200, "request_id": "3daedf1f229b040c8cb4a0e8a40c6235", "body": {"id": "chatcmpl-BwxFEBLOyozdRS3dHiU4o2y9OqMf7", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'CEP' -- Assuming 'CEP' is the class name for Cepheid variables\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification_ranks AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    cr.class_name,\n    cr.ranking,\n    cr.probability\nFROM selected_objects so\nJOIN classification_ranks cr ON so.oid = cr.oid\nWHERE cr.class_name = 'CEP'\n  AND cr.probability > 0.76\nORDER BY cr.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5012, "completion_tokens": 317, "total_tokens": 5329, "prompt_tokens_details": {"cached_tokens": 4480, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132cdc08190a4e33cbb3b401b2b", "custom_id": "27-1", "response": {"status_code": 200, "request_id": "7a345d96a7279fc1846af61b64627113", "body": {"id": "chatcmpl-BwxFFKNOGa5hKL3Wnl0X4tP1ZotZ8", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'CEP' -- Assuming 'CEP' is the class name for Cepheid variables\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification AS (\n    SELECT\n        so.oid,\n        so.meanra,\n        so.meandec,\n        so.ndet,\n        so.firstmjd,\n        so.deltajd,\n        so.g_r_max,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM selected_objects so\n    JOIN cepheid_prob p ON so.oid = p.oid\n)\nSELECT * FROM classification;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5012, "completion_tokens": 255, "total_tokens": 5267, "prompt_tokens_details": {"cached_tokens": 4864, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132d3748190b75f1f28cb89a4a3", "custom_id": "27-2", "response": {"status_code": 200, "request_id": "851eadc8c52e172ea011c5379c143215", "body": {"id": "chatcmpl-BwxFFos4JayHSX5woRzAOHekWw9lI", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.classifier_name,\n    c.class_name,\n    c.ranking,\n    c.probability\nFROM object_filtered of\nJOIN classification c ON of.oid = c.oid\nORDER BY c.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6395, "completion_tokens": 236, "total_tokens": 6631, "prompt_tokens_details": {"cached_tokens": 6272, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132d300819095474de299afd1fc", "custom_id": "27-3", "response": {"status_code": 200, "request_id": "bf2d6105a401d2875e855e96a6d38a38", "body": {"id": "chatcmpl-BwxFFk0yZ2wkoDvWgICZpuQcRdF07", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    cp.class_name,\n    cp.ranking,\n    cp.probability\nFROM object_filtered of\nJOIN cepheid_prob cp ON of.oid = cp.oid\nORDER BY cp.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6395, "completion_tokens": 228, "total_tokens": 6623, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132c9708190b7087b2b7dc3cea3", "custom_id": "27-4", "response": {"status_code": 200, "request_id": "2e4aa0c1d67e45aeae7a74ebf1c40f50", "body": {"id": "chatcmpl-BwxFDyFVY9flrWaIz1INZdk1x6l3W", "object": "chat.completion", "created": 1753390459, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.probability > 0.76\n),\n-- Retrieve the most probable class for each object\nmost_probable_class AS (\n    SELECT DISTINCT ON (c.oid)\n        c.oid,\n        c.class_name,\n        c.classifier_name,\n        c.ranking,\n        c.probability\n    FROM classification c\n    ORDER BY c.oid, c.ranking\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    mpc.class_name AS class,\n    mpc.ranking,\n    mpc.probability\nFROM selected_objects so\nJOIN most_probable_class mpc ON so.oid = mpc.oid\nORDER BY so.ndet DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3343, "completion_tokens": 317, "total_tokens": 3660, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132cf148190b1e9842eff32d261", "custom_id": "27-5", "response": {"status_code": 200, "request_id": "c239685da69cdbcbf900e74a726a86a6", "body": {"id": "chatcmpl-BwxFIbapxmamcG1PwG4jVx40kTbzg", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        m.g_r_max\n    FROM\n        object o\n    WHERE\n        o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.class_name,\n    c.classifier_name,\n    c.ranking,\n    c.probability\nFROM\n    object_filtered of\nJOIN\n    classification c ON of.oid = c.oid\nORDER BY\n    c.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6395, "completion_tokens": 250, "total_tokens": 6645, "prompt_tokens_details": {"cached_tokens": 6272, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132d62c81908d3eb9244ae63110", "custom_id": "27-6", "response": {"status_code": 200, "request_id": "d6edc3d7fd313b974775d921eea9b7e0", "body": {"id": "chatcmpl-BwxFEzgBjza6eOs1Rbd8TJDCftAjo", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'CEP' -- class name for Cepheid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification_details AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    cd.class_name,\n    cd.ranking,\n    cd.probability\nFROM selected_objects so\nJOIN classification_details cd ON so.oid = cd.oid\nWHERE cd.class_name = 'CEP'\n  AND cd.probability > 0.76\nORDER BY cd.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3343, "completion_tokens": 309, "total_tokens": 3652, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132d2848190b0e5db44589d17b0", "custom_id": "27-7", "response": {"status_code": 200, "request_id": "2db2430be50ee3a03b2114b74cb7266e", "body": {"id": "chatcmpl-BwxFFfPQdXHFIVVe6FgIMVD9QP3kl", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.class_name,\n    c.classifier_name,\n    c.ranking,\n    c.probability\nFROM object_filtered of\nJOIN classification c ON of.oid = c.oid\nORDER BY c.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6395, "completion_tokens": 236, "total_tokens": 6631, "prompt_tokens_details": {"cached_tokens": 6272, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a132f1dc8190920af151b05d8399", "custom_id": "27-8", "response": {"status_code": 200, "request_id": "c4d58812279db085db2fbea782ffc405", "body": {"id": "chatcmpl-BwxFMAX3nlmBA505PvWnX2dT7UbRU", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability,\n        p.classifier_name,\n        p.classifier_version\n    FROM probability p\n    WHERE p.class_name = 'CEP'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification_details AS (\n    SELECT\n        so.oid,\n        so.meanra,\n        so.meandec,\n        so.ndet,\n        so.firstmjd,\n        so.deltajd,\n        so.g_r_max,\n        cp.class_name,\n        cp.ranking,\n        cp.probability,\n        cp.classifier_name\n    FROM selected_objects so\n    JOIN cepheid_probabilities cp ON so.oid = cp.oid\n)\nSELECT\n    oid,\n    meanra,\n    meandec,\n    ndet,\n    firstmjd,\n    deltajd,\n    g_r_max,\n    class_name,\n    classifier_name,\n    ranking,\n    probability\nFROM classification_details\nORDER BY probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3343, "completion_tokens": 313, "total_tokens": 3656, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13305e88190b73199387df38ee7", "custom_id": "27-9", "response": {"status_code": 200, "request_id": "c966ccdd49fb2481b3583df63ca63895", "body": {"id": "chatcmpl-BwxFH4KYrreMNOERYodeeCwlXJEnE", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    cp.class_name AS class,\n    cp.classifier_name,\n    cp.ranking,\n    cp.probability\nFROM object_filtered of\nJOIN cepheid_prob cp ON of.oid = cp.oid\nORDER BY cp.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6395, "completion_tokens": 242, "total_tokens": 6637, "prompt_tokens_details": {"cached_tokens": 6272, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1334c8c8190b5d8251cba4ddac9", "custom_id": "17-0", "response": {"status_code": 200, "request_id": "e329a764824641be2f50ad385eec6fbe", "body": {"id": "chatcmpl-BwxFBXb14uTTA5ngNdj5YLOmxWd9g", "object": "chat.completion", "created": 1753390457, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object oids classified as AGN with variability in r band and no detections or no variability in g band\nSELECT o.oid\nFROM object o\nWHERE \n    -- Check if the object is classified as AGN with highest probability (ranking=1) in the 'probability' table\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n    AND\n    -- Check for variability in r band from magstat table\n    EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.ndet > 1 -- indicates variability (more than one detection)\n    )\n    AND\n    -- Check for no detections or no variability in g band\n    (\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n              AND m2.ndet > 1 -- multiple detections indicating variability\n        )\n        OR\n        -- Alternatively, if no detections in g band, ensure no variability\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n              AND m2.magmean_corr IS NOT NULL\n        )\n    )\nORDER BY o.oid ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6246, "completion_tokens": 350, "total_tokens": 6596, "prompt_tokens_details": {"cached_tokens": 3968, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133491c8190910c0c04510bfd57", "custom_id": "17-1", "response": {"status_code": 200, "request_id": "dc5bb69da1b168bee0f6859744293f57", "body": {"id": "chatcmpl-BwxFCoLanFTvAPQNKTy1BRMpadu0H", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object oids classified as AGN with variability in r band and no detections or variability in g band\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        -- Check if the object is classified as AGN with ranking=1 in the probability table for AGN\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n    AND EXISTS (\n        -- Check for variability in r band (fid=2) in magstat\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2\n          AND (m.magmax - m.magmin) > 0 -- Variability indicated by difference in magnitudes\n    )\n    AND (\n        -- Check for no detections or no variability in g band (fid=1)\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1\n              AND (m2.magmax - m2.magmin) > 0\n        )\n        OR NOT EXISTS (\n            -- No detections in g band\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n        )\n    )\n)\n-- Retrieve all features for these objects, ordered by their value in ascending order\nSELECT f.*\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM agn_objects)\nORDER BY f.value ASC, f.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6246, "completion_tokens": 398, "total_tokens": 6644, "prompt_tokens_details": {"cached_tokens": 6016, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1336cd4819089a6312993a2ace1", "custom_id": "17-2", "response": {"status_code": 200, "request_id": "5b3b8af4e56c6f1ad34f8de6d797688a", "body": {"id": "chatcmpl-BwxFIJsSodC0YTI3DYQwh74FL5ZVK", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the AGN class from the probability table\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n)\n-- Join with magstat for r band to check variability\nAND EXISTS (\n    SELECT 1\n    FROM magstat m_r\n    WHERE m_r.oid = o.oid\n      AND m_r.fid = 2 -- r band\n      AND (m_r.magsigma > 0 OR m_r.dm_first IS NOT NULL) -- variability in r band\n)\n-- Join with magstat for g band to check no detections or no variability\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1 -- g band\n          AND (m_g.ndet > 0 OR m_g.magsigma > 0 OR m_g.dm_first IS NOT NULL)\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6415, "completion_tokens": 318, "total_tokens": 6733, "prompt_tokens_details": {"cached_tokens": 6272, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133508081909143895941f818f6", "custom_id": "17-3", "response": {"status_code": 200, "request_id": "1abfca5848889ee854c22bc65ed09dd0", "body": {"id": "chatcmpl-BwxFEzOrPZoBHBMBQWqMjNevKqql3", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score (deep learning real bogus score)\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name = 'drb'\n      AND p.ranking = 1\n)\n-- Join with magstat to check for variability in the r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2\n      AND (m.magsigma > 0 OR m.magmax - m.magmin > 0)\n)\n-- Check for no detections or no variability in the g band (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM detection d\n        WHERE d.oid = o.oid\n          AND d.fid = 1\n    )\n    OR NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n          AND (m2.magsigma > 0 OR m2.magmax - m2.magmin > 0)\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6415, "completion_tokens": 329, "total_tokens": 6744, "prompt_tokens_details": {"cached_tokens": 6272, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13395e08190adac62d88778d0d8", "custom_id": "17-4", "response": {"status_code": 200, "request_id": "8cc9b7a1880b378017d41ce5f5b06b64", "body": {"id": "chatcmpl-BwxFEhbdBixKYBw6VBJwrizBPzs2d", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'AGN' class from the 'probability' table\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n)\n-- Join with magstat to check for variability in the r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m_r\n    WHERE m_r.oid = o.oid\n      AND m_r.fid = 2\n      AND (m_r.magsigma > 0 OR m_r.dm_first IS NOT NULL)\n)\n-- Check for no detections or no variability in the g band (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1\n    )\n    OR (\n        EXISTS (\n            SELECT 1\n            FROM magstat m_g\n            WHERE m_g.oid = o.oid\n              AND m_g.fid = 1\n              AND (m_g.magsigma = 0 OR m_g.dm_first IS NULL)\n        )\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6415, "completion_tokens": 352, "total_tokens": 6767, "prompt_tokens_details": {"cached_tokens": 6272, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13360f48190bfd496b63eeb7478", "custom_id": "17-5", "response": {"status_code": 200, "request_id": "85aa499868c56e7e665c000f82359333", "body": {"id": "chatcmpl-BwxFB4M71mPbIAUISC4At7SvOu28r", "object": "chat.completion", "created": 1753390457, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score (deep learning real bogus score)\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name = 'drb'\n      AND p.ranking = 1\n)\n-- Join with magstat to check variability in the r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2\n      AND (m.magsigma > 0 OR m.dm_first IS NOT NULL)\n)\n-- Check for g band detections or variability (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n    )\n    OR NOT (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n          AND (m2.magsigma > 0 OR m2.dm_first IS NOT NULL)\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6415, "completion_tokens": 318, "total_tokens": 6733, "prompt_tokens_details": {"cached_tokens": 6272, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133580081909efde896b58807fe", "custom_id": "17-6", "response": {"status_code": 200, "request_id": "5176d7e25058f1eb827952811e76bd88", "body": {"id": "chatcmpl-BwxFBTBdMZZxd1x1kRAtycCClKyZO", "object": "chat.completion", "created": 1753390457, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object oids classified as AGN with variability in r band and no detections or no variability in g band\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND (m.magsigma > 0 OR m.magmax - m.magmin > 0) -- variability in r band\n    )\n    AND (\n        -- g band: no detections or no variability\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n        )\n        OR EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n              AND (m2.magsigma = 0 OR m2.magmax - m2.magmin = 0)\n        )\n    )\n)\nSELECT f.name, f.value\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM agn_objects)\nORDER BY f.value ASC, f.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6363, "completion_tokens": 356, "total_tokens": 6719, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13364a48190a08a314b839e2aab", "custom_id": "17-7", "response": {"status_code": 200, "request_id": "6c6e1212fe2cb2a280dccc2a7db2145d", "body": {"id": "chatcmpl-BwxFBhQLTYZvzXh7EjvLeQxtQZZhr", "object": "chat.completion", "created": 1753390457, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object IDs classified as AGN with variability in r band and no detections or variability in g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'AGN' class from the 'probability' table\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- assuming a threshold for confident classification\n)\n-- Join with magstat to check for variability in r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2\n      AND (m.magmax - m.magmin) > 0.1 -- threshold for variability in r band\n)\n-- Check for no detections or no variability in g band (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n    )\n    OR\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n          AND (m2.magmax - m2.magmin) > 0.1 -- no significant variability in g band\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6415, "completion_tokens": 373, "total_tokens": 6788, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1339f6881908729957623fc197f", "custom_id": "17-8", "response": {"status_code": 200, "request_id": "5b23772b94a6b550a513bc1f7ebb1265", "body": {"id": "chatcmpl-BwxFCQIrXQHj81jfsPTUpCGRaGeOj", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object IDs classified as AGN with variability in r band and no detections or variability in g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score (deep learning real bogus score) for AGN class\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n)\n-- Subquery to check for variability in the r band\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2 -- r band\n      AND (m.magmean_corr IS NOT NULL AND m.magsigma_corr > 0)\n)\n-- Subquery to ensure no detections or variability in the g band\nAND NOT EXISTS (\n    SELECT 1\n    FROM magstat m2\n    WHERE m2.oid = o.oid\n      AND m2.fid = 1 -- g band\n      AND (\n        m2.magmean_corr IS NOT NULL\n        AND (m2.magsigma_corr > 0 OR m2.ndet = 0)\n      )\n)\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6415, "completion_tokens": 313, "total_tokens": 6728, "prompt_tokens_details": {"cached_tokens": 6272, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133c5108190a638457cc761145d", "custom_id": "17-9", "response": {"status_code": 200, "request_id": "1e5cae11ec16e18e25b50ca4774a0045", "body": {"id": "chatcmpl-BwxFGWKTDoHHUCAzPvf6CiBSfmzJr", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND (m.magsigma > 0 OR m.ndet > 0) -- variability or detections in r band\n    )\n    AND NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1 -- g band\n          AND (m2.magsigma > 0 OR m2.ndet > 0) -- no variability or detections in g band\n    )\n)\nSELECT f.*\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM agn_objects)\nORDER BY f.value ASC, f.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6363, "completion_tokens": 299, "total_tokens": 6662, "prompt_tokens_details": {"cached_tokens": 6144, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133c234819096b5776b8d5bc33d", "custom_id": "37-0", "response": {"status_code": 200, "request_id": "e3c95a8067aec3331637201dbe91aa35", "body": {"id": "chatcmpl-BwxFG5JnAQcjHCCGv7xx7GwKtkc76", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n) sub\nJOIN probability p ON p.oid = sub.oid\nWHERE p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\nORDER BY p.probability DESC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 145, "total_tokens": 2681, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133c75481909a167d3e2db390f1", "custom_id": "37-1", "response": {"status_code": 200, "request_id": "3d67f2bf5b86c44a4ebda0e08bea9b23", "body": {"id": "chatcmpl-BwxFJNbTl2B975FhbT0N7aiKIr376", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 275, "total_tokens": 2811, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133e0748190b6d359b35a473ae8", "custom_id": "37-2", "response": {"status_code": 200, "request_id": "69d21b8ac63f4f09675492584f5e5921", "body": {"id": "chatcmpl-BwxFImYcvzOhGCqQq5toB0A2xJFLC", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Select object OIDs with the highest probability for SNIa class in the lc_classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Fetch all details for these objects from the object table\nJOIN object o ON o.oid = sub.oid\nORDER BY (SELECT p.probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'SNIa' AND p.classifier_name = 'lc_classifier' ORDER BY p.probability DESC LIMIT 1) DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 187, "total_tokens": 2723, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133d03881908393c6bf6cd16667", "custom_id": "37-3", "response": {"status_code": 200, "request_id": "32189fc0edc0871ed377ed66d049b117", "body": {"id": "chatcmpl-BwxFLCCy902ejmRhOXa8CZ5T9kAHh", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Match object OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 276, "total_tokens": 2812, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133d6648190b7d5d65333a13ac7", "custom_id": "37-4", "response": {"status_code": 200, "request_id": "bf26a348636d727349b07dd54ed3aea3", "body": {"id": "chatcmpl-BwxFLBLh1FuiQ8gISypBgZ7xnp4YS", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n) sub\nJOIN probability p ON p.oid = sub.oid\nWHERE p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nORDER BY p.probability DESC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 154, "total_tokens": 2690, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1348e548190a6de6ca5ef996c42", "custom_id": "37-5", "response": {"status_code": 200, "request_id": "aa0b83aa90fc30079fc6612e6cffde81", "body": {"id": "chatcmpl-BwxFBxHbVE2vT5DLGg6VhghX3HTcf", "object": "chat.completion", "created": 1753390457, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 265, "total_tokens": 2801, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a133eed48190bb8843708de1c032", "custom_id": "37-6", "response": {"status_code": 200, "request_id": "d3c2c1b4b6dee9865aad996146cc87c8", "body": {"id": "chatcmpl-BwxFKccrxB4LXSkFOn4ifeEqhmonC", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT o.*\nFROM (\n    -- Subquery to get object OIDs with the highest probability for SNIa in the lc_classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name = 'lc_classifier' AND class_name = 'SNIa')\n    ORDER BY p.probability DESC\n    LIMIT 200\n) AS top_oids\nJOIN object o ON o.oid = top_oids.oid\nORDER BY (SELECT p.probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'SNIa' AND p.classifier_name = 'lc_classifier' AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name = 'lc_classifier' AND class_name = 'SNIa')) DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 227, "total_tokens": 2763, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13472c08190a65c60ffe16e5775", "custom_id": "37-7", "response": {"status_code": 200, "request_id": "0a8a4ed09310af1b40f4d3b530d1a44e", "body": {"id": "chatcmpl-BwxFDR3Kz1QU8cF6MWuSqJ1uitWId", "object": "chat.completion", "created": 1753390459, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by probability in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 259, "total_tokens": 2795, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a134191481909adb3689247571ee", "custom_id": "37-8", "response": {"status_code": 200, "request_id": "92961dd73e58d203cec0890e4712fb0b", "body": {"id": "chatcmpl-BwxFMwlDNd5uW2RGafDavAQrqqFBM", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 265, "total_tokens": 2801, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1343c4c819086143ff84040d9fb", "custom_id": "37-9", "response": {"status_code": 200, "request_id": "d59f1433dfc2180300292d7da88f3fce", "body": {"id": "chatcmpl-BwxFFGQ9o7xmf588xE4AyDuz9z4qG", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n) sub\nJOIN probability p ON p.oid = sub.oid\nWHERE p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\nORDER BY p.probability DESC\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2536, "completion_tokens": 145, "total_tokens": 2681, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1348a648190bdd88a3cb77c7241", "custom_id": "34-0", "response": {"status_code": 200, "request_id": "b4ed951874585c79912f34277a697367", "body": {"id": "chatcmpl-BwxFNI9QHWIAKQ4Tf1UaT2pi9eS0j", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 201, "total_tokens": 5072, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1343dd8819098281cf9e6cb9667", "custom_id": "34-1", "response": {"status_code": 200, "request_id": "64290bbd21364ffc8c3395d40fa40a83", "body": {"id": "chatcmpl-BwxFHcQYHclj8AjmJTu5XizQxNR6R", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT f.*\nFROM feature f\nWHERE f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')\n  AND f.name IN ('Amplitude', 'Multiband_period');", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 110, "total_tokens": 4981, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a134651c8190b586cebd5531fde4", "custom_id": "34-2", "response": {"status_code": 200, "request_id": "2b119136b48fec0022ac1ba6af31bddd", "body": {"id": "chatcmpl-BwxFINOs1gxMgHUv6bEpc06HPiiIZ", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT f.*\nFROM feature f\nJOIN oid_list o ON f.oid = o.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 176, "total_tokens": 5047, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a134506c81909e8f68830131dc41", "custom_id": "34-3", "response": {"status_code": 200, "request_id": "b02345601bc9decf98883b502a56561d", "body": {"id": "chatcmpl-BwxFKrFs6UqtC74M3K98yey2Hysrd", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 201, "total_tokens": 5072, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1346ab08190ad60155af3b87413", "custom_id": "34-4", "response": {"status_code": 200, "request_id": "ed2573a0d878c84a67f45614c75b5535", "body": {"id": "chatcmpl-BwxFC8NIkqK6p0euKX9JhzRtcGN2f", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 201, "total_tokens": 5072, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a134ba288190b26e2e44ce8a6c82", "custom_id": "34-5", "response": {"status_code": 200, "request_id": "dea1f942e97766888ff486fb59517d7a", "body": {"id": "chatcmpl-BwxFCEf2vKfESa1dT8w0PKrP1uH1p", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 201, "total_tokens": 5072, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13495f88190a9b0e70733646bc8", "custom_id": "34-6", "response": {"status_code": 200, "request_id": "2b30c785e2c4547f4d6256e16403be45", "body": {"id": "chatcmpl-BwxFCMUTeQi7S5SyoPJzEqznKnfTq", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 201, "total_tokens": 5072, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a134bc088190a887e514d0a2f23d", "custom_id": "34-7", "response": {"status_code": 200, "request_id": "6a97085d99573b1dc573bc08d456b548", "body": {"id": "chatcmpl-BwxFCLqMadZ69ZRv3h1ZBLBSFBPya", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 201, "total_tokens": 5072, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a134b9288190a571f6952c09dd9d", "custom_id": "34-8", "response": {"status_code": 200, "request_id": "99ac7f3c540b1a8ea2747729373d32e6", "body": {"id": "chatcmpl-BwxFC1OVeWjytanMeB7FP1nv5apAr", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 201, "total_tokens": 5072, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a134cf9c8190bd514dd515364058", "custom_id": "34-9", "response": {"status_code": 200, "request_id": "ac17c23cf94fdcdf5fd53c8f45006508", "body": {"id": "chatcmpl-BwxFEu3XShuylbPsuRcfqY4RdGfer", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT f.*\nFROM feature f\nWHERE f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')\n  AND f.name IN ('Amplitude', 'Multiband_period');", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4871, "completion_tokens": 110, "total_tokens": 4981, "prompt_tokens_details": {"cached_tokens": 4736, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1352ec08190ab5d5606bbfcd4e1", "custom_id": "1-0", "response": {"status_code": 200, "request_id": "3b115210f149ab3984e61bd99d721d37", "body": {"id": "chatcmpl-BwxFFH6poItMipAKjx8lwRTlyQwIP", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Classify as AGN with probability > 0.6 and top ranking\n        (SELECT probability FROM probability p \n         WHERE p.oid = o.oid AND p.class_name = 'AGN' AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') AND p.probability > 0.6 AND p.ranking = 1\n        ) IS NOT NULL\n        AND \n        -- Covering at least one year\n        (o.mjdendhist - o.mjdstarthist) >= 365\n        AND \n        -- At least 20 detections in any band\n        o.ndet >= 20\n),\nlight_curves AS (\n    SELECT \n        d.oid,\n        -- Max and Min magnitudes per band\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_max_g,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_min_g,\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_max_r,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_min_r,\n        -- Variations in bands\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1)) AS delta_mag_g,\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2)) AS delta_mag_r,\n        -- Mean coordinates\n        o.meanra,\n        o.meandec,\n        -- Number of detections\n        o.ndet\n    FROM detection d\n    JOIN agn_objects ao ON d.oid = ao.oid\n    GROUP BY d.oid, o.meanra, o.meandec, o.ndet\n),\nvariability AS (\n    SELECT \n        lc.oid,\n        -- Variations larger than thresholds\n        (lc.mag_max_g - lc.mag_min_g) AS delta_mag_g,\n        (lc.mag_max_r - lc.mag_min_r) AS delta_mag_r\n    FROM light_curves lc\n    WHERE \n        -- Variations larger than 1 in g band\n        (lc.mag_max_g - lc.mag_min_g) > 1\n        AND\n        -- Variations larger than 0.5 in r band\n        (lc.mag_max_r - lc.mag_min_r) > 0.5\n)\nSELECT \n    ao.oid,\n    -- Features: get value, name, version, filter id for AGN\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS agn_fid,\n    -- Coordinates\n    ao.meanra,\n    ao.meandec,\n    -- Number of detections\n    ao.ndet,\n    -- Max and Min magnitudes\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_max_g,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_min_g,\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_max_r,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_min_r,\n    -- Delta magnitudes\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS delta_mag_g,\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS delta_mag_r\nFROM agn_objects ao\nJOIN feature f ON ao.oid = f.oid\nJOIN variability v ON ao.oid = v.oid\nWHERE \n    -- Filter features for AGN\n    f.name = 'W2-W3' -- example feature, adjust as needed\n    AND f.value IS NOT NULL\n    -- Filter for AGN classification probability > 0.6\n    AND EXISTS (\n        SELECT 1 FROM probability p\n        WHERE p.oid = ao.oid AND p.class_name = 'AGN' AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') AND p.probability > 0.6 AND p.ranking = 1\n    )\n    -- Variations in bands\n    AND v.delta_mag_g > 1\n    AND v.delta_mag_r > 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5637, "completion_tokens": 1044, "total_tokens": 6681, "prompt_tokens_details": {"cached_tokens": 4608, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a134ec2081909310107e332323c6", "custom_id": "1-1", "response": {"status_code": 200, "request_id": "3f1435e2245351ac0fcff847a4bd851a", "body": {"id": "chatcmpl-BwxFG37eDhBSZwhFokfHIqf42x1LK", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Classify as AGN with probability > 0.6 and top ranking\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'AGN'\n              AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n              AND p.probability > 0.6\n              AND p.ranking = 1\n        )\n        -- Covering at least one year\n        AND (o.mjdendhist - o.mjdstarthist) >= 365\n        -- At least 20 detections in any band\n        AND (\n            SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid\n        ) >= 20\n),\nlight_curves AS (\n    SELECT \n        d.oid,\n        -- Filter for corrected magnitudes\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_max,\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_min,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_max,\n        MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_min,\n        -- Max and min magnitudes for detection counts\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS delta_g,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS delta_r,\n        -- Count detections per band\n        COUNT(CASE WHEN d.fid = 1 THEN 1 END) AS n_det_g,\n        COUNT(CASE WHEN d.fid = 2 THEN 1 END) AS n_det_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nvariability AS (\n    SELECT \n        d.oid,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_g,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS delta_mag_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nfeatures AS (\n    SELECT \n        f.oid,\n        -- Select feature values for mean coordinates\n        MAX(CASE WHEN f.name = 'meanra' AND f.fid = 0 THEN f.value END) AS meanra,\n        MAX(CASE WHEN f.name = 'meandec' AND f.fid = 0 THEN f.value END) AS meandec,\n        -- Max and min magnitudes\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS max_mag_g,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS min_mag_g,\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS max_mag_r,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS min_mag_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY f.oid\n)\nSELECT \n    a.oid,\n    f.meanra,\n    f.meandec,\n    -- Number of detections\n    (SELECT COUNT(*) FROM detection d WHERE d.oid = a.oid) AS n_detections,\n    -- Max and min magnitudes\n    f.max_mag_g,\n    f.min_mag_g,\n    f.max_mag_r,\n    f.min_mag_r,\n    -- Variations\n    v.delta_mag_g,\n    v.delta_mag_r\nFROM agn_objects a\nJOIN features f ON a.oid = f.oid\nJOIN variability v ON a.oid = v.oid\nWHERE \n    -- Variations larger than thresholds\n    v.delta_mag_g > 1 AND v.delta_mag_r > 0.5\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5637, "completion_tokens": 956, "total_tokens": 6593, "prompt_tokens_details": {"cached_tokens": 5504, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a134eee0819097040b6656520a9f", "custom_id": "1-2", "response": {"status_code": 200, "request_id": "2b86e2c95502b0f3bb628ecca3d1b75e", "body": {"id": "chatcmpl-BwxFGEksCpvVBa1nMwJy60qCNynEi", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdendhist - o.mjdstarthist >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat g ON g.oid = o.oid AND g.fid = 1\n    JOIN magstat r ON r.oid = o.oid AND r.fid = 2\n    WHERE g.magmax - g.magmin > 1\n      AND r.magmax - r.magmin > 0.5\n),\n-- Combine all filters\nfiltered_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN long_duration_objects ld ON o.oid = ld.oid\n    JOIN variable_objects v ON o.oid = v.oid\n)\n-- Final selection with required features and properties\nSELECT\n    o.oid,\n    -- Select features: value, name, version, filter id\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS features_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    g.magmax AS magmax_g,\n    g.magmin AS magmin_g,\n    r.magmax AS magmax_r,\n    r.magmin AS magmin_r,\n    -- Calculate delta magnitudes\n    (g.magmax - g.magmin) AS delta_mag_g,\n    (r.magmax - r.magmin) AS delta_mag_r\nFROM filtered_objects fo\nJOIN object o ON o.oid = fo.oid\nLEFT JOIN feature f ON f.oid = o.oid\nLEFT JOIN magstat g ON g.oid = o.oid AND g.fid = 1\nLEFT JOIN magstat r ON r.oid = o.oid AND r.fid = 2\nWHERE f.name IN ('Amplitude', 'magmax', 'magmin')\n  AND f.value IS NOT NULL\n  AND f.version IS NOT NULL\n  AND f.name IN ('magmax', 'magmin')\n  AND f.fid IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6353, "completion_tokens": 585, "total_tokens": 6938, "prompt_tokens_details": {"cached_tokens": 6144, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13522688190b2d28a348c783481", "custom_id": "1-3", "response": {"status_code": 200, "request_id": "369dae642b72a8c461e6d322bc0b05c0", "body": {"id": "chatcmpl-BwxFHDi5qEsPth2XTgafcu3HcgQhm", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\n    JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\n    WHERE m_g.magmax - m_g.magmin > 1\n      AND m_r.magmax - m_r.magmin > 0.5\n),\n-- Combine all conditions\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Retrieve required information for the filtered objects\nSELECT\n    o.oid,\n    -- Get the maximum probability for AGN class\n    p.probability AS agn_probability,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    f.version AS feature_version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Calculate delta magnitudes\n    (m_g.magmax - m_g.magmin) AS g_delta_mag,\n    (m_r.magmax - m_r.magmin) AS r_delta_mag\nFROM object o\nLEFT JOIN probability p ON p.oid = o.oid AND p.class_name = 'AGN' AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier') AND p.probability > 0.6\nLEFT JOIN feature f ON f.oid = o.oid\nLEFT JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\nLEFT JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\nWHERE o.oid IN (SELECT oid FROM filtered_objects)\n  AND f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmax', 'magmin')\n  AND f.value IS NOT NULL\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6353, "completion_tokens": 673, "total_tokens": 7026, "prompt_tokens_details": {"cached_tokens": 6144, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1352f4c8190b3e7a0472cf8ecba", "custom_id": "1-4", "response": {"status_code": 200, "request_id": "5e619ee148ba28e7054f4ec610ae6609", "body": {"id": "chatcmpl-BwxFE3QTRyZpEVTT9NrANfq2WBfTI", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n),\nlight_curve_stats AS (\n    SELECT\n        o.oid,\n        MIN(magmean_corr) AS mag_mean,\n        MAX(magmean_corr) AS mag_max,\n        MIN(magmean_corr) AS mag_min,\n        MAX(magmean_corr) - MIN(magmean_corr) AS delta_mag,\n        MAX(lastmjd) - MIN(firstmjd) AS duration_days,\n        COUNT(*) AS detections_in_band\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nvariability AS (\n    SELECT\n        o.oid,\n        MAX(CASE WHEN m.fid = 1 THEN m.magmax_corr END) AS g_mag_max,\n        MIN(CASE WHEN m.fid = 1 THEN m.magmin_corr END) AS g_mag_min,\n        MAX(CASE WHEN m.fid = 2 THEN m.magmax_corr END) AS r_mag_max,\n        MIN(CASE WHEN m.fid = 2 THEN m.magmin_corr END) AS r_mag_min\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        lc.detections_in_band,\n        g.g_mag_max,\n        g.g_mag_min,\n        r.r_mag_max,\n        r.r_mag_min,\n        g.delta_mag AS delta_mag_g,\n        r.delta_mag AS delta_mag_r\n    FROM agn_objects o\n    JOIN light_curve_stats lc ON o.oid = lc.oid\n    JOIN variability g ON o.oid = g.oid\n    JOIN variability r ON o.oid = r.oid\n    WHERE\n        lc.duration_days >= 365\n        AND (g.detections_in_band >= 20 OR r.detections_in_band >= 20)\n        AND g.delta_mag > 1\n        AND r.delta_mag > 0.5\n)\nSELECT\n    fo.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    fo.meanra,\n    fo.meandec,\n    (SELECT COUNT(*) FROM magstat m WHERE m.oid = fo.oid AND m.corrected = TRUE) AS \"magstat_ndet\",\n    fo.g_mag_max,\n    fo.g_mag_min,\n    fo.r_mag_max,\n    fo.r_mag_min,\n    fo.delta_mag_g,\n    fo.delta_mag_r\nFROM filtered_objects fo\nJOIN feature f ON fo.oid = f.oid\nWHERE\n    f.name IN ('g-r_max_corr', 'g-r_mean_corr', 'g-r_max', 'g-r_mean')\n    AND f.fid IN (1, 2)\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6353, "completion_tokens": 710, "total_tokens": 7063, "prompt_tokens_details": {"cached_tokens": 3328, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13518448190ac5f9ca170d5d627", "custom_id": "1-5", "response": {"status_code": 200, "request_id": "6855cfcb93237a5b3ac51361c52cbbaf", "body": {"id": "chatcmpl-BwxFJ3mvgJVNiTHM1w30pBYj60Xtc", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND m.magmax - m.magmin > 1\n          AND m.magmax_corr - m.magmin_corr > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.magmax - m.magmin > 0.5\n          AND m.magmax_corr - m.magmin_corr > 0.5\n    )\n)\n-- Final selection combining all conditions\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    mag_g.magmax_corr AS \"mag_g_max\",\n    mag_g.magmin_corr AS \"mag_g_min\",\n    (mag_g.magmax_corr - mag_g.magmin_corr) AS \"delta_mag_g\",\n    mag_r.magmax_corr AS \"mag_r_max\",\n    mag_r.magmin_corr AS \"mag_r_min\",\n    (mag_r.magmax_corr - mag_r.magmin_corr) AS \"delta_mag_r\"\nFROM object o\nJOIN agn_objects a ON o.oid = a.oid\nJOIN long_duration_objects l ON o.oid = l.oid\nJOIN feature f ON o.oid = f.oid\nLEFT JOIN magstat mag_g ON o.oid = mag_g.oid AND mag_g.fid = 1\nLEFT JOIN magstat mag_r ON o.oid = mag_r.oid AND mag_r.fid = 2\nWHERE f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmean_corr', 'magmax_corr', 'magmin_corr')\n  AND f.version = (SELECT MAX(version) FROM feature WHERE oid = o.oid AND name = f.name)\n  AND f.fid = (CASE WHEN f.name LIKE 'g%' THEN 1 WHEN f.name LIKE 'r%' THEN 2 ELSE f.fid END);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6353, "completion_tokens": 683, "total_tokens": 7036, "prompt_tokens_details": {"cached_tokens": 6144, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1353e3481908cfb89e37d402822", "custom_id": "1-6", "response": {"status_code": 200, "request_id": "a41c2e47b881c34b4231cb5acf38d49d", "body": {"id": "chatcmpl-BwxFE70QVOQ0WeUgr2b6qSHELDzy3", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND m.magmax_corr - m.magmin_corr > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.magmax_corr - m.magmin_corr > 0.5\n    )\n)\n-- Combine all filters to get the final set of objects\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Max and min magnitudes in g band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmax_g,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmin_g,\n    -- Max and min magnitudes in r band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmax_r,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmin_r,\n    -- Variations in bands\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS delta_mag_g,\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS delta_mag_r\nFROM object o\nJOIN feature f ON f.oid = o.oid\nWHERE o.oid IN (\n    SELECT oid FROM agn_objects\n    INTERSECT\n    SELECT oid FROM long_duration_objects\n    INTERSECT\n    SELECT oid FROM variable_objects\n)\n  AND f.name IN ('r-W2', 'g-r_max', 'g-r_max_corr', 'g-r_mean', 'g-r_mean_corr')\n  AND f.value IS NOT NULL\n  AND f.fid IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6353, "completion_tokens": 688, "total_tokens": 7041, "prompt_tokens_details": {"cached_tokens": 6144, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a135384c819080c4dd8708527d11", "custom_id": "1-7", "response": {"status_code": 200, "request_id": "245ecf0f7eba2efd06c1137e810d2acb", "body": {"id": "chatcmpl-BwxFN6XPOdgF5dn3wTafoZkqlssvm", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_objects AS (\n    -- Select objects classified as AGN with probability > 0.6 and rank=1\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nlight_curve_stats AS (\n    -- Select objects with at least 20 detections in any band and light curve duration >= 365 days\n    SELECT o.oid, o.firstmjd, o.lastmjd, o.ndet, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND (o.lastmjd - o.firstmjd) >= 365\n      AND o.ndet >= 20\n),\nfeatures_filtered AS (\n    -- Select features for objects with magnitude variations > 1 in g and > 0.5 in r, corrected magnitudes\n    SELECT f.*\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM light_curve_stats)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n      AND f.fid IN (1, 2)\n      AND f.version = (SELECT MAX(version) FROM feature WHERE oid = f.oid AND name = f.name AND fid = f.fid)\n),\nmag_stats AS (\n    -- Get maximum and minimum corrected magnitudes per object and band\n    SELECT\n        f.oid,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 1 THEN f.value END) AS magmax_corr_g,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 1 THEN f.value END) AS magmin_corr_g,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 2 THEN f.value END) AS magmax_corr_r,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 2 THEN f.value END) AS magmin_corr_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM light_curve_stats)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY f.oid\n),\nvariations AS (\n    -- Calculate delta magnitudes for g and r bands\n    SELECT\n        m.oid,\n        (m.magmax_corr_g - m.magmin_corr_g) AS delta_mag_g,\n        (m.magmax_corr_r - m.magmin_corr_r) AS delta_mag_r\n    FROM mag_stats m\n),\nfinal_selection AS (\n    -- Select objects with variations > thresholds\n    SELECT\n        lc.oid,\n        lc.firstmjd,\n        lc.lastmjd,\n        lc.ndet,\n        lc.meanra,\n        lc.meandec,\n        f.oid AS feature_oid,\n        f.name,\n        f.version,\n        f.fid,\n        v.delta_mag_g,\n        v.delta_mag_r\n    FROM light_curve_stats lc\n    JOIN features_filtered f ON lc.oid = f.oid\n    JOIN variations v ON lc.oid = v.oid\n    WHERE v.delta_mag_g > 1\n      AND v.delta_mag_r > 0.5\n)\nSELECT\n    final_selection.oid,\n    final_selection.value,\n    final_selection.name,\n    final_selection.version,\n    final_selection.fid AS \"features_fid\",\n    final_selection.meanra,\n    final_selection.meandec,\n    final_selection.ndet,\n    final_selection.magmax_corr_g,\n    final_selection.magmin_corr_g,\n    final_selection.magmax_corr_r,\n    final_selection.magmin_corr_r,\n    final_selection.delta_mag_g,\n    final_selection.delta_mag_r\nFROM final_selection\nJOIN feature f ON final_selection.oid = f.oid\nWHERE f.name IN ('magmax_corr', 'magmin_corr')\n  AND f.version = (SELECT MAX(version) FROM feature WHERE oid = f.oid AND name = f.name AND fid = f.fid);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6353, "completion_tokens": 862, "total_tokens": 7215, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13538c481909665c106d17f50b4", "custom_id": "1-8", "response": {"status_code": 200, "request_id": "4a8b3ed25cbde0e112b33ef0a41dede7", "body": {"id": "chatcmpl-BwxFFSKj2bIKKObNObg4a0lu3afyG", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdendhist - o.mjdstarthist >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than 1 in g band and 0.5 in r band, corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat magg ON o.oid = magg.oid AND magg.fid = 1\n    JOIN magstat magr ON o.oid = magr.oid AND magr.fid = 2\n    WHERE magg.magmax_corr - magg.magmin_corr > 1\n      AND magr.magmax_corr - magr.magmin_corr > 0.5\n),\n-- Combine all filters: classification, duration, detection count, and variability\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Final selection with required features and properties\nSELECT\n    o.oid,\n    p.probability,\n    p.class_name AS class_name,\n    p.classifier_version,\n    f.value AS feature_value,\n    f.name AS feature_name,\n    f.version AS feature_version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Calculate max and min magnitudes for g and r bands\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 1) AS magmax_g,\n    (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 1) AS magmin_g,\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 2) AS magmax_r,\n    (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 2) AS magmin_r,\n    -- Calculate magnitude variations\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 1) - (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 1) AS delta_mag_g,\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 2) - (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 2) AS delta_mag_r\nFROM object o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n  AND p.probability > 0.6\n  AND o.oid IN (SELECT oid FROM long_duration_objects)\n  AND o.oid IN (SELECT oid FROM variable_objects)\n  AND f.name IN ('Amplitude', 'magmax_corr', 'magmin_corr')\n  AND f.value IS NOT NULL\n  AND f.fid IN (1, 2)\n  AND f.version = (SELECT MAX(version) FROM feature WHERE oid = o.oid AND name = f.name AND fid = f.fid)\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6353, "completion_tokens": 823, "total_tokens": 7176, "prompt_tokens_details": {"cached_tokens": 6144, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13561bc819097194382e6f80c48", "custom_id": "1-9", "response": {"status_code": 200, "request_id": "a65a01295ed6173f823d03662fa1d05c", "body": {"id": "chatcmpl-BwxFFx3OmScbxUU6kZc9rjwFN5XL4", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS total_detections\n    FROM detection\n    GROUP BY oid\n),\nobjects_with_detections AS (\n    SELECT oid\n    FROM detection_counts\n    WHERE total_detections >= 20\n),\n-- Get features for objects with significant variations in g and r bands\nfeatures_g AS (\n    SELECT f.oid, f.value AS mag, f.name, f.version, f.fid\n    FROM feature f\n    WHERE f.name = 'magmax' AND f.fid = 1\n),\nfeatures_r AS (\n    SELECT f.oid, f.value AS mag, f.name, f.version, f.fid\n    FROM feature f\n    WHERE f.name = 'magmax' AND f.fid = 2\n),\nmag_stats_g AS (\n    SELECT oid, MAX(value) AS magmax, MIN(value) AS magmin\n    FROM feature\n    WHERE name = 'magmax' AND fid = 1\n    GROUP BY oid\n),\nmag_stats_r AS (\n    SELECT oid, MAX(value) AS magmax, MIN(value) AS magmin\n    FROM feature\n    WHERE name = 'magmax' AND fid = 2\n    GROUP BY oid\n),\n-- Calculate magnitude variations\nvariations AS (\n    SELECT\n        g.oid,\n        (g.magmax - g.magmin) AS delta_mag_g,\n        (r.magmax - r.magmin) AS delta_mag_r\n    FROM mag_stats_g g\n    JOIN mag_stats_r r ON g.oid = r.oid\n),\n-- Filter objects with variations larger than thresholds in corrected magnitudes\nobjects_with_variations AS (\n    SELECT v.oid\n    FROM variations v\n    JOIN feature f_g ON v.oid = f_g.oid AND f_g.name = 'magmax' AND f_g.fid = 1\n    JOIN feature f_r ON v.oid = f_r.oid AND f_r.name = 'magmax' AND f_r.fid = 2\n    WHERE\n        -- Assuming corrected magnitudes are stored in features with name 'magmax_corr'\n        -- and that the features for corrected magnitudes are available\n        -- If not, this condition can be adjusted accordingly\n        EXISTS (\n            SELECT 1\n            FROM feature fc\n            WHERE fc.oid = v.oid AND fc.name = 'magmax_corr' AND fc.fid = 1\n        )\n        AND v.delta_mag_g > 1\n        AND v.delta_mag_r > 0.5\n),\n-- Final selection of objects meeting all criteria\nfinal_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN long_duration_objects l ON o.oid = l.oid\n    JOIN objects_with_detections d ON o.oid = d.oid\n    JOIN objects_with_variations v ON o.oid = v.oid\n)\n-- Retrieve required information for the final objects\nSELECT\n    o.oid,\n    f.value AS feature_value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    magmax_corr AS magmax,\n    magmin_corr AS magmin,\n    (magmax_corr - magmin_corr) AS delta_mag\nFROM object o\nJOIN feature f ON o.oid = f.oid\nLEFT JOIN (\n    SELECT oid, MAX(CASE WHEN name = 'magmax_corr' AND fid = 1 THEN value END) AS magmax_corr,\n           MAX(CASE WHEN name = 'magmin_corr' AND fid = 1 THEN value END) AS magmin_corr\n    FROM feature\n    WHERE name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY oid\n) mag_stats ON o.oid = mag_stats.oid\nWHERE o.oid IN (SELECT oid FROM final_objects)\n  AND f.name IN ('magmax', 'magmin')\n  AND f.fid IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6353, "completion_tokens": 994, "total_tokens": 7347, "prompt_tokens_details": {"cached_tokens": 6144, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13569408190a4fc8ab58450d354", "custom_id": "16-0", "response": {"status_code": 200, "request_id": "de5126e6b293d3074e520427acee9c53", "body": {"id": "chatcmpl-BwxFHFzyt8HqyZxBsCthAhH29Nei3", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        d.mjd,\n        ms.ndet,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        detection d\n    JOIN\n        magstat ms ON d.oid = ms.oid AND d.fid = ms.fid\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= (SELECT MIN(mjd) FROM detection WHERE oid = d.oid))\n        AND d.mjd < (SELECT first_mjd FROM first_detections WHERE oid = d.oid)\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.candid,\n        lc.fid,\n        lc.magpsf,\n        lc.mjd,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        light_curve_data lc\n    JOIN\n        magstat ms ON lc.oid = ms.oid AND lc.fid = ms.fid\n    WHERE\n        ms.ndet > 0\n        AND (ms.magfirst - ms.maglast) >= 0.25 * (ms.mjd - (SELECT MAX(mjd) FROM detection WHERE oid = lc.oid AND mjd < (SELECT first_mjd FROM first_detections WHERE oid = lc.oid)))\n)\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    ld.fid AS magstat_fid,\n    ld.magpsf,\n    ld.dmdt_first\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    light_curve_data ld ON sp.oid = ld.oid\nJOIN\n    magstat ms ON ld.oid = ms.oid AND ld.fid = ms.fid\nWHERE\n    sp.class_name = 'SN'\n    AND sp.ranking = 1\n    AND ld.oid IN (SELECT oid FROM risers)\nORDER BY\n    sp.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 642, "total_tokens": 4599, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13575188190acab3ed3228b15f8", "custom_id": "16-1", "response": {"status_code": 200, "request_id": "292cb182d59c9f71e4fa3b5eba50fefb", "body": {"id": "chatcmpl-BwxFN0Z3ohmXrDyy8x1emGWNu8l6q", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name='stamp_classifier'\n      AND p.ranking=1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name='SN' -- highest probability class is SN\n),\ndetection_stats AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.fid\n    FROM detection d\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.lastmjd\n    FROM magstat m\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd,\n        -- Calculate initial rise rate: (magfirst - maglast) / (first_detection_mjd - last_non_detection_mjd)\n        -- First, find the last non-detection before first detection\n        (m.magfirst - m.maglast) / NULLIF((fnd.mjd - m.lastmjd), 0) AS initial_rise\n    FROM detection d\n    JOIN magstat m ON d.oid = m.oid AND d.fid = m.fid\n    JOIN detection fnd ON fnd.oid = d.oid AND fnd.mjd < d.mjd AND fnd.isdiffpos=0 -- last non-detection before first detection\n    WHERE d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid=d.oid AND mjd >= 60188.0 AND mjd <= 60189.0)\n    GROUP BY d.oid, m.magfirst, m.lastmjd, m.fid\n),\nfast_risers AS (\n    SELECT\n        r.oid,\n        r.initial_rise\n    FROM rise_estimates r\n    WHERE r.initial_rise >= 0.25 -- fast riser criterion\n)\nSELECT\n    f.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    m.magstat_fid,\n    r.initial_rise\nFROM first_detections f\nJOIN sn_objects sn ON f.oid = sn.oid\nJOIN max_prob mp ON mp.oid = f.oid\nJOIN detection_stats d ON d.oid = f.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid=d.oid AND mjd >= 60188.0 AND mjd <= 60189.0)\nJOIN magstat_info m ON m.oid = f.oid AND m.fid = d.fid\nJOIN rise_estimates r ON r.oid = f.oid\nWHERE mp.class_name='SN'\n  AND r.initial_rise >= 0.25\nORDER BY f.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 734, "total_tokens": 4691, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a135b4ec8190af0715d3264f9e55", "custom_id": "16-2", "response": {"status_code": 200, "request_id": "63548c242b2a9383ed00f8b339a2ac97", "body": {"id": "chatcmpl-BwxFNijrHJqHiEOulduDpo72Ws7A0", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- highest probability class\n),\nstamp_sn AS (\n    SELECT\n        mp.oid,\n        mp.probability\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\nrise_rates AS (\n    SELECT\n        o.oid,\n        -- Calculate the rate of magnitude change at detection\n        CASE\n            WHEN o.ndethist > 0 AND o.mjdendhist >= 60188.0 THEN\n                (m.magfirst - m.maglast) / (o.mjdendhist - o.firstmjd)\n            ELSE NULL\n        END AS rise_rate\n    FROM object o\n    LEFT JOIN magstat m ON o.oid = m.oid AND m.fid = 2 -- filter ID 2 (r-band)\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT\n        r.oid\n    FROM rise_rates r\n    WHERE r.rise_rate >= 0.25 -- fast riser condition\n),\ndetections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.mjd\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM fast_risers)\n      AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= 60188.0 AND mjd <= 60189.0) -- first detection in the date range\n),\nnon_detections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.mjd\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM fast_risers)\n      AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= 60188.0 AND mjd <= 60189.0) -- before first detection\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        -- Estimate initial rise as (magfirst - maglast) / time difference\n        CASE\n            WHEN m.dt_first > 0 THEN (m.magfirst - m.maglast) / m.dt_first\n            ELSE NULL\n        END AS initial_rise_estimate\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM fast_risers)\n      AND m.fid = 2 -- r-band\n)\nSELECT\n    f.oid,\n    fp.probability AS stamp_classifier_probability,\n    d.fid AS detection_filter_id,\n    d.diffmaglim AS diff_image,\n    m.magstat_fid,\n    m.initial_rise_estimate\nFROM first_detections f\nJOIN stamp_sn fp ON f.oid = fp.oid\nJOIN detections d ON f.oid = d.oid\nJOIN magstat_info m ON f.oid = m.oid\nORDER BY f.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 818, "total_tokens": 4775, "prompt_tokens_details": {"cached_tokens": 3840, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1359ed48190826fe73ea4b71ed2", "custom_id": "16-3", "response": {"status_code": 200, "request_id": "7c876b46f4786ece52ceb73bf0eda9ee", "body": {"id": "chatcmpl-BwxFPh2BeFNC54Y9RYbvHHINJAmk2", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curves AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.sigmapsf,\n        d.distnr\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND magpsf IS NOT NULL)\n),\nmagstats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n),\nprobabilities AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.firstmjd,\n        lc.lastmjd,\n        (lc.magfirst - lc.maglast) / (lc.firstmjd - (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)) AS initial_rise\n    FROM\n        magstat lc\n    WHERE\n        lc.oid IN (SELECT oid FROM objects_in_time_window)\n        AND (lc.firstmjd - (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)) > 0\n        AND ((lc.magfirst - (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)) * 0.25) <= (lc.magfirst - lc.maglast)\n)\nSELECT\n    sp.oid,\n    sp.stamp_probability AS probability_in_stamp_classifier,\n    d.fid AS detection_fid,\n    d.diffmaglim,\n    m.fid AS magstat_fid,\n    risers.initial_rise\nFROM\n    stamp_probs sp\nJOIN\n    probabilities p ON sp.oid = p.oid\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    light_curves d ON sp.oid = d.oid\nJOIN\n    magstats m ON sp.oid = m.oid AND m.fid = d.fid\nJOIN\n    risers ON sp.oid = risers.oid\nORDER BY\n    sp.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 828, "total_tokens": 4785, "prompt_tokens_details": {"cached_tokens": 3840, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a135ace4819097f0c182acb27fec", "custom_id": "16-4", "response": {"status_code": 200, "request_id": "ea245b8c3e12aec556cf7bb75b4aa52e", "body": {"id": "chatcmpl-BwxFRcevFYViFlKNhLY3f4xwCy26G", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.probability = (\n            SELECT MAX(probability)\n            FROM probability p2\n            WHERE p2.oid = p.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n        )\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n),\nfast_risers AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        -- Calculate initial rise rate: (magmax - maglast) / (firstmjd - last non-detection mjd)\n        -- For simplicity, assume magmax is magmax from magstat, and last non-detection is approximated by the last negative detection before first detection\n        -- Since detailed last non-detection data is not directly available, approximate using detection data\n        -- For this query, we will assume magmax and maglast are available in magstat\n        ms.magmax AS magmax,\n        ms.maglast AS maglast,\n        ms.firstmjd AS magstat_firstmjd,\n        -- Compute the rate of magnitude change\n        CASE\n            WHEN ms.magmax IS NOT NULL AND ms.maglast IS NOT NULL AND (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2)) > 0\n            THEN (ms.magmax - ms.maglast) / (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2))\n            ELSE NULL\n        END AS initial_rise\n    FROM\n        object o\n        JOIN magstat ms ON o.oid = ms.oid AND ms.fid = 2\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n        AND ms.magmax IS NOT NULL\n        AND ms.maglast IS NOT NULL\n        AND (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2)) > 0\n        AND ((ms.magmax - ms.maglast) / (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2))) >= 0.25\n)\nSELECT\n    o.oid,\n    sp.stamp_probability,\n    d.fid AS magstat_fid,\n    d.magap AS magstat_diffmag,\n    d.mjd AS magstat_mjd,\n    -- Approximate initial rise estimate\n    CASE\n        WHEN fr.initial_rise IS NOT NULL THEN fr.initial_rise\n        ELSE NULL\n    END AS initial_rise_estimate\nFROM\n    fast_risers fr\n    JOIN object o ON fr.oid = o.oid\n    JOIN stamp_probs sp ON o.oid = sp.oid\n    JOIN magstat d ON o.oid = d.oid AND d.fid = 2\nORDER BY\n    o.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 764, "total_tokens": 4721, "prompt_tokens_details": {"cached_tokens": 3840, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a135ac40819087df362e4210bdc5", "custom_id": "16-5", "response": {"status_code": 200, "request_id": "3a938f3832069c99252ce1871a84910b", "body": {"id": "chatcmpl-BwxFCQNL9oegElSA17CmrTfV4fTEH", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and light curve info for fast risers with specific conditions\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nstamp_max AS (\n    SELECT\n        mp.oid,\n        mp.probability\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN'\n),\nlight_curve_non_detections AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.isdiffpos,\n        d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM first_detections)\n      AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND isdiffpos = 1)\n),\nmag_stats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.ndet,\n        m.ndubious,\n        m.magmean,\n        m.magmedian,\n        m.magmax,\n        m.magmin,\n        m.magsigma,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.firstmjd,\n        lc.lastmjd,\n        (lc.magfirst - lc.maglast) / (lc.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = lc.oid AND isdiffpos = 0 AND mjd < (SELECT MIN(mjd) FROM detection WHERE oid = lc.oid AND isdiffpos = 1))) AS rise_rate\n    FROM magstat lc\n    WHERE lc.oid IN (SELECT oid FROM first_detections)\n),\nqualified_objects AS (\n    SELECT\n        f.oid\n    FROM first_detections f\n    JOIN stamp_max s ON f.oid = s.oid\n    WHERE s.probability = (SELECT MAX(probability) FROM max_prob WHERE oid = f.oid)\n      AND s.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n      )\n      AND (initial_rise.rise_rate >= 0.25)\n)\nSELECT\n    q.oid,\n    s.probability AS stamp_probability,\n    lc.fid AS filter_id,\n    lc.magpsf AS mag_difference,\n    m.magstat_fid,\n    (initial_rise.magfirst - initial_rise.maglast) / (initial_rise.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = q.oid AND isdiffpos = 0 AND mjd < (SELECT MIN(mjd) FROM detection WHERE oid = q.oid AND isdiffpos = 1))) AS initial_rise_estimate\nFROM qualified_objects q\nJOIN stamp_max s ON q.oid = s.oid\nJOIN light_curve_non_detections lc ON q.oid = lc.oid\nJOIN mag_stats m ON q.oid = m.oid\nJOIN initial_rise ON q.oid = initial_rise.oid\nORDER BY q.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 810, "total_tokens": 4767, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a135bb4c8190a7150adc5099750e", "custom_id": "16-6", "response": {"status_code": 200, "request_id": "54a1c949cad34ef79d3fe655e8ab0065", "body": {"id": "chatcmpl-BwxFCP1kT11Kyzebw3pIyB53o6djW", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- class SN with highest probability\n),\ncandidate_objects AS (\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.ndet,\n        fd.meanra,\n        fd.meandec\n    FROM first_detections fd\n    JOIN sn_objects sn ON fd.oid = sn.oid\n),\ndetection_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        d.distnr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM candidate_objects)\n      AND d.mjd BETWEEN 60188.0 AND 60189.0 -- detections during the first 2 days\n),\nmagstat_data AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM candidate_objects)\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd,\n        -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - last non-detection mjd)\n        CASE\n            WHEN m.firstmjd > m.lastmjd AND (m.firstmjd - m.lastmjd) > 0\n            THEN (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS initial_rise\n    FROM detection_data d\n    JOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd = m.firstmjd -- only the detection at first detection time\n),\nfast_risers AS (\n    SELECT\n        re.oid,\n        re.candid,\n        re.mjd,\n        re.fid,\n        re.magpsf,\n        re.magfirst,\n        re.maglast,\n        re.firstmjd,\n        re.lastmjd,\n        re.initial_rise\n    FROM rise_estimates re\n    WHERE re.initial_rise >= 0.25 -- fast riser criterion\n)\n-- Final selection with ordering and limit\nSELECT\n    c.oid,\n    p.probability,\n    d.fid AS detection_fid,\n    d.magpsf,\n    m.magstat_fid,\n    re.initial_rise\nFROM fast_risers re\nJOIN object c ON re.oid = c.oid\nJOIN probability p ON p.oid = c.oid AND p.class_name = 'SN' AND p.classifier_name = 'stamp_classifier' AND p.ranking = 1\nJOIN detection d ON d.oid = c.oid AND d.mjd = c.firstmjd\nJOIN magstat m ON m.oid = c.oid AND m.fid = d.fid\nORDER BY c.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 845, "total_tokens": 4802, "prompt_tokens_details": {"cached_tokens": 3840, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a135b8cc81908284f662e7026d57", "custom_id": "16-7", "response": {"status_code": 200, "request_id": "f8c605bc9b7dbae3d47046e003643f6d", "body": {"id": "chatcmpl-BwxFFchi3Kib3DLKJ694QBxiNJd28", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\nfast_risers AS (\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.ndet,\n        fd.ndethist,\n        magstat.magfirst,\n        magstat.maglast,\n        magstat.dmdt_first,\n        magstat.fistmjd,\n        magstat.magsigma,\n        magstat.fid AS magstat_fid\n    FROM first_detections fd\n    JOIN magstat ON magstat.oid = fd.oid AND magstat.fid = 2 -- r-band\n    WHERE magstat.ndet > 0\n      AND magstat.magfirst IS NOT NULL\n      AND magstat.maglast IS NOT NULL\n      AND magstat.fid = 2\n      AND (magstat.magfirst - magstat.maglast) / (fd.firstmjd - (fd.mjdendhist - fd.ndethist)) >= 0.25 -- initial rise rate >= 0.25 mag/day\n)\nSELECT\n    sr.oid,\n    mp.probability,\n    2 AS filter_id,\n    d.magpsf AS diffmag,\n    d.fid AS diff_filter_id,\n    -- Calculate initial rise estimate: difference in magnitude divided by time difference\n    (sr.magfirst - sr.maglast) / (sr.firstmjd - (SELECT mjd FROM detection WHERE oid = sr.oid AND fid = 2 ORDER BY mjd LIMIT 1)) AS initial_rise\nFROM fast_risers sr\nJOIN max_prob mp ON mp.oid = sr.oid\nJOIN detection d ON d.oid = sr.oid AND d.fid = 2\nWHERE mp.class_name = 'SN'\nORDER BY sr.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 548, "total_tokens": 4505, "prompt_tokens_details": {"cached_tokens": 3840, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a135b57c8190a5f900f207676c92", "custom_id": "16-8", "response": {"status_code": 200, "request_id": "d943828c0c1ba5268e7168ccb1f0f486", "body": {"id": "chatcmpl-BwxFKxNCLOepHaMcAGU7y6ZV84lPY", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_info AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        d.dmagdt_first,\n        -- Calculate initial rise estimate: difference in mag divided by time difference\n        CASE\n            WHEN d.dmagdt_first IS NOT NULL AND d.dt_first > 0 THEN\n                d.dm_first / d.dt_first\n            ELSE\n                NULL\n        END AS initial_rise\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.isdiffpos = 1 -- positive difference (brightening)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd,\n        -- Calculate the rate of magnitude change\n        CASE\n            WHEN m.firstmjd IS NOT NULL AND m.lastmjd IS NOT NULL AND m.firstmjd != m.lastmjd THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE\n                NULL\n        END AS mag_change_rate\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n)\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    lc.fid,\n    lc.magpsf,\n    lc.dmagdt_first,\n    lc.dt_first,\n    mi.magstat_fid,\n    mi.mag_change_rate\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window oiw ON sp.oid = oiw.oid\nJOIN\n    light_curve_info lc ON sp.oid = lc.oid\nJOIN\n    magstat_info mi ON sp.oid = mi.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser\n    mi.mag_change_rate >= 0.25\nORDER BY\n    sp.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 607, "total_tokens": 4564, "prompt_tokens_details": {"cached_tokens": 3840, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a135f0688190a901613d909a8b74", "custom_id": "16-9", "response": {"status_code": 200, "request_id": "098f9af77d28182b8603683436013e2f", "body": {"id": "chatcmpl-BwxFCe8e3nZGyV27k8o9hHK1hwx6E", "object": "chat.completion", "created": 1753390458, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- most probable class\n),\nsn_objects AS (\n    SELECT\n        fp.oid\n    FROM first_detections fp\n    JOIN max_prob mp ON fp.oid = mp.oid\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\ndetection_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.diffmaglim,\n        d.isdiffpos,\n        d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_objects)\n),\nmagstat_data AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM sn_objects)\n),\nrise_estimates AS (\n    SELECT\n        md.oid,\n        -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - lastmjd)\n        CASE\n            WHEN (m.firstmjd - m.lastmjd) != 0 THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS initial_rise\n    FROM magstat_data m\n)\nSELECT\n    d.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    d.candid,\n    m.magstat_fid,\n    r.initial_rise\nFROM detection_data d\nJOIN max_prob mp ON d.oid = mp.oid\nJOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\nJOIN rise_estimates r ON d.oid = r.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser: initial rise >= 0.25 mag/day\n    r.initial_rise >= 0.25\nORDER BY d.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3957, "completion_tokens": 593, "total_tokens": 4550, "prompt_tokens_details": {"cached_tokens": 3840, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a135e55481908f47f83534e088db", "custom_id": "19-0", "response": {"status_code": 200, "request_id": "8fc19798129959f71e5e599b8b532688", "body": {"id": "chatcmpl-BwxFMU4VtYR1xWCbRoFmjoMGp4O5n", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.ndet <= 1\n      AND o.oid IN (SELECT oid FROM objects_in_date)\n),\n-- Select objects classified as asteroids with high probability\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM\n    objects_with_one_or_less_detections o\nJOIN\n    asteroid_classification ac ON o.oid = ac.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3182, "completion_tokens": 333, "total_tokens": 3515, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136170c8190b7193fbb31fd6294", "custom_id": "19-1", "response": {"status_code": 200, "request_id": "ca2fa2d94275ccc25e5bca70735bf685", "body": {"id": "chatcmpl-BwxFNKhFt3fGNZUAilf9tXAEcXxNd", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects that appeared between March 1, 2021 (MJD 59274.0) and April 1, 2021 (MJD 59305.0)\n-- with at most one detection, classified as 'asteroid' by the stamp classifier with probability > 0.7\n-- and retrieve specified columns\n\nWITH selected_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59274.0 AND 59305.0\n      AND o.ndet <= 1\n),\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n)\nSELECT \n    so.oid, \n    so.meanra, \n    so.meandec, \n    so.ndet, \n    so.firstmjd, \n    ac.class_name, \n    ac.probability\nFROM selected_objects so\nJOIN asteroid_classification ac ON so.oid = ac.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3182, "completion_tokens": 275, "total_tokens": 3457, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136224c8190a92fa2da6d3a8b44", "custom_id": "19-2", "response": {"status_code": 200, "request_id": "bb720e3717ad2d010974848acf5f01de", "body": {"id": "chatcmpl-BwxFPNP8hVTuPIEOTaodSlE1VEc1o", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for stamp classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n),\n-- Select objects classified as 'SN' (asteroids) with high probability\nasteroid_objects AS (\n    SELECT c.oid\n    FROM classification c\n    WHERE c.class_name = 'SN'\n),\n-- Final selection combining all conditions\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_range r ON o.oid = r.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n    WHERE c.oid IN (SELECT oid FROM asteroid_objects)\n)\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3227, "completion_tokens": 389, "total_tokens": 3616, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1366a788190b367153a83e84622", "custom_id": "19-3", "response": {"status_code": 200, "request_id": "8b9ee8fa3a6fde2f67baaabecfdd7176", "body": {"id": "chatcmpl-BwxFFtLzcw8mPOPi0waGAm6tRWTvO", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for detections\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that satisfy all conditions\nfiltered_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (\n        SELECT oid FROM objects_in_date\n        INTERSECT\n        SELECT oid FROM objects_with_one_or_less_detections\n    )\n),\n-- Get classification probabilities for stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\n-- Filter objects classified as 'SN' (asteroids) with highest probability\nasteroid_classification AS (\n    SELECT c.oid, c.class_name, c.probability\n    FROM (\n        SELECT *, ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n        FROM classification\n    ) c\n    WHERE c.rn = 1 AND c.class_name = 'SN'\n)\n-- Final selection with required columns\nSELECT\n    fo.oid,\n    fo.meanra,\n    fo.meandec,\n    fo.ndet,\n    fo.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM filtered_objects fo\nJOIN asteroid_classification ac ON fo.oid = ac.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3227, "completion_tokens": 433, "total_tokens": 3660, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13625608190a9032d191735b9ce", "custom_id": "19-4", "response": {"status_code": 200, "request_id": "83fc9160cbd931b8d824b741be22e2d6", "body": {"id": "chatcmpl-BwxFRgJXqwJugW7fWmBqBo0jWl9fV", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for the observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for objects classified as 'SN' by stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.7\n),\n-- Combine all filters to get the final set of objects\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_date d ON o.oid = d.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n)\n-- Select the desired columns\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3227, "completion_tokens": 353, "total_tokens": 3580, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1362ec0819082a3eb688cd8552a", "custom_id": "19-5", "response": {"status_code": 200, "request_id": "b38845d7d4379b46955a3ca9b0fdc90b", "body": {"id": "chatcmpl-BwxFRTtSIeVLggB07Kc5mAlFDfPy8", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the specified date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Retrieve objects that satisfy all conditions:\n-- 1. Detected within date range\n-- 2. Have at most one detection overall\n-- 3. Classified as asteroid ('asteroid') by stamp classifier with probability > 0.7\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nJOIN objects_in_date oid_in_date ON o.oid = oid_in_date.oid\nJOIN objects_with_one_or_none_detection oid_one ON o.oid = oid_one.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.ranking = 1; -- ensure the most probable class\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3227, "completion_tokens": 338, "total_tokens": 3565, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1362e108190813f4416d7d6d256", "custom_id": "19-6", "response": {"status_code": 200, "request_id": "467e438136dc2d06655c3c7b610af964", "body": {"id": "chatcmpl-BwxFIrhO692MsjQlDZXxhqZun5qly", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that meet all criteria: in date range, at most one detection, classified as asteroid with high probability\nresult AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        p.class_name,\n        p.probability\n    FROM object o\n    JOIN objects_in_date_range oir ON o.oid = oir.oid\n    JOIN objects_with_one_or_none_detection owd ON o.oid = owd.oid\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\nSELECT * FROM result;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3227, "completion_tokens": 331, "total_tokens": 3558, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1365b4881909496db15c59428f1", "custom_id": "19-7", "response": {"status_code": 200, "request_id": "f4539b3707875b4bd7ddf0ecfc0e4b96", "body": {"id": "chatcmpl-BwxFKtPyC3RkLJQEcmGyWD6426kY9", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for detections\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects classified as asteroids with high probability\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM object o\nJOIN objects_in_date_range dr ON o.oid = dr.oid\nJOIN objects_with_few_detections fw ON o.oid = fw.oid\nJOIN asteroid_classification ac ON o.oid = ac.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3227, "completion_tokens": 321, "total_tokens": 3548, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13634a08190afff2b5c6172f524", "custom_id": "19-8", "response": {"status_code": 200, "request_id": "6e88ddabb6b29a5dc6f2c1b62595b73c", "body": {"id": "chatcmpl-BwxFLLErCqH2lfDP9kOlphn3DhZ5a", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM objects_in_range)\n      AND o.ndet <= 1\n),\n-- Get classification probabilities for stamp classifier with probability > 0.7 and class 'SN' (asteroid)\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND p.class_name = 'SN'\n)\n-- Final selection of objects matching all criteria\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    c.class_name, \n    c.probability\nFROM objects_with_few_detections o\nJOIN classification c ON o.oid = c.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3227, "completion_tokens": 341, "total_tokens": 3568, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1366b008190a9cf20dab4bac174", "custom_id": "19-9", "response": {"status_code": 200, "request_id": "bb2d385ff1a31639334de0ea55b5d2be", "body": {"id": "chatcmpl-BwxFOhZWyMfPURX2EmeL23Zwevp13", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o, date_range dr\n    WHERE o.firstmjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Select relevant probabilities for objects classified as 'SN' (asteroids) by stamp_classifier with probability > 0.7\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.7\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_fewer_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Combine all conditions\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability\n    FROM objects_in_range o\n    JOIN probabilities p ON o.oid = p.oid\n    JOIN objects_with_one_or_fewer_detections ow ON o.oid = ow.oid\n)\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3227, "completion_tokens": 339, "total_tokens": 3566, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13667848190848a5792c3eeaeda", "custom_id": "14-0", "response": {"status_code": 200, "request_id": "feeea35d4e9c8a2349c728c987958dad", "body": {"id": "chatcmpl-BwxFDvQt8iTI88i1w5zDfqj4Bbbbk", "object": "chat.completion", "created": 1753390459, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nlatest_detections AS (\n    SELECT DISTINCT ON (d.oid) d.*\n    FROM detection_filtered d\n    ORDER BY d.oid, d.mjd DESC\n),\nprobability_latest AS (\n    SELECT\n        p.oid,\n        p.probability AS drb_score\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nfinal AS (\n    SELECT\n        ld.oid,\n        ld.candid,\n        ld.fid,\n        ld.mjd,\n        ld.magpsf,\n        ld.sigmapsf,\n        ld.has_stamp,\n        pl.drb_score,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM latest_detections ld\n    LEFT JOIN probability_latest pl ON ld.oid = pl.oid\n    LEFT JOIN xmatch xm ON ld.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE pl.drb_score > 0.5\n      AND (xm.class_catalog < 0.5 OR xm.dist < 1)\n)\nSELECT\n    oid,\n    candid,\n    fid,\n    mjd,\n    magpsf,\n    sigmapsf,\n    has_stamp,\n    drb_score,\n    star_galaxy_score,\n    dist\nFROM final;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3364, "completion_tokens": 584, "total_tokens": 3948, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136b4a0819096274262bbaa8003", "custom_id": "14-1", "response": {"status_code": 200, "request_id": "91afbd5b12f8759c2dc16e6cf8ea6911", "body": {"id": "chatcmpl-BwxFDCa1SZC8pzTx9sgL4BPMyXbd7", "object": "chat.completion", "created": 1753390459, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        x.dist,\n        x.class_catalog\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch x ON d.oid = x.oid\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM selected_oids)\n),\nlatest_detection AS (\n    SELECT DISTINCT ON (d.oid) d.*\n    FROM detection_filtered d\n    ORDER BY d.oid, d.mjd DESC\n)\nSELECT DISTINCT\n    ld.oid,\n    ld.candid,\n    ld.fid,\n    ld.mjd,\n    ld.magpsf,\n    ld.sigmapsf,\n    ld.has_stamp,\n    ld.drb,\n    x.class_catalog,\n    x.dist\nFROM latest_detection ld\nLEFT JOIN probability_filtered p ON ld.oid = p.oid\nLEFT JOIN xmatch x ON ld.oid = x.oid\nWHERE ld.drb > 0.5\n  AND (x.class_catalog = 'star' AND x.dist < 1 OR x.class_catalog = 'galaxy' AND x.dist < 1 OR x.class_catalog IS NULL OR x.dist < 1)\n  AND (x.class_catalog = 'star' AND x.dist < 1 OR x.class_catalog = 'galaxy' AND x.dist < 1 OR x.class_catalog IS NULL OR x.dist < 1)\n  AND (x.class_catalog = 'star' AND x.dist < 1 OR x.class_catalog = 'galaxy' AND x.dist < 1 OR x.class_catalog IS NULL OR x.dist < 1);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3364, "completion_tokens": 542, "total_tokens": 3906, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1369e7c8190ad3a14a19b0dbc22", "custom_id": "14-2", "response": {"status_code": 200, "request_id": "43ce0544a06ce66b19ab6464ab233d42", "body": {"id": "chatcmpl-BwxFGbeF7fXV1LwDOHYwbRqJhVbRa", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nJOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4004, "completion_tokens": 292, "total_tokens": 4296, "prompt_tokens_details": {"cached_tokens": 3840, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136a89481908c045359da497289", "custom_id": "14-3", "response": {"status_code": 200, "request_id": "91546c63acbe84634ebcf3530a03be30", "body": {"id": "chatcmpl-BwxFJcuk6iDdttM635ZOxmbwKtX0J", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid\n    WHERE d.drb > 0.5\n      AND (xm.dist IS NULL OR xm.dist < 1)\n),\nprobability_filtered AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'drl_score' AND p.probability > 0.5\n),\nobject_info AS (\n    SELECT o.oid, o.ndet, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_oids)\n)\nSELECT DISTINCT\n    oi.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    -- Assuming star galaxy score is derived from probability table for class 'VS' (star/galaxy)\n    (SELECT p.probability FROM probability p WHERE p.oid = oi.oid AND p.class_name = 'VS' AND p.classifier_name = 'drl_score' LIMIT 1) AS star_galaxy_score,\n    d.dist\nFROM detection_filtered d\nJOIN object_info oi ON d.oid = oi.oid;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3409, "completion_tokens": 447, "total_tokens": 3856, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136dbf481908c7c5fbedc42bb76", "custom_id": "14-4", "response": {"status_code": 200, "request_id": "bdfb813adbd51f53763b46dc1a3fff55", "body": {"id": "chatcmpl-BwxFLQGs9u8GVIa1yoo8t6Qumculg", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'drb'\n      AND p.probability > 0.5\n),\nfinal_objects AS (\n    SELECT DISTINCT\n        o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_oids)\n)\nSELECT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    d.star_galaxy_score,\n    d.dist\nFROM detection_filtered d\nJOIN final_objects o ON d.oid = o.oid\nWHERE\n    d.drb > 0.5\n    AND (\n        d.star_galaxy_score < 0.5\n        OR d.dist < 1\n    );", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3409, "completion_tokens": 448, "total_tokens": 3857, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136bd148190933b0812e7d8b267", "custom_id": "14-5", "response": {"status_code": 200, "request_id": "2742d7c6d18e8150582e991041644cb7", "body": {"id": "chatcmpl-BwxFOj5F6DRd1unwX87PpkM1qcDPN", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.dist\n    FROM detection d\n    JOIN selected_oids s ON d.oid = s.oid\n    LEFT JOIN xmatch p ON d.oid = p.oid AND p.catid = 'panstarrs'\n    WHERE d.drb > 0.5 AND (p.dist < 1 OR p.dist IS NULL)\n)\nSELECT DISTINCT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.dist\nFROM detection_filtered d\nJOIN object o ON d.oid = o.oid\nLEFT JOIN xmatch p ON o.oid = p.oid AND p.catid = 'panstarrs';", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3409, "completion_tokens": 316, "total_tokens": 3725, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136cb688190913afc3091f9e3a9", "custom_id": "14-6", "response": {"status_code": 200, "request_id": "51fdfebb215ddb4d4c5ab71f6e4421dc", "body": {"id": "chatcmpl-BwxFPa8faTCklIooZUKLDkK04Z8l5", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nLEFT JOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4004, "completion_tokens": 293, "total_tokens": 4297, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136df788190b05b687d2fcd4c58", "custom_id": "14-7", "response": {"status_code": 200, "request_id": "c47405184beb9911b82e1315ce99bdf3", "body": {"id": "chatcmpl-BwxFEyXlTm29aLqimIeUcidxIfe8t", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nLEFT JOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4004, "completion_tokens": 293, "total_tokens": 4297, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136f5788190b25a427ca5d9709d", "custom_id": "14-8", "response": {"status_code": 200, "request_id": "dbaf87c26ee6a945babcbaccea3bb620", "body": {"id": "chatcmpl-BwxFEDUkWYVyUqNiPAUybEK4lyg4z", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n),\nlatest_detections AS (\n    SELECT df.oid, df.candid, df.fid, df.mjd, df.magpsf, df.sigmapsf, df.has_stamp, df.drb, df.dist\n    FROM detection_filtered df\n),\ndeep_bogus_scores AS (\n    SELECT oid, drb\n    FROM latest_detections\n    WHERE drb > 0.5\n),\nclassification_scores AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability_filtered p\n    WHERE p.classifier_name = 'lc_classifier'\n),\nstar_galaxy_scores AS (\n    SELECT p.oid, p.probability AS star_galaxy_score\n    FROM probability_filtered p\n    WHERE p.class_name = 'VS' AND p.classifier_name = 'stamp_classifier'\n),\nnearest_panstarrs AS (\n    SELECT oid, dist\n    FROM latest_detections\n    WHERE xm.catid = 'panstarrs'\n)\nSELECT DISTINCT\n    ld.oid,\n    ld.candid,\n    ld.fid,\n    ld.mjd,\n    ld.magpsf,\n    ld.sigmapsf,\n    ld.has_stamp,\n    dbs.drb,\n    sg.star_galaxy_score,\n    np.dist\nFROM latest_detections ld\nLEFT JOIN deep_bogus_scores dbs ON ld.oid = dbs.oid\nLEFT JOIN star_galaxy_scores sg ON ld.oid = sg.oid\nLEFT JOIN nearest_panstarrs np ON ld.oid = np.oid\nWHERE\n    dbs.drb > 0.5\n    AND (\n        sg.star_galaxy_score < 0.5\n        OR np.dist < 1\n    );", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3409, "completion_tokens": 631, "total_tokens": 4040, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136e5a8819098a2f1e22a46bccf", "custom_id": "14-9", "response": {"status_code": 200, "request_id": "6f70d289d3c9181071f7d6a3b5b26434", "body": {"id": "chatcmpl-BwxFF3TC0O8NpDE7cByIkCwycMhY0", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.drb > 0.5 AND (xm.dist IS NULL OR xm.dist < 1)\n)\nSELECT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    -- Retrieve the star galaxy score from the probability table for the most probable class in 'lc_classifier' for each object\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid AND p.class_name = 'VS' AND p.classifier_name = 'lc_classifier'\n     ORDER BY p.ranking LIMIT 1) AS star_galaxy_score,\n    d.dist\nFROM object o\nJOIN detection_filtered d ON o.oid = d.oid;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3409, "completion_tokens": 373, "total_tokens": 3782, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a136ec4081909bac5c19b650dc2d", "custom_id": "30-0", "response": {"status_code": 200, "request_id": "f66699da5c51745699ace3165c629301", "body": {"id": "chatcmpl-BwxFKJozuGQsDAFDScdfN2nEAPOg8", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the most probable class for each object from the probability table\nJOIN (\n    SELECT \n        p1.oid,\n        p1.class_name,\n        p1.probability\n    FROM \n        probability p1\n    WHERE \n        p1.classifier_name = 'lc_classifier'\n        AND p1.classifier_version = (SELECT MAX(classifier_version) FROM probability p2 WHERE p2.classifier_name = 'lc_classifier' AND p2.oid = p1.oid)\n        AND p1.ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2542, "completion_tokens": 182, "total_tokens": 2724, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1373ef481908e7aba71425d2711", "custom_id": "30-1", "response": {"status_code": 200, "request_id": "dc5d73d5434bdfa5bdb508c353fef946", "body": {"id": "chatcmpl-BwxFKzkRWa5CML0di7mJtw129zBum", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2542, "completion_tokens": 127, "total_tokens": 2669, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137247881908b7a1c38a7798d37", "custom_id": "30-2", "response": {"status_code": 200, "request_id": "fdd79b428bf1402486d4641dcbf7021a", "body": {"id": "chatcmpl-BwxFEwYqaNQMhUgYXCGV1EfyAFB5D", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2587, "completion_tokens": 127, "total_tokens": 2714, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1372b948190b70eeef4ff8331b4", "custom_id": "30-3", "response": {"status_code": 200, "request_id": "608d082e24ec18d2a4fcaebbde3bef39", "body": {"id": "chatcmpl-BwxFKVzcVVMPerDmDm3hbUVAZrPJm", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2587, "completion_tokens": 127, "total_tokens": 2714, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137479481909df5bfa99173366d", "custom_id": "30-4", "response": {"status_code": 200, "request_id": "02a0c6bbbc98027b1e79363bd82877c0", "body": {"id": "chatcmpl-BwxFEFWK1Gs0VQctk5PpHiJ7JOr4h", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2587, "completion_tokens": 127, "total_tokens": 2714, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1374f9c8190a29417185676f6a8", "custom_id": "30-5", "response": {"status_code": 200, "request_id": "b73ed2ba02dc5fcf14d5a345f9f43b2a", "body": {"id": "chatcmpl-BwxFE1ubEGqJ5qcnaOGxGsqD21Fjt", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2587, "completion_tokens": 127, "total_tokens": 2714, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1375f948190b1b9eb2e7d6099ac", "custom_id": "30-6", "response": {"status_code": 200, "request_id": "5d84b9ff08733c4dfca9014f847a6e6d", "body": {"id": "chatcmpl-BwxFMlRPzQWg0bGg8WwIK0hjdja7q", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2587, "completion_tokens": 127, "total_tokens": 2714, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13777e081909602df1f06585660", "custom_id": "30-7", "response": {"status_code": 200, "request_id": "0603b5711c651479345a91a5a14a175a", "body": {"id": "chatcmpl-BwxFH7nol7K9myM6ZfY9CVlM7LPcl", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2587, "completion_tokens": 127, "total_tokens": 2714, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13766708190979087ea6b155ab0", "custom_id": "30-8", "response": {"status_code": 200, "request_id": "18b1d4cd81893502d00d85f1d25a8a3c", "body": {"id": "chatcmpl-BwxFEWeNpfnm5ISJYtaahmcHGlzJs", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2587, "completion_tokens": 127, "total_tokens": 2714, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137791c8190bb878cdbbb029f54", "custom_id": "30-9", "response": {"status_code": 200, "request_id": "31fa25b7670950c6de5d3af001135649", "body": {"id": "chatcmpl-BwxFGcFdvrlxzetTZIahfUYACWViz", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2587, "completion_tokens": 127, "total_tokens": 2714, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13772448190ad6a249fb7aa6282", "custom_id": "22-0", "response": {"status_code": 200, "request_id": "6cae6e7a83acf67fe89e7937113031e9", "body": {"id": "chatcmpl-BwxFEkZF9eLuULG4GJ0yYBtd167GC", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object details for objects detected between June 1st and July 1st, 2018\nWITH date_filtered_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd >= 58239.0 AND lastmjd <= 58270.0\n)\n-- Retrieve objects with their top-ranked probability class from the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid\n    FROM date_filtered_objects\n) AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2564, "completion_tokens": 146, "total_tokens": 2710, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137a67c819096b8670053e42351", "custom_id": "22-1", "response": {"status_code": 200, "request_id": "460e4e20e1ac73ba8cf28ca5dcff2eae", "body": {"id": "chatcmpl-BwxFO2pHUMok4EV4pBQNgDt9ESQxG", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object details for objects detected between June 1st and July 1st, 2018\nWITH object_time_filtered AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd >= 58239.0 AND firstmjd <= 58270.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to select objects with top-ranked probability for the light curve classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM object_time_filtered)\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2564, "completion_tokens": 139, "total_tokens": 2703, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137afa48190b0cb8085815fba97", "custom_id": "22-2", "response": {"status_code": 200, "request_id": "9cd2ca7ca5ec554ed1b637f60ff53ccd", "body": {"id": "chatcmpl-BwxFEvAsMAzcUsjDMr3G3FmyJfrye", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5040, "completion_tokens": 136, "total_tokens": 5176, "prompt_tokens_details": {"cached_tokens": 4864, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137b4b081909fe5c3b7af84e5f7", "custom_id": "22-3", "response": {"status_code": 200, "request_id": "b2a32f5277f16f96235d6b5b21508537", "body": {"id": "chatcmpl-BwxFHPgMmbvi2btqlbJuiVqR2Ngqq", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects detected between June 1st and July 1st, 2018, classified by the light curve classifier\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n)\nSELECT o.*\nFROM object o\nWHERE o.firstmjd >= (SELECT start_mjd FROM date_range)\n  AND o.firstmjd <= (SELECT end_mjd FROM date_range)\n  AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n        AND p.ranking = 1\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5119, "completion_tokens": 165, "total_tokens": 5284, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137c37081909b1faa98b7373db8", "custom_id": "22-4", "response": {"status_code": 200, "request_id": "07c1b6a6db97407b867c87ba1531f700", "body": {"id": "chatcmpl-BwxFE4cX55dDSvtrisr0Mxd0O1QCh", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5040, "completion_tokens": 149, "total_tokens": 5189, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137ce7c819092b32ea27361574f", "custom_id": "22-5", "response": {"status_code": 200, "request_id": "bb516fa9323d73a32910618022db0c7d", "body": {"id": "chatcmpl-BwxFJuY4bnfxqOUVnNWPzX69QoRPv", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the date range in MJD\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n),\n-- Select object OIDs with probabilities from the light curve classifier within the date range\nlc_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1 -- most probable class\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.firstmjd <= (SELECT end_mjd FROM date_range)\n            AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n      )\n)\n-- Final selection of objects found within the date range by the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM lc_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5119, "completion_tokens": 186, "total_tokens": 5305, "prompt_tokens_details": {"cached_tokens": 4992, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137d9dc819092e10c8bdd756af7", "custom_id": "22-6", "response": {"status_code": 200, "request_id": "0818a999622efdfd3256bc523e8b3b30", "body": {"id": "chatcmpl-BwxFLvhBHYmzKrdReEDNkgJpTBdfO", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nWITH date_filtered_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd <= 58270.0\n      AND lastmjd >= 58239.0\n)\n-- Retrieve objects with probabilities for the light curve classifier within the date range\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM date_filtered_objects)\n  AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5040, "completion_tokens": 170, "total_tokens": 5210, "prompt_tokens_details": {"cached_tokens": 4864, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137e00481909e497bc64c8465c1", "custom_id": "22-7", "response": {"status_code": 200, "request_id": "7433cce55c358dd7c6f7f7e67c5c1b30", "body": {"id": "chatcmpl-BwxFExp9alh4Iu2iFHH0V0zuG3oYE", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5040, "completion_tokens": 126, "total_tokens": 5166, "prompt_tokens_details": {"cached_tokens": 4864, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13835688190b070ec7b22510b9e", "custom_id": "22-8", "response": {"status_code": 200, "request_id": "faa90dccb6b4b150661430ca8b14adb5", "body": {"id": "chatcmpl-BwxFLuIroT8IN9fOGA6ntYr0If1aF", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5040, "completion_tokens": 136, "total_tokens": 5176, "prompt_tokens_details": {"cached_tokens": 4864, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a137ffd4819094fa2be66d1f113c", "custom_id": "22-9", "response": {"status_code": 200, "request_id": "e58deaa797f2b678e1eb91d457bab85b", "body": {"id": "chatcmpl-BwxFHtDuoYRdxWahOblWh2xRjdBnQ", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5040, "completion_tokens": 136, "total_tokens": 5176, "prompt_tokens_details": {"cached_tokens": 4864, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1380b9c81908264514ac98f1d57", "custom_id": "12-0", "response": {"status_code": 200, "request_id": "efa9fa63c8e1ef4abd02d84b95944d90", "body": {"id": "chatcmpl-BwxFGGvhr5GJL9r5jgNJBWbUsM1yA", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sources AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\nsn_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n)\nSELECT s.oid, s.meanra, s.meandec\nFROM sources s\nJOIN sn_probabilities sp ON s.oid = sp.oid\nWHERE q3c_poly_query(s.meanra, s.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2609, "completion_tokens": 173, "total_tokens": 2782, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13825b08190a0395996aa2d9f18", "custom_id": "12-1", "response": {"status_code": 200, "request_id": "437c16d6f21d1de5c08eb80d1f7ce498", "body": {"id": "chatcmpl-BwxFOtgJ8NazWWkN1luM9D3jqog9k", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH source_coords AS (\n    SELECT * FROM (VALUES\n        ('polygon_region', '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    ) AS t(source_id, poly)\n)\nSELECT o.oid, o.meanra, o.meandec\nFROM object o\nWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0\n  AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n  )\n  AND EXISTS (\n    SELECT 1\n    FROM source_coords sc\n    WHERE q3c_poly_query(o.meanra, o.meandec, sc.poly)\n  );", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2609, "completion_tokens": 185, "total_tokens": 2794, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1383f448190b774974916d4c77e", "custom_id": "12-2", "response": {"status_code": 200, "request_id": "ddf83ce2a4d21d62694b931293f1dc2f", "body": {"id": "chatcmpl-BwxFKRCA7NtvEC17OdwUmoyaiHXwv", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.object_oid IN (\n            SELECT o2.oid\n            FROM object o2\n            WHERE o2.oid = p.object_oid\n              AND p.class_name = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        )\n        AND p.first_detection_mjd BETWEEN 59988.0 AND 60197.0\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2425, "completion_tokens": 185, "total_tokens": 2610, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1383dc081909aef64751bf8d1f5", "custom_id": "12-3", "response": {"status_code": 200, "request_id": "9ed7f5cd97848469ef7c647a0138ad50", "body": {"id": "chatcmpl-BwxFImJie61kTd9yUgbfAzt3vzPCT", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.object_oid IN (\n            SELECT o.oid\n            FROM object o\n            WHERE o.oid IN (\n                SELECT o.oid\n                FROM object o\n                WHERE o.firstmjd BETWEEN 59988.0 AND 60197.0\n            )\n        )\n        AND p.class_name = 'SNe'\n        AND p.ranking = 1\n        AND p.classifier_name = 'lc_classifier'\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2425, "completion_tokens": 192, "total_tokens": 2617, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1383ed08190a4d6f84fe5d74b0c", "custom_id": "12-4", "response": {"status_code": 200, "request_id": "4e96e293dbf7206c9f83163351f49210", "body": {"id": "chatcmpl-BwxFPuGMdkRYfu0Ucpe99ePP3j27U", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid IN (\n        SELECT oid\n        FROM (\n            SELECT oid, \n                   (probability ->> 'SNIa')::float AS snia_prob,\n                   (probability ->> 'SNIbc')::float AS snbc_prob,\n                   (probability ->> 'SNII')::float AS snii_prob,\n                   (probability ->> 'SLSN')::float AS slsn_prob\n            FROM probability\n            WHERE classifier_name = 'lc_classifier'\n        ) sub\n        WHERE snia_prob IS NOT NULL OR snbc_prob IS NOT NULL OR snii_prob IS NOT NULL OR slsn_prob IS NOT NULL\n    )\n    AND oid IN (\n        SELECT oid\n        FROM object\n        WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    (SELECT array_agg(ra) FROM (VALUES (-20), -2, 20, 10) AS t(ra)),\n    (SELECT array_agg(dec) FROM (VALUES (-20), -20, 1, 10) AS t(dec)),\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2425, "completion_tokens": 299, "total_tokens": 2724, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1386ab88190961e1e22df983883", "custom_id": "12-5", "response": {"status_code": 200, "request_id": "b168c6862fc48ca79ffe582e68e05cb1", "body": {"id": "chatcmpl-BwxFJBi7jAcewzVNMpjfnfs0nSA0k", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sources AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\npolygon_coords AS (\n    SELECT ARRAY[\n        ROW(-20, -20),\n        ROW(-2, -20),\n        ROW(20, 1),\n        ROW(10, 10),\n        ROW(-20, -20) -- close the polygon\n    ]::point[] AS poly\n)\nSELECT s.oid, s.meanra, s.meandec\nFROM sources s, polygon_coords p\nWHERE q3c_poly_query(s.meanra, s.meandec, p.poly);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2425, "completion_tokens": 140, "total_tokens": 2565, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1387da08190978eb59e5eca2a6c", "custom_id": "12-6", "response": {"status_code": 200, "request_id": "ef3535a333d429d3de490b9fda4f8690", "body": {"id": "chatcmpl-BwxFEITlcb8TGYkALKdwIBLMsrYes", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid IN (\n        SELECT oid\n        FROM (\n            SELECT oid, \n                   (probability ->> 'SNIa')::float AS snia_prob,\n                   (probability ->> 'SNIbc')::float AS snbc_prob,\n                   (probability ->> 'SNII')::float AS snii_prob,\n                   (probability ->> 'SLSN')::float AS slsn_prob\n            FROM probability\n            WHERE classifier_name = 'lc_classifier'\n        ) sub\n        WHERE snia_prob IS NOT NULL OR snbc_prob IS NOT NULL OR snii_prob IS NOT NULL OR slsn_prob IS NOT NULL\n    )\n    AND oid IN (\n        SELECT oid\n        FROM object\n        WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    (SELECT array_agg(ra) FROM (VALUES (-20), (-2), (20), (10)) AS coords(ra)),\n    (SELECT array_agg(dec) FROM (VALUES (-20), (-20), (1), (10)) AS coords(dec)),\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n)\n;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2425, "completion_tokens": 300, "total_tokens": 2725, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1387bb48190993f364f7feaa290", "custom_id": "12-7", "response": {"status_code": 200, "request_id": "4178403393cc811119581f26fe20e9e2", "body": {"id": "chatcmpl-BwxFJxC73AcbXzUrPElSQOpaW6dpm", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.object_oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.ranking = 1\n          AND p.classifier_name = 'stamp_classifier'\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2425, "completion_tokens": 161, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1387d948190862b293b6933675b", "custom_id": "12-8", "response": {"status_code": 200, "request_id": "417cfe06e285fea77a8e6494be51f8c9", "body": {"id": "chatcmpl-BwxFMXYsX9FE4BVr7G8efgC5kDPxs", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.class_name = 'SNIa' -- Supernovae type Ia, included in all SNe\n        AND p.ranking = 1 -- most probable class\n        AND p.classifier_name = 'lc_classifier' -- default classifier for probabilities\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0 -- first occurrence between Feb 13 and Sep 10\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2425, "completion_tokens": 187, "total_tokens": 2612, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1388be88190b9acc5742fbd42c0", "custom_id": "12-9", "response": {"status_code": 200, "request_id": "74374f0a04b8fedb393c053c8f143151", "body": {"id": "chatcmpl-BwxFEPqSo5TDLtjvItlBOrLbEDwf8", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM (\n            SELECT oid\n            FROM probability p\n            WHERE p.object = o.oid\n              AND p.class = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        ) AS sn\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2425, "completion_tokens": 166, "total_tokens": 2591, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a138ab988190b8c442157908b141", "custom_id": "57-0", "response": {"status_code": 200, "request_id": "2a840dc7191cef7f116da6be492cc4b7", "body": {"id": "chatcmpl-BwxFHytxlroJkRusZxMhayY5Vx3FV", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS ra_input,\n        io.dec AS dec_input,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    mo.oid AS ztf_object_id,\n    mo.ndet AS number_of_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_mjd,\n    io.identifier AS input_object_id,\n    io.ra AS input_ra,\n    io.dec AS input_dec,\n    io.radius_deg AS search_radius_deg\nFROM\n    matched_objects mo\nJOIN\n    object o ON mo.oid = o.oid\nORDER BY\n    mo.firstmjd DESC;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 315, "total_tokens": 3440, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a138b9708190bf7ce095af18476e", "custom_id": "57-1", "response": {"status_code": 200, "request_id": "1ee43dc558e92ba3b7ed396262f6c6b9", "body": {"id": "chatcmpl-BwxFId9I1SFlBmxZMZOZgJHEvdnD4", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(o.meanra) AS mean_ra,\n        AVG(o.meandec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        input_objects io\n    JOIN\n        object o ON TRUE\n    JOIN\n        detection d ON d.oid = o.oid\n    WHERE\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    GROUP BY\n        io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    input_id,\n    input_ra,\n    input_dec,\n    radius_deg,\n    ztf_oid,\n    detection_count,\n    mean_ra,\n    mean_dec,\n    first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    first_detection_mjd DESC;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 334, "total_tokens": 3459, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a138c43c8190ae97d9b6facda435", "custom_id": "57-2", "response": {"status_code": 200, "request_id": "3daddd950048f9382d4fa4cb370b1588", "body": {"id": "chatcmpl-BwxFJbsFGtV3FvE3Xypo19Ww5I0OQ", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    mo.oid AS ztf_object_id,\n    mo.ndet AS number_of_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_date,\n    io.identifier AS input_object_id,\n    io.radius_deg AS search_radius_deg\nFROM\n    matched_objects mo\nJOIN\n    input_objects io ON mo.input_id = io.identifier\nORDER BY\n    mo.firstmjd DESC;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 289, "total_tokens": 3414, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a138d6bc81909a0b605749645195", "custom_id": "57-3", "response": {"status_code": 200, "request_id": "e06bd317906808bdc27e42236f9d17ee", "body": {"id": "chatcmpl-BwxFIIt3sY09gf8yVMy6lqzAfPfiV", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS ra_input,\n        io.dec AS dec_input,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM\n    matched_objects m\nJOIN\n    object o\nON\n    m.oid = o.oid\nJOIN\n    input_objects io\nON\n    io.identifier = m.identifier\nORDER BY\n    m.firstmjd DESC;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 338, "total_tokens": 3463, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a138b9f08190af890116fbd81ceb", "custom_id": "57-4", "response": {"status_code": 200, "request_id": "7a826e5b7ad94d3c7b6e1f30a1a8f294", "body": {"id": "chatcmpl-BwxFIEpQ4Nn1sFsYbK0dFtaKYR5qB", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM\n    matched_objects m\nJOIN\n    object o ON m.oid = o.oid\nJOIN\n    input_objects io ON io.identifier = m.identifier\nORDER BY\n    m.firstmjd DESC;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 332, "total_tokens": 3457, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13904c48190b3d2eb677324a511", "custom_id": "57-5", "response": {"status_code": 200, "request_id": "950d16d86f3bf07493f239ff4909bab6", "body": {"id": "chatcmpl-BwxFJGgtps1AqkuOQcABqVHgnCbm5", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    mo.oid AS ztf_id,\n    mo.ndet AS num_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_mjd\nFROM\n    matched_objects mo\nORDER BY\n    mo.firstmjd DESC;\n", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 257, "total_tokens": 3382, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a138f10081908f99281f82a492f0", "custom_id": "57-6", "response": {"status_code": 200, "request_id": "9cfa407f4bcb1137c68bb7420188de7c", "body": {"id": "chatcmpl-BwxFETwcMgilFQZ5nt5ZxQCvaRONl", "object": "chat.completion", "created": 1753390460, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM object o\n    JOIN input_objects io ON (\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    )\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM matched_objects m\nJOIN input_objects io ON m.input_id = io.identifier\nORDER BY m.firstmjd DESC;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 290, "total_tokens": 3415, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a138fc60819082d91e44005b2936", "custom_id": "57-7", "response": {"status_code": 200, "request_id": "43e963bea6b5ef96e3b2c73f128c4f07", "body": {"id": "chatcmpl-BwxFNKG6RV1umfNdKAIbVQ2MUSarw", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        (io.identifier = 'id_1' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n        OR\n        (io.identifier = 'id_2' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n)\nSELECT\n    -- Input object info\n    input_id AS input_object_id,\n    ra AS input_object_ra,\n    dec AS input_object_dec,\n    radius_deg AS search_radius_deg,\n    -- ZTF object info\n    oid AS ztf_object_id,\n    ndet AS number_of_detections,\n    meanra,\n    meandec,\n    firstmjd AS first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    firstmjd DESC;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 341, "total_tokens": 3466, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13906348190b962af95bb1baf29", "custom_id": "57-8", "response": {"status_code": 200, "request_id": "8fcd5460b0900de358d7bda662c68ff0", "body": {"id": "chatcmpl-BwxFGK5RhXdHWkfjIuuxD1hEkNJtI", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS num_detections,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd\n    FROM input_objects io\n    JOIN object o ON (\n        q3c_join(io.ra, io.dec, o.meanra, o.meandec, io.radius_deg)\n    )\n    LEFT JOIN detection d ON d.oid = o.oid\n    GROUP BY io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    mo.ztf_oid AS ztf_object_id,\n    mo.num_detections,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM input_objects io\nJOIN matched_objects mo ON io.identifier = mo.input_id\nORDER BY mo.last_detection_mjd DESC;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 354, "total_tokens": 3479, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1392344819080ad6ecb31ccdf28", "custom_id": "57-9", "response": {"status_code": 200, "request_id": "5f1f5561aab5805247783fcdf43e6b3f", "body": {"id": "chatcmpl-BwxFOHa7cuwlmBGljeVuHmKYsaxLF", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0/3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0/3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS object_id\n    FROM input_objects io\n    WHERE EXISTS (\n        SELECT 1\n        FROM object o\n        WHERE q3c_join(io.ra, io.dec, o.meanra, o.meandec, io.radius_deg)\n    )\n),\nztf_objects AS (\n    SELECT\n        mo.object_id,\n        COUNT(d.candid) AS num_detections,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd\n    FROM matched_objects mo\n    JOIN detection d ON d.oid = mo.object_id\n    GROUP BY mo.object_id\n)\nSELECT\n    mo.object_id AS ztf_id,\n    mo.num_detections,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM ztf_objects mo\nORDER BY mo.last_detection_mjd DESC;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3125, "completion_tokens": 319, "total_tokens": 3444, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13934808190a2c5fbf5bda5bbcd", "custom_id": "75-0", "response": {"status_code": 200, "request_id": "87903e36a3ad7e2aa3f21c42dbedc89d", "body": {"id": "chatcmpl-BwxFQd2mkF2IWiqjsTR48ZR53A7Bz", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 24, "total_tokens": 2049, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1395ecc81908e64c5551b531e4e", "custom_id": "75-1", "response": {"status_code": 200, "request_id": "19f633b3cf37dec24dfddb764224312d", "body": {"id": "chatcmpl-BwxFLj6NPabBtvNSR3rackSoxxD0i", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 24, "total_tokens": 2049, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13939b881909b9ad39fa53fe2f9", "custom_id": "75-2", "response": {"status_code": 200, "request_id": "4691fca67da1b0ef1d6079b60144bf4f", "body": {"id": "chatcmpl-BwxFL38r0JWC9dKPccNYny3a2CDoG", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 24, "total_tokens": 2049, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1393e3481908e62146fdfada6fa", "custom_id": "75-3", "response": {"status_code": 200, "request_id": "d1c45f2f1c808393bc66733691d92d34", "body": {"id": "chatcmpl-BwxFMOBKl7ha0B97Q9UMn6VTDBVc7", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 24, "total_tokens": 2049, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a139569c8190bb40a2f75477053f", "custom_id": "75-4", "response": {"status_code": 200, "request_id": "c6400c69f5452efcf32185a53fbfba50", "body": {"id": "chatcmpl-BwxFOsZIpFHQ9c7LnPum4HpqovZXG", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 24, "total_tokens": 2049, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13969ac81908846b2e7da816c7f", "custom_id": "75-5", "response": {"status_code": 200, "request_id": "a41b50a3e0b0807b16a3b7f21b985120", "body": {"id": "chatcmpl-BwxFFRVBQqE2ZGByiyRBWPhM2Jm80", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM ss_ztf \nWHERE ssnamenr IS NOT NULL \nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 25, "total_tokens": 2050, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1397ad0819084c8de66285e1608", "custom_id": "75-6", "response": {"status_code": 200, "request_id": "dae2d3724666a58966ea60bcaafdee1f", "body": {"id": "chatcmpl-BwxFIE5wTFPrIa3tHBLrWSup6mfaK", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 24, "total_tokens": 2049, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1398f748190a9926742e67a26a9", "custom_id": "75-7", "response": {"status_code": 200, "request_id": "2eb6d19e35273cf8ff5dbfac24988ba8", "body": {"id": "chatcmpl-BwxFHKokuGYgmvSiK19oG4LOIkQxc", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 24, "total_tokens": 2049, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a139888481908b40faf7b97e3d13", "custom_id": "75-8", "response": {"status_code": 200, "request_id": "f3cf413a512a151daba4f20347de533f", "body": {"id": "chatcmpl-BwxFJwIo2r8dRHisJFgq4Iwg2Ig7C", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 24, "total_tokens": 2049, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1399c248190b6c86daff9858783", "custom_id": "75-9", "response": {"status_code": 200, "request_id": "21b8d03057e7b569a3c6f582ca31bdf1", "body": {"id": "chatcmpl-BwxFJ3uLcAgG4wfABiYmHvgX9rguE", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 24, "total_tokens": 2049, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a139c0c08190bd1d00bb0ab5512c", "custom_id": "43-0", "response": {"status_code": 200, "request_id": "05a0c8a029dd72629f6561c457323add", "body": {"id": "chatcmpl-BwxFLdo6WiLL12MbemUFZJz3FsTKt", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2; -- 2 corresponds to the r-band\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3179, "completion_tokens": 93, "total_tokens": 3272, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a139c5608190b800e8833e253f57", "custom_id": "43-1", "response": {"status_code": 200, "request_id": "229af6e0d7a05c42b21326eee4e227f9", "body": {"id": "chatcmpl-BwxFN4gNeQZPJb93DOT143GPUGbMR", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2; -- 2 corresponds to the r-band\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3179, "completion_tokens": 93, "total_tokens": 3272, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a139baa4819086017fa8ee2c59c9", "custom_id": "43-2", "response": {"status_code": 200, "request_id": "1d523bb59c9d1310970641119853dc6a", "body": {"id": "chatcmpl-BwxFFOB4jpdLrc1FK7MD3DTviRLgu", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2697, "completion_tokens": 86, "total_tokens": 2783, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a139d2dc8190b263d1e25b84ab2c", "custom_id": "43-3", "response": {"status_code": 200, "request_id": "7df5186470d86dac436172077829461e", "body": {"id": "chatcmpl-BwxFH5LnmAClbZsHIML3dxcsHbTho", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant columns for specified objects and r-band filter\nSELECT \n    dq.oid AS ztf_identifier,\n    dq.candid AS candidate_id,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr AS peak_pixel_snr\nFROM \n    dataquality dq\nWHERE \n    dq.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND dq.fid = 2; -- 2 corresponds to the r-band filter\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2697, "completion_tokens": 106, "total_tokens": 2803, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a139dfa88190a4adb1680e3b5d49", "custom_id": "43-4", "response": {"status_code": 200, "request_id": "3fad0b264979b36250d5e48ffee01e94", "body": {"id": "chatcmpl-BwxFIRUL9eTvfKVuUYJGKCovDVq3e", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant columns for specified objects and r-band filter\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2; -- r-band filter\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2697, "completion_tokens": 87, "total_tokens": 2784, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a139f60c81909bb225f6c1c50f97", "custom_id": "43-5", "response": {"status_code": 200, "request_id": "35b732c136df199306bb426f14c5209f", "body": {"id": "chatcmpl-BwxFKJopAfXyJXjBxVtoK5WZTGwNv", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    dq.oid AS ztf_identifier,\n    dq.candid AS candidate_id,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr AS peak_pixel_snr\nFROM \n    dataquality dq\nWHERE \n    dq.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND dq.fid = 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2697, "completion_tokens": 100, "total_tokens": 2797, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a139f364819099f3e50ca6451457", "custom_id": "43-6", "response": {"status_code": 200, "request_id": "d22729fd9352691a6c264765e0de1cb0", "body": {"id": "chatcmpl-BwxFFzS9MqSnfgrq9Rc9wldBGxkQv", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant columns for specified objects and r-band filter\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2; -- 2 corresponds to the r-band filter\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2697, "completion_tokens": 106, "total_tokens": 2803, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a044c8190886195bf5606d0f0", "custom_id": "43-7", "response": {"status_code": 200, "request_id": "625dbbef96f1266803a4c31c402437b4", "body": {"id": "chatcmpl-BwxFFjYeLpA4p1EIP9pKBQ65vCFMF", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2697, "completion_tokens": 86, "total_tokens": 2783, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a0a1c8190a49e739dcd0b4074", "custom_id": "43-8", "response": {"status_code": 200, "request_id": "1336876a9600b16f69ddedad8aa264cc", "body": {"id": "chatcmpl-BwxFMQyziSX8KvshjoXcAYFUnnDrF", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2697, "completion_tokens": 86, "total_tokens": 2783, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a39448190b257304507522611", "custom_id": "43-9", "response": {"status_code": 200, "request_id": "a35637ff2543bcb456028e9d06f915f4", "body": {"id": "chatcmpl-BwxFNj4N1uS1iyA2fu3X3oH3MGtw4", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2697, "completion_tokens": 86, "total_tokens": 2783, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a411881908e887c77da6dcef5", "custom_id": "89-0", "response": {"status_code": 200, "request_id": "3815b724c1500d4a378445ad007aa195", "body": {"id": "chatcmpl-BwxFIMyfFU1j3RyCpXHYCTTjnW07D", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.7\n    )\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3342, "completion_tokens": 104, "total_tokens": 3446, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a3c2081909623368f6147fbe6", "custom_id": "89-1", "response": {"status_code": 200, "request_id": "a04bed8307cdf2aada456bcc007e301f", "body": {"id": "chatcmpl-BwxFMJas5n4CbCoGU9GJeE3LwyPU5", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve OIDs of objects with probability > 0.7 of being supernovae ('SN') in the stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Select all columns from dataquality for the identified objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3342, "completion_tokens": 117, "total_tokens": 3459, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a49d88190a68e04396126518a", "custom_id": "89-2", "response": {"status_code": 200, "request_id": "3f9f82f87630c75fa2562b9ca37878a5", "body": {"id": "chatcmpl-BwxFMp5DvxaJ5SAEhBLYlVPBeTgPp", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3387, "completion_tokens": 120, "total_tokens": 3507, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a59008190938a4935223a117e", "custom_id": "89-3", "response": {"status_code": 200, "request_id": "55db7c05f45da4e377dac9751b29b810", "body": {"id": "chatcmpl-BwxFFl4MWFamAYICMDgnEKcliNdoS", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3387, "completion_tokens": 119, "total_tokens": 3506, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a5aac8190a8230cdfb94bb47f", "custom_id": "89-4", "response": {"status_code": 200, "request_id": "1f1f955ad48fc012901103e14198d494", "body": {"id": "chatcmpl-BwxFNMVK6uSYZyBEwRil8gQScbp1C", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select OIDs of objects with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3387, "completion_tokens": 122, "total_tokens": 3509, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a7e9c8190ad35cc4068475533", "custom_id": "89-5", "response": {"status_code": 200, "request_id": "0629b8903a1acb7bae4389fb395089ea", "body": {"id": "chatcmpl-BwxFFTCaz7bLRFzrv0UolbRnVuOLY", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.7\n    )\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3342, "completion_tokens": 104, "total_tokens": 3446, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a718481909a9dc0a6fadeffee", "custom_id": "89-6", "response": {"status_code": 200, "request_id": "f8f608863fae1105544591dc997660fe", "body": {"id": "chatcmpl-BwxFFMdlufewxZDy3AaWn6mTVjzy1", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select OIDs of objects with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3387, "completion_tokens": 122, "total_tokens": 3509, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13a7fec8190905f3ab959c8ad73", "custom_id": "89-7", "response": {"status_code": 200, "request_id": "b1a4890716bf0620a6e58f103f4dfc50", "body": {"id": "chatcmpl-BwxFFTNvmS29BxZnxsIM9BabEuIXS", "object": "chat.completion", "created": 1753390461, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3387, "completion_tokens": 119, "total_tokens": 3506, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13aa9988190961b18ac52cac5e3", "custom_id": "89-8", "response": {"status_code": 200, "request_id": "518df680ed81e7e1fed65ab0251051a6", "body": {"id": "chatcmpl-BwxFHKPycydh671azgZQQzYzWdYp8", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3387, "completion_tokens": 119, "total_tokens": 3506, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13ac14c8190b67534ef61bc61b2", "custom_id": "89-9", "response": {"status_code": 200, "request_id": "c290b5e316832e8a3119f9e730f63c5a", "body": {"id": "chatcmpl-BwxFHPLxj5viP2VsPpXqJmTPrmi1m", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3387, "completion_tokens": 119, "total_tokens": 3506, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13ab7c08190ba2d68d74e6e201e", "custom_id": "72-0", "response": {"status_code": 200, "request_id": "77bbcfbf6a11ac9943af6d441b2bfab5", "body": {"id": "chatcmpl-BwxFJE18W7QeVVP9FaMge87EmkLFc", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13aca80819090d854c834b0a14f", "custom_id": "72-1", "response": {"status_code": 200, "request_id": "9d10820d487b0b120ee8da89b90994dc", "body": {"id": "chatcmpl-BwxFIYol0C9rO6mbXqfdr1H2wf9Yt", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13aca088190b3e16ba283f7cef0", "custom_id": "72-2", "response": {"status_code": 200, "request_id": "142fc3e4fdaaf2a8de80aac64e5f7c63", "body": {"id": "chatcmpl-BwxFKtuxxloH5roVN5laCc5uo6nIp", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13ad8048190a4708268ed267b30", "custom_id": "72-3", "response": {"status_code": 200, "request_id": "b44af86d8b7d381df4145ca164bcd2a9", "body": {"id": "chatcmpl-BwxFJdBpfyzOXWUcTqka1tS3d3KT9", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13ae1b4819092024e2dd90c730c", "custom_id": "72-4", "response": {"status_code": 200, "request_id": "1463567254200114e3125cf3d14eb461", "body": {"id": "chatcmpl-BwxFMEzy0MQp0TK7HnHKg2QwAb4aV", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13af238819083051f2c4598a1c3", "custom_id": "72-5", "response": {"status_code": 200, "request_id": "d87956c61c7b7608ed1e5e94b585ef42", "body": {"id": "chatcmpl-BwxFN4WUoqMBeF2VO0Lmv0pPqK8fn", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b07dc8190a3ff0f455aae6a50", "custom_id": "72-6", "response": {"status_code": 200, "request_id": "758408f1278d192cdf5c672791a23d34", "body": {"id": "chatcmpl-BwxFNqdzvj2ig8iNQuC9DEcIFmM2B", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13afac881908076a2d729150d4a", "custom_id": "72-7", "response": {"status_code": 200, "request_id": "ff14247c9c0795a01803f24bd14b3513", "body": {"id": "chatcmpl-BwxFN7TCedcqfVcj4mqM7h7WOqnez", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b25808190aefb453334e506da", "custom_id": "72-8", "response": {"status_code": 200, "request_id": "6f78ddcd147c1fa6d41ffce2cf926c06", "body": {"id": "chatcmpl-BwxFNpXZzBpjvPx6vh8KxJZLqQQu4", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b3b0881908b76c58ed0558612", "custom_id": "72-9", "response": {"status_code": 200, "request_id": "5b60657f4a5945a04f8fa9bbf8d2f15e", "body": {"id": "chatcmpl-BwxFMyQxpUa8w3wSOp1nMmtNfOF9C", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2234, "completion_tokens": 30, "total_tokens": 2264, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b524881908467aa8aed4e5b19", "custom_id": "103-0", "response": {"status_code": 200, "request_id": "ce84c5ac3eb9a957ad69260c4bda1ac6", "body": {"id": "chatcmpl-BwxFKZv47d2CcpWySVuSc3qj3GuqE", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n    ORDER BY p.distpsnr1\n)\nSELECT o.*, p.*, ps.*\nFROM filtered_objects o\nJOIN probabilities p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE ps.distpsnr1 = (\n    SELECT MIN(distpsnr1)\n    FROM ps1_ztf\n    WHERE oid = o.oid\n)\nORDER BY ps.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 253, "total_tokens": 3601, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b4c048190b2fe0b2fd8382614", "custom_id": "103-1", "response": {"status_code": 200, "request_id": "26bf889a8658b5695e365c2fd5422267", "body": {"id": "chatcmpl-BwxFPHROG6WCnRqjR8nY55bijh2Ka", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n        AND p.distpsnr1 > 5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM probability prob\n        WHERE prob.oid = o.oid\n        AND prob.class_name <> 'SNIa' -- Exclude supernova class\n        AND prob.class_name <> 'SNIbc'\n        AND prob.class_name <> 'SNII'\n        AND prob.class_name <> 'SLSN'\n        AND prob.classifier_name = 'lc_classifier'\n        AND prob.probability > 0.7\n        AND prob.ranking = 1\n    )\n)\nSELECT o.*, p.*, p1.*\nFROM selected_objects o\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p.class_name <> 'SNIa' AND p.class_name <> 'SNIbc' AND p.class_name <> 'SNII' AND p.class_name <> 'SLSN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.7\n  AND p.ranking = 1\nORDER BY p1.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 295, "total_tokens": 3643, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b4dd88190bc8d2851e44ae08c", "custom_id": "103-2", "response": {"status_code": 200, "request_id": "b2f86890db9025873fa3c894b8fd36b4", "body": {"id": "chatcmpl-BwxFOzXooySGBiMwC21ODfMBkcD8T", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM probability prob\n        WHERE prob.oid = o.oid\n          AND prob.class_name != 'SNIa' -- Exclude supernova class\n          AND prob.class_name != 'SNIbc'\n          AND prob.class_name != 'SNII'\n          AND prob.class_name != 'SLSN'\n          AND prob.classifier_name = 'lc_classifier'\n          AND prob.probability > 0.7\n    )\n)\nSELECT o.*, p.*, p1.*\nFROM selected_objects o\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p.class_name != 'SNIa' -- Exclude supernova class\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.7\n  AND p1.distpsnr1 > 5\nORDER BY p1.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 267, "total_tokens": 3615, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b5c708190b3386968c9e56930", "custom_id": "103-3", "response": {"status_code": 200, "request_id": "0768c331610f50fa3855a85df39c5993", "body": {"id": "chatcmpl-BwxFMuFan7mTYfGChJWSqYhfehPiF", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_objects AS (\n    SELECT o.*, p.*, ps.*\n    FROM object o\n    JOIN (\n        SELECT oid, distpsnr1\n        FROM ps1_ztf\n        WHERE distpsnr1 > 5\n    ) ps ON o.oid = ps.oid\n    JOIN (\n        SELECT oid, class_name, probability, ranking\n        FROM probability\n        WHERE classifier_name = 'lc_classifier' AND probability > 0.7 AND class_name <> 'SNIa'\n    ) p ON o.oid = p.oid\n)\nSELECT *\nFROM selected_objects\nORDER BY distpsnr1\nLIMIT 200;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 133, "total_tokens": 3481, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b6efc81908becd6bf917fe919", "custom_id": "103-4", "response": {"status_code": 200, "request_id": "76e9999089313ca4a1b0fb98708f7e99", "body": {"id": "chatcmpl-BwxFOrJeMn3yfCakxNejGKRYFmuk8", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n    ORDER BY p.distpsnr1\n)\nSELECT o.*, p.*, p1.*\nFROM filtered_objects o\nJOIN probabilities p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p1.distpsnr1 = (\n    SELECT MIN(distpsnr1)\n    FROM ps1_ztf p2\n    WHERE p2.oid = o.oid\n)\nORDER BY p1.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 263, "total_tokens": 3611, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13bd0788190a89debeda4598a0a", "custom_id": "103-5", "response": {"status_code": 200, "request_id": "f8a6fac1cce925c27d00dc29ca04f833", "body": {"id": "chatcmpl-BwxFGar5ED0UmIhiOSGp2SXzY7U0R", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n),\nranked_objects AS (\n    SELECT o.*, prob.*, np.distpsnr1\n    FROM filtered_objects o\n    JOIN probabilities prob ON prob.oid = o.oid\n    JOIN nearest_ps1 np ON np.oid = o.oid\n)\nSELECT *\nFROM ranked_objects\nORDER BY distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 228, "total_tokens": 3576, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b78e48190bbfb8c11fe1991c0", "custom_id": "103-6", "response": {"status_code": 200, "request_id": "a74e6ad79d65d1e737dfd809af2ee8f6", "body": {"id": "chatcmpl-BwxFGonjEAU4X7rcxgUQj3zYCQoYm", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n    ORDER BY p.distpsnr1\n)\nSELECT o.*, p.*, p1.*\nFROM filtered_objects o\nJOIN probabilities p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p1.distpsnr1 = (\n    SELECT MIN(distpsnr1)\n    FROM ps1_ztf p2\n    WHERE p2.oid = o.oid\n)\nORDER BY p1.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 263, "total_tokens": 3611, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13b815c819098d9bc03f6e068a8", "custom_id": "103-7", "response": {"status_code": 200, "request_id": "a3cf24db5ad594dd10a244f8bae0a799", "body": {"id": "chatcmpl-BwxFGjxQkU9Xet1QxMw19TSwNN3Gg", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM probability prob\n        WHERE prob.oid = o.oid\n          AND prob.class_name != 'SNIa' -- Exclude supernova class\n          AND prob.class_name != 'SNIbc'\n          AND prob.class_name != 'SNII'\n          AND prob.class_name != 'SLSN'\n          AND prob.classifier_name = 'lc_classifier'\n          AND prob.probability > 0.7\n          AND prob.ranking = 1\n    )\n)\nSELECT o.*, p.*, ps.*\nFROM selected_objects o\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p2\n      WHERE p2.oid = o.oid\n        AND p2.distpsnr1 > 5\n  )\nORDER BY ps.distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 295, "total_tokens": 3643, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13bc67081909b0922dee9c39244", "custom_id": "103-8", "response": {"status_code": 200, "request_id": "eeb34d329b491ae04f06d440cb15bdb8", "body": {"id": "chatcmpl-BwxFKk3IGuEOiizpnPHy8qjjrhpM4", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n),\nranked_objects AS (\n    SELECT o.*, prob.*, np.distpsnr1\n    FROM filtered_objects o\n    JOIN probabilities prob ON prob.oid = o.oid\n    JOIN nearest_ps1 np ON np.oid = o.oid\n)\nSELECT *\nFROM ranked_objects\nORDER BY distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 228, "total_tokens": 3576, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13bdc5081909fae5dcbc0051f5f", "custom_id": "103-9", "response": {"status_code": 200, "request_id": "1cb857988769f173a3d2487881b35f4e", "body": {"id": "chatcmpl-BwxFILWGgIBIaiPxRiIkbu3HCO85c", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n),\nranked_objects AS (\n    SELECT o.*, prob.*, np.distpsnr1\n    FROM filtered_objects o\n    JOIN probabilities prob ON prob.oid = o.oid\n    JOIN nearest_ps1 np ON np.oid = o.oid\n)\nSELECT *\nFROM ranked_objects\nORDER BY distpsnr1\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3348, "completion_tokens": 228, "total_tokens": 3576, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13bd37481909c00372a46b55467", "custom_id": "54-0", "response": {"status_code": 200, "request_id": "1f3675b0af1aff6459080cd183ea5447", "body": {"id": "chatcmpl-BwxFLQxY4INqPOU055naON9cDQWsx", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT * \nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 38, "total_tokens": 2063, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13bc9348190903882b23ac626b8", "custom_id": "54-1", "response": {"status_code": 200, "request_id": "1faf47d1bb75a4139b426ae7aea965c6", "body": {"id": "chatcmpl-BwxFLoO7JgDfUOq4ue8feRET3WHdY", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 64, "total_tokens": 2089, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13bf9488190a7fc91a594b1ccc3", "custom_id": "54-2", "response": {"status_code": 200, "request_id": "4c081d5ebc918eb3045f834f0f2d794a", "body": {"id": "chatcmpl-BwxFGpR5tH34L56lMasZ2l3BZZADf", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 59, "total_tokens": 2084, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13bdce481908bda8d1fddbeec17", "custom_id": "54-3", "response": {"status_code": 200, "request_id": "7f6b3619b15614d5ed802f416e26a4ad", "body": {"id": "chatcmpl-BwxFGdoX88gdBafcXsksbha0htvRj", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 59, "total_tokens": 2084, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13bf7b8819096e91f358a989773", "custom_id": "54-4", "response": {"status_code": 200, "request_id": "14fa75285d21fbbab2c86259dd616c04", "body": {"id": "chatcmpl-BwxFNy4pYPfrRIG3nXaC7JgEOmbFd", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 59, "total_tokens": 2084, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13e1ee08190abb0dd9aa9da089b", "custom_id": "54-5", "response": {"status_code": 200, "request_id": "232e0733f584265cb8a610d4856b14f2", "body": {"id": "chatcmpl-BwxFN90ei28cfLp0mnRzejZzEzpVk", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 54, "total_tokens": 2079, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13bfe6c81908c79c2039e3821d7", "custom_id": "54-6", "response": {"status_code": 200, "request_id": "0a45b8bee286ebe8508f58b6f19c498f", "body": {"id": "chatcmpl-BwxFNxicvolsZ9P4oCsuuUvVVhbf4", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 41, "total_tokens": 2066, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13c50788190ac9c810759c1d24d", "custom_id": "54-7", "response": {"status_code": 200, "request_id": "0ef18fa51f27fe8783117cdbf131695d", "body": {"id": "chatcmpl-BwxFOKL7LucfzROOKiMZjZVG86wNN", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT nd.*\nFROM (\n    SELECT * FROM non_detection\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n) nd\nWHERE nd.diffmaglim > 19.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 51, "total_tokens": 2076, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13c582c8190a1dc13b52fc37db6", "custom_id": "54-8", "response": {"status_code": 200, "request_id": "c23bf403d25b6a1ca153697d3056a4e7", "body": {"id": "chatcmpl-BwxFGSDYAjFXlEtPDV7TyGmjVFrdh", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 64, "total_tokens": 2089, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13c49f48190b9f4b46a449c16da", "custom_id": "54-9", "response": {"status_code": 200, "request_id": "d4ce178d76556eda7afe121cee77204b", "body": {"id": "chatcmpl-BwxFMyeDHtLkexFbaV9IVXzYvx3e6", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT * \nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2025, "completion_tokens": 38, "total_tokens": 2063, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13c66108190b510b2b911aea19c", "custom_id": "99-0", "response": {"status_code": 200, "request_id": "491442e5317dea7018902615caca8178", "body": {"id": "chatcmpl-BwxFPgyUV2ImhnOmoVbJbOhwjg1M8", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 170, "total_tokens": 3428, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13c5f1c8190b9912fa03a388b44", "custom_id": "99-1", "response": {"status_code": 200, "request_id": "f50816e9491ed5978ce6685fed539389", "body": {"id": "chatcmpl-BwxFJ5IU8h3dppFdhjZin3SnzILcU", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310\nWITH recent_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd > 60310\n    LIMIT 10\n)\n-- Select all columns from forced_photometry for objects that meet the criteria\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    -- Filter objects with probability=1 of being an asteroid in stamp_classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability = 1\n      AND p.oid IN (SELECT oid FROM recent_objects)\n)\nORDER BY (SELECT firstmjd FROM object WHERE object.oid = fp.oid) ASC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 178, "total_tokens": 3436, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13c565081909109ff08315bce71", "custom_id": "99-2", "response": {"status_code": 200, "request_id": "c001b5687a6819b34a141793d0a80f98", "body": {"id": "chatcmpl-BwxFNYM6jv3aI3i7zvXpIx6p4coFj", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with first detection after MJD 60310 and classified as asteroid with probability 1 in stamp_classifier\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n        LIMIT 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from forced_photometry for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 169, "total_tokens": 3427, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13c751481909fc1481258227470", "custom_id": "99-3", "response": {"status_code": 200, "request_id": "0c00ac0cd9de968f73e13e37761ec485", "body": {"id": "chatcmpl-BwxFLp5x2g02blc38mUaJ51dnOgR3", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 170, "total_tokens": 3428, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13c7e8c8190abe304bf34fd5ff6", "custom_id": "99-4", "response": {"status_code": 200, "request_id": "d01f86c76b61d717f145ac5a24660bea", "body": {"id": "chatcmpl-BwxFLQ62CwsHMgY6g4GCSRIRMU60Z", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 170, "total_tokens": 3428, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13c8ba0819091765954d1c72d11", "custom_id": "99-5", "response": {"status_code": 200, "request_id": "28dd41158885b7f06daa52462ae27c68", "body": {"id": "chatcmpl-BwxFKt9BZb2XgpGgBvTFxf6Af6Z4A", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 170, "total_tokens": 3428, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13cc770819084de51cd535dd663", "custom_id": "99-6", "response": {"status_code": 200, "request_id": "72ae965aa06a3f06ec3cb8da760f7cb0", "body": {"id": "chatcmpl-BwxFMb0RDodeKmGHPr9vyzayOn6D9", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with first detection after MJD 60310\nWITH recent_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd > 60310\n    LIMIT 10\n)\n-- Filter objects that have a probability of 1 for being an asteroid in the stamp_classifier\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT oid\n    FROM recent_objects\n) AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = fp.oid\n      AND p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability = 1\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 148, "total_tokens": 3406, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13cd61c8190a252e0812796028f", "custom_id": "99-7", "response": {"status_code": 200, "request_id": "92d2c0cff3872fdb82e69e707f358642", "body": {"id": "chatcmpl-BwxFQFnYg0qKAVT8C4JYqJEwS1FDz", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with first detection after MJD 60310 and classified as asteroid with probability 1 in stamp_classifier\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n          AND p.ranking = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from forced_photometry for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 173, "total_tokens": 3431, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13cdd248190b7cdcaa6fb2a0770", "custom_id": "99-8", "response": {"status_code": 200, "request_id": "7a7bcbe9539692cb456da68bda08bd79", "body": {"id": "chatcmpl-BwxFLgzCosH0wppo6sdoJHKK0YQAG", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 170, "total_tokens": 3428, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13cdc9c81909166aa850a3e9c47", "custom_id": "99-9", "response": {"status_code": 200, "request_id": "c49332ee1462234f76eaa16c811cb97a", "body": {"id": "chatcmpl-BwxFMUP1Vky33pJcqeLpufuVIyfub", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3258, "completion_tokens": 170, "total_tokens": 3428, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13cd6d081908efccca4d8b9506a", "custom_id": "40-0", "response": {"status_code": 200, "request_id": "837ff8cafa28ebf8bfd6f4cae07be41d", "body": {"id": "chatcmpl-BwxFON6AmmFEg1jAUvubG7XsCL62d", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 143, "total_tokens": 2753, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13cdfa881908373252de918af32", "custom_id": "40-1", "response": {"status_code": 200, "request_id": "a13f432d8235b87a05160f4065f34f38", "body": {"id": "chatcmpl-BwxFPg6KMdne21LhwCEe69i5EFH2L", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT \n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM allwise a\nJOIN catalog c ON q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600.0);", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 125, "total_tokens": 2735, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13ced808190821ddef1e311afe8", "custom_id": "40-2", "response": {"status_code": 200, "request_id": "c938f62083bceb1cf2e92fc0712aa985", "body": {"id": "chatcmpl-BwxFGl1Nhsvd04RVQA4hMVco2ZgwI", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 143, "total_tokens": 2753, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13d1bb08190b4fbe8dd414ad49b", "custom_id": "40-3", "response": {"status_code": 200, "request_id": "4d5ded1ac66378e031f12729184bea57", "body": {"id": "chatcmpl-BwxFIcLIHQxifzPzFYHhTB188e7qG", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 143, "total_tokens": 2753, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13d43488190987b2431de905823", "custom_id": "40-4", "response": {"status_code": 200, "request_id": "1c91cf7b54cfde9b465c5183af8db135", "body": {"id": "chatcmpl-BwxFGUdXRzB7aqMjtFHNs5OVdRL6U", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 143, "total_tokens": 2753, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a151f1388190ae2d655375c5af06", "custom_id": "40-5", "response": {"status_code": 200, "request_id": "f710a093e6f340f2216c4b256c7ccbd3", "body": {"id": "chatcmpl-BwxFG23vSNRjbss7IUwjF9PFTc48T", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 143, "total_tokens": 2753, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13d60a881908f53be6944f73d17", "custom_id": "40-6", "response": {"status_code": 200, "request_id": "4588b50d7e3f2bb2a642b7052a5e9690", "body": {"id": "chatcmpl-BwxFGlyqYI5altDtzkZmqgAr5ipml", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 143, "total_tokens": 2753, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13d5430819080feb284f8d0c3b5", "custom_id": "40-7", "response": {"status_code": 200, "request_id": "05bf20417824133c658c749a57a23a48", "body": {"id": "chatcmpl-BwxFG4U2RXMhZf1C6jsPswVhPnbfe", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 143, "total_tokens": 2753, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13d56fc81908e96df3df4437e8f", "custom_id": "40-8", "response": {"status_code": 200, "request_id": "42aadd0b5e95bd3749ee64ceecbc50cb", "body": {"id": "chatcmpl-BwxFG4MPzuaD5o54D6iQffESzqnpG", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 143, "total_tokens": 2753, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13d63fc8190bb9ad8a9a8d5a17b", "custom_id": "40-9", "response": {"status_code": 200, "request_id": "53caf0308d70a43aa728374e16fe9a5c", "body": {"id": "chatcmpl-BwxFGYV4h9Q9ZPQbozzceDA1q6Vx1", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2610, "completion_tokens": 143, "total_tokens": 2753, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13d5a44819084e1208406b5b3a5", "custom_id": "80-0", "response": {"status_code": 200, "request_id": "9725f699489a9f9e94773e1194d2bbf1", "body": {"id": "chatcmpl-BwxFI6cpsn9fEi0WVfF40375vVN7y", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 40, "total_tokens": 2052, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13d661881908f462597dd7d0de5", "custom_id": "80-1", "response": {"status_code": 200, "request_id": "837c43a1388898498f697b9c3d329cbe", "body": {"id": "chatcmpl-BwxFJyb1Mx0VYK68EPs9WQ6oKKo9N", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 40, "total_tokens": 2052, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13db82c8190b4b05f7faeaed081", "custom_id": "80-2", "response": {"status_code": 200, "request_id": "8e892b744510f059d8e1d9b989ae3224", "body": {"id": "chatcmpl-BwxFKDJEQeWSxNd6x9HimtnrFOhRC", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 40, "total_tokens": 2052, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13dba288190a803b6cf1e4e1380", "custom_id": "80-3", "response": {"status_code": 200, "request_id": "b6eaa6fb3b06d2a9333ae7414ce4a556", "body": {"id": "chatcmpl-BwxFLwyeMJdTv8q4NhRg4cIopbMPo", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 40, "total_tokens": 2052, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13dce1c819085e6402d37457b64", "custom_id": "80-4", "response": {"status_code": 200, "request_id": "130bacbf046e8912c1b1822024b71386", "body": {"id": "chatcmpl-BwxFMRVtVQCCKXJH60sqNfab5jA2V", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 40, "total_tokens": 2052, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a141c1d881908ed0179773ff1900", "custom_id": "80-5", "response": {"status_code": 200, "request_id": "806392bf7b3410b9d4a3cac3e376e2f9", "body": {"id": "chatcmpl-BwxFNljOqLDfKdslhLfJ2yXFbG5XE", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 40, "total_tokens": 2052, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13debd88190a6f3f0d3babf27b4", "custom_id": "80-6", "response": {"status_code": 200, "request_id": "308cfd9b158fd0bfce48665c8128ad00", "body": {"id": "chatcmpl-BwxFO2YrNsnghfZcvJzOlLR1FvtzT", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from xmatch where the object matches are within 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 60, "total_tokens": 2072, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a151842c8190987e1bded27d192f", "custom_id": "80-7", "response": {"status_code": 200, "request_id": "1ffd21e87c03620f2997a02148bf7f39", "body": {"id": "chatcmpl-BwxFLuqIkXYYycU6hy4yBRmYtvGR8", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 40, "total_tokens": 2052, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13de0c08190ac122d09b8336f19", "custom_id": "80-8", "response": {"status_code": 200, "request_id": "c1e0ad44db0cdcb5f0dd73cda88f4d70", "body": {"id": "chatcmpl-BwxFPYXPupXmR55cNGR8fomTEt0D5", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from xmatch where the object matches either of the specified ZTF IDs\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 59, "total_tokens": 2071, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13def2c8190bbd350e8b26d68c2", "custom_id": "80-9", "response": {"status_code": 200, "request_id": "cef65a740d5456a8689d0ad978286f5e", "body": {"id": "chatcmpl-BwxFHd3CZ4uuousWPvWlM2XjlIJHb", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2012, "completion_tokens": 40, "total_tokens": 2052, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13e675481908d1aaaf81059bf0a", "custom_id": "45-0", "response": {"status_code": 200, "request_id": "55815fb097330944bd8344cc8fa66093", "body": {"id": "chatcmpl-BwxFHNTkshc5Pg7N2SClTwgXTYmHK", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the count of dataquality rows for specified objects with min chipsf (reduced chi-square) >= 5\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3161, "completion_tokens": 65, "total_tokens": 3226, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13e32248190ae4f92488467fe9d", "custom_id": "45-1", "response": {"status_code": 200, "request_id": "6c192a7901ab3724bbc46cbec562e3ec", "body": {"id": "chatcmpl-BwxFH3tnpO7hc4JM08ToaVC0nb3AJ", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE candid IN (\n    SELECT candid \n    FROM dataquality \n    WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n) \nAND chipsf = (\n    SELECT MIN(chipsf) \n    FROM dataquality dq2 \n    WHERE dq2.candid = dataquality.candid\n) \nAND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3161, "completion_tokens": 88, "total_tokens": 3249, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13e53b08190819bb00204acb6ac", "custom_id": "45-2", "response": {"status_code": 200, "request_id": "53befa0603cd6ac51f9e42047197f2e0", "body": {"id": "chatcmpl-BwxFHvWlOqaWestSaWuTJd7e34HxJ", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2679, "completion_tokens": 40, "total_tokens": 2719, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13e58248190a5cab1f75708404e", "custom_id": "45-3", "response": {"status_code": 200, "request_id": "3fad2059cbcdb9ec9475fc956c0a510e", "body": {"id": "chatcmpl-BwxFG5PqPlSuaXBqPH4FHxkP2MJxF", "object": "chat.completion", "created": 1753390462, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the count of rows in dataquality where the oid matches either of the specified ZTF identifiers\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2679, "completion_tokens": 61, "total_tokens": 2740, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13e70e0819089ae041388e11c8d", "custom_id": "45-4", "response": {"status_code": 200, "request_id": "3302036e7dd2a053a082104eaa1dcc96", "body": {"id": "chatcmpl-BwxFSpA7HhFpjOAgLj7F8gtDoZcyF", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2679, "completion_tokens": 40, "total_tokens": 2719, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13e68a48190b2a145fb5ab1dd95", "custom_id": "45-5", "response": {"status_code": 200, "request_id": "0a22c876ce8b94a829e14fa714069e1f", "body": {"id": "chatcmpl-BwxFQGarDPSxqO0xUNB8sbSBOY7LS", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2679, "completion_tokens": 40, "total_tokens": 2719, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13e9900819085c83c1073799fa3", "custom_id": "45-6", "response": {"status_code": 200, "request_id": "dc7ad67b80b663245ad9dc3c3c5f91ae", "body": {"id": "chatcmpl-BwxFTagRiEKdkQOttwDkJjPdYPlR6", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2679, "completion_tokens": 40, "total_tokens": 2719, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a140238081908df312ab9dddaafd", "custom_id": "45-7", "response": {"status_code": 200, "request_id": "4afe2a50bb94bbef412b73a938a20a5a", "body": {"id": "chatcmpl-BwxFH7KP6UOMqRU1WguMCX6GqXTNH", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2679, "completion_tokens": 40, "total_tokens": 2719, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13edeac8190b60d620a4623a9f5", "custom_id": "45-8", "response": {"status_code": 200, "request_id": "e93b9cbe3b671f71c543439c6226503f", "body": {"id": "chatcmpl-BwxFUrFRj1U6qN0eFcJHch8by0H8n", "object": "chat.completion", "created": 1753390476, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2679, "completion_tokens": 40, "total_tokens": 2719, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13ed5d08190b30d335d12e2e94a", "custom_id": "45-9", "response": {"status_code": 200, "request_id": "8159f6a7e95c1fa52953ffecf0f7247f", "body": {"id": "chatcmpl-BwxFHkdhVkUtzBUXcniebsgb1fzif", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2679, "completion_tokens": 40, "total_tokens": 2719, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13ee2d4819097a876e3002397c6", "custom_id": "63-0", "response": {"status_code": 200, "request_id": "7317d4e902e8905fdd9520f424ed4efc", "body": {"id": "chatcmpl-BwxFJ2dQNskO4Q37d1dqKnGRzuSnF", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION ALL\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability and light curve classifier tables where ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 129, "total_tokens": 2207, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13ee1e88190b04b277072c692f2", "custom_id": "63-1", "response": {"status_code": 200, "request_id": "c5a9cfa1f0da3aee27e94624b015a115", "body": {"id": "chatcmpl-BwxFJ6DbzOYUeHmzCKHfOHJcSWXGW", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve object OIDs for specified ZTF identifiers\nWITH selected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF21aaobkmg',\n        'ZTF21aaomuka'\n    )\n)\n-- Select all relevant probability and classifier data for objects with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 110, "total_tokens": 2188, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13eee088190b5ca1b5d075d450f", "custom_id": "63-2", "response": {"status_code": 200, "request_id": "c2d2f3633286b36031e32ed016baed93", "body": {"id": "chatcmpl-BwxFHRK3PP8cBdeAK1N49pGrft2Hv", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 128, "total_tokens": 2206, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13f142881908a7dce4d63cffad8", "custom_id": "63-3", "response": {"status_code": 200, "request_id": "e35e89ecba504eebae3ac772ad39b947", "body": {"id": "chatcmpl-BwxFKvp5tC9VXG3kHBIGw5nFjYJaC", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION ALL\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nUNION ALL\n-- Select from light curve classifier probabilities with same conditions\nSELECT lc.*\nFROM probability lc\nWHERE lc.oid IN (SELECT oid FROM target_oids)\n  AND lc.ranking IN (1, 2)\nORDER BY ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 174, "total_tokens": 2252, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13f4e488190ab237ccaad021e42", "custom_id": "63-4", "response": {"status_code": 200, "request_id": "126844c745ef371e7f2a72228cac6b5b", "body": {"id": "chatcmpl-BwxFHWcKF6D4BEGaqezgfACbY1ztf", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 128, "total_tokens": 2206, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13f5eec819085000c333c4995df", "custom_id": "63-5", "response": {"status_code": 200, "request_id": "814ebeae89c42acb6849c1291fbe4f75", "body": {"id": "chatcmpl-BwxFHhH1YUbZG2Te1KBlSY4aOChBg", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve OIDs for the specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\n-- Select all relevant probability and classifier data with ranking 1 or 2 for these OIDs\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 109, "total_tokens": 2187, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13f607081909a0457ef71a417c5", "custom_id": "63-6", "response": {"status_code": 200, "request_id": "40c320cba62d55cce1c1518184499e20", "body": {"id": "chatcmpl-BwxFLmBqTg2JX4INU7eGtMvbDuTkd", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all probability and light curve classifier rows with ranking 1 or 2 for specified objects\nSELECT *\nFROM (\n    -- Subquery to get OIDs for the specified ZTF identifiers\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n) AS obj_ids\nJOIN probability p ON p.oid = obj_ids.oid\nWHERE p.ranking IN (1, 2)\nORDER BY p.ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 112, "total_tokens": 2190, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13f5c908190b8e72888e15e9e43", "custom_id": "63-7", "response": {"status_code": 200, "request_id": "24effbf942e639d4aefbb5ca0a940eb1", "body": {"id": "chatcmpl-BwxFHsbHjcyWwzdSPR7hLPaf7pmyf", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability and light curve classifier tables where ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 128, "total_tokens": 2206, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13f6a5481908fc1671f716874b7", "custom_id": "63-8", "response": {"status_code": 200, "request_id": "e07da9606b193f18e17f5a8817f07e6f", "body": {"id": "chatcmpl-BwxFH5LAJ2d0ZAuBd1e6KRv0Z1wWV", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION ALL\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nUNION ALL\n-- Select from light curve classifier probabilities with same conditions\nSELECT lc.*\nFROM probability lc\nWHERE lc.oid IN (SELECT oid FROM target_oids)\n  AND lc.ranking IN (1, 2)\nORDER BY ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 174, "total_tokens": 2252, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13fae7c8190bc0a45315041ea78", "custom_id": "63-9", "response": {"status_code": 200, "request_id": "7a0160129fb9ab435f8a519d7f440bf8", "body": {"id": "chatcmpl-BwxFMzQdnSSGRui9gQgI7qcQ8EQJ6", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2078, "completion_tokens": 128, "total_tokens": 2206, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13fcfe48190a928f36b68468f53", "custom_id": "73-0", "response": {"status_code": 200, "request_id": "7279089c89dc1173371a728a2ba408ff", "body": {"id": "chatcmpl-BwxFJFzXvbmdZKPR7cqzZvGPQkrc5", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH nearest_ss AS (\n    SELECT \n        o.oid,\n        s.ssnamenr,\n        s.ssmagnr\n    FROM \n        object o\n    LEFT JOIN \n        ss_ztf s ON o.oid = s.oid\n    WHERE \n        o.oid = 'ZTF21acitntz'\n    ORDER BY \n        s.ssdistnr ASC\n    LIMIT 1\n)\nSELECT \n    o.oid,\n    s.ssnamenr,\n    s.ssmagnr\nFROM \n    object o\nLEFT JOIN \n    ss_ztf s ON o.oid = s.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2524, "completion_tokens": 151, "total_tokens": 2675, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13fd1dc8190b6845c8c19cc191d", "custom_id": "73-1", "response": {"status_code": 200, "request_id": "2479750b4141e126e7a50e263bfc522a", "body": {"id": "chatcmpl-BwxFIYPlF069ZiCQrdyILMB3NCUSs", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  sss.ssnamenr AS mpc_name,\n  sss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf sss ON o.oid = sss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2890, "completion_tokens": 82, "total_tokens": 2972, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13fd6a0819083bf0487c862161b", "custom_id": "73-2", "response": {"status_code": 200, "request_id": "39471b1da1c88621d5bb3708e39e3ebc", "body": {"id": "chatcmpl-BwxFPKKv1aNXWlOU6VSFvTe8mXSt2", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  ss.ssnamenr AS mpc_name,\n  ss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf ss ON o.oid = ss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2890, "completion_tokens": 77, "total_tokens": 2967, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13fd8ec8190b8fbe85bf6616f1d", "custom_id": "73-3", "response": {"status_code": 200, "request_id": "60c5b617f66a635ae0f8163752e061c4", "body": {"id": "chatcmpl-BwxFPVStmD5vLS9QLEJKRo4k82tSo", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH nearest_ss AS (\n    SELECT \n        o.oid,\n        sss.ssname,\n        sss.ssmagnr\n    FROM \n        object o\n    LEFT JOIN \n        ss_ztf sss ON o.oid = sss.oid\n    WHERE \n        o.oid = 'ZTF21acitntz'\n    ORDER BY \n        sss.ssdistnr ASC\n    LIMIT 1\n)\nSELECT \n    o.oid,\n    sss.ssname,\n    sss.ssmagnr\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2524, "completion_tokens": 156, "total_tokens": 2680, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a13fe61c8190b18bc9bf68701b6d", "custom_id": "73-4", "response": {"status_code": 200, "request_id": "55270ac8f6e6a9fdd9a012b3ce4b7adc", "body": {"id": "chatcmpl-BwxFKursHo9zLUuqZFlDInOAk1M8n", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  ss.ssnamenr AS mpc_name,\n  ss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf ss ON o.oid = ss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2890, "completion_tokens": 77, "total_tokens": 2967, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14024308190811846ed385af500", "custom_id": "73-5", "response": {"status_code": 200, "request_id": "d8ce11cc3afd5566ade4161f6f86277d", "body": {"id": "chatcmpl-BwxFJFCYl2xk4lNpp2gfCx6nrUJcr", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  sss.ssnamenr AS mpc_name,\n  sss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf sss ON o.oid = sss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2890, "completion_tokens": 82, "total_tokens": 2972, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1404c5c8190a162eccba7bdc777", "custom_id": "73-6", "response": {"status_code": 200, "request_id": "ba93d8d67f320fa43ecf28de21f5aeca", "body": {"id": "chatcmpl-BwxFPvgA6Nylk3IPYZwFPSyfSSfk2", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH nearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n    WHERE o.oid = 'ZTF21acitntz'\n    ORDER BY s.ssdistnr ASC\n    LIMIT 1\n)\nSELECT o.oid, s.ssnamenr AS mpc_name, s.ssmagnr AS mpc_magnitude\nFROM object o\nLEFT JOIN ss_ztf s ON o.oid = s.oid\nWHERE o.oid = 'ZTF21acitntz'\nAND s.oid = (SELECT oid FROM nearest_ss);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2524, "completion_tokens": 150, "total_tokens": 2674, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14058e881908f9eb531722789a5", "custom_id": "73-7", "response": {"status_code": 200, "request_id": "03a1a7097cc2b2d9182b2d460c692b97", "body": {"id": "chatcmpl-BwxFKQq9iHmTEVi4DPaaH7o6Y2JRV", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude for the nearest known Solar System object to 'ZTF21acitntz'\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nJOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz'\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2637, "completion_tokens": 104, "total_tokens": 2741, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1404f7c819081d7dcec9c91d416", "custom_id": "73-8", "response": {"status_code": 200, "request_id": "6fa1fce9a1d1a10c7a59d950f12f1f89", "body": {"id": "chatcmpl-BwxFKnTURSSN3MFBegEpGvtJ8EAyo", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude of the nearest known Solar System object for the specified ZTF object\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2637, "completion_tokens": 103, "total_tokens": 2740, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1405608819094322598d6397700", "custom_id": "73-9", "response": {"status_code": 200, "request_id": "0db152663a544a0a482d5199278b9fb9", "body": {"id": "chatcmpl-BwxFLrKsNvArBi4qe1AwNoxXtQM77", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the object identifier, MPC name, and MPC magnitude for the nearest known Solar System object to the specified ZTF object\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2890, "completion_tokens": 103, "total_tokens": 2993, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1406bd48190aaf5601bc166853b", "custom_id": "92-0", "response": {"status_code": 200, "request_id": "3d2201a08a8e5c6f1e348db34df761b5", "body": {"id": "chatcmpl-BwxFNykhXVqNAfVCZyWrMYcN6y2gQ", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with at least 10 detections in the g band and no dubious corrections\nWITH g_band_detections AS (\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\nfiltered_objects AS (\n    SELECT o.oid\n    FROM g_band_detections o\n    WHERE NOT EXISTS (\n        SELECT 1\n        FROM detection d2\n        WHERE d2.oid = o.oid\n          AND d2.fid = 1 -- g band\n          AND d2.dubious = TRUE\n    )\n)\n-- Retrieve probabilities with ranking=1 for the light curve classifier\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM filtered_objects fo\nJOIN object o ON fo.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nORDER BY o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5553, "completion_tokens": 258, "total_tokens": 5811, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a140a924819091dd62c78ef6763d", "custom_id": "92-1", "response": {"status_code": 200, "request_id": "4b325497c50e2c09363a3734c8909936", "body": {"id": "chatcmpl-BwxFOdRf3BbSpOo9AEZEl0mGabcOK", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH g_band_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n      AND o.corrected = TRUE\n      AND o.dubious = FALSE\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM g_band_objects)\n)\nSELECT o.oid AS \"ZTF identifier\",\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probabilities p\nJOIN object o ON p.oid = o.oid\nORDER BY o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3122, "completion_tokens": 206, "total_tokens": 3328, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a140a4308190b2ae19549d2b9ca2", "custom_id": "92-2", "response": {"status_code": 200, "request_id": "478f3ee4487aabe66f85028c2c29214a", "body": {"id": "chatcmpl-BwxFMtp0f6rdYyYD7P5p8gPowoeig", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10\n),\nclassified_objects AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.oid IN (SELECT oid FROM g_band_objects)\n)\nSELECT\n    o.oid AS ztf_identifier,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    object o\nJOIN\n    classified_objects c ON o.oid = c.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5632, "completion_tokens": 212, "total_tokens": 5844, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a140ca188190bcacfaee0e4328e5", "custom_id": "92-3", "response": {"status_code": 200, "request_id": "ab16fe7d2418cb64e9e7fb860a84201c", "body": {"id": "chatcmpl-BwxFPzjR7DDncQRGYjC0hfvYAogrC", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE\n        AND d.dubious = FALSE\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5632, "completion_tokens": 244, "total_tokens": 5876, "prompt_tokens_details": {"cached_tokens": 5120, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a140cda081909a84578fa35eae8d", "custom_id": "92-4", "response": {"status_code": 200, "request_id": "89c09fe4ac2ac37eef942318ddf72531", "body": {"id": "chatcmpl-BwxFQPgDRyCFZGPHKvwm5Gtm3vVOj", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS g_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10\n),\nclassified_objects AS (\n    SELECT\n        p.oid,\n        p.classifier_name,\n        p.classifier_version,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS ztf_id,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    g_band_objects o\nJOIN\n    classified_objects c ON o.oid = c.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 211, "total_tokens": 3411, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a140d2608190a43d6257c95b9742", "custom_id": "92-5", "response": {"status_code": 200, "request_id": "ea2fda578ea81f5558b7bfa526ee7832", "body": {"id": "chatcmpl-BwxFOmjmgWJi1F9AGlBtKKrxS0V5p", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter detections in g band (fid=1)\n        EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n              AND d.dubious = FALSE\n        )\n        -- Count detections in g band with no dubious flag\n        AND (\n            SELECT COUNT(*) FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n              AND d.dubious = FALSE\n        ) >= 10\n),\nprobabilities_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    g.oid AS \"ZTF Identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects g\nJOIN\n    probabilities_rank1 p ON g.oid = p.oid\nORDER BY\n    g.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 286, "total_tokens": 3486, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a140d3b88190a4dcb79eefbd5483", "custom_id": "92-6", "response": {"status_code": 200, "request_id": "7f49bf3971f76ef6562e45cbf7143fbd", "body": {"id": "chatcmpl-BwxFHoeFznkgJQFsfvgG3M1B4MlpZ", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.classifier_version,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter objects with at least 10 detections in g band\n        o.ndet >= 10\n        AND NOT o.dubious\n        AND EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1 -- g band filter\n              AND d.corrected = FALSE\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.classifier_name = 'lc_classifier'\n              AND p.ranking = 1\n        )\n)\nSELECT\n    g.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects g\nJOIN\n    probability p ON p.oid = g.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\nORDER BY\n    g.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 253, "total_tokens": 3453, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a140ecc48190afb1709d16d5e1bf", "custom_id": "92-7", "response": {"status_code": 200, "request_id": "485b2afea75fbc4f1d639cab9ad06803", "body": {"id": "chatcmpl-BwxFRrNyjN6suWE5opeU3o7KPdvB7", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) FILTER (WHERE d.fid = 1) AS g_detections\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(*) FILTER (WHERE d.fid = 1) >= 10\n),\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.step_id_corr,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM object o\n    JOIN g_band_objects g ON o.oid = g.oid\n    LEFT JOIN probability p ON o.oid = p.oid\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n    WHERE o.corrected IS FALSE OR o.corrected IS NULL\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.step_id_corr AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability\nFROM filtered_objects o\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier' AND p.ranking = 1\nORDER BY o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5632, "completion_tokens": 263, "total_tokens": 5895, "prompt_tokens_details": {"cached_tokens": 5504, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1412c488190a7a7e50cfc84e14f", "custom_id": "92-8", "response": {"status_code": 200, "request_id": "9df172f98bf8ca10ad9011fa11c88680", "body": {"id": "chatcmpl-BwxFSUhRdJwPqyRwsXWRXuc19zqRp", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.classifier_version,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter objects with at least 10 detections in g band\n        (SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid AND d.fid = 1) >= 10\n        AND\n        -- Exclude objects with dubious corrections in g band\n        NOT EXISTS (\n            SELECT 1 FROM detection d\n            WHERE d.oid = o.oid AND d.fid = 1 AND d.dubious = TRUE\n        )\n    -- Join with probability table to get probabilities with ranking=1 for lc_classifier\n    JOIN\n        probability p ON p.oid = o.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    classifier_version,\n    class_name,\n    probability\nFROM\n    g_band_objects\nORDER BY\n    oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 234, "total_tokens": 3434, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14123548190bab0468b7bfd477e", "custom_id": "92-9", "response": {"status_code": 200, "request_id": "68b3a1ba2969921b4b4858c6b1861e84", "body": {"id": "chatcmpl-BwxFJs2MrasRY5AyKMXPJmBiRljfA", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE -- no dubious corrections\n        AND d.dubious = FALSE -- exclude dubious detections\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_name,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5632, "completion_tokens": 258, "total_tokens": 5890, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14142a081909abef36029670d75", "custom_id": "102-0", "response": {"status_code": 200, "request_id": "dcb9efc16e6ba463136344e89a541dd4", "body": {"id": "chatcmpl-BwxFLzztfbdW42k0L3GmgXEjDQAuD", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nJOIN agn_objects ao ON ms.oid = ao.oid\nWHERE ms.fid = 2 -- WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3282, "completion_tokens": 182, "total_tokens": 3464, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1414b748190b1361dab4f81c1e0", "custom_id": "102-1", "response": {"status_code": 200, "request_id": "4f424b7382985c0df88023e5010cea6c", "body": {"id": "chatcmpl-BwxFLqRxtoqF91O0YliwkEcbwpEjx", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM agn_objects);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3282, "completion_tokens": 145, "total_tokens": 3427, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14150b08190b4275bf86d50751f", "custom_id": "102-2", "response": {"status_code": 200, "request_id": "af642a0698e0f1bf3b10c69d6e23ebc1", "body": {"id": "chatcmpl-BwxFHQ31MprENuyjl0d0fOyuCTRQY", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3395, "completion_tokens": 158, "total_tokens": 3553, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a141521c8190b81b060f22394e59", "custom_id": "102-3", "response": {"status_code": 200, "request_id": "70ad23aab03cc41466ac3cf316c9ef8e", "body": {"id": "chatcmpl-BwxFObSrWXsQ8GJc9sU5DQDl6SPre", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3395, "completion_tokens": 158, "total_tokens": 3553, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a141700881909413bd1928a91fea", "custom_id": "102-4", "response": {"status_code": 200, "request_id": "c4afeb397f65e3af4675c9fcd8bddfc5", "body": {"id": "chatcmpl-BwxFHctc1DqzbiNd9GIBTfNnd3quh", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3395, "completion_tokens": 158, "total_tokens": 3553, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1419d808190844d900c354ca394", "custom_id": "102-5", "response": {"status_code": 200, "request_id": "eb6b8622404b00309a8a9fbe47c0d8a6", "body": {"id": "chatcmpl-BwxFHEedenR5GiKzf4YFBk190cer4", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2913, "completion_tokens": 160, "total_tokens": 3073, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a141b1ac81909adc76af9d64a25b", "custom_id": "102-6", "response": {"status_code": 200, "request_id": "667e587989c919697548f81515a865cd", "body": {"id": "chatcmpl-BwxFJmyMwtFlWZZzrcypRPb6C27ge", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3395, "completion_tokens": 158, "total_tokens": 3553, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a141c3508190be984c9b203b33c4", "custom_id": "102-7", "response": {"status_code": 200, "request_id": "eb9a636d34cdf0d4fbb5d5d600f0eb44", "body": {"id": "chatcmpl-BwxFQyd9U9eIYSrpHVMlTwTbNSUCk", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1 -- most probable class\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM agn_objects)\n  AND m.fid = 2 -- WISE W1 band\n  AND m.magmean BETWEEN 12 AND 13\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3395, "completion_tokens": 161, "total_tokens": 3556, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a141c8908190903c5c8cb551c1ac", "custom_id": "102-8", "response": {"status_code": 200, "request_id": "52d7a9dc559dffc35e883486c677f410", "body": {"id": "chatcmpl-BwxFJ6TsFRp2ZaSuKPsu8af4WxXqZ", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_candidates AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects, filtering by WISE W1 magnitude\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM agn_candidates)\n  AND m.magmean_corr BETWEEN 12 AND 13;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2913, "completion_tokens": 135, "total_tokens": 3048, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a141c9c48190947720d20aaef011", "custom_id": "102-9", "response": {"status_code": 200, "request_id": "2088ade910f92e284c77b3b2305f9296", "body": {"id": "chatcmpl-BwxFRfX1Pm6va1d5v5TPXky6Wyl1h", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2913, "completion_tokens": 160, "total_tokens": 3073, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a141dbf0819093e2ee949619a6fc", "custom_id": "81-0", "response": {"status_code": 200, "request_id": "c335af082ddef0fa8065e93fc3e46430", "body": {"id": "chatcmpl-BwxFHUBRLK8uDYSIAEmzXTnFttraQ", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch xm\n    WHERE \n        xm.oid = o.oid\n        AND xm.catid = 'ALLWISE'\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 87, "total_tokens": 2088, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a142080481909c9d0ae9b12459bf", "custom_id": "81-1", "response": {"status_code": 200, "request_id": "33d2b2871e2cd0ffe613843f5030a861", "body": {"id": "chatcmpl-BwxFL0lqipSwD2qYTlu5MCHiIJNoj", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 88, "total_tokens": 2089, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1421a5881908f3ff3d6706fa6cd", "custom_id": "81-2", "response": {"status_code": 200, "request_id": "9481d40990fba2a65218edccb7983e83", "body": {"id": "chatcmpl-BwxFHSUhJbPAkSE1Rsk2LpwssGdyT", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 88, "total_tokens": 2089, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1422ddc8190833d1dd8a047d754", "custom_id": "81-3", "response": {"status_code": 200, "request_id": "e780750ebd18309dd717b2c87cfce497", "body": {"id": "chatcmpl-BwxFTXqGw3pcW7JzLMmawC19yblz1", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch xm\n    WHERE \n        xm.oid = o.oid\n        AND xm.catid = 'ALLWISE'\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 87, "total_tokens": 2088, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1423edc8190af2ccba024b172dc", "custom_id": "81-4", "response": {"status_code": 200, "request_id": "1af9aaa34f0837813e2381417de5f3d7", "body": {"id": "chatcmpl-BwxFNFXZ2ECm1ep7H7xnNBLoW44I5", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nWHERE \n    x.catid = 'ALLWISE'\n    AND x.oid_catalog = 'J163603.54-065228.7';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 75, "total_tokens": 2076, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14255ac8190b69340f058a37a8d", "custom_id": "81-5", "response": {"status_code": 200, "request_id": "456fd98b10ab260d61f1e165948c7de8", "body": {"id": "chatcmpl-BwxFNJxfTnmk5Z5tRUml0xJ8Wf1HW", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 88, "total_tokens": 2089, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1424b7c8190a6ccd2c35e92ba1d", "custom_id": "81-6", "response": {"status_code": 200, "request_id": "c1fa8d29a67300c93adcabe73b2f373a", "body": {"id": "chatcmpl-BwxFNOZ8N1o8T8I1hBtldTOp75fOY", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch xm\n    WHERE \n        xm.oid = o.oid\n        AND xm.catid = 'ALLWISE'\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 87, "total_tokens": 2088, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1424a5081909e389b57bf61c5da", "custom_id": "81-7", "response": {"status_code": 200, "request_id": "e87a3e048d34ee2735520e09302a5599", "body": {"id": "chatcmpl-BwxFPvWZtCW78pLXlzd7S4cY148CV", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch x\n    WHERE \n        x.oid = o.oid\n        AND x.catid = 'ALLWISE'\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 87, "total_tokens": 2088, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1427d38819081ef93dcc8433b78", "custom_id": "81-8", "response": {"status_code": 200, "request_id": "39fd23de11381e89599dc20ffd206d26", "body": {"id": "chatcmpl-BwxFP0QYTq28qgyRvzr2I6Ughw7Zj", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 88, "total_tokens": 2089, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1428f4c819098695604b09447a7", "custom_id": "81-9", "response": {"status_code": 200, "request_id": "5a3507e70e7c5d379fb0910c00aa77bb", "body": {"id": "chatcmpl-BwxFHcy3tIPvqToXfMsn60hWgwviE", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2001, "completion_tokens": 88, "total_tokens": 2089, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14293c88190b38ce20c2a247e6e", "custom_id": "69-0", "response": {"status_code": 200, "request_id": "ba01a1a00608b8ab3d8fc39008a84407", "body": {"id": "chatcmpl-BwxFQXhjarcDHFZ0tQhILbOYnX0Mt", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH nearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.distpsnr1,\n        p2.sgscore2,\n        p2.distpsnr2,\n        p3.sgscore3,\n        p3.distpsnr3\n    FROM\n        ps1_ztf p1\n    LEFT JOIN\n        ps1_ztf p2 ON p1.oid <> p2.oid AND p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') AND p2.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    LEFT JOIN\n        ps1_ztf p3 ON p1.oid <> p3.oid AND p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') AND p3.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nWHERE\n    p.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    AND (\n        (p.oid = 'ZTF21abstkhj' AND (\n            (nearest_sources.sgscore1 < 0.2 AND nearest_sources.distpsnr1 = (\n                SELECT MIN(distpsnr1) FROM nearest_sources WHERE sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore2 < 0.2 AND nearest_sources.distpsnr2 = (\n                SELECT MIN(distpsnr2) FROM nearest_sources WHERE sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore3 < 0.2 AND nearest_sources.distpsnr3 = (\n                SELECT MIN(distpsnr3) FROM nearest_sources WHERE sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n            ))\n        )) OR\n        (p.oid = 'ZTF22aacqjeb' AND (\n            (nearest_sources.sgscore1 < 0.2 AND nearest_sources.distpsnr1 = (\n                SELECT MIN(distpsnr1) FROM nearest_sources WHERE sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore2 < 0.2 AND nearest_sources.distpsnr2 = (\n                SELECT MIN(distpsnr2) FROM nearest_sources WHERE sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore3 < 0.2 AND nearest_sources.distpsnr3 = (\n                SELECT MIN(distpsnr3) FROM nearest_sources WHERE sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n            ))\n        )) OR\n        (p.oid = 'ZTF21aamwpdf' AND (\n            (nearest_sources.sgscore1 < 0.2 AND nearest_sources.distpsnr1 = (\n                SELECT MIN(distpsnr1) FROM nearest_sources WHERE sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore2 < 0.2 AND nearest_sources.distpsnr2 = (\n                SELECT MIN(distpsnr2) FROM nearest_sources WHERE sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore3 < 0.2 AND nearest_sources.distpsnr3 = (\n                SELECT MIN(distpsnr3) FROM nearest_sources WHERE sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n            ))\n        ))\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3139, "completion_tokens": 847, "total_tokens": 3986, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a142b56c81909cc9167a644c2642", "custom_id": "69-1", "response": {"status_code": 200, "request_id": "1818a473e8a955d36600cdddd22ccf4e", "body": {"id": "chatcmpl-BwxFQAmNHGp4dFAnEp8BKBSY5PAt8", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH nearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.sgscore2,\n        p1.sgscore3,\n        -- Find the minimum distance among the three sources\n        LEAST(p1.distpsnr1, p1.distpsnr2, p1.distpsnr3) AS min_dist\n    FROM\n        ps1_ztf p1\n    WHERE\n        p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n),\nnearest_source_scores AS (\n    SELECT\n        ns.oid,\n        ns.candid,\n        -- Determine the star/galaxy score of the nearest source\n        CASE\n            WHEN ns.min_dist = ns.distpsnr1 THEN ns.sgscore1\n            WHEN ns.min_dist = ns.distpsnr2 THEN ns.sgscore2\n            WHEN ns.min_dist = ns.distpsnr3 THEN ns.sgscore3\n        END AS nearest_sgscore\n    FROM\n        nearest_sources ns\n)\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nJOIN\n    nearest_source_scores nss\nON\n    p.oid = nss.oid AND p.candid = nss.candid\nWHERE\n    nss.nearest_sgscore < 0.2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3139, "completion_tokens": 296, "total_tokens": 3435, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a142bac0819083c3bf9070c51067", "custom_id": "69-2", "response": {"status_code": 200, "request_id": "b839b2ad953abc46904b91aa8a83784b", "body": {"id": "chatcmpl-BwxFN4rr11MMPv7WzBoyFF7NS2oDh", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1\n     FROM ps1_ztf AS sub\n     WHERE sub.oid = ps1_ztf.oid\n     LIMIT 1\n    ) < 0.2\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2771, "completion_tokens": 208, "total_tokens": 2979, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a142c1a881909082309e8c918dbd", "custom_id": "69-3", "response": {"status_code": 200, "request_id": "694984e199072716ba2046e41abe9969", "body": {"id": "chatcmpl-BwxFHH7SDgu43p8BEXazhjlBjs2xv", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1 FROM ps1_ztf AS sub WHERE sub.oid = ps1_ztf.oid LIMIT 1) < 0.2\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2771, "completion_tokens": 200, "total_tokens": 2971, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a142ced48190bceba0c13e65ab09", "custom_id": "69-4", "response": {"status_code": 200, "request_id": "e6968337ac9f6b932b6c90f375b200e6", "body": {"id": "chatcmpl-BwxFO639FMCDz5Tx0ND3pDCGm6Bfe", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from ps1_ztf where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE\n    -- Filter for specific ZTF identifiers\n    oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    AND\n    -- Ensure the star/galaxy score of the nearest source (sgscore1) is less than 0.2\n    sgscore1 < 0.2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2657, "completion_tokens": 121, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1436dbc819092d7edce82e95b2a", "custom_id": "69-5", "response": {"status_code": 200, "request_id": "647b374a5b1a2c56fbc273b8f8353a0f", "body": {"id": "chatcmpl-BwxFI2njNmjYCMVa1e371mzvk5tLT", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1\n     FROM ps1_ztf AS sub\n     WHERE sub.oid = ps1_ztf.oid\n     LIMIT 1\n    ) < 0.2\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2771, "completion_tokens": 208, "total_tokens": 2979, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a142f8d481909c3e220f37046ff9", "custom_id": "69-6", "response": {"status_code": 200, "request_id": "a15fd3d74884ecbc6867b7f723c66e22", "body": {"id": "chatcmpl-BwxFOpnkJdXLRNs6biO1I35IYknFC", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all rows from ps1_ztf where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Select object IDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND (\n    -- For each object, find the star/galaxy score of the nearest source\n    SELECT sgscore1\n    FROM ps1_ztf p2\n    WHERE p2.oid = ps1_ztf.oid\n    ORDER BY distpsnr1\n    LIMIT 1\n) < 0.2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2771, "completion_tokens": 168, "total_tokens": 2939, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1430d788190b87ee309cbf28bee", "custom_id": "69-7", "response": {"status_code": 200, "request_id": "3344d8501032fd941d7b0e31aa6e9c70", "body": {"id": "chatcmpl-BwxFHc382M1cLbde3zap53T0FtlFE", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1\n     FROM ps1_ztf AS sub\n     WHERE sub.oid = ps1_ztf.oid\n     LIMIT 1\n    ) < 0.2\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2771, "completion_tokens": 208, "total_tokens": 2979, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1430a5c8190adbc5e56d881c270", "custom_id": "69-8", "response": {"status_code": 200, "request_id": "4515b361ecfbd0755e1b7bbc6443c46f", "body": {"id": "chatcmpl-BwxFHMZgSVNANhAyEKsMoOxw4eL9L", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from ps1_ztf where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE\n  -- Filter for specific ZTF object identifiers\n  oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND\n  -- The star/galaxy score of the nearest source (sgscore1) is less than 0.2\n  sgscore1 < 0.2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2657, "completion_tokens": 121, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a143402c8190b8ee4e4eeed9ed69", "custom_id": "69-9", "response": {"status_code": 200, "request_id": "4171a80db9c2d22bdd76d3c7914c4748", "body": {"id": "chatcmpl-BwxFI1hAK7S0Am8pLarguJAxDRQpT", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve the OIDs for the specified objects\nWITH target_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n),\nnearest_sources AS (\n    SELECT\n        t.oid,\n        p1.sgscore1 AS star_galaxy_score\n    FROM\n        target_objects t\n    JOIN\n        ps1_ztf p1 ON t.oid = p1.oid\n    WHERE\n        p1.sgscore1 = (\n            SELECT MIN(sgscore1)\n            FROM ps1_ztf p2\n            WHERE p2.oid = t.oid\n        )\n)\nSELECT\n    p.*\nFROM\n    nearest_sources ns\nJOIN\n    ps1_ztf p ON ns.oid = p.oid AND ns.star_galaxy_score = p.sgscore1\nWHERE\n    ns.star_galaxy_score < 0.2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2771, "completion_tokens": 212, "total_tokens": 2983, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14332808190865208ccce9b6e85", "custom_id": "61-0", "response": {"status_code": 200, "request_id": "fe2c850a87f030babd8c91b9da9048a6", "body": {"id": "chatcmpl-BwxFKNUzZwxdW8WT9yJsk81Y6MjTz", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14354f48190981edcdbae8e3b98", "custom_id": "61-1", "response": {"status_code": 200, "request_id": "44c53c9fe30f6d7b33209cf76299ae3d", "body": {"id": "chatcmpl-BwxFIWJ59QyH1E7DjIdADnGfK8MP4", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1434da481908fd08fcd891178fe", "custom_id": "61-2", "response": {"status_code": 200, "request_id": "7fc3469f0196af746204261f0bc8b79f", "body": {"id": "chatcmpl-BwxFHBgHfLdMof78zy58D4PVW3yfj", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14373f48190a9348859cca69487", "custom_id": "61-3", "response": {"status_code": 200, "request_id": "31557d720e060cfe731af01f3fd17e40", "body": {"id": "chatcmpl-BwxFQqV4G5tofZaxId7w9ElZpcZm2", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1438eb481909eee9bdabe758f54", "custom_id": "61-4", "response": {"status_code": 200, "request_id": "210aee7971f3a858f40c376c7daa8e4c", "body": {"id": "chatcmpl-BwxFHn8q7WHkiGGQI0ECycWHFr6K6", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1438b8481909fc55581660c0859", "custom_id": "61-5", "response": {"status_code": 200, "request_id": "763aa0ab3da4b51d99e93e853ebd7afa", "body": {"id": "chatcmpl-BwxFLQUN7qMQ0xfMZEIVJgvpemQwu", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a143b2908190848e8a1dbcc6b819", "custom_id": "61-6", "response": {"status_code": 200, "request_id": "5d4dea188e9219733e60c6448efe2b52", "body": {"id": "chatcmpl-BwxFHrgy0daM7lwTXHGZ1V0Pa2VJh", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a143b92481908360c0199dd43b3b", "custom_id": "61-7", "response": {"status_code": 200, "request_id": "9a097196202d17a3fc1a4e68c42de1bd", "body": {"id": "chatcmpl-BwxFSlYDkYyZRsF1g0AdNVDIO4eWN", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a143d02481908082c18f0bba2c97", "custom_id": "61-8", "response": {"status_code": 200, "request_id": "0acab2a193d4f3df6dea47b02cd7c508", "body": {"id": "chatcmpl-BwxFK5fwI9MgUTCpIm5vzGdX5IRZ1", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a143d110819081c70a5efb0896c9", "custom_id": "61-9", "response": {"status_code": 200, "request_id": "f1d09ad5d8927756caadfe2cdad2f919", "body": {"id": "chatcmpl-BwxFMxnijr2qPr7ZPXQnd93Kwn4Qn", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2617, "completion_tokens": 42, "total_tokens": 2659, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a143e9048190a536b97828e39f01", "custom_id": "104-0", "response": {"status_code": 200, "request_id": "2a193958338b3f9b08d44ee99e3482a2", "body": {"id": "chatcmpl-BwxFMBDZxGKZYNQvJNdHlMXMFOqf8", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, s.magnr\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN ss_ztf s ON o.oid = s.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    so.magnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    d.drb,\n    d.drbversion,\n    d.step_id_corr\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5149, "completion_tokens": 262, "total_tokens": 5411, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a143ee688190b517a33aec7ca7fa", "custom_id": "104-1", "response": {"status_code": 200, "request_id": "8dd92253c5b08f14726ec7f75a1fcc7e", "body": {"id": "chatcmpl-BwxFJSjoR5dxOlFcsoILemhgOX0St", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, s.magnr\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN ss_ztf s ON o.oid = s.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT \n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    so.magnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    d.rp,\n    d.drb,\n    d.drbversion\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5149, "completion_tokens": 261, "total_tokens": 5410, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a144160c8190a220e75425d3f771", "custom_id": "104-2", "response": {"status_code": 200, "request_id": "cb6d41d2df03099c3a7cdd16b1532a6b", "body": {"id": "chatcmpl-BwxFN2fulBTz5qQQjmHHeyD5CYjov", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.distnr, d.rid, d.mjd, d.magap, d.sigmagap\n    FROM detection d\n),\nps1_info AS (\n    SELECT p.oid, p.candid, p.objectidps1, p.sgmag1, p.distpsnr1\n    FROM ps1_ztf p\n),\nfilter_exposure AS (\n    SELECT f.fid, f.fwhm, f.exptime, f.ncalib\n    FROM filter f\n),\nfinal AS (\n    SELECT \n        so.oid, \n        so.ssnamenr AS sso_name,\n        so.ssdistnr AS sso_distance,\n        so.ssmagnr AS sso_mpc_mag,\n        ci.candid,\n        ci.fid,\n        fi.fwhm,\n        pi.ncalib,\n        fi.exptime,\n        ci.magpsf,\n        ci.distnr,\n        ci.rid,\n        ci.mjd,\n        ci.magap,\n        ci.sigmagap\n    FROM selected_objects so\n    JOIN nearest_ss ns ON so.oid = ns.oid\n    JOIN candidate_info ci ON so.oid = ci.oid AND so.oid = ci.oid\n    LEFT JOIN ps1_info pi ON so.oid = pi.oid AND ci.candid = pi.candid\n    JOIN filter_exposure fi ON ci.fid = fi.fid\n)\nSELECT \n    oid,\n    candid,\n    sso_distance,\n    sso_mpc_mag,\n    sso_name,\n    fid,\n    magpsf,\n    fwhm,\n    ncalib,\n    exptime\nFROM final\nORDER BY probability DESC -- Note: probability is not directly selected here; assuming the probability info is embedded in the selection criteria\nLIMIT 30;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 8046, "completion_tokens": 570, "total_tokens": 8616, "prompt_tokens_details": {"cached_tokens": 7808, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1440bf08190a2ffe6a87a8ee080", "custom_id": "104-3", "response": {"status_code": 200, "request_id": "03a6c71acf9e62bd1258f9b54f027ad1", "body": {"id": "chatcmpl-BwxFImWMlHo6ppyCjfr79Vhxd8NEV", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- filter for asteroid class\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n)\nSELECT \n    so.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearest_sso,\n    ss.ssnamenr AS sso_name,\n    -- MPC archive magnitude and name (assuming MPC info is stored in a feature table or similar; if not, this part is a placeholder)\n    -- For demonstration, assuming 'mpc_mag' and 'mpc_name' are features\n    f_mpc_mag.value AS mpc_magnitude,\n    f_mpc_name.value AS mpc_name,\n    -- Additional candidate info\n    d.fid AS filter_id,\n    d.sigmapsf AS fwhm, -- assuming sigmapsf as a proxy for FWHM from SExtractor\n    -- Number of PS1 calibrators used (assuming stored in feature table with name 'n_ps1_calibrators')\n    f_ps1_calibrators.value AS n_ps1_calibrators,\n    -- Exposure time (assuming stored in detection table or feature; here, using 'pid' as placeholder)\n    d.pid AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid\nLEFT JOIN ss_ztf ss ON so.oid = ss.oid\nLEFT JOIN feature f_mpc_mag ON so.oid = f_mpc_mag.oid AND f_mpc_mag.name = 'mpc_mag'\nLEFT JOIN feature f_mpc_name ON so.oid = f_mpc_name.oid AND f_mpc_name.name = 'mpc_name'\nLEFT JOIN feature f_ps1_calibrators ON so.oid = f_ps1_calibrators.oid AND f_ps1_calibrators.name = 'n_ps1_calibrators'\nWHERE d.oid = so.oid;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 8046, "completion_tokens": 482, "total_tokens": 8528, "prompt_tokens_details": {"cached_tokens": 7424, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1442c608190ba9e23ef3c12ede5", "custom_id": "104-4", "response": {"status_code": 200, "request_id": "4ba9dcdebd269aa48fa715fe833c8c29", "body": {"id": "chatcmpl-BwxFIVzEtTPdvmSzhzc6ouf6lOoHq", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_archive_magnitude,\n    d.fid AS filter_id,\n    d.sigmapsf AS fwhm_sextractor,\n    -- Assuming 'ps1_ztf' table has 'candid' matching the candidate and 'nmtchps' as number of PS1 calibrators\n    p.nmtchps AS ps1_calibrators_used,\n    d.mjd AS exposure_time -- Using detection time as a proxy for exposure time\nFROM selected_objects so\nJOIN object o ON o.oid = so.oid\nJOIN detection d ON d.candid = so.candid\nLEFT JOIN ss_ztf ss ON ss.candid = d.candid\n-- Additional columns like FWHM, PS1 calibrators, exposure time are included as per assumptions\nLIMIT 30;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 8046, "completion_tokens": 317, "total_tokens": 8363, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a144362c8190a256348c89cff0dc", "custom_id": "104-5", "response": {"status_code": 200, "request_id": "3bdc3ac9e15aa8b1a62624f8a7cdd7d8", "body": {"id": "chatcmpl-BwxFI2mGAwfWBSrJFznQGfkXy5Pv7", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_objects AS (\n    SELECT o.oid, p.candid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.ranking\n        LIMIT 1\n    )\n),\nnearest_ss AS (\n    SELECT so.oid, so.ssnamenr\n    FROM ss_ztf so\n),\ncandidate_info AS (\n    SELECT c.oid, c.candid, c.distnr, c.ssmagnr, c.ssnamnr, c.fid, c.fwhm, c.nps1, c.exptime\n    FROM detection c\n)\nSELECT\n    o.oid AS ztf_id,\n    c.candid,\n    ns.ssnamenr AS solar_system_object_name,\n    c.distnr AS distance_ss,\n    c.ssmagnr AS mpc_magnitude,\n    c.ssnamnr AS mpc_name,\n    c.fid AS filter_id,\n    c.fwhm,\n    c.nps1 AS ps1_calibrators_used,\n    c.exptime AS exposure_time\nFROM selected_objects o\nJOIN candidate_info c ON o.oid = c.oid\nLEFT JOIN nearest_ss ns ON o.oid = ns.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 8046, "completion_tokens": 315, "total_tokens": 8361, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14450488190a9119dcf018cc4b3", "custom_id": "104-6", "response": {"status_code": 200, "request_id": "0f9db8c0b070f394734cc9bad338dac2", "body": {"id": "chatcmpl-BwxFHkJWzhireL1DX1wkA4rLbtejP", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 30 ZTF objects with high asteroid probability in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH high_prob_objects AS (\n    SELECT o.oid, p.oid, p.class_name, p.probability, p.ranking\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n      AND p.ranking = 1\n    LIMIT 30\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearest_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_magnitude,\n    d.fid AS filter_id,\n    -- Assuming FWHM, number of PS1 calibrators, and exposure time are stored in detection or feature tables\n    -- If not, these columns are placeholders and should be replaced with actual table/column names\n    f.value AS fwhm,\n    -- For number of PS1 calibrators used, assuming it's stored in feature table with a specific feature name\n    (SELECT value FROM feature WHERE oid = o.oid AND name = 'n_ps1_calibrators' AND fid = d.fid LIMIT 1) AS n_ps1_calibrators,\n    -- For exposure time, assuming it's stored in detection table as 'exposure_time' or similar\n    d.exposure_time\nFROM high_prob_objects hpo\nJOIN object o ON o.oid = hpo.oid\nJOIN detection d ON d.oid = o.oid\nLEFT JOIN ss_ztf ss ON ss.oid = o.oid\nLEFT JOIN feature f ON f.oid = o.oid AND f.name = 'FWHM' AND f.fid = d.fid\n-- Additional filters can be added if needed, e.g., specific filters or detection quality\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 8081, "completion_tokens": 448, "total_tokens": 8529, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14453248190af8d66e64c6f7637", "custom_id": "104-7", "response": {"status_code": 200, "request_id": "142833e187334f27e157f44211438237", "body": {"id": "chatcmpl-BwxFIkiQrxPViDrNKrdtM6TYcUt15", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.mjd, d.distnr, d.rgmag, d.exptime\n    FROM detection d\n)\nSELECT\n    so.oid AS ztf_id,\n    so.candid AS candidate_id,\n    ns.ssdistnr AS distance_to_nearest_ss_object,\n    ns.ssmagnr AS mpc_magnitude,\n    ns.ssnamenr AS solar_system_object_name,\n    ci.fid AS filter_id,\n    ci.magpsf AS fwhm, -- Assuming magpsf is used as a proxy for FWHM; adjust if a specific FWHM column exists\n    -- Placeholder for number of PS1 calibrators used; assuming it's stored in feature table with a specific feature name\n    (SELECT value FROM feature WHERE oid = ci.oid AND name = 'n_ps1_calibrators' LIMIT 1) AS ps1_calibrators_count,\n    ci.exptime AS exposure_time\nFROM selected_objects so\nJOIN candidate_info ci ON so.candid = ci.candid\nLEFT JOIN nearest_ss ns ON so.oid = ns.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 8046, "completion_tokens": 429, "total_tokens": 8475, "prompt_tokens_details": {"cached_tokens": 7808, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a144a4748190a80d8223759610b1", "custom_id": "104-8", "response": {"status_code": 200, "request_id": "b0b4eb6de0d073e766c69422b4514543", "body": {"id": "chatcmpl-BwxFN5NtvZe7nbjHv93PAm84dP5xh", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.oid, d.candid, d.fid, d.ra, d.dec, d.mjd, d.magpsf, d.sigmapsf, d.magap, d.sigmagap, d.distnr, d.rb, d.rid, d.exptime\n    FROM detection d\n    WHERE (d.oid, d.candid) IN (SELECT oid, candid FROM selected_objects)\n),\ncandidate_details AS (\n    SELECT c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb, c.rid, c.exptime,\n           f.name AS filter_name,\n           -- Placeholder for FWHM from SExtractor, assuming it's stored in feature table with a specific name\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'FWHM' AND fid = c.fid LIMIT 1) AS fwhm,\n           -- Placeholder for number of PS1 calibrators used, assuming stored in feature table\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'n_ps1_calibrators' AND fid = c.fid LIMIT 1) AS n_ps1_calibrators,\n           -- Placeholder for exposure time, assuming stored in feature table\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'exposure_time' AND fid = c.fid LIMIT 1) AS exposure_time\n    FROM candidate_info c\n),\nfinal_result AS (\n    SELECT \n        c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb, c.rid, c.exptime,\n        fc.filter_name, fc.fwhm, fc.n_ps1_calibrators, fc.exposure_time,\n        ns.ssnamenr, ns.ssdistnr, ns.ssmagnr\n    FROM candidate_details fc\n    LEFT JOIN nearest_ss ns ON fc.oid = ns.oid\n)\nSELECT * FROM final_result\nLIMIT 30;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 8046, "completion_tokens": 641, "total_tokens": 8687, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1446ba08190ae23d0adb391da45", "custom_id": "104-9", "response": {"status_code": 200, "request_id": "84decc632704a453e15c5308ce936e30", "body": {"id": "chatcmpl-BwxFJXNOYXXei9JdZbkqYWJTM0GX6", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.probability DESC\n        LIMIT 30\n    )\n)\nSELECT \n    so.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS ss_object_name,\n    ss.magnr AS mpc_archive_magnitude,\n    d.fid AS filter_id,\n    f.value AS fwhm,\n    -- Assuming 'ps1_calibrators' is a feature stored in the feature table with a specific name, e.g., 'ps1_calibrators_used'\n    (SELECT f2.value FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'ps1_calibrators_used' AND f2.fid = d.fid AND f2.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS ps1_calibrators_used,\n    -- Assuming 'exposure_time' is stored similarly in the feature table with name 'exposure_time'\n    (SELECT f3.value FROM feature f3 WHERE f3.oid = so.oid AND f3.name = 'exposure_time' AND f3.fid = d.fid AND f3.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.oid = d.oid\nJOIN ss_ztf ss ON so.oid = ss.oid\nJOIN feature f ON so.oid = f.oid AND f.name = 'FWHM' AND f.fid = d.fid\nWHERE d.oid = so.oid\nLIMIT 30;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 8046, "completion_tokens": 447, "total_tokens": 8493, "prompt_tokens_details": {"cached_tokens": 7808, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14488708190b02aca762390b599", "custom_id": "71-0", "response": {"status_code": 200, "request_id": "54061d4b767764235846e7b90eff36a5", "body": {"id": "chatcmpl-BwxFIsQeGRSNjqmfQ2H0IsR33DV9s", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference information for specified ZTF objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band filter\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2768, "completion_tokens": 121, "total_tokens": 2889, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1449fdc81908cbb3bb00a87bc4f", "custom_id": "71-1", "response": {"status_code": 200, "request_id": "e04870f12b90a97cc1f28b0ba2f59eba", "body": {"id": "chatcmpl-BwxFOBkcELvdTV57qqdbHLPCYDEve", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference entries for specified ZTF objects with g-band data\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 2 -- g-band filter\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2768, "completion_tokens": 115, "total_tokens": 2883, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a144ab848190ad0f08616b5c2ed6", "custom_id": "71-2", "response": {"status_code": 200, "request_id": "64b5ef63294d6aa5117c845ec697e6ed", "body": {"id": "chatcmpl-BwxFIU4VfuoTSgR2KnkTsselTLE6E", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2286, "completion_tokens": 120, "total_tokens": 2406, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a144aeec8190a798c51a23ad80ef", "custom_id": "71-3", "response": {"status_code": 200, "request_id": "ae4d1408c47ef39f09ed4e46146518f8", "body": {"id": "chatcmpl-BwxFN6KjPEMTNuS03BGTGEWfeXNgv", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.rfid IS NOT NULL -- assuming rfid corresponds to the band information\n    AND r.rfid IN (\n        -- Subquery to find rfid values associated with g band observations\n        SELECT r2.rfid\n        FROM reference r2\n        WHERE r2.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n        AND r2.rfid IS NOT NULL\n        -- Additional filtering if needed to specify g band, but since no explicit band info in reference table,\n        -- assume rfid or other columns are used to infer band; if not, this may need adjustment.\n    )\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3526, "completion_tokens": 246, "total_tokens": 3772, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a144c6d88190a5fc035998a00689", "custom_id": "71-4", "response": {"status_code": 200, "request_id": "1aa125537f98d6a7182b1c955c8c3478", "body": {"id": "chatcmpl-BwxFHXes5DlCs5UgMQNbZonQRMjGk", "object": "chat.completion", "created": 1753390463, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.rfid IS NOT NULL -- assuming rfid corresponds to the band information\n    AND r.rfid IN (\n        -- Subquery to find rfid values associated with g band\n        SELECT r2.rfid\n        FROM reference r2\n        WHERE r2.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n        AND r2.rfid IS NOT NULL\n        -- Additional filtering if needed to specify g band, but since no explicit band info in reference table,\n        -- assuming rfid or other columns would be used if available. If not, this filter may be omitted.\n    )\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3526, "completion_tokens": 246, "total_tokens": 3772, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a144d4408190b781c362dcf2f12f", "custom_id": "71-5", "response": {"status_code": 200, "request_id": "788dbae831b0b52c638d4047442b8d0f", "body": {"id": "chatcmpl-BwxFNiw9OyHd0xs7N353fovwG7m5M", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.rfid = 1 -- Assuming rfid=1 corresponds to the g band\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3526, "completion_tokens": 126, "total_tokens": 3652, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14521708190ab3ec7668ad6aac9", "custom_id": "71-6", "response": {"status_code": 200, "request_id": "9358e2db1541fa7c1495097530296848", "body": {"id": "chatcmpl-BwxFNBacEcmN2lJsK69duya2eLlID", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_id,\n    r.rfid AS ztf_id,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2286, "completion_tokens": 124, "total_tokens": 2410, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a145498081909d526ac41d5a0cca", "custom_id": "71-7", "response": {"status_code": 200, "request_id": "f9a2191bfccc83870cecd5c344b2a73f", "body": {"id": "chatcmpl-BwxFKOS1K22bOOHcwL1zBaWogxgJ0", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2286, "completion_tokens": 120, "total_tokens": 2406, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14566348190ac623355b92c7ace", "custom_id": "71-8", "response": {"status_code": 200, "request_id": "322606bb11794fd7d2e662598070d62f", "body": {"id": "chatcmpl-BwxFNfNXRZmzXgFFi9GkvELscWEoF", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2286, "completion_tokens": 120, "total_tokens": 2406, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1455f088190826a9fb8ca272d0b", "custom_id": "71-9", "response": {"status_code": 200, "request_id": "be92fc8600839d1f120f1f421e99accd", "body": {"id": "chatcmpl-BwxFMGqmScxMGGnbx1A8O2Bc5EyJh", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2286, "completion_tokens": 120, "total_tokens": 2406, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14564e48190aa499c0eadd19ead", "custom_id": "42-0", "response": {"status_code": 200, "request_id": "5c3da3f442385fccef636bbabf25f410", "body": {"id": "chatcmpl-BwxFMQ2dG4Crw2KNqDCdEfkt1H45t", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 127, "total_tokens": 2841, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14583f4819086290ada6a1dd931", "custom_id": "42-1", "response": {"status_code": 200, "request_id": "f6caa547895abb252877ea4c50ebc249", "body": {"id": "chatcmpl-BwxFI3lgcKkjhmFpEwfhhmMI6WPMd", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM (\n    SELECT \n        oid,\n        candid,\n        fid,\n        chipsf,\n        fwhm,\n        classtar,\n        nbad,\n        magzpsci,\n        magzpsciunc,\n        exptime\n    FROM dataquality\n    WHERE oid = 'ZTF21aapnixl'\n) sub\nORDER BY chipsf ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 137, "total_tokens": 2851, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a145806c819094f936dfc123e2f1", "custom_id": "42-2", "response": {"status_code": 200, "request_id": "383e5c2ab072a7dcdae5d91674fa5f74", "body": {"id": "chatcmpl-BwxFPvG2DoHLrlNykI3QVyxbbHGfI", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 127, "total_tokens": 2841, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1459f1081908d77eac8b742a32e", "custom_id": "42-3", "response": {"status_code": 200, "request_id": "e51c57776f043bf2b68cde4df415c462", "body": {"id": "chatcmpl-BwxFOscypVziayCXm3JzSowDxQTta", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime\nFROM \n    dataquality\nWHERE \n    oid = 'ZTF21aapnixl'\nORDER BY \n    chipsf;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 98, "total_tokens": 2812, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1459f98819088b288c970fd1088", "custom_id": "42-4", "response": {"status_code": 200, "request_id": "57adc0c16eb142ccf8a740d11f6b6db5", "body": {"id": "chatcmpl-BwxFIkmnu3kkyXfKUfdRluYKicXFZ", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime\nFROM \n    dataquality\nWHERE \n    oid = 'ZTF21aapnixl'\nORDER BY \n    chipsf;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 98, "total_tokens": 2812, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a145da988190a1173c3981701726", "custom_id": "42-5", "response": {"status_code": 200, "request_id": "d374a46d34940570071f13ccf33b7ff2", "body": {"id": "chatcmpl-BwxFQxRzs8dOuNtFmhov2yQK2MIMc", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM \n    dataquality\nWHERE \n    oid = 'ZTF21aapnixl'\nORDER BY \n    chipsf;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 134, "total_tokens": 2848, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a145dd2c8190a133d409869d26cc", "custom_id": "42-6", "response": {"status_code": 200, "request_id": "a66e454c9d46656ff502ad1a0c005b66", "body": {"id": "chatcmpl-BwxFPvT6Koo6Sb2u6pXYQQAo9CWuH", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 128, "total_tokens": 2842, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a145ded881909b2fcb22be1f6041", "custom_id": "42-7", "response": {"status_code": 200, "request_id": "e19984f5130d6baad4fe3ff099e937a1", "body": {"id": "chatcmpl-BwxFP7cRIMgkHa51bGBwl5AgJDTET", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM (\n    SELECT \n        oid,\n        candid,\n        fid,\n        chipsf,\n        fwhm,\n        classtar,\n        nbad,\n        magzpsci,\n        magzpsciunc,\n        exptime\n    FROM dataquality\n    WHERE oid = 'ZTF21aapnixl'\n) sub\nORDER BY chipsf;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 136, "total_tokens": 2850, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a145e924819084b162025e1f37c5", "custom_id": "42-8", "response": {"status_code": 200, "request_id": "e5b6e5792ab71c893cbf1904d7dd0393", "body": {"id": "chatcmpl-BwxFKY7azHwA3Zj65vdHoM3VaJHCN", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm,\n    classtar AS star_galaxy_score,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 125, "total_tokens": 2839, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a145fba08190bf8e889458d71bb0", "custom_id": "42-9", "response": {"status_code": 200, "request_id": "4f3a14da801fb6ef3ddc4083f14e712f", "body": {"id": "chatcmpl-BwxFOQYhWIFS8shRd7UkJGxgjJvb2", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2714, "completion_tokens": 127, "total_tokens": 2841, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14600248190afc4bf2f98545cd0", "custom_id": "107-0", "response": {"status_code": 200, "request_id": "eed52bc3c46852825bfd6d52972236ce", "body": {"id": "chatcmpl-BwxFQGpef9ThdtkY0YqJ7yOs1SAYC", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.ranking,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist,\n        d.candid,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Get the most probable class with probability > 0.5 for stamp_classifier_1.0.4\n    WHERE\n        -- Subquery to get the top-ranked probability for stamp_classifier_1.0.4\n        (\n            SELECT probability\n            FROM probability p2\n            WHERE p2.oid = o.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n              AND p2.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p2.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        -- Subquery to get the top-ranked probability for the asteroid class\n        (\n            SELECT probability\n            FROM probability p3\n            WHERE p3.oid = o.oid\n              AND p3.class_name = 'asteroid'\n              AND p3.classifier_name = 'stamp_classifier'\n              AND p3.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p3.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        -- Distance to nearest Solar System object less than 2 arcsec\n        (\n            SELECT dist\n            FROM xmatch xm2\n            WHERE xm2.oid = o.oid\n              AND xm2.catid = 'solar_system'\n            ORDER BY dist\n            LIMIT 1\n        ) < 2\n)\n-- Join with detection table to get detection details\nSELECT\n    so.oid AS ztf_id,\n    so.ndet AS num_detections,\n    so.firstmjd AS first_detection_mjd,\n    so.lastmjd AS last_detection_mjd,\n    so.probability,\n    so.candid AS candidate_id,\n    so.dist AS distance_arcsec,\n    so.oid_catalog AS mpc_name,\n    so.mjd AS detection_mjd,\n    so.fid AS filter_id\nFROM\n    selected_objects so\nJOIN\n    detection d ON d.oid = so.oid\n-- Order by first detection date\nORDER BY\n    so.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 540, "total_tokens": 3820, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a146206c8190a3c97f9f6075eda0", "custom_id": "107-1", "response": {"status_code": 200, "request_id": "ff7ed60acfce60a356fe436c068b3773", "body": {"id": "chatcmpl-BwxFNqnzaKID4oCBCNFl7PtxlsV9I", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.ranking = 1\n        AND p.class_name = 'SN' -- Assuming 'SN' is used for asteroids in the stamp classifier\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.catid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.classifier_name = 'stamp_classifier_1.0.4' AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 413, "total_tokens": 3693, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1461ba88190b84147dd3ffe77fb", "custom_id": "107-2", "response": {"status_code": 200, "request_id": "496e94fce535f19812121a3212af96f3", "body": {"id": "chatcmpl-BwxFKkeKu5NdmKrfyK1r4LFFqTM4e", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        d.candid,\n        xm.dist,\n        xm.oid_catalog AS mpc_name,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Subquery to get the most probable class with ranking=1 for stamp_classifier_1.0.4\n    WHERE\n        -- Ensure object has more than 500 detections\n        o.ndet > 500\n        AND\n        -- Probability of being an asteroid (assuming 'asteroid' class in 'stamp_classifier')\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'asteroid'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.ranking = 1\n                AND p.probability > 0.5\n        )\n        AND\n        -- Distance to nearest Solar System object less than 2 arcsec\n        EXISTS (\n            SELECT 1\n            FROM xmatch xm\n            WHERE\n                xm.oid = o.oid\n                AND xm.dist < 2\n        )\n    -- Join with detection to get detection date and filter\n    JOIN detection d ON d.oid = o.oid\n    -- Join with xmatch to get MPC name and distance\n    LEFT JOIN xmatch xm ON xm.oid = o.oid\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    ndet AS \"Number of Detections\",\n    to_timestamp(firstmjd * 86400) AS \"First Detection Date\",\n    to_timestamp(lastmjd * 86400) AS \"Last Detection Date\",\n    probability AS \"Probability\",\n    candid AS \"Candidate Identifier\",\n    dist AS \"Distance to MPC (arcsec)\",\n    mpc_name AS \"MPC Name\",\n    to_timestamp(mjd * 86400) AS \"Detection Date\",\n    fid AS \"Filter ID\"\nFROM\n    selected_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 479, "total_tokens": 3759, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14668e4819097e032894458d942", "custom_id": "107-3", "response": {"status_code": 200, "request_id": "9f888e81905143b13ed19e545f972f36", "body": {"id": "chatcmpl-BwxFQXyPP8J3VtbxTfWjo25ND4GHN", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 10 objects with specified conditions\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability AS asteroid_probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM \n    object o\n-- Subquery to get the probability > 0.5 for stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND class_name = 'SN' -- Assuming 'SN' is used for asteroid classification; if not, clarify the class name\n        AND probability > 0.5\n) p ON o.oid = p.oid\n-- Subquery to get the nearest Solar System object within 2 arcsec\nJOIN (\n    SELECT \n        xm1.oid,\n        xm1.dist,\n        xm1.oid_catalog\n    FROM \n        xmatch xm1\n    WHERE \n        xm1.dist < 2\n        AND xm1.catid = 'MPC' -- Assuming 'MPC' is the catalog ID for Solar System objects\n) xm ON o.oid = xm.oid\n-- Join with detection to get detection details\nJOIN detection d ON o.oid = d.oid\n-- Order by first detection date\nORDER BY \n    o.firstmjd\n-- Limit to 10 results\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 374, "total_tokens": 3654, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14677508190bf705f18487ab18c", "custom_id": "107-4", "response": {"status_code": 200, "request_id": "8441c1232d71582d671d0e8ba6943e99", "body": {"id": "chatcmpl-BwxFRipF1xOIeCFvd8RvgVGjZGTcv", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.dist,\n        xm.catid,\n        xm.oid_catalog\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.class_name = 'SN' -- Assuming 'SN' in 'stamp_classifier' indicates asteroid class\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.ranking = 1\n        AND xm.dist < 2\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.class_name = 'SN' AND p.classifier_name = 'stamp_classifier' AND p.classifier_version = 'stamp_classifier_1.0.4' AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nJOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 423, "total_tokens": 3703, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1465d048190bbcf84526f58f70b", "custom_id": "107-5", "response": {"status_code": 200, "request_id": "b3264cebf06c7ea94b6d59e962874288", "body": {"id": "chatcmpl-BwxFM2Ag1cRSB90n1QQ3q4sFuDgSX", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT\n    oid,\n    ndet,\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS first_detection_date,\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS last_detection_date,\n    probability,\n    candid,\n    dist,\n    catid,\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS detection_date,\n    fid\nFROM\n    selected_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 299, "total_tokens": 3579, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a146681081908d6996085d0df47e", "custom_id": "107-6", "response": {"status_code": 200, "request_id": "acb72b286331ed736f068a79448e7ece", "body": {"id": "chatcmpl-BwxFMMKJH8Qs0UYRimt9Cgj6WHmVL", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN detection d ON o.oid = d.oid\n    LEFT JOIN xmatch xm ON o.oid = xm.oid\n    WHERE \n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'SN' -- Assuming 'SN' is used for asteroids in stamp classifier\n        AND p.ranking = 1\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT \n    oid AS ztf_object_id,\n    ndet AS number_of_detections,\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS first_detection_date,\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS last_detection_date,\n    probability,\n    candid AS candidate_id,\n    dist AS distance_arcsec,\n    catid AS mpc_name,\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS detection_date,\n    fid AS filter_id\nFROM selected_objects\nORDER BY firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 338, "total_tokens": 3618, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14685548190ba553ddf9b950427", "custom_id": "107-7", "response": {"status_code": 200, "request_id": "de64fdbf449933538e6278f7841f1cc1", "body": {"id": "chatcmpl-BwxFOhSq2lxi14bWbX5i9qlNJK4iU", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'SN' -- Assuming 'SN' is used for asteroids in the stamp classifier\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    -- Retrieve candidate id and detection date from detection table\n    d.candid AS candidate_id,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name\nFROM\n    selected_objects o\nLEFT JOIN\n    probability p ON o.oid = p.oid AND p.classifier_name = 'stamp_classifier' AND p.classifier_version = 'stamp_classifier_1.0.4' AND p.class_name = 'SN'\nLEFT JOIN\n    detection d ON o.oid = d.oid\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nWHERE\n    d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 420, "total_tokens": 3700, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1467da08190b54c7adf85be0a58", "custom_id": "107-8", "response": {"status_code": 200, "request_id": "92dfd669570ef40ce2301a0d9d17166c", "body": {"id": "chatcmpl-BwxFQZpPHej5xfXxCFwvnHYzcDYqv", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 10 objects with specified conditions\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability AS asteroid_probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM \n    object o\n-- Subquery to get the top probability for stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        oid,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' AND\n        classifier_version = 'stamp_classifier_1.0.4' AND\n        ranking = 1 AND\n        probability > 0.5\n) p ON o.oid = p.oid\n-- Subquery to get the nearest Solar System object within 2 arcsec\nJOIN (\n    SELECT \n        xm1.oid,\n        xm1.dist,\n        xm1.oid_catalog\n    FROM \n        xmatch xm1\n    WHERE \n        xm1.dist < 2\n        AND xm1.catid = 'solar_system'\n) xm ON o.oid = xm.oid\n-- Join to get detections for the object\nJOIN detection d ON o.oid = d.oid\n-- Filter for the earliest detection date for ordering\nWHERE \n    o.ndet > 500\nORDER BY \n    o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 342, "total_tokens": 3622, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14699488190aa808836c025a7db", "custom_id": "107-9", "response": {"status_code": 200, "request_id": "591fbe14a1417b2f25a245e67704bb8f", "body": {"id": "chatcmpl-BwxFMT6tMrmAxnQjzWrcfKnjfSHua", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        -- Filter for objects with more than 500 detections\n        o.ndet > 500\n        -- Probability > 0.5 for asteroid class in stamp_classifier version 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.probability > 0.5\n        -- Most probable class (ranking=1)\n        AND p.ranking = 1\n        -- Distance from Solar System object below 2 arcsec\n        AND (xm.dist IS NULL OR xm.dist < 2)\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.catid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3280, "completion_tokens": 455, "total_tokens": 3735, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a146a43c81908d5022737d080e63", "custom_id": "83-0", "response": {"status_code": 200, "request_id": "4028ed8d2718aaac0f115ffe7d717a7e", "body": {"id": "chatcmpl-BwxFMGODuZ06Dt5bd9LnkZ2y1RQU5", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a146d9fc81908bb8ee67995ad7ad", "custom_id": "83-1", "response": {"status_code": 200, "request_id": "52494c101fdbe2c4625a05457ba795cd", "body": {"id": "chatcmpl-BwxFItVjML9tBFjEg6v07CuWvyGuV", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a146de788190be57a6cefbb89ebc", "custom_id": "83-2", "response": {"status_code": 200, "request_id": "74b179f8cce04e7b61bba326fe004f59", "body": {"id": "chatcmpl-BwxFOtWz2jdgfXMYqjAR2FoA76rZx", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a146ec1c819094823984c9ac8279", "custom_id": "83-3", "response": {"status_code": 200, "request_id": "c5e7e353e84d29f6ce1d82a8cbe6731a", "body": {"id": "chatcmpl-BwxFRLys2ew7HGYj1QMQah172ERyq", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a146f99c8190990a6291a1139134", "custom_id": "83-4", "response": {"status_code": 200, "request_id": "ac871736830acecfb9432c83e9dfa173", "body": {"id": "chatcmpl-BwxFOogbqd6mrHlcnSdUlQTQ64rGA", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14710e88190abd1756831794ff3", "custom_id": "83-5", "response": {"status_code": 200, "request_id": "9051327e4daae89b82b2d1185940d1c8", "body": {"id": "chatcmpl-BwxFIcTFdzb7WIBefUBiqWH8sh632", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a146fb508190b5cece0946e5cdca", "custom_id": "83-6", "response": {"status_code": 200, "request_id": "a79098574e2d39572a3c242fb3053b8b", "body": {"id": "chatcmpl-BwxFJzvF4bJi8WMVR031RDggkLHq7", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a147198c81909d3501fa49ee4c49", "custom_id": "83-7", "response": {"status_code": 200, "request_id": "c6c44792d888857440a7e961af731abd", "body": {"id": "chatcmpl-BwxFN4gNkcUDbsSkrXIkjY4WE2wMp", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14728e88190b0bde763478db2cf", "custom_id": "83-8", "response": {"status_code": 200, "request_id": "f6d6f127470cda3eff259b240036f234", "body": {"id": "chatcmpl-BwxFSz7eWWKrCBIFMmrTmYL6mTPrU", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1475af881908ec929fa0fd4b662", "custom_id": "83-9", "response": {"status_code": 200, "request_id": "736bd34a8df76395f7267d06fdc25fea", "body": {"id": "chatcmpl-BwxFOPTOP3UsUfqoFijHHGnRXiVoo", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2561, "completion_tokens": 25, "total_tokens": 2586, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14757bc8190b46b2e749c3e1dc9", "custom_id": "84-0", "response": {"status_code": 200, "request_id": "c76119af44fc2fbc7d11117d18f1cf5b", "body": {"id": "chatcmpl-BwxFIF2qsEghiMHfCdKboCkespSzH", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        a.oid_catalog,\n        a.ra,\n        a.dec,\n        q3c_dist(z.meanra, z.meandec, a.ra, a.dec) AS distance,\n        a.w1mpro,\n        a.w2mpro,\n        a.w3mpro,\n        a.w4mpro\n    FROM allwise a\n    JOIN ztf_object z ON q3c_join(z.meanra, z.meandec, a.ra, a.dec, 0.5) -- assuming a 0.5 degree radius for matching\n)\nSELECT\n    'ZTF19aascdol' AS ztf_oid,\n    oid_catalog,\n    distance,\n    w1mpro AS W1,\n    w2mpro AS W2,\n    w3mpro AS W3,\n    w4mpro AS W4\nFROM wise_matches;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3087, "completion_tokens": 237, "total_tokens": 3324, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1476b508190a9b1e2afdbf57b19", "custom_id": "84-1", "response": {"status_code": 200, "request_id": "e1c275e00c7f1952dd4cdd58a4b60890", "body": {"id": "chatcmpl-BwxFIN6xoXKVtqhAWJ7aSCHlRR6EZ", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        o.oid_catalog,\n        o.ra,\n        o.dec,\n        q3c_dist(z.meanra, z.meandec, o.ra, o.dec) AS distance_deg,\n        o.w1mpro,\n        o.w2mpro,\n        o.w3mpro,\n        o.w4mpro\n    FROM allwise o\n    CROSS JOIN ztf_object z\n    WHERE q3c_join(z.meanra, z.meandec, o.ra, o.dec, 0.000277778) -- 1 arcsecond in degrees\n)\nSELECT\n    'ZTF19aascdol' AS ztf_oid,\n    oid_catalog,\n    distance_deg,\n    w1mpro,\n    w2mpro,\n    w3mpro,\n    w4mpro\nFROM wise_matches;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3087, "completion_tokens": 235, "total_tokens": 3322, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1478668819098f62bb1cdd4f48f", "custom_id": "84-2", "response": {"status_code": 200, "request_id": "33a8dc37fe0ae650f7fe99932c552870", "body": {"id": "chatcmpl-BwxFOIZta8RFGRpyVnsVQeZrbwyld", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object\nSELECT \n    o.oid AS ztf_object_id,\n    aw.oid_catalog AS allwise_catalog_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 150, "total_tokens": 3350, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14784488190bacf601e811663a3", "custom_id": "84-3", "response": {"status_code": 200, "request_id": "da880c9eaed378f6ae97bc9c970cb15c", "body": {"id": "chatcmpl-BwxFKzs2cNzLxZkDuslErFI15wmva", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 134, "total_tokens": 3334, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14790b88190943721bca8fef8d9", "custom_id": "84-4", "response": {"status_code": 200, "request_id": "7bf4e42d86fd424e9fd27f9f0e9d5bce", "body": {"id": "chatcmpl-BwxFIBlVrHzqZhO7nvvNPbcnm5AIx", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    z.oid AS ztf_oid,\n    a.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    a.w1mpro AS W1_magnitude,\n    a.w2mpro AS W2_magnitude,\n    a.w3mpro AS W3_magnitude,\n    a.w4mpro AS W4_magnitude\nFROM \n    object z\nJOIN \n    xmatch x ON z.oid = x.oid\nJOIN \n    allwise a ON x.oid_catalog = a.oid_catalog\nWHERE \n    z.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2718, "completion_tokens": 134, "total_tokens": 2852, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1479fcc81909a3ac494189efaf1", "custom_id": "84-5", "response": {"status_code": 200, "request_id": "332bfd5a6172713cc214d9fff7177b83", "body": {"id": "chatcmpl-BwxFSwvcZaKlbIYM1PxsH7BrHrBMr", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 155, "total_tokens": 3355, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a147afc88190ab1678db369cbec4", "custom_id": "84-6", "response": {"status_code": 200, "request_id": "62e8a75f83f8af9457bd49b4d2d91595", "body": {"id": "chatcmpl-BwxFOI9hvYsLX79rOJlbNnOQ7hlN6", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 155, "total_tokens": 3355, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a147f0e48190a1f061dc4a6a1418", "custom_id": "84-7", "response": {"status_code": 200, "request_id": "1b8f5da6764264478610e8740adae032", "body": {"id": "chatcmpl-BwxFT4WBHUpevWHP5ACicXVUXqIcJ", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    aw.oid_catalog AS wise_catalog_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 135, "total_tokens": 3335, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a147d46081908be72dfc63659ab2", "custom_id": "84-8", "response": {"status_code": 200, "request_id": "f2283739a6981c5a08161500bde90649", "body": {"id": "chatcmpl-BwxFI1HvCQqkvv8RNgcPZZJiVfi8N", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 148, "total_tokens": 3348, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a147ea088190aa854d0dea0243c0", "custom_id": "84-9", "response": {"status_code": 200, "request_id": "901a207423de461cecf8bcf1d9e14583", "body": {"id": "chatcmpl-BwxFI3UKNqZSfyhYV9QFBZumi9aYP", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3200, "completion_tokens": 155, "total_tokens": 3355, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1480dac819091156afa896bb326", "custom_id": "96-0", "response": {"status_code": 200, "request_id": "81d105633f69d310de73a0afdefb8c75", "body": {"id": "chatcmpl-BwxFOShOa5GWliB1nG0Eas4jCYsvR", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra_value1 AS ra, dec_value1 AS dec\n    UNION ALL\n    SELECT '2009UK56', ra_value2, dec_value2\n),\n-- Find objects within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n)\n-- Final output: join with ss_ztf for MPC name and include specified columns\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 270, "total_tokens": 2905, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a148027481908f917ebdaa26a2fc", "custom_id": "96-1", "response": {"status_code": 200, "request_id": "72b886f3d5f676e265898bab1e0833ae", "body": {"id": "chatcmpl-BwxFLJKHrmrAg081XABHZ5fAc1jeM", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find detections within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN sources s ON q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n),\n-- Join with ss_ztf to get solar system info\nss_info AS (\n    SELECT ss.*, nd.candid, nd.mjd, nd.fid, nd.isdiffpos, nd.ra AS detection_ra, nd.dec AS detection_dec, nd.magpsf AS diff_mag, nd.sigmapsf AS mag_uncertainty\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Select required columns and sort\nSELECT\n    ss_info.*\nFROM ss_info\nORDER BY ss_info.ssnamenr, ss_info.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 282, "total_tokens": 2917, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1481ff08190a0978e5f82f66f0b", "custom_id": "96-2", "response": {"status_code": 200, "request_id": "4c29af5feb7ca0d1af0b6c53eb85c139", "body": {"id": "chatcmpl-BwxFI8a57vdc1ptko6GpiISLABgrP", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define a temporary table with the coordinates of the specified solar system objects\nWITH ss_objects AS (\n    SELECT * FROM (\n        VALUES\n            ('2003FP134', 0.0, 0.0), -- Placeholder RA/Dec, replace with actual coordinates if known\n            ('2009UK56', 0.0, 0.0) -- Placeholder RA/Dec, replace with actual coordinates if known\n    ) AS t(name, ra, dec)\n),\n-- Cross-match with ss_ztf to find objects within 2 arcseconds (~0.0005556 degrees)\nmatched_ss AS (\n    SELECT s.*\n    FROM ss_objects s\n    JOIN ss_ztf ON ss_ztf.ssnamenr = s.name\n    WHERE q3c_join(ss_ztf.ssnamenr, ss_ztf.ssnamenr, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for objects associated with the matched solar system objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN matched_ss ON d.oid = matched_ss.oid\n)\n-- Select required columns, including all from ss_ztf and specified detection info, sorted accordingly\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_ztf ss\nJOIN detections d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 349, "total_tokens": 2984, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14820788190b4f83ea07e21c9d1", "custom_id": "96-3", "response": {"status_code": 200, "request_id": "d6b2a570bd8f187926406568959ced24", "body": {"id": "chatcmpl-BwxFS1MlR60VisiUP7rArauheBs6w", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra_value1 AS ra, dec_value1 AS dec\n    UNION ALL\n    SELECT '2009UK56', ra_value2, dec_value2\n),\n-- Select sources within 2 arcseconds (which is 2/3600 degrees)\nnear_sources AS (\n    SELECT s.mpc_name, s.ra, s.dec\n    FROM sources s\n    WHERE EXISTS (\n        SELECT 1\n        FROM q3c_poly_query(s.ra, s.dec, ARRAY[\n            -- Placeholder for the polygon points if needed, or use q3c_radial_query\n        ]) -- Not used here, so proceed with q3c_join\n        WHERE q3c_join(d.ra, d.dec, s.ra, s.dec, 2/3600.0)\n    )\n),\n-- Get all detections for objects near the sources\ndetections AS (\n    SELECT d.*, o.ssnamenr\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    WHERE EXISTS (\n        SELECT 1\n        FROM near_sources ns\n        WHERE q3c_join(d.ra, d.dec, ns.ra, ns.dec, 2/3600.0)\n    )\n)\n-- Select required columns, including from ss_ztf\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 378, "total_tokens": 3013, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1482cd081909bb6b2a685cb4cf5", "custom_id": "96-4", "response": {"status_code": 200, "request_id": "08d807d13ae9098e014b7e1ae9c7bdb0", "body": {"id": "chatcmpl-BwxFP8Kk3hzRpwv4euYZQqFGgnhsF", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra_value1 AS ra, dec_value1 AS dec\n    UNION ALL\n    SELECT '2009UK56', ra_value2, dec_value2\n),\n-- Calculate the angular distance between each detection and the sources\ncandidate_matches AS (\n    SELECT d.*, s.mpc_name, s.ra AS source_ra, s.dec AS source_dec,\n           q3c_dist(d.ra, d.dec, s.ra, s.dec) AS distance_deg\n    FROM detection d\n    JOIN sources s ON TRUE\n)\n-- Select detections within 2 arcseconds (~0.0005556 degrees)\nSELECT\n    ss.oid,\n    ss.candid,\n    ss.ssdistnr,\n    ss.ssmagnr,\n    ss.ssnamenr,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM\n    ss_ztf ss\nJOIN\n    candidate_matches d ON ss.oid = d.oid\nWHERE\n    d.distance_deg <= 2.0 / 3600 -- 2 arcseconds in degrees\nORDER BY\n    ss.ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 287, "total_tokens": 2922, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14850688190bf7c36f38ffdd156", "custom_id": "96-5", "response": {"status_code": 200, "request_id": "25727261f8543577a48df27f235a2550", "body": {"id": "chatcmpl-BwxFRXo7YKvSM2PoXMHV11BsfuagR", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find all objects within 2 arcseconds (which is 2/3600 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 2.0/3600)\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN nearby_objects no ON d.oid = no.oid\n),\n-- Retrieve solar system info for these objects\nss_info AS (\n    SELECT ss.*\n    FROM ss_ztf ss\n    JOIN nearby_objects no ON ss.oid = no.oid\n)\n-- Final select with required columns, sorted by MPC name and detection date\nSELECT\n    ss_info.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_info\nJOIN detections d ON ss_info.oid = d.oid\nORDER BY ss_info.ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 342, "total_tokens": 2977, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1486d6481908cd1be9515a599c4", "custom_id": "96-6", "response": {"status_code": 200, "request_id": "b727a95880b433ec3b809f9d17a822bc", "body": {"id": "chatcmpl-BwxFTHDnjlUvGxrK3sbEXwm9MDf0M", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select sources with their coordinates\nsource_coords AS (\n    SELECT * FROM sources\n),\n-- Find detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s\n      ON q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve ss_ztf info and detection details, sorted by MPC name and detection date\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 345, "total_tokens": 2980, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1486ee88190aa50cc414506a652", "custom_id": "96-7", "response": {"status_code": 200, "request_id": "6c2a84226ff2ea6f6183944554931f59", "body": {"id": "chatcmpl-BwxFIflIGZS94W33oDQazFtFMjrJn", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find detections within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Join with ss_ztf to get solar system info\nss_info AS (\n    SELECT ss.*, nd.mjd AS detection_date, nd.fid, nd.isdiffpos, nd.ra AS detection_ra, nd.dec AS detection_dec, nd.magpsf AS diff_mag, nd.sigmapsf AS diff_mag_err\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Final selection, sorted by MPC name and detection date\nSELECT ss.*, detection_date, fid, isdiffpos, detection_ra, detection_dec, diff_mag, diff_mag_err\nFROM ss_info\nORDER BY ss.ssnamenr, detection_date;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 314, "total_tokens": 2949, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1487f5c8190a87c62645ad80d47", "custom_id": "96-8", "response": {"status_code": 200, "request_id": "3cc5dbd9dd9a53528d8176ff261cc669", "body": {"id": "chatcmpl-BwxFQcCfCnUviIByiT0AY8zksUDqD", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select sources with their coordinates\nsource_coords AS (\n    SELECT mpc_name, ra, dec FROM sources\n),\n-- Find all detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s ON TRUE\n    WHERE q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve required data from ss_ztf and detection tables\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 348, "total_tokens": 2983, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a148a3ac8190840648b23433df29", "custom_id": "96-9", "response": {"status_code": 200, "request_id": "19810cca57725eccea078495a41362f6", "body": {"id": "chatcmpl-BwxFKwLwukLNm7hib5cxBP7osIbU0", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find all objects within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n),\n-- Join with ss_ztf to get MPC names\nss_ztf_with_name AS (\n    SELECT s.*, ss.ssnamenr\n    FROM ss_ztf ss\n    JOIN object o ON ss.oid = o.oid\n)\n-- Final selection and sorting\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf_with_name s\nJOIN detections d ON s.oid = d.oid\nORDER BY ssnamenr, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 340, "total_tokens": 2975, "prompt_tokens_details": {"cached_tokens": 1664, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1489b588190b5202b68e185c470", "custom_id": "67-0", "response": {"status_code": 200, "request_id": "b949eff6eff529899d2a1804ecc6da63", "body": {"id": "chatcmpl-BwxFLp0QSutlmyZkoQ62NqxejulrX", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  AND neargaia <= 1.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2602, "completion_tokens": 82, "total_tokens": 2684, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1489c308190a799feaa1de46c69", "custom_id": "67-1", "response": {"status_code": 200, "request_id": "ca4fd8f2ece9dcaf0e73ab4c2eba2ad8", "body": {"id": "chatcmpl-BwxFQUvQhC6O8CffUbv1Xrex3hfRL", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  AND neargaia <= 1.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2602, "completion_tokens": 82, "total_tokens": 2684, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a148a7808190b2d1368f5a948d29", "custom_id": "67-2", "response": {"status_code": 200, "request_id": "ccf279448956de3fe954ba52294a3329", "body": {"id": "chatcmpl-BwxFKaPlIoDtcSsndWVKfOdnlGTPy", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND -- Filter for Gaia sources within 1.5 arcseconds of the ZTF objects\nneargaia <= 1.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2120, "completion_tokens": 134, "total_tokens": 2254, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a148cf74819095e4bfdb2473fe7d", "custom_id": "67-3", "response": {"status_code": 200, "request_id": "c73e8a6132d48081bbe528668c1d144f", "body": {"id": "chatcmpl-BwxFK51b5gLh5q6elxENb2HFuIU6N", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- List of specific ZTF identifiers\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND neargaia <= 1.5; -- Filter for Gaia sources within 1.5 arcseconds\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2120, "completion_tokens": 138, "total_tokens": 2258, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a148e5d4819092ad83900db767a3", "custom_id": "67-4", "response": {"status_code": 200, "request_id": "ec4d03d99c1699766a7bd55bba2c7266", "body": {"id": "chatcmpl-BwxFNhIqrxGfJQHBn33W27zQEcS7T", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links oid to ZTF identifiers\n        -- If object table does not contain ZTF identifiers, this part needs adjustment based on available schema\n        -- For now, assuming oid matches ZTF identifiers directly\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND (\n    -- Calculate angular distance between the object and Gaia source; check if within 1.5 arcsec\n    q3c_dist(\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n        -- Gaia source coordinates from the gaia_ztf table\n        -- Assuming ra and dec are available in the object table linked by oid\n        -- If not, need to adjust based on actual schema\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid)\n    ) <= 1.5 / 3600 -- Convert arcseconds to degrees\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2120, "completion_tokens": 320, "total_tokens": 2440, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a148eaf081908268b38e4db701d9", "custom_id": "67-5", "response": {"status_code": 200, "request_id": "e86fbed84db9d1ee5142632c362f4919", "body": {"id": "chatcmpl-BwxFRUJ4uWc6FqHsXTdD0ZypdfwIF", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links oid to ZTF identifiers\n        -- If object table does not contain ZTF identifiers, this part needs adjustment based on available schema\n        -- For now, assuming oid can be directly matched to ZTF identifiers\n        -- Otherwise, additional context or tables are needed to map ZTF identifiers to object oids\n        -- Since only gaia_ztf table is provided, assuming oid is directly the ZTF identifier\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND neargaia <= 1.5;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2120, "completion_tokens": 215, "total_tokens": 2335, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a148fec08190937da269c9b18eae", "custom_id": "67-6", "response": {"status_code": 200, "request_id": "041a294f6a4c876a623915ca1db37994", "body": {"id": "chatcmpl-BwxFNmpV1KvP6rMcfYhDXaaruR8KQ", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links ZTF IDs to OIDs\n        -- Since only ZTF IDs are provided, and no direct link in schema, this is a placeholder\n        -- Alternatively, if ZTF IDs are stored in object table, include them here\n        -- For demonstration, assuming object table has a column 'ztf_id' (not specified in schema)\n        -- If not, this part needs to be adjusted based on actual schema\n        'ZTF18acxlskz' -- placeholder, replace with actual method to get OID for each ZTF ID\n        -- Add other ZTF IDs as needed\n    )\n)\nAND neargaia <= 1.5\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2120, "completion_tokens": 223, "total_tokens": 2343, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1491ac88190a0a57c952c08e354", "custom_id": "67-7", "response": {"status_code": 200, "request_id": "1af7d22f70b78531306b956996bb4d9f", "body": {"id": "chatcmpl-BwxFIJAMAD2X7FyQOIhctuXMrfk6k", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE candid IN (\n        -- List of specified ZTF identifiers\n        SELECT candid FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n    )\n)\nAND q3c_join(\n    -- Use q3c_join to check if the Gaia source is within 1.5 arcseconds (converted to degrees)\n    -- 1.5 arcsec = 1.5 / 3600 degrees\n    neargaia,\n    0,\n    (SELECT ra FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    (SELECT dec FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    1.5 / 3600\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2120, "completion_tokens": 269, "total_tokens": 2389, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1491a408190a8f3c50fa801b3af", "custom_id": "67-8", "response": {"status_code": 200, "request_id": "3630e9eca58fa6502dd193880585fc39", "body": {"id": "chatcmpl-BwxFId6l1wuvD7oOAtQV31MaJjri0", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE candid IN (\n        -- List of specified ZTF identifiers\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND q3c_join(\n    -- Use q3c_join to check if the Gaia source is within 1.5 arcseconds (~0.0004167 degrees)\n    -- between Gaia source and the ZTF object coordinates\n    (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n    (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n    -- Coordinates of the Gaia source\n    (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n    (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n    1.5 / 3600.0 -- Convert 1.5 arcseconds to degrees\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2120, "completion_tokens": 261, "total_tokens": 2381, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1492ecc81909f841cc953f59d32", "custom_id": "67-9", "response": {"status_code": 200, "request_id": "a2e3e9d1f32d4358e524413efa0c755a", "body": {"id": "chatcmpl-BwxFMo7b6A0Ine6IGjO1t4GC3QEJN", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links oid to ZTF identifiers\n        -- If object table does not contain ZTF identifiers, this part needs adjustment based on available schema\n        -- For now, assuming oid directly corresponds to ZTF identifiers\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND (\n    -- Calculate the angular distance between the object and Gaia source; check if within 1.5 arcsec\n    q3c_dist(\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n        -- Assuming the Gaia source position is stored elsewhere; since only gaia_ztf table is provided,\n        -- and no position columns are in gaia_ztf, this query cannot be completed as is.\n        -- Alternatively, if the object table contains ra and dec, use those.\n        -- For demonstration, assuming ra and dec are in object table linked by oid:\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid)\n    ) <= 1.5\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2120, "completion_tokens": 346, "total_tokens": 2466, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14921c081909c64db593e74ec00", "custom_id": "55-0", "response": {"status_code": 200, "request_id": "a3531f0432eaedf6cdd53216f7afae5e", "body": {"id": "chatcmpl-BwxFLMuUgSMWb7hb57oGxBDUJMGbj", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14959248190b1b02ea1597dbb42", "custom_id": "55-1", "response": {"status_code": 200, "request_id": "e7210d18a858e2e9ec6cf14b8f20a685", "body": {"id": "chatcmpl-BwxFSAvRXXyQxcifldvdyx3gkacUW", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14961dc819099b44c808b76f0fa", "custom_id": "55-2", "response": {"status_code": 200, "request_id": "ee9f1e34fe08df691e0a5843ba0045ff", "body": {"id": "chatcmpl-BwxFNFvpQciahGjw5rfZWR9fnLtx1", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1496d78819084118870cfbefa05", "custom_id": "55-3", "response": {"status_code": 200, "request_id": "3aa8fa99b6a1a0aa21e93f5d6ab77bee", "body": {"id": "chatcmpl-BwxFODl3yR1DZ5zZIdLoMTDqGKwNz", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1497b4081909a281e9c2248720e", "custom_id": "55-4", "response": {"status_code": 200, "request_id": "63d42ee398ba64242c29c6d0b7ba5911", "body": {"id": "chatcmpl-BwxFOpO2QtVTINeTNQtFSRtOpGhd9", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a149ed088190a0c9f4879ca144a6", "custom_id": "55-5", "response": {"status_code": 200, "request_id": "2880077228f3bfc689070c6892d335ed", "body": {"id": "chatcmpl-BwxFOw6yBDgaWJnral0LowrcfkXFL", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14993708190820188d8fb0a7c61", "custom_id": "55-6", "response": {"status_code": 200, "request_id": "fd034d08633c31ad090ad400d43bf819", "body": {"id": "chatcmpl-BwxFNuPPUDJwxghyxa2y5UCg2XyKh", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1499c7c8190be0fe894d5358c79", "custom_id": "55-7", "response": {"status_code": 200, "request_id": "f630b5823ff5515e21d59aa546c1a9f6", "body": {"id": "chatcmpl-BwxFNR8yHSGaBTy8KBezVQfudxnc1", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a149a62c81909c649bd61d905f78", "custom_id": "55-8", "response": {"status_code": 200, "request_id": "088ade3a2886404fc747b96a291a39b0", "body": {"id": "chatcmpl-BwxFORQkBIBw3iZ639EdRRfEJuJ0S", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a149d5cc819089083c7781217a09", "custom_id": "55-9", "response": {"status_code": 200, "request_id": "c6901c7b1d1581573055e1e342412a8f", "body": {"id": "chatcmpl-BwxFInEr38SZjtsJGA4MkDsNGZiqf", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2343, "completion_tokens": 21, "total_tokens": 2364, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a149e1548190ae16108d8a20503f", "custom_id": "47-0", "response": {"status_code": 200, "request_id": "6453599731c48d7aa35a25ccac9dedfd", "body": {"id": "chatcmpl-BwxFICMMottWXy9jSaPcbY4aA7H0X", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY \n    d.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3142, "completion_tokens": 138, "total_tokens": 3280, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a149ed9c819082581ca566c9299f", "custom_id": "47-1", "response": {"status_code": 200, "request_id": "13065c06f98a29a1eee985cf17179ad4", "body": {"id": "chatcmpl-BwxFQTE8dH9lyrE1OYDhUgXLnnww6", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY \n    d.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3142, "completion_tokens": 138, "total_tokens": 3280, "prompt_tokens_details": {"cached_tokens": 2944, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a149f9f081908e64ce2e06d51f9a", "custom_id": "47-2", "response": {"status_code": 200, "request_id": "c639710560bc82c5be1f1f31c97d22e0", "body": {"id": "chatcmpl-BwxFOiyF0qQihHqdWCAWNbYs4INVP", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2476, "completion_tokens": 171, "total_tokens": 2647, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14a13748190bb45229104be0b2e", "custom_id": "47-3", "response": {"status_code": 200, "request_id": "34566e57939ad96d5221ef13af786432", "body": {"id": "chatcmpl-BwxFS9TCu6MCdIHrhMpW68edVByOu", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2476, "completion_tokens": 177, "total_tokens": 2653, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14a1e7c8190a7dfff4d979b3ad1", "custom_id": "47-4", "response": {"status_code": 200, "request_id": "1bc17382e4a901608eb6d2fd78d58e65", "body": {"id": "chatcmpl-BwxFOD4LQaLfcDn9x7tcELuPkg9jN", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2476, "completion_tokens": 171, "total_tokens": 2647, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14a24788190a95240503825174b", "custom_id": "47-5", "response": {"status_code": 200, "request_id": "776c2c5bfabb56f65f3559e1148f18f7", "body": {"id": "chatcmpl-BwxFImxAFVK85Ov8Nd5ZcJ4nfhIAO", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2476, "completion_tokens": 177, "total_tokens": 2653, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14a5adc81908e0be406f8245713", "custom_id": "47-6", "response": {"status_code": 200, "request_id": "45e6346cc3b742fdc76251a891409a25", "body": {"id": "chatcmpl-BwxFSOYfeGo5gy8FcDBZXB9yFNM3h", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select detections for specified ZTF objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2476, "completion_tokens": 173, "total_tokens": 2649, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14a6e8c819089f81297113f4f1a", "custom_id": "47-7", "response": {"status_code": 200, "request_id": "50d4f294f8a6cfa00c186daa73f6d90c", "body": {"id": "chatcmpl-BwxFP1r6pMazr5VDWK0LEYm2yGjKI", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    detection d\nWHERE\n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    d.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2476, "completion_tokens": 157, "total_tokens": 2633, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14a6e188190a66deef9f8379b26", "custom_id": "47-8", "response": {"status_code": 200, "request_id": "a6312b7f2f77b755a49bf2ad1f9a1c77", "body": {"id": "chatcmpl-BwxFP5VfjAF7RBaYpmoX0wb1zvZTX", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select detections for specified ZTF objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2476, "completion_tokens": 179, "total_tokens": 2655, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14a66dc8190af7f141715d3c560", "custom_id": "47-9", "response": {"status_code": 200, "request_id": "60ff7e2aa73f982c4563f50f5c9e421e", "body": {"id": "chatcmpl-BwxFIuKh8po2O6M0wxjlL8RCD2Jms", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    ZTF,\n    detection_date;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2476, "completion_tokens": 169, "total_tokens": 2645, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14a79c88190bdc366da0a4fb81e", "custom_id": "79-0", "response": {"status_code": 200, "request_id": "904f7d709e5e82a1dad62255ae3d9715", "body": {"id": "chatcmpl-BwxFNsN9B6Gq8pshOtWcjxypGfP3Z", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 48, "total_tokens": 2039, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14aa5288190a07669268c1a0c1d", "custom_id": "79-1", "response": {"status_code": 200, "request_id": "9f0cc47b8e26ed9906f7431c002f2dc1", "body": {"id": "chatcmpl-BwxFTvqcjs96Tfj8wv78PqOBlMu6Z", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 44, "total_tokens": 2035, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14aa26081909591b0bbfc26b55a", "custom_id": "79-2", "response": {"status_code": 200, "request_id": "16ac6112438ce08f8394f4385c687461", "body": {"id": "chatcmpl-BwxFI7tHQjG6pplKIxzswj8wZn95M", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 48, "total_tokens": 2039, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14aa9d88190994e3396da613705", "custom_id": "79-3", "response": {"status_code": 200, "request_id": "525b344942ffa2c4ed361b2b11b569cb", "body": {"id": "chatcmpl-BwxFION73UONN54LZZAdZ88bzKHDw", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 48, "total_tokens": 2039, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14ad70081909c711a6a9ee7bc1f", "custom_id": "79-4", "response": {"status_code": 200, "request_id": "c3ff153a87a5ddfa2eb347f6d0703b5e", "body": {"id": "chatcmpl-BwxFN8CtYfOpCraXIW5y83FDP1ulg", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT catid, oid_catalog, dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 24, "total_tokens": 2015, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14aeafc81908ccbb5256ed55a77", "custom_id": "79-5", "response": {"status_code": 200, "request_id": "f38b64218229d06e28002b64602e0c80", "body": {"id": "chatcmpl-BwxFPBnu3TLxwNugbVi90274e8Rob", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 48, "total_tokens": 2039, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14af1d0819083a0e6d30859c53f", "custom_id": "79-6", "response": {"status_code": 200, "request_id": "edcce5e32c7777c91d4c9d92bdf48a66", "body": {"id": "chatcmpl-BwxFRtThVJrTr9SQvXp9rIlbLtS3i", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 48, "total_tokens": 2039, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14ae9e08190b1efb9a73b056d7a", "custom_id": "79-7", "response": {"status_code": 200, "request_id": "e758d463da229496101bada4cbf8e8ee", "body": {"id": "chatcmpl-BwxFIAFql6KOsCTB81qeZdczRatQ8", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 48, "total_tokens": 2039, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14af9648190995c663c9a716a40", "custom_id": "79-8", "response": {"status_code": 200, "request_id": "dd7a121aa539feee95a2fedbd8bb56cc", "body": {"id": "chatcmpl-BwxFIgk7ZL7IdnHyQYLPN7MQX7BgE", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 48, "total_tokens": 2039, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b2acc8190b3d35949dad3dad0", "custom_id": "79-9", "response": {"status_code": 200, "request_id": "46af5ab3b8f6c6e1914bc1d4dd28b21a", "body": {"id": "chatcmpl-BwxFRRCN19BpRod303PISLr880xFO", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1991, "completion_tokens": 44, "total_tokens": 2035, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b210c819090c6f1c403049a23", "custom_id": "94-0", "response": {"status_code": 200, "request_id": "ed77b85f365d8ac7f521f20251079931", "body": {"id": "chatcmpl-BwxFKorVAonaEqNDtRqOz9JBXmzrN", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 57, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b252c8190965da7bc819d1810", "custom_id": "94-1", "response": {"status_code": 200, "request_id": "65eed74209475901f53c73aaa2c3dc91", "body": {"id": "chatcmpl-BwxFLmvVgpBtyay8fhjfaLYk2U0T4", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 57, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b6db08190b0dd83bbcc51a7f2", "custom_id": "94-2", "response": {"status_code": 200, "request_id": "6d7658b88743624025983194504bebb6", "body": {"id": "chatcmpl-BwxFQrqZ1MXSMwlo7lE3j3176OMBL", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 57, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b84e0819088dbdd5bb039f8c0", "custom_id": "94-3", "response": {"status_code": 200, "request_id": "75ab6bf60b4bcad6ec3cabcd190b4b37", "body": {"id": "chatcmpl-BwxFSLClclNpPwVUcLPcoNIK86tYd", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 57, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b65cc8190bb296d91e0a20bb5", "custom_id": "94-4", "response": {"status_code": 200, "request_id": "799e5c70f66932a5e1d643a68c613623", "body": {"id": "chatcmpl-BwxFI2L6QrLnbWtiPgsGyHIgSYyHe", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 57, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b7e348190a48289ee0d277dac", "custom_id": "94-5", "response": {"status_code": 200, "request_id": "133032a0066dde26c24fcef9d9767348", "body": {"id": "chatcmpl-BwxFRw1Uh3In4apKKdZepeDJb9TrR", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 57, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b7b2881908e30aa1150fc9478", "custom_id": "94-6", "response": {"status_code": 200, "request_id": "b5392f62952de0507ed60c6c07700a3e", "body": {"id": "chatcmpl-BwxFLT4JZDKjMYSRCwVaH80MxEQ55", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a reference change\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 56, "total_tokens": 2777, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b9d2c8190bfdad7554fc92418", "custom_id": "94-7", "response": {"status_code": 200, "request_id": "a09ab90af2d0e9121e618517de22bdb8", "body": {"id": "chatcmpl-BwxFSVJa1RXjCNRJssCkYVlPXTn87", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 57, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14b9cb48190a9b4adec742a2059", "custom_id": "94-8", "response": {"status_code": 200, "request_id": "aa35d1dc72d929136a43d4d935878d9b", "body": {"id": "chatcmpl-BwxFMl4tNgppc5iCPfLfG1cItIPf8", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.oid IN (\n    -- Subquery to find objects with a change in reference\n    SELECT r1.oid\n    FROM reference r1\n    JOIN reference r2 ON r1.oid = r2.oid\n    WHERE r1.rfid <> r2.rfid\n)\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 111, "total_tokens": 2832, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14bbb3c8190be5d5a56146e2b8b", "custom_id": "94-9", "response": {"status_code": 200, "request_id": "987c6c1148b3446fac0ebee8170a073d", "body": {"id": "chatcmpl-BwxFL6QLKyv7e9uVthBNJjWVfOaVi", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 57, "total_tokens": 2778, "prompt_tokens_details": {"cached_tokens": 2560, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14bf0cc81909a2dbf3eab0af2d2", "custom_id": "90-0", "response": {"status_code": 200, "request_id": "a6626261a4e280572e533f3b4f719e0d", "body": {"id": "chatcmpl-BwxFKeMJFuGzB3RjvINWuvbOySSjI", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days and top 2 rankings for the light curve classifier\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = 'feature_version' -- Replace with actual version if known\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for the selected objects, classifier 'lc_classifier', and rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5054, "completion_tokens": 179, "total_tokens": 5233, "prompt_tokens_details": {"cached_tokens": 4480, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14bf3ac819089ebb0b9587fcb7f", "custom_id": "90-1", "response": {"status_code": 200, "request_id": "7c2f77604f3b51886c02c62f0978e37c", "body": {"id": "chatcmpl-BwxFSYOXmOwouvKGX48rMzvZspBg8", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days and probabilities for top 2 rankings\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5054, "completion_tokens": 149, "total_tokens": 5203, "prompt_tokens_details": {"cached_tokens": 4608, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c00048190aea293157c9b0716", "custom_id": "90-2", "response": {"status_code": 200, "request_id": "f317ebd59337fdc4a0ca9340b2329b9b", "body": {"id": "chatcmpl-BwxFMg2mF2HYitdPsxGpqX0qYANXW", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for the selected objects, classifier 'lc_classifier', with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5132, "completion_tokens": 165, "total_tokens": 5297, "prompt_tokens_details": {"cached_tokens": 4992, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14bf8d881909cbc509978433795", "custom_id": "90-3", "response": {"status_code": 200, "request_id": "1fc9f7fea2f7ea5357d2c5666eb2e4d6", "body": {"id": "chatcmpl-BwxFPtzh1o3juL5VaA54swvzv4Gdw", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5132, "completion_tokens": 163, "total_tokens": 5295, "prompt_tokens_details": {"cached_tokens": 4992, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14bfdbc8190932e3b3cda6c4b93", "custom_id": "90-4", "response": {"status_code": 200, "request_id": "0319932d27669ce72dd189bd6f8061a9", "body": {"id": "chatcmpl-BwxFMyiA7Vt5gwxsvImWCganRLnvz", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for objects in selected_objects with classifier 'lc_classifier' and ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5132, "completion_tokens": 166, "total_tokens": 5298, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c16dc8190b6775bac8a042ba2", "custom_id": "90-5", "response": {"status_code": 200, "request_id": "488712f7d094b9dca75d56ffb59b9c22", "body": {"id": "chatcmpl-BwxFI6MB82O9ijT9GvqqecFQGBrls", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5132, "completion_tokens": 163, "total_tokens": 5295, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c1d34819085d0997ec7ff40ec", "custom_id": "90-6", "response": {"status_code": 200, "request_id": "cce83641675999ed0b8db0272b97ba35", "body": {"id": "chatcmpl-BwxFLizSZh3ej8fL2uDzudjppxfjA", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5132, "completion_tokens": 164, "total_tokens": 5296, "prompt_tokens_details": {"cached_tokens": 4992, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c438081909de1faa8e34b37f9", "custom_id": "90-7", "response": {"status_code": 200, "request_id": "8adda0fe8fa2af8a99a84bb5103442e9", "body": {"id": "chatcmpl-BwxFMEwzEWYvTqMYMkphwGhlkmkLi", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5132, "completion_tokens": 164, "total_tokens": 5296, "prompt_tokens_details": {"cached_tokens": 4608, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c7a0c8190b0c7ff8806b22941", "custom_id": "90-8", "response": {"status_code": 200, "request_id": "e25393655f2a3df9a49ebbd8b6f28cb9", "body": {"id": "chatcmpl-BwxFMs77SfE2hjm7kbvBEIdSkHHCd", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for objects with top 2 rankings in the light curve classifier\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5132, "completion_tokens": 160, "total_tokens": 5292, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c75ec8190bf899712f83808f9", "custom_id": "90-9", "response": {"status_code": 200, "request_id": "a361fc1025a9da314bb014db4313cf67", "body": {"id": "chatcmpl-BwxFOXJFGVZwsIdTQTTFJyo5KfUAm", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for the selected objects, classifier 'lc_classifier', with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5132, "completion_tokens": 165, "total_tokens": 5297, "prompt_tokens_details": {"cached_tokens": 4992, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c7c208190862825859ec385c4", "custom_id": "51-0", "response": {"status_code": 200, "request_id": "f5c2590fbad0ec9b6f747473c1c37fec", "body": {"id": "chatcmpl-BwxFK7QVbpSa7Px3Ew5qSvK8Mj0DC", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 112, "total_tokens": 2701, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c7de881908487b06915882e2d", "custom_id": "51-1", "response": {"status_code": 200, "request_id": "a8a90ceaab54bd8b6f80669f222a863e", "body": {"id": "chatcmpl-BwxFImV4dbOCldojWxl02GaqfxmnJ", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 112, "total_tokens": 2701, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c779481908e88d882a04f3f04", "custom_id": "51-2", "response": {"status_code": 200, "request_id": "6a2da51d4859b3ce96820b809618d87d", "body": {"id": "chatcmpl-BwxFNAn6OzFfyImuJnWje6IbdYnli", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 112, "total_tokens": 2701, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c95fc819083a0177ad0d4ed0a", "custom_id": "51-3", "response": {"status_code": 200, "request_id": "c2edb9c70611fed0b027cceb8fbe0cb1", "body": {"id": "chatcmpl-BwxFPG1ihtP1fEtSVCHl2ZxbbEB6f", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 112, "total_tokens": 2701, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14c9bfc8190830ef3651dc07f71", "custom_id": "51-4", "response": {"status_code": 200, "request_id": "2fdbcb45b47c3386cdba0b14fc61474b", "body": {"id": "chatcmpl-BwxFLFVEimfd2rXhP8RZQiUBJAuIb", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 112, "total_tokens": 2701, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14cc1408190bed3c612c3a23408", "custom_id": "51-5", "response": {"status_code": 200, "request_id": "7530a74b980dea4164b95ecf94c5729c", "body": {"id": "chatcmpl-BwxFKhwyQF2LRo5UPDXrSqgzLWI3h", "object": "chat.completion", "created": 1753390466, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from forced_photometry for object 'ZTF24aaiutyh', sorted by date (mjd)\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 116, "total_tokens": 2705, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d026c819084109574fe99f299", "custom_id": "51-6", "response": {"status_code": 200, "request_id": "8b9c75e90f4993645c3038a5fa2ccc42", "body": {"id": "chatcmpl-BwxFOCriNemCzoj1GxuFsqle9uA8P", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 109, "total_tokens": 2698, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14cf0b081908845fc4c083155b8", "custom_id": "51-7", "response": {"status_code": 200, "request_id": "8a494ed8c9badf9c46376ca6faff91e3", "body": {"id": "chatcmpl-BwxFP7824SCvMlSM8BuyQE4wUDyUu", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 112, "total_tokens": 2701, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14cf12c81909a42eae16bf0fdca", "custom_id": "51-8", "response": {"status_code": 200, "request_id": "8f4dda0ac0ba349c6c2ff3ef82297b41", "body": {"id": "chatcmpl-BwxFJV81Y3UaSq4MOcTPO70WZFha2", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT \n    oid,\n    mjd AS date,\n    fid,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 82, "total_tokens": 2671, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d075c81909910c59c23ca3e3f", "custom_id": "51-9", "response": {"status_code": 200, "request_id": "f0c57cc336b550b28136d395a882f3c8", "body": {"id": "chatcmpl-BwxFPZ7zTrbhL5f0hYODF9kUCnbSC", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2589, "completion_tokens": 112, "total_tokens": 2701, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14cfc70819090ecb6e0c7c00e1b", "custom_id": "59-0", "response": {"status_code": 200, "request_id": "6f8b284707016e54a3ad920622eb2b30", "body": {"id": "chatcmpl-BwxFQzcsjv765JN7pL4KY7EKp3I4x", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 56, "total_tokens": 2653, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d164c81908fc7eeea888fb772", "custom_id": "59-1", "response": {"status_code": 200, "request_id": "bb35fc412c490532e6d0ba6304f86961", "body": {"id": "chatcmpl-BwxFMnxezSGFreWpS0UifFTHO8ax2", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 60, "total_tokens": 2657, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d214c8190a4a15c9ca893a7df", "custom_id": "59-2", "response": {"status_code": 200, "request_id": "6d458a442296ba4315231c02eaf4c601", "body": {"id": "chatcmpl-BwxFPRN197V76CVB9K7jdSBuDPx8d", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 56, "total_tokens": 2653, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d3a3c8190be7802cb923a65f4", "custom_id": "59-3", "response": {"status_code": 200, "request_id": "2ba99d1877ab87e25dd883ef1f9f6eb3", "body": {"id": "chatcmpl-BwxFMpMNsTwG0IZeAWDzbFNa8XVIw", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 60, "total_tokens": 2657, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d9b8c81909cece4a426e9d189", "custom_id": "59-4", "response": {"status_code": 200, "request_id": "62e870fbad71509109b54f3bb578b904", "body": {"id": "chatcmpl-BwxFPtPTRXbO6ETqFzpzzwS5PRwQc", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 60, "total_tokens": 2657, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d68788190bcfc9c6014368256", "custom_id": "59-5", "response": {"status_code": 200, "request_id": "8cd4b96c48290871553d201b4b67bc99", "body": {"id": "chatcmpl-BwxFReganvX9cLrwX10GjfY2mi3gN", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 52, "total_tokens": 2649, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d75bc8190b84520cbd161782d", "custom_id": "59-6", "response": {"status_code": 200, "request_id": "f7d58ce5ed09ebe3924deccaa65259de", "body": {"id": "chatcmpl-BwxFQ5HzIfQ068NaJNTkNsTKgo37P", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 60, "total_tokens": 2657, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e35e08190a779155ddf8769c7", "custom_id": "59-7", "response": {"status_code": 200, "request_id": "7e615634bcfe064d87185b91a92e6277", "body": {"id": "chatcmpl-BwxFSofSMzqSOvCG0YUN0BDknOs9R", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 60, "total_tokens": 2657, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d96cc8190b4df1b30b77c5418", "custom_id": "59-8", "response": {"status_code": 200, "request_id": "7a49c4ca32f2cc27387ed74679b24495", "body": {"id": "chatcmpl-BwxUDmPXnvYhl8s8UmbkaWFT00q7p", "object": "chat.completion", "created": 1753391389, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 60, "total_tokens": 2657, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d97c08190be6263b0acd9536b", "custom_id": "59-9", "response": {"status_code": 200, "request_id": "31f8c8418a45e75f04af0883fb64a4e8", "body": {"id": "chatcmpl-BwxFQUDrF4fbcNIUaoeIXRPWPi74A", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2597, "completion_tokens": 60, "total_tokens": 2657, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14d9d6881909978f09db1974e24", "custom_id": "100-0", "response": {"status_code": 200, "request_id": "65278c2b4bbc8e2931249148ba2e53dc", "body": {"id": "chatcmpl-BwxFQFZT7hdkSxpy72N5XrqaxP2tI", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    mag AS diffmag,\n    e_mag AS diffmag_err,\n    NULL AS diffmaglim,\n    mag_corr,\n    e_mag_corr AS mag_corr_err\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 307, "total_tokens": 3602, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14dd1cc819083e827400e59c68a", "custom_id": "100-1", "response": {"status_code": 200, "request_id": "5b7bf6b17e20cea12fe36b2a712ce104", "body": {"id": "chatcmpl-BwxFOuZJ00ZZdsU15N9ECgj3VyI7u", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detections for the object\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS magerr,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS magerr_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS magerr,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS magerr_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  mag AS diffmag,\n  e_mag AS magerr,\n  NULL AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS magerr_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 306, "total_tokens": 3601, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e784c81908ba2a8d08243fb96", "custom_id": "100-2", "response": {"status_code": 200, "request_id": "47fe5f41b5391d621c54d3dbc650493e", "body": {"id": "chatcmpl-BwxFRvzT0DzLetE3BrzjSeMshrNWv", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_uncertainty,\n    NULL AS diffmaglim,\n    mag_corr AS magpsf_corr,\n    e_mag_corr AS mag_corr_uncertainty\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 323, "total_tokens": 3618, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14dee5481909be4bc316088a1d0", "custom_id": "100-3", "response": {"status_code": 200, "request_id": "93be0ee7313841cec8c246d90141a64f", "body": {"id": "chatcmpl-BwxFQkgzCGhrjWSiFxCIjQVtakSsr", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 376, "total_tokens": 3671, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e16748190a2aba836d3a6b44f", "custom_id": "100-4", "response": {"status_code": 200, "request_id": "fdd0cb5078f500b58813e28e45a02921", "body": {"id": "chatcmpl-BwxFRPhJa0w7tbsFJLpQtYbkBLRvO", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  diffmaglim,\n  mag_corr,\n  e_mag_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 322, "total_tokens": 3617, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e9820819088f650ed3336b95e", "custom_id": "100-5", "response": {"status_code": 200, "request_id": "274992ce092d9914d6e78f121d782b53", "body": {"id": "chatcmpl-BwxFSiqX67yevTaePpzlwCVjIqj0J", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS candid,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        NULL AS mag_limit,\n        mag AS mag_corr,\n        e_mag AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 335, "total_tokens": 3630, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e2068819085bf362f54b042bd", "custom_id": "100-6", "response": {"status_code": 200, "request_id": "c0319619e4891d0084e301915ef05e4f", "body": {"id": "chatcmpl-BwxFIMM4hqq2KYTcPTyHsoD2hPB1z", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS candid,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 379, "total_tokens": 3674, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e1544819094adff898ccb8bdc", "custom_id": "100-7", "response": {"status_code": 200, "request_id": "2247f6756bbd6c518f4872e6b43f8e37", "body": {"id": "chatcmpl-BwxFPlffoUblE0OBlP72TUPsEVeiZ", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detections for the specified object\nSELECT\n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the specified object\nSELECT\n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the specified object\nSELECT\n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    NULL AS diffmaglim,\n    mag AS magpsf_corr,\n    e_mag AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 312, "total_tokens": 3607, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e4ee08190a974f9a055250bbb", "custom_id": "100-8", "response": {"status_code": 200, "request_id": "63cef63ac125d054feceb6a7d3ae25da", "body": {"id": "chatcmpl-BwxFLtVP0stwxtq6ZLTEWLvh2VsRz", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "WITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS candid,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 334, "total_tokens": 3629, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e82208190a3abdcafe7ab34b8", "custom_id": "100-9", "response": {"status_code": 200, "request_id": "b3b1d7d47a226a9c9e02f42cd86063a2", "body": {"id": "chatcmpl-BwxFQSG3po4LuxpVS5W8jROnJFcuu", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  NULL AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3295, "completion_tokens": 336, "total_tokens": 3631, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e90d8819083c3b5591f768e91", "custom_id": "106-0", "response": {"status_code": 200, "request_id": "9b801766976adeaa2d2b347a275a3374", "body": {"id": "chatcmpl-BwxFLfwnxsmCGyBVhoQgTP8VjG3YC", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'bogus'\n              AND p.classifier_name = 'stamp_classifier_1.0.4'\n              AND p.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'Transient'\n              AND p.classifier_name = 'lc_classifier_top'\n              AND p.probability > 0.9\n        )\n),\nbogus_probs AS (\n    SELECT\n        oid,\n        probability AS prob_stamp_bogus\n    FROM probability\n    WHERE\n        class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier_1.0.4'\n        AND probability > 0.7\n),\ntransient_probs AS (\n    SELECT\n        oid,\n        probability AS prob_lc_transient\n    FROM probability\n    WHERE\n        class_name = 'Transient'\n        AND classifier_name = 'lc_classifier_top'\n        AND probability > 0.9\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    bp.prob_stamp_bogus AS \"prob_stamp_bogus\",\n    tp.prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects o\nJOIN\n    bogus_probs bp ON o.oid = bp.oid\nJOIN\n    transient_probs tp ON o.oid = tp.oid\nORDER BY\n    \"prob_stamp_bogus\" DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2647, "completion_tokens": 431, "total_tokens": 3078, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e954c8190ae52327ef6f480af", "custom_id": "106-1", "response": {"status_code": 200, "request_id": "dd04af97a36dc6fb8f396587624ca33e", "body": {"id": "chatcmpl-BwxFMMwyyk8TdCM6Jazeacsy1GE7U", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select at most 30 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    -- Retrieve the probability of being bogus from the stamp classifier\n    JOIN\n        (SELECT oid, probability\n         FROM probability\n         WHERE classifier_name = 'stamp_classifier_1.0.4'\n           AND class_name = 'bogus'\n           AND ranking = 1\n           AND probability > 0.7\n        ) p_stamp ON o.oid = p_stamp.oid\n    -- Retrieve the probability of being transient from the top-level LC classifier\n    JOIN\n        (SELECT oid, probability\n         FROM probability\n         WHERE classifier_name = 'lc_classifier'\n           AND class_name = 'Transient'\n           AND ranking = 1\n           AND probability > 0.9\n        ) p_top ON o.oid = p_top.oid\n    WHERE\n        o.ndet > 10\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2647, "completion_tokens": 320, "total_tokens": 2967, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14e9f248190bcdee31d521598ce", "custom_id": "106-2", "response": {"status_code": 200, "request_id": "fde26de8df284d871594fca87e8e4e24", "body": {"id": "chatcmpl-BwxFR9LjVgMdO1cwrGKGrfqgeCMFY", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest or default top level\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2725, "completion_tokens": 340, "total_tokens": 3065, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14eae488190ac349e5f1f0d9b2e", "custom_id": "106-3", "response": {"status_code": 200, "request_id": "0a7d40809ebf45d29f9d162afa6c22ea", "body": {"id": "chatcmpl-BwxFO0PBEIPM2OODbjwY9FnjwgIRk", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'bogus'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'Transient'\n                AND p.classifier_name = 'lc_classifier_top'\n                AND p.probability > 0.9\n        )\n),\nranked_objects AS (\n    SELECT\n        so.*,\n        ROW_NUMBER() OVER (ORDER BY so.prob_stamp_bogus DESC) AS rn\n    FROM\n        selected_objects so\n    WHERE\n        so.prob_stamp_bogus > 0.7\n        AND so.prob_lc_transient > 0.9\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"ZTF identifier\";\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2647, "completion_tokens": 366, "total_tokens": 3013, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14ec81c81909af65c9e63f26686", "custom_id": "106-4", "response": {"status_code": 200, "request_id": "ebb81b59b83250ecba5235793f79b251", "body": {"id": "chatcmpl-BwxFPoMrlmMh7q5lnPx4ijgTdsUoY", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest or default top level classifier\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2725, "completion_tokens": 341, "total_tokens": 3066, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14ef360819095c89e06d2c14485", "custom_id": "106-5", "response": {"status_code": 200, "request_id": "834c852523010abe1007ff9698584e94", "body": {"id": "chatcmpl-BwxFOXh9TH4mHUTYIv1PASx5l57Bo", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier_1.0.4'\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier_top'\n                AND p_top.probability > 0.9\n        )\n),\nbogus_objects AS (\n    SELECT\n        oid\n    FROM\n        probability\n    WHERE\n        class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier_1.0.4'\n        AND probability > 0.7\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.prob_stamp_bogus,\n    o.prob_lc_transient\nFROM\n    selected_objects o\nWHERE\n    o.oid IN (SELECT oid FROM bogus_objects)\nORDER BY\n    o.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2647, "completion_tokens": 349, "total_tokens": 2996, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14efd0081909131d958b9093974", "custom_id": "106-6", "response": {"status_code": 200, "request_id": "dd5d505761c33e1bcd9490b8a180256b", "body": {"id": "chatcmpl-BwxFPkZkvyU44QXEsGLuE8HdpwlPf", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n),\nprobabilities_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'bogus'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n        AND p.oid IN (SELECT oid FROM object_filtered)\n),\nlc_probabilities AS (\n    SELECT\n        p.oid,\n        p.probability AS prob_lc_transient\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier_top'\n        AND p.class_name = 'Transient'\n        AND p.ranking = 1\n        AND p.probability > 0.9\n        AND p.oid IN (SELECT oid FROM object_filtered)\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    to_char(to_timestamp(o.firstmjd * 86400), 'YYYY-MM-DD') AS \"first detection date\",\n    p.probability AS \"prob_stamp_bogus\",\n    lc.prob_lc_transient\nFROM\n    object_filtered o\nJOIN\n    probabilities_filtered p ON o.oid = p.oid\nJOIN\n    lc_probabilities lc ON o.oid = lc.oid\nORDER BY\n    p.oid\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2725, "completion_tokens": 357, "total_tokens": 3082, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f10748190bc29383616ef10cb", "custom_id": "106-7", "response": {"status_code": 200, "request_id": "f8fbaeda979c34a9d6349bed4d0179c0", "body": {"id": "chatcmpl-BwxFS8gteU15VE7z2w7LgSJXiZjyR", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest version if not specified\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2647, "completion_tokens": 340, "total_tokens": 2987, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f162481908b0b05a5c1bbc42a", "custom_id": "106-8", "response": {"status_code": 200, "request_id": "1f8d345c221a6396c8200a746bc248f5", "body": {"id": "chatcmpl-BwxFILn5GQDkFM9ldureljnJL2vr0", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest version if not specified\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2647, "completion_tokens": 340, "total_tokens": 2987, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f18888190a8ab8da8f7adae2d", "custom_id": "106-9", "response": {"status_code": 200, "request_id": "63eb230ffb46c708bb11f3bc2a1c357e", "body": {"id": "chatcmpl-BwxFT06yqDUZ55NXjJBQVdt0xWj1y", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier_1.0.4'\n                AND p_stamp.probability > 0.7\n                AND p_stamp.ranking = 1\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.probability > 0.9\n                AND p_top.ranking = 1\n        )\n),\nranked_objects AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (ORDER BY prob_stamp_bogus DESC, oid) AS rn\n    FROM selected_objects\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"prob_stamp_bogus\" DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2647, "completion_tokens": 351, "total_tokens": 2998, "prompt_tokens_details": {"cached_tokens": 2048, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f1c3481908b6722033140842f", "custom_id": "56-0", "response": {"status_code": 200, "request_id": "7e1a573dd7fe83cacbf4c03bd94798d4", "body": {"id": "chatcmpl-BwxFRcE9EBSNWXXhaBzdHBbewl8EI", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    (g_r_mean - g_r_max) AS \"diff between mean g- and r-band difference magnitudes\",\n    (g_r_mean_corr - g_r_max_corr) AS \"diff between mean g- and r-band corrected magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 5408, "completion_tokens": 154, "total_tokens": 5562, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f25388190a35042ea128eb03f", "custom_id": "56-1", "response": {"status_code": 200, "request_id": "b7254288b86a038d34f335d12a93e129", "body": {"id": "chatcmpl-BwxFTCilDj6KlxbfiAHsYLyqfnJZ9", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"diff between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"diff between max g- and r-band difference magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2429, "completion_tokens": 158, "total_tokens": 2587, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f43c48190bf53433b1ffd3053", "custom_id": "56-2", "response": {"status_code": 200, "request_id": "3bec6b49808e5b8841f0630114316b9f", "body": {"id": "chatcmpl-BwxFIkyno7NX2hXivYUS7XLRPohi5", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_max AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_mean_corr - g_r_max_corr AS \"difference between mean g- and r-band corrected magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2429, "completion_tokens": 168, "total_tokens": 2597, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f7014819086d45bb9ac54153b", "custom_id": "56-3", "response": {"status_code": 200, "request_id": "d38d4b15a39cee0580c09105be6633c1", "body": {"id": "chatcmpl-BwxFTfyPFrlqYUQ40lK3EWr0kSjiZ", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.meanra AS \"mean RA\",\n    o.meandec AS \"mean Dec\",\n    o.firstmjd AS \"dates of first detection\",\n    o.lastmjd AS \"dates of last detection\",\n    ( \n        (SELECT magmean FROM magstat WHERE oid = o.oid AND fid = 1) - \n        (SELECT magmean FROM magstat WHERE oid = o.oid AND fid = 2)\n    ) AS \"mean g - r difference\",\n    ( \n        (SELECT magmean_corr FROM magstat WHERE oid = o.oid AND fid = 1) - \n        (SELECT magmean_corr FROM magstat WHERE oid = o.oid AND fid = 2)\n    ) AS \"mean g - r corrected difference\"\nFROM \n    object o\nWHERE \n    o.oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND NOT EXISTS (\n        SELECT 1 FROM magstat m\n        WHERE m.oid = o.oid AND m.corrected = TRUE\n    )\nORDER BY \n    o.firstmjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4386, "completion_tokens": 262, "total_tokens": 4648, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f7bbc81909578dc4ca482d361", "custom_id": "56-4", "response": {"status_code": 200, "request_id": "521a04e30bdf4693625d45be3e55b781", "body": {"id": "chatcmpl-BwxFUL9t78SrZSjwDL9WWlRbQcSVf", "object": "chat.completion", "created": 1753390476, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"difference between max g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2429, "completion_tokens": 158, "total_tokens": 2587, "prompt_tokens_details": {"cached_tokens": 2304, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f8ae08190a769b3c08e4d822d", "custom_id": "56-5", "response": {"status_code": 200, "request_id": "160db63837b5a6c47c5f9d87f20370b9", "body": {"id": "chatcmpl-BwxFTTxwYvhQctnKeyFBPy3W0vTaL", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"difference between max g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2429, "completion_tokens": 158, "total_tokens": 2587, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f9384819092f377401cb7726d", "custom_id": "56-6", "response": {"status_code": 200, "request_id": "57c2346b821ee3b221ae1b72b994cda3", "body": {"id": "chatcmpl-BwxFWU7iazOa9jx18L94MofjDyoPw", "object": "chat.completion", "created": 1753390478, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"difference between max g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2429, "completion_tokens": 158, "total_tokens": 2587, "prompt_tokens_details": {"cached_tokens": 2176, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f9a6c8190a35480a8e081d914", "custom_id": "56-7", "response": {"status_code": 200, "request_id": "58cd7d3e1d567d7539eeb11e8f79afac", "body": {"id": "chatcmpl-BwxFUJ3ZEXgX3hS1POIefrC8ZZtj1", "object": "chat.completion", "created": 1753390476, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    -- Calculate the difference between mean g-r difference magnitude and mean g-r corrected magnitude\n    (g_r_mean - g_r_mean_corr) AS \"diff between mean g-r and corrected g-r\"\nFROM object\n-- Filter for specific ZTF identifiers and where corrected light curve was not computed\nWHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n  AND corrected = FALSE\n-- Order results by date of first detection\nORDER BY firstmjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6177, "completion_tokens": 186, "total_tokens": 6363, "prompt_tokens_details": {"cached_tokens": 3200, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14f94f08190865bade08d438142", "custom_id": "56-8", "response": {"status_code": 200, "request_id": "287974d588f83c736eb39a7d0f39e2e5", "body": {"id": "chatcmpl-BwxFIaw0yOZCsihHpkHnx6X9mHnmf", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    (g_r_mean - g_r_mean_corr) AS \"diff between mean g- and r-band difference magnitudes\",\n    (g_r_max - g_r_max_corr) AS \"diff between max g- and r-band difference magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6125, "completion_tokens": 154, "total_tokens": 6279, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14fadb48190b4ad877a9716bbdf", "custom_id": "56-9", "response": {"status_code": 200, "request_id": "be8a944cb1b6e0d677b04d7bf75cbc2a", "body": {"id": "chatcmpl-BwxFIDFtvQhfaWsEWuGnV8IIIRa6w", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"Number of detections\",\n    meanra AS \"Mean RA\",\n    meandec AS \"Mean Dec\",\n    firstmjd AS \"First detection date\",\n    lastmjd AS \"Last detection date\",\n    (g_r_mean - g_r_max) AS \"Difference between mean g- and r-band difference magnitudes\",\n    (g_r_mean_corr - g_r_max_corr) AS \"Difference between mean g- and r-band corrected magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 6177, "completion_tokens": 170, "total_tokens": 6347, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14fbe0481909992901d4b510e91", "custom_id": "48-0", "response": {"status_code": 200, "request_id": "906fff8595ed339d8baec59adbd104d4", "body": {"id": "chatcmpl-BwxFIJft7E5D7lQKq6ZKzx6VoCwaF", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, \n    f.fid, \n    f.version;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4851, "completion_tokens": 86, "total_tokens": 4937, "prompt_tokens_details": {"cached_tokens": 4352, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14fe9c08190b7d4b89942e0235f", "custom_id": "48-1", "response": {"status_code": 200, "request_id": "6b5a557e68f50a47c41f5a0049652cd2", "body": {"id": "chatcmpl-BwxFLrq5PF8TSn8gdpuON37hbwjBI", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4851, "completion_tokens": 82, "total_tokens": 4933, "prompt_tokens_details": {"cached_tokens": 4352, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a14ffaec8190aa458b7d6fbe5f5b", "custom_id": "48-2", "response": {"status_code": 200, "request_id": "fa59bece07ca45c3d58639a2be69c129", "body": {"id": "chatcmpl-BwxFIBd4pTgdwZ8v0musJdcPtpGbV", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "SELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4851, "completion_tokens": 78, "total_tokens": 4929, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15004f48190ab0a6f208246fd34", "custom_id": "48-3", "response": {"status_code": 200, "request_id": "887c8266f84ca5870145dbe4f4f89f75", "body": {"id": "chatcmpl-BwxFNmnWtGWsyEFilmkCfpHfAij2Q", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4851, "completion_tokens": 82, "total_tokens": 4933, "prompt_tokens_details": {"cached_tokens": 3840, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1500c688190b9a18055e724bd7b", "custom_id": "48-4", "response": {"status_code": 200, "request_id": "4204a65601f7a1fd4c557fff8e294a28", "body": {"id": "chatcmpl-BwxFM08Vx7OIeDwl8cyuULrYB095G", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4369, "completion_tokens": 82, "total_tokens": 4451, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a150160c81908061ac7fc9e0a429", "custom_id": "48-5", "response": {"status_code": 200, "request_id": "4a7d7944d2b11ec99c21c7b7b37602f2", "body": {"id": "chatcmpl-BwxFMi9swA8irtd8sjhhjcZR7KIui", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4851, "completion_tokens": 82, "total_tokens": 4933, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1502c68819091ccbe85b0cfd0fe", "custom_id": "48-6", "response": {"status_code": 200, "request_id": "d9bcfa6d0cee56c5b75ab9f7cc520ae2", "body": {"id": "chatcmpl-BwxFMMzmMhu8FwgHqpVEX0efVjqJZ", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4851, "completion_tokens": 82, "total_tokens": 4933, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15042b88190be54b942b4ab546c", "custom_id": "48-7", "response": {"status_code": 200, "request_id": "9a9267f6855cc05efe4b02a728bd4c3b", "body": {"id": "chatcmpl-BwxFO6eoRW9tsjWpq0v6PvYCTUMjP", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4851, "completion_tokens": 82, "total_tokens": 4933, "prompt_tokens_details": {"cached_tokens": 4608, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a150523881908715485a578370d3", "custom_id": "48-8", "response": {"status_code": 200, "request_id": "66be8b10c315d5b4eec533467564cfa9", "body": {"id": "chatcmpl-BwxFPcec3snXb8CrB96qVePiHZZ9E", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"feature value\",\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4851, "completion_tokens": 86, "total_tokens": 4937, "prompt_tokens_details": {"cached_tokens": 4608, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15073b481908e33e84e85ee8feb", "custom_id": "48-9", "response": {"status_code": 200, "request_id": "7a47fd3fafea24b5b0af19c995db0e87", "body": {"id": "chatcmpl-BwxFLfKnSF8lwJr2IMsscKomfhhVn", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4851, "completion_tokens": 82, "total_tokens": 4933, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15076608190a30212eaaabd90bd", "custom_id": "58-0", "response": {"status_code": 200, "request_id": "72b762db4ef8b11a7a7538db76c83170", "body": {"id": "chatcmpl-BwxFRVGktPca4LUce9BzNTr9bLTw1", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.*\nFROM object o\nWHERE \n    o.oid IN (\n        SELECT oid\n        FROM magstat\n        WHERE \n            fid IN (1, 2) -- g and r bands\n            AND ndet >= 30\n        GROUP BY oid\n        HAVING \n            MAX(CASE WHEN fid = 1 THEN magmax_corr ELSE NULL END) - \n            MAX(CASE WHEN fid = 2 THEN magmin_corr ELSE NULL END) > 3.5\n    )\n  AND \n    o.oid IN (\n        SELECT oid\n        FROM object\n        WHERE \n            lastmjd - firstmjd > 20\n    )\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3651, "completion_tokens": 145, "total_tokens": 3796, "prompt_tokens_details": {"cached_tokens": 3456, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1507c148190aa33b5ac49e2c20b", "custom_id": "58-1", "response": {"status_code": 200, "request_id": "0196536c853a98f2b7d929d13e8fa73b", "body": {"id": "chatcmpl-BwxFPRPItrN3qk3p2p00grWdHL7RH", "object": "chat.completion", "created": 1753390471, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.*\nFROM object o\nWHERE (\n    SELECT COUNT(*) \n    FROM detection d \n    WHERE d.oid = o.oid\n) >= 30\nAND (\n    SELECT magmax_corr - magmin_corr\n    FROM magstat m\n    WHERE m.oid = o.oid AND m.fid IN (1, 2)\n    ORDER BY m.fid\n    LIMIT 2\n) > 3.5\nAND o.lastmjd - o.firstmjd > 20\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3651, "completion_tokens": 113, "total_tokens": 3764, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1509d8c8190983bf06295eb9b89", "custom_id": "58-2", "response": {"status_code": 200, "request_id": "bab7979364eaa70cb2b05a4d201e2863", "body": {"id": "chatcmpl-BwxFRj5rIxvr6ImSvQ1QGlFbJnyzX", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2934, "completion_tokens": 57, "total_tokens": 2991, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15098b0819096beb963bf8ed84f", "custom_id": "58-3", "response": {"status_code": 200, "request_id": "a1f2f355056d604e2095314c6fb81bcb", "body": {"id": "chatcmpl-BwxFQiDhpsqDYgSsFQN5n0TbtvisQ", "object": "chat.completion", "created": 1753390472, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.*\nFROM (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND (g_r_max_corr - g_r_mean_corr) > 3.5\n      AND (lastmjd - firstmjd) > 20\n    LIMIT 20\n) sub\nJOIN object o ON o.oid = sub.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2934, "completion_tokens": 79, "total_tokens": 3013, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1512f908190b106067b1f98303a", "custom_id": "58-4", "response": {"status_code": 200, "request_id": "5c52441f4701ef30873462ddef7f112c", "body": {"id": "chatcmpl-BwxFR2TjPpe7l8k9twl6S5ksR0icW", "object": "chat.completion", "created": 1753390473, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2934, "completion_tokens": 57, "total_tokens": 2991, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a150c97c8190be9645176208602e", "custom_id": "58-5", "response": {"status_code": 200, "request_id": "06a70451559c6d625e490ec80dbe8b6b", "body": {"id": "chatcmpl-BwxFSSmeOJV9lH5uzQ9j6DKRH7Oae", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.*\nFROM (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND (g_r_max_corr - g_r_mean_corr) > 3.5\n      AND (lastmjd - firstmjd) > 20\n    LIMIT 20\n) sub\nJOIN object o ON o.oid = sub.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2934, "completion_tokens": 79, "total_tokens": 3013, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a150dcc081908360885eeb8d3158", "custom_id": "58-6", "response": {"status_code": 200, "request_id": "1549ebbf37648329ce4078d0b1b1fc29", "body": {"id": "chatcmpl-BwxFScyhLMQy5BqYPDOJmLMWq2GgI", "object": "chat.completion", "created": 1753390474, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2934, "completion_tokens": 57, "total_tokens": 2991, "prompt_tokens_details": {"cached_tokens": 2816, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a150ef3c81909c143c553e302d16", "custom_id": "58-7", "response": {"status_code": 200, "request_id": "dc5521ead26865a35d03b730a6933451", "body": {"id": "chatcmpl-BwxFJRZDpdUakfzzBaXZuyykB7ApD", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 20 objects from the 'object' table that meet the specified conditions\nSELECT *\nFROM object\nWHERE ndet >= 30\n  AND (g_r_max_corr - g_r_mean_corr) > 3.5\n  AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2934, "completion_tokens": 73, "total_tokens": 3007, "prompt_tokens_details": {"cached_tokens": 1920, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a150f0288190ba835900229a24bf", "custom_id": "58-8", "response": {"status_code": 200, "request_id": "ccdba98950fb28dabb7fda7e7e8bdb5a", "body": {"id": "chatcmpl-BwxFIRvbEv2RknZt8sPphZSYb9u7l", "object": "chat.completion", "created": 1753390464, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.*\nFROM (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND (g_r_max_corr - g_r_mean_corr) > 3.5\n      AND (lastmjd - firstmjd) > 20\n    LIMIT 20\n) sub\nJOIN object o ON o.oid = sub.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2934, "completion_tokens": 79, "total_tokens": 3013, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a150fa0881909021922af17ce9c8", "custom_id": "58-9", "response": {"status_code": 200, "request_id": "fdb98b504a2ec8487033bc3c4ccea209", "body": {"id": "chatcmpl-BwxFU5XRIHSvicNivvM3Hh5GB7QRw", "object": "chat.completion", "created": 1753390476, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2934, "completion_tokens": 57, "total_tokens": 2991, "prompt_tokens_details": {"cached_tokens": 2432, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1510f988190b55e47541ea494c7", "custom_id": "78-0", "response": {"status_code": 200, "request_id": "939f4f552bf8fca4d237d4bb89e68aa2", "body": {"id": "chatcmpl-BwxFJRrCXRgUYAnJmWD7vNPgsHYJZ", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 39, "total_tokens": 1951, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15122688190b080e408ab187c0e", "custom_id": "78-1", "response": {"status_code": 200, "request_id": "d6492ff3b85d56b9ab316ea5a3387584", "body": {"id": "chatcmpl-BwxFJZf3exN1fajx1QUdtYbc7lY4a", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 73, "total_tokens": 1985, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a151481c8190b47ab01d68a5b11a", "custom_id": "78-2", "response": {"status_code": 200, "request_id": "e345bfc218dd85945d1fa12c5bb49fe3", "body": {"id": "chatcmpl-BwxFJywwny5aZbwxs5BfLZgXmF27g", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 39, "total_tokens": 1951, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1516b588190b5135ad8240885f2", "custom_id": "78-3", "response": {"status_code": 200, "request_id": "0d7f3ad8e57ebf8ff0ca76c533d7d9b9", "body": {"id": "chatcmpl-BwxFJmsuHqaq6fBTIkdgJsXcGgqrK", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 39, "total_tokens": 1951, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15169948190a48ef2a6540a5009", "custom_id": "78-4", "response": {"status_code": 200, "request_id": "1a8254b0db40de45fcf1b86a94f7a8e4", "body": {"id": "chatcmpl-BwxFJUmEwhUtfHH7czFZQB015yG0H", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 73, "total_tokens": 1985, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15184f48190b4f33b871a7a7a17", "custom_id": "78-5", "response": {"status_code": 200, "request_id": "1a5186cd64c6fd3579e143dde5dfe452", "body": {"id": "chatcmpl-BwxFLxY6O4WQwwlNOPYdZ74dY79y2", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 73, "total_tokens": 1985, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1520ec0819095d22ddfd2d71682", "custom_id": "78-6", "response": {"status_code": 200, "request_id": "3a337ce1a277ea1a7f5a9c783ee1245e", "body": {"id": "chatcmpl-BwxFLI9HF630TC9T4zJyZ34Bl4x54", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 73, "total_tokens": 1985, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15187d48190841bdd5e00d770d5", "custom_id": "78-7", "response": {"status_code": 200, "request_id": "0df209564ee3a80198314b9e2de8498d", "body": {"id": "chatcmpl-BwxFMfJz6VcVV4ZjbTYJjPs6xtt29", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 39, "total_tokens": 1951, "prompt_tokens_details": {"cached_tokens": 1408, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a151a1648190ab191216063e220d", "custom_id": "78-8", "response": {"status_code": 200, "request_id": "31c0e23e17d0434648c0500dbf0a54c9", "body": {"id": "chatcmpl-BwxFMLOZKNeMeTqFDbbkeNkalIFMs", "object": "chat.completion", "created": 1753390468, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 73, "total_tokens": 1985, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a151b8748190a477894325656c1c", "custom_id": "78-9", "response": {"status_code": 200, "request_id": "a03b2c48bf47cc5dc5d655dca5a39165", "body": {"id": "chatcmpl-BwxFLjX75l8NFiq2jBwbxUIvoYrdR", "object": "chat.completion", "created": 1753390467, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1912, "completion_tokens": 39, "total_tokens": 1951, "prompt_tokens_details": {"cached_tokens": 1792, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a151dc988190b0f743e32731fc5a", "custom_id": "39-0", "response": {"status_code": 200, "request_id": "e3d28a7c7300d2720d34353d1209ce6a", "body": {"id": "chatcmpl-BwxFN4pmRzUG4pYV6eJ8MIfhZngU2", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r\n    FROM\n        detection d\n    WHERE\n        -- Filter for objects with the highest probability class 'CV/Nova' in 'stochastic' classifier\n        (SELECT p.class_name\n         FROM probability p\n         WHERE p.oid = d.oid\n           AND p.classifier_name = 'lc_classifier_stochastic'\n           AND p.ranking = 1\n         LIMIT 1) = 'CV/Nova'\n        -- Filter for objects with at most 50 detections from first to last detection\n        AND (\n            SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid\n            AND d2.mjd BETWEEN (SELECT firstmjd FROM object WHERE oid = d.oid)\n                         AND (SELECT lastmjd FROM object WHERE oid = d.oid)\n        ) <= 50\n),\n-- Calculate maximum rise (max mag - min mag) for each object\nmax_rise AS (\n    SELECT\n        object_id,\n        MAX(magnitude) - MIN(magnitude) AS max_rise\n    FROM\n        filtered_objects\n    GROUP BY\n        object_id\n)\n-- Final selection: first 1000 rows ordered by object ID\nSELECT\n    fo.object_id,\n    fo.candidate_id,\n    fo.f_id,\n    fo.ra,\n    fo.dec,\n    fo.magnitude,\n    fo.mag_error,\n    fo.mag_corr_r,\n    fo.mag_corr_error_r,\n    mr.max_rise\nFROM\n    filtered_objects fo\nJOIN\n    max_rise mr ON fo.object_id = mr.object_id\nORDER BY\n    fo.object_id\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3865, "completion_tokens": 442, "total_tokens": 4307, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a151e09c81909513cebb742032c1", "custom_id": "39-1", "response": {"status_code": 200, "request_id": "ba94a13693d71d0177c8ae2fc8d1dd51", "body": {"id": "chatcmpl-BwxFNpzoYSD7RzGu4tHaABlRKbAjk", "object": "chat.completion", "created": 1753390469, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH object_candidates AS (\n    SELECT\n        o.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS filter_id,\n        d.ra AS ra,\n        d.dec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_error,\n        p.probability AS class_probability,\n        p.ranking AS class_ranking,\n        p.class_name AS class_name,\n        o.ndet AS total_detections,\n        d.mjd AS detection_mjd,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r,\n        d.magpsf_corr AS psf_mag_r,\n        d.magpsf AS magpsf,\n        d.mjd,\n        -- Calculate maximum rise as max mag - min mag for each object\n        MAX(d.magpsf) OVER (PARTITION BY o.oid) - MIN(d.magpsf) OVER (PARTITION BY o.oid) AS max_rise\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.class_name = 'CV/Nova'\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.ranking = 1\n        AND o.ndet <= 50\n        AND d.fid = 2 -- r-band filter\n        AND d.magpsf_corr IS NOT NULL\n)\nSELECT\n    object_id,\n    candidate_id,\n    filter_id AS f_id,\n    ra,\n    dec,\n    mag,\n    mag_error,\n    mag_corr_r,\n    mag_corr_error_r,\n    psf_mag_r,\n    max_rise\nFROM\n    object_candidates\nORDER BY\n    object_id\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3539, "completion_tokens": 388, "total_tokens": 3927, "prompt_tokens_details": {"cached_tokens": 3072, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a151e62c8190b1d77bde6872fbb9", "custom_id": "39-2", "response": {"status_code": 200, "request_id": "1e432dd3403a1371c39f6e570045c727", "body": {"id": "chatcmpl-BwxFO91u0R59c0b3WqR928EFFfzZg", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from detection table\nWITH filtered_objects AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects with corrected difference magnitude in r-band (magpsf_corr) not null\n        AND d.magpsf_corr IS NOT NULL\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = d.oid\n                AND p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        )\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4231, "completion_tokens": 354, "total_tokens": 4585, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15205488190b6ba93b18c30e8ff", "custom_id": "39-3", "response": {"status_code": 200, "request_id": "afedfbf75f78f5f4aeba56c94403b22c", "body": {"id": "chatcmpl-BwxFOwNgTp7ToYo8W2UX34Y7DOuoi", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID as 'f_id', coordinates, magnitude, and magnitude errors\nWITH filtered_objects AS (\n    -- Filter objects with maximum probability class 'CV/Nova' in 'stochastic' classifier\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n    GROUP BY o.oid\n    HAVING COUNT(*) <= 50\n),\ncandidate_probs AS (\n    -- Get the probability for 'CV/Nova' class for each object\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n),\ndetection_filtered AS (\n    -- Filter detections for objects in filtered_objects\n    SELECT d.oid, d.candid, d.rfid AS f_id, d.ra, d.dec, d.magpsf AS mag, d.sigmapsf AS mag_err, d.magpsf_corr AS mag_corr_r\n    FROM detection d\n    JOIN filtered_objects fo ON d.oid = fo.oid\n    WHERE d.fid = 2 -- r-band filter\n),\nmax_min_rise AS (\n    -- Calculate maximum rise (max mag - min mag) for each object\n    SELECT oid, MAX(mag) - MIN(mag) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.mag,\n    d.mag_err,\n    d.mag_corr_r,\n    mr.max_rise\nFROM detection_filtered d\nJOIN max_min_rise mr ON d.oid = mr.oid\nORDER BY d.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3865, "completion_tokens": 428, "total_tokens": 4293, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15205ac81909ed864ec4aff4bcb", "custom_id": "39-4", "response": {"status_code": 200, "request_id": "8a5630b42c62a880df80ca1c0bf14cd3", "body": {"id": "chatcmpl-BwxFOFk7eXA1bW4OyQ2zRKQzr7VMz", "object": "chat.completion", "created": 1753390470, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from detection, object, and probability tables\nWITH filtered_objects AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects with corrected difference magnitude in r-band\n        AND d.magzpsci_corr IS NOT NULL\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND (\n            SELECT\n                p.class_name\n            FROM\n                probability p\n            WHERE\n                p.oid = o.oid\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n            LIMIT 1\n        ) = 'CV/Nova'\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4231, "completion_tokens": 356, "total_tokens": 4587, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15204f881908007d4b054b40d2e", "custom_id": "39-5", "response": {"status_code": 200, "request_id": "1867785379217f414ca28a2351f2c281", "body": {"id": "chatcmpl-BwxFTbpzaWDDGq4xSkHRoUGsTTllX", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from detection table\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND (\n            SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid\n        ) <= 50\n        -- Filter for objects with the highest probability class as 'CV/Nova' in stochastic classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = d.oid\n                AND p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        )\n    GROUP BY\n        d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n)\nSELECT\n    object_id,\n    candidate_id,\n    f_id,\n    ra,\n    dec,\n    magnitude,\n    mag_error,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    object_id\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4231, "completion_tokens": 366, "total_tokens": 4597, "prompt_tokens_details": {"cached_tokens": 4096, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a15230cc81909d01b9af0dacc33a", "custom_id": "39-6", "response": {"status_code": 200, "request_id": "84dcd1d838038e3f5e29395630d81695", "body": {"id": "chatcmpl-BwxFTx4NTdxWO3cD65sFX6PPfKRLv", "object": "chat.completion", "created": 1753390475, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r\n    FROM\n        detection d\n    WHERE\n        -- Filter for objects with the highest probability class 'CV/Nova' in stochastic classifier\n        -- First, get the probability with ranking=1 for 'CV/Nova' in 'lc_classifier_stochastic'\n        -- Then, filter objects where this probability corresponds to 'CV/Nova'\n        -- and the object has at most 50 detections from first to last detection\n        (\n            SELECT\n                p.oid\n            FROM\n                probability p\n            WHERE\n                p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        ) AS prob_obj\n        ON d.oid = prob_obj.oid\n        AND (\n            SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid AND d2.mjd BETWEEN (SELECT firstmjd FROM object WHERE oid = d.oid) AND (SELECT lastmjd FROM object WHERE oid = d.oid)\n        ) <= 50\n)\n-- Now, select from the filtered objects, compute maximum rise (max mag - min mag) per object\nSELECT\n    fo.object_id,\n    fo.candidate_id,\n    fo.f_id,\n    fo.ra,\n    fo.dec,\n    fo.magnitude,\n    fo.mag_error,\n    fo.mag_corr_r,\n    fo.mag_corr_error_r,\n    (MAX(fo.magnitude) OVER (PARTITION BY fo.object_id) - MIN(fo.magnitude) OVER (PARTITION BY fo.object_id)) AS max_rise\nFROM\n    filtered_objects fo\nORDER BY\n    fo.object_id\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3865, "completion_tokens": 456, "total_tokens": 4321, "prompt_tokens_details": {"cached_tokens": 3712, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1523aac8190a6e7953db9218cff", "custom_id": "39-7", "response": {"status_code": 200, "request_id": "9c9d4780b33ac4737e916e95eef2929c", "body": {"id": "chatcmpl-BwxFUky8kWyiDtiw9xo3MUWHn02NT", "object": "chat.completion", "created": 1753390476, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from detection, object, probability, and reference tables\nWITH filtered_objects AS (\n    -- Filter objects with at most 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nprob_top_stochastic AS (\n    -- Get the most probable class for each object from the top-level classifier\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top' AND p.ranking = 1\n),\ncv_nova_objects AS (\n    -- Filter objects where the top class is 'SNIa' (representing CV/Nova)\n    SELECT p.oid\n    FROM prob_top_stochastic p\n    WHERE p.class_name = 'SNIa'\n),\nfinal_objects AS (\n    -- Combine filters: objects with max 50 detections, not CV/Nova\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n      AND o.oid NOT IN (SELECT oid FROM cv_nova_objects)\n),\ndetection_filtered AS (\n    -- Filter detections for the final objects in r-band (fid=2)\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Calculate maximum rise (max magpsf - min magpsf) per object\nrise_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf) - MIN(magpsf) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n),\n-- Get the corrected difference magnitude in r-band\ndetection_with_corr AS (\n    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Determine PSF corrected magnitude in r-filter for each object (taking maximum magpsf_corr)\npsf_max_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf_corr) AS max_psf_corr\n    FROM detection_with_corr\n    GROUP BY oid\n)\n-- Final selection with ordering and limit\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    r.max_rise,\n    p.max_psf_corr\nFROM detection_with_corr d\nJOIN rise_per_object r ON d.oid = r.oid\nJOIN psf_max_per_object p ON d.oid = p.oid\nORDER BY d.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4231, "completion_tokens": 605, "total_tokens": 4836, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a152b8648190b07f78f79d47a8c2", "custom_id": "39-8", "response": {"status_code": 200, "request_id": "c29a32e02e56768e8decd87d5ad521e4", "body": {"id": "chatcmpl-BwxFJJxLPiw1uRNt8YsdT4w6hldVd", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from detection, object, probability, and nested subqueries\nSELECT\n    d.oid,\n    d.candid AS candidate_id,\n    d.fid AS f_id,\n    o.meanra AS ra,\n    o.meandec AS dec,\n    d.magpsf AS mag,\n    d.sigmapsf AS mag_err,\n    d.magpsf_corr AS mag_corr_r,\n    -- Calculate maximum rise as difference between max and min magpsf in detections per object\n    MAX(d.magpsf) OVER (PARTITION BY d.oid) - MIN(d.magpsf) OVER (PARTITION BY d.oid) AS max_rise\nFROM\n    detection d\nJOIN\n    object o ON d.oid = o.oid\n-- Subquery to filter objects with highest probability class 'CV/Nova' in stochastic classifier\nWHERE\n    -- Filter objects where the top probability class in 'lc_classifier_stochastic' is 'CV/Nova'\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = d.oid\n          AND p.classifier_name = 'lc_classifier_stochastic'\n          AND p.ranking = 1\n        LIMIT 1\n    ) = 'CV/Nova'\n  AND\n    -- Filter objects with number of detections <= 50\n    (\n        SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid AND d2.mjd BETWEEN o.firstmjd AND o.lastmjd\n    ) <= 50\n  AND\n    -- Filter for corrected difference magnitude in r-band (fid=2)\n    d.fid = 2\n-- Order by object identifier\nORDER BY\n    d.oid\n-- Limit to first 1000 rows\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4231, "completion_tokens": 375, "total_tokens": 4606, "prompt_tokens_details": {"cached_tokens": 2688, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
{"id": "batch_req_6882a1525b148190904375caa781f0f5", "custom_id": "39-9", "response": {"status_code": 200, "request_id": "aeee4259b1b7af022fd025f04c9b7bd3", "body": {"id": "chatcmpl-BwxFJEKXPL6mjFW4hYfesRh3M9P7M", "object": "chat.completion", "created": 1753390465, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select specified columns from detection, object, probability, and reference tables\nWITH filtered_objects AS (\n    -- Filter objects with at most 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nprob_top_stochastic AS (\n    -- Get the most probable class for each object from the top-level classifier\n    SELECT p.oid, p.class_name, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top' AND p.ranking = 1\n),\ncv_nova_objects AS (\n    -- Filter objects where the top class is 'SNIa' (representing CV/Nova class)\n    SELECT p.oid\n    FROM prob_top_stochastic p\n    WHERE p.class_name = 'SNIa'\n),\nfinal_objects AS (\n    -- Combine filters: detection count, class, and object existence\n    SELECT o.oid\n    FROM object o\n    JOIN filtered_objects fo ON o.oid = fo.oid\n    JOIN cv_nova_objects cv ON o.oid = cv.oid\n)\nSELECT\n    d.oid,\n    d.candid AS candidate_id,\n    d.fid AS f_id,\n    o.meanra AS ra,\n    o.meandec AS dec,\n    d.magpsf AS mag,\n    d.sigmapsf AS mag_err,\n    d.magpsf_corr AS mag_corr_r,\n    -- Calculate maximum rise as max(mag) - min(mag) across detections per object\n    MAX(d.magpsf) OVER (PARTITION BY d.oid) - MIN(d.magpsf) OVER (PARTITION BY d.oid) AS max_rise\nFROM detection d\nJOIN object o ON d.oid = o.oid\nJOIN final_objects fo ON o.oid = fo.oid\nJOIN probability p ON o.oid = p.oid\nWHERE\n    p.classifier_name = 'lc_classifier_stochastic'\n    AND p.class_name = 'SNIa'\n    AND p.ranking = 1\n    AND d.fid = 2 -- r-band filter\n    AND d.corrected = TRUE\nORDER BY d.oid\nLIMIT 1000;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4231, "completion_tokens": 464, "total_tokens": 4695, "prompt_tokens_details": {"cached_tokens": 4096, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": null}}, "error": null}
