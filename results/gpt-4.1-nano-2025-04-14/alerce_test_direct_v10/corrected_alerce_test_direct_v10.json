{
    "8": {
        "0": {
            "req_id": "8",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 776,
                "out_toks": 22,
                "id": "chatcmpl-BjAchfYNGckRsjUgPPiLMaLB1kFyJ",
                "created": 1750105295,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the classification is the top (most probable) class\n      )\n)\n-- Select objects that meet the above criteria or have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the classification is the top (most probable) class\n      )\n)\n-- Select objects that meet the above criteria or have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 1964,
                "out_toks": 183,
                "id": "chatcmpl-Bx088Kr6dGPX6DT1SW6aBggPezWx7",
                "created": 1753401552,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects that meet the above criteria or have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects that meet the above criteria or have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 3118,
                "out_toks": 162,
                "id": "chatcmpl-BwxFHdPBIjsUbmXZgegsiIn4aUyMv",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "8",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 776,
                "out_toks": 22,
                "id": "chatcmpl-BjAchfYNGckRsjUgPPiLMaLB1kFyJ",
                "created": 1750105295,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve object OIDs classified as SN by the stamp classifier with probability > 0.5 and ranking=1\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1 -- Ensure the classification is the top-ranked (most probable)\n),\n-- Select objects that meet either condition: classified as SN with high probability or have at least two detections\ncandidate_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM sn_objects)\n       OR o.ndet >= 2\n)\n-- Final selection: objects first classified as SN between August 17 and August 21\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM candidate_objects)\n  AND o.firstmjd BETWEEN 60173.0 AND 60177.0;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve object OIDs classified as SN by the stamp classifier with probability > 0.5 and ranking=1\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.5\n      AND p.ranking = 1 -- Ensure the classification is the top-ranked (most probable)\n),\n-- Select objects that meet either condition: classified as SN with high probability or have at least two detections\ncandidate_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM sn_objects)\n       OR o.ndet >= 2\n)\n-- Final selection: objects first classified as SN between August 17 and August 21\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM candidate_objects)\n  AND o.firstmjd BETWEEN 60173.0 AND 60177.0;\n```"
                },
                "in_toks": 2003,
                "out_toks": 213,
                "id": "chatcmpl-Bx083cQf5KgihqHLeUryiXi90gWg0",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve object OIDs classified as SN by the stamp classifier with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n    )\n    UNION\n    -- Include objects with at least two detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 2\n)\n-- Select all objects that meet either condition and were first classified as SN between August 17 and August 21\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM sn_objects)\n  AND firstmjd BETWEEN 60173.0 AND 60177.0;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve object OIDs classified as SN by the stamp classifier with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n    )\n    UNION\n    -- Include objects with at least two detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 2\n)\n-- Select all objects that meet either condition and were first classified as SN between August 17 and August 21\nSELECT *\nFROM object\nWHERE oid IN (SELECT oid FROM sn_objects)\n  AND firstmjd BETWEEN 60173.0 AND 60177.0;\n```"
                },
                "in_toks": 3118,
                "out_toks": 183,
                "id": "chatcmpl-BwxFHEhe91vGbR5GRdSpDHjzUctY3",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "8",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"object\", \"probability\", \"taxonomy\", \"detection\"]"
                },
                "in_toks": 623,
                "out_toks": 14,
                "id": "chatcmpl-BwvIav0A21PPytQaCxRa3jdviRDmA",
                "created": 1753382980,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n  AND o.ndet >= 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n  AND o.ndet >= 2;\n```"
                },
                "in_toks": 3163,
                "out_toks": 161,
                "id": "chatcmpl-BwxFDzYdF2iaoNEPDsBqSP9opi22B",
                "created": 1753390459,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "8",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 623,
                "out_toks": 14,
                "id": "chatcmpl-BwvIbqsuA92eIs5IiyAjiY4tBpGV5",
                "created": 1753382981,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\n-- with probability > 0.5 or at least two detections, optimizing with nested queries and additional conditions\n\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE\n        -- Check if the object was first classified as SN by the stamp classifier with high confidence\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'SN'\n              AND p.classifier_name = 'stamp_classifier'\n              AND p.probability > 0.5\n              AND p.ranking = 1 -- ensure the top-ranked classification\n        )\n        -- Ensure the first classification occurred within the specified date range\n        AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\n-- Select objects that meet either classification criteria or have multiple detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid FROM sn_objects\n)\nOR o.ndet >= 2; -- Include objects with at least two detections\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\n-- with probability > 0.5 or at least two detections, optimizing with nested queries and additional conditions\n\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE\n        -- Check if the object was first classified as SN by the stamp classifier with high confidence\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'SN'\n              AND p.classifier_name = 'stamp_classifier'\n              AND p.probability > 0.5\n              AND p.ranking = 1 -- ensure the top-ranked classification\n        )\n        -- Ensure the first classification occurred within the specified date range\n        AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\n-- Select objects that meet either classification criteria or have multiple detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid FROM sn_objects\n)\nOR o.ndet >= 2; -- Include objects with at least two detections\n```"
                },
                "in_toks": 2092,
                "out_toks": 243,
                "id": "chatcmpl-Bx07x3ZcdLEE8g4khiygIAyyz9RkB",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5 or at least two detections\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Check if the object was first classified as SN by the stamp classifier\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'SN'\n              AND p.classifier_name = 'stamp_classifier'\n              AND p.probability > 0.5\n        )\n        AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Objects first classified as SN in the specified period with probability > 0.5\n    SELECT oid FROM sn_objects\n)\nOR o.ndet >= 2; -- Or objects with at least two detections\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5 or at least two detections\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Check if the object was first classified as SN by the stamp classifier\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'SN'\n              AND p.classifier_name = 'stamp_classifier'\n              AND p.probability > 0.5\n        )\n        AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Objects first classified as SN in the specified period with probability > 0.5\n    SELECT oid FROM sn_objects\n)\nOR o.ndet >= 2; -- Or objects with at least two detections\n```"
                },
                "in_toks": 3163,
                "out_toks": 207,
                "id": "chatcmpl-BwxFFss8wmLx8cU41ywqyn9C0Gt0n",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "8",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"object\", \"probability\", \"taxonomy\", \"detection\"]"
                },
                "in_toks": 623,
                "out_toks": 14,
                "id": "chatcmpl-BwvIdvN6uSgwMz1Mprl3DoVYTv2rD",
                "created": 1753382983,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 2007,
                "out_toks": 176,
                "id": "chatcmpl-Bx0834iI91BunQtwfRtP32ZL6Z4Ha",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 3163,
                "out_toks": 161,
                "id": "chatcmpl-BwxFFbENToHXQSbexftsnwIeXh9nD",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "8",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 623,
                "out_toks": 14,
                "id": "chatcmpl-BwvIem4cD28lUQUfiiVC2ADT2c4ax",
                "created": 1753382984,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0 -- Date range for classification\n)\n-- Select objects with at least two detections or that were first classified as SN in the specified period\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0 -- Date range for classification\n)\n-- Select objects with at least two detections or that were first classified as SN in the specified period\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 2021,
                "out_toks": 199,
                "id": "chatcmpl-Bx0895JOEodV1CCsnPxTJQ5rbcXtE",
                "created": 1753401553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\n-- Select objects with at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\n-- Select objects with at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 3163,
                "out_toks": 168,
                "id": "chatcmpl-BwxFG80TpowIgTkJ28uDqXpiRMZHG",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "8",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"object\", \"probability\", \"taxonomy\", \"detection\"]"
                },
                "in_toks": 623,
                "out_toks": 14,
                "id": "chatcmpl-BwvIf1PloMlhHsSlZngtUIuQ7hn2X",
                "created": 1753382985,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 2007,
                "out_toks": 176,
                "id": "chatcmpl-Bx083wsqLKJtcAjFj5RK0TfaHWoQN",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Select objects from the above set that have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 3163,
                "out_toks": 161,
                "id": "chatcmpl-BwxFIZxloLZGCTn878DnxiNtfXM2X",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "8",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"object\", \"probability\", \"taxonomy\", \"detection\"]"
                },
                "in_toks": 623,
                "out_toks": 14,
                "id": "chatcmpl-BwvIg2aG9agTN6M6ejgQS27Wwrhev",
                "created": 1753382986,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    -- Filter objects based on first detection date within the specified range\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n    -- Ensure the object has either a high probability of being SN from the stamp classifier\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n    )\n    -- Or the object has at least two detections\n    OR o.ndet >= 2\n)\n-- Retrieve full object details for the selected objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    -- Filter objects based on first detection date within the specified range\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n    -- Ensure the object has either a high probability of being SN from the stamp classifier\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n    )\n    -- Or the object has at least two detections\n    OR o.ndet >= 2\n)\n-- Retrieve full object details for the selected objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 1977,
                "out_toks": 215,
                "id": "chatcmpl-Bx07xpLNmBi5BpQqQRjqFlo9vo4Wc",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n      OR o.ndet >= 2\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n      OR o.ndet >= 2\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3163,
                "out_toks": 146,
                "id": "chatcmpl-BwxG9u2kzhFwkSi6bwNBJ2eRAmbFm",
                "created": 1753390517,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "8",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 623,
                "out_toks": 14,
                "id": "chatcmpl-BwvIgIwwJmykwFQ8VNREN01kRWSGw",
                "created": 1753382986,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0 -- Date range for classification\n)\n-- Select objects with at least two detections or that were first classified as SN in the specified period\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n          AND p.ranking = 1 -- Ensure the top-ranked classification\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0 -- Date range for classification\n)\n-- Select objects with at least two detections or that were first classified as SN in the specified period\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 2021,
                "out_toks": 199,
                "id": "chatcmpl-Bx0P27lNeXbpr2iF84KZl8Sx18HQA",
                "created": 1753402600,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\n-- Select objects with at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n        LIMIT 1\n    )\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\n-- Select objects with at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n   OR o.ndet >= 2;\n```"
                },
                "in_toks": 3163,
                "out_toks": 168,
                "id": "chatcmpl-BwxFK2XGBcCEJPkVHfpb28345GXdK",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "8",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"object\", \"probability\", \"taxonomy\", \"detection\"]"
                },
                "in_toks": 623,
                "out_toks": 14,
                "id": "chatcmpl-BwvIhtLilgIUQhfLP7ZHTMrXsjeeV",
                "created": 1753382987,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\n-- with probability > 0.5 or at least two detections, optimizing with nested queries and explicit conditions\n\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND (\n        -- Check for probability > 0.5 for SN classification by stamp_classifier\n        EXISTS (\n          SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.class_name = 'SN'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.probability > 0.5\n            AND p.ranking = 1 -- ensure top-ranked classification\n        )\n        -- Or object has at least two detections\n        OR o.ndet >= 2\n      )\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\n-- with probability > 0.5 or at least two detections, optimizing with nested queries and explicit conditions\n\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND (\n        -- Check for probability > 0.5 for SN classification by stamp_classifier\n        EXISTS (\n          SELECT 1\n          FROM probability p\n          WHERE p.oid = o.oid\n            AND p.class_name = 'SN'\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.probability > 0.5\n            AND p.ranking = 1 -- ensure top-ranked classification\n        )\n        -- Or object has at least two detections\n        OR o.ndet >= 2\n      )\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 2003,
                "out_toks": 215,
                "id": "chatcmpl-Bx086zMxfyrGcy6pBv0pyVa62NRmw",
                "created": 1753401550,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5 or at least two detections\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n      OR o.ndet >= 2\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21 with probability > 0.5 or at least two detections\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n      OR o.ndet >= 2\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3163,
                "out_toks": 159,
                "id": "chatcmpl-BwxFBROFXO7iSAQwhLwDzF7G4IbKv",
                "created": 1753390457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "27": {
        "0": {
            "req_id": "27",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 815,
                "out_toks": 20,
                "id": "chatcmpl-BjAchBCwWsG628bhMi5xjKGF7O6I8",
                "created": 1750105295,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'CEP' -- Assuming 'CEP' is the class name for Cepheid variables\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification_ranks AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    cr.class_name,\n    cr.ranking,\n    cr.probability\nFROM selected_objects so\nJOIN classification_ranks cr ON so.oid = cr.oid\nWHERE cr.class_name = 'CEP'\n  AND cr.probability > 0.76\nORDER BY cr.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'CEP' -- Assuming 'CEP' is the class name for Cepheid variables\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification_ranks AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    cr.class_name,\n    cr.ranking,\n    cr.probability\nFROM selected_objects so\nJOIN classification_ranks cr ON so.oid = cr.oid\nWHERE cr.class_name = 'CEP'\n  AND cr.probability > 0.76\nORDER BY cr.probability DESC;\n```"
                },
                "in_toks": 5012,
                "out_toks": 317,
                "id": "chatcmpl-BwxFEBLOyozdRS3dHiU4o2y9OqMf7",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "27",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 815,
                "out_toks": 20,
                "id": "chatcmpl-BjAchBCwWsG628bhMi5xjKGF7O6I8",
                "created": 1750105295,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'CEP' -- Assuming 'CEP' is the class name for Cepheid variables\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification AS (\n    SELECT\n        so.oid,\n        so.meanra,\n        so.meandec,\n        so.ndet,\n        so.firstmjd,\n        so.deltajd,\n        so.g_r_max,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM selected_objects so\n    JOIN cepheid_prob p ON so.oid = p.oid\n)\nSELECT * FROM classification;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'CEP' -- Assuming 'CEP' is the class name for Cepheid variables\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification AS (\n    SELECT\n        so.oid,\n        so.meanra,\n        so.meandec,\n        so.ndet,\n        so.firstmjd,\n        so.deltajd,\n        so.g_r_max,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM selected_objects so\n    JOIN cepheid_prob p ON so.oid = p.oid\n)\nSELECT * FROM classification;\n```"
                },
                "in_toks": 5012,
                "out_toks": 255,
                "id": "chatcmpl-BwxFFKNOGa5hKL3Wnl0X4tP1ZotZ8",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "27",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "detection",
                "feature",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'detection', 'feature', 'step']"
                },
                "in_toks": 662,
                "out_toks": 24,
                "id": "chatcmpl-BwvIh2toqd7Rf5KnDWPMrPZMGQsVR",
                "created": 1753382987,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.classifier_name,\n    c.class_name,\n    c.ranking,\n    c.probability\nFROM object_filtered of\nJOIN classification c ON of.oid = c.oid\nORDER BY c.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.classifier_name,\n    c.class_name,\n    c.ranking,\n    c.probability\nFROM object_filtered of\nJOIN classification c ON of.oid = c.oid\nORDER BY c.probability DESC;\n```"
                },
                "in_toks": 6395,
                "out_toks": 236,
                "id": "chatcmpl-BwxFFos4JayHSX5woRzAOHekWw9lI",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "27",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "detection",
                "feature",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'detection', 'feature', 'step']"
                },
                "in_toks": 662,
                "out_toks": 24,
                "id": "chatcmpl-BwvIiKOzrblW0dfd0I8XyKGKybJer",
                "created": 1753382988,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    cp.class_name,\n    cp.ranking,\n    cp.probability\nFROM object_filtered of\nJOIN cepheid_prob cp ON of.oid = cp.oid\nORDER BY cp.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    cp.class_name,\n    cp.ranking,\n    cp.probability\nFROM object_filtered of\nJOIN cepheid_prob cp ON of.oid = cp.oid\nORDER BY cp.probability DESC;\n```"
                },
                "in_toks": 6395,
                "out_toks": 228,
                "id": "chatcmpl-BwxFFk0yZ2wkoDvWgICZpuQcRdF07",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "27",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "classification"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'classification']"
                },
                "in_toks": 662,
                "out_toks": 17,
                "id": "chatcmpl-BwvIjPFOhHk6bvaKFy0mULuaAAYyX",
                "created": 1753382989,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.probability > 0.76\n),\n-- Retrieve the most probable class for each object\nmost_probable_class AS (\n    SELECT DISTINCT ON (c.oid)\n        c.oid,\n        c.class_name,\n        c.classifier_name,\n        c.ranking,\n        c.probability\n    FROM classification c\n    ORDER BY c.oid, c.ranking\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    mpc.class_name AS class,\n    mpc.ranking,\n    mpc.probability\nFROM selected_objects so\nJOIN most_probable_class mpc ON so.oid = mpc.oid\nORDER BY so.ndet DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.probability > 0.76\n),\n-- Retrieve the most probable class for each object\nmost_probable_class AS (\n    SELECT DISTINCT ON (c.oid)\n        c.oid,\n        c.class_name,\n        c.classifier_name,\n        c.ranking,\n        c.probability\n    FROM classification c\n    ORDER BY c.oid, c.ranking\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    mpc.class_name AS class,\n    mpc.ranking,\n    mpc.probability\nFROM selected_objects so\nJOIN most_probable_class mpc ON so.oid = mpc.oid\nORDER BY so.ndet DESC;\n```"
                },
                "in_toks": 3343,
                "out_toks": 317,
                "id": "chatcmpl-BwxFDyFVY9flrWaIz1INZdk1x6l3W",
                "created": 1753390459,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "27",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "detection",
                "feature",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'detection', 'feature', 'step']"
                },
                "in_toks": 662,
                "out_toks": 24,
                "id": "chatcmpl-BwvIkyol0ocSHSyq9LY3jnfS9Hi0U",
                "created": 1753382990,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 100 detections\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        -- Retrieve g_r_max from magstat table for band 2 (r-band)\n        -- Assuming the relevant magstat entry is for fid=2 (r-band)\n        -- Use subquery to get g_r_max for each object\n        (\n            SELECT magstat.g_r_max\n            FROM magstat\n            WHERE magstat.oid = o.oid AND magstat.fid = 2\n            LIMIT 1\n        ) AS g_r_max\n    FROM\n        object o\n    WHERE\n        o.ndet >= 100\n),\nclassification AS (\n    -- Select classification probabilities for objects classified as CEP\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\n-- Join filtered objects with their classification info\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.class_name,\n    c.classifier_name,\n    c.ranking,\n    c.probability\nFROM\n    object_filtered of\nJOIN\n    classification c ON of.oid = c.oid\nORDER BY\n    c.probability DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 100 detections\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        -- Retrieve g_r_max from magstat table for band 2 (r-band)\n        -- Assuming the relevant magstat entry is for fid=2 (r-band)\n        -- Use subquery to get g_r_max for each object\n        (\n            SELECT magstat.g_r_max\n            FROM magstat\n            WHERE magstat.oid = o.oid AND magstat.fid = 2\n            LIMIT 1\n        ) AS g_r_max\n    FROM\n        object o\n    WHERE\n        o.ndet >= 100\n),\nclassification AS (\n    -- Select classification probabilities for objects classified as CEP\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\n-- Join filtered objects with their classification info\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.class_name,\n    c.classifier_name,\n    c.ranking,\n    c.probability\nFROM\n    object_filtered of\nJOIN\n    classification c ON of.oid = c.oid\nORDER BY\n    c.probability DESC;\n```"
                },
                "in_toks": 5219,
                "out_toks": 370,
                "id": "chatcmpl-Bx085kXzWEyOd7VX9DFc1hHK48Soq",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        m.g_r_max\n    FROM\n        object o\n    WHERE\n        o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.class_name,\n    c.classifier_name,\n    c.ranking,\n    c.probability\nFROM\n    object_filtered of\nJOIN\n    classification c ON of.oid = c.oid\nORDER BY\n    c.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        m.g_r_max\n    FROM\n        object o\n    WHERE\n        o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.class_name,\n    c.classifier_name,\n    c.ranking,\n    c.probability\nFROM\n    object_filtered of\nJOIN\n    classification c ON of.oid = c.oid\nORDER BY\n    c.probability DESC;\n```"
                },
                "in_toks": 6395,
                "out_toks": 250,
                "id": "chatcmpl-BwxFIbapxmamcG1PwG4jVx40kTbzg",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "27",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "classification"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'classification']"
                },
                "in_toks": 662,
                "out_toks": 17,
                "id": "chatcmpl-BwvIk86FZIP4IF8Yd5rUKCXi6GUM6",
                "created": 1753382990,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'CEP' -- class name for Cepheid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification_details AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    cd.class_name,\n    cd.ranking,\n    cd.probability\nFROM selected_objects so\nJOIN classification_details cd ON so.oid = cd.oid\nWHERE cd.class_name = 'CEP'\n  AND cd.probability > 0.76\nORDER BY cd.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.class_name = 'CEP' -- class name for Cepheid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification_details AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    cd.class_name,\n    cd.ranking,\n    cd.probability\nFROM selected_objects so\nJOIN classification_details cd ON so.oid = cd.oid\nWHERE cd.class_name = 'CEP'\n  AND cd.probability > 0.76\nORDER BY cd.probability DESC;\n```"
                },
                "in_toks": 3343,
                "out_toks": 309,
                "id": "chatcmpl-BwxFEzgBjza6eOs1Rbd8TJDCftAjo",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "27",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "detection",
                "feature",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'detection', 'feature', 'step']"
                },
                "in_toks": 662,
                "out_toks": 24,
                "id": "chatcmpl-BwvIlk9sOM4ubgqKwO48bpStwlHZR",
                "created": 1753382991,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.class_name,\n    c.classifier_name,\n    c.ranking,\n    c.probability\nFROM object_filtered of\nJOIN classification c ON of.oid = c.oid\nORDER BY c.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\nclassification AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    c.class_name,\n    c.classifier_name,\n    c.ranking,\n    c.probability\nFROM object_filtered of\nJOIN classification c ON of.oid = c.oid\nORDER BY c.probability DESC;\n```"
                },
                "in_toks": 6395,
                "out_toks": 236,
                "id": "chatcmpl-BwxFFfPQdXHFIVVe6FgIMVD9QP3kl",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "27",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "classification"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'classification']"
                },
                "in_toks": 662,
                "out_toks": 17,
                "id": "chatcmpl-BwvImc7Dwixh3WKDljUgKyIFLRKOo",
                "created": 1753382992,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability,\n        p.classifier_name,\n        p.classifier_version\n    FROM probability p\n    WHERE p.class_name = 'CEP'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification_details AS (\n    SELECT\n        so.oid,\n        so.meanra,\n        so.meandec,\n        so.ndet,\n        so.firstmjd,\n        so.deltajd,\n        so.g_r_max,\n        cp.class_name,\n        cp.ranking,\n        cp.probability,\n        cp.classifier_name\n    FROM selected_objects so\n    JOIN cepheid_probabilities cp ON so.oid = cp.oid\n)\nSELECT\n    oid,\n    meanra,\n    meandec,\n    ndet,\n    firstmjd,\n    deltajd,\n    g_r_max,\n    class_name,\n    classifier_name,\n    ranking,\n    probability\nFROM classification_details\nORDER BY probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_probabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.ranking,\n        p.probability,\n        p.classifier_name,\n        p.classifier_version\n    FROM probability p\n    WHERE p.class_name = 'CEP'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.76\n),\nclassification_details AS (\n    SELECT\n        so.oid,\n        so.meanra,\n        so.meandec,\n        so.ndet,\n        so.firstmjd,\n        so.deltajd,\n        so.g_r_max,\n        cp.class_name,\n        cp.ranking,\n        cp.probability,\n        cp.classifier_name\n    FROM selected_objects so\n    JOIN cepheid_probabilities cp ON so.oid = cp.oid\n)\nSELECT\n    oid,\n    meanra,\n    meandec,\n    ndet,\n    firstmjd,\n    deltajd,\n    g_r_max,\n    class_name,\n    classifier_name,\n    ranking,\n    probability\nFROM classification_details\nORDER BY probability DESC;\n```"
                },
                "in_toks": 3343,
                "out_toks": 313,
                "id": "chatcmpl-BwxFMAX3nlmBA505PvWnX2dT7UbRU",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "27",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "magstat",
                "detection",
                "feature",
                "step"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'magstat', 'detection', 'feature', 'step']"
                },
                "in_toks": 662,
                "out_toks": 24,
                "id": "chatcmpl-BwvInvOQAdOHe3hOm1V4IN71oCgJt",
                "created": 1753382993,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    cp.class_name AS class,\n    cp.classifier_name,\n    cp.ranking,\n    cp.probability\nFROM object_filtered of\nJOIN cepheid_prob cp ON of.oid = cp.oid\nORDER BY cp.probability DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n),\ncepheid_prob AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'CEP'\n      AND p.ranking = 1\n      AND p.probability > 0.76\n)\nSELECT\n    of.oid,\n    of.meanra,\n    of.meandec,\n    of.ndet,\n    of.firstmjd,\n    of.deltajd,\n    of.g_r_max,\n    cp.class_name AS class,\n    cp.classifier_name,\n    cp.ranking,\n    cp.probability\nFROM object_filtered of\nJOIN cepheid_prob cp ON of.oid = cp.oid\nORDER BY cp.probability DESC;\n```"
                },
                "in_toks": 6395,
                "out_toks": 242,
                "id": "chatcmpl-BwxFH4KYrreMNOERYodeeCwlXJEnE",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "17": {
        "0": {
            "req_id": "17",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection']",
                    "1": "['object', 'probability', 'feature', 'magstat', 'detection']"
                },
                "in_toks": 783,
                "out_toks": 36,
                "id": "chatcmpl-BjAciTalKkAJqpX02saYvEzOWSr0r",
                "created": 1750105296,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object oids classified as AGN with variability in r band and no detections or no variability in g band\nSELECT o.oid\nFROM object o\nWHERE \n    -- Check if the object is classified as AGN with highest probability (ranking=1) in the 'probability' table\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n    AND\n    -- Check for variability in r band from magstat table\n    EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.ndet > 1 -- indicates variability (more than one detection)\n    )\n    AND\n    -- Check for no detections or no variability in g band\n    (\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n              AND m2.ndet > 1 -- multiple detections indicating variability\n        )\n        OR\n        -- Alternatively, if no detections in g band, ensure no variability\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n              AND m2.magmean_corr IS NOT NULL\n        )\n    )\nORDER BY o.oid ASC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object oids classified as AGN with variability in r band and no detections or no variability in g band\nSELECT o.oid\nFROM object o\nWHERE \n    -- Check if the object is classified as AGN with highest probability (ranking=1) in the 'probability' table\n    EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n    AND\n    -- Check for variability in r band from magstat table\n    EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.ndet > 1 -- indicates variability (more than one detection)\n    )\n    AND\n    -- Check for no detections or no variability in g band\n    (\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n              AND m2.ndet > 1 -- multiple detections indicating variability\n        )\n        OR\n        -- Alternatively, if no detections in g band, ensure no variability\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n              AND m2.magmean_corr IS NOT NULL\n        )\n    )\nORDER BY o.oid ASC;\n```"
                },
                "in_toks": 6246,
                "out_toks": 350,
                "id": "chatcmpl-BwxFBXb14uTTA5ngNdj5YLOmxWd9g",
                "created": 1753390457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "17",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection']",
                    "1": "['object', 'probability', 'feature', 'magstat', 'detection']"
                },
                "in_toks": 783,
                "out_toks": 36,
                "id": "chatcmpl-BjAciTalKkAJqpX02saYvEzOWSr0r",
                "created": 1750105296,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object oids classified as AGN with variability in r band and no detections or variability in g band\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        -- Check if the object is classified as AGN with ranking=1 in the probability table for AGN\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n    AND EXISTS (\n        -- Check for variability in r band (fid=2) in magstat\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2\n          AND (m.magmax - m.magmin) > 0 -- Variability indicated by difference in magnitudes\n    )\n    AND (\n        -- Check for no detections or no variability in g band (fid=1)\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1\n              AND (m2.magmax - m2.magmin) > 0\n        )\n        OR NOT EXISTS (\n            -- No detections in g band\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n        )\n    )\n)\n-- Retrieve all features for these objects, ordered by their value in ascending order\nSELECT f.*\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM agn_objects)\nORDER BY f.value ASC, f.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object oids classified as AGN with variability in r band and no detections or variability in g band\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        -- Check if the object is classified as AGN with ranking=1 in the probability table for AGN\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n    AND EXISTS (\n        -- Check for variability in r band (fid=2) in magstat\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2\n          AND (m.magmax - m.magmin) > 0 -- Variability indicated by difference in magnitudes\n    )\n    AND (\n        -- Check for no detections or no variability in g band (fid=1)\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1\n              AND (m2.magmax - m2.magmin) > 0\n        )\n        OR NOT EXISTS (\n            -- No detections in g band\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n        )\n    )\n)\n-- Retrieve all features for these objects, ordered by their value in ascending order\nSELECT f.*\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM agn_objects)\nORDER BY f.value ASC, f.oid;\n```"
                },
                "in_toks": 6246,
                "out_toks": 398,
                "id": "chatcmpl-BwxFCoLanFTvAPQNKTy1BRMpadu0H",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "17",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection",
                "non_detection",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection', 'non_detection', 'feature_version']"
                },
                "in_toks": 630,
                "out_toks": 26,
                "id": "chatcmpl-BwvIoqSg85VPW4TMsCppc198pvx6c",
                "created": 1753382994,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the AGN class from the probability table\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n)\n-- Join with magstat for r band to check variability\nAND EXISTS (\n    SELECT 1\n    FROM magstat m_r\n    WHERE m_r.oid = o.oid\n      AND m_r.fid = 2 -- r band\n      AND (m_r.magsigma > 0 OR m_r.dm_first IS NOT NULL) -- variability in r band\n)\n-- Join with magstat for g band to check no detections or no variability\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1 -- g band\n          AND (m_g.ndet > 0 OR m_g.magsigma > 0 OR m_g.dm_first IS NOT NULL)\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the AGN class from the probability table\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n)\n-- Join with magstat for r band to check variability\nAND EXISTS (\n    SELECT 1\n    FROM magstat m_r\n    WHERE m_r.oid = o.oid\n      AND m_r.fid = 2 -- r band\n      AND (m_r.magsigma > 0 OR m_r.dm_first IS NOT NULL) -- variability in r band\n)\n-- Join with magstat for g band to check no detections or no variability\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1 -- g band\n          AND (m_g.ndet > 0 OR m_g.magsigma > 0 OR m_g.dm_first IS NOT NULL)\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```"
                },
                "in_toks": 6415,
                "out_toks": 318,
                "id": "chatcmpl-BwxFIJsSodC0YTI3DYQwh74FL5ZVK",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "17",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection",
                "non_detection",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection', 'non_detection', 'feature_version']"
                },
                "in_toks": 630,
                "out_toks": 26,
                "id": "chatcmpl-BwvIodJTPC2x4mUKLkk745HbwpqAi",
                "created": 1753382994,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score (deep learning real bogus score)\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name = 'drb'\n      AND p.ranking = 1\n)\n-- Join with magstat to check for variability in the r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2\n      AND (m.magsigma > 0 OR m.magmax - m.magmin > 0)\n)\n-- Check for no detections or no variability in the g band (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM detection d\n        WHERE d.oid = o.oid\n          AND d.fid = 1\n    )\n    OR NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n          AND (m2.magsigma > 0 OR m2.magmax - m2.magmin > 0)\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score (deep learning real bogus score)\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name = 'drb'\n      AND p.ranking = 1\n)\n-- Join with magstat to check for variability in the r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2\n      AND (m.magsigma > 0 OR m.magmax - m.magmin > 0)\n)\n-- Check for no detections or no variability in the g band (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM detection d\n        WHERE d.oid = o.oid\n          AND d.fid = 1\n    )\n    OR NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n          AND (m2.magsigma > 0 OR m2.magmax - m2.magmin > 0)\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```"
                },
                "in_toks": 6415,
                "out_toks": 329,
                "id": "chatcmpl-BwxFEzOrPZoBHBMBQWqMjNevKqql3",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "17",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection",
                "non_detection",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection', 'non_detection', 'feature_version']"
                },
                "in_toks": 630,
                "out_toks": 26,
                "id": "chatcmpl-BwvIpERK8Kl7dUOzxELraxBbgCXJv",
                "created": 1753382995,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'AGN' class from the 'probability' table\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n)\n-- Join with magstat to check for variability in the r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m_r\n    WHERE m_r.oid = o.oid\n      AND m_r.fid = 2\n      AND (m_r.magsigma > 0 OR m_r.dm_first IS NOT NULL)\n)\n-- Check for no detections or no variability in the g band (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1\n    )\n    OR (\n        EXISTS (\n            SELECT 1\n            FROM magstat m_g\n            WHERE m_g.oid = o.oid\n              AND m_g.fid = 1\n              AND (m_g.magsigma = 0 OR m_g.dm_first IS NULL)\n        )\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'AGN' class from the 'probability' table\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n)\n-- Join with magstat to check for variability in the r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m_r\n    WHERE m_r.oid = o.oid\n      AND m_r.fid = 2\n      AND (m_r.magsigma > 0 OR m_r.dm_first IS NOT NULL)\n)\n-- Check for no detections or no variability in the g band (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1\n    )\n    OR (\n        EXISTS (\n            SELECT 1\n            FROM magstat m_g\n            WHERE m_g.oid = o.oid\n              AND m_g.fid = 1\n              AND (m_g.magsigma = 0 OR m_g.dm_first IS NULL)\n        )\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```"
                },
                "in_toks": 6415,
                "out_toks": 352,
                "id": "chatcmpl-BwxFEhbdBixKYBw6VBJwrizBPzs2d",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "17",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection",
                "non_detection",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection', 'non_detection', 'feature_version']"
                },
                "in_toks": 630,
                "out_toks": 26,
                "id": "chatcmpl-BwvIqrhsq5cw6lYj0zRLDCECfRlhS",
                "created": 1753382996,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score (deep learning real bogus score)\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name = 'drb'\n      AND p.ranking = 1\n)\n-- Join with magstat to check variability in the r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2\n      AND (m.magsigma > 0 OR m.dm_first IS NOT NULL)\n)\n-- Check for g band detections or variability (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n    )\n    OR NOT (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n          AND (m2.magsigma > 0 OR m2.dm_first IS NOT NULL)\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score (deep learning real bogus score)\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name = 'drb'\n      AND p.ranking = 1\n)\n-- Join with magstat to check variability in the r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2\n      AND (m.magsigma > 0 OR m.dm_first IS NOT NULL)\n)\n-- Check for g band detections or variability (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n    )\n    OR NOT (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n          AND (m2.magsigma > 0 OR m2.dm_first IS NOT NULL)\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```"
                },
                "in_toks": 6415,
                "out_toks": 318,
                "id": "chatcmpl-BwxFB4M71mPbIAUISC4At7SvOu28r",
                "created": 1753390457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "17",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "magstat",
                "detection",
                "non_detection",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat', 'detection', 'non_detection', 'feature']"
                },
                "in_toks": 630,
                "out_toks": 22,
                "id": "chatcmpl-BwvIrel03mWcDvwK1xY86AkuJrTyS",
                "created": 1753382997,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object oids classified as AGN with variability in r band and no detections or no variability in g band\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND (m.magsigma > 0 OR m.magmax - m.magmin > 0) -- variability in r band\n    )\n    AND (\n        -- g band: no detections or no variability\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n        )\n        OR EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n              AND (m2.magsigma = 0 OR m2.magmax - m2.magmin = 0)\n        )\n    )\n)\nSELECT f.name, f.value\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM agn_objects)\nORDER BY f.value ASC, f.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object oids classified as AGN with variability in r band and no detections or no variability in g band\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND (m.magsigma > 0 OR m.magmax - m.magmin > 0) -- variability in r band\n    )\n    AND (\n        -- g band: no detections or no variability\n        NOT EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n        )\n        OR EXISTS (\n            SELECT 1\n            FROM magstat m2\n            WHERE m2.oid = o.oid\n              AND m2.fid = 1 -- g band\n              AND (m2.magsigma = 0 OR m2.magmax - m2.magmin = 0)\n        )\n    )\n)\nSELECT f.name, f.value\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM agn_objects)\nORDER BY f.value ASC, f.oid;\n```"
                },
                "in_toks": 6363,
                "out_toks": 356,
                "id": "chatcmpl-BwxFBTBdMZZxd1x1kRAtycCClKyZO",
                "created": 1753390457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "17",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection",
                "non_detection",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection', 'non_detection', 'feature_version']"
                },
                "in_toks": 630,
                "out_toks": 26,
                "id": "chatcmpl-BwvIrtj62adTU3nHbaEhL0JizDkZi",
                "created": 1753382997,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs classified as AGN with variability in r band and no detections or variability in g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'AGN' class from the 'probability' table\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- assuming a threshold for confident classification\n)\n-- Join with magstat to check for variability in r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2\n      AND (m.magmax - m.magmin) > 0.1 -- threshold for variability in r band\n)\n-- Check for no detections or no variability in g band (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n    )\n    OR\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n          AND (m2.magmax - m2.magmin) > 0.1 -- no significant variability in g band\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs classified as AGN with variability in r band and no detections or variability in g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'AGN' class from the 'probability' table\nWHERE o.oid IN (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- assuming a threshold for confident classification\n)\n-- Join with magstat to check for variability in r band (fid=2)\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2\n      AND (m.magmax - m.magmin) > 0.1 -- threshold for variability in r band\n)\n-- Check for no detections or no variability in g band (fid=1)\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n    )\n    OR\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1\n          AND (m2.magmax - m2.magmin) > 0.1 -- no significant variability in g band\n    )\n)\n-- Order the features by their value in ascending order\nORDER BY o.oid;\n```"
                },
                "in_toks": 6415,
                "out_toks": 373,
                "id": "chatcmpl-BwxFBhQLTYZvzXh7EjvLeQxtQZZhr",
                "created": 1753390457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "17",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection",
                "non_detection",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection', 'non_detection', 'feature_version']"
                },
                "in_toks": 630,
                "out_toks": 26,
                "id": "chatcmpl-BwvIsKPG9AZXt6MAhZk5S2c9stxey",
                "created": 1753382998,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs classified as AGN with variability in r band and no detections or variability in g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score (deep learning real bogus score) for AGN class\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n)\n-- Subquery to check for variability in the r band\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2 -- r band\n      AND (m.magmean_corr IS NOT NULL AND m.magsigma_corr > 0)\n)\n-- Subquery to ensure no detections or variability in the g band\nAND NOT EXISTS (\n    SELECT 1\n    FROM magstat m2\n    WHERE m2.oid = o.oid\n      AND m2.fid = 1 -- g band\n      AND (\n        m2.magmean_corr IS NOT NULL\n        AND (m2.magsigma_corr > 0 OR m2.ndet = 0)\n      )\n)\nORDER BY o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs classified as AGN with variability in r band and no detections or variability in g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score (deep learning real bogus score) for AGN class\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.ranking = 1\n)\n-- Subquery to check for variability in the r band\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2 -- r band\n      AND (m.magmean_corr IS NOT NULL AND m.magsigma_corr > 0)\n)\n-- Subquery to ensure no detections or variability in the g band\nAND NOT EXISTS (\n    SELECT 1\n    FROM magstat m2\n    WHERE m2.oid = o.oid\n      AND m2.fid = 1 -- g band\n      AND (\n        m2.magmean_corr IS NOT NULL\n        AND (m2.magsigma_corr > 0 OR m2.ndet = 0)\n      )\n)\nORDER BY o.oid;\n```"
                },
                "in_toks": 6415,
                "out_toks": 313,
                "id": "chatcmpl-BwxFCQIrXQHj81jfsPTUpCGRaGeOj",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "17",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "magstat",
                "detection",
                "non_detection",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat', 'detection', 'non_detection', 'feature']"
                },
                "in_toks": 630,
                "out_toks": 22,
                "id": "chatcmpl-BwvItG75CpYeHzTbYTTohTXnejueY",
                "created": 1753382999,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND (m.magsigma > 0 OR m.ndet > 0) -- variability or detections in r band\n    )\n    AND NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1 -- g band\n          AND (m2.magsigma > 0 OR m2.ndet > 0) -- no variability or detections in g band\n    )\n)\nSELECT f.*\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM agn_objects)\nORDER BY f.value ASC, f.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs classified as AGN with variability in the r band and no detections or no variability in the g band\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND (m.magsigma > 0 OR m.ndet > 0) -- variability or detections in r band\n    )\n    AND NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1 -- g band\n          AND (m2.magsigma > 0 OR m2.ndet > 0) -- no variability or detections in g band\n    )\n)\nSELECT f.*\nFROM feature f\nWHERE f.oid IN (SELECT oid FROM agn_objects)\nORDER BY f.value ASC, f.oid;\n```"
                },
                "in_toks": 6363,
                "out_toks": 299,
                "id": "chatcmpl-BwxFGWKTDoHHUCAzPvf6CiBSfmzJr",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "37": {
        "0": {
            "req_id": "37",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 769,
                "out_toks": 14,
                "id": "chatcmpl-BjAcjnJ7PJs8CG6592IVktIUmDFgP",
                "created": 1750105297,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n) sub\nJOIN probability p ON p.oid = sub.oid\nWHERE p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\nORDER BY p.probability DESC\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n) sub\nJOIN probability p ON p.oid = sub.oid\nWHERE p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\nORDER BY p.probability DESC\nLIMIT 200;\n```"
                },
                "in_toks": 2536,
                "out_toks": 145,
                "id": "chatcmpl-BwxFG5JnAQcjHCCGv7xx7GwKtkc76",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "37",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 769,
                "out_toks": 14,
                "id": "chatcmpl-BjAcjnJ7PJs8CG6592IVktIUmDFgP",
                "created": 1750105297,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nSELECT o.*\nFROM object o\nJOIN top_objects t ON o.oid = t.oid\nORDER BY t.probability DESC; -- Order final results by the probability of SNIa class in descending order\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nSELECT o.*\nFROM object o\nJOIN top_objects t ON o.oid = t.oid\nORDER BY t.probability DESC; -- Order final results by the probability of SNIa class in descending order\n```"
                },
                "in_toks": 1595,
                "out_toks": 155,
                "id": "chatcmpl-Bx07xW0yGH5LtRCD3ISg9BuztQ6De",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```"
                },
                "in_toks": 2536,
                "out_toks": 275,
                "id": "chatcmpl-BwxFJNbTl2B975FhbT0N7aiKIr376",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "37",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 616,
                "out_toks": 7,
                "id": "chatcmpl-BwvIu2xiue7UABeorZZIQb7iotLIs",
                "created": 1753383000,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Select object OIDs with the highest probability for SNIa class in the lc_classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Fetch all details for these objects from the object table\nJOIN object o ON o.oid = sub.oid\nORDER BY (SELECT p.probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'SNIa' AND p.classifier_name = 'lc_classifier' ORDER BY p.probability DESC LIMIT 1) DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Select object OIDs with the highest probability for SNIa class in the lc_classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Fetch all details for these objects from the object table\nJOIN object o ON o.oid = sub.oid\nORDER BY (SELECT p.probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'SNIa' AND p.classifier_name = 'lc_classifier' ORDER BY p.probability DESC LIMIT 1) DESC;\n```"
                },
                "in_toks": 2536,
                "out_toks": 187,
                "id": "chatcmpl-BwxFImYcvzOhGCqQq5toB0A2xJFLC",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "37",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 616,
                "out_toks": 7,
                "id": "chatcmpl-BwvIv8ET7SlbXWdhmT65G1wJnahMB",
                "created": 1753383001,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class, limited to top 200\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n),\nprobabilities AS (\n    -- Select the probability for each object OID for the SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n)\nSELECT o.*\nFROM object o\nJOIN top_objects tobj ON o.oid = tobj.oid\n-- Join with probabilities to order by probability in descending order\nJOIN probabilities p ON o.oid = p.oid\nORDER BY p.probability DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class, limited to top 200\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n),\nprobabilities AS (\n    -- Select the probability for each object OID for the SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n)\nSELECT o.*\nFROM object o\nJOIN top_objects tobj ON o.oid = tobj.oid\n-- Join with probabilities to order by probability in descending order\nJOIN probabilities p ON o.oid = p.oid\nORDER BY p.probability DESC;\n```"
                },
                "in_toks": 1597,
                "out_toks": 236,
                "id": "chatcmpl-Bx0P3RWwh9RCJ6kYvXbCmiLA3jDG6",
                "created": 1753402601,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Match object OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Match object OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```"
                },
                "in_toks": 2536,
                "out_toks": 276,
                "id": "chatcmpl-BwxFLCCy902ejmRhOXa8CZ5T9kAHh",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "37",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 616,
                "out_toks": 7,
                "id": "chatcmpl-BwvIw7diZkfBnNoJYRSjmYr1q741h",
                "created": 1753383002,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n) sub\nJOIN probability p ON p.oid = sub.oid\nWHERE p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nORDER BY p.probability DESC\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n) sub\nJOIN probability p ON p.oid = sub.oid\nWHERE p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nORDER BY p.probability DESC\nLIMIT 200;\n```"
                },
                "in_toks": 2536,
                "out_toks": 154,
                "id": "chatcmpl-BwxFLBLh1FuiQ8gISypBgZ7xnp4YS",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "37",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 616,
                "out_toks": 7,
                "id": "chatcmpl-BwvIxTUA07kgAitR05p18EfCfFR6z",
                "created": 1753383003,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n),\nprobabilities AS (\n    -- Get the probability for each object OID for the SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.oid IN (SELECT oid FROM top_objects)\n)\n-- Select object details, ordered by their SNIa probability in descending order\nSELECT o.*\nFROM object o\nJOIN probabilities p ON o.oid = p.oid\nORDER BY p.probability DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n),\nprobabilities AS (\n    -- Get the probability for each object OID for the SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.oid IN (SELECT oid FROM top_objects)\n)\n-- Select object details, ordered by their SNIa probability in descending order\nSELECT o.*\nFROM object o\nJOIN probabilities p ON o.oid = p.oid\nORDER BY p.probability DESC;\n```"
                },
                "in_toks": 1575,
                "out_toks": 212,
                "id": "chatcmpl-Bx0P4l8vVbqfUqxKsqxZe2QSLs8uS",
                "created": 1753402602,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```"
                },
                "in_toks": 2536,
                "out_toks": 265,
                "id": "chatcmpl-BwxFBxHbVE2vT5DLGg6VhghX3HTcf",
                "created": 1753390457,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "37",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 616,
                "out_toks": 7,
                "id": "chatcmpl-BwvIyBPEr3u9vxLg9WMcC4L5U2T3J",
                "created": 1753383004,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT o.*\nFROM (\n    -- Subquery to get object OIDs with the highest probability for SNIa in the lc_classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name = 'lc_classifier' AND class_name = 'SNIa')\n    ORDER BY p.probability DESC\n    LIMIT 200\n) AS top_oids\nJOIN object o ON o.oid = top_oids.oid\nORDER BY (SELECT p.probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'SNIa' AND p.classifier_name = 'lc_classifier' AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name = 'lc_classifier' AND class_name = 'SNIa')) DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT o.*\nFROM (\n    -- Subquery to get object OIDs with the highest probability for SNIa in the lc_classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name = 'lc_classifier' AND class_name = 'SNIa')\n    ORDER BY p.probability DESC\n    LIMIT 200\n) AS top_oids\nJOIN object o ON o.oid = top_oids.oid\nORDER BY (SELECT p.probability FROM probability p WHERE p.oid = o.oid AND p.class_name = 'SNIa' AND p.classifier_name = 'lc_classifier' AND p.classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name = 'lc_classifier' AND class_name = 'SNIa')) DESC;\n```"
                },
                "in_toks": 2536,
                "out_toks": 227,
                "id": "chatcmpl-BwxFKccrxB4LXSkFOn4ifeEqhmonC",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "37",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 616,
                "out_toks": 7,
                "id": "chatcmpl-BwvIzTqWeyS2gt0wocc6s2LpLaV70",
                "created": 1753383005,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nSELECT o.*\nFROM object o\nJOIN top_objects t ON o.oid = t.oid\nORDER BY t.probability DESC; -- Order the final results by probability in descending order\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nSELECT o.*\nFROM object o\nJOIN top_objects t ON o.oid = t.oid\nORDER BY t.probability DESC; -- Order the final results by probability in descending order\n```"
                },
                "in_toks": 1563,
                "out_toks": 140,
                "id": "chatcmpl-Bx07zboaxsWblspn89hRkCnDNwv50",
                "created": 1753401543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by probability in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by probability in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```"
                },
                "in_toks": 2536,
                "out_toks": 259,
                "id": "chatcmpl-BwxFDR3Kz1QU8cF6MWuSqJ1uitWId",
                "created": 1753390459,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "37",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 616,
                "out_toks": 7,
                "id": "chatcmpl-BwvIz6A5i0THXPPP9mQ5ltFLd3Ur8",
                "created": 1753383005,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n),\nprobabilities AS (\n    -- Get the probability for each object OID for SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n)\n-- Main query to fetch all details for these objects, ordered by their SNIa probability\nSELECT o.*\nFROM object o\nJOIN top_objects tobj ON o.oid = tobj.oid\nJOIN probabilities p ON o.oid = p.oid\nORDER BY p.probability DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH top_objects AS (\n    -- Select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n),\nprobabilities AS (\n    -- Get the probability for each object OID for SNIa class\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n)\n-- Main query to fetch all details for these objects, ordered by their SNIa probability\nSELECT o.*\nFROM object o\nJOIN top_objects tobj ON o.oid = tobj.oid\nJOIN probabilities p ON o.oid = p.oid\nORDER BY p.probability DESC;\n```"
                },
                "in_toks": 1575,
                "out_toks": 216,
                "id": "chatcmpl-Bx0878rBqgpFL72Jv4RV62JLkjkJX",
                "created": 1753401551,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    -- Subquery to select object OIDs with the highest probability for SNIa class\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n) sub\n-- Main query to fetch all details for these objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Select OIDs from the subquery\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nORDER BY (\n    -- Order the final results by the probability of SNIa class in descending order\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    LIMIT 1\n) DESC;\n```"
                },
                "in_toks": 2536,
                "out_toks": 265,
                "id": "chatcmpl-BwxFMwlDNd5uW2RGafDavAQrqqFBM",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "37",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']"
                },
                "in_toks": 616,
                "out_toks": 7,
                "id": "chatcmpl-BwvJ06ynQ4WdEu9JkJ0f6MKU66EwN",
                "created": 1753383006,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n) sub\nJOIN probability p ON p.oid = sub.oid\nWHERE p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\nORDER BY p.probability DESC\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nSELECT *\nFROM (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SNIa'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.ranking = 1\n    )\n) sub\nJOIN probability p ON p.oid = sub.oid\nWHERE p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\nORDER BY p.probability DESC\nLIMIT 200;\n```"
                },
                "in_toks": 2536,
                "out_toks": 145,
                "id": "chatcmpl-BwxFFGQ9o7xmf588xE4AyDuz9z4qG",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "34": {
        "0": {
            "req_id": "34",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']",
                    "1": "['object', 'feature']"
                },
                "in_toks": 858,
                "out_toks": 12,
                "id": "chatcmpl-BjAckjdKqrILPIoHt5jecc9oMRckM",
                "created": 1750105298,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4871,
                "out_toks": 201,
                "id": "chatcmpl-BwxFNI9QHWIAKQ4Tf1UaT2pi9eS0j",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "34",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']",
                    "1": "['object', 'feature']"
                },
                "in_toks": 858,
                "out_toks": 12,
                "id": "chatcmpl-BjAckjdKqrILPIoHt5jecc9oMRckM",
                "created": 1750105298,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT f.*\nFROM feature f\nWHERE f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')\n  AND f.name IN ('Amplitude', 'Multiband_period');",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT f.*\nFROM feature f\nWHERE f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')\n  AND f.name IN ('Amplitude', 'Multiband_period');"
                },
                "in_toks": 4871,
                "out_toks": 110,
                "id": "chatcmpl-BwxFHcQYHclj8AjmJTu5XizQxNR6R",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "34",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 705,
                "out_toks": 6,
                "id": "chatcmpl-BwvJ0r0coDrZmkDU8U1G8u0Is4fs5",
                "created": 1753383006,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT f.*\nFROM feature f\nJOIN oid_list o ON f.oid = o.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT f.*\nFROM feature f\nJOIN oid_list o ON f.oid = o.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4871,
                "out_toks": 176,
                "id": "chatcmpl-BwxFINOs1gxMgHUv6bEpc06HPiiIZ",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "34",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 705,
                "out_toks": 6,
                "id": "chatcmpl-BwvJ10OGjncfMSXPJJ7SVQZ3icGxG",
                "created": 1753383007,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4871,
                "out_toks": 201,
                "id": "chatcmpl-BwxFKrFs6UqtC74M3K98yey2Hysrd",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "34",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 705,
                "out_toks": 6,
                "id": "chatcmpl-BwvJ256J0LVY20eSLrGDT1wBxe5Pv",
                "created": 1753383008,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4871,
                "out_toks": 201,
                "id": "chatcmpl-BwxFC8NIkqK6p0euKX9JhzRtcGN2f",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "34",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 705,
                "out_toks": 6,
                "id": "chatcmpl-BwvJ3M9lhcOiz4v7cfouG9YaqcLZP",
                "created": 1753383009,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4871,
                "out_toks": 201,
                "id": "chatcmpl-BwxFCEf2vKfESa1dT8w0PKrP1uH1p",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "34",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 705,
                "out_toks": 6,
                "id": "chatcmpl-BwvJ3DqImjI0DkX1QETYU4d6s3mZi",
                "created": 1753383009,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4871,
                "out_toks": 201,
                "id": "chatcmpl-BwxFCMUTeQi7S5SyoPJzEqznKnfTq",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "34",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 705,
                "out_toks": 6,
                "id": "chatcmpl-BwvJ4wTQ7DbzvtfMLbtGVo3oaROzx",
                "created": 1753383010,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4871,
                "out_toks": 201,
                "id": "chatcmpl-BwxFCLqMadZ69ZRv3h1ZBLBSFBPya",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "34",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 705,
                "out_toks": 6,
                "id": "chatcmpl-BwvJ4bO87V5NKLLWU1xVlclhJCVKA",
                "created": 1753383010,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the list of object IDs\nWITH oid_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nWHERE\n    f.oid IN (SELECT oid FROM oid_list)\n    AND f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4871,
                "out_toks": 201,
                "id": "chatcmpl-BwxFC1OVeWjytanMeB7FP1nv5apAr",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "34",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']"
                },
                "in_toks": 705,
                "out_toks": 6,
                "id": "chatcmpl-BwvJ597jm0QuFM5iEDiqolqF4ilB9",
                "created": 1753383011,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT f.*\nFROM feature f\nWHERE f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')\n  AND f.name IN ('Amplitude', 'Multiband_period');",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT f.*\nFROM feature f\nWHERE f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')\n  AND f.name IN ('Amplitude', 'Multiband_period');"
                },
                "in_toks": 4871,
                "out_toks": 110,
                "id": "chatcmpl-BwxFEu3XShuylbPsuRcfqY4RdGfer",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "1": {
        "0": {
            "req_id": "1",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection']",
                    "1": "['object', 'probability', 'feature', 'detection']"
                },
                "in_toks": 891,
                "out_toks": 28,
                "id": "chatcmpl-BjAclj62JKNCgXPtiET0ukSrX2AdO",
                "created": 1750105299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Classify as AGN with probability > 0.6 and top ranking\n        EXISTS (\n            SELECT 1 FROM probability p\n            WHERE p.oid = o.oid \n              AND p.class_name = 'AGN' \n              AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') \n              AND p.probability > 0.6 \n              AND p.ranking = 1\n        )\n        -- Covering at least one year\n        AND (o.mjdendhist - o.mjdstarthist) >= 365\n        -- At least 20 detections\n        AND o.ndet >= 20\n),\nlight_curves AS (\n    SELECT \n        o.oid,\n        -- Max and Min magnitudes per band\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_max_g,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_min_g,\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_max_r,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_min_r,\n        -- Variations in bands\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1)) AS delta_mag_g,\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2)) AS delta_mag_r,\n        -- Mean coordinates\n        o.meanra,\n        o.meandec,\n        -- Number of detections\n        o.ndet\n    FROM detection d\n    JOIN agn_objects ao ON d.oid = ao.oid\n    JOIN object o ON o.oid = ao.oid\n    GROUP BY o.oid, o.meanra, o.meandec, o.ndet\n),\nvariability AS (\n    SELECT \n        lc.oid,\n        -- Variations larger than thresholds\n        lc.delta_mag_g,\n        lc.delta_mag_r\n    FROM light_curves lc\n    WHERE \n        -- Variations larger than 1 in g band\n        lc.delta_mag_g > 1\n        AND\n        -- Variations larger than 0.5 in r band\n        lc.delta_mag_r > 0.5\n)\nSELECT \n    ao.oid,\n    -- Retrieve feature value, name, version, and filter id for AGN\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS agn_fid,\n    -- Coordinates\n    ao.meanra,\n    ao.meandec,\n    -- Number of detections\n    ao.ndet,\n    -- Max and Min magnitudes in g band\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_max_g,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_min_g,\n    -- Max and Min magnitudes in r band\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_max_r,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_min_r,\n    -- Delta magnitudes\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS delta_mag_g,\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS delta_mag_r\nFROM agn_objects ao\nJOIN feature f ON ao.oid = f.oid\nJOIN variability v ON ao.oid = v.oid\nWHERE \n    -- Filter features for AGN\n    f.name = 'W2-W3' -- example feature, adjust as needed\n    AND f.value IS NOT NULL\n    -- Confirm AGN classification probability > 0.6\n    AND EXISTS (\n        SELECT 1 FROM probability p\n        WHERE p.oid = ao.oid \n          AND p.class_name = 'AGN' \n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') \n          AND p.probability > 0.6 \n          AND p.ranking = 1\n    )\n    -- Variations in bands\n    AND v.delta_mag_g > 1\n    AND v.delta_mag_r > 0.5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Classify as AGN with probability > 0.6 and top ranking\n        EXISTS (\n            SELECT 1 FROM probability p\n            WHERE p.oid = o.oid \n              AND p.class_name = 'AGN' \n              AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') \n              AND p.probability > 0.6 \n              AND p.ranking = 1\n        )\n        -- Covering at least one year\n        AND (o.mjdendhist - o.mjdstarthist) >= 365\n        -- At least 20 detections\n        AND o.ndet >= 20\n),\nlight_curves AS (\n    SELECT \n        o.oid,\n        -- Max and Min magnitudes per band\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_max_g,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_min_g,\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_max_r,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_min_r,\n        -- Variations in bands\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1)) AS delta_mag_g,\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2)) AS delta_mag_r,\n        -- Mean coordinates\n        o.meanra,\n        o.meandec,\n        -- Number of detections\n        o.ndet\n    FROM detection d\n    JOIN agn_objects ao ON d.oid = ao.oid\n    JOIN object o ON o.oid = ao.oid\n    GROUP BY o.oid, o.meanra, o.meandec, o.ndet\n),\nvariability AS (\n    SELECT \n        lc.oid,\n        -- Variations larger than thresholds\n        lc.delta_mag_g,\n        lc.delta_mag_r\n    FROM light_curves lc\n    WHERE \n        -- Variations larger than 1 in g band\n        lc.delta_mag_g > 1\n        AND\n        -- Variations larger than 0.5 in r band\n        lc.delta_mag_r > 0.5\n)\nSELECT \n    ao.oid,\n    -- Retrieve feature value, name, version, and filter id for AGN\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS agn_fid,\n    -- Coordinates\n    ao.meanra,\n    ao.meandec,\n    -- Number of detections\n    ao.ndet,\n    -- Max and Min magnitudes in g band\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_max_g,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_min_g,\n    -- Max and Min magnitudes in r band\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_max_r,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_min_r,\n    -- Delta magnitudes\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS delta_mag_g,\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS delta_mag_r\nFROM agn_objects ao\nJOIN feature f ON ao.oid = f.oid\nJOIN variability v ON ao.oid = v.oid\nWHERE \n    -- Filter features for AGN\n    f.name = 'W2-W3' -- example feature, adjust as needed\n    AND f.value IS NOT NULL\n    -- Confirm AGN classification probability > 0.6\n    AND EXISTS (\n        SELECT 1 FROM probability p\n        WHERE p.oid = ao.oid \n          AND p.class_name = 'AGN' \n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') \n          AND p.probability > 0.6 \n          AND p.ranking = 1\n    )\n    -- Variations in bands\n    AND v.delta_mag_g > 1\n    AND v.delta_mag_r > 0.5;\n```"
                },
                "in_toks": 6239,
                "out_toks": 1042,
                "id": "chatcmpl-Bx0P2K25xB9biOUgWDQ7rBqia9RKU",
                "created": 1753402600,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Classify as AGN with probability > 0.6 and top ranking\n        (SELECT probability FROM probability p \n         WHERE p.oid = o.oid AND p.class_name = 'AGN' AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') AND p.probability > 0.6 AND p.ranking = 1\n        ) IS NOT NULL\n        AND \n        -- Covering at least one year\n        (o.mjdendhist - o.mjdstarthist) >= 365\n        AND \n        -- At least 20 detections in any band\n        o.ndet >= 20\n),\nlight_curves AS (\n    SELECT \n        d.oid,\n        -- Max and Min magnitudes per band\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_max_g,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_min_g,\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_max_r,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_min_r,\n        -- Variations in bands\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1)) AS delta_mag_g,\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2)) AS delta_mag_r,\n        -- Mean coordinates\n        o.meanra,\n        o.meandec,\n        -- Number of detections\n        o.ndet\n    FROM detection d\n    JOIN agn_objects ao ON d.oid = ao.oid\n    GROUP BY d.oid, o.meanra, o.meandec, o.ndet\n),\nvariability AS (\n    SELECT \n        lc.oid,\n        -- Variations larger than thresholds\n        (lc.mag_max_g - lc.mag_min_g) AS delta_mag_g,\n        (lc.mag_max_r - lc.mag_min_r) AS delta_mag_r\n    FROM light_curves lc\n    WHERE \n        -- Variations larger than 1 in g band\n        (lc.mag_max_g - lc.mag_min_g) > 1\n        AND\n        -- Variations larger than 0.5 in r band\n        (lc.mag_max_r - lc.mag_min_r) > 0.5\n)\nSELECT \n    ao.oid,\n    -- Features: get value, name, version, filter id for AGN\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS agn_fid,\n    -- Coordinates\n    ao.meanra,\n    ao.meandec,\n    -- Number of detections\n    ao.ndet,\n    -- Max and Min magnitudes\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_max_g,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_min_g,\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_max_r,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_min_r,\n    -- Delta magnitudes\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS delta_mag_g,\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS delta_mag_r\nFROM agn_objects ao\nJOIN feature f ON ao.oid = f.oid\nJOIN variability v ON ao.oid = v.oid\nWHERE \n    -- Filter features for AGN\n    f.name = 'W2-W3' -- example feature, adjust as needed\n    AND f.value IS NOT NULL\n    -- Filter for AGN classification probability > 0.6\n    AND EXISTS (\n        SELECT 1 FROM probability p\n        WHERE p.oid = ao.oid AND p.class_name = 'AGN' AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') AND p.probability > 0.6 AND p.ranking = 1\n    )\n    -- Variations in bands\n    AND v.delta_mag_g > 1\n    AND v.delta_mag_r > 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Classify as AGN with probability > 0.6 and top ranking\n        (SELECT probability FROM probability p \n         WHERE p.oid = o.oid AND p.class_name = 'AGN' AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') AND p.probability > 0.6 AND p.ranking = 1\n        ) IS NOT NULL\n        AND \n        -- Covering at least one year\n        (o.mjdendhist - o.mjdstarthist) >= 365\n        AND \n        -- At least 20 detections in any band\n        o.ndet >= 20\n),\nlight_curves AS (\n    SELECT \n        d.oid,\n        -- Max and Min magnitudes per band\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_max_g,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1) AS mag_min_g,\n        MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_max_r,\n        MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2) AS mag_min_r,\n        -- Variations in bands\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 1) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 1)) AS delta_mag_g,\n        (MAX(d.magpsf_corr) FILTER (WHERE d.fid = 2) - MIN(d.magpsf_corr) FILTER (WHERE d.fid = 2)) AS delta_mag_r,\n        -- Mean coordinates\n        o.meanra,\n        o.meandec,\n        -- Number of detections\n        o.ndet\n    FROM detection d\n    JOIN agn_objects ao ON d.oid = ao.oid\n    GROUP BY d.oid, o.meanra, o.meandec, o.ndet\n),\nvariability AS (\n    SELECT \n        lc.oid,\n        -- Variations larger than thresholds\n        (lc.mag_max_g - lc.mag_min_g) AS delta_mag_g,\n        (lc.mag_max_r - lc.mag_min_r) AS delta_mag_r\n    FROM light_curves lc\n    WHERE \n        -- Variations larger than 1 in g band\n        (lc.mag_max_g - lc.mag_min_g) > 1\n        AND\n        -- Variations larger than 0.5 in r band\n        (lc.mag_max_r - lc.mag_min_r) > 0.5\n)\nSELECT \n    ao.oid,\n    -- Features: get value, name, version, filter id for AGN\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS agn_fid,\n    -- Coordinates\n    ao.meanra,\n    ao.meandec,\n    -- Number of detections\n    ao.ndet,\n    -- Max and Min magnitudes\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_max_g,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS mag_min_g,\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_max_r,\n    (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS mag_min_r,\n    -- Delta magnitudes\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 1) AS delta_mag_g,\n    (SELECT MAX(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) - (SELECT MIN(magpsf_corr) FROM detection WHERE oid = ao.oid AND fid = 2) AS delta_mag_r\nFROM agn_objects ao\nJOIN feature f ON ao.oid = f.oid\nJOIN variability v ON ao.oid = v.oid\nWHERE \n    -- Filter features for AGN\n    f.name = 'W2-W3' -- example feature, adjust as needed\n    AND f.value IS NOT NULL\n    -- Filter for AGN classification probability > 0.6\n    AND EXISTS (\n        SELECT 1 FROM probability p\n        WHERE p.oid = ao.oid AND p.class_name = 'AGN' AND p.classifier_name IN ('lc_classifier', 'stamp_classifier') AND p.probability > 0.6 AND p.ranking = 1\n    )\n    -- Variations in bands\n    AND v.delta_mag_g > 1\n    AND v.delta_mag_r > 0.5;\n```"
                },
                "in_toks": 5637,
                "out_toks": 1044,
                "id": "chatcmpl-BwxFFH6poItMipAKjx8lwRTlyQwIP",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "1",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection']",
                    "1": "['object', 'probability', 'feature', 'detection']"
                },
                "in_toks": 891,
                "out_toks": 28,
                "id": "chatcmpl-BjAclj62JKNCgXPtiET0ukSrX2AdO",
                "created": 1750105299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Optimized and corrected SQL query with nested subqueries to improve performance and ensure proper filtering\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Confirm object is classified as AGN with probability > 0.6 and top ranking\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'AGN'\n              AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n              AND p.probability > 0.6\n              AND p.ranking = 1\n        )\n        -- Cover at least one year of observations\n        AND (o.mjdendhist - o.mjdstarthist) >= 365\n        -- Ensure at least 20 detections in total\n        AND (\n            SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid\n        ) >= 20\n),\nlight_curves AS (\n    SELECT \n        d.oid,\n        -- Max and min corrected magnitudes per band\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_max,\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_min,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_max,\n        MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_min,\n        -- Count detections per band\n        COUNT(CASE WHEN d.fid = 1 THEN 1 END) AS n_det_g,\n        COUNT(CASE WHEN d.fid = 2 THEN 1 END) AS n_det_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nvariability AS (\n    SELECT \n        d.oid,\n        -- Variations in magnitudes per band\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS delta_mag_g,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS delta_mag_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nfeatures AS (\n    SELECT \n        f.oid,\n        -- Mean coordinates\n        MAX(CASE WHEN f.name = 'meanra' AND f.fid = 0 THEN f.value END) AS meanra,\n        MAX(CASE WHEN f.name = 'meandec' AND f.fid = 0 THEN f.value END) AS meandec,\n        -- Max and min magnitudes for bands\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS max_mag_g,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS min_mag_g,\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS max_mag_r,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS min_mag_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY f.oid\n)\nSELECT \n    a.oid,\n    f.meanra,\n    f.meandec,\n    -- Total number of detections\n    (SELECT COUNT(*) FROM detection d WHERE d.oid = a.oid) AS n_detections,\n    -- Max and min magnitudes\n    f.max_mag_g,\n    f.min_mag_g,\n    f.max_mag_r,\n    f.min_mag_r,\n    -- Variations in magnitudes\n    v.delta_mag_g,\n    v.delta_mag_r\nFROM agn_objects a\nJOIN features f ON a.oid = f.oid\nJOIN variability v ON a.oid = v.oid\nWHERE \n    -- Variations exceed thresholds: larger than 1 mag in g, larger than 0.5 in r\n    v.delta_mag_g > 1\n    AND v.delta_mag_r > 0.5\n-- Optional: add further filters if needed, e.g., on number of detections or date ranges\n;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized and corrected SQL query with nested subqueries to improve performance and ensure proper filtering\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Confirm object is classified as AGN with probability > 0.6 and top ranking\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'AGN'\n              AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n              AND p.probability > 0.6\n              AND p.ranking = 1\n        )\n        -- Cover at least one year of observations\n        AND (o.mjdendhist - o.mjdstarthist) >= 365\n        -- Ensure at least 20 detections in total\n        AND (\n            SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid\n        ) >= 20\n),\nlight_curves AS (\n    SELECT \n        d.oid,\n        -- Max and min corrected magnitudes per band\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_max,\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_min,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_max,\n        MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_min,\n        -- Count detections per band\n        COUNT(CASE WHEN d.fid = 1 THEN 1 END) AS n_det_g,\n        COUNT(CASE WHEN d.fid = 2 THEN 1 END) AS n_det_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nvariability AS (\n    SELECT \n        d.oid,\n        -- Variations in magnitudes per band\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS delta_mag_g,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS delta_mag_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nfeatures AS (\n    SELECT \n        f.oid,\n        -- Mean coordinates\n        MAX(CASE WHEN f.name = 'meanra' AND f.fid = 0 THEN f.value END) AS meanra,\n        MAX(CASE WHEN f.name = 'meandec' AND f.fid = 0 THEN f.value END) AS meandec,\n        -- Max and min magnitudes for bands\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS max_mag_g,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS min_mag_g,\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS max_mag_r,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS min_mag_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY f.oid\n)\nSELECT \n    a.oid,\n    f.meanra,\n    f.meandec,\n    -- Total number of detections\n    (SELECT COUNT(*) FROM detection d WHERE d.oid = a.oid) AS n_detections,\n    -- Max and min magnitudes\n    f.max_mag_g,\n    f.min_mag_g,\n    f.max_mag_r,\n    f.min_mag_r,\n    -- Variations in magnitudes\n    v.delta_mag_g,\n    v.delta_mag_r\nFROM agn_objects a\nJOIN features f ON a.oid = f.oid\nJOIN variability v ON a.oid = v.oid\nWHERE \n    -- Variations exceed thresholds: larger than 1 mag in g, larger than 0.5 in r\n    v.delta_mag_g > 1\n    AND v.delta_mag_r > 0.5\n-- Optional: add further filters if needed, e.g., on number of detections or date ranges\n;\n"
                },
                "in_toks": 6137,
                "out_toks": 956,
                "id": "chatcmpl-Bx07xDiVIFvKhvFvDABLVPKlioF9P",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Classify as AGN with probability > 0.6 and top ranking\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'AGN'\n              AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n              AND p.probability > 0.6\n              AND p.ranking = 1\n        )\n        -- Covering at least one year\n        AND (o.mjdendhist - o.mjdstarthist) >= 365\n        -- At least 20 detections in any band\n        AND (\n            SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid\n        ) >= 20\n),\nlight_curves AS (\n    SELECT \n        d.oid,\n        -- Filter for corrected magnitudes\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_max,\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_min,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_max,\n        MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_min,\n        -- Max and min magnitudes for detection counts\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS delta_g,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS delta_r,\n        -- Count detections per band\n        COUNT(CASE WHEN d.fid = 1 THEN 1 END) AS n_det_g,\n        COUNT(CASE WHEN d.fid = 2 THEN 1 END) AS n_det_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nvariability AS (\n    SELECT \n        d.oid,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_g,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS delta_mag_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nfeatures AS (\n    SELECT \n        f.oid,\n        -- Select feature values for mean coordinates\n        MAX(CASE WHEN f.name = 'meanra' AND f.fid = 0 THEN f.value END) AS meanra,\n        MAX(CASE WHEN f.name = 'meandec' AND f.fid = 0 THEN f.value END) AS meandec,\n        -- Max and min magnitudes\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS max_mag_g,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS min_mag_g,\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS max_mag_r,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS min_mag_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY f.oid\n)\nSELECT \n    a.oid,\n    f.meanra,\n    f.meandec,\n    -- Number of detections\n    (SELECT COUNT(*) FROM detection d WHERE d.oid = a.oid) AS n_detections,\n    -- Max and min magnitudes\n    f.max_mag_g,\n    f.min_mag_g,\n    f.max_mag_r,\n    f.min_mag_r,\n    -- Variations\n    v.delta_mag_g,\n    v.delta_mag_r\nFROM agn_objects a\nJOIN features f ON a.oid = f.oid\nJOIN variability v ON a.oid = v.oid\nWHERE \n    -- Variations larger than thresholds\n    v.delta_mag_g > 1 AND v.delta_mag_r > 0.5\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE \n        -- Classify as AGN with probability > 0.6 and top ranking\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'AGN'\n              AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n              AND p.probability > 0.6\n              AND p.ranking = 1\n        )\n        -- Covering at least one year\n        AND (o.mjdendhist - o.mjdstarthist) >= 365\n        -- At least 20 detections in any band\n        AND (\n            SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid\n        ) >= 20\n),\nlight_curves AS (\n    SELECT \n        d.oid,\n        -- Filter for corrected magnitudes\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_max,\n        MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS mag_g_min,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_max,\n        MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS mag_r_min,\n        -- Max and min magnitudes for detection counts\n        MAX(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 1 THEN d.magpsf_corr END) AS delta_g,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS delta_r,\n        -- Count detections per band\n        COUNT(CASE WHEN d.fid = 1 THEN 1 END) AS n_det_g,\n        COUNT(CASE WHEN d.fid = 2 THEN 1 END) AS n_det_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nvariability AS (\n    SELECT \n        d.oid,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) AS delta_mag_g,\n        MAX(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) - MIN(CASE WHEN d.fid = 2 THEN d.magpsf_corr END) AS delta_mag_r\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY d.oid\n),\nfeatures AS (\n    SELECT \n        f.oid,\n        -- Select feature values for mean coordinates\n        MAX(CASE WHEN f.name = 'meanra' AND f.fid = 0 THEN f.value END) AS meanra,\n        MAX(CASE WHEN f.name = 'meandec' AND f.fid = 0 THEN f.value END) AS meandec,\n        -- Max and min magnitudes\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS max_mag_g,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 1 THEN f.value END) AS min_mag_g,\n        MAX(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS max_mag_r,\n        MIN(CASE WHEN f.name = 'max_mag' AND f.fid = 2 THEN f.value END) AS min_mag_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM agn_objects)\n    GROUP BY f.oid\n)\nSELECT \n    a.oid,\n    f.meanra,\n    f.meandec,\n    -- Number of detections\n    (SELECT COUNT(*) FROM detection d WHERE d.oid = a.oid) AS n_detections,\n    -- Max and min magnitudes\n    f.max_mag_g,\n    f.min_mag_g,\n    f.max_mag_r,\n    f.min_mag_r,\n    -- Variations\n    v.delta_mag_g,\n    v.delta_mag_r\nFROM agn_objects a\nJOIN features f ON a.oid = f.oid\nJOIN variability v ON a.oid = v.oid\nWHERE \n    -- Variations larger than thresholds\n    v.delta_mag_g > 1 AND v.delta_mag_r > 0.5\n```"
                },
                "in_toks": 5637,
                "out_toks": 956,
                "id": "chatcmpl-BwxFG37eDhBSZwhFokfHIqf42x1LK",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "1",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 738,
                "out_toks": 18,
                "id": "chatcmpl-BwvJ5SXlXyN0YB7ScEKLOp01xA9SR",
                "created": 1753383011,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdendhist - o.mjdstarthist >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat g ON g.oid = o.oid AND g.fid = 1\n    JOIN magstat r ON r.oid = o.oid AND r.fid = 2\n    WHERE g.magmax - g.magmin > 1\n      AND r.magmax - r.magmin > 0.5\n),\n-- Combine all filters\nfiltered_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN long_duration_objects ld ON o.oid = ld.oid\n    JOIN variable_objects v ON o.oid = v.oid\n)\n-- Final selection with required features and properties\nSELECT\n    o.oid,\n    -- Select features: value, name, version, filter id\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS features_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    g.magmax AS magmax_g,\n    g.magmin AS magmin_g,\n    r.magmax AS magmax_r,\n    r.magmin AS magmin_r,\n    -- Calculate delta magnitudes\n    (g.magmax - g.magmin) AS delta_mag_g,\n    (r.magmax - r.magmin) AS delta_mag_r\nFROM filtered_objects fo\nJOIN object o ON o.oid = fo.oid\nLEFT JOIN feature f ON f.oid = o.oid\nLEFT JOIN magstat g ON g.oid = o.oid AND g.fid = 1\nLEFT JOIN magstat r ON r.oid = o.oid AND r.fid = 2\nWHERE f.name IN ('Amplitude', 'magmax', 'magmin')\n  AND f.value IS NOT NULL\n  AND f.version IS NOT NULL\n  AND f.name IN ('magmax', 'magmin')\n  AND f.fid IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdendhist - o.mjdstarthist >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat g ON g.oid = o.oid AND g.fid = 1\n    JOIN magstat r ON r.oid = o.oid AND r.fid = 2\n    WHERE g.magmax - g.magmin > 1\n      AND r.magmax - r.magmin > 0.5\n),\n-- Combine all filters\nfiltered_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN long_duration_objects ld ON o.oid = ld.oid\n    JOIN variable_objects v ON o.oid = v.oid\n)\n-- Final selection with required features and properties\nSELECT\n    o.oid,\n    -- Select features: value, name, version, filter id\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS features_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    g.magmax AS magmax_g,\n    g.magmin AS magmin_g,\n    r.magmax AS magmax_r,\n    r.magmin AS magmin_r,\n    -- Calculate delta magnitudes\n    (g.magmax - g.magmin) AS delta_mag_g,\n    (r.magmax - r.magmin) AS delta_mag_r\nFROM filtered_objects fo\nJOIN object o ON o.oid = fo.oid\nLEFT JOIN feature f ON f.oid = o.oid\nLEFT JOIN magstat g ON g.oid = o.oid AND g.fid = 1\nLEFT JOIN magstat r ON r.oid = o.oid AND r.fid = 2\nWHERE f.name IN ('Amplitude', 'magmax', 'magmin')\n  AND f.value IS NOT NULL\n  AND f.version IS NOT NULL\n  AND f.name IN ('magmax', 'magmin')\n  AND f.fid IN (1, 2);\n```"
                },
                "in_toks": 6353,
                "out_toks": 585,
                "id": "chatcmpl-BwxFGEksCpvVBa1nMwJy60qCNynEi",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "1",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 738,
                "out_toks": 18,
                "id": "chatcmpl-BwvJ6W287JHVDSes8VEydRXyYNFuU",
                "created": 1753383012,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Optimized and corrected SQL query with nested subqueries to improve performance and ensure proper filtering\nWITH agn_objects AS (\n    -- Select objects with AGN classification probability > 0.6 and ranking=1 for the specified classifiers\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n),\nlong_duration_objects AS (\n    -- Select objects with light curves spanning at least 365 days and at least 20 detections\n    SELECT o.oid\n    FROM object o\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndet >= 20\n),\nvariable_objects AS (\n    -- Select objects with magnitude variations larger than thresholds in g and r bands\n    SELECT o.oid\n    FROM object o\n    JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\n    JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\n    WHERE (m_g.magmax - m_g.magmin) > 1\n      AND (m_r.magmax - m_r.magmin) > 0.5\n),\n-- Combine all conditions to filter objects satisfying all criteria\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Retrieve detailed info for filtered objects, including maximum probability, features, and magnitude variations\nSELECT\n    o.oid,\n    -- Get the maximum probability for AGN class (from probability table with ranking=1)\n    p.probability AS agn_probability,\n    -- Select features of interest\n    f.name AS feature_name,\n    f.value AS feature_value,\n    f.version AS feature_version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Calculate delta magnitudes for g and r bands\n    (m_g.magmax - m_g.magmin) AS g_delta_mag,\n    (m_r.magmax - m_r.magmin) AS r_delta_mag\nFROM object o\nLEFT JOIN probability p ON p.oid = o.oid\n  AND p.class_name = 'AGN'\n  AND p.ranking = 1\n  AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\nLEFT JOIN feature f ON f.oid = o.oid\nLEFT JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\nLEFT JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\nWHERE o.oid IN (SELECT oid FROM filtered_objects)\n  AND f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmax', 'magmin')\n  AND f.value IS NOT NULL\nORDER BY o.oid;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized and corrected SQL query with nested subqueries to improve performance and ensure proper filtering\nWITH agn_objects AS (\n    -- Select objects with AGN classification probability > 0.6 and ranking=1 for the specified classifiers\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n),\nlong_duration_objects AS (\n    -- Select objects with light curves spanning at least 365 days and at least 20 detections\n    SELECT o.oid\n    FROM object o\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndet >= 20\n),\nvariable_objects AS (\n    -- Select objects with magnitude variations larger than thresholds in g and r bands\n    SELECT o.oid\n    FROM object o\n    JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\n    JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\n    WHERE (m_g.magmax - m_g.magmin) > 1\n      AND (m_r.magmax - m_r.magmin) > 0.5\n),\n-- Combine all conditions to filter objects satisfying all criteria\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Retrieve detailed info for filtered objects, including maximum probability, features, and magnitude variations\nSELECT\n    o.oid,\n    -- Get the maximum probability for AGN class (from probability table with ranking=1)\n    p.probability AS agn_probability,\n    -- Select features of interest\n    f.name AS feature_name,\n    f.value AS feature_value,\n    f.version AS feature_version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Calculate delta magnitudes for g and r bands\n    (m_g.magmax - m_g.magmin) AS g_delta_mag,\n    (m_r.magmax - m_r.magmin) AS r_delta_mag\nFROM object o\nLEFT JOIN probability p ON p.oid = o.oid\n  AND p.class_name = 'AGN'\n  AND p.ranking = 1\n  AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\nLEFT JOIN feature f ON f.oid = o.oid\nLEFT JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\nLEFT JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\nWHERE o.oid IN (SELECT oid FROM filtered_objects)\n  AND f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmax', 'magmin')\n  AND f.value IS NOT NULL\nORDER BY o.oid;\n"
                },
                "in_toks": 6098,
                "out_toks": 720,
                "id": "chatcmpl-Bx07x2HqL6N8AImj7NsjCb8MtNktU",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\n    JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\n    WHERE m_g.magmax - m_g.magmin > 1\n      AND m_r.magmax - m_r.magmin > 0.5\n),\n-- Combine all conditions\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Retrieve required information for the filtered objects\nSELECT\n    o.oid,\n    -- Get the maximum probability for AGN class\n    p.probability AS agn_probability,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    f.version AS feature_version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Calculate delta magnitudes\n    (m_g.magmax - m_g.magmin) AS g_delta_mag,\n    (m_r.magmax - m_r.magmin) AS r_delta_mag\nFROM object o\nLEFT JOIN probability p ON p.oid = o.oid AND p.class_name = 'AGN' AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier') AND p.probability > 0.6\nLEFT JOIN feature f ON f.oid = o.oid\nLEFT JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\nLEFT JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\nWHERE o.oid IN (SELECT oid FROM filtered_objects)\n  AND f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmax', 'magmin')\n  AND f.value IS NOT NULL\nORDER BY o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\n    JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\n    WHERE m_g.magmax - m_g.magmin > 1\n      AND m_r.magmax - m_r.magmin > 0.5\n),\n-- Combine all conditions\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Retrieve required information for the filtered objects\nSELECT\n    o.oid,\n    -- Get the maximum probability for AGN class\n    p.probability AS agn_probability,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    f.version AS feature_version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Calculate delta magnitudes\n    (m_g.magmax - m_g.magmin) AS g_delta_mag,\n    (m_r.magmax - m_r.magmin) AS r_delta_mag\nFROM object o\nLEFT JOIN probability p ON p.oid = o.oid AND p.class_name = 'AGN' AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier') AND p.probability > 0.6\nLEFT JOIN feature f ON f.oid = o.oid\nLEFT JOIN magstat m_g ON m_g.oid = o.oid AND m_g.fid = 1\nLEFT JOIN magstat m_r ON m_r.oid = o.oid AND m_r.fid = 2\nWHERE o.oid IN (SELECT oid FROM filtered_objects)\n  AND f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmax', 'magmin')\n  AND f.value IS NOT NULL\nORDER BY o.oid;\n```"
                },
                "in_toks": 6353,
                "out_toks": 673,
                "id": "chatcmpl-BwxFHDi5qEsPth2XTgafcu3HcgQhm",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "1",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 738,
                "out_toks": 18,
                "id": "chatcmpl-BwvJ7JUFanpwaVYUg2AoRsBZpANmD",
                "created": 1753383013,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n),\nlight_curve_stats AS (\n    SELECT\n        o.oid,\n        MIN(magmean_corr) AS mag_mean,\n        MAX(magmean_corr) AS mag_max,\n        MIN(magmean_corr) AS mag_min,\n        MAX(magmean_corr) - MIN(magmean_corr) AS delta_mag,\n        -- Corrected: specify table alias for lastmjd and firstmjd to avoid ambiguity\n        MAX(o.lastmjd) AS lastmjd,\n        MIN(o.firstmjd) AS firstmjd,\n        MAX(o.lastmjd) - MIN(o.firstmjd) AS duration_days,\n        COUNT(*) AS detections_in_band\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nvariability AS (\n    SELECT\n        o.oid,\n        MAX(CASE WHEN m.fid = 1 THEN m.magmax_corr END) AS g_mag_max,\n        MIN(CASE WHEN m.fid = 1 THEN m.magmin_corr END) AS g_mag_min,\n        MAX(CASE WHEN m.fid = 2 THEN m.magmax_corr END) AS r_mag_max,\n        MIN(CASE WHEN m.fid = 2 THEN m.magmin_corr END) AS r_mag_min\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        lc.detections_in_band,\n        g.g_mag_max,\n        g.g_mag_min,\n        r.r_mag_max,\n        r.r_mag_min,\n        g.delta_mag AS delta_mag_g,\n        r.delta_mag AS delta_mag_r\n    FROM agn_objects o\n    JOIN light_curve_stats lc ON o.oid = lc.oid\n    JOIN variability g ON o.oid = g.oid\n    JOIN variability r ON o.oid = r.oid\n    WHERE\n        -- Corrected: use duration_days from light_curve_stats\n        lc.duration_days >= 365\n        AND (lc.detections_in_band >= 20)\n        AND g.delta_mag > 1\n        AND r.delta_mag > 0.5\n)\nSELECT\n    fo.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    fo.meanra,\n    fo.meandec,\n    (SELECT COUNT(*) FROM magstat m WHERE m.oid = fo.oid AND m.corrected = TRUE) AS \"magstat_ndet\",\n    fo.g_mag_max,\n    fo.g_mag_min,\n    fo.r_mag_max,\n    fo.r_mag_min,\n    fo.delta_mag_g,\n    fo.delta_mag_r\nFROM filtered_objects fo\nJOIN feature f ON fo.oid = f.oid\nWHERE\n    f.name IN ('g-r_max_corr', 'g-r_mean_corr', 'g-r_max', 'g-r_mean')\n    AND f.fid IN (1, 2);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n),\nlight_curve_stats AS (\n    SELECT\n        o.oid,\n        MIN(magmean_corr) AS mag_mean,\n        MAX(magmean_corr) AS mag_max,\n        MIN(magmean_corr) AS mag_min,\n        MAX(magmean_corr) - MIN(magmean_corr) AS delta_mag,\n        -- Corrected: specify table alias for lastmjd and firstmjd to avoid ambiguity\n        MAX(o.lastmjd) AS lastmjd,\n        MIN(o.firstmjd) AS firstmjd,\n        MAX(o.lastmjd) - MIN(o.firstmjd) AS duration_days,\n        COUNT(*) AS detections_in_band\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nvariability AS (\n    SELECT\n        o.oid,\n        MAX(CASE WHEN m.fid = 1 THEN m.magmax_corr END) AS g_mag_max,\n        MIN(CASE WHEN m.fid = 1 THEN m.magmin_corr END) AS g_mag_min,\n        MAX(CASE WHEN m.fid = 2 THEN m.magmax_corr END) AS r_mag_max,\n        MIN(CASE WHEN m.fid = 2 THEN m.magmin_corr END) AS r_mag_min\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        lc.detections_in_band,\n        g.g_mag_max,\n        g.g_mag_min,\n        r.r_mag_max,\n        r.r_mag_min,\n        g.delta_mag AS delta_mag_g,\n        r.delta_mag AS delta_mag_r\n    FROM agn_objects o\n    JOIN light_curve_stats lc ON o.oid = lc.oid\n    JOIN variability g ON o.oid = g.oid\n    JOIN variability r ON o.oid = r.oid\n    WHERE\n        -- Corrected: use duration_days from light_curve_stats\n        lc.duration_days >= 365\n        AND (lc.detections_in_band >= 20)\n        AND g.delta_mag > 1\n        AND r.delta_mag > 0.5\n)\nSELECT\n    fo.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    fo.meanra,\n    fo.meandec,\n    (SELECT COUNT(*) FROM magstat m WHERE m.oid = fo.oid AND m.corrected = TRUE) AS \"magstat_ndet\",\n    fo.g_mag_max,\n    fo.g_mag_min,\n    fo.r_mag_max,\n    fo.r_mag_min,\n    fo.delta_mag_g,\n    fo.delta_mag_r\nFROM filtered_objects fo\nJOIN feature f ON fo.oid = f.oid\nWHERE\n    f.name IN ('g-r_max_corr', 'g-r_mean_corr', 'g-r_max', 'g-r_mean')\n    AND f.fid IN (1, 2);\n```"
                },
                "in_toks": 6160,
                "out_toks": 759,
                "id": "chatcmpl-Bx07xJRvSzX3KNTHChpuqatwjGXyL",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n),\nlight_curve_stats AS (\n    SELECT\n        o.oid,\n        MIN(magmean_corr) AS mag_mean,\n        MAX(magmean_corr) AS mag_max,\n        MIN(magmean_corr) AS mag_min,\n        MAX(magmean_corr) - MIN(magmean_corr) AS delta_mag,\n        MAX(lastmjd) - MIN(firstmjd) AS duration_days,\n        COUNT(*) AS detections_in_band\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nvariability AS (\n    SELECT\n        o.oid,\n        MAX(CASE WHEN m.fid = 1 THEN m.magmax_corr END) AS g_mag_max,\n        MIN(CASE WHEN m.fid = 1 THEN m.magmin_corr END) AS g_mag_min,\n        MAX(CASE WHEN m.fid = 2 THEN m.magmax_corr END) AS r_mag_max,\n        MIN(CASE WHEN m.fid = 2 THEN m.magmin_corr END) AS r_mag_min\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        lc.detections_in_band,\n        g.g_mag_max,\n        g.g_mag_min,\n        r.r_mag_max,\n        r.r_mag_min,\n        g.delta_mag AS delta_mag_g,\n        r.delta_mag AS delta_mag_r\n    FROM agn_objects o\n    JOIN light_curve_stats lc ON o.oid = lc.oid\n    JOIN variability g ON o.oid = g.oid\n    JOIN variability r ON o.oid = r.oid\n    WHERE\n        lc.duration_days >= 365\n        AND (g.detections_in_band >= 20 OR r.detections_in_band >= 20)\n        AND g.delta_mag > 1\n        AND r.delta_mag > 0.5\n)\nSELECT\n    fo.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    fo.meanra,\n    fo.meandec,\n    (SELECT COUNT(*) FROM magstat m WHERE m.oid = fo.oid AND m.corrected = TRUE) AS \"magstat_ndet\",\n    fo.g_mag_max,\n    fo.g_mag_min,\n    fo.r_mag_max,\n    fo.r_mag_min,\n    fo.delta_mag_g,\n    fo.delta_mag_r\nFROM filtered_objects fo\nJOIN feature f ON fo.oid = f.oid\nWHERE\n    f.name IN ('g-r_max_corr', 'g-r_mean_corr', 'g-r_max', 'g-r_mean')\n    AND f.fid IN (1, 2)\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.probability > 0.6\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n    )\n),\nlight_curve_stats AS (\n    SELECT\n        o.oid,\n        MIN(magmean_corr) AS mag_mean,\n        MAX(magmean_corr) AS mag_max,\n        MIN(magmean_corr) AS mag_min,\n        MAX(magmean_corr) - MIN(magmean_corr) AS delta_mag,\n        MAX(lastmjd) - MIN(firstmjd) AS duration_days,\n        COUNT(*) AS detections_in_band\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nvariability AS (\n    SELECT\n        o.oid,\n        MAX(CASE WHEN m.fid = 1 THEN m.magmax_corr END) AS g_mag_max,\n        MIN(CASE WHEN m.fid = 1 THEN m.magmin_corr END) AS g_mag_min,\n        MAX(CASE WHEN m.fid = 2 THEN m.magmax_corr END) AS r_mag_max,\n        MIN(CASE WHEN m.fid = 2 THEN m.magmin_corr END) AS r_mag_min\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE m.corrected = TRUE\n    GROUP BY o.oid\n),\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        lc.detections_in_band,\n        g.g_mag_max,\n        g.g_mag_min,\n        r.r_mag_max,\n        r.r_mag_min,\n        g.delta_mag AS delta_mag_g,\n        r.delta_mag AS delta_mag_r\n    FROM agn_objects o\n    JOIN light_curve_stats lc ON o.oid = lc.oid\n    JOIN variability g ON o.oid = g.oid\n    JOIN variability r ON o.oid = r.oid\n    WHERE\n        lc.duration_days >= 365\n        AND (g.detections_in_band >= 20 OR r.detections_in_band >= 20)\n        AND g.delta_mag > 1\n        AND r.delta_mag > 0.5\n)\nSELECT\n    fo.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    fo.meanra,\n    fo.meandec,\n    (SELECT COUNT(*) FROM magstat m WHERE m.oid = fo.oid AND m.corrected = TRUE) AS \"magstat_ndet\",\n    fo.g_mag_max,\n    fo.g_mag_min,\n    fo.r_mag_max,\n    fo.r_mag_min,\n    fo.delta_mag_g,\n    fo.delta_mag_r\nFROM filtered_objects fo\nJOIN feature f ON fo.oid = f.oid\nWHERE\n    f.name IN ('g-r_max_corr', 'g-r_mean_corr', 'g-r_max', 'g-r_mean')\n    AND f.fid IN (1, 2)\n```"
                },
                "in_toks": 6353,
                "out_toks": 710,
                "id": "chatcmpl-BwxFE3QTRyZpEVTT9NrANfq2WBfTI",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "1",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 738,
                "out_toks": 18,
                "id": "chatcmpl-BwvJ7CE4XhedhGFnQiqoOxzfC4mJZ",
                "created": 1753383013,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Optimized and corrected SQL query with nested subqueries for better performance and clarity\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n          AND p.ranking = 1 -- ensure highest confidence classification\n    )\n),\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND m.magmax - m.magmin > 1\n          AND m.magmax_corr - m.magmin_corr > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.magmax - m.magmin > 0.5\n          AND m.magmax_corr - m.magmin_corr > 0.5\n    )\n)\n-- Final selection combining all conditions with nested subqueries for efficiency\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    mag_g.magmax_corr AS \"mag_g_max\",\n    mag_g.magmin_corr AS \"mag_g_min\",\n    (mag_g.magmax_corr - mag_g.magmin_corr) AS \"delta_mag_g\",\n    mag_r.magmax_corr AS \"mag_r_max\",\n    mag_r.magmin_corr AS \"mag_r_min\",\n    (mag_r.magmax_corr - mag_r.magmin_corr) AS \"delta_mag_r\"\nFROM object o\nJOIN agn_objects a ON o.oid = a.oid\nJOIN long_duration_objects l ON o.oid = l.oid\nJOIN feature f ON o.oid = f.oid\nLEFT JOIN magstat mag_g ON o.oid = mag_g.oid AND mag_g.fid = 1\nLEFT JOIN magstat mag_r ON o.oid = mag_r.oid AND mag_r.fid = 2\nWHERE f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmean_corr', 'magmax_corr', 'magmin_corr')\n  AND f.version = (\n      SELECT MAX(f2.version)\n      FROM feature f2\n      WHERE f2.oid = o.oid AND f2.name = f.name\n  )\n  AND f.fid = CASE\n                WHEN f.name LIKE 'g%' THEN 1\n                WHEN f.name LIKE 'r%' THEN 2\n                ELSE f.fid\n              END\n  AND EXISTS (\n      SELECT 1\n      FROM magstat mg\n      WHERE mg.oid = o.oid\n        AND mg.fid = CASE\n                        WHEN f.name LIKE 'g%' THEN 1\n                        WHEN f.name LIKE 'r%' THEN 2\n                        ELSE mg.fid\n                     END\n        AND mg.magmax_corr IS NOT NULL\n        AND mg.magmin_corr IS NOT NULL\n  );",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized and corrected SQL query with nested subqueries for better performance and clarity\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n          AND p.ranking = 1 -- ensure highest confidence classification\n    )\n),\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND m.magmax - m.magmin > 1\n          AND m.magmax_corr - m.magmin_corr > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.magmax - m.magmin > 0.5\n          AND m.magmax_corr - m.magmin_corr > 0.5\n    )\n)\n-- Final selection combining all conditions with nested subqueries for efficiency\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    mag_g.magmax_corr AS \"mag_g_max\",\n    mag_g.magmin_corr AS \"mag_g_min\",\n    (mag_g.magmax_corr - mag_g.magmin_corr) AS \"delta_mag_g\",\n    mag_r.magmax_corr AS \"mag_r_max\",\n    mag_r.magmin_corr AS \"mag_r_min\",\n    (mag_r.magmax_corr - mag_r.magmin_corr) AS \"delta_mag_r\"\nFROM object o\nJOIN agn_objects a ON o.oid = a.oid\nJOIN long_duration_objects l ON o.oid = l.oid\nJOIN feature f ON o.oid = f.oid\nLEFT JOIN magstat mag_g ON o.oid = mag_g.oid AND mag_g.fid = 1\nLEFT JOIN magstat mag_r ON o.oid = mag_r.oid AND mag_r.fid = 2\nWHERE f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmean_corr', 'magmax_corr', 'magmin_corr')\n  AND f.version = (\n      SELECT MAX(f2.version)\n      FROM feature f2\n      WHERE f2.oid = o.oid AND f2.name = f.name\n  )\n  AND f.fid = CASE\n                WHEN f.name LIKE 'g%' THEN 1\n                WHEN f.name LIKE 'r%' THEN 2\n                ELSE f.fid\n              END\n  AND EXISTS (\n      SELECT 1\n      FROM magstat mg\n      WHERE mg.oid = o.oid\n        AND mg.fid = CASE\n                        WHEN f.name LIKE 'g%' THEN 1\n                        WHEN f.name LIKE 'r%' THEN 2\n                        ELSE mg.fid\n                     END\n        AND mg.magmax_corr IS NOT NULL\n        AND mg.magmin_corr IS NOT NULL\n  );"
                },
                "in_toks": 6115,
                "out_toks": 775,
                "id": "chatcmpl-Bx088AS3X16GERJokOhYUiP5V79yZ",
                "created": 1753401552,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND m.magmax - m.magmin > 1\n          AND m.magmax_corr - m.magmin_corr > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.magmax - m.magmin > 0.5\n          AND m.magmax_corr - m.magmin_corr > 0.5\n    )\n)\n-- Final selection combining all conditions\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    mag_g.magmax_corr AS \"mag_g_max\",\n    mag_g.magmin_corr AS \"mag_g_min\",\n    (mag_g.magmax_corr - mag_g.magmin_corr) AS \"delta_mag_g\",\n    mag_r.magmax_corr AS \"mag_r_max\",\n    mag_r.magmin_corr AS \"mag_r_min\",\n    (mag_r.magmax_corr - mag_r.magmin_corr) AS \"delta_mag_r\"\nFROM object o\nJOIN agn_objects a ON o.oid = a.oid\nJOIN long_duration_objects l ON o.oid = l.oid\nJOIN feature f ON o.oid = f.oid\nLEFT JOIN magstat mag_g ON o.oid = mag_g.oid AND mag_g.fid = 1\nLEFT JOIN magstat mag_r ON o.oid = mag_r.oid AND mag_r.fid = 2\nWHERE f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmean_corr', 'magmax_corr', 'magmin_corr')\n  AND f.version = (SELECT MAX(version) FROM feature WHERE oid = o.oid AND name = f.name)\n  AND f.fid = (CASE WHEN f.name LIKE 'g%' THEN 1 WHEN f.name LIKE 'r%' THEN 2 ELSE f.fid END);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND m.magmax - m.magmin > 1\n          AND m.magmax_corr - m.magmin_corr > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.magmax - m.magmin > 0.5\n          AND m.magmax_corr - m.magmin_corr > 0.5\n    )\n)\n-- Final selection combining all conditions\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    mag_g.magmax_corr AS \"mag_g_max\",\n    mag_g.magmin_corr AS \"mag_g_min\",\n    (mag_g.magmax_corr - mag_g.magmin_corr) AS \"delta_mag_g\",\n    mag_r.magmax_corr AS \"mag_r_max\",\n    mag_r.magmin_corr AS \"mag_r_min\",\n    (mag_r.magmax_corr - mag_r.magmin_corr) AS \"delta_mag_r\"\nFROM object o\nJOIN agn_objects a ON o.oid = a.oid\nJOIN long_duration_objects l ON o.oid = l.oid\nJOIN feature f ON o.oid = f.oid\nLEFT JOIN magstat mag_g ON o.oid = mag_g.oid AND mag_g.fid = 1\nLEFT JOIN magstat mag_r ON o.oid = mag_r.oid AND mag_r.fid = 2\nWHERE f.name IN ('Amplitude', 'g-r_max_corr', 'g-r_mean_corr', 'magmean_corr', 'magmax_corr', 'magmin_corr')\n  AND f.version = (SELECT MAX(version) FROM feature WHERE oid = o.oid AND name = f.name)\n  AND f.fid = (CASE WHEN f.name LIKE 'g%' THEN 1 WHEN f.name LIKE 'r%' THEN 2 ELSE f.fid END);\n```"
                },
                "in_toks": 6353,
                "out_toks": 683,
                "id": "chatcmpl-BwxFJ3mvgJVNiTHM1w30pBYj60Xtc",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "1",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 738,
                "out_toks": 18,
                "id": "chatcmpl-BwvJAI0ZRYlzVoYboiLqMUXpchCV5",
                "created": 1753383016,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Optimized and corrected SQL query with nested subqueries to improve performance and ensure proper filtering\nWITH agn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1 -- Ensure highest confidence classification\n),\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND (m.magmax_corr - m.magmin_corr) > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND (m.magmax_corr - m.magmin_corr) > 0.5\n    )\n)\n-- Select objects satisfying all criteria\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Max and min magnitudes in g band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmax_g,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmin_g,\n    -- Max and min magnitudes in r band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmax_r,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmin_r,\n    -- Variations in bands\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS delta_mag_g,\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS delta_mag_r\nFROM object o\nJOIN feature f ON f.oid = o.oid\nWHERE o.oid IN (\n    SELECT oid FROM agn_objects\n    INTERSECT\n    SELECT oid FROM long_duration_objects\n    INTERSECT\n    SELECT oid FROM variable_objects\n)\n  AND f.name IN ('r-W2', 'g-r_max', 'g-r_max_corr', 'g-r_mean', 'g-r_mean_corr')\n  AND f.value IS NOT NULL\n  AND f.fid IN (1, 2);\n",
            "sql_response": {
                "responses": {
                    "0": "-- Optimized and corrected SQL query with nested subqueries to improve performance and ensure proper filtering\nWITH agn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1 -- Ensure highest confidence classification\n),\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND (m.magmax_corr - m.magmin_corr) > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND (m.magmax_corr - m.magmin_corr) > 0.5\n    )\n)\n-- Select objects satisfying all criteria\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Max and min magnitudes in g band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmax_g,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmin_g,\n    -- Max and min magnitudes in r band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmax_r,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmin_r,\n    -- Variations in bands\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS delta_mag_g,\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS delta_mag_r\nFROM object o\nJOIN feature f ON f.oid = o.oid\nWHERE o.oid IN (\n    SELECT oid FROM agn_objects\n    INTERSECT\n    SELECT oid FROM long_duration_objects\n    INTERSECT\n    SELECT oid FROM variable_objects\n)\n  AND f.name IN ('r-W2', 'g-r_max', 'g-r_max_corr', 'g-r_mean', 'g-r_mean_corr')\n  AND f.value IS NOT NULL\n  AND f.fid IN (1, 2);\n"
                },
                "in_toks": 6137,
                "out_toks": 640,
                "id": "chatcmpl-Bx07zcgqsykgjDdYqvOB27Mugcdr6",
                "created": 1753401543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND m.magmax_corr - m.magmin_corr > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.magmax_corr - m.magmin_corr > 0.5\n    )\n)\n-- Combine all filters to get the final set of objects\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Max and min magnitudes in g band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmax_g,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmin_g,\n    -- Max and min magnitudes in r band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmax_r,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmin_r,\n    -- Variations in bands\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS delta_mag_g,\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS delta_mag_r\nFROM object o\nJOIN feature f ON f.oid = o.oid\nWHERE o.oid IN (\n    SELECT oid FROM agn_objects\n    INTERSECT\n    SELECT oid FROM long_duration_objects\n    INTERSECT\n    SELECT oid FROM variable_objects\n)\n  AND f.name IN ('r-W2', 'g-r_max', 'g-r_max_corr', 'g-r_mean', 'g-r_mean_corr')\n  AND f.value IS NOT NULL\n  AND f.fid IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n          AND p.probability > 0.6\n    )\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n      AND o.ndethist >= 20\n),\n-- Select objects with magnitude variations larger than thresholds in corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 1 -- g band\n          AND m.magmax_corr - m.magmin_corr > 1\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM magstat m\n        WHERE m.oid = o.oid\n          AND m.fid = 2 -- r band\n          AND m.magmax_corr - m.magmin_corr > 0.5\n    )\n)\n-- Combine all filters to get the final set of objects\nSELECT\n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Max and min magnitudes in g band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmax_g,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS magmin_g,\n    -- Max and min magnitudes in r band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmax_r,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS magmin_r,\n    -- Variations in bands\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1) AS delta_mag_g,\n    (SELECT magmax_corr - magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2) AS delta_mag_r\nFROM object o\nJOIN feature f ON f.oid = o.oid\nWHERE o.oid IN (\n    SELECT oid FROM agn_objects\n    INTERSECT\n    SELECT oid FROM long_duration_objects\n    INTERSECT\n    SELECT oid FROM variable_objects\n)\n  AND f.name IN ('r-W2', 'g-r_max', 'g-r_max_corr', 'g-r_mean', 'g-r_mean_corr')\n  AND f.value IS NOT NULL\n  AND f.fid IN (1, 2);\n```"
                },
                "in_toks": 6353,
                "out_toks": 688,
                "id": "chatcmpl-BwxFE70QVOQ0WeUgr2b6qSHELDzy3",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "1",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 738,
                "out_toks": 18,
                "id": "chatcmpl-BwvJBJjyUgXmO79L7cVTCQ5nBvhdg",
                "created": 1753383017,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nWITH agn_objects AS (\n    -- Select objects classified as AGN with probability > 0.6 and rank=1\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nlight_curve_stats AS (\n    -- Select objects with at least 20 detections and duration >= 365 days\n    SELECT o.oid, o.firstmjd, o.lastmjd, o.ndet, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND (o.lastmjd - o.firstmjd) >= 365\n      AND o.ndet >= 20\n),\nfeatures_maxmin AS (\n    -- Get maximum and minimum corrected magnitudes per object and band\n    SELECT\n        f.oid,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 1 THEN f.value END) AS magmax_corr_g,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 1 THEN f.value END) AS magmin_corr_g,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 2 THEN f.value END) AS magmax_corr_r,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 2 THEN f.value END) AS magmin_corr_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM light_curve_stats)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY f.oid\n),\nvariations AS (\n    -- Calculate delta magnitudes for g and r bands\n    SELECT\n        o.oid,\n        -- Difference between max and min in g band\n        (f_maxmin.magmax_corr_g - f_maxmin.magmin_corr_g) AS delta_mag_g,\n        -- Difference between max and min in r band\n        (f_maxmin.magmax_corr_r - f_maxmin.magmin_corr_r) AS delta_mag_r\n    FROM light_curve_stats o\n    JOIN features_maxmin f_maxmin ON o.oid = f_maxmin.oid\n),\nfinal_objects AS (\n    -- Select objects satisfying variation thresholds\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM light_curve_stats o\n    JOIN variations v ON o.oid = v.oid\n    WHERE v.delta_mag_g > 1\n      AND v.delta_mag_r > 0.5\n),\nfeatures_details AS (\n    -- Get feature details for the objects\n    SELECT f.*\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM final_objects)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n      AND f.fid IN (1, 2)\n      AND f.version = (\n        SELECT MAX(f2.version)\n        FROM feature f2\n        WHERE f2.oid = f.oid AND f2.name = f.name AND f2.fid = f.fid\n      )\n),\n-- Aggregate max and min magnitudes per object and band for detailed info\nmag_stats AS (\n    SELECT\n        f.oid,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 1 THEN f.value END) AS magmax_corr_g,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 1 THEN f.value END) AS magmin_corr_g,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 2 THEN f.value END) AS magmax_corr_r,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 2 THEN f.value END) AS magmin_corr_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM final_objects)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY f.oid\n),\ndelta_mags AS (\n    -- Calculate delta magnitudes for g and r bands\n    SELECT\n        o.oid,\n        (m.magmax_corr_g - m.magmin_corr_g) AS delta_mag_g,\n        (m.magmax_corr_r - m.magmin_corr_r) AS delta_mag_r\n    FROM mag_stats m\n),\n-- Final selection of objects with required properties\nselected_objects AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        d.delta_mag_g,\n        d.delta_mag_r\n    FROM final_objects o\n    JOIN delta_mags d ON o.oid = d.oid\n    WHERE d.delta_mag_g > 1\n      AND d.delta_mag_r > 0.5\n)\n-- Final output with object info and feature details\nSELECT\n    so.oid,\n    -- Retrieve the latest feature values for magmax_corr and magmin_corr in g and r bands\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmax_corr' AND f.fid = 1 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmax_corr' AND f2.fid = 1\n    )) AS magmax_corr_g,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmin_corr' AND f.fid = 1 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmin_corr' AND f2.fid = 1\n    )) AS magmin_corr_g,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmax_corr' AND f.fid = 2 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmax_corr' AND f2.fid = 2\n    )) AS magmax_corr_r,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmin_corr' AND f.fid = 2 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmin_corr' AND f2.fid = 2\n    )) AS magmin_corr_r,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    -- Calculate maximum and minimum magnitudes for g band\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmax_corr' AND f.fid = 1 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmax_corr' AND f2.fid = 1\n    )) AS magmax_corr_g,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmin_corr' AND f.fid = 1 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmin_corr' AND f2.fid = 1\n    )) AS magmin_corr_g,\n    -- Calculate maximum and minimum magnitudes for r band\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmax_corr' AND f.fid = 2 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmax_corr' AND f2.fid = 2\n    )) AS magmax_corr_r,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmin_corr' AND f.fid = 2 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmin_corr' AND f2.fid = 2\n    )) AS magmin_corr_r,\n    -- Variations\n    so.delta_mag_g,\n    so.delta_mag_r\nFROM selected_objects so;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH agn_objects AS (\n    -- Select objects classified as AGN with probability > 0.6 and rank=1\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nlight_curve_stats AS (\n    -- Select objects with at least 20 detections and duration >= 365 days\n    SELECT o.oid, o.firstmjd, o.lastmjd, o.ndet, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND (o.lastmjd - o.firstmjd) >= 365\n      AND o.ndet >= 20\n),\nfeatures_maxmin AS (\n    -- Get maximum and minimum corrected magnitudes per object and band\n    SELECT\n        f.oid,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 1 THEN f.value END) AS magmax_corr_g,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 1 THEN f.value END) AS magmin_corr_g,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 2 THEN f.value END) AS magmax_corr_r,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 2 THEN f.value END) AS magmin_corr_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM light_curve_stats)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY f.oid\n),\nvariations AS (\n    -- Calculate delta magnitudes for g and r bands\n    SELECT\n        o.oid,\n        -- Difference between max and min in g band\n        (f_maxmin.magmax_corr_g - f_maxmin.magmin_corr_g) AS delta_mag_g,\n        -- Difference between max and min in r band\n        (f_maxmin.magmax_corr_r - f_maxmin.magmin_corr_r) AS delta_mag_r\n    FROM light_curve_stats o\n    JOIN features_maxmin f_maxmin ON o.oid = f_maxmin.oid\n),\nfinal_objects AS (\n    -- Select objects satisfying variation thresholds\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM light_curve_stats o\n    JOIN variations v ON o.oid = v.oid\n    WHERE v.delta_mag_g > 1\n      AND v.delta_mag_r > 0.5\n),\nfeatures_details AS (\n    -- Get feature details for the objects\n    SELECT f.*\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM final_objects)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n      AND f.fid IN (1, 2)\n      AND f.version = (\n        SELECT MAX(f2.version)\n        FROM feature f2\n        WHERE f2.oid = f.oid AND f2.name = f.name AND f2.fid = f.fid\n      )\n),\n-- Aggregate max and min magnitudes per object and band for detailed info\nmag_stats AS (\n    SELECT\n        f.oid,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 1 THEN f.value END) AS magmax_corr_g,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 1 THEN f.value END) AS magmin_corr_g,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 2 THEN f.value END) AS magmax_corr_r,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 2 THEN f.value END) AS magmin_corr_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM final_objects)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY f.oid\n),\ndelta_mags AS (\n    -- Calculate delta magnitudes for g and r bands\n    SELECT\n        o.oid,\n        (m.magmax_corr_g - m.magmin_corr_g) AS delta_mag_g,\n        (m.magmax_corr_r - m.magmin_corr_r) AS delta_mag_r\n    FROM mag_stats m\n),\n-- Final selection of objects with required properties\nselected_objects AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.lastmjd,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        d.delta_mag_g,\n        d.delta_mag_r\n    FROM final_objects o\n    JOIN delta_mags d ON o.oid = d.oid\n    WHERE d.delta_mag_g > 1\n      AND d.delta_mag_r > 0.5\n)\n-- Final output with object info and feature details\nSELECT\n    so.oid,\n    -- Retrieve the latest feature values for magmax_corr and magmin_corr in g and r bands\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmax_corr' AND f.fid = 1 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmax_corr' AND f2.fid = 1\n    )) AS magmax_corr_g,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmin_corr' AND f.fid = 1 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmin_corr' AND f2.fid = 1\n    )) AS magmin_corr_g,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmax_corr' AND f.fid = 2 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmax_corr' AND f2.fid = 2\n    )) AS magmax_corr_r,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmin_corr' AND f.fid = 2 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmin_corr' AND f2.fid = 2\n    )) AS magmin_corr_r,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    -- Calculate maximum and minimum magnitudes for g band\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmax_corr' AND f.fid = 1 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmax_corr' AND f2.fid = 1\n    )) AS magmax_corr_g,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmin_corr' AND f.fid = 1 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmin_corr' AND f2.fid = 1\n    )) AS magmin_corr_g,\n    -- Calculate maximum and minimum magnitudes for r band\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmax_corr' AND f.fid = 2 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmax_corr' AND f2.fid = 2\n    )) AS magmax_corr_r,\n    (SELECT f.value FROM feature f WHERE f.oid = so.oid AND f.name = 'magmin_corr' AND f.fid = 2 AND f.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'magmin_corr' AND f2.fid = 2\n    )) AS magmin_corr_r,\n    -- Variations\n    so.delta_mag_g,\n    so.delta_mag_r\nFROM selected_objects so;\n```"
                },
                "in_toks": 6547,
                "out_toks": 1838,
                "id": "chatcmpl-Bx07xMzvxfpDC83nbcdN7UBel6u38",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH agn_objects AS (\n    -- Select objects classified as AGN with probability > 0.6 and rank=1\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nlight_curve_stats AS (\n    -- Select objects with at least 20 detections in any band and light curve duration >= 365 days\n    SELECT o.oid, o.firstmjd, o.lastmjd, o.ndet, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND (o.lastmjd - o.firstmjd) >= 365\n      AND o.ndet >= 20\n),\nfeatures_filtered AS (\n    -- Select features for objects with magnitude variations > 1 in g and > 0.5 in r, corrected magnitudes\n    SELECT f.*\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM light_curve_stats)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n      AND f.fid IN (1, 2)\n      AND f.version = (SELECT MAX(version) FROM feature WHERE oid = f.oid AND name = f.name AND fid = f.fid)\n),\nmag_stats AS (\n    -- Get maximum and minimum corrected magnitudes per object and band\n    SELECT\n        f.oid,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 1 THEN f.value END) AS magmax_corr_g,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 1 THEN f.value END) AS magmin_corr_g,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 2 THEN f.value END) AS magmax_corr_r,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 2 THEN f.value END) AS magmin_corr_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM light_curve_stats)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY f.oid\n),\nvariations AS (\n    -- Calculate delta magnitudes for g and r bands\n    SELECT\n        m.oid,\n        (m.magmax_corr_g - m.magmin_corr_g) AS delta_mag_g,\n        (m.magmax_corr_r - m.magmin_corr_r) AS delta_mag_r\n    FROM mag_stats m\n),\nfinal_selection AS (\n    -- Select objects with variations > thresholds\n    SELECT\n        lc.oid,\n        lc.firstmjd,\n        lc.lastmjd,\n        lc.ndet,\n        lc.meanra,\n        lc.meandec,\n        f.oid AS feature_oid,\n        f.name,\n        f.version,\n        f.fid,\n        v.delta_mag_g,\n        v.delta_mag_r\n    FROM light_curve_stats lc\n    JOIN features_filtered f ON lc.oid = f.oid\n    JOIN variations v ON lc.oid = v.oid\n    WHERE v.delta_mag_g > 1\n      AND v.delta_mag_r > 0.5\n)\nSELECT\n    final_selection.oid,\n    final_selection.value,\n    final_selection.name,\n    final_selection.version,\n    final_selection.fid AS \"features_fid\",\n    final_selection.meanra,\n    final_selection.meandec,\n    final_selection.ndet,\n    final_selection.magmax_corr_g,\n    final_selection.magmin_corr_g,\n    final_selection.magmax_corr_r,\n    final_selection.magmin_corr_r,\n    final_selection.delta_mag_g,\n    final_selection.delta_mag_r\nFROM final_selection\nJOIN feature f ON final_selection.oid = f.oid\nWHERE f.name IN ('magmax_corr', 'magmin_corr')\n  AND f.version = (SELECT MAX(version) FROM feature WHERE oid = f.oid AND name = f.name AND fid = f.fid);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH agn_objects AS (\n    -- Select objects classified as AGN with probability > 0.6 and rank=1\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nlight_curve_stats AS (\n    -- Select objects with at least 20 detections in any band and light curve duration >= 365 days\n    SELECT o.oid, o.firstmjd, o.lastmjd, o.ndet, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND (o.lastmjd - o.firstmjd) >= 365\n      AND o.ndet >= 20\n),\nfeatures_filtered AS (\n    -- Select features for objects with magnitude variations > 1 in g and > 0.5 in r, corrected magnitudes\n    SELECT f.*\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM light_curve_stats)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n      AND f.fid IN (1, 2)\n      AND f.version = (SELECT MAX(version) FROM feature WHERE oid = f.oid AND name = f.name AND fid = f.fid)\n),\nmag_stats AS (\n    -- Get maximum and minimum corrected magnitudes per object and band\n    SELECT\n        f.oid,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 1 THEN f.value END) AS magmax_corr_g,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 1 THEN f.value END) AS magmin_corr_g,\n        MAX(CASE WHEN f.name = 'magmax_corr' AND f.fid = 2 THEN f.value END) AS magmax_corr_r,\n        MIN(CASE WHEN f.name = 'magmin_corr' AND f.fid = 2 THEN f.value END) AS magmin_corr_r\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM light_curve_stats)\n      AND f.name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY f.oid\n),\nvariations AS (\n    -- Calculate delta magnitudes for g and r bands\n    SELECT\n        m.oid,\n        (m.magmax_corr_g - m.magmin_corr_g) AS delta_mag_g,\n        (m.magmax_corr_r - m.magmin_corr_r) AS delta_mag_r\n    FROM mag_stats m\n),\nfinal_selection AS (\n    -- Select objects with variations > thresholds\n    SELECT\n        lc.oid,\n        lc.firstmjd,\n        lc.lastmjd,\n        lc.ndet,\n        lc.meanra,\n        lc.meandec,\n        f.oid AS feature_oid,\n        f.name,\n        f.version,\n        f.fid,\n        v.delta_mag_g,\n        v.delta_mag_r\n    FROM light_curve_stats lc\n    JOIN features_filtered f ON lc.oid = f.oid\n    JOIN variations v ON lc.oid = v.oid\n    WHERE v.delta_mag_g > 1\n      AND v.delta_mag_r > 0.5\n)\nSELECT\n    final_selection.oid,\n    final_selection.value,\n    final_selection.name,\n    final_selection.version,\n    final_selection.fid AS \"features_fid\",\n    final_selection.meanra,\n    final_selection.meandec,\n    final_selection.ndet,\n    final_selection.magmax_corr_g,\n    final_selection.magmin_corr_g,\n    final_selection.magmax_corr_r,\n    final_selection.magmin_corr_r,\n    final_selection.delta_mag_g,\n    final_selection.delta_mag_r\nFROM final_selection\nJOIN feature f ON final_selection.oid = f.oid\nWHERE f.name IN ('magmax_corr', 'magmin_corr')\n  AND f.version = (SELECT MAX(version) FROM feature WHERE oid = f.oid AND name = f.name AND fid = f.fid);\n```"
                },
                "in_toks": 6353,
                "out_toks": 862,
                "id": "chatcmpl-BwxFN6XPOdgF5dn3wTafoZkqlssvm",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "1",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 738,
                "out_toks": 18,
                "id": "chatcmpl-BwvJCYdmhWDwqglmRNAJJSViXBCLz",
                "created": 1753383018,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdendhist - o.mjdstarthist >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than 1 in g band and 0.5 in r band, corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat magg ON o.oid = magg.oid AND magg.fid = 1\n    JOIN magstat magr ON o.oid = magr.oid AND magr.fid = 2\n    WHERE magg.magmax_corr - magg.magmin_corr > 1\n      AND magr.magmax_corr - magr.magmin_corr > 0.5\n),\n-- Combine all filters: classification, duration, detection count, and variability\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Final selection with required features and properties\nSELECT\n    o.oid,\n    p.probability,\n    p.class_name AS class_name,\n    p.classifier_version,\n    -- Retrieve feature values for amplitude, max, and min magnitudes in g and r bands\n    (SELECT f1.value FROM feature f1 WHERE f1.oid = o.oid AND f1.name = 'Amplitude' AND f1.fid = 1 AND f1.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = o.oid AND f2.name = 'Amplitude' AND f2.fid = 1\n    )) AS amplitude_g,\n    (SELECT f2.value FROM feature f2 WHERE f2.oid = o.oid AND f2.name = 'Amplitude' AND f2.fid = 2 AND f2.version = (\n        SELECT MAX(f3.version) FROM feature f3 WHERE f3.oid = o.oid AND f3.name = 'Amplitude' AND f3.fid = 2\n    )) AS amplitude_r,\n    -- Max and min magnitudes in g band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 1 AND magmax_corr IS NOT NULL ORDER BY magmax_corr DESC LIMIT 1) AS magmax_g,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1 AND magmin_corr IS NOT NULL ORDER BY magmin_corr ASC LIMIT 1) AS magmin_g,\n    -- Max and min magnitudes in r band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 2 AND magmax_corr IS NOT NULL ORDER BY magmax_corr DESC LIMIT 1) AS magmax_r,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2 AND magmin_corr IS NOT NULL ORDER BY magmin_corr ASC LIMIT 1) AS magmin_r,\n    -- Variations in g and r bands\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 1 AND magmax_corr IS NOT NULL ORDER BY magmax_corr DESC LIMIT 1) -\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1 AND magmin_corr IS NOT NULL ORDER BY magmin_corr ASC LIMIT 1) AS delta_mag_g,\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 2 AND magmax_corr IS NOT NULL ORDER BY magmax_corr DESC LIMIT 1) -\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2 AND magmin_corr IS NOT NULL ORDER BY magmin_corr ASC LIMIT 1) AS delta_mag_r\nFROM object o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n  AND p.probability > 0.6\n  AND o.oid IN (SELECT oid FROM long_duration_objects)\n  AND o.oid IN (SELECT oid FROM variable_objects)\n  -- Filter for features: amplitude, max, and min magnitudes in g and r bands\n  AND (\n    (f.name = 'Amplitude' AND f.fid IN (1,2) AND f.value IS NOT NULL)\n    OR (f.name IN ('magmax_corr', 'magmin_corr') AND f.fid IN (1,2))\n  )\n  -- Ensure latest feature versions are used\n  AND f.version = (\n    SELECT MAX(fv.version) FROM feature fv WHERE fv.oid = o.oid AND fv.name = f.name AND fv.fid = f.fid\n  )\nORDER BY o.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdendhist - o.mjdstarthist >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than 1 in g band and 0.5 in r band, corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat magg ON o.oid = magg.oid AND magg.fid = 1\n    JOIN magstat magr ON o.oid = magr.oid AND magr.fid = 2\n    WHERE magg.magmax_corr - magg.magmin_corr > 1\n      AND magr.magmax_corr - magr.magmin_corr > 0.5\n),\n-- Combine all filters: classification, duration, detection count, and variability\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Final selection with required features and properties\nSELECT\n    o.oid,\n    p.probability,\n    p.class_name AS class_name,\n    p.classifier_version,\n    -- Retrieve feature values for amplitude, max, and min magnitudes in g and r bands\n    (SELECT f1.value FROM feature f1 WHERE f1.oid = o.oid AND f1.name = 'Amplitude' AND f1.fid = 1 AND f1.version = (\n        SELECT MAX(f2.version) FROM feature f2 WHERE f2.oid = o.oid AND f2.name = 'Amplitude' AND f2.fid = 1\n    )) AS amplitude_g,\n    (SELECT f2.value FROM feature f2 WHERE f2.oid = o.oid AND f2.name = 'Amplitude' AND f2.fid = 2 AND f2.version = (\n        SELECT MAX(f3.version) FROM feature f3 WHERE f3.oid = o.oid AND f3.name = 'Amplitude' AND f3.fid = 2\n    )) AS amplitude_r,\n    -- Max and min magnitudes in g band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 1 AND magmax_corr IS NOT NULL ORDER BY magmax_corr DESC LIMIT 1) AS magmax_g,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1 AND magmin_corr IS NOT NULL ORDER BY magmin_corr ASC LIMIT 1) AS magmin_g,\n    -- Max and min magnitudes in r band\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 2 AND magmax_corr IS NOT NULL ORDER BY magmax_corr DESC LIMIT 1) AS magmax_r,\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2 AND magmin_corr IS NOT NULL ORDER BY magmin_corr ASC LIMIT 1) AS magmin_r,\n    -- Variations in g and r bands\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 1 AND magmax_corr IS NOT NULL ORDER BY magmax_corr DESC LIMIT 1) -\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 1 AND magmin_corr IS NOT NULL ORDER BY magmin_corr ASC LIMIT 1) AS delta_mag_g,\n    (SELECT magmax_corr FROM magstat WHERE oid = o.oid AND fid = 2 AND magmax_corr IS NOT NULL ORDER BY magmax_corr DESC LIMIT 1) -\n    (SELECT magmin_corr FROM magstat WHERE oid = o.oid AND fid = 2 AND magmin_corr IS NOT NULL ORDER BY magmin_corr ASC LIMIT 1) AS delta_mag_r\nFROM object o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n  AND p.probability > 0.6\n  AND o.oid IN (SELECT oid FROM long_duration_objects)\n  AND o.oid IN (SELECT oid FROM variable_objects)\n  -- Filter for features: amplitude, max, and min magnitudes in g and r bands\n  AND (\n    (f.name = 'Amplitude' AND f.fid IN (1,2) AND f.value IS NOT NULL)\n    OR (f.name IN ('magmax_corr', 'magmin_corr') AND f.fid IN (1,2))\n  )\n  -- Ensure latest feature versions are used\n  AND f.version = (\n    SELECT MAX(fv.version) FROM feature fv WHERE fv.oid = o.oid AND fv.name = f.name AND fv.fid = f.fid\n  )\nORDER BY o.oid;\n```"
                },
                "in_toks": 6505,
                "out_toks": 1154,
                "id": "chatcmpl-Bx07xno2stGqNvfLyt1WaztyfA1oI",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdendhist - o.mjdstarthist >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than 1 in g band and 0.5 in r band, corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat magg ON o.oid = magg.oid AND magg.fid = 1\n    JOIN magstat magr ON o.oid = magr.oid AND magr.fid = 2\n    WHERE magg.magmax_corr - magg.magmin_corr > 1\n      AND magr.magmax_corr - magr.magmin_corr > 0.5\n),\n-- Combine all filters: classification, duration, detection count, and variability\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Final selection with required features and properties\nSELECT\n    o.oid,\n    p.probability,\n    p.class_name AS class_name,\n    p.classifier_version,\n    f.value AS feature_value,\n    f.name AS feature_name,\n    f.version AS feature_version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Calculate max and min magnitudes for g and r bands\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 1) AS magmax_g,\n    (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 1) AS magmin_g,\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 2) AS magmax_r,\n    (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 2) AS magmin_r,\n    -- Calculate magnitude variations\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 1) - (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 1) AS delta_mag_g,\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 2) - (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 2) AS delta_mag_r\nFROM object o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n  AND p.probability > 0.6\n  AND o.oid IN (SELECT oid FROM long_duration_objects)\n  AND o.oid IN (SELECT oid FROM variable_objects)\n  AND f.name IN ('Amplitude', 'magmax_corr', 'magmin_corr')\n  AND f.value IS NOT NULL\n  AND f.fid IN (1, 2)\n  AND f.version = (SELECT MAX(version) FROM feature WHERE oid = o.oid AND name = f.name AND fid = f.fid)\nORDER BY o.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdendhist - o.mjdstarthist >= 365\n      AND o.ndet >= 20\n),\n-- Select objects with magnitude variations larger than 1 in g band and 0.5 in r band, corrected magnitudes\nvariable_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN magstat magg ON o.oid = magg.oid AND magg.fid = 1\n    JOIN magstat magr ON o.oid = magr.oid AND magr.fid = 2\n    WHERE magg.magmax_corr - magg.magmin_corr > 1\n      AND magr.magmax_corr - magr.magmin_corr > 0.5\n),\n-- Combine all filters: classification, duration, detection count, and variability\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM agn_objects)\n      AND o.oid IN (SELECT oid FROM long_duration_objects)\n      AND o.oid IN (SELECT oid FROM variable_objects)\n)\n-- Final selection with required features and properties\nSELECT\n    o.oid,\n    p.probability,\n    p.class_name AS class_name,\n    p.classifier_version,\n    f.value AS feature_value,\n    f.name AS feature_name,\n    f.version AS feature_version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    -- Calculate max and min magnitudes for g and r bands\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 1) AS magmax_g,\n    (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 1) AS magmin_g,\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 2) AS magmax_r,\n    (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 2) AS magmin_r,\n    -- Calculate magnitude variations\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 1) - (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 1) AS delta_mag_g,\n    (SELECT MAX(mag) FROM magstat WHERE oid = o.oid AND fid = 2) - (SELECT MIN(mag) FROM magstat WHERE oid = o.oid AND fid = 2) AS delta_mag_r\nFROM object o\nJOIN probability p ON o.oid = p.oid\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE p.class_name = 'AGN'\n  AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n  AND p.probability > 0.6\n  AND o.oid IN (SELECT oid FROM long_duration_objects)\n  AND o.oid IN (SELECT oid FROM variable_objects)\n  AND f.name IN ('Amplitude', 'magmax_corr', 'magmin_corr')\n  AND f.value IS NOT NULL\n  AND f.fid IN (1, 2)\n  AND f.version = (SELECT MAX(version) FROM feature WHERE oid = o.oid AND name = f.name AND fid = f.fid)\nORDER BY o.oid;\n```"
                },
                "in_toks": 6353,
                "out_toks": 823,
                "id": "chatcmpl-BwxFFSKj2bIKKObNObg4a0lu3afyG",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "1",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 738,
                "out_toks": 18,
                "id": "chatcmpl-BwvJEekRkGvWRRzFS0EqdiG4d3HLE",
                "created": 1753383020,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS total_detections\n    FROM detection\n    GROUP BY oid\n),\nobjects_with_detections AS (\n    SELECT oid\n    FROM detection_counts\n    WHERE total_detections >= 20\n),\n-- Get features for objects with significant variations in g and r bands\nfeatures_g AS (\n    SELECT f.oid, f.value AS mag, f.name, f.version, f.fid\n    FROM feature f\n    WHERE f.name = 'magmax' AND f.fid = 1\n),\nfeatures_r AS (\n    SELECT f.oid, f.value AS mag, f.name, f.version, f.fid\n    FROM feature f\n    WHERE f.name = 'magmax' AND f.fid = 2\n),\nmag_stats_g AS (\n    SELECT oid, MAX(value) AS magmax, MIN(value) AS magmin\n    FROM feature\n    WHERE name = 'magmax' AND fid = 1\n    GROUP BY oid\n),\nmag_stats_r AS (\n    SELECT oid, MAX(value) AS magmax, MIN(value) AS magmin\n    FROM feature\n    WHERE name = 'magmax' AND fid = 2\n    GROUP BY oid\n),\n-- Calculate magnitude variations\nvariations AS (\n    SELECT\n        g.oid,\n        (g.magmax - g.magmin) AS delta_mag_g,\n        (r.magmax - r.magmin) AS delta_mag_r\n    FROM mag_stats_g g\n    JOIN mag_stats_r r ON g.oid = r.oid\n),\n-- Filter objects with variations larger than thresholds in corrected magnitudes\nobjects_with_variations AS (\n    SELECT v.oid\n    FROM variations v\n    JOIN feature f_g ON v.oid = f_g.oid AND f_g.name = 'magmax' AND f_g.fid = 1\n    JOIN feature f_r ON v.oid = f_r.oid AND f_r.name = 'magmax' AND f_r.fid = 2\n    WHERE\n        -- Assuming corrected magnitudes are stored in features with name 'magmax_corr'\n        -- and that the features for corrected magnitudes are available\n        -- If not, this condition can be adjusted accordingly\n        EXISTS (\n            SELECT 1\n            FROM feature fc\n            WHERE fc.oid = v.oid AND fc.name = 'magmax_corr' AND fc.fid = 1\n        )\n        AND v.delta_mag_g > 1\n        AND v.delta_mag_r > 0.5\n),\n-- Final selection of objects meeting all criteria\nfinal_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN long_duration_objects l ON o.oid = l.oid\n    JOIN objects_with_detections d ON o.oid = d.oid\n    JOIN objects_with_variations v ON o.oid = v.oid\n)\n-- Retrieve required information for the final objects\nSELECT\n    o.oid,\n    f.value AS feature_value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    magmax_corr AS magmax,\n    magmin_corr AS magmin,\n    (magmax_corr - magmin_corr) AS delta_mag\nFROM object o\nJOIN feature f ON o.oid = f.oid\nLEFT JOIN (\n    SELECT oid, MAX(CASE WHEN name = 'magmax_corr' AND fid = 1 THEN value END) AS magmax_corr,\n           MAX(CASE WHEN name = 'magmin_corr' AND fid = 1 THEN value END) AS magmin_corr\n    FROM feature\n    WHERE name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY oid\n) mag_stats ON o.oid = mag_stats.oid\nWHERE o.oid IN (SELECT oid FROM final_objects)\n  AND f.name IN ('magmax', 'magmin')\n  AND f.fid IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'stamp_classifier')\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\n-- Filter objects with light curves covering at least one year and at least 20 detections in any band\nlong_duration_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE (o.mjdendhist - o.mjdstarthist) >= 365\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS total_detections\n    FROM detection\n    GROUP BY oid\n),\nobjects_with_detections AS (\n    SELECT oid\n    FROM detection_counts\n    WHERE total_detections >= 20\n),\n-- Get features for objects with significant variations in g and r bands\nfeatures_g AS (\n    SELECT f.oid, f.value AS mag, f.name, f.version, f.fid\n    FROM feature f\n    WHERE f.name = 'magmax' AND f.fid = 1\n),\nfeatures_r AS (\n    SELECT f.oid, f.value AS mag, f.name, f.version, f.fid\n    FROM feature f\n    WHERE f.name = 'magmax' AND f.fid = 2\n),\nmag_stats_g AS (\n    SELECT oid, MAX(value) AS magmax, MIN(value) AS magmin\n    FROM feature\n    WHERE name = 'magmax' AND fid = 1\n    GROUP BY oid\n),\nmag_stats_r AS (\n    SELECT oid, MAX(value) AS magmax, MIN(value) AS magmin\n    FROM feature\n    WHERE name = 'magmax' AND fid = 2\n    GROUP BY oid\n),\n-- Calculate magnitude variations\nvariations AS (\n    SELECT\n        g.oid,\n        (g.magmax - g.magmin) AS delta_mag_g,\n        (r.magmax - r.magmin) AS delta_mag_r\n    FROM mag_stats_g g\n    JOIN mag_stats_r r ON g.oid = r.oid\n),\n-- Filter objects with variations larger than thresholds in corrected magnitudes\nobjects_with_variations AS (\n    SELECT v.oid\n    FROM variations v\n    JOIN feature f_g ON v.oid = f_g.oid AND f_g.name = 'magmax' AND f_g.fid = 1\n    JOIN feature f_r ON v.oid = f_r.oid AND f_r.name = 'magmax' AND f_r.fid = 2\n    WHERE\n        -- Assuming corrected magnitudes are stored in features with name 'magmax_corr'\n        -- and that the features for corrected magnitudes are available\n        -- If not, this condition can be adjusted accordingly\n        EXISTS (\n            SELECT 1\n            FROM feature fc\n            WHERE fc.oid = v.oid AND fc.name = 'magmax_corr' AND fc.fid = 1\n        )\n        AND v.delta_mag_g > 1\n        AND v.delta_mag_r > 0.5\n),\n-- Final selection of objects meeting all criteria\nfinal_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN long_duration_objects l ON o.oid = l.oid\n    JOIN objects_with_detections d ON o.oid = d.oid\n    JOIN objects_with_variations v ON o.oid = v.oid\n)\n-- Retrieve required information for the final objects\nSELECT\n    o.oid,\n    f.value AS feature_value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    magmax_corr AS magmax,\n    magmin_corr AS magmin,\n    (magmax_corr - magmin_corr) AS delta_mag\nFROM object o\nJOIN feature f ON o.oid = f.oid\nLEFT JOIN (\n    SELECT oid, MAX(CASE WHEN name = 'magmax_corr' AND fid = 1 THEN value END) AS magmax_corr,\n           MAX(CASE WHEN name = 'magmin_corr' AND fid = 1 THEN value END) AS magmin_corr\n    FROM feature\n    WHERE name IN ('magmax_corr', 'magmin_corr')\n    GROUP BY oid\n) mag_stats ON o.oid = mag_stats.oid\nWHERE o.oid IN (SELECT oid FROM final_objects)\n  AND f.name IN ('magmax', 'magmin')\n  AND f.fid IN (1, 2);\n```"
                },
                "in_toks": 6353,
                "out_toks": 994,
                "id": "chatcmpl-BwxFFx3OmScbxUU6kZc9rjwFN5XL4",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "16": {
        "0": {
            "req_id": "16",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 846,
                "out_toks": 30,
                "id": "chatcmpl-BjAclYJbonOMlNW0pP9qTW6mGoqDV",
                "created": 1750105299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        d.mjd,\n        ms.ndet,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        detection d\n    JOIN\n        magstat ms ON d.oid = ms.oid AND d.fid = ms.fid\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd = (\n            SELECT MIN(mjd)\n            FROM detection\n            WHERE oid = d.oid AND mjd >= (\n                SELECT MIN(mjd)\n                FROM detection\n                WHERE oid = d.oid\n            )\n        )\n        AND d.mjd < (SELECT first_mjd FROM first_detections WHERE oid = d.oid)\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.candid,\n        lc.fid,\n        lc.magpsf,\n        lc.mjd,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        light_curve_data lc\n    JOIN\n        magstat ms ON lc.oid = ms.oid AND lc.fid = ms.fid\n    WHERE\n        ms.ndet > 0\n        AND (ms.magfirst - ms.maglast) >= 0.25 * (\n            SELECT MAX(mjd)\n            FROM detection\n            WHERE oid = lc.oid\n              AND mjd < (SELECT first_mjd FROM first_detections WHERE oid = lc.oid)\n        )\n)\n-- Final selection combining all conditions\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    ld.fid AS magstat_fid,\n    ld.magpsf,\n    ld.dmdt_first\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    light_curve_data ld ON sp.oid = ld.oid\nJOIN\n    magstat ms ON ld.oid = ms.oid AND ld.fid = ms.fid\nWHERE\n    sp.class_name = 'SN'\n    AND sp.ranking = 1\n    AND ld.oid IN (SELECT oid FROM risers)\nORDER BY\n    sp.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        d.mjd,\n        ms.ndet,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        detection d\n    JOIN\n        magstat ms ON d.oid = ms.oid AND d.fid = ms.fid\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd = (\n            SELECT MIN(mjd)\n            FROM detection\n            WHERE oid = d.oid AND mjd >= (\n                SELECT MIN(mjd)\n                FROM detection\n                WHERE oid = d.oid\n            )\n        )\n        AND d.mjd < (SELECT first_mjd FROM first_detections WHERE oid = d.oid)\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.candid,\n        lc.fid,\n        lc.magpsf,\n        lc.mjd,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        light_curve_data lc\n    JOIN\n        magstat ms ON lc.oid = ms.oid AND lc.fid = ms.fid\n    WHERE\n        ms.ndet > 0\n        AND (ms.magfirst - ms.maglast) >= 0.25 * (\n            SELECT MAX(mjd)\n            FROM detection\n            WHERE oid = lc.oid\n              AND mjd < (SELECT first_mjd FROM first_detections WHERE oid = lc.oid)\n        )\n)\n-- Final selection combining all conditions\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    ld.fid AS magstat_fid,\n    ld.magpsf,\n    ld.dmdt_first\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    light_curve_data ld ON sp.oid = ld.oid\nJOIN\n    magstat ms ON ld.oid = ms.oid AND ld.fid = ms.fid\nWHERE\n    sp.class_name = 'SN'\n    AND sp.ranking = 1\n    AND ld.oid IN (SELECT oid FROM risers)\nORDER BY\n    sp.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3661,
                "out_toks": 664,
                "id": "chatcmpl-Bx07zzUqep7bjkgYQV6Nt80vDuHUK",
                "created": 1753401543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        d.mjd,\n        ms.ndet,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        detection d\n    JOIN\n        magstat ms ON d.oid = ms.oid AND d.fid = ms.fid\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= (SELECT MIN(mjd) FROM detection WHERE oid = d.oid))\n        AND d.mjd < (SELECT first_mjd FROM first_detections WHERE oid = d.oid)\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.candid,\n        lc.fid,\n        lc.magpsf,\n        lc.mjd,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        light_curve_data lc\n    JOIN\n        magstat ms ON lc.oid = ms.oid AND lc.fid = ms.fid\n    WHERE\n        ms.ndet > 0\n        AND (ms.magfirst - ms.maglast) >= 0.25 * (ms.mjd - (SELECT MAX(mjd) FROM detection WHERE oid = lc.oid AND mjd < (SELECT first_mjd FROM first_detections WHERE oid = lc.oid)))\n)\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    ld.fid AS magstat_fid,\n    ld.magpsf,\n    ld.dmdt_first\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    light_curve_data ld ON sp.oid = ld.oid\nJOIN\n    magstat ms ON ld.oid = ms.oid AND ld.fid = ms.fid\nWHERE\n    sp.class_name = 'SN'\n    AND sp.ranking = 1\n    AND ld.oid IN (SELECT oid FROM risers)\nORDER BY\n    sp.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        d.mjd,\n        ms.ndet,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        detection d\n    JOIN\n        magstat ms ON d.oid = ms.oid AND d.fid = ms.fid\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= (SELECT MIN(mjd) FROM detection WHERE oid = d.oid))\n        AND d.mjd < (SELECT first_mjd FROM first_detections WHERE oid = d.oid)\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.candid,\n        lc.fid,\n        lc.magpsf,\n        lc.mjd,\n        ms.magfirst,\n        ms.maglast,\n        ms.dmdt_first\n    FROM\n        light_curve_data lc\n    JOIN\n        magstat ms ON lc.oid = ms.oid AND lc.fid = ms.fid\n    WHERE\n        ms.ndet > 0\n        AND (ms.magfirst - ms.maglast) >= 0.25 * (ms.mjd - (SELECT MAX(mjd) FROM detection WHERE oid = lc.oid AND mjd < (SELECT first_mjd FROM first_detections WHERE oid = lc.oid)))\n)\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    ld.fid AS magstat_fid,\n    ld.magpsf,\n    ld.dmdt_first\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    light_curve_data ld ON sp.oid = ld.oid\nJOIN\n    magstat ms ON ld.oid = ms.oid AND ld.fid = ms.fid\nWHERE\n    sp.class_name = 'SN'\n    AND sp.ranking = 1\n    AND ld.oid IN (SELECT oid FROM risers)\nORDER BY\n    sp.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 642,
                "id": "chatcmpl-BwxFHFzyt8HqyZxBsCthAhH29Nei3",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "16",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 846,
                "out_toks": 30,
                "id": "chatcmpl-BjAclYJbonOMlNW0pP9qTW6mGoqDV",
                "created": 1750105299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name='stamp_classifier'\n      AND p.ranking=1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name='SN' -- objects with highest class as SN\n),\ndetection_stats AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.fid\n    FROM detection d\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.lastmjd\n    FROM magstat m\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        -- Find the first detection time within the date window\n        MIN(d.mjd) FILTER (WHERE d.mjd >= 60188.0 AND d.mjd <= 60189.0) AS first_detection_mjd,\n        -- Find the last non-detection before the first detection\n        -- Subquery to get the last non-detection (isdiffpos=0) before the first detection\n        ( -- Calculate initial rise rate\n            -- Use a subquery to get the last non-detection's mjd and mag\n            SELECT\n                (m.magfirst - m2.magfirst) / NULLIF((d2.mjd - m2.lastmjd), 0)\n            FROM detection d2\n            JOIN magstat m2 ON d2.oid = m2.oid AND d2.fid = m2.fid\n            WHERE d2.oid = d.oid\n              AND d2.mjd < d.mjd\n              AND d2.isdiffpos=0\n            ORDER BY d2.mjd DESC\n            LIMIT 1\n        ) AS initial_rise\n    FROM detection d\n    JOIN magstat m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd >= 60188.0 AND d.mjd <= 60189.0\n    GROUP BY d.oid\n),\nfast_risers AS (\n    SELECT\n        r.oid,\n        r.initial_rise\n    FROM rise_estimates r\n    WHERE r.initial_rise >= 0.25 -- fast riser criterion\n)\nSELECT\n    f.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    m.magstat_fid,\n    r.initial_rise\nFROM first_detections f\nJOIN sn_objects sn ON f.oid = sn.oid\nJOIN max_prob mp ON mp.oid = f.oid\nJOIN detection_stats d ON d.oid = f.oid\n  AND d.mjd = (\n      SELECT MIN(mjd)\n      FROM detection\n      WHERE oid = d.oid\n        AND mjd >= 60188.0 AND mjd <= 60189.0\n  )\nJOIN magstat_info m ON m.oid = f.oid AND m.fid = d.fid\nJOIN rise_estimates r ON r.oid = f.oid\nWHERE mp.class_name='SN'\n  AND r.initial_rise >= 0.25\nORDER BY f.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name='stamp_classifier'\n      AND p.ranking=1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name='SN' -- objects with highest class as SN\n),\ndetection_stats AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.fid\n    FROM detection d\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.lastmjd\n    FROM magstat m\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        -- Find the first detection time within the date window\n        MIN(d.mjd) FILTER (WHERE d.mjd >= 60188.0 AND d.mjd <= 60189.0) AS first_detection_mjd,\n        -- Find the last non-detection before the first detection\n        -- Subquery to get the last non-detection (isdiffpos=0) before the first detection\n        ( -- Calculate initial rise rate\n            -- Use a subquery to get the last non-detection's mjd and mag\n            SELECT\n                (m.magfirst - m2.magfirst) / NULLIF((d2.mjd - m2.lastmjd), 0)\n            FROM detection d2\n            JOIN magstat m2 ON d2.oid = m2.oid AND d2.fid = m2.fid\n            WHERE d2.oid = d.oid\n              AND d2.mjd < d.mjd\n              AND d2.isdiffpos=0\n            ORDER BY d2.mjd DESC\n            LIMIT 1\n        ) AS initial_rise\n    FROM detection d\n    JOIN magstat m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd >= 60188.0 AND d.mjd <= 60189.0\n    GROUP BY d.oid\n),\nfast_risers AS (\n    SELECT\n        r.oid,\n        r.initial_rise\n    FROM rise_estimates r\n    WHERE r.initial_rise >= 0.25 -- fast riser criterion\n)\nSELECT\n    f.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    m.magstat_fid,\n    r.initial_rise\nFROM first_detections f\nJOIN sn_objects sn ON f.oid = sn.oid\nJOIN max_prob mp ON mp.oid = f.oid\nJOIN detection_stats d ON d.oid = f.oid\n  AND d.mjd = (\n      SELECT MIN(mjd)\n      FROM detection\n      WHERE oid = d.oid\n        AND mjd >= 60188.0 AND mjd <= 60189.0\n  )\nJOIN magstat_info m ON m.oid = f.oid AND m.fid = d.fid\nJOIN rise_estimates r ON r.oid = f.oid\nWHERE mp.class_name='SN'\n  AND r.initial_rise >= 0.25\nORDER BY f.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3785,
                "out_toks": 808,
                "id": "chatcmpl-Bx08DjD1e7zRrlKy3ZGLATCApHo3D",
                "created": 1753401557,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name='stamp_classifier'\n      AND p.ranking=1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name='SN' -- highest probability class is SN\n),\ndetection_stats AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.fid\n    FROM detection d\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.lastmjd\n    FROM magstat m\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd,\n        -- Calculate initial rise rate: (magfirst - maglast) / (first_detection_mjd - last_non_detection_mjd)\n        -- First, find the last non-detection before first detection\n        (m.magfirst - m.maglast) / NULLIF((fnd.mjd - m.lastmjd), 0) AS initial_rise\n    FROM detection d\n    JOIN magstat m ON d.oid = m.oid AND d.fid = m.fid\n    JOIN detection fnd ON fnd.oid = d.oid AND fnd.mjd < d.mjd AND fnd.isdiffpos=0 -- last non-detection before first detection\n    WHERE d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid=d.oid AND mjd >= 60188.0 AND mjd <= 60189.0)\n    GROUP BY d.oid, m.magfirst, m.lastmjd, m.fid\n),\nfast_risers AS (\n    SELECT\n        r.oid,\n        r.initial_rise\n    FROM rise_estimates r\n    WHERE r.initial_rise >= 0.25 -- fast riser criterion\n)\nSELECT\n    f.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    m.magstat_fid,\n    r.initial_rise\nFROM first_detections f\nJOIN sn_objects sn ON f.oid = sn.oid\nJOIN max_prob mp ON mp.oid = f.oid\nJOIN detection_stats d ON d.oid = f.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid=d.oid AND mjd >= 60188.0 AND mjd <= 60189.0)\nJOIN magstat_info m ON m.oid = f.oid AND m.fid = d.fid\nJOIN rise_estimates r ON r.oid = f.oid\nWHERE mp.class_name='SN'\n  AND r.initial_rise >= 0.25\nORDER BY f.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.ndet,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name='stamp_classifier'\n      AND p.ranking=1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name='SN' -- highest probability class is SN\n),\ndetection_stats AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.fid\n    FROM detection d\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.lastmjd\n    FROM magstat m\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd,\n        -- Calculate initial rise rate: (magfirst - maglast) / (first_detection_mjd - last_non_detection_mjd)\n        -- First, find the last non-detection before first detection\n        (m.magfirst - m.maglast) / NULLIF((fnd.mjd - m.lastmjd), 0) AS initial_rise\n    FROM detection d\n    JOIN magstat m ON d.oid = m.oid AND d.fid = m.fid\n    JOIN detection fnd ON fnd.oid = d.oid AND fnd.mjd < d.mjd AND fnd.isdiffpos=0 -- last non-detection before first detection\n    WHERE d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid=d.oid AND mjd >= 60188.0 AND mjd <= 60189.0)\n    GROUP BY d.oid, m.magfirst, m.lastmjd, m.fid\n),\nfast_risers AS (\n    SELECT\n        r.oid,\n        r.initial_rise\n    FROM rise_estimates r\n    WHERE r.initial_rise >= 0.25 -- fast riser criterion\n)\nSELECT\n    f.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    m.magstat_fid,\n    r.initial_rise\nFROM first_detections f\nJOIN sn_objects sn ON f.oid = sn.oid\nJOIN max_prob mp ON mp.oid = f.oid\nJOIN detection_stats d ON d.oid = f.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid=d.oid AND mjd >= 60188.0 AND mjd <= 60189.0)\nJOIN magstat_info m ON m.oid = f.oid AND m.fid = d.fid\nJOIN rise_estimates r ON r.oid = f.oid\nWHERE mp.class_name='SN'\n  AND r.initial_rise >= 0.25\nORDER BY f.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 734,
                "id": "chatcmpl-BwxFN0Z3ohmXrDyy8x1emGWNu8l6q",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "16",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 693,
                "out_toks": 15,
                "id": "chatcmpl-BwvJE8xbWFUxxHjJO6GH0ckmtR28Z",
                "created": 1753383020,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- highest probability class\n),\nstamp_sn AS (\n    SELECT\n        mp.oid,\n        mp.probability\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\nrise_rates AS (\n    SELECT\n        o.oid,\n        -- Calculate the rate of magnitude change at detection\n        CASE\n            WHEN o.ndethist > 0 AND o.mjdendhist >= 60188.0 THEN\n                (m.magfirst - m.maglast) / (o.mjdendhist - o.firstmjd)\n            ELSE NULL\n        END AS rise_rate\n    FROM object o\n    LEFT JOIN magstat m ON o.oid = m.oid AND m.fid = 2 -- filter ID 2 (r-band)\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT\n        r.oid\n    FROM rise_rates r\n    WHERE r.rise_rate >= 0.25 -- fast riser condition\n),\ndetections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.mjd\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM fast_risers)\n      AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= 60188.0 AND mjd <= 60189.0) -- first detection in the date range\n),\nnon_detections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.mjd\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM fast_risers)\n      AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= 60188.0 AND mjd <= 60189.0) -- before first detection\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        -- Estimate initial rise as (magfirst - maglast) / time difference\n        CASE\n            WHEN m.dt_first > 0 THEN (m.magfirst - m.maglast) / m.dt_first\n            ELSE NULL\n        END AS initial_rise_estimate\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM fast_risers)\n      AND m.fid = 2 -- r-band\n)\nSELECT\n    f.oid,\n    fp.probability AS stamp_classifier_probability,\n    d.fid AS detection_filter_id,\n    d.diffmaglim AS diff_image,\n    m.magstat_fid,\n    m.initial_rise_estimate\nFROM first_detections f\nJOIN stamp_sn fp ON f.oid = fp.oid\nJOIN detections d ON f.oid = d.oid\nJOIN magstat_info m ON f.oid = m.oid\nORDER BY f.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- highest probability class\n),\nstamp_sn AS (\n    SELECT\n        mp.oid,\n        mp.probability\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\nrise_rates AS (\n    SELECT\n        o.oid,\n        -- Calculate the rate of magnitude change at detection\n        CASE\n            WHEN o.ndethist > 0 AND o.mjdendhist >= 60188.0 THEN\n                (m.magfirst - m.maglast) / (o.mjdendhist - o.firstmjd)\n            ELSE NULL\n        END AS rise_rate\n    FROM object o\n    LEFT JOIN magstat m ON o.oid = m.oid AND m.fid = 2 -- filter ID 2 (r-band)\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nfast_risers AS (\n    SELECT\n        r.oid\n    FROM rise_rates r\n    WHERE r.rise_rate >= 0.25 -- fast riser condition\n),\ndetections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.mjd\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM fast_risers)\n      AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= 60188.0 AND mjd <= 60189.0) -- first detection in the date range\n),\nnon_detections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.mjd\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM fast_risers)\n      AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND mjd >= 60188.0 AND mjd <= 60189.0) -- before first detection\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        -- Estimate initial rise as (magfirst - maglast) / time difference\n        CASE\n            WHEN m.dt_first > 0 THEN (m.magfirst - m.maglast) / m.dt_first\n            ELSE NULL\n        END AS initial_rise_estimate\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM fast_risers)\n      AND m.fid = 2 -- r-band\n)\nSELECT\n    f.oid,\n    fp.probability AS stamp_classifier_probability,\n    d.fid AS detection_filter_id,\n    d.diffmaglim AS diff_image,\n    m.magstat_fid,\n    m.initial_rise_estimate\nFROM first_detections f\nJOIN stamp_sn fp ON f.oid = fp.oid\nJOIN detections d ON f.oid = d.oid\nJOIN magstat_info m ON f.oid = m.oid\nORDER BY f.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 818,
                "id": "chatcmpl-BwxFNijrHJqHiEOulduDpo72Ws7A0",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "16",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 693,
                "out_toks": 15,
                "id": "chatcmpl-BwvJFrjOqzNhQBQsUN8p8JoZIfRQW",
                "created": 1753383021,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curves AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.sigmapsf,\n        d.distnr\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND magpsf IS NOT NULL)\n),\nmagstats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n),\nprobabilities AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.firstmjd,\n        lc.lastmjd,\n        -- Calculate initial rise as change in magnitude over time since last non-detection\n        (lc.magfirst - lc.maglast) / NULLIF(\n            (lc.firstmjd - \n             (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)\n            ), 0) AS initial_rise\n    FROM\n        magstat lc\n    WHERE\n        lc.oid IN (SELECT oid FROM objects_in_time_window)\n        AND (lc.firstmjd - \n             (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)\n            ) > 0\n        AND (\n            (lc.magfirst - \n             (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)\n            ) * 0.25\n        ) <= (lc.magfirst - lc.maglast)\n)\n-- Final selection combining all relevant info\nSELECT\n    sp.oid,\n    sp.stamp_probability AS probability_in_stamp_classifier,\n    d.fid AS detection_fid,\n    d.diffmaglim,\n    -- Use magstat.fid as magstat_fid\n    m.magstat_fid,\n    risers.initial_rise\nFROM\n    stamp_probs sp\nJOIN\n    probabilities p ON sp.oid = p.oid\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    detection d ON sp.oid = d.oid\nJOIN\n    magstat m ON sp.oid = m.oid\n    AND m.fid = d.fid\nJOIN\n    risers ON sp.oid = risers.oid\nORDER BY\n    sp.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curves AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.sigmapsf,\n        d.distnr\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND magpsf IS NOT NULL)\n),\nmagstats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n),\nprobabilities AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.firstmjd,\n        lc.lastmjd,\n        -- Calculate initial rise as change in magnitude over time since last non-detection\n        (lc.magfirst - lc.maglast) / NULLIF(\n            (lc.firstmjd - \n             (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)\n            ), 0) AS initial_rise\n    FROM\n        magstat lc\n    WHERE\n        lc.oid IN (SELECT oid FROM objects_in_time_window)\n        AND (lc.firstmjd - \n             (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)\n            ) > 0\n        AND (\n            (lc.magfirst - \n             (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)\n            ) * 0.25\n        ) <= (lc.magfirst - lc.maglast)\n)\n-- Final selection combining all relevant info\nSELECT\n    sp.oid,\n    sp.stamp_probability AS probability_in_stamp_classifier,\n    d.fid AS detection_fid,\n    d.diffmaglim,\n    -- Use magstat.fid as magstat_fid\n    m.magstat_fid,\n    risers.initial_rise\nFROM\n    stamp_probs sp\nJOIN\n    probabilities p ON sp.oid = p.oid\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    detection d ON sp.oid = d.oid\nJOIN\n    magstat m ON sp.oid = m.oid\n    AND m.fid = d.fid\nJOIN\n    risers ON sp.oid = risers.oid\nORDER BY\n    sp.oid\nLIMIT 100;\n```"
                },
                "in_toks": 4020,
                "out_toks": 886,
                "id": "chatcmpl-Bx0NhNVEofBLTKom14dP3UNF0Dkt6",
                "created": 1753402517,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curves AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.sigmapsf,\n        d.distnr\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND magpsf IS NOT NULL)\n),\nmagstats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n),\nprobabilities AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.firstmjd,\n        lc.lastmjd,\n        (lc.magfirst - lc.maglast) / (lc.firstmjd - (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)) AS initial_rise\n    FROM\n        magstat lc\n    WHERE\n        lc.oid IN (SELECT oid FROM objects_in_time_window)\n        AND (lc.firstmjd - (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)) > 0\n        AND ((lc.magfirst - (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)) * 0.25) <= (lc.magfirst - lc.maglast)\n)\nSELECT\n    sp.oid,\n    sp.stamp_probability AS probability_in_stamp_classifier,\n    d.fid AS detection_fid,\n    d.diffmaglim,\n    m.fid AS magstat_fid,\n    risers.initial_rise\nFROM\n    stamp_probs sp\nJOIN\n    probabilities p ON sp.oid = p.oid\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    light_curves d ON sp.oid = d.oid\nJOIN\n    magstats m ON sp.oid = m.oid AND m.fid = d.fid\nJOIN\n    risers ON sp.oid = risers.oid\nORDER BY\n    sp.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curves AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.diffmaglim,\n        d.magpsf,\n        d.sigmapsf,\n        d.distnr\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND magpsf IS NOT NULL)\n),\nmagstats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n),\nprobabilities AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n),\nrisers AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.firstmjd,\n        lc.lastmjd,\n        (lc.magfirst - lc.maglast) / (lc.firstmjd - (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)) AS initial_rise\n    FROM\n        magstat lc\n    WHERE\n        lc.oid IN (SELECT oid FROM objects_in_time_window)\n        AND (lc.firstmjd - (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)) > 0\n        AND ((lc.magfirst - (SELECT MAX(lastmjd) FROM magstat WHERE magstat.oid = lc.oid AND magstat.fid = lc.fid AND magstat.lastmjd < lc.firstmjd)) * 0.25) <= (lc.magfirst - lc.maglast)\n)\nSELECT\n    sp.oid,\n    sp.stamp_probability AS probability_in_stamp_classifier,\n    d.fid AS detection_fid,\n    d.diffmaglim,\n    m.fid AS magstat_fid,\n    risers.initial_rise\nFROM\n    stamp_probs sp\nJOIN\n    probabilities p ON sp.oid = p.oid\nJOIN\n    objects_in_time_window o ON sp.oid = o.oid\nJOIN\n    light_curves d ON sp.oid = d.oid\nJOIN\n    magstats m ON sp.oid = m.oid AND m.fid = d.fid\nJOIN\n    risers ON sp.oid = risers.oid\nORDER BY\n    sp.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 828,
                "id": "chatcmpl-BwxFPh2BeFNC54Y9RYbvHHINJAmk2",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "16",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 693,
                "out_toks": 15,
                "id": "chatcmpl-BwvJGTMTOKHVmUMYNHYXG1jsUzrtH",
                "created": 1753383022,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.probability = (\n            SELECT MAX(probability)\n            FROM probability p2\n            WHERE p2.oid = p.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n        )\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n),\n-- Calculate the maximum magnitude (magmax) and last magnitude (maglast) from magstat for each object in filter 2 (r-band)\nmag_stats AS (\n    SELECT\n        ms.oid,\n        ms.magmax,\n        ms.maglast,\n        ms.firstmjd\n    FROM\n        magstat ms\n    WHERE\n        ms.fid = 2\n),\n-- Compute the initial rise rate for objects with valid data\nfast_risers AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        -- Retrieve magmax, maglast, and firstmjd from mag_stats\n        ms.magmax,\n        ms.maglast,\n        ms.firstmjd AS magstat_firstmjd,\n        -- Calculate the rate of magnitude change: (magmax - maglast) / (firstmjd - last non-detection mjd)\n        -- Approximate last non-detection mjd as the maximum mjd before first detection\n        CASE\n            WHEN ms.magmax IS NOT NULL AND ms.maglast IS NOT NULL THEN\n                -- Find the last detection before firstmjd in filter 2\n                (ms.magmax - ms.maglast) /\n                NULLIF(\n                    o.firstmjd - (\n                        SELECT MAX(mjd)\n                        FROM detection\n                        WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2\n                    ),\n                    0 -- prevent division by zero\n                )\n            ELSE NULL\n        END AS initial_rise\n    FROM\n        object o\n        JOIN mag_stats ms ON o.oid = ms.oid\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n        AND ms.magmax IS NOT NULL\n        AND ms.maglast IS NOT NULL\n        AND (\n            SELECT MAX(mjd)\n            FROM detection\n            WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2\n        ) IS NOT NULL\n        AND (\n            o.firstmjd - (\n                SELECT MAX(mjd)\n                FROM detection\n                WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2\n            )\n        ) > 0\n        AND (\n            (ms.magmax - ms.maglast) /\n            NULLIF(\n                o.firstmjd - (\n                    SELECT MAX(mjd)\n                    FROM detection\n                    WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2\n                ),\n                0\n            )\n        ) >= 0.25\n)\nSELECT\n    o.oid,\n    sp.stamp_probability,\n    -- Retrieve filter id from detection for the first detection (assumed to be in filter 2)\n    d.fid AS magstat_fid,\n    -- Use magmax as the representative magnitude difference (since magap does not exist)\n    ms.magmax AS magstat_diffmag,\n    -- Use the detection mjd as the magstat_mjd\n    d.mjd AS magstat_mjd,\n    -- Provide the initial rise estimate if available\n    fr.initial_rise AS initial_rise_estimate\nFROM\n    fast_risers fr\n    JOIN object o ON fr.oid = o.oid\n    JOIN stamp_probs sp ON o.oid = sp.oid\n    JOIN magstat ms ON o.oid = ms.oid AND ms.fid = 2\n    JOIN detection d ON o.oid = d.oid AND d.mjd = (\n        -- Find the first detection in filter 2 for the object\n        SELECT MIN(mjd) FROM detection WHERE oid = o.oid AND fid = 2\n    )\nWHERE\n    -- Ensure the first detection is within the first 2 days of September 2023 (MJDs 60188.0 to 60190.0)\n    o.firstmjd BETWEEN 60188.0 AND 60190.0\n    -- Filter for objects with highest probability in SN class in stamp classifier\n    AND sp.stamp_probability IS NOT NULL\nORDER BY\n    o.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.probability = (\n            SELECT MAX(probability)\n            FROM probability p2\n            WHERE p2.oid = p.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n        )\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n),\n-- Calculate the maximum magnitude (magmax) and last magnitude (maglast) from magstat for each object in filter 2 (r-band)\nmag_stats AS (\n    SELECT\n        ms.oid,\n        ms.magmax,\n        ms.maglast,\n        ms.firstmjd\n    FROM\n        magstat ms\n    WHERE\n        ms.fid = 2\n),\n-- Compute the initial rise rate for objects with valid data\nfast_risers AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        -- Retrieve magmax, maglast, and firstmjd from mag_stats\n        ms.magmax,\n        ms.maglast,\n        ms.firstmjd AS magstat_firstmjd,\n        -- Calculate the rate of magnitude change: (magmax - maglast) / (firstmjd - last non-detection mjd)\n        -- Approximate last non-detection mjd as the maximum mjd before first detection\n        CASE\n            WHEN ms.magmax IS NOT NULL AND ms.maglast IS NOT NULL THEN\n                -- Find the last detection before firstmjd in filter 2\n                (ms.magmax - ms.maglast) /\n                NULLIF(\n                    o.firstmjd - (\n                        SELECT MAX(mjd)\n                        FROM detection\n                        WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2\n                    ),\n                    0 -- prevent division by zero\n                )\n            ELSE NULL\n        END AS initial_rise\n    FROM\n        object o\n        JOIN mag_stats ms ON o.oid = ms.oid\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n        AND ms.magmax IS NOT NULL\n        AND ms.maglast IS NOT NULL\n        AND (\n            SELECT MAX(mjd)\n            FROM detection\n            WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2\n        ) IS NOT NULL\n        AND (\n            o.firstmjd - (\n                SELECT MAX(mjd)\n                FROM detection\n                WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2\n            )\n        ) > 0\n        AND (\n            (ms.magmax - ms.maglast) /\n            NULLIF(\n                o.firstmjd - (\n                    SELECT MAX(mjd)\n                    FROM detection\n                    WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2\n                ),\n                0\n            )\n        ) >= 0.25\n)\nSELECT\n    o.oid,\n    sp.stamp_probability,\n    -- Retrieve filter id from detection for the first detection (assumed to be in filter 2)\n    d.fid AS magstat_fid,\n    -- Use magmax as the representative magnitude difference (since magap does not exist)\n    ms.magmax AS magstat_diffmag,\n    -- Use the detection mjd as the magstat_mjd\n    d.mjd AS magstat_mjd,\n    -- Provide the initial rise estimate if available\n    fr.initial_rise AS initial_rise_estimate\nFROM\n    fast_risers fr\n    JOIN object o ON fr.oid = o.oid\n    JOIN stamp_probs sp ON o.oid = sp.oid\n    JOIN magstat ms ON o.oid = ms.oid AND ms.fid = 2\n    JOIN detection d ON o.oid = d.oid AND d.mjd = (\n        -- Find the first detection in filter 2 for the object\n        SELECT MIN(mjd) FROM detection WHERE oid = o.oid AND fid = 2\n    )\nWHERE\n    -- Ensure the first detection is within the first 2 days of September 2023 (MJDs 60188.0 to 60190.0)\n    o.firstmjd BETWEEN 60188.0 AND 60190.0\n    -- Filter for objects with highest probability in SN class in stamp classifier\n    AND sp.stamp_probability IS NOT NULL\nORDER BY\n    o.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3882,
                "out_toks": 1034,
                "id": "chatcmpl-Bx080snuiHX4wRHhXi4yg3ogLyG3l",
                "created": 1753401544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.probability = (\n            SELECT MAX(probability)\n            FROM probability p2\n            WHERE p2.oid = p.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n        )\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n),\nfast_risers AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        -- Calculate initial rise rate: (magmax - maglast) / (firstmjd - last non-detection mjd)\n        -- For simplicity, assume magmax is magmax from magstat, and last non-detection is approximated by the last negative detection before first detection\n        -- Since detailed last non-detection data is not directly available, approximate using detection data\n        -- For this query, we will assume magmax and maglast are available in magstat\n        ms.magmax AS magmax,\n        ms.maglast AS maglast,\n        ms.firstmjd AS magstat_firstmjd,\n        -- Compute the rate of magnitude change\n        CASE\n            WHEN ms.magmax IS NOT NULL AND ms.maglast IS NOT NULL AND (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2)) > 0\n            THEN (ms.magmax - ms.maglast) / (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2))\n            ELSE NULL\n        END AS initial_rise\n    FROM\n        object o\n        JOIN magstat ms ON o.oid = ms.oid AND ms.fid = 2\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n        AND ms.magmax IS NOT NULL\n        AND ms.maglast IS NOT NULL\n        AND (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2)) > 0\n        AND ((ms.magmax - ms.maglast) / (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2))) >= 0.25\n)\nSELECT\n    o.oid,\n    sp.stamp_probability,\n    d.fid AS magstat_fid,\n    d.magap AS magstat_diffmag,\n    d.mjd AS magstat_mjd,\n    -- Approximate initial rise estimate\n    CASE\n        WHEN fr.initial_rise IS NOT NULL THEN fr.initial_rise\n        ELSE NULL\n    END AS initial_rise_estimate\nFROM\n    fast_risers fr\n    JOIN object o ON fr.oid = o.oid\n    JOIN stamp_probs sp ON o.oid = sp.oid\n    JOIN magstat d ON o.oid = d.oid AND d.fid = 2\nORDER BY\n    o.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.probability = (\n            SELECT MAX(probability)\n            FROM probability p2\n            WHERE p2.oid = p.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n        )\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n),\nfast_risers AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        -- Calculate initial rise rate: (magmax - maglast) / (firstmjd - last non-detection mjd)\n        -- For simplicity, assume magmax is magmax from magstat, and last non-detection is approximated by the last negative detection before first detection\n        -- Since detailed last non-detection data is not directly available, approximate using detection data\n        -- For this query, we will assume magmax and maglast are available in magstat\n        ms.magmax AS magmax,\n        ms.maglast AS maglast,\n        ms.firstmjd AS magstat_firstmjd,\n        -- Compute the rate of magnitude change\n        CASE\n            WHEN ms.magmax IS NOT NULL AND ms.maglast IS NOT NULL AND (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2)) > 0\n            THEN (ms.magmax - ms.maglast) / (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2))\n            ELSE NULL\n        END AS initial_rise\n    FROM\n        object o\n        JOIN magstat ms ON o.oid = ms.oid AND ms.fid = 2\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60190.0\n        AND ms.magmax IS NOT NULL\n        AND ms.maglast IS NOT NULL\n        AND (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2)) > 0\n        AND ((ms.magmax - ms.maglast) / (o.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = o.oid AND mjd < o.firstmjd AND fid = 2))) >= 0.25\n)\nSELECT\n    o.oid,\n    sp.stamp_probability,\n    d.fid AS magstat_fid,\n    d.magap AS magstat_diffmag,\n    d.mjd AS magstat_mjd,\n    -- Approximate initial rise estimate\n    CASE\n        WHEN fr.initial_rise IS NOT NULL THEN fr.initial_rise\n        ELSE NULL\n    END AS initial_rise_estimate\nFROM\n    fast_risers fr\n    JOIN object o ON fr.oid = o.oid\n    JOIN stamp_probs sp ON o.oid = sp.oid\n    JOIN magstat d ON o.oid = d.oid AND d.fid = 2\nORDER BY\n    o.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 764,
                "id": "chatcmpl-BwxFRcevFYViFlKNhLY3f4xwCy26G",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "16",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 693,
                "out_toks": 15,
                "id": "chatcmpl-BwvJHM3lIiwpuWEp0vVZQMjiogJCr",
                "created": 1753383023,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and light curve info for fast risers with specific conditions\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nstamp_max AS (\n    SELECT\n        mp.oid,\n        mp.probability\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN'\n),\nlight_curve_non_detections AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.isdiffpos,\n        d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM first_detections)\n      AND d.mjd < (\n          SELECT MIN(mjd)\n          FROM detection\n          WHERE oid = d.oid\n            AND isdiffpos = 1\n      )\n),\nmag_stats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.ndet,\n        m.ndubious,\n        m.magmean,\n        m.magmedian,\n        m.magmax,\n        m.magmin,\n        m.magsigma,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT\n        ms.oid,\n        ms.magfirst,\n        ms.maglast,\n        ms.firstmjd,\n        ms.lastmjd,\n        -- Calculate initial rise rate: change in magnitude over time between first detection and last non-detection before the first detection\n        CASE\n            WHEN\n                (ms.firstmjd - (\n                    SELECT MAX(d2.mjd)\n                    FROM detection d2\n                    WHERE d2.oid = ms.oid\n                      AND d2.isdiffpos = 0\n                      AND d2.mjd < ms.firstmjd\n                )) != 0\n            THEN\n                (ms.magfirst - ms.maglast) /\n                (ms.firstmjd - (\n                    SELECT MAX(d2.mjd)\n                    FROM detection d2\n                    WHERE d2.oid = ms.oid\n                      AND d2.isdiffpos = 0\n                      AND d2.mjd < ms.firstmjd\n                ))\n            ELSE NULL\n        END AS rise_rate\n    FROM mag_stats ms\n    WHERE ms.oid IN (SELECT oid FROM first_detections)\n),\nqualified_objects AS (\n    SELECT\n        f.oid\n    FROM first_detections f\n    JOIN stamp_max s ON f.oid = s.oid\n    JOIN initial_rise ir ON f.oid = ir.oid\n    WHERE s.probability = (\n        SELECT MAX(p2.probability)\n        FROM max_prob p2\n        WHERE p2.oid = f.oid\n    )\n      AND s.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n      )\n      AND ir.rise_rate >= 0.25 -- qualify as fast risers\n)\nSELECT\n    q.oid,\n    s.probability AS stamp_probability,\n    lc.fid AS filter_id,\n    lc.magpsf AS mag_difference,\n    m.magstat_fid,\n    -- Recompute initial rise estimate: magnitude change over time between first detection and last non-detection before first detection\n    CASE\n        WHEN\n            (initial_rise.firstmjd - (\n                SELECT MAX(d2.mjd)\n                FROM detection d2\n                WHERE d2.oid = q.oid\n                  AND d2.isdiffpos = 0\n                  AND d2.mjd < initial_rise.firstmjd\n            )) != 0\n        THEN\n            (initial_rise.magfirst - initial_rise.maglast) /\n            (initial_rise.firstmjd - (\n                SELECT MAX(d2.mjd)\n                FROM detection d2\n                WHERE d2.oid = q.oid\n                  AND d2.isdiffpos = 0\n                  AND d2.mjd < initial_rise.firstmjd\n            ))\n        ELSE NULL\n    END AS initial_rise_estimate\nFROM qualified_objects q\nJOIN stamp_max s ON q.oid = s.oid\nJOIN light_curve_non_detections lc ON q.oid = lc.oid\nJOIN mag_stats m ON q.oid = m.oid\nJOIN initial_rise ON q.oid = initial_rise.oid\nORDER BY q.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and light curve info for fast risers with specific conditions\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nstamp_max AS (\n    SELECT\n        mp.oid,\n        mp.probability\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN'\n),\nlight_curve_non_detections AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.isdiffpos,\n        d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM first_detections)\n      AND d.mjd < (\n          SELECT MIN(mjd)\n          FROM detection\n          WHERE oid = d.oid\n            AND isdiffpos = 1\n      )\n),\nmag_stats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.ndet,\n        m.ndubious,\n        m.magmean,\n        m.magmedian,\n        m.magmax,\n        m.magmin,\n        m.magsigma,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT\n        ms.oid,\n        ms.magfirst,\n        ms.maglast,\n        ms.firstmjd,\n        ms.lastmjd,\n        -- Calculate initial rise rate: change in magnitude over time between first detection and last non-detection before the first detection\n        CASE\n            WHEN\n                (ms.firstmjd - (\n                    SELECT MAX(d2.mjd)\n                    FROM detection d2\n                    WHERE d2.oid = ms.oid\n                      AND d2.isdiffpos = 0\n                      AND d2.mjd < ms.firstmjd\n                )) != 0\n            THEN\n                (ms.magfirst - ms.maglast) /\n                (ms.firstmjd - (\n                    SELECT MAX(d2.mjd)\n                    FROM detection d2\n                    WHERE d2.oid = ms.oid\n                      AND d2.isdiffpos = 0\n                      AND d2.mjd < ms.firstmjd\n                ))\n            ELSE NULL\n        END AS rise_rate\n    FROM mag_stats ms\n    WHERE ms.oid IN (SELECT oid FROM first_detections)\n),\nqualified_objects AS (\n    SELECT\n        f.oid\n    FROM first_detections f\n    JOIN stamp_max s ON f.oid = s.oid\n    JOIN initial_rise ir ON f.oid = ir.oid\n    WHERE s.probability = (\n        SELECT MAX(p2.probability)\n        FROM max_prob p2\n        WHERE p2.oid = f.oid\n    )\n      AND s.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n      )\n      AND ir.rise_rate >= 0.25 -- qualify as fast risers\n)\nSELECT\n    q.oid,\n    s.probability AS stamp_probability,\n    lc.fid AS filter_id,\n    lc.magpsf AS mag_difference,\n    m.magstat_fid,\n    -- Recompute initial rise estimate: magnitude change over time between first detection and last non-detection before first detection\n    CASE\n        WHEN\n            (initial_rise.firstmjd - (\n                SELECT MAX(d2.mjd)\n                FROM detection d2\n                WHERE d2.oid = q.oid\n                  AND d2.isdiffpos = 0\n                  AND d2.mjd < initial_rise.firstmjd\n            )) != 0\n        THEN\n            (initial_rise.magfirst - initial_rise.maglast) /\n            (initial_rise.firstmjd - (\n                SELECT MAX(d2.mjd)\n                FROM detection d2\n                WHERE d2.oid = q.oid\n                  AND d2.isdiffpos = 0\n                  AND d2.mjd < initial_rise.firstmjd\n            ))\n        ELSE NULL\n    END AS initial_rise_estimate\nFROM qualified_objects q\nJOIN stamp_max s ON q.oid = s.oid\nJOIN light_curve_non_detections lc ON q.oid = lc.oid\nJOIN mag_stats m ON q.oid = m.oid\nJOIN initial_rise ON q.oid = initial_rise.oid\nORDER BY q.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3915,
                "out_toks": 1069,
                "id": "chatcmpl-Bx07xuD8bMqApa7TU1lUwH3zf041g",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and light curve info for fast risers with specific conditions\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nstamp_max AS (\n    SELECT\n        mp.oid,\n        mp.probability\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN'\n),\nlight_curve_non_detections AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.isdiffpos,\n        d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM first_detections)\n      AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND isdiffpos = 1)\n),\nmag_stats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.ndet,\n        m.ndubious,\n        m.magmean,\n        m.magmedian,\n        m.magmax,\n        m.magmin,\n        m.magsigma,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.firstmjd,\n        lc.lastmjd,\n        (lc.magfirst - lc.maglast) / (lc.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = lc.oid AND isdiffpos = 0 AND mjd < (SELECT MIN(mjd) FROM detection WHERE oid = lc.oid AND isdiffpos = 1))) AS rise_rate\n    FROM magstat lc\n    WHERE lc.oid IN (SELECT oid FROM first_detections)\n),\nqualified_objects AS (\n    SELECT\n        f.oid\n    FROM first_detections f\n    JOIN stamp_max s ON f.oid = s.oid\n    WHERE s.probability = (SELECT MAX(probability) FROM max_prob WHERE oid = f.oid)\n      AND s.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n      )\n      AND (initial_rise.rise_rate >= 0.25)\n)\nSELECT\n    q.oid,\n    s.probability AS stamp_probability,\n    lc.fid AS filter_id,\n    lc.magpsf AS mag_difference,\n    m.magstat_fid,\n    (initial_rise.magfirst - initial_rise.maglast) / (initial_rise.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = q.oid AND isdiffpos = 0 AND mjd < (SELECT MIN(mjd) FROM detection WHERE oid = q.oid AND isdiffpos = 1))) AS initial_rise_estimate\nFROM qualified_objects q\nJOIN stamp_max s ON q.oid = s.oid\nJOIN light_curve_non_detections lc ON q.oid = lc.oid\nJOIN mag_stats m ON q.oid = m.oid\nJOIN initial_rise ON q.oid = initial_rise.oid\nORDER BY q.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and light curve info for fast risers with specific conditions\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n),\nstamp_max AS (\n    SELECT\n        mp.oid,\n        mp.probability\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN'\n),\nlight_curve_non_detections AS (\n    SELECT\n        d.oid,\n        d.mjd,\n        d.magpsf,\n        d.isdiffpos,\n        d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM first_detections)\n      AND d.mjd < (SELECT MIN(mjd) FROM detection WHERE oid = d.oid AND isdiffpos = 1)\n),\nmag_stats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.ndet,\n        m.ndubious,\n        m.magmean,\n        m.magmedian,\n        m.magmax,\n        m.magmin,\n        m.magsigma,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM first_detections)\n),\ninitial_rise AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.firstmjd,\n        lc.lastmjd,\n        (lc.magfirst - lc.maglast) / (lc.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = lc.oid AND isdiffpos = 0 AND mjd < (SELECT MIN(mjd) FROM detection WHERE oid = lc.oid AND isdiffpos = 1))) AS rise_rate\n    FROM magstat lc\n    WHERE lc.oid IN (SELECT oid FROM first_detections)\n),\nqualified_objects AS (\n    SELECT\n        f.oid\n    FROM first_detections f\n    JOIN stamp_max s ON f.oid = s.oid\n    WHERE s.probability = (SELECT MAX(probability) FROM max_prob WHERE oid = f.oid)\n      AND s.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n      )\n      AND (initial_rise.rise_rate >= 0.25)\n)\nSELECT\n    q.oid,\n    s.probability AS stamp_probability,\n    lc.fid AS filter_id,\n    lc.magpsf AS mag_difference,\n    m.magstat_fid,\n    (initial_rise.magfirst - initial_rise.maglast) / (initial_rise.firstmjd - (SELECT MAX(mjd) FROM detection WHERE oid = q.oid AND isdiffpos = 0 AND mjd < (SELECT MIN(mjd) FROM detection WHERE oid = q.oid AND isdiffpos = 1))) AS initial_rise_estimate\nFROM qualified_objects q\nJOIN stamp_max s ON q.oid = s.oid\nJOIN light_curve_non_detections lc ON q.oid = lc.oid\nJOIN mag_stats m ON q.oid = m.oid\nJOIN initial_rise ON q.oid = initial_rise.oid\nORDER BY q.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 810,
                "id": "chatcmpl-BwxFCQNL9oegElSA17CmrTfV4fTEH",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "16",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 693,
                "out_toks": 15,
                "id": "chatcmpl-BwvJINaaFwi4u0FeWIB4iFvwxtZnf",
                "created": 1753383024,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with specific criteria: first detection in first 2 days of September, highest probability class 'SN', and fast rise\nWITH first_detections AS (\n    SELECT o.oid,\n           o.firstmjd,\n           o.ndet,\n           o.ndethist,\n           o.meanra,\n           o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT p.oid,\n           p.probability,\n           p.class_name,\n           p.classifier_name,\n           p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- top-ranked class\n),\nsn_objects AS (\n    SELECT mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- class SN with highest probability\n),\ncandidate_objects AS (\n    SELECT fd.oid,\n           fd.firstmjd,\n           fd.ndet,\n           fd.meanra,\n           fd.meandec\n    FROM first_detections fd\n    JOIN sn_objects sn ON fd.oid = sn.oid\n),\ndetection_data AS (\n    SELECT d.oid,\n           d.candid,\n           d.mjd,\n           d.fid,\n           d.magpsf,\n           d.distnr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM candidate_objects)\n      AND d.mjd BETWEEN 60188.0 AND 60189.0 -- detections during the first 2 days\n),\nmagstat_data AS (\n    SELECT m.oid,\n           m.fid AS magstat_fid,\n           m.magfirst,\n           m.maglast,\n           m.firstmjd,\n           m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM candidate_objects)\n),\nrise_estimates AS (\n    SELECT d.oid,\n           d.candid,\n           d.mjd,\n           d.fid,\n           d.magpsf,\n           m.magfirst,\n           m.maglast,\n           m.firstmjd,\n           m.lastmjd,\n           -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - last non-detection mjd)\n           CASE\n               WHEN m.firstmjd > m.lastmjd AND (m.firstmjd - m.lastmjd) > 0\n               THEN (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n               ELSE NULL\n           END AS initial_rise\n    FROM detection_data d\n    JOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd = m.firstmjd -- detection at first detection time\n),\nfast_risers AS (\n    SELECT re.oid,\n           re.candid,\n           re.mjd,\n           re.fid,\n           re.magpsf,\n           re.magfirst,\n           re.maglast,\n           re.firstmjd,\n           re.lastmjd,\n           re.initial_rise\n    FROM rise_estimates re\n    WHERE re.initial_rise >= 0.25 -- criterion for fast risers\n)\n-- Final selection with ordering and limit\nSELECT\n    c.oid,\n    p.probability,\n    d.fid AS detection_fid,\n    d.magpsf,\n    -- Retrieve magstat_fid from magstat table for the object and filter\n    m.fid AS magstat_fid,\n    re.initial_rise\nFROM fast_risers re\nJOIN object c ON re.oid = c.oid\nJOIN probability p ON p.oid = c.oid AND p.class_name = 'SN' AND p.classifier_name = 'stamp_classifier' AND p.ranking = 1\nJOIN detection d ON d.oid = c.oid AND d.mjd = c.firstmjd\nJOIN magstat m ON m.oid = c.oid AND m.fid = d.fid\nORDER BY c.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria: first detection in first 2 days of September, highest probability class 'SN', and fast rise\nWITH first_detections AS (\n    SELECT o.oid,\n           o.firstmjd,\n           o.ndet,\n           o.ndethist,\n           o.meanra,\n           o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT p.oid,\n           p.probability,\n           p.class_name,\n           p.classifier_name,\n           p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- top-ranked class\n),\nsn_objects AS (\n    SELECT mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- class SN with highest probability\n),\ncandidate_objects AS (\n    SELECT fd.oid,\n           fd.firstmjd,\n           fd.ndet,\n           fd.meanra,\n           fd.meandec\n    FROM first_detections fd\n    JOIN sn_objects sn ON fd.oid = sn.oid\n),\ndetection_data AS (\n    SELECT d.oid,\n           d.candid,\n           d.mjd,\n           d.fid,\n           d.magpsf,\n           d.distnr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM candidate_objects)\n      AND d.mjd BETWEEN 60188.0 AND 60189.0 -- detections during the first 2 days\n),\nmagstat_data AS (\n    SELECT m.oid,\n           m.fid AS magstat_fid,\n           m.magfirst,\n           m.maglast,\n           m.firstmjd,\n           m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM candidate_objects)\n),\nrise_estimates AS (\n    SELECT d.oid,\n           d.candid,\n           d.mjd,\n           d.fid,\n           d.magpsf,\n           m.magfirst,\n           m.maglast,\n           m.firstmjd,\n           m.lastmjd,\n           -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - last non-detection mjd)\n           CASE\n               WHEN m.firstmjd > m.lastmjd AND (m.firstmjd - m.lastmjd) > 0\n               THEN (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n               ELSE NULL\n           END AS initial_rise\n    FROM detection_data d\n    JOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd = m.firstmjd -- detection at first detection time\n),\nfast_risers AS (\n    SELECT re.oid,\n           re.candid,\n           re.mjd,\n           re.fid,\n           re.magpsf,\n           re.magfirst,\n           re.maglast,\n           re.firstmjd,\n           re.lastmjd,\n           re.initial_rise\n    FROM rise_estimates re\n    WHERE re.initial_rise >= 0.25 -- criterion for fast risers\n)\n-- Final selection with ordering and limit\nSELECT\n    c.oid,\n    p.probability,\n    d.fid AS detection_fid,\n    d.magpsf,\n    -- Retrieve magstat_fid from magstat table for the object and filter\n    m.fid AS magstat_fid,\n    re.initial_rise\nFROM fast_risers re\nJOIN object c ON re.oid = c.oid\nJOIN probability p ON p.oid = c.oid AND p.class_name = 'SN' AND p.classifier_name = 'stamp_classifier' AND p.ranking = 1\nJOIN detection d ON d.oid = c.oid AND d.mjd = c.firstmjd\nJOIN magstat m ON m.oid = c.oid AND m.fid = d.fid\nORDER BY c.oid\nLIMIT 100;\n```"
                },
                "in_toks": 4067,
                "out_toks": 858,
                "id": "chatcmpl-Bx08JZQRf5zJbq9KGuvm50RMI6dU8",
                "created": 1753401563,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- class SN with highest probability\n),\ncandidate_objects AS (\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.ndet,\n        fd.meanra,\n        fd.meandec\n    FROM first_detections fd\n    JOIN sn_objects sn ON fd.oid = sn.oid\n),\ndetection_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        d.distnr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM candidate_objects)\n      AND d.mjd BETWEEN 60188.0 AND 60189.0 -- detections during the first 2 days\n),\nmagstat_data AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM candidate_objects)\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd,\n        -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - last non-detection mjd)\n        CASE\n            WHEN m.firstmjd > m.lastmjd AND (m.firstmjd - m.lastmjd) > 0\n            THEN (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS initial_rise\n    FROM detection_data d\n    JOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd = m.firstmjd -- only the detection at first detection time\n),\nfast_risers AS (\n    SELECT\n        re.oid,\n        re.candid,\n        re.mjd,\n        re.fid,\n        re.magpsf,\n        re.magfirst,\n        re.maglast,\n        re.firstmjd,\n        re.lastmjd,\n        re.initial_rise\n    FROM rise_estimates re\n    WHERE re.initial_rise >= 0.25 -- fast riser criterion\n)\n-- Final selection with ordering and limit\nSELECT\n    c.oid,\n    p.probability,\n    d.fid AS detection_fid,\n    d.magpsf,\n    m.magstat_fid,\n    re.initial_rise\nFROM fast_risers re\nJOIN object c ON re.oid = c.oid\nJOIN probability p ON p.oid = c.oid AND p.class_name = 'SN' AND p.classifier_name = 'stamp_classifier' AND p.ranking = 1\nJOIN detection d ON d.oid = c.oid AND d.mjd = c.firstmjd\nJOIN magstat m ON m.oid = c.oid AND m.fid = d.fid\nORDER BY c.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- class SN with highest probability\n),\ncandidate_objects AS (\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.ndet,\n        fd.meanra,\n        fd.meandec\n    FROM first_detections fd\n    JOIN sn_objects sn ON fd.oid = sn.oid\n),\ndetection_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        d.distnr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM candidate_objects)\n      AND d.mjd BETWEEN 60188.0 AND 60189.0 -- detections during the first 2 days\n),\nmagstat_data AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM candidate_objects)\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.fid,\n        d.magpsf,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd,\n        -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - last non-detection mjd)\n        CASE\n            WHEN m.firstmjd > m.lastmjd AND (m.firstmjd - m.lastmjd) > 0\n            THEN (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS initial_rise\n    FROM detection_data d\n    JOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\n    WHERE d.mjd = m.firstmjd -- only the detection at first detection time\n),\nfast_risers AS (\n    SELECT\n        re.oid,\n        re.candid,\n        re.mjd,\n        re.fid,\n        re.magpsf,\n        re.magfirst,\n        re.maglast,\n        re.firstmjd,\n        re.lastmjd,\n        re.initial_rise\n    FROM rise_estimates re\n    WHERE re.initial_rise >= 0.25 -- fast riser criterion\n)\n-- Final selection with ordering and limit\nSELECT\n    c.oid,\n    p.probability,\n    d.fid AS detection_fid,\n    d.magpsf,\n    m.magstat_fid,\n    re.initial_rise\nFROM fast_risers re\nJOIN object c ON re.oid = c.oid\nJOIN probability p ON p.oid = c.oid AND p.class_name = 'SN' AND p.classifier_name = 'stamp_classifier' AND p.ranking = 1\nJOIN detection d ON d.oid = c.oid AND d.mjd = c.firstmjd\nJOIN magstat m ON m.oid = c.oid AND m.fid = d.fid\nORDER BY c.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 845,
                "id": "chatcmpl-BwxFCP1kT11Kyzebw3pIyB53o6djW",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "16",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 693,
                "out_toks": 15,
                "id": "chatcmpl-BwvJIlwcsXqOaQgkF4CxtbF1qkXYZ",
                "created": 1753383024,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with specific criteria: first detection in first 2 days of September, highest class probability as SN, and fast rise\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- top-ranked class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- class is SN\n),\nmagstats_rband AS (\n    SELECT\n        m.oid,\n        m.fid,\n        m.magfirst,\n        m.maglast,\n        m.ndet,\n        m.magsigma,\n        m.firstmjd\n    FROM magstat m\n    WHERE m.fid = 2 -- r-band\n),\nfast_risers AS (\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.ndet,\n        fd.ndethist,\n        mr.magfirst,\n        mr.maglast,\n        mr.magsigma,\n        mr.fid\n    FROM first_detections fd\n    JOIN magstats_rband mr ON mr.oid = fd.oid\n    WHERE mr.ndet > 0\n      AND mr.magfirst IS NOT NULL\n      AND mr.maglast IS NOT NULL\n      AND (mr.magfirst - mr.maglast) / (fd.firstmjd - (fd.mjdendhist - fd.ndethist)) >= 0.25 -- initial rise rate >= 0.25 mag/day\n)\nSELECT\n    sr.oid,\n    mp.probability,\n    2 AS filter_id,\n    d.magpsf AS diffmag,\n    d.fid AS diff_filter_id,\n    -- Calculate initial rise: difference in magnitude divided by time difference between first detection and earliest detection\n    (sr.magfirst - sr.maglast) / NULLIF((sr.firstmjd - \n        (SELECT MIN(mjd) FROM detection WHERE oid = sr.oid AND fid = 2)), 0) AS initial_rise\nFROM fast_risers sr\nJOIN max_prob mp ON mp.oid = sr.oid\nJOIN detection d ON d.oid = sr.oid AND d.fid = 2\nWHERE mp.class_name = 'SN'\nORDER BY sr.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria: first detection in first 2 days of September, highest class probability as SN, and fast rise\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- top-ranked class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- class is SN\n),\nmagstats_rband AS (\n    SELECT\n        m.oid,\n        m.fid,\n        m.magfirst,\n        m.maglast,\n        m.ndet,\n        m.magsigma,\n        m.firstmjd\n    FROM magstat m\n    WHERE m.fid = 2 -- r-band\n),\nfast_risers AS (\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.ndet,\n        fd.ndethist,\n        mr.magfirst,\n        mr.maglast,\n        mr.magsigma,\n        mr.fid\n    FROM first_detections fd\n    JOIN magstats_rband mr ON mr.oid = fd.oid\n    WHERE mr.ndet > 0\n      AND mr.magfirst IS NOT NULL\n      AND mr.maglast IS NOT NULL\n      AND (mr.magfirst - mr.maglast) / (fd.firstmjd - (fd.mjdendhist - fd.ndethist)) >= 0.25 -- initial rise rate >= 0.25 mag/day\n)\nSELECT\n    sr.oid,\n    mp.probability,\n    2 AS filter_id,\n    d.magpsf AS diffmag,\n    d.fid AS diff_filter_id,\n    -- Calculate initial rise: difference in magnitude divided by time difference between first detection and earliest detection\n    (sr.magfirst - sr.maglast) / NULLIF((sr.firstmjd - \n        (SELECT MIN(mjd) FROM detection WHERE oid = sr.oid AND fid = 2)), 0) AS initial_rise\nFROM fast_risers sr\nJOIN max_prob mp ON mp.oid = sr.oid\nJOIN detection d ON d.oid = sr.oid AND d.fid = 2\nWHERE mp.class_name = 'SN'\nORDER BY sr.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3468,
                "out_toks": 579,
                "id": "chatcmpl-Bx07zG0p9w1ZesEjEOPuWkVwpmgpY",
                "created": 1753401543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\nfast_risers AS (\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.ndet,\n        fd.ndethist,\n        magstat.magfirst,\n        magstat.maglast,\n        magstat.dmdt_first,\n        magstat.fistmjd,\n        magstat.magsigma,\n        magstat.fid AS magstat_fid\n    FROM first_detections fd\n    JOIN magstat ON magstat.oid = fd.oid AND magstat.fid = 2 -- r-band\n    WHERE magstat.ndet > 0\n      AND magstat.magfirst IS NOT NULL\n      AND magstat.maglast IS NOT NULL\n      AND magstat.fid = 2\n      AND (magstat.magfirst - magstat.maglast) / (fd.firstmjd - (fd.mjdendhist - fd.ndethist)) >= 0.25 -- initial rise rate >= 0.25 mag/day\n)\nSELECT\n    sr.oid,\n    mp.probability,\n    2 AS filter_id,\n    d.magpsf AS diffmag,\n    d.fid AS diff_filter_id,\n    -- Calculate initial rise estimate: difference in magnitude divided by time difference\n    (sr.magfirst - sr.maglast) / (sr.firstmjd - (SELECT mjd FROM detection WHERE oid = sr.oid AND fid = 2 ORDER BY mjd LIMIT 1)) AS initial_rise\nFROM fast_risers sr\nJOIN max_prob mp ON mp.oid = sr.oid\nJOIN detection d ON d.oid = sr.oid AND d.fid = 2\nWHERE mp.class_name = 'SN'\nORDER BY sr.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- highest probability class\n),\nsn_objects AS (\n    SELECT\n        mp.oid\n    FROM max_prob mp\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\nfast_risers AS (\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.ndet,\n        fd.ndethist,\n        magstat.magfirst,\n        magstat.maglast,\n        magstat.dmdt_first,\n        magstat.fistmjd,\n        magstat.magsigma,\n        magstat.fid AS magstat_fid\n    FROM first_detections fd\n    JOIN magstat ON magstat.oid = fd.oid AND magstat.fid = 2 -- r-band\n    WHERE magstat.ndet > 0\n      AND magstat.magfirst IS NOT NULL\n      AND magstat.maglast IS NOT NULL\n      AND magstat.fid = 2\n      AND (magstat.magfirst - magstat.maglast) / (fd.firstmjd - (fd.mjdendhist - fd.ndethist)) >= 0.25 -- initial rise rate >= 0.25 mag/day\n)\nSELECT\n    sr.oid,\n    mp.probability,\n    2 AS filter_id,\n    d.magpsf AS diffmag,\n    d.fid AS diff_filter_id,\n    -- Calculate initial rise estimate: difference in magnitude divided by time difference\n    (sr.magfirst - sr.maglast) / (sr.firstmjd - (SELECT mjd FROM detection WHERE oid = sr.oid AND fid = 2 ORDER BY mjd LIMIT 1)) AS initial_rise\nFROM fast_risers sr\nJOIN max_prob mp ON mp.oid = sr.oid\nJOIN detection d ON d.oid = sr.oid AND d.fid = 2\nWHERE mp.class_name = 'SN'\nORDER BY sr.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 548,
                "id": "chatcmpl-BwxFFchi3Kib3DLKJ694QBxiNJd28",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "16",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 693,
                "out_toks": 15,
                "id": "chatcmpl-BwvJK1ltcvlLqTr48fbHJjYDjmA7c",
                "created": 1753383026,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_info AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        -- Calculate initial rise estimate: difference in mag divided by time difference\n        -- Note: The columns d.dmagdt_first and d.dm_first do not exist in the schema.\n        -- Instead, compute the initial rise as the difference between magpsf and maglast in magstat, divided by time difference.\n        -- But since magstat info is in a separate table, we will join later.\n        NULL AS initial_rise -- Placeholder, will compute after joining with magstat\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.isdiffpos = 1 -- positive difference (brightening)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd,\n        -- Calculate the rate of magnitude change\n        CASE\n            WHEN m.firstmjd IS NOT NULL AND m.lastmjd IS NOT NULL AND m.firstmjd != m.lastmjd THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS mag_change_rate\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n)\n-- Now, join detection and magstat to compute initial rise\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    lc.candid,\n    lc.fid,\n    lc.magpsf,\n    -- Compute initial rise as difference between magpsf and maglast divided by time difference\n    CASE\n        WHEN ms.maglast IS NOT NULL AND ms.firstmjd IS NOT NULL AND ms.lastmjd IS NOT NULL AND ms.firstmjd != ms.lastmjd THEN\n            (lc.magpsf - ms.maglast) / (ms.firstmjd - ms.lastmjd)\n        ELSE NULL\n    END AS initial_rise,\n    ms.magstat_fid,\n    ms.mag_change_rate\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window oiw ON sp.oid = oiw.oid\nJOIN\n    detection lc ON sp.oid = lc.oid\nLEFT JOIN\n    magstat_info ms ON sp.oid = ms.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser\n    -- Using mag_change_rate from magstat info\n    ms.mag_change_rate >= 0.25\nORDER BY\n    sp.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_info AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        -- Calculate initial rise estimate: difference in mag divided by time difference\n        -- Note: The columns d.dmagdt_first and d.dm_first do not exist in the schema.\n        -- Instead, compute the initial rise as the difference between magpsf and maglast in magstat, divided by time difference.\n        -- But since magstat info is in a separate table, we will join later.\n        NULL AS initial_rise -- Placeholder, will compute after joining with magstat\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.isdiffpos = 1 -- positive difference (brightening)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd,\n        -- Calculate the rate of magnitude change\n        CASE\n            WHEN m.firstmjd IS NOT NULL AND m.lastmjd IS NOT NULL AND m.firstmjd != m.lastmjd THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS mag_change_rate\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n)\n-- Now, join detection and magstat to compute initial rise\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    lc.candid,\n    lc.fid,\n    lc.magpsf,\n    -- Compute initial rise as difference between magpsf and maglast divided by time difference\n    CASE\n        WHEN ms.maglast IS NOT NULL AND ms.firstmjd IS NOT NULL AND ms.lastmjd IS NOT NULL AND ms.firstmjd != ms.lastmjd THEN\n            (lc.magpsf - ms.maglast) / (ms.firstmjd - ms.lastmjd)\n        ELSE NULL\n    END AS initial_rise,\n    ms.magstat_fid,\n    ms.mag_change_rate\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window oiw ON sp.oid = oiw.oid\nJOIN\n    detection lc ON sp.oid = lc.oid\nLEFT JOIN\n    magstat_info ms ON sp.oid = ms.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser\n    -- Using mag_change_rate from magstat info\n    ms.mag_change_rate >= 0.25\nORDER BY\n    sp.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3510,
                "out_toks": 746,
                "id": "chatcmpl-Bx081RqCchlZQ6DDsVhveX4btfTwP",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_info AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        d.dmagdt_first,\n        -- Calculate initial rise estimate: difference in mag divided by time difference\n        CASE\n            WHEN d.dmagdt_first IS NOT NULL AND d.dt_first > 0 THEN\n                d.dm_first / d.dt_first\n            ELSE\n                NULL\n        END AS initial_rise\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.isdiffpos = 1 -- positive difference (brightening)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd,\n        -- Calculate the rate of magnitude change\n        CASE\n            WHEN m.firstmjd IS NOT NULL AND m.lastmjd IS NOT NULL AND m.firstmjd != m.lastmjd THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE\n                NULL\n        END AS mag_change_rate\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n)\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    lc.fid,\n    lc.magpsf,\n    lc.dmagdt_first,\n    lc.dt_first,\n    mi.magstat_fid,\n    mi.mag_change_rate\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window oiw ON sp.oid = oiw.oid\nJOIN\n    light_curve_info lc ON sp.oid = lc.oid\nJOIN\n    magstat_info mi ON sp.oid = mi.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser\n    mi.mag_change_rate >= 0.25\nORDER BY\n    sp.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers, probabilities in the stamp classifier, and relevant light curve info\nWITH stamp_probs AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\nobjects_in_time_window AS (\n    SELECT\n        fd.oid\n    FROM\n        first_detections fd\n    WHERE\n        fd.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_info AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.magpsf,\n        d.dmagdt_first,\n        -- Calculate initial rise estimate: difference in mag divided by time difference\n        CASE\n            WHEN d.dmagdt_first IS NOT NULL AND d.dt_first > 0 THEN\n                d.dm_first / d.dt_first\n            ELSE\n                NULL\n        END AS initial_rise\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM objects_in_time_window)\n        AND d.isdiffpos = 1 -- positive difference (brightening)\n),\nmagstat_info AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd,\n        -- Calculate the rate of magnitude change\n        CASE\n            WHEN m.firstmjd IS NOT NULL AND m.lastmjd IS NOT NULL AND m.firstmjd != m.lastmjd THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE\n                NULL\n        END AS mag_change_rate\n    FROM\n        magstat m\n    WHERE\n        m.oid IN (SELECT oid FROM objects_in_time_window)\n)\nSELECT\n    sp.oid,\n    sp.stamp_probability,\n    lc.fid,\n    lc.magpsf,\n    lc.dmagdt_first,\n    lc.dt_first,\n    mi.magstat_fid,\n    mi.mag_change_rate\nFROM\n    stamp_probs sp\nJOIN\n    objects_in_time_window oiw ON sp.oid = oiw.oid\nJOIN\n    light_curve_info lc ON sp.oid = lc.oid\nJOIN\n    magstat_info mi ON sp.oid = mi.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser\n    mi.mag_change_rate >= 0.25\nORDER BY\n    sp.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 607,
                "id": "chatcmpl-BwxFKxNCLOepHaMcAGU7y6ZV84lPY",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "16",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 693,
                "out_toks": 15,
                "id": "chatcmpl-BwvJOWJ1gEZWWun2BXPhWrbh346bq",
                "created": 1753383030,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- most probable class\n),\nsn_objects AS (\n    SELECT fp.oid\n    FROM first_detections fp\n    JOIN max_prob mp ON fp.oid = mp.oid\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\ndetection_data AS (\n    SELECT d.oid,\n           d.candid,\n           d.mjd,\n           d.ra,\n           d.dec,\n           d.magpsf,\n           d.diffmaglim,\n           d.isdiffpos,\n           d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_objects)\n),\nmagstat_data AS (\n    SELECT m.oid,\n           m.fid AS magstat_fid,\n           m.magfirst,\n           m.maglast,\n           m.firstmjd,\n           m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM sn_objects)\n),\nrise_estimates AS (\n    SELECT\n        m.oid,\n        -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - lastmjd)\n        CASE\n            WHEN (m.firstmjd - m.lastmjd) != 0 THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS initial_rise\n    FROM magstat_data m\n)\nSELECT\n    d.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    d.candid,\n    m.magstat_fid,\n    r.initial_rise\nFROM detection_data d\nJOIN max_prob mp ON d.oid = mp.oid\nJOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\nJOIN rise_estimates r ON d.oid = r.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser: initial rise >= 0.25 mag/day\n    r.initial_rise >= 0.25\nORDER BY d.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- most probable class\n),\nsn_objects AS (\n    SELECT fp.oid\n    FROM first_detections fp\n    JOIN max_prob mp ON fp.oid = mp.oid\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\ndetection_data AS (\n    SELECT d.oid,\n           d.candid,\n           d.mjd,\n           d.ra,\n           d.dec,\n           d.magpsf,\n           d.diffmaglim,\n           d.isdiffpos,\n           d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_objects)\n),\nmagstat_data AS (\n    SELECT m.oid,\n           m.fid AS magstat_fid,\n           m.magfirst,\n           m.maglast,\n           m.firstmjd,\n           m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM sn_objects)\n),\nrise_estimates AS (\n    SELECT\n        m.oid,\n        -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - lastmjd)\n        CASE\n            WHEN (m.firstmjd - m.lastmjd) != 0 THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS initial_rise\n    FROM magstat_data m\n)\nSELECT\n    d.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    d.candid,\n    m.magstat_fid,\n    r.initial_rise\nFROM detection_data d\nJOIN max_prob mp ON d.oid = mp.oid\nJOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\nJOIN rise_estimates r ON d.oid = r.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser: initial rise >= 0.25 mag/day\n    r.initial_rise >= 0.25\nORDER BY d.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3436,
                "out_toks": 587,
                "id": "chatcmpl-Bx07xcXEK7KSwwLnRSOQ9ph9p3qHl",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- most probable class\n),\nsn_objects AS (\n    SELECT\n        fp.oid\n    FROM first_detections fp\n    JOIN max_prob mp ON fp.oid = mp.oid\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\ndetection_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.diffmaglim,\n        d.isdiffpos,\n        d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_objects)\n),\nmagstat_data AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM sn_objects)\n),\nrise_estimates AS (\n    SELECT\n        md.oid,\n        -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - lastmjd)\n        CASE\n            WHEN (m.firstmjd - m.lastmjd) != 0 THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS initial_rise\n    FROM magstat_data m\n)\nSELECT\n    d.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    d.candid,\n    m.magstat_fid,\n    r.initial_rise\nFROM detection_data d\nJOIN max_prob mp ON d.oid = mp.oid\nJOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\nJOIN rise_estimates r ON d.oid = r.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser: initial rise >= 0.25 mag/day\n    r.initial_rise >= 0.25\nORDER BY d.oid\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and rise rate\nWITH first_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.ndet,\n        o.ndethist,\n        o.meanra,\n        o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- first detection within the first 2 days of September\n),\nmax_prob AS (\n    SELECT\n        p.oid,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1 -- most probable class\n),\nsn_objects AS (\n    SELECT\n        fp.oid\n    FROM first_detections fp\n    JOIN max_prob mp ON fp.oid = mp.oid\n    WHERE mp.class_name = 'SN' -- highest probability class is SN\n),\ndetection_data AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.diffmaglim,\n        d.isdiffpos,\n        d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM sn_objects)\n),\nmagstat_data AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.firstmjd,\n        m.lastmjd\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM sn_objects)\n),\nrise_estimates AS (\n    SELECT\n        md.oid,\n        -- Calculate initial rise rate: (magfirst - maglast) / (firstmjd - lastmjd)\n        CASE\n            WHEN (m.firstmjd - m.lastmjd) != 0 THEN\n                (m.magfirst - m.maglast) / (m.firstmjd - m.lastmjd)\n            ELSE NULL\n        END AS initial_rise\n    FROM magstat_data m\n)\nSELECT\n    d.oid,\n    mp.probability,\n    d.fid,\n    d.magpsf,\n    d.candid,\n    m.magstat_fid,\n    r.initial_rise\nFROM detection_data d\nJOIN max_prob mp ON d.oid = mp.oid\nJOIN magstat_data m ON d.oid = m.oid AND d.fid = m.fid\nJOIN rise_estimates r ON d.oid = r.oid\nWHERE\n    -- Ensure the object qualifies as a fast riser: initial rise >= 0.25 mag/day\n    r.initial_rise >= 0.25\nORDER BY d.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3957,
                "out_toks": 593,
                "id": "chatcmpl-BwxFCe8e3nZGyV27k8o9hHK1hwx6E",
                "created": 1753390458,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "19": {
        "0": {
            "req_id": "19",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 818,
                "out_toks": 22,
                "id": "chatcmpl-BjAcmhge0Ka9eS9WBYtUuSpWT6wW5",
                "created": 1750105300,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.ndet <= 1\n      AND o.oid IN (SELECT oid FROM objects_in_date)\n),\n-- Select objects classified as asteroids with high probability and ranking 1\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM\n    objects_with_one_or_less_detections o\nJOIN\n    asteroid_classification ac ON o.oid = ac.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.ndet <= 1\n      AND o.oid IN (SELECT oid FROM objects_in_date)\n),\n-- Select objects classified as asteroids with high probability and ranking 1\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM\n    objects_with_one_or_less_detections o\nJOIN\n    asteroid_classification ac ON o.oid = ac.oid;\n```"
                },
                "in_toks": 2358,
                "out_toks": 337,
                "id": "chatcmpl-Bx08QoVYfJt0EaipI1wHM9yiAzwGi",
                "created": 1753401570,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.ndet <= 1\n      AND o.oid IN (SELECT oid FROM objects_in_date)\n),\n-- Select objects classified as asteroids with high probability\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM\n    objects_with_one_or_less_detections o\nJOIN\n    asteroid_classification ac ON o.oid = ac.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.ndet <= 1\n      AND o.oid IN (SELECT oid FROM objects_in_date)\n),\n-- Select objects classified as asteroids with high probability\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM\n    objects_with_one_or_less_detections o\nJOIN\n    asteroid_classification ac ON o.oid = ac.oid;\n```"
                },
                "in_toks": 3182,
                "out_toks": 333,
                "id": "chatcmpl-BwxFMU4VtYR1xWCbRoFmjoMGp4O5n",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "19",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 818,
                "out_toks": 22,
                "id": "chatcmpl-BjAcmhge0Ka9eS9WBYtUuSpWT6wW5",
                "created": 1750105300,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects that appeared between March 1, 2021 (MJD 59274.0) and April 1, 2021 (MJD 59305.0)\n-- with at most one detection, classified as 'asteroid' by the stamp classifier with probability > 0.7\n-- and retrieve specified columns\n\nWITH selected_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59274.0 AND 59305.0\n      AND o.ndet <= 1\n),\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n)\nSELECT \n    so.oid, \n    so.meanra, \n    so.meandec, \n    so.ndet, \n    so.firstmjd, \n    ac.class_name, \n    ac.probability\nFROM selected_objects so\nJOIN asteroid_classification ac ON so.oid = ac.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects that appeared between March 1, 2021 (MJD 59274.0) and April 1, 2021 (MJD 59305.0)\n-- with at most one detection, classified as 'asteroid' by the stamp classifier with probability > 0.7\n-- and retrieve specified columns\n\nWITH selected_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 59274.0 AND 59305.0\n      AND o.ndet <= 1\n),\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- most probable class\n)\nSELECT \n    so.oid, \n    so.meanra, \n    so.meandec, \n    so.ndet, \n    so.firstmjd, \n    ac.class_name, \n    ac.probability\nFROM selected_objects so\nJOIN asteroid_classification ac ON so.oid = ac.oid;\n```"
                },
                "in_toks": 3182,
                "out_toks": 275,
                "id": "chatcmpl-BwxFNKhFt3fGNZUAilf9tXAEcXxNd",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "19",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 14,
                "id": "chatcmpl-BwvJOBlFCCsu8ndI5G9Bd2cfN5f3d",
                "created": 1753383030,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for 'stamp_classifier' with probability > 0.7 and ranking=1\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n),\n-- Select objects classified as 'SN' (which in this context are considered asteroids)\nasteroid_objects AS (\n    SELECT c.oid\n    FROM classification c\n    WHERE c.class_name = 'SN'\n),\n-- Final selection combining all conditions\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_range r ON o.oid = r.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n    WHERE c.oid IN (SELECT oid FROM asteroid_objects)\n)\n-- Return the desired columns\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for 'stamp_classifier' with probability > 0.7 and ranking=1\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n),\n-- Select objects classified as 'SN' (which in this context are considered asteroids)\nasteroid_objects AS (\n    SELECT c.oid\n    FROM classification c\n    WHERE c.class_name = 'SN'\n),\n-- Final selection combining all conditions\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_range r ON o.oid = r.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n    WHERE c.oid IN (SELECT oid FROM asteroid_objects)\n)\n-- Return the desired columns\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```"
                },
                "in_toks": 2529,
                "out_toks": 403,
                "id": "chatcmpl-Bx08158qwcppTTCs6elrmGZSYOAM3",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for stamp classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n),\n-- Select objects classified as 'SN' (asteroids) with high probability\nasteroid_objects AS (\n    SELECT c.oid\n    FROM classification c\n    WHERE c.class_name = 'SN'\n),\n-- Final selection combining all conditions\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_range r ON o.oid = r.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n    WHERE c.oid IN (SELECT oid FROM asteroid_objects)\n)\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for stamp classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n),\n-- Select objects classified as 'SN' (asteroids) with high probability\nasteroid_objects AS (\n    SELECT c.oid\n    FROM classification c\n    WHERE c.class_name = 'SN'\n),\n-- Final selection combining all conditions\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_range r ON o.oid = r.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n    WHERE c.oid IN (SELECT oid FROM asteroid_objects)\n)\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```"
                },
                "in_toks": 3227,
                "out_toks": 389,
                "id": "chatcmpl-BwxFPNP8hVTuPIEOTaodSlE1VEc1o",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "19",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 14,
                "id": "chatcmpl-BwvJPcTrRDA2IwvXyNEKiIx2R2x1b",
                "created": 1753383031,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for detections (March 1 to April 1, 2021)\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that satisfy all previous conditions\nfiltered_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (\n        SELECT oid FROM objects_in_date\n        INTERSECT\n        SELECT oid FROM objects_with_one_or_less_detections\n    )\n),\n-- Get classification probabilities for 'stamp_classifier' with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\n-- For each object, select the classification with the highest probability\nasteroid_classification AS (\n    SELECT c.oid, c.class_name, c.probability\n    FROM (\n        SELECT *, ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n        FROM classification\n    ) c\n    WHERE c.rn = 1 AND c.class_name = 'SN'\n)\n-- Final output: objects with classification as 'SN' (asteroids) with probability > 0.7\nSELECT\n    fo.oid,\n    fo.meanra,\n    fo.meandec,\n    fo.ndet,\n    fo.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM filtered_objects fo\nJOIN asteroid_classification ac ON fo.oid = ac.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for detections (March 1 to April 1, 2021)\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that satisfy all previous conditions\nfiltered_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (\n        SELECT oid FROM objects_in_date\n        INTERSECT\n        SELECT oid FROM objects_with_one_or_less_detections\n    )\n),\n-- Get classification probabilities for 'stamp_classifier' with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\n-- For each object, select the classification with the highest probability\nasteroid_classification AS (\n    SELECT c.oid, c.class_name, c.probability\n    FROM (\n        SELECT *, ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n        FROM classification\n    ) c\n    WHERE c.rn = 1 AND c.class_name = 'SN'\n)\n-- Final output: objects with classification as 'SN' (asteroids) with probability > 0.7\nSELECT\n    fo.oid,\n    fo.meanra,\n    fo.meandec,\n    fo.ndet,\n    fo.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM filtered_objects fo\nJOIN asteroid_classification ac ON fo.oid = ac.oid;\n```"
                },
                "in_toks": 2604,
                "out_toks": 461,
                "id": "chatcmpl-Bx081WBh0IOSnr332FyrdsNkqe83w",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range for detections\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that satisfy all conditions\nfiltered_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (\n        SELECT oid FROM objects_in_date\n        INTERSECT\n        SELECT oid FROM objects_with_one_or_less_detections\n    )\n),\n-- Get classification probabilities for stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\n-- Filter objects classified as 'SN' (asteroids) with highest probability\nasteroid_classification AS (\n    SELECT c.oid, c.class_name, c.probability\n    FROM (\n        SELECT *, ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n        FROM classification\n    ) c\n    WHERE c.rn = 1 AND c.class_name = 'SN'\n)\n-- Final selection with required columns\nSELECT\n    fo.oid,\n    fo.meanra,\n    fo.meandec,\n    fo.ndet,\n    fo.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM filtered_objects fo\nJOIN asteroid_classification ac ON fo.oid = ac.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for detections\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that satisfy all conditions\nfiltered_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (\n        SELECT oid FROM objects_in_date\n        INTERSECT\n        SELECT oid FROM objects_with_one_or_less_detections\n    )\n),\n-- Get classification probabilities for stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\n-- Filter objects classified as 'SN' (asteroids) with highest probability\nasteroid_classification AS (\n    SELECT c.oid, c.class_name, c.probability\n    FROM (\n        SELECT *, ROW_NUMBER() OVER (PARTITION BY oid ORDER BY probability DESC) AS rn\n        FROM classification\n    ) c\n    WHERE c.rn = 1 AND c.class_name = 'SN'\n)\n-- Final selection with required columns\nSELECT\n    fo.oid,\n    fo.meanra,\n    fo.meandec,\n    fo.ndet,\n    fo.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM filtered_objects fo\nJOIN asteroid_classification ac ON fo.oid = ac.oid;\n```"
                },
                "in_toks": 3227,
                "out_toks": 433,
                "id": "chatcmpl-BwxFFtLzcw8mPOPi0waGAm6tRWTvO",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "19",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 14,
                "id": "chatcmpl-BwvJQbrHSDdg9DHUMvQoFbeHF6pKi",
                "created": 1753383032,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for the observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for objects classified as 'asteroid' by stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n),\n-- Combine all filters to get the final set of objects\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_date d ON o.oid = d.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n)\n-- Select the desired columns\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for the observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for objects classified as 'asteroid' by stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n),\n-- Combine all filters to get the final set of objects\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_date d ON o.oid = d.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n)\n-- Select the desired columns\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```"
                },
                "in_toks": 2453,
                "out_toks": 355,
                "id": "chatcmpl-Bx08Vf0fjHqc32OoZJF02FHSvfkmT",
                "created": 1753401575,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range for the observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for objects classified as 'SN' by stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.7\n),\n-- Combine all filters to get the final set of objects\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_date d ON o.oid = d.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n)\n-- Select the desired columns\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for the observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_date AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT oid\n    FROM object\n    WHERE ndet <= 1\n),\n-- Get classification probabilities for objects classified as 'SN' by stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.7\n),\n-- Combine all filters to get the final set of objects\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, c.class_name, c.probability\n    FROM object o\n    JOIN objects_in_date d ON o.oid = d.oid\n    JOIN objects_with_few_detections f ON o.oid = f.oid\n    JOIN classification c ON o.oid = c.oid\n)\n-- Select the desired columns\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```"
                },
                "in_toks": 3227,
                "out_toks": 353,
                "id": "chatcmpl-BwxFRgJXqwJugW7fWmBqBo0jWl9fV",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "19",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 14,
                "id": "chatcmpl-BwvJQuHKWeWl3NihIRct0bhID25Yn",
                "created": 1753383032,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the specified date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n)\n-- Retrieve objects that satisfy all conditions:\n-- 1. Detected within date range\n-- 2. Have at most one detection overall\n-- 3. Classified as asteroid ('asteroid') by stamp classifier with probability > 0.7\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nJOIN objects_in_date oid_in_date ON o.oid = oid_in_date.oid\nJOIN objects_with_one_or_none_detection oid_one ON o.oid = oid_one.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.ranking = 1; -- ensure the most probable class\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the specified date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n)\n-- Retrieve objects that satisfy all conditions:\n-- 1. Detected within date range\n-- 2. Have at most one detection overall\n-- 3. Classified as asteroid ('asteroid') by stamp classifier with probability > 0.7\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nJOIN objects_in_date oid_in_date ON o.oid = oid_in_date.oid\nJOIN objects_with_one_or_none_detection oid_one ON o.oid = oid_one.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.ranking = 1; -- ensure the most probable class\n```"
                },
                "in_toks": 2358,
                "out_toks": 338,
                "id": "chatcmpl-Bx07xUQlcuWT4CwuL9TtPiSBiQGB2",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the specified date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Retrieve objects that satisfy all conditions:\n-- 1. Detected within date range\n-- 2. Have at most one detection overall\n-- 3. Classified as asteroid ('asteroid') by stamp classifier with probability > 0.7\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nJOIN objects_in_date oid_in_date ON o.oid = oid_in_date.oid\nJOIN objects_with_one_or_none_detection oid_one ON o.oid = oid_one.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.ranking = 1; -- ensure the most probable class\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the specified date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Retrieve objects that satisfy all conditions:\n-- 1. Detected within date range\n-- 2. Have at most one detection overall\n-- 3. Classified as asteroid ('asteroid') by stamp classifier with probability > 0.7\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nJOIN objects_in_date oid_in_date ON o.oid = oid_in_date.oid\nJOIN objects_with_one_or_none_detection oid_one ON o.oid = oid_one.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'asteroid'\n  AND p.probability > 0.7\n  AND p.ranking = 1; -- ensure the most probable class\n```"
                },
                "in_toks": 3227,
                "out_toks": 338,
                "id": "chatcmpl-BwxFRTtSIeVLggB07Kc5mAlFDfPy8",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "19",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 14,
                "id": "chatcmpl-BwvJREkcsF73x9DLE4YC944uHsHPG",
                "created": 1753383033,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that meet all criteria: in date range, at most one detection, classified as asteroid with high probability\nresult AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        p.class_name,\n        p.probability\n    FROM object o\n    JOIN objects_in_date_range oir ON o.oid = oir.oid\n    JOIN objects_with_one_or_none_detection owd ON o.oid = owd.oid\n    -- Join with probability table to filter for asteroid classification with high confidence\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n      -- Additional condition: ensure the probability is among the top classes (ranking=1)\n)\nSELECT * FROM result;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that meet all criteria: in date range, at most one detection, classified as asteroid with high probability\nresult AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        p.class_name,\n        p.probability\n    FROM object o\n    JOIN objects_in_date_range oir ON o.oid = oir.oid\n    JOIN objects_with_one_or_none_detection owd ON o.oid = owd.oid\n    -- Join with probability table to filter for asteroid classification with high confidence\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n      -- Additional condition: ensure the probability is among the top classes (ranking=1)\n)\nSELECT * FROM result;\n```"
                },
                "in_toks": 2385,
                "out_toks": 369,
                "id": "chatcmpl-Bx081BemThm6GzSm6LXuDci0uN6mX",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that meet all criteria: in date range, at most one detection, classified as asteroid with high probability\nresult AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        p.class_name,\n        p.probability\n    FROM object o\n    JOIN objects_in_date_range oir ON o.oid = oir.oid\n    JOIN objects_with_one_or_none_detection owd ON o.oid = owd.oid\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\nSELECT * FROM result;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that meet all criteria: in date range, at most one detection, classified as asteroid with high probability\nresult AS (\n    SELECT \n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        p.class_name,\n        p.probability\n    FROM object o\n    JOIN objects_in_date_range oir ON o.oid = oir.oid\n    JOIN objects_with_one_or_none_detection owd ON o.oid = owd.oid\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\nSELECT * FROM result;\n```"
                },
                "in_toks": 3227,
                "out_toks": 331,
                "id": "chatcmpl-BwxFIrhO692MsjQlDZXxhqZun5qly",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "19",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 14,
                "id": "chatcmpl-BwvJSDCFzeq559Q1KJ76Vz49lHRXd",
                "created": 1753383034,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for detections (March 1 to April 1, 2021)\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59295.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select high-confidence asteroid classifications from the 'stamp_classifier' with probability > 0.7 and ranking = 1\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM object o\nJOIN objects_in_date_range dr ON o.oid = dr.oid\nJOIN objects_with_few_detections fw ON o.oid = fw.oid\nJOIN asteroid_classification ac ON o.oid = ac.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for detections (March 1 to April 1, 2021)\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59295.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select high-confidence asteroid classifications from the 'stamp_classifier' with probability > 0.7 and ranking = 1\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM object o\nJOIN objects_in_date_range dr ON o.oid = dr.oid\nJOIN objects_with_few_detections fw ON o.oid = fw.oid\nJOIN asteroid_classification ac ON o.oid = ac.oid;\n```"
                },
                "in_toks": 2367,
                "out_toks": 347,
                "id": "chatcmpl-Bx0856ddpRosLHCSZ2iMwtYE82XI5",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range for detections\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects classified as asteroids with high probability\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM object o\nJOIN objects_in_date_range dr ON o.oid = dr.oid\nJOIN objects_with_few_detections fw ON o.oid = fw.oid\nJOIN asteroid_classification ac ON o.oid = ac.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for detections\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects with detections within the date range\nobjects_in_date_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects classified as asteroids with high probability\nasteroid_classification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\n-- Final selection combining all conditions\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    ac.class_name,\n    ac.probability\nFROM object o\nJOIN objects_in_date_range dr ON o.oid = dr.oid\nJOIN objects_with_few_detections fw ON o.oid = fw.oid\nJOIN asteroid_classification ac ON o.oid = ac.oid;\n```"
                },
                "in_toks": 3227,
                "out_toks": 321,
                "id": "chatcmpl-BwxFKtPyC3RkLJQEcmGyWD6426kY9",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "19",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 14,
                "id": "chatcmpl-BwvJSrhLbJciTbIengc3N5C7OFO7c",
                "created": 1753383034,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM objects_in_range)\n      AND o.ndet <= 1\n),\n-- Get classification probabilities for stamp classifier with probability > 0.7, ranking=1, and class 'SN' (asteroid)\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND p.class_name = 'SN'\n)\n-- Final selection of objects matching all criteria\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    c.class_name, \n    c.probability\nFROM objects_with_few_detections o\nJOIN classification c ON o.oid = c.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM objects_in_range)\n      AND o.ndet <= 1\n),\n-- Get classification probabilities for stamp classifier with probability > 0.7, ranking=1, and class 'SN' (asteroid)\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND p.class_name = 'SN'\n)\n-- Final selection of objects matching all criteria\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    c.class_name, \n    c.probability\nFROM objects_with_few_detections o\nJOIN classification c ON o.oid = c.oid;\n```"
                },
                "in_toks": 2417,
                "out_toks": 346,
                "id": "chatcmpl-Bx082EilihQxEBowiYJNI05cOV16S",
                "created": 1753401546,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM objects_in_range)\n      AND o.ndet <= 1\n),\n-- Get classification probabilities for stamp classifier with probability > 0.7 and class 'SN' (asteroid)\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND p.class_name = 'SN'\n)\n-- Final selection of objects matching all criteria\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    c.class_name, \n    c.probability\nFROM objects_with_few_detections o\nJOIN classification c ON o.oid = c.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.mjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Filter objects with at most one detection\nobjects_with_few_detections AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM objects_in_range)\n      AND o.ndet <= 1\n),\n-- Get classification probabilities for stamp classifier with probability > 0.7 and class 'SN' (asteroid)\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND p.class_name = 'SN'\n)\n-- Final selection of objects matching all criteria\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    c.class_name, \n    c.probability\nFROM objects_with_few_detections o\nJOIN classification c ON o.oid = c.oid;\n```"
                },
                "in_toks": 3227,
                "out_toks": 341,
                "id": "chatcmpl-BwxFLLErCqH2lfDP9kOlphn3DhZ5a",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "19",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'detection']"
                },
                "in_toks": 665,
                "out_toks": 14,
                "id": "chatcmpl-BwvJTG7o8yzcmCiNyBQfoRZspTege",
                "created": 1753383035,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for observations (March 1 to April 1, 2021)\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Select probabilities for objects classified as 'asteroid' (assuming class_name='asteroid') by 'stamp_classifier' with probability > 0.7\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- Ensure we take the top-ranked classification\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_fewer_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Combine all conditions: objects in date range, classified as asteroid with high probability, and with at most one detection\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability\n    FROM objects_in_range o\n    JOIN probabilities p ON o.oid = p.oid\n    JOIN objects_with_one_or_fewer_detections ow ON o.oid = ow.oid\n)\n-- Return the desired columns\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations (March 1 to April 1, 2021)\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN (SELECT start_mjd FROM date_range) AND (SELECT end_mjd FROM date_range)\n),\n-- Select probabilities for objects classified as 'asteroid' (assuming class_name='asteroid') by 'stamp_classifier' with probability > 0.7\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- Ensure we take the top-ranked classification\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_fewer_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Combine all conditions: objects in date range, classified as asteroid with high probability, and with at most one detection\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability\n    FROM objects_in_range o\n    JOIN probabilities p ON o.oid = p.oid\n    JOIN objects_with_one_or_fewer_detections ow ON o.oid = ow.oid\n)\n-- Return the desired columns\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```"
                },
                "in_toks": 2422,
                "out_toks": 405,
                "id": "chatcmpl-Bx08ao3xtEMJgFCIN5dfS8IxQk26S",
                "created": 1753401580,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o, date_range dr\n    WHERE o.firstmjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Select relevant probabilities for objects classified as 'SN' (asteroids) by stamp_classifier with probability > 0.7\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.7\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_fewer_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Combine all conditions\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability\n    FROM objects_in_range o\n    JOIN probabilities p ON o.oid = p.oid\n    JOIN objects_with_one_or_fewer_detections ow ON o.oid = ow.oid\n)\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects observed within the date range\nobjects_in_range AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o, date_range dr\n    WHERE o.firstmjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Select relevant probabilities for objects classified as 'SN' (asteroids) by stamp_classifier with probability > 0.7\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'SN'\n      AND p.probability > 0.7\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_fewer_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Combine all conditions\nfinal_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability\n    FROM objects_in_range o\n    JOIN probabilities p ON o.oid = p.oid\n    JOIN objects_with_one_or_fewer_detections ow ON o.oid = ow.oid\n)\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_objects;\n```"
                },
                "in_toks": 3227,
                "out_toks": 339,
                "id": "chatcmpl-BwxFOhZWyMfPURX2EmeL23Zwevp13",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "14": {
        "0": {
            "req_id": "14",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'xmatch']",
                    "1": "['object', 'probability', 'detection', 'xmatch']"
                },
                "in_toks": 937,
                "out_toks": 30,
                "id": "chatcmpl-BjAcnXV50gVDBkHbXWVEZNqueP7pV",
                "created": 1750105301,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the specified OIDs\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\n-- Filter detections for selected objects, join with xmatch for panstarrs data\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n),\n-- Get the latest detection per object\nlatest_detections AS (\n    SELECT DISTINCT ON (d.oid) d.*\n    FROM detection_filtered d\n    ORDER BY d.oid, d.mjd DESC\n),\n-- Get the deep learning real bogus score for latest detection\nprobability_latest AS (\n    SELECT\n        p.oid,\n        p.probability AS drb_score\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.class_name = 'real_bogus' -- assuming class_name indicates real bogus score\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\n-- Combine latest detection with probability and xmatch info\nfinal AS (\n    SELECT\n        ld.oid,\n        ld.candid,\n        ld.fid,\n        ld.mjd,\n        ld.magpsf,\n        ld.sigmapsf,\n        ld.has_stamp,\n        pl.drb_score,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM latest_detections ld\n    LEFT JOIN probability_latest pl ON ld.oid = pl.oid\n    LEFT JOIN xmatch xm ON ld.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE pl.drb_score > 0.5\n      AND (\n        -- Correct the comparison: class_catalog is numeric or cast to numeric\n        -- If class_catalog is stored as text, cast to numeric for comparison\n        (xm.class_catalog::numeric < 0.5 OR xm.class_catalog IS NULL)\n        OR (xm.dist < 1)\n      )\n)\n-- Select final output\nSELECT\n    oid,\n    candid,\n    fid,\n    mjd,\n    magpsf,\n    sigmapsf,\n    has_stamp,\n    drb_score,\n    star_galaxy_score,\n    dist\nFROM final;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the specified OIDs\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\n-- Filter detections for selected objects, join with xmatch for panstarrs data\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n),\n-- Get the latest detection per object\nlatest_detections AS (\n    SELECT DISTINCT ON (d.oid) d.*\n    FROM detection_filtered d\n    ORDER BY d.oid, d.mjd DESC\n),\n-- Get the deep learning real bogus score for latest detection\nprobability_latest AS (\n    SELECT\n        p.oid,\n        p.probability AS drb_score\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.class_name = 'real_bogus' -- assuming class_name indicates real bogus score\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\n-- Combine latest detection with probability and xmatch info\nfinal AS (\n    SELECT\n        ld.oid,\n        ld.candid,\n        ld.fid,\n        ld.mjd,\n        ld.magpsf,\n        ld.sigmapsf,\n        ld.has_stamp,\n        pl.drb_score,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM latest_detections ld\n    LEFT JOIN probability_latest pl ON ld.oid = pl.oid\n    LEFT JOIN xmatch xm ON ld.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE pl.drb_score > 0.5\n      AND (\n        -- Correct the comparison: class_catalog is numeric or cast to numeric\n        -- If class_catalog is stored as text, cast to numeric for comparison\n        (xm.class_catalog::numeric < 0.5 OR xm.class_catalog IS NULL)\n        OR (xm.dist < 1)\n      )\n)\n-- Select final output\nSELECT\n    oid,\n    candid,\n    fid,\n    mjd,\n    magpsf,\n    sigmapsf,\n    has_stamp,\n    drb_score,\n    star_galaxy_score,\n    dist\nFROM final;\n```"
                },
                "in_toks": 3215,
                "out_toks": 639,
                "id": "chatcmpl-Bx085VAMu12Oe63duTTPgy3IqdkQb",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nlatest_detections AS (\n    SELECT DISTINCT ON (d.oid) d.*\n    FROM detection_filtered d\n    ORDER BY d.oid, d.mjd DESC\n),\nprobability_latest AS (\n    SELECT\n        p.oid,\n        p.probability AS drb_score\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nfinal AS (\n    SELECT\n        ld.oid,\n        ld.candid,\n        ld.fid,\n        ld.mjd,\n        ld.magpsf,\n        ld.sigmapsf,\n        ld.has_stamp,\n        pl.drb_score,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM latest_detections ld\n    LEFT JOIN probability_latest pl ON ld.oid = pl.oid\n    LEFT JOIN xmatch xm ON ld.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE pl.drb_score > 0.5\n      AND (xm.class_catalog < 0.5 OR xm.dist < 1)\n)\nSELECT\n    oid,\n    candid,\n    fid,\n    mjd,\n    magpsf,\n    sigmapsf,\n    has_stamp,\n    drb_score,\n    star_galaxy_score,\n    dist\nFROM final;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nlatest_detections AS (\n    SELECT DISTINCT ON (d.oid) d.*\n    FROM detection_filtered d\n    ORDER BY d.oid, d.mjd DESC\n),\nprobability_latest AS (\n    SELECT\n        p.oid,\n        p.probability AS drb_score\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nfinal AS (\n    SELECT\n        ld.oid,\n        ld.candid,\n        ld.fid,\n        ld.mjd,\n        ld.magpsf,\n        ld.sigmapsf,\n        ld.has_stamp,\n        pl.drb_score,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM latest_detections ld\n    LEFT JOIN probability_latest pl ON ld.oid = pl.oid\n    LEFT JOIN xmatch xm ON ld.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE pl.drb_score > 0.5\n      AND (xm.class_catalog < 0.5 OR xm.dist < 1)\n)\nSELECT\n    oid,\n    candid,\n    fid,\n    mjd,\n    magpsf,\n    sigmapsf,\n    has_stamp,\n    drb_score,\n    star_galaxy_score,\n    dist\nFROM final;"
                },
                "in_toks": 3364,
                "out_toks": 584,
                "id": "chatcmpl-BwxFDvQt8iTI88i1w5zDfqj4Bbbbk",
                "created": 1753390459,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "14",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'xmatch']",
                    "1": "['object', 'probability', 'detection', 'xmatch']"
                },
                "in_toks": 937,
                "out_toks": 30,
                "id": "chatcmpl-BjAcnXV50gVDBkHbXWVEZNqueP7pV",
                "created": 1750105301,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        x.dist,\n        x.class_catalog\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch x ON d.oid = x.oid\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM selected_oids)\n),\nlatest_detection AS (\n    SELECT DISTINCT ON (d.oid) d.*\n    FROM detection_filtered d\n    ORDER BY d.oid, d.mjd DESC\n)\nSELECT DISTINCT\n    ld.oid,\n    ld.candid,\n    ld.fid,\n    ld.mjd,\n    ld.magpsf,\n    ld.sigmapsf,\n    ld.has_stamp,\n    ld.drb,\n    x.class_catalog,\n    x.dist\nFROM latest_detection ld\nLEFT JOIN probability_filtered p ON ld.oid = p.oid\nLEFT JOIN xmatch x ON ld.oid = x.oid\nWHERE ld.drb > 0.5\n  AND (x.class_catalog = 'star' AND x.dist < 1 OR x.class_catalog = 'galaxy' AND x.dist < 1 OR x.class_catalog IS NULL OR x.dist < 1)\n  AND (x.class_catalog = 'star' AND x.dist < 1 OR x.class_catalog = 'galaxy' AND x.dist < 1 OR x.class_catalog IS NULL OR x.dist < 1)\n  AND (x.class_catalog = 'star' AND x.dist < 1 OR x.class_catalog = 'galaxy' AND x.dist < 1 OR x.class_catalog IS NULL OR x.dist < 1);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        x.dist,\n        x.class_catalog\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch x ON d.oid = x.oid\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM selected_oids)\n),\nlatest_detection AS (\n    SELECT DISTINCT ON (d.oid) d.*\n    FROM detection_filtered d\n    ORDER BY d.oid, d.mjd DESC\n)\nSELECT DISTINCT\n    ld.oid,\n    ld.candid,\n    ld.fid,\n    ld.mjd,\n    ld.magpsf,\n    ld.sigmapsf,\n    ld.has_stamp,\n    ld.drb,\n    x.class_catalog,\n    x.dist\nFROM latest_detection ld\nLEFT JOIN probability_filtered p ON ld.oid = p.oid\nLEFT JOIN xmatch x ON ld.oid = x.oid\nWHERE ld.drb > 0.5\n  AND (x.class_catalog = 'star' AND x.dist < 1 OR x.class_catalog = 'galaxy' AND x.dist < 1 OR x.class_catalog IS NULL OR x.dist < 1)\n  AND (x.class_catalog = 'star' AND x.dist < 1 OR x.class_catalog = 'galaxy' AND x.dist < 1 OR x.class_catalog IS NULL OR x.dist < 1)\n  AND (x.class_catalog = 'star' AND x.dist < 1 OR x.class_catalog = 'galaxy' AND x.dist < 1 OR x.class_catalog IS NULL OR x.dist < 1);"
                },
                "in_toks": 3364,
                "out_toks": 542,
                "id": "chatcmpl-BwxFDCa1SZC8pzTx9sgL4BPMyXbd7",
                "created": 1753390459,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "14",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'ps1_ztf']"
                },
                "in_toks": 784,
                "out_toks": 18,
                "id": "chatcmpl-BwvJUJm7iPKCXibvpetdvEINzqk16",
                "created": 1753383036,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table aliases and references\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN ps1_ztf p ON d.oid = p.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nLEFT JOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table aliases and references\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN ps1_ztf p ON d.oid = p.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nLEFT JOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;"
                },
                "in_toks": 3126,
                "out_toks": 323,
                "id": "chatcmpl-Bx0P495ikl1H3vW5RFgkNdneAj2sb",
                "created": 1753402602,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nJOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nJOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;"
                },
                "in_toks": 4004,
                "out_toks": 292,
                "id": "chatcmpl-BwxFGbeF7fXV1LwDOHYwbRqJhVbRa",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "14",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "xmatch",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'xmatch', 'taxonomy']"
                },
                "in_toks": 784,
                "out_toks": 18,
                "id": "chatcmpl-BwvJUVYhcahVFWmhohyhYlcAe0HQU",
                "created": 1753383036,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid\n    WHERE d.drb > 0.5\n      AND (xm.dist IS NULL OR xm.dist < 1)\n),\nprobability_filtered AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'drl_score' AND p.probability > 0.5\n),\nobject_info AS (\n    SELECT o.oid, o.ndet, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_oids)\n)\nSELECT DISTINCT\n    oi.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    -- Assuming star galaxy score is derived from probability table for class 'VS' (star/galaxy)\n    (SELECT p.probability FROM probability p WHERE p.oid = oi.oid AND p.class_name = 'VS' AND p.classifier_name = 'drl_score' LIMIT 1) AS star_galaxy_score,\n    d.dist\nFROM detection_filtered d\nJOIN object_info oi ON d.oid = oi.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid\n    WHERE d.drb > 0.5\n      AND (xm.dist IS NULL OR xm.dist < 1)\n),\nprobability_filtered AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'drl_score' AND p.probability > 0.5\n),\nobject_info AS (\n    SELECT o.oid, o.ndet, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_oids)\n)\nSELECT DISTINCT\n    oi.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    -- Assuming star galaxy score is derived from probability table for class 'VS' (star/galaxy)\n    (SELECT p.probability FROM probability p WHERE p.oid = oi.oid AND p.class_name = 'VS' AND p.classifier_name = 'drl_score' LIMIT 1) AS star_galaxy_score,\n    d.dist\nFROM detection_filtered d\nJOIN object_info oi ON d.oid = oi.oid;"
                },
                "in_toks": 3409,
                "out_toks": 447,
                "id": "chatcmpl-BwxFJcuk6iDdttM635ZOxmbwKtX0J",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "14",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "xmatch",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'xmatch', 'taxonomy']"
                },
                "in_toks": 784,
                "out_toks": 18,
                "id": "chatcmpl-BwvJVYYRaMCY7wTWzeunrFshyJ5lP",
                "created": 1753383037,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with specified oids\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\n-- Filter detections for selected oids and join with xmatch for panstarrs data\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n),\n-- Filter probabilities for 'drb' classifier with probability > 0.5\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'drb'\n      AND p.probability > 0.5\n),\n-- Get distinct objects from selected oids\nfinal_objects AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_oids)\n)\n-- Final selection with specified conditions\nSELECT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    d.star_galaxy_score,\n    d.dist\nFROM detection_filtered d\nJOIN final_objects o ON d.oid = o.oid\nWHERE\n    d.drb > 0.5\n    AND (\n        -- Cast star_galaxy_score to numeric for comparison\n        CAST(d.star_galaxy_score AS NUMERIC) < 0.5\n        OR d.dist < 1\n    );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specified oids\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\n-- Filter detections for selected oids and join with xmatch for panstarrs data\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n),\n-- Filter probabilities for 'drb' classifier with probability > 0.5\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'drb'\n      AND p.probability > 0.5\n),\n-- Get distinct objects from selected oids\nfinal_objects AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_oids)\n)\n-- Final selection with specified conditions\nSELECT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    d.star_galaxy_score,\n    d.dist\nFROM detection_filtered d\nJOIN final_objects o ON d.oid = o.oid\nWHERE\n    d.drb > 0.5\n    AND (\n        -- Cast star_galaxy_score to numeric for comparison\n        CAST(d.star_galaxy_score AS NUMERIC) < 0.5\n        OR d.dist < 1\n    );\n```"
                },
                "in_toks": 2985,
                "out_toks": 515,
                "id": "chatcmpl-Bx07xUZHgJslMetVdohcuOIMco7HY",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'drb'\n      AND p.probability > 0.5\n),\nfinal_objects AS (\n    SELECT DISTINCT\n        o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_oids)\n)\nSELECT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    d.star_galaxy_score,\n    d.dist\nFROM detection_filtered d\nJOIN final_objects o ON d.oid = o.oid\nWHERE\n    d.drb > 0.5\n    AND (\n        d.star_galaxy_score < 0.5\n        OR d.dist < 1\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        xm.class_catalog AS star_galaxy_score,\n        xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n      AND p.classifier_name = 'drb'\n      AND p.probability > 0.5\n),\nfinal_objects AS (\n    SELECT DISTINCT\n        o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM selected_oids)\n)\nSELECT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    d.star_galaxy_score,\n    d.dist\nFROM detection_filtered d\nJOIN final_objects o ON d.oid = o.oid\nWHERE\n    d.drb > 0.5\n    AND (\n        d.star_galaxy_score < 0.5\n        OR d.dist < 1\n    );"
                },
                "in_toks": 3409,
                "out_toks": 448,
                "id": "chatcmpl-BwxFLQGs9u8GVIa1yoo8t6Qumculg",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "14",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "xmatch",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'xmatch', 'taxonomy']"
                },
                "in_toks": 784,
                "out_toks": 18,
                "id": "chatcmpl-BwvJWikYwWcYhgjdSQ7TiNn4eb4Co",
                "created": 1753383038,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.dist\n    FROM detection d\n    JOIN selected_oids s ON d.oid = s.oid\n    LEFT JOIN xmatch p ON d.oid = p.oid AND p.catid = 'panstarrs'\n    WHERE d.drb > 0.5 AND (p.dist < 1 OR p.dist IS NULL)\n)\nSELECT DISTINCT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.dist\nFROM detection_filtered d\nJOIN object o ON d.oid = o.oid\nLEFT JOIN xmatch p ON o.oid = p.oid AND p.catid = 'panstarrs';",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.dist\n    FROM detection d\n    JOIN selected_oids s ON d.oid = s.oid\n    LEFT JOIN xmatch p ON d.oid = p.oid AND p.catid = 'panstarrs'\n    WHERE d.drb > 0.5 AND (p.dist < 1 OR p.dist IS NULL)\n)\nSELECT DISTINCT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.dist\nFROM detection_filtered d\nJOIN object o ON d.oid = o.oid\nLEFT JOIN xmatch p ON o.oid = p.oid AND p.catid = 'panstarrs';"
                },
                "in_toks": 3409,
                "out_toks": 316,
                "id": "chatcmpl-BwxFOj5F6DRd1unwX87PpkM1qcDPN",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "14",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'ps1_ztf']"
                },
                "in_toks": 784,
                "out_toks": 18,
                "id": "chatcmpl-BwvJXWU4mieUgQ8lzJKOJBn3z2Yss",
                "created": 1753383039,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table aliases and column references based on the provided schema\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN ps1_ztf p ON d.oid = p.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\n-- Note: p is now included in the FROM clause via the LEFT JOIN in the CTE\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table aliases and column references based on the provided schema\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN ps1_ztf p ON d.oid = p.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\n-- Note: p is now included in the FROM clause via the LEFT JOIN in the CTE\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;"
                },
                "in_toks": 3128,
                "out_toks": 332,
                "id": "chatcmpl-Bx08eDNgHmjBJrB9GoylksE0H0HyU",
                "created": 1753401584,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nLEFT JOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nLEFT JOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;"
                },
                "in_toks": 4004,
                "out_toks": 293,
                "id": "chatcmpl-BwxFPa8faTCklIooZUKLDkK04Z8l5",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "14",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'ps1_ztf']"
                },
                "in_toks": 784,
                "out_toks": 18,
                "id": "chatcmpl-BwvJXM1FOOTT4TiZf0ZXKqexyPGNh",
                "created": 1753383039,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table aliases and column references based on the provided schema\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN ps1_ztf p ON d.oid = p.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    d.sgscore1,\n    d.distpsnr1\nFROM filtered_detections d\nWHERE d.sgscore1 < 0.5 OR d.distpsnr1 < 1;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table aliases and column references based on the provided schema\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN ps1_ztf p ON d.oid = p.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    d.sgscore1,\n    d.distpsnr1\nFROM filtered_detections d\nWHERE d.sgscore1 < 0.5 OR d.distpsnr1 < 1;"
                },
                "in_toks": 3128,
                "out_toks": 312,
                "id": "chatcmpl-Bx082ADyxok0O7e6hFobodkG7x539",
                "created": 1753401546,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nLEFT JOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\nfiltered_detections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, p.sgscore1, p.distpsnr1\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    WHERE d.drb > 0.5\n)\nSELECT DISTINCT\n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM filtered_detections d\nLEFT JOIN ps1_ztf p ON d.oid = p.oid\nWHERE p.sgscore1 < 0.5 OR p.distpsnr1 < 1;"
                },
                "in_toks": 4004,
                "out_toks": 293,
                "id": "chatcmpl-BwxFEyXlTm29aLqimIeUcidxIfe8t",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "14",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "xmatch",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'xmatch', 'taxonomy']"
                },
                "in_toks": 784,
                "out_toks": 18,
                "id": "chatcmpl-BwvJYxNprzotFHRnkH6xwhDeJ9RWj",
                "created": 1753383040,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table aliasing and referencing the xmatch table correctly\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs' -- Correct reference to xmatch table\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n),\nlatest_detections AS (\n    SELECT df.oid, df.candid, df.fid, df.mjd, df.magpsf, df.sigmapsf, df.has_stamp, df.drb, df.dist\n    FROM detection_filtered df\n),\ndeep_bogus_scores AS (\n    SELECT oid, drb\n    FROM latest_detections\n    WHERE drb > 0.5\n),\nclassification_scores AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability_filtered p\n    WHERE p.classifier_name = 'lc_classifier'\n),\nstar_galaxy_scores AS (\n    SELECT p.oid, p.probability AS star_galaxy_score\n    FROM probability_filtered p\n    WHERE p.class_name = 'VS' AND p.classifier_name = 'stamp_classifier'\n),\nnearest_panstarrs AS (\n    SELECT ld.oid, ld.dist\n    FROM latest_detections ld\n    WHERE ld.dist IS NOT NULL -- Ensure only detections with a match in panstarrs\n)\nSELECT DISTINCT\n    ld.oid,\n    ld.candid,\n    ld.fid,\n    ld.mjd,\n    ld.magpsf,\n    ld.sigmapsf,\n    ld.has_stamp,\n    dbs.drb,\n    sg.star_galaxy_score,\n    np.dist\nFROM latest_detections ld\nLEFT JOIN deep_bogus_scores dbs ON ld.oid = dbs.oid\nLEFT JOIN star_galaxy_scores sg ON ld.oid = sg.oid\nLEFT JOIN nearest_panstarrs np ON ld.oid = np.oid\nWHERE\n    dbs.drb > 0.5\n    AND (\n        sg.star_galaxy_score < 0.5\n        OR np.dist < 1\n    );",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table aliasing and referencing the xmatch table correctly\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs' -- Correct reference to xmatch table\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n),\nlatest_detections AS (\n    SELECT df.oid, df.candid, df.fid, df.mjd, df.magpsf, df.sigmapsf, df.has_stamp, df.drb, df.dist\n    FROM detection_filtered df\n),\ndeep_bogus_scores AS (\n    SELECT oid, drb\n    FROM latest_detections\n    WHERE drb > 0.5\n),\nclassification_scores AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability_filtered p\n    WHERE p.classifier_name = 'lc_classifier'\n),\nstar_galaxy_scores AS (\n    SELECT p.oid, p.probability AS star_galaxy_score\n    FROM probability_filtered p\n    WHERE p.class_name = 'VS' AND p.classifier_name = 'stamp_classifier'\n),\nnearest_panstarrs AS (\n    SELECT ld.oid, ld.dist\n    FROM latest_detections ld\n    WHERE ld.dist IS NOT NULL -- Ensure only detections with a match in panstarrs\n)\nSELECT DISTINCT\n    ld.oid,\n    ld.candid,\n    ld.fid,\n    ld.mjd,\n    ld.magpsf,\n    ld.sigmapsf,\n    ld.has_stamp,\n    dbs.drb,\n    sg.star_galaxy_score,\n    np.dist\nFROM latest_detections ld\nLEFT JOIN deep_bogus_scores dbs ON ld.oid = dbs.oid\nLEFT JOIN star_galaxy_scores sg ON ld.oid = sg.oid\nLEFT JOIN nearest_panstarrs np ON ld.oid = np.oid\nWHERE\n    dbs.drb > 0.5\n    AND (\n        sg.star_galaxy_score < 0.5\n        OR np.dist < 1\n    );"
                },
                "in_toks": 3245,
                "out_toks": 670,
                "id": "chatcmpl-Bx086g0uHGKH5Cc41Ut0sNcKm6Dwj",
                "created": 1753401550,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n),\nlatest_detections AS (\n    SELECT df.oid, df.candid, df.fid, df.mjd, df.magpsf, df.sigmapsf, df.has_stamp, df.drb, df.dist\n    FROM detection_filtered df\n),\ndeep_bogus_scores AS (\n    SELECT oid, drb\n    FROM latest_detections\n    WHERE drb > 0.5\n),\nclassification_scores AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability_filtered p\n    WHERE p.classifier_name = 'lc_classifier'\n),\nstar_galaxy_scores AS (\n    SELECT p.oid, p.probability AS star_galaxy_score\n    FROM probability_filtered p\n    WHERE p.class_name = 'VS' AND p.classifier_name = 'stamp_classifier'\n),\nnearest_panstarrs AS (\n    SELECT oid, dist\n    FROM latest_detections\n    WHERE xm.catid = 'panstarrs'\n)\nSELECT DISTINCT\n    ld.oid,\n    ld.candid,\n    ld.fid,\n    ld.mjd,\n    ld.magpsf,\n    ld.sigmapsf,\n    ld.has_stamp,\n    dbs.drb,\n    sg.star_galaxy_score,\n    np.dist\nFROM latest_detections ld\nLEFT JOIN deep_bogus_scores dbs ON ld.oid = dbs.oid\nLEFT JOIN star_galaxy_scores sg ON ld.oid = sg.oid\nLEFT JOIN nearest_panstarrs np ON ld.oid = np.oid\nWHERE\n    dbs.drb > 0.5\n    AND (\n        sg.star_galaxy_score < 0.5\n        OR np.dist < 1\n    );",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.oid IN (SELECT oid FROM selected_oids)\n),\nprobability_filtered AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking, p.classifier_name\n    FROM probability p\n    WHERE p.oid IN (SELECT oid FROM selected_oids)\n),\nlatest_detections AS (\n    SELECT df.oid, df.candid, df.fid, df.mjd, df.magpsf, df.sigmapsf, df.has_stamp, df.drb, df.dist\n    FROM detection_filtered df\n),\ndeep_bogus_scores AS (\n    SELECT oid, drb\n    FROM latest_detections\n    WHERE drb > 0.5\n),\nclassification_scores AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability_filtered p\n    WHERE p.classifier_name = 'lc_classifier'\n),\nstar_galaxy_scores AS (\n    SELECT p.oid, p.probability AS star_galaxy_score\n    FROM probability_filtered p\n    WHERE p.class_name = 'VS' AND p.classifier_name = 'stamp_classifier'\n),\nnearest_panstarrs AS (\n    SELECT oid, dist\n    FROM latest_detections\n    WHERE xm.catid = 'panstarrs'\n)\nSELECT DISTINCT\n    ld.oid,\n    ld.candid,\n    ld.fid,\n    ld.mjd,\n    ld.magpsf,\n    ld.sigmapsf,\n    ld.has_stamp,\n    dbs.drb,\n    sg.star_galaxy_score,\n    np.dist\nFROM latest_detections ld\nLEFT JOIN deep_bogus_scores dbs ON ld.oid = dbs.oid\nLEFT JOIN star_galaxy_scores sg ON ld.oid = sg.oid\nLEFT JOIN nearest_panstarrs np ON ld.oid = np.oid\nWHERE\n    dbs.drb > 0.5\n    AND (\n        sg.star_galaxy_score < 0.5\n        OR np.dist < 1\n    );"
                },
                "in_toks": 3409,
                "out_toks": 631,
                "id": "chatcmpl-BwxFEDUkWYVyUqNiPAUybEK4lyg4z",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "14",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "xmatch",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'xmatch', 'taxonomy']"
                },
                "in_toks": 784,
                "out_toks": 18,
                "id": "chatcmpl-BwvJZCAYmmTFOzuIDZJjSwG2cMClO",
                "created": 1753383041,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.drb > 0.5 AND (xm.dist IS NULL OR xm.dist < 1)\n)\nSELECT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    -- Retrieve the star galaxy score from the probability table for the most probable class in 'lc_classifier' for each object\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid AND p.class_name = 'VS' AND p.classifier_name = 'lc_classifier'\n     ORDER BY p.ranking LIMIT 1) AS star_galaxy_score,\n    d.dist\nFROM object o\nJOIN detection_filtered d ON o.oid = d.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n),\ndetection_filtered AS (\n    SELECT DISTINCT ON (d.oid) d.oid, d.candid, d.fid, d.mjd, d.magpsf, d.sigmapsf, d.has_stamp, d.drb, xm.dist\n    FROM detection d\n    JOIN selected_oids o ON d.oid = o.oid\n    LEFT JOIN xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\n    WHERE d.drb > 0.5 AND (xm.dist IS NULL OR xm.dist < 1)\n)\nSELECT\n    o.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    d.sigmapsf,\n    d.has_stamp,\n    d.drb,\n    -- Retrieve the star galaxy score from the probability table for the most probable class in 'lc_classifier' for each object\n    (SELECT p.probability\n     FROM probability p\n     WHERE p.oid = o.oid AND p.class_name = 'VS' AND p.classifier_name = 'lc_classifier'\n     ORDER BY p.ranking LIMIT 1) AS star_galaxy_score,\n    d.dist\nFROM object o\nJOIN detection_filtered d ON o.oid = d.oid;"
                },
                "in_toks": 3409,
                "out_toks": 373,
                "id": "chatcmpl-BwxFF3TC0O8NpDE7cByIkCwycMhY0",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "30": {
        "0": {
            "req_id": "30",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 776,
                "out_toks": 14,
                "id": "chatcmpl-BjAcoBAXN4bjHhUFJerGHGNocXNAY",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest version of the classifier for each object and the top-ranked class\nJOIN (\n    SELECT \n        p1.oid,\n        p1.class_name,\n        p1.probability\n    FROM \n        probability p1\n    WHERE \n        p1.classifier_name = 'lc_classifier'\n        -- Ensure we are selecting the latest classifier version for each object\n        AND p1.classifier_version = (\n            SELECT MAX(p2.classifier_version)\n            FROM probability p2\n            WHERE p2.classifier_name = 'lc_classifier'\n              AND p2.oid = p1.oid\n        )\n        -- Select only the top-ranked class (most probable)\n        AND p1.ranking = 1\n        -- Additional condition to ensure the probability is above a threshold (e.g., 0.5) for meaningful classification\n        AND p1.probability >= 0.5\n) p ON o.oid = p.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest version of the classifier for each object and the top-ranked class\nJOIN (\n    SELECT \n        p1.oid,\n        p1.class_name,\n        p1.probability\n    FROM \n        probability p1\n    WHERE \n        p1.classifier_name = 'lc_classifier'\n        -- Ensure we are selecting the latest classifier version for each object\n        AND p1.classifier_version = (\n            SELECT MAX(p2.classifier_version)\n            FROM probability p2\n            WHERE p2.classifier_name = 'lc_classifier'\n              AND p2.oid = p1.oid\n        )\n        -- Select only the top-ranked class (most probable)\n        AND p1.ranking = 1\n        -- Additional condition to ensure the probability is above a threshold (e.g., 0.5) for meaningful classification\n        AND p1.probability >= 0.5\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 1460,
                "out_toks": 258,
                "id": "chatcmpl-Bx07xg15C1ntK01W7HK4VdxOE0H5j",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the most probable class for each object from the probability table\nJOIN (\n    SELECT \n        p1.oid,\n        p1.class_name,\n        p1.probability\n    FROM \n        probability p1\n    WHERE \n        p1.classifier_name = 'lc_classifier'\n        AND p1.classifier_version = (SELECT MAX(classifier_version) FROM probability p2 WHERE p2.classifier_name = 'lc_classifier' AND p2.oid = p1.oid)\n        AND p1.ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the most probable class for each object from the probability table\nJOIN (\n    SELECT \n        p1.oid,\n        p1.class_name,\n        p1.probability\n    FROM \n        probability p1\n    WHERE \n        p1.classifier_name = 'lc_classifier'\n        AND p1.classifier_version = (SELECT MAX(classifier_version) FROM probability p2 WHERE p2.classifier_name = 'lc_classifier' AND p2.oid = p1.oid)\n        AND p1.ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2542,
                "out_toks": 182,
                "id": "chatcmpl-BwxFKJozuGQsDAFDScdfN2nEAPOg8",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "30",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 776,
                "out_toks": 14,
                "id": "chatcmpl-BjAcoBAXN4bjHhUFJerGHGNocXNAY",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- Optional: Add an index or condition to limit the scope if needed, e.g., date range or specific objects\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- Optional: Add an index or condition to limit the scope if needed, e.g., date range or specific objects\n```"
                },
                "in_toks": 1345,
                "out_toks": 188,
                "id": "chatcmpl-Bx08ixhsvubisa4oMT5ULpbxmhwSS",
                "created": 1753401588,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2542,
                "out_toks": 127,
                "id": "chatcmpl-BwxFKzkRWa5CML0di7mJtw129zBum",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "30",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 623,
                "out_toks": 10,
                "id": "chatcmpl-BwvJZM4pV6IXoiZca6xo3EOSInjpL",
                "created": 1753383041,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- To optimize, ensure that the probability table has an index on (oid, classifier_name, ranking)\n-- and that the join condition is efficient; consider adding additional filters if needed\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- To optimize, ensure that the probability table has an index on (oid, classifier_name, ranking)\n-- and that the join condition is efficient; consider adding additional filters if needed\n```"
                },
                "in_toks": 1390,
                "out_toks": 201,
                "id": "chatcmpl-Bx086OJu4TygyIUqwrOrrzVjp6DqM",
                "created": 1753401550,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2587,
                "out_toks": 127,
                "id": "chatcmpl-BwxFEwYqaNQMhUgYXCGV1EfyAFB5D",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "30",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 623,
                "out_toks": 10,
                "id": "chatcmpl-BwvJa3z2GjRHZIhJfptJTmFVZazY6",
                "created": 1753383042,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- Optional: Add an index or condition to limit the scope if needed, e.g., date range or object subset\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- Optional: Add an index or condition to limit the scope if needed, e.g., date range or object subset\n```"
                },
                "in_toks": 1390,
                "out_toks": 188,
                "id": "chatcmpl-Bx083DM4T7uu4qTimpvOLvwvwjRlW",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2587,
                "out_toks": 127,
                "id": "chatcmpl-BwxFKVzcVVMPerDmDm3hbUVAZrPJm",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "30",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 623,
                "out_toks": 10,
                "id": "chatcmpl-BwvJaJW3cKjdCcn7QW5tEHbliZKFq",
                "created": 1753383042,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- Optional: Add an ORDER BY clause if needed to sort results\n-- ORDER BY o.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- Optional: Add an ORDER BY clause if needed to sort results\n-- ORDER BY o.oid;\n```"
                },
                "in_toks": 1390,
                "out_toks": 185,
                "id": "chatcmpl-Bx07xaHNxKCE5fBu7n4lHlj5s1I5u",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2587,
                "out_toks": 127,
                "id": "chatcmpl-BwxFEFWK1Gs0VQctk5PpHiJ7JOr4h",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "30",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 623,
                "out_toks": 10,
                "id": "chatcmpl-BwvJbu0jbYM95NKRJ5Nn4pPZhZbua",
                "created": 1753383043,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object from the probability table\nJOIN (\n    SELECT \n        p1.oid,\n        p1.class_name,\n        p1.probability\n    FROM \n        probability p1\n    -- Filter for the specific classifier and ensure only the top-ranked class per object\n    WHERE \n        p1.classifier_name = 'lc_classifier'\n        AND p1.ranking = 1\n        -- Additional conditions to optimize and narrow down the query\n        AND p1.probability > 0.5 -- optional: only consider classes with probability > 0.5\n        AND p1.class_name IS NOT NULL -- ensure class_name is not null\n) p ON o.oid = p.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object from the probability table\nJOIN (\n    SELECT \n        p1.oid,\n        p1.class_name,\n        p1.probability\n    FROM \n        probability p1\n    -- Filter for the specific classifier and ensure only the top-ranked class per object\n    WHERE \n        p1.classifier_name = 'lc_classifier'\n        AND p1.ranking = 1\n        -- Additional conditions to optimize and narrow down the query\n        AND p1.probability > 0.5 -- optional: only consider classes with probability > 0.5\n        AND p1.class_name IS NOT NULL -- ensure class_name is not null\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 1390,
                "out_toks": 218,
                "id": "chatcmpl-Bx08l5vlLvhmJseCZ5idzGb04jQin",
                "created": 1753401591,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2587,
                "out_toks": 127,
                "id": "chatcmpl-BwxFE1ubEGqJ5qcnaOGxGsqD21Fjt",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "30",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 623,
                "out_toks": 10,
                "id": "chatcmpl-BwvJbU08NVFhw5rbPewW5nc7rW2ot",
                "created": 1753383043,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n        -- Additional conditions to optimize the query and reduce timeout:\n        -- For example, filter by a specific classifier version if known, or limit to objects with recent observations\n        -- AND classifier_version = 'v1.0' -- Uncomment and modify if a specific version is used\n        -- AND oid IN (SELECT oid FROM object WHERE lastmjd > some_recent_date) -- Optional date filter\n) p ON o.oid = p.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n        -- Additional conditions to optimize the query and reduce timeout:\n        -- For example, filter by a specific classifier version if known, or limit to objects with recent observations\n        -- AND classifier_version = 'v1.0' -- Uncomment and modify if a specific version is used\n        -- AND oid IN (SELECT oid FROM object WHERE lastmjd > some_recent_date) -- Optional date filter\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 1390,
                "out_toks": 211,
                "id": "chatcmpl-Bx089HGX4vciuhG3cGFksAL4OUY8b",
                "created": 1753401553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2587,
                "out_toks": 127,
                "id": "chatcmpl-BwxFMlRPzQWg0bGg8WwIK0hjdja7q",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "30",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 623,
                "out_toks": 10,
                "id": "chatcmpl-BwvJc8phWcG7DBh6YaUr7pTgGS8T2",
                "created": 1753383044,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- Optional: Add an index or condition to limit the scope if needed, e.g., date range or object subset\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier' -- Filter for the specific classifier\n        AND ranking = 1 -- Select only the top-ranked class for each object\n        AND probability IS NOT NULL -- Ensure probability is not null to avoid unnecessary data\n) p ON o.oid = p.oid\n-- Optional: Add an index or condition to limit the scope if needed, e.g., date range or object subset\n```"
                },
                "in_toks": 1390,
                "out_toks": 188,
                "id": "chatcmpl-Bx085e0a3gmvXWQG1yTg1MIKWpjQj",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2587,
                "out_toks": 127,
                "id": "chatcmpl-BwxFH7nol7K9myM6ZfY9CVlM7LPcl",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "30",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 623,
                "out_toks": 10,
                "id": "chatcmpl-BwvJdaYv4U2P82DlZxLKUPhiTkD08",
                "created": 1753383045,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n        -- Additional conditions to optimize query performance\n        AND probability > 0.0 -- ensure the probability is meaningful\n        -- Optionally, add a date range condition if relevant, e.g., only objects observed in recent years\n        -- AND object.mjdendhist >= EXTRACT(EPOCH FROM CURRENT_DATE) - 365*3 -- last 3 years\n) p ON o.oid = p.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n        -- Additional conditions to optimize query performance\n        AND probability > 0.0 -- ensure the probability is meaningful\n        -- Optionally, add a date range condition if relevant, e.g., only objects observed in recent years\n        -- AND object.mjdendhist >= EXTRACT(EPOCH FROM CURRENT_DATE) - 365*3 -- last 3 years\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 1390,
                "out_toks": 205,
                "id": "chatcmpl-Bx07yIu9gIYrvfPMLELimXYSj3vol",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2587,
                "out_toks": 127,
                "id": "chatcmpl-BwxFEWeNpfnm5ISJYtaahmcHGlzJs",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "30",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy']"
                },
                "in_toks": 623,
                "out_toks": 10,
                "id": "chatcmpl-BwvJdVynkwxi4ZKTFPyaeqr11YCu6",
                "created": 1753383045,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n        -- Additional conditions to optimize the query and reduce timeout:\n        -- For example, filter by a specific classifier version if known, or limit to recent objects\n        -- AND classifier_version = 'v1.0' -- Uncomment and modify if a specific version is needed\n        -- AND oid IN (SELECT oid FROM object WHERE lastmjd - firstmjd < 365) -- Example: objects observed within a year\n) p ON o.oid = p.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Join with a subquery that selects the highest probability class (ranking=1) for each object, classifier, and version\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n        -- Additional conditions to optimize the query and reduce timeout:\n        -- For example, filter by a specific classifier version if known, or limit to recent objects\n        -- AND classifier_version = 'v1.0' -- Uncomment and modify if a specific version is needed\n        -- AND oid IN (SELECT oid FROM object WHERE lastmjd - firstmjd < 365) -- Example: objects observed within a year\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 1390,
                "out_toks": 216,
                "id": "chatcmpl-Bx07xidOLEs93fA5f4y0dmjHMsqzl",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, class name, and probability for each object based on the top-ranked class from the light curve classifier\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability\nFROM \n    object o\n-- Use a nested subquery to select the highest probability class (ranking=1) for each object and classifier\nJOIN (\n    SELECT \n        oid,\n        class_name,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier'\n        AND ranking = 1\n) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2587,
                "out_toks": 127,
                "id": "chatcmpl-BwxFGcFdvrlxzetTZIahfUYACWViz",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "22": {
        "0": {
            "req_id": "22",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 761,
                "out_toks": 14,
                "id": "chatcmpl-BjAcoLtTfznresCZGC0pkA0mgslNN",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects detected between June 1st and July 1st, 2018, with their top-ranked lc_classifier probability\nWITH date_filtered_objects AS (\n    -- Filter objects based on detection time window\n    SELECT oid\n    FROM object\n    WHERE firstmjd >= 58239.0 AND lastmjd <= 58270.0\n),\ntop_probability AS (\n    -- Select the highest probability (ranking=1) for each object from the lc_classifier\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nfiltered_objects AS (\n    -- Join objects with their top probability class\n    SELECT o.*\n    FROM object o\n    JOIN top_probability tp ON o.oid = tp.oid\n)\n-- Final selection of objects within date range and with top class probability\nSELECT fo.*\nFROM filtered_objects fo\nWHERE fo.oid IN (\n    SELECT oid FROM date_filtered_objects\n);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects detected between June 1st and July 1st, 2018, with their top-ranked lc_classifier probability\nWITH date_filtered_objects AS (\n    -- Filter objects based on detection time window\n    SELECT oid\n    FROM object\n    WHERE firstmjd >= 58239.0 AND lastmjd <= 58270.0\n),\ntop_probability AS (\n    -- Select the highest probability (ranking=1) for each object from the lc_classifier\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nfiltered_objects AS (\n    -- Join objects with their top probability class\n    SELECT o.*\n    FROM object o\n    JOIN top_probability tp ON o.oid = tp.oid\n)\n-- Final selection of objects within date range and with top class probability\nSELECT fo.*\nFROM filtered_objects fo\nWHERE fo.oid IN (\n    SELECT oid FROM date_filtered_objects\n);\n```"
                },
                "in_toks": 1382,
                "out_toks": 217,
                "id": "chatcmpl-Bx07xVwoD77uXtgWT3MY9VVM2x3MR",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object details for objects detected between June 1st and July 1st, 2018\nWITH date_filtered_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd >= 58239.0 AND lastmjd <= 58270.0\n)\n-- Retrieve objects with their top-ranked probability class from the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid\n    FROM date_filtered_objects\n) AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object details for objects detected between June 1st and July 1st, 2018\nWITH date_filtered_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd >= 58239.0 AND lastmjd <= 58270.0\n)\n-- Retrieve objects with their top-ranked probability class from the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid\n    FROM date_filtered_objects\n) AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n);\n```"
                },
                "in_toks": 2564,
                "out_toks": 146,
                "id": "chatcmpl-BwxFEkZF9eLuULG4GJ0yYBtd167GC",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "22",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 761,
                "out_toks": 14,
                "id": "chatcmpl-BjAcoLtTfznresCZGC0pkA0mgslNN",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object details for objects detected between June 1st and July 1st, 2018\nWITH object_time_filtered AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd >= 58239.0 AND firstmjd <= 58270.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to select objects with top-ranked probability for the light curve classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM object_time_filtered)\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object details for objects detected between June 1st and July 1st, 2018\nWITH object_time_filtered AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd >= 58239.0 AND firstmjd <= 58270.0\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    -- Subquery to select objects with top-ranked probability for the light curve classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM object_time_filtered)\n);\n```"
                },
                "in_toks": 2564,
                "out_toks": 139,
                "id": "chatcmpl-BwxFO2pHUMok4EV4pBQNgDt9ESQxG",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "22",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'light curve classifier']"
                },
                "in_toks": 608,
                "out_toks": 18,
                "id": "chatcmpl-BwvJeiapLizBaw7zikjl5MBIC1B5Y",
                "created": 1753383046,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed classification as the light curve classifier\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0  -- Last observation after or on June 1, 2018\n  AND o.mjdstarthist <= 58270.0 -- First observation before or on July 1, 2018\n  AND EXISTS (\n    -- Confirm the object has a probability entry with the classifier 'lc_classifier' and top ranking\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed classification as the light curve classifier\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0  -- Last observation after or on June 1, 2018\n  AND o.mjdstarthist <= 58270.0 -- First observation before or on July 1, 2018\n  AND EXISTS (\n    -- Confirm the object has a probability entry with the classifier 'lc_classifier' and top ranking\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 3819,
                "out_toks": 174,
                "id": "chatcmpl-Bx087osCLKvTmKC1yBfREwqq6UDTV",
                "created": 1753401551,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 5040,
                "out_toks": 136,
                "id": "chatcmpl-BwxFEvAsMAzcUsjDMr3G3FmyJfrye",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "22",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'pipeline']"
                },
                "in_toks": 608,
                "out_toks": 16,
                "id": "chatcmpl-BwvJec5EpswXFa0LQZ1cgFVGvtrUS",
                "created": 1753383046,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects detected between June 1st and July 1st, 2018, classified by the light curve classifier\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n)\nSELECT o.*\nFROM object o\nWHERE o.firstmjd >= (SELECT start_mjd FROM date_range)\n  AND o.firstmjd <= (SELECT end_mjd FROM date_range)\n  AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n        AND p.ranking = 1\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects detected between June 1st and July 1st, 2018, classified by the light curve classifier\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n)\nSELECT o.*\nFROM object o\nWHERE o.firstmjd >= (SELECT start_mjd FROM date_range)\n  AND o.firstmjd <= (SELECT end_mjd FROM date_range)\n  AND EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n        AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 5119,
                "out_toks": 165,
                "id": "chatcmpl-BwxFHPgMmbvi2btqlbJuiVqR2Ngqq",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "22",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'light curve classifier']"
                },
                "in_toks": 608,
                "out_toks": 18,
                "id": "chatcmpl-BwvJfnInMbDbNXh8izTBFegYpSzZQ",
                "created": 1753383047,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed light curve classification\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check for a probability entry with the light curve classifier, ranking 1, and specific classifier names\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n      )\n      AND p.ranking = 1\n      -- Additional condition to ensure the probability is above a certain threshold for confidence (e.g., > 0.5)\n      AND p.probability > 0.5\n  );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed light curve classification\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check for a probability entry with the light curve classifier, ranking 1, and specific classifier names\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n      )\n      AND p.ranking = 1\n      -- Additional condition to ensure the probability is above a certain threshold for confidence (e.g., > 0.5)\n      AND p.probability > 0.5\n  );\n```"
                },
                "in_toks": 3849,
                "out_toks": 208,
                "id": "chatcmpl-Bx08Ar45M0BK1xfUR5jyFe5V5pYnL",
                "created": 1753401554,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 5040,
                "out_toks": 149,
                "id": "chatcmpl-BwxFE4cX55dDSvtrisr0Mxd0O1QCh",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "22",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"object\", \"probability\", \"taxonomy\", \"feature\", \"pipeline\"]"
                },
                "in_toks": 608,
                "out_toks": 16,
                "id": "chatcmpl-BwvJgXwypRJi6jccptNFVsaPlijmh",
                "created": 1753383048,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range in MJD\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n),\n-- Select object OIDs with probabilities from the light curve classifier within the date range\nlc_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    -- Filter for the specific classifier and the most probable class\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      -- Ensure the probability entry is for objects observed within the date range\n      AND EXISTS (\n          SELECT 1\n          FROM object o\n          WHERE o.oid = p.oid\n            AND o.firstmjd <= (SELECT end_mjd FROM date_range)\n            AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n      )\n      -- Additional condition: ensure the probability is above a certain threshold for relevance (optional, e.g., > 0.5)\n      AND p.probability > 0.5\n)\n-- Final selection of objects found within the date range by the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM lc_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range in MJD\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n),\n-- Select object OIDs with probabilities from the light curve classifier within the date range\nlc_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    -- Filter for the specific classifier and the most probable class\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      -- Ensure the probability entry is for objects observed within the date range\n      AND EXISTS (\n          SELECT 1\n          FROM object o\n          WHERE o.oid = p.oid\n            AND o.firstmjd <= (SELECT end_mjd FROM date_range)\n            AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n      )\n      -- Additional condition: ensure the probability is above a certain threshold for relevance (optional, e.g., > 0.5)\n      AND p.probability > 0.5\n)\n-- Final selection of objects found within the date range by the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM lc_objects);\n```"
                },
                "in_toks": 4012,
                "out_toks": 255,
                "id": "chatcmpl-Bx08opcdKTuaJX6HbbFgPrhQNVStC",
                "created": 1753401594,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the date range in MJD\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n),\n-- Select object OIDs with probabilities from the light curve classifier within the date range\nlc_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1 -- most probable class\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.firstmjd <= (SELECT end_mjd FROM date_range)\n            AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n      )\n)\n-- Final selection of objects found within the date range by the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM lc_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range in MJD\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n),\n-- Select object OIDs with probabilities from the light curve classifier within the date range\nlc_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1 -- most probable class\n      AND p.oid IN (\n          SELECT o.oid\n          FROM object o\n          WHERE o.firstmjd <= (SELECT end_mjd FROM date_range)\n            AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n      )\n)\n-- Final selection of objects found within the date range by the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM lc_objects);\n```"
                },
                "in_toks": 5119,
                "out_toks": 186,
                "id": "chatcmpl-BwxFJuY4bnfxqOUVnNWPzX69QoRPv",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "22",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'light curve classifier']"
                },
                "in_toks": 608,
                "out_toks": 18,
                "id": "chatcmpl-BwvJgqm7q6w8dsKD6jfyfqaQyd9pp",
                "created": 1753383048,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nWITH date_filtered_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd <= 58270.0\n      AND lastmjd >= 58239.0\n)\n-- Retrieve objects with probabilities for the light curve classifier within the date range\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM date_filtered_objects)\n  AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nWITH date_filtered_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd <= 58270.0\n      AND lastmjd >= 58239.0\n)\n-- Retrieve objects with probabilities for the light curve classifier within the date range\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM date_filtered_objects)\n  AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 5040,
                "out_toks": 170,
                "id": "chatcmpl-BwxFLvhBHYmzKrdReEDNkgJpTBdfO",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "22",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'light curve classifier']"
                },
                "in_toks": 608,
                "out_toks": 18,
                "id": "chatcmpl-BwvJhje1hl6mDYFGwsrhm8qGJfNmH",
                "created": 1753383049,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed light curve classification\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0  -- Last observation after or on June 1, 2018\n  AND o.mjdstarthist <= 58270.0 -- First observation before or on July 1, 2018\n  AND EXISTS (\n    -- Confirm the object has a probability entry with the classifier 'lc_classifier' and top ranking\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name = 'LightCurveClassifier' -- Ensure the class name matches the classifier's class\n  );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed light curve classification\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0  -- Last observation after or on June 1, 2018\n  AND o.mjdstarthist <= 58270.0 -- First observation before or on July 1, 2018\n  AND EXISTS (\n    -- Confirm the object has a probability entry with the classifier 'lc_classifier' and top ranking\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name = 'LightCurveClassifier' -- Ensure the class name matches the classifier's class\n  );\n```"
                },
                "in_toks": 3799,
                "out_toks": 183,
                "id": "chatcmpl-Bx085G4feorKEJ4IhPvGCgDVL8B5W",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 5040,
                "out_toks": 126,
                "id": "chatcmpl-BwxFExp9alh4Iu2iFHH0V0zuG3oYE",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "22",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'light curve classifier']"
                },
                "in_toks": 608,
                "out_toks": 18,
                "id": "chatcmpl-BwvJiRAH4Ld1CnNO1MsmBZupvvoFT",
                "created": 1753383050,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed light curve classification\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0  -- Last observation on or after June 1, 2018\n  AND o.mjdstarthist <= 58270.0 -- First observation on or before July 1, 2018\n  AND EXISTS (\n    -- Confirm the object has a probability entry with the 'lc_classifier' and top ranking\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed light curve classification\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0  -- Last observation on or after June 1, 2018\n  AND o.mjdstarthist <= 58270.0 -- First observation on or before July 1, 2018\n  AND EXISTS (\n    -- Confirm the object has a probability entry with the 'lc_classifier' and top ranking\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 3819,
                "out_toks": 170,
                "id": "chatcmpl-Bx07xa9kpzCkc5mxT4fVS9s3GBGfC",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 5040,
                "out_toks": 136,
                "id": "chatcmpl-BwxFLuIroT8IN9fOGA6ntYr0If1aF",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "22",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'feature', 'light curve classifier']"
                },
                "in_toks": 608,
                "out_toks": 18,
                "id": "chatcmpl-BwvJiy8gSTmGCmv2iumXPDZ78t1f4",
                "created": 1753383050,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed light curve classification\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0  -- Last observation on or after June 1, 2018\n  AND o.mjdstarthist <= 58270.0 -- First observation on or before July 1, 2018\n  AND EXISTS (\n    -- Confirm the object has a probability entry with the 'lc_classifier' and highest ranking (1)\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs observed between June 1st and July 1st, 2018, with confirmed light curve classification\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0  -- Last observation on or after June 1, 2018\n  AND o.mjdstarthist <= 58270.0 -- First observation on or before July 1, 2018\n  AND EXISTS (\n    -- Confirm the object has a probability entry with the 'lc_classifier' and highest ranking (1)\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 3819,
                "out_toks": 172,
                "id": "chatcmpl-Bx07xoWpExFJ0AqiSPukoyjtCJjNL",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs that were observed between June 1st and July 1st, 2018\nSELECT o.oid\nFROM object o\nWHERE o.mjdendhist >= 58239.0\n  AND o.mjdstarthist <= 58270.0\n  AND EXISTS (\n    -- Check if the object has a probability entry with the light curve classifier\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n      AND p.ranking = 1\n  );\n```"
                },
                "in_toks": 5040,
                "out_toks": 136,
                "id": "chatcmpl-BwxFHtDuoYRdxWahOblWh2xRjdBnQ",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "12": {
        "0": {
            "req_id": "12",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 807,
                "out_toks": 14,
                "id": "chatcmpl-BjAcouBO9FjaxiiAlcv9yKuTS4IJo",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\nsn_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n)\nSELECT s.oid, s.meanra, s.meandec\nFROM sources s\nJOIN sn_probabilities sp ON s.oid = sp.oid\nWHERE q3c_poly_query(s.meanra, s.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sources AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\nsn_probabilities AS (\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n)\nSELECT s.oid, s.meanra, s.meandec\nFROM sources s\nJOIN sn_probabilities sp ON s.oid = sp.oid\nWHERE q3c_poly_query(s.meanra, s.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 2609,
                "out_toks": 173,
                "id": "chatcmpl-BwxFGGvhr5GJL9r5jgNJBWbUsM1yA",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "12",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 807,
                "out_toks": 14,
                "id": "chatcmpl-BjAcouBO9FjaxiiAlcv9yKuTS4IJo",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH source_coords AS (\n    SELECT * FROM (VALUES\n        ('polygon_region', '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    ) AS t(source_id, poly)\n)\nSELECT o.oid, o.meanra, o.meandec\nFROM object o\nWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0\n  AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n  )\n  AND EXISTS (\n    SELECT 1\n    FROM source_coords sc\n    WHERE q3c_poly_query(o.meanra, o.meandec, sc.poly)\n  );",
            "original_sql_response": {
                "responses": {
                    "0": "WITH source_coords AS (\n    SELECT * FROM (VALUES\n        ('polygon_region', '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n    ) AS t(source_id, poly)\n)\nSELECT o.oid, o.meanra, o.meandec\nFROM object o\nWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0\n  AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n  )\n  AND EXISTS (\n    SELECT 1\n    FROM source_coords sc\n    WHERE q3c_poly_query(o.meanra, o.meandec, sc.poly)\n  );"
                },
                "in_toks": 2609,
                "out_toks": 185,
                "id": "chatcmpl-BwxFOtgJ8NazWWkN1luM9D3jqog9k",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "12",
            "experiment_id": "run_2",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 654,
                "out_toks": 3,
                "id": "chatcmpl-BwvJjG0giCVgVGmq2ub9dYUqEVoRz",
                "created": 1753383051,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user requirements\nWITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE -- Filter objects classified as SNe based on probability table\n        o.oid IN (\n            SELECT p.object_oid\n            FROM probability p\n            WHERE p.class_name = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        )\n        AND -- Filter objects with first detection MJDs between Feb 13 and Sep 10, 2023\n        o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\n-- Select objects within the specified polygon\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user requirements\nWITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE -- Filter objects classified as SNe based on probability table\n        o.oid IN (\n            SELECT p.object_oid\n            FROM probability p\n            WHERE p.class_name = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        )\n        AND -- Filter objects with first detection MJDs between Feb 13 and Sep 10, 2023\n        o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\n-- Select objects within the specified polygon\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 1446,
                "out_toks": 206,
                "id": "chatcmpl-Bx08rr9C5EhpDbgxWvY1WEGO294zd",
                "created": 1753401597,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.object_oid IN (\n            SELECT o2.oid\n            FROM object o2\n            WHERE o2.oid = p.object_oid\n              AND p.class_name = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        )\n        AND p.first_detection_mjd BETWEEN 59988.0 AND 60197.0\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.object_oid IN (\n            SELECT o2.oid\n            FROM object o2\n            WHERE o2.oid = p.object_oid\n              AND p.class_name = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        )\n        AND p.first_detection_mjd BETWEEN 59988.0 AND 60197.0\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 2425,
                "out_toks": 185,
                "id": "chatcmpl-BwxFKRCA7NtvEC17OdwUmoyaiHXwv",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "12",
            "experiment_id": "run_3",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 654,
                "out_toks": 3,
                "id": "chatcmpl-BwvJj4s0Vh2cj0AMme8GGxNGl1Vrw",
                "created": 1753383051,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected query to find SNe objects that first occurred between Feb 13 and Sep 10, within the specified polygon.\n-- The original query referenced a 'probability' table and 'object_oid' column which do not exist in the provided schema.\n-- Instead, we will use only the 'object' table, filter by 'firstmjd' (first detection date), and apply the polygon filter.\n-- The date range is converted from calendar dates to MJD:\n-- Feb 13, 2023 -> MJD 59988\n-- Sep 10, 2023 -> MJD 60197\n\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec\nFROM \n    object o\n-- Filter objects with first detection between Feb 13 and Sep 10, 2023\nWHERE \n    o.firstmjd BETWEEN 59988 AND 60197\n-- Filter objects within the specified polygon using q3c_poly_query\n-- The polygon is defined by the provided coordinates\nAND \n    q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected query to find SNe objects that first occurred between Feb 13 and Sep 10, within the specified polygon.\n-- The original query referenced a 'probability' table and 'object_oid' column which do not exist in the provided schema.\n-- Instead, we will use only the 'object' table, filter by 'firstmjd' (first detection date), and apply the polygon filter.\n-- The date range is converted from calendar dates to MJD:\n-- Feb 13, 2023 -> MJD 59988\n-- Sep 10, 2023 -> MJD 60197\n\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec\nFROM \n    object o\n-- Filter objects with first detection between Feb 13 and Sep 10, 2023\nWHERE \n    o.firstmjd BETWEEN 59988 AND 60197\n-- Filter objects within the specified polygon using q3c_poly_query\n-- The polygon is defined by the provided coordinates\nAND \n    q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 1459,
                "out_toks": 257,
                "id": "chatcmpl-Bx086SHT2cLgY8MP2xkC8OGLCpTnj",
                "created": 1753401550,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.object_oid IN (\n            SELECT o.oid\n            FROM object o\n            WHERE o.oid IN (\n                SELECT o.oid\n                FROM object o\n                WHERE o.firstmjd BETWEEN 59988.0 AND 60197.0\n            )\n        )\n        AND p.class_name = 'SNe'\n        AND p.ranking = 1\n        AND p.classifier_name = 'lc_classifier'\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.object_oid IN (\n            SELECT o.oid\n            FROM object o\n            WHERE o.oid IN (\n                SELECT o.oid\n                FROM object o\n                WHERE o.firstmjd BETWEEN 59988.0 AND 60197.0\n            )\n        )\n        AND p.class_name = 'SNe'\n        AND p.ranking = 1\n        AND p.classifier_name = 'lc_classifier'\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 2425,
                "out_toks": 192,
                "id": "chatcmpl-BwxFImJie61kTd9yUgbfAzt3vzPCT",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "12",
            "experiment_id": "run_4",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 654,
                "out_toks": 3,
                "id": "chatcmpl-BwvJkSaVUotHD1dZT7CZ9nUhpoRO1",
                "created": 1753383052,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper syntax for polygon query and accurate table/column references\nWITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid IN (\n        SELECT oid\n        FROM (\n            SELECT oid, \n                   (probability ->> 'SNIa')::float AS snia_prob,\n                   (probability ->> 'SNIbc')::float AS snbc_prob,\n                   (probability ->> 'SNII')::float AS snii_prob,\n                   (probability ->> 'SLSN')::float AS slsn_prob\n            FROM probability\n            WHERE classifier_name = 'lc_classifier'\n        ) sub\n        WHERE snia_prob IS NOT NULL OR snbc_prob IS NOT NULL OR snii_prob IS NOT NULL OR slsn_prob IS NOT NULL\n    )\n    AND oid IN (\n        SELECT oid\n        FROM object\n        WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n    )\n)\n-- Use q3c_poly_query with proper array inputs for RA and Dec\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    -- Array of RA coordinates defining the polygon vertices\n    ARRAY[-20, -2, 20, 10],\n    -- Array of Dec coordinates defining the polygon vertices\n    ARRAY[-20, -20, 1, 10],\n    -- Polygon vertices as a string in WKT format\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'\n);\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper syntax for polygon query and accurate table/column references\nWITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid IN (\n        SELECT oid\n        FROM (\n            SELECT oid, \n                   (probability ->> 'SNIa')::float AS snia_prob,\n                   (probability ->> 'SNIbc')::float AS snbc_prob,\n                   (probability ->> 'SNII')::float AS snii_prob,\n                   (probability ->> 'SLSN')::float AS slsn_prob\n            FROM probability\n            WHERE classifier_name = 'lc_classifier'\n        ) sub\n        WHERE snia_prob IS NOT NULL OR snbc_prob IS NOT NULL OR snii_prob IS NOT NULL OR slsn_prob IS NOT NULL\n    )\n    AND oid IN (\n        SELECT oid\n        FROM object\n        WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n    )\n)\n-- Use q3c_poly_query with proper array inputs for RA and Dec\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    -- Array of RA coordinates defining the polygon vertices\n    ARRAY[-20, -2, 20, 10],\n    -- Array of Dec coordinates defining the polygon vertices\n    ARRAY[-20, -20, 1, 10],\n    -- Polygon vertices as a string in WKT format\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'\n);\n"
                },
                "in_toks": 1604,
                "out_toks": 336,
                "id": "chatcmpl-Bx08BhYCJoWDcM0YcKZ7b8Elr96UQ",
                "created": 1753401555,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid IN (\n        SELECT oid\n        FROM (\n            SELECT oid, \n                   (probability ->> 'SNIa')::float AS snia_prob,\n                   (probability ->> 'SNIbc')::float AS snbc_prob,\n                   (probability ->> 'SNII')::float AS snii_prob,\n                   (probability ->> 'SLSN')::float AS slsn_prob\n            FROM probability\n            WHERE classifier_name = 'lc_classifier'\n        ) sub\n        WHERE snia_prob IS NOT NULL OR snbc_prob IS NOT NULL OR snii_prob IS NOT NULL OR slsn_prob IS NOT NULL\n    )\n    AND oid IN (\n        SELECT oid\n        FROM object\n        WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    (SELECT array_agg(ra) FROM (VALUES (-20), -2, 20, 10) AS t(ra)),\n    (SELECT array_agg(dec) FROM (VALUES (-20), -20, 1, 10) AS t(dec)),\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid IN (\n        SELECT oid\n        FROM (\n            SELECT oid, \n                   (probability ->> 'SNIa')::float AS snia_prob,\n                   (probability ->> 'SNIbc')::float AS snbc_prob,\n                   (probability ->> 'SNII')::float AS snii_prob,\n                   (probability ->> 'SLSN')::float AS slsn_prob\n            FROM probability\n            WHERE classifier_name = 'lc_classifier'\n        ) sub\n        WHERE snia_prob IS NOT NULL OR snbc_prob IS NOT NULL OR snii_prob IS NOT NULL OR slsn_prob IS NOT NULL\n    )\n    AND oid IN (\n        SELECT oid\n        FROM object\n        WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    (SELECT array_agg(ra) FROM (VALUES (-20), -2, 20, 10) AS t(ra)),\n    (SELECT array_agg(dec) FROM (VALUES (-20), -20, 1, 10) AS t(dec)),\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n);"
                },
                "in_toks": 2425,
                "out_toks": 299,
                "id": "chatcmpl-BwxFPuGMdkRYfu0Ucpe99ePP3j27U",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "12",
            "experiment_id": "run_5",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 654,
                "out_toks": 3,
                "id": "chatcmpl-BwvJk1iaVp6la7IsAefOjIg3X6kXB",
                "created": 1753383052,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query to find SNe objects that first occurred between Feb 13 and Sep 10, within the specified polygon, returning their oids, mean ra, and dec.\nWITH sources AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\npolygon_coords AS (\n    -- Define the polygon as a WKT polygon string\n    SELECT 'POLYGON((-20 -20, -2 -20, 20 1, 10 10, -20 -20))'::geometry AS geom\n)\nSELECT s.oid, s.meanra, s.meandec\nFROM sources s, polygon_coords p\n-- Use q3c_poly_query to check if the object's position is within the polygon\nWHERE q3c_poly_query(\n    q3c_point(s.meanra, s.meandec),\n    p.geom\n);",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query to find SNe objects that first occurred between Feb 13 and Sep 10, within the specified polygon, returning their oids, mean ra, and dec.\nWITH sources AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\npolygon_coords AS (\n    -- Define the polygon as a WKT polygon string\n    SELECT 'POLYGON((-20 -20, -2 -20, 20 1, 10 10, -20 -20))'::geometry AS geom\n)\nSELECT s.oid, s.meanra, s.meandec\nFROM sources s, polygon_coords p\n-- Use q3c_poly_query to check if the object's position is within the polygon\nWHERE q3c_poly_query(\n    q3c_point(s.meanra, s.meandec),\n    p.geom\n);"
                },
                "in_toks": 1276,
                "out_toks": 195,
                "id": "chatcmpl-Bx07x2r7bMk3d83Pqwc0ghUSvCSZs",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sources AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\npolygon_coords AS (\n    SELECT ARRAY[\n        ROW(-20, -20),\n        ROW(-2, -20),\n        ROW(20, 1),\n        ROW(10, 10),\n        ROW(-20, -20) -- close the polygon\n    ]::point[] AS poly\n)\nSELECT s.oid, s.meanra, s.meandec\nFROM sources s, polygon_coords p\nWHERE q3c_poly_query(s.meanra, s.meandec, p.poly);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sources AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\npolygon_coords AS (\n    SELECT ARRAY[\n        ROW(-20, -20),\n        ROW(-2, -20),\n        ROW(20, 1),\n        ROW(10, 10),\n        ROW(-20, -20) -- close the polygon\n    ]::point[] AS poly\n)\nSELECT s.oid, s.meanra, s.meandec\nFROM sources s, polygon_coords p\nWHERE q3c_poly_query(s.meanra, s.meandec, p.poly);"
                },
                "in_toks": 2425,
                "out_toks": 140,
                "id": "chatcmpl-BwxFJBi7jAcewzVNMpjfnfs0nSA0k",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "12",
            "experiment_id": "run_6",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 654,
                "out_toks": 3,
                "id": "chatcmpl-BwvJlkE5xd10RXLI2Aa5wHjSKelke",
                "created": 1753383053,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\nWITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE -- Filter objects that are within the specified date range\n          firstmjd BETWEEN 59988.0 AND 60197.0\n          -- Additional filters for SN classification probabilities can be added here if probability table exists\n)\n-- Select objects within the specified polygon\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    -- Coordinates defining the polygon\n    ARRAY[-20, -2, 20, 10], -- RA points\n    ARRAY[-20, -20, 1, 10], -- Dec points\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n);\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\nWITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE -- Filter objects that are within the specified date range\n          firstmjd BETWEEN 59988.0 AND 60197.0\n          -- Additional filters for SN classification probabilities can be added here if probability table exists\n)\n-- Select objects within the specified polygon\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    -- Coordinates defining the polygon\n    ARRAY[-20, -2, 20, 10], -- RA points\n    ARRAY[-20, -20, 1, 10], -- Dec points\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n);\n"
                },
                "in_toks": 1751,
                "out_toks": 184,
                "id": "chatcmpl-Bx07xQobs1Slw6jp7py9aEDbS4qst",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid IN (\n        SELECT oid\n        FROM (\n            SELECT oid, \n                   (probability ->> 'SNIa')::float AS snia_prob,\n                   (probability ->> 'SNIbc')::float AS snbc_prob,\n                   (probability ->> 'SNII')::float AS snii_prob,\n                   (probability ->> 'SLSN')::float AS slsn_prob\n            FROM probability\n            WHERE classifier_name = 'lc_classifier'\n        ) sub\n        WHERE snia_prob IS NOT NULL OR snbc_prob IS NOT NULL OR snii_prob IS NOT NULL OR slsn_prob IS NOT NULL\n    )\n    AND oid IN (\n        SELECT oid\n        FROM object\n        WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    (SELECT array_agg(ra) FROM (VALUES (-20), (-2), (20), (10)) AS coords(ra)),\n    (SELECT array_agg(dec) FROM (VALUES (-20), (-20), (1), (10)) AS coords(dec)),\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n)\n;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid IN (\n        SELECT oid\n        FROM (\n            SELECT oid, \n                   (probability ->> 'SNIa')::float AS snia_prob,\n                   (probability ->> 'SNIbc')::float AS snbc_prob,\n                   (probability ->> 'SNII')::float AS snii_prob,\n                   (probability ->> 'SLSN')::float AS slsn_prob\n            FROM probability\n            WHERE classifier_name = 'lc_classifier'\n        ) sub\n        WHERE snia_prob IS NOT NULL OR snbc_prob IS NOT NULL OR snii_prob IS NOT NULL OR slsn_prob IS NOT NULL\n    )\n    AND oid IN (\n        SELECT oid\n        FROM object\n        WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n    )\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(\n    (SELECT array_agg(ra) FROM (VALUES (-20), (-2), (20), (10)) AS coords(ra)),\n    (SELECT array_agg(dec) FROM (VALUES (-20), (-20), (1), (10)) AS coords(dec)),\n    '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon\n)\n;"
                },
                "in_toks": 2425,
                "out_toks": 300,
                "id": "chatcmpl-BwxFEITlcb8TGYkALKdwIBLMsrYes",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "12",
            "experiment_id": "run_7",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 654,
                "out_toks": 3,
                "id": "chatcmpl-BwvJlMrYsAgl9WJJ15ZLuZFhlRXZi",
                "created": 1753383053,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user requirements\nWITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE -- Filter objects classified as SN (assuming probability table is not available, so we omit that filter)\n          -- and only consider objects with firstmjd between Feb 13 and Sep 10, 2023\n          o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE -- Use q3c_poly_query to filter objects within the specified polygon\n      q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user requirements\nWITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE -- Filter objects classified as SN (assuming probability table is not available, so we omit that filter)\n          -- and only consider objects with firstmjd between Feb 13 and Sep 10, 2023\n          o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE -- Use q3c_poly_query to filter objects within the specified polygon\n      q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 1399,
                "out_toks": 174,
                "id": "chatcmpl-Bx08uORpYbEktXtIGkoZG0nUtJw4A",
                "created": 1753401600,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.object_oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.ranking = 1\n          AND p.classifier_name = 'stamp_classifier'\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.object_oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.ranking = 1\n          AND p.classifier_name = 'stamp_classifier'\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 2425,
                "out_toks": 161,
                "id": "chatcmpl-BwxFJxC73AcbXzUrPElSQOpaW6dpm",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "12",
            "experiment_id": "run_8",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 654,
                "out_toks": 3,
                "id": "chatcmpl-BwvJmTzvOssTfyU3jGTBHeIlgkugv",
                "created": 1753383054,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\nWITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE -- Filter objects that are classified as SNe (Supernovae) with highest probability\n        -- Since 'probability' table or 'object_oid' column does not exist, \n        -- and only 'object' table is provided, we assume classification info is embedded or omitted.\n        -- If classification info is stored elsewhere, it should be joined here.\n        -- For this correction, we proceed without classification filtering due to missing info.\n        -- If classification filtering is essential, it should be added once the correct table/column is known.\n        -- For now, we include all objects.\n        -- Filter objects with first detection date between Feb 13 and Sep 10\n        o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\n-- Select objects within the specified polygon\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\nWITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE -- Filter objects that are classified as SNe (Supernovae) with highest probability\n        -- Since 'probability' table or 'object_oid' column does not exist, \n        -- and only 'object' table is provided, we assume classification info is embedded or omitted.\n        -- If classification info is stored elsewhere, it should be joined here.\n        -- For this correction, we proceed without classification filtering due to missing info.\n        -- If classification filtering is essential, it should be added once the correct table/column is known.\n        -- For now, we include all objects.\n        -- Filter objects with first detection date between Feb 13 and Sep 10\n        o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\n-- Select objects within the specified polygon\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);\n"
                },
                "in_toks": 1453,
                "out_toks": 259,
                "id": "chatcmpl-Bx089FyQnBEfKBTq65Kwyd7HWcCW0",
                "created": 1753401553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.class_name = 'SNIa' -- Supernovae type Ia, included in all SNe\n        AND p.ranking = 1 -- most probable class\n        AND p.classifier_name = 'lc_classifier' -- default classifier for probabilities\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0 -- first occurrence between Feb 13 and Sep 10\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE o.oid IN (\n        SELECT DISTINCT p.object_oid\n        FROM probability p\n        WHERE p.class_name = 'SNIa' -- Supernovae type Ia, included in all SNe\n        AND p.ranking = 1 -- most probable class\n        AND p.classifier_name = 'lc_classifier' -- default classifier for probabilities\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0 -- first occurrence between Feb 13 and Sep 10\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 2425,
                "out_toks": 187,
                "id": "chatcmpl-BwxFMXYsX9FE4BVr7G8efgC5kDPxs",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "12",
            "experiment_id": "run_9",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 654,
                "out_toks": 3,
                "id": "chatcmpl-BwvJmpzV2MsMNakqh3qtH0mrf0b4O",
                "created": 1753383054,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user requirements\nWITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE -- Filter objects that are classified as SNe\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        )\n        -- Filter objects with first detection between Feb 13 and Sep 10, 2023\n        AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\n-- Select objects within the specified polygon\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user requirements\nWITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE -- Filter objects that are classified as SNe\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        )\n        -- Filter objects with first detection between Feb 13 and Sep 10, 2023\n        AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\n-- Select objects within the specified polygon\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 1408,
                "out_toks": 207,
                "id": "chatcmpl-Bx07z2X7qS7re5MiqfAhhBIcdYFeQ",
                "created": 1753401543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM (\n            SELECT oid\n            FROM probability p\n            WHERE p.object = o.oid\n              AND p.class = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        ) AS sn\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH sn_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM (\n            SELECT oid\n            FROM probability p\n            WHERE p.object = o.oid\n              AND p.class = 'SN'\n              AND p.ranking = 1\n              AND p.classifier_name = 'stamp_classifier'\n        ) AS sn\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\nSELECT oid, meanra, meandec\nFROM sn_objects\nWHERE q3c_poly_query(meanra, meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);"
                },
                "in_toks": 2425,
                "out_toks": 166,
                "id": "chatcmpl-BwxFEPqSo5TDLtjvItlBOrLbEDwf8",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "57": {
        "0": {
            "req_id": "57",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']",
                    "1": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 881,
                "out_toks": 22,
                "id": "chatcmpl-BjAcp7V12NZMkuMacCfJ0Mi4PstEz",
                "created": 1750105303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Define input objects with their coordinates and search radii in degrees\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\n-- Find objects within the specified radius of each input object\ncandidate_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        -- Use q3c_join to find objects within the radius of each input coordinate\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n),\n-- For each candidate object, compute mean RA/Dec and first detection date\naggregated_objects AS (\n    SELECT\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.input_ra,\n        c.input_dec,\n        c.radius_deg\n    FROM\n        candidate_objects c\n),\n-- Retrieve detection info for each object\ndetection_info AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS detection_count,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM aggregated_objects)\n    GROUP BY\n        d.oid\n)\n-- Final select: join aggregated object info with detection info\nSELECT\n    ao.oid AS ztf_object_id,\n    di.detection_count AS number_of_detections,\n    di.mean_ra,\n    di.mean_dec,\n    di.first_detection_mjd,\n    ao.input_id AS input_object_id,\n    ao.input_ra,\n    ao.input_dec,\n    ao.radius_deg AS search_radius_deg\nFROM\n    aggregated_objects ao\nJOIN\n    detection_info di ON ao.oid = di.oid\nORDER BY\n    di.first_detection_mjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Define input objects with their coordinates and search radii in degrees\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\n-- Find objects within the specified radius of each input object\ncandidate_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        -- Use q3c_join to find objects within the radius of each input coordinate\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n),\n-- For each candidate object, compute mean RA/Dec and first detection date\naggregated_objects AS (\n    SELECT\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.input_ra,\n        c.input_dec,\n        c.radius_deg\n    FROM\n        candidate_objects c\n),\n-- Retrieve detection info for each object\ndetection_info AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS detection_count,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM aggregated_objects)\n    GROUP BY\n        d.oid\n)\n-- Final select: join aggregated object info with detection info\nSELECT\n    ao.oid AS ztf_object_id,\n    di.detection_count AS number_of_detections,\n    di.mean_ra,\n    di.mean_dec,\n    di.first_detection_mjd,\n    ao.input_id AS input_object_id,\n    ao.input_ra,\n    ao.input_dec,\n    ao.radius_deg AS search_radius_deg\nFROM\n    aggregated_objects ao\nJOIN\n    detection_info di ON ao.oid = di.oid\nORDER BY\n    di.first_detection_mjd DESC;"
                },
                "in_toks": 2320,
                "out_toks": 539,
                "id": "chatcmpl-Bx086aZplI1BgxAovBC5OMBSwefyb",
                "created": 1753401550,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS ra_input,\n        io.dec AS dec_input,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    mo.oid AS ztf_object_id,\n    mo.ndet AS number_of_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_mjd,\n    io.identifier AS input_object_id,\n    io.ra AS input_ra,\n    io.dec AS input_dec,\n    io.radius_deg AS search_radius_deg\nFROM\n    matched_objects mo\nJOIN\n    object o ON mo.oid = o.oid\nORDER BY\n    mo.firstmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS ra_input,\n        io.dec AS dec_input,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    mo.oid AS ztf_object_id,\n    mo.ndet AS number_of_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_mjd,\n    io.identifier AS input_object_id,\n    io.ra AS input_ra,\n    io.dec AS input_dec,\n    io.radius_deg AS search_radius_deg\nFROM\n    matched_objects mo\nJOIN\n    object o ON mo.oid = o.oid\nORDER BY\n    mo.firstmjd DESC;"
                },
                "in_toks": 3125,
                "out_toks": 315,
                "id": "chatcmpl-BwxFHytxlroJkRusZxMhayY5Vx3FV",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "57",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']",
                    "1": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 881,
                "out_toks": 22,
                "id": "chatcmpl-BjAcp7V12NZMkuMacCfJ0Mi4PstEz",
                "created": 1750105303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query with nested subqueries, explicit join conditions, and probability filtering if applicable\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\ncandidate_objects AS (\n    -- Select objects with probability filtering if probability table exists\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.lastmjd\n    FROM\n        object o\n    -- If a probability table exists, include filtering conditions here, e.g.,\n    -- JOIN probability p ON p.oid = o.oid AND p.ranking=1 AND p.probability > threshold\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        co.oid AS ztf_oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(co.meanra) AS mean_ra,\n        AVG(co.meandec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        input_objects io\n    JOIN\n        candidate_objects co ON\n        -- Use q3c_join for spatial matching within radius\n        q3c_join(co.meanra, co.meandec, io.ra, io.dec, io.radius_deg)\n    JOIN\n        detection d ON d.oid = co.oid\n    GROUP BY\n        io.identifier, io.ra, io.dec, io.radius_deg, co.oid\n)\nSELECT\n    input_id,\n    input_ra,\n    input_dec,\n    radius_deg,\n    ztf_oid,\n    detection_count,\n    mean_ra,\n    mean_dec,\n    first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    first_detection_mjd DESC;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query with nested subqueries, explicit join conditions, and probability filtering if applicable\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\ncandidate_objects AS (\n    -- Select objects with probability filtering if probability table exists\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.lastmjd\n    FROM\n        object o\n    -- If a probability table exists, include filtering conditions here, e.g.,\n    -- JOIN probability p ON p.oid = o.oid AND p.ranking=1 AND p.probability > threshold\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        co.oid AS ztf_oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(co.meanra) AS mean_ra,\n        AVG(co.meandec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        input_objects io\n    JOIN\n        candidate_objects co ON\n        -- Use q3c_join for spatial matching within radius\n        q3c_join(co.meanra, co.meandec, io.ra, io.dec, io.radius_deg)\n    JOIN\n        detection d ON d.oid = co.oid\n    GROUP BY\n        io.identifier, io.ra, io.dec, io.radius_deg, co.oid\n)\nSELECT\n    input_id,\n    input_ra,\n    input_dec,\n    radius_deg,\n    ztf_oid,\n    detection_count,\n    mean_ra,\n    mean_dec,\n    first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    first_detection_mjd DESC;\n"
                },
                "in_toks": 2390,
                "out_toks": 457,
                "id": "chatcmpl-Bx08DFpj6hUIzk30woTVTDbP7kqZv",
                "created": 1753401557,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(o.meanra) AS mean_ra,\n        AVG(o.meandec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        input_objects io\n    JOIN\n        object o ON TRUE\n    JOIN\n        detection d ON d.oid = o.oid\n    WHERE\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    GROUP BY\n        io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    input_id,\n    input_ra,\n    input_dec,\n    radius_deg,\n    ztf_oid,\n    detection_count,\n    mean_ra,\n    mean_dec,\n    first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    first_detection_mjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(o.meanra) AS mean_ra,\n        AVG(o.meandec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        input_objects io\n    JOIN\n        object o ON TRUE\n    JOIN\n        detection d ON d.oid = o.oid\n    WHERE\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    GROUP BY\n        io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    input_id,\n    input_ra,\n    input_dec,\n    radius_deg,\n    ztf_oid,\n    detection_count,\n    mean_ra,\n    mean_dec,\n    first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    first_detection_mjd DESC;"
                },
                "in_toks": 3125,
                "out_toks": 334,
                "id": "chatcmpl-BwxFId9I1SFlBmxZMZOZgJHEvdnD4",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "57",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 728,
                "out_toks": 11,
                "id": "chatcmpl-BwvJmmwZEedDfLfIuSMEmgxJdIj9Q",
                "created": 1753383054,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define input objects with their coordinates and search radii in degrees\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\n-- Select objects from the object table that are within the specified radius of each input object\ncandidate_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd\n    FROM\n        input_objects io\n    -- Use q3c_join for efficient spherical distance filtering\n    JOIN\n        object o ON q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n),\n-- For each candidate object, find the minimal distance to the input object to confirm within radius\nmatched_objects AS (\n    SELECT\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.radius_deg\n    FROM\n        candidate_objects c\n    -- Filter to ensure the actual distance is within the specified radius\n    WHERE\n        -- Calculate the angular distance in arcseconds\n        q3c_dist(c.meanra, c.meandec, \n                 (SELECT ra FROM input_objects WHERE identifier = c.input_id),\n                 (SELECT dec FROM input_objects WHERE identifier = c.input_id)) <= c.radius_deg * 3600\n)\n-- Final selection with desired columns and sorting\nSELECT\n    o.oid AS ztf_object_id,\n    o.ndet AS number_of_detections,\n    o.meanra,\n    o.meandec,\n    o.firstmjd AS first_detection_date,\n    im.input_id AS input_object_id,\n    im.radius_deg AS search_radius_deg\nFROM\n    matched_objects o\nJOIN\n    input_objects im ON o.input_id = im.identifier\nORDER BY\n    o.firstmjd DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define input objects with their coordinates and search radii in degrees\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\n-- Select objects from the object table that are within the specified radius of each input object\ncandidate_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.radius_deg,\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd\n    FROM\n        input_objects io\n    -- Use q3c_join for efficient spherical distance filtering\n    JOIN\n        object o ON q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n),\n-- For each candidate object, find the minimal distance to the input object to confirm within radius\nmatched_objects AS (\n    SELECT\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.radius_deg\n    FROM\n        candidate_objects c\n    -- Filter to ensure the actual distance is within the specified radius\n    WHERE\n        -- Calculate the angular distance in arcseconds\n        q3c_dist(c.meanra, c.meandec, \n                 (SELECT ra FROM input_objects WHERE identifier = c.input_id),\n                 (SELECT dec FROM input_objects WHERE identifier = c.input_id)) <= c.radius_deg * 3600\n)\n-- Final selection with desired columns and sorting\nSELECT\n    o.oid AS ztf_object_id,\n    o.ndet AS number_of_detections,\n    o.meanra,\n    o.meandec,\n    o.firstmjd AS first_detection_date,\n    im.input_id AS input_object_id,\n    im.radius_deg AS search_radius_deg\nFROM\n    matched_objects o\nJOIN\n    input_objects im ON o.input_id = im.identifier\nORDER BY\n    o.firstmjd DESC;\n```"
                },
                "in_toks": 2296,
                "out_toks": 495,
                "id": "chatcmpl-Bx07x4l074apxwhY0wtSwYXiJiAcT",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    mo.oid AS ztf_object_id,\n    mo.ndet AS number_of_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_date,\n    io.identifier AS input_object_id,\n    io.radius_deg AS search_radius_deg\nFROM\n    matched_objects mo\nJOIN\n    input_objects io ON mo.input_id = io.identifier\nORDER BY\n    mo.firstmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    mo.oid AS ztf_object_id,\n    mo.ndet AS number_of_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_date,\n    io.identifier AS input_object_id,\n    io.radius_deg AS search_radius_deg\nFROM\n    matched_objects mo\nJOIN\n    input_objects io ON mo.input_id = io.identifier\nORDER BY\n    mo.firstmjd DESC;"
                },
                "in_toks": 3125,
                "out_toks": 289,
                "id": "chatcmpl-BwxFJbsFGtV3FvE3Xypo19Ww5I0OQ",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "57",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 728,
                "out_toks": 11,
                "id": "chatcmpl-BwvJndTvoGCFhy62ASyiqFEzBFoVO",
                "created": 1753383055,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query with nested subqueries to improve performance and ensure proper filtering\nWITH input_objects AS (\n    -- Define input objects with their coordinates and search radii in degrees\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\ncandidate_matches AS (\n    -- Find objects within the specified radius of each input object using q3c_join\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS ra_input,\n        io.dec AS dec_input,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n),\n-- Filter detections for matched objects, selecting the latest detection per object\nlatest_detections AS (\n    SELECT DISTINCT ON (d.oid)\n        d.oid,\n        d.mjd,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.candid\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM candidate_matches)\n    ORDER BY\n        d.oid,\n        d.mjd DESC -- latest detection per object\n)\n-- Final selection combining input object info with matched object stats and latest detection info\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    o.oid AS ztf_object_id,\n    o.ndet AS number_of_detections,\n    o.meanra,\n    o.meandec,\n    o.firstmjd AS first_detection_mjd,\n    ld.mjd AS last_detection_mjd\nFROM\n    candidate_matches o\nJOIN\n    object o ON o.oid = o.oid\nJOIN\n    input_objects io ON io.identifier = o.identifier\nLEFT JOIN\n    latest_detections ld ON ld.oid = o.oid\nORDER BY\n    ld.mjd DESC; -- sort by most recent detection date",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query with nested subqueries to improve performance and ensure proper filtering\nWITH input_objects AS (\n    -- Define input objects with their coordinates and search radii in degrees\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\ncandidate_matches AS (\n    -- Find objects within the specified radius of each input object using q3c_join\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS ra_input,\n        io.dec AS dec_input,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n),\n-- Filter detections for matched objects, selecting the latest detection per object\nlatest_detections AS (\n    SELECT DISTINCT ON (d.oid)\n        d.oid,\n        d.mjd,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.candid\n    FROM\n        detection d\n    WHERE\n        d.oid IN (SELECT oid FROM candidate_matches)\n    ORDER BY\n        d.oid,\n        d.mjd DESC -- latest detection per object\n)\n-- Final selection combining input object info with matched object stats and latest detection info\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    o.oid AS ztf_object_id,\n    o.ndet AS number_of_detections,\n    o.meanra,\n    o.meandec,\n    o.firstmjd AS first_detection_mjd,\n    ld.mjd AS last_detection_mjd\nFROM\n    candidate_matches o\nJOIN\n    object o ON o.oid = o.oid\nJOIN\n    input_objects io ON io.identifier = o.identifier\nLEFT JOIN\n    latest_detections ld ON ld.oid = o.oid\nORDER BY\n    ld.mjd DESC; -- sort by most recent detection date"
                },
                "in_toks": 2386,
                "out_toks": 541,
                "id": "chatcmpl-Bx08xz4r86GKSMurdLiefwPsM7kfm",
                "created": 1753401603,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS ra_input,\n        io.dec AS dec_input,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM\n    matched_objects m\nJOIN\n    object o\nON\n    m.oid = o.oid\nJOIN\n    input_objects io\nON\n    io.identifier = m.identifier\nORDER BY\n    m.firstmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS ra_input,\n        io.dec AS dec_input,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM\n    matched_objects m\nJOIN\n    object o\nON\n    m.oid = o.oid\nJOIN\n    input_objects io\nON\n    io.identifier = m.identifier\nORDER BY\n    m.firstmjd DESC;"
                },
                "in_toks": 3125,
                "out_toks": 338,
                "id": "chatcmpl-BwxFIIt3sY09gf8yVMy6lqzAfPfiV",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "57",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 728,
                "out_toks": 11,
                "id": "chatcmpl-BwvJnN3i7p9U2vnJ3Q89A4eNvFxN6",
                "created": 1753383055,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query with nested subqueries and explicit join conditions to improve performance\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\n-- Find objects within the specified radius of each input object using q3c_join\ncandidate_matches AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n),\n-- For each candidate object, select the closest match within the radius\nmatched_objects AS (\n    SELECT DISTINCT ON (cm.oid)\n        cm.oid,\n        cm.ndet,\n        cm.meanra,\n        cm.meandec,\n        cm.firstmjd,\n        cm.identifier,\n        cm.input_ra,\n        cm.input_dec,\n        cm.radius_deg\n    FROM\n        candidate_matches cm\n    JOIN\n        object o2 ON cm.oid = o2.oid\n    WHERE\n        -- Ensure the distance is within the specified radius\n        q3c_distance(cm.input_ra, cm.input_dec, o2.meanra, o2.meandec) <= cm.radius_deg\n    ORDER BY\n        cm.oid,\n        q3c_distance(cm.input_ra, cm.input_dec, o2.meanra, o2.meandec) -- pick the closest object\n)\n-- Final selection with required columns and sorting\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM\n    matched_objects m\nJOIN\n    input_objects io ON io.identifier = m.identifier\nORDER BY\n    m.firstmjd DESC;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query with nested subqueries and explicit join conditions to improve performance\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\n-- Find objects within the specified radius of each input object using q3c_join\ncandidate_matches AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n),\n-- For each candidate object, select the closest match within the radius\nmatched_objects AS (\n    SELECT DISTINCT ON (cm.oid)\n        cm.oid,\n        cm.ndet,\n        cm.meanra,\n        cm.meandec,\n        cm.firstmjd,\n        cm.identifier,\n        cm.input_ra,\n        cm.input_dec,\n        cm.radius_deg\n    FROM\n        candidate_matches cm\n    JOIN\n        object o2 ON cm.oid = o2.oid\n    WHERE\n        -- Ensure the distance is within the specified radius\n        q3c_distance(cm.input_ra, cm.input_dec, o2.meanra, o2.meandec) <= cm.radius_deg\n    ORDER BY\n        cm.oid,\n        q3c_distance(cm.input_ra, cm.input_dec, o2.meanra, o2.meandec) -- pick the closest object\n)\n-- Final selection with required columns and sorting\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM\n    matched_objects m\nJOIN\n    input_objects io ON io.identifier = m.identifier\nORDER BY\n    m.firstmjd DESC;\n"
                },
                "in_toks": 2380,
                "out_toks": 543,
                "id": "chatcmpl-Bx07xwR8WLojut2KylZuXgDru6Pzc",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM\n    matched_objects m\nJOIN\n    object o ON m.oid = o.oid\nJOIN\n    input_objects io ON io.identifier = m.identifier\nORDER BY\n    m.firstmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM\n    matched_objects m\nJOIN\n    object o ON m.oid = o.oid\nJOIN\n    input_objects io ON io.identifier = m.identifier\nORDER BY\n    m.firstmjd DESC;"
                },
                "in_toks": 3125,
                "out_toks": 332,
                "id": "chatcmpl-BwxFIEpQ4Nn1sFsYbK0dFtaKYR5qB",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "57",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 728,
                "out_toks": 11,
                "id": "chatcmpl-BwvJowrJx9LIwGOnvjPUXx76Ch7UA",
                "created": 1753383056,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query with explicit conditions, nested subqueries, and proper schema usage\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\n-- Find objects within the specified radius of each input object using q3c_join\ncandidate_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        -- Use q3c_join to find objects within the radius\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    -- Optional: Add a filter to limit the search to recent observations or specific conditions if needed\n),\n-- For each candidate object, compute the first detection date from detection table\ndetection_info AS (\n    SELECT\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.radius_deg,\n        -- Get the earliest detection date for the object\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        candidate_objects c\n    LEFT JOIN\n        detection d\n    ON\n        d.oid = c.oid\n    GROUP BY\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.radius_deg\n)\n-- Select and order the final output\nSELECT\n    d.oid AS ztf_id,\n    d.ndet AS num_detections,\n    d.meanra,\n    d.meandec,\n    d.first_detection_mjd\nFROM\n    detection_info d\nORDER BY\n    d.first_detection_mjd DESC;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query with explicit conditions, nested subqueries, and proper schema usage\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\n-- Find objects within the specified radius of each input object using q3c_join\ncandidate_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        -- Use q3c_join to find objects within the radius\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    -- Optional: Add a filter to limit the search to recent observations or specific conditions if needed\n),\n-- For each candidate object, compute the first detection date from detection table\ndetection_info AS (\n    SELECT\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.radius_deg,\n        -- Get the earliest detection date for the object\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        candidate_objects c\n    LEFT JOIN\n        detection d\n    ON\n        d.oid = c.oid\n    GROUP BY\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.radius_deg\n)\n-- Select and order the final output\nSELECT\n    d.oid AS ztf_id,\n    d.ndet AS num_detections,\n    d.meanra,\n    d.meandec,\n    d.first_detection_mjd\nFROM\n    detection_info d\nORDER BY\n    d.first_detection_mjd DESC;\n"
                },
                "in_toks": 2234,
                "out_toks": 485,
                "id": "chatcmpl-Bx089v4UR5RHAPaBsoRReZQgHIuIr",
                "created": 1753401553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    mo.oid AS ztf_id,\n    mo.ndet AS num_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_mjd\nFROM\n    matched_objects mo\nORDER BY\n    mo.firstmjd DESC;\n",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n)\nSELECT\n    mo.oid AS ztf_id,\n    mo.ndet AS num_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_mjd\nFROM\n    matched_objects mo\nORDER BY\n    mo.firstmjd DESC;\n"
                },
                "in_toks": 3125,
                "out_toks": 257,
                "id": "chatcmpl-BwxFJGgtps1AqkuOQcABqVHgnCbm5",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "57",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 728,
                "out_toks": 11,
                "id": "chatcmpl-BwvJpseT1MoyOtZOW5Qz0Or0clTiR",
                "created": 1753383057,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected and optimized query with nested subqueries to improve performance and avoid timeout\nWITH input_objects AS (\n    -- Define the input objects with their coordinates and search radii in degrees\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600 -- 20 arcsec in degrees\n),\ncandidate_objects AS (\n    -- Find objects within the specified radius of each input object\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM object o\n    JOIN input_objects io ON (\n        -- Use q3c_join for efficient spherical distance filtering\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    )\n),\n-- For each candidate object, find the closest match to the input object within the radius\nmatched_objects AS (\n    SELECT\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.input_ra,\n        c.input_dec,\n        c.radius_deg,\n        -- Find the minimal distance to the input object within the radius\n        (SELECT MIN(dist) FROM xmatch xm WHERE xm.oid = c.oid AND xm.dist <= c.radius_deg * 3600) AS min_dist\n    FROM candidate_objects c\n),\n-- Filter to keep only the closest matches within the radius\nclosest_matches AS (\n    SELECT\n        m.*\n    FROM matched_objects m\n    WHERE\n        -- Ensure the match is the closest for the object\n        (SELECT MIN(dist) FROM xmatch xm WHERE xm.oid = m.oid) = m.min_dist\n        AND m.min_dist IS NOT NULL\n)\n-- Final selection with object info and detection details\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    o.oid AS ztf_object_id,\n    o.ndet AS number_of_detections,\n    o.meanra,\n    o.meandec,\n    o.firstmjd AS first_detection_mjd\nFROM closest_matches o\nJOIN input_objects io ON o.input_id = io.identifier\nORDER BY o.firstmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected and optimized query with nested subqueries to improve performance and avoid timeout\nWITH input_objects AS (\n    -- Define the input objects with their coordinates and search radii in degrees\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600 -- 20 arcsec in degrees\n),\ncandidate_objects AS (\n    -- Find objects within the specified radius of each input object\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM object o\n    JOIN input_objects io ON (\n        -- Use q3c_join for efficient spherical distance filtering\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    )\n),\n-- For each candidate object, find the closest match to the input object within the radius\nmatched_objects AS (\n    SELECT\n        c.oid,\n        c.ndet,\n        c.meanra,\n        c.meandec,\n        c.firstmjd,\n        c.input_id,\n        c.input_ra,\n        c.input_dec,\n        c.radius_deg,\n        -- Find the minimal distance to the input object within the radius\n        (SELECT MIN(dist) FROM xmatch xm WHERE xm.oid = c.oid AND xm.dist <= c.radius_deg * 3600) AS min_dist\n    FROM candidate_objects c\n),\n-- Filter to keep only the closest matches within the radius\nclosest_matches AS (\n    SELECT\n        m.*\n    FROM matched_objects m\n    WHERE\n        -- Ensure the match is the closest for the object\n        (SELECT MIN(dist) FROM xmatch xm WHERE xm.oid = m.oid) = m.min_dist\n        AND m.min_dist IS NOT NULL\n)\n-- Final selection with object info and detection details\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    o.oid AS ztf_object_id,\n    o.ndet AS number_of_detections,\n    o.meanra,\n    o.meandec,\n    o.firstmjd AS first_detection_mjd\nFROM closest_matches o\nJOIN input_objects io ON o.input_id = io.identifier\nORDER BY o.firstmjd DESC;"
                },
                "in_toks": 2319,
                "out_toks": 563,
                "id": "chatcmpl-Bx081cBX13j20D5X6UbtRnosSabsz",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM object o\n    JOIN input_objects io ON (\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    )\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM matched_objects m\nJOIN input_objects io ON m.input_id = io.identifier\nORDER BY m.firstmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg\n    FROM object o\n    JOIN input_objects io ON (\n        q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg)\n    )\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    m.oid AS ztf_object_id,\n    m.ndet AS number_of_detections,\n    m.meanra,\n    m.meandec,\n    m.firstmjd AS first_detection_mjd\nFROM matched_objects m\nJOIN input_objects io ON m.input_id = io.identifier\nORDER BY m.firstmjd DESC;"
                },
                "in_toks": 3125,
                "out_toks": 290,
                "id": "chatcmpl-BwxFETwcMgilFQZ5nt5ZxQCvaRONl",
                "created": 1753390460,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "57",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 728,
                "out_toks": 11,
                "id": "chatcmpl-BwvJpY8GPVfx4uEJibwTaKdYr4yKS",
                "created": 1753383057,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Define input objects with their coordinates and search radii in degrees\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\n-- Find objects in the 'object' table that are within the specified radius of each input object\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        -- Use q3c_join to find objects within the specified radius for each input object\n        (io.identifier = 'id_1' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n        OR\n        (io.identifier = 'id_2' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n)\n-- Select desired columns, including input object info and matched object info\nSELECT\n    -- Input object details\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    -- Matched ZTF object details\n    mo.oid AS ztf_object_id,\n    mo.ndet AS number_of_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_mjd\nFROM\n    matched_objects mo\nJOIN\n    input_objects io ON mo.input_id = io.identifier\n-- Order results by the most recent detection date\nORDER BY\n    mo.firstmjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "-- Define input objects with their coordinates and search radii in degrees\nWITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\n-- Find objects in the 'object' table that are within the specified radius of each input object\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        -- Use q3c_join to find objects within the specified radius for each input object\n        (io.identifier = 'id_1' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n        OR\n        (io.identifier = 'id_2' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n)\n-- Select desired columns, including input object info and matched object info\nSELECT\n    -- Input object details\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    -- Matched ZTF object details\n    mo.oid AS ztf_object_id,\n    mo.ndet AS number_of_detections,\n    mo.meanra,\n    mo.meandec,\n    mo.firstmjd AS first_detection_mjd\nFROM\n    matched_objects mo\nJOIN\n    input_objects io ON mo.input_id = io.identifier\n-- Order results by the most recent detection date\nORDER BY\n    mo.firstmjd DESC;"
                },
                "in_toks": 2446,
                "out_toks": 447,
                "id": "chatcmpl-Bx08Dj7Q7Two6PZGcx5N8FSoRbnOt",
                "created": 1753401557,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        (io.identifier = 'id_1' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n        OR\n        (io.identifier = 'id_2' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n)\nSELECT\n    -- Input object info\n    input_id AS input_object_id,\n    ra AS input_object_ra,\n    dec AS input_object_dec,\n    radius_deg AS search_radius_deg,\n    -- ZTF object info\n    oid AS ztf_object_id,\n    ndet AS number_of_detections,\n    meanra,\n    meandec,\n    firstmjd AS first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    firstmjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.meanra,\n        o.meandec,\n        o.firstmjd,\n        io.identifier AS input_id,\n        io.radius_deg\n    FROM\n        object o\n    JOIN\n        input_objects io\n    ON\n        (io.identifier = 'id_1' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n        OR\n        (io.identifier = 'id_2' AND q3c_join(o.meanra, o.meandec, io.ra, io.dec, io.radius_deg))\n)\nSELECT\n    -- Input object info\n    input_id AS input_object_id,\n    ra AS input_object_ra,\n    dec AS input_object_dec,\n    radius_deg AS search_radius_deg,\n    -- ZTF object info\n    oid AS ztf_object_id,\n    ndet AS number_of_detections,\n    meanra,\n    meandec,\n    firstmjd AS first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    firstmjd DESC;"
                },
                "in_toks": 3125,
                "out_toks": 341,
                "id": "chatcmpl-BwxFNKG6RV1umfNdKAIbVQ2MUSarw",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "57",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 728,
                "out_toks": 11,
                "id": "chatcmpl-BwvJqOHWnblOs11OUXSUFtuzqTa02",
                "created": 1753383058,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS num_detections,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd\n    FROM input_objects io\n    JOIN object o ON (\n        q3c_join(io.ra, io.dec, o.meanra, o.meandec, io.radius_deg)\n    )\n    LEFT JOIN detection d ON d.oid = o.oid\n    GROUP BY io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    mo.ztf_oid AS ztf_object_id,\n    mo.num_detections,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM input_objects io\nJOIN matched_objects mo ON io.identifier = mo.input_id\nORDER BY mo.last_detection_mjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0 / 3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0 / 3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS num_detections,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd\n    FROM input_objects io\n    JOIN object o ON (\n        q3c_join(io.ra, io.dec, o.meanra, o.meandec, io.radius_deg)\n    )\n    LEFT JOIN detection d ON d.oid = o.oid\n    GROUP BY io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    mo.ztf_oid AS ztf_object_id,\n    mo.num_detections,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM input_objects io\nJOIN matched_objects mo ON io.identifier = mo.input_id\nORDER BY mo.last_detection_mjd DESC;"
                },
                "in_toks": 3125,
                "out_toks": 354,
                "id": "chatcmpl-BwxFGK5RhXdHWkfjIuuxD1hEkNJtI",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "57",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 728,
                "out_toks": 11,
                "id": "chatcmpl-BwvJqzQoMFLTDpPVVpxflzxH6dBBt",
                "created": 1753383058,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0/3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0/3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS object_id\n    FROM input_objects io\n    -- Use q3c_join to find objects within the specified radius\n    WHERE EXISTS (\n        SELECT 1\n        FROM object o\n        WHERE q3c_join(io.ra, io.dec, o.meanra, o.meandec, io.radius_deg)\n    )\n),\nztf_objects AS (\n    SELECT\n        mo.object_id,\n        COUNT(d.candid) AS num_detections,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd\n    FROM matched_objects mo\n    JOIN detection d ON d.oid = mo.object_id\n    GROUP BY mo.object_id\n)\nSELECT\n    mo.object_id AS ztf_id,\n    mo.num_detections,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM ztf_objects mo\nORDER BY mo.last_detection_mjd DESC;\n",
            "sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0/3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0/3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS object_id\n    FROM input_objects io\n    -- Use q3c_join to find objects within the specified radius\n    WHERE EXISTS (\n        SELECT 1\n        FROM object o\n        WHERE q3c_join(io.ra, io.dec, o.meanra, o.meandec, io.radius_deg)\n    )\n),\nztf_objects AS (\n    SELECT\n        mo.object_id,\n        COUNT(d.candid) AS num_detections,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd\n    FROM matched_objects mo\n    JOIN detection d ON d.oid = mo.object_id\n    GROUP BY mo.object_id\n)\nSELECT\n    mo.object_id AS ztf_id,\n    mo.num_detections,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM ztf_objects mo\nORDER BY mo.last_detection_mjd DESC;\n"
                },
                "in_toks": 2350,
                "out_toks": 334,
                "id": "chatcmpl-Bx087yYqJxbNaRvXoi3xtw6Or2yMD",
                "created": 1753401551,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0/3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0/3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS object_id\n    FROM input_objects io\n    WHERE EXISTS (\n        SELECT 1\n        FROM object o\n        WHERE q3c_join(io.ra, io.dec, o.meanra, o.meandec, io.radius_deg)\n    )\n),\nztf_objects AS (\n    SELECT\n        mo.object_id,\n        COUNT(d.candid) AS num_detections,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd\n    FROM matched_objects mo\n    JOIN detection d ON d.oid = mo.object_id\n    GROUP BY mo.object_id\n)\nSELECT\n    mo.object_id AS ztf_id,\n    mo.num_detections,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM ztf_objects mo\nORDER BY mo.last_detection_mjd DESC;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30.0/3600 AS radius_deg -- 30 arcsec in degrees\n    UNION ALL\n    SELECT 'id_2', 20.7993, 1.00331, 20.0/3600 -- 20 arcsec in degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS object_id\n    FROM input_objects io\n    WHERE EXISTS (\n        SELECT 1\n        FROM object o\n        WHERE q3c_join(io.ra, io.dec, o.meanra, o.meandec, io.radius_deg)\n    )\n),\nztf_objects AS (\n    SELECT\n        mo.object_id,\n        COUNT(d.candid) AS num_detections,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd,\n        MAX(d.mjd) AS last_detection_mjd\n    FROM matched_objects mo\n    JOIN detection d ON d.oid = mo.object_id\n    GROUP BY mo.object_id\n)\nSELECT\n    mo.object_id AS ztf_id,\n    mo.num_detections,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM ztf_objects mo\nORDER BY mo.last_detection_mjd DESC;"
                },
                "in_toks": 3125,
                "out_toks": 319,
                "id": "chatcmpl-BwxFOHa7cuwlmBGljeVuHmKYsaxLF",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "75": {
        "0": {
            "req_id": "75",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-BjAcpoX6KBj2s5Pe62SnDhBvljTGc",
                "created": 1750105303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 24,
                "id": "chatcmpl-BwxFQd2mkF2IWiqjsTR48ZR53A7Bz",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "75",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-BjAcpoX6KBj2s5Pe62SnDhBvljTGc",
                "created": 1750105303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 24,
                "id": "chatcmpl-BwxFLj6NPabBtvNSR3rackSoxxD0i",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "75",
            "experiment_id": "run_2",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 609,
                "out_toks": 6,
                "id": "chatcmpl-BwvJrIBeCr5i5FhH3h1pc3BxYAtQe",
                "created": 1753383059,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 24,
                "id": "chatcmpl-BwxFL38r0JWC9dKPccNYny3a2CDoG",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "75",
            "experiment_id": "run_3",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 609,
                "out_toks": 6,
                "id": "chatcmpl-BwvJrt5ZNbPJfxFfCFJbEUQbHiMZj",
                "created": 1753383059,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 24,
                "id": "chatcmpl-BwxFMOBKl7ha0B97Q9UMn6VTDBVc7",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "75",
            "experiment_id": "run_4",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 609,
                "out_toks": 6,
                "id": "chatcmpl-BwvJsTLr5JJiBt2m2mgcBcyj8dMQy",
                "created": 1753383060,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 24,
                "id": "chatcmpl-BwxFOsZIpFHQ9c7LnPum4HpqovZXG",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "75",
            "experiment_id": "run_5",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 609,
                "out_toks": 6,
                "id": "chatcmpl-BwvJsl7HBIHWNkDkEWR3vUBUdcHVy",
                "created": 1753383060,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM ss_ztf \nWHERE ssnamenr IS NOT NULL \nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM ss_ztf \nWHERE ssnamenr IS NOT NULL \nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 25,
                "id": "chatcmpl-BwxFFRVBQqE2ZGByiyRBWPhM2Jm80",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "75",
            "experiment_id": "run_6",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 609,
                "out_toks": 6,
                "id": "chatcmpl-BwvJtwlbacT29tLPsTZaK4lKlzUl7",
                "created": 1753383061,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 24,
                "id": "chatcmpl-BwxFIE5wTFPrIa3tHBLrWSup6mfaK",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "75",
            "experiment_id": "run_7",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 609,
                "out_toks": 6,
                "id": "chatcmpl-BwvJxNHz8h5QT6K3gaA4aSwjqSMaw",
                "created": 1753383065,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 24,
                "id": "chatcmpl-BwxFHKokuGYgmvSiK19oG4LOIkQxc",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "75",
            "experiment_id": "run_8",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 609,
                "out_toks": 6,
                "id": "chatcmpl-BwvJx6RgLyPjXGIWqIJIEkAYXZgEg",
                "created": 1753383065,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 24,
                "id": "chatcmpl-BwxFJwIo2r8dRHisJFgq4Iwg2Ig7C",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "75",
            "experiment_id": "run_9",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']"
                },
                "in_toks": 609,
                "out_toks": 6,
                "id": "chatcmpl-BwvJzbHtkdOY4myg1aD102Q3LI7bI",
                "created": 1753383067,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2025,
                "out_toks": 24,
                "id": "chatcmpl-BwxFJ3uLcAgG4wfABiYmHvgX9rguE",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "43": {
        "0": {
            "req_id": "43",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 799,
                "out_toks": 14,
                "id": "chatcmpl-BjAcq7AXvqb28MUct6o0YvBDB05R5",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2; -- 2 corresponds to the r-band\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2; -- 2 corresponds to the r-band\n```"
                },
                "in_toks": 3179,
                "out_toks": 93,
                "id": "chatcmpl-BwxFLdo6WiLL12MbemUFZJz3FsTKt",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "43",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 799,
                "out_toks": 14,
                "id": "chatcmpl-BjAcq7AXvqb28MUct6o0YvBDB05R5",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2; -- 2 corresponds to the r-band\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2; -- 2 corresponds to the r-band\n```"
                },
                "in_toks": 3179,
                "out_toks": 93,
                "id": "chatcmpl-BwxFN4gNeQZPJb93DOT143GPUGbMR",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "43",
            "experiment_id": "run_2",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 646,
                "out_toks": 4,
                "id": "chatcmpl-BwvJz9Gnexz1SVaqApzq9tsSdpgHa",
                "created": 1753383067,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```"
                },
                "in_toks": 2697,
                "out_toks": 86,
                "id": "chatcmpl-BwxFFOB4jpdLrc1FK7MD3DTviRLgu",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "43",
            "experiment_id": "run_3",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 646,
                "out_toks": 4,
                "id": "chatcmpl-BwvK00427EP67VILNWZUnwk7porXS",
                "created": 1753383068,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant columns for specified objects and r-band filter\nSELECT \n    dq.oid AS ztf_identifier,\n    dq.candid AS candidate_id,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr AS peak_pixel_snr\nFROM \n    dataquality dq\nWHERE \n    dq.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND dq.fid = 2; -- 2 corresponds to the r-band filter\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for specified objects and r-band filter\nSELECT \n    dq.oid AS ztf_identifier,\n    dq.candid AS candidate_id,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr AS peak_pixel_snr\nFROM \n    dataquality dq\nWHERE \n    dq.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND dq.fid = 2; -- 2 corresponds to the r-band filter\n```"
                },
                "in_toks": 2697,
                "out_toks": 106,
                "id": "chatcmpl-BwxFH5LnmAClbZsHIML3dxcsHbTho",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "43",
            "experiment_id": "run_4",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 646,
                "out_toks": 4,
                "id": "chatcmpl-BwvK0TBDszqnVAksiBbhIpgStai6O",
                "created": 1753383068,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant columns for specified objects and r-band filter\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2; -- r-band filter\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for specified objects and r-band filter\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2; -- r-band filter\n```"
                },
                "in_toks": 2697,
                "out_toks": 87,
                "id": "chatcmpl-BwxFIRUL9eTvfKVuUYJGKCovDVq3e",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "43",
            "experiment_id": "run_5",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 646,
                "out_toks": 4,
                "id": "chatcmpl-BwvK0aFpl6BlatAWzsSBBlHEwk8xz",
                "created": 1753383068,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    dq.oid AS ztf_identifier,\n    dq.candid AS candidate_id,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr AS peak_pixel_snr\nFROM \n    dataquality dq\nWHERE \n    dq.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND dq.fid = 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    dq.oid AS ztf_identifier,\n    dq.candid AS candidate_id,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr AS peak_pixel_snr\nFROM \n    dataquality dq\nWHERE \n    dq.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND dq.fid = 2;\n```"
                },
                "in_toks": 2697,
                "out_toks": 100,
                "id": "chatcmpl-BwxFKJopAfXyJXjBxVtoK5WZTGwNv",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "43",
            "experiment_id": "run_6",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 646,
                "out_toks": 4,
                "id": "chatcmpl-BwvK1Yv4SJOYcLwiA3qcXrz0WNFWR",
                "created": 1753383069,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant columns for specified objects and r-band filter\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2; -- 2 corresponds to the r-band filter\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for specified objects and r-band filter\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2; -- 2 corresponds to the r-band filter\n```"
                },
                "in_toks": 2697,
                "out_toks": 106,
                "id": "chatcmpl-BwxFFzS9MqSnfgrq9Rc9wldBGxkQv",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "43",
            "experiment_id": "run_7",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 646,
                "out_toks": 4,
                "id": "chatcmpl-BwvK1d64fS3SCGs3v2UBlehoVA8tu",
                "created": 1753383069,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```"
                },
                "in_toks": 2697,
                "out_toks": 86,
                "id": "chatcmpl-BwxFFjYeLpA4p1EIP9pKBQ65vCFMF",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "43",
            "experiment_id": "run_8",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 646,
                "out_toks": 4,
                "id": "chatcmpl-BwvK2ryi0S8lp7iee7Hd2bng4BcyJ",
                "created": 1753383070,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```"
                },
                "in_toks": 2697,
                "out_toks": 86,
                "id": "chatcmpl-BwxFMQyziSX8KvshjoXcAYFUnnDrF",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "43",
            "experiment_id": "run_9",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 646,
                "out_toks": 4,
                "id": "chatcmpl-BwvK2g1ZRB3eFAmWSGRCiI5C2FvwZ",
                "created": 1753383070,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    oid AS ztf_identifier,\n    candid AS candidate_id,\n    xpos,\n    ypos,\n    scorr AS peak_pixel_snr\nFROM \n    dataquality\nWHERE \n    oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND fid = 2;\n```"
                },
                "in_toks": 2697,
                "out_toks": 86,
                "id": "chatcmpl-BwxFNj4N1uS1iyA2fu3X3oH3MGtw4",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "89": {
        "0": {
            "req_id": "89",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'dataquality']",
                    "1": "['object', 'probability', 'dataquality']"
                },
                "in_toks": 778,
                "out_toks": 22,
                "id": "chatcmpl-BjAcqQ5GjA6PXLIOV4QT4rIaNamFv",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 50 objects with probability > 0.7 of being SN, using nested queries for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON p.oid = o.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- ensure selecting the most probable classification\n    LIMIT 50\n)\n-- Retrieve all data quality entries for these selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 50 objects with probability > 0.7 of being SN, using nested queries for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON p.oid = o.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- ensure selecting the most probable classification\n    LIMIT 50\n)\n-- Retrieve all data quality entries for these selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 2113,
                "out_toks": 142,
                "id": "chatcmpl-Bx0922TrXnttRcXIB7puLqdHWVjhj",
                "created": 1753401608,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.7\n    )\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.7\n    )\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3342,
                "out_toks": 104,
                "id": "chatcmpl-BwxFIMyfFU1j3RyCpXHYCTTjnW07D",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "89",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'dataquality']",
                    "1": "['object', 'probability', 'dataquality']"
                },
                "in_toks": 778,
                "out_toks": 22,
                "id": "chatcmpl-BjAcqQ5GjA6PXLIOV4QT4rIaNamFv",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve OIDs of objects with probability > 0.7 of being supernovae ('SN') in the stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Select all columns from dataquality for the identified objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve OIDs of objects with probability > 0.7 of being supernovae ('SN') in the stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Select all columns from dataquality for the identified objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3342,
                "out_toks": 117,
                "id": "chatcmpl-BwxFMJas5n4CbCoGU9GJeE3LwyPU5",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "89",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 625,
                "out_toks": 14,
                "id": "chatcmpl-BwvK3uxVwOKKzJKubIeZmzmRxJTpy",
                "created": 1753383071,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3387,
                "out_toks": 120,
                "id": "chatcmpl-BwxFMp5DvxaJ5SAEhBLYlVPBeTgPp",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "89",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 625,
                "out_toks": 14,
                "id": "chatcmpl-BwvK3KXzAL5kVliZH379jP9kDTFOM",
                "created": 1753383071,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3387,
                "out_toks": 119,
                "id": "chatcmpl-BwxFFl4MWFamAYICMDgnEKcliNdoS",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "89",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 625,
                "out_toks": 14,
                "id": "chatcmpl-BwvK4wAqCl5YxDDZIkdZeADIFQYxu",
                "created": 1753383072,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select OIDs of objects with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select OIDs of objects with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3387,
                "out_toks": 122,
                "id": "chatcmpl-BwxFNMVK6uSYZyBEwRil8gQScbp1C",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "89",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'dataquality']"
                },
                "in_toks": 625,
                "out_toks": 11,
                "id": "chatcmpl-BwvK4mCfgYhb3v8l0mOQz8kDMuQ6g",
                "created": 1753383072,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 50 objects with probability > 0.7 of being supernovae, using nested queries for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON p.oid = o.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- ensure selecting the most probable classification\n    LIMIT 50\n)\n-- Retrieve all data quality entries for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 50 objects with probability > 0.7 of being supernovae, using nested queries for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON p.oid = o.oid\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n      AND p.ranking = 1 -- ensure selecting the most probable classification\n    LIMIT 50\n)\n-- Retrieve all data quality entries for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 2113,
                "out_toks": 144,
                "id": "chatcmpl-Bx07xIwjuM27pBWvidvn1Nhy3NnkR",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.7\n    )\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.7\n    )\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3342,
                "out_toks": 104,
                "id": "chatcmpl-BwxFFTCaz7bLRFzrv0UolbRnVuOLY",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "89",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 625,
                "out_toks": 14,
                "id": "chatcmpl-BwvK52MdTsdmJiD3gXlfOPTligaWU",
                "created": 1753383073,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select OIDs of objects with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select OIDs of objects with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3387,
                "out_toks": 122,
                "id": "chatcmpl-BwxFFMdlufewxZDy3AaWn6mTVjzy1",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "89",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 625,
                "out_toks": 14,
                "id": "chatcmpl-BwvK5fvnOoDsJx5FHezSOju8qSDEq",
                "created": 1753383073,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3387,
                "out_toks": 119,
                "id": "chatcmpl-BwxFFTNvmS29BxZnxsIM9BabEuIXS",
                "created": 1753390461,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "89",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 625,
                "out_toks": 14,
                "id": "chatcmpl-BwvK6bsny7tH40qexx2wfoJnxC6AK",
                "created": 1753383074,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3387,
                "out_toks": 119,
                "id": "chatcmpl-BwxFHKPycydh671azgZQQzYzWdYp8",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "89",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "taxonomy",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'taxonomy', 'dataquality']"
                },
                "in_toks": 625,
                "out_toks": 14,
                "id": "chatcmpl-BwvK7p9ljaD1tHnQX5fipAojAH1cy",
                "created": 1753383075,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to select object IDs with probability > 0.7 of being supernovae ('SN') in stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    LIMIT 50\n)\n-- Main query to retrieve all columns from dataquality for the selected objects\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3387,
                "out_toks": 119,
                "id": "chatcmpl-BwxFHPLxj5viP2VsPpXqJmTPrmi1m",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "72": {
        "0": {
            "req_id": "72",
            "experiment_id": "run_0",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']",
                    "1": "['reference']"
                },
                "in_toks": 767,
                "out_toks": 6,
                "id": "chatcmpl-BjAcqrmHAuqrF8YXj3EitkMwRHssr",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFJE18W7QeVVP9FaMge87EmkLFc",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "72",
            "experiment_id": "run_1",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']",
                    "1": "['reference']"
                },
                "in_toks": 767,
                "out_toks": 6,
                "id": "chatcmpl-BjAcqrmHAuqrF8YXj3EitkMwRHssr",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFIYol0C9rO6mbXqfdr1H2wf9Yt",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "72",
            "experiment_id": "run_2",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"reference\"]"
                },
                "in_toks": 614,
                "out_toks": 3,
                "id": "chatcmpl-BwvK7zZEb2sMOcQ16cH0H2GIfMUVX",
                "created": 1753383075,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFKtuxxloH5roVN5laCc5uo6nIp",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "72",
            "experiment_id": "run_3",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"reference\"]"
                },
                "in_toks": 614,
                "out_toks": 3,
                "id": "chatcmpl-BwvK8vrEhkcfVeiyHdacuktjMphLa",
                "created": 1753383076,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFJdBpfyzOXWUcTqka1tS3d3KT9",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "72",
            "experiment_id": "run_4",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"reference\"]"
                },
                "in_toks": 614,
                "out_toks": 3,
                "id": "chatcmpl-BwvK9buqMrAujeZZ3ZILLS23o7gd8",
                "created": 1753383077,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFMEzy0MQp0TK7HnHKg2QwAb4aV",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "72",
            "experiment_id": "run_5",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"reference\"]"
                },
                "in_toks": 614,
                "out_toks": 3,
                "id": "chatcmpl-BwvK9RLKTxPO6D3XNjqEiOBDTtb3M",
                "created": 1753383077,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFN4WUoqMBeF2VO0Lmv0pPqK8fn",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "72",
            "experiment_id": "run_6",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"reference\"]"
                },
                "in_toks": 614,
                "out_toks": 3,
                "id": "chatcmpl-BwvKA42hx6H3uuUWNMTbYv2W4S9EG",
                "created": 1753383078,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFNqdzvj2ig8iNQuC9DEcIFmM2B",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "72",
            "experiment_id": "run_7",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"reference\"]"
                },
                "in_toks": 614,
                "out_toks": 3,
                "id": "chatcmpl-BwvKAzawCD1xMYr2NeJh8mJei7sll",
                "created": 1753383078,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFN7TCedcqfVcj4mqM7h7WOqnez",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "72",
            "experiment_id": "run_8",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"reference\"]"
                },
                "in_toks": 614,
                "out_toks": 3,
                "id": "chatcmpl-BwvKBT5U6VSK90q6bECrfwNtGMMsa",
                "created": 1753383079,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFNpXZzBpjvPx6vh8KxJZLqQQu4",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "72",
            "experiment_id": "run_9",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"reference\"]"
                },
                "in_toks": 614,
                "out_toks": 3,
                "id": "chatcmpl-BwvKBL7xu3NtNRd61AjTRt3Sll9za",
                "created": 1753383079,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2234,
                "out_toks": 30,
                "id": "chatcmpl-BwxFMyQxpUa8w3wSOp1nMmtNfOF9C",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "103": {
        "0": {
            "req_id": "103",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 829,
                "out_toks": 28,
                "id": "chatcmpl-BjAcrPfFYQ3d5CXdQeaagoDeEdiTF",
                "created": 1750105305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n    ORDER BY p.distpsnr1\n)\nSELECT o.*, p.*, ps.*\nFROM filtered_objects o\nJOIN probabilities p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE ps.distpsnr1 = (\n    SELECT MIN(distpsnr1)\n    FROM ps1_ztf\n    WHERE oid = o.oid\n)\nORDER BY ps.distpsnr1\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n    ORDER BY p.distpsnr1\n)\nSELECT o.*, p.*, ps.*\nFROM filtered_objects o\nJOIN probabilities p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE ps.distpsnr1 = (\n    SELECT MIN(distpsnr1)\n    FROM ps1_ztf\n    WHERE oid = o.oid\n)\nORDER BY ps.distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3348,
                "out_toks": 253,
                "id": "chatcmpl-BwxFKZv47d2CcpWySVuSc3qj3GuqE",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "103",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 829,
                "out_toks": 28,
                "id": "chatcmpl-BjAcrPfFYQ3d5CXdQeaagoDeEdiTF",
                "created": 1750105305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n        AND p.distpsnr1 > 5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM probability prob\n        WHERE prob.oid = o.oid\n        AND prob.class_name <> 'SNIa' -- Exclude supernova class\n        AND prob.class_name <> 'SNIbc'\n        AND prob.class_name <> 'SNII'\n        AND prob.class_name <> 'SLSN'\n        AND prob.classifier_name = 'lc_classifier'\n        AND prob.probability > 0.7\n        AND prob.ranking = 1\n    )\n)\nSELECT o.*, p.*, p1.*\nFROM selected_objects o\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p.class_name <> 'SNIa' AND p.class_name <> 'SNIbc' AND p.class_name <> 'SNII' AND p.class_name <> 'SLSN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.7\n  AND p.ranking = 1\nORDER BY p1.distpsnr1\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n        AND p.distpsnr1 > 5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM probability prob\n        WHERE prob.oid = o.oid\n        AND prob.class_name <> 'SNIa' -- Exclude supernova class\n        AND prob.class_name <> 'SNIbc'\n        AND prob.class_name <> 'SNII'\n        AND prob.class_name <> 'SLSN'\n        AND prob.classifier_name = 'lc_classifier'\n        AND prob.probability > 0.7\n        AND prob.ranking = 1\n    )\n)\nSELECT o.*, p.*, p1.*\nFROM selected_objects o\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p.class_name <> 'SNIa' AND p.class_name <> 'SNIbc' AND p.class_name <> 'SNII' AND p.class_name <> 'SLSN'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.7\n  AND p.ranking = 1\nORDER BY p1.distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3348,
                "out_toks": 295,
                "id": "chatcmpl-BwxFPHROG6WCnRqjR8nY55bijh2Ka",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "103",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 676,
                "out_toks": 14,
                "id": "chatcmpl-BwvKCc8ix2VtZNfr7xeE1D0F7orUX",
                "created": 1753383080,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM probability prob\n        WHERE prob.oid = o.oid\n          AND prob.class_name != 'SNIa' -- Exclude supernova class\n          AND prob.class_name != 'SNIbc'\n          AND prob.class_name != 'SNII'\n          AND prob.class_name != 'SLSN'\n          AND prob.classifier_name = 'lc_classifier'\n          AND prob.probability > 0.7\n    )\n)\nSELECT o.*, p.*, p1.*\nFROM selected_objects o\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p.class_name != 'SNIa' -- Exclude supernova class\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.7\n  AND p1.distpsnr1 > 5\nORDER BY p1.distpsnr1\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM probability prob\n        WHERE prob.oid = o.oid\n          AND prob.class_name != 'SNIa' -- Exclude supernova class\n          AND prob.class_name != 'SNIbc'\n          AND prob.class_name != 'SNII'\n          AND prob.class_name != 'SLSN'\n          AND prob.classifier_name = 'lc_classifier'\n          AND prob.probability > 0.7\n    )\n)\nSELECT o.*, p.*, p1.*\nFROM selected_objects o\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p.class_name != 'SNIa' -- Exclude supernova class\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.7\n  AND p1.distpsnr1 > 5\nORDER BY p1.distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3348,
                "out_toks": 267,
                "id": "chatcmpl-BwxFOzXooySGBiMwC21ODfMBkcD8T",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "103",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 676,
                "out_toks": 14,
                "id": "chatcmpl-BwvKCrz8e51Xry1I1DJTP2EczlpfE",
                "created": 1753383080,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_objects AS (\n    SELECT o.*, p.*, ps.*\n    FROM object o\n    JOIN (\n        SELECT oid, distpsnr1\n        FROM ps1_ztf\n        WHERE distpsnr1 > 5\n    ) ps ON o.oid = ps.oid\n    JOIN (\n        SELECT oid, class_name, probability, ranking\n        FROM probability\n        WHERE classifier_name = 'lc_classifier' AND probability > 0.7 AND class_name <> 'SNIa'\n    ) p ON o.oid = p.oid\n)\nSELECT *\nFROM selected_objects\nORDER BY distpsnr1\nLIMIT 200;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_objects AS (\n    SELECT o.*, p.*, ps.*\n    FROM object o\n    JOIN (\n        SELECT oid, distpsnr1\n        FROM ps1_ztf\n        WHERE distpsnr1 > 5\n    ) ps ON o.oid = ps.oid\n    JOIN (\n        SELECT oid, class_name, probability, ranking\n        FROM probability\n        WHERE classifier_name = 'lc_classifier' AND probability > 0.7 AND class_name <> 'SNIa'\n    ) p ON o.oid = p.oid\n)\nSELECT *\nFROM selected_objects\nORDER BY distpsnr1\nLIMIT 200;"
                },
                "in_toks": 3348,
                "out_toks": 133,
                "id": "chatcmpl-BwxFMuFan7mTYfGChJWSqYhfehPiF",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "103",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 676,
                "out_toks": 14,
                "id": "chatcmpl-BwvKDA8vRQyOxkxe6OLla9s2a7gQp",
                "created": 1753383081,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n    ORDER BY p.distpsnr1\n)\nSELECT o.*, p.*, p1.*\nFROM filtered_objects o\nJOIN probabilities p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p1.distpsnr1 = (\n    SELECT MIN(distpsnr1)\n    FROM ps1_ztf p2\n    WHERE p2.oid = o.oid\n)\nORDER BY p1.distpsnr1\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n    ORDER BY p.distpsnr1\n)\nSELECT o.*, p.*, p1.*\nFROM filtered_objects o\nJOIN probabilities p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p1.distpsnr1 = (\n    SELECT MIN(distpsnr1)\n    FROM ps1_ztf p2\n    WHERE p2.oid = o.oid\n)\nORDER BY p1.distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3348,
                "out_toks": 263,
                "id": "chatcmpl-BwxFOrJeMn3yfCakxNejGKRYFmuk8",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "103",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 676,
                "out_toks": 14,
                "id": "chatcmpl-BwvKErZbVfjut06FG5TIYwybuFTwj",
                "created": 1753383082,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n),\nranked_objects AS (\n    SELECT o.*, prob.*, np.distpsnr1\n    FROM filtered_objects o\n    JOIN probabilities prob ON prob.oid = o.oid\n    JOIN nearest_ps1 np ON np.oid = o.oid\n)\nSELECT *\nFROM ranked_objects\nORDER BY distpsnr1\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n),\nranked_objects AS (\n    SELECT o.*, prob.*, np.distpsnr1\n    FROM filtered_objects o\n    JOIN probabilities prob ON prob.oid = o.oid\n    JOIN nearest_ps1 np ON np.oid = o.oid\n)\nSELECT *\nFROM ranked_objects\nORDER BY distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3348,
                "out_toks": 228,
                "id": "chatcmpl-BwxFGar5ED0UmIhiOSGp2SXzY7U0R",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "103",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 676,
                "out_toks": 14,
                "id": "chatcmpl-BwvKE7CE8SfImlPe3IZhG4dXsUn6I",
                "created": 1753383082,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n    ORDER BY p.distpsnr1\n)\nSELECT o.*, p.*, p1.*\nFROM filtered_objects o\nJOIN probabilities p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p1.distpsnr1 = (\n    SELECT MIN(distpsnr1)\n    FROM ps1_ztf p2\n    WHERE p2.oid = o.oid\n)\nORDER BY p1.distpsnr1\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n    ORDER BY p.distpsnr1\n)\nSELECT o.*, p.*, p1.*\nFROM filtered_objects o\nJOIN probabilities p ON p.oid = o.oid\nJOIN ps1_ztf p1 ON p1.oid = o.oid\nWHERE p1.distpsnr1 = (\n    SELECT MIN(distpsnr1)\n    FROM ps1_ztf p2\n    WHERE p2.oid = o.oid\n)\nORDER BY p1.distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3348,
                "out_toks": 263,
                "id": "chatcmpl-BwxFGonjEAU4X7rcxgUQj3zYCQoYm",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "103",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 676,
                "out_toks": 14,
                "id": "chatcmpl-BwvKFb3d6QHrb6tDUOVVe1IENzfBC",
                "created": 1753383083,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM probability prob\n        WHERE prob.oid = o.oid\n          AND prob.class_name != 'SNIa' -- Exclude supernova class\n          AND prob.class_name != 'SNIbc'\n          AND prob.class_name != 'SNII'\n          AND prob.class_name != 'SLSN'\n          AND prob.classifier_name = 'lc_classifier'\n          AND prob.probability > 0.7\n          AND prob.ranking = 1\n    )\n)\nSELECT o.*, p.*, ps.*\nFROM selected_objects o\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p2\n      WHERE p2.oid = o.oid\n        AND p2.distpsnr1 > 5\n  )\nORDER BY ps.distpsnr1\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM probability prob\n        WHERE prob.oid = o.oid\n          AND prob.class_name != 'SNIa' -- Exclude supernova class\n          AND prob.class_name != 'SNIbc'\n          AND prob.class_name != 'SNII'\n          AND prob.class_name != 'SLSN'\n          AND prob.classifier_name = 'lc_classifier'\n          AND prob.probability > 0.7\n          AND prob.ranking = 1\n    )\n)\nSELECT o.*, p.*, ps.*\nFROM selected_objects o\nJOIN probability p ON p.oid = o.oid\nJOIN ps1_ztf ps ON ps.oid = o.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND EXISTS (\n      SELECT 1\n      FROM ps1_ztf p2\n      WHERE p2.oid = o.oid\n        AND p2.distpsnr1 > 5\n  )\nORDER BY ps.distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3348,
                "out_toks": 295,
                "id": "chatcmpl-BwxFGjxQkU9Xet1QxMw19TSwNN3Gg",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "103",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 676,
                "out_toks": 14,
                "id": "chatcmpl-BwvKF4dg4fWOVsJ5OyScdrCXCXabm",
                "created": 1753383083,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n),\nranked_objects AS (\n    SELECT o.*, prob.*, np.distpsnr1\n    FROM filtered_objects o\n    JOIN probabilities prob ON prob.oid = o.oid\n    JOIN nearest_ps1 np ON np.oid = o.oid\n)\nSELECT *\nFROM ranked_objects\nORDER BY distpsnr1\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n),\nranked_objects AS (\n    SELECT o.*, prob.*, np.distpsnr1\n    FROM filtered_objects o\n    JOIN probabilities prob ON prob.oid = o.oid\n    JOIN nearest_ps1 np ON np.oid = o.oid\n)\nSELECT *\nFROM ranked_objects\nORDER BY distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3348,
                "out_toks": 228,
                "id": "chatcmpl-BwxFKk3IGuEOiizpnPHy8qjjrhpM4",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "103",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 676,
                "out_toks": 14,
                "id": "chatcmpl-BwvKGbykhEei7GgMoislq7C1F0UH4",
                "created": 1753383084,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n),\nranked_objects AS (\n    SELECT o.*, prob.*, np.distpsnr1\n    FROM filtered_objects o\n    JOIN probabilities prob ON prob.oid = o.oid\n    JOIN nearest_ps1 np ON np.oid = o.oid\n)\nSELECT *\nFROM ranked_objects\nORDER BY distpsnr1\nLIMIT 200;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH filtered_objects AS (\n    SELECT o.*\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM ps1_ztf p\n        WHERE p.oid = o.oid\n          AND p.distpsnr1 > 5\n    )\n),\nprobabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.class_name != 'SN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND p.oid IN (SELECT oid FROM filtered_objects)\n),\nnearest_ps1 AS (\n    SELECT p.oid, p.distpsnr1\n    FROM ps1_ztf p\n    WHERE p.oid IN (SELECT oid FROM filtered_objects)\n),\nranked_objects AS (\n    SELECT o.*, prob.*, np.distpsnr1\n    FROM filtered_objects o\n    JOIN probabilities prob ON prob.oid = o.oid\n    JOIN nearest_ps1 np ON np.oid = o.oid\n)\nSELECT *\nFROM ranked_objects\nORDER BY distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3348,
                "out_toks": 228,
                "id": "chatcmpl-BwxFILWGgIBIaiPxRiIkbu3HCO85c",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "54": {
        "0": {
            "req_id": "54",
            "experiment_id": "run_0",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']",
                    "1": "['non_detection']"
                },
                "in_toks": 794,
                "out_toks": 8,
                "id": "chatcmpl-BjAcraunn93XBgyyQKaqQxiuRJy8k",
                "created": 1750105305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT * \nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT * \nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;"
                },
                "in_toks": 2025,
                "out_toks": 38,
                "id": "chatcmpl-BwxFLQxY4INqPOU055naON9cDQWsx",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "54",
            "experiment_id": "run_1",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']",
                    "1": "['non_detection']"
                },
                "in_toks": 794,
                "out_toks": 8,
                "id": "chatcmpl-BjAcraunn93XBgyyQKaqQxiuRJy8k",
                "created": 1750105305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```"
                },
                "in_toks": 2025,
                "out_toks": 64,
                "id": "chatcmpl-BwxFLoO7JgDfUOq4ue8feRET3WHdY",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "54",
            "experiment_id": "run_2",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 641,
                "out_toks": 4,
                "id": "chatcmpl-BwvKGpqr02Bv0VrJF5gVteqoRryvL",
                "created": 1753383084,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```"
                },
                "in_toks": 2025,
                "out_toks": 59,
                "id": "chatcmpl-BwxFGpR5tH34L56lMasZ2l3BZZADf",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "54",
            "experiment_id": "run_3",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 641,
                "out_toks": 4,
                "id": "chatcmpl-BwvKH9HLIP3Kzeq1gCmt5PFnVAude",
                "created": 1753383085,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```"
                },
                "in_toks": 2025,
                "out_toks": 59,
                "id": "chatcmpl-BwxFGdoX88gdBafcXsksbha0htvRj",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "54",
            "experiment_id": "run_4",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 641,
                "out_toks": 4,
                "id": "chatcmpl-BwvKHjFQ2LsX5icosAJd5qF5TYdeK",
                "created": 1753383085,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```"
                },
                "in_toks": 2025,
                "out_toks": 59,
                "id": "chatcmpl-BwxFNy4pYPfrRIG3nXaC7JgEOmbFd",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "54",
            "experiment_id": "run_5",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 641,
                "out_toks": 4,
                "id": "chatcmpl-BwvKInkO39klMVCUeNBG8zi1cdCWd",
                "created": 1753383086,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND diffmaglim > 19.5;\n```"
                },
                "in_toks": 2025,
                "out_toks": 54,
                "id": "chatcmpl-BwxFN90ei28cfLp0mnRzejZzEzpVk",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "54",
            "experiment_id": "run_6",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 641,
                "out_toks": 4,
                "id": "chatcmpl-BwvKIac0RrjfhOEgc9U4ygTfDi3k9",
                "created": 1753383086,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;\n```"
                },
                "in_toks": 2025,
                "out_toks": 41,
                "id": "chatcmpl-BwxFNxicvolsZ9P4oCsuuUvVVhbf4",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "54",
            "experiment_id": "run_7",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 641,
                "out_toks": 4,
                "id": "chatcmpl-BwvKJAQrRtshjoqcgmEeW5gW4VLAA",
                "created": 1753383087,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT nd.*\nFROM (\n    SELECT * FROM non_detection\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n) nd\nWHERE nd.diffmaglim > 19.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT nd.*\nFROM (\n    SELECT * FROM non_detection\n    WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n) nd\nWHERE nd.diffmaglim > 19.5;\n```"
                },
                "in_toks": 2025,
                "out_toks": 51,
                "id": "chatcmpl-BwxFOKL7LucfzROOKiMZjZVG86wNN",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "54",
            "experiment_id": "run_8",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 641,
                "out_toks": 4,
                "id": "chatcmpl-BwvKJm4d84aROJ5aJ2vqTHDVoscW0",
                "created": 1753383087,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n)\nAND nd.diffmaglim > 19.5;\n```"
                },
                "in_toks": 2025,
                "out_toks": 64,
                "id": "chatcmpl-BwxFGSDYAjFXlEtPDV7TyGmjVFrdh",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "54",
            "experiment_id": "run_9",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']"
                },
                "in_toks": 641,
                "out_toks": 4,
                "id": "chatcmpl-BwvKKe6GYLfZq5rshc4uF8HavaXMA",
                "created": 1753383088,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT * \nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT * \nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;"
                },
                "in_toks": 2025,
                "out_toks": 38,
                "id": "chatcmpl-BwxFMyeDHtLkexFbaV9IVXzYvx3e6",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "99": {
        "0": {
            "req_id": "99",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']",
                    "1": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 799,
                "out_toks": 26,
                "id": "chatcmpl-BjAcswo1SvrNPbHj9rTNX5MIwDR3W",
                "created": 1750105306,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3258,
                "out_toks": 170,
                "id": "chatcmpl-BwxFPgyUV2ImhnOmoVbJbOhwjg1M8",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "99",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']",
                    "1": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 799,
                "out_toks": 26,
                "id": "chatcmpl-BjAcswo1SvrNPbHj9rTNX5MIwDR3W",
                "created": 1750105306,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310\nWITH recent_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd > 60310\n    LIMIT 10\n)\n-- Select all columns from forced_photometry for objects that meet the criteria\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    -- Filter objects with probability=1 of being an asteroid in stamp_classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability = 1\n      AND p.oid IN (SELECT oid FROM recent_objects)\n)\nORDER BY (SELECT firstmjd FROM object WHERE object.oid = fp.oid) ASC\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310\nWITH recent_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd > 60310\n    LIMIT 10\n)\n-- Select all columns from forced_photometry for objects that meet the criteria\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    -- Filter objects with probability=1 of being an asteroid in stamp_classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability = 1\n      AND p.oid IN (SELECT oid FROM recent_objects)\n)\nORDER BY (SELECT firstmjd FROM object WHERE object.oid = fp.oid) ASC\nLIMIT 10;\n```"
                },
                "in_toks": 3258,
                "out_toks": 178,
                "id": "chatcmpl-BwxFJ5IU8h3dppFdhjZin3SnzILcU",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "99",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "stamp",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'stamp', 'forced_photometry']"
                },
                "in_toks": 646,
                "out_toks": 16,
                "id": "chatcmpl-BwvKLNwYEhDSR3oQ8I1dlAUCrj4GD",
                "created": 1753383089,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with first detection after MJD 60310 and classified as asteroid with probability 1 in stamp_classifier\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n        LIMIT 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from forced_photometry for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with first detection after MJD 60310 and classified as asteroid with probability 1 in stamp_classifier\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n        LIMIT 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from forced_photometry for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3258,
                "out_toks": 169,
                "id": "chatcmpl-BwxFNYM6jv3aI3i7zvXpIx6p4coFj",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "99",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "stamp",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'stamp', 'forced_photometry']"
                },
                "in_toks": 646,
                "out_toks": 16,
                "id": "chatcmpl-BwvKLKbYklwQt8oUfYKHCjJ62iPzq",
                "created": 1753383089,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3258,
                "out_toks": 170,
                "id": "chatcmpl-BwxFLp5x2g02blc38mUaJ51dnOgR3",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "99",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "stamp",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'stamp', 'forced_photometry']"
                },
                "in_toks": 646,
                "out_toks": 16,
                "id": "chatcmpl-BwvKMDQfx4oqyr9aTHcCSNk9QbzB2",
                "created": 1753383090,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3258,
                "out_toks": 170,
                "id": "chatcmpl-BwxFLQ62CwsHMgY6g4GCSRIRMU60Z",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "99",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "stamp",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'stamp', 'forced_photometry']"
                },
                "in_toks": 646,
                "out_toks": 16,
                "id": "chatcmpl-BwvKNxCMdvqfyqml9Yyf14ZPvc7LD",
                "created": 1753383091,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3258,
                "out_toks": 170,
                "id": "chatcmpl-BwxFKt9BZb2XgpGgBvTFxf6Af6Z4A",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "99",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "stamp",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'stamp', 'forced_photometry']"
                },
                "in_toks": 646,
                "out_toks": 16,
                "id": "chatcmpl-BwvKOuWEnBrBeSj1W7xrcGfiTLlmf",
                "created": 1753383092,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with first detection after MJD 60310\nWITH recent_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd > 60310\n    LIMIT 10\n)\n-- Filter objects that have a probability of 1 for being an asteroid in the stamp_classifier\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT oid\n    FROM recent_objects\n) AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = fp.oid\n      AND p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability = 1\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with first detection after MJD 60310\nWITH recent_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd > 60310\n    LIMIT 10\n)\n-- Filter objects that have a probability of 1 for being an asteroid in the stamp_classifier\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT oid\n    FROM recent_objects\n) AND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = fp.oid\n      AND p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability = 1\n);\n```"
                },
                "in_toks": 3258,
                "out_toks": 148,
                "id": "chatcmpl-BwxFMb0RDodeKmGHPr9vyzayOn6D9",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "99",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "stamp",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'stamp', 'forced_photometry']"
                },
                "in_toks": 646,
                "out_toks": 16,
                "id": "chatcmpl-BwvKPtkKOoQt47BJ2pXNNsUbUjZl1",
                "created": 1753383093,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with first detection after MJD 60310 and classified as asteroid with probability 1 in stamp_classifier\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n          AND p.ranking = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from forced_photometry for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with first detection after MJD 60310 and classified as asteroid with probability 1 in stamp_classifier\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n          AND p.ranking = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from forced_photometry for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3258,
                "out_toks": 173,
                "id": "chatcmpl-BwxFQFnYg0qKAVT8C4JYqJEwS1FDz",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "99",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "stamp",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'stamp', 'forced_photometry']"
                },
                "in_toks": 646,
                "out_toks": 16,
                "id": "chatcmpl-BwvKPgt9m2y2zPj5MzfdV2XlOeEVo",
                "created": 1753383093,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3258,
                "out_toks": 170,
                "id": "chatcmpl-BwxFLgzCosH0wppo6sdoJHKK0YQAG",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "99",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "stamp",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'stamp', 'forced_photometry']"
                },
                "in_toks": 646,
                "out_toks": 16,
                "id": "chatcmpl-BwvKQENwEz1cSZHOD6hsGuBtQnEyr",
                "created": 1753383094,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to find object IDs with first detection after mjd=60310 and probability=1 for 'asteroid' in 'stamp_classifier'\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n      )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Select all columns from 'forced_photometry' for the selected objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM selected_objects);\n```"
                },
                "in_toks": 3258,
                "out_toks": 170,
                "id": "chatcmpl-BwxFMUP1Vky33pJcqeLpufuVIyfub",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "40": {
        "0": {
            "req_id": "40",
            "experiment_id": "run_0",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 810,
                "out_toks": 8,
                "id": "chatcmpl-BjAcsW8S4ZQwbT31bO6D4y5RyAXEN",
                "created": 1750105306,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees"
                },
                "in_toks": 2610,
                "out_toks": 143,
                "id": "chatcmpl-BwxFON6AmmFEg1jAUvubG7XsCL62d",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "40",
            "experiment_id": "run_1",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 810,
                "out_toks": 8,
                "id": "chatcmpl-BjAcsW8S4ZQwbT31bO6D4y5RyAXEN",
                "created": 1750105306,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT \n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM allwise a\nJOIN catalog c ON q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600.0);",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT \n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM allwise a\nJOIN catalog c ON q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600.0);"
                },
                "in_toks": 2610,
                "out_toks": 125,
                "id": "chatcmpl-BwxFPg6KMdne21LhwCEe69i5EFH2L",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "40",
            "experiment_id": "run_2",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 657,
                "out_toks": 4,
                "id": "chatcmpl-BwvKQnkRPttNngPuHMfIdlQSmklmq",
                "created": 1753383094,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees"
                },
                "in_toks": 2610,
                "out_toks": 143,
                "id": "chatcmpl-BwxFGl1Nhsvd04RVQA4hMVco2ZgwI",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "40",
            "experiment_id": "run_3",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 657,
                "out_toks": 4,
                "id": "chatcmpl-BwvKRTjWVEBvsQWfhYx9ZBXZsmsUg",
                "created": 1753383095,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees"
                },
                "in_toks": 2610,
                "out_toks": 143,
                "id": "chatcmpl-BwxFIcLIHQxifzPzFYHhTB188e7qG",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "40",
            "experiment_id": "run_4",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 657,
                "out_toks": 4,
                "id": "chatcmpl-BwvKRnrbPoRiNN2Oj7O5gCYDqOGFX",
                "created": 1753383095,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees"
                },
                "in_toks": 2610,
                "out_toks": 143,
                "id": "chatcmpl-BwxFGUdXRzB7aqMjtFHNs5OVdRL6U",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "40",
            "experiment_id": "run_5",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 657,
                "out_toks": 4,
                "id": "chatcmpl-BwvKS0PYdwahUqPhIXPMabkUf8nby",
                "created": 1753383096,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees"
                },
                "in_toks": 2610,
                "out_toks": 143,
                "id": "chatcmpl-BwxFG23vSNRjbss7IUwjF9PFTc48T",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "40",
            "experiment_id": "run_6",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 657,
                "out_toks": 4,
                "id": "chatcmpl-BwvKSznTNVSoreo7AOtgH0CFHXJzR",
                "created": 1753383096,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees"
                },
                "in_toks": 2610,
                "out_toks": 143,
                "id": "chatcmpl-BwxFGlyqYI5altDtzkZmqgAr5ipml",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "40",
            "experiment_id": "run_7",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 657,
                "out_toks": 4,
                "id": "chatcmpl-BwvKSOo7r70O5TZmOdfoZ2oDnZGF4",
                "created": 1753383096,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source1', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees"
                },
                "in_toks": 2610,
                "out_toks": 143,
                "id": "chatcmpl-BwxFG4U2RXMhZf1C6jsPswVhPnbfe",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "40",
            "experiment_id": "run_8",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 657,
                "out_toks": 4,
                "id": "chatcmpl-BwvKTqLGHCcGSekvezUjTmFhLBdlP",
                "created": 1753383097,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees"
                },
                "in_toks": 2610,
                "out_toks": 143,
                "id": "chatcmpl-BwxFG4MPzuaD5o54D6iQffESzqnpG",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "40",
            "experiment_id": "run_9",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 657,
                "out_toks": 4,
                "id": "chatcmpl-BwvKURO49ZAoNzizkz8ahEskEdMqu",
                "created": 1753383098,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees",
            "original_sql_response": {
                "responses": {
                    "0": "WITH catalog AS (\n    VALUES\n        ('source_name', 23.6488, 30.7314)\n)\nSELECT\n    a.oid_catalog,\n    a.ra,\n    a.dec,\n    a.w1mpro,\n    a.w1sigmpro,\n    a.w2mpro,\n    a.w2sigmpro,\n    a.j_m_2mass,\n    a.j_msig_2mass\nFROM\n    allwise a\nJOIN\n    catalog c\nON\n    q3c_join(a.ra, a.dec, c.column2, c.column3, 1.0/3600)  -- 1 arcsec = 1/3600 degrees"
                },
                "in_toks": 2610,
                "out_toks": 143,
                "id": "chatcmpl-BwxFGYV4h9Q9ZPQbozzceDA1q6Vx1",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "80": {
        "0": {
            "req_id": "80",
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-BjAct64I3F5nDrjdfHP6dO5CE2Kox",
                "created": 1750105307,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 40,
                "id": "chatcmpl-BwxFI6cpsn9fEi0WVfF40375vVN7y",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "80",
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-BjAct64I3F5nDrjdfHP6dO5CE2Kox",
                "created": 1750105307,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 40,
                "id": "chatcmpl-BwxFJyb1Mx0VYK68EPs9WQ6oKKo9N",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "80",
            "experiment_id": "run_2",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 645,
                "out_toks": 4,
                "id": "chatcmpl-BwvKUVxJMQS5J9KdUt9vP8bH86T56",
                "created": 1753383098,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 40,
                "id": "chatcmpl-BwxFKDJEQeWSxNd6x9HimtnrFOhRC",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "80",
            "experiment_id": "run_3",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 645,
                "out_toks": 4,
                "id": "chatcmpl-BwvKVDY9JIHqnRYtJJGv6pc6SRcWM",
                "created": 1753383099,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 40,
                "id": "chatcmpl-BwxFLwyeMJdTv8q4NhRg4cIopbMPo",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "80",
            "experiment_id": "run_4",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 645,
                "out_toks": 4,
                "id": "chatcmpl-BwvKVQeEfE7mLvZhYyQThr51JUQEg",
                "created": 1753383099,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 40,
                "id": "chatcmpl-BwxFMRVtVQCCKXJH60sqNfab5jA2V",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "80",
            "experiment_id": "run_5",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 645,
                "out_toks": 4,
                "id": "chatcmpl-BwvKWA8iwdMa0oVdTPyOGffA0SiJX",
                "created": 1753383100,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 40,
                "id": "chatcmpl-BwxFNljOqLDfKdslhLfJ2yXFbG5XE",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "80",
            "experiment_id": "run_6",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 645,
                "out_toks": 4,
                "id": "chatcmpl-BwvKWVvQVAgApVQKKMV7yI84yKXPu",
                "created": 1753383100,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from xmatch where the object matches are within 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from xmatch where the object matches are within 0.5 arcsec\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 60,
                "id": "chatcmpl-BwxFO2YrNsnghfZcvJzOlLR1FvtzT",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "80",
            "experiment_id": "run_7",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 645,
                "out_toks": 4,
                "id": "chatcmpl-BwvKXIqpEwuUnzHCBkTiSiPQ2XYuv",
                "created": 1753383101,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 40,
                "id": "chatcmpl-BwxFLuqIkXYYycU6hy4yBRmYtvGR8",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "80",
            "experiment_id": "run_8",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 645,
                "out_toks": 4,
                "id": "chatcmpl-BwvKXq1fG4c9RKWIS1KY9zStFEJe2",
                "created": 1753383101,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from xmatch where the object matches either of the specified ZTF IDs\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from xmatch where the object matches either of the specified ZTF IDs\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 59,
                "id": "chatcmpl-BwxFPYXPupXmR55cNGR8fomTEt0D5",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "80",
            "experiment_id": "run_9",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 645,
                "out_toks": 4,
                "id": "chatcmpl-BwvKY3IC8iARzUopVENE8lkQoyPoC",
                "created": 1753383102,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM xmatch\nWHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2012,
                "out_toks": 40,
                "id": "chatcmpl-BwxFHd3CZ4uuousWPvWlM2XjlIJHb",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "45": {
        "0": {
            "req_id": "45",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 781,
                "out_toks": 14,
                "id": "chatcmpl-BjActi3yvQLLy0eK8w7Q6xLmNOWqU",
                "created": 1750105307,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the count of dataquality rows for specified objects with min chipsf (reduced chi-square) >= 5\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the count of dataquality rows for specified objects with min chipsf (reduced chi-square) >= 5\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```"
                },
                "in_toks": 3161,
                "out_toks": 65,
                "id": "chatcmpl-BwxFHNTkshc5Pg7N2SClTwgXTYmHK",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "45",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 781,
                "out_toks": 14,
                "id": "chatcmpl-BjActi3yvQLLy0eK8w7Q6xLmNOWqU",
                "created": 1750105307,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE candid IN (\n    SELECT candid \n    FROM dataquality \n    WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n) \nAND chipsf = (\n    SELECT MIN(chipsf) \n    FROM dataquality dq2 \n    WHERE dq2.candid = dataquality.candid\n) \nAND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE candid IN (\n    SELECT candid \n    FROM dataquality \n    WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n) \nAND chipsf = (\n    SELECT MIN(chipsf) \n    FROM dataquality dq2 \n    WHERE dq2.candid = dataquality.candid\n) \nAND chipsf >= 5;\n```"
                },
                "in_toks": 3161,
                "out_toks": 88,
                "id": "chatcmpl-BwxFH3tnpO7hc4JM08ToaVC0nb3AJ",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "45",
            "experiment_id": "run_2",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 628,
                "out_toks": 4,
                "id": "chatcmpl-BwvKY0x3IUw3KppVRhKHE34b3UXHg",
                "created": 1753383102,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```"
                },
                "in_toks": 2679,
                "out_toks": 40,
                "id": "chatcmpl-BwxFHvWlOqaWestSaWuTJd7e34HxJ",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "45",
            "experiment_id": "run_3",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 628,
                "out_toks": 4,
                "id": "chatcmpl-BwvKY3pw6AMkW5LsWsh9jYKrL7tIs",
                "created": 1753383102,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select the count of rows in dataquality where the oid matches either of the specified ZTF identifiers\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the count of rows in dataquality where the oid matches either of the specified ZTF identifiers\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```"
                },
                "in_toks": 2679,
                "out_toks": 61,
                "id": "chatcmpl-BwxFG5PqPlSuaXBqPH4FHxkP2MJxF",
                "created": 1753390462,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "45",
            "experiment_id": "run_4",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 628,
                "out_toks": 4,
                "id": "chatcmpl-BwvKZ82He0ulm62lRLC6Fg1cGYW83",
                "created": 1753383103,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```"
                },
                "in_toks": 2679,
                "out_toks": 40,
                "id": "chatcmpl-BwxFSpA7HhFpjOAgLj7F8gtDoZcyF",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "45",
            "experiment_id": "run_5",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 628,
                "out_toks": 4,
                "id": "chatcmpl-BwvKazI60YVgaT4JH7gdAG9rWi6bZ",
                "created": 1753383104,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```"
                },
                "in_toks": 2679,
                "out_toks": 40,
                "id": "chatcmpl-BwxFQGarDPSxqO0xUNB8sbSBOY7LS",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "45",
            "experiment_id": "run_6",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 628,
                "out_toks": 4,
                "id": "chatcmpl-BwvKasapUpyHNNeaSgrNLl4olFjcs",
                "created": 1753383104,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```"
                },
                "in_toks": 2679,
                "out_toks": 40,
                "id": "chatcmpl-BwxFTagRiEKdkQOttwDkJjPdYPlR6",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "45",
            "experiment_id": "run_7",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 628,
                "out_toks": 4,
                "id": "chatcmpl-BwvKaFB6e069dxpmTwMWf37HjNHSY",
                "created": 1753383104,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```"
                },
                "in_toks": 2679,
                "out_toks": 40,
                "id": "chatcmpl-BwxFH7KP6UOMqRU1WguMCX6GqXTNH",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "45",
            "experiment_id": "run_8",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 628,
                "out_toks": 4,
                "id": "chatcmpl-BwvKbFE55xQWfOj3HGANjUMvPu8Ny",
                "created": 1753383105,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```"
                },
                "in_toks": 2679,
                "out_toks": 40,
                "id": "chatcmpl-BwxFUrFRj1U6qN0eFcJHch8by0H8n",
                "created": 1753390476,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "45",
            "experiment_id": "run_9",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 628,
                "out_toks": 4,
                "id": "chatcmpl-BwvKbxn46ESd44Re86mapFTdRGa2i",
                "created": 1753383105,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT COUNT(*) \nFROM dataquality \nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') \n  AND chipsf >= 5;\n```"
                },
                "in_toks": 2679,
                "out_toks": 40,
                "id": "chatcmpl-BwxFHkdhVkUtzBUXcniebsgb1fzif",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "63": {
        "0": {
            "req_id": "63",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-BjAcuKTdJelZxo2B1l1r7PoShHxUt",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION ALL\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability and light curve classifier tables where ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION ALL\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability and light curve classifier tables where ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 129,
                "id": "chatcmpl-BwxFJ2dQNskO4Q37d1dqKnGRzuSnF",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "63",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-BjAcuKTdJelZxo2B1l1r7PoShHxUt",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve object OIDs for specified ZTF identifiers\nWITH selected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF21aaobkmg',\n        'ZTF21aaomuka'\n    )\n)\n-- Select all relevant probability and classifier data for objects with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve object OIDs for specified ZTF identifiers\nWITH selected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF21aaobkmg',\n        'ZTF21aaomuka'\n    )\n)\n-- Select all relevant probability and classifier data for objects with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 110,
                "id": "chatcmpl-BwxFJ6DbzOYUeHmzCKHfOHJcSWXGW",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "63",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 640,
                "out_toks": 4,
                "id": "chatcmpl-BwvKbmrX0oyFvVPx4uy2P9Rowe0Y0",
                "created": 1753383105,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 128,
                "id": "chatcmpl-BwxFHRK3PP8cBdeAK1N49pGrft2Hv",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "63",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 640,
                "out_toks": 4,
                "id": "chatcmpl-BwvKcifGV4Q0uWCPJ7JVssxtqfOyJ",
                "created": 1753383106,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION ALL\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nUNION ALL\n-- Select from light curve classifier probabilities with same conditions\nSELECT lc.*\nFROM probability lc\nWHERE lc.oid IN (SELECT oid FROM target_oids)\n  AND lc.ranking IN (1, 2)\nORDER BY ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION ALL\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nUNION ALL\n-- Select from light curve classifier probabilities with same conditions\nSELECT lc.*\nFROM probability lc\nWHERE lc.oid IN (SELECT oid FROM target_oids)\n  AND lc.ranking IN (1, 2)\nORDER BY ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 174,
                "id": "chatcmpl-BwxFKvp5tC9VXG3kHBIGw5nFjYJaC",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "63",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 640,
                "out_toks": 4,
                "id": "chatcmpl-BwvKcYVYzGluEg9c8CZSZcTQp7ZhX",
                "created": 1753383106,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 128,
                "id": "chatcmpl-BwxFHWcKF6D4BEGaqezgfACbY1ztf",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "63",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 640,
                "out_toks": 4,
                "id": "chatcmpl-BwvKcplrPjux5jSqFvKzpD9RN4PtJ",
                "created": 1753383106,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve OIDs for the specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\n-- Select all relevant probability and classifier data with ranking 1 or 2 for these OIDs\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve OIDs for the specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\n-- Select all relevant probability and classifier data with ranking 1 or 2 for these OIDs\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 109,
                "id": "chatcmpl-BwxFHhH1YUbZG2Te1KBlSY4aOChBg",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "63",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 640,
                "out_toks": 4,
                "id": "chatcmpl-BwvKdJ0fMxbdsD6FPZfiV5Ejwf4o0",
                "created": 1753383107,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all probability and light curve classifier rows with ranking 1 or 2 for specified objects\nSELECT *\nFROM (\n    -- Subquery to get OIDs for the specified ZTF identifiers\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n) AS obj_ids\nJOIN probability p ON p.oid = obj_ids.oid\nWHERE p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all probability and light curve classifier rows with ranking 1 or 2 for specified objects\nSELECT *\nFROM (\n    -- Subquery to get OIDs for the specified ZTF identifiers\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n) AS obj_ids\nJOIN probability p ON p.oid = obj_ids.oid\nWHERE p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 112,
                "id": "chatcmpl-BwxFLmBqTg2JX4INU7eGtMvbDuTkd",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "63",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 640,
                "out_toks": 4,
                "id": "chatcmpl-BwvKeaxRcdwjmbuq64cmwk2zS3cPZ",
                "created": 1753383108,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability and light curve classifier tables where ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability and light curve classifier tables where ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 128,
                "id": "chatcmpl-BwxFHsbHjcyWwzdSPR7hLPaf7pmyf",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "63",
            "experiment_id": "run_8",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 640,
                "out_toks": 4,
                "id": "chatcmpl-BwvKeFErVkL011GfnjhqImOvilXpK",
                "created": 1753383108,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION ALL\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nUNION ALL\n-- Select from light curve classifier probabilities with same conditions\nSELECT lc.*\nFROM probability lc\nWHERE lc.oid IN (SELECT oid FROM target_oids)\n  AND lc.ranking IN (1, 2)\nORDER BY ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION ALL\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nUNION ALL\n-- Select from light curve classifier probabilities with same conditions\nSELECT lc.*\nFROM probability lc\nWHERE lc.oid IN (SELECT oid FROM target_oids)\n  AND lc.ranking IN (1, 2)\nORDER BY ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 174,
                "id": "chatcmpl-BwxFH5LAJ2d0ZAuBd1e6KRv0Z1wWV",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "63",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']"
                },
                "in_toks": 640,
                "out_toks": 4,
                "id": "chatcmpl-BwvKeFrU6r33Ybq8OtLKJeSWN2uWY",
                "created": 1753383108,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve OIDs for specified ZTF identifiers\nWITH target_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        SELECT oid FROM object WHERE oid = 'ZTF21aaobkmg'\n        UNION\n        SELECT oid FROM object WHERE oid = 'ZTF21aaomuka'\n    )\n)\n-- Select from probability table where OID matches and ranking is 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM target_oids)\n  AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2078,
                "out_toks": 128,
                "id": "chatcmpl-BwxFMzQdnSSGRui9gQgI7qcQ8EQJ6",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "73": {
        "0": {
            "req_id": "73",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf']",
                    "1": "['object', 'ss_ztf', 'reference']"
                },
                "in_toks": 780,
                "out_toks": 21,
                "id": "chatcmpl-BjAcudxcZ9nk8kGmWilsQXf71spjp",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH nearest_ss AS (\n    SELECT \n        o.oid,\n        s.ssnamenr,\n        s.ssmagnr\n    FROM \n        object o\n    LEFT JOIN \n        ss_ztf s ON o.oid = s.oid\n    WHERE \n        o.oid = 'ZTF21acitntz'\n    ORDER BY \n        s.ssdistnr ASC\n    LIMIT 1\n)\nSELECT \n    o.oid,\n    s.ssnamenr,\n    s.ssmagnr\nFROM \n    object o\nLEFT JOIN \n    ss_ztf s ON o.oid = s.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH nearest_ss AS (\n    SELECT \n        o.oid,\n        s.ssnamenr,\n        s.ssmagnr\n    FROM \n        object o\n    LEFT JOIN \n        ss_ztf s ON o.oid = s.oid\n    WHERE \n        o.oid = 'ZTF21acitntz'\n    ORDER BY \n        s.ssdistnr ASC\n    LIMIT 1\n)\nSELECT \n    o.oid,\n    s.ssnamenr,\n    s.ssmagnr\nFROM \n    object o\nLEFT JOIN \n    ss_ztf s ON o.oid = s.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```"
                },
                "in_toks": 2524,
                "out_toks": 151,
                "id": "chatcmpl-BwxFJFzXvbmdZKPR7cqzZvGPQkrc5",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "73",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "ss_ztf",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf']",
                    "1": "['object', 'ss_ztf', 'reference']"
                },
                "in_toks": 780,
                "out_toks": 21,
                "id": "chatcmpl-BjAcudxcZ9nk8kGmWilsQXf71spjp",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  sss.ssnamenr AS mpc_name,\n  sss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf sss ON o.oid = sss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  sss.ssnamenr AS mpc_name,\n  sss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf sss ON o.oid = sss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```"
                },
                "in_toks": 2890,
                "out_toks": 82,
                "id": "chatcmpl-BwxFIYPlF069ZiCQrdyILMB3NCUSs",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "73",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "ss_ztf",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf', 'reference']"
                },
                "in_toks": 627,
                "out_toks": 12,
                "id": "chatcmpl-BwvKfD45AhfirFe3JYwR8Am4zXWhZ",
                "created": 1753383109,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  ss.ssnamenr AS mpc_name,\n  ss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf ss ON o.oid = ss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  ss.ssnamenr AS mpc_name,\n  ss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf ss ON o.oid = ss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```"
                },
                "in_toks": 2890,
                "out_toks": 77,
                "id": "chatcmpl-BwxFPKKv1aNXWlOU6VSFvTe8mXSt2",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "73",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf']"
                },
                "in_toks": 627,
                "out_toks": 9,
                "id": "chatcmpl-BwvKf4oAVZJD1f0djxPeLOI5bzxvF",
                "created": 1753383109,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- The original query references a column 'ssname' which does not exist in the 'ss_ztf' table.\n-- The correct column name is 'ssnamenr' for the name of the nearest known solar system object.\n-- Additionally, the query can be simplified to directly select the nearest solar system object for the specified object.\n-- We will select the object with oid 'ZTF21acitntz' and join with 'ss_ztf' to get the nearest SSO info, ordering by 'ssdistnr'.\n\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz'\n-- Order by distance to find the nearest known Solar System Object\nORDER BY \n    sss.ssdistnr ASC\n-- Limit to the closest one\nLIMIT 1;\n",
            "sql_response": {
                "responses": {
                    "0": "-- The original query references a column 'ssname' which does not exist in the 'ss_ztf' table.\n-- The correct column name is 'ssnamenr' for the name of the nearest known solar system object.\n-- Additionally, the query can be simplified to directly select the nearest solar system object for the specified object.\n-- We will select the object with oid 'ZTF21acitntz' and join with 'ss_ztf' to get the nearest SSO info, ordering by 'ssdistnr'.\n\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz'\n-- Order by distance to find the nearest known Solar System Object\nORDER BY \n    sss.ssdistnr ASC\n-- Limit to the closest one\nLIMIT 1;\n"
                },
                "in_toks": 1488,
                "out_toks": 217,
                "id": "chatcmpl-Bx08AyRwjdVsQyJzJtNgJ4WhERF8J",
                "created": 1753401554,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH nearest_ss AS (\n    SELECT \n        o.oid,\n        sss.ssname,\n        sss.ssmagnr\n    FROM \n        object o\n    LEFT JOIN \n        ss_ztf sss ON o.oid = sss.oid\n    WHERE \n        o.oid = 'ZTF21acitntz'\n    ORDER BY \n        sss.ssdistnr ASC\n    LIMIT 1\n)\nSELECT \n    o.oid,\n    sss.ssname,\n    sss.ssmagnr\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH nearest_ss AS (\n    SELECT \n        o.oid,\n        sss.ssname,\n        sss.ssmagnr\n    FROM \n        object o\n    LEFT JOIN \n        ss_ztf sss ON o.oid = sss.oid\n    WHERE \n        o.oid = 'ZTF21acitntz'\n    ORDER BY \n        sss.ssdistnr ASC\n    LIMIT 1\n)\nSELECT \n    o.oid,\n    sss.ssname,\n    sss.ssmagnr\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```"
                },
                "in_toks": 2524,
                "out_toks": 156,
                "id": "chatcmpl-BwxFPVStmD5vLS9QLEJKRo4k82tSo",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "73",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "ss_ztf",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf', 'reference']"
                },
                "in_toks": 627,
                "out_toks": 12,
                "id": "chatcmpl-BwvKgeSF7qzKrMoHyu5lpCaQz8OAY",
                "created": 1753383110,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  ss.ssnamenr AS mpc_name,\n  ss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf ss ON o.oid = ss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  ss.ssnamenr AS mpc_name,\n  ss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf ss ON o.oid = ss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```"
                },
                "in_toks": 2890,
                "out_toks": 77,
                "id": "chatcmpl-BwxFKursHo9zLUuqZFlDInOAk1M8n",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "73",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "ss_ztf",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf', 'reference']"
                },
                "in_toks": 627,
                "out_toks": 12,
                "id": "chatcmpl-BwvKgdHtvXeRE9aHgSCRwsUT7XzUJ",
                "created": 1753383110,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  sss.ssnamenr AS mpc_name,\n  sss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf sss ON o.oid = sss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n  o.oid AS ztf_object_id,\n  sss.ssnamenr AS mpc_name,\n  sss.ssmagnr AS mpc_magnitude\nFROM \n  object o\nLEFT JOIN \n  ss_ztf sss ON o.oid = sss.oid\nWHERE \n  o.oid = 'ZTF21acitntz';\n```"
                },
                "in_toks": 2890,
                "out_toks": 82,
                "id": "chatcmpl-BwxFJFCYl2xk4lNpp2gfCx6nrUJcr",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "73",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"object\", \"ss_ztf\"]"
                },
                "in_toks": 627,
                "out_toks": 9,
                "id": "chatcmpl-BwvKhJnYqussK0UpSvNuTpW2zcchx",
                "created": 1753383111,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH nearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n    WHERE o.oid = 'ZTF21acitntz'\n    ORDER BY s.ssdistnr ASC\n    LIMIT 1\n)\nSELECT o.oid, s.ssnamenr AS mpc_name, s.ssmagnr AS mpc_magnitude\nFROM object o\nLEFT JOIN ss_ztf s ON o.oid = s.oid\nWHERE o.oid = 'ZTF21acitntz'\nAND s.oid = (SELECT oid FROM nearest_ss);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH nearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n    WHERE o.oid = 'ZTF21acitntz'\n    ORDER BY s.ssdistnr ASC\n    LIMIT 1\n)\nSELECT o.oid, s.ssnamenr AS mpc_name, s.ssmagnr AS mpc_magnitude\nFROM object o\nLEFT JOIN ss_ztf s ON o.oid = s.oid\nWHERE o.oid = 'ZTF21acitntz'\nAND s.oid = (SELECT oid FROM nearest_ss);\n```"
                },
                "in_toks": 2524,
                "out_toks": 150,
                "id": "chatcmpl-BwxFPvgA6Nylk3IPYZwFPSyfSSfk2",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "73",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "ss_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf', 'xmatch']"
                },
                "in_toks": 627,
                "out_toks": 13,
                "id": "chatcmpl-BwvKhVTd6LaGfQxdtSmLjMsyh2ZqV",
                "created": 1753383111,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude for the nearest known Solar System object to 'ZTF21acitntz'\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nJOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz'\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude for the nearest known Solar System object to 'ZTF21acitntz'\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nJOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz'\n```"
                },
                "in_toks": 2637,
                "out_toks": 104,
                "id": "chatcmpl-BwxFKQq9iHmTEVi4DPaaH7o6Y2JRV",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "73",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "ss_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf', 'xmatch']"
                },
                "in_toks": 627,
                "out_toks": 13,
                "id": "chatcmpl-BwvKiFp9Ve0bA6Ogc7cU2w7p3JnpX",
                "created": 1753383112,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude of the nearest known Solar System object for the specified ZTF object\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude of the nearest known Solar System object for the specified ZTF object\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```"
                },
                "in_toks": 2637,
                "out_toks": 103,
                "id": "chatcmpl-BwxFKnTURSSN3MFBegEpGvtJ8EAyo",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "73",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "ss_ztf",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf', 'reference']"
                },
                "in_toks": 627,
                "out_toks": 12,
                "id": "chatcmpl-BwvKjS3MohDn1tMFkZDVRhFRicI7l",
                "created": 1753383113,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the object identifier, MPC name, and MPC magnitude for the nearest known Solar System object to the specified ZTF object\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object identifier, MPC name, and MPC magnitude for the nearest known Solar System object to the specified ZTF object\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```"
                },
                "in_toks": 2890,
                "out_toks": 103,
                "id": "chatcmpl-BwxFLrKsNvArBi4qe1AwNoxXtQM77",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "92": {
        "0": {
            "req_id": "92",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'feature']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 807,
                "out_toks": 25,
                "id": "chatcmpl-BjAcu22HHR4AHrUZNk69E0kYYB2PK",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 10 detections in the g band and no dubious corrections, optimized with nested queries\nWITH g_band_obj AS (\n    -- Find object IDs with >=10 detections in g band\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\nclean_objects AS (\n    -- Filter out objects with any dubious detection in g band\n    SELECT o.oid\n    FROM g_band_obj o\n    WHERE NOT EXISTS (\n        SELECT 1\n        FROM detection d2\n        WHERE d2.oid = o.oid\n          AND d2.fid = 1 -- g band\n          AND d2.dubious = TRUE\n    )\n)\n-- Retrieve probabilities with ranking=1 for the light curve classifier, limiting to 500 results\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    clean_objects co\nJOIN object o ON co.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name IS NOT NULL -- ensure class_name is present\n    AND p.classifier_version IS NOT NULL -- ensure classifier_version is present\nORDER BY o.oid\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 10 detections in the g band and no dubious corrections, optimized with nested queries\nWITH g_band_obj AS (\n    -- Find object IDs with >=10 detections in g band\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\nclean_objects AS (\n    -- Filter out objects with any dubious detection in g band\n    SELECT o.oid\n    FROM g_band_obj o\n    WHERE NOT EXISTS (\n        SELECT 1\n        FROM detection d2\n        WHERE d2.oid = o.oid\n          AND d2.fid = 1 -- g band\n          AND d2.dubious = TRUE\n    )\n)\n-- Retrieve probabilities with ranking=1 for the light curve classifier, limiting to 500 results\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    clean_objects co\nJOIN object o ON co.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name IS NOT NULL -- ensure class_name is present\n    AND p.classifier_version IS NOT NULL -- ensure classifier_version is present\nORDER BY o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 4601,
                "out_toks": 325,
                "id": "chatcmpl-Bx088LNs9mDTQwWPCvVjwPpK4RnNZ",
                "created": 1753401552,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with at least 10 detections in the g band and no dubious corrections\nWITH g_band_detections AS (\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\nfiltered_objects AS (\n    SELECT o.oid\n    FROM g_band_detections o\n    WHERE NOT EXISTS (\n        SELECT 1\n        FROM detection d2\n        WHERE d2.oid = o.oid\n          AND d2.fid = 1 -- g band\n          AND d2.dubious = TRUE\n    )\n)\n-- Retrieve probabilities with ranking=1 for the light curve classifier\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM filtered_objects fo\nJOIN object o ON fo.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nORDER BY o.oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with at least 10 detections in the g band and no dubious corrections\nWITH g_band_detections AS (\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\nfiltered_objects AS (\n    SELECT o.oid\n    FROM g_band_detections o\n    WHERE NOT EXISTS (\n        SELECT 1\n        FROM detection d2\n        WHERE d2.oid = o.oid\n          AND d2.fid = 1 -- g band\n          AND d2.dubious = TRUE\n    )\n)\n-- Retrieve probabilities with ranking=1 for the light curve classifier\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM filtered_objects fo\nJOIN object o ON fo.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nORDER BY o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 5553,
                "out_toks": 258,
                "id": "chatcmpl-BwxFNykhXVqNAfVCZyWrMYcN6y2gQ",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "92",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'feature']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 807,
                "out_toks": 25,
                "id": "chatcmpl-BjAcu22HHR4AHrUZNk69E0kYYB2PK",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 10 detections in the g band, corrected, and not dubious\nWITH g_band_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n      AND o.corrected = TRUE\n      AND o.corrected IS NOT NULL -- ensure corrected is not null, assuming boolean\n      AND o.dubious = FALSE -- check for non-dubious objects\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\n-- Filter probabilities for the light curve classifier with top ranking\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM g_band_objects)\n)\n-- Final selection of object info and probabilities\nSELECT o.oid AS \"ZTF identifier\",\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probabilities p\nJOIN object o ON p.oid = o.oid\nORDER BY o.oid\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 10 detections in the g band, corrected, and not dubious\nWITH g_band_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n      AND o.corrected = TRUE\n      AND o.corrected IS NOT NULL -- ensure corrected is not null, assuming boolean\n      AND o.dubious = FALSE -- check for non-dubious objects\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\n-- Filter probabilities for the light curve classifier with top ranking\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM g_band_objects)\n)\n-- Final selection of object info and probabilities\nSELECT o.oid AS \"ZTF identifier\",\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probabilities p\nJOIN object o ON p.oid = o.oid\nORDER BY o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 2183,
                "out_toks": 274,
                "id": "chatcmpl-Bx081zrnXdZ8ZjBTNjrNGDkC7dtFb",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH g_band_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n      AND o.corrected = TRUE\n      AND o.dubious = FALSE\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM g_band_objects)\n)\nSELECT o.oid AS \"ZTF identifier\",\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probabilities p\nJOIN object o ON p.oid = o.oid\nORDER BY o.oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH g_band_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE d.fid = 1 -- g band\n      AND o.corrected = TRUE\n      AND o.dubious = FALSE\n    GROUP BY o.oid\n    HAVING COUNT(*) >= 10\n),\nprobabilities AS (\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.oid IN (SELECT oid FROM g_band_objects)\n)\nSELECT o.oid AS \"ZTF identifier\",\n       p.classifier_version,\n       p.class_name,\n       p.probability\nFROM probabilities p\nJOIN object o ON p.oid = o.oid\nORDER BY o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 3122,
                "out_toks": 206,
                "id": "chatcmpl-BwxFOdRf3BbSpOo9AEZEl0mGabcOK",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "92",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "feature",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'feature', 'pipeline']"
                },
                "in_toks": 654,
                "out_toks": 17,
                "id": "chatcmpl-BwvKj0CfyqFoxjefHLZ7zxpFLl24y",
                "created": 1753383113,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Optimize the query by reducing the dataset early and ensuring proper filtering\nWITH g_band_objects AS (\n    -- Select objects with at least 10 detections in g band and no dubious detections\n    SELECT\n        d.oid\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10\n),\nclassified_objects AS (\n    -- Select objects with the top-ranked probability for the lc_classifier\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.oid IN (SELECT oid FROM g_band_objects)\n        -- Additional probability conditions for robustness\n        AND p.probability > 0.5 -- example threshold to filter confident classifications\n        AND p.classifier_version IS NOT NULL\n        AND p.class_name IS NOT NULL\n)\n-- Join with object table to get object identifiers and order\nSELECT\n    o.oid AS ztf_identifier,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    object o\nJOIN\n    classified_objects c ON o.oid = c.oid\nORDER BY\n    o.oid\nLIMIT 500;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Optimize the query by reducing the dataset early and ensuring proper filtering\nWITH g_band_objects AS (\n    -- Select objects with at least 10 detections in g band and no dubious detections\n    SELECT\n        d.oid\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10\n),\nclassified_objects AS (\n    -- Select objects with the top-ranked probability for the lc_classifier\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.oid IN (SELECT oid FROM g_band_objects)\n        -- Additional probability conditions for robustness\n        AND p.probability > 0.5 -- example threshold to filter confident classifications\n        AND p.classifier_version IS NOT NULL\n        AND p.class_name IS NOT NULL\n)\n-- Join with object table to get object identifiers and order\nSELECT\n    o.oid AS ztf_identifier,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    object o\nJOIN\n    classified_objects c ON o.oid = c.oid\nORDER BY\n    o.oid\nLIMIT 500;\n"
                },
                "in_toks": 4570,
                "out_toks": 305,
                "id": "chatcmpl-Bx0956CTzAl3dRapQFwbrsw2xpZ5m",
                "created": 1753401611,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10\n),\nclassified_objects AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.oid IN (SELECT oid FROM g_band_objects)\n)\nSELECT\n    o.oid AS ztf_identifier,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    object o\nJOIN\n    classified_objects c ON o.oid = c.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10\n),\nclassified_objects AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.oid IN (SELECT oid FROM g_band_objects)\n)\nSELECT\n    o.oid AS ztf_identifier,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    object o\nJOIN\n    classified_objects c ON o.oid = c.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 5632,
                "out_toks": 212,
                "id": "chatcmpl-BwxFMtp0f6rdYyYD7P5p8gPowoeig",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "92",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "feature",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'feature', 'pipeline']"
                },
                "in_toks": 654,
                "out_toks": 17,
                "id": "chatcmpl-BwvKkstqch5TIlGDLU1UDERdwjTTf",
                "created": 1753383114,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Optimize the query by filtering the probability table with additional conditions to reduce the dataset early\n-- Use nested subqueries to limit the number of rows processed in joins\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE\n        AND d.dubious = FALSE\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        -- Additional filtering to reduce dataset size, e.g., probability threshold\n        AND p.probability > 0.5\n)\n-- Main query joins only with filtered datasets to improve performance\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Optimize the query by filtering the probability table with additional conditions to reduce the dataset early\n-- Use nested subqueries to limit the number of rows processed in joins\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE\n        AND d.dubious = FALSE\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        -- Additional filtering to reduce dataset size, e.g., probability threshold\n        AND p.probability > 0.5\n)\n-- Main query joins only with filtered datasets to improve performance\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n"
                },
                "in_toks": 4626,
                "out_toks": 312,
                "id": "chatcmpl-Bx0813zQbR0cy58xTUzlQ5kaLfg0H",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE\n        AND d.dubious = FALSE\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE\n        AND d.dubious = FALSE\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 5632,
                "out_toks": 244,
                "id": "chatcmpl-BwxFPzjR7DDncQRGYjC0hfvYAogrC",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "92",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'pipeline']"
                },
                "in_toks": 654,
                "out_toks": 14,
                "id": "chatcmpl-BwvKkILaWy0ZHkvOxYOhW2xrSXaS1",
                "created": 1753383114,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 10 detections in the g band and no dubious detections\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS g_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE -- exclude dubious detections\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10 -- minimum detections\n),\n-- Select the top-ranked light curve classifier probabilities for each object\nclassified_objects AS (\n    SELECT\n        p.oid,\n        p.classifier_name,\n        p.classifier_version,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier' -- specific classifier\n        AND p.ranking = 1 -- top rank\n        AND p.probability IS NOT NULL -- ensure probability is not null\n)\n-- Join objects with their classification probabilities\nSELECT\n    o.oid AS ztf_id,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    g_band_objects o\nJOIN\n    classified_objects c ON o.oid = c.oid\n-- Optional: order by object id for consistency\nORDER BY\n    o.oid\n-- Limit to 500 results\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 10 detections in the g band and no dubious detections\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS g_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE -- exclude dubious detections\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10 -- minimum detections\n),\n-- Select the top-ranked light curve classifier probabilities for each object\nclassified_objects AS (\n    SELECT\n        p.oid,\n        p.classifier_name,\n        p.classifier_version,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier' -- specific classifier\n        AND p.ranking = 1 -- top rank\n        AND p.probability IS NOT NULL -- ensure probability is not null\n)\n-- Join objects with their classification probabilities\nSELECT\n    o.oid AS ztf_id,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    g_band_objects o\nJOIN\n    classified_objects c ON o.oid = c.oid\n-- Optional: order by object id for consistency\nORDER BY\n    o.oid\n-- Limit to 500 results\nLIMIT 500;\n```"
                },
                "in_toks": 2146,
                "out_toks": 301,
                "id": "chatcmpl-Bx07xDrm3xeG7u7hpFfbug4htGCyr",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS g_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10\n),\nclassified_objects AS (\n    SELECT\n        p.oid,\n        p.classifier_name,\n        p.classifier_version,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS ztf_id,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    g_band_objects o\nJOIN\n    classified_objects c ON o.oid = c.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS g_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n    HAVING\n        COUNT(*) >= 10\n),\nclassified_objects AS (\n    SELECT\n        p.oid,\n        p.classifier_name,\n        p.classifier_version,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS ztf_id,\n    c.classifier_version,\n    c.class_name,\n    c.probability\nFROM\n    g_band_objects o\nJOIN\n    classified_objects c ON o.oid = c.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 3200,
                "out_toks": 211,
                "id": "chatcmpl-BwxFQPgDRyCFZGPHKvwm5Gtm3vVOj",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "92",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'pipeline']"
                },
                "in_toks": 654,
                "out_toks": 14,
                "id": "chatcmpl-BwvKlEc16aeSyX50gI22g5QCKTE8l",
                "created": 1753383115,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 10 detections in the g band (fid=1) and no dubious detections in that band\nWITH g_band_objects AS (\n    SELECT\n        o.oid\n    FROM\n        object o\n    WHERE\n        -- Ensure the object has at least 10 non-dubious detections in g band\n        (\n            SELECT COUNT(*) FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n              AND d.dubious = FALSE\n        ) >= 10\n),\n-- Select probabilities with classifier 'lc_classifier' and ranking 1\nprobabilities_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\n-- Join objects with their top-ranked probabilities\nSELECT\n    o.oid AS \"ZTF Identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects o\nJOIN\n    probabilities_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 10 detections in the g band (fid=1) and no dubious detections in that band\nWITH g_band_objects AS (\n    SELECT\n        o.oid\n    FROM\n        object o\n    WHERE\n        -- Ensure the object has at least 10 non-dubious detections in g band\n        (\n            SELECT COUNT(*) FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n              AND d.dubious = FALSE\n        ) >= 10\n),\n-- Select probabilities with classifier 'lc_classifier' and ranking 1\nprobabilities_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\n-- Join objects with their top-ranked probabilities\nSELECT\n    o.oid AS \"ZTF Identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects o\nJOIN\n    probabilities_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 2265,
                "out_toks": 270,
                "id": "chatcmpl-Bx07xkKEAtriCXDuy26o1Fdcc0LyR",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter detections in g band (fid=1)\n        EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n              AND d.dubious = FALSE\n        )\n        -- Count detections in g band with no dubious flag\n        AND (\n            SELECT COUNT(*) FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n              AND d.dubious = FALSE\n        ) >= 10\n),\nprobabilities_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    g.oid AS \"ZTF Identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects g\nJOIN\n    probabilities_rank1 p ON g.oid = p.oid\nORDER BY\n    g.oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter detections in g band (fid=1)\n        EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n              AND d.dubious = FALSE\n        )\n        -- Count detections in g band with no dubious flag\n        AND (\n            SELECT COUNT(*) FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1\n              AND d.dubious = FALSE\n        ) >= 10\n),\nprobabilities_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_version,\n        p.class_name,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    g.oid AS \"ZTF Identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects g\nJOIN\n    probabilities_rank1 p ON g.oid = p.oid\nORDER BY\n    g.oid\nLIMIT 500;\n```"
                },
                "in_toks": 3200,
                "out_toks": 286,
                "id": "chatcmpl-BwxFOmjmgWJi1F9AGlBtKKrxS0V5p",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "92",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'pipeline']"
                },
                "in_toks": 654,
                "out_toks": 14,
                "id": "chatcmpl-BwvKmbM8haIK3IHsK04XGJ6qYVsR5",
                "created": 1753383116,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a CTE to select objects with at least 10 detections in g band, no dubious corrections, and with top-ranked lc_classifier probability\nWITH g_band_objects AS (\n    SELECT\n        o.oid\n    FROM\n        object o\n    WHERE\n        -- Filter objects with at least 10 detections\n        o.ndet >= 10\n        -- Exclude objects marked as dubious\n        AND NOT o.dubious\n        -- Ensure there is at least one detection in g band (fid=1) that is not corrected\n        AND EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1 -- g band filter\n              AND d.corrected = FALSE\n        )\n        -- Ensure the object has a probability entry with classifier 'lc_classifier' and ranking 1\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.classifier_name = 'lc_classifier'\n              AND p.ranking = 1\n        )\n)\n-- Select the desired columns, joining with probability to get classifier info\nSELECT\n    g.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects g\nJOIN\n    probability p ON p.oid = g.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\nORDER BY\n    g.oid\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a CTE to select objects with at least 10 detections in g band, no dubious corrections, and with top-ranked lc_classifier probability\nWITH g_band_objects AS (\n    SELECT\n        o.oid\n    FROM\n        object o\n    WHERE\n        -- Filter objects with at least 10 detections\n        o.ndet >= 10\n        -- Exclude objects marked as dubious\n        AND NOT o.dubious\n        -- Ensure there is at least one detection in g band (fid=1) that is not corrected\n        AND EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1 -- g band filter\n              AND d.corrected = FALSE\n        )\n        -- Ensure the object has a probability entry with classifier 'lc_classifier' and ranking 1\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.classifier_name = 'lc_classifier'\n              AND p.ranking = 1\n        )\n)\n-- Select the desired columns, joining with probability to get classifier info\nSELECT\n    g.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects g\nJOIN\n    probability p ON p.oid = g.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\nORDER BY\n    g.oid\nLIMIT 500;\n```"
                },
                "in_toks": 2200,
                "out_toks": 329,
                "id": "chatcmpl-Bx083yFedMAzpqs6BRxNXgfZXAG07",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.classifier_version,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter objects with at least 10 detections in g band\n        o.ndet >= 10\n        AND NOT o.dubious\n        AND EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1 -- g band filter\n              AND d.corrected = FALSE\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.classifier_name = 'lc_classifier'\n              AND p.ranking = 1\n        )\n)\nSELECT\n    g.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects g\nJOIN\n    probability p ON p.oid = g.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\nORDER BY\n    g.oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.classifier_version,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter objects with at least 10 detections in g band\n        o.ndet >= 10\n        AND NOT o.dubious\n        AND EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE d.oid = o.oid\n              AND d.fid = 1 -- g band filter\n              AND d.corrected = FALSE\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.classifier_name = 'lc_classifier'\n              AND p.ranking = 1\n        )\n)\nSELECT\n    g.oid AS ztf_identifier,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_objects g\nJOIN\n    probability p ON p.oid = g.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\nORDER BY\n    g.oid\nLIMIT 500;\n```"
                },
                "in_toks": 3200,
                "out_toks": 253,
                "id": "chatcmpl-BwxFHoeFznkgJQFsfvgG3M1B4MlpZ",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "92",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "feature",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'feature', 'pipeline']"
                },
                "in_toks": 654,
                "out_toks": 17,
                "id": "chatcmpl-BwvKmeAcphlYuhyvGpnjGQ8XP8Tit",
                "created": 1753383116,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 10 detections in the g band\nWITH g_band_objects AS (\n    SELECT\n        d.oid\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n),\n-- Filter objects that are corrected or have no correction\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.step_id_corr\n    FROM object o\n    JOIN g_band_objects g ON o.oid = g.oid\n    WHERE o.corrected IS FALSE OR o.corrected IS NULL\n),\n-- Retrieve the top-ranked probability classification for each object\ntop_probabilities AS (\n    SELECT DISTINCT ON (p.oid)\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking,\n        p.classifier_name,\n        p.classifier_version\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n    ORDER BY p.oid, p.classifier_version DESC -- prioritize latest classifier version if needed\n)\n-- Final selection with necessary joins and filters\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.step_id_corr AS \"classifier version\",\n    tp.class_name AS \"class name\",\n    tp.probability\nFROM filtered_objects o\nJOIN top_probabilities tp ON o.oid = tp.oid\nWHERE tp.classifier_name = 'lc_classifier'\nORDER BY o.oid\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 10 detections in the g band\nWITH g_band_objects AS (\n    SELECT\n        d.oid\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n),\n-- Filter objects that are corrected or have no correction\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.step_id_corr\n    FROM object o\n    JOIN g_band_objects g ON o.oid = g.oid\n    WHERE o.corrected IS FALSE OR o.corrected IS NULL\n),\n-- Retrieve the top-ranked probability classification for each object\ntop_probabilities AS (\n    SELECT DISTINCT ON (p.oid)\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking,\n        p.classifier_name,\n        p.classifier_version\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n    ORDER BY p.oid, p.classifier_version DESC -- prioritize latest classifier version if needed\n)\n-- Final selection with necessary joins and filters\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.step_id_corr AS \"classifier version\",\n    tp.class_name AS \"class name\",\n    tp.probability\nFROM filtered_objects o\nJOIN top_probabilities tp ON o.oid = tp.oid\nWHERE tp.classifier_name = 'lc_classifier'\nORDER BY o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 4691,
                "out_toks": 317,
                "id": "chatcmpl-Bx07yTYIV1d15xwAVSTJWsJoVtH8L",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) FILTER (WHERE d.fid = 1) AS g_detections\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(*) FILTER (WHERE d.fid = 1) >= 10\n),\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.step_id_corr,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM object o\n    JOIN g_band_objects g ON o.oid = g.oid\n    LEFT JOIN probability p ON o.oid = p.oid\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n    WHERE o.corrected IS FALSE OR o.corrected IS NULL\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.step_id_corr AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability\nFROM filtered_objects o\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier' AND p.ranking = 1\nORDER BY o.oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH g_band_objects AS (\n    SELECT\n        d.oid,\n        COUNT(*) FILTER (WHERE d.fid = 1) AS g_detections\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n    HAVING COUNT(*) FILTER (WHERE d.fid = 1) >= 10\n),\nfiltered_objects AS (\n    SELECT\n        o.oid,\n        o.step_id_corr,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM object o\n    JOIN g_band_objects g ON o.oid = g.oid\n    LEFT JOIN probability p ON o.oid = p.oid\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n    WHERE o.corrected IS FALSE OR o.corrected IS NULL\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.step_id_corr AS \"classifier version\",\n    p.class_name AS \"class name\",\n    p.probability\nFROM filtered_objects o\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier' AND p.ranking = 1\nORDER BY o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 5632,
                "out_toks": 263,
                "id": "chatcmpl-BwxFRrNyjN6suWE5opeU3o7KPdvB7",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "92",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'pipeline']"
                },
                "in_toks": 654,
                "out_toks": 14,
                "id": "chatcmpl-BwvKnFaYTwlFIdHrYsn0S6Xk9IP99",
                "created": 1753383117,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 10 detections in g band and no dubious detections in g band\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.classifier_version,\n        p.probability\n    FROM\n        object o\n    -- Count detections in g band (fid=1) for each object\n    WHERE\n        (SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid AND d.fid = 1) >= 10\n        -- Exclude objects with any dubious detection in g band\n        AND NOT EXISTS (\n            SELECT 1 FROM detection d WHERE d.oid = o.oid AND d.fid = 1 AND d.dubious = TRUE\n        )\n    -- Join with probability table to get probabilities for lc_classifier with ranking=1\n    JOIN\n        probability p ON p.oid = o.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\n-- Select desired columns, order by oid, limit to 500\nSELECT\n    oid AS \"ZTF Identifier\",\n    classifier_version,\n    class_name,\n    probability\nFROM\n    g_band_objects\nORDER BY\n    oid\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 10 detections in g band and no dubious detections in g band\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.classifier_version,\n        p.probability\n    FROM\n        object o\n    -- Count detections in g band (fid=1) for each object\n    WHERE\n        (SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid AND d.fid = 1) >= 10\n        -- Exclude objects with any dubious detection in g band\n        AND NOT EXISTS (\n            SELECT 1 FROM detection d WHERE d.oid = o.oid AND d.fid = 1 AND d.dubious = TRUE\n        )\n    -- Join with probability table to get probabilities for lc_classifier with ranking=1\n    JOIN\n        probability p ON p.oid = o.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\n-- Select desired columns, order by oid, limit to 500\nSELECT\n    oid AS \"ZTF Identifier\",\n    classifier_version,\n    class_name,\n    probability\nFROM\n    g_band_objects\nORDER BY\n    oid\nLIMIT 500;\n```"
                },
                "in_toks": 2278,
                "out_toks": 269,
                "id": "chatcmpl-Bx08AMf4iD4dm54QohfI7P7AVkJbZ",
                "created": 1753401554,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.classifier_version,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter objects with at least 10 detections in g band\n        (SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid AND d.fid = 1) >= 10\n        AND\n        -- Exclude objects with dubious corrections in g band\n        NOT EXISTS (\n            SELECT 1 FROM detection d\n            WHERE d.oid = o.oid AND d.fid = 1 AND d.dubious = TRUE\n        )\n    -- Join with probability table to get probabilities with ranking=1 for lc_classifier\n    JOIN\n        probability p ON p.oid = o.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    classifier_version,\n    class_name,\n    probability\nFROM\n    g_band_objects\nORDER BY\n    oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH g_band_objects AS (\n    SELECT\n        o.oid,\n        p.class_name,\n        p.classifier_version,\n        p.probability\n    FROM\n        object o\n    WHERE\n        -- Filter objects with at least 10 detections in g band\n        (SELECT COUNT(*) FROM detection d WHERE d.oid = o.oid AND d.fid = 1) >= 10\n        AND\n        -- Exclude objects with dubious corrections in g band\n        NOT EXISTS (\n            SELECT 1 FROM detection d\n            WHERE d.oid = o.oid AND d.fid = 1 AND d.dubious = TRUE\n        )\n    -- Join with probability table to get probabilities with ranking=1 for lc_classifier\n    JOIN\n        probability p ON p.oid = o.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    classifier_version,\n    class_name,\n    probability\nFROM\n    g_band_objects\nORDER BY\n    oid\nLIMIT 500;\n```"
                },
                "in_toks": 3200,
                "out_toks": 234,
                "id": "chatcmpl-BwxFSUhRdJwPqyRwsXWRXuc19zqRp",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "92",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "feature",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'feature', 'pipeline']"
                },
                "in_toks": 654,
                "out_toks": 17,
                "id": "chatcmpl-BwvKnQYLfbTJXnrNEN4ss6hKkJIIH",
                "created": 1753383117,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 10 detections in the g band, no dubious corrections, and with probability ranking 1\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE -- object has no dubious corrections\n        AND d.dubious = FALSE -- exclude dubious detections\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    -- Select probability info for objects with classifier 'lc_classifier' and top rank 1\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.classifier_version\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 10 detections in the g band, no dubious corrections, and with probability ranking 1\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE -- object has no dubious corrections\n        AND d.dubious = FALSE -- exclude dubious detections\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    -- Select probability info for objects with classifier 'lc_classifier' and top rank 1\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.classifier_version\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 4708,
                "out_toks": 300,
                "id": "chatcmpl-Bx07zWaeI6DxnGRRSS6NxYgUDB38D",
                "created": 1753401543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE -- no dubious corrections\n        AND d.dubious = FALSE -- exclude dubious detections\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_name,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH g_band_detections AS (\n    SELECT\n        o.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        d.fid = 1 -- g band\n        AND o.corrected = TRUE -- no dubious corrections\n        AND d.dubious = FALSE -- exclude dubious detections\n    GROUP BY\n        o.oid\n    HAVING\n        COUNT(*) >= 10\n),\nprob_rank1 AS (\n    SELECT\n        p.oid,\n        p.classifier_name,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    g_band_detections g\nJOIN\n    object o ON g.oid = o.oid\nJOIN\n    prob_rank1 p ON o.oid = p.oid\nORDER BY\n    o.oid\nLIMIT 500;\n```"
                },
                "in_toks": 5632,
                "out_toks": 258,
                "id": "chatcmpl-BwxFJs2MrasRY5AyKMXPJmBiRljfA",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "102": {
        "0": {
            "req_id": "102",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat']",
                    "1": "['object', 'probability', 'magstat']"
                },
                "in_toks": 798,
                "out_toks": 22,
                "id": "chatcmpl-BjAcvQz5VhKwIQbNQqsDylDCtaE3O",
                "created": 1750105309,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nJOIN agn_objects ao ON ms.oid = ao.oid\nWHERE ms.fid = 2 -- WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nJOIN agn_objects ao ON ms.oid = ao.oid\nWHERE ms.fid = 2 -- WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13\nLIMIT 50;\n```"
                },
                "in_toks": 3282,
                "out_toks": 182,
                "id": "chatcmpl-BwxFLzztfbdW42k0L3GmgXEjDQAuD",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "102",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat']",
                    "1": "['object', 'probability', 'magstat']"
                },
                "in_toks": 798,
                "out_toks": 22,
                "id": "chatcmpl-BjAcvQz5VhKwIQbNQqsDylDCtaE3O",
                "created": 1750105309,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM agn_objects);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM agn_objects);\n```"
                },
                "in_toks": 3282,
                "out_toks": 145,
                "id": "chatcmpl-BwxFLqRxtoqF91O0YliwkEcbwpEjx",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "102",
            "experiment_id": "run_2",
            "pred_tables": [
                "probability",
                "magstat",
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat', 'object', 'xmatch']"
                },
                "in_toks": 645,
                "out_toks": 15,
                "id": "chatcmpl-BwvKolBdomWB52aXOXiqob4Pd6ykc",
                "created": 1753383118,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```"
                },
                "in_toks": 3395,
                "out_toks": 158,
                "id": "chatcmpl-BwxFHQ31MprENuyjl0d0fOyuCTRQY",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "102",
            "experiment_id": "run_3",
            "pred_tables": [
                "probability",
                "magstat",
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat', 'object', 'xmatch']"
                },
                "in_toks": 645,
                "out_toks": 15,
                "id": "chatcmpl-BwvKprVScJkBHscMBEZTQyDJstFRn",
                "created": 1753383119,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```"
                },
                "in_toks": 3395,
                "out_toks": 158,
                "id": "chatcmpl-BwxFObSrWXsQ8GJc9sU5DQDl6SPre",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "102",
            "experiment_id": "run_4",
            "pred_tables": [
                "probability",
                "magstat",
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat', 'object', 'xmatch']"
                },
                "in_toks": 645,
                "out_toks": 15,
                "id": "chatcmpl-BwvKpJQkVBZfAxPalghRpYIV7woD5",
                "created": 1753383119,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```"
                },
                "in_toks": 3395,
                "out_toks": 158,
                "id": "chatcmpl-BwxFHctc1DqzbiNd9GIBTfNnd3quh",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "102",
            "experiment_id": "run_5",
            "pred_tables": [
                "probability",
                "magstat",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat', 'xmatch']"
                },
                "in_toks": 645,
                "out_toks": 12,
                "id": "chatcmpl-BwvKq5scrfeauMGxU6wjpQtHnCbrA",
                "created": 1753383120,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```"
                },
                "in_toks": 2913,
                "out_toks": 160,
                "id": "chatcmpl-BwxFHEedenR5GiKzf4YFBk190cer4",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "102",
            "experiment_id": "run_6",
            "pred_tables": [
                "probability",
                "magstat",
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat', 'object', 'xmatch']"
                },
                "in_toks": 645,
                "out_toks": 15,
                "id": "chatcmpl-BwvKqOcPDZs1NvVWbS559pJGoDlJG",
                "created": 1753383120,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```"
                },
                "in_toks": 3395,
                "out_toks": 158,
                "id": "chatcmpl-BwxFJmyMwtFlWZZzrcypRPb6C27ge",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "102",
            "experiment_id": "run_7",
            "pred_tables": [
                "probability",
                "magstat",
                "object",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat', 'object', 'xmatch']"
                },
                "in_toks": 645,
                "out_toks": 15,
                "id": "chatcmpl-BwvKrothLGzz9lQEFzpLAR3QbDnCz",
                "created": 1753383121,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1 -- most probable class\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM agn_objects)\n  AND m.fid = 2 -- WISE W1 band\n  AND m.magmean BETWEEN 12 AND 13\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1 -- most probable class\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM agn_objects)\n  AND m.fid = 2 -- WISE W1 band\n  AND m.magmean BETWEEN 12 AND 13\nLIMIT 50;\n```"
                },
                "in_toks": 3395,
                "out_toks": 161,
                "id": "chatcmpl-BwxFQyd9U9eIYSrpHVMlTwTbNSUCk",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "102",
            "experiment_id": "run_8",
            "pred_tables": [
                "probability",
                "magstat",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat', 'xmatch']"
                },
                "in_toks": 645,
                "out_toks": 12,
                "id": "chatcmpl-BwvKsanELhgYey4z9BRPTCi4WJe6W",
                "created": 1753383122,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_candidates AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects, filtering by WISE W1 magnitude\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM agn_candidates)\n  AND m.magmean_corr BETWEEN 12 AND 13;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_candidates AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects, filtering by WISE W1 magnitude\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (SELECT oid FROM agn_candidates)\n  AND m.magmean_corr BETWEEN 12 AND 13;\n```"
                },
                "in_toks": 2913,
                "out_toks": 135,
                "id": "chatcmpl-BwxFJ6TsFRp2ZaSuKPsu8af4WxXqZ",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "102",
            "experiment_id": "run_9",
            "pred_tables": [
                "probability",
                "magstat",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability', 'magstat', 'xmatch']"
                },
                "in_toks": 645,
                "out_toks": 12,
                "id": "chatcmpl-BwvKsWT9ypgyiiyuchxnwrTCLHGyt",
                "created": 1753383122,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n    ORDER BY ranking -- optional, to prioritize most probable\n    LIMIT 50\n)\n-- Retrieve all columns from magstat for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_objects)\n  AND ms.fid = 2 -- assuming fid=2 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13;\n```"
                },
                "in_toks": 2913,
                "out_toks": 160,
                "id": "chatcmpl-BwxFRfX1Pm6va1d5v5TPXky6Wyl1h",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "81": {
        "0": {
            "req_id": "81",
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 787,
                "out_toks": 8,
                "id": "chatcmpl-BjAcwinRrDXvbeDURO2Xz5PmhaGeJ",
                "created": 1750105310,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch xm ON xm.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND xm.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch xm ON xm.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND xm.catid = 'ALLWISE';\n```"
                },
                "in_toks": 864,
                "out_toks": 125,
                "id": "chatcmpl-Bx09CXDHDOl9t8mD72oZcqExJluH3",
                "created": 1753401618,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch xm\n    WHERE \n        xm.oid = o.oid\n        AND xm.catid = 'ALLWISE'\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch xm\n    WHERE \n        xm.oid = o.oid\n        AND xm.catid = 'ALLWISE'\n);\n```"
                },
                "in_toks": 2001,
                "out_toks": 87,
                "id": "chatcmpl-BwxFHUBRLK8uDYSIAEmzXTnFttraQ",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "81",
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 787,
                "out_toks": 8,
                "id": "chatcmpl-BjAcwinRrDXvbeDURO2Xz5PmhaGeJ",
                "created": 1750105310,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID from the object table and the distance from the xmatch table\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND x.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID from the object table and the distance from the xmatch table\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND x.catid = 'ALLWISE';\n```"
                },
                "in_toks": 866,
                "out_toks": 126,
                "id": "chatcmpl-Bx084RvSuLktWnoKMuylIoFvyNn5C",
                "created": 1753401548,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```"
                },
                "in_toks": 2001,
                "out_toks": 88,
                "id": "chatcmpl-BwxFL0lqipSwD2qYTlu5MCHiIJNoj",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "81",
            "experiment_id": "run_2",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 634,
                "out_toks": 4,
                "id": "chatcmpl-BwvKtWWZS7YOY3asBFKqUSlM0e1mu",
                "created": 1753383123,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join with xmatch to get matching catalog information\nJOIN \n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND \n    x.catid = 'ALLWISE'; -- Ensure the match is from the ALLWISE catalog\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join with xmatch to get matching catalog information\nJOIN \n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND \n    x.catid = 'ALLWISE'; -- Ensure the match is from the ALLWISE catalog\n```"
                },
                "in_toks": 866,
                "out_toks": 123,
                "id": "chatcmpl-Bx08AkAKExSamkSGoVPKWocgBF38q",
                "created": 1753401554,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```"
                },
                "in_toks": 2001,
                "out_toks": 88,
                "id": "chatcmpl-BwxFHSUhJbPAkSE1Rsk2LpwssGdyT",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "81",
            "experiment_id": "run_3",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 634,
                "out_toks": 4,
                "id": "chatcmpl-BwvKtKvStNG9tnCdOkiYN0tLuCsz4",
                "created": 1753383123,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch xm ON xm.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND xm.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch xm ON xm.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND xm.catid = 'ALLWISE';\n```"
                },
                "in_toks": 864,
                "out_toks": 125,
                "id": "chatcmpl-Bx07xL6VStQ5ERiZZZWVfr2s8Pqcj",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch xm\n    WHERE \n        xm.oid = o.oid\n        AND xm.catid = 'ALLWISE'\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch xm\n    WHERE \n        xm.oid = o.oid\n        AND xm.catid = 'ALLWISE'\n);\n```"
                },
                "in_toks": 2001,
                "out_toks": 87,
                "id": "chatcmpl-BwxFTXqGw3pcW7JzLMmawC19yblz1",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "81",
            "experiment_id": "run_4",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 634,
                "out_toks": 4,
                "id": "chatcmpl-BwvKthDLAaZNu2sR30kshJVh0veTD",
                "created": 1753383123,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nWHERE \n    x.catid = 'ALLWISE'\n    AND x.oid_catalog = 'J163603.54-065228.7';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nWHERE \n    x.catid = 'ALLWISE'\n    AND x.oid_catalog = 'J163603.54-065228.7';\n```"
                },
                "in_toks": 2001,
                "out_toks": 75,
                "id": "chatcmpl-BwxFNFXZ2ECm1ep7H7xnNBLoW44I5",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "81",
            "experiment_id": "run_5",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 634,
                "out_toks": 4,
                "id": "chatcmpl-BwvKuBnPn68jWF588qjFYNIFI8gKd",
                "created": 1753383124,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID from the object table and the distance from the xmatch table\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  -- Ensure the match is from the ALLWISE catalog\n  AND x.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID from the object table and the distance from the xmatch table\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  -- Ensure the match is from the ALLWISE catalog\n  AND x.catid = 'ALLWISE';\n```"
                },
                "in_toks": 866,
                "out_toks": 127,
                "id": "chatcmpl-Bx09EO9M1D6GTfWVuVjIYNQ74iv3t",
                "created": 1753401620,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```"
                },
                "in_toks": 2001,
                "out_toks": 88,
                "id": "chatcmpl-BwxFNJxfTnmk5Z5tRUml0xJ8Wf1HW",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "81",
            "experiment_id": "run_6",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 634,
                "out_toks": 4,
                "id": "chatcmpl-BwvKuNFFqduwRjvM2uIwXai1oNO7s",
                "created": 1753383124,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch xm ON xm.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND xm.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch xm ON xm.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND xm.catid = 'ALLWISE';\n```"
                },
                "in_toks": 864,
                "out_toks": 125,
                "id": "chatcmpl-Bx085CjWGPtJWW4hHGRdzeDMFX3TQ",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch xm\n    WHERE \n        xm.oid = o.oid\n        AND xm.catid = 'ALLWISE'\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    xm.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch xm\n    WHERE \n        xm.oid = o.oid\n        AND xm.catid = 'ALLWISE'\n);\n```"
                },
                "in_toks": 2001,
                "out_toks": 87,
                "id": "chatcmpl-BwxFNOZ8N1o8T8I1hBtldTOp75fOY",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "81",
            "experiment_id": "run_7",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 634,
                "out_toks": 4,
                "id": "chatcmpl-BwvKuAg7Q0Cgu7bP4rZmlBd27Z4Vg",
                "created": 1753383124,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the ZTF object ID and the distance from the xmatch table\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join the xmatch table to the object table on the object ID\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  -- Ensure the match is from the ALLWISE catalog\n  AND x.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the ZTF object ID and the distance from the xmatch table\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join the xmatch table to the object table on the object ID\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  -- Ensure the match is from the ALLWISE catalog\n  AND x.catid = 'ALLWISE';\n```"
                },
                "in_toks": 864,
                "out_toks": 125,
                "id": "chatcmpl-Bx0NfWSXv6ACxqod1IpGBYXpVTQ2T",
                "created": 1753402515,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch x\n    WHERE \n        x.oid = o.oid\n        AND x.catid = 'ALLWISE'\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch x\n    WHERE \n        x.oid = o.oid\n        AND x.catid = 'ALLWISE'\n);\n```"
                },
                "in_toks": 2001,
                "out_toks": 87,
                "id": "chatcmpl-BwxFPvWZtCW78pLXlzd7S4cY148CV",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "81",
            "experiment_id": "run_8",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 634,
                "out_toks": 4,
                "id": "chatcmpl-BwvKvvyBNqs4jjf1sOzsRTIAC7gbv",
                "created": 1753383125,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join with xmatch to get matching catalog information\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n    -- Ensure the match is from the ALLWISE catalog\n    AND x.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID and distance from the xmatch table for the specified object\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join with xmatch to get matching catalog information\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n    -- Ensure the match is from the ALLWISE catalog\n    AND x.catid = 'ALLWISE';\n```"
                },
                "in_toks": 866,
                "out_toks": 122,
                "id": "chatcmpl-Bx080ZEXqCKfdrGJI6ugiFe5uweoV",
                "created": 1753401544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```"
                },
                "in_toks": 2001,
                "out_toks": 88,
                "id": "chatcmpl-BwxFP0QYTq28qgyRvzr2I6Ughw7Zj",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "81",
            "experiment_id": "run_9",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 634,
                "out_toks": 4,
                "id": "chatcmpl-BwvKwT4KkeGJxxsMytMunFUApTY7q",
                "created": 1753383126,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID from the object table and the distance from the xmatch table\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND x.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID from the object table and the distance from the xmatch table\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\n-- Join the object table with the xmatch table on the object ID\nJOIN\n    xmatch x ON x.oid = o.oid\n-- Filter for the specific object ID\nWHERE \n    o.oid = 'J163603.54-065228.7'\n-- Ensure the match is from the ALLWISE catalog\n  AND x.catid = 'ALLWISE';\n```"
                },
                "in_toks": 866,
                "out_toks": 126,
                "id": "chatcmpl-Bx07xEl8Wm8NPd94MjzV0HlP6EK3M",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nWHERE \n    o.oid = 'J163603.54-065228.7'\n  AND EXISTS (\n    SELECT 1\n    FROM xmatch\n    WHERE \n        xmatch.oid = o.oid\n        AND xmatch.catid = 'ALLWISE'\n);\n```"
                },
                "in_toks": 2001,
                "out_toks": 88,
                "id": "chatcmpl-BwxFHcy3tIPvqToXfMsn60hWgwviE",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "69": {
        "0": {
            "req_id": "69",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']",
                    "1": "['object', 'ps1_ztf']"
                },
                "in_toks": 803,
                "out_toks": 20,
                "id": "chatcmpl-BjAcw7S2pAGIqCEVbFnXZz1ZclaOX",
                "created": 1750105310,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a CTE to find the nearest sources for each object with their star/galaxy scores and distances\nWITH nearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.distpsnr1,\n        p2.sgscore2,\n        p2.distpsnr2,\n        p3.sgscore3,\n        p3.distpsnr3\n    FROM\n        ps1_ztf p1\n    LEFT JOIN\n        ps1_ztf p2 ON p1.oid <> p2.oid\n    LEFT JOIN\n        ps1_ztf p3 ON p1.oid <> p3.oid\n    WHERE\n        p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n        AND p2.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n        AND p3.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\n\n-- Select rows from ps1_ztf for the specified objects where the nearest source with sgscore < 0.2 has the minimum distance\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nWHERE\n    p.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    AND (\n        -- For each object, check if the nearest source with sgscore < 0.2 is the closest (minimum distance)\n        (p.oid = 'ZTF21abstkhj' AND (\n            (EXISTS (\n                SELECT 1 FROM nearest_sources ns\n                WHERE ns.oid = p.oid\n                  AND ns.sgscore1 < 0.2\n                  AND ns.distpsnr1 = (\n                      SELECT MIN(distpsnr1) FROM nearest_sources WHERE oid = p.oid AND sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n                  )\n            ))\n        )) OR\n        (p.oid = 'ZTF22aacqjeb' AND (\n            (EXISTS (\n                SELECT 1 FROM nearest_sources ns\n                WHERE ns.oid = p.oid\n                  AND ns.sgscore2 < 0.2\n                  AND ns.distpsnr2 = (\n                      SELECT MIN(distpsnr2) FROM nearest_sources WHERE oid = p.oid AND sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n                  )\n            ))\n        )) OR\n        (p.oid = 'ZTF21aamwpdf' AND (\n            (EXISTS (\n                SELECT 1 FROM nearest_sources ns\n                WHERE ns.oid = p.oid\n                  AND ns.sgscore3 < 0.2\n                  AND ns.distpsnr3 = (\n                      SELECT MIN(distpsnr3) FROM nearest_sources WHERE oid = p.oid AND sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n                  )\n            ))\n        ))\n    );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a CTE to find the nearest sources for each object with their star/galaxy scores and distances\nWITH nearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.distpsnr1,\n        p2.sgscore2,\n        p2.distpsnr2,\n        p3.sgscore3,\n        p3.distpsnr3\n    FROM\n        ps1_ztf p1\n    LEFT JOIN\n        ps1_ztf p2 ON p1.oid <> p2.oid\n    LEFT JOIN\n        ps1_ztf p3 ON p1.oid <> p3.oid\n    WHERE\n        p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n        AND p2.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n        AND p3.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\n\n-- Select rows from ps1_ztf for the specified objects where the nearest source with sgscore < 0.2 has the minimum distance\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nWHERE\n    p.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    AND (\n        -- For each object, check if the nearest source with sgscore < 0.2 is the closest (minimum distance)\n        (p.oid = 'ZTF21abstkhj' AND (\n            (EXISTS (\n                SELECT 1 FROM nearest_sources ns\n                WHERE ns.oid = p.oid\n                  AND ns.sgscore1 < 0.2\n                  AND ns.distpsnr1 = (\n                      SELECT MIN(distpsnr1) FROM nearest_sources WHERE oid = p.oid AND sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n                  )\n            ))\n        )) OR\n        (p.oid = 'ZTF22aacqjeb' AND (\n            (EXISTS (\n                SELECT 1 FROM nearest_sources ns\n                WHERE ns.oid = p.oid\n                  AND ns.sgscore2 < 0.2\n                  AND ns.distpsnr2 = (\n                      SELECT MIN(distpsnr2) FROM nearest_sources WHERE oid = p.oid AND sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n                  )\n            ))\n        )) OR\n        (p.oid = 'ZTF21aamwpdf' AND (\n            (EXISTS (\n                SELECT 1 FROM nearest_sources ns\n                WHERE ns.oid = p.oid\n                  AND ns.sgscore3 < 0.2\n                  AND ns.distpsnr3 = (\n                      SELECT MIN(distpsnr3) FROM nearest_sources WHERE oid = p.oid AND sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n                  )\n            ))\n        ))\n    );\n```"
                },
                "in_toks": 3472,
                "out_toks": 673,
                "id": "chatcmpl-Bx07x7pc3FvjrsN5JWgQvKwCOw0ba",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH nearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.distpsnr1,\n        p2.sgscore2,\n        p2.distpsnr2,\n        p3.sgscore3,\n        p3.distpsnr3\n    FROM\n        ps1_ztf p1\n    LEFT JOIN\n        ps1_ztf p2 ON p1.oid <> p2.oid AND p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') AND p2.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    LEFT JOIN\n        ps1_ztf p3 ON p1.oid <> p3.oid AND p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') AND p3.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nWHERE\n    p.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    AND (\n        (p.oid = 'ZTF21abstkhj' AND (\n            (nearest_sources.sgscore1 < 0.2 AND nearest_sources.distpsnr1 = (\n                SELECT MIN(distpsnr1) FROM nearest_sources WHERE sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore2 < 0.2 AND nearest_sources.distpsnr2 = (\n                SELECT MIN(distpsnr2) FROM nearest_sources WHERE sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore3 < 0.2 AND nearest_sources.distpsnr3 = (\n                SELECT MIN(distpsnr3) FROM nearest_sources WHERE sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n            ))\n        )) OR\n        (p.oid = 'ZTF22aacqjeb' AND (\n            (nearest_sources.sgscore1 < 0.2 AND nearest_sources.distpsnr1 = (\n                SELECT MIN(distpsnr1) FROM nearest_sources WHERE sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore2 < 0.2 AND nearest_sources.distpsnr2 = (\n                SELECT MIN(distpsnr2) FROM nearest_sources WHERE sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore3 < 0.2 AND nearest_sources.distpsnr3 = (\n                SELECT MIN(distpsnr3) FROM nearest_sources WHERE sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n            ))\n        )) OR\n        (p.oid = 'ZTF21aamwpdf' AND (\n            (nearest_sources.sgscore1 < 0.2 AND nearest_sources.distpsnr1 = (\n                SELECT MIN(distpsnr1) FROM nearest_sources WHERE sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore2 < 0.2 AND nearest_sources.distpsnr2 = (\n                SELECT MIN(distpsnr2) FROM nearest_sources WHERE sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore3 < 0.2 AND nearest_sources.distpsnr3 = (\n                SELECT MIN(distpsnr3) FROM nearest_sources WHERE sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n            ))\n        ))\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH nearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.distpsnr1,\n        p2.sgscore2,\n        p2.distpsnr2,\n        p3.sgscore3,\n        p3.distpsnr3\n    FROM\n        ps1_ztf p1\n    LEFT JOIN\n        ps1_ztf p2 ON p1.oid <> p2.oid AND p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') AND p2.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    LEFT JOIN\n        ps1_ztf p3 ON p1.oid <> p3.oid AND p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') AND p3.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nWHERE\n    p.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    AND (\n        (p.oid = 'ZTF21abstkhj' AND (\n            (nearest_sources.sgscore1 < 0.2 AND nearest_sources.distpsnr1 = (\n                SELECT MIN(distpsnr1) FROM nearest_sources WHERE sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore2 < 0.2 AND nearest_sources.distpsnr2 = (\n                SELECT MIN(distpsnr2) FROM nearest_sources WHERE sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore3 < 0.2 AND nearest_sources.distpsnr3 = (\n                SELECT MIN(distpsnr3) FROM nearest_sources WHERE sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n            ))\n        )) OR\n        (p.oid = 'ZTF22aacqjeb' AND (\n            (nearest_sources.sgscore1 < 0.2 AND nearest_sources.distpsnr1 = (\n                SELECT MIN(distpsnr1) FROM nearest_sources WHERE sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore2 < 0.2 AND nearest_sources.distpsnr2 = (\n                SELECT MIN(distpsnr2) FROM nearest_sources WHERE sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore3 < 0.2 AND nearest_sources.distpsnr3 = (\n                SELECT MIN(distpsnr3) FROM nearest_sources WHERE sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n            ))\n        )) OR\n        (p.oid = 'ZTF21aamwpdf' AND (\n            (nearest_sources.sgscore1 < 0.2 AND nearest_sources.distpsnr1 = (\n                SELECT MIN(distpsnr1) FROM nearest_sources WHERE sgscore1 < 0.2 AND distpsnr1 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore2 < 0.2 AND nearest_sources.distpsnr2 = (\n                SELECT MIN(distpsnr2) FROM nearest_sources WHERE sgscore2 < 0.2 AND distpsnr2 IS NOT NULL\n            )) OR\n            (nearest_sources.sgscore3 < 0.2 AND nearest_sources.distpsnr3 = (\n                SELECT MIN(distpsnr3) FROM nearest_sources WHERE sgscore3 < 0.2 AND distpsnr3 IS NOT NULL\n            ))\n        ))\n    );\n```"
                },
                "in_toks": 3139,
                "out_toks": 847,
                "id": "chatcmpl-BwxFQXhjarcDHFZ0tQhILbOYnX0Mt",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "69",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']",
                    "1": "['object', 'ps1_ztf']"
                },
                "in_toks": 803,
                "out_toks": 20,
                "id": "chatcmpl-BjAcw7S2pAGIqCEVbFnXZz1ZclaOX",
                "created": 1750105310,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object IDs of interest\nWITH selected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n),\n-- For each object, find the closest source in ps1_ztf and its star/galaxy score\nnearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.sgscore2,\n        p1.sgscore3,\n        -- Determine the minimum distance among the three sources for each object\n        LEAST(p1.distpsnr1, p1.distpsnr2, p1.distpsnr3) AS min_dist\n    FROM\n        ps1_ztf p1\n    WHERE\n        p1.oid IN (SELECT oid FROM selected_objects)\n),\n-- For each object, identify the star/galaxy score of the nearest source based on the minimum distance\nnearest_source_scores AS (\n    SELECT\n        ns.oid,\n        -- Assign the star/galaxy score corresponding to the nearest source\n        CASE\n            WHEN ns.min_dist = ns.distpsnr1 THEN ns.sgscore1\n            WHEN ns.min_dist = ns.distpsnr2 THEN ns.sgscore2\n            WHEN ns.min_dist = ns.distpsnr3 THEN ns.sgscore3\n        END AS nearest_sgscore\n    FROM\n        nearest_sources ns\n)\n-- Retrieve all rows from ps1_ztf for the selected objects where the nearest source's star/galaxy score is below 0.2\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nJOIN\n    nearest_source_scores nss\nON\n    p.oid = nss.oid AND p.candid = (\n        -- Find the candid corresponding to the nearest source for each object\n        SELECT candid FROM nearest_sources ns\n        WHERE ns.oid = p.oid AND\n        (\n            (nss.nearest_sgscore = ns.sgscore1 AND ns.distpsnr1 = nss.min_dist) OR\n            (nss.nearest_sgscore = ns.sgscore2 AND ns.distpsnr2 = nss.min_dist) OR\n            (nss.nearest_sgscore = ns.sgscore3 AND ns.distpsnr3 = nss.min_dist)\n        )\n    )\nWHERE\n    nss.nearest_sgscore < 0.2;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object IDs of interest\nWITH selected_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n),\n-- For each object, find the closest source in ps1_ztf and its star/galaxy score\nnearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.sgscore2,\n        p1.sgscore3,\n        -- Determine the minimum distance among the three sources for each object\n        LEAST(p1.distpsnr1, p1.distpsnr2, p1.distpsnr3) AS min_dist\n    FROM\n        ps1_ztf p1\n    WHERE\n        p1.oid IN (SELECT oid FROM selected_objects)\n),\n-- For each object, identify the star/galaxy score of the nearest source based on the minimum distance\nnearest_source_scores AS (\n    SELECT\n        ns.oid,\n        -- Assign the star/galaxy score corresponding to the nearest source\n        CASE\n            WHEN ns.min_dist = ns.distpsnr1 THEN ns.sgscore1\n            WHEN ns.min_dist = ns.distpsnr2 THEN ns.sgscore2\n            WHEN ns.min_dist = ns.distpsnr3 THEN ns.sgscore3\n        END AS nearest_sgscore\n    FROM\n        nearest_sources ns\n)\n-- Retrieve all rows from ps1_ztf for the selected objects where the nearest source's star/galaxy score is below 0.2\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nJOIN\n    nearest_source_scores nss\nON\n    p.oid = nss.oid AND p.candid = (\n        -- Find the candid corresponding to the nearest source for each object\n        SELECT candid FROM nearest_sources ns\n        WHERE ns.oid = p.oid AND\n        (\n            (nss.nearest_sgscore = ns.sgscore1 AND ns.distpsnr1 = nss.min_dist) OR\n            (nss.nearest_sgscore = ns.sgscore2 AND ns.distpsnr2 = nss.min_dist) OR\n            (nss.nearest_sgscore = ns.sgscore3 AND ns.distpsnr3 = nss.min_dist)\n        )\n    )\nWHERE\n    nss.nearest_sgscore < 0.2;\n```"
                },
                "in_toks": 2413,
                "out_toks": 520,
                "id": "chatcmpl-Bx08C9R1D9JbP0JzGDXHxQA8SWgOt",
                "created": 1753401556,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH nearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.sgscore2,\n        p1.sgscore3,\n        -- Find the minimum distance among the three sources\n        LEAST(p1.distpsnr1, p1.distpsnr2, p1.distpsnr3) AS min_dist\n    FROM\n        ps1_ztf p1\n    WHERE\n        p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n),\nnearest_source_scores AS (\n    SELECT\n        ns.oid,\n        ns.candid,\n        -- Determine the star/galaxy score of the nearest source\n        CASE\n            WHEN ns.min_dist = ns.distpsnr1 THEN ns.sgscore1\n            WHEN ns.min_dist = ns.distpsnr2 THEN ns.sgscore2\n            WHEN ns.min_dist = ns.distpsnr3 THEN ns.sgscore3\n        END AS nearest_sgscore\n    FROM\n        nearest_sources ns\n)\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nJOIN\n    nearest_source_scores nss\nON\n    p.oid = nss.oid AND p.candid = nss.candid\nWHERE\n    nss.nearest_sgscore < 0.2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH nearest_sources AS (\n    SELECT\n        p1.oid,\n        p1.candid,\n        p1.sgscore1,\n        p1.sgscore2,\n        p1.sgscore3,\n        -- Find the minimum distance among the three sources\n        LEAST(p1.distpsnr1, p1.distpsnr2, p1.distpsnr3) AS min_dist\n    FROM\n        ps1_ztf p1\n    WHERE\n        p1.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n),\nnearest_source_scores AS (\n    SELECT\n        ns.oid,\n        ns.candid,\n        -- Determine the star/galaxy score of the nearest source\n        CASE\n            WHEN ns.min_dist = ns.distpsnr1 THEN ns.sgscore1\n            WHEN ns.min_dist = ns.distpsnr2 THEN ns.sgscore2\n            WHEN ns.min_dist = ns.distpsnr3 THEN ns.sgscore3\n        END AS nearest_sgscore\n    FROM\n        nearest_sources ns\n)\nSELECT\n    p.*\nFROM\n    ps1_ztf p\nJOIN\n    nearest_source_scores nss\nON\n    p.oid = nss.oid AND p.candid = nss.candid\nWHERE\n    nss.nearest_sgscore < 0.2;\n```"
                },
                "in_toks": 3139,
                "out_toks": 296,
                "id": "chatcmpl-BwxFQAmNHGp4dFAnEp8BKBSY5PAt8",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "69",
            "experiment_id": "run_2",
            "pred_tables": [
                "ps1_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf', 'xmatch']"
                },
                "in_toks": 650,
                "out_toks": 11,
                "id": "chatcmpl-BwvKx4Tdj9oRlwKZOAbAsSi7q0LYd",
                "created": 1753383127,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1\n     FROM ps1_ztf AS sub\n     WHERE sub.oid = ps1_ztf.oid\n     LIMIT 1\n    ) < 0.2\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1\n     FROM ps1_ztf AS sub\n     WHERE sub.oid = ps1_ztf.oid\n     LIMIT 1\n    ) < 0.2\n  );\n```"
                },
                "in_toks": 2771,
                "out_toks": 208,
                "id": "chatcmpl-BwxFN4rr11MMPv7WzBoyFF7NS2oDh",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "69",
            "experiment_id": "run_3",
            "pred_tables": [
                "ps1_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf', 'xmatch']"
                },
                "in_toks": 650,
                "out_toks": 11,
                "id": "chatcmpl-BwvKxnWUksZsFvgjdccrZWYZbe9Ft",
                "created": 1753383127,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1 FROM ps1_ztf AS sub WHERE sub.oid = ps1_ztf.oid LIMIT 1) < 0.2\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1 FROM ps1_ztf AS sub WHERE sub.oid = ps1_ztf.oid LIMIT 1) < 0.2\n  );\n```"
                },
                "in_toks": 2771,
                "out_toks": 200,
                "id": "chatcmpl-BwxFHH7SDgu43p8BEXazhjlBjs2xv",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "69",
            "experiment_id": "run_4",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvKymDW8cO04OKVWOOw58GYc58EZ",
                "created": 1753383128,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from ps1_ztf where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE\n    -- Filter for specific ZTF identifiers\n    oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    AND\n    -- Ensure the star/galaxy score of the nearest source (sgscore1) is less than 0.2\n    sgscore1 < 0.2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from ps1_ztf where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE\n    -- Filter for specific ZTF identifiers\n    oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n    AND\n    -- Ensure the star/galaxy score of the nearest source (sgscore1) is less than 0.2\n    sgscore1 < 0.2;\n```"
                },
                "in_toks": 2657,
                "out_toks": 121,
                "id": "chatcmpl-BwxFO639FMCDz5Tx0ND3pDCGm6Bfe",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "69",
            "experiment_id": "run_5",
            "pred_tables": [
                "ps1_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf', 'xmatch']"
                },
                "in_toks": 650,
                "out_toks": 11,
                "id": "chatcmpl-BwvKyyLYbfSkZbN28PqIWtZJlhBJb",
                "created": 1753383128,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1\n     FROM ps1_ztf AS sub\n     WHERE sub.oid = ps1_ztf.oid\n     LIMIT 1\n    ) < 0.2\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1\n     FROM ps1_ztf AS sub\n     WHERE sub.oid = ps1_ztf.oid\n     LIMIT 1\n    ) < 0.2\n  );\n```"
                },
                "in_toks": 2771,
                "out_toks": 208,
                "id": "chatcmpl-BwxFI2njNmjYCMVa1e371mzvk5tLT",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "69",
            "experiment_id": "run_6",
            "pred_tables": [
                "ps1_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf', 'xmatch']"
                },
                "in_toks": 650,
                "out_toks": 11,
                "id": "chatcmpl-BwvKy0CFtvPWhUBdvayd1sqQ2V7V0",
                "created": 1753383128,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all rows from ps1_ztf where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Select object IDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND (\n    -- For each object, find the star/galaxy score of the nearest source\n    SELECT sgscore1\n    FROM ps1_ztf p2\n    WHERE p2.oid = ps1_ztf.oid\n    ORDER BY distpsnr1\n    LIMIT 1\n) < 0.2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all rows from ps1_ztf where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN (\n    -- Select object IDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nAND (\n    -- For each object, find the star/galaxy score of the nearest source\n    SELECT sgscore1\n    FROM ps1_ztf p2\n    WHERE p2.oid = ps1_ztf.oid\n    ORDER BY distpsnr1\n    LIMIT 1\n) < 0.2;\n```"
                },
                "in_toks": 2771,
                "out_toks": 168,
                "id": "chatcmpl-BwxFOpnkJdXLRNs6biO1I35IYknFC",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "69",
            "experiment_id": "run_7",
            "pred_tables": [
                "ps1_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf', 'xmatch']"
                },
                "in_toks": 650,
                "out_toks": 11,
                "id": "chatcmpl-BwvKzA1isHGfMBYybSYvuzg2L18rG",
                "created": 1753383129,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1\n     FROM ps1_ztf AS sub\n     WHERE sub.oid = ps1_ztf.oid\n     LIMIT 1\n    ) < 0.2\n  );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the ps1_ztf rows for specified objects where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND distpsnr1 = (\n    -- Subquery to find the star/galaxy score of the nearest source for each object\n    SELECT sgscore1\n    FROM ps1_ztf AS sub\n    WHERE sub.oid = ps1_ztf.oid\n    LIMIT 1\n  )\n  AND (\n    -- Ensure the star/galaxy score of the nearest source is less than 0.2\n    (SELECT sgscore1\n     FROM ps1_ztf AS sub\n     WHERE sub.oid = ps1_ztf.oid\n     LIMIT 1\n    ) < 0.2\n  );\n```"
                },
                "in_toks": 2771,
                "out_toks": 208,
                "id": "chatcmpl-BwxFHc382M1cLbde3zap53T0FtlFE",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "69",
            "experiment_id": "run_8",
            "pred_tables": [
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvL0jQI9GOoHBYsnR0yKi6htbwnT",
                "created": 1753383130,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from ps1_ztf where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE\n  -- Filter for specific ZTF object identifiers\n  oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND\n  -- The star/galaxy score of the nearest source (sgscore1) is less than 0.2\n  sgscore1 < 0.2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from ps1_ztf where the star/galaxy score of the nearest source is less than 0.2\nSELECT *\nFROM ps1_ztf\nWHERE\n  -- Filter for specific ZTF object identifiers\n  oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n  AND\n  -- The star/galaxy score of the nearest source (sgscore1) is less than 0.2\n  sgscore1 < 0.2;\n```"
                },
                "in_toks": 2657,
                "out_toks": 121,
                "id": "chatcmpl-BwxFHMZgSVNANhAyEKsMoOxw4eL9L",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "69",
            "experiment_id": "run_9",
            "pred_tables": [
                "ps1_ztf",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ps1_ztf', 'xmatch']"
                },
                "in_toks": 650,
                "out_toks": 11,
                "id": "chatcmpl-BwvL06BJbbyfWzJvExY1gKlBxky5H",
                "created": 1753383130,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve the OIDs for the specified objects\nWITH target_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n),\nnearest_sources AS (\n    SELECT\n        t.oid,\n        p1.sgscore1 AS star_galaxy_score\n    FROM\n        target_objects t\n    JOIN\n        ps1_ztf p1 ON t.oid = p1.oid\n    WHERE\n        p1.sgscore1 = (\n            SELECT MIN(sgscore1)\n            FROM ps1_ztf p2\n            WHERE p2.oid = t.oid\n        )\n)\nSELECT\n    p.*\nFROM\n    nearest_sources ns\nJOIN\n    ps1_ztf p ON ns.oid = p.oid AND ns.star_galaxy_score = p.sgscore1\nWHERE\n    ns.star_galaxy_score < 0.2;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the OIDs for the specified objects\nWITH target_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n),\nnearest_sources AS (\n    SELECT\n        t.oid,\n        p1.sgscore1 AS star_galaxy_score\n    FROM\n        target_objects t\n    JOIN\n        ps1_ztf p1 ON t.oid = p1.oid\n    WHERE\n        p1.sgscore1 = (\n            SELECT MIN(sgscore1)\n            FROM ps1_ztf p2\n            WHERE p2.oid = t.oid\n        )\n)\nSELECT\n    p.*\nFROM\n    nearest_sources ns\nJOIN\n    ps1_ztf p ON ns.oid = p.oid AND ns.star_galaxy_score = p.sgscore1\nWHERE\n    ns.star_galaxy_score < 0.2;\n```"
                },
                "in_toks": 2771,
                "out_toks": 212,
                "id": "chatcmpl-BwxFI1hAK7S0Am8pLarguJAxDRQpT",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "61": {
        "0": {
            "req_id": "61",
            "experiment_id": "run_0",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 788,
                "out_toks": 8,
                "id": "chatcmpl-BjAcxk1vT6qzcXwfl6xfQuWix3uSQ",
                "created": 1750105311,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFKNUzZwxdW8WT9yJsk81Y6MjTz",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "61",
            "experiment_id": "run_1",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 788,
                "out_toks": 8,
                "id": "chatcmpl-BjAcxk1vT6qzcXwfl6xfQuWix3uSQ",
                "created": 1750105311,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFIWJ59QyH1E7DjIdADnGfK8MP4",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "61",
            "experiment_id": "run_2",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 635,
                "out_toks": 4,
                "id": "chatcmpl-BwvL1wt5sAPqnrVi1GSpzIfNJ62gg",
                "created": 1753383131,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFHBgHfLdMof78zy58D4PVW3yfj",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "61",
            "experiment_id": "run_3",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 635,
                "out_toks": 4,
                "id": "chatcmpl-BwvL2Q33OO1kxTW7QKwbdsTLfiGT5",
                "created": 1753383132,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFQqV4G5tofZaxId7w9ElZpcZm2",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "61",
            "experiment_id": "run_4",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 635,
                "out_toks": 4,
                "id": "chatcmpl-BwvL2iLoV4GYtYEKdNcwibvNICqtf",
                "created": 1753383132,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFHn8q7WHkiGGQI0ECycWHFr6K6",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "61",
            "experiment_id": "run_5",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 635,
                "out_toks": 4,
                "id": "chatcmpl-BwvL27UByDulJdcNMPzWNRASFYbTu",
                "created": 1753383132,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFLQUN7qMQ0xfMZEIVJgvpemQwu",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "61",
            "experiment_id": "run_6",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 635,
                "out_toks": 4,
                "id": "chatcmpl-BwvL3He0CZc8z4AMI50gS2NqY70UD",
                "created": 1753383133,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFHrgy0daM7lwTXHGZ1V0Pa2VJh",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "61",
            "experiment_id": "run_7",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 635,
                "out_toks": 4,
                "id": "chatcmpl-BwvL3oyZD0m6YLAWXCglTO18vmb1t",
                "created": 1753383133,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFSlYDkYyZRsF1g0AdNVDIO4eWN",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "61",
            "experiment_id": "run_8",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 635,
                "out_toks": 4,
                "id": "chatcmpl-BwvL4WsWXIDfEbcr57CfqFUNZT0fh",
                "created": 1753383134,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFK5fwI9MgUTCpIm5vzGdX5IRZ1",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "61",
            "experiment_id": "run_9",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 635,
                "out_toks": 4,
                "id": "chatcmpl-BwvL4q4Dr68fM1KyEC3N1CQEHl5SK",
                "created": 1753383134,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2617,
                "out_toks": 42,
                "id": "chatcmpl-BwxFMxnijr2qPr7ZPXQnd93Kwn4Qn",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "104": {
        "0": {
            "req_id": "104",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ss_ztf",
                "reference",
                "detection",
                "magstat",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ss_ztf', 'reference', 'detection', 'magstat', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ss_ztf', 'reference', 'detection', 'magstat', 'ps1_ztf']"
                },
                "in_toks": 836,
                "out_toks": 62,
                "id": "chatcmpl-BjAcxZTTRzl2BbIFEntVdQ5asKKlq",
                "created": 1750105311,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, p.oid, p.probability\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    so.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssnamenr,\n    s.ssmagnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    d.drb,\n    d.drbversion,\n    d.step_id_corr\nFROM selected_objects so\nJOIN ss_ztf s ON so.oid = s.oid\nJOIN detection d ON s.candid = d.candid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, p.oid, p.probability\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    so.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssnamenr,\n    s.ssmagnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    d.drb,\n    d.drbversion,\n    d.step_id_corr\nFROM selected_objects so\nJOIN ss_ztf s ON so.oid = s.oid\nJOIN detection d ON s.candid = d.candid;\n```"
                },
                "in_toks": 4110,
                "out_toks": 250,
                "id": "chatcmpl-Bx09HWynk3LErIOmTBYdi62G8trAT",
                "created": 1753401623,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, s.magnr\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN ss_ztf s ON o.oid = s.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    so.magnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    d.drb,\n    d.drbversion,\n    d.step_id_corr\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, s.magnr\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN ss_ztf s ON o.oid = s.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT\n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    so.magnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    d.drb,\n    d.drbversion,\n    d.step_id_corr\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid;\n```"
                },
                "in_toks": 5149,
                "out_toks": 262,
                "id": "chatcmpl-BwxFMBDZxGKZYNQvJNdHlMXMFOqf8",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "104",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "ss_ztf",
                "reference",
                "detection",
                "magstat",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ss_ztf', 'reference', 'detection', 'magstat', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ss_ztf', 'reference', 'detection', 'magstat', 'ps1_ztf']"
                },
                "in_toks": 836,
                "out_toks": 62,
                "id": "chatcmpl-BjAcxZTTRzl2BbIFEntVdQ5asKKlq",
                "created": 1750105311,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, p.oid, p.probability\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT \n    so.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssnamenr,\n    s.ssmagnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    -- Additional columns from detection table as per user request\n    d.magap,\n    d.rid,\n    d.exptime\nFROM selected_objects so\nJOIN ss_ztf s ON so.oid = s.oid\nJOIN detection d ON s.candid = d.candid;\n-- Note: 'exptime' is not in the provided schema; if needed, replace with correct column if available.",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, p.oid, p.probability\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT \n    so.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssnamenr,\n    s.ssmagnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    -- Additional columns from detection table as per user request\n    d.magap,\n    d.rid,\n    d.exptime\nFROM selected_objects so\nJOIN ss_ztf s ON so.oid = s.oid\nJOIN detection d ON s.candid = d.candid;\n-- Note: 'exptime' is not in the provided schema; if needed, replace with correct column if available."
                },
                "in_toks": 4108,
                "out_toks": 293,
                "id": "chatcmpl-Bx07x7hIjbjD89WS33wzKp6MbCemZ",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, s.magnr\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN ss_ztf s ON o.oid = s.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT \n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    so.magnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    d.rp,\n    d.drb,\n    d.drbversion\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, s.magnr\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN ss_ztf s ON o.oid = s.oid\n    WHERE p.class_name = 'asteroid'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n)\nSELECT \n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    so.magnr,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.distnr,\n    d.mjd,\n    d.rp,\n    d.drb,\n    d.drbversion\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid;\n```"
                },
                "in_toks": 5149,
                "out_toks": 261,
                "id": "chatcmpl-BwxFJSjoR5dxOlFcsoILemhgOX0St",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "104",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "gaia_ztf",
                "ss_ztf",
                "ps1_ztf",
                "reference",
                "detection",
                "magstat",
                "non_detection",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'gaia_ztf', 'ss_ztf', 'ps1_ztf', 'reference', 'detection', 'magstat', 'non_detection', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 683,
                "out_toks": 52,
                "id": "chatcmpl-BwvL5qOtPJd1tskfEgJgWT4J3JGJL",
                "created": 1753383135,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\nWITH selected_objects AS (\n    -- Select objects with probability > 0.9 of being an asteroid (assuming class_name='Asteroid' or similar; adjust if needed)\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'Asteroid' -- Adjust class_name if different for asteroids\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n),\nnearest_ss AS (\n    -- Get nearest solar system object info\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    -- Get detection info for selected objects\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.distnr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM selected_objects)\n),\nps1_info AS (\n    -- Get closest PS1 source info\n    SELECT p.oid, p.candid, p.objectidps1, p.sgmag1, p.distpsnr1\n    FROM ps1_ztf p\n),\nfilter_exposure AS (\n    -- Get filter info: FWHM and exposure time\n    SELECT f.fid, f.fwhm, f.exptime\n    FROM filter f\n)\nSELECT\n    o.oid,\n    ns.ssnamenr AS sso_name,\n    ns.ssdistnr AS sso_distance,\n    ns.ssmagnr AS sso_mpc_mag,\n    ci.candid,\n    ci.fid,\n    fi.fwhm,\n    fi.exptime,\n    -- Additional info from detection\n    ci.magpsf,\n    ci.sigmapsf,\n    ci.distnr,\n    -- PS1 info\n    pi.objectidps1,\n    pi.sgmag1,\n    pi.distpsnr1\nFROM object o\nLEFT JOIN nearest_ss ns ON o.oid = ns.oid\nJOIN candidate_info ci ON o.oid = ci.oid\nJOIN filter_exposure fi ON ci.fid = fi.fid\nLEFT JOIN ps1_info pi ON o.oid = pi.oid AND ci.candid = pi.candid\nORDER BY -- No explicit probability column in final; order by probability if needed, but not available here\nLIMIT 30;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\nWITH selected_objects AS (\n    -- Select objects with probability > 0.9 of being an asteroid (assuming class_name='Asteroid' or similar; adjust if needed)\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'Asteroid' -- Adjust class_name if different for asteroids\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n),\nnearest_ss AS (\n    -- Get nearest solar system object info\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    -- Get detection info for selected objects\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.distnr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM selected_objects)\n),\nps1_info AS (\n    -- Get closest PS1 source info\n    SELECT p.oid, p.candid, p.objectidps1, p.sgmag1, p.distpsnr1\n    FROM ps1_ztf p\n),\nfilter_exposure AS (\n    -- Get filter info: FWHM and exposure time\n    SELECT f.fid, f.fwhm, f.exptime\n    FROM filter f\n)\nSELECT\n    o.oid,\n    ns.ssnamenr AS sso_name,\n    ns.ssdistnr AS sso_distance,\n    ns.ssmagnr AS sso_mpc_mag,\n    ci.candid,\n    ci.fid,\n    fi.fwhm,\n    fi.exptime,\n    -- Additional info from detection\n    ci.magpsf,\n    ci.sigmapsf,\n    ci.distnr,\n    -- PS1 info\n    pi.objectidps1,\n    pi.sgmag1,\n    pi.distpsnr1\nFROM object o\nLEFT JOIN nearest_ss ns ON o.oid = ns.oid\nJOIN candidate_info ci ON o.oid = ci.oid\nJOIN filter_exposure fi ON ci.fid = fi.fid\nLEFT JOIN ps1_info pi ON o.oid = pi.oid AND ci.candid = pi.candid\nORDER BY -- No explicit probability column in final; order by probability if needed, but not available here\nLIMIT 30;\n"
                },
                "in_toks": 7579,
                "out_toks": 550,
                "id": "chatcmpl-Bx081JVzJ9fxfG2Vw2Q8sEYyDz9sY",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.distnr, d.rid, d.mjd, d.magap, d.sigmagap\n    FROM detection d\n),\nps1_info AS (\n    SELECT p.oid, p.candid, p.objectidps1, p.sgmag1, p.distpsnr1\n    FROM ps1_ztf p\n),\nfilter_exposure AS (\n    SELECT f.fid, f.fwhm, f.exptime, f.ncalib\n    FROM filter f\n),\nfinal AS (\n    SELECT \n        so.oid, \n        so.ssnamenr AS sso_name,\n        so.ssdistnr AS sso_distance,\n        so.ssmagnr AS sso_mpc_mag,\n        ci.candid,\n        ci.fid,\n        fi.fwhm,\n        pi.ncalib,\n        fi.exptime,\n        ci.magpsf,\n        ci.distnr,\n        ci.rid,\n        ci.mjd,\n        ci.magap,\n        ci.sigmagap\n    FROM selected_objects so\n    JOIN nearest_ss ns ON so.oid = ns.oid\n    JOIN candidate_info ci ON so.oid = ci.oid AND so.oid = ci.oid\n    LEFT JOIN ps1_info pi ON so.oid = pi.oid AND ci.candid = pi.candid\n    JOIN filter_exposure fi ON ci.fid = fi.fid\n)\nSELECT \n    oid,\n    candid,\n    sso_distance,\n    sso_mpc_mag,\n    sso_name,\n    fid,\n    magpsf,\n    fwhm,\n    ncalib,\n    exptime\nFROM final\nORDER BY probability DESC -- Note: probability is not directly selected here; assuming the probability info is embedded in the selection criteria\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.distnr, d.rid, d.mjd, d.magap, d.sigmagap\n    FROM detection d\n),\nps1_info AS (\n    SELECT p.oid, p.candid, p.objectidps1, p.sgmag1, p.distpsnr1\n    FROM ps1_ztf p\n),\nfilter_exposure AS (\n    SELECT f.fid, f.fwhm, f.exptime, f.ncalib\n    FROM filter f\n),\nfinal AS (\n    SELECT \n        so.oid, \n        so.ssnamenr AS sso_name,\n        so.ssdistnr AS sso_distance,\n        so.ssmagnr AS sso_mpc_mag,\n        ci.candid,\n        ci.fid,\n        fi.fwhm,\n        pi.ncalib,\n        fi.exptime,\n        ci.magpsf,\n        ci.distnr,\n        ci.rid,\n        ci.mjd,\n        ci.magap,\n        ci.sigmagap\n    FROM selected_objects so\n    JOIN nearest_ss ns ON so.oid = ns.oid\n    JOIN candidate_info ci ON so.oid = ci.oid AND so.oid = ci.oid\n    LEFT JOIN ps1_info pi ON so.oid = pi.oid AND ci.candid = pi.candid\n    JOIN filter_exposure fi ON ci.fid = fi.fid\n)\nSELECT \n    oid,\n    candid,\n    sso_distance,\n    sso_mpc_mag,\n    sso_name,\n    fid,\n    magpsf,\n    fwhm,\n    ncalib,\n    exptime\nFROM final\nORDER BY probability DESC -- Note: probability is not directly selected here; assuming the probability info is embedded in the selection criteria\nLIMIT 30;"
                },
                "in_toks": 8046,
                "out_toks": 570,
                "id": "chatcmpl-BwxFN2fulBTz5qQQjmHHeyD5CYjov",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "104",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "gaia_ztf",
                "ss_ztf",
                "ps1_ztf",
                "reference",
                "detection",
                "magstat",
                "non_detection",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'gaia_ztf', 'ss_ztf', 'ps1_ztf', 'reference', 'detection', 'magstat', 'non_detection', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 683,
                "out_toks": 52,
                "id": "chatcmpl-BwvL6krB1dSOqGsnKx5z8e6uiwlZO",
                "created": 1753383136,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- filter for asteroid class\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n)\nSELECT \n    so.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearest_sso,\n    ss.ssnamenr AS sso_name,\n    -- MPC archive magnitude and name (assuming MPC info is stored in a feature table or similar; if not, this part is a placeholder)\n    -- For demonstration, assuming 'mpc_mag' and 'mpc_name' are features\n    f_mpc_mag.value AS mpc_magnitude,\n    f_mpc_name.value AS mpc_name,\n    -- Additional candidate info\n    d.fid AS filter_id,\n    d.sigmapsf AS fwhm, -- assuming sigmapsf as a proxy for FWHM from SExtractor\n    -- Number of PS1 calibrators used (assuming stored in feature table with name 'n_ps1_calibrators')\n    f_ps1_calibrators.value AS n_ps1_calibrators,\n    -- Exposure time (assuming stored in detection table or feature; here, using 'pid' as placeholder)\n    d.pid AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid\nLEFT JOIN ss_ztf ss ON so.oid = ss.oid\nLEFT JOIN feature f_mpc_mag ON so.oid = f_mpc_mag.oid AND f_mpc_mag.name = 'mpc_mag'\nLEFT JOIN feature f_mpc_name ON so.oid = f_mpc_name.oid AND f_mpc_name.name = 'mpc_name'\nLEFT JOIN feature f_ps1_calibrators ON so.oid = f_ps1_calibrators.oid AND f_ps1_calibrators.name = 'n_ps1_calibrators'\nWHERE d.oid = so.oid;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- filter for asteroid class\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n)\nSELECT \n    so.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearest_sso,\n    ss.ssnamenr AS sso_name,\n    -- MPC archive magnitude and name (assuming MPC info is stored in a feature table or similar; if not, this part is a placeholder)\n    -- For demonstration, assuming 'mpc_mag' and 'mpc_name' are features\n    f_mpc_mag.value AS mpc_magnitude,\n    f_mpc_name.value AS mpc_name,\n    -- Additional candidate info\n    d.fid AS filter_id,\n    d.sigmapsf AS fwhm, -- assuming sigmapsf as a proxy for FWHM from SExtractor\n    -- Number of PS1 calibrators used (assuming stored in feature table with name 'n_ps1_calibrators')\n    f_ps1_calibrators.value AS n_ps1_calibrators,\n    -- Exposure time (assuming stored in detection table or feature; here, using 'pid' as placeholder)\n    d.pid AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid\nLEFT JOIN ss_ztf ss ON so.oid = ss.oid\nLEFT JOIN feature f_mpc_mag ON so.oid = f_mpc_mag.oid AND f_mpc_mag.name = 'mpc_mag'\nLEFT JOIN feature f_mpc_name ON so.oid = f_mpc_name.oid AND f_mpc_name.name = 'mpc_name'\nLEFT JOIN feature f_ps1_calibrators ON so.oid = f_ps1_calibrators.oid AND f_ps1_calibrators.name = 'n_ps1_calibrators'\nWHERE d.oid = so.oid;"
                },
                "in_toks": 8046,
                "out_toks": 482,
                "id": "chatcmpl-BwxFImWMlHo6ppyCjfr79Vhxd8NEV",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "104",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "gaia_ztf",
                "ss_ztf",
                "ps1_ztf",
                "reference",
                "detection",
                "magstat",
                "non_detection",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'gaia_ztf', 'ss_ztf', 'ps1_ztf', 'reference', 'detection', 'magstat', 'non_detection', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 683,
                "out_toks": 52,
                "id": "chatcmpl-BwvL71Yh9phxQzk1UDkhQyYeavzjS",
                "created": 1753383137,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table references and syntax, including necessary joins and explicit table aliases\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_archive_magnitude,\n    d.fid AS filter_id,\n    d.sigmapsf AS fwhm_sextractor,\n    p.nmtchps AS ps1_calibrators_used,\n    d.mjd AS exposure_time -- Using detection time as a proxy for exposure time\nFROM selected_objects so\nJOIN object o ON o.oid = so.oid\nJOIN detection d ON d.oid = o.oid\nLEFT JOIN ss_ztf ss ON ss.candid = d.candid\nLEFT JOIN ps1_ztf p ON p.candid = d.candid\n-- Limit to at most 30 results\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table references and syntax, including necessary joins and explicit table aliases\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_archive_magnitude,\n    d.fid AS filter_id,\n    d.sigmapsf AS fwhm_sextractor,\n    p.nmtchps AS ps1_calibrators_used,\n    d.mjd AS exposure_time -- Using detection time as a proxy for exposure time\nFROM selected_objects so\nJOIN object o ON o.oid = so.oid\nJOIN detection d ON d.oid = o.oid\nLEFT JOIN ss_ztf ss ON ss.candid = d.candid\nLEFT JOIN ps1_ztf p ON p.candid = d.candid\n-- Limit to at most 30 results\nLIMIT 30;"
                },
                "in_toks": 6960,
                "out_toks": 304,
                "id": "chatcmpl-Bx07zRbFFRa96d9FGC4tPZBmdlEWa",
                "created": 1753401543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_archive_magnitude,\n    d.fid AS filter_id,\n    d.sigmapsf AS fwhm_sextractor,\n    -- Assuming 'ps1_ztf' table has 'candid' matching the candidate and 'nmtchps' as number of PS1 calibrators\n    p.nmtchps AS ps1_calibrators_used,\n    d.mjd AS exposure_time -- Using detection time as a proxy for exposure time\nFROM selected_objects so\nJOIN object o ON o.oid = so.oid\nJOIN detection d ON d.candid = so.candid\nLEFT JOIN ss_ztf ss ON ss.candid = d.candid\n-- Additional columns like FWHM, PS1 calibrators, exposure time are included as per assumptions\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_archive_magnitude,\n    d.fid AS filter_id,\n    d.sigmapsf AS fwhm_sextractor,\n    -- Assuming 'ps1_ztf' table has 'candid' matching the candidate and 'nmtchps' as number of PS1 calibrators\n    p.nmtchps AS ps1_calibrators_used,\n    d.mjd AS exposure_time -- Using detection time as a proxy for exposure time\nFROM selected_objects so\nJOIN object o ON o.oid = so.oid\nJOIN detection d ON d.candid = so.candid\nLEFT JOIN ss_ztf ss ON ss.candid = d.candid\n-- Additional columns like FWHM, PS1 calibrators, exposure time are included as per assumptions\nLIMIT 30;"
                },
                "in_toks": 8046,
                "out_toks": 317,
                "id": "chatcmpl-BwxFIVzEtTPdvmSzhzc6ouf6lOoHq",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "104",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "gaia_ztf",
                "ss_ztf",
                "reference",
                "ps1_ztf",
                "detection",
                "magstat",
                "non_detection",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'gaia_ztf', 'ss_ztf', 'reference', 'ps1_ztf', 'detection', 'magstat', 'non_detection', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 683,
                "out_toks": 52,
                "id": "chatcmpl-BwvL8FzPLPLQhn9IEGdBLwUIJ6JiX",
                "created": 1753383138,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query with proper table and column references based on provided schema\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.ranking\n        LIMIT 1\n    )\n),\nnearest_ss AS (\n    SELECT so.oid, so.ssnamnr\n    FROM ss_ztf so\n),\ncandidate_info AS (\n    SELECT d.oid, d.candid, d.distnr, d.ssmagnr, d.ssnamnr, d.fid, d.fwhm, d.nps1, d.exptime\n    FROM detection d\n)\nSELECT\n    o.oid AS ztf_id,\n    c.candid,\n    ns.ssnamnr AS solar_system_object_name,\n    c.distnr AS distance_ss,\n    c.ssmagnr AS mpc_magnitude,\n    c.ssnamnr AS mpc_name,\n    c.fid AS filter_id,\n    c.fwhm,\n    c.nps1 AS ps1_calibrators_used,\n    c.exptime AS exposure_time\nFROM selected_objects o\nJOIN candidate_info c ON o.oid = c.oid\nLEFT JOIN nearest_ss ns ON o.oid = ns.oid\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query with proper table and column references based on provided schema\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.ranking\n        LIMIT 1\n    )\n),\nnearest_ss AS (\n    SELECT so.oid, so.ssnamnr\n    FROM ss_ztf so\n),\ncandidate_info AS (\n    SELECT d.oid, d.candid, d.distnr, d.ssmagnr, d.ssnamnr, d.fid, d.fwhm, d.nps1, d.exptime\n    FROM detection d\n)\nSELECT\n    o.oid AS ztf_id,\n    c.candid,\n    ns.ssnamnr AS solar_system_object_name,\n    c.distnr AS distance_ss,\n    c.ssmagnr AS mpc_magnitude,\n    c.ssnamnr AS mpc_name,\n    c.fid AS filter_id,\n    c.fwhm,\n    c.nps1 AS ps1_calibrators_used,\n    c.exptime AS exposure_time\nFROM selected_objects o\nJOIN candidate_info c ON o.oid = c.oid\nLEFT JOIN nearest_ss ns ON o.oid = ns.oid\nLIMIT 30;"
                },
                "in_toks": 6971,
                "out_toks": 325,
                "id": "chatcmpl-Bx07yUPlvhEtAhbMTOdhH7uDM7nyp",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_objects AS (\n    SELECT o.oid, p.candid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.ranking\n        LIMIT 1\n    )\n),\nnearest_ss AS (\n    SELECT so.oid, so.ssnamenr\n    FROM ss_ztf so\n),\ncandidate_info AS (\n    SELECT c.oid, c.candid, c.distnr, c.ssmagnr, c.ssnamnr, c.fid, c.fwhm, c.nps1, c.exptime\n    FROM detection c\n)\nSELECT\n    o.oid AS ztf_id,\n    c.candid,\n    ns.ssnamenr AS solar_system_object_name,\n    c.distnr AS distance_ss,\n    c.ssmagnr AS mpc_magnitude,\n    c.ssnamnr AS mpc_name,\n    c.fid AS filter_id,\n    c.fwhm,\n    c.nps1 AS ps1_calibrators_used,\n    c.exptime AS exposure_time\nFROM selected_objects o\nJOIN candidate_info c ON o.oid = c.oid\nLEFT JOIN nearest_ss ns ON o.oid = ns.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_objects AS (\n    SELECT o.oid, p.candid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.ranking\n        LIMIT 1\n    )\n),\nnearest_ss AS (\n    SELECT so.oid, so.ssnamenr\n    FROM ss_ztf so\n),\ncandidate_info AS (\n    SELECT c.oid, c.candid, c.distnr, c.ssmagnr, c.ssnamnr, c.fid, c.fwhm, c.nps1, c.exptime\n    FROM detection c\n)\nSELECT\n    o.oid AS ztf_id,\n    c.candid,\n    ns.ssnamenr AS solar_system_object_name,\n    c.distnr AS distance_ss,\n    c.ssmagnr AS mpc_magnitude,\n    c.ssnamnr AS mpc_name,\n    c.fid AS filter_id,\n    c.fwhm,\n    c.nps1 AS ps1_calibrators_used,\n    c.exptime AS exposure_time\nFROM selected_objects o\nJOIN candidate_info c ON o.oid = c.oid\nLEFT JOIN nearest_ss ns ON o.oid = ns.oid\nLIMIT 30;"
                },
                "in_toks": 8046,
                "out_toks": 315,
                "id": "chatcmpl-BwxFI2mGAwfWBSrJFznQGfkXy5Pv7",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "104",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "gaia_ztf",
                "ss_ztf",
                "ps1_ztf",
                "reference",
                "detection",
                "magstat",
                "non_detection",
                "feature",
                "feature_version",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'gaia_ztf', 'ss_ztf', 'ps1_ztf', 'reference', 'detection', 'magstat', 'non_detection', 'feature', 'feature_version', 'xmatch']"
                },
                "in_toks": 683,
                "out_toks": 53,
                "id": "chatcmpl-BwvLAnWAJ0jAvtB97g0Zp6h8etqJ1",
                "created": 1753383140,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 30 ZTF objects with high asteroid probability in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH high_prob_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n      AND p.ranking = 1\n    LIMIT 30\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearest_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_magnitude,\n    d.fid AS filter_id,\n    -- Assuming FWHM is stored in feature table with name 'FWHM' for each object and filter\n    f.value AS fwhm,\n    -- Number of PS1 calibrators used, assuming stored as a feature named 'n_ps1_calibrators'\n    (SELECT f2.value FROM feature f2 WHERE f2.oid = o.oid AND f2.name = 'n_ps1_calibrators' AND f2.fid = d.fid LIMIT 1) AS n_ps1_calibrators,\n    -- Exposure time, assuming stored in detection table as 'exposure_time' (if available)\n    d.exposure_time\nFROM high_prob_objects hpo\nJOIN object o ON o.oid = hpo.oid\nJOIN detection d ON d.oid = o.oid\nLEFT JOIN ss_ztf ss ON ss.oid = o.oid\nLEFT JOIN feature f ON f.oid = o.oid AND f.name = 'FWHM' AND f.fid = d.fid\n-- Additional filters can be added if needed\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 30 ZTF objects with high asteroid probability in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH high_prob_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n      AND p.ranking = 1\n    LIMIT 30\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearest_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_magnitude,\n    d.fid AS filter_id,\n    -- Assuming FWHM is stored in feature table with name 'FWHM' for each object and filter\n    f.value AS fwhm,\n    -- Number of PS1 calibrators used, assuming stored as a feature named 'n_ps1_calibrators'\n    (SELECT f2.value FROM feature f2 WHERE f2.oid = o.oid AND f2.name = 'n_ps1_calibrators' AND f2.fid = d.fid LIMIT 1) AS n_ps1_calibrators,\n    -- Exposure time, assuming stored in detection table as 'exposure_time' (if available)\n    d.exposure_time\nFROM high_prob_objects hpo\nJOIN object o ON o.oid = hpo.oid\nJOIN detection d ON d.oid = o.oid\nLEFT JOIN ss_ztf ss ON ss.oid = o.oid\nLEFT JOIN feature f ON f.oid = o.oid AND f.name = 'FWHM' AND f.fid = d.fid\n-- Additional filters can be added if needed\n```"
                },
                "in_toks": 7277,
                "out_toks": 413,
                "id": "chatcmpl-Bx07yWArzfJTdtvUGinZYto9S7Dnt",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 30 ZTF objects with high asteroid probability in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH high_prob_objects AS (\n    SELECT o.oid, p.oid, p.class_name, p.probability, p.ranking\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n      AND p.ranking = 1\n    LIMIT 30\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearest_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_magnitude,\n    d.fid AS filter_id,\n    -- Assuming FWHM, number of PS1 calibrators, and exposure time are stored in detection or feature tables\n    -- If not, these columns are placeholders and should be replaced with actual table/column names\n    f.value AS fwhm,\n    -- For number of PS1 calibrators used, assuming it's stored in feature table with a specific feature name\n    (SELECT value FROM feature WHERE oid = o.oid AND name = 'n_ps1_calibrators' AND fid = d.fid LIMIT 1) AS n_ps1_calibrators,\n    -- For exposure time, assuming it's stored in detection table as 'exposure_time' or similar\n    d.exposure_time\nFROM high_prob_objects hpo\nJOIN object o ON o.oid = hpo.oid\nJOIN detection d ON d.oid = o.oid\nLEFT JOIN ss_ztf ss ON ss.oid = o.oid\nLEFT JOIN feature f ON f.oid = o.oid AND f.name = 'FWHM' AND f.fid = d.fid\n-- Additional filters can be added if needed, e.g., specific filters or detection quality\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 30 ZTF objects with high asteroid probability in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH high_prob_objects AS (\n    SELECT o.oid, p.oid, p.class_name, p.probability, p.ranking\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.9\n      AND p.ranking = 1\n    LIMIT 30\n)\nSELECT \n    o.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearest_ss_object,\n    ss.ssnamenr AS nearest_ss_name,\n    ss.ssmagnr AS mpc_magnitude,\n    d.fid AS filter_id,\n    -- Assuming FWHM, number of PS1 calibrators, and exposure time are stored in detection or feature tables\n    -- If not, these columns are placeholders and should be replaced with actual table/column names\n    f.value AS fwhm,\n    -- For number of PS1 calibrators used, assuming it's stored in feature table with a specific feature name\n    (SELECT value FROM feature WHERE oid = o.oid AND name = 'n_ps1_calibrators' AND fid = d.fid LIMIT 1) AS n_ps1_calibrators,\n    -- For exposure time, assuming it's stored in detection table as 'exposure_time' or similar\n    d.exposure_time\nFROM high_prob_objects hpo\nJOIN object o ON o.oid = hpo.oid\nJOIN detection d ON d.oid = o.oid\nLEFT JOIN ss_ztf ss ON ss.oid = o.oid\nLEFT JOIN feature f ON f.oid = o.oid AND f.name = 'FWHM' AND f.fid = d.fid\n-- Additional filters can be added if needed, e.g., specific filters or detection quality\n```"
                },
                "in_toks": 8081,
                "out_toks": 448,
                "id": "chatcmpl-BwxFHkJWzhireL1DX1wkA4rLbtejP",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "104",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "gaia_ztf",
                "ss_ztf",
                "ps1_ztf",
                "reference",
                "detection",
                "magstat",
                "non_detection",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'gaia_ztf', 'ss_ztf', 'ps1_ztf', 'reference', 'detection', 'magstat', 'non_detection', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 683,
                "out_toks": 52,
                "id": "chatcmpl-BwvLB2gI20jrJ7ErvXSzi7EZ4XRzm",
                "created": 1753383141,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\nWITH selected_objects AS (\n    -- Select objects with probability > 0.9 of being an asteroid (assuming class_name='asteroid' or similar; adjust if needed)\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version\n    FROM probability p\n    WHERE p.class_name = 'asteroid' -- Adjust class_name if different for asteroids\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    LIMIT 30\n),\ncandidate_objects AS (\n    -- Get object and candidate info for selected objects\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (SELECT oid FROM selected_objects)\n),\nnearest_ss AS (\n    -- Get nearest solar system object info\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_details AS (\n    -- Get detection details for candidates\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.mjd, d.distnr\n    FROM detection d\n),\nfeature_ps1 AS (\n    -- Get number of PS1 calibrators used; assuming stored as a feature with name 'n_ps1_calibrators'\n    SELECT f.oid, f.value::int AS n_ps1_calibrators\n    FROM feature f\n    WHERE f.name = 'n_ps1_calibrators'\n),\n-- Main select combining all info\nSELECT\n    co.oid AS ztf_id,\n    co.candid AS candidate_id,\n    ns.ssdistnr AS distance_to_nearest_ss_object,\n    ns.ssmagnr AS mpc_magnitude,\n    ns.ssnamenr AS solar_system_object_name,\n    cd.fid AS filter_id,\n    -- Use magpsf as a proxy for FWHM if no specific FWHM column exists\n    cd.magpsf AS fwhm,\n    -- Get number of PS1 calibrators\n    fp.n_ps1_calibrators,\n    -- Get exposure time from detection; assuming 'exptime' is available in detection (not in schema, so set as NULL or omit)\n    NULL AS exposure_time\nFROM candidate_objects co\nJOIN candidate_details cd ON co.candid = cd.candid\nLEFT JOIN nearest_ss ns ON co.oid = ns.oid\nLEFT JOIN feature_ps1 fp ON co.oid = fp.oid\n-- Limit to 30 objects as per user request\nLIMIT 30;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\nWITH selected_objects AS (\n    -- Select objects with probability > 0.9 of being an asteroid (assuming class_name='asteroid' or similar; adjust if needed)\n    SELECT p.oid, p.class_name, p.classifier_name, p.classifier_version\n    FROM probability p\n    WHERE p.class_name = 'asteroid' -- Adjust class_name if different for asteroids\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    LIMIT 30\n),\ncandidate_objects AS (\n    -- Get object and candidate info for selected objects\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (SELECT oid FROM selected_objects)\n),\nnearest_ss AS (\n    -- Get nearest solar system object info\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_details AS (\n    -- Get detection details for candidates\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.mjd, d.distnr\n    FROM detection d\n),\nfeature_ps1 AS (\n    -- Get number of PS1 calibrators used; assuming stored as a feature with name 'n_ps1_calibrators'\n    SELECT f.oid, f.value::int AS n_ps1_calibrators\n    FROM feature f\n    WHERE f.name = 'n_ps1_calibrators'\n),\n-- Main select combining all info\nSELECT\n    co.oid AS ztf_id,\n    co.candid AS candidate_id,\n    ns.ssdistnr AS distance_to_nearest_ss_object,\n    ns.ssmagnr AS mpc_magnitude,\n    ns.ssnamenr AS solar_system_object_name,\n    cd.fid AS filter_id,\n    -- Use magpsf as a proxy for FWHM if no specific FWHM column exists\n    cd.magpsf AS fwhm,\n    -- Get number of PS1 calibrators\n    fp.n_ps1_calibrators,\n    -- Get exposure time from detection; assuming 'exptime' is available in detection (not in schema, so set as NULL or omit)\n    NULL AS exposure_time\nFROM candidate_objects co\nJOIN candidate_details cd ON co.candid = cd.candid\nLEFT JOIN nearest_ss ns ON co.oid = ns.oid\nLEFT JOIN feature_ps1 fp ON co.oid = fp.oid\n-- Limit to 30 objects as per user request\nLIMIT 30;\n"
                },
                "in_toks": 7294,
                "out_toks": 594,
                "id": "chatcmpl-Bx08CHfgg49y1I0gf8OHzdc5Uc4R0",
                "created": 1753401556,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.mjd, d.distnr, d.rgmag, d.exptime\n    FROM detection d\n)\nSELECT\n    so.oid AS ztf_id,\n    so.candid AS candidate_id,\n    ns.ssdistnr AS distance_to_nearest_ss_object,\n    ns.ssmagnr AS mpc_magnitude,\n    ns.ssnamenr AS solar_system_object_name,\n    ci.fid AS filter_id,\n    ci.magpsf AS fwhm, -- Assuming magpsf is used as a proxy for FWHM; adjust if a specific FWHM column exists\n    -- Placeholder for number of PS1 calibrators used; assuming it's stored in feature table with a specific feature name\n    (SELECT value FROM feature WHERE oid = ci.oid AND name = 'n_ps1_calibrators' LIMIT 1) AS ps1_calibrators_count,\n    ci.exptime AS exposure_time\nFROM selected_objects so\nJOIN candidate_info ci ON so.candid = ci.candid\nLEFT JOIN nearest_ss ns ON so.oid = ns.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.candid, d.oid, d.fid, d.magpsf, d.sigmapsf, d.mjd, d.distnr, d.rgmag, d.exptime\n    FROM detection d\n)\nSELECT\n    so.oid AS ztf_id,\n    so.candid AS candidate_id,\n    ns.ssdistnr AS distance_to_nearest_ss_object,\n    ns.ssmagnr AS mpc_magnitude,\n    ns.ssnamenr AS solar_system_object_name,\n    ci.fid AS filter_id,\n    ci.magpsf AS fwhm, -- Assuming magpsf is used as a proxy for FWHM; adjust if a specific FWHM column exists\n    -- Placeholder for number of PS1 calibrators used; assuming it's stored in feature table with a specific feature name\n    (SELECT value FROM feature WHERE oid = ci.oid AND name = 'n_ps1_calibrators' LIMIT 1) AS ps1_calibrators_count,\n    ci.exptime AS exposure_time\nFROM selected_objects so\nJOIN candidate_info ci ON so.candid = ci.candid\nLEFT JOIN nearest_ss ns ON so.oid = ns.oid\nLIMIT 30;"
                },
                "in_toks": 8046,
                "out_toks": 429,
                "id": "chatcmpl-BwxFIkiQrxPViDrNKrdtM6TYcUt15",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "104",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "gaia_ztf",
                "ss_ztf",
                "ps1_ztf",
                "reference",
                "detection",
                "magstat",
                "non_detection",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'gaia_ztf', 'ss_ztf', 'ps1_ztf', 'reference', 'detection', 'magstat', 'non_detection', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 683,
                "out_toks": 52,
                "id": "chatcmpl-BwvLChIkrKUgTSXG2xEe1htrglRjh",
                "created": 1753383142,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and user request\nWITH selected_objects AS (\n    SELECT o.oid, p.oid AS prob_oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.oid, d.candid, d.fid, d.ra, d.dec, d.mjd, d.magpsf, d.sigmapsf, d.magap, d.sigmagap, d.distnr, d.rb\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM selected_objects)\n),\nfeature_data AS (\n    SELECT c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb,\n           -- Retrieve filter name based on fid\n           (CASE c.fid\n               WHEN 1 THEN 'g'\n               WHEN 2 THEN 'r'\n               WHEN 3 THEN 'i'\n               ELSE NULL\n            END) AS filter_name,\n           -- Placeholder for FWHM from feature table\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'FWHM' AND fid = c.fid LIMIT 1) AS fwhm,\n           -- Placeholder for number of PS1 calibrators used\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'n_ps1_calibrators' AND fid = c.fid LIMIT 1) AS n_ps1_calibrators,\n           -- Placeholder for exposure time\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'exposure_time' AND fid = c.fid LIMIT 1) AS exposure_time\n    FROM candidate_info c\n),\nfinal_output AS (\n    SELECT \n        c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb,\n        f.filter_name, f.fwhm, f.n_ps1_calibrators, f.exposure_time,\n        ns.ssnamenr, ns.ssdistnr, ns.ssmagnr\n    FROM feature_data f\n    LEFT JOIN nearest_ss ns ON f.oid = ns.oid\n)\nSELECT * FROM final_output\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and user request\nWITH selected_objects AS (\n    SELECT o.oid, p.oid AS prob_oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.classifier_version = 'stamp_classifier_1.0.4'\n      AND p.probability > 0.9\n    ORDER BY p.probability DESC\n    LIMIT 30\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.oid, d.candid, d.fid, d.ra, d.dec, d.mjd, d.magpsf, d.sigmapsf, d.magap, d.sigmagap, d.distnr, d.rb\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM selected_objects)\n),\nfeature_data AS (\n    SELECT c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb,\n           -- Retrieve filter name based on fid\n           (CASE c.fid\n               WHEN 1 THEN 'g'\n               WHEN 2 THEN 'r'\n               WHEN 3 THEN 'i'\n               ELSE NULL\n            END) AS filter_name,\n           -- Placeholder for FWHM from feature table\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'FWHM' AND fid = c.fid LIMIT 1) AS fwhm,\n           -- Placeholder for number of PS1 calibrators used\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'n_ps1_calibrators' AND fid = c.fid LIMIT 1) AS n_ps1_calibrators,\n           -- Placeholder for exposure time\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'exposure_time' AND fid = c.fid LIMIT 1) AS exposure_time\n    FROM candidate_info c\n),\nfinal_output AS (\n    SELECT \n        c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb,\n        f.filter_name, f.fwhm, f.n_ps1_calibrators, f.exposure_time,\n        ns.ssnamenr, ns.ssdistnr, ns.ssmagnr\n    FROM feature_data f\n    LEFT JOIN nearest_ss ns ON f.oid = ns.oid\n)\nSELECT * FROM final_output\nLIMIT 30;"
                },
                "in_toks": 7777,
                "out_toks": 635,
                "id": "chatcmpl-Bx088ZFA3u2tlROZqCb6r7bp5pkY3",
                "created": 1753401552,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.oid, d.candid, d.fid, d.ra, d.dec, d.mjd, d.magpsf, d.sigmapsf, d.magap, d.sigmagap, d.distnr, d.rb, d.rid, d.exptime\n    FROM detection d\n    WHERE (d.oid, d.candid) IN (SELECT oid, candid FROM selected_objects)\n),\ncandidate_details AS (\n    SELECT c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb, c.rid, c.exptime,\n           f.name AS filter_name,\n           -- Placeholder for FWHM from SExtractor, assuming it's stored in feature table with a specific name\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'FWHM' AND fid = c.fid LIMIT 1) AS fwhm,\n           -- Placeholder for number of PS1 calibrators used, assuming stored in feature table\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'n_ps1_calibrators' AND fid = c.fid LIMIT 1) AS n_ps1_calibrators,\n           -- Placeholder for exposure time, assuming stored in feature table\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'exposure_time' AND fid = c.fid LIMIT 1) AS exposure_time\n    FROM candidate_info c\n),\nfinal_result AS (\n    SELECT \n        c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb, c.rid, c.exptime,\n        fc.filter_name, fc.fwhm, fc.n_ps1_calibrators, fc.exposure_time,\n        ns.ssnamenr, ns.ssdistnr, ns.ssmagnr\n    FROM candidate_details fc\n    LEFT JOIN nearest_ss ns ON fc.oid = ns.oid\n)\nSELECT * FROM final_result\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'SN' -- Assuming 'SN' is the class for asteroids; adjust if needed\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        LIMIT 30\n    )\n),\nnearest_ss AS (\n    SELECT o.oid, s.ssnamenr, s.ssdistnr, s.ssmagnr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n),\ncandidate_info AS (\n    SELECT d.oid, d.candid, d.fid, d.ra, d.dec, d.mjd, d.magpsf, d.sigmapsf, d.magap, d.sigmagap, d.distnr, d.rb, d.rid, d.exptime\n    FROM detection d\n    WHERE (d.oid, d.candid) IN (SELECT oid, candid FROM selected_objects)\n),\ncandidate_details AS (\n    SELECT c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb, c.rid, c.exptime,\n           f.name AS filter_name,\n           -- Placeholder for FWHM from SExtractor, assuming it's stored in feature table with a specific name\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'FWHM' AND fid = c.fid LIMIT 1) AS fwhm,\n           -- Placeholder for number of PS1 calibrators used, assuming stored in feature table\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'n_ps1_calibrators' AND fid = c.fid LIMIT 1) AS n_ps1_calibrators,\n           -- Placeholder for exposure time, assuming stored in feature table\n           (SELECT value FROM feature WHERE oid = c.oid AND name = 'exposure_time' AND fid = c.fid LIMIT 1) AS exposure_time\n    FROM candidate_info c\n),\nfinal_result AS (\n    SELECT \n        c.oid, c.candid, c.fid, c.ra, c.dec, c.mjd, c.magpsf, c.sigmapsf, c.magap, c.sigmagap, c.distnr, c.rb, c.rid, c.exptime,\n        fc.filter_name, fc.fwhm, fc.n_ps1_calibrators, fc.exposure_time,\n        ns.ssnamenr, ns.ssdistnr, ns.ssmagnr\n    FROM candidate_details fc\n    LEFT JOIN nearest_ss ns ON fc.oid = ns.oid\n)\nSELECT * FROM final_result\nLIMIT 30;"
                },
                "in_toks": 8046,
                "out_toks": 641,
                "id": "chatcmpl-BwxFN5NtvZe7nbjHv93PAm84dP5xh",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "104",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "gaia_ztf",
                "ss_ztf",
                "ps1_ztf",
                "reference",
                "detection",
                "magstat",
                "non_detection",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'gaia_ztf', 'ss_ztf', 'ps1_ztf', 'reference', 'detection', 'magstat', 'non_detection', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 683,
                "out_toks": 52,
                "id": "chatcmpl-BwvLD2C7vgBcj1zZokK3sokIfKDeA",
                "created": 1753383143,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query based on provided schema and error analysis\nWITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.probability DESC\n        LIMIT 30\n    )\n)\nSELECT \n    so.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS ss_object_name,\n    ss.ssmagnr AS mpc_archive_magnitude, -- Corrected column name from 'magnr' to 'ssmagnr'\n    d.fid AS filter_id,\n    f.value AS fwhm,\n    -- Retrieve 'ps1_calibrators_used' feature value for the object and filter\n    (SELECT f2.value FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'ps1_calibrators_used' AND f2.fid = d.fid AND f2.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS ps1_calibrators_used,\n    -- Retrieve 'exposure_time' feature value for the object and filter\n    (SELECT f3.value FROM feature f3 WHERE f3.oid = so.oid AND f3.name = 'exposure_time' AND f3.fid = d.fid AND f3.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.oid = d.oid\nJOIN ss_ztf ss ON so.oid = ss.oid\nJOIN feature f ON so.oid = f.oid AND f.name = 'FWHM' AND f.fid = d.fid\nWHERE d.oid = so.oid\nLIMIT 30;",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query based on provided schema and error analysis\nWITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.probability DESC\n        LIMIT 30\n    )\n)\nSELECT \n    so.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS ss_object_name,\n    ss.ssmagnr AS mpc_archive_magnitude, -- Corrected column name from 'magnr' to 'ssmagnr'\n    d.fid AS filter_id,\n    f.value AS fwhm,\n    -- Retrieve 'ps1_calibrators_used' feature value for the object and filter\n    (SELECT f2.value FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'ps1_calibrators_used' AND f2.fid = d.fid AND f2.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS ps1_calibrators_used,\n    -- Retrieve 'exposure_time' feature value for the object and filter\n    (SELECT f3.value FROM feature f3 WHERE f3.oid = so.oid AND f3.name = 'exposure_time' AND f3.fid = d.fid AND f3.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.oid = d.oid\nJOIN ss_ztf ss ON so.oid = ss.oid\nJOIN feature f ON so.oid = f.oid AND f.name = 'FWHM' AND f.fid = d.fid\nWHERE d.oid = so.oid\nLIMIT 30;"
                },
                "in_toks": 7386,
                "out_toks": 456,
                "id": "chatcmpl-Bx07yvET7x7oPct5noq4HEI2D8EEj",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.probability DESC\n        LIMIT 30\n    )\n)\nSELECT \n    so.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS ss_object_name,\n    ss.magnr AS mpc_archive_magnitude,\n    d.fid AS filter_id,\n    f.value AS fwhm,\n    -- Assuming 'ps1_calibrators' is a feature stored in the feature table with a specific name, e.g., 'ps1_calibrators_used'\n    (SELECT f2.value FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'ps1_calibrators_used' AND f2.fid = d.fid AND f2.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS ps1_calibrators_used,\n    -- Assuming 'exposure_time' is stored similarly in the feature table with name 'exposure_time'\n    (SELECT f3.value FROM feature f3 WHERE f3.oid = so.oid AND f3.name = 'exposure_time' AND f3.fid = d.fid AND f3.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.oid = d.oid\nJOIN ss_ztf ss ON so.oid = ss.oid\nJOIN feature f ON so.oid = f.oid AND f.name = 'FWHM' AND f.fid = d.fid\nWHERE d.oid = so.oid\nLIMIT 30;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH selected_objects AS (\n    SELECT o.oid, d.candid\n    FROM object o\n    JOIN detection d ON o.oid = d.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.probability DESC\n        LIMIT 30\n    )\n)\nSELECT \n    so.oid AS ztf_object_id,\n    d.candid AS candidate_id,\n    ss.ssdistnr AS distance_to_nearby_ss_object,\n    ss.ssnamenr AS ss_object_name,\n    ss.magnr AS mpc_archive_magnitude,\n    d.fid AS filter_id,\n    f.value AS fwhm,\n    -- Assuming 'ps1_calibrators' is a feature stored in the feature table with a specific name, e.g., 'ps1_calibrators_used'\n    (SELECT f2.value FROM feature f2 WHERE f2.oid = so.oid AND f2.name = 'ps1_calibrators_used' AND f2.fid = d.fid AND f2.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS ps1_calibrators_used,\n    -- Assuming 'exposure_time' is stored similarly in the feature table with name 'exposure_time'\n    (SELECT f3.value FROM feature f3 WHERE f3.oid = so.oid AND f3.name = 'exposure_time' AND f3.fid = d.fid AND f3.version = (SELECT version FROM feature_version WHERE version = 'latest')) AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.oid = d.oid\nJOIN ss_ztf ss ON so.oid = ss.oid\nJOIN feature f ON so.oid = f.oid AND f.name = 'FWHM' AND f.fid = d.fid\nWHERE d.oid = so.oid\nLIMIT 30;"
                },
                "in_toks": 8046,
                "out_toks": 447,
                "id": "chatcmpl-BwxFJXNOYXXei9JdZbkqYWJTM0GX6",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "71": {
        "0": {
            "req_id": "71",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 819,
                "out_toks": 12,
                "id": "chatcmpl-BjAcyJOZvmqDZY3pffsfwDOxdNyS2",
                "created": 1750105312,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference information for specified ZTF objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band filter\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference information for specified ZTF objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band filter\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 2768,
                "out_toks": 121,
                "id": "chatcmpl-BwxFIsQeGRSNjqmfQ2H0IsR33DV9s",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "71",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 819,
                "out_toks": 12,
                "id": "chatcmpl-BjAcyJOZvmqDZY3pffsfwDOxdNyS2",
                "created": 1750105312,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference entries for specified ZTF objects with g-band data\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 2 -- g-band filter\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference entries for specified ZTF objects with g-band data\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 2 -- g-band filter\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 2768,
                "out_toks": 115,
                "id": "chatcmpl-BwxFOBkcELvdTV57qqdbHLPCYDEve",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "71",
            "experiment_id": "run_2",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 666,
                "out_toks": 3,
                "id": "chatcmpl-BwvLFxtyBS7aL9UohAxKv2o08z4st",
                "created": 1753383145,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 2286,
                "out_toks": 120,
                "id": "chatcmpl-BwxFIU4VfuoTSgR2KnkTsselTLE6E",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "71",
            "experiment_id": "run_3",
            "pred_tables": [
                "reference",
                "detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference', 'detection', 'forced_photometry']"
                },
                "in_toks": 666,
                "out_toks": 13,
                "id": "chatcmpl-BwvLH5gSJqVkTKT3GFDmXOspVYJfW",
                "created": 1753383147,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.rfid IS NOT NULL -- assuming rfid corresponds to the band information\n    AND r.rfid IN (\n        -- Subquery to find rfid values associated with g band observations\n        SELECT r2.rfid\n        FROM reference r2\n        WHERE r2.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n        AND r2.rfid IS NOT NULL\n        -- Additional filtering if needed to specify g band, but since no explicit band info in reference table,\n        -- assume rfid or other columns are used to infer band; if not, this may need adjustment.\n    )\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.rfid IS NOT NULL -- assuming rfid corresponds to the band information\n    AND r.rfid IN (\n        -- Subquery to find rfid values associated with g band observations\n        SELECT r2.rfid\n        FROM reference r2\n        WHERE r2.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n        AND r2.rfid IS NOT NULL\n        -- Additional filtering if needed to specify g band, but since no explicit band info in reference table,\n        -- assume rfid or other columns are used to infer band; if not, this may need adjustment.\n    )\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 3526,
                "out_toks": 246,
                "id": "chatcmpl-BwxFN6KjPEMTNuS03BGTGEWfeXNgv",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "71",
            "experiment_id": "run_4",
            "pred_tables": [
                "reference",
                "detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference', 'detection', 'forced_photometry']"
                },
                "in_toks": 666,
                "out_toks": 13,
                "id": "chatcmpl-BwvLIfiSkYba9lSvxRjQYPMEWec3x",
                "created": 1753383148,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.rfid IS NOT NULL -- assuming rfid corresponds to the band information\n    AND r.rfid IN (\n        -- Subquery to find rfid values associated with g band\n        SELECT r2.rfid\n        FROM reference r2\n        WHERE r2.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n        AND r2.rfid IS NOT NULL\n        -- Additional filtering if needed to specify g band, but since no explicit band info in reference table,\n        -- assuming rfid or other columns would be used if available. If not, this filter may be omitted.\n    )\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.rfid IS NOT NULL -- assuming rfid corresponds to the band information\n    AND r.rfid IN (\n        -- Subquery to find rfid values associated with g band\n        SELECT r2.rfid\n        FROM reference r2\n        WHERE r2.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n        AND r2.rfid IS NOT NULL\n        -- Additional filtering if needed to specify g band, but since no explicit band info in reference table,\n        -- assuming rfid or other columns would be used if available. If not, this filter may be omitted.\n    )\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 3526,
                "out_toks": 246,
                "id": "chatcmpl-BwxFHXes5DlCs5UgMQNbZonQRMjGk",
                "created": 1753390463,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "71",
            "experiment_id": "run_5",
            "pred_tables": [
                "reference",
                "detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference', 'detection', 'forced_photometry']"
                },
                "in_toks": 666,
                "out_toks": 13,
                "id": "chatcmpl-BwvLJDeZLWD6SM536P4KZlsBOX7Rm",
                "created": 1753383149,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.rfid = 1 -- Assuming rfid=1 corresponds to the g band\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.rfid = 1 -- Assuming rfid=1 corresponds to the g band\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 3526,
                "out_toks": 126,
                "id": "chatcmpl-BwxFNiw9OyHd0xs7N353fovwG7m5M",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "71",
            "experiment_id": "run_6",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 666,
                "out_toks": 3,
                "id": "chatcmpl-BwvLJddQ9QjooKTcUq7xgNhWJbZsD",
                "created": 1753383149,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_id,\n    r.rfid AS ztf_id,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_id,\n    r.rfid AS ztf_id,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 2286,
                "out_toks": 124,
                "id": "chatcmpl-BwxFNBacEcmN2lJsK69duya2eLlID",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "71",
            "experiment_id": "run_7",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 666,
                "out_toks": 3,
                "id": "chatcmpl-BwvLKZvI1DpBW3ZcBv2bDePPo6jnH",
                "created": 1753383150,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 2286,
                "out_toks": 120,
                "id": "chatcmpl-BwxFKOS1K22bOOHcwL1zBaWogxgJ0",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "71",
            "experiment_id": "run_8",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 666,
                "out_toks": 3,
                "id": "chatcmpl-BwvLKhg16GvEruYVGqcefWq0TAZMd",
                "created": 1753383150,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 2286,
                "out_toks": 120,
                "id": "chatcmpl-BwxFNfNXRZmzXgFFi9GkvELscWEoF",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "71",
            "experiment_id": "run_9",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']"
                },
                "in_toks": 666,
                "out_toks": 3,
                "id": "chatcmpl-BwvLKcH5CPtquY4e6kxhmX5j1RLYB",
                "created": 1753383150,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference_oid, rfid, candid, magnr, sigmagnr for specified ZTF objects in g band\nSELECT \n    r.oid AS reference_oid,\n    r.rfid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 2286,
                "out_toks": 120,
                "id": "chatcmpl-BwxFMGqmScxMGGnbx1A8O2Bc5EyJh",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "42": {
        "0": {
            "req_id": "42",
            "experiment_id": "run_0",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 816,
                "out_toks": 8,
                "id": "chatcmpl-BjAcynhrqunbr30iZVUFCcSkeiUoq",
                "created": 1750105312,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```"
                },
                "in_toks": 2714,
                "out_toks": 127,
                "id": "chatcmpl-BwxFMQ2dG4Crw2KNqDCdEfkt1H45t",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "42",
            "experiment_id": "run_1",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 816,
                "out_toks": 8,
                "id": "chatcmpl-BjAcynhrqunbr30iZVUFCcSkeiUoq",
                "created": 1750105312,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM (\n    SELECT \n        oid,\n        candid,\n        fid,\n        chipsf,\n        fwhm,\n        classtar,\n        nbad,\n        magzpsci,\n        magzpsciunc,\n        exptime\n    FROM dataquality\n    WHERE oid = 'ZTF21aapnixl'\n) sub\nORDER BY chipsf ASC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM (\n    SELECT \n        oid,\n        candid,\n        fid,\n        chipsf,\n        fwhm,\n        classtar,\n        nbad,\n        magzpsci,\n        magzpsciunc,\n        exptime\n    FROM dataquality\n    WHERE oid = 'ZTF21aapnixl'\n) sub\nORDER BY chipsf ASC;\n```"
                },
                "in_toks": 2714,
                "out_toks": 137,
                "id": "chatcmpl-BwxFI3lgcKkjhmFpEwfhhmMI6WPMd",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "42",
            "experiment_id": "run_2",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"dataquality\"]"
                },
                "in_toks": 663,
                "out_toks": 4,
                "id": "chatcmpl-BwvLLoVN5H7nGxZRPXjT10H6Js0Qg",
                "created": 1753383151,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```"
                },
                "in_toks": 2714,
                "out_toks": 127,
                "id": "chatcmpl-BwxFPvG2DoHLrlNykI3QVyxbbHGfI",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "42",
            "experiment_id": "run_3",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 663,
                "out_toks": 4,
                "id": "chatcmpl-BwvLLDS2ADP1sunDo0cW6bkc2zH8P",
                "created": 1753383151,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime\nFROM \n    dataquality\nWHERE \n    oid = 'ZTF21aapnixl'\nORDER BY \n    chipsf;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime\nFROM \n    dataquality\nWHERE \n    oid = 'ZTF21aapnixl'\nORDER BY \n    chipsf;\n```"
                },
                "in_toks": 2714,
                "out_toks": 98,
                "id": "chatcmpl-BwxFOscypVziayCXm3JzSowDxQTta",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "42",
            "experiment_id": "run_4",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']"
                },
                "in_toks": 663,
                "out_toks": 4,
                "id": "chatcmpl-BwvLMXQkoVslHQM0X5ipsafAqC28O",
                "created": 1753383152,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime\nFROM \n    dataquality\nWHERE \n    oid = 'ZTF21aapnixl'\nORDER BY \n    chipsf;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime\nFROM \n    dataquality\nWHERE \n    oid = 'ZTF21aapnixl'\nORDER BY \n    chipsf;\n```"
                },
                "in_toks": 2714,
                "out_toks": 98,
                "id": "chatcmpl-BwxFIkmnu3kkyXfKUfdRluYKicXFZ",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "42",
            "experiment_id": "run_5",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"dataquality\"]"
                },
                "in_toks": 663,
                "out_toks": 4,
                "id": "chatcmpl-BwvLM2gS6weHnOFBnDQo8r6CYvBEs",
                "created": 1753383152,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM \n    dataquality\nWHERE \n    oid = 'ZTF21aapnixl'\nORDER BY \n    chipsf;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM \n    dataquality\nWHERE \n    oid = 'ZTF21aapnixl'\nORDER BY \n    chipsf;\n```"
                },
                "in_toks": 2714,
                "out_toks": 134,
                "id": "chatcmpl-BwxFQxRzs8dOuNtFmhov2yQK2MIMc",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "42",
            "experiment_id": "run_6",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"dataquality\"]"
                },
                "in_toks": 663,
                "out_toks": 4,
                "id": "chatcmpl-BwvLNfmt3RcAye7hqEtthNzO2dRQS",
                "created": 1753383153,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```"
                },
                "in_toks": 2714,
                "out_toks": 128,
                "id": "chatcmpl-BwxFPvT6Koo6Sb2u6pXYQQAo9CWuH",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "42",
            "experiment_id": "run_7",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"dataquality\"]"
                },
                "in_toks": 663,
                "out_toks": 4,
                "id": "chatcmpl-BwvLNCIfB5bYwVLF2B9YuJFJzzt5u",
                "created": 1753383153,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM (\n    SELECT \n        oid,\n        candid,\n        fid,\n        chipsf,\n        fwhm,\n        classtar,\n        nbad,\n        magzpsci,\n        magzpsciunc,\n        exptime\n    FROM dataquality\n    WHERE oid = 'ZTF21aapnixl'\n) sub\nORDER BY chipsf;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM (\n    SELECT \n        oid,\n        candid,\n        fid,\n        chipsf,\n        fwhm,\n        classtar,\n        nbad,\n        magzpsci,\n        magzpsciunc,\n        exptime\n    FROM dataquality\n    WHERE oid = 'ZTF21aapnixl'\n) sub\nORDER BY chipsf;\n```"
                },
                "in_toks": 2714,
                "out_toks": 136,
                "id": "chatcmpl-BwxFP7cRIMgkHa51bGBwl5AgJDTET",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "42",
            "experiment_id": "run_8",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"dataquality\"]"
                },
                "in_toks": 663,
                "out_toks": 4,
                "id": "chatcmpl-BwvLNjyudHq7lkDF1aa13beTRFiCZ",
                "created": 1753383153,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm,\n    classtar AS star_galaxy_score,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm,\n    classtar AS star_galaxy_score,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```"
                },
                "in_toks": 2714,
                "out_toks": 125,
                "id": "chatcmpl-BwxFKY7azHwA3Zj65vdHoM3VaJHCN",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "42",
            "experiment_id": "run_9",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"dataquality\"]"
                },
                "in_toks": 663,
                "out_toks": 4,
                "id": "chatcmpl-BwvLOke0ssxmeFqQ9msPIY2KiZ518",
                "created": 1753383154,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm AS fwhm_sextractor,\n    classtar AS star_galaxy_score,\n    nbad AS number_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```"
                },
                "in_toks": 2714,
                "out_toks": 127,
                "id": "chatcmpl-BwxFOQYhWIFS8shRd7UkJGxgjJvb2",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "107": {
        "0": {
            "req_id": "107",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']",
                    "1": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 853,
                "out_toks": 30,
                "id": "chatcmpl-BjAczJGsHQhxnwDxIz8U0Qtsxt8qf",
                "created": 1750105313,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        -- Subquery to get the probability of being an SN with classifier version 'stamp_classifier_1.0.4'\n        (\n            SELECT p2.probability\n            FROM probability p2\n            WHERE p2.oid = o.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n              AND p2.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p2.ranking\n            LIMIT 1\n        ) AS probability_sn,\n        -- Subquery to get the probability of being an asteroid with classifier version 'stamp_classifier_1.0.4'\n        (\n            SELECT p3.probability\n            FROM probability p3\n            WHERE p3.oid = o.oid\n              AND p3.class_name = 'asteroid'\n              AND p3.classifier_name = 'stamp_classifier'\n              AND p3.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p3.ranking\n            LIMIT 1\n        ) AS probability_asteroid,\n        -- Subquery to get the nearest Solar System object distance\n        (\n            SELECT xm2.dist\n            FROM xmatch xm2\n            WHERE xm2.oid = o.oid\n              AND xm2.catid = 'solar_system'\n            ORDER BY xm2.dist\n            LIMIT 1\n        ) AS dist_solar_system\n    FROM object o\n    WHERE\n        -- Ensure probabilities are above 0.5\n        (\n            SELECT p2.probability\n            FROM probability p2\n            WHERE p2.oid = o.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n              AND p2.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p2.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        (\n            SELECT p3.probability\n            FROM probability p3\n            WHERE p3.oid = o.oid\n              AND p3.class_name = 'asteroid'\n              AND p3.classifier_name = 'stamp_classifier'\n              AND p3.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p3.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        -- Distance to Solar System object less than 2 arcsec\n        (\n            SELECT xm2.dist\n            FROM xmatch xm2\n            WHERE xm2.oid = o.oid\n              AND xm2.catid = 'solar_system'\n            ORDER BY xm2.dist\n            LIMIT 1\n        ) < 2\n)\n-- Join with detection table to get detection details\nSELECT\n    so.oid AS ztf_id,\n    so.ndet AS num_detections,\n    so.firstmjd AS first_detection_mjd,\n    so.lastmjd AS last_detection_mjd,\n    so.probability_sn AS probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    d.oid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM selected_objects so\nJOIN detection d ON d.oid = so.oid\nJOIN xmatch xm ON xm.oid = so.oid AND xm.catid = 'solar_system'\n-- Order by first detection date\nORDER BY so.firstmjd\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        -- Subquery to get the probability of being an SN with classifier version 'stamp_classifier_1.0.4'\n        (\n            SELECT p2.probability\n            FROM probability p2\n            WHERE p2.oid = o.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n              AND p2.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p2.ranking\n            LIMIT 1\n        ) AS probability_sn,\n        -- Subquery to get the probability of being an asteroid with classifier version 'stamp_classifier_1.0.4'\n        (\n            SELECT p3.probability\n            FROM probability p3\n            WHERE p3.oid = o.oid\n              AND p3.class_name = 'asteroid'\n              AND p3.classifier_name = 'stamp_classifier'\n              AND p3.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p3.ranking\n            LIMIT 1\n        ) AS probability_asteroid,\n        -- Subquery to get the nearest Solar System object distance\n        (\n            SELECT xm2.dist\n            FROM xmatch xm2\n            WHERE xm2.oid = o.oid\n              AND xm2.catid = 'solar_system'\n            ORDER BY xm2.dist\n            LIMIT 1\n        ) AS dist_solar_system\n    FROM object o\n    WHERE\n        -- Ensure probabilities are above 0.5\n        (\n            SELECT p2.probability\n            FROM probability p2\n            WHERE p2.oid = o.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n              AND p2.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p2.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        (\n            SELECT p3.probability\n            FROM probability p3\n            WHERE p3.oid = o.oid\n              AND p3.class_name = 'asteroid'\n              AND p3.classifier_name = 'stamp_classifier'\n              AND p3.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p3.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        -- Distance to Solar System object less than 2 arcsec\n        (\n            SELECT xm2.dist\n            FROM xmatch xm2\n            WHERE xm2.oid = o.oid\n              AND xm2.catid = 'solar_system'\n            ORDER BY xm2.dist\n            LIMIT 1\n        ) < 2\n)\n-- Join with detection table to get detection details\nSELECT\n    so.oid AS ztf_id,\n    so.ndet AS num_detections,\n    so.firstmjd AS first_detection_mjd,\n    so.lastmjd AS last_detection_mjd,\n    so.probability_sn AS probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    d.oid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM selected_objects so\nJOIN detection d ON d.oid = so.oid\nJOIN xmatch xm ON xm.oid = so.oid AND xm.catid = 'solar_system'\n-- Order by first detection date\nORDER BY so.firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 2845,
                "out_toks": 772,
                "id": "chatcmpl-Bx07xKuFtPJZNAg2xyCGMgwamhluQ",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.ranking,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist,\n        d.candid,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Get the most probable class with probability > 0.5 for stamp_classifier_1.0.4\n    WHERE\n        -- Subquery to get the top-ranked probability for stamp_classifier_1.0.4\n        (\n            SELECT probability\n            FROM probability p2\n            WHERE p2.oid = o.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n              AND p2.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p2.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        -- Subquery to get the top-ranked probability for the asteroid class\n        (\n            SELECT probability\n            FROM probability p3\n            WHERE p3.oid = o.oid\n              AND p3.class_name = 'asteroid'\n              AND p3.classifier_name = 'stamp_classifier'\n              AND p3.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p3.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        -- Distance to nearest Solar System object less than 2 arcsec\n        (\n            SELECT dist\n            FROM xmatch xm2\n            WHERE xm2.oid = o.oid\n              AND xm2.catid = 'solar_system'\n            ORDER BY dist\n            LIMIT 1\n        ) < 2\n)\n-- Join with detection table to get detection details\nSELECT\n    so.oid AS ztf_id,\n    so.ndet AS num_detections,\n    so.firstmjd AS first_detection_mjd,\n    so.lastmjd AS last_detection_mjd,\n    so.probability,\n    so.candid AS candidate_id,\n    so.dist AS distance_arcsec,\n    so.oid_catalog AS mpc_name,\n    so.mjd AS detection_mjd,\n    so.fid AS filter_id\nFROM\n    selected_objects so\nJOIN\n    detection d ON d.oid = so.oid\n-- Order by first detection date\nORDER BY\n    so.firstmjd\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.ranking,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist,\n        d.candid,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Get the most probable class with probability > 0.5 for stamp_classifier_1.0.4\n    WHERE\n        -- Subquery to get the top-ranked probability for stamp_classifier_1.0.4\n        (\n            SELECT probability\n            FROM probability p2\n            WHERE p2.oid = o.oid\n              AND p2.class_name = 'SN'\n              AND p2.classifier_name = 'stamp_classifier'\n              AND p2.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p2.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        -- Subquery to get the top-ranked probability for the asteroid class\n        (\n            SELECT probability\n            FROM probability p3\n            WHERE p3.oid = o.oid\n              AND p3.class_name = 'asteroid'\n              AND p3.classifier_name = 'stamp_classifier'\n              AND p3.classifier_version = 'stamp_classifier_1.0.4'\n            ORDER BY p3.ranking\n            LIMIT 1\n        ) > 0.5\n        AND\n        -- Distance to nearest Solar System object less than 2 arcsec\n        (\n            SELECT dist\n            FROM xmatch xm2\n            WHERE xm2.oid = o.oid\n              AND xm2.catid = 'solar_system'\n            ORDER BY dist\n            LIMIT 1\n        ) < 2\n)\n-- Join with detection table to get detection details\nSELECT\n    so.oid AS ztf_id,\n    so.ndet AS num_detections,\n    so.firstmjd AS first_detection_mjd,\n    so.lastmjd AS last_detection_mjd,\n    so.probability,\n    so.candid AS candidate_id,\n    so.dist AS distance_arcsec,\n    so.oid_catalog AS mpc_name,\n    so.mjd AS detection_mjd,\n    so.fid AS filter_id\nFROM\n    selected_objects so\nJOIN\n    detection d ON d.oid = so.oid\n-- Order by first detection date\nORDER BY\n    so.firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 540,
                "id": "chatcmpl-BwxFQGpef9ThdtkY0YqJ7yOs1SAYC",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "107",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']",
                    "1": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 853,
                "out_toks": 30,
                "id": "chatcmpl-BjAczJGsHQhxnwDxIz8U0Qtsxt8qf",
                "created": 1750105313,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.ranking = 1\n        AND p.class_name = 'SN' -- Assuming 'SN' is used for asteroids in the stamp classifier\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.catid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.classifier_name = 'stamp_classifier_1.0.4' AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.ranking = 1\n        AND p.class_name = 'SN' -- Assuming 'SN' is used for asteroids in the stamp classifier\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.catid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.classifier_name = 'stamp_classifier_1.0.4' AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 413,
                "id": "chatcmpl-BwxFNqnzaKID4oCBCNFl7PtxlsV9I",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "107",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 700,
                "out_toks": 15,
                "id": "chatcmpl-BwvLOKX6UVf51c8ojzsxsdOdhbuId",
                "created": 1753383154,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        d.candid,\n        xm.dist,\n        xm.oid_catalog AS mpc_name,\n        d.mjd,\n        d.fid\n    FROM object o\n    -- Filter objects with more than 500 detections\n    WHERE\n        o.ndet > 500\n        -- Ensure object has a probability > 0.5 of being an asteroid in the specified classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'asteroid'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.ranking = 1\n                AND p.probability > 0.5\n        )\n        -- Ensure the object is within 2 arcsec of a Solar System object\n        AND EXISTS (\n            SELECT 1\n            FROM xmatch xm\n            WHERE\n                xm.oid = o.oid\n                AND xm.dist < 2\n        )\n    -- Join with detection to get detection date and filter\n    JOIN detection d ON d.oid = o.oid\n    -- Join with xmatch to get MPC name and distance\n    LEFT JOIN xmatch xm ON xm.oid = o.oid\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    ndet AS \"Number of Detections\",\n    to_timestamp(firstmjd * 86400) AS \"First Detection Date\",\n    to_timestamp(lastmjd * 86400) AS \"Last Detection Date\",\n    probability AS \"Probability\",\n    candid AS \"Candidate Identifier\",\n    dist AS \"Distance to MPC (arcsec)\",\n    mpc_name AS \"MPC Name\",\n    to_timestamp(mjd * 86400) AS \"Detection Date\",\n    fid AS \"Filter ID\"\nFROM selected_objects\nORDER BY firstmjd\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        d.candid,\n        xm.dist,\n        xm.oid_catalog AS mpc_name,\n        d.mjd,\n        d.fid\n    FROM object o\n    -- Filter objects with more than 500 detections\n    WHERE\n        o.ndet > 500\n        -- Ensure object has a probability > 0.5 of being an asteroid in the specified classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'asteroid'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.ranking = 1\n                AND p.probability > 0.5\n        )\n        -- Ensure the object is within 2 arcsec of a Solar System object\n        AND EXISTS (\n            SELECT 1\n            FROM xmatch xm\n            WHERE\n                xm.oid = o.oid\n                AND xm.dist < 2\n        )\n    -- Join with detection to get detection date and filter\n    JOIN detection d ON d.oid = o.oid\n    -- Join with xmatch to get MPC name and distance\n    LEFT JOIN xmatch xm ON xm.oid = o.oid\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    ndet AS \"Number of Detections\",\n    to_timestamp(firstmjd * 86400) AS \"First Detection Date\",\n    to_timestamp(lastmjd * 86400) AS \"Last Detection Date\",\n    probability AS \"Probability\",\n    candid AS \"Candidate Identifier\",\n    dist AS \"Distance to MPC (arcsec)\",\n    mpc_name AS \"MPC Name\",\n    to_timestamp(mjd * 86400) AS \"Detection Date\",\n    fid AS \"Filter ID\"\nFROM selected_objects\nORDER BY firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 2743,
                "out_toks": 449,
                "id": "chatcmpl-Bx089iid7YGhgAxvjQX6sDy63kpJ7",
                "created": 1753401553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        d.candid,\n        xm.dist,\n        xm.oid_catalog AS mpc_name,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Subquery to get the most probable class with ranking=1 for stamp_classifier_1.0.4\n    WHERE\n        -- Ensure object has more than 500 detections\n        o.ndet > 500\n        AND\n        -- Probability of being an asteroid (assuming 'asteroid' class in 'stamp_classifier')\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'asteroid'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.ranking = 1\n                AND p.probability > 0.5\n        )\n        AND\n        -- Distance to nearest Solar System object less than 2 arcsec\n        EXISTS (\n            SELECT 1\n            FROM xmatch xm\n            WHERE\n                xm.oid = o.oid\n                AND xm.dist < 2\n        )\n    -- Join with detection to get detection date and filter\n    JOIN detection d ON d.oid = o.oid\n    -- Join with xmatch to get MPC name and distance\n    LEFT JOIN xmatch xm ON xm.oid = o.oid\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    ndet AS \"Number of Detections\",\n    to_timestamp(firstmjd * 86400) AS \"First Detection Date\",\n    to_timestamp(lastmjd * 86400) AS \"Last Detection Date\",\n    probability AS \"Probability\",\n    candid AS \"Candidate Identifier\",\n    dist AS \"Distance to MPC (arcsec)\",\n    mpc_name AS \"MPC Name\",\n    to_timestamp(mjd * 86400) AS \"Detection Date\",\n    fid AS \"Filter ID\"\nFROM\n    selected_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        d.candid,\n        xm.dist,\n        xm.oid_catalog AS mpc_name,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Subquery to get the most probable class with ranking=1 for stamp_classifier_1.0.4\n    WHERE\n        -- Ensure object has more than 500 detections\n        o.ndet > 500\n        AND\n        -- Probability of being an asteroid (assuming 'asteroid' class in 'stamp_classifier')\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'asteroid'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.ranking = 1\n                AND p.probability > 0.5\n        )\n        AND\n        -- Distance to nearest Solar System object less than 2 arcsec\n        EXISTS (\n            SELECT 1\n            FROM xmatch xm\n            WHERE\n                xm.oid = o.oid\n                AND xm.dist < 2\n        )\n    -- Join with detection to get detection date and filter\n    JOIN detection d ON d.oid = o.oid\n    -- Join with xmatch to get MPC name and distance\n    LEFT JOIN xmatch xm ON xm.oid = o.oid\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    ndet AS \"Number of Detections\",\n    to_timestamp(firstmjd * 86400) AS \"First Detection Date\",\n    to_timestamp(lastmjd * 86400) AS \"Last Detection Date\",\n    probability AS \"Probability\",\n    candid AS \"Candidate Identifier\",\n    dist AS \"Distance to MPC (arcsec)\",\n    mpc_name AS \"MPC Name\",\n    to_timestamp(mjd * 86400) AS \"Detection Date\",\n    fid AS \"Filter ID\"\nFROM\n    selected_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 479,
                "id": "chatcmpl-BwxFKkeKu5NdmKrfyK1r4LFFqTM4e",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "107",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 700,
                "out_toks": 15,
                "id": "chatcmpl-BwvLP4JAIllzyE8maXFlsdNNrPTug",
                "created": 1753383155,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select at most 10 objects with specified conditions\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability AS asteroid_probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM \n    object o\n-- Subquery to get the probability > 0.5 for stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND class_name = 'SN' -- Assuming 'SN' is used for asteroid classification; if not, clarify the class name\n        AND probability > 0.5\n) p ON o.oid = p.oid\n-- Subquery to get the nearest Solar System object within 2 arcsec\nJOIN (\n    SELECT \n        xm1.oid,\n        xm1.dist,\n        xm1.oid_catalog\n    FROM \n        xmatch xm1\n    WHERE \n        xm1.dist < 2\n        AND xm1.catid = 'MPC' -- Assuming 'MPC' is the catalog ID for Solar System objects\n) xm ON o.oid = xm.oid\n-- Join with detection to get detection details\nJOIN detection d ON o.oid = d.oid\n-- Order by first detection date\nORDER BY \n    o.firstmjd\n-- Limit to 10 results\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 10 objects with specified conditions\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability AS asteroid_probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM \n    object o\n-- Subquery to get the probability > 0.5 for stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' \n        AND classifier_version = 'stamp_classifier_1.0.4'\n        AND class_name = 'SN' -- Assuming 'SN' is used for asteroid classification; if not, clarify the class name\n        AND probability > 0.5\n) p ON o.oid = p.oid\n-- Subquery to get the nearest Solar System object within 2 arcsec\nJOIN (\n    SELECT \n        xm1.oid,\n        xm1.dist,\n        xm1.oid_catalog\n    FROM \n        xmatch xm1\n    WHERE \n        xm1.dist < 2\n        AND xm1.catid = 'MPC' -- Assuming 'MPC' is the catalog ID for Solar System objects\n) xm ON o.oid = xm.oid\n-- Join with detection to get detection details\nJOIN detection d ON o.oid = d.oid\n-- Order by first detection date\nORDER BY \n    o.firstmjd\n-- Limit to 10 results\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 374,
                "id": "chatcmpl-BwxFQXyPP8J3VtbxTfWjo25ND4GHN",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "107",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 700,
                "out_toks": 15,
                "id": "chatcmpl-BwvLQlGM7J6riCyIMgaMGLOHJRgLl",
                "created": 1753383156,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with more than 500 detections, probability > 0.5 for asteroid class, and close to Solar System object\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.ranking,\n        p.class_name,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.dist,\n        xm.catid,\n        xm.oid_catalog\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.class_name = 'SN' -- Assuming 'SN' indicates asteroid class in 'stamp_classifier'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.ranking = 1\n        AND p.probability > 0.5\n        AND xm.dist < 2\n),\n-- For each object, find the earliest detection date\nfirst_detections AS (\n    SELECT\n        o.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    GROUP BY o.oid\n),\n-- For each object, find the latest detection date\nlast_detections AS (\n    SELECT\n        o.oid,\n        MAX(d.mjd) AS last_mjd\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    GROUP BY o.oid\n),\n-- For each object, find the detection with the earliest mjd (for filtering)\nmin_mjd_detections AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        d.mjd = (\n            SELECT MIN(mjd)\n            FROM detection\n            WHERE oid = o.oid\n        )\n)\n-- Final selection combining all info\nSELECT\n    so.oid AS ztf_id,\n    o.ndet AS num_detections,\n    fd.first_mjd AS first_detection_mjd,\n    ld.last_mjd AS last_detection_mjd,\n    so.probability,\n    md.candid AS candidate_id,\n    so.dist AS distance_arcsec,\n    so.oid_catalog AS mpc_name,\n    md.mjd AS detection_mjd,\n    md.fid AS filter_id\nFROM\n    selected_objects so\nJOIN\n    object o ON so.oid = o.oid\nJOIN\n    first_detections fd ON o.oid = fd.oid\nJOIN\n    last_detections ld ON o.oid = ld.oid\nJOIN\n    min_mjd_detections md ON o.oid = md.oid\nWHERE\n    -- Ensure the detection used is the earliest detection\n    md.mjd = fd.first_mjd\nORDER BY\n    fd.first_mjd\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with more than 500 detections, probability > 0.5 for asteroid class, and close to Solar System object\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.ranking,\n        p.class_name,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.dist,\n        xm.catid,\n        xm.oid_catalog\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.class_name = 'SN' -- Assuming 'SN' indicates asteroid class in 'stamp_classifier'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.ranking = 1\n        AND p.probability > 0.5\n        AND xm.dist < 2\n),\n-- For each object, find the earliest detection date\nfirst_detections AS (\n    SELECT\n        o.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    GROUP BY o.oid\n),\n-- For each object, find the latest detection date\nlast_detections AS (\n    SELECT\n        o.oid,\n        MAX(d.mjd) AS last_mjd\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    GROUP BY o.oid\n),\n-- For each object, find the detection with the earliest mjd (for filtering)\nmin_mjd_detections AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        d.mjd = (\n            SELECT MIN(mjd)\n            FROM detection\n            WHERE oid = o.oid\n        )\n)\n-- Final selection combining all info\nSELECT\n    so.oid AS ztf_id,\n    o.ndet AS num_detections,\n    fd.first_mjd AS first_detection_mjd,\n    ld.last_mjd AS last_detection_mjd,\n    so.probability,\n    md.candid AS candidate_id,\n    so.dist AS distance_arcsec,\n    so.oid_catalog AS mpc_name,\n    md.mjd AS detection_mjd,\n    md.fid AS filter_id\nFROM\n    selected_objects so\nJOIN\n    object o ON so.oid = o.oid\nJOIN\n    first_detections fd ON o.oid = fd.oid\nJOIN\n    last_detections ld ON o.oid = ld.oid\nJOIN\n    min_mjd_detections md ON o.oid = md.oid\nWHERE\n    -- Ensure the detection used is the earliest detection\n    md.mjd = fd.first_mjd\nORDER BY\n    fd.first_mjd\nLIMIT 10;\n```"
                },
                "in_toks": 2655,
                "out_toks": 693,
                "id": "chatcmpl-Bx080TdBLJQgzwkreT0bFH4Lytv3T",
                "created": 1753401544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.dist,\n        xm.catid,\n        xm.oid_catalog\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.class_name = 'SN' -- Assuming 'SN' in 'stamp_classifier' indicates asteroid class\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.ranking = 1\n        AND xm.dist < 2\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.class_name = 'SN' AND p.classifier_name = 'stamp_classifier' AND p.classifier_version = 'stamp_classifier_1.0.4' AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nJOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.dist,\n        xm.catid,\n        xm.oid_catalog\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.class_name = 'SN' -- Assuming 'SN' in 'stamp_classifier' indicates asteroid class\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.ranking = 1\n        AND xm.dist < 2\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.class_name = 'SN' AND p.classifier_name = 'stamp_classifier' AND p.classifier_version = 'stamp_classifier_1.0.4' AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nJOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 423,
                "id": "chatcmpl-BwxFRipF1xOIeCFvd8RvgVGjZGTcv",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "107",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 700,
                "out_toks": 15,
                "id": "chatcmpl-BwvLRlQH83bZdnEwSmXiOucUgBXnV",
                "created": 1753383157,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT\n    oid,\n    ndet,\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS first_detection_date,\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS last_detection_date,\n    probability,\n    candid,\n    dist,\n    catid,\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS detection_date,\n    fid\nFROM\n    selected_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT\n    oid,\n    ndet,\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS first_detection_date,\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS last_detection_date,\n    probability,\n    candid,\n    dist,\n    catid,\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS detection_date,\n    fid\nFROM\n    selected_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 299,
                "id": "chatcmpl-BwxFM2Ag1cRSB90n1QQ3q4sFuDgSX",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "107",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 700,
                "out_toks": 15,
                "id": "chatcmpl-BwvLSliXABe3fwprT2aYmMq2V50fm",
                "created": 1753383158,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN detection d ON o.oid = d.oid\n    LEFT JOIN xmatch xm ON o.oid = xm.oid\n    WHERE \n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'SN' -- Assuming 'SN' is used for asteroids in stamp classifier\n        AND p.ranking = 1\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT \n    oid AS ztf_object_id,\n    ndet AS number_of_detections,\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS first_detection_date,\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS last_detection_date,\n    probability,\n    candid AS candidate_id,\n    dist AS distance_arcsec,\n    catid AS mpc_name,\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS detection_date,\n    fid AS filter_id\nFROM selected_objects\nORDER BY firstmjd\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT \n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN detection d ON o.oid = d.oid\n    LEFT JOIN xmatch xm ON o.oid = xm.oid\n    WHERE \n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'SN' -- Assuming 'SN' is used for asteroids in stamp classifier\n        AND p.ranking = 1\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT \n    oid AS ztf_object_id,\n    ndet AS number_of_detections,\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS first_detection_date,\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS last_detection_date,\n    probability,\n    candid AS candidate_id,\n    dist AS distance_arcsec,\n    catid AS mpc_name,\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS detection_date,\n    fid AS filter_id\nFROM selected_objects\nORDER BY firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 338,
                "id": "chatcmpl-BwxFMMKJH8Qs0UYRimt9Cgj6WHmVL",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "107",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 700,
                "out_toks": 15,
                "id": "chatcmpl-BwvLSqRUhc1gn4GGql1JucW52r1VB",
                "created": 1753383158,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with more than 500 detections, matching the specified probability criteria,\n-- and with a close Solar System object match, limiting to 10 results ordered by first detection date.\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'SN' -- Assuming 'SN' corresponds to asteroids in this classifier\n        AND p.probability > 0.5\n        AND xm.dist < 2\n        AND p.ranking = 1 -- Ensure we select the top-ranked probability per object\n)\n-- Main query to fetch detection info and candidate details\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    -- Retrieve the earliest detection for the object\n    d.candid AS candidate_id,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name\nFROM\n    selected_objects o\nLEFT JOIN\n    probability p ON o.oid = p.oid\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'SN'\nLEFT JOIN\n    detection d ON o.oid = d.oid\n    AND d.mjd = (\n        SELECT MIN(mjd) FROM detection WHERE oid = o.oid\n    )\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with more than 500 detections, matching the specified probability criteria,\n-- and with a close Solar System object match, limiting to 10 results ordered by first detection date.\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'SN' -- Assuming 'SN' corresponds to asteroids in this classifier\n        AND p.probability > 0.5\n        AND xm.dist < 2\n        AND p.ranking = 1 -- Ensure we select the top-ranked probability per object\n)\n-- Main query to fetch detection info and candidate details\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    -- Retrieve the earliest detection for the object\n    d.candid AS candidate_id,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name\nFROM\n    selected_objects o\nLEFT JOIN\n    probability p ON o.oid = p.oid\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'SN'\nLEFT JOIN\n    detection d ON o.oid = d.oid\n    AND d.mjd = (\n        SELECT MIN(mjd) FROM detection WHERE oid = o.oid\n    )\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 2642,
                "out_toks": 490,
                "id": "chatcmpl-Bx081bbUeocrfwK23kh0RVlLLWUr9",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'SN' -- Assuming 'SN' is used for asteroids in the stamp classifier\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    -- Retrieve candidate id and detection date from detection table\n    d.candid AS candidate_id,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name\nFROM\n    selected_objects o\nLEFT JOIN\n    probability p ON o.oid = p.oid AND p.classifier_name = 'stamp_classifier' AND p.classifier_version = 'stamp_classifier_1.0.4' AND p.class_name = 'SN'\nLEFT JOIN\n    detection d ON o.oid = d.oid\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nWHERE\n    d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.classifier_name,\n        p.classifier_version,\n        xm.catid,\n        xm.oid_catalog,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        o.ndet > 500\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'SN' -- Assuming 'SN' is used for asteroids in the stamp classifier\n        AND p.probability > 0.5\n        AND xm.dist < 2\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    -- Retrieve candidate id and detection date from detection table\n    d.candid AS candidate_id,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name\nFROM\n    selected_objects o\nLEFT JOIN\n    probability p ON o.oid = p.oid AND p.classifier_name = 'stamp_classifier' AND p.classifier_version = 'stamp_classifier_1.0.4' AND p.class_name = 'SN'\nLEFT JOIN\n    detection d ON o.oid = d.oid\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nWHERE\n    d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 420,
                "id": "chatcmpl-BwxFOhSq2lxi14bWbX5i9qlNJK4iU",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "107",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 700,
                "out_toks": 15,
                "id": "chatcmpl-BwvLTTUP4kiDcpzt2xuqGEs91k0Im",
                "created": 1753383159,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select at most 10 objects with specified conditions\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability AS asteroid_probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM \n    object o\n-- Subquery to get the top probability for stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        oid,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' AND\n        classifier_version = 'stamp_classifier_1.0.4' AND\n        ranking = 1 AND\n        probability > 0.5\n) p ON o.oid = p.oid\n-- Subquery to get the nearest Solar System object within 2 arcsec\nJOIN (\n    SELECT \n        xm1.oid,\n        xm1.dist,\n        xm1.oid_catalog\n    FROM \n        xmatch xm1\n    WHERE \n        xm1.dist < 2\n        AND xm1.catid = 'solar_system'\n) xm ON o.oid = xm.oid\n-- Join to get detections for the object\nJOIN detection d ON o.oid = d.oid\n-- Filter for the earliest detection date for ordering\nWHERE \n    o.ndet > 500\nORDER BY \n    o.firstmjd\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 10 objects with specified conditions\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability AS asteroid_probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.oid_catalog AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM \n    object o\n-- Subquery to get the top probability for stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        oid,\n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier' AND\n        classifier_version = 'stamp_classifier_1.0.4' AND\n        ranking = 1 AND\n        probability > 0.5\n) p ON o.oid = p.oid\n-- Subquery to get the nearest Solar System object within 2 arcsec\nJOIN (\n    SELECT \n        xm1.oid,\n        xm1.dist,\n        xm1.oid_catalog\n    FROM \n        xmatch xm1\n    WHERE \n        xm1.dist < 2\n        AND xm1.catid = 'solar_system'\n) xm ON o.oid = xm.oid\n-- Join to get detections for the object\nJOIN detection d ON o.oid = d.oid\n-- Filter for the earliest detection date for ordering\nWHERE \n    o.ndet > 500\nORDER BY \n    o.firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 342,
                "id": "chatcmpl-BwxFQZpPHej5xfXxCFwvnHYzcDYqv",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "107",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 700,
                "out_toks": 15,
                "id": "chatcmpl-BwvLUyXaVFKjhMvIl8NaJ4AqwIW3V",
                "created": 1753383160,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with more than 500 detections, high asteroid probability, and close to Solar System objects\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        -- Filter for objects with more than 500 detections\n        o.ndet > 500\n        -- Filter for the most probable class being asteroid with probability > 0.5 in specified classifier version\n        AND p.class_name = 'asteroid'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.probability > 0.5\n        -- Ensure this is the top-ranked class for the object\n        AND p.ranking = 1\n        -- Filter for objects with a close match to Solar System objects (distance < 2 arcsec) or no match\n        AND (xm.dist IS NULL OR xm.dist < 2)\n)\n-- Retrieve relevant details, including the first detection date\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.catid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (\n        SELECT MIN(mjd) FROM detection WHERE oid = o.oid\n    )\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with more than 500 detections, high asteroid probability, and close to Solar System objects\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        -- Filter for objects with more than 500 detections\n        o.ndet > 500\n        -- Filter for the most probable class being asteroid with probability > 0.5 in specified classifier version\n        AND p.class_name = 'asteroid'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.probability > 0.5\n        -- Ensure this is the top-ranked class for the object\n        AND p.ranking = 1\n        -- Filter for objects with a close match to Solar System objects (distance < 2 arcsec) or no match\n        AND (xm.dist IS NULL OR xm.dist < 2)\n)\n-- Retrieve relevant details, including the first detection date\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.catid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (\n        SELECT MIN(mjd) FROM detection WHERE oid = o.oid\n    )\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 2714,
                "out_toks": 503,
                "id": "chatcmpl-Bx08A0fDmQOaE1ZH47ywiozP0K5CH",
                "created": 1753401554,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        -- Filter for objects with more than 500 detections\n        o.ndet > 500\n        -- Probability > 0.5 for asteroid class in stamp_classifier version 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.probability > 0.5\n        -- Most probable class (ranking=1)\n        AND p.ranking = 1\n        -- Distance from Solar System object below 2 arcsec\n        AND (xm.dist IS NULL OR xm.dist < 2)\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.catid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        p.class_name,\n        p.ranking,\n        d.candid,\n        d.mjd,\n        d.fid,\n        xm.catid,\n        xm.dist\n    FROM\n        object o\n    JOIN\n        probability p ON o.oid = p.oid\n    JOIN\n        detection d ON o.oid = d.oid\n    LEFT JOIN\n        xmatch xm ON o.oid = xm.oid\n    WHERE\n        -- Filter for objects with more than 500 detections\n        o.ndet > 500\n        -- Probability > 0.5 for asteroid class in stamp_classifier version 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.probability > 0.5\n        -- Most probable class (ranking=1)\n        AND p.ranking = 1\n        -- Distance from Solar System object below 2 arcsec\n        AND (xm.dist IS NULL OR xm.dist < 2)\n)\nSELECT\n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_mjd,\n    o.lastmjd AS last_detection_mjd,\n    p.probability,\n    d.candid AS candidate_id,\n    xm.dist AS distance_arcsec,\n    xm.catid AS mpc_name,\n    d.mjd AS detection_mjd,\n    d.fid AS filter_id\nFROM\n    selected_objects o\nJOIN\n    probability p ON o.oid = p.oid AND p.ranking = 1\nJOIN\n    detection d ON o.oid = d.oid AND d.mjd = (SELECT MIN(mjd) FROM detection WHERE oid = o.oid)\nLEFT JOIN\n    xmatch xm ON o.oid = xm.oid\nORDER BY\n    o.firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3280,
                "out_toks": 455,
                "id": "chatcmpl-BwxFMT6tMrmAxnQjzWrcfKnjfSHua",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "83": {
        "0": {
            "req_id": "83",
            "experiment_id": "run_0",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 762,
                "out_toks": 8,
                "id": "chatcmpl-BjAczuLFHIvvvuOgzvONJz9txTrMY",
                "created": 1750105313,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFMGODuZ06Dt5bd9LnkZ2y1RQU5",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "83",
            "experiment_id": "run_1",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 762,
                "out_toks": 8,
                "id": "chatcmpl-BjAczuLFHIvvvuOgzvONJz9txTrMY",
                "created": 1750105313,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFItVjML9tBFjEg6v07CuWvyGuV",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "83",
            "experiment_id": "run_2",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 609,
                "out_toks": 4,
                "id": "chatcmpl-BwvLUrtGCWEz5FQKrRS0Vggy76jd9",
                "created": 1753383160,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFOtWz2jdgfXMYqjAR2FoA76rZx",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "83",
            "experiment_id": "run_3",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 609,
                "out_toks": 4,
                "id": "chatcmpl-BwvLVRO6NSAEXXLqxHXK7j4QgNRyH",
                "created": 1753383161,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFRLys2ew7HGYj1QMQah172ERyq",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "83",
            "experiment_id": "run_4",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 609,
                "out_toks": 4,
                "id": "chatcmpl-BwvLVkQjy3jC5UnzWUfMpQznyzwhq",
                "created": 1753383161,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFOogbqd6mrHlcnSdUlQTQ64rGA",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "83",
            "experiment_id": "run_5",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 609,
                "out_toks": 4,
                "id": "chatcmpl-BwvLWtdhJAUgEyHiADl8HuDNRfOua",
                "created": 1753383162,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFIcTFdzb7WIBefUBiqWH8sh632",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "83",
            "experiment_id": "run_6",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 609,
                "out_toks": 4,
                "id": "chatcmpl-BwvLWs99TFk0R1rLEQ5q7SQTkjJt0",
                "created": 1753383162,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFJzvF4bJi8WMVR031RDggkLHq7",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "83",
            "experiment_id": "run_7",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 609,
                "out_toks": 4,
                "id": "chatcmpl-BwvLXWbMrC2V3Grm7xrRBlMftykxd",
                "created": 1753383163,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFN4gNkcUDbsSkrXIkjY4WE2wMp",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "83",
            "experiment_id": "run_8",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 609,
                "out_toks": 4,
                "id": "chatcmpl-BwvLXJehzF16uHdCOUI0JGFj7Wtkk",
                "created": 1753383163,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFSz7eWWKrCBIFMmrTmYL6mTPrU",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "83",
            "experiment_id": "run_9",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']"
                },
                "in_toks": 609,
                "out_toks": 4,
                "id": "chatcmpl-BwvLY5tiMYDRKhvqjYCcXGvT2Mhb6",
                "created": 1753383164,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2561,
                "out_toks": 25,
                "id": "chatcmpl-BwxFOPTOP3UsUfqoFijHHGnRXiVoo",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "84": {
        "0": {
            "req_id": "84",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'allwise']",
                    "1": "['object', 'allwise']"
                },
                "in_toks": 786,
                "out_toks": 14,
                "id": "chatcmpl-BjAd0phqsWHuhBzSAXPfu8dM1SjZd",
                "created": 1750105314,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        a.oid_catalog,\n        a.ra,\n        a.dec,\n        q3c_dist(z.meanra, z.meandec, a.ra, a.dec) AS distance,\n        a.w1mpro,\n        a.w2mpro,\n        a.w3mpro,\n        a.w4mpro\n    FROM allwise a\n    JOIN ztf_object z ON q3c_join(z.meanra, z.meandec, a.ra, a.dec, 0.5) -- assuming a 0.5 degree radius for matching\n)\nSELECT\n    'ZTF19aascdol' AS ztf_oid,\n    oid_catalog,\n    distance,\n    w1mpro AS W1,\n    w2mpro AS W2,\n    w3mpro AS W3,\n    w4mpro AS W4\nFROM wise_matches;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        a.oid_catalog,\n        a.ra,\n        a.dec,\n        q3c_dist(z.meanra, z.meandec, a.ra, a.dec) AS distance,\n        a.w1mpro,\n        a.w2mpro,\n        a.w3mpro,\n        a.w4mpro\n    FROM allwise a\n    JOIN ztf_object z ON q3c_join(z.meanra, z.meandec, a.ra, a.dec, 0.5) -- assuming a 0.5 degree radius for matching\n)\nSELECT\n    'ZTF19aascdol' AS ztf_oid,\n    oid_catalog,\n    distance,\n    w1mpro AS W1,\n    w2mpro AS W2,\n    w3mpro AS W3,\n    w4mpro AS W4\nFROM wise_matches;\n```"
                },
                "in_toks": 3087,
                "out_toks": 237,
                "id": "chatcmpl-BwxFIF2qsEghiMHfCdKboCkespSzH",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "84",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'allwise']",
                    "1": "['object', 'allwise']"
                },
                "in_toks": 786,
                "out_toks": 14,
                "id": "chatcmpl-BjAd0phqsWHuhBzSAXPfu8dM1SjZd",
                "created": 1750105314,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        o.oid_catalog,\n        o.ra,\n        o.dec,\n        q3c_dist(z.meanra, z.meandec, o.ra, o.dec) AS distance_deg,\n        o.w1mpro,\n        o.w2mpro,\n        o.w3mpro,\n        o.w4mpro\n    FROM allwise o\n    CROSS JOIN ztf_object z\n    WHERE q3c_join(z.meanra, z.meandec, o.ra, o.dec, 0.000277778) -- 1 arcsecond in degrees\n)\nSELECT\n    'ZTF19aascdol' AS ztf_oid,\n    oid_catalog,\n    distance_deg,\n    w1mpro,\n    w2mpro,\n    w3mpro,\n    w4mpro\nFROM wise_matches;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        o.oid_catalog,\n        o.ra,\n        o.dec,\n        q3c_dist(z.meanra, z.meandec, o.ra, o.dec) AS distance_deg,\n        o.w1mpro,\n        o.w2mpro,\n        o.w3mpro,\n        o.w4mpro\n    FROM allwise o\n    CROSS JOIN ztf_object z\n    WHERE q3c_join(z.meanra, z.meandec, o.ra, o.dec, 0.000277778) -- 1 arcsecond in degrees\n)\nSELECT\n    'ZTF19aascdol' AS ztf_oid,\n    oid_catalog,\n    distance_deg,\n    w1mpro,\n    w2mpro,\n    w3mpro,\n    w4mpro\nFROM wise_matches;\n```"
                },
                "in_toks": 3087,
                "out_toks": 235,
                "id": "chatcmpl-BwxFIN6xoXKVtqhAWJ7aSCHlRR6EZ",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "84",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 11,
                "id": "chatcmpl-BwvLYKmjlIGmJFbkcgzumMp6Flf6l",
                "created": 1753383164,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object\nSELECT \n    o.oid AS ztf_object_id,\n    aw.oid_catalog AS allwise_catalog_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object\nSELECT \n    o.oid AS ztf_object_id,\n    aw.oid_catalog AS allwise_catalog_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```"
                },
                "in_toks": 3200,
                "out_toks": 150,
                "id": "chatcmpl-BwxFOIZta8RFGRpyVnsVQeZrbwyld",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "84",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 11,
                "id": "chatcmpl-BwvLZz5P39wRMMrpEwHZeveHzArSy",
                "created": 1753383165,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```"
                },
                "in_toks": 3200,
                "out_toks": 134,
                "id": "chatcmpl-BwxFKzs2cNzLxZkDuslErFI15wmva",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "84",
            "experiment_id": "run_4",
            "pred_tables": [
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 8,
                "id": "chatcmpl-BwvLZIOt8LsiwuHqCmZTz6QWDqGlY",
                "created": 1753383165,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    z.oid AS ztf_oid,\n    a.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    a.w1mpro AS W1_magnitude,\n    a.w2mpro AS W2_magnitude,\n    a.w3mpro AS W3_magnitude,\n    a.w4mpro AS W4_magnitude\nFROM \n    object z\nJOIN \n    xmatch x ON z.oid = x.oid\nJOIN \n    allwise a ON x.oid_catalog = a.oid_catalog\nWHERE \n    z.oid = 'ZTF19aascdol';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    z.oid AS ztf_oid,\n    a.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    a.w1mpro AS W1_magnitude,\n    a.w2mpro AS W2_magnitude,\n    a.w3mpro AS W3_magnitude,\n    a.w4mpro AS W4_magnitude\nFROM \n    object z\nJOIN \n    xmatch x ON z.oid = x.oid\nJOIN \n    allwise a ON x.oid_catalog = a.oid_catalog\nWHERE \n    z.oid = 'ZTF19aascdol';\n```"
                },
                "in_toks": 2718,
                "out_toks": 134,
                "id": "chatcmpl-BwxFIBlVrHzqZhO7nvvNPbcnm5AIx",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "84",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 11,
                "id": "chatcmpl-BwvLaQECJ1N4RiKdfRTzkCc99PJnT",
                "created": 1753383166,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```"
                },
                "in_toks": 3200,
                "out_toks": 155,
                "id": "chatcmpl-BwxFSwvcZaKlbIYM1PxsH7BrHrBMr",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "84",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 11,
                "id": "chatcmpl-BwvLaXjB0dx32tApHzbcwm4gzL1Ag",
                "created": 1753383166,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```"
                },
                "in_toks": 3200,
                "out_toks": 155,
                "id": "chatcmpl-BwxFOI9hvYsLX79rOJlbNnOQ7hlN6",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "84",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 11,
                "id": "chatcmpl-BwvLbsEFQetjHAb713ckGfdt4Go6k",
                "created": 1753383167,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    aw.oid_catalog AS wise_catalog_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS ztf_object_id,\n    aw.oid_catalog AS wise_catalog_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```"
                },
                "in_toks": 3200,
                "out_toks": 135,
                "id": "chatcmpl-BwxFT4WBHUpevWHP5ACicXVUXqIcJ",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "84",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 11,
                "id": "chatcmpl-BwvLb1v5GfZ9kK7jfQp25iB6bVuYU",
                "created": 1753383167,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```"
                },
                "in_toks": 3200,
                "out_toks": 148,
                "id": "chatcmpl-BwxFI1HvCQqkvv8RNgcPZZJiVfi8N",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "84",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "xmatch",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'allwise']"
                },
                "in_toks": 633,
                "out_toks": 11,
                "id": "chatcmpl-BwvLciPuTaNcNKHGWNW1Uux4rZR8X",
                "created": 1753383168,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nSELECT \n    o.oid AS ztf_oid,\n    aw.oid_catalog AS allwise_id,\n    x.dist AS distance_arcsec,\n    aw.w1mpro AS W1_magnitude,\n    aw.w2mpro AS W2_magnitude,\n    aw.w3mpro AS W3_magnitude,\n    aw.w4mpro AS W4_magnitude\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nJOIN \n    allwise aw ON x.oid_catalog = aw.oid_catalog\nWHERE \n    o.oid = 'ZTF19aascdol';\n```"
                },
                "in_toks": 3200,
                "out_toks": 155,
                "id": "chatcmpl-BwxFI3UKNqZSfyhYV9QFBZumi9aYP",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "96": {
        "0": {
            "req_id": "96",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']",
                    "1": "['ss_ztf', 'detection']"
                },
                "in_toks": 824,
                "out_toks": 20,
                "id": "chatcmpl-BjAd0R3aN83TsMDefiPFMVhlPHAYF",
                "created": 1750105314,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their names and coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name,  /* Solar System object name */\n           0.0 AS ra,               /* Placeholder RA, replace with actual RA if known */\n           0.0 AS dec               /* Placeholder Dec, replace with actual Dec if known */\n    UNION ALL\n    SELECT '2009UK56', 0.0, 0.0   /* Same as above for second object */\n),\n-- Find objects within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    -- Use q3c_join to find objects within the specified radius of each source\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n)\n-- Final output: join with ss_ztf for MPC name and include specified columns\nSELECT\n    s.*,  -- All columns from ss_ztf\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their names and coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name,  /* Solar System object name */\n           0.0 AS ra,               /* Placeholder RA, replace with actual RA if known */\n           0.0 AS dec               /* Placeholder Dec, replace with actual Dec if known */\n    UNION ALL\n    SELECT '2009UK56', 0.0, 0.0   /* Same as above for second object */\n),\n-- Find objects within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    -- Use q3c_join to find objects within the specified radius of each source\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n)\n-- Final output: join with ss_ztf for MPC name and include specified columns\nSELECT\n    s.*,  -- All columns from ss_ztf\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 1905,
                "out_toks": 343,
                "id": "chatcmpl-Bx07zvTYDNptz4QsjFYMDcSVATsAG",
                "created": 1753401543,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra_value1 AS ra, dec_value1 AS dec\n    UNION ALL\n    SELECT '2009UK56', ra_value2, dec_value2\n),\n-- Find objects within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n)\n-- Final output: join with ss_ztf for MPC name and include specified columns\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra_value1 AS ra, dec_value1 AS dec\n    UNION ALL\n    SELECT '2009UK56', ra_value2, dec_value2\n),\n-- Find objects within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n)\n-- Final output: join with ss_ztf for MPC name and include specified columns\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2635,
                "out_toks": 270,
                "id": "chatcmpl-BwxFOShOa5GWliB1nG0Eas4jCYsvR",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "96",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']",
                    "1": "['ss_ztf', 'detection']"
                },
                "in_toks": 824,
                "out_toks": 20,
                "id": "chatcmpl-BjAd0R3aN83TsMDefiPFMVhlPHAYF",
                "created": 1750105314,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their coordinates by retrieving RA and Dec from the object table\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra, dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra, dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find detections within approximately 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN sources s ON -- Use a spatial join based on RA/Dec proximity\n        -- Since q3c functions are not explicitly provided, use a bounding box filter for approximate proximity\n        d.ra BETWEEN s.ra - 0.0005556 AND s.ra + 0.0005556\n        AND d.dec BETWEEN s.dec - 0.0005556 AND s.dec + 0.0005556\n),\n-- Join with ss_ztf to get solar system info for objects near the sources\nss_info AS (\n    SELECT ss.*, nd.candid, nd.mjd, nd.fid, nd.isdiffpos, nd.ra AS detection_ra, nd.dec AS detection_dec,\n           nd.magpsf AS diff_mag, nd.sigmapsf AS mag_uncertainty\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Select all columns from ss_info, including detection details, and order by MPC name and detection date\nSELECT\n    ss_info.*\nFROM ss_info\nORDER BY ss_info.ssnamenr, ss_info.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates by retrieving RA and Dec from the object table\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra, dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra, dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find detections within approximately 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN sources s ON -- Use a spatial join based on RA/Dec proximity\n        -- Since q3c functions are not explicitly provided, use a bounding box filter for approximate proximity\n        d.ra BETWEEN s.ra - 0.0005556 AND s.ra + 0.0005556\n        AND d.dec BETWEEN s.dec - 0.0005556 AND s.dec + 0.0005556\n),\n-- Join with ss_ztf to get solar system info for objects near the sources\nss_info AS (\n    SELECT ss.*, nd.candid, nd.mjd, nd.fid, nd.isdiffpos, nd.ra AS detection_ra, nd.dec AS detection_dec,\n           nd.magpsf AS diff_mag, nd.sigmapsf AS mag_uncertainty\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Select all columns from ss_info, including detection details, and order by MPC name and detection date\nSELECT\n    ss_info.*\nFROM ss_info\nORDER BY ss_info.ssnamenr, ss_info.mjd;\n```"
                },
                "in_toks": 1926,
                "out_toks": 363,
                "id": "chatcmpl-Bx07xgXe60MbMbw6aUOjLWMfgatCH",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find detections within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN sources s ON q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n),\n-- Join with ss_ztf to get solar system info\nss_info AS (\n    SELECT ss.*, nd.candid, nd.mjd, nd.fid, nd.isdiffpos, nd.ra AS detection_ra, nd.dec AS detection_dec, nd.magpsf AS diff_mag, nd.sigmapsf AS mag_uncertainty\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Select required columns and sort\nSELECT\n    ss_info.*\nFROM ss_info\nORDER BY ss_info.ssnamenr, ss_info.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find detections within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN sources s ON q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n),\n-- Join with ss_ztf to get solar system info\nss_info AS (\n    SELECT ss.*, nd.candid, nd.mjd, nd.fid, nd.isdiffpos, nd.ra AS detection_ra, nd.dec AS detection_dec, nd.magpsf AS diff_mag, nd.sigmapsf AS mag_uncertainty\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Select required columns and sort\nSELECT\n    ss_info.*\nFROM ss_info\nORDER BY ss_info.ssnamenr, ss_info.mjd;\n```"
                },
                "in_toks": 2635,
                "out_toks": 282,
                "id": "chatcmpl-BwxFLJKHrmrAg081XABHZ5fAc1jeM",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "96",
            "experiment_id": "run_2",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 671,
                "out_toks": 10,
                "id": "chatcmpl-BwvLcZutspzz6NvUZ94SPQhezHjOF",
                "created": 1753383168,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary table with the identifiers of the specified solar system objects\nWITH ss_objects AS (\n    SELECT * FROM (\n        VALUES\n            ('2003FP134'), -- Solar system object identifier\n            ('2009UK56')   -- Solar system object identifier\n    ) AS t(name)\n),\n-- Retrieve the nearest known solar system objects from ss_ztf matching the identifiers\nss_nearest AS (\n    SELECT s.*\n    FROM ss_ztf s\n    JOIN ss_objects o ON s.ssnamenr = o.name\n),\n-- Assuming we have the actual RA/Dec for these objects, replace the placeholders with real coordinates if available\n-- For this example, we proceed with placeholder coordinates (0,0). If actual coordinates are known, replace accordingly.\n-- Find objects in ss_ztf within 2 arcseconds (~0.0005556 degrees) of the known objects\nmatched_ss AS (\n    SELECT s.*\n    FROM ss_nearest s\n    WHERE -- Use a spatial distance check; since q3c functions are not available, approximate with coordinate differences\n          -- Note: For precise angular separation, a proper spherical distance function is needed.\n          -- Here, we approximate with coordinate differences for small angles.\n          ABS(s.ra - 0.0) <= 0.0005556 AND -- Replace 0.0 with actual RA if known\n          ABS(s.decl - 0.0) <= 0.0005556 -- Replace 0.0 with actual Dec if known\n),\n-- Retrieve detections for objects associated with the matched solar system objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN matched_ss ms ON d.oid = ms.oid\n)\n-- Select all columns from ss_ztf, plus detection info, sorted by name and detection date\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_ztf ss\nJOIN detections d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the identifiers of the specified solar system objects\nWITH ss_objects AS (\n    SELECT * FROM (\n        VALUES\n            ('2003FP134'), -- Solar system object identifier\n            ('2009UK56')   -- Solar system object identifier\n    ) AS t(name)\n),\n-- Retrieve the nearest known solar system objects from ss_ztf matching the identifiers\nss_nearest AS (\n    SELECT s.*\n    FROM ss_ztf s\n    JOIN ss_objects o ON s.ssnamenr = o.name\n),\n-- Assuming we have the actual RA/Dec for these objects, replace the placeholders with real coordinates if available\n-- For this example, we proceed with placeholder coordinates (0,0). If actual coordinates are known, replace accordingly.\n-- Find objects in ss_ztf within 2 arcseconds (~0.0005556 degrees) of the known objects\nmatched_ss AS (\n    SELECT s.*\n    FROM ss_nearest s\n    WHERE -- Use a spatial distance check; since q3c functions are not available, approximate with coordinate differences\n          -- Note: For precise angular separation, a proper spherical distance function is needed.\n          -- Here, we approximate with coordinate differences for small angles.\n          ABS(s.ra - 0.0) <= 0.0005556 AND -- Replace 0.0 with actual RA if known\n          ABS(s.decl - 0.0) <= 0.0005556 -- Replace 0.0 with actual Dec if known\n),\n-- Retrieve detections for objects associated with the matched solar system objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN matched_ss ms ON d.oid = ms.oid\n)\n-- Select all columns from ss_ztf, plus detection info, sorted by name and detection date\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_ztf ss\nJOIN detections d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2168,
                "out_toks": 469,
                "id": "chatcmpl-Bx087M3CLs2Yap4h5pbbYtAGQY0cA",
                "created": 1753401551,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define a temporary table with the coordinates of the specified solar system objects\nWITH ss_objects AS (\n    SELECT * FROM (\n        VALUES\n            ('2003FP134', 0.0, 0.0), -- Placeholder RA/Dec, replace with actual coordinates if known\n            ('2009UK56', 0.0, 0.0) -- Placeholder RA/Dec, replace with actual coordinates if known\n    ) AS t(name, ra, dec)\n),\n-- Cross-match with ss_ztf to find objects within 2 arcseconds (~0.0005556 degrees)\nmatched_ss AS (\n    SELECT s.*\n    FROM ss_objects s\n    JOIN ss_ztf ON ss_ztf.ssnamenr = s.name\n    WHERE q3c_join(ss_ztf.ssnamenr, ss_ztf.ssnamenr, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for objects associated with the matched solar system objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN matched_ss ON d.oid = matched_ss.oid\n)\n-- Select required columns, including all from ss_ztf and specified detection info, sorted accordingly\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_ztf ss\nJOIN detections d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary table with the coordinates of the specified solar system objects\nWITH ss_objects AS (\n    SELECT * FROM (\n        VALUES\n            ('2003FP134', 0.0, 0.0), -- Placeholder RA/Dec, replace with actual coordinates if known\n            ('2009UK56', 0.0, 0.0) -- Placeholder RA/Dec, replace with actual coordinates if known\n    ) AS t(name, ra, dec)\n),\n-- Cross-match with ss_ztf to find objects within 2 arcseconds (~0.0005556 degrees)\nmatched_ss AS (\n    SELECT s.*\n    FROM ss_objects s\n    JOIN ss_ztf ON ss_ztf.ssnamenr = s.name\n    WHERE q3c_join(ss_ztf.ssnamenr, ss_ztf.ssnamenr, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for objects associated with the matched solar system objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN matched_ss ON d.oid = matched_ss.oid\n)\n-- Select required columns, including all from ss_ztf and specified detection info, sorted accordingly\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_ztf ss\nJOIN detections d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2635,
                "out_toks": 349,
                "id": "chatcmpl-BwxFI8a57vdc1ptko6GpiISLABgrP",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "96",
            "experiment_id": "run_3",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 671,
                "out_toks": 10,
                "id": "chatcmpl-BwvLelfklnev0RFpepb0fkIHSK3lq",
                "created": 1753383170,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name,  /* Known solar system object name */\n           0.0 AS ra,               /* Placeholder RA for 2003FP134, replace with actual value if known */\n           0.0 AS dec               /* Placeholder Dec for 2003FP134, replace with actual value if known */\n    UNION ALL\n    SELECT '2009UK56', 0.0, 0.0     /* Placeholder RA/Dec for 2009UK56, replace with actual values if available */\n),\n-- Select sources within 2 arcseconds (which is 2/3600 degrees)\nnear_sources AS (\n    SELECT s.mpc_name, s.ra, s.dec\n    FROM sources s\n    WHERE TRUE\n    -- Since actual RA/Dec values are placeholders, the following filter is omitted.\n    -- If actual coordinates are known, replace the placeholders with real values and uncomment the following:\n    -- WHERE EXISTS (\n    --     SELECT 1\n    --     FROM q3c_radial_query(s.ra, s.dec, s.ra, s.dec, 2/3600.0)\n    -- )\n),\n-- Get all detections for objects near the sources\ndetections AS (\n    SELECT d.*, o.ssnamenr\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    WHERE EXISTS (\n        SELECT 1\n        FROM near_sources ns\n        WHERE q3c_join(d.ra, d.dec, ns.ra, ns.dec, 2/3600.0)\n    )\n)\n-- Select required columns, including from ss_ztf\nSELECT\n    s.*,  -- All columns from ss_ztf\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name,  /* Known solar system object name */\n           0.0 AS ra,               /* Placeholder RA for 2003FP134, replace with actual value if known */\n           0.0 AS dec               /* Placeholder Dec for 2003FP134, replace with actual value if known */\n    UNION ALL\n    SELECT '2009UK56', 0.0, 0.0     /* Placeholder RA/Dec for 2009UK56, replace with actual values if available */\n),\n-- Select sources within 2 arcseconds (which is 2/3600 degrees)\nnear_sources AS (\n    SELECT s.mpc_name, s.ra, s.dec\n    FROM sources s\n    WHERE TRUE\n    -- Since actual RA/Dec values are placeholders, the following filter is omitted.\n    -- If actual coordinates are known, replace the placeholders with real values and uncomment the following:\n    -- WHERE EXISTS (\n    --     SELECT 1\n    --     FROM q3c_radial_query(s.ra, s.dec, s.ra, s.dec, 2/3600.0)\n    -- )\n),\n-- Get all detections for objects near the sources\ndetections AS (\n    SELECT d.*, o.ssnamenr\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    WHERE EXISTS (\n        SELECT 1\n        FROM near_sources ns\n        WHERE q3c_join(d.ra, d.dec, ns.ra, ns.dec, 2/3600.0)\n    )\n)\n-- Select required columns, including from ss_ztf\nSELECT\n    s.*,  -- All columns from ss_ztf\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2117,
                "out_toks": 454,
                "id": "chatcmpl-Bx085wl7Qm4HYZoGv67td5ZFBJk5S",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra_value1 AS ra, dec_value1 AS dec\n    UNION ALL\n    SELECT '2009UK56', ra_value2, dec_value2\n),\n-- Select sources within 2 arcseconds (which is 2/3600 degrees)\nnear_sources AS (\n    SELECT s.mpc_name, s.ra, s.dec\n    FROM sources s\n    WHERE EXISTS (\n        SELECT 1\n        FROM q3c_poly_query(s.ra, s.dec, ARRAY[\n            -- Placeholder for the polygon points if needed, or use q3c_radial_query\n        ]) -- Not used here, so proceed with q3c_join\n        WHERE q3c_join(d.ra, d.dec, s.ra, s.dec, 2/3600.0)\n    )\n),\n-- Get all detections for objects near the sources\ndetections AS (\n    SELECT d.*, o.ssnamenr\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    WHERE EXISTS (\n        SELECT 1\n        FROM near_sources ns\n        WHERE q3c_join(d.ra, d.dec, ns.ra, ns.dec, 2/3600.0)\n    )\n)\n-- Select required columns, including from ss_ztf\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra_value1 AS ra, dec_value1 AS dec\n    UNION ALL\n    SELECT '2009UK56', ra_value2, dec_value2\n),\n-- Select sources within 2 arcseconds (which is 2/3600 degrees)\nnear_sources AS (\n    SELECT s.mpc_name, s.ra, s.dec\n    FROM sources s\n    WHERE EXISTS (\n        SELECT 1\n        FROM q3c_poly_query(s.ra, s.dec, ARRAY[\n            -- Placeholder for the polygon points if needed, or use q3c_radial_query\n        ]) -- Not used here, so proceed with q3c_join\n        WHERE q3c_join(d.ra, d.dec, s.ra, s.dec, 2/3600.0)\n    )\n),\n-- Get all detections for objects near the sources\ndetections AS (\n    SELECT d.*, o.ssnamenr\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    WHERE EXISTS (\n        SELECT 1\n        FROM near_sources ns\n        WHERE q3c_join(d.ra, d.dec, ns.ra, ns.dec, 2/3600.0)\n    )\n)\n-- Select required columns, including from ss_ztf\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN detections d ON s.oid = d.oid\nORDER BY s.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2635,
                "out_toks": 378,
                "id": "chatcmpl-BwxFS1MlR60VisiUP7rArauheBs6w",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "96",
            "experiment_id": "run_4",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 671,
                "out_toks": 10,
                "id": "chatcmpl-BwvLe2WpXtpqSHpBE3mdxJ9GkXmBz",
                "created": 1753383170,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name,  /* Solar System object name */\n           -- Coordinates for 2003FP134 (replace with actual RA/Dec values)\n           0.0 AS ra,  -- Placeholder, replace with actual RA in degrees\n           0.0 AS dec  -- Placeholder, replace with actual Dec in degrees\n    UNION ALL\n    SELECT '2009UK56',  /* Solar System object name */\n           -- Coordinates for 2009UK56 (replace with actual RA/Dec values)\n           0.0,  -- Placeholder, replace with actual RA in degrees\n           0.0   -- Placeholder, replace with actual Dec in degrees\n),\n-- Calculate the angular distance between each detection and the sources\ncandidate_matches AS (\n    SELECT d.*, s.mpc_name, s.ra AS source_ra, s.dec AS source_dec,\n           -- Calculate angular distance in degrees using the haversine formula or similar\n           -- Since q3c_dist is not available, approximate with the spherical law of cosines\n           ACOS(\n               SIN(RADIANS(d.ra)) * SIN(RADIANS(s.ra))\n               + COS(RADIANS(d.ra)) * COS(RADIANS(s.ra)) * COS(RADIANS(d.dec) - RADIANS(s.dec))\n           ) AS distance_deg\n    FROM detection d\n    CROSS JOIN sources s\n)\n-- Select detections within 2 arcseconds (~0.0005556 degrees)\nSELECT\n    ss.oid,\n    ss.candid,\n    ss.ssdistnr,\n    ss.ssmagnr,\n    ss.ssnamenr,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM\n    ss_ztf ss\nJOIN\n    candidate_matches d ON ss.oid = d.oid\nWHERE\n    d.distance_deg <= (2.0 / 3600)  -- 2 arcseconds in degrees\nORDER BY\n    ss.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name,  /* Solar System object name */\n           -- Coordinates for 2003FP134 (replace with actual RA/Dec values)\n           0.0 AS ra,  -- Placeholder, replace with actual RA in degrees\n           0.0 AS dec  -- Placeholder, replace with actual Dec in degrees\n    UNION ALL\n    SELECT '2009UK56',  /* Solar System object name */\n           -- Coordinates for 2009UK56 (replace with actual RA/Dec values)\n           0.0,  -- Placeholder, replace with actual RA in degrees\n           0.0   -- Placeholder, replace with actual Dec in degrees\n),\n-- Calculate the angular distance between each detection and the sources\ncandidate_matches AS (\n    SELECT d.*, s.mpc_name, s.ra AS source_ra, s.dec AS source_dec,\n           -- Calculate angular distance in degrees using the haversine formula or similar\n           -- Since q3c_dist is not available, approximate with the spherical law of cosines\n           ACOS(\n               SIN(RADIANS(d.ra)) * SIN(RADIANS(s.ra))\n               + COS(RADIANS(d.ra)) * COS(RADIANS(s.ra)) * COS(RADIANS(d.dec) - RADIANS(s.dec))\n           ) AS distance_deg\n    FROM detection d\n    CROSS JOIN sources s\n)\n-- Select detections within 2 arcseconds (~0.0005556 degrees)\nSELECT\n    ss.oid,\n    ss.candid,\n    ss.ssdistnr,\n    ss.ssmagnr,\n    ss.ssnamenr,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM\n    ss_ztf ss\nJOIN\n    candidate_matches d ON ss.oid = d.oid\nWHERE\n    d.distance_deg <= (2.0 / 3600)  -- 2 arcseconds in degrees\nORDER BY\n    ss.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 1931,
                "out_toks": 461,
                "id": "chatcmpl-Bx08AL5luxD4WZOTgs7K8E4uhsKDE",
                "created": 1753401554,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra_value1 AS ra, dec_value1 AS dec\n    UNION ALL\n    SELECT '2009UK56', ra_value2, dec_value2\n),\n-- Calculate the angular distance between each detection and the sources\ncandidate_matches AS (\n    SELECT d.*, s.mpc_name, s.ra AS source_ra, s.dec AS source_dec,\n           q3c_dist(d.ra, d.dec, s.ra, s.dec) AS distance_deg\n    FROM detection d\n    JOIN sources s ON TRUE\n)\n-- Select detections within 2 arcseconds (~0.0005556 degrees)\nSELECT\n    ss.oid,\n    ss.candid,\n    ss.ssdistnr,\n    ss.ssmagnr,\n    ss.ssnamenr,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM\n    ss_ztf ss\nJOIN\n    candidate_matches d ON ss.oid = d.oid\nWHERE\n    d.distance_deg <= 2.0 / 3600 -- 2 arcseconds in degrees\nORDER BY\n    ss.ssnamenr, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra_value1 AS ra, dec_value1 AS dec\n    UNION ALL\n    SELECT '2009UK56', ra_value2, dec_value2\n),\n-- Calculate the angular distance between each detection and the sources\ncandidate_matches AS (\n    SELECT d.*, s.mpc_name, s.ra AS source_ra, s.dec AS source_dec,\n           q3c_dist(d.ra, d.dec, s.ra, s.dec) AS distance_deg\n    FROM detection d\n    JOIN sources s ON TRUE\n)\n-- Select detections within 2 arcseconds (~0.0005556 degrees)\nSELECT\n    ss.oid,\n    ss.candid,\n    ss.ssdistnr,\n    ss.ssmagnr,\n    ss.ssnamenr,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM\n    ss_ztf ss\nJOIN\n    candidate_matches d ON ss.oid = d.oid\nWHERE\n    d.distance_deg <= 2.0 / 3600 -- 2 arcseconds in degrees\nORDER BY\n    ss.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2635,
                "out_toks": 287,
                "id": "chatcmpl-BwxFP8Kk3hzRpwv4euYZQqFGgnhsF",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "96",
            "experiment_id": "run_5",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 671,
                "out_toks": 10,
                "id": "chatcmpl-BwvLfzQpjdaa95tuH6yr4bYaI6fwI",
                "created": 1753383171,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their coordinates by retrieving RA and Dec from the object table\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2009UK56'\n),\n-- Find all objects within 2 arcseconds (2/3600 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 2.0/3600)\n),\n-- Retrieve solar system info for these nearby objects\nss_info AS (\n    SELECT ss.*\n    FROM ss_ztf ss\n    JOIN nearby_objects no ON ss.oid = no.oid\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN nearby_objects no ON d.oid = no.oid\n)\n-- Final select with required columns, sorted by MPC name and detection date\nSELECT\n    ss_info.*, -- all columns from ss_ztf\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_info\nJOIN detections d ON ss_info.oid = d.oid\nORDER BY ss_info.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates by retrieving RA and Dec from the object table\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2009UK56'\n),\n-- Find all objects within 2 arcseconds (2/3600 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 2.0/3600)\n),\n-- Retrieve solar system info for these nearby objects\nss_info AS (\n    SELECT ss.*\n    FROM ss_ztf ss\n    JOIN nearby_objects no ON ss.oid = no.oid\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN nearby_objects no ON d.oid = no.oid\n)\n-- Final select with required columns, sorted by MPC name and detection date\nSELECT\n    ss_info.*, -- all columns from ss_ztf\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_info\nJOIN detections d ON ss_info.oid = d.oid\nORDER BY ss_info.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2037,
                "out_toks": 359,
                "id": "chatcmpl-Bx080wfxP2YbVCHDpukR802wgtTGf",
                "created": 1753401544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find all objects within 2 arcseconds (which is 2/3600 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 2.0/3600)\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN nearby_objects no ON d.oid = no.oid\n),\n-- Retrieve solar system info for these objects\nss_info AS (\n    SELECT ss.*\n    FROM ss_ztf ss\n    JOIN nearby_objects no ON ss.oid = no.oid\n)\n-- Final select with required columns, sorted by MPC name and detection date\nSELECT\n    ss_info.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_info\nJOIN detections d ON ss_info.oid = d.oid\nORDER BY ss_info.ssnamenr, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find all objects within 2 arcseconds (which is 2/3600 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 2.0/3600)\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN nearby_objects no ON d.oid = no.oid\n),\n-- Retrieve solar system info for these objects\nss_info AS (\n    SELECT ss.*\n    FROM ss_ztf ss\n    JOIN nearby_objects no ON ss.oid = no.oid\n)\n-- Final select with required columns, sorted by MPC name and detection date\nSELECT\n    ss_info.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error\nFROM ss_info\nJOIN detections d ON ss_info.oid = d.oid\nORDER BY ss_info.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2635,
                "out_toks": 342,
                "id": "chatcmpl-BwxFRXo7YKvSM2PoXMHV11BsfuagR",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "96",
            "experiment_id": "run_6",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 671,
                "out_toks": 10,
                "id": "chatcmpl-BwvLgwbl36SMguFLfijN8Bm4jjzVf",
                "created": 1753383172,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their coordinates (replace placeholder RA/Dec with actual values if known)\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select sources with their coordinates\nsource_coords AS (\n    SELECT * FROM sources\n),\n-- Find detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s\n      ON q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve ss_ztf info and detection details, sorted by MPC name and detection date\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates (replace placeholder RA/Dec with actual values if known)\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select sources with their coordinates\nsource_coords AS (\n    SELECT * FROM sources\n),\n-- Find detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s\n      ON q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve ss_ztf info and detection details, sorted by MPC name and detection date\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 1989,
                "out_toks": 356,
                "id": "chatcmpl-Bx082VgPoScNfDoMYOgAziRgZKqps",
                "created": 1753401546,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select sources with their coordinates\nsource_coords AS (\n    SELECT * FROM sources\n),\n-- Find detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s\n      ON q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve ss_ztf info and detection details, sorted by MPC name and detection date\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select sources with their coordinates\nsource_coords AS (\n    SELECT * FROM sources\n),\n-- Find detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s\n      ON q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve ss_ztf info and detection details, sorted by MPC name and detection date\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2635,
                "out_toks": 345,
                "id": "chatcmpl-BwxFTHDnjlUvGxrK3sbEXwm9MDf0M",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "96",
            "experiment_id": "run_7",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 671,
                "out_toks": 10,
                "id": "chatcmpl-BwvLgrdoQdSUAGBXhfD0shcRbC3ey",
                "created": 1753383172,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their coordinates from the object table\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2009UK56'\n),\n-- Find detections within approximately 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    -- Use q3c_join for angular distance within 2 arcsec\n    WHERE q3c_join(o.ra, o.dec, sources.ra, sources.dec, 0.0005556)\n),\n-- Join with ss_ztf to get solar system info and detection details\nss_info AS (\n    SELECT ss.*, \n           nd.mjd AS detection_date, \n           nd.fid, \n           nd.isdiffpos, \n           nd.ra AS detection_ra, \n           nd.dec AS detection_dec, \n           nd.magpsf AS diff_mag, \n           nd.sigmapsf AS diff_mag_err\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Select all columns from ss_ztf, plus detection info, sorted by MPC name and detection date\nSELECT ss.*, \n       detection_date, \n       fid, \n       isdiffpos, \n       detection_ra, \n       detection_dec, \n       diff_mag, \n       diff_mag_err\nFROM ss_info\nORDER BY ss.ssnamenr, detection_date;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates from the object table\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2009UK56'\n),\n-- Find detections within approximately 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    -- Use q3c_join for angular distance within 2 arcsec\n    WHERE q3c_join(o.ra, o.dec, sources.ra, sources.dec, 0.0005556)\n),\n-- Join with ss_ztf to get solar system info and detection details\nss_info AS (\n    SELECT ss.*, \n           nd.mjd AS detection_date, \n           nd.fid, \n           nd.isdiffpos, \n           nd.ra AS detection_ra, \n           nd.dec AS detection_dec, \n           nd.magpsf AS diff_mag, \n           nd.sigmapsf AS diff_mag_err\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Select all columns from ss_ztf, plus detection info, sorted by MPC name and detection date\nSELECT ss.*, \n       detection_date, \n       fid, \n       isdiffpos, \n       detection_ra, \n       detection_dec, \n       diff_mag, \n       diff_mag_err\nFROM ss_info\nORDER BY ss.ssnamenr, detection_date;\n```"
                },
                "in_toks": 1999,
                "out_toks": 375,
                "id": "chatcmpl-Bx07xJXPzAD0Y96EsyrOBdrK1joOM",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find detections within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Join with ss_ztf to get solar system info\nss_info AS (\n    SELECT ss.*, nd.mjd AS detection_date, nd.fid, nd.isdiffpos, nd.ra AS detection_ra, nd.dec AS detection_dec, nd.magpsf AS diff_mag, nd.sigmapsf AS diff_mag_err\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Final selection, sorted by MPC name and detection date\nSELECT ss.*, detection_date, fid, isdiffpos, detection_ra, detection_dec, diff_mag, diff_mag_err\nFROM ss_info\nORDER BY ss.ssnamenr, detection_date;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find detections within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_detections AS (\n    SELECT d.*\n    FROM detection d\n    JOIN object o ON d.oid = o.oid\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Join with ss_ztf to get solar system info\nss_info AS (\n    SELECT ss.*, nd.mjd AS detection_date, nd.fid, nd.isdiffpos, nd.ra AS detection_ra, nd.dec AS detection_dec, nd.magpsf AS diff_mag, nd.sigmapsf AS diff_mag_err\n    FROM ss_ztf ss\n    JOIN nearby_detections nd ON ss.oid = nd.oid\n)\n-- Final selection, sorted by MPC name and detection date\nSELECT ss.*, detection_date, fid, isdiffpos, detection_ra, detection_dec, diff_mag, diff_mag_err\nFROM ss_info\nORDER BY ss.ssnamenr, detection_date;\n```"
                },
                "in_toks": 2635,
                "out_toks": 314,
                "id": "chatcmpl-BwxFIflIGZS94W33oDQazFtFMjrJn",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "96",
            "experiment_id": "run_8",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 671,
                "out_toks": 10,
                "id": "chatcmpl-BwvLhZNwwv0fPw8AkEYriDWJ6L6Mq",
                "created": 1753383173,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their coordinates (replace placeholder RA/Dec with actual values if known)\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select source coordinates\nsource_coords AS (\n    SELECT mpc_name, ra, dec FROM sources\n),\n-- Find all detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s ON TRUE\n    WHERE q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve all relevant data, including from ss_ztf and detection tables\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates (replace placeholder RA/Dec with actual values if known)\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select source coordinates\nsource_coords AS (\n    SELECT mpc_name, ra, dec FROM sources\n),\n-- Find all detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s ON TRUE\n    WHERE q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve all relevant data, including from ss_ztf and detection tables\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 1999,
                "out_toks": 356,
                "id": "chatcmpl-Bx08EXb83GqTdYeNu98qWHBGUr2i4",
                "created": 1753401558,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select sources with their coordinates\nsource_coords AS (\n    SELECT mpc_name, ra, dec FROM sources\n),\n-- Find all detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s ON TRUE\n    WHERE q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve required data from ss_ztf and detection tables\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM (VALUES\n        ('2003FP134', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n    UNION ALL\n    SELECT '2009UK56', ra, dec\n    FROM (VALUES\n        ('2009UK56', 0.0, 0.0) -- Placeholder, replace with actual RA/Dec if known\n    ) AS t(mpc_name, ra, dec)\n),\n-- Select sources with their coordinates\nsource_coords AS (\n    SELECT mpc_name, ra, dec FROM sources\n),\n-- Find all detections within 2 arcsec (~0.0005556 degrees) of each source\ndetections_near_sources AS (\n    SELECT d.*\n    FROM detection d\n    JOIN source_coords s ON TRUE\n    WHERE q3c_join(d.ra, d.dec, s.ra, s.dec, 0.0005556)\n)\n-- Retrieve required data from ss_ztf and detection tables\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf ss\nJOIN detections_near_sources d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2635,
                "out_toks": 348,
                "id": "chatcmpl-BwxFQcCfCnUviIByiT0AY8zksUDqD",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "96",
            "experiment_id": "run_9",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']"
                },
                "in_toks": 671,
                "out_toks": 10,
                "id": "chatcmpl-BwvLhb7QCoSI13uxkekd8SkSq2PLq",
                "created": 1753383173,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their coordinates from the object table\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2009UK56'\n),\n-- Find all objects within approximately 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n),\n-- Join with object table to get the MPC name for each object\nobject_with_name AS (\n    SELECT o.oid, o.ra, o.dec, s.ssnamenr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n)\n-- Final selection: all columns from ss_ztf, detection info, and object MPC name\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN object_with_name o ON s.oid = o.oid\nJOIN detections d ON o.oid = d.oid\nORDER BY o.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates from the object table\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, o.ra, o.dec\n    FROM object o\n    WHERE o.oid = '2009UK56'\n),\n-- Find all objects within approximately 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n),\n-- Join with object table to get the MPC name for each object\nobject_with_name AS (\n    SELECT o.oid, o.ra, o.dec, s.ssnamenr\n    FROM object o\n    LEFT JOIN ss_ztf s ON o.oid = s.oid\n)\n-- Final selection: all columns from ss_ztf, detection info, and object MPC name\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf s\nJOIN object_with_name o ON s.oid = o.oid\nJOIN detections d ON o.oid = d.oid\nORDER BY o.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2041,
                "out_toks": 384,
                "id": "chatcmpl-Bx082wRtznFk5cUAKNbUACQ6BAiN7",
                "created": 1753401546,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find all objects within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n),\n-- Join with ss_ztf to get MPC names\nss_ztf_with_name AS (\n    SELECT s.*, ss.ssnamenr\n    FROM ss_ztf ss\n    JOIN object o ON ss.oid = o.oid\n)\n-- Final selection and sorting\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf_with_name s\nJOIN detections d ON s.oid = d.oid\nORDER BY ssnamenr, d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    SELECT '2003FP134' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2003FP134'\n    UNION ALL\n    SELECT '2009UK56' AS mpc_name, ra AS ra, dec AS dec\n    FROM object\n    WHERE oid = '2009UK56'\n),\n-- Find all objects within 2 arcseconds (~0.0005556 degrees) of the sources\nnearby_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN sources s ON q3c_join(o.ra, o.dec, s.ra, s.dec, 0.0005556)\n),\n-- Retrieve detections for these nearby objects\ndetections AS (\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM nearby_objects)\n),\n-- Join with ss_ztf to get MPC names\nss_ztf_with_name AS (\n    SELECT s.*, ss.ssnamenr\n    FROM ss_ztf ss\n    JOIN object o ON ss.oid = o.oid\n)\n-- Final selection and sorting\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_ztf_with_name s\nJOIN detections d ON s.oid = d.oid\nORDER BY ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2635,
                "out_toks": 340,
                "id": "chatcmpl-BwxFKwLwukLNm7hib5cxBP7osIbU0",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "67": {
        "0": {
            "req_id": "67",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']",
                    "1": "['object', 'gaia_ztf']"
                },
                "in_toks": 802,
                "out_toks": 20,
                "id": "chatcmpl-BjAd1ODAySkpbKMqPK5ks3U7JKH0I",
                "created": 1750105315,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  AND neargaia <= 1.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  AND neargaia <= 1.5;\n```"
                },
                "in_toks": 2602,
                "out_toks": 82,
                "id": "chatcmpl-BwxFLp0QSutlmyZkoQ62NqxejulrX",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "67",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']",
                    "1": "['object', 'gaia_ztf']"
                },
                "in_toks": 802,
                "out_toks": 20,
                "id": "chatcmpl-BjAd1ODAySkpbKMqPK5ks3U7JKH0I",
                "created": 1750105315,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  AND neargaia <= 1.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n  AND neargaia <= 1.5;\n```"
                },
                "in_toks": 2602,
                "out_toks": 82,
                "id": "chatcmpl-BwxFQUvQhC6O8CffUbv1Xrex3hfRL",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "67",
            "experiment_id": "run_2",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 649,
                "out_toks": 7,
                "id": "chatcmpl-BwvLizCIfY3IpXaWxbaOglZVEInax",
                "created": 1753383174,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND -- Filter for Gaia sources within 1.5 arcseconds of the ZTF objects\nneargaia <= 1.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND -- Filter for Gaia sources within 1.5 arcseconds of the ZTF objects\nneargaia <= 1.5;\n```"
                },
                "in_toks": 2120,
                "out_toks": 134,
                "id": "chatcmpl-BwxFKaPlIoDtcSsndWVKfOdnlGTPy",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "67",
            "experiment_id": "run_3",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 649,
                "out_toks": 7,
                "id": "chatcmpl-BwvLiyErjKrjtS1p3xMqDcr5Btlvd",
                "created": 1753383174,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- List of specific ZTF identifiers\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND neargaia <= 1.5; -- Filter for Gaia sources within 1.5 arcseconds\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- List of specific ZTF identifiers\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND neargaia <= 1.5; -- Filter for Gaia sources within 1.5 arcseconds\n```"
                },
                "in_toks": 2120,
                "out_toks": 138,
                "id": "chatcmpl-BwxFK51b5gLh5q6elxENb2HFuIU6N",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "67",
            "experiment_id": "run_4",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 649,
                "out_toks": 7,
                "id": "chatcmpl-BwvLitCwjOCqtruRAzrvz0ClxEGZh",
                "created": 1753383174,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Find OIDs corresponding to the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\n-- Filter for Gaia sources within 1.5 arcseconds (convert to degrees by dividing by 3600)\nAND neargaia <= 1.5 / 3600;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Find OIDs corresponding to the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\n-- Filter for Gaia sources within 1.5 arcseconds (convert to degrees by dividing by 3600)\nAND neargaia <= 1.5 / 3600;\n```"
                },
                "in_toks": 1533,
                "out_toks": 141,
                "id": "chatcmpl-Bx08FXbEjrRcj6gDKNqTMKxpj9k30",
                "created": 1753401559,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links oid to ZTF identifiers\n        -- If object table does not contain ZTF identifiers, this part needs adjustment based on available schema\n        -- For now, assuming oid matches ZTF identifiers directly\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND (\n    -- Calculate angular distance between the object and Gaia source; check if within 1.5 arcsec\n    q3c_dist(\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n        -- Gaia source coordinates from the gaia_ztf table\n        -- Assuming ra and dec are available in the object table linked by oid\n        -- If not, need to adjust based on actual schema\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid)\n    ) <= 1.5 / 3600 -- Convert arcseconds to degrees\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links oid to ZTF identifiers\n        -- If object table does not contain ZTF identifiers, this part needs adjustment based on available schema\n        -- For now, assuming oid matches ZTF identifiers directly\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND (\n    -- Calculate angular distance between the object and Gaia source; check if within 1.5 arcsec\n    q3c_dist(\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n        -- Gaia source coordinates from the gaia_ztf table\n        -- Assuming ra and dec are available in the object table linked by oid\n        -- If not, need to adjust based on actual schema\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid)\n    ) <= 1.5 / 3600 -- Convert arcseconds to degrees\n);\n```"
                },
                "in_toks": 2120,
                "out_toks": 320,
                "id": "chatcmpl-BwxFNhIqrxGfJQHBn33W27zQEcS7T",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "67",
            "experiment_id": "run_5",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 649,
                "out_toks": 7,
                "id": "chatcmpl-BwvLjgWuVCF2gD6uSbKN3nTFnTSUv",
                "created": 1753383175,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links oid to ZTF identifiers\n        -- If object table does not contain ZTF identifiers, this part needs adjustment based on available schema\n        -- For now, assuming oid can be directly matched to ZTF identifiers\n        -- Otherwise, additional context or tables are needed to map ZTF identifiers to object oids\n        -- Since only gaia_ztf table is provided, assuming oid is directly the ZTF identifier\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND neargaia <= 1.5;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links oid to ZTF identifiers\n        -- If object table does not contain ZTF identifiers, this part needs adjustment based on available schema\n        -- For now, assuming oid can be directly matched to ZTF identifiers\n        -- Otherwise, additional context or tables are needed to map ZTF identifiers to object oids\n        -- Since only gaia_ztf table is provided, assuming oid is directly the ZTF identifier\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND neargaia <= 1.5;\n```"
                },
                "in_toks": 2120,
                "out_toks": 215,
                "id": "chatcmpl-BwxFRUJ4uWc6FqHsXTdD0ZypdfwIF",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "67",
            "experiment_id": "run_6",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 649,
                "out_toks": 7,
                "id": "chatcmpl-BwvLjiz6FdnyrBQZRcs1Rfh3ln6B5",
                "created": 1753383175,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links ZTF IDs to OIDs\n        -- Since only ZTF IDs are provided, and no direct link in schema, this is a placeholder\n        -- Alternatively, if ZTF IDs are stored in object table, include them here\n        -- For demonstration, assuming object table has a column 'ztf_id' (not specified in schema)\n        -- If not, this part needs to be adjusted based on actual schema\n        'ZTF18acxlskz' -- placeholder, replace with actual method to get OID for each ZTF ID\n        -- Add other ZTF IDs as needed\n    )\n)\nAND neargaia <= 1.5\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links ZTF IDs to OIDs\n        -- Since only ZTF IDs are provided, and no direct link in schema, this is a placeholder\n        -- Alternatively, if ZTF IDs are stored in object table, include them here\n        -- For demonstration, assuming object table has a column 'ztf_id' (not specified in schema)\n        -- If not, this part needs to be adjusted based on actual schema\n        'ZTF18acxlskz' -- placeholder, replace with actual method to get OID for each ZTF ID\n        -- Add other ZTF IDs as needed\n    )\n)\nAND neargaia <= 1.5\n```"
                },
                "in_toks": 2120,
                "out_toks": 223,
                "id": "chatcmpl-BwxFNmpV1KvP6rMcfYhDXaaruR8KQ",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "67",
            "experiment_id": "run_7",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 649,
                "out_toks": 7,
                "id": "chatcmpl-BwvLkkH7s9q7Mijkgvzhm6SNcWpec",
                "created": 1753383176,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find oids for the specified ZTF object candid identifiers\n    SELECT oid\n    FROM object\n    WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n)\nAND q3c_join(\n    -- Use q3c_join to check if the Gaia source is within 1.5 arcseconds (converted to degrees)\n    -- 1.5 arcsec = 1.5 / 3600 degrees\n    neargaia,\n    0,\n    -- Subquery to get the RA of the object with the specified candid identifiers\n    (SELECT ra FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    -- Subquery to get the Dec of the object with the specified candid identifiers\n    (SELECT dec FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    1.5 / 3600\n);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find oids for the specified ZTF object candid identifiers\n    SELECT oid\n    FROM object\n    WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n)\nAND q3c_join(\n    -- Use q3c_join to check if the Gaia source is within 1.5 arcseconds (converted to degrees)\n    -- 1.5 arcsec = 1.5 / 3600 degrees\n    neargaia,\n    0,\n    -- Subquery to get the RA of the object with the specified candid identifiers\n    (SELECT ra FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    -- Subquery to get the Dec of the object with the specified candid identifiers\n    (SELECT dec FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    1.5 / 3600\n);\n```"
                },
                "in_toks": 1385,
                "out_toks": 285,
                "id": "chatcmpl-Bx0P7RJDeWwCrjxmSdMO6QOXsyQFv",
                "created": 1753402605,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE candid IN (\n        -- List of specified ZTF identifiers\n        SELECT candid FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n    )\n)\nAND q3c_join(\n    -- Use q3c_join to check if the Gaia source is within 1.5 arcseconds (converted to degrees)\n    -- 1.5 arcsec = 1.5 / 3600 degrees\n    neargaia,\n    0,\n    (SELECT ra FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    (SELECT dec FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    1.5 / 3600\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE candid IN (\n        -- List of specified ZTF identifiers\n        SELECT candid FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n    )\n)\nAND q3c_join(\n    -- Use q3c_join to check if the Gaia source is within 1.5 arcseconds (converted to degrees)\n    -- 1.5 arcsec = 1.5 / 3600 degrees\n    neargaia,\n    0,\n    (SELECT ra FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    (SELECT dec FROM object WHERE candid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') LIMIT 1),\n    1.5 / 3600\n);\n```"
                },
                "in_toks": 2120,
                "out_toks": 269,
                "id": "chatcmpl-BwxFIJAMAD2X7FyQOIhctuXMrfk6k",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "67",
            "experiment_id": "run_8",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 649,
                "out_toks": 7,
                "id": "chatcmpl-BwvLkWQJtAJBuyBwgIVchLHVHCtUE",
                "created": 1753383176,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find oids for the specified ZTF identifiers\n    SELECT o.oid\n    FROM object o\n    WHERE o.candid IN (\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\n-- Join with object table to get RA and Dec for each oid\nAND q3c_join(\n    -- RA of the object\n    (SELECT o2.ra FROM object o2 WHERE o2.oid = gaia_ztf.oid),\n    -- Dec of the object\n    (SELECT o2.dec FROM object o2 WHERE o2.oid = gaia_ztf.oid),\n    -- RA of the Gaia source (same as object RA)\n    (SELECT o2.ra FROM object o2 WHERE o2.oid = gaia_ztf.oid),\n    -- Dec of the Gaia source (same as object Dec)\n    (SELECT o2.dec FROM object o2 WHERE o2.oid = gaia_ztf.oid),\n    1.5 / 3600.0 -- Convert 1.5 arcseconds to degrees\n);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find oids for the specified ZTF identifiers\n    SELECT o.oid\n    FROM object o\n    WHERE o.candid IN (\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\n-- Join with object table to get RA and Dec for each oid\nAND q3c_join(\n    -- RA of the object\n    (SELECT o2.ra FROM object o2 WHERE o2.oid = gaia_ztf.oid),\n    -- Dec of the object\n    (SELECT o2.dec FROM object o2 WHERE o2.oid = gaia_ztf.oid),\n    -- RA of the Gaia source (same as object RA)\n    (SELECT o2.ra FROM object o2 WHERE o2.oid = gaia_ztf.oid),\n    -- Dec of the Gaia source (same as object Dec)\n    (SELECT o2.dec FROM object o2 WHERE o2.oid = gaia_ztf.oid),\n    1.5 / 3600.0 -- Convert 1.5 arcseconds to degrees\n);\n```"
                },
                "in_toks": 1361,
                "out_toks": 290,
                "id": "chatcmpl-Bx083Z7SIvCmy4j84ux6bqjn1kUcV",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE candid IN (\n        -- List of specified ZTF identifiers\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND q3c_join(\n    -- Use q3c_join to check if the Gaia source is within 1.5 arcseconds (~0.0004167 degrees)\n    -- between Gaia source and the ZTF object coordinates\n    (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n    (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n    -- Coordinates of the Gaia source\n    (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n    (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n    1.5 / 3600.0 -- Convert 1.5 arcseconds to degrees\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE candid IN (\n        -- List of specified ZTF identifiers\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND q3c_join(\n    -- Use q3c_join to check if the Gaia source is within 1.5 arcseconds (~0.0004167 degrees)\n    -- between Gaia source and the ZTF object coordinates\n    (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n    (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n    -- Coordinates of the Gaia source\n    (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n    (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n    1.5 / 3600.0 -- Convert 1.5 arcseconds to degrees\n);\n```"
                },
                "in_toks": 2120,
                "out_toks": 261,
                "id": "chatcmpl-BwxFId6l1wuvD7oOAtQV31MaJjri0",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "67",
            "experiment_id": "run_9",
            "pred_tables": [
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['gaia_ztf']"
                },
                "in_toks": 649,
                "out_toks": 7,
                "id": "chatcmpl-BwvLlxugeh0EcZkNaDX1Fg7nPVCXa",
                "created": 1753383177,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Find OIDs corresponding to the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\n-- Filter for Gaia sources within 1.5 arcsec; assuming the object table contains ra and dec columns\nAND (\n    -- Calculate the angular distance between the object and Gaia source\n    -- Using q3c_dist function with object coordinates and Gaia source coordinates\n    q3c_dist(\n        -- Retrieve ra and dec for the object from the object table\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n        -- Retrieve ra and dec for the Gaia source; assuming Gaia source positions are stored in the object table\n        -- Since only gaia_ztf table is provided, and no position columns are in it, we assume the object table has ra/dec\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid)\n    ) <= 1.5\n);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Find OIDs corresponding to the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\n-- Filter for Gaia sources within 1.5 arcsec; assuming the object table contains ra and dec columns\nAND (\n    -- Calculate the angular distance between the object and Gaia source\n    -- Using q3c_dist function with object coordinates and Gaia source coordinates\n    q3c_dist(\n        -- Retrieve ra and dec for the object from the object table\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n        -- Retrieve ra and dec for the Gaia source; assuming Gaia source positions are stored in the object table\n        -- Since only gaia_ztf table is provided, and no position columns are in it, we assume the object table has ra/dec\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid)\n    ) <= 1.5\n);\n```"
                },
                "in_toks": 1583,
                "out_toks": 308,
                "id": "chatcmpl-Bx083rZDcTxm2TsNUAZWVxxX1RqXF",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links oid to ZTF identifiers\n        -- If object table does not contain ZTF identifiers, this part needs adjustment based on available schema\n        -- For now, assuming oid directly corresponds to ZTF identifiers\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND (\n    -- Calculate the angular distance between the object and Gaia source; check if within 1.5 arcsec\n    q3c_dist(\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n        -- Assuming the Gaia source position is stored elsewhere; since only gaia_ztf table is provided,\n        -- and no position columns are in gaia_ztf, this query cannot be completed as is.\n        -- Alternatively, if the object table contains ra and dec, use those.\n        -- For demonstration, assuming ra and dec are in object table linked by oid:\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid)\n    ) <= 1.5\n);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find OIDs for the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN (\n        -- Replace with actual object identifiers if available; assuming object table links oid to ZTF identifiers\n        -- If object table does not contain ZTF identifiers, this part needs adjustment based on available schema\n        -- For now, assuming oid directly corresponds to ZTF identifiers\n        'ZTF18acxlskz',\n        'ZTF22aanppbi',\n        'ZTF22abunrft'\n    )\n)\nAND (\n    -- Calculate the angular distance between the object and Gaia source; check if within 1.5 arcsec\n    q3c_dist(\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid),\n        -- Assuming the Gaia source position is stored elsewhere; since only gaia_ztf table is provided,\n        -- and no position columns are in gaia_ztf, this query cannot be completed as is.\n        -- Alternatively, if the object table contains ra and dec, use those.\n        -- For demonstration, assuming ra and dec are in object table linked by oid:\n        (SELECT ra FROM object WHERE oid = gaia_ztf.oid),\n        (SELECT dec FROM object WHERE oid = gaia_ztf.oid)\n    ) <= 1.5\n);\n```"
                },
                "in_toks": 2120,
                "out_toks": 346,
                "id": "chatcmpl-BwxFMo7b6A0Ine6IGjO1t4GC3QEJN",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "55": {
        "0": {
            "req_id": "55",
            "experiment_id": "run_0",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 761,
                "out_toks": 6,
                "id": "chatcmpl-BjAd14K26qr0SbGI32TUgdE9AHfP4",
                "created": 1750105315,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFLMuUgSMWb7hb57oGxBDUJMGbj",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "55",
            "experiment_id": "run_1",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 761,
                "out_toks": 6,
                "id": "chatcmpl-BjAd14K26qr0SbGI32TUgdE9AHfP4",
                "created": 1750105315,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFSAvRXXyQxcifldvdyx3gkacUW",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "55",
            "experiment_id": "run_2",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 608,
                "out_toks": 3,
                "id": "chatcmpl-BwvLlEtANKS3EiWhrjWXaHHsiaGVS",
                "created": 1753383177,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFNFvpQciahGjw5rfZWR9fnLtx1",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "55",
            "experiment_id": "run_3",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 608,
                "out_toks": 3,
                "id": "chatcmpl-BwvLmyaV1JWtC4ici8Vbw7nUVexkR",
                "created": 1753383178,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFODl3yR1DZ5zZIdLoMTDqGKwNz",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "55",
            "experiment_id": "run_4",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 608,
                "out_toks": 3,
                "id": "chatcmpl-BwvLmbucjzB1NCgpsV4KGTwMZBV4L",
                "created": 1753383178,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFOpO2QtVTINeTNQtFSRtOpGhd9",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "55",
            "experiment_id": "run_5",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 608,
                "out_toks": 3,
                "id": "chatcmpl-BwvLnB791LMUmxPLq1t7CfUCFmHrH",
                "created": 1753383179,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFOw6yBDgaWJnral0LowrcfkXFL",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "55",
            "experiment_id": "run_6",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 608,
                "out_toks": 3,
                "id": "chatcmpl-BwvLncBi69g7f5dnDcjxbQlnDEgGF",
                "created": 1753383179,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFNuPPUDJwxghyxa2y5UCg2XyKh",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "55",
            "experiment_id": "run_7",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 608,
                "out_toks": 3,
                "id": "chatcmpl-BwvLonq1Nyqdplft6gldSN5EBXlV5",
                "created": 1753383180,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFNR8yHSGaBTy8KBezVQfudxnc1",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "55",
            "experiment_id": "run_8",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 608,
                "out_toks": 3,
                "id": "chatcmpl-BwvLoIpSj97oicIMwiVcLIQoMU8Tm",
                "created": 1753383180,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFORQkBIBw3iZ639EdRRfEJuJ0S",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "55",
            "experiment_id": "run_9",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 608,
                "out_toks": 3,
                "id": "chatcmpl-BwvLpuaHfjiWkdReBEmRaB2sl4jY7",
                "created": 1753383181,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2343,
                "out_toks": 21,
                "id": "chatcmpl-BwxFInEr38SZjtsJGA4MkDsNGZiqf",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "47": {
        "0": {
            "req_id": "47",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'probability']",
                    "1": "['object', 'detection', 'probability']"
                },
                "in_toks": 827,
                "out_toks": 22,
                "id": "chatcmpl-BjAd2i3Yoz7dnDrglHmBI59oNl3Qv",
                "created": 1750105316,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY \n    d.oid,\n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY \n    d.oid,\n    d.mjd;\n```"
                },
                "in_toks": 3142,
                "out_toks": 138,
                "id": "chatcmpl-BwxFICMMottWXy9jSaPcbY4aA7H0X",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "47",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'probability']",
                    "1": "['object', 'detection', 'probability']"
                },
                "in_toks": 827,
                "out_toks": 22,
                "id": "chatcmpl-BjAd2i3Yoz7dnDrglHmBI59oNl3Qv",
                "created": 1750105316,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY \n    d.oid,\n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM \n    detection d\nWHERE \n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY \n    d.oid,\n    d.mjd;\n```"
                },
                "in_toks": 3142,
                "out_toks": 138,
                "id": "chatcmpl-BwxFQTE8dH9lyrE1OYDhUgXLnnww6",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "47",
            "experiment_id": "run_2",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"detection\"]"
                },
                "in_toks": 674,
                "out_toks": 4,
                "id": "chatcmpl-BwvLpokfdyCAGyQ4stcx9L58WrarO",
                "created": 1753383181,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2476,
                "out_toks": 171,
                "id": "chatcmpl-BwxFOiyF0qQihHqdWCAWNbYs4INVP",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "47",
            "experiment_id": "run_3",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']"
                },
                "in_toks": 674,
                "out_toks": 4,
                "id": "chatcmpl-BwvLqpxfUU1fEVLvFmg5usqkIbtRa",
                "created": 1753383182,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2476,
                "out_toks": 177,
                "id": "chatcmpl-BwxFS9TCu6MCdIHrhMpW68edVByOu",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "47",
            "experiment_id": "run_4",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']"
                },
                "in_toks": 674,
                "out_toks": 4,
                "id": "chatcmpl-BwvLqBMlLDniEwc2peErbd4NEMLaa",
                "created": 1753383182,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2476,
                "out_toks": 171,
                "id": "chatcmpl-BwxFOD4LQaLfcDn9x7tcELuPkg9jN",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "47",
            "experiment_id": "run_5",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"detection\"]"
                },
                "in_toks": 674,
                "out_toks": 4,
                "id": "chatcmpl-BwvLrzj7ddQZ2Lf1zSsp4rKLqwSvm",
                "created": 1753383183,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2476,
                "out_toks": 177,
                "id": "chatcmpl-BwxFImxAFVK85Ov8Nd5ZcJ4nfhIAO",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "47",
            "experiment_id": "run_6",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"detection\"]"
                },
                "in_toks": 674,
                "out_toks": 4,
                "id": "chatcmpl-BwvLrujOCPZAnMdsBdmu8zaAo06tD",
                "created": 1753383183,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select detections for specified ZTF objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select detections for specified ZTF objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2476,
                "out_toks": 173,
                "id": "chatcmpl-BwxFSOYfeGo5gy8FcDBZXB9yFNM3h",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "47",
            "experiment_id": "run_7",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']"
                },
                "in_toks": 674,
                "out_toks": 4,
                "id": "chatcmpl-BwvLrtvU8XogBegT6obbgvxcz0jX5",
                "created": 1753383183,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    detection d\nWHERE\n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    d.oid,\n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for specified objects with real/bogus score > 0.7\nSELECT\n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    detection d\nWHERE\n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    d.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2476,
                "out_toks": 157,
                "id": "chatcmpl-BwxFP1r6pMazr5VDWK0LEYm2yGjKI",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "47",
            "experiment_id": "run_8",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "[\"detection\"]"
                },
                "in_toks": 674,
                "out_toks": 4,
                "id": "chatcmpl-BwvLsSbtWxW9QxOTD8SIwiSjMKn37",
                "created": 1753383184,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select detections for specified ZTF objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select detections for specified ZTF objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    o.oid,\n    d.mjd;\n```"
                },
                "in_toks": 2476,
                "out_toks": 179,
                "id": "chatcmpl-BwxFP5VfjAF7RBaYpmoX0wb1zvZTX",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "47",
            "experiment_id": "run_9",
            "pred_tables": [
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection']"
                },
                "in_toks": 674,
                "out_toks": 4,
                "id": "chatcmpl-BwvLs8muiXnX2Jnt56UjlD04zTQWb",
                "created": 1753383184,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    ZTF,\n    detection_date;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select detections for specified objects with real/bogus score > 0.7\nSELECT\n    o.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.fid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty,\n    d.drb AS real_bogus_score\nFROM\n    object o\nJOIN\n    detection d ON o.oid = d.oid\nWHERE\n    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    ZTF,\n    detection_date;\n```"
                },
                "in_toks": 2476,
                "out_toks": 169,
                "id": "chatcmpl-BwxFIuKh8po2O6M0wxjlL8RCD2Jms",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "79": {
        "0": {
            "req_id": "79",
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 777,
                "out_toks": 8,
                "id": "chatcmpl-BjAd3B3M1beKYcnNj9YyUUWbaIbGV",
                "created": 1750105317,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```"
                },
                "in_toks": 1991,
                "out_toks": 48,
                "id": "chatcmpl-BwxFNsN9B6Gq8pshOtWcjxypGfP3Z",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "79",
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 777,
                "out_toks": 8,
                "id": "chatcmpl-BjAd3B3M1beKYcnNj9YyUUWbaIbGV",
                "created": 1750105317,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';"
                },
                "in_toks": 1991,
                "out_toks": 44,
                "id": "chatcmpl-BwxFTvqcjs96Tfj8wv78PqOBlMu6Z",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "79",
            "experiment_id": "run_2",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 624,
                "out_toks": 4,
                "id": "chatcmpl-BwvLtQr1Ah6tGi9oYg5GKiGts7osU",
                "created": 1753383185,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```"
                },
                "in_toks": 1991,
                "out_toks": 48,
                "id": "chatcmpl-BwxFI7tHQjG6pplKIxzswj8wZn95M",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "79",
            "experiment_id": "run_3",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 624,
                "out_toks": 4,
                "id": "chatcmpl-BwvLtP6jPytqsLJOQSPCDxZ8LalL8",
                "created": 1753383185,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```"
                },
                "in_toks": 1991,
                "out_toks": 48,
                "id": "chatcmpl-BwxFION73UONN54LZZAdZ88bzKHDw",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "79",
            "experiment_id": "run_4",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 624,
                "out_toks": 4,
                "id": "chatcmpl-BwvLuzKZdbRUK7OPvp4QIusceDb7n",
                "created": 1753383186,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT catid, oid_catalog, dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT catid, oid_catalog, dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';"
                },
                "in_toks": 1991,
                "out_toks": 24,
                "id": "chatcmpl-BwxFN8CtYfOpCraXIW5y83FDP1ulg",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "79",
            "experiment_id": "run_5",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 624,
                "out_toks": 4,
                "id": "chatcmpl-BwvLuLazNkABpNauIYTwUBzqUNWQd",
                "created": 1753383186,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```"
                },
                "in_toks": 1991,
                "out_toks": 48,
                "id": "chatcmpl-BwxFPBnu3TLxwNugbVi90274e8Rob",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "79",
            "experiment_id": "run_6",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 624,
                "out_toks": 4,
                "id": "chatcmpl-BwvLvEbyLZvohKBBBJNIVe75lpMz2",
                "created": 1753383187,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```"
                },
                "in_toks": 1991,
                "out_toks": 48,
                "id": "chatcmpl-BwxFRtThVJrTr9SQvXp9rIlbLtS3i",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "79",
            "experiment_id": "run_7",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 624,
                "out_toks": 4,
                "id": "chatcmpl-BwvLvGBY6Hnb2Ekw9cnJ4E8u8fxuv",
                "created": 1753383187,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```"
                },
                "in_toks": 1991,
                "out_toks": 48,
                "id": "chatcmpl-BwxFIAFql6KOsCTB81qeZdczRatQ8",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "79",
            "experiment_id": "run_8",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 624,
                "out_toks": 4,
                "id": "chatcmpl-BwvLvhsfv2ex3SMop9MCdCbzk2cU9",
                "created": 1753383187,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```"
                },
                "in_toks": 1991,
                "out_toks": 48,
                "id": "chatcmpl-BwxFIgk7ZL7IdnHyQYLPN7MQX7BgE",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "79",
            "experiment_id": "run_9",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']"
                },
                "in_toks": 624,
                "out_toks": 4,
                "id": "chatcmpl-BwvLw99xu4XdMWlV1B5CXuqtKiPTy",
                "created": 1753383188,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';"
                },
                "in_toks": 1991,
                "out_toks": 44,
                "id": "chatcmpl-BwxFRRCN19BpRod303PISLr880xFO",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "94": {
        "0": {
            "req_id": "94",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 772,
                "out_toks": 12,
                "id": "chatcmpl-BjAd32igZKXwd6D1pZySpXBRU8HRu",
                "created": 1750105317,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the reference changed.\n-- Therefore, we should filter objects with 'reference_change = TRUE' and join with 'reference' to get related reference info.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n",
            "sql_response": {
                "responses": {
                    "0": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the reference changed.\n-- Therefore, we should filter objects with 'reference_change = TRUE' and join with 'reference' to get related reference info.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n"
                },
                "in_toks": 1547,
                "out_toks": 125,
                "id": "chatcmpl-Bx07y13ZGCsC8eHunncjxvN3lgiVX",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 57,
                "id": "chatcmpl-BwxFKorVAonaEqNDtRqOz9JBXmzrN",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "94",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 772,
                "out_toks": 12,
                "id": "chatcmpl-BjAd32igZKXwd6D1pZySpXBRU8HRu",
                "created": 1750105317,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the reference changed.\n-- Therefore, we should filter objects where 'reference_change' is TRUE.\n-- Then, join with 'reference' to get all related reference entries for those objects.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;",
            "sql_response": {
                "responses": {
                    "0": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the reference changed.\n-- Therefore, we should filter objects where 'reference_change' is TRUE.\n-- Then, join with 'reference' to get all related reference entries for those objects.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;"
                },
                "in_toks": 1547,
                "out_toks": 132,
                "id": "chatcmpl-Bx07yrVCbFjJJF0Tra8p9OcjCbWUR",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 57,
                "id": "chatcmpl-BwxFLmvVgpBtyay8fhjfaLYk2U0T4",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "94",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 619,
                "out_toks": 6,
                "id": "chatcmpl-BwvLw8Is8OqljJ0JNI8vBhwwvmTPm",
                "created": 1753383188,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects that had a change in the reference image\n-- Since 'reference_change' is a column in 'object' table, filter based on it\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects that had a change in the reference image\n-- Since 'reference_change' is a column in 'object' table, filter based on it\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 1547,
                "out_toks": 80,
                "id": "chatcmpl-Bx086KKCKRNF0REtSXFVqFoOLDRKo",
                "created": 1753401550,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 57,
                "id": "chatcmpl-BwxFQrqZ1MXSMwlo7lE3j3176OMBL",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "94",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 619,
                "out_toks": 6,
                "id": "chatcmpl-BwvLxn9iwUaE9rSXDECT1Sh0yManb",
                "created": 1753383189,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the reference changed.\n-- Therefore, we should filter objects with 'reference_change = TRUE' and join with 'reference' table.\n-- To get all columns from both tables for these objects, we join on 'oid'.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;",
            "sql_response": {
                "responses": {
                    "0": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the reference changed.\n-- Therefore, we should filter objects with 'reference_change = TRUE' and join with 'reference' table.\n-- To get all columns from both tables for these objects, we join on 'oid'.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;"
                },
                "in_toks": 1547,
                "out_toks": 139,
                "id": "chatcmpl-Bx0858mNysFR2E6wl8ZwynaQ1zcUf",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 57,
                "id": "chatcmpl-BwxFSLClclNpPwVUcLPcoNIK86tYd",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "94",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 619,
                "out_toks": 6,
                "id": "chatcmpl-BwvLxpms7CF79wIXzxUX3H0G2DC1I",
                "created": 1753383189,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects that had a change in the reference image\n-- Since 'reference_change' is a column in 'object' table, filter based on it\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects that had a change in the reference image\n-- Since 'reference_change' is a column in 'object' table, filter based on it\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 1547,
                "out_toks": 80,
                "id": "chatcmpl-Bx0NdbQmOLzWU0OmDHQVd5UVhKRQ5",
                "created": 1753402513,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 57,
                "id": "chatcmpl-BwxFI2L6QrLnbWtiPgsGyHIgSYyHe",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "94",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 619,
                "out_toks": 6,
                "id": "chatcmpl-BwvLyqcjJ6V5PmbAqHtYLI3oJzzdK",
                "created": 1753383190,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the object had a reference change.\n-- Therefore, we should filter objects with 'reference_change = TRUE' and join with 'reference' to get related reference info.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n",
            "sql_response": {
                "responses": {
                    "0": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the object had a reference change.\n-- Therefore, we should filter objects with 'reference_change = TRUE' and join with 'reference' to get related reference info.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n"
                },
                "in_toks": 1547,
                "out_toks": 128,
                "id": "chatcmpl-Bx08FjDJ15NXKOPDPqX7QOCQl1x7v",
                "created": 1753401559,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 57,
                "id": "chatcmpl-BwxFRw1Uh3In4apKKdZepeDJb9TrR",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "94",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 619,
                "out_toks": 6,
                "id": "chatcmpl-BwvLyynEQ5QoxROh0YQ53w9n3YuPZ",
                "created": 1753383190,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects that had a change in the reference image\n-- Since 'reference_change' is not a column in the provided 'reference' table schema,\n-- we interpret the user's request as selecting objects with a change in reference, which is indicated by the 'reference_change' column in 'object' table.\n-- We join 'object' with 'reference' on 'oid' and filter for objects where 'reference_change' is TRUE.\n-- Limit the result to at most 50 rows.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects that had a change in the reference image\n-- Since 'reference_change' is not a column in the provided 'reference' table schema,\n-- we interpret the user's request as selecting objects with a change in reference, which is indicated by the 'reference_change' column in 'object' table.\n-- We join 'object' with 'reference' on 'oid' and filter for objects where 'reference_change' is TRUE.\n-- Limit the result to at most 50 rows.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 1545,
                "out_toks": 147,
                "id": "chatcmpl-Bx080ZHVSEplGnFm1nFgl865McvrV",
                "created": 1753401544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a reference change\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a reference change\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 56,
                "id": "chatcmpl-BwxFLT4JZDKjMYSRCwVaH80MxEQ55",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "94",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 619,
                "out_toks": 6,
                "id": "chatcmpl-BwvLyWXp4q7GeJvSYBeR4gVEXGZ6v",
                "created": 1753383190,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects that had a change in the reference image\n-- Since 'reference_change' is a column in 'object' table, filter based on that\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects that had a change in the reference image\n-- Since 'reference_change' is a column in 'object' table, filter based on that\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 1547,
                "out_toks": 80,
                "id": "chatcmpl-Bx087vB8Xv2xmMUhD6qpH2lEn0SVE",
                "created": 1753401551,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 57,
                "id": "chatcmpl-BwxFSVJa1RXjCNRJssCkYVlPXTn87",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "94",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 619,
                "out_toks": 6,
                "id": "chatcmpl-BwvLzYjFg8fRtae3hhLshtsC3bcJc",
                "created": 1753383191,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.oid IN (\n    -- Subquery to find objects with a change in reference\n    SELECT r1.oid\n    FROM reference r1\n    JOIN reference r2 ON r1.oid = r2.oid\n    WHERE r1.rfid <> r2.rfid\n)\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.oid IN (\n    -- Subquery to find objects with a change in reference\n    SELECT r1.oid\n    FROM reference r1\n    JOIN reference r2 ON r1.oid = r2.oid\n    WHERE r1.rfid <> r2.rfid\n)\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 111,
                "id": "chatcmpl-BwxFMl4tNgppc5iCPfLfG1cItIPf8",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "94",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']"
                },
                "in_toks": 619,
                "out_toks": 6,
                "id": "chatcmpl-BwvLzwVR5AYuMrqxz4J53bBclGenH",
                "created": 1753383191,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the object had a reference change.\n-- Therefore, we should filter objects with 'reference_change = TRUE' and join with 'reference' to get related reference info.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;",
            "sql_response": {
                "responses": {
                    "0": "-- The 'reference' table does not have a 'reference_change' column.\n-- Based on the user request, we need to find objects that had a change in their reference.\n-- The 'object' table has a 'reference_change' boolean column indicating if the object had a reference change.\n-- Therefore, we should filter objects with 'reference_change = TRUE' and join with 'reference' to get related reference info.\n-- Limit the result to 50 rows as requested.\n\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE o.reference_change = TRUE\nLIMIT 50;"
                },
                "in_toks": 1547,
                "out_toks": 128,
                "id": "chatcmpl-Bx0864gFru8xGH7KDrktOWxmtY0WQ",
                "created": 1753401550,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2721,
                "out_toks": 57,
                "id": "chatcmpl-BwxFL6QLKyv7e9uVthBNJjWVfOaVi",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "90": {
        "0": {
            "req_id": "90",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version']",
                    "1": "['object', 'probability', 'feature', 'feature_version']"
                },
                "in_toks": 804,
                "out_toks": 28,
                "id": "chatcmpl-BjAd4UfPvqxhUq1kqG3JPkTeFslY6",
                "created": 1750105318,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, using the specific feature version, limiting to 100 objects\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = 'lc_classifier_1.2.1-P' -- specify the exact feature version\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, focusing on the 'lc_classifier' classifier, rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, using the specific feature version, limiting to 100 objects\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = 'lc_classifier_1.2.1-P' -- specify the exact feature version\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, focusing on the 'lc_classifier' classifier, rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 3963,
                "out_toks": 189,
                "id": "chatcmpl-Bx07yNBRVHy1AYKwhNieDP2QE00RO",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days and top 2 rankings for the light curve classifier\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = 'feature_version' -- Replace with actual version if known\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for the selected objects, classifier 'lc_classifier', and rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days and top 2 rankings for the light curve classifier\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = 'feature_version' -- Replace with actual version if known\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for the selected objects, classifier 'lc_classifier', and rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5054,
                "out_toks": 179,
                "id": "chatcmpl-BwxFKeMJFuGzB3RjvINWuvbOySSjI",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "90",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version']",
                    "1": "['object', 'probability', 'feature', 'feature_version']"
                },
                "in_toks": 804,
                "out_toks": 28,
                "id": "chatcmpl-BjAd4UfPvqxhUq1kqG3JPkTeFslY6",
                "created": 1750105318,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, using an optimized nested query\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n        LIMIT 1  -- Limit inside EXISTS to optimize performance\n    )\n    LIMIT 100  -- Limit total number of objects to 100\n)\n-- Retrieve probability data for these objects, filtering for classifier and rankings\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional condition to ensure probabilities are for the relevant class, if needed\n  AND p.class_name = 'top_class_name' -- Replace 'top_class_name' with actual class name if specified\n;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, using an optimized nested query\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n        LIMIT 1  -- Limit inside EXISTS to optimize performance\n    )\n    LIMIT 100  -- Limit total number of objects to 100\n)\n-- Retrieve probability data for these objects, filtering for classifier and rankings\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional condition to ensure probabilities are for the relevant class, if needed\n  AND p.class_name = 'top_class_name' -- Replace 'top_class_name' with actual class name if specified\n;\n```"
                },
                "in_toks": 3902,
                "out_toks": 227,
                "id": "chatcmpl-Bx087SrIbUjd8mr6fjFcGDgQG2A78",
                "created": 1753401551,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days and probabilities for top 2 rankings\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days and probabilities for top 2 rankings\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5054,
                "out_toks": 149,
                "id": "chatcmpl-BwxFSYOXmOwouvKGX48rMzvZspBg8",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "90",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 651,
                "out_toks": 17,
                "id": "chatcmpl-BwvM0jav0kqDajJuiyFIdUA8yVY9w",
                "created": 1753383192,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for selected objects, classifier 'lc_classifier', with ranking 1 or 2,\n-- and include an additional condition on probability to filter for more specificity\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.probability > 0.5; -- Additional condition to filter for higher confidence, can be adjusted as needed\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for selected objects, classifier 'lc_classifier', with ranking 1 or 2,\n-- and include an additional condition on probability to filter for more specificity\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.probability > 0.5; -- Additional condition to filter for higher confidence, can be adjusted as needed\n```"
                },
                "in_toks": 4012,
                "out_toks": 210,
                "id": "chatcmpl-Bx07yaetmj6CeHMqeR9MjXOAESPP5",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for the selected objects, classifier 'lc_classifier', with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for the selected objects, classifier 'lc_classifier', with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5132,
                "out_toks": 165,
                "id": "chatcmpl-BwxFMg2mF2HYitdPsxGpqX0qYANXW",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "90",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 651,
                "out_toks": 17,
                "id": "chatcmpl-BwvM1nfdCQQOtdO71GXP5i6xpVsjU",
                "created": 1753383193,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for these objects, focusing on classifier 'lc_classifier' with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional filtering to ensure relevance and optimize performance\n  AND p.class_name = 'LightCurveClassifier' -- assuming class_name indicates classifier type\n  AND p.probability > 0.5 -- optional: filter for higher confidence if desired\n  AND p.classifier_version = 'lc_classifier_1.2.1-P'; -- ensure version matches\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for these objects, focusing on classifier 'lc_classifier' with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional filtering to ensure relevance and optimize performance\n  AND p.class_name = 'LightCurveClassifier' -- assuming class_name indicates classifier type\n  AND p.probability > 0.5 -- optional: filter for higher confidence if desired\n  AND p.classifier_version = 'lc_classifier_1.2.1-P'; -- ensure version matches\n```"
                },
                "in_toks": 4008,
                "out_toks": 245,
                "id": "chatcmpl-Bx08160du418gY5rW8OWcDbYPSheB",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5132,
                "out_toks": 163,
                "id": "chatcmpl-BwxFPtzh1o3juL5VaA54swvzv4Gdw",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "90",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 651,
                "out_toks": 17,
                "id": "chatcmpl-BwvM2q5mgtMqwKTMKX145TUCnA2Px",
                "created": 1753383194,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, using nested query for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for selected objects, filtering for classifier 'lc_classifier' with ranking 1 or 2,\n-- and adding an additional condition on probability to ensure meaningful classification confidence\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.probability > 0.5; -- Additional condition to filter for higher confidence classifications\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, using nested query for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for selected objects, filtering for classifier 'lc_classifier' with ranking 1 or 2,\n-- and adding an additional condition on probability to ensure meaningful classification confidence\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.probability > 0.5; -- Additional condition to filter for higher confidence classifications\n```"
                },
                "in_toks": 4014,
                "out_toks": 207,
                "id": "chatcmpl-Bx088wMqDjZ2HOgLwj5BoWk5PzUSd",
                "created": 1753401552,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for objects in selected_objects with classifier 'lc_classifier' and ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for objects in selected_objects with classifier 'lc_classifier' and ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5132,
                "out_toks": 166,
                "id": "chatcmpl-BwxFMyiA7Vt5gwxsvImWCganRLnvz",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "90",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 651,
                "out_toks": 17,
                "id": "chatcmpl-BwvM2vuJaa5FsbjKTmCDLH85ntCbZ",
                "created": 1753383194,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for these objects, focusing on the 'lc_classifier' with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional filtering to ensure relevance and optimize performance\n  AND p.class_name = 'LightCurveClassifier' -- assuming class_name indicates classifier type\n  AND p.probability IS NOT NULL\n  AND p.classifier_version = '1.2.1-P'; -- ensure version consistency\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for these objects, focusing on the 'lc_classifier' with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional filtering to ensure relevance and optimize performance\n  AND p.class_name = 'LightCurveClassifier' -- assuming class_name indicates classifier type\n  AND p.probability IS NOT NULL\n  AND p.classifier_version = '1.2.1-P'; -- ensure version consistency\n```"
                },
                "in_toks": 4008,
                "out_toks": 231,
                "id": "chatcmpl-Bx0859fw8HaOaHJjGFM5Z03tqkNZS",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5132,
                "out_toks": 163,
                "id": "chatcmpl-BwxFI6MB82O9ijT9GvqqecFQGBrls",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "90",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 651,
                "out_toks": 17,
                "id": "chatcmpl-BwvM3I7SiqkibNuN8xhm37ykHaMyS",
                "created": 1753383195,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for these objects, classifier 'lc_classifier', with ranking 1 or 2,\n-- and include an additional condition on probability to filter for more relevant classifications\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.probability > 0.5; -- Additional condition to filter for higher confidence classifications\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for these objects, classifier 'lc_classifier', with ranking 1 or 2,\n-- and include an additional condition on probability to filter for more relevant classifications\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  AND p.probability > 0.5; -- Additional condition to filter for higher confidence classifications\n```"
                },
                "in_toks": 4010,
                "out_toks": 206,
                "id": "chatcmpl-Bx081yESG9GvMre8dA24DKIUz16Gs",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5132,
                "out_toks": 164,
                "id": "chatcmpl-BwxFLizSZh3ej8fL2uDzudjppxfjA",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "90",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 651,
                "out_toks": 17,
                "id": "chatcmpl-BwvM41NJKJ6Eu57CDfgBVVglDebVo",
                "created": 1753383196,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, using nested query for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100 -- Limit to 100 objects to reduce query scope and timeout risk\n)\n-- Retrieve probability data for these objects, focusing on the 'lc_classifier' with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional filtering to ensure relevance and reduce data volume\n  AND p.class_name = 'LightCurveClassifier' -- assuming class_name indicates classifier type\n  AND p.probability > 0.5 -- optional: filter for higher confidence probabilities\n  AND p.classifier_version = 'lc_classifier_1.2.1-P'; -- ensure version match\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, using nested query for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100 -- Limit to 100 objects to reduce query scope and timeout risk\n)\n-- Retrieve probability data for these objects, focusing on the 'lc_classifier' with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional filtering to ensure relevance and reduce data volume\n  AND p.class_name = 'LightCurveClassifier' -- assuming class_name indicates classifier type\n  AND p.probability > 0.5 -- optional: filter for higher confidence probabilities\n  AND p.classifier_version = 'lc_classifier_1.2.1-P'; -- ensure version match\n```"
                },
                "in_toks": 4010,
                "out_toks": 258,
                "id": "chatcmpl-Bx081LaKDYrwEE9ISWFaCOSILleDD",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5132,
                "out_toks": 164,
                "id": "chatcmpl-BwxFMEwzEWYvTqMYMkphwGhlkmkLi",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "90",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 651,
                "out_toks": 17,
                "id": "chatcmpl-BwvM4MX0hn7S0vJMaXgkI5Jt1FCLR",
                "created": 1753383196,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100 -- Limit to 100 objects to reduce query scope and timeout risk\n)\n-- Retrieve probability data for objects with top 2 rankings in the lc_classifier, with additional probability conditions\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional conditions to filter for high-confidence classifications\n  AND p.probability > 0.5 -- Filter for probabilities indicating significant classification confidence\n  AND p.class_name = 'some_class_name' -- Replace 'some_class_name' with specific class if needed\n  AND p.classifier_version = 'lc_classifier' -- Ensure classifier version matches if applicable\n;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, optimized with nested subqueries\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100 -- Limit to 100 objects to reduce query scope and timeout risk\n)\n-- Retrieve probability data for objects with top 2 rankings in the lc_classifier, with additional probability conditions\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional conditions to filter for high-confidence classifications\n  AND p.probability > 0.5 -- Filter for probabilities indicating significant classification confidence\n  AND p.class_name = 'some_class_name' -- Replace 'some_class_name' with specific class if needed\n  AND p.classifier_version = 'lc_classifier' -- Ensure classifier version matches if applicable\n;\n```"
                },
                "in_toks": 4002,
                "out_toks": 257,
                "id": "chatcmpl-Bx088rXQ8jm5xn7hVhlkXVJ9XTxGS",
                "created": 1753401552,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for objects with top 2 rankings in the light curve classifier\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for objects with top 2 rankings in the light curve classifier\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5132,
                "out_toks": 160,
                "id": "chatcmpl-BwxFMs77SfE2hjm7kbvBEIdSkHHCd",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "90",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version', 'pipeline']"
                },
                "in_toks": 651,
                "out_toks": 17,
                "id": "chatcmpl-BwvM5oP0IgzaQ366Wbfv1rwbhLGlN",
                "created": 1753383197,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days, using nested query for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for selected objects, focusing on 'lc_classifier' with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional filtering to ensure relevance and optimize query:\n  AND p.class_name = 'LightCurveClassifier' -- assuming class_name indicates classifier type\n  AND p.probability > 0.5 -- optional: filter for higher confidence if desired\n  AND p.classifier_version = 'lc_classifier_1.2.1-P'; -- ensure version match\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days, using nested query for optimization\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve probability data for selected objects, focusing on 'lc_classifier' with ranking 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\n  -- Additional filtering to ensure relevance and optimize query:\n  AND p.class_name = 'LightCurveClassifier' -- assuming class_name indicates classifier type\n  AND p.probability > 0.5 -- optional: filter for higher confidence if desired\n  AND p.classifier_version = 'lc_classifier_1.2.1-P'; -- ensure version match\n```"
                },
                "in_toks": 4012,
                "out_toks": 244,
                "id": "chatcmpl-Bx083eQlOpPJYxnbPyRJVYTQu4xdo",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for the selected objects, classifier 'lc_classifier', with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object OIDs with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for the selected objects, classifier 'lc_classifier', with rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5132,
                "out_toks": 165,
                "id": "chatcmpl-BwxFOXJFGVZwsIdTQTTFJyo5KfUAm",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "51": {
        "0": {
            "req_id": "51",
            "experiment_id": "run_0",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 796,
                "out_toks": 12,
                "id": "chatcmpl-BjAd5jLU4sbL8SuOtdCD4efoLHMFP",
                "created": 1750105319,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2589,
                "out_toks": 112,
                "id": "chatcmpl-BwxFK7QVbpSa7Px3Ew5qSvK8Mj0DC",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "51",
            "experiment_id": "run_1",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 796,
                "out_toks": 12,
                "id": "chatcmpl-BjAd5jLU4sbL8SuOtdCD4efoLHMFP",
                "created": 1750105319,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2589,
                "out_toks": 112,
                "id": "chatcmpl-BwxFImV4dbOCldojWxl02GaqfxmnJ",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "51",
            "experiment_id": "run_2",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 643,
                "out_toks": 6,
                "id": "chatcmpl-BwvM68KKNgOG4gIcfw0YuUEWvKUXX",
                "created": 1753383198,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2589,
                "out_toks": 112,
                "id": "chatcmpl-BwxFNAn6OzFfyImuJnWje6IbdYnli",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "51",
            "experiment_id": "run_3",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 643,
                "out_toks": 6,
                "id": "chatcmpl-BwvM6x74hvCBvr6Y0cQDoJpQBcjqV",
                "created": 1753383198,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2589,
                "out_toks": 112,
                "id": "chatcmpl-BwxFPG1ihtP1fEtSVCHl2ZxbbEB6f",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "51",
            "experiment_id": "run_4",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 643,
                "out_toks": 6,
                "id": "chatcmpl-BwvM77BdfAnCjTyzodKb5LsIDxcsJ",
                "created": 1753383199,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2589,
                "out_toks": 112,
                "id": "chatcmpl-BwxFLFVEimfd2rXhP8RZQiUBJAuIb",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "51",
            "experiment_id": "run_5",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 643,
                "out_toks": 6,
                "id": "chatcmpl-BwvM7ORbqZbDxPCUqEcgBOaB8lIzT",
                "created": 1753383199,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from forced_photometry for object 'ZTF24aaiutyh', sorted by date (mjd)\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from forced_photometry for object 'ZTF24aaiutyh', sorted by date (mjd)\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2589,
                "out_toks": 116,
                "id": "chatcmpl-BwxFKhwyQF2LRo5UPDXrSqgzLWI3h",
                "created": 1753390466,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "51",
            "experiment_id": "run_6",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 643,
                "out_toks": 6,
                "id": "chatcmpl-BwvM84e3RZwrYHZr4yFGZpZnIqG0J",
                "created": 1753383200,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2589,
                "out_toks": 109,
                "id": "chatcmpl-BwxFOCriNemCzoj1GxuFsqle9uA8P",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "51",
            "experiment_id": "run_7",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 643,
                "out_toks": 6,
                "id": "chatcmpl-BwvM8WkzpCJt7Fy63W3sErxiDbnoL",
                "created": 1753383200,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2589,
                "out_toks": 112,
                "id": "chatcmpl-BwxFP7824SCvMlSM8BuyQE4wUDyUu",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "51",
            "experiment_id": "run_8",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 643,
                "out_toks": 6,
                "id": "chatcmpl-BwvM9aEZi6RMaH5wtJmkETzbqqW9Z",
                "created": 1753383201,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    oid,\n    mjd AS date,\n    fid,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT \n    oid,\n    mjd AS date,\n    fid,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;"
                },
                "in_toks": 2589,
                "out_toks": 82,
                "id": "chatcmpl-BwxFJV81Y3UaSq4MOcTPO70WZFha2",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "51",
            "experiment_id": "run_9",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']"
                },
                "in_toks": 643,
                "out_toks": 6,
                "id": "chatcmpl-BwvM9BOyhvAtqH2DuKyf3Nh5uiLRU",
                "created": 1753383201,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the forced_photometry table for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2589,
                "out_toks": 112,
                "id": "chatcmpl-BwxFPZ7zTrbhL5f0hYODF9kUCnbSC",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "59": {
        "0": {
            "req_id": "59",
            "experiment_id": "run_0",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 779,
                "out_toks": 8,
                "id": "chatcmpl-BjAd6kUQmvxIFJ82BfrINK2szhfEC",
                "created": 1750105320,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2597,
                "out_toks": 56,
                "id": "chatcmpl-BwxFQzcsjv765JN7pL4KY7EKp3I4x",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "59",
            "experiment_id": "run_1",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 779,
                "out_toks": 8,
                "id": "chatcmpl-BjAd6kUQmvxIFJ82BfrINK2szhfEC",
                "created": 1750105320,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2597,
                "out_toks": 60,
                "id": "chatcmpl-BwxFMnxezSGFreWpS0UifFTHO8ax2",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "59",
            "experiment_id": "run_2",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 626,
                "out_toks": 4,
                "id": "chatcmpl-BwvMAe0l9U2vbjG5UMGzZOqQfZQ4n",
                "created": 1753383202,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2597,
                "out_toks": 56,
                "id": "chatcmpl-BwxFPRN197V76CVB9K7jdSBuDPx8d",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "59",
            "experiment_id": "run_3",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 626,
                "out_toks": 4,
                "id": "chatcmpl-BwvMACxYa4MGJfJ8F7y7GQfI0e8TT",
                "created": 1753383202,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2597,
                "out_toks": 60,
                "id": "chatcmpl-BwxFMpMNsTwG0IZeAWDzbFNa8XVIw",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "59",
            "experiment_id": "run_4",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 626,
                "out_toks": 4,
                "id": "chatcmpl-BwvMAlSHAmjrgEidtj8K72YZUuQFW",
                "created": 1753383202,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2597,
                "out_toks": 60,
                "id": "chatcmpl-BwxFPtPTRXbO6ETqFzpzzwS5PRwQc",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "59",
            "experiment_id": "run_5",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 626,
                "out_toks": 4,
                "id": "chatcmpl-BwvMB7WnJpkalSoTvrA4fG3v9gaXj",
                "created": 1753383203,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';"
                },
                "in_toks": 2597,
                "out_toks": 52,
                "id": "chatcmpl-BwxFReganvX9cLrwX10GjfY2mi3gN",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "59",
            "experiment_id": "run_6",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 626,
                "out_toks": 4,
                "id": "chatcmpl-BwvMBFg8VFu36SZXaEqM8uhpmioRk",
                "created": 1753383203,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2597,
                "out_toks": 60,
                "id": "chatcmpl-BwxFQ5HzIfQ068NaJNTkNsTKgo37P",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "59",
            "experiment_id": "run_7",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 626,
                "out_toks": 4,
                "id": "chatcmpl-BwvMCnzTrqIfdDBaLvAeJBAmxP89D",
                "created": 1753383204,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2597,
                "out_toks": 60,
                "id": "chatcmpl-BwxFSofSMzqSOvCG0YUN0BDknOs9R",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "59",
            "experiment_id": "run_8",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 626,
                "out_toks": 4,
                "id": "chatcmpl-BwvMCDXobXFp7xWp6s5dL5knnfqvM",
                "created": 1753383204,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2597,
                "out_toks": 60,
                "id": "chatcmpl-BwxUDmPXnvYhl8s8UmbkaWFT00q7p",
                "created": 1753391389,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "59",
            "experiment_id": "run_9",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']"
                },
                "in_toks": 626,
                "out_toks": 4,
                "id": "chatcmpl-BwvMDcX7kuxuUx3ljHylJ570HUwhT",
                "created": 1753383205,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM \n    magstat\nWHERE \n    oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2597,
                "out_toks": 60,
                "id": "chatcmpl-BwxFQUDrF4fbcNIUaoeIXRPWPi74A",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "100": {
        "0": {
            "req_id": "100",
            "experiment_id": "run_0",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']",
                    "1": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 836,
                "out_toks": 28,
                "id": "chatcmpl-BjAd6wmQgoAT8dcJ6haDaq9Q90ypx",
                "created": 1750105320,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    mag AS diffmag,\n    e_mag AS diffmag_err,\n    NULL AS diffmaglim,\n    mag_corr,\n    e_mag_corr AS mag_corr_err\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    mag AS diffmag,\n    e_mag AS diffmag_err,\n    NULL AS diffmaglim,\n    mag_corr,\n    e_mag_corr AS mag_corr_err\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 2563,
                "out_toks": 305,
                "id": "chatcmpl-Bx087pwPcPj2bMKqzozNcLZzSS5LM",
                "created": 1753401551,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    mag AS diffmag,\n    e_mag AS diffmag_err,\n    NULL AS diffmaglim,\n    mag_corr,\n    e_mag_corr AS mag_corr_err\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_err\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    mag AS diffmag,\n    e_mag AS diffmag_err,\n    NULL AS diffmaglim,\n    mag_corr,\n    e_mag_corr AS mag_corr_err\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 3295,
                "out_toks": 307,
                "id": "chatcmpl-BwxFQFZT7hdkSxpy72N5XrqaxP2tI",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "100",
            "experiment_id": "run_1",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']",
                    "1": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 836,
                "out_toks": 28,
                "id": "chatcmpl-BjAd6wmQgoAT8dcJ6haDaq9Q90ypx",
                "created": 1750105320,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve detections for the object\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS magerr,\n  diffmaglim,\n  NULL::DOUBLE PRECISION AS magpsf_corr,\n  NULL::DOUBLE PRECISION AS magerr_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object\nSELECT\n  'non_detection' AS table,\n  NULL::BIGINT AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL::INTEGER AS isdiffpos,\n  NULL::DOUBLE PRECISION AS diffmag,\n  NULL::DOUBLE PRECISION AS magerr,\n  diffmaglim,\n  NULL::DOUBLE PRECISION AS magpsf_corr,\n  NULL::DOUBLE PRECISION AS magerr_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  mag AS diffmag,\n  e_mag AS magerr,\n  NULL::DOUBLE PRECISION AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS magerr_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for the object\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS magerr,\n  diffmaglim,\n  NULL::DOUBLE PRECISION AS magpsf_corr,\n  NULL::DOUBLE PRECISION AS magerr_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object\nSELECT\n  'non_detection' AS table,\n  NULL::BIGINT AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL::INTEGER AS isdiffpos,\n  NULL::DOUBLE PRECISION AS diffmag,\n  NULL::DOUBLE PRECISION AS magerr,\n  diffmaglim,\n  NULL::DOUBLE PRECISION AS magpsf_corr,\n  NULL::DOUBLE PRECISION AS magerr_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  mag AS diffmag,\n  e_mag AS magerr,\n  NULL::DOUBLE PRECISION AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS magerr_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 2571,
                "out_toks": 337,
                "id": "chatcmpl-Bx07xQplJ5fSzfxRlLV2MPvOqsXm8",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detections for the object\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS magerr,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS magerr_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS magerr,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS magerr_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  mag AS diffmag,\n  e_mag AS magerr,\n  NULL AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS magerr_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for the object\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS magerr,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS magerr_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS magerr,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS magerr_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  mag AS diffmag,\n  e_mag AS magerr,\n  NULL AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS magerr_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 3295,
                "out_toks": 306,
                "id": "chatcmpl-BwxFOuZJ00ZZdsU15N9ECgj3VyI7u",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "100",
            "experiment_id": "run_2",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 683,
                "out_toks": 14,
                "id": "chatcmpl-BwvMDRs2V6Wy5t6ZkrxmQwoYtE2GS",
                "created": 1753383205,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    mag AS diffmag,\n    e_mag AS diffmag_uncertainty,\n    NULL AS diffmaglim,\n    mag_corr AS magpsf_corr,\n    e_mag_corr AS mag_corr_uncertainty\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    mag AS diffmag,\n    e_mag AS diffmag_uncertainty,\n    NULL AS diffmaglim,\n    mag_corr AS magpsf_corr,\n    e_mag_corr AS mag_corr_uncertainty\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 2605,
                "out_toks": 322,
                "id": "chatcmpl-Bx082ZSeWpaJIQ6JNjwmGhIwot3I0",
                "created": 1753401546,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_uncertainty,\n    NULL AS diffmaglim,\n    mag_corr AS magpsf_corr,\n    e_mag_corr AS mag_corr_uncertainty\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select detection data for the specified object\nSELECT \n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select non-detection data for the specified object\nSELECT \n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_uncertainty,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS mag_corr_uncertainty\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Select forced photometry data for the specified object\nSELECT \n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_uncertainty,\n    NULL AS diffmaglim,\n    mag_corr AS magpsf_corr,\n    e_mag_corr AS mag_corr_uncertainty\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 3295,
                "out_toks": 323,
                "id": "chatcmpl-BwxFRvzT0DzLetE3BrzjSeMshrNWv",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "100",
            "experiment_id": "run_3",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 683,
                "out_toks": 14,
                "id": "chatcmpl-BwvMEDa9j8IkhtmsmUgNUPhvUKrEG",
                "created": 1753383206,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL::BIGINT AS ztf_id, -- Explicitly cast NULL to match ztf_id data type\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL::BIGINT AS ztf_id, -- Explicitly cast NULL to match ztf_id data type\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry;\n```"
                },
                "in_toks": 2697,
                "out_toks": 396,
                "id": "chatcmpl-Bx088cRxowkqcfwg3ZVUZpwdt6ayb",
                "created": 1753401552,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry;\n```"
                },
                "in_toks": 3295,
                "out_toks": 376,
                "id": "chatcmpl-BwxFQkgzCGhrjWSiFxCIjQVtakSsr",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "100",
            "experiment_id": "run_4",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 683,
                "out_toks": 14,
                "id": "chatcmpl-BwvME2zHT2TOQensnAXkueWg9Dczd",
                "created": 1753383206,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  diffmaglim,\n  mag_corr,\n  e_mag_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  diffmaglim,\n  mag_corr,\n  e_mag_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 2593,
                "out_toks": 322,
                "id": "chatcmpl-Bx07y7I7dDwlSwQduAbgqNHZGRaY2",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  diffmaglim,\n  mag_corr,\n  e_mag_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  diffmaglim,\n  mag_corr,\n  e_mag_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 3295,
                "out_toks": 322,
                "id": "chatcmpl-BwxFRPhJa0w7tbsFJLpQtYbkBLRvO",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "100",
            "experiment_id": "run_5",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 683,
                "out_toks": 14,
                "id": "chatcmpl-BwvMFTowcYp1dGpBwB8A5YKup097P",
                "created": 1753383207,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Combine detections, non-detections, and forced photometry points for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL::BIGINT AS ztf_id, -- Explicitly cast NULL to match ztf_id data type\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL::DOUBLE PRECISION AS mag_limit,\n        mag AS mag_corr,\n        e_mag AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Union all three datasets ensuring consistent data types across columns\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Combine detections, non-detections, and forced photometry points for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL::BIGINT AS ztf_id, -- Explicitly cast NULL to match ztf_id data type\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL::DOUBLE PRECISION AS mag_limit,\n        mag AS mag_corr,\n        e_mag AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Union all three datasets ensuring consistent data types across columns\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```"
                },
                "in_toks": 2617,
                "out_toks": 390,
                "id": "chatcmpl-Bx07x2b8ZAqTLBNiTS0QSXID6jby0",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS candid,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        NULL AS mag_limit,\n        mag AS mag_corr,\n        e_mag AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS candid,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        NULL AS mag_limit,\n        mag AS mag_corr,\n        e_mag AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```"
                },
                "in_toks": 3295,
                "out_toks": 335,
                "id": "chatcmpl-BwxFSiqX67yevTaePpzlwCVjIqj0J",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "100",
            "experiment_id": "run_6",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 683,
                "out_toks": 14,
                "id": "chatcmpl-BwvMGCEcoT07trNaUliQRheryiFA4",
                "created": 1753383208,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL::BIGINT AS ztf_id, -- Explicitly cast NULL to match ztf_id data type\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos, -- Explicitly cast NULL to match isdiffpos data type\n        NULL::DOUBLE PRECISION AS diffmag,\n        NULL::DOUBLE PRECISION AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL::DOUBLE PRECISION AS mag_corr,\n        NULL::DOUBLE PRECISION AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL::DOUBLE PRECISION AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set with matching column data types\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL::BIGINT AS ztf_id, -- Explicitly cast NULL to match ztf_id data type\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos, -- Explicitly cast NULL to match isdiffpos data type\n        NULL::DOUBLE PRECISION AS diffmag,\n        NULL::DOUBLE PRECISION AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL::DOUBLE PRECISION AS mag_corr,\n        NULL::DOUBLE PRECISION AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL::DOUBLE PRECISION AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set with matching column data types\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```"
                },
                "in_toks": 2703,
                "out_toks": 439,
                "id": "chatcmpl-Bx083JEcb7HPmKC6yje5Bu5lcyDrQ",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS candid,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detection data for the specified object\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve non-detection data for the specified object\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS candid,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\n-- Retrieve forced photometry data for the specified object\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs into a single result set\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n```"
                },
                "in_toks": 3295,
                "out_toks": 379,
                "id": "chatcmpl-BwxFIMM4hqq2KYTcPTyHsoD2hPB1z",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "100",
            "experiment_id": "run_7",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 683,
                "out_toks": 14,
                "id": "chatcmpl-BwvMGjx0gd9hykoa1QX2Gf6GVbiHt",
                "created": 1753383208,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve detections for the specified object\nSELECT\n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the specified object\nSELECT\n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the specified object\nSELECT\n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    mag AS diffmag,\n    e_mag AS diffmag_err,\n    NULL AS diffmaglim,\n    mag AS magpsf_corr,\n    e_mag AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for the specified object\nSELECT\n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the specified object\nSELECT\n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the specified object\nSELECT\n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    mag AS diffmag,\n    e_mag AS diffmag_err,\n    NULL AS diffmaglim,\n    mag AS magpsf_corr,\n    e_mag AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 2581,
                "out_toks": 311,
                "id": "chatcmpl-Bx089JbehQoyP3X95joPSOvX7Ddbl",
                "created": 1753401553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detections for the specified object\nSELECT\n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the specified object\nSELECT\n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the specified object\nSELECT\n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    NULL AS diffmaglim,\n    mag AS magpsf_corr,\n    e_mag AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for the specified object\nSELECT\n    'detection' AS table,\n    candid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    isdiffpos,\n    magpsf AS diffmag,\n    sigmapsf AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the specified object\nSELECT\n    'non_detection' AS table,\n    NULL AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    diffmaglim,\n    NULL AS magpsf_corr,\n    NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the specified object\nSELECT\n    'forced_photometry' AS table,\n    pid AS ztf_id,\n    mjd AS epoch_date,\n    fid AS filter_id,\n    NULL AS isdiffpos,\n    NULL AS diffmag,\n    NULL AS diffmag_err,\n    NULL AS diffmaglim,\n    mag AS magpsf_corr,\n    e_mag AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 3295,
                "out_toks": 312,
                "id": "chatcmpl-BwxFPlffoUblE0OBlP72TUPsEVeiZ",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "100",
            "experiment_id": "run_8",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 683,
                "out_toks": 14,
                "id": "chatcmpl-BwvMH0aRpExOxS3hY9OzDTXOBLrlK",
                "created": 1753383209,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "-- Corrected SQL query to match the database schema and ensure consistent data types across UNION ALL components\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid::BIGINT AS ztf_id, -- ensure ztf_id is of type BIGINT for consistency\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL::DOUBLE PRECISION AS mag_corr,\n        NULL::DOUBLE PRECISION AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL::BIGINT AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        NULL::DOUBLE PRECISION AS diffmag,\n        NULL::DOUBLE PRECISION AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL::DOUBLE PRECISION AS mag_corr,\n        NULL::DOUBLE PRECISION AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid::BIGINT AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL::DOUBLE PRECISION AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs from detections, non-detections, and forced photometry\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n",
            "sql_response": {
                "responses": {
                    "0": "-- Corrected SQL query to match the database schema and ensure consistent data types across UNION ALL components\nWITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid::BIGINT AS ztf_id, -- ensure ztf_id is of type BIGINT for consistency\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL::DOUBLE PRECISION AS mag_corr,\n        NULL::DOUBLE PRECISION AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL::BIGINT AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        NULL::DOUBLE PRECISION AS diffmag,\n        NULL::DOUBLE PRECISION AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL::DOUBLE PRECISION AS mag_corr,\n        NULL::DOUBLE PRECISION AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid::BIGINT AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL::INTEGER AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL::DOUBLE PRECISION AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\n-- Combine all epochs from detections, non-detections, and forced photometry\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;\n"
                },
                "in_toks": 2618,
                "out_toks": 428,
                "id": "chatcmpl-Bx08955y8pLp6heTYo5Pm1CR0mAQx",
                "created": 1753401553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "WITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS candid,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;",
            "original_sql_response": {
                "responses": {
                    "0": "WITH detections AS (\n    SELECT \n        'detection' AS table_name,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_err,\n        magpsf_corr AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nnon_detections AS (\n    SELECT \n        'non_detection' AS table_name,\n        NULL AS candid,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_err,\n        diffmaglim AS mag_limit,\n        NULL AS mag_corr,\n        NULL AS mag_corr_err\n    FROM non_detection\n    WHERE oid = 'ZTF24aamtvxb'\n),\nforced_photometry AS (\n    SELECT \n        'forced_photometry' AS table_name,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_err,\n        NULL AS mag_limit,\n        mag_corr AS mag_corr,\n        e_mag_corr AS mag_corr_err\n    FROM forced_photometry\n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;"
                },
                "in_toks": 3295,
                "out_toks": 334,
                "id": "chatcmpl-BwxFLtVP0stwxtq6ZLTEWLvh2VsRz",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "100",
            "experiment_id": "run_9",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 683,
                "out_toks": 14,
                "id": "chatcmpl-BwvMIsdqF8QGeaw8iRChN3Xt1KEaA",
                "created": 1753383210,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL::DOUBLE PRECISION AS magpsf_corr,\n  NULL::DOUBLE PRECISION AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL::BIGINT AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL::INTEGER AS isdiffpos,\n  NULL::DOUBLE PRECISION AS diffmag,\n  NULL::DOUBLE PRECISION AS diffmag_err,\n  diffmaglim,\n  NULL::DOUBLE PRECISION AS magpsf_corr,\n  NULL::DOUBLE PRECISION AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL::INTEGER AS isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  NULL::DOUBLE PRECISION AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL::DOUBLE PRECISION AS magpsf_corr,\n  NULL::DOUBLE PRECISION AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL::BIGINT AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL::INTEGER AS isdiffpos,\n  NULL::DOUBLE PRECISION AS diffmag,\n  NULL::DOUBLE PRECISION AS diffmag_err,\n  diffmaglim,\n  NULL::DOUBLE PRECISION AS magpsf_corr,\n  NULL::DOUBLE PRECISION AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL::INTEGER AS isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  NULL::DOUBLE PRECISION AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 2631,
                "out_toks": 371,
                "id": "chatcmpl-Bx08517GV41u3lt6cGtQNtOSgzKQX",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  NULL AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve detections for the object 'ZTF24aamtvxb'\nSELECT\n  'detection' AS table,\n  candid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  isdiffpos,\n  magpsf AS diffmag,\n  sigmapsf AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve non-detections for the object 'ZTF24aamtvxb'\nSELECT\n  'non_detection' AS table,\n  NULL AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  NULL AS diffmag,\n  NULL AS diffmag_err,\n  diffmaglim,\n  NULL AS magpsf_corr,\n  NULL AS sigmapsf_corr\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\n-- Retrieve forced photometry points for the object 'ZTF24aamtvxb'\nSELECT\n  'forced_photometry' AS table,\n  pid AS ztf_id,\n  mjd AS epoch_date,\n  fid AS filter_id,\n  NULL AS isdiffpos,\n  mag AS diffmag,\n  e_mag AS diffmag_err,\n  NULL AS diffmaglim,\n  mag_corr AS magpsf_corr,\n  e_mag_corr AS sigmapsf_corr\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb';\n```"
                },
                "in_toks": 3295,
                "out_toks": 336,
                "id": "chatcmpl-BwxFQSG3po4LuxpVS5W8jROnJFcuu",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "106": {
        "0": {
            "req_id": "106",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 881,
                "out_toks": 14,
                "id": "chatcmpl-BjAd7xMaViPIISEvpVmyqud7bzvsz",
                "created": 1750105321,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with more than 10 detections, and with probabilities above thresholds for bogus and transient classes\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Retrieve the probability of being bogus from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier_1.0.4') AS prob_stamp_bogus,\n        -- Retrieve the probability of being transient from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier_top') AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND -- ensure probability of bogus > 0.7\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier_1.0.4') > 0.7\n        AND -- ensure probability of transient > 0.9\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier_top') > 0.9\n)\n-- Select top 30 objects ordered by the probability of being bogus in descending order\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.prob_stamp_bogus,\n    o.prob_lc_transient\nFROM\n    selected_objects o\nORDER BY\n    o.prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with more than 10 detections, and with probabilities above thresholds for bogus and transient classes\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Retrieve the probability of being bogus from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier_1.0.4') AS prob_stamp_bogus,\n        -- Retrieve the probability of being transient from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier_top') AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND -- ensure probability of bogus > 0.7\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier_1.0.4') > 0.7\n        AND -- ensure probability of transient > 0.9\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier_top') > 0.9\n)\n-- Select top 30 objects ordered by the probability of being bogus in descending order\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.prob_stamp_bogus,\n    o.prob_lc_transient\nFROM\n    selected_objects o\nORDER BY\n    o.prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 2027,
                "out_toks": 428,
                "id": "chatcmpl-Bx084G2qB4EXz927OB3pIdQi4Rj6H",
                "created": 1753401548,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'bogus'\n              AND p.classifier_name = 'stamp_classifier_1.0.4'\n              AND p.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'Transient'\n              AND p.classifier_name = 'lc_classifier_top'\n              AND p.probability > 0.9\n        )\n),\nbogus_probs AS (\n    SELECT\n        oid,\n        probability AS prob_stamp_bogus\n    FROM probability\n    WHERE\n        class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier_1.0.4'\n        AND probability > 0.7\n),\ntransient_probs AS (\n    SELECT\n        oid,\n        probability AS prob_lc_transient\n    FROM probability\n    WHERE\n        class_name = 'Transient'\n        AND classifier_name = 'lc_classifier_top'\n        AND probability > 0.9\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    bp.prob_stamp_bogus AS \"prob_stamp_bogus\",\n    tp.prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects o\nJOIN\n    bogus_probs bp ON o.oid = bp.oid\nJOIN\n    transient_probs tp ON o.oid = tp.oid\nORDER BY\n    \"prob_stamp_bogus\" DESC\nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'bogus'\n              AND p.classifier_name = 'stamp_classifier_1.0.4'\n              AND p.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n              AND p.class_name = 'Transient'\n              AND p.classifier_name = 'lc_classifier_top'\n              AND p.probability > 0.9\n        )\n),\nbogus_probs AS (\n    SELECT\n        oid,\n        probability AS prob_stamp_bogus\n    FROM probability\n    WHERE\n        class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier_1.0.4'\n        AND probability > 0.7\n),\ntransient_probs AS (\n    SELECT\n        oid,\n        probability AS prob_lc_transient\n    FROM probability\n    WHERE\n        class_name = 'Transient'\n        AND classifier_name = 'lc_classifier_top'\n        AND probability > 0.9\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    bp.prob_stamp_bogus AS \"prob_stamp_bogus\",\n    tp.prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects o\nJOIN\n    bogus_probs bp ON o.oid = bp.oid\nJOIN\n    transient_probs tp ON o.oid = tp.oid\nORDER BY\n    \"prob_stamp_bogus\" DESC\nLIMIT 30;\n```"
                },
                "in_toks": 2647,
                "out_toks": 431,
                "id": "chatcmpl-BwxFLfwnxsmCGyBVhoQgTP8VjG3YC",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "106",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 881,
                "out_toks": 14,
                "id": "chatcmpl-BjAd7xMaViPIISEvpVmyqud7bzvsz",
                "created": 1750105321,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select at most 30 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    -- Retrieve the probability of being bogus from the stamp classifier\n    JOIN\n        (SELECT oid, probability\n         FROM probability\n         WHERE classifier_name = 'stamp_classifier_1.0.4'\n           AND class_name = 'bogus'\n           AND ranking = 1\n           AND probability > 0.7\n        ) p_stamp ON o.oid = p_stamp.oid\n    -- Retrieve the probability of being transient from the top-level LC classifier\n    JOIN\n        (SELECT oid, probability\n         FROM probability\n         WHERE classifier_name = 'lc_classifier'\n           AND class_name = 'Transient'\n           AND ranking = 1\n           AND probability > 0.9\n        ) p_top ON o.oid = p_top.oid\n    WHERE\n        o.ndet > 10\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 30 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    -- Retrieve the probability of being bogus from the stamp classifier\n    JOIN\n        (SELECT oid, probability\n         FROM probability\n         WHERE classifier_name = 'stamp_classifier_1.0.4'\n           AND class_name = 'bogus'\n           AND ranking = 1\n           AND probability > 0.7\n        ) p_stamp ON o.oid = p_stamp.oid\n    -- Retrieve the probability of being transient from the top-level LC classifier\n    JOIN\n        (SELECT oid, probability\n         FROM probability\n         WHERE classifier_name = 'lc_classifier'\n           AND class_name = 'Transient'\n           AND ranking = 1\n           AND probability > 0.9\n        ) p_top ON o.oid = p_top.oid\n    WHERE\n        o.ndet > 10\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 2647,
                "out_toks": 320,
                "id": "chatcmpl-BwxFMMwyyk8TdCM6Jazeacsy1GE7U",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "106",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "classification",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'classification', 'pipeline']"
                },
                "in_toks": 728,
                "out_toks": 13,
                "id": "chatcmpl-BwvMILW6iNbH37kc2a0USCwD9W3TP",
                "created": 1753383210,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Select the probability of being a bogus from the probability table for the stamp classifier\n        p_stamp.probability AS prob_stamp_bogus,\n        -- Select the probability of being a transient from the probability table for the light curve classifier\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    -- Join with probability table for stamp classifier 'stamp_classifier_1.0.4' and class 'bogus'\n    JOIN\n        probability p_stamp ON p_stamp.oid = o.oid\n    -- Join with probability table for light curve classifier 'lc_classifier' and class 'Transient'\n    JOIN\n        probability p_top ON p_top.oid = o.oid\n    WHERE\n        o.ndet > 10\n        -- Conditions for the stamp classifier probability\n        AND p_stamp.class_name = 'bogus'\n        AND p_stamp.classifier_name = 'stamp_classifier'\n        AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n        AND p_stamp.ranking = 1\n        AND p_stamp.probability > 0.7\n        -- Conditions for the light curve classifier probability\n        AND p_top.class_name = 'Transient'\n        AND p_top.classifier_name = 'lc_classifier'\n        AND p_top.classifier_version = 'latest' -- or specify exact version if known\n        AND p_top.ranking = 1\n        AND p_top.probability > 0.9\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Select the probability of being a bogus from the probability table for the stamp classifier\n        p_stamp.probability AS prob_stamp_bogus,\n        -- Select the probability of being a transient from the probability table for the light curve classifier\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    -- Join with probability table for stamp classifier 'stamp_classifier_1.0.4' and class 'bogus'\n    JOIN\n        probability p_stamp ON p_stamp.oid = o.oid\n    -- Join with probability table for light curve classifier 'lc_classifier' and class 'Transient'\n    JOIN\n        probability p_top ON p_top.oid = o.oid\n    WHERE\n        o.ndet > 10\n        -- Conditions for the stamp classifier probability\n        AND p_stamp.class_name = 'bogus'\n        AND p_stamp.classifier_name = 'stamp_classifier'\n        AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n        AND p_stamp.ranking = 1\n        AND p_stamp.probability > 0.7\n        -- Conditions for the light curve classifier probability\n        AND p_top.class_name = 'Transient'\n        AND p_top.classifier_name = 'lc_classifier'\n        AND p_top.classifier_version = 'latest' -- or specify exact version if known\n        AND p_top.ranking = 1\n        AND p_top.probability > 0.9\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 1931,
                "out_toks": 414,
                "id": "chatcmpl-Bx089ZSQ6RmXrgLmecPxVSZDwkhL9",
                "created": 1753401553,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest or default top level\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest or default top level\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 2725,
                "out_toks": 340,
                "id": "chatcmpl-BwxFR9LjVgMdO1cwrGKGrfqgeCMFY",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "106",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "classification",
                "stamp"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'classification', 'stamp', 'light_curve_classifier']"
                },
                "in_toks": 728,
                "out_toks": 18,
                "id": "chatcmpl-BwvMJyaILjoXTeh8KTQ9EI46FF7lV",
                "created": 1753383211,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with more than 10 detections, matching probability criteria for bogus and transient classes\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Retrieve the probability of being bogus from the probability table\n        p_bogus.probability AS prob_stamp_bogus,\n        -- Retrieve the probability of being a transient from the probability table\n        p_transient.probability AS prob_lc_transient\n    FROM\n        object o\n    -- Join with probability table for bogus class\n    LEFT JOIN\n        probability p_bogus ON p_bogus.oid = o.oid\n        AND p_bogus.class_name = 'bogus'\n        AND p_bogus.classifier_name = 'stamp_classifier'\n        AND p_bogus.classifier_version = 'stamp_classifier_1.0.4'\n    -- Join with probability table for transient class\n    LEFT JOIN\n        probability p_transient ON p_transient.oid = o.oid\n        AND p_transient.class_name = 'Transient'\n        AND p_transient.classifier_name = 'lc_classifier_top'\n    WHERE\n        o.ndet > 10\n        AND p_bogus.probability > 0.7\n        AND p_transient.probability > 0.9\n),\nranked_objects AS (\n    SELECT\n        so.*,\n        ROW_NUMBER() OVER (ORDER BY so.prob_stamp_bogus DESC) AS rn\n    FROM\n        selected_objects so\n    WHERE\n        so.prob_stamp_bogus > 0.7\n        AND so.prob_lc_transient > 0.9\n)\n-- Select top 30 objects ordered by the probability of being bogus\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"ZTF identifier\";\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with more than 10 detections, matching probability criteria for bogus and transient classes\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Retrieve the probability of being bogus from the probability table\n        p_bogus.probability AS prob_stamp_bogus,\n        -- Retrieve the probability of being a transient from the probability table\n        p_transient.probability AS prob_lc_transient\n    FROM\n        object o\n    -- Join with probability table for bogus class\n    LEFT JOIN\n        probability p_bogus ON p_bogus.oid = o.oid\n        AND p_bogus.class_name = 'bogus'\n        AND p_bogus.classifier_name = 'stamp_classifier'\n        AND p_bogus.classifier_version = 'stamp_classifier_1.0.4'\n    -- Join with probability table for transient class\n    LEFT JOIN\n        probability p_transient ON p_transient.oid = o.oid\n        AND p_transient.class_name = 'Transient'\n        AND p_transient.classifier_name = 'lc_classifier_top'\n    WHERE\n        o.ndet > 10\n        AND p_bogus.probability > 0.7\n        AND p_transient.probability > 0.9\n),\nranked_objects AS (\n    SELECT\n        so.*,\n        ROW_NUMBER() OVER (ORDER BY so.prob_stamp_bogus DESC) AS rn\n    FROM\n        selected_objects so\n    WHERE\n        so.prob_stamp_bogus > 0.7\n        AND so.prob_lc_transient > 0.9\n)\n-- Select top 30 objects ordered by the probability of being bogus\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"ZTF identifier\";\n```"
                },
                "in_toks": 1899,
                "out_toks": 454,
                "id": "chatcmpl-Bx07xrQY9KtKY8NjUMFbzNBRUqrCl",
                "created": 1753401541,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'bogus'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'Transient'\n                AND p.classifier_name = 'lc_classifier_top'\n                AND p.probability > 0.9\n        )\n),\nranked_objects AS (\n    SELECT\n        so.*,\n        ROW_NUMBER() OVER (ORDER BY so.prob_stamp_bogus DESC) AS rn\n    FROM\n        selected_objects so\n    WHERE\n        so.prob_stamp_bogus > 0.7\n        AND so.prob_lc_transient > 0.9\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"ZTF identifier\";\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'bogus'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'Transient'\n                AND p.classifier_name = 'lc_classifier_top'\n                AND p.probability > 0.9\n        )\n),\nranked_objects AS (\n    SELECT\n        so.*,\n        ROW_NUMBER() OVER (ORDER BY so.prob_stamp_bogus DESC) AS rn\n    FROM\n        selected_objects so\n    WHERE\n        so.prob_stamp_bogus > 0.7\n        AND so.prob_lc_transient > 0.9\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"ZTF identifier\";\n```"
                },
                "in_toks": 2647,
                "out_toks": 366,
                "id": "chatcmpl-BwxFO0PBEIPM2OODbjwY9FnjwgIRk",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "106",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "classification",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'classification', 'pipeline']"
                },
                "in_toks": 728,
                "out_toks": 13,
                "id": "chatcmpl-BwvMJKfFrcLLrfH656DECrJVEqEQx",
                "created": 1753383211,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Retrieve the probability of being a bogus from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n           AND p.ranking = 1\n         LIMIT 1) AS prob_stamp_bogus,\n        -- Retrieve the probability of being a transient from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier'\n           AND p.classifier_version = 'latest'\n           AND p.ranking = 1\n         LIMIT 1) AS prob_lc_transient\n    FROM object o\n    WHERE\n        o.ndet > 10\n        AND -- ensure the object has the required probabilities with conditions\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n           AND p.ranking = 1) > 0.7\n        AND\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier'\n           AND p.classifier_version = 'latest'\n           AND p.ranking = 1) > 0.9\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus,\n    prob_lc_transient\nFROM selected_objects\nWHERE prob_stamp_bogus > 0.7 AND prob_lc_transient > 0.9\nORDER BY prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Retrieve the probability of being a bogus from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n           AND p.ranking = 1\n         LIMIT 1) AS prob_stamp_bogus,\n        -- Retrieve the probability of being a transient from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier'\n           AND p.classifier_version = 'latest'\n           AND p.ranking = 1\n         LIMIT 1) AS prob_lc_transient\n    FROM object o\n    WHERE\n        o.ndet > 10\n        AND -- ensure the object has the required probabilities with conditions\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier'\n           AND p.classifier_version = 'stamp_classifier_1.0.4'\n           AND p.ranking = 1) > 0.7\n        AND\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier'\n           AND p.classifier_version = 'latest'\n           AND p.ranking = 1) > 0.9\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus,\n    prob_lc_transient\nFROM selected_objects\nWHERE prob_stamp_bogus > 0.7 AND prob_lc_transient > 0.9\nORDER BY prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 1933,
                "out_toks": 473,
                "id": "chatcmpl-Bx08ABJjAw9b8m2zzJNXoezYbwZI2",
                "created": 1753401554,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest or default top level classifier\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest or default top level classifier\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 2725,
                "out_toks": 341,
                "id": "chatcmpl-BwxFPoMrlmMh7q5lnPx4ijgTdsUoY",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "106",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "classification"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'classification', 'stamp_classifier', 'light_curve_classifier']"
                },
                "in_toks": 728,
                "out_toks": 19,
                "id": "chatcmpl-BwvMKyWeoaW1eXOZw2ppQ7ux5sNZP",
                "created": 1753383212,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with more than 10 detections, and with specified probabilities for bogus and transient classes\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Retrieve the probability of being bogus from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier_1.0.4') AS prob_stamp_bogus,\n        -- Retrieve the probability of being transient from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier_top') AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND -- Ensure the object has probability > 0.7 of being bogus\n            (SELECT p.probability\n             FROM probability p\n             WHERE p.oid = o.oid\n               AND p.class_name = 'bogus'\n               AND p.classifier_name = 'stamp_classifier_1.0.4') > 0.7\n        AND -- Ensure the object has probability > 0.9 of being transient\n            (SELECT p.probability\n             FROM probability p\n             WHERE p.oid = o.oid\n               AND p.class_name = 'Transient'\n               AND p.classifier_name = 'lc_classifier_top') > 0.9\n),\n-- Filter objects that meet the bogus probability condition\nbogus_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE\n        class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier_1.0.4'\n        AND probability > 0.7\n)\n-- Final selection, joining with the filtered list of bogus objects\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.prob_stamp_bogus,\n    o.prob_lc_transient\nFROM\n    selected_objects o\nWHERE\n    o.oid IN (SELECT oid FROM bogus_objects)\nORDER BY\n    o.oid\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with more than 10 detections, and with specified probabilities for bogus and transient classes\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Retrieve the probability of being bogus from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'bogus'\n           AND p.classifier_name = 'stamp_classifier_1.0.4') AS prob_stamp_bogus,\n        -- Retrieve the probability of being transient from the probability table\n        (SELECT p.probability\n         FROM probability p\n         WHERE p.oid = o.oid\n           AND p.class_name = 'Transient'\n           AND p.classifier_name = 'lc_classifier_top') AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND -- Ensure the object has probability > 0.7 of being bogus\n            (SELECT p.probability\n             FROM probability p\n             WHERE p.oid = o.oid\n               AND p.class_name = 'bogus'\n               AND p.classifier_name = 'stamp_classifier_1.0.4') > 0.7\n        AND -- Ensure the object has probability > 0.9 of being transient\n            (SELECT p.probability\n             FROM probability p\n             WHERE p.oid = o.oid\n               AND p.class_name = 'Transient'\n               AND p.classifier_name = 'lc_classifier_top') > 0.9\n),\n-- Filter objects that meet the bogus probability condition\nbogus_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE\n        class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier_1.0.4'\n        AND probability > 0.7\n)\n-- Final selection, joining with the filtered list of bogus objects\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.prob_stamp_bogus,\n    o.prob_lc_transient\nFROM\n    selected_objects o\nWHERE\n    o.oid IN (SELECT oid FROM bogus_objects)\nORDER BY\n    o.oid\nLIMIT 30;\n```"
                },
                "in_toks": 1867,
                "out_toks": 499,
                "id": "chatcmpl-Bx07ymbnKXs2GjYDqyrklYl7Uhq3H",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier_1.0.4'\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier_top'\n                AND p_top.probability > 0.9\n        )\n),\nbogus_objects AS (\n    SELECT\n        oid\n    FROM\n        probability\n    WHERE\n        class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier_1.0.4'\n        AND probability > 0.7\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.prob_stamp_bogus,\n    o.prob_lc_transient\nFROM\n    selected_objects o\nWHERE\n    o.oid IN (SELECT oid FROM bogus_objects)\nORDER BY\n    o.oid\nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier_1.0.4'\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier_top'\n                AND p_top.probability > 0.9\n        )\n),\nbogus_objects AS (\n    SELECT\n        oid\n    FROM\n        probability\n    WHERE\n        class_name = 'bogus'\n        AND classifier_name = 'stamp_classifier_1.0.4'\n        AND probability > 0.7\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    o.prob_stamp_bogus,\n    o.prob_lc_transient\nFROM\n    selected_objects o\nWHERE\n    o.oid IN (SELECT oid FROM bogus_objects)\nORDER BY\n    o.oid\nLIMIT 30;\n```"
                },
                "in_toks": 2647,
                "out_toks": 349,
                "id": "chatcmpl-BwxFOXh9TH4mHUTYIv1PASx5l57Bo",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "106",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "classification",
                "pipeline"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'classification', 'pipeline']"
                },
                "in_toks": 728,
                "out_toks": 13,
                "id": "chatcmpl-BwvMLFpevw8rA3WEyDF3j0htVhr5W",
                "created": 1753383213,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n),\nprobabilities_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'bogus'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n        AND p.oid IN (SELECT oid FROM object_filtered)\n),\nlc_probabilities AS (\n    SELECT\n        p.oid,\n        p.probability AS prob_lc_transient\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier_top'\n        AND p.class_name = 'Transient'\n        AND p.ranking = 1\n        AND p.probability > 0.9\n        AND p.oid IN (SELECT oid FROM object_filtered)\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    to_char(to_timestamp(o.firstmjd * 86400), 'YYYY-MM-DD') AS \"first detection date\",\n    p.probability AS \"prob_stamp_bogus\",\n    lc.prob_lc_transient\nFROM\n    object_filtered o\nJOIN\n    probabilities_filtered p ON o.oid = p.oid\nJOIN\n    lc_probabilities lc ON o.oid = lc.oid\nORDER BY\n    p.oid\nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH object_filtered AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n),\nprobabilities_filtered AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'bogus'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n        AND p.oid IN (SELECT oid FROM object_filtered)\n),\nlc_probabilities AS (\n    SELECT\n        p.oid,\n        p.probability AS prob_lc_transient\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier_top'\n        AND p.class_name = 'Transient'\n        AND p.ranking = 1\n        AND p.probability > 0.9\n        AND p.oid IN (SELECT oid FROM object_filtered)\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    to_char(to_timestamp(o.firstmjd * 86400), 'YYYY-MM-DD') AS \"first detection date\",\n    p.probability AS \"prob_stamp_bogus\",\n    lc.prob_lc_transient\nFROM\n    object_filtered o\nJOIN\n    probabilities_filtered p ON o.oid = p.oid\nJOIN\n    lc_probabilities lc ON o.oid = lc.oid\nORDER BY\n    p.oid\nLIMIT 30;\n```"
                },
                "in_toks": 2725,
                "out_toks": 357,
                "id": "chatcmpl-BwxFPkZkvyU44QXEsGLuE8HdpwlPf",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "106",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "classification"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'classification', 'stamp_classifier', 'light_curve_classifier']"
                },
                "in_toks": 728,
                "out_toks": 19,
                "id": "chatcmpl-BwvMLcEKx5kvej9CGv4baF7JB7Ypl",
                "created": 1753383213,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with more than 10 detections and matching probability criteria\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Join with probability table to get the probability of being a bogus in the stamp classifier\n        p_stamp.probability AS prob_stamp_bogus,\n        -- Join with probability table to get the probability of being a transient in the light curve classifier\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n        -- Join with probability table for the stamp classifier (bogus class)\n        LEFT JOIN probability p_stamp ON p_stamp.oid = o.oid\n            AND p_stamp.class_name = 'bogus'\n            AND p_stamp.classifier_name = 'stamp_classifier'\n            AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n            AND p_stamp.ranking = 1\n        -- Join with probability table for the light curve classifier (transient class)\n        LEFT JOIN probability p_top ON p_top.oid = o.oid\n            AND p_top.class_name = 'Transient'\n            AND p_top.classifier_name = 'lc_classifier'\n            AND p_top.classifier_version = 'latest'\n            AND p_top.ranking = 1\n    WHERE\n        o.ndet > 10\n        AND -- Ensure the probabilities meet the specified thresholds\n        p_stamp.probability > 0.7\n        AND p_top.probability > 0.9\n)\n-- Select desired columns and order by the bogus probability\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with more than 10 detections and matching probability criteria\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Join with probability table to get the probability of being a bogus in the stamp classifier\n        p_stamp.probability AS prob_stamp_bogus,\n        -- Join with probability table to get the probability of being a transient in the light curve classifier\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n        -- Join with probability table for the stamp classifier (bogus class)\n        LEFT JOIN probability p_stamp ON p_stamp.oid = o.oid\n            AND p_stamp.class_name = 'bogus'\n            AND p_stamp.classifier_name = 'stamp_classifier'\n            AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n            AND p_stamp.ranking = 1\n        -- Join with probability table for the light curve classifier (transient class)\n        LEFT JOIN probability p_top ON p_top.oid = o.oid\n            AND p_top.class_name = 'Transient'\n            AND p_top.classifier_name = 'lc_classifier'\n            AND p_top.classifier_version = 'latest'\n            AND p_top.ranking = 1\n    WHERE\n        o.ndet > 10\n        AND -- Ensure the probabilities meet the specified thresholds\n        p_stamp.probability > 0.7\n        AND p_top.probability > 0.9\n)\n-- Select desired columns and order by the bogus probability\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 1853,
                "out_toks": 410,
                "id": "chatcmpl-Bx07ySH6HxOuE6bPIYBs0QxSrIDK5",
                "created": 1753401542,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest version if not specified\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest version if not specified\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 2647,
                "out_toks": 340,
                "id": "chatcmpl-BwxFS8gteU15VE7z2w7LgSJXiZjyR",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "106",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "classification"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'classification', 'stamp_classifier', 'light_curve_classifier']"
                },
                "in_toks": 728,
                "out_toks": 19,
                "id": "chatcmpl-BwvMM6Qknrb3LxHOAZUmTRahgCmMG",
                "created": 1753383214,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with more than 10 detections, and with probabilities for bogus and transient classes\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Join with probability table for 'bogus' class from 'stamp_classifier_1.0.4'\n        p_stamp.probability AS prob_stamp_bogus,\n        -- Join with probability table for 'Transient' class from 'lc_classifier' (assuming latest version)\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    -- Join with probability table for 'bogus' class\n    LEFT JOIN\n        probability p_stamp\n        ON p_stamp.oid = o.oid\n        AND p_stamp.class_name = 'bogus'\n        AND p_stamp.classifier_name = 'stamp_classifier'\n        AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n        AND p_stamp.ranking = 1\n    -- Join with probability table for 'Transient' class\n    LEFT JOIN\n        probability p_top\n        ON p_top.oid = o.oid\n        AND p_top.class_name = 'Transient'\n        AND p_top.classifier_name = 'lc_classifier'\n        AND p_top.classifier_version = 'latest' -- assuming latest version if not specified\n        AND p_top.ranking = 1\n    WHERE\n        o.ndet > 10\n        AND -- Ensure probabilities meet the specified thresholds\n        p_stamp.probability > 0.7\n        AND p_top.probability > 0.9\n)\n-- Select desired columns and order by 'prob_stamp_bogus' descending\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus,\n    prob_lc_transient\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with more than 10 detections, and with probabilities for bogus and transient classes\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Join with probability table for 'bogus' class from 'stamp_classifier_1.0.4'\n        p_stamp.probability AS prob_stamp_bogus,\n        -- Join with probability table for 'Transient' class from 'lc_classifier' (assuming latest version)\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    -- Join with probability table for 'bogus' class\n    LEFT JOIN\n        probability p_stamp\n        ON p_stamp.oid = o.oid\n        AND p_stamp.class_name = 'bogus'\n        AND p_stamp.classifier_name = 'stamp_classifier'\n        AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n        AND p_stamp.ranking = 1\n    -- Join with probability table for 'Transient' class\n    LEFT JOIN\n        probability p_top\n        ON p_top.oid = o.oid\n        AND p_top.class_name = 'Transient'\n        AND p_top.classifier_name = 'lc_classifier'\n        AND p_top.classifier_version = 'latest' -- assuming latest version if not specified\n        AND p_top.ranking = 1\n    WHERE\n        o.ndet > 10\n        AND -- Ensure probabilities meet the specified thresholds\n        p_stamp.probability > 0.7\n        AND p_top.probability > 0.9\n)\n-- Select desired columns and order by 'prob_stamp_bogus' descending\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus,\n    prob_lc_transient\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 1853,
                "out_toks": 420,
                "id": "chatcmpl-Bx080Vy8jM6wuWCbXgGvE56yb48im",
                "created": 1753401544,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest version if not specified\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.classifier_version = 'latest' -- assuming latest version if not specified\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects\nORDER BY\n    prob_stamp_bogus DESC\nLIMIT 30;\n```"
                },
                "in_toks": 2647,
                "out_toks": 340,
                "id": "chatcmpl-BwxFILn5GQDkFM9ldureljnJL2vr0",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "9": {
            "req_id": "106",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "classification",
                "stamp"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'classification', 'stamp', 'light_curve_classifier']"
                },
                "in_toks": 728,
                "out_toks": 18,
                "id": "chatcmpl-BwvMNhhlBszJqKVKBQCmsqhPsRqje",
                "created": 1753383215,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Select probability of being bogus from the probability table\n        p_stamp.probability AS prob_stamp_bogus,\n        -- Select probability of being transient from the probability table\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n        -- Join with probability table for 'bogus' class and 'stamp_classifier_1.0.4' version\n        LEFT JOIN probability p_stamp ON p_stamp.oid = o.oid\n            AND p_stamp.class_name = 'bogus'\n            AND p_stamp.classifier_name = 'stamp_classifier_1.0.4'\n        -- Join with probability table for 'Transient' class and 'lc_classifier' version\n        LEFT JOIN probability p_top ON p_top.oid = o.oid\n            AND p_top.class_name = 'Transient'\n            AND p_top.classifier_name = 'lc_classifier'\n    WHERE\n        o.ndet > 10\n        AND -- Ensure probability of bogus > 0.7 and ranking = 1\n            p_stamp.probability > 0.7\n            AND p_stamp.ranking = 1\n        AND -- Ensure probability of transient > 0.9 and ranking = 1\n            p_top.probability > 0.9\n            AND p_top.ranking = 1\n),\nranked_objects AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (ORDER BY prob_stamp_bogus DESC, oid) AS rn\n    FROM selected_objects\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"prob_stamp_bogus\" DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        -- Select probability of being bogus from the probability table\n        p_stamp.probability AS prob_stamp_bogus,\n        -- Select probability of being transient from the probability table\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n        -- Join with probability table for 'bogus' class and 'stamp_classifier_1.0.4' version\n        LEFT JOIN probability p_stamp ON p_stamp.oid = o.oid\n            AND p_stamp.class_name = 'bogus'\n            AND p_stamp.classifier_name = 'stamp_classifier_1.0.4'\n        -- Join with probability table for 'Transient' class and 'lc_classifier' version\n        LEFT JOIN probability p_top ON p_top.oid = o.oid\n            AND p_top.class_name = 'Transient'\n            AND p_top.classifier_name = 'lc_classifier'\n    WHERE\n        o.ndet > 10\n        AND -- Ensure probability of bogus > 0.7 and ranking = 1\n            p_stamp.probability > 0.7\n            AND p_stamp.ranking = 1\n        AND -- Ensure probability of transient > 0.9 and ranking = 1\n            p_top.probability > 0.9\n            AND p_top.ranking = 1\n),\nranked_objects AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (ORDER BY prob_stamp_bogus DESC, oid) AS rn\n    FROM selected_objects\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"prob_stamp_bogus\" DESC;\n```"
                },
                "in_toks": 1873,
                "out_toks": 424,
                "id": "chatcmpl-Bx088Udj3Wqpqphq5CLGxgvLsCjJE",
                "created": 1753401552,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier_1.0.4'\n                AND p_stamp.probability > 0.7\n                AND p_stamp.ranking = 1\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.probability > 0.9\n                AND p_top.ranking = 1\n        )\n),\nranked_objects AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (ORDER BY prob_stamp_bogus DESC, oid) AS rn\n    FROM selected_objects\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"prob_stamp_bogus\" DESC;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier_1.0.4'\n                AND p_stamp.probability > 0.7\n                AND p_stamp.ranking = 1\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier'\n                AND p_top.probability > 0.9\n                AND p_top.ranking = 1\n        )\n),\nranked_objects AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (ORDER BY prob_stamp_bogus DESC, oid) AS rn\n    FROM selected_objects\n)\nSELECT\n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    firstmjd AS \"first detection date\",\n    prob_stamp_bogus AS \"prob_stamp_bogus\",\n    prob_lc_transient AS \"prob_lc_transient\"\nFROM\n    ranked_objects\nWHERE\n    rn <= 30\nORDER BY\n    \"prob_stamp_bogus\" DESC;\n```"
                },
                "in_toks": 2647,
                "out_toks": 351,
                "id": "chatcmpl-BwxFT06yqDUZ55NXjJBQVdt0xWj1y",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        }
    },
    "56": {
        "0": {
            "req_id": "56",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'feature']",
                    "1": "['object']"
                },
                "in_toks": 846,
                "out_toks": 13,
                "id": "chatcmpl-BjAd8WDSpD4c5IYYYNXwrxHJsgDMl",
                "created": 1750105322,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    (g_r_mean - g_r_max) AS \"diff between mean g- and r-band difference magnitudes\",\n    (g_r_mean_corr - g_r_max_corr) AS \"diff between mean g- and r-band corrected magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    (g_r_mean - g_r_max) AS \"diff between mean g- and r-band difference magnitudes\",\n    (g_r_mean_corr - g_r_max_corr) AS \"diff between mean g- and r-band corrected magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;"
                },
                "in_toks": 5408,
                "out_toks": 154,
                "id": "chatcmpl-BwxFRcE9EBSNWXXhaBzdHBbewl8EI",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "56",
            "experiment_id": "run_1",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'feature']",
                    "1": "['object']"
                },
                "in_toks": 846,
                "out_toks": 13,
                "id": "chatcmpl-BjAd8WDSpD4c5IYYYNXwrxHJsgDMl",
                "created": 1750105322,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"diff between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"diff between max g- and r-band difference magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"diff between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"diff between max g- and r-band difference magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```"
                },
                "in_toks": 2429,
                "out_toks": 158,
                "id": "chatcmpl-BwxFTCilDj6KlxbfiAHsYLyqfnJZ9",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "56",
            "experiment_id": "run_2",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 693,
                "out_toks": 3,
                "id": "chatcmpl-BwvMNtT7b3l2MlBKJhWMQ9s5cOrYC",
                "created": 1753383215,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_max AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_mean_corr - g_r_max_corr AS \"difference between mean g- and r-band corrected magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_max AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_mean_corr - g_r_max_corr AS \"difference between mean g- and r-band corrected magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;\n```"
                },
                "in_toks": 2429,
                "out_toks": 168,
                "id": "chatcmpl-BwxFIkyno7NX2hXivYUS7XLRPohi5",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "56",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "detection",
                "magstat",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'magstat', 'forced_photometry']"
                },
                "in_toks": 693,
                "out_toks": 17,
                "id": "chatcmpl-BwvMOBgnBDf3q9KgJJn2kmcPaOJjt",
                "created": 1753383216,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.meanra AS \"mean RA\",\n    o.meandec AS \"mean Dec\",\n    o.firstmjd AS \"dates of first detection\",\n    o.lastmjd AS \"dates of last detection\",\n    ( \n        (SELECT magmean FROM magstat WHERE oid = o.oid AND fid = 1) - \n        (SELECT magmean FROM magstat WHERE oid = o.oid AND fid = 2)\n    ) AS \"mean g - r difference\",\n    ( \n        (SELECT magmean_corr FROM magstat WHERE oid = o.oid AND fid = 1) - \n        (SELECT magmean_corr FROM magstat WHERE oid = o.oid AND fid = 2)\n    ) AS \"mean g - r corrected difference\"\nFROM \n    object o\nWHERE \n    o.oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND NOT EXISTS (\n        SELECT 1 FROM magstat m\n        WHERE m.oid = o.oid AND m.corrected = TRUE\n    )\nORDER BY \n    o.firstmjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.meanra AS \"mean RA\",\n    o.meandec AS \"mean Dec\",\n    o.firstmjd AS \"dates of first detection\",\n    o.lastmjd AS \"dates of last detection\",\n    ( \n        (SELECT magmean FROM magstat WHERE oid = o.oid AND fid = 1) - \n        (SELECT magmean FROM magstat WHERE oid = o.oid AND fid = 2)\n    ) AS \"mean g - r difference\",\n    ( \n        (SELECT magmean_corr FROM magstat WHERE oid = o.oid AND fid = 1) - \n        (SELECT magmean_corr FROM magstat WHERE oid = o.oid AND fid = 2)\n    ) AS \"mean g - r corrected difference\"\nFROM \n    object o\nWHERE \n    o.oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND NOT EXISTS (\n        SELECT 1 FROM magstat m\n        WHERE m.oid = o.oid AND m.corrected = TRUE\n    )\nORDER BY \n    o.firstmjd;\n```"
                },
                "in_toks": 4386,
                "out_toks": 262,
                "id": "chatcmpl-BwxFTfyPFrlqYUQ40lK3EWr0kSjiZ",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "56",
            "experiment_id": "run_4",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 693,
                "out_toks": 3,
                "id": "chatcmpl-BwvMOImDQO8kgM3iRGWjMO2tGnNS5",
                "created": 1753383216,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"difference between max g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"difference between max g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```"
                },
                "in_toks": 2429,
                "out_toks": 158,
                "id": "chatcmpl-BwxFUL9t78SrZSjwDL9WWlRbQcSVf",
                "created": 1753390476,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "56",
            "experiment_id": "run_5",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 693,
                "out_toks": 3,
                "id": "chatcmpl-BwvMPvI9DOtcgSpVAoCS1ncLPuy6y",
                "created": 1753383217,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"difference between max g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"difference between max g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```"
                },
                "in_toks": 2429,
                "out_toks": 158,
                "id": "chatcmpl-BwxFTTxwYvhQctnKeyFBPy3W0vTaL",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "56",
            "experiment_id": "run_6",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']"
                },
                "in_toks": 693,
                "out_toks": 3,
                "id": "chatcmpl-BwvMPkGBmsgiX7X8xmhKWHhztD6ba",
                "created": 1753383217,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"difference between max g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"difference between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"difference between max g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```"
                },
                "in_toks": 2429,
                "out_toks": 158,
                "id": "chatcmpl-BwxFWU7iazOa9jx18L94MofjDyoPw",
                "created": 1753390478,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "56",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "detection",
                "magstat",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'magstat', 'feature', 'feature_version']"
                },
                "in_toks": 693,
                "out_toks": 18,
                "id": "chatcmpl-BwvMQowPMroL7o7WntoXlxCDRcqPH",
                "created": 1753383218,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    -- Calculate the difference between mean g-r difference magnitude and mean g-r corrected magnitude\n    (g_r_mean - g_r_mean_corr) AS \"diff between mean g-r and corrected g-r\"\nFROM object\n-- Filter for specific ZTF identifiers and where corrected light curve was not computed\nWHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n  AND corrected = FALSE\n-- Order results by date of first detection\nORDER BY firstmjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    -- Calculate the difference between mean g-r difference magnitude and mean g-r corrected magnitude\n    (g_r_mean - g_r_mean_corr) AS \"diff between mean g-r and corrected g-r\"\nFROM object\n-- Filter for specific ZTF identifiers and where corrected light curve was not computed\nWHERE oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n  AND corrected = FALSE\n-- Order results by date of first detection\nORDER BY firstmjd;\n```"
                },
                "in_toks": 6177,
                "out_toks": 186,
                "id": "chatcmpl-BwxFUJ3ZEXgX3hS1POIefrC8ZZtj1",
                "created": 1753390476,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "56",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "detection",
                "magstat",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'magstat', 'feature']"
                },
                "in_toks": 693,
                "out_toks": 14,
                "id": "chatcmpl-BwvMRBMLYmNAJ30XOnojeWcjZgAnV",
                "created": 1753383219,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    (g_r_mean - g_r_mean_corr) AS \"diff between mean g- and r-band difference magnitudes\",\n    (g_r_max - g_r_max_corr) AS \"diff between max g- and r-band difference magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    (g_r_mean - g_r_mean_corr) AS \"diff between mean g- and r-band difference magnitudes\",\n    (g_r_max - g_r_max_corr) AS \"diff between max g- and r-band difference magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;"
                },
                "in_toks": 6125,
                "out_toks": 154,
                "id": "chatcmpl-BwxFIaw0yOZCsihHpkHnx6X9mHnmf",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "56",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "detection",
                "magstat",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'magstat', 'feature', 'feature_version']"
                },
                "in_toks": 693,
                "out_toks": 18,
                "id": "chatcmpl-BwvMRpxHMXWBK5QnCAhLSWUXOClaL",
                "created": 1753383219,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"Number of detections\",\n    meanra AS \"Mean RA\",\n    meandec AS \"Mean Dec\",\n    firstmjd AS \"First detection date\",\n    lastmjd AS \"Last detection date\",\n    (g_r_mean - g_r_max) AS \"Difference between mean g- and r-band difference magnitudes\",\n    (g_r_mean_corr - g_r_max_corr) AS \"Difference between mean g- and r-band corrected magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"Number of detections\",\n    meanra AS \"Mean RA\",\n    meandec AS \"Mean Dec\",\n    firstmjd AS \"First detection date\",\n    lastmjd AS \"Last detection date\",\n    (g_r_mean - g_r_max) AS \"Difference between mean g- and r-band difference magnitudes\",\n    (g_r_mean_corr - g_r_max_corr) AS \"Difference between mean g- and r-band corrected magnitudes\"\nFROM object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY firstmjd;\n```"
                },
                "in_toks": 6177,
                "out_toks": 170,
                "id": "chatcmpl-BwxFIDFtvQhfaWsEWuGnV8IIIRa6w",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "48": {
        "0": {
            "req_id": "48",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 786,
                "out_toks": 20,
                "id": "chatcmpl-BjAd8Xz412mZZVWRhsqz3fK872lRO",
                "created": 1750105322,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, \n    f.fid, \n    f.version;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, \n    f.fid, \n    f.version;\n```"
                },
                "in_toks": 4851,
                "out_toks": 86,
                "id": "chatcmpl-BwxFIJft7E5D7lQKq6ZKzx6VoCwaF",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "48",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 786,
                "out_toks": 20,
                "id": "chatcmpl-BjAd8Xz412mZZVWRhsqz3fK872lRO",
                "created": 1750105322,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4851,
                "out_toks": 82,
                "id": "chatcmpl-BwxFLrq5PF8TSn8gdpuON37hbwjBI",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "48",
            "experiment_id": "run_2",
            "pred_tables": [
                "feature",
                "object",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'object', 'feature_version']"
                },
                "in_toks": 633,
                "out_toks": 10,
                "id": "chatcmpl-BwvMSMWAjhgXTn3GpjriieBlVQOrc",
                "created": 1753383220,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "SELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;",
            "original_sql_response": {
                "responses": {
                    "0": "SELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;"
                },
                "in_toks": 4851,
                "out_toks": 78,
                "id": "chatcmpl-BwxFIBd4pTgdwZ8v0musJdcPtpGbV",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "48",
            "experiment_id": "run_3",
            "pred_tables": [
                "feature",
                "object",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'object', 'feature_version']"
                },
                "in_toks": 633,
                "out_toks": 10,
                "id": "chatcmpl-BwvMTBCWO0uBzBfYdvZ2KnnAaZqiZ",
                "created": 1753383221,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4851,
                "out_toks": 82,
                "id": "chatcmpl-BwxFNmnWtGWsyEFilmkCfpHfAij2Q",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "48",
            "experiment_id": "run_4",
            "pred_tables": [
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'feature_version']"
                },
                "in_toks": 633,
                "out_toks": 7,
                "id": "chatcmpl-BwvMTqQNjIwfiS0TYyaCGhX1UzAc7",
                "created": 1753383221,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4369,
                "out_toks": 82,
                "id": "chatcmpl-BwxFM08Vx7OIeDwl8cyuULrYB095G",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "48",
            "experiment_id": "run_5",
            "pred_tables": [
                "feature",
                "object",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'object', 'feature_version']"
                },
                "in_toks": 633,
                "out_toks": 10,
                "id": "chatcmpl-BwvMUKBFxqRRwTvxTPmIeAFv4ZyLY",
                "created": 1753383222,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4851,
                "out_toks": 82,
                "id": "chatcmpl-BwxFMi9swA8irtd8sjhhjcZR7KIui",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "48",
            "experiment_id": "run_6",
            "pred_tables": [
                "feature",
                "object",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'object', 'feature_version']"
                },
                "in_toks": 633,
                "out_toks": 10,
                "id": "chatcmpl-BwvMUiN47OosHwxlk5tD5BIYe11Lr",
                "created": 1753383222,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4851,
                "out_toks": 82,
                "id": "chatcmpl-BwxFMMzmMhu8FwgHqpVEX0efVjqJZ",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "48",
            "experiment_id": "run_7",
            "pred_tables": [
                "feature",
                "object",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'object', 'feature_version']"
                },
                "in_toks": 633,
                "out_toks": 10,
                "id": "chatcmpl-BwvMV7rNlwAoiAl9TPwiM66u8Rhvi",
                "created": 1753383223,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4851,
                "out_toks": 82,
                "id": "chatcmpl-BwxFO6eoRW9tsjWpq0v6PvYCTUMjP",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "48",
            "experiment_id": "run_8",
            "pred_tables": [
                "feature",
                "object",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'object', 'feature_version']"
                },
                "in_toks": 633,
                "out_toks": 10,
                "id": "chatcmpl-BwvMWMM7Ee3jl9azyzceIVx4wPJqE",
                "created": 1753383224,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"feature value\",\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"feature value\",\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4851,
                "out_toks": 86,
                "id": "chatcmpl-BwxFPcec3snXb8CrB96qVePiHZZ9E",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "48",
            "experiment_id": "run_9",
            "pred_tables": [
                "feature",
                "object",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['feature', 'object', 'feature_version']"
                },
                "in_toks": 633,
                "out_toks": 10,
                "id": "chatcmpl-BwvMW7wmbywIlFoHs35U50kcO7HWZ",
                "created": 1753383224,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value,\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4851,
                "out_toks": 82,
                "id": "chatcmpl-BwxFLfKnSF8lwJr2IMsscKomfhhVn",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "58": {
        "0": {
            "req_id": "58",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'magstat']",
                    "1": "['object', 'detection', 'magstat']"
                },
                "in_toks": 803,
                "out_toks": 22,
                "id": "chatcmpl-BjAd98rP3UwqR9WEuAzEz8yMpK01w",
                "created": 1750105323,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT o.*\nFROM object o\nWHERE \n    o.oid IN (\n        SELECT oid\n        FROM magstat\n        WHERE \n            fid IN (1, 2) -- g and r bands\n            AND ndet >= 30\n        GROUP BY oid\n        HAVING \n            MAX(CASE WHEN fid = 1 THEN magmax_corr ELSE NULL END) - \n            MAX(CASE WHEN fid = 2 THEN magmin_corr ELSE NULL END) > 3.5\n    )\n  AND \n    o.oid IN (\n        SELECT oid\n        FROM object\n        WHERE \n            lastmjd - firstmjd > 20\n    )\nLIMIT 20;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nWHERE \n    o.oid IN (\n        SELECT oid\n        FROM magstat\n        WHERE \n            fid IN (1, 2) -- g and r bands\n            AND ndet >= 30\n        GROUP BY oid\n        HAVING \n            MAX(CASE WHEN fid = 1 THEN magmax_corr ELSE NULL END) - \n            MAX(CASE WHEN fid = 2 THEN magmin_corr ELSE NULL END) > 3.5\n    )\n  AND \n    o.oid IN (\n        SELECT oid\n        FROM object\n        WHERE \n            lastmjd - firstmjd > 20\n    )\nLIMIT 20;\n```"
                },
                "in_toks": 3651,
                "out_toks": 145,
                "id": "chatcmpl-BwxFRVGktPca4LUce9BzNTr9bLTw1",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "58",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'magstat']",
                    "1": "['object', 'detection', 'magstat']"
                },
                "in_toks": 803,
                "out_toks": 22,
                "id": "chatcmpl-BjAd98rP3UwqR9WEuAzEz8yMpK01w",
                "created": 1750105323,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 20 objects that meet the specified criteria\nSELECT o.*\nFROM object o\n-- Ensure the object has at least 30 detections\nWHERE (\n    SELECT COUNT(*) \n    FROM detection d \n    WHERE d.oid = o.oid\n) >= 30\n-- Calculate the difference between maximum g- and r-band corrected magnitudes\n-- by finding the maximum magmax_corr for g-band (fid=1) and r-band (fid=2)\nAND (\n    -- Subquery to get maximum magmax_corr for g-band\n    (SELECT MAX(m.magmax_corr)\n     FROM magstat m\n     WHERE m.oid = o.oid AND m.fid = 1)\n    -\n    -- Subquery to get maximum magmax_corr for r-band\n    (SELECT MAX(m2.magmax_corr)\n     FROM magstat m2\n     WHERE m2.oid = o.oid AND m2.fid = 2)\n) > 3.5\n-- Check if the time span between last and first detection exceeds 20 days\nAND o.deltajd > 20\n-- Limit the result to at most 20 objects\nLIMIT 20;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 20 objects that meet the specified criteria\nSELECT o.*\nFROM object o\n-- Ensure the object has at least 30 detections\nWHERE (\n    SELECT COUNT(*) \n    FROM detection d \n    WHERE d.oid = o.oid\n) >= 30\n-- Calculate the difference between maximum g- and r-band corrected magnitudes\n-- by finding the maximum magmax_corr for g-band (fid=1) and r-band (fid=2)\nAND (\n    -- Subquery to get maximum magmax_corr for g-band\n    (SELECT MAX(m.magmax_corr)\n     FROM magstat m\n     WHERE m.oid = o.oid AND m.fid = 1)\n    -\n    -- Subquery to get maximum magmax_corr for r-band\n    (SELECT MAX(m2.magmax_corr)\n     FROM magstat m2\n     WHERE m2.oid = o.oid AND m2.fid = 2)\n) > 3.5\n-- Check if the time span between last and first detection exceeds 20 days\nAND o.deltajd > 20\n-- Limit the result to at most 20 objects\nLIMIT 20;\n```"
                },
                "in_toks": 2287,
                "out_toks": 250,
                "id": "chatcmpl-Bx087SqyKQliuvGziNYY2Oyb4DRwz",
                "created": 1753401551,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT o.*\nFROM object o\nWHERE (\n    SELECT COUNT(*) \n    FROM detection d \n    WHERE d.oid = o.oid\n) >= 30\nAND (\n    SELECT magmax_corr - magmin_corr\n    FROM magstat m\n    WHERE m.oid = o.oid AND m.fid IN (1, 2)\n    ORDER BY m.fid\n    LIMIT 2\n) > 3.5\nAND o.lastmjd - o.firstmjd > 20\nLIMIT 20;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nWHERE (\n    SELECT COUNT(*) \n    FROM detection d \n    WHERE d.oid = o.oid\n) >= 30\nAND (\n    SELECT magmax_corr - magmin_corr\n    FROM magstat m\n    WHERE m.oid = o.oid AND m.fid IN (1, 2)\n    ORDER BY m.fid\n    LIMIT 2\n) > 3.5\nAND o.lastmjd - o.firstmjd > 20\nLIMIT 20;\n```"
                },
                "in_toks": 3651,
                "out_toks": 113,
                "id": "chatcmpl-BwxFPRPItrN3qk3p2p00grWdHL7RH",
                "created": 1753390471,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "58",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvMXXGsfrgg8wF4ZEMgEWzmFyD29",
                "created": 1753383225,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```"
                },
                "in_toks": 2934,
                "out_toks": 57,
                "id": "chatcmpl-BwxFRj5rIxvr6ImSvQ1QGlFbJnyzX",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "58",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvMXw1y5NpVUzChMe46YxU1pyG1d",
                "created": 1753383225,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT o.*\nFROM (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND (g_r_max_corr - g_r_mean_corr) > 3.5\n      AND (lastmjd - firstmjd) > 20\n    LIMIT 20\n) sub\nJOIN object o ON o.oid = sub.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND (g_r_max_corr - g_r_mean_corr) > 3.5\n      AND (lastmjd - firstmjd) > 20\n    LIMIT 20\n) sub\nJOIN object o ON o.oid = sub.oid;\n```"
                },
                "in_toks": 2934,
                "out_toks": 79,
                "id": "chatcmpl-BwxFQiDhpsqDYgSsFQN5n0TbtvisQ",
                "created": 1753390472,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "58",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvMYkgWmo8fCzPWyPc5F8UPtTfeT",
                "created": 1753383226,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```"
                },
                "in_toks": 2934,
                "out_toks": 57,
                "id": "chatcmpl-BwxFR2TjPpe7l8k9twl6S5ksR0icW",
                "created": 1753390473,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "58",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvMddDWfAzay6Z92Rk4AMZIVFbzP",
                "created": 1753383231,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT o.*\nFROM (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND (g_r_max_corr - g_r_mean_corr) > 3.5\n      AND (lastmjd - firstmjd) > 20\n    LIMIT 20\n) sub\nJOIN object o ON o.oid = sub.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND (g_r_max_corr - g_r_mean_corr) > 3.5\n      AND (lastmjd - firstmjd) > 20\n    LIMIT 20\n) sub\nJOIN object o ON o.oid = sub.oid;\n```"
                },
                "in_toks": 2934,
                "out_toks": 79,
                "id": "chatcmpl-BwxFSSmeOJV9lH5uzQ9j6DKRH7Oae",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "58",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvMdh9WMpYYIveru0bUGBXWsxnJQ",
                "created": 1753383231,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```"
                },
                "in_toks": 2934,
                "out_toks": 57,
                "id": "chatcmpl-BwxFScyhLMQy5BqYPDOJmLMWq2GgI",
                "created": 1753390474,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "58",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvMeZQhEoSRnNcBYMxsl8x5PSbGn",
                "created": 1753383232,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select up to 20 objects from the 'object' table that meet the specified conditions\nSELECT *\nFROM object\nWHERE ndet >= 30\n  AND (g_r_max_corr - g_r_mean_corr) > 3.5\n  AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 20 objects from the 'object' table that meet the specified conditions\nSELECT *\nFROM object\nWHERE ndet >= 30\n  AND (g_r_max_corr - g_r_mean_corr) > 3.5\n  AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```"
                },
                "in_toks": 2934,
                "out_toks": 73,
                "id": "chatcmpl-BwxFJRZDpdUakfzzBaXZuyykB7ApD",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "58",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvMeOPFTfI7X0phdUAaiK2yJOE7C",
                "created": 1753383232,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT o.*\nFROM (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND (g_r_max_corr - g_r_mean_corr) > 3.5\n      AND (lastmjd - firstmjd) > 20\n    LIMIT 20\n) sub\nJOIN object o ON o.oid = sub.oid;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM (\n    SELECT oid\n    FROM object\n    WHERE ndet >= 30\n      AND (g_r_max_corr - g_r_mean_corr) > 3.5\n      AND (lastmjd - firstmjd) > 20\n    LIMIT 20\n) sub\nJOIN object o ON o.oid = sub.oid;\n```"
                },
                "in_toks": 2934,
                "out_toks": 79,
                "id": "chatcmpl-BwxFIRvbEv2RknZt8sPphZSYb9u7l",
                "created": 1753390464,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "58",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection']"
                },
                "in_toks": 650,
                "out_toks": 7,
                "id": "chatcmpl-BwvMfSJuPd3464NZRhi2bmoxUWZcy",
                "created": 1753383233,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE \n    ndet >= 30\n    AND (g_r_max_corr - g_r_mean_corr) > 3.5\n    AND (lastmjd - firstmjd) > 20\nLIMIT 20;\n```"
                },
                "in_toks": 2934,
                "out_toks": 57,
                "id": "chatcmpl-BwxFU5XRIHSvicNivvM3Hh5GB7QRw",
                "created": 1753390476,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "78": {
        "0": {
            "req_id": "78",
            "experiment_id": "run_0",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']",
                    "1": "['taxonomy']"
                },
                "in_toks": 766,
                "out_toks": 6,
                "id": "chatcmpl-BjAdAS1OB6XElQx9vaOJW7zVsfsXV",
                "created": 1750105324,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```"
                },
                "in_toks": 1912,
                "out_toks": 39,
                "id": "chatcmpl-BwxFJRrCXRgUYAnJmWD7vNPgsHYJZ",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "1": {
            "req_id": "78",
            "experiment_id": "run_1",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']",
                    "1": "['taxonomy']"
                },
                "in_toks": 766,
                "out_toks": 6,
                "id": "chatcmpl-BjAdAS1OB6XElQx9vaOJW7zVsfsXV",
                "created": 1750105324,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```"
                },
                "in_toks": 1912,
                "out_toks": 73,
                "id": "chatcmpl-BwxFJZf3exN1fajx1QUdtYbc7lY4a",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "2": {
            "req_id": "78",
            "experiment_id": "run_2",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 613,
                "out_toks": 3,
                "id": "chatcmpl-BwvMfciIUbOL4V4lg1MXGowxVNmH6",
                "created": 1753383233,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```"
                },
                "in_toks": 1912,
                "out_toks": 39,
                "id": "chatcmpl-BwxFJywwny5aZbwxs5BfLZgXmF27g",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "3": {
            "req_id": "78",
            "experiment_id": "run_3",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 613,
                "out_toks": 3,
                "id": "chatcmpl-BwvMgWUJEPKhpi4edboYhA3esaPvT",
                "created": 1753383234,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```"
                },
                "in_toks": 1912,
                "out_toks": 39,
                "id": "chatcmpl-BwxFJmsuHqaq6fBTIkdgJsXcGgqrK",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "4": {
            "req_id": "78",
            "experiment_id": "run_4",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 613,
                "out_toks": 3,
                "id": "chatcmpl-BwvMgjuaYmT9IAAwkmIa5ZENxcmAb",
                "created": 1753383234,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```"
                },
                "in_toks": 1912,
                "out_toks": 73,
                "id": "chatcmpl-BwxFJUmEwhUtfHH7czFZQB015yG0H",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "5": {
            "req_id": "78",
            "experiment_id": "run_5",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 613,
                "out_toks": 3,
                "id": "chatcmpl-BwvMhXf2NBpXjpmEY7DdiP383gi4d",
                "created": 1753383235,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```"
                },
                "in_toks": 1912,
                "out_toks": 73,
                "id": "chatcmpl-BwxFLxY6O4WQwwlNOPYdZ74dY79y2",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "6": {
            "req_id": "78",
            "experiment_id": "run_6",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 613,
                "out_toks": 3,
                "id": "chatcmpl-BwvMivlCD0MQ8qzIGTpo4A8Gc26uv",
                "created": 1753383236,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```"
                },
                "in_toks": 1912,
                "out_toks": 73,
                "id": "chatcmpl-BwxFLI9HF630TC9T4zJyZ34Bl4x54",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "7": {
            "req_id": "78",
            "experiment_id": "run_7",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 613,
                "out_toks": 3,
                "id": "chatcmpl-BwvMiDNi3ehkUl0IIiUeWWh2sKP5o",
                "created": 1753383236,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```"
                },
                "in_toks": 1912,
                "out_toks": 39,
                "id": "chatcmpl-BwxFMfJz6VcVV4ZjbTYJjPs6xtt29",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "8": {
            "req_id": "78",
            "experiment_id": "run_8",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 613,
                "out_toks": 3,
                "id": "chatcmpl-BwvMinmfK2fs6yRLBBQsqaclXEpoF",
                "created": 1753383236,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name IN (\n        'lc_classifier', \n        'lc_classifier_top', \n        'lc_classifier_transient', \n        'lc_classifier_stochastic', \n        'lc_classifier_periodic'\n    );\n```"
                },
                "in_toks": 1912,
                "out_toks": 73,
                "id": "chatcmpl-BwxFMLOZKNeMeTqFDbbkeNkalIFMs",
                "created": 1753390468,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "78",
            "experiment_id": "run_9",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']"
                },
                "in_toks": 613,
                "out_toks": 3,
                "id": "chatcmpl-BwvMjfDfrwL520hHbwG6Sgatry7QA",
                "created": 1753383237,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```"
                },
                "in_toks": 1912,
                "out_toks": 39,
                "id": "chatcmpl-BwxFLjX75l8NFiq2jBwbxUIvoYrdR",
                "created": 1753390467,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    },
    "39": {
        "0": {
            "req_id": "39",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'forced_photometry']",
                    "1": "['object', 'probability', 'detection', 'reference']"
                },
                "in_toks": 859,
                "out_toks": 31,
                "id": "chatcmpl-BjAdAkNYjP6LpbAiDLjnBDhB9Nq21",
                "created": 1750105324,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r\n    FROM\n        detection d\n    WHERE\n        -- Ensure the object has the highest probability class 'CV/Nova' in 'lc_classifier_stochastic' with ranking=1\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = d.oid\n              AND p.classifier_name = 'lc_classifier_stochastic'\n              AND p.ranking = 1\n              AND p.class_name = 'CV/Nova'\n        )\n        -- Filter for objects with at most 50 detections from first to last detection\n        AND (\n            SELECT COUNT(*) FROM detection d2\n            WHERE d2.oid = d.oid\n              AND d2.mjd BETWEEN\n                (SELECT firstmjd FROM object WHERE oid = d.oid)\n                AND (SELECT lastmjd FROM object WHERE oid = d.oid)\n        ) <= 50\n),\n-- Calculate maximum rise (max mag - min mag) for each object\nmax_rise AS (\n    SELECT\n        object_id,\n        MAX(magnitude) - MIN(magnitude) AS max_rise\n    FROM\n        filtered_objects\n    GROUP BY\n        object_id\n)\n-- Final selection: first 1000 rows ordered by object ID\nSELECT\n    fo.object_id,\n    fo.candidate_id,\n    fo.f_id,\n    fo.ra,\n    fo.dec,\n    fo.magnitude,\n    fo.mag_error,\n    fo.mag_corr_r,\n    fo.mag_corr_error_r,\n    mr.max_rise\nFROM\n    filtered_objects fo\nJOIN\n    max_rise mr ON fo.object_id = mr.object_id\nORDER BY\n    fo.object_id\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r\n    FROM\n        detection d\n    WHERE\n        -- Ensure the object has the highest probability class 'CV/Nova' in 'lc_classifier_stochastic' with ranking=1\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = d.oid\n              AND p.classifier_name = 'lc_classifier_stochastic'\n              AND p.ranking = 1\n              AND p.class_name = 'CV/Nova'\n        )\n        -- Filter for objects with at most 50 detections from first to last detection\n        AND (\n            SELECT COUNT(*) FROM detection d2\n            WHERE d2.oid = d.oid\n              AND d2.mjd BETWEEN\n                (SELECT firstmjd FROM object WHERE oid = d.oid)\n                AND (SELECT lastmjd FROM object WHERE oid = d.oid)\n        ) <= 50\n),\n-- Calculate maximum rise (max mag - min mag) for each object\nmax_rise AS (\n    SELECT\n        object_id,\n        MAX(magnitude) - MIN(magnitude) AS max_rise\n    FROM\n        filtered_objects\n    GROUP BY\n        object_id\n)\n-- Final selection: first 1000 rows ordered by object ID\nSELECT\n    fo.object_id,\n    fo.candidate_id,\n    fo.f_id,\n    fo.ra,\n    fo.dec,\n    fo.magnitude,\n    fo.mag_error,\n    fo.mag_corr_r,\n    fo.mag_corr_error_r,\n    mr.max_rise\nFROM\n    filtered_objects fo\nJOIN\n    max_rise mr ON fo.object_id = mr.object_id\nORDER BY\n    fo.object_id\nLIMIT 1000;\n```"
                },
                "in_toks": 3290,
                "out_toks": 454,
                "id": "chatcmpl-Bx081kd3ySgE5m2XUzvbeU7TaUopQ",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r\n    FROM\n        detection d\n    WHERE\n        -- Filter for objects with the highest probability class 'CV/Nova' in 'stochastic' classifier\n        (SELECT p.class_name\n         FROM probability p\n         WHERE p.oid = d.oid\n           AND p.classifier_name = 'lc_classifier_stochastic'\n           AND p.ranking = 1\n         LIMIT 1) = 'CV/Nova'\n        -- Filter for objects with at most 50 detections from first to last detection\n        AND (\n            SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid\n            AND d2.mjd BETWEEN (SELECT firstmjd FROM object WHERE oid = d.oid)\n                         AND (SELECT lastmjd FROM object WHERE oid = d.oid)\n        ) <= 50\n),\n-- Calculate maximum rise (max mag - min mag) for each object\nmax_rise AS (\n    SELECT\n        object_id,\n        MAX(magnitude) - MIN(magnitude) AS max_rise\n    FROM\n        filtered_objects\n    GROUP BY\n        object_id\n)\n-- Final selection: first 1000 rows ordered by object ID\nSELECT\n    fo.object_id,\n    fo.candidate_id,\n    fo.f_id,\n    fo.ra,\n    fo.dec,\n    fo.magnitude,\n    fo.mag_error,\n    fo.mag_corr_r,\n    fo.mag_corr_error_r,\n    mr.max_rise\nFROM\n    filtered_objects fo\nJOIN\n    max_rise mr ON fo.object_id = mr.object_id\nORDER BY\n    fo.object_id\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r\n    FROM\n        detection d\n    WHERE\n        -- Filter for objects with the highest probability class 'CV/Nova' in 'stochastic' classifier\n        (SELECT p.class_name\n         FROM probability p\n         WHERE p.oid = d.oid\n           AND p.classifier_name = 'lc_classifier_stochastic'\n           AND p.ranking = 1\n         LIMIT 1) = 'CV/Nova'\n        -- Filter for objects with at most 50 detections from first to last detection\n        AND (\n            SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid\n            AND d2.mjd BETWEEN (SELECT firstmjd FROM object WHERE oid = d.oid)\n                         AND (SELECT lastmjd FROM object WHERE oid = d.oid)\n        ) <= 50\n),\n-- Calculate maximum rise (max mag - min mag) for each object\nmax_rise AS (\n    SELECT\n        object_id,\n        MAX(magnitude) - MIN(magnitude) AS max_rise\n    FROM\n        filtered_objects\n    GROUP BY\n        object_id\n)\n-- Final selection: first 1000 rows ordered by object ID\nSELECT\n    fo.object_id,\n    fo.candidate_id,\n    fo.f_id,\n    fo.ra,\n    fo.dec,\n    fo.magnitude,\n    fo.mag_error,\n    fo.mag_corr_r,\n    fo.mag_corr_error_r,\n    mr.max_rise\nFROM\n    filtered_objects fo\nJOIN\n    max_rise mr ON fo.object_id = mr.object_id\nORDER BY\n    fo.object_id\nLIMIT 1000;\n```"
                },
                "in_toks": 3865,
                "out_toks": 442,
                "id": "chatcmpl-BwxFN4pmRzUG4pYV6eJ8MIfhZngU2",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "1": {
            "req_id": "39",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'forced_photometry']",
                    "1": "['object', 'probability', 'detection', 'reference']"
                },
                "in_toks": 859,
                "out_toks": 31,
                "id": "chatcmpl-BjAdAkNYjP6LpbAiDLjnBDhB9Nq21",
                "created": 1750105324,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select relevant object, candidate, and detection information with computed max rise\nWITH object_candidates AS (\n    SELECT\n        o.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS filter_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_error,\n        p.probability AS class_probability,\n        p.ranking AS class_ranking,\n        p.class_name AS class_name,\n        o.ndet AS total_detections,\n        d.mjd AS detection_mjd,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r,\n        d.magpsf AS psf_mag_r,\n        -- Calculate maximum rise as max mag - min mag for each object\n        MAX(d.magpsf) OVER (PARTITION BY o.oid) - MIN(d.magpsf) OVER (PARTITION BY o.oid) AS max_rise\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        -- Filter for class 'CV/Nova' with high confidence (ranking=1)\n        p.class_name = 'CV/Nova'\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.ranking = 1\n        -- Limit to objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter detections in the r-band\n        AND d.fid = 2\n        -- Ensure corrected magnitude is available\n        AND d.magpsf_corr IS NOT NULL\n        -- Additional condition: probability above a threshold (e.g., 0.5) to ensure high confidence\n        AND p.probability > 0.5\n)\n-- Select desired columns and order\nSELECT\n    object_id,\n    candidate_id,\n    filter_id AS f_id,\n    ra,\n    dec,\n    mag,\n    mag_error,\n    mag_corr_r,\n    mag_corr_error_r,\n    psf_mag_r,\n    max_rise\nFROM\n    object_candidates\nORDER BY\n    object_id\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant object, candidate, and detection information with computed max rise\nWITH object_candidates AS (\n    SELECT\n        o.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS filter_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_error,\n        p.probability AS class_probability,\n        p.ranking AS class_ranking,\n        p.class_name AS class_name,\n        o.ndet AS total_detections,\n        d.mjd AS detection_mjd,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r,\n        d.magpsf AS psf_mag_r,\n        -- Calculate maximum rise as max mag - min mag for each object\n        MAX(d.magpsf) OVER (PARTITION BY o.oid) - MIN(d.magpsf) OVER (PARTITION BY o.oid) AS max_rise\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        -- Filter for class 'CV/Nova' with high confidence (ranking=1)\n        p.class_name = 'CV/Nova'\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.ranking = 1\n        -- Limit to objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter detections in the r-band\n        AND d.fid = 2\n        -- Ensure corrected magnitude is available\n        AND d.magpsf_corr IS NOT NULL\n        -- Additional condition: probability above a threshold (e.g., 0.5) to ensure high confidence\n        AND p.probability > 0.5\n)\n-- Select desired columns and order\nSELECT\n    object_id,\n    candidate_id,\n    filter_id AS f_id,\n    ra,\n    dec,\n    mag,\n    mag_error,\n    mag_corr_r,\n    mag_corr_error_r,\n    psf_mag_r,\n    max_rise\nFROM\n    object_candidates\nORDER BY\n    object_id\nLIMIT 1000;\n```"
                },
                "in_toks": 2842,
                "out_toks": 470,
                "id": "chatcmpl-Bx0851M9jmaUCW9mQzueDJFsKesaZ",
                "created": 1753401549,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\nWITH object_candidates AS (\n    SELECT\n        o.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS filter_id,\n        d.ra AS ra,\n        d.dec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_error,\n        p.probability AS class_probability,\n        p.ranking AS class_ranking,\n        p.class_name AS class_name,\n        o.ndet AS total_detections,\n        d.mjd AS detection_mjd,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r,\n        d.magpsf_corr AS psf_mag_r,\n        d.magpsf AS magpsf,\n        d.mjd,\n        -- Calculate maximum rise as max mag - min mag for each object\n        MAX(d.magpsf) OVER (PARTITION BY o.oid) - MIN(d.magpsf) OVER (PARTITION BY o.oid) AS max_rise\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.class_name = 'CV/Nova'\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.ranking = 1\n        AND o.ndet <= 50\n        AND d.fid = 2 -- r-band filter\n        AND d.magpsf_corr IS NOT NULL\n)\nSELECT\n    object_id,\n    candidate_id,\n    filter_id AS f_id,\n    ra,\n    dec,\n    mag,\n    mag_error,\n    mag_corr_r,\n    mag_corr_error_r,\n    psf_mag_r,\n    max_rise\nFROM\n    object_candidates\nORDER BY\n    object_id\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\nWITH object_candidates AS (\n    SELECT\n        o.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS filter_id,\n        d.ra AS ra,\n        d.dec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_error,\n        p.probability AS class_probability,\n        p.ranking AS class_ranking,\n        p.class_name AS class_name,\n        o.ndet AS total_detections,\n        d.mjd AS detection_mjd,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r,\n        d.magpsf_corr AS psf_mag_r,\n        d.magpsf AS magpsf,\n        d.mjd,\n        -- Calculate maximum rise as max mag - min mag for each object\n        MAX(d.magpsf) OVER (PARTITION BY o.oid) - MIN(d.magpsf) OVER (PARTITION BY o.oid) AS max_rise\n    FROM\n        object o\n    JOIN\n        detection d ON o.oid = d.oid\n    JOIN\n        probability p ON o.oid = p.oid\n    WHERE\n        p.class_name = 'CV/Nova'\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.ranking = 1\n        AND o.ndet <= 50\n        AND d.fid = 2 -- r-band filter\n        AND d.magpsf_corr IS NOT NULL\n)\nSELECT\n    object_id,\n    candidate_id,\n    filter_id AS f_id,\n    ra,\n    dec,\n    mag,\n    mag_error,\n    mag_corr_r,\n    mag_corr_error_r,\n    psf_mag_r,\n    max_rise\nFROM\n    object_candidates\nORDER BY\n    object_id\nLIMIT 1000;\n```"
                },
                "in_toks": 3539,
                "out_toks": 388,
                "id": "chatcmpl-BwxFNpzoYSD7RzGu4tHaABlRKbAjk",
                "created": 1753390469,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "2": {
            "req_id": "39",
            "experiment_id": "run_2",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "reference",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'reference', 'forced_photometry']"
                },
                "in_toks": 706,
                "out_toks": 20,
                "id": "chatcmpl-BwvMjxlRIhTRbzVasE7kdLKqkVeh9",
                "created": 1753383237,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from detection table with aggregation to compute max rise\nWITH detection_stats AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        -- For each object, compute maximum and minimum magpsf\n        MAX(d.magpsf) AS max_mag,\n        MIN(d.magpsf) AS min_mag\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects with corrected difference magnitude in r-band (magpsf_corr) not null\n        AND d.magpsf_corr IS NOT NULL\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = d.oid\n                AND p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        )\n    GROUP BY\n        d.oid,\n        d.candid,\n        d.fid,\n        o.meanra,\n        o.meandec\n)\nSELECT\n    ds.oid,\n    ds.candid,\n    ds.f_id,\n    ds.ra,\n    ds.dec,\n    d.magpsf AS mag,\n    d.sigmapsf AS mag_err,\n    d.magpsf_corr AS mag_corr_r,\n    (ds.max_mag - ds.min_mag) AS max_rise\nFROM\n    detection d\nJOIN\n    detection_stats ds ON d.oid = ds.oid AND d.candid = ds.candid\nWHERE\n    -- Ensure we're selecting detections corresponding to the aggregated objects\n    d.fid = 2\n    AND d.oid IN (\n        SELECT oid FROM object WHERE ndet <= 50\n    )\n    AND d.magpsf_corr IS NOT NULL\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE\n            p.oid = d.oid\n            AND p.class_name = 'CV/Nova'\n            AND p.classifier_name = 'lc_classifier_stochastic'\n            AND p.ranking = 1\n    )\nORDER BY\n    ds.oid\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table with aggregation to compute max rise\nWITH detection_stats AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        -- For each object, compute maximum and minimum magpsf\n        MAX(d.magpsf) AS max_mag,\n        MIN(d.magpsf) AS min_mag\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects with corrected difference magnitude in r-band (magpsf_corr) not null\n        AND d.magpsf_corr IS NOT NULL\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = d.oid\n                AND p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        )\n    GROUP BY\n        d.oid,\n        d.candid,\n        d.fid,\n        o.meanra,\n        o.meandec\n)\nSELECT\n    ds.oid,\n    ds.candid,\n    ds.f_id,\n    ds.ra,\n    ds.dec,\n    d.magpsf AS mag,\n    d.sigmapsf AS mag_err,\n    d.magpsf_corr AS mag_corr_r,\n    (ds.max_mag - ds.min_mag) AS max_rise\nFROM\n    detection d\nJOIN\n    detection_stats ds ON d.oid = ds.oid AND d.candid = ds.candid\nWHERE\n    -- Ensure we're selecting detections corresponding to the aggregated objects\n    d.fid = 2\n    AND d.oid IN (\n        SELECT oid FROM object WHERE ndet <= 50\n    )\n    AND d.magpsf_corr IS NOT NULL\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE\n            p.oid = d.oid\n            AND p.class_name = 'CV/Nova'\n            AND p.classifier_name = 'lc_classifier_stochastic'\n            AND p.ranking = 1\n    )\nORDER BY\n    ds.oid\nLIMIT 1000;\n```"
                },
                "in_toks": 3451,
                "out_toks": 533,
                "id": "chatcmpl-Bx087b6C8MIl5fLwfar9Ithtnp0pW",
                "created": 1753401551,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from detection table\nWITH filtered_objects AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects with corrected difference magnitude in r-band (magpsf_corr) not null\n        AND d.magpsf_corr IS NOT NULL\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = d.oid\n                AND p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        )\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    oid\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table\nWITH filtered_objects AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects with corrected difference magnitude in r-band (magpsf_corr) not null\n        AND d.magpsf_corr IS NOT NULL\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = d.oid\n                AND p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        )\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    oid\nLIMIT 1000;\n```"
                },
                "in_toks": 4231,
                "out_toks": 354,
                "id": "chatcmpl-BwxFO91u0R59c0b3WqR928EFFfzZg",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "3": {
            "req_id": "39",
            "experiment_id": "run_3",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'forced_photometry']"
                },
                "in_toks": 706,
                "out_toks": 17,
                "id": "chatcmpl-BwvMkLPD5y3mjUS2dDnhw1fAhosv8",
                "created": 1753383238,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID as 'f_id', coordinates, magnitude, and magnitude errors\nWITH filtered_objects AS (\n    -- Filter objects with maximum probability class 'CV/Nova' in 'lc_classifier_stochastic' classifier\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n    GROUP BY o.oid\n    HAVING COUNT(*) <= 50\n),\ncandidate_probs AS (\n    -- Get the probability for 'CV/Nova' class for each object with additional probability conditions\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- ensure high confidence in classification\n),\ndetection_filtered AS (\n    -- Filter detections for objects in filtered_objects with additional date constraints if needed\n    SELECT d.oid,\n           d.candid,\n           d.rfid AS f_id,\n           d.ra,\n           d.dec,\n           d.magpsf AS mag,\n           d.sigmapsf AS mag_err,\n           d.magpsf_corr AS mag_corr_r\n    FROM detection d\n    JOIN filtered_objects fo ON d.oid = fo.oid\n    WHERE d.fid = 2 -- r-band filter\n),\nmax_min_rise AS (\n    -- Calculate maximum rise (max mag - min mag) for each object\n    SELECT oid, MAX(mag) - MIN(mag) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n)\n-- Final selection with ordering and limit\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.mag,\n    d.mag_err,\n    d.mag_corr_r,\n    mr.max_rise\nFROM detection_filtered d\nJOIN max_min_rise mr ON d.oid = mr.oid\nORDER BY d.oid\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID as 'f_id', coordinates, magnitude, and magnitude errors\nWITH filtered_objects AS (\n    -- Filter objects with maximum probability class 'CV/Nova' in 'lc_classifier_stochastic' classifier\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n    GROUP BY o.oid\n    HAVING COUNT(*) <= 50\n),\ncandidate_probs AS (\n    -- Get the probability for 'CV/Nova' class for each object with additional probability conditions\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n      AND p.probability > 0.5 -- ensure high confidence in classification\n),\ndetection_filtered AS (\n    -- Filter detections for objects in filtered_objects with additional date constraints if needed\n    SELECT d.oid,\n           d.candid,\n           d.rfid AS f_id,\n           d.ra,\n           d.dec,\n           d.magpsf AS mag,\n           d.sigmapsf AS mag_err,\n           d.magpsf_corr AS mag_corr_r\n    FROM detection d\n    JOIN filtered_objects fo ON d.oid = fo.oid\n    WHERE d.fid = 2 -- r-band filter\n),\nmax_min_rise AS (\n    -- Calculate maximum rise (max mag - min mag) for each object\n    SELECT oid, MAX(mag) - MIN(mag) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n)\n-- Final selection with ordering and limit\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.mag,\n    d.mag_err,\n    d.mag_corr_r,\n    mr.max_rise\nFROM detection_filtered d\nJOIN max_min_rise mr ON d.oid = mr.oid\nORDER BY d.oid\nLIMIT 1000;\n```"
                },
                "in_toks": 3271,
                "out_toks": 473,
                "id": "chatcmpl-Bx0PChgGb3B5Q3TDPyPRHNmbMpV5z",
                "created": 1753402610,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID as 'f_id', coordinates, magnitude, and magnitude errors\nWITH filtered_objects AS (\n    -- Filter objects with maximum probability class 'CV/Nova' in 'stochastic' classifier\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n    GROUP BY o.oid\n    HAVING COUNT(*) <= 50\n),\ncandidate_probs AS (\n    -- Get the probability for 'CV/Nova' class for each object\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n),\ndetection_filtered AS (\n    -- Filter detections for objects in filtered_objects\n    SELECT d.oid, d.candid, d.rfid AS f_id, d.ra, d.dec, d.magpsf AS mag, d.sigmapsf AS mag_err, d.magpsf_corr AS mag_corr_r\n    FROM detection d\n    JOIN filtered_objects fo ON d.oid = fo.oid\n    WHERE d.fid = 2 -- r-band filter\n),\nmax_min_rise AS (\n    -- Calculate maximum rise (max mag - min mag) for each object\n    SELECT oid, MAX(mag) - MIN(mag) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.mag,\n    d.mag_err,\n    d.mag_corr_r,\n    mr.max_rise\nFROM detection_filtered d\nJOIN max_min_rise mr ON d.oid = mr.oid\nORDER BY d.oid\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID as 'f_id', coordinates, magnitude, and magnitude errors\nWITH filtered_objects AS (\n    -- Filter objects with maximum probability class 'CV/Nova' in 'stochastic' classifier\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n    GROUP BY o.oid\n    HAVING COUNT(*) <= 50\n),\ncandidate_probs AS (\n    -- Get the probability for 'CV/Nova' class for each object\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n),\ndetection_filtered AS (\n    -- Filter detections for objects in filtered_objects\n    SELECT d.oid, d.candid, d.rfid AS f_id, d.ra, d.dec, d.magpsf AS mag, d.sigmapsf AS mag_err, d.magpsf_corr AS mag_corr_r\n    FROM detection d\n    JOIN filtered_objects fo ON d.oid = fo.oid\n    WHERE d.fid = 2 -- r-band filter\n),\nmax_min_rise AS (\n    -- Calculate maximum rise (max mag - min mag) for each object\n    SELECT oid, MAX(mag) - MIN(mag) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.mag,\n    d.mag_err,\n    d.mag_corr_r,\n    mr.max_rise\nFROM detection_filtered d\nJOIN max_min_rise mr ON d.oid = mr.oid\nORDER BY d.oid\nLIMIT 1000;\n```"
                },
                "in_toks": 3865,
                "out_toks": 428,
                "id": "chatcmpl-BwxFOwNgTp7ToYo8W2UX34Y7DOuoi",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "4": {
            "req_id": "39",
            "experiment_id": "run_4",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "reference",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'reference', 'forced_photometry']"
                },
                "in_toks": 706,
                "out_toks": 20,
                "id": "chatcmpl-BwvMm3ZOKZycjEfeBH5QslB8DuSMT",
                "created": 1753383240,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from detection, object, and probability tables\nWITH filtered_objects AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        -- Use magpsf as the corrected magnitude in r-band (since magpsf_corr does not exist)\n        d.magpsf AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND (\n            SELECT\n                p.class_name\n            FROM\n                probability p\n            WHERE\n                p.oid = o.oid\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n            LIMIT 1\n        ) = 'CV/Nova'\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    oid\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection, object, and probability tables\nWITH filtered_objects AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        -- Use magpsf as the corrected magnitude in r-band (since magpsf_corr does not exist)\n        d.magpsf AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND (\n            SELECT\n                p.class_name\n            FROM\n                probability p\n            WHERE\n                p.oid = o.oid\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n            LIMIT 1\n        ) = 'CV/Nova'\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    oid\nLIMIT 1000;\n```"
                },
                "in_toks": 3574,
                "out_toks": 353,
                "id": "chatcmpl-Bx0811VpT1WjjTsT1tEsUagHuOIma",
                "created": 1753401545,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from detection, object, and probability tables\nWITH filtered_objects AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects with corrected difference magnitude in r-band\n        AND d.magzpsci_corr IS NOT NULL\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND (\n            SELECT\n                p.class_name\n            FROM\n                probability p\n            WHERE\n                p.oid = o.oid\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n            LIMIT 1\n        ) = 'CV/Nova'\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    oid\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection, object, and probability tables\nWITH filtered_objects AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.fid AS f_id,\n        o.meanra AS ra,\n        o.meandec AS dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND o.ndet <= 50\n        -- Filter for objects with corrected difference magnitude in r-band\n        AND d.magzpsci_corr IS NOT NULL\n        -- Filter for objects where the most probable class is 'CV/Nova' in stochastic classifier\n        AND (\n            SELECT\n                p.class_name\n            FROM\n                probability p\n            WHERE\n                p.oid = o.oid\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n            LIMIT 1\n        ) = 'CV/Nova'\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    oid\nLIMIT 1000;\n```"
                },
                "in_toks": 4231,
                "out_toks": 356,
                "id": "chatcmpl-BwxFOFk7eXA1bW4OyQ2zRKQzr7VMz",
                "created": 1753390470,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "5": {
            "req_id": "39",
            "experiment_id": "run_5",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "reference",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'reference', 'forced_photometry']"
                },
                "in_toks": 706,
                "out_toks": 20,
                "id": "chatcmpl-BwvMn6j5qJnpzeHfiUhL9s2kFCOSo",
                "created": 1753383241,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from detection table with optimized nested queries\nWITH detection_counts AS (\n    -- Precompute detection counts per object to avoid repeated subqueries\n    SELECT\n        oid,\n        COUNT(*) AS det_count\n    FROM detection\n    GROUP BY oid\n),\nprobability_filtered AS (\n    -- Filter objects with highest probability class as 'CV/Nova' in the stochastic classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE\n        p.class_name = 'CV/Nova'\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.ranking = 1\n        AND p.probability >= 0.5 -- Optional: ensure high confidence, adjust as needed\n),\nfiltered_detections AS (\n    -- Main detection selection with filters applied\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM detection d\n    -- Join with detection_counts to filter objects with at most 50 detections\n    JOIN detection_counts dc ON d.oid = dc.oid\n    -- Join with probability_filtered to ensure object has highest probability class as 'CV/Nova'\n    JOIN probability_filtered pf ON d.oid = pf.oid\n    WHERE\n        d.fid = 2 -- Filter for r-band\n        AND dc.det_count <= 50 -- Limit detections to at most 50\n    GROUP BY\n        d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n)\n-- Final selection ordered by object ID with limit\nSELECT\n    object_id,\n    candidate_id,\n    f_id,\n    ra,\n    dec,\n    magnitude,\n    mag_error,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_detections\nORDER BY\n    object_id\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table with optimized nested queries\nWITH detection_counts AS (\n    -- Precompute detection counts per object to avoid repeated subqueries\n    SELECT\n        oid,\n        COUNT(*) AS det_count\n    FROM detection\n    GROUP BY oid\n),\nprobability_filtered AS (\n    -- Filter objects with highest probability class as 'CV/Nova' in the stochastic classifier\n    SELECT p.oid\n    FROM probability p\n    WHERE\n        p.class_name = 'CV/Nova'\n        AND p.classifier_name = 'lc_classifier_stochastic'\n        AND p.ranking = 1\n        AND p.probability >= 0.5 -- Optional: ensure high confidence, adjust as needed\n),\nfiltered_detections AS (\n    -- Main detection selection with filters applied\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM detection d\n    -- Join with detection_counts to filter objects with at most 50 detections\n    JOIN detection_counts dc ON d.oid = dc.oid\n    -- Join with probability_filtered to ensure object has highest probability class as 'CV/Nova'\n    JOIN probability_filtered pf ON d.oid = pf.oid\n    WHERE\n        d.fid = 2 -- Filter for r-band\n        AND dc.det_count <= 50 -- Limit detections to at most 50\n    GROUP BY\n        d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n)\n-- Final selection ordered by object ID with limit\nSELECT\n    object_id,\n    candidate_id,\n    f_id,\n    ra,\n    dec,\n    magnitude,\n    mag_error,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_detections\nORDER BY\n    object_id\nLIMIT 1000;\n```"
                },
                "in_toks": 3495,
                "out_toks": 478,
                "id": "chatcmpl-Bx08BN4v8s1XlS1z4HvbM5UNKKhVk",
                "created": 1753401555,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from detection table\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND (\n            SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid\n        ) <= 50\n        -- Filter for objects with the highest probability class as 'CV/Nova' in stochastic classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = d.oid\n                AND p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        )\n    GROUP BY\n        d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n)\nSELECT\n    object_id,\n    candidate_id,\n    f_id,\n    ra,\n    dec,\n    magnitude,\n    mag_error,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    object_id\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.fid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        -- Calculate maximum rise as difference between max and min magpsf in detections per object\n        MAX(d.magpsf) - MIN(d.magpsf) AS max_rise\n    FROM\n        detection d\n    WHERE\n        -- Filter for filter id = 2 (r-band)\n        d.fid = 2\n        -- Filter for objects with at most 50 detections\n        AND (\n            SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid\n        ) <= 50\n        -- Filter for objects with the highest probability class as 'CV/Nova' in stochastic classifier\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = d.oid\n                AND p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        )\n    GROUP BY\n        d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n)\nSELECT\n    object_id,\n    candidate_id,\n    f_id,\n    ra,\n    dec,\n    magnitude,\n    mag_error,\n    mag_corr_r,\n    max_rise\nFROM\n    filtered_objects\nORDER BY\n    object_id\nLIMIT 1000;\n```"
                },
                "in_toks": 4231,
                "out_toks": 366,
                "id": "chatcmpl-BwxFTbpzaWDDGq4xSkHRoUGsTTllX",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "6": {
            "req_id": "39",
            "experiment_id": "run_6",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'forced_photometry']"
                },
                "in_toks": 706,
                "out_toks": 17,
                "id": "chatcmpl-BwvMnVqYigHynnyquUB1VCNWzSZnK",
                "created": 1753383241,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH prob_class AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n),\nobject_detection_counts AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS detection_count,\n        (SELECT firstmjd FROM object WHERE oid = d.oid) AS first_mjd,\n        (SELECT lastmjd FROM object WHERE oid = d.oid) AS last_mjd\n    FROM detection d\n    GROUP BY d.oid\n)\nSELECT\n    d.oid AS object_id,\n    d.candid AS candidate_id,\n    d.rfid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf AS magnitude,\n    d.sigmapsf AS mag_error,\n    d.magpsf_corr AS mag_corr_r,\n    d.sigmapsf_corr AS mag_corr_error_r\nFROM detection d\nJOIN prob_class pc ON d.oid = pc.oid\nJOIN object_detection_counts odc ON d.oid = odc.oid\nWHERE\n    odc.detection_count <= 50\n    AND d.oid IN (SELECT oid FROM prob_class)\n    AND d.mjd BETWEEN\n        (SELECT firstmjd FROM object WHERE oid = d.oid)\n        AND\n        (SELECT lastmjd FROM object WHERE oid = d.oid)\n-- Compute maximum rise (max mag - min mag) per object\n-- Use window functions to get max and min per object\n, max_min AS (\n    SELECT\n        oid,\n        MAX(magpsf) AS max_mag,\n        MIN(magpsf) AS min_mag\n    FROM detection\n    GROUP BY oid\n)\nSELECT\n    d.oid AS object_id,\n    d.candid AS candidate_id,\n    d.rfid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf AS magnitude,\n    d.sigmapsf AS mag_error,\n    d.magpsf_corr AS mag_corr_r,\n    d.sigmapsf_corr AS mag_corr_error_r,\n    (mm.max_mag - mm.min_mag) AS max_rise\nFROM detection d\nJOIN max_min mm ON d.oid = mm.oid\nWHERE d.oid IN (SELECT oid FROM prob_class)\nORDER BY d.oid\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH prob_class AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'CV/Nova'\n      AND p.classifier_name = 'lc_classifier_stochastic'\n      AND p.ranking = 1\n),\nobject_detection_counts AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS detection_count,\n        (SELECT firstmjd FROM object WHERE oid = d.oid) AS first_mjd,\n        (SELECT lastmjd FROM object WHERE oid = d.oid) AS last_mjd\n    FROM detection d\n    GROUP BY d.oid\n)\nSELECT\n    d.oid AS object_id,\n    d.candid AS candidate_id,\n    d.rfid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf AS magnitude,\n    d.sigmapsf AS mag_error,\n    d.magpsf_corr AS mag_corr_r,\n    d.sigmapsf_corr AS mag_corr_error_r\nFROM detection d\nJOIN prob_class pc ON d.oid = pc.oid\nJOIN object_detection_counts odc ON d.oid = odc.oid\nWHERE\n    odc.detection_count <= 50\n    AND d.oid IN (SELECT oid FROM prob_class)\n    AND d.mjd BETWEEN\n        (SELECT firstmjd FROM object WHERE oid = d.oid)\n        AND\n        (SELECT lastmjd FROM object WHERE oid = d.oid)\n-- Compute maximum rise (max mag - min mag) per object\n-- Use window functions to get max and min per object\n, max_min AS (\n    SELECT\n        oid,\n        MAX(magpsf) AS max_mag,\n        MIN(magpsf) AS min_mag\n    FROM detection\n    GROUP BY oid\n)\nSELECT\n    d.oid AS object_id,\n    d.candid AS candidate_id,\n    d.rfid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf AS magnitude,\n    d.sigmapsf AS mag_error,\n    d.magpsf_corr AS mag_corr_r,\n    d.sigmapsf_corr AS mag_corr_error_r,\n    (mm.max_mag - mm.min_mag) AS max_rise\nFROM detection d\nJOIN max_min mm ON d.oid = mm.oid\nWHERE d.oid IN (SELECT oid FROM prob_class)\nORDER BY d.oid\nLIMIT 1000;\n```"
                },
                "in_toks": 3306,
                "out_toks": 522,
                "id": "chatcmpl-Bx088FPyDz2jj2j2f2zAY4pfV5ptH",
                "created": 1753401552,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r\n    FROM\n        detection d\n    WHERE\n        -- Filter for objects with the highest probability class 'CV/Nova' in stochastic classifier\n        -- First, get the probability with ranking=1 for 'CV/Nova' in 'lc_classifier_stochastic'\n        -- Then, filter objects where this probability corresponds to 'CV/Nova'\n        -- and the object has at most 50 detections from first to last detection\n        (\n            SELECT\n                p.oid\n            FROM\n                probability p\n            WHERE\n                p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        ) AS prob_obj\n        ON d.oid = prob_obj.oid\n        AND (\n            SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid AND d2.mjd BETWEEN (SELECT firstmjd FROM object WHERE oid = d.oid) AND (SELECT lastmjd FROM object WHERE oid = d.oid)\n        ) <= 50\n)\n-- Now, select from the filtered objects, compute maximum rise (max mag - min mag) per object\nSELECT\n    fo.object_id,\n    fo.candidate_id,\n    fo.f_id,\n    fo.ra,\n    fo.dec,\n    fo.magnitude,\n    fo.mag_error,\n    fo.mag_corr_r,\n    fo.mag_corr_error_r,\n    (MAX(fo.magnitude) OVER (PARTITION BY fo.object_id) - MIN(fo.magnitude) OVER (PARTITION BY fo.object_id)) AS max_rise\nFROM\n    filtered_objects fo\nORDER BY\n    fo.object_id\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection table, including object ID, candidate ID, filter ID, coordinates, magnitude, and errors\nWITH filtered_objects AS (\n    SELECT\n        d.oid AS object_id,\n        d.candid AS candidate_id,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS magnitude,\n        d.sigmapsf AS mag_error,\n        d.magpsf_corr AS mag_corr_r,\n        d.sigmapsf_corr AS mag_corr_error_r\n    FROM\n        detection d\n    WHERE\n        -- Filter for objects with the highest probability class 'CV/Nova' in stochastic classifier\n        -- First, get the probability with ranking=1 for 'CV/Nova' in 'lc_classifier_stochastic'\n        -- Then, filter objects where this probability corresponds to 'CV/Nova'\n        -- and the object has at most 50 detections from first to last detection\n        (\n            SELECT\n                p.oid\n            FROM\n                probability p\n            WHERE\n                p.class_name = 'CV/Nova'\n                AND p.classifier_name = 'lc_classifier_stochastic'\n                AND p.ranking = 1\n        ) AS prob_obj\n        ON d.oid = prob_obj.oid\n        AND (\n            SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid AND d2.mjd BETWEEN (SELECT firstmjd FROM object WHERE oid = d.oid) AND (SELECT lastmjd FROM object WHERE oid = d.oid)\n        ) <= 50\n)\n-- Now, select from the filtered objects, compute maximum rise (max mag - min mag) per object\nSELECT\n    fo.object_id,\n    fo.candidate_id,\n    fo.f_id,\n    fo.ra,\n    fo.dec,\n    fo.magnitude,\n    fo.mag_error,\n    fo.mag_corr_r,\n    fo.mag_corr_error_r,\n    (MAX(fo.magnitude) OVER (PARTITION BY fo.object_id) - MIN(fo.magnitude) OVER (PARTITION BY fo.object_id)) AS max_rise\nFROM\n    filtered_objects fo\nORDER BY\n    fo.object_id\nLIMIT 1000;\n```"
                },
                "in_toks": 3865,
                "out_toks": 456,
                "id": "chatcmpl-BwxFTx4NTdxWO3cD65sFX6PPfKRLv",
                "created": 1753390475,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "7": {
            "req_id": "39",
            "experiment_id": "run_7",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "reference",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'reference', 'forced_photometry']"
                },
                "in_toks": 706,
                "out_toks": 20,
                "id": "chatcmpl-BwvMoRalBPMMB8j5pQ3ICIUCd8W7M",
                "created": 1753383242,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from detection, object, probability, and reference tables\nWITH filtered_objects AS (\n    -- Filter objects with at most 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nprob_top_stochastic AS (\n    -- Get the most probable class for each object from the top-level classifier\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top' AND p.ranking = 1\n),\ncv_nova_objects AS (\n    -- Filter objects where the top class is 'SNIa' (representing CV/Nova)\n    SELECT p.oid\n    FROM prob_top_stochastic p\n    WHERE p.class_name = 'SNIa'\n),\nfinal_objects AS (\n    -- Combine filters: objects with max 50 detections, excluding CV/Nova\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n      AND o.oid NOT IN (SELECT oid FROM cv_nova_objects)\n),\ndetection_filtered AS (\n    -- Filter detections for the final objects in r-band (fid=2)\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Calculate maximum rise (max magpsf - min magpsf) per object\nrise_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf) - MIN(magpsf) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n),\n-- Get the maximum corrected difference magnitude in r-band for each object\ndetection_with_corr AS (\n    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Determine maximum PSF corrected magnitude in r-filter per object\npsf_max_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf_corr) AS max_psf_corr\n    FROM detection_with_corr\n    GROUP BY oid\n)\n-- Final selection: columns, join with rise and max PSF magnitude, order and limit\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    r.max_rise,\n    p.max_psf_corr\nFROM detection_with_corr d\nJOIN rise_per_object r ON d.oid = r.oid\nJOIN psf_max_per_object p ON d.oid = p.oid\nORDER BY d.oid\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection, object, probability, and reference tables\nWITH filtered_objects AS (\n    -- Filter objects with at most 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nprob_top_stochastic AS (\n    -- Get the most probable class for each object from the top-level classifier\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top' AND p.ranking = 1\n),\ncv_nova_objects AS (\n    -- Filter objects where the top class is 'SNIa' (representing CV/Nova)\n    SELECT p.oid\n    FROM prob_top_stochastic p\n    WHERE p.class_name = 'SNIa'\n),\nfinal_objects AS (\n    -- Combine filters: objects with max 50 detections, excluding CV/Nova\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n      AND o.oid NOT IN (SELECT oid FROM cv_nova_objects)\n),\ndetection_filtered AS (\n    -- Filter detections for the final objects in r-band (fid=2)\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Calculate maximum rise (max magpsf - min magpsf) per object\nrise_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf) - MIN(magpsf) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n),\n-- Get the maximum corrected difference magnitude in r-band for each object\ndetection_with_corr AS (\n    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Determine maximum PSF corrected magnitude in r-filter per object\npsf_max_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf_corr) AS max_psf_corr\n    FROM detection_with_corr\n    GROUP BY oid\n)\n-- Final selection: columns, join with rise and max PSF magnitude, order and limit\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    r.max_rise,\n    p.max_psf_corr\nFROM detection_with_corr d\nJOIN rise_per_object r ON d.oid = r.oid\nJOIN psf_max_per_object p ON d.oid = p.oid\nORDER BY d.oid\nLIMIT 1000;\n```"
                },
                "in_toks": 4003,
                "out_toks": 613,
                "id": "chatcmpl-Bx083UgThTU8NVKQyFXRrTx4B0ZcV",
                "created": 1753401547,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from detection, object, probability, and reference tables\nWITH filtered_objects AS (\n    -- Filter objects with at most 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nprob_top_stochastic AS (\n    -- Get the most probable class for each object from the top-level classifier\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top' AND p.ranking = 1\n),\ncv_nova_objects AS (\n    -- Filter objects where the top class is 'SNIa' (representing CV/Nova)\n    SELECT p.oid\n    FROM prob_top_stochastic p\n    WHERE p.class_name = 'SNIa'\n),\nfinal_objects AS (\n    -- Combine filters: objects with max 50 detections, not CV/Nova\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n      AND o.oid NOT IN (SELECT oid FROM cv_nova_objects)\n),\ndetection_filtered AS (\n    -- Filter detections for the final objects in r-band (fid=2)\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Calculate maximum rise (max magpsf - min magpsf) per object\nrise_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf) - MIN(magpsf) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n),\n-- Get the corrected difference magnitude in r-band\ndetection_with_corr AS (\n    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Determine PSF corrected magnitude in r-filter for each object (taking maximum magpsf_corr)\npsf_max_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf_corr) AS max_psf_corr\n    FROM detection_with_corr\n    GROUP BY oid\n)\n-- Final selection with ordering and limit\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    r.max_rise,\n    p.max_psf_corr\nFROM detection_with_corr d\nJOIN rise_per_object r ON d.oid = r.oid\nJOIN psf_max_per_object p ON d.oid = p.oid\nORDER BY d.oid\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection, object, probability, and reference tables\nWITH filtered_objects AS (\n    -- Filter objects with at most 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nprob_top_stochastic AS (\n    -- Get the most probable class for each object from the top-level classifier\n    SELECT p.oid, p.class_name, p.probability, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top' AND p.ranking = 1\n),\ncv_nova_objects AS (\n    -- Filter objects where the top class is 'SNIa' (representing CV/Nova)\n    SELECT p.oid\n    FROM prob_top_stochastic p\n    WHERE p.class_name = 'SNIa'\n),\nfinal_objects AS (\n    -- Combine filters: objects with max 50 detections, not CV/Nova\n    SELECT o.*\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM filtered_objects)\n      AND o.oid NOT IN (SELECT oid FROM cv_nova_objects)\n),\ndetection_filtered AS (\n    -- Filter detections for the final objects in r-band (fid=2)\n    SELECT d.*\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Calculate maximum rise (max magpsf - min magpsf) per object\nrise_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf) - MIN(magpsf) AS max_rise\n    FROM detection_filtered\n    GROUP BY oid\n),\n-- Get the corrected difference magnitude in r-band\ndetection_with_corr AS (\n    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM final_objects)\n      AND d.fid = 2\n),\n-- Determine PSF corrected magnitude in r-filter for each object (taking maximum magpsf_corr)\npsf_max_per_object AS (\n    SELECT\n        oid,\n        MAX(magpsf_corr) AS max_psf_corr\n    FROM detection_with_corr\n    GROUP BY oid\n)\n-- Final selection with ordering and limit\nSELECT\n    d.oid,\n    d.candid,\n    d.f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    r.max_rise,\n    p.max_psf_corr\nFROM detection_with_corr d\nJOIN rise_per_object r ON d.oid = r.oid\nJOIN psf_max_per_object p ON d.oid = p.oid\nORDER BY d.oid\nLIMIT 1000;\n```"
                },
                "in_toks": 4231,
                "out_toks": 605,
                "id": "chatcmpl-BwxFUky8kWyiDtiw9xo3MUWHn02NT",
                "created": 1753390476,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": true
        },
        "8": {
            "req_id": "39",
            "experiment_id": "run_8",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "reference",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'reference', 'forced_photometry']"
                },
                "in_toks": 706,
                "out_toks": 20,
                "id": "chatcmpl-BwvMpcAq3256xK5KjWbgVK7YMI7eK",
                "created": 1753383243,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from detection, object, probability, and nested subqueries\nSELECT\n    d.oid,\n    d.candid AS candidate_id,\n    d.fid AS f_id,\n    o.meanra AS ra,\n    o.meandec AS dec,\n    d.magpsf AS mag,\n    d.sigmapsf AS mag_err,\n    d.magpsf_corr AS mag_corr_r,\n    -- Calculate maximum rise as difference between max and min magpsf in detections per object\n    MAX(d.magpsf) OVER (PARTITION BY d.oid) - MIN(d.magpsf) OVER (PARTITION BY d.oid) AS max_rise\nFROM\n    detection d\nJOIN\n    object o ON d.oid = o.oid\n-- Subquery to filter objects with highest probability class 'CV/Nova' in stochastic classifier\nWHERE\n    -- Filter objects where the top probability class in 'lc_classifier_stochastic' is 'CV/Nova'\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = d.oid\n          AND p.classifier_name = 'lc_classifier_stochastic'\n          AND p.ranking = 1\n        LIMIT 1\n    ) = 'CV/Nova'\n  AND\n    -- Filter objects with number of detections <= 50\n    (\n        SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid AND d2.mjd BETWEEN o.firstmjd AND o.lastmjd\n    ) <= 50\n  AND\n    -- Filter for corrected difference magnitude in r-band (fid=2)\n    d.fid = 2\n-- Order by object identifier\nORDER BY\n    d.oid\n-- Limit to first 1000 rows\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection, object, probability, and nested subqueries\nSELECT\n    d.oid,\n    d.candid AS candidate_id,\n    d.fid AS f_id,\n    o.meanra AS ra,\n    o.meandec AS dec,\n    d.magpsf AS mag,\n    d.sigmapsf AS mag_err,\n    d.magpsf_corr AS mag_corr_r,\n    -- Calculate maximum rise as difference between max and min magpsf in detections per object\n    MAX(d.magpsf) OVER (PARTITION BY d.oid) - MIN(d.magpsf) OVER (PARTITION BY d.oid) AS max_rise\nFROM\n    detection d\nJOIN\n    object o ON d.oid = o.oid\n-- Subquery to filter objects with highest probability class 'CV/Nova' in stochastic classifier\nWHERE\n    -- Filter objects where the top probability class in 'lc_classifier_stochastic' is 'CV/Nova'\n    (\n        SELECT p.class_name\n        FROM probability p\n        WHERE p.oid = d.oid\n          AND p.classifier_name = 'lc_classifier_stochastic'\n          AND p.ranking = 1\n        LIMIT 1\n    ) = 'CV/Nova'\n  AND\n    -- Filter objects with number of detections <= 50\n    (\n        SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid AND d2.mjd BETWEEN o.firstmjd AND o.lastmjd\n    ) <= 50\n  AND\n    -- Filter for corrected difference magnitude in r-band (fid=2)\n    d.fid = 2\n-- Order by object identifier\nORDER BY\n    d.oid\n-- Limit to first 1000 rows\nLIMIT 1000;\n```"
                },
                "in_toks": 4231,
                "out_toks": 375,
                "id": "chatcmpl-BwxFJJxLPiw1uRNt8YsdT4w6hldVd",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        },
        "9": {
            "req_id": "39",
            "experiment_id": "run_9",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "reference",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'reference', 'forced_photometry']"
                },
                "in_toks": 706,
                "out_toks": 20,
                "id": "chatcmpl-BwvMpbwORucC0KUUhi8rwo1g5rGgF",
                "created": 1753383243,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": null,
            "sql_response": null,
            "pred_diff": null,
            "diff_response": null,
            "original_sql_query": "```sql\n-- Select specified columns from detection, object, probability, and reference tables\nWITH filtered_objects AS (\n    -- Filter objects with at most 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nprob_top_stochastic AS (\n    -- Get the most probable class for each object from the top-level classifier\n    SELECT p.oid, p.class_name, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top' AND p.ranking = 1\n),\ncv_nova_objects AS (\n    -- Filter objects where the top class is 'SNIa' (representing CV/Nova class)\n    SELECT p.oid\n    FROM prob_top_stochastic p\n    WHERE p.class_name = 'SNIa'\n),\nfinal_objects AS (\n    -- Combine filters: detection count, class, and object existence\n    SELECT o.oid\n    FROM object o\n    JOIN filtered_objects fo ON o.oid = fo.oid\n    JOIN cv_nova_objects cv ON o.oid = cv.oid\n)\nSELECT\n    d.oid,\n    d.candid AS candidate_id,\n    d.fid AS f_id,\n    o.meanra AS ra,\n    o.meandec AS dec,\n    d.magpsf AS mag,\n    d.sigmapsf AS mag_err,\n    d.magpsf_corr AS mag_corr_r,\n    -- Calculate maximum rise as max(mag) - min(mag) across detections per object\n    MAX(d.magpsf) OVER (PARTITION BY d.oid) - MIN(d.magpsf) OVER (PARTITION BY d.oid) AS max_rise\nFROM detection d\nJOIN object o ON d.oid = o.oid\nJOIN final_objects fo ON o.oid = fo.oid\nJOIN probability p ON o.oid = p.oid\nWHERE\n    p.classifier_name = 'lc_classifier_stochastic'\n    AND p.class_name = 'SNIa'\n    AND p.ranking = 1\n    AND d.fid = 2 -- r-band filter\n    AND d.corrected = TRUE\nORDER BY d.oid\nLIMIT 1000;\n```",
            "original_sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection, object, probability, and reference tables\nWITH filtered_objects AS (\n    -- Filter objects with at most 50 detections\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 50\n),\nprob_top_stochastic AS (\n    -- Get the most probable class for each object from the top-level classifier\n    SELECT p.oid, p.class_name, p.ranking\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_top' AND p.ranking = 1\n),\ncv_nova_objects AS (\n    -- Filter objects where the top class is 'SNIa' (representing CV/Nova class)\n    SELECT p.oid\n    FROM prob_top_stochastic p\n    WHERE p.class_name = 'SNIa'\n),\nfinal_objects AS (\n    -- Combine filters: detection count, class, and object existence\n    SELECT o.oid\n    FROM object o\n    JOIN filtered_objects fo ON o.oid = fo.oid\n    JOIN cv_nova_objects cv ON o.oid = cv.oid\n)\nSELECT\n    d.oid,\n    d.candid AS candidate_id,\n    d.fid AS f_id,\n    o.meanra AS ra,\n    o.meandec AS dec,\n    d.magpsf AS mag,\n    d.sigmapsf AS mag_err,\n    d.magpsf_corr AS mag_corr_r,\n    -- Calculate maximum rise as max(mag) - min(mag) across detections per object\n    MAX(d.magpsf) OVER (PARTITION BY d.oid) - MIN(d.magpsf) OVER (PARTITION BY d.oid) AS max_rise\nFROM detection d\nJOIN object o ON d.oid = o.oid\nJOIN final_objects fo ON o.oid = fo.oid\nJOIN probability p ON o.oid = p.oid\nWHERE\n    p.classifier_name = 'lc_classifier_stochastic'\n    AND p.class_name = 'SNIa'\n    AND p.ranking = 1\n    AND d.fid = 2 -- r-band filter\n    AND d.corrected = TRUE\nORDER BY d.oid\nLIMIT 1000;\n```"
                },
                "in_toks": 4231,
                "out_toks": 464,
                "id": "chatcmpl-BwxFJEKXPL6mjFW4hYfesRh3M9P7M",
                "created": 1753390465,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "correction_applied": false
        }
    }
}