{"id": "batch_req_6839e3ea469c8190b11c0fb48cdb2570", "custom_id": "86-0", "response": {"status_code": 200, "request_id": "2c1a0678147fe7dd89611e62eccb352c", "body": {"id": "chatcmpl-BcxMMVhqb2oVi2N9vuYcRHibFXpmc", "object": "chat.completion", "created": 1748624342, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*, z.*\nFROM probability p\nINNER JOIN ps1_ztf z ON p.oid = z.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.probability > 0.6\n  AND p.class_name IN ('Cepheid', 'DSCT', 'RRL')\n  AND z.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2205, "completion_tokens": 113, "total_tokens": 2318, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839e3ea52308190b668d9169bd34393", "custom_id": "86-1", "response": {"status_code": 200, "request_id": "413f893363dfa6fdfb663e2582506a63", "body": {"id": "chatcmpl-BcxMLhtlEiz1xR4v6SaQb9dSsPEAM", "object": "chat.completion", "created": 1748624341, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*, ps1.*\nFROM probability p\nINNER JOIN ps1_ztf ps1 ON p.oid = ps1.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND p.probability > 0.6\n  AND p.class_name IN ('Cepheid', 'DSCT', 'RRL')\n  AND ps1.sgscore1 > 0.8\nORDER BY p.probability DESC\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2011, "completion_tokens": 125, "total_tokens": 2136, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839e3ea62508190abe3fdbeaf120623", "custom_id": "36-0", "response": {"status_code": 200, "request_id": "2f411b68ca56b5828c86d041d4748427", "body": {"id": "chatcmpl-BcxMb2fkGmrjs3E9fWTkcpzENm74k", "object": "chat.completion", "created": 1748624357, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT oid, name, value\nFROM feature\nWHERE oid = 'ZTF20aaelulu';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1908, "completion_tokens": 25, "total_tokens": 1933, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839e3ea6d688190a9e094f4a7e913ed", "custom_id": "36-1", "response": {"status_code": 200, "request_id": "9ce7b7428cc7bf0f21f7e7a0f4442a2f", "body": {"id": "chatcmpl-BcxMfYtJI8LGQQt5EDQJPXQFizbYL", "object": "chat.completion", "created": 1748624361, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT oid, name, value\nFROM feature\nWHERE oid = 'ZTF20aaelulu'\nORDER BY name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1969, "completion_tokens": 29, "total_tokens": 1998, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839e3ea79c08190be81fa0e1a70e9aa", "custom_id": "0-0", "response": {"status_code": 200, "request_id": "265ffd265259dec512219fa1b542618f", "body": {"id": "chatcmpl-BcxMM5AIeiHqH94HyZJJC8Oq9MYmW", "object": "chat.completion", "created": 1748624342, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid,\n    p.probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.7\n    AND f.name IN ('Multiband_period', 'period') -- assuming period features are labeled as such\n    AND f.value BETWEEN 3 AND 10\nUNION ALL\nSELECT \n    o.oid,\n    p.probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.7\n    AND f.name = 'Amplitude'\n    AND f.value > 0.5\nORDER BY \n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2128, "completion_tokens": 288, "total_tokens": 2416, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839e3ea84d081908f1c5e7bf09e0cc8", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "430e979b395b131654ae86fb5bf701e0", "body": {"id": "chatcmpl-BcxMMWibeeWH9vam5hNO6DR65GfT1", "object": "chat.completion", "created": 1748624342, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid,\n    p.probability,\n    f_period.value AS period_value,\n    f_period.name AS feature_name,\n    f_period.fid,\n    f_period.version AS feature_version,\n    f_amplitude.value AS amplitude_value\nFROM \n    probability p\nINNER JOIN \n    object o ON p.oid = o.oid\n-- Filter for objects with high YSO probability\nWHERE \n    p.class_name = 'YSO'\n    AND p.probability > 0.7\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n-- Join for period feature within 3 to 10 days\nINNER JOIN \n    feature f_period ON o.oid = f_period.oid\n    AND f_period.name IN ('Multiband_period') -- assuming 'Multiband_period' indicates period feature\n    AND f_period.value BETWEEN 3 AND 10\n-- Join for amplitude feature greater than 0.5\nINNER JOIN \n    feature f_amplitude ON o.oid = f_amplitude.oid\n    AND f_amplitude.name = 'Amplitude'\n    AND f_amplitude.value > 0.5\n-- Order by probability descending\nORDER BY \n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2101, "completion_tokens": 265, "total_tokens": 2366, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839e3ea904c8190b98903b646533e12", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "b4c9bcc1985ab386f52cf8c8f5adc585", "body": {"id": "chatcmpl-BcxMMLyRB0aTLWmpw1k47uXYFWMvC", "object": "chat.completion", "created": 1748624342, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter objects classified as SN II with probability > 0.6, ranking=1, classifier='lc_classifier'\nWITH snii_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd <= 59910 -- 2022-12-31 MJD\n      AND o.lastmjd >= 58549 -- 2019-01-01 MJD\n),\n-- Step 2: Filter objects with more than 50 detections in 2019-2022\nobjects_with_ndet AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM snii_objects)\n      AND o.ndet > 50\n),\n-- Step 3: Filter detections within date range and bands g (fid=1) and r (fid=2)\ndetections_filtered AS (\n    SELECT d.oid, d.candid, d.magpsf, d.sigmapsf, d.mjd, d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM objects_with_ndet)\n      AND d.mjd BETWEEN 58549 AND 59910\n      AND d.fid IN (1, 2)\n),\n-- Step 4: Filter objects with initial rise rate > 0.5 mag/day in g and r bands\nmagstat_filtered AS (\n    SELECT m.oid, m.fid, m.dmdt_first\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM objects_with_ndet)\n      AND m.fid IN (1, 2)\n      AND m.dmdt_first > 0.5\n)\n-- Final: Retrieve detections with associated initial rise rate\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    m.dmdt_first,\n    CASE d.fid WHEN 1 THEN 'g' WHEN 2 THEN 'r' END AS band,\n    d.mjd\nFROM detections_filtered d\nINNER JOIN magstat_filtered m ON d.oid = m.oid AND d.fid = m.fid\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2713, "completion_tokens": 515, "total_tokens": 3228, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839e3ea9cb88190b6c21b31efaa98b2", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "222355a7fe2d28c62cc6b4354877195c", "body": {"id": "chatcmpl-BcxMTrre5SD1dp0xKJ7d4iJUncW0b", "object": "chat.completion", "created": 1748624349, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH classified_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name='SNII'\n      AND p.classifier_name='lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking=1\n),\nfiltered_objects AS (\n    SELECT o.*\n    FROM object o\n    JOIN classified_objects co ON o.oid = co.oid\n    WHERE o.firstmjd BETWEEN 2458600 AND 2459580 -- Corresponds approximately to 2019-01-01 to 2022-12-31\n      AND o.lastmjd BETWEEN 2458600 AND 2459580\n      AND o.ndet > 50\n),\nmagstat_filtered AS (\n    SELECT *\n    FROM magstat\n    WHERE dmdt_first > 0.5\n)\nSELECT\n    o.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    m.dmdt_first,\n    d.fid,\n    d.mjd\nFROM filtered_objects o\nJOIN detection d ON o.oid = d.oid\nJOIN magstat_filtered m ON o.oid = m.oid\nORDER BY d.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2511, "completion_tokens": 256, "total_tokens": 2767, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839e3eaa87081909b6a3b72125b291b", "custom_id": "97-0", "response": {"status_code": 200, "request_id": "2ea8669c6997c2b29629d3852117f004", "body": {"id": "chatcmpl-BcxMRqFFUaQsbGynWsWFwhlV9NHSz", "object": "chat.completion", "created": 1748624347, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_probs AS (\n    SELECT o.oid, p.probability AS prob_stamp_agn\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'stamp_classifier_1.0.4'\n      AND p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nlpv_probs AS (\n    SELECT o.oid, p.probability AS prob_lc_lpv\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'LPV'\n      AND p.probability > 0.7\n      AND p.ranking = 1\n)\nSELECT o.oid, agn_probs.prob_stamp_agn, lpv_probs.prob_lc_lpv\nFROM object o\nINNER JOIN agn_probs ON o.oid = agn_probs.oid\nINNER JOIN lpv_probs ON o.oid = lpv_probs.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2140, "completion_tokens": 241, "total_tokens": 2381, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839e3eab440819086223419d6c51241", "custom_id": "97-1", "response": {"status_code": 200, "request_id": "31724b752adf23f4590075d63b4632dc", "body": {"id": "chatcmpl-BcxMMtRMtKwE9tRoJ5JChqkWBpcBp", "object": "chat.completion", "created": 1748624342, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_probs AS (\n    SELECT oid, probability AS prob_stamp_agn\n    FROM probability\n    WHERE class_name = 'AGN'\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n      AND probability > 0.6\n),\nlpv_probs AS (\n    SELECT oid, probability AS prob_lc_lpv\n    FROM probability\n    WHERE class_name = 'LPV'\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.7\n)\nSELECT a.oid, a.prob_stamp_agn, l.prob_lc_lpv\nFROM agn_probs a\nINNER JOIN lpv_probs l ON a.oid = l.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2084, "completion_tokens": 161, "total_tokens": 2245, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
