{"id": "batch_req_6843677cc2f48190a7084d27b6529dc4", "custom_id": "86-1", "response": {"status_code": 200, "request_id": "4927560c4adc5c383128fcf7a8c655f6", "body": {"id": "chatcmpl-BfZZBvhJ8uXNsAGiUKqYPh3FF0uHy", "object": "chat.completion", "created": 1749247865, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and ps1_ztf tables for objects classified as Cepheid, DSCT, or RRL\n-- with probability > 0.6, ranked 1, and with a star/galaxy score > 0.8 for the closest PS1 object\n-- Use nested queries to optimize and filter early, reducing the dataset before join\nSELECT p.*, ps1.*\nFROM (\n    -- Subquery to filter probability table with necessary conditions\n    SELECT *\n    FROM probability\n    WHERE classifier_name = 'hierarchical_rf_1.1.0'\n      AND ranking = 1\n      AND probability > 0.6\n      AND class_name IN ('Cepheid', 'DSCT', 'RRL')\n) p\n-- Join with ps1_ztf on object ID\nINNER JOIN ps1_ztf ps1 ON p.oid = ps1.oid\n-- Filter for star/galaxy score > 0.8 in the closest PS1 object\nWHERE ps1.sgscore1 > 0.8\n-- Limit the result to 100 rows for performance\nORDER BY p.probability DESC\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2170, "completion_tokens": 245, "total_tokens": 2415, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_6843677ccf4081908570564d0f85bc85", "custom_id": "91-0", "response": {"status_code": 200, "request_id": "62b0d8d4affbbcdcd1dadb13ab916801", "body": {"id": "chatcmpl-BfZZB7bklwhYFFjHudBMAChxXLgbR", "object": "chat.completion", "created": 1749247865, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with 'W1-W2' color less than 1, including specified columns\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.value - f_r.value) AS g_minus_r_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join to get the 'g-W2' feature for the object\nJOIN \n    feature f_g ON o.oid = f_g.oid AND f_g.name = 'g-W2' AND f_g.fid = 13\n-- Join to get the 'r-W2' feature for the object\nJOIN \n    feature f_r ON o.oid = f_r.oid AND f_r.name = 'r-W2' AND f_r.fid = 23\n-- Join to get the 'W1-W2' feature for the object\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2' AND f_w1_w2.fid = 12\n-- Subquery to get the latest version of 'W1-W2' feature for each object\nWHERE \n    f_w1_w2.value < 1\n    AND f_w1_w2.version = (\n        SELECT MAX(version)\n        FROM feature f_sub\n        WHERE f_sub.name = 'W1-W2' AND f_sub.oid = o.oid\n    )\n-- Limit to 100 results for performance\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3978, "completion_tokens": 344, "total_tokens": 4322, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_6843677cdf2c8190b70a5dfe2737151f", "custom_id": "91-1", "response": {"status_code": 200, "request_id": "7b901991d96431829824c1529f193578", "body": {"id": "chatcmpl-BfZZBhXXqDYjCbp41rLKtc7Nifre5", "object": "chat.completion", "created": 1749247865, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with 'W1-W2' color less than 1, including specified columns\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.value - f_r.value) AS g_minus_r_diff,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join to get g-r_max feature (fid=13) for the object\nJOIN \n    feature f_g ON o.oid = f_g.oid AND f_g.name = 'g-r_max' AND f_g.fid = 13\n-- Join to get r-W2 feature (fid=12) for the object\nJOIN \n    feature f_r ON o.oid = f_r.oid AND f_r.name = 'r-W2' AND f_r.fid = 12\n-- Join to get W1-W2 feature (fid=13 or 12, depending on feature naming; assuming fid=13 for W1-W2)\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2'\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results for performance\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3854, "completion_tokens": 287, "total_tokens": 4141, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_6843677cebc08190a5e8d528cc7df8ea", "custom_id": "0-0", "response": {"status_code": 200, "request_id": "b39ae004ffbb9db39b522cd2e40169bd", "body": {"id": "chatcmpl-BfZZByNv1IEXXhHJri0yV84l2yHDl", "object": "chat.completion", "created": 1749247865, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects likely to be YSOs with periodicities between 3 and 10 days and amplitude > 0.5 mag\nSELECT \n    o.oid,\n    p.probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.7\n    AND (\n        -- Check for period features within the specified range\n        (f.name IN ('Multiband_period', 'period') AND f.value BETWEEN 3 AND 10)\n        OR\n        -- Check for amplitude feature greater than 0.5\n        (f.name = 'Amplitude' AND f.value > 0.5)\n    )\nORDER BY \n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4094, "completion_tokens": 224, "total_tokens": 4318, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_6843677cfdc88190bfa649057aae9914", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "4f4f511943b984f519f6d634b556e891", "body": {"id": "chatcmpl-BfZZCD6pa9H821rw24L3ecZzUnoRd", "object": "chat.completion", "created": 1749247866, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object ID, probability, period value and related info, and amplitude\nSELECT \n    o.oid,\n    p.probability,\n    f_period.value AS period_value,\n    f_period.name AS feature_name,\n    f_period.fid,\n    f_period.version AS feature_version,\n    f_amplitude.value AS amplitude_value\nFROM \n    probability p\n-- Join with object table to get object details\nJOIN \n    object o ON p.oid = o.oid\n-- Filter for objects with high YSO probability\nWHERE \n    p.class_name = 'YSO'\n    AND p.probability > 0.7\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n-- Join for period feature within 3 to 10 days\nJOIN \n    feature f_period ON o.oid = f_period.oid\n    AND f_period.name = 'Multiband_period' -- period feature\n    AND f_period.value BETWEEN 3 AND 10\n-- Join for amplitude feature greater than 0.5\nJOIN \n    feature f_amplitude ON o.oid = f_amplitude.oid\n    AND f_amplitude.name = 'Amplitude'\n    AND f_amplitude.value > 0.5\n-- Order results by probability descending\nORDER BY \n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4059, "completion_tokens": 281, "total_tokens": 4340, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
