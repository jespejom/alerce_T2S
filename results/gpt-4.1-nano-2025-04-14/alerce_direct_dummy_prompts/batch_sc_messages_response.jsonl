{"id": "batch_req_6839d1b4d9a48190903d1824bbcd5364", "custom_id": "91-0", "response": {"status_code": 200, "request_id": "33621438386165e414c3e19346262f60", "body": {"id": "chatcmpl-Bcw96wmE4Azw8HZiPZDF6i2otBgdo", "object": "chat.completion", "created": 1748619676, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with 'W1-W2' color lower than 1, including specified columns\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.value - f_r.value) AS mag_diff_g_r,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join with feature table for g-W2 color (g-r difference)\nJOIN \n    feature f_g ON o.oid = f_g.oid AND f_g.name = 'g-W2' AND f_g.fid = 13\n-- Join with feature table for r-W2 color\nJOIN \n    feature f_r ON o.oid = f_r.oid AND f_r.name = 'r-W2' AND f_r.fid = 23\n-- Join with feature table for W1-W2 color\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid AND f_w1_w2.name = 'W1-W2' AND f_w1_w2.fid = 12\n-- Optional: join with probability table if needed for optimization (assuming such a table exists)\n-- WHERE clause to filter objects with W1-W2 color less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit the result to 100 rows for performance\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3933, "completion_tokens": 308, "total_tokens": 4241, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839d1b4e8988190a23f42d9d404b2b3", "custom_id": "91-1", "response": {"status_code": 200, "request_id": "beef2aa633ab7f8b9c755843219fbcdd", "body": {"id": "chatcmpl-Bcw9Flhy54kINkPQG55ELiaXlEdl5", "object": "chat.completion", "created": 1748619685, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select ZTF objects with 'W1-W2' color lower than 1, including specified columns\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    (f_g.value - f_r.value) AS mag_diff_g_r,\n    f_w1_w2.value AS w1_w2,\n    f_w1_w2.version AS feature_version\nFROM \n    object o\n-- Join to get g-r_max feature for g-band (fid=13)\nJOIN \n    feature f_g ON o.oid = f_g.oid \n    AND f_g.name = 'g-r_max' \n    AND f_g.fid = 13\n-- Join to get g-r_max feature for r-band (fid=23)\nJOIN \n    feature f_r ON o.oid = f_r.oid \n    AND f_r.name = 'g-r_max' \n    AND f_r.fid = 23\n-- Join to get W1-W2 feature\nJOIN \n    feature f_w1_w2 ON o.oid = f_w1_w2.oid \n    AND f_w1_w2.name = 'W1-W2'\n-- Filter objects where W1-W2 color is less than 1\nWHERE \n    f_w1_w2.value < 1\n-- Limit to 100 results for performance\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3858, "completion_tokens": 290, "total_tokens": 4148, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839d1b4f45c81909d88eba9b6436fdf", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "e553cbf36f06cfb6ef5dda11e598e80f", "body": {"id": "chatcmpl-Bcw96AhzLS12wi4Op09qSY4T14HYg", "object": "chat.completion", "created": 1748619676, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "-- Optimized query with nested subqueries to improve performance and ensure proper filtering\nWITH yso_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS possibility,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        f.name AS feature_name,\n        f.value,\n        f.fid AS filter_id,\n        f.version AS feature_version\n    FROM\n        probability p\n    WHERE\n        p.class_name = 'YSO'\n        AND p.ranking = 1\n        AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n        AND EXISTS (\n            -- Ensure the object has a 'Period_band' feature within the specified period range\n            SELECT 1\n            FROM feature f1\n            WHERE\n                f1.oid = p.oid\n                AND f1.name = 'Period_band'\n                AND f1.value BETWEEN 3 AND 10\n        )\n        AND EXISTS (\n            -- Ensure the object has an 'Amplitude' feature greater than 0.5\n            SELECT 1\n            FROM feature f2\n            WHERE\n                f2.oid = p.oid\n                AND f2.name = 'Amplitude'\n                AND f2.value > 0.5\n        )\n)\nSELECT\n    oid,\n    possibility,\n    class_name,\n    feature_name,\n    value,\n    filter_id,\n    feature_version\nFROM\n    yso_prob\nORDER BY\n    possibility DESC;\n", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4114, "completion_tokens": 326, "total_tokens": 4440, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839d1b50104819084ef098733e4119e", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "9f5a130c45182b53e908ebd5b2ce6e53", "body": {"id": "chatcmpl-Bcw9FnS9IOgQraTsqAWyaETa4VMoZ", "object": "chat.completion", "created": 1748619685, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant information for objects classified as SN II with specified conditions\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII' -- Corrected class_name to 'SNII' for SN II classification\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58311 AND 58823 -- Corresponds to 2019-01-01 to 2022-12-31 in MJD\n      AND o.ndet > 50\n),\nrise_rates AS (\n    SELECT\n        m.oid,\n        -- Calculate initial rise rate as change in magnitude over time between first and last detection\n        (m.magfirst - m.maglast) / NULLIF(m.lastmjd - m.firstmjd, 0) AS initial_rise_rate\n    FROM magstat m\n    WHERE m.firstmjd IS NOT NULL AND m.lastmjd IS NOT NULL\n      AND m.ndet > 1\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    -- Estimate initial rise as the difference between first and last magnitude divided by time\n    (m.magfirst - m.maglast) / NULLIF(m.lastmjd - m.firstmjd, 0) AS initial_rise_estimate,\n    d.fid\nFROM detection d\nJOIN sn_ii_objects s ON d.oid = s.oid\nJOIN magstat m ON d.oid = m.oid\n  AND d.mjd BETWEEN m.firstmjd AND m.lastmjd\nJOIN rise_rates r ON d.oid = r.oid\nWHERE d.mjd BETWEEN 58311 AND 58823 -- MJD range for 2019-01-01 to 2022-12-31\n  AND d.fid IN (1, 2) -- g and r bands\n  AND r.initial_rise_rate > 0.5\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3088, "completion_tokens": 459, "total_tokens": 3547, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_6839d1b50ca08190a72ae5a5cef14c1e", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "17f8281cf793fb37c7124c7ea344fa20", "body": {"id": "chatcmpl-Bcw976ZLuahCaqj3KXa1ftsLhrAm8", "object": "chat.completion", "created": 1748619677, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select relevant information for objects classified as SN II with specified conditions\nWITH sn_ii_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII' -- Corrected class name to 'SNII' for Type II supernovae\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd BETWEEN 58849 AND 59923 -- Corresponds to dates from 2019-01-01 to 2022-12-31 in MJD\n      AND o.ndet > 50\n),\nrise_rates AS (\n    SELECT\n        m.oid,\n        -- Calculate initial rise rate as change in magnitude over time between first and second detection\n        (m.magfirst - m.maglast) / NULLIF(m.lastmjd - m.firstmjd, 0) AS initial_rise_rate\n    FROM magstat m\n    WHERE m.ndet >= 2\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    -- Estimate initial rise as the difference between first and second detection magnitudes\n    (d.magpsf - d.magap) AS initial_rise_estimate,\n    d.fid\nFROM detection d\nJOIN sn_ii_objects s ON d.oid = s.oid\nJOIN rise_rates r ON d.oid = r.oid\nWHERE\n    d.mjd = (\n        SELECT MIN(mjd)\n        FROM detection\n        WHERE oid = d.oid\n    )\n    AND d.fid IN (1, 2) -- g and r bands\n    AND r.initial_rise_rate > 0.5\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2965, "completion_tokens": 395, "total_tokens": 3360, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
