{"id": "batch_req_684891a6396881909cb6e2e23c098653", "custom_id": "10-0", "response": {"status_code": 200, "request_id": "a1d9f982f5f8c7452b85900061deb398", "body": {"id": "chatcmpl-BgzbTaoee2rNaprdvISBvpteOVz7n", "object": "chat.completion", "created": 1749586279, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers and their probabilities for SNIa and CV/Nova classes\nSELECT \n    p_sn.oid,\n    p_sn.probability AS \"SN_prob\",\n    p_cv.probability AS \"CV_prob\"\nFROM\n    -- Subquery for SNIa probabilities with ranking=1\n    (SELECT oid, probability\n     FROM probability\n     WHERE classifier_name='lc_classifier' AND class_name='SNIa' AND ranking=1) p_sn\nINNER JOIN\n    -- Subquery for CV/Nova probabilities with ranking=2\n    (SELECT oid, probability\n     FROM probability\n     WHERE classifier_name='lc_classifier' AND class_name='CV/Nova' AND ranking=2) p_cv\nON p_sn.oid = p_cv.oid\nWHERE\n    -- Filter objects where the absolute difference between probabilities is less than 0.1\n    ABS(p_sn.probability - p_cv.probability) < 0.1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2721, "completion_tokens": 205, "total_tokens": 2926, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a646ac8190a55a6be2a9c73e2a", "custom_id": "10-1", "response": {"status_code": 200, "request_id": "9720b339831d9223084a9bb5f0cc0103", "body": {"id": "chatcmpl-BgzbUv3GMfrnJfMq6TPdjiC3ytHEP", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers and their probabilities for SNIa and CV/Nova classifications\nSELECT \n    o.oid,\n    -- Probability of SNIa at ranking 1\n    p_snia.probability AS \"SN_prob\",\n    -- Probability of CV/Nova at ranking 2\n    p_cvnova.probability AS \"CV_prob\"\nFROM \n    object o\nINNER JOIN \n    probability p_snia ON o.oid = p_snia.oid\nINNER JOIN \n    probability p_cvnova ON o.oid = p_cvnova.oid\nWHERE \n    -- Filter for SNIa class with ranking 1\n    p_snia.class_name = 'SNIa' AND p_snia.ranking = 1\n    -- Filter for CV/Nova class with ranking 2\n    AND p_cvnova.class_name = 'CV/Nova' AND p_cvnova.ranking = 2\n    -- Ensure probabilities are from the light curve classifier\n    AND p_snia.classifier_name = 'lc_classifier'\n    AND p_cvnova.classifier_name = 'lc_classifier'\n    -- Filter objects where the absolute difference between probabilities is less than 0.1\n    AND ABS(p_snia.probability - p_cvnova.probability) < 0.1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2692, "completion_tokens": 278, "total_tokens": 2970, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a654d48190a49b76891746ef5f", "custom_id": "15-0", "response": {"status_code": 200, "request_id": "eb12de2a43adec212d290013f3e99046", "body": {"id": "chatcmpl-BgzbUtg0AWcyvI8QfIoE2ggOECNgK", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH sn_prob AS (\n    -- Select objects with highest probability for class 'SN' in stamp_classifier\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name='stamp_classifier'\n      AND p.class_name='SN'\n      AND p.ranking=1\n),\nfirst_detections AS (\n    -- Select objects with first detection in the first 2 days of September\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nlast_non_detections AS (\n    -- For each object, find the last non-detection before first detection\n    SELECT d.oid, MAX(d.mjd) AS last_mjd, d.magpsf\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM first_detections)\n      AND d.isdiffpos=FALSE\n      AND d.mjd < (SELECT firstmjd FROM object o WHERE o.oid=d.oid)\n    GROUP BY d.oid, d.magpsf\n),\ninitial_rise AS (\n    -- Calculate the initial rise rate for each object\n    SELECT\n        f.oid,\n        (f.magpsf - n.magpsf) / NULLIF((f.firstmjd - n.last_mjd), 0) AS rise_rate\n    FROM first_detections f\n    JOIN last_non_detections n ON f.oid = n.oid\n    WHERE (f.magpsf - n.magpsf) >= 0.25 * (f.firstmjd - n.last_mjd)\n),\nqualified_objects AS (\n    -- Select objects that qualify as fast risers\n    SELECT f.oid\n    FROM first_detections f\n    JOIN initial_rise r ON f.oid = r.oid\n    WHERE r.rise_rate >= 0.25\n),\ndetections AS (\n    -- Retrieve detections (positive only) for qualified objects\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM qualified_objects)\n      AND d.isdiffpos=TRUE\n),\nmagstat_info AS (\n    -- Get magstat filter ID for each object\n    SELECT m.oid, m.fid AS magstat_fid\n    FROM magstat m\n    WHERE m.oid IN (SELECT oid FROM qualified_objects)\n)\nSELECT\n    sn_prob.oid,\n    sn_prob.probability,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf,\n    m.magstat_fid,\n    (f.magpsf - n.magpsf) / NULLIF((f.firstmjd - n.last_mjd), 0) AS initial_rise_estimate\nFROM sn_prob\nJOIN first_detections f ON sn_prob.oid = f.oid\nJOIN last_non_detections n ON sn_prob.oid = n.oid\nJOIN qualified_objects q ON sn_prob.oid = q.oid\nJOIN detections d ON q.oid = d.oid\nJOIN magstat_info m ON q.oid = m.oid\nORDER BY sn_prob.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3461, "completion_tokens": 687, "total_tokens": 4148, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6613c81908cc354d1bdc641d5", "custom_id": "15-1", "response": {"status_code": 200, "request_id": "48120193d6fedb8f37bf3e9dd5ceb7df", "body": {"id": "chatcmpl-BgzcRk92iE2IgmK62QAffdSVh4qLb", "object": "chat.completion", "created": 1749586339, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH max_prob AS (\n    SELECT p.oid, p.probability AS max_probability\n    FROM probability p\n    WHERE p.classifier_name='stamp_classifier' AND p.ranking=1 AND p.class_name='SN'\n),\nfirst_detection AS (\n    SELECT o.oid, o.firstmjd, o.meanra, o.meandec\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nlast_nondetection AS (\n    SELECT d.oid, d.fid, d.mjd, d.magpsf_corr,\n           ROW_NUMBER() OVER (PARTITION BY d.oid, d.fid ORDER BY d.mjd DESC) AS rn\n    FROM detection d\n    WHERE d.isdiffpos=0\n),\nlast_non_det AS (\n    SELECT oid, fid, mjd, magpsf_corr\n    FROM last_nondetection\n    WHERE rn=1\n),\nrise_rates AS (\n    SELECT\n        fd.oid,\n        fd.firstmjd,\n        fd.meanra,\n        fd.meandec,\n        lnd.mjd AS mjd_last_non_det,\n        lnd.magpsf_corr AS mag_last_non_det,\n        (fd.firstmjd - lnd.mjd) AS delta_mjd,\n        (fd.magpsf_corr - lnd.magpsf_corr) / NULLIF((fd.firstmjd - lnd.mjd), 0) AS initial_rise\n    FROM first_detection fd\n    JOIN last_non_det lnd ON fd.oid=lnd.oid AND fd.firstmjd > lnd.mjd\n    WHERE (fd.magpsf_corr - lnd.magpsf_corr) / NULLIF((fd.firstmjd - lnd.mjd), 0) >= 0.25\n),\ndetections AS (\n    SELECT d.oid, d.candid, d.fid, d.mjd, d.magpsf_corr\n    FROM detection d\n    WHERE d.isdiffpos=1\n),\nmagstat_info AS (\n    SELECT m.oid, m.fid AS magstat_fid\n    FROM magstat m\n)\nSELECT\n    mp.oid,\n    mp.max_probability,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,\n    mi.magstat_fid,\n    rr.initial_rise\nFROM rise_rates rr\nJOIN max_prob mp ON rr.oid=mp.oid\nJOIN detections d ON rr.oid=d.oid\nJOIN magstat_info mi ON rr.oid=mi.oid\nORDER BY rr.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3448, "completion_tokens": 548, "total_tokens": 3996, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6867481908865900fce6634ab", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "6dfd0b669875c04e24e197187361012b", "body": {"id": "chatcmpl-BgzbTqmWS9pzXLCos2fKgABHp021b", "object": "chat.completion", "created": 1749586279, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH classified_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.firstmjd <= 58849.5 -- corresponds to 2019-01-01\n      AND o.lastmjd >= 58405.5 -- corresponds to 2022-12-31\n      AND o.ndet > 50\n),\nrise_rates AS (\n    SELECT magstat.oid, magstat.fid, magstat.dmdt_first\n    FROM magstat\n    WHERE magstat.fid IN (1, 2) -- g and r bands\n      AND magstat.dmdt_first > 0.5\n),\ndetections AS (\n    SELECT d.candid, d.oid, d.mjd, d.magpsf, d.sigmapsf, d.fid\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM classified_objects)\n      AND d.mjd BETWEEN 58405.5 AND 58849.5 -- date range for 2019-2022\n      AND d.fid IN (1, 2) -- g and r bands\n)\nSELECT d.oid, d.candid, d.mjd, d.magpsf, d.sigmapsf, d.fid, r.dmdt_first\nFROM detections d\nJOIN rise_rates r ON d.oid = r.oid AND d.fid = r.fid\nWHERE r.dmdt_first > 0.5\nORDER BY d.oid, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3352, "completion_tokens": 371, "total_tokens": 3723, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a696648190b6c82c0b54c9f2e0", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "6a76e5b64db06ead4538d1725a754b26", "body": {"id": "chatcmpl-BgzbThfqhCRd7QdhwNFvONfCChNQb", "object": "chat.completion", "created": 1749586279, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH probability_filtered AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name='lc_classifier'\n      AND class_name='SNII'\n      AND ranking=1\n      AND probability > 0.6\n),\nobject_filtered AS (\n    SELECT o.*\n    FROM object o\n    INNER JOIN probability_filtered pf ON o.oid = pf.oid\n    WHERE o.firstmjd <= 2459580 -- corresponds to Jan 1, 2019\n      AND o.lastmjd >= 2458849 -- corresponds to Dec 31, 2022\n),\ndetection_filtered AS (\n    SELECT d.*\n    FROM detection d\n    INNER JOIN object_filtered o ON d.oid = o.oid\n    WHERE d.mjd BETWEEN 2458849 AND 2459580\n),\ndetection_counts AS (\n    SELECT oid, COUNT(*) AS ndet\n    FROM detection_filtered\n    GROUP BY oid\n),\nobject_with_counts AS (\n    SELECT o.*, dc.ndet\n    FROM object_filtered o\n    INNER JOIN detection_counts dc ON o.oid = dc.oid\n    WHERE dc.ndet > 50\n),\nmagstat_filtered AS (\n    SELECT m.*\n    FROM magstat m\n    INNER JOIN object_with_counts o ON m.oid = o.oid\n    WHERE m.fid IN (1, 2) -- g and r bands\n),\nrise_rates AS (\n    SELECT oid, fid, dmdt_first\n    FROM magstat_filtered\n    WHERE dmdt_first > 0.5\n),\ndetections_with_rise AS (\n    SELECT d.oid, d.candid, d.magpsf, d.sigmapsf, d.mjd, d.fid, r.dmdt_first\n    FROM detection_filtered d\n    INNER JOIN rise_rates r ON d.oid = r.oid AND d.fid = r.fid\n)\nSELECT oid, candid, magpsf, sigmapsf, mjd, fid, dmdt_first\nFROM detections_with_rise\nORDER BY oid, mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3148, "completion_tokens": 430, "total_tokens": 3578, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6a274819088758812e3231f86", "custom_id": "25-0", "response": {"status_code": 200, "request_id": "62ea7119969f65f9453b7bacaa5d08b5", "body": {"id": "chatcmpl-BgzbT06VluWQ87Q6kLSk1euZQFpbM", "object": "chat.completion", "created": 1749586279, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects within 10 degrees of the specified sources and with the specified detection and classification criteria\nSELECT o.*\nFROM object o\n-- Join with probability table to filter by SN probability and classifier details\nINNER JOIN probability p ON p.oid = o.oid\nWHERE\n  -- Spatial filter: within 10 degrees of source 1\n  (q3c_join(o.meanra, o.meandec, 160.18301441363647, 33.0164673528409, 10)\n   OR\n   -- within 10 degrees of source 2\n   q3c_join(o.meanra, o.meandec, 174.21524897555543, 44.83789535222221, 10))\n  -- Temporal filter: first detection within the first 7 days of February\n  AND o.firstmjd BETWEEN 59976.0 AND 59982.0\n  -- Probability filter: SN class with probability > 0.4, ranking=1, classifier 'lc_classifier'\n  AND p.class_name = 'SNIa'\n  AND p.probability > 0.4\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2807, "completion_tokens": 261, "total_tokens": 3068, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6aeec8190ab8743fad672cdd0", "custom_id": "25-1", "response": {"status_code": 200, "request_id": "c9d32f2ae1ec2891144d4b2e286cdfcf", "body": {"id": "chatcmpl-BgzbTfxODkaxfg0QbsiccDhjl0VL2", "object": "chat.completion", "created": 1749586279, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects within 10 degrees of the specified sources, with first detection in the first 7 days of February,\n-- and with SN probabilities > 0.4, ranking=1 in the stamp classifier.\n\nSELECT o.*, p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN probability p_stamp ON o.oid = p_stamp.oid\nWHERE\n  -- Spatial condition for source 1\n  (\n    q3c_join(o.meanra, o.meandec, 160.18301441363647, 33.0164673528409, 10)\n  )\n  OR\n  -- Spatial condition for source 2\n  (\n    q3c_join(o.meanra, o.meandec, 174.21524897555543, 44.83789535222221, 10)\n  )\n  -- Temporal condition: first detection within first 7 days of February\n  AND o.firstmjd >= 59976.0 AND o.firstmjd <= 59982.0\n  -- Probability condition: SN probability > 0.4, class 'SNIa', classifier 'lc_classifier', ranking=1\n  AND p.class_name = 'SNIa'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.4\n  -- Conditions for stamp classifier: ranking=1\n  AND p_stamp.class_name = 'SNIa'\n  AND p_stamp.classifier_name = 'stamp_classifier'\n  AND p_stamp.ranking = 1\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2809, "completion_tokens": 343, "total_tokens": 3152, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6bae0819096c2fb9e63012fa2", "custom_id": "7-0", "response": {"status_code": 200, "request_id": "9a619a67b3c3a5b740bd3d54f005129c", "body": {"id": "chatcmpl-BgzbTafyIfWQSgCZI5UMrTC8kBzoC", "object": "chat.completion", "created": 1749586279, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.oid, p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND o.firstmjd >= 59945.0\n  AND o.firstmjd <= 59975.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2809, "completion_tokens": 85, "total_tokens": 2894, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6c6a081908cf71f6b0fafbc00", "custom_id": "7-1", "response": {"status_code": 200, "request_id": "0b6e2fccc6e7fbd498d67a00005204fc", "body": {"id": "chatcmpl-BgzbTqvl9wOG7SftQK4Kw4j8BsiH1", "object": "chat.completion", "created": 1749586279, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve object identifiers and their probabilities for objects with most likely class 'SN'\n-- detected first in January 2023, according to the stamp classifier with ranking 1\nSELECT o.oid, p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'SN'\n  AND o.firstmjd BETWEEN 59945.0 AND 59975.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2717, "completion_tokens": 113, "total_tokens": 2830, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6d32c8190917b93a77a80c815", "custom_id": "3-0", "response": {"status_code": 200, "request_id": "29fb8abcb6d59e363ccdbdc864938da5", "body": {"id": "chatcmpl-BgzbTxNI0QVgcfNi9KpumylbU6P88", "object": "chat.completion", "created": 1749586279, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'YSO'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.7\n  AND p.ranking = 1\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2560, "completion_tokens": 84, "total_tokens": 2644, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6df548190a92080a3551426ed", "custom_id": "23-0", "response": {"status_code": 200, "request_id": "1f221a78e79b8420a053c44070d76657", "body": {"id": "chatcmpl-BgzbUnFUWnd46mM7LVViBPA1t5y9o", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects that are most likely classified as 'SNIa', 'SNIbc', 'SNII', or 'SLSN' with probability > 0.2\nWITH filtered_probabilities AS (\n    SELECT\n        p.*\n    FROM\n        probability p\n    INNER JOIN\n        object o ON p.oid = o.oid\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.probability > 0.2\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nSELECT\n    o.*,\n    -- Aggregate all classification probabilities for each object into a JSON array\n    (\n        SELECT json_agg(json_build_object(\n            'class_name', p2.class_name,\n            'probability', p2.probability,\n            'ranking', p2.ranking\n        ))\n        FROM probability p2\n        WHERE p2.oid = o.oid\n    ) AS all_classification_probabilities\nFROM\n    object o\nWHERE\n    o.oid IN (\n        SELECT DISTINCT oid FROM filtered_probabilities\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2678, "completion_tokens": 250, "total_tokens": 2928, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6eb808190bb4860c42deeef53", "custom_id": "23-1", "response": {"status_code": 200, "request_id": "5f2328b9e2a9cabd2a7e3ab9a0a85a12", "body": {"id": "chatcmpl-BgzbUCOpKmis6VDNhobs4C1w4XQH4", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with the most likely classification as 'SNIa', 'SNIbc', 'SNII', or 'SLSN' with probability > 0.2\nWITH top_probabilities AS (\n    SELECT p.*\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n      AND p.probability > 0.2\n)\nSELECT o.*, \n       -- Retrieve all classification probabilities for each object\n       (SELECT json_agg(row_to_json(p))\n        FROM probability p\n        WHERE p.oid = o.oid) AS all_probabilities\nFROM object o\nINNER JOIN top_probabilities tp ON o.oid = tp.oid\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2695, "completion_tokens": 184, "total_tokens": 2879, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a6f8108190bbb4fcc31d8f262e", "custom_id": "20-0", "response": {"status_code": 200, "request_id": "c026ee448579334b1028a4ee62db660f", "body": {"id": "chatcmpl-BgzbUyqMZEpGntg9C3tKpI4mpdH58", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from object table for objects classified as RRL with high confidence\nSELECT o.*\nFROM object o\n-- Join with probability table to filter by classification and probability\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'RRL'\n  AND p.probability > 0.55\n  AND p.ranking = 1 -- ensure the most confident classification\n  AND o.ndet >= 100; -- objects with at least 100 detections\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2572, "completion_tokens": 119, "total_tokens": 2691, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a706b08190aee7a2492e4366e3", "custom_id": "20-1", "response": {"status_code": 200, "request_id": "60e4082105f5e83d86ac362b7792ec1e", "body": {"id": "chatcmpl-BgzbUAEK74X27APv7XeLYX8ofNyi9", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as 'RRL' by the 'lc_classifier' with probability > 0.55 and at least 100 detections\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'RRL'\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.probability > 0.55\n  AND o.ndet >= 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2683, "completion_tokens": 104, "total_tokens": 2787, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a7132881908b45482ea1098646", "custom_id": "18-0", "response": {"status_code": 200, "request_id": "fea715951f5d3f3547bc75e09b50d3fb", "body": {"id": "chatcmpl-BgzbUuAlyHEaA7ijTV63wjMw8ueTz", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query for sources classified as AGN with probability > 0.95\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    'lc_classifier' AS classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.95\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n\nUNION\n\n-- Sub-query for sources classified as QSO with probability > 0.95\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    'lc_classifier' AS classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'QSO'\n    AND p.probability > 0.95\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n\nUNION\n\n-- Sub-query for sources classified as Blazar with probability > 0.8\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    'lc_classifier' AS classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'Blazar'\n    AND p.probability > 0.8\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3136, "completion_tokens": 495, "total_tokens": 3631, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a71f308190963313c90d888a00", "custom_id": "18-1", "response": {"status_code": 200, "request_id": "f8fefe31fde3c4570dd8b90d33db1f47", "body": {"id": "chatcmpl-BgzbVt4gNfZVJ3YCsYlnCqgJTywhY", "object": "chat.completion", "created": 1749586281, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query for AGN class with probability > 0.95\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.95\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n\nUNION\n\n-- Sub-query for QSO class with probability > 0.95\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'QSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.95\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n\nUNION\n\n-- Sub-query for Blazar class with probability > 0.8\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'Blazar'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.8\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3109, "completion_tokens": 519, "total_tokens": 3628, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a72fa881908b1be4e7c940a257", "custom_id": "11-0", "response": {"status_code": 200, "request_id": "d40055cdc417fad540410164b24e5c79", "body": {"id": "chatcmpl-BgzbUDKGV1B0gkkDkJyqz1FBf9Upe", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH classified_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    WHERE p.classifier_name='lc_classifier'\n      AND p.ranking=1\n      AND p.class_name='SNIa'\n),\nfirst_detections AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 60188.0 AND 60217.0\n),\npeak_magnitudes AS (\n    SELECT d.oid, d.magpsf AS magmax, d.fid\n    FROM detection d\n    INNER JOIN (\n        SELECT oid, MIN(magpsf) AS min_mag\n        FROM detection\n        GROUP BY oid\n    ) md ON d.oid = md.oid AND d.magpsf = md.min_mag\n),\ng_r_features AS (\n    SELECT oid, g_r_max\n    FROM feature\n    WHERE feature_name='g-r_max'\n),\nfiltered_objects AS (\n    SELECT c.oid, f.g_r_max, p.magmax, p.fid\n    FROM classified_objects c\n    INNER JOIN first_detections fd ON c.oid = fd.oid\n    INNER JOIN peak_magnitudes p ON c.oid = p.oid\n    INNER JOIN g_r_features f ON c.oid = f.oid\n    WHERE p.magmax > 19\n      AND f.g_r_max < 1\n)\nSELECT oid, g_r_max, magmax, fid\nFROM filtered_objects;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3089, "completion_tokens": 316, "total_tokens": 3405, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a73bbc8190999cc2d6d120be7e", "custom_id": "11-1", "response": {"status_code": 200, "request_id": "ce776c89440da854634454b598c21a35", "body": {"id": "chatcmpl-BgzbUKjgX0Ihe9nd4OaxgSIGdrbEG", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects classified as 'SNIa' with highest probability (ranking=1) from the lc_classifier\nSELECT \n    o.oid,\n    f.g_r_max,\n    m.magmax,\n    m.fid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    detection d ON o.oid = d.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nINNER JOIN \n    magstat m ON o.oid = m.oid AND m.magmax = (\n        SELECT MAX(magmax) FROM magstat WHERE oid = o.oid\n    )\nWHERE \n    p.class_name = 'SNIa'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND d.mjd = (\n        SELECT MIN(mjd) FROM detection WHERE oid = o.oid\n    )\n    AND d.mjd BETWEEN 60188.0 AND 60217.0\n    AND f.g_r_max < 1\n    AND m.magmax > 19\nORDER BY \n    o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2874, "completion_tokens": 242, "total_tokens": 3116, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a7481c8190ad4b4177d38f3e1e", "custom_id": "9-0", "response": {"status_code": 200, "request_id": "ef9d605c2cf0f8ddbb39323ba924df62", "body": {"id": "chatcmpl-BgzbUOO5vzl3hj97s1jTNCr9hnUTP", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers and relevant properties for objects detected in July 2023\nSELECT \n    obj.oid,\n    -- Assuming 'value' and 'name' are from the probability table or classification result\n    prob.value,\n    prob.name,\n    prob.version,\n    obj.meanra,\n    obj.meandec,\n    -- Calculate the angular distance from the object to Abell 370 center\n    q3c_dist(obj.meanra, obj.meandec, 39.97, -1.5768) AS dist\nFROM object AS obj\n-- Join with probability table to get the highest probability class for each object\nINNER JOIN (\n    SELECT DISTINCT ON (p.oid)\n        p.oid,\n        p.class_name AS class_name,\n        p.probability,\n        p.value,\n        p.name,\n        p.version\n    FROM probability AS p\n    WHERE p.classifier_name='stamp_classifier' AND p.ranking=1\n    ORDER BY p.oid, p.probability DESC\n) AS prob ON obj.oid = prob.oid\n-- Filter objects detected in July 2023\nWHERE obj.firstmjd >= 60126.0 AND obj.firstmjd <= 60156.0\n-- Filter objects within 16.16667 degrees (1000 arcmin) from Abell 370\nAND q3c_dist(obj.meanra, obj.meandec, 39.97, -1.5768) <= 16.16667\n-- Filter objects with sgscore1 less than 0.3\nAND obj.sgscore1 < 0.3\n-- Exclude objects where the highest probability class is 'asteroid' or 'bogus'\nAND LOWER(prob.class_name) NOT IN ('asteroid', 'bogus');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3123, "completion_tokens": 371, "total_tokens": 3494, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a75970819085d7db0284e66504", "custom_id": "9-1", "response": {"status_code": 200, "request_id": "151db56c13e59c4420f7926ea1677bb4", "body": {"id": "chatcmpl-BgzbUFyaB68YhIXieCyD7o8fjCxVf", "object": "chat.completion", "created": 1749586280, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select object identifiers and relevant information based on user criteria\nSELECT\n    obj.oid,\n    prob.value,\n    prob.name,\n    prob.version,\n    obj.meanra,\n    obj.meandec,\n    obj.oid AS source_identifier,\n    q3c_dist(obj.meanra, obj.meandec, 39.97, -1.5768) AS dist\nFROM\n    object AS obj\nJOIN\n    probability AS prob ON obj.oid = prob.oid\nWHERE\n    -- Filter objects with first detection in July 2023\n    obj.firstmjd BETWEEN 60126.0 AND 60156.0\n    -- Filter objects within 1000 arcmin (16.16667 degrees) from Abell 370 center\n    AND q3c_dist(obj.meanra, obj.meandec, 39.97, -1.5768) <= 16.16667\n    -- Filter objects with sgscore1 < 0.3\n    AND obj.sgscore1 < 0.3\n    -- Only consider the most probable classification (ranking=1) from stamp_classifier\n    AND prob.ranking = 1\n    AND prob.classifier_name = 'stamp_classifier'\n    -- Exclude objects where the highest probability class is 'Asteroid' or 'Bogus'\n    AND prob.name NOT IN ('Asteroid', 'Bogus')\n    -- Ensure the probability corresponds to the maximum value for each object\n    AND prob.value = (\n        SELECT MAX(p2.value)\n        FROM probability p2\n        WHERE p2.oid = obj.oid\n          AND p2.ranking = 1\n          AND p2.classifier_name = 'stamp_classifier'\n    );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3107, "completion_tokens": 359, "total_tokens": 3466, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a766d88190aee58e6c6813959e", "custom_id": "5-0", "response": {"status_code": 200, "request_id": "b5932667b1a73fe8286128a4f709729c", "body": {"id": "chatcmpl-BgzbVjEEY3artyfjrnR8rv6sfOJHg", "object": "chat.completion", "created": 1749586281, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_prob AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name='SNIi'\n      AND classifier_name='lc_classifier'\n      AND ranking=1\n      AND probability > 0.6\n),\nobjects_with_detections AS (\n    SELECT oid\n    FROM detection\n    WHERE oid IN (SELECT oid FROM filtered_prob)\n    GROUP BY oid\n    HAVING COUNT(*) > 50\n),\nmag_range AS (\n    SELECT oid, MAX(magpsf) - MIN(magpsf) AS mag_diff\n    FROM detection\n    WHERE oid IN (SELECT oid FROM objects_with_detections)\n      AND fid=1\n    GROUP BY oid\n    HAVING MAX(magpsf) - MIN(magpsf) > 2\n),\nfinal_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM mag_range)\n)\nSELECT\n    d.oid,\n    d.candid,\n    f.name,\n    f.value,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid AS feature_fid\nFROM detection d\nJOIN final_objects fo ON d.oid = fo.oid\nLEFT JOIN feature f ON d.oid = f.oid\nWHERE d.oid IN (SELECT oid FROM final_objects)\nORDER BY d.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3027, "completion_tokens": 284, "total_tokens": 3311, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a774188190b4de9d61fead49a9", "custom_id": "5-1", "response": {"status_code": 200, "request_id": "5c0dfb8c3c700ac10df5a55e4d212ba7", "body": {"id": "chatcmpl-BgzbVIhynM8W5oOwzggMZSj4QlJ6P", "object": "chat.completion", "created": 1749586281, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH snii_objects AS (\n    -- Select objects classified as SNII with probability > 0.6, ranking 1\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\nobjects_detection_counts AS (\n    -- Count detections per object\n    SELECT o.oid, COUNT(d.candid) AS detection_count\n    FROM object o\n    INNER JOIN detection d ON o.oid = d.oid\n    GROUP BY o.oid\n),\nobjects_with_detection_threshold AS (\n    -- Filter objects with more than 50 detections\n    SELECT o.oid\n    FROM objects_detection_counts o\n    WHERE o.detection_count > 50\n),\ng_band_magnitudes AS (\n    -- For each object, find min and max magpsf in g-band (fid=1)\n    SELECT d.oid,\n           MIN(d.magpsf) AS min_mag,\n           MAX(d.magpsf) AS max_mag\n    FROM detection d\n    WHERE d.fid = 1\n    GROUP BY d.oid\n),\nobjects_with_magnitude_range AS (\n    -- Filter objects where magnitude difference > 2\n    SELECT g.oid\n    FROM g_band_magnitudes g\n    WHERE (g.max_mag - g.min_mag) > 2\n)\n-- Final selection joining all filters\nSELECT\n    o.oid,\n    d.candid,\n    d.mjd,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid AS feature_fid\nFROM snii_objects s\nINNER JOIN objects_with_detection_threshold o ON s.oid = o.oid\nINNER JOIN objects_with_magnitude_range m ON o.oid = m.oid\nINNER JOIN detection d ON o.oid = d.oid\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE d.oid = o.oid\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2920, "completion_tokens": 447, "total_tokens": 3367, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a785088190bfe03acc0807f89f", "custom_id": "0-0", "response": {"status_code": 200, "request_id": "13105569abf5398798635894799f7eb4", "body": {"id": "chatcmpl-BgzbVA1SNSk7zCYwEJ2cf1j2QkFim", "object": "chat.completion", "created": 1749586281, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high YSO probability and relevant features\nSELECT \n    o.oid,\n    p.value AS probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO'\n    AND p.value > 0.7\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND (\n        -- Filter for periodicity features with period between 3 and 10 days\n        (f.name IN ('Multiband_period', 'Period_band') AND f.value BETWEEN 3 AND 10)\n        OR\n        -- Filter for amplitude feature greater than 0.5 mag\n        (f.name = 'Amplitude' AND f.value > 0.5)\n    )\nORDER BY \n    p.value DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2751, "completion_tokens": 212, "total_tokens": 2963, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a7924481908d5eb313c8cd0b00", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "ce78163f777409372deb2d4b8846529a", "body": {"id": "chatcmpl-BgzbVHykpicXpBb2ziKbkp7cZy5ke", "object": "chat.completion", "created": 1749586281, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with high YSO probability and relevant features\nSELECT \n    o.oid,\n    p.probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    -- Filter for YSO classification with probability > 0.7, ranking 1, classifier 'lc_classifier'\n    p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.probability > 0.7\n    -- Filter for features related to period within 3 to 10 days\n    AND f.name IN ('Multiband_period') -- assuming 'Multiband_period' indicates periodicity\n    AND f.value BETWEEN 3 AND 10\n    -- Filter for amplitude greater than 0.5 mag\n    AND f.name = 'Amplitude'\n    AND f.value > 0.5\nORDER BY \n    p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2762, "completion_tokens": 240, "total_tokens": 3002, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a7a11c8190ac127cd9c58fceb5", "custom_id": "38-0", "response": {"status_code": 200, "request_id": "e721a563f32370bd879d3d36f2a90fed", "body": {"id": "chatcmpl-BgzbVPfDPeko7ybamOSrZ9kNCxM6t", "object": "chat.completion", "created": 1749586281, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6\nWITH agn_candidates AS (\n    SELECT o.*\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.classifier_name='lc_classifier'\n      AND p.ranking=1\n      AND p.class_name='AGN'\n      AND p.probability > 0.6\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5\n qso_candidates AS (\n    SELECT o.*\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.classifier_name='lc_classifier'\n      AND p.ranking=1\n      AND p.class_name='QSO'\n      AND p.probability > 0.5\n    ORDER BY p.probability DESC\n    LIMIT 1000\n)\n-- Combine both candidate lists\nSELECT o.*\nFROM (\n    SELECT * FROM agn_candidates\n    UNION ALL\n    SELECT * FROM qso_candidates\n) AS combined\nINNER JOIN object o ON combined.oid = o.oid\n-- Filter objects with detections between 30 and 200\nWHERE o.ndet BETWEEN 30 AND 200\n-- Order by probability descending (using the probability from the probability table)\nORDER BY \n    CASE \n        WHEN class_name='AGN' THEN (SELECT p.probability FROM probability p WHERE p.oid=o.oid AND p.class_name='AGN' AND p.ranking=1 LIMIT 1)\n        WHEN class_name='QSO' THEN (SELECT p.probability FROM probability p WHERE p.oid=o.oid AND p.class_name='QSO' AND p.ranking=1 LIMIT 1)\n        ELSE 0\n    END DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2877, "completion_tokens": 389, "total_tokens": 3266, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a7b72c8190837226f9a86f6b90", "custom_id": "38-1", "response": {"status_code": 200, "request_id": "06b2cd866e7920344bee1b5fcb45117f", "body": {"id": "chatcmpl-BgzbW8V5LgdYNeqvOiWUDKOVkH9mD", "object": "chat.completion", "created": 1749586282, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select top 1000 AGN candidates with probability > 0.6, ranked 1, ordered by probability descending\nWITH top_agn AS (\n    SELECT o.*\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name = 'AGN'\n      AND p.probability > 0.6\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Select top 1000 QSO candidates with probability > 0.5, ranked 1, ordered by probability descending\ntop_qso AS (\n    SELECT o.*\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.class_name = 'QSO'\n      AND p.probability > 0.5\n    ORDER BY p.probability DESC\n    LIMIT 1000\n)\n-- Combine both sets and filter by number of detections between 30 and 200\nSELECT *\nFROM (\n    SELECT * FROM top_agn\n    UNION ALL\n    SELECT * FROM top_qso\n) AS combined_objects\nWHERE ndet BETWEEN 30 AND 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2853, "completion_tokens": 285, "total_tokens": 3138, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a7c44081909a2412a170a9c0ac", "custom_id": "24-0", "response": {"status_code": 200, "request_id": "c82b802ccf554549aaa1a0253797a466", "body": {"id": "chatcmpl-BgzbWvdIbn6xOYbAI95UPJfRykOzb", "object": "chat.completion", "created": 1749586282, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH sources AS (\n    SELECT 'source_1' AS name, 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 'source_2', 174.21524897555543, 44.83789535222221\n),\nobjects_near_sources AS (\n    SELECT o.*, s.name AS source_name\n    FROM sources s\n    INNER JOIN object o\n        ON q3c_join(o.meanra, o.meandec, s.ra, s.dec, 10)\n),\nobjects_with_detection AS (\n    SELECT o.*, d.firstmjd\n    FROM objects_near_sources o\n    INNER JOIN (\n        SELECT oid, MIN(mjd) AS firstmjd\n        FROM detection\n        GROUP BY oid\n    ) d ON o.oid = d.oid\n)\nSELECT *\nFROM objects_with_detection\nWHERE firstmjd BETWEEN 59976.0 AND 59982.0\nORDER BY firstmjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2811, "completion_tokens": 214, "total_tokens": 3025, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a7d20481909912b308d0728207", "custom_id": "24-1", "response": {"status_code": 200, "request_id": "5d503e4eb5e653b46af9c96cf832f139", "body": {"id": "chatcmpl-BgzbWtSCSXqrn9PmTZazo1Pfis8gS", "object": "chat.completion", "created": 1749586282, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH sources AS (\n    SELECT 'source_1' AS source_id, 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 'source_2', 174.21524897555543, 44.83789535222221\n)\nSELECT o.*\nFROM object o\nJOIN sources s ON (\n    -- Spatial condition: within 10 degrees of either source\n    q3c_circle(s.ra, s.dec, 10) @> q3c_point(o.meanra, o.meandec)\n)\nWHERE\n    -- Temporal condition: first detection within first 7 days of February\n    o.firstmjd >= 59976.0 AND o.firstmjd <= 59982.0\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2744, "completion_tokens": 166, "total_tokens": 2910, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a7de5c81908be85269b8350cbd", "custom_id": "31-0", "response": {"status_code": 200, "request_id": "d9dc3bad16cacc146deaf4ac02415537", "body": {"id": "chatcmpl-BgzbWosDxZazZvzOkGTQRuvCaeU24", "object": "chat.completion", "created": 1749586282, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    obj.gal_b, \n    obj.gal_l, \n    feat.*, \n    prob.class_name, \n    obj.oid\nFROM \n    object AS obj\nINNER JOIN \n    probability AS prob ON obj.oid = prob.oid\nINNER JOIN \n    feature AS feat ON obj.oid = feat.oid\nWHERE \n    -- Filter objects first detected between February 1 and 2, 2023 (MJD 59976.0 to 59977.0)\n    obj.firstmjd BETWEEN 59976.0 AND 59977.0\n    -- Filter for the most probable classification by the light curve classifier\n    AND prob.classifier_name = 'lc_classifier'\n    AND prob.ranking = 1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2861, "completion_tokens": 160, "total_tokens": 3021, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891a7f12c8190afe6f35836abe6e0", "custom_id": "31-1", "response": {"status_code": 200, "request_id": "2e02bae703db9b7f88d49d8e5b60608b", "body": {"id": "chatcmpl-BgzbWdta7szE0p9cTbG7RTPh3O2ov", "object": "chat.completion", "created": 1749586282, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.gal_b,\n    o.gal_l,\n    o.firstmjd,\n    f.*,  -- select all feature columns\n    p.class_name,\n    o.oid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.firstmjd BETWEEN 59976.0 AND 59977.0\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2824, "completion_tokens": 120, "total_tokens": 2944, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a7fc048190a8de04456c573365", "custom_id": "6-0", "response": {"status_code": 200, "request_id": "e10799e4b3eb4137e9945a2593694c98", "body": {"id": "chatcmpl-BgzbXXDxfg5uyQ788lZRmRyZ11Siz", "object": "chat.completion", "created": 1749586283, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter probability table for SNII with probability > 0.6, ranking=1, classifier='lc_classifier'\nWITH snii_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n),\n\n-- Step 2: Filter objects with detections in date range 2019-2022\nobjects_in_time_range AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd >= 58484.0 AND o.lastmjd <= 59944.0\n),\n\n-- Step 3: Find objects with initial rise rate > 0.5 mag/day in g and r bands\nrise_rates AS (\n    SELECT\n        d.oid,\n        -- For g-band (fid=1)\n        MIN(d.mjd) FILTER (WHERE d.fid=1) AS g_first_mjd,\n        MAX(d.mjd) FILTER (WHERE d.fid=1) AS g_last_mjd,\n        MIN(d.magpsf) FILTER (WHERE d.fid=1) AS g_first_mag,\n        MAX(d.magpsf) FILTER (WHERE d.fid=1) AS g_last_mag,\n        -- For r-band (fid=2)\n        MIN(d.mjd) FILTER (WHERE d.fid=2) AS r_first_mjd,\n        MAX(d.mjd) FILTER (WHERE d.fid=2) AS r_last_mjd,\n        MIN(d.magpsf) FILTER (WHERE d.fid=2) AS r_first_mag,\n        MAX(d.magpsf) FILTER (WHERE d.fid=2) AS r_last_mag\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM snii_objects)\n      AND d.mjd BETWEEN 58484.0 AND 59944.0\n    GROUP BY d.oid\n),\nrise_rate_calc AS (\n    SELECT\n        oid,\n        -- Calculate rise rate in g-band\n        CASE WHEN (g_last_mjd - g_first_mjd) > 0 THEN\n            (g_last_mag - g_first_mag) / (g_last_mjd - g_first_mjd)\n        ELSE NULL END AS g_rise_rate,\n        -- Calculate rise rate in r-band\n        CASE WHEN (r_last_mjd - r_first_mjd) > 0 THEN\n            (r_last_mag - r_first_mag) / (r_last_mjd - r_first_mjd)\n        ELSE NULL END AS r_rise_rate\n    FROM rise_rates\n),\nobjects_with_rise AS (\n    SELECT oid\n    FROM rise_rate_calc\n    WHERE g_rise_rate > 0.5 AND r_rise_rate > 0.5\n),\n\n-- Step 4: Filter objects with at least 100 days of observations in r-band\nr_band_observation_span AS (\n    SELECT\n        d.oid,\n        (MAX(d.mjd) FILTER (WHERE d.fid=2) - MIN(d.mjd) FILTER (WHERE d.fid=2)) AS r_obs_span,\n        COUNT(*) FILTER (WHERE d.fid=2) AS r_detection_count\n    FROM detection d\n    WHERE d.oid IN (SELECT oid FROM objects_with_rise)\n    GROUP BY d.oid\n),\nobjects_with_observations AS (\n    SELECT oid\n    FROM r_band_observation_span\n    WHERE r_obs_span >= 100 AND r_detection_count > 30\n)\n\n-- Final step: Retrieve detection data for objects meeting all criteria\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid AS f_id,\n    d.mjd\nFROM detection d\nWHERE d.oid IN (\n    SELECT oid FROM snii_objects\n    INTERSECT\n    SELECT oid FROM objects_in_time_range\n    INTERSECT\n    SELECT oid FROM objects_with_rise\n    INTERSECT\n    SELECT oid FROM objects_with_observations\n)\n  AND d.mjd BETWEEN 58484.0 AND 59944.0\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3325, "completion_tokens": 886, "total_tokens": 4211, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891a806d88190b50300599bb7f544", "custom_id": "6-1", "response": {"status_code": 200, "request_id": "99e9b025b608a8cecd0e80064b1e4013", "body": {"id": "chatcmpl-BgzbXGAEJCYr6e50U3FhLzwLFecya", "object": "chat.completion", "created": 1749586283, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter probability table for SN II with specified conditions\nWITH snii_prob AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNII'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.6\n),\n\n-- Step 2: Select objects that meet the initial rise rate > 0.5 mag/day in g and r bands\ninitial_rise AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM (\n            SELECT d.oid, d.fid, d.mjd, d.magpsf\n            FROM detection d\n            WHERE d.oid = o.oid AND d.mjd BETWEEN 58484.0 AND 59944.0\n        ) detections\n        WHERE detections.fid IN (1, 2) -- g and r bands\n        GROUP BY detections.oid, detections.fid\n        HAVING\n            -- Calculate initial rise rate for each band\n            -- Find first detection\n            MIN(detections.mjd) AS first_mjd,\n            -- Find first detection magnitude\n            FIRST_VALUE(detections.magpsf) OVER (PARTITION BY detections.oid, detections.fid ORDER BY detections.mjd) AS first_mag,\n            -- Find last detection\n            MAX(detections.mjd) AS last_mjd,\n            -- Find last detection magnitude\n            LAST_VALUE(detections.magpsf) OVER (PARTITION BY detections.oid, detections.fid ORDER BY detections.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_mag\n        HAVING\n            -- Compute rise rate: (mag_last - mag_first) / (mjd_last - mjd_first)\n            (LAST_VALUE(detections.magpsf) OVER (PARTITION BY detections.oid, detections.fid ORDER BY detections.mjd ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) - FIRST_VALUE(detections.magpsf) OVER (PARTITION BY detections.oid, detections.fid ORDER BY detections.mjd))\n            / (LAST_VALUE(detections.mjd) OVER (PARTITION BY detections.oid, detections.fid ORDER BY detections.mjd) - FIRST_VALUE(detections.mjd) OVER (PARTITION BY detections.oid, detections.fid ORDER BY detections.mjd))\n            > 0.5\n    )\n    GROUP BY o.oid\n    HAVING COUNT(DISTINCT CASE WHEN detections.fid = 2 THEN detections.mjd END) >= 100 -- at least 100 days in r-band\n       AND COUNT(detections.oid) > 30 -- total detections > 30\n),\n\n-- Step 3: Select detections for objects passing all filters\ndetections_filtered AS (\n    SELECT d.oid, d.candid, d.magpsf, d.sigmapsf, d.fid AS f_id, d.mjd\n    FROM detection d\n    INNER JOIN snii_prob p ON d.oid = p.oid\n    INNER JOIN initial_rise ir ON d.oid = ir.oid\n    WHERE d.mjd BETWEEN 58484.0 AND 59944.0\n)\n\n-- Final output: detections as a function of time for selected objects\nSELECT\n    d.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    d.f_id,\n    d.mjd\nFROM detections_filtered d\nORDER BY d.oid, d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3373, "completion_tokens": 786, "total_tokens": 4159, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891aa4ae881908b2f0149db7157eb", "custom_id": "21-0", "response": {"status_code": 200, "request_id": "fd5fbbcd89bb5dfaf776d2ea14c71564", "body": {"id": "chatcmpl-BgzbXosMXiqnaWZThrddEm9daupv1", "object": "chat.completion", "created": 1749586283, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from the object table for sources classified as AGN, QSO, or Blazar\nSELECT o.*\nFROM object o\n-- Join with probability table to filter by classification and probability\nINNER JOIN probability p ON o.oid = p.oid\nWHERE\n    -- Filter for the most likely classification by the lc_classifier with ranking 1\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    -- Filter for class names AGN, QSO, or Blazar\n    AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n    -- Filter for probability higher than 0.5\n    AND p.probability > 0.5\n    -- Filter objects with at least 30 detections\n    AND o.ndet >= 30\n    -- Filter objects with a time span between first and last detection of at least 200 days\n    AND (o.lastmjd - o.firstmjd) >= 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2735, "completion_tokens": 211, "total_tokens": 2946, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891aa56d88190bdcfde3290c018ec", "custom_id": "21-1", "response": {"status_code": 200, "request_id": "d2df9b796de10a85f0c36969f9b08164", "body": {"id": "chatcmpl-BgzbXrRubBGDXPirtPhHLkuxEW7td", "object": "chat.completion", "created": 1749586283, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select sources classified as AGN, QSO, or Blazar with specified conditions\nSELECT o.*, p.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n  AND p.probability > 0.5\n  AND o.ndet >= 30\n  AND (o.lastmjd - o.firstmjd) >= 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2745, "completion_tokens": 118, "total_tokens": 2863, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891aa640c81908e2eb83d0b8c71c7", "custom_id": "26-0", "response": {"status_code": 200, "request_id": "afe644b360a9bacd6ad78088f08c33cb", "body": {"id": "chatcmpl-BgzbXGx0GZLf5m7csboalZbe85mPH", "object": "chat.completion", "created": 1749586283, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects that appeared between August 25 and September 10, 2022\n-- and are classified as 'SNIa' with probability > 0.5 and ranking=1\n-- or have more than one detection\n\nSELECT o.*\nFROM object o\nLEFT JOIN probability p ON o.oid = p.oid\nWHERE (\n    -- Classification as 'SNIa' with probability > 0.5, classifier 'lc_classifier', ranking=1\n    (p.class_name = 'SNIa' AND p.probability > 0.5 AND p.classifier_name = 'lc_classifier' AND p.ranking = 1)\n    OR\n    -- More than one detection\n    o.ndet > 1\n)\nAND (\n    -- Object appeared within the date range\n    o.firstmjd <= 59832.0 AND o.lastmjd >= 59816.0\n)\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2975, "completion_tokens": 193, "total_tokens": 3168, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891aa710881909df3dc73d202188c", "custom_id": "26-1", "response": {"status_code": 200, "request_id": "d8a07f3aee12f63d2b36d0ace506af7f", "body": {"id": "chatcmpl-BgzbXngIghgAGYQpDoOr4bTNMtSxf", "object": "chat.completion", "created": 1749586283, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects that appeared between August 25, 2022 (MJD 59816.0) and September 10, 2022 (MJD 59832.0)\n-- and either are classified as supernovae with probability > 0.5 by the stamp classifier (ranking=1)\n-- or have more than one detection (ndet > 1)\n\nSELECT o.*\nFROM object o\n-- Join with probability table to filter for supernova classification\nINNER JOIN probability p ON o.oid = p.oid\n-- Join with detection table to filter for detections within the date range\nINNER JOIN detection d ON o.oid = d.oid\nWHERE\n  -- Filter detections within the specified MJDs\n  d.mjd BETWEEN 59816.0 AND 59832.0\n  -- Filter for most probable supernova classification with probability > 0.5\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.probability > 0.5\n  AND p.ranking = 1\n  -- Ensure objects with more than one detection or classified as supernova\n  AND (\n    o.ndet > 1\n    OR\n    -- Additional condition to include objects classified as supernovae\n    (p.class_name = 'SN' AND p.probability > 0.5 AND p.ranking = 1)\n  )\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2914, "completion_tokens": 301, "total_tokens": 3215, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891aa7d80819099c29b65811165d7", "custom_id": "109-0", "response": {"status_code": 200, "request_id": "d4e79e02a023d51c645c016c382b8af1", "body": {"id": "chatcmpl-BgzbXhoXUtV1qoD3tOyWP0z1tvJ0m", "object": "chat.completion", "created": 1749586283, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM object o\n-- Filter objects with detection span greater than 1 day\nWHERE (o.lastmjd - o.firstmjd) > 1\n-- Join with feature table to get 'LinearTrend' feature with value > 5\nINNER JOIN feature f ON o.oid = f.oid\nWHERE f.name = 'LinearTrend' AND f.value > 5\n-- Join with probability table to get classification at ranking 1 and classifier 'lc_classifier'\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier' AND p.ranking = 1\n-- Limit to 10 results\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2706, "completion_tokens": 197, "total_tokens": 2903, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891aa8f688190a07ec83932f7afe5", "custom_id": "109-1", "response": {"status_code": 200, "request_id": "da434e2323dbae35ab87609310f3e469", "body": {"id": "chatcmpl-BgzbXY7ZLFRqTeNf6dxDJC8ihd2KE", "object": "chat.completion", "created": 1749586283, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    f.value AS LinearTrend_value,\n    f.fid AS filter_id\nFROM \n    object o\nINNER JOIN \n    feature f ON o.oid = f.oid\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.lastmjd - o.firstmjd > 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\nORDER BY \n    f.value DESC\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2710, "completion_tokens": 160, "total_tokens": 2870, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891aa9be081908036f549f53f4afb", "custom_id": "49-1", "response": {"status_code": 200, "request_id": "3e24a10bf9ed4777407ee9a1e6d9645a", "body": {"id": "chatcmpl-BgzbYeWojlyRFPRKS61B6Cy5vKF6Y", "object": "chat.completion", "created": 1749586284, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM feature\nWHERE oid IN (\n    SELECT oid FROM object WHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n)\nAND fid = 1; -- fid=1 corresponds to the g band\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2629, "completion_tokens": 56, "total_tokens": 2685, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891aac21c8190aeaef46306712dc8", "custom_id": "93-0", "response": {"status_code": 200, "request_id": "04e48dda73c6963cb099873712772cc1", "body": {"id": "chatcmpl-BgzbYclZmjBYIscDnKpvwg1k3AdZA", "object": "chat.completion", "created": 1749586284, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*, m.*\nFROM probability p\nINNER JOIN magstat m ON p.oid = m.oid\nWHERE p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2707, "completion_tokens": 74, "total_tokens": 2781, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891aad19c8190bf30f14627417618", "custom_id": "93-1", "response": {"status_code": 200, "request_id": "8b58ea2f01fd43426c52b27c795cc7ed", "body": {"id": "chatcmpl-BgzbY7NLRe3FWIfRticGLi7RXGi1I", "object": "chat.completion", "created": 1749586284, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*, m.*\nFROM probability p\nINNER JOIN magstat m ON p.oid = m.oid\nWHERE p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\n  AND m.corrected = TRUE\nORDER BY p.oid\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2775, "completion_tokens": 74, "total_tokens": 2849, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891aae18481908d0341653f0c92b0", "custom_id": "95-0", "response": {"status_code": 200, "request_id": "1e03f180853de6ca2dd747d0887b0790", "body": {"id": "chatcmpl-BgzbYQKuWvdUN7Jsqy0rxrHA6NtYN", "object": "chat.completion", "created": 1749586284, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Define the list of ZTF object identifiers of interest\nWITH ztf_objects AS (\n    SELECT 'ZTF19aazhdoy' AS oid\n    UNION ALL\n    SELECT 'ZTF17aaaqqtd'\n),\n-- Select relevant features for these objects with specified names and version\nfeatures AS (\n    SELECT f.oid, f.name, f.value\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM ztf_objects)\n      AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n      AND f.version = 'lc_classifier_1.2.1-P'\n),\n-- Retrieve all matches from 'xmatch' for these objects\nmatches AS (\n    SELECT x.oid, x.oid_catalog, x.dist, x.class\n    FROM xmatch x\n    WHERE x.oid IN (SELECT oid FROM ztf_objects)\n)\n-- Join features with matches to include catalog info and sort accordingly\nSELECT \n    m.oid AS ztf_identifier,\n    m.oid_catalog AS catalog_identifier,\n    m.dist AS distance,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM matches m\nJOIN features f ON m.oid = f.oid\nORDER BY m.oid_catalog, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2768, "completion_tokens": 269, "total_tokens": 3037, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891aaee04819091d6917b91d63a7b", "custom_id": "95-1", "response": {"status_code": 200, "request_id": "b692f07a8a362ffedab2520fa7a748c9", "body": {"id": "chatcmpl-BgzbYLCpYH78purp6O9IHQnqQnHMl", "object": "chat.completion", "created": 1749586284, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve all matches from 'xmatch' for the specified ZTF objects\nWITH ztf_objects AS (\n    SELECT 'ZTF19aazhdoy' AS oid\n    UNION ALL\n    SELECT 'ZTF17aaaqqtd'\n),\nmatches AS (\n    SELECT xm.oid, xm.catid, xm.dist\n    FROM xmatch xm\n    INNER JOIN ztf_objects zo ON xm.oid = zo.oid\n),\n-- Retrieve features 'W1-W2', 'g-W2', 'r-W2' with specific version for these objects\nfeatures AS (\n    SELECT f.oid, f.name, f.value\n    FROM feature f\n    WHERE f.oid IN (SELECT oid FROM ztf_objects)\n      AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n      AND f.version = 'lc_classifier_1.2.1-P'\n)\n-- Join matches with features on object ID, and include feature name and value\nSELECT \n    m.oid AS ztf_object_id,\n    m.catid AS catalog_object_id,\n    m.dist AS distance,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM matches m\nINNER JOIN features f ON m.oid = f.oid\nORDER BY m.catid, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2744, "completion_tokens": 275, "total_tokens": 3019, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891aafa948190a646e81136e4d155", "custom_id": "85-0", "response": {"status_code": 200, "request_id": "afa55c4e71ea467ebfd24ccc412117c5", "body": {"id": "chatcmpl-BgzbZujSJ88CRYvuL7cB9sEMbrL3b", "object": "chat.completion", "created": 1749586285, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS uncertainty,\n    dq.*\nFROM detection d\nINNER JOIN dataquality dq ON d.candid = dq.candid\nWHERE dq.oid = 'ZTF20actqnhg'\nORDER BY d.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2576, "completion_tokens": 80, "total_tokens": 2656, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ab07748190be7766bb0b4816f3", "custom_id": "85-1", "response": {"status_code": 200, "request_id": "9d878340dd0bb1b94c0795fdb6b95936", "body": {"id": "chatcmpl-BgzbZ9EeS9c1URvTWWoiM6je7QrhF", "object": "chat.completion", "created": 1749586285, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.mjd AS detection_date,\n    d.isdiffpos,\n    d.magpsf AS difference_magnitude,\n    d.sigmapsf AS uncertainty,\n    dq.*\nFROM \n    detection d\nINNER JOIN \n    object o ON d.oid = o.oid\nLEFT JOIN \n    dataquality dq ON d.candid = dq.candid\nWHERE \n    o.oid = 'ZTF20actqnhg'\nORDER BY \n    d.mjd ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2604, "completion_tokens": 103, "total_tokens": 2707, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891ab14dc81908b44ef6d77622d81", "custom_id": "98-0", "response": {"status_code": 200, "request_id": "dfb9432f5e70bf64a2d2d77b37c297c0", "body": {"id": "chatcmpl-BgzbZq2dUUTB70aLARBu8sBSNETtt", "object": "chat.completion", "created": 1749586285, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH high_prob_qso AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n      AND p.class_name = 'QSO'\n    LIMIT 200\n)\nSELECT xm.*, aw.*\nFROM high_prob_qso hpq\nINNER JOIN xmatch xm ON xm.oid = hpq.oid\nINNER JOIN allwise aw ON aw.oid_catalog = xm.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2839, "completion_tokens": 128, "total_tokens": 2967, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ab21d08190927f968c5097743e", "custom_id": "98-1", "response": {"status_code": 200, "request_id": "46b52b51c52362e3cb0cdd05cc8fc797", "body": {"id": "chatcmpl-BgzbZHUOsAcchPCIhgSOevAv4cUNz", "object": "chat.completion", "created": 1749586285, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 200 objects with the highest probability (>0.7) of being a QSO according to the lc_classifier\nWITH top_qso_objects AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND probability > 0.7\n      AND ranking = 1\n    LIMIT 200\n)\n-- Retrieve all columns from xmatch for these objects\nSELECT xm.*\nFROM xmatch xm\nJOIN top_qso_objects tqo ON xm.oid = tqo.oid;\n\n-- Retrieve all columns from allwise for these objects\nSELECT aw.*\nFROM allwise aw\nJOIN top_qso_objects tqo ON aw.oid = tqo.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2702, "completion_tokens": 150, "total_tokens": 2852, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ab2efc81909bc9399892044622", "custom_id": "87-0", "response": {"status_code": 200, "request_id": "591d62bdad30d555bf1af0928777eb3f", "body": {"id": "chatcmpl-BgzbZGNFnGQFQF9hRyUWpNiLjQfIU", "object": "chat.completion", "created": 1749586285, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM probability\nINNER JOIN gaia_ztf ON probability.oid = gaia_ztf.oid\nWHERE probability.ranking = 1\n  AND probability.classifier_name = 'lc_classifier'\n  AND probability.classifier_version = 'hierarchical_rf_1.1.0'\n  AND probability.class_name IN ('LPV', 'E')\n  AND probability.probability > 0.7\n  AND gaia_ztf.unique1 = TRUE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2884, "completion_tokens": 107, "total_tokens": 2991, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ab3cf881909ea9dc233f220d8a", "custom_id": "87-1", "response": {"status_code": 200, "request_id": "89d7affa3042b952e33b7c38d3ab9c99", "body": {"id": "chatcmpl-BgzbZceARYolNn8GjIP2RmwSYTAlf", "object": "chat.completion", "created": 1749586285, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*, g.*\nFROM (\n    -- Select probability entries with specified classifier, ranking, probability threshold, and class\n    SELECT *\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n      AND ranking = 1\n      AND probability > 0.7\n      AND class_name IN ('LPV', 'E')\n) p\nINNER JOIN gaia_ztf g ON p.oid = g.oid\nWHERE g.unique1 = true\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2633, "completion_tokens": 119, "total_tokens": 2752, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891ab50788190a45805d3e3396b3b", "custom_id": "108-0", "response": {"status_code": 200, "request_id": "46bbacd803710d08513100df16d96577", "body": {"id": "chatcmpl-BgzbZHOmhfYoc4rFEi5ZF3uzmjYxJ", "object": "chat.completion", "created": 1749586285, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\", \n    o.ndet AS \"number of detections\", \n    p.probability, \n    o.gal_b\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.ndet > 20\n    AND p.probability > 0.9\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'bogus'\nORDER BY \n    o.oid\nLIMIT 15;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2733, "completion_tokens": 135, "total_tokens": 2868, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ab5c7481909071b3f59982de7e", "custom_id": "108-1", "response": {"status_code": 200, "request_id": "3f56d54560a7e737d79a1c18b2a45168", "body": {"id": "chatcmpl-BgzbayLCE6A1FcBza8TM72ZyejInt", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select the object identifier, number of detections, probability, and galactic latitude\nSELECT \n    o.oid AS ztf_identifier,\n    o.ndet AS number_of_detections,\n    p.probability,\n    o.meandec AS gal_b\nFROM object o\n-- Join with probability table to get classification probabilities\nINNER JOIN probability p ON o.oid = p.oid\n-- Join with stamp_classifier table to filter for bogus classifications\nINNER JOIN stamp_classifier sc ON o.oid = sc.oid\nWHERE \n    -- Filter for objects with more than 20 detections\n    o.ndet > 20\n    -- Filter for probability greater than 0.9\n    AND p.probability > 0.9\n    -- Filter for classifier name and version\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    -- Filter for the most likely classification\n    AND p.ranking = 1\n    -- Filter for objects classified as bogus\n    AND sc.class_name = 'bogus'\n    -- Ensure the classification is from the same object\n    AND o.oid = sc.oid\nORDER BY o.oid\nLIMIT 15;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2873, "completion_tokens": 264, "total_tokens": 3137, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ab688081909a6f477ece98e791", "custom_id": "101-1", "response": {"status_code": 200, "request_id": "e678526daa483e4ad30f41de655d035b", "body": {"id": "chatcmpl-BgzbaqafARDIPfcmc2rAGMETXLbTb", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*, x.*, w.*\nFROM probability p\nINNER JOIN xmatch x ON p.oid = x.oid\nINNER JOIN allwise w ON p.oid = w.oid_catalog\nWHERE p.classifier_name='lc_classifier'\n  AND p.class_name='LPV'\n  AND p.probability > 0.5\n  AND p.ranking=1\n  AND w.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2823, "completion_tokens": 100, "total_tokens": 2923, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ab79488190a1bdd679651b6903", "custom_id": "88-0", "response": {"status_code": 200, "request_id": "2f17631b8c9b83515b0544f28ecf0888", "body": {"id": "chatcmpl-Bgzbar5Yh4qx7Aa0dQVbmHFqUM4je", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    p.classifier_version,\n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name='stamp_classifier'\n    AND p.class_name='bogus'\n    AND p.ranking=1\n    AND o.ndet >= 20\nORDER BY \n    p.probability DESC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2674, "completion_tokens": 111, "total_tokens": 2785, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891ab846881908c82d504d6bcd41b", "custom_id": "88-1", "response": {"status_code": 200, "request_id": "5bc0c4dda694017a8962fffed4522511", "body": {"id": "chatcmpl-Bgzba9FbW5I50MPL44xdZalwJDgag", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    o.meanra, \n    o.meandec, \n    p.classifier_version, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'bogus'\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND o.ndet >= 20\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2892, "completion_tokens": 109, "total_tokens": 3001, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ab8f54819090dce897df7ada93", "custom_id": "105-0", "response": {"status_code": 200, "request_id": "fcdec344f98f6bec8b4cd9fcfd0ae77c", "body": {"id": "chatcmpl-Bgzbb2XEf73mXKmZuGJMUX3NKME1Z", "object": "chat.completion", "created": 1749586287, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH probability_filtered AS (\n    SELECT o.oid, p.probability\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.ranking = 1\n      AND p.probability > 0.7\n),\nspatial_filtered AS (\n    SELECT pf.oid, xm.catid AS objectidps1, xm.dist, ps1.sgscore1\n    FROM probability_filtered pf\n    INNER JOIN xmatch xm ON pf.oid = xm.oid\n    INNER JOIN ps1_ztf ps1 ON xm.catid = ps1.objectid\n    WHERE xm.dist < 2\n),\nscore_diff_filtered AS (\n    SELECT sf.oid, sf.objectidps1, sf.dist, sf.sgscore1, se.candid, se.fid, se.dsnrms, se.seeratio\n    FROM spatial_filtered sf\n    INNER JOIN dataquality se ON sf.oid = se.oid AND se.fid IN (1, 2, 3)\n    WHERE ABS(sf.sgscore1 - se.clrcoeff) < 0.5\n),\nepoch_data AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.fid,\n        d.sigmara,\n        d.seeratio\n    FROM score_diff_filtered s\n    INNER JOIN dataquality d ON s.oid = d.oid AND d.candid = (\n        SELECT candid FROM dataquality WHERE oid = d.oid ORDER BY dsnrms DESC LIMIT 1\n    )\n)\nSELECT\n    p.oid,\n    p.probability,\n    e.candid,\n    e.fid,\n    e.sigmara,\n    e.seeratio,\n    s.objectidps1,\n    s.sgscore1,\n    s.dist\nFROM probability_filtered p\nINNER JOIN epoch_data e ON p.oid = e.oid\nINNER JOIN score_diff_filtered s ON p.oid = s.oid\nORDER BY p.probability DESC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3305, "completion_tokens": 462, "total_tokens": 3767, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_eede8f0d45"}}, "error": null}
{"id": "batch_req_684891ab9b6081909318de9a5ef60644", "custom_id": "105-1", "response": {"status_code": 200, "request_id": "69ce52e29d1890779eacf9192c9cc721", "body": {"id": "chatcmpl-BgzbaWmIMvwgBz8imkqsLjjJZQw1E", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select up to 50 ZTF objects with specified conditions\nSELECT\n    o.oid AS ztf_object_id,\n    p.probability,\n    -- Epoch-specific features\n    f.candid,\n    f.fid,\n    f.seeratio AS reduced_chi_square,\n    f.classtar AS sextractor_sgscore,\n    -- PS1 source info\n    ps1.oid AS ps1_source_id,\n    ps1.sgscore1 AS ps1_sgscore,\n    ps1.distpsnr1 AS distance_ps1\nFROM\n    object o\nINNER JOIN\n    probability p ON o.oid = p.oid\nINNER JOIN\n    ps1_ztf ps1 ON o.oid = ps1.oid\nINNER JOIN\n    feature f ON o.oid = f.oid\nWHERE\n    -- Probability conditions\n    p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = 'hierarchical_rf_1.1.0'\n    AND p.probability > 0.7\n    AND p.ranking = 1\n    -- Spatial proximity condition\n    AND ps1.distpsnr1 < 2\n    -- Star/galaxy score difference condition\n    AND ABS(ps1.sgscore1 - f.classtar) < 0.5\nORDER BY\n    p.probability DESC\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2911, "completion_tokens": 301, "total_tokens": 3212, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891aba86c8190b707d6aac34eeacb", "custom_id": "86-0", "response": {"status_code": 200, "request_id": "e87a9df59eb4c2f9a29b11cb76e44547", "body": {"id": "chatcmpl-Bgzbal8Wn9tKkNXS6camDmZTzwyeW", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select all columns from probability and ps1_ztf tables\nSELECT p.*, z.*\nFROM probability p\nINNER JOIN ps1_ztf z ON p.oid = z.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.6\n  AND p.ranking = 1\n  AND p.class_name IN ('Cepheid', 'DSCT', 'RRL')\n  AND z.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2784, "completion_tokens": 127, "total_tokens": 2911, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891abb714819092c8030f2d409dd5", "custom_id": "86-1", "response": {"status_code": 200, "request_id": "aa7750addd1d34f7b3d522438a413e9e", "body": {"id": "chatcmpl-BgzbaHrj5mAQUa2udRAghDYT4RYtC", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT p.*, z.*\nFROM probability p\nINNER JOIN ps1_ztf z ON p.oid = z.oid\nWHERE p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND p.probability > 0.6\n  AND p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.ranking = 1\n  AND z.sgscore1 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2779, "completion_tokens": 112, "total_tokens": 2891, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891abc3508190836e80552da28442", "custom_id": "41-0", "response": {"status_code": 200, "request_id": "27db3d6188a393e187fba8754ab798a8", "body": {"id": "chatcmpl-BgzbaGNCm0pEtH2v3jQJMto65msMf", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0/3600 AS r_deg\n    UNION ALL\n    SELECT 'id_2' AS id, 139.01 AS ra, 41.5653 AS dec, 10.0/3600 AS r_deg\n)\nSELECT\n    'ALLWISE' AS identifier,\n    ao.oid_catalog,\n    ao.ra,\n    ao.dec,\n    ao.w1mpro,\n    ao.w1sigmpro,\n    io.id AS input_id,\n    io.ra AS obj_ra,\n    io.dec AS obj_dec,\n    io.r_deg\nFROM\n    input_objects io\nJOIN\n    allwise ao\nON\n    (q3c_radial_query(ao.ra, ao.dec, io.ra, io.dec, io.r_deg))\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2789, "completion_tokens": 191, "total_tokens": 2980, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_38343a2f8f"}}, "error": null}
{"id": "batch_req_684891abd0cc8190a61e0a3f1646d674", "custom_id": "41-1", "response": {"status_code": 200, "request_id": "06e1afc97d9d1e7a73bba29bf1a0067c", "body": {"id": "chatcmpl-BgzbaACOqfwrQpu3f8NIJOqfO67ac", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    -- Define the input objects with their coordinates and search radii in degrees\n    SELECT 'id_1' AS id, 132.961 AS ra, 41.397 AS dec, 5.0 / 3600 AS r_deg\n    UNION ALL\n    SELECT 'id_2' AS id, 139.01 AS ra, 41.5653 AS dec, 10.0 / 3600 AS r_deg\n),\nallwise_matches AS (\n    SELECT\n        io.id AS input_id,\n        io.ra AS obj_ra,\n        io.dec AS obj_dec,\n        io.r_deg,\n        aw.oid_catalog,\n        aw.ra,\n        aw.dec,\n        aw.w1mpro,\n        aw.w1sigmpro\n    FROM\n        input_objects io\n    -- Join with allwise objects within the specified radius using q3c_join\n    JOIN\n        allwise aw ON q3c_join(aw.ra, aw.dec, io.ra, io.dec, io.r_deg)\n)\nSELECT\n    input_id AS \"id\",\n    obj_ra,\n    obj_dec,\n    r_deg,\n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro\nFROM\n    allwise_matches;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2902, "completion_tokens": 272, "total_tokens": 3174, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891abdd748190aaad8d4cd8fccff6", "custom_id": "74-0", "response": {"status_code": 200, "request_id": "0c835ee6a1ad66aff7ed45f193351502", "body": {"id": "chatcmpl-Bgzba1SQ4xLLFKEmSH0G4rr8eDkTv", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve ZTF object ID, MPC object identifier, and MPC magnitude for specified ZTF objects\nSELECT \n    z.oid AS ztf_object_id,\n    m.ssnamenr AS mpc_object_id,\n    m.ssmagnr AS mpc_magnitude\nFROM \n    ss_ztf z\nJOIN \n    mpc_objects m ON z.oid = m.oid -- Assuming 'mpc_objects' table exists with relevant MPC data\nWHERE \n    z.oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n    AND m.ssmagnr < 19.2 -- Brightness filter: magnitude less than 19.2\nORDER BY \n    m.ssmagnr DESC; -- Sort by MPC magnitude in descending order\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2810, "completion_tokens": 176, "total_tokens": 2986, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891abe9848190b92eb2aa024bb404", "custom_id": "74-1", "response": {"status_code": 200, "request_id": "2512683bd7beb9b8650110570d478086", "body": {"id": "chatcmpl-BgzbaspJEWS1gJQNKP6cyt4d1dQ89", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    ss_ztf.oid AS ztf_identifier,\n    ss_ztf.ssnamenr AS mpc_identifier,\n    ss_ztf.ssmagnr AS mpc_magnitude\nFROM \n    ss_ztf\nWHERE \n    ss_ztf.oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n    AND ss_ztf.ssmagnr < 19.2\nORDER BY \n    ss_ztf.ssmagnr DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2621, "completion_tokens": 121, "total_tokens": 2742, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891abf5ac8190942a4b9db0f08374", "custom_id": "97-0", "response": {"status_code": 200, "request_id": "f3534790becf252963c4b9012c7be315", "body": {"id": "chatcmpl-BgzbabGXm06dPgpnVzxhJ36rw8H8Z", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Select objects with specified classification probabilities from probability table\nSELECT \n    o.oid, \n    p_agn.probability AS prob_stamp_agn, \n    p_lpv.probability AS prob_lc_lpv\nFROM \n    object o\nINNER JOIN \n    probability p_agn ON o.oid = p_agn.oid\nINNER JOIN \n    probability p_lpv ON o.oid = p_lpv.oid\nWHERE \n    -- Filter for AGN in stamp classifier version 'stamp_classifier_1.0.4' with probability > 0.6\n    p_agn.classifier_name = 'stamp_classifier' AND\n    p_agn.class_name = 'AGN' AND\n    p_agn.classifier_version = 'stamp_classifier_1.0.4' AND\n    p_agn.probability > 0.6 AND\n    p_agn.ranking = 1\n    AND\n    -- Filter for LPV in light curve classifier with probability > 0.7\n    p_lpv.classifier_name = 'lc_classifier' AND\n    p_lpv.class_name = 'LPV' AND\n    p_lpv.probability > 0.7 AND\n    p_lpv.ranking = 1\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2903, "completion_tokens": 271, "total_tokens": 3174, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ac03688190b89639d765da7d74", "custom_id": "97-1", "response": {"status_code": 200, "request_id": "272f2934541e291174cf910b90dd3511", "body": {"id": "chatcmpl-BgzbaDfdIpLoj076aP7Pod1Lm3oI6", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    p_agn.probability AS prob_stamp_agn, \n    p_lpv.probability AS prob_lc_lpv\nFROM \n    object o\nINNER JOIN \n    probability p_agn ON o.oid = p_agn.oid\nINNER JOIN \n    probability p_lpv ON o.oid = p_lpv.oid\nWHERE \n    p_agn.classifier_name = 'stamp_classifier'\n    AND p_agn.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_agn.class_name = 'AGN'\n    AND p_agn.probability > 0.6\n    AND p_agn.ranking = 1\n    AND p_lpv.classifier_name = 'lc_classifier'\n    AND p_lpv.class_name = 'LPV'\n    AND p_lpv.probability > 0.7\n    AND p_lpv.ranking = 1\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2779, "completion_tokens": 207, "total_tokens": 2986, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ac0f7c8190b3596259f47cac39", "custom_id": "76-0", "response": {"status_code": 200, "request_id": "b9b1d4a200610a52e338cb3512f88b40", "body": {"id": "chatcmpl-Bgzbaz8vAbW1IKOUY8HMcm2Wg4xUu", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH mpc_object AS (\n    -- Replace the following with the actual query to get RA and Dec for MPC object '115185'\n    SELECT\n        '115185' AS mpc_id,\n        -- Example coordinates, replace with actual retrieval if available\n        150.0 AS ra_deg,  -- Right Ascension in degrees\n        2.0 AS dec_deg    -- Declination in degrees\n)\nSELECT\n    o.oid AS ztf_identifier,\n    o.g_r_max AS mpc_archive_magnitude,\n    q3c_dist(o.meanra, o.meandec, mpc.ra_deg, mpc.dec_deg) AS distance_deg\nFROM\n    object o,\n    mpc_object mpc\nWHERE\n    q3c_join(o.meanra, o.meandec, mpc.ra_deg, mpc.dec_deg, 1.5/3600.0)\nORDER BY\n    distance_deg ASC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2692, "completion_tokens": 197, "total_tokens": 2889, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ac1c3c8190bdd7ae09249d72af", "custom_id": "44-0", "response": {"status_code": 200, "request_id": "61c4a06c882ab7cfe911d52775919598", "body": {"id": "chatcmpl-BgzbauEtRagBtcXgdcaKZ1W2Fdbkh", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM dataquality\nWHERE oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz') \n  AND chipsf < 3\nORDER BY oid ASC, scorr DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2579, "completion_tokens": 50, "total_tokens": 2629, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
{"id": "batch_req_684891ac2a9c8190886ae33972076c29", "custom_id": "44-1", "response": {"status_code": 200, "request_id": "84a2d6b80f1b7da6b9a5189b923d5b59", "body": {"id": "chatcmpl-Bgzba1GSz5Ugg4OYn0m2FIosggeMo", "object": "chat.completion", "created": 1749586286, "model": "gpt-4.1-nano-2025-04-14", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM dataquality\nWHERE oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz') \n  AND chipsf < 3\nORDER BY oid ASC, scorr DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2586, "completion_tokens": 50, "total_tokens": 2636, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_f12167b370"}}, "error": null}
