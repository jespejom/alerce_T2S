{
    "8": {
        "0": {
            "req_id": "8",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 776,
                "out_toks": 22,
                "id": "chatcmpl-BjAchfYNGckRsjUgPPiLMaLB1kFyJ",
                "created": 1750105295,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Filter objects that either meet the probability criterion or have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n  AND (\n    EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.probability > 0.5\n    )\n    OR o.ndet >= 2\n  );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n)\n-- Filter objects that either meet the probability criterion or have at least two detections\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects)\n  AND (\n    EXISTS (\n      SELECT 1\n      FROM probability p\n      WHERE p.oid = o.oid\n        AND p.class_name = 'SN'\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.probability > 0.5\n    )\n    OR o.ndet >= 2\n  );\n```"
                },
                "in_toks": 3133,
                "out_toks": 225,
                "id": "chatcmpl-BjAdHzFLCL4aFFvE25cDTcvvNMGje",
                "created": 1750105331,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "8",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 776,
                "out_toks": 22,
                "id": "chatcmpl-BjAchfYNGckRsjUgPPiLMaLB1kFyJ",
                "created": 1750105295,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n      OR o.ndet >= 2\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects first classified as SN by the stamp classifier between August 17 and August 21\nWITH sn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n      AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'SN'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability > 0.5\n      )\n      OR o.ndet >= 2\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3133,
                "out_toks": 146,
                "id": "chatcmpl-BjAdHIC9ogs4LYZQgDFUH1X6A0loU",
                "created": 1750105331,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "27": {
        "0": {
            "req_id": "27",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 815,
                "out_toks": 20,
                "id": "chatcmpl-BjAchBCwWsG628bhMi5xjKGF7O6I8",
                "created": 1750105295,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object information along with classification details for objects with at least 100 detections,\n-- most likely classified as Cepheid with probability > 0.76, using the lc_classifier.\n\nWITH cepheid_probs AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n),\nobject_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM\n        object o\n    WHERE\n        o.ndet >= 100\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_max,\n    cp.class_name,\n    cp.classifier_name,\n    cp.ranking,\n    cp.probability\nFROM\n    object_filtered o\nJOIN\n    cepheid_probs cp ON o.oid = cp.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object information along with classification details for objects with at least 100 detections,\n-- most likely classified as Cepheid with probability > 0.76, using the lc_classifier.\n\nWITH cepheid_probs AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.ranking,\n        p.probability\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n),\nobject_filtered AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM\n        object o\n    WHERE\n        o.ndet >= 100\n)\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_max,\n    cp.class_name,\n    cp.classifier_name,\n    cp.ranking,\n    cp.probability\nFROM\n    object_filtered o\nJOIN\n    cepheid_probs cp ON o.oid = cp.oid;\n```"
                },
                "in_toks": 5028,
                "out_toks": 282,
                "id": "chatcmpl-BjAdHhFyKUgCeg5UX5F7DoFJgKq4x",
                "created": 1750105331,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "27",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature']",
                    "1": "['object', 'probability', 'feature']"
                },
                "in_toks": 815,
                "out_toks": 20,
                "id": "chatcmpl-BjAchBCwWsG628bhMi5xjKGF7O6I8",
                "created": 1750105295,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'CEP'\n    AND p.probability > 0.76\nORDER BY p.probability DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object information along with classification details for objects with at least 100 detections\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.meanra,\n        o.meandec,\n        o.ndet,\n        o.firstmjd,\n        o.deltajd,\n        o.g_r_max\n    FROM object o\n    WHERE o.ndet >= 100\n)\nSELECT\n    so.oid,\n    so.meanra,\n    so.meandec,\n    so.ndet,\n    so.firstmjd,\n    so.deltajd,\n    so.g_r_max,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\nFROM selected_objects so\nJOIN probability p ON so.oid = p.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'CEP'\n    AND p.probability > 0.76\nORDER BY p.probability DESC;\n```"
                },
                "in_toks": 5028,
                "out_toks": 207,
                "id": "chatcmpl-BjAdHkmLbLZX3ibuJRLndbaLPnio2",
                "created": 1750105331,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "17": {
        "0": {
            "req_id": "17",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection']",
                    "1": "['object', 'probability', 'feature', 'magstat', 'detection']"
                },
                "in_toks": 783,
                "out_toks": 36,
                "id": "chatcmpl-BjAciTalKkAJqpX02saYvEzOWSr0r",
                "created": 1750105296,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects classified as AGN with variability in the r band and no detections or variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score for AGN class\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n)\n-- Join with magstat for r band to check variability\nAND EXISTS (\n    SELECT 1\n    FROM magstat m_r\n    WHERE m_r.oid = o.oid\n      AND m_r.fid = 2 -- r band\n      AND (m_r.ndet > 0 AND m_r.magsigma > 0) -- shows variability\n)\n-- Check g band for no detections or no variability\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1 -- g band\n          AND (m_g.ndet > 0 AND m_g.magsigma > 0)\n    )\n    OR\n    -- If detections exist in g, ensure no variability\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1\n          AND m_g.ndet > 0\n          AND m_g.magsigma > 0\n    )\n)\nORDER BY o.oid ASC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with variability in the r band and no detections or variability in the g band\nSELECT o.oid\nFROM object o\n-- Subquery to find AGN objects with high probability in the 'drb' score for AGN class\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_stochastic', 'lc_classifier_periodic')\n      AND p.ranking = 1\n)\n-- Join with magstat for r band to check variability\nAND EXISTS (\n    SELECT 1\n    FROM magstat m_r\n    WHERE m_r.oid = o.oid\n      AND m_r.fid = 2 -- r band\n      AND (m_r.ndet > 0 AND m_r.magsigma > 0) -- shows variability\n)\n-- Check g band for no detections or no variability\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1 -- g band\n          AND (m_g.ndet > 0 AND m_g.magsigma > 0)\n    )\n    OR\n    -- If detections exist in g, ensure no variability\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m_g\n        WHERE m_g.oid = o.oid\n          AND m_g.fid = 1\n          AND m_g.ndet > 0\n          AND m_g.magsigma > 0\n    )\n)\nORDER BY o.oid ASC;\n```"
                },
                "in_toks": 6261,
                "out_toks": 366,
                "id": "chatcmpl-BjAdIzbghOssTtmKfbFsl9u0LdbBC",
                "created": 1750105332,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "17",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "magstat",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'magstat', 'detection']",
                    "1": "['object', 'probability', 'feature', 'magstat', 'detection']"
                },
                "in_toks": 783,
                "out_toks": 36,
                "id": "chatcmpl-BjAciTalKkAJqpX02saYvEzOWSr0r",
                "created": 1750105296,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects classified as AGN with variability in r band and no detections or no variability in g band\nSELECT o.oid\nFROM object o\n-- Filter objects with probability of AGN class ranking 1 in the 'stamp_classifier'\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n)\n-- Ensure the object shows variability in the r band\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2 -- r band\n      AND m.ndet > 0 -- has detections in r band\n      AND (\n        m.magmax - m.magmin > 0 -- variability in r band (change in magnitude)\n        OR m.magsigma > 0 -- dispersion indicates variability\n      )\n)\n-- Ensure the object has no detections or no variability in the g band\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1 -- g band\n          AND m2.ndet > 0 -- has detections in g band\n          AND (\n            m2.magmax - m2.magmin > 0 -- variability in g band\n            OR m2.magsigma > 0 -- dispersion indicates variability\n          )\n      )\n    OR NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1 -- g band\n          AND m2.ndet > 0\n          AND m2.magsigma > 0\n      )\n)\n-- Order the results by object id\nORDER BY o.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with variability in r band and no detections or no variability in g band\nSELECT o.oid\nFROM object o\n-- Filter objects with probability of AGN class ranking 1 in the 'stamp_classifier'\nWHERE EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'AGN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1\n)\n-- Ensure the object shows variability in the r band\nAND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = o.oid\n      AND m.fid = 2 -- r band\n      AND m.ndet > 0 -- has detections in r band\n      AND (\n        m.magmax - m.magmin > 0 -- variability in r band (change in magnitude)\n        OR m.magsigma > 0 -- dispersion indicates variability\n      )\n)\n-- Ensure the object has no detections or no variability in the g band\nAND (\n    NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1 -- g band\n          AND m2.ndet > 0 -- has detections in g band\n          AND (\n            m2.magmax - m2.magmin > 0 -- variability in g band\n            OR m2.magsigma > 0 -- dispersion indicates variability\n          )\n      )\n    OR NOT EXISTS (\n        SELECT 1\n        FROM magstat m2\n        WHERE m2.oid = o.oid\n          AND m2.fid = 1 -- g band\n          AND m2.ndet > 0\n          AND m2.magsigma > 0\n      )\n)\n-- Order the results by object id\nORDER BY o.oid;\n```"
                },
                "in_toks": 6261,
                "out_toks": 406,
                "id": "chatcmpl-BjAdJAVcXKdNiN8KNOlT2xkBgfgkn",
                "created": 1750105333,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "37": {
        "0": {
            "req_id": "37",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 769,
                "out_toks": 14,
                "id": "chatcmpl-BjAcjnJ7PJs8CG6592IVktIUmDFgP",
                "created": 1750105297,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Subquery to get the top 200 objects classified as SNIa by the lc_classifier, ordered by probability descending\nWITH top_snia AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\n-- Main query to select all columns from object for the top 200 SNIa objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM top_snia)\nORDER BY (\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.ranking\n    LIMIT 1\n) DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Subquery to get the top 200 objects classified as SNIa by the lc_classifier, ordered by probability descending\nWITH top_snia AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\n-- Main query to select all columns from object for the top 200 SNIa objects\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM top_snia)\nORDER BY (\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.ranking\n    LIMIT 1\n) DESC;\n```"
                },
                "in_toks": 2551,
                "out_toks": 194,
                "id": "chatcmpl-BjAdJmto4LrtjNhwX2pXTk0CvjmKb",
                "created": 1750105333,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "37",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 769,
                "out_toks": 14,
                "id": "chatcmpl-BjAcjnJ7PJs8CG6592IVktIUmDFgP",
                "created": 1750105297,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH snia_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL -- assuming any version, or specify if needed\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM snia_objects)\nORDER BY (\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.ranking ASC\n    LIMIT 1\n) DESC;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the top 200 objects classified as SNIa by the light curve classifier, ordered by probability descending\nWITH snia_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version IS NOT NULL -- assuming any version, or specify if needed\n    ORDER BY p.probability DESC\n    LIMIT 200\n)\nSELECT o.*\nFROM object o\nWHERE o.oid IN (SELECT oid FROM snia_objects)\nORDER BY (\n    SELECT p.probability\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name = 'SNIa'\n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.ranking ASC\n    LIMIT 1\n) DESC;\n```"
                },
                "in_toks": 2551,
                "out_toks": 183,
                "id": "chatcmpl-BjAdKvFQYL7KvV039fVviujkS9uDe",
                "created": 1750105334,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "34": {
        "0": {
            "req_id": "34",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']",
                    "1": "['object', 'feature']"
                },
                "in_toks": 858,
                "out_toks": 12,
                "id": "chatcmpl-BjAckjdKqrILPIoHt5jecc9oMRckM",
                "created": 1750105298,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary inline table with the list of object IDs\nWITH object_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nJOIN\n    object_list ol ON f.oid = ol.oid\nWHERE\n    f.name IN ('Amplitude', 'Multiband_period');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary inline table with the list of object IDs\nWITH object_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nJOIN\n    object_list ol ON f.oid = ol.oid\nWHERE\n    f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4887,
                "out_toks": 208,
                "id": "chatcmpl-BjAdKVCAl0A8oAqglqq7X6SSxbV9G",
                "created": 1750105334,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "34",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature']",
                    "1": "['object', 'feature']"
                },
                "in_toks": 858,
                "out_toks": 12,
                "id": "chatcmpl-BjAckjdKqrILPIoHt5jecc9oMRckM",
                "created": 1750105298,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define a temporary inline table with the list of object IDs\nWITH object_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nJOIN\n    object_list ol ON f.oid = ol.oid\nWHERE\n    f.name IN ('Amplitude', 'Multiband_period');\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define a temporary inline table with the list of object IDs\nWITH object_list AS (\n    SELECT unnest(ARRAY[\n        'ZTF17aaadpsi',\n        'ZTF19aaduncs',\n        'ZTF18abnvehl',\n        'ZTF19abrqsxy',\n        'ZTF19aaduodl',\n        'ZTF19aadovdv',\n        'ZTF18aammkke',\n        'ZTF18abtriul',\n        'ZTF17aabwtky',\n        'ZTF18abwjpfy'\n    ]) AS oid\n)\n-- Select features 'Amplitude' or 'Multiband_period' for objects in the list\nSELECT\n    f.oid,\n    f.name,\n    f.value,\n    f.fid,\n    f.version\nFROM\n    feature f\nJOIN\n    object_list ol ON f.oid = ol.oid\nWHERE\n    f.name IN ('Amplitude', 'Multiband_period');\n```"
                },
                "in_toks": 4887,
                "out_toks": 208,
                "id": "chatcmpl-BjAdLb5sfKLiubJHgbwCWUVZjHzHr",
                "created": 1750105335,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "1": {
        "0": {
            "req_id": "1",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection']",
                    "1": "['object', 'probability', 'feature', 'detection']"
                },
                "in_toks": 891,
                "out_toks": 28,
                "id": "chatcmpl-BjAclj62JKNCgXPtiET0ukSrX2AdO",
                "created": 1750105299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.probability > 0.6\n),\n-- Filter objects with light curves covering at least one year\nobjects_one_year AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n),\n-- Filter objects with at least 20 detections in any band\nobjects_min_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 20\n),\n-- Filter objects with magnitude variations larger than thresholds in corrected magnitudes\nobjects_variation AS (\n    SELECT o.oid,\n           MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_max,\n           MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_min,\n           MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_max,\n           MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_min\n    FROM object o\n    LEFT JOIN feature f ON o.oid = f.oid\n    WHERE f.name IN ('g-r_max_corr', 'r-W2')\n    GROUP BY o.oid\n),\n-- Calculate the variations in g and r bands\nobjects_delta AS (\n    SELECT o.oid,\n           (g_max - g_min) AS delta_g,\n           (r_max - r_min) AS delta_r\n    FROM objects_variation ov\n    JOIN object o ON ov.oid = o.oid\n    WHERE g_max - g_min > 1 AND r_max - r_min > 0.5\n),\n-- Final selection combining all filters\nfinal_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN objects_one_year o1 ON o.oid = o1.oid\n    JOIN objects_min_detections o2 ON o.oid = o2.oid\n    JOIN objects_delta od ON o.oid = od.oid\n)\n-- Retrieve required information for the selected objects\nSELECT\n    o.oid,\n    f.value AS feature_value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_max_corr,\n    MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_min_corr,\n    MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_max_corr,\n    MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_min_corr,\n    (MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) - MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1)) AS delta_g,\n    (MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) - MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2)) AS delta_r\nFROM object o\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE o.oid IN (SELECT oid FROM final_objects)\n  AND f.name IN ('g-r_max_corr', 'r-W2')\n  AND f.value IS NOT NULL\nGROUP BY o.oid, f.value, f.name, f.version, f.fid\nORDER BY o.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.probability > 0.6\n),\n-- Filter objects with light curves covering at least one year\nobjects_one_year AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n),\n-- Filter objects with at least 20 detections in any band\nobjects_min_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 20\n),\n-- Filter objects with magnitude variations larger than thresholds in corrected magnitudes\nobjects_variation AS (\n    SELECT o.oid,\n           MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_max,\n           MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_min,\n           MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_max,\n           MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_min\n    FROM object o\n    LEFT JOIN feature f ON o.oid = f.oid\n    WHERE f.name IN ('g-r_max_corr', 'r-W2')\n    GROUP BY o.oid\n),\n-- Calculate the variations in g and r bands\nobjects_delta AS (\n    SELECT o.oid,\n           (g_max - g_min) AS delta_g,\n           (r_max - r_min) AS delta_r\n    FROM objects_variation ov\n    JOIN object o ON ov.oid = o.oid\n    WHERE g_max - g_min > 1 AND r_max - r_min > 0.5\n),\n-- Final selection combining all filters\nfinal_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN objects_one_year o1 ON o.oid = o1.oid\n    JOIN objects_min_detections o2 ON o.oid = o2.oid\n    JOIN objects_delta od ON o.oid = od.oid\n)\n-- Retrieve required information for the selected objects\nSELECT\n    o.oid,\n    f.value AS feature_value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_max_corr,\n    MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_min_corr,\n    MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_max_corr,\n    MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_min_corr,\n    (MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) - MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1)) AS delta_g,\n    (MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) - MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2)) AS delta_r\nFROM object o\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE o.oid IN (SELECT oid FROM final_objects)\n  AND f.name IN ('g-r_max_corr', 'r-W2')\n  AND f.value IS NOT NULL\nGROUP BY o.oid, f.value, f.name, f.version, f.fid\nORDER BY o.oid;\n```"
                },
                "in_toks": 5652,
                "out_toks": 927,
                "id": "chatcmpl-BjAdL6yHSEye5TiWAefbs7j4GptBu",
                "created": 1750105335,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "1",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'detection']",
                    "1": "['object', 'probability', 'feature', 'detection']"
                },
                "in_toks": 891,
                "out_toks": 28,
                "id": "chatcmpl-BjAclj62JKNCgXPtiET0ukSrX2AdO",
                "created": 1750105299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.probability > 0.6\n),\n-- Filter objects with light curves covering at least one year\nobjects_one_year AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n),\n-- Filter objects with at least 20 detections in any band\nobjects_min_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 20\n),\n-- Filter objects with magnitude variations larger than thresholds in corrected magnitudes\nobjects_variation AS (\n    SELECT o.oid,\n           MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_max,\n           MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_min,\n           MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_max,\n           MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_min\n    FROM object o\n    LEFT JOIN feature f ON o.oid = f.oid\n    WHERE f.name IN ('g-r_max_corr', 'r-W2')\n    GROUP BY o.oid\n),\n-- Calculate the variations in g and r bands\nobjects_delta AS (\n    SELECT o.oid,\n           (g_max - g_min) AS delta_g,\n           (r_max - r_min) AS delta_r\n    FROM objects_variation ov\n    JOIN object o ON ov.oid = o.oid\n    WHERE g_max - g_min > 1 AND r_max - r_min > 0.5\n),\n-- Final selection combining all filters\nfinal_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN objects_one_year o1 ON o.oid = o1.oid\n    JOIN objects_min_detections o2 ON o.oid = o2.oid\n    JOIN objects_delta od ON o.oid = od.oid\n)\n-- Retrieve required details for the selected objects\nSELECT\n    o.oid,\n    f.value AS value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS max_mag_g,\n    MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS min_mag_g,\n    MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS max_mag_r,\n    MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS min_mag_r,\n    (MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) - MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1)) AS delta_mag_g,\n    (MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) - MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2)) AS delta_mag_r\nFROM object o\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE o.oid IN (SELECT oid FROM final_objects)\n  AND f.name IN ('value', 'name', 'version', 'fid')\nGROUP BY o.oid, f.value, f.name, f.version, f.fid\nORDER BY o.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects classified as AGN with probability > 0.6\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n      AND p.probability > 0.6\n),\n-- Filter objects with light curves covering at least one year\nobjects_one_year AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.mjdstarthist IS NOT NULL\n      AND o.mjdendhist IS NOT NULL\n      AND (o.mjdendhist - o.mjdstarthist) >= 365\n),\n-- Filter objects with at least 20 detections in any band\nobjects_min_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet >= 20\n),\n-- Filter objects with magnitude variations larger than thresholds in corrected magnitudes\nobjects_variation AS (\n    SELECT o.oid,\n           MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_max,\n           MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS g_min,\n           MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_max,\n           MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS r_min\n    FROM object o\n    LEFT JOIN feature f ON o.oid = f.oid\n    WHERE f.name IN ('g-r_max_corr', 'r-W2')\n    GROUP BY o.oid\n),\n-- Calculate the variations in g and r bands\nobjects_delta AS (\n    SELECT o.oid,\n           (g_max - g_min) AS delta_g,\n           (r_max - r_min) AS delta_r\n    FROM objects_variation ov\n    JOIN object o ON ov.oid = o.oid\n    WHERE g_max - g_min > 1 AND r_max - r_min > 0.5\n),\n-- Final selection combining all filters\nfinal_objects AS (\n    SELECT o.oid\n    FROM agn_objects o\n    JOIN objects_one_year o1 ON o.oid = o1.oid\n    JOIN objects_min_detections o2 ON o.oid = o2.oid\n    JOIN objects_delta od ON o.oid = od.oid\n)\n-- Retrieve required details for the selected objects\nSELECT\n    o.oid,\n    f.value AS value,\n    f.name,\n    f.version,\n    f.fid AS \"features_fid\",\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS max_mag_g,\n    MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) AS min_mag_g,\n    MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS max_mag_r,\n    MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) AS min_mag_r,\n    (MAX(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1) - MIN(f.value) FILTER (WHERE f.name = 'g-r_max_corr' AND f.fid = 1)) AS delta_mag_g,\n    (MAX(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2) - MIN(f.value) FILTER (WHERE f.name = 'r-W2' AND f.fid = 2)) AS delta_mag_r\nFROM object o\nLEFT JOIN feature f ON o.oid = f.oid\nWHERE o.oid IN (SELECT oid FROM final_objects)\n  AND f.name IN ('value', 'name', 'version', 'fid')\nGROUP BY o.oid, f.value, f.name, f.version, f.fid\nORDER BY o.oid;\n```"
                },
                "in_toks": 5652,
                "out_toks": 922,
                "id": "chatcmpl-BjAdL9ZVtUILTvwigvDIoiBezO03V",
                "created": 1750105335,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "16": {
        "0": {
            "req_id": "16",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 846,
                "out_toks": 30,
                "id": "chatcmpl-BjAclYJbonOMlNW0pP9qTW6mGoqDV",
                "created": 1750105299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and fast rise\nWITH stamp_max_sn AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.meanra,\n        o.meandec\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_stats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.dmdt_first\n    FROM\n        magstat m\n),\ndetections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.isdiffpos\n    FROM\n        detection d\n),\n-- Calculate the initial rise rate for objects qualifying as fast risers\ninitial_rise AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.dmdt_first,\n        (lc.magfirst - lc.maglast) / NULLIF((fd.mjd - (SELECT mjd FROM detection WHERE oid = lc.oid AND isdiffpos = 0 ORDER BY mjd DESC LIMIT 1)), 1) AS rise_rate\n    FROM\n        light_curve_stats lc\n    JOIN\n        first_detections fd ON lc.oid = fd.oid\n    WHERE\n        -- Ensure the first detection is within the first 2 days of September\n        fd.firstmjd BETWEEN 60188.0 AND 60190.0\n        -- Calculate the rate of magnitude change\n        AND (lc.magfirst - lc.maglast) / NULLIF((fd.firstmjd - (SELECT mjd FROM detection WHERE oid = lc.oid AND isdiffpos = 0 ORDER BY mjd DESC LIMIT 1)), 1) >= 0.25\n)\n-- Final selection combining all criteria\nSELECT\n    o.oid,\n    p.stamp_prob,\n    d.fid AS filter_id,\n    d.magpsf AS diffmag,\n    lc.magstat_fid,\n    lc.dmdt_first AS initial_rise_estimate\nFROM\n    object o\nJOIN\n    stamp_max_sn p ON o.oid = p.oid\nJOIN\n    first_detections fd ON o.oid = fd.oid\nJOIN\n    light_curve_stats lc ON o.oid = lc.oid\nJOIN\n    detections d ON o.oid = d.oid\nJOIN\n    initial_rise ir ON o.oid = ir.oid\nWHERE\n    -- Ensure the object has the highest stamp classifier probability for SN\n    p.ranking = 1\n    AND p.class_name = 'SN'\n    -- First detection within the first 2 days of September\n    AND fd.firstmjd BETWEEN 60188.0 AND 60189.0\n    -- Fast riser condition\n    AND (ir.magfirst - ir.maglast) / NULLIF((fd.firstmjd - (SELECT mjd FROM detection WHERE oid = o.oid AND isdiffpos = 0 ORDER BY mjd DESC LIMIT 1)), 1) >= 0.25\nORDER BY\n    o.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria related to classification, detection timing, and fast rise\nWITH stamp_max_sn AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_prob,\n        p.class_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        o.oid,\n        o.firstmjd,\n        o.meanra,\n        o.meandec\n    FROM\n        object o\n    WHERE\n        o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\nlight_curve_stats AS (\n    SELECT\n        m.oid,\n        m.fid AS magstat_fid,\n        m.magfirst,\n        m.maglast,\n        m.dmdt_first\n    FROM\n        magstat m\n),\ndetections AS (\n    SELECT\n        d.oid,\n        d.candid,\n        d.mjd,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.isdiffpos\n    FROM\n        detection d\n),\n-- Calculate the initial rise rate for objects qualifying as fast risers\ninitial_rise AS (\n    SELECT\n        lc.oid,\n        lc.magfirst,\n        lc.maglast,\n        lc.dmdt_first,\n        (lc.magfirst - lc.maglast) / NULLIF((fd.mjd - (SELECT mjd FROM detection WHERE oid = lc.oid AND isdiffpos = 0 ORDER BY mjd DESC LIMIT 1)), 1) AS rise_rate\n    FROM\n        light_curve_stats lc\n    JOIN\n        first_detections fd ON lc.oid = fd.oid\n    WHERE\n        -- Ensure the first detection is within the first 2 days of September\n        fd.firstmjd BETWEEN 60188.0 AND 60190.0\n        -- Calculate the rate of magnitude change\n        AND (lc.magfirst - lc.maglast) / NULLIF((fd.firstmjd - (SELECT mjd FROM detection WHERE oid = lc.oid AND isdiffpos = 0 ORDER BY mjd DESC LIMIT 1)), 1) >= 0.25\n)\n-- Final selection combining all criteria\nSELECT\n    o.oid,\n    p.stamp_prob,\n    d.fid AS filter_id,\n    d.magpsf AS diffmag,\n    lc.magstat_fid,\n    lc.dmdt_first AS initial_rise_estimate\nFROM\n    object o\nJOIN\n    stamp_max_sn p ON o.oid = p.oid\nJOIN\n    first_detections fd ON o.oid = fd.oid\nJOIN\n    light_curve_stats lc ON o.oid = lc.oid\nJOIN\n    detections d ON o.oid = d.oid\nJOIN\n    initial_rise ir ON o.oid = ir.oid\nWHERE\n    -- Ensure the object has the highest stamp classifier probability for SN\n    p.ranking = 1\n    AND p.class_name = 'SN'\n    -- First detection within the first 2 days of September\n    AND fd.firstmjd BETWEEN 60188.0 AND 60189.0\n    -- Fast riser condition\n    AND (ir.magfirst - ir.maglast) / NULLIF((fd.firstmjd - (SELECT mjd FROM detection WHERE oid = o.oid AND isdiffpos = 0 ORDER BY mjd DESC LIMIT 1)), 1) >= 0.25\nORDER BY\n    o.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3972,
                "out_toks": 764,
                "id": "chatcmpl-BjAdMtO103lYBnrjr9BRObQbkXoSY",
                "created": 1750105336,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "16",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'magstat']",
                    "1": "['object', 'probability', 'detection', 'magstat']"
                },
                "in_toks": 846,
                "out_toks": 30,
                "id": "chatcmpl-BjAclYJbonOMlNW0pP9qTW6mGoqDV",
                "created": 1750105299,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with specific criteria: highest stamp classifier probability for 'SN', first detection within first 2 days of September, and qualifying as fast risers\nWITH stamp_max_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\ncandidate_objects AS (\n    SELECT\n        s.oid\n    FROM\n        stamp_max_prob s\n        JOIN first_detections f ON s.oid = f.oid\n    WHERE\n        f.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        d.fid AS magstat_fid,\n        d.magpsf AS mag_last,\n        d.mjd AS last_mjd,\n        ms.magfirst AS mag_first,\n        ms.firstmjd AS first_mjd,\n        -- Calculate the initial rise rate: (mag_first - mag_last) / (first_mjd - last_mjd)\n        CASE\n            WHEN (ms.firstmjd - d.mjd) != 0 THEN\n                (ms.magfirst - d.magpsf) / (ms.firstmjd - d.mjd)\n            ELSE\n                NULL\n        END AS initial_rise_rate\n    FROM\n        detection d\n        JOIN magstat ms ON d.oid = ms.oid AND d.fid = ms.fid\n    WHERE\n        d.oid IN (SELECT oid FROM candidate_objects)\n        AND d.mjd = (SELECT MIN(m.mjd) FROM detection m WHERE m.oid = d.oid AND m.mjd >= ms.firstmjd)\n),\nfast_risers AS (\n    SELECT\n        r.oid,\n        r.magstat_fid,\n        r.mag_last,\n        r.mag_first,\n        r.first_mjd,\n        r.last_mjd,\n        r.initial_rise_rate\n    FROM\n        rise_estimates r\n    WHERE\n        r.initial_rise_rate >= 0.25\n)\nSELECT\n    c.oid,\n    s.stamp_probability,\n    d.fid AS magstat_fid,\n    d.magpsf AS magdiff,\n    d.mjd AS detection_mjd,\n    r.initial_rise_rate\nFROM\n    candidate_objects c\n    JOIN stamp_max_prob s ON c.oid = s.oid\n    JOIN detection d ON c.oid = d.oid\n    JOIN magstat ms ON c.oid = ms.oid AND d.fid = ms.fid\n    JOIN fast_risers r ON c.oid = r.oid AND d.fid = r.magstat_fid\nWHERE\n    d.mjd = (SELECT MIN(m.mjd) FROM detection m WHERE m.oid = d.oid AND m.mjd >= ms.firstmjd)\nORDER BY\n    c.oid\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific criteria: highest stamp classifier probability for 'SN', first detection within first 2 days of September, and qualifying as fast risers\nWITH stamp_max_prob AS (\n    SELECT\n        p.oid,\n        p.probability AS stamp_probability,\n        p.class_name,\n        p.classifier_name,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'stamp_classifier'\n        AND p.ranking = 1\n        AND p.class_name = 'SN'\n),\nfirst_detections AS (\n    SELECT\n        d.oid,\n        MIN(d.mjd) AS first_mjd\n    FROM\n        detection d\n    GROUP BY\n        d.oid\n),\ncandidate_objects AS (\n    SELECT\n        s.oid\n    FROM\n        stamp_max_prob s\n        JOIN first_detections f ON s.oid = f.oid\n    WHERE\n        f.first_mjd BETWEEN 60188.0 AND 60189.0\n),\nrise_estimates AS (\n    SELECT\n        d.oid,\n        d.fid AS magstat_fid,\n        d.magpsf AS mag_last,\n        d.mjd AS last_mjd,\n        ms.magfirst AS mag_first,\n        ms.firstmjd AS first_mjd,\n        -- Calculate the initial rise rate: (mag_first - mag_last) / (first_mjd - last_mjd)\n        CASE\n            WHEN (ms.firstmjd - d.mjd) != 0 THEN\n                (ms.magfirst - d.magpsf) / (ms.firstmjd - d.mjd)\n            ELSE\n                NULL\n        END AS initial_rise_rate\n    FROM\n        detection d\n        JOIN magstat ms ON d.oid = ms.oid AND d.fid = ms.fid\n    WHERE\n        d.oid IN (SELECT oid FROM candidate_objects)\n        AND d.mjd = (SELECT MIN(m.mjd) FROM detection m WHERE m.oid = d.oid AND m.mjd >= ms.firstmjd)\n),\nfast_risers AS (\n    SELECT\n        r.oid,\n        r.magstat_fid,\n        r.mag_last,\n        r.mag_first,\n        r.first_mjd,\n        r.last_mjd,\n        r.initial_rise_rate\n    FROM\n        rise_estimates r\n    WHERE\n        r.initial_rise_rate >= 0.25\n)\nSELECT\n    c.oid,\n    s.stamp_probability,\n    d.fid AS magstat_fid,\n    d.magpsf AS magdiff,\n    d.mjd AS detection_mjd,\n    r.initial_rise_rate\nFROM\n    candidate_objects c\n    JOIN stamp_max_prob s ON c.oid = s.oid\n    JOIN detection d ON c.oid = d.oid\n    JOIN magstat ms ON c.oid = ms.oid AND d.fid = ms.fid\n    JOIN fast_risers r ON c.oid = r.oid AND d.fid = r.magstat_fid\nWHERE\n    d.mjd = (SELECT MIN(m.mjd) FROM detection m WHERE m.oid = d.oid AND m.mjd >= ms.firstmjd)\nORDER BY\n    c.oid\nLIMIT 100;\n```"
                },
                "in_toks": 3972,
                "out_toks": 685,
                "id": "chatcmpl-BjAdNPpC8TsG6BFswWvKrx2gPvkUw",
                "created": 1750105337,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "19": {
        "0": {
            "req_id": "19",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 818,
                "out_toks": 22,
                "id": "chatcmpl-BjAcmhge0Ka9eS9WBYtUuSpWT6wW5",
                "created": 1750105300,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for the observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that satisfy all conditions\ncandidate_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM objects_in_date)\n      AND o.oid IN (SELECT oid FROM objects_with_one_or_less_detections)\n),\n-- Get classification probabilities for objects classified as 'asteroid' by stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n),\n-- Join all conditions to get final result\nfinal_result AS (\n    SELECT c.oid, c.meanra, c.meandec, c.ndet, c.firstmjd, p.class_name, p.probability\n    FROM candidate_objects c\n    JOIN classification p ON c.oid = p.oid\n)\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_result;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for the observations\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects with at most one detection\nobjects_with_one_or_less_detections AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that satisfy all conditions\ncandidate_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd\n    FROM object o\n    WHERE o.oid IN (SELECT oid FROM objects_in_date)\n      AND o.oid IN (SELECT oid FROM objects_with_one_or_less_detections)\n),\n-- Get classification probabilities for objects classified as 'asteroid' by stamp_classifier with probability > 0.7\nclassification AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n      AND p.class_name = 'asteroid'\n      AND p.probability > 0.7\n),\n-- Join all conditions to get final result\nfinal_result AS (\n    SELECT c.oid, c.meanra, c.meandec, c.ndet, c.firstmjd, p.class_name, p.probability\n    FROM candidate_objects c\n    JOIN classification p ON c.oid = p.oid\n)\nSELECT oid, meanra, meandec, ndet, firstmjd, class_name, probability\nFROM final_result;\n```"
                },
                "in_toks": 3197,
                "out_toks": 378,
                "id": "chatcmpl-BjAdN55LgzGEXoUPTK734Mpw7AT2o",
                "created": 1750105337,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "19",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 818,
                "out_toks": 22,
                "id": "chatcmpl-BjAcmhge0Ka9eS9WBYtUuSpWT6wW5",
                "created": 1750105300,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the specified date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that satisfy all conditions:\n-- 1. Have detections in the date range\n-- 2. Have at most one detection overall\n-- 3. Are classified as 'asteroid' by the stamp classifier with probability > 0.7\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nJOIN objects_in_date oid_in_date ON o.oid = oid_in_date.oid\nJOIN objects_with_one_or_none_detection oid_one ON o.oid = oid_one.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability > 0.7\n  AND p.ranking = 1; -- ensure the class is the most probable\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the date range for observations between March 1st and April 1st, 2021\nWITH date_range AS (\n    SELECT 59274.0 AS start_mjd, 59305.0 AS end_mjd\n),\n-- Select objects that have detections within the specified date range\nobjects_in_date AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    JOIN date_range dr ON d.mjd BETWEEN dr.start_mjd AND dr.end_mjd\n),\n-- Filter objects that have at most one detection in total\nobjects_with_one_or_none_detection AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet <= 1\n),\n-- Select objects that satisfy all conditions:\n-- 1. Have detections in the date range\n-- 2. Have at most one detection overall\n-- 3. Are classified as 'asteroid' by the stamp classifier with probability > 0.7\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nJOIN objects_in_date oid_in_date ON o.oid = oid_in_date.oid\nJOIN objects_with_one_or_none_detection oid_one ON o.oid = oid_one.oid\nJOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'asteroid'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability > 0.7\n  AND p.ranking = 1; -- ensure the class is the most probable\n```"
                },
                "in_toks": 3197,
                "out_toks": 343,
                "id": "chatcmpl-BjAdOGvXQBTXAR90BLL7gllnNpViF",
                "created": 1750105338,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "14": {
        "0": {
            "req_id": "14",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'xmatch']",
                    "1": "['object', 'probability', 'detection', 'xmatch']"
                },
                "in_toks": 937,
                "out_toks": 30,
                "id": "chatcmpl-BjAcnXV50gVDBkHbXWVEZNqueP7pV",
                "created": 1750105301,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select relevant information for specified oids with given conditions\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', \n                  'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.rfid AS filter_id,\n    d.mjd,\n    d.magpsf AS magnitude,\n    d.sigmapsf AS magnitude_error,\n    d.has_stamp,\n    d.drb AS deep_learning_real_bogus_score,\n    -- Assuming star_galaxy_score is stored in the 'xmatch' table with class_catalog='star_galaxy'\n    xm_star_galaxy_score,\n    xm_dist AS distance_to_nearest_panstarrs\nFROM\n    detection d\nJOIN\n    selected_oids s ON d.oid = s.oid\nLEFT JOIN\n    xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\nWHERE\n    d.oid IN (SELECT oid FROM selected_oids)\n    AND d.drb > 0.5\n    AND (\n        xm.class_catalog = 'star_galaxy' AND xm.score < 0.5\n        OR\n        xm.dist < 1\n    );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant information for specified oids with given conditions\nWITH selected_oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', \n                  'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n)\nSELECT\n    d.oid,\n    d.candid,\n    d.rfid AS filter_id,\n    d.mjd,\n    d.magpsf AS magnitude,\n    d.sigmapsf AS magnitude_error,\n    d.has_stamp,\n    d.drb AS deep_learning_real_bogus_score,\n    -- Assuming star_galaxy_score is stored in the 'xmatch' table with class_catalog='star_galaxy'\n    xm_star_galaxy_score,\n    xm_dist AS distance_to_nearest_panstarrs\nFROM\n    detection d\nJOIN\n    selected_oids s ON d.oid = s.oid\nLEFT JOIN\n    xmatch xm ON d.oid = xm.oid AND xm.catid = 'panstarrs'\nWHERE\n    d.oid IN (SELECT oid FROM selected_oids)\n    AND d.drb > 0.5\n    AND (\n        xm.class_catalog = 'star_galaxy' AND xm.score < 0.5\n        OR\n        xm.dist < 1\n    );\n```"
                },
                "in_toks": 3379,
                "out_toks": 340,
                "id": "chatcmpl-BjAdOAMH5tvByzOUShfGzqCswIDcZ",
                "created": 1750105338,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "14",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'xmatch']",
                    "1": "['object', 'probability', 'detection', 'xmatch']"
                },
                "in_toks": 937,
                "out_toks": 30,
                "id": "chatcmpl-BjAcnXV50gVDBkHbXWVEZNqueP7pV",
                "created": 1750105301,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select relevant columns from detection table for specified oids\nWITH selected_objects AS (\n    SELECT \n        d.oid,\n        d.candid,\n        d.rfid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        x.dist\n    FROM detection d\n    LEFT JOIN xmatch x ON d.oid = x.oid\n    WHERE d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n)\n-- Filter objects based on deep learning real bogus score and other conditions\nSELECT DISTINCT\n    so.oid,\n    so.candid,\n    so.rfid,\n    so.mjd,\n    so.magpsf,\n    so.sigmapsf,\n    so.has_stamp,\n    so.drb,\n    -- Retrieve the star galaxy score from probability table for the object\n    p_star_galaxy.score AS star_galaxy_score,\n    so.dist\nFROM selected_objects so\nLEFT JOIN (\n    -- Get the star galaxy score for each object\n    SELECT \n        p.oid,\n        p.probability AS score\n    FROM probability p\n    WHERE p.class_name IN ('VS') AND p.classifier_name = 'stamp_classifier'\n) p_star_galaxy ON so.oid = p_star_galaxy.oid\nWHERE \n    so.drb > 0.5\n    AND (\n        p_star_galaxy.score < 0.5\n        OR so.dist < 1\n    );\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns from detection table for specified oids\nWITH selected_objects AS (\n    SELECT \n        d.oid,\n        d.candid,\n        d.rfid,\n        d.mjd,\n        d.magpsf,\n        d.sigmapsf,\n        d.has_stamp,\n        d.drb,\n        x.dist\n    FROM detection d\n    LEFT JOIN xmatch x ON d.oid = x.oid\n    WHERE d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')\n)\n-- Filter objects based on deep learning real bogus score and other conditions\nSELECT DISTINCT\n    so.oid,\n    so.candid,\n    so.rfid,\n    so.mjd,\n    so.magpsf,\n    so.sigmapsf,\n    so.has_stamp,\n    so.drb,\n    -- Retrieve the star galaxy score from probability table for the object\n    p_star_galaxy.score AS star_galaxy_score,\n    so.dist\nFROM selected_objects so\nLEFT JOIN (\n    -- Get the star galaxy score for each object\n    SELECT \n        p.oid,\n        p.probability AS score\n    FROM probability p\n    WHERE p.class_name IN ('VS') AND p.classifier_name = 'stamp_classifier'\n) p_star_galaxy ON so.oid = p_star_galaxy.oid\nWHERE \n    so.drb > 0.5\n    AND (\n        p_star_galaxy.score < 0.5\n        OR so.dist < 1\n    );\n```"
                },
                "in_toks": 3379,
                "out_toks": 391,
                "id": "chatcmpl-BjAdOoLWqtPQz3eamaQINBFSjzmjB",
                "created": 1750105338,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "30": {
        "0": {
            "req_id": "30",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 776,
                "out_toks": 14,
                "id": "chatcmpl-BjAcoBAXN4bjHhUFJerGHGNocXNAY",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID, class name, and probability for each object based on the light curve classifier\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability\nFROM\n    object o\n-- Use a nested query to get the top-ranked class (most probable) for each object from the probability table\nJOIN (\n    SELECT\n        oid,\n        class_name,\n        probability,\n        ROW_NUMBER() OVER (PARTITION BY oid ORDER BY ranking ASC) AS rn\n    FROM\n        probability\n    WHERE\n        classifier_name = 'lc_classifier'\n) p ON o.oid = p.oid\n-- Filter to only include the most probable class per object\nWHERE\n    p.rn = 1;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID, class name, and probability for each object based on the light curve classifier\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability\nFROM\n    object o\n-- Use a nested query to get the top-ranked class (most probable) for each object from the probability table\nJOIN (\n    SELECT\n        oid,\n        class_name,\n        probability,\n        ROW_NUMBER() OVER (PARTITION BY oid ORDER BY ranking ASC) AS rn\n    FROM\n        probability\n    WHERE\n        classifier_name = 'lc_classifier'\n) p ON o.oid = p.oid\n-- Filter to only include the most probable class per object\nWHERE\n    p.rn = 1;\n```"
                },
                "in_toks": 2557,
                "out_toks": 155,
                "id": "chatcmpl-BjAdPkJZPFfmIrPC38hHudaRF8gRY",
                "created": 1750105339,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "30",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 776,
                "out_toks": 14,
                "id": "chatcmpl-BjAcoBAXN4bjHhUFJerGHGNocXNAY",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select the object ID, class name, and probability for the most probable class from the light curve classifier\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability\nFROM\n    object o\nJOIN\n    (\n        -- Subquery to get the top-ranked class and its probability for each object\n        SELECT\n            oid,\n            class_name,\n            probability\n        FROM\n            probability\n        WHERE\n            classifier_name = 'lc_classifier'\n            AND classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name = 'lc_classifier')\n        QUALIFY\n            ROW_NUMBER() OVER (PARTITION BY oid ORDER BY ranking) = 1\n    ) p ON o.oid = p.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select the object ID, class name, and probability for the most probable class from the light curve classifier\nSELECT\n    o.oid,\n    p.class_name,\n    p.probability\nFROM\n    object o\nJOIN\n    (\n        -- Subquery to get the top-ranked class and its probability for each object\n        SELECT\n            oid,\n            class_name,\n            probability\n        FROM\n            probability\n        WHERE\n            classifier_name = 'lc_classifier'\n            AND classifier_version = (SELECT MAX(classifier_version) FROM probability WHERE classifier_name = 'lc_classifier')\n        QUALIFY\n            ROW_NUMBER() OVER (PARTITION BY oid ORDER BY ranking) = 1\n    ) p ON o.oid = p.oid;\n```"
                },
                "in_toks": 2557,
                "out_toks": 157,
                "id": "chatcmpl-BjAdPhyigsm7wGCyBPKjoWfIYSHUd",
                "created": 1750105339,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "22": {
        "0": {
            "req_id": "22",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 761,
                "out_toks": 14,
                "id": "chatcmpl-BjAcoLtTfznresCZGC0pkA0mgslNN",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object IDs for objects detected between June 1st and July 1st, 2018\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n),\nobject_in_date_range AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd <= (SELECT end_mjd FROM date_range)\n      AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n)\n-- Retrieve objects classified by the light curve classifier within the date range\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid FROM object_in_date_range\n)\nAND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object IDs for objects detected between June 1st and July 1st, 2018\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n),\nobject_in_date_range AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd <= (SELECT end_mjd FROM date_range)\n      AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n)\n-- Retrieve objects classified by the light curve classifier within the date range\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid FROM object_in_date_range\n)\nAND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n);\n```"
                },
                "in_toks": 2579,
                "out_toks": 185,
                "id": "chatcmpl-BjAdRklKXgbo6NIicXfc5GCAk89VX",
                "created": 1750105341,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "22",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 761,
                "out_toks": 14,
                "id": "chatcmpl-BjAcoLtTfznresCZGC0pkA0mgslNN",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select object identifiers for objects detected between June 1st and July 1st, 2018\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n),\nobject_time_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd <= (SELECT end_mjd FROM date_range)\n      AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n)\n-- Retrieve objects classified as 'Transient', 'Stochastic', or 'Periodic' by the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid FROM object_time_filtered\n)\nAND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name IN ('Transient', 'Stochastic', 'Periodic')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select object identifiers for objects detected between June 1st and July 1st, 2018\nWITH date_range AS (\n    SELECT 58239.0 AS start_mjd, 58270.0 AS end_mjd\n),\nobject_time_filtered AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd <= (SELECT end_mjd FROM date_range)\n      AND o.lastmjd >= (SELECT start_mjd FROM date_range)\n)\n-- Retrieve objects classified as 'Transient', 'Stochastic', or 'Periodic' by the light curve classifier\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n    SELECT oid FROM object_time_filtered\n)\nAND EXISTS (\n    SELECT 1\n    FROM probability p\n    WHERE p.oid = o.oid\n      AND p.class_name IN ('Transient', 'Stochastic', 'Periodic')\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n);\n```"
                },
                "in_toks": 2579,
                "out_toks": 207,
                "id": "chatcmpl-BjAdTFYG29KWkBL6qtGlNMmFjPeXL",
                "created": 1750105343,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "12": {
        "0": {
            "req_id": "12",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 807,
                "out_toks": 14,
                "id": "chatcmpl-BjAcouBO9FjaxiiAlcv9yKuTS4IJo",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the polygon with the given coordinates\nWITH polygon_coords AS (\n    SELECT ARRAY[\n        ROW(-20, -20),\n        ROW(-2, -20),\n        ROW(20, 1),\n        ROW(10, 10),\n        ROW(-20, -20) -- close the polygon\n    ]::point[] AS poly\n),\n-- Select objects with first detection between Feb 13 and Sep 10\nobjects_in_time AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\n-- Filter objects that are classified as SNe (Supernovae)\nsne_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM objects_in_time o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name LIKE 'SNI%'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n),\n-- Perform spatial filtering using Q3C to check if objects are within the polygon\nfiltered_objects AS (\n    SELECT s.oid, s.meanra, s.meandec\n    FROM sne_objects s, polygon_coords pc\n    WHERE q3c_poly_query(s.meanra, s.meandec, pc.poly)\n)\nSELECT oid, meanra, meandec\nFROM filtered_objects;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the polygon with the given coordinates\nWITH polygon_coords AS (\n    SELECT ARRAY[\n        ROW(-20, -20),\n        ROW(-2, -20),\n        ROW(20, 1),\n        ROW(10, 10),\n        ROW(-20, -20) -- close the polygon\n    ]::point[] AS poly\n),\n-- Select objects with first detection between Feb 13 and Sep 10\nobjects_in_time AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\n-- Filter objects that are classified as SNe (Supernovae)\nsne_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM objects_in_time o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name LIKE 'SNI%'\n          AND p.classifier_name IN ('lc_classifier', 'lc_classifier_top', 'lc_classifier_transient', 'lc_classifier_stochastic', 'lc_classifier_periodic', 'stamp_classifier')\n          AND p.ranking = 1\n    )\n),\n-- Perform spatial filtering using Q3C to check if objects are within the polygon\nfiltered_objects AS (\n    SELECT s.oid, s.meanra, s.meandec\n    FROM sne_objects s, polygon_coords pc\n    WHERE q3c_poly_query(s.meanra, s.meandec, pc.poly)\n)\nSELECT oid, meanra, meandec\nFROM filtered_objects;\n```"
                },
                "in_toks": 2624,
                "out_toks": 335,
                "id": "chatcmpl-BjAdU686ckt3ef02ZFd1JQX1SkUXI",
                "created": 1750105344,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "12",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 807,
                "out_toks": 14,
                "id": "chatcmpl-BjAcouBO9FjaxiiAlcv9yKuTS4IJo",
                "created": 1750105302,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the polygon with the given coordinates\nWITH polygon_coords AS (\n    SELECT ARRAY[\n        ROW(-20, -20),\n        ROW(-2, -20),\n        ROW(20, 1),\n        ROW(10, 10),\n        ROW(-20, -20) -- close the polygon\n    ]::point[] AS poly\n),\n-- Select objects with first detection between Feb 13 (MJD 59988.0) and Sep 10 (MJD 60197.0)\nobjects_in_time AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\n-- Filter objects within the polygon using Q3C poly_query\nobjects_in_polygon AS (\n    SELECT oid, meanra, meandec\n    FROM objects_in_time\n    WHERE q3c_poly_query(meanra, meandec, (SELECT poly FROM polygon_coords))\n),\n-- Retrieve the probability for class 'SNe' (Supernovae) with the highest ranking (most probable)\nsupernova_prob AS (\n    SELECT p.oid, p.class_name, p.ranking\n    FROM probability p\n    WHERE p.class_name ILIKE 'SNe%'\n      AND p.ranking = 1\n)\n-- Select oids, mean ra, dec for objects classified as SNe within the time and polygon constraints\nSELECT o.oid, o.meanra, o.meandec\nFROM objects_in_polygon o\nJOIN supernova_prob sp ON o.oid = sp.oid\nWHERE sp.class_name ILIKE 'SNe%'\n;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the polygon with the given coordinates\nWITH polygon_coords AS (\n    SELECT ARRAY[\n        ROW(-20, -20),\n        ROW(-2, -20),\n        ROW(20, 1),\n        ROW(10, 10),\n        ROW(-20, -20) -- close the polygon\n    ]::point[] AS poly\n),\n-- Select objects with first detection between Feb 13 (MJD 59988.0) and Sep 10 (MJD 60197.0)\nobjects_in_time AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 59988.0 AND 60197.0\n),\n-- Filter objects within the polygon using Q3C poly_query\nobjects_in_polygon AS (\n    SELECT oid, meanra, meandec\n    FROM objects_in_time\n    WHERE q3c_poly_query(meanra, meandec, (SELECT poly FROM polygon_coords))\n),\n-- Retrieve the probability for class 'SNe' (Supernovae) with the highest ranking (most probable)\nsupernova_prob AS (\n    SELECT p.oid, p.class_name, p.ranking\n    FROM probability p\n    WHERE p.class_name ILIKE 'SNe%'\n      AND p.ranking = 1\n)\n-- Select oids, mean ra, dec for objects classified as SNe within the time and polygon constraints\nSELECT o.oid, o.meanra, o.meandec\nFROM objects_in_polygon o\nJOIN supernova_prob sp ON o.oid = sp.oid\nWHERE sp.class_name ILIKE 'SNe%'\n;\n```"
                },
                "in_toks": 2624,
                "out_toks": 339,
                "id": "chatcmpl-BjAdYo9htnMIRcRgdzscIsjZ6MAqD",
                "created": 1750105348,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "57": {
        "0": {
            "req_id": "57",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']",
                    "1": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 881,
                "out_toks": 22,
                "id": "chatcmpl-BjAcp7V12NZMkuMacCfJ0Mi4PstEz",
                "created": 1750105303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        input_objects io\n    JOIN\n        object o ON TRUE\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        q3c_join(d.ra, d.dec, io.ra, io.dec, io.radius_deg)\n    GROUP BY\n        io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    input_id,\n    input_ra,\n    input_dec,\n    radius_deg,\n    ztf_oid,\n    detection_count,\n    mean_ra,\n    mean_dec,\n    first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    first_detection_mjd DESC;",
            "sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        input_objects io\n    JOIN\n        object o ON TRUE\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        q3c_join(d.ra, d.dec, io.ra, io.dec, io.radius_deg)\n    GROUP BY\n        io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    input_id,\n    input_ra,\n    input_dec,\n    radius_deg,\n    ztf_oid,\n    detection_count,\n    mean_ra,\n    mean_dec,\n    first_detection_mjd\nFROM\n    matched_objects\nORDER BY\n    first_detection_mjd DESC;"
                },
                "in_toks": 3140,
                "out_toks": 328,
                "id": "chatcmpl-BjAdSiIjkdzw59eGO2SeaU0v4nfdk",
                "created": 1750105342,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "57",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'xmatch', 'detection']",
                    "1": "['object', 'xmatch', 'detection']"
                },
                "in_toks": 881,
                "out_toks": 22,
                "id": "chatcmpl-BjAcp7V12NZMkuMacCfJ0Mi4PstEz",
                "created": 1750105303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        input_objects io\n    JOIN\n        object o ON TRUE\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        q3c_join(d.ra, d.dec, io.ra, io.dec, io.radius_deg)\n    GROUP BY\n        io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    mo.ztf_oid AS ztf_object_id,\n    mo.detection_count,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM\n    input_objects io\nLEFT JOIN\n    matched_objects mo ON io.identifier = mo.input_id\nORDER BY\n    mo.first_detection_mjd DESC NULLS LAST;",
            "sql_response": {
                "responses": {
                    "0": "WITH input_objects AS (\n    SELECT\n        'id_1' AS identifier,\n        354.67 AS ra,\n        15.954 AS dec,\n        30.0 / 3600 AS radius_deg -- 30 arcsec converted to degrees\n    UNION ALL\n    SELECT\n        'id_2' AS identifier,\n        20.7993 AS ra,\n        1.00331 AS dec,\n        20.0 / 3600 AS radius_deg -- 20 arcsec converted to degrees\n),\nmatched_objects AS (\n    SELECT\n        io.identifier AS input_id,\n        io.ra AS input_ra,\n        io.dec AS input_dec,\n        io.radius_deg,\n        o.oid AS ztf_oid,\n        COUNT(d.candid) AS detection_count,\n        AVG(d.ra) AS mean_ra,\n        AVG(d.dec) AS mean_dec,\n        MIN(d.mjd) AS first_detection_mjd\n    FROM\n        input_objects io\n    JOIN\n        object o ON TRUE\n    JOIN\n        detection d ON o.oid = d.oid\n    WHERE\n        q3c_join(d.ra, d.dec, io.ra, io.dec, io.radius_deg)\n    GROUP BY\n        io.identifier, io.ra, io.dec, io.radius_deg, o.oid\n)\nSELECT\n    io.identifier AS input_object_id,\n    io.ra AS input_object_ra,\n    io.dec AS input_object_dec,\n    io.radius_deg AS search_radius_deg,\n    mo.ztf_oid AS ztf_object_id,\n    mo.detection_count,\n    mo.mean_ra,\n    mo.mean_dec,\n    mo.first_detection_mjd\nFROM\n    input_objects io\nLEFT JOIN\n    matched_objects mo ON io.identifier = mo.input_id\nORDER BY\n    mo.first_detection_mjd DESC NULLS LAST;"
                },
                "in_toks": 3140,
                "out_toks": 377,
                "id": "chatcmpl-BjAdSLIawKaEE1ECj0jUXtVl8gyfc",
                "created": 1750105342,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "75": {
        "0": {
            "req_id": "75",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-BjAcpoX6KBj2s5Pe62SnDhBvljTGc",
                "created": 1750105303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2040,
                "out_toks": 25,
                "id": "chatcmpl-BjAdTtKiIRxT7VgFccYghhHTwMN5l",
                "created": 1750105343,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "75",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf']",
                    "1": "['ss_ztf']"
                },
                "in_toks": 762,
                "out_toks": 12,
                "id": "chatcmpl-BjAcpoX6KBj2s5Pe62SnDhBvljTGc",
                "created": 1750105303,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM ss_ztf\nWHERE ssnamenr IS NOT NULL\nLIMIT 100;\n```"
                },
                "in_toks": 2040,
                "out_toks": 25,
                "id": "chatcmpl-BjAdTx35JISx3c8g76FyYUzjPpQgy",
                "created": 1750105343,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "43": {
        "0": {
            "req_id": "43",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 799,
                "out_toks": 14,
                "id": "chatcmpl-BjAcq7AXvqb28MUct6o0YvBDB05R5",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select relevant columns for the specified objects and r-band filter (fid=2)\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for the specified objects and r-band filter (fid=2)\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2;\n```"
                },
                "in_toks": 3194,
                "out_toks": 101,
                "id": "chatcmpl-BjAdTqkbd3u2ad4oHgWmKxjhbKbuQ",
                "created": 1750105343,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "43",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 799,
                "out_toks": 14,
                "id": "chatcmpl-BjAcq7AXvqb28MUct6o0YvBDB05R5",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select relevant columns for specified objects and r-band filter (fid=2)\nSELECT \n    d.oid AS ztf_identifier,\n    d.candid AS candidate_id,\n    d.xpos,\n    d.ypos,\n    d.scorr AS peak_pixel_snr\nFROM \n    dataquality d\nWHERE \n    d.oid IN ('ZTF20acwrybw', 'ZTF22abugigx')\n    AND d.fid = 2;\n```"
                },
                "in_toks": 3194,
                "out_toks": 100,
                "id": "chatcmpl-BjAdU7LZYSo0Uv2agjkkcC0M7g8t9",
                "created": 1750105344,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "89": {
        "0": {
            "req_id": "89",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'dataquality']",
                    "1": "['object', 'probability', 'dataquality']"
                },
                "in_toks": 778,
                "out_toks": 22,
                "id": "chatcmpl-BjAcqQ5GjA6PXLIOV4QT4rIaNamFv",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 50 objects with probability > 0.7 of being supernovae (SN) in the stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    ORDER BY p.probability DESC\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 50 objects with probability > 0.7 of being supernovae (SN) in the stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    ORDER BY p.probability DESC\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3357,
                "out_toks": 114,
                "id": "chatcmpl-BjAdU5ZtPtcUfxkzRgB4g3YvbfIiK",
                "created": 1750105344,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "89",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'dataquality']",
                    "1": "['object', 'probability', 'dataquality']"
                },
                "in_toks": 778,
                "out_toks": 22,
                "id": "chatcmpl-BjAcqQ5GjA6PXLIOV4QT4rIaNamFv",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 50 objects with probability > 0.7 of being supernovae ('SN') in the stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    ORDER BY p.ranking -- optional, to prioritize most probable objects\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 50 objects with probability > 0.7 of being supernovae ('SN') in the stamp_classifier\nWITH sn_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SN'\n      AND p.classifier_name = 'stamp_classifier'\n      AND p.probability > 0.7\n    ORDER BY p.ranking -- optional, to prioritize most probable objects\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);\n```"
                },
                "in_toks": 3357,
                "out_toks": 120,
                "id": "chatcmpl-BjAdVoggz8tVIE9mwdiqo55x087nB",
                "created": 1750105345,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "72": {
        "0": {
            "req_id": "72",
            "experiment_id": "run_0",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']",
                    "1": "['reference']"
                },
                "in_toks": 767,
                "out_toks": 6,
                "id": "chatcmpl-BjAcqrmHAuqrF8YXj3EitkMwRHssr",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2249,
                "out_toks": 30,
                "id": "chatcmpl-BjAdVaXK4RTXzhyuOD64VDLScMdY2",
                "created": 1750105345,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "72",
            "experiment_id": "run_1",
            "pred_tables": [
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['reference']",
                    "1": "['reference']"
                },
                "in_toks": 767,
                "out_toks": 6,
                "id": "chatcmpl-BjAcqrmHAuqrF8YXj3EitkMwRHssr",
                "created": 1750105304,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM reference \nWHERE oid = 'ZTF20actnuls' AND rfid = 712120223;\n```"
                },
                "in_toks": 2249,
                "out_toks": 30,
                "id": "chatcmpl-BjAdWDGtNw8aYC4jECltOjp1LTjcb",
                "created": 1750105346,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "103": {
        "0": {
            "req_id": "103",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 829,
                "out_toks": 28,
                "id": "chatcmpl-BjAcrPfFYQ3d5CXdQeaagoDeEdiTF",
                "created": 1750105305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with specific conditions:\n-- 1. Distance to nearest PS1 source > 5 arcsec\n-- 2. Probability > 0.7 for classes other than supernova in 'lc_classifier' classifier\n-- 3. Limit to 200 results, ordered by nearest PS1 source distance\n\nWITH filtered_objects AS (\n    SELECT o.*, p.*, ps.*\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN ps1_ztf ps ON o.oid = ps.oid\n    WHERE p.class_name != 'SN' -- Exclude supernova class\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND ps.distpsnr1 > 5 -- Distance to PS1 source > 5 arcsec\n)\nSELECT *\nFROM filtered_objects\nORDER BY distpsnr1\nLIMIT 200;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific conditions:\n-- 1. Distance to nearest PS1 source > 5 arcsec\n-- 2. Probability > 0.7 for classes other than supernova in 'lc_classifier' classifier\n-- 3. Limit to 200 results, ordered by nearest PS1 source distance\n\nWITH filtered_objects AS (\n    SELECT o.*, p.*, ps.*\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN ps1_ztf ps ON o.oid = ps.oid\n    WHERE p.class_name != 'SN' -- Exclude supernova class\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.7\n      AND ps.distpsnr1 > 5 -- Distance to PS1 source > 5 arcsec\n)\nSELECT *\nFROM filtered_objects\nORDER BY distpsnr1\nLIMIT 200;\n```"
                },
                "in_toks": 3364,
                "out_toks": 195,
                "id": "chatcmpl-BjAdXbwt1kiqf8HKnDbtrdG6SKedo",
                "created": 1750105347,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "103",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ps1_ztf']"
                },
                "in_toks": 829,
                "out_toks": 28,
                "id": "chatcmpl-BjAcrPfFYQ3d5CXdQeaagoDeEdiTF",
                "created": 1750105305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with specific conditions\nWITH filtered_objects AS (\n    SELECT o.*, p.*, p1.*\n    FROM object o\n    -- Join with probability table to filter by probability > 0.7 and class not being supernova\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name != 'SN' -- Exclude supernova class\n      AND p.probability > 0.7\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1 -- Most probable class\n    -- Join with ps1_ztf to get PS1 sources info\n    JOIN ps1_ztf p1 ON o.oid = p1.oid\n    -- Filter for objects with nearest PS1 source distance > 5 arcsec\n    WHERE p1.distpsnr1 > 5\n)\n-- Select all columns from object, probability, and ps1_ztf tables\nSELECT o.*, p.*, p1.*\nFROM filtered_objects o\n-- Order by the nearest PS1 source distance\nORDER BY p1.distpsnr1\n-- Limit to 200 objects\nLIMIT 200;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with specific conditions\nWITH filtered_objects AS (\n    SELECT o.*, p.*, p1.*\n    FROM object o\n    -- Join with probability table to filter by probability > 0.7 and class not being supernova\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name != 'SN' -- Exclude supernova class\n      AND p.probability > 0.7\n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1 -- Most probable class\n    -- Join with ps1_ztf to get PS1 sources info\n    JOIN ps1_ztf p1 ON o.oid = p1.oid\n    -- Filter for objects with nearest PS1 source distance > 5 arcsec\n    WHERE p1.distpsnr1 > 5\n)\n-- Select all columns from object, probability, and ps1_ztf tables\nSELECT o.*, p.*, p1.*\nFROM filtered_objects o\n-- Order by the nearest PS1 source distance\nORDER BY p1.distpsnr1\n-- Limit to 200 objects\nLIMIT 200;\n```"
                },
                "in_toks": 3364,
                "out_toks": 242,
                "id": "chatcmpl-BjAdXAM3wefqzD8JR6Gsw6nBmMwb3",
                "created": 1750105347,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "54": {
        "0": {
            "req_id": "54",
            "experiment_id": "run_0",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']",
                    "1": "['non_detection']"
                },
                "in_toks": 794,
                "out_toks": 8,
                "id": "chatcmpl-BjAcraunn93XBgyyQKaqQxiuRJy8k",
                "created": 1750105305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;\n```"
                },
                "in_toks": 2040,
                "out_toks": 41,
                "id": "chatcmpl-BjAdaA8CRQTBg6oYPUysMtrDtsZGR",
                "created": 1750105350,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "54",
            "experiment_id": "run_1",
            "pred_tables": [
                "non_detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['non_detection']",
                    "1": "['non_detection']"
                },
                "in_toks": 794,
                "out_toks": 8,
                "id": "chatcmpl-BjAcraunn93XBgyyQKaqQxiuRJy8k",
                "created": 1750105305,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT *\nFROM non_detection\nWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')\n  AND diffmaglim > 19.5;\n```"
                },
                "in_toks": 2040,
                "out_toks": 41,
                "id": "chatcmpl-BjAdY9mrCan9B3StFEGj8hzJwKOXr",
                "created": 1750105348,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "99": {
        "0": {
            "req_id": "99",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']",
                    "1": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 799,
                "out_toks": 26,
                "id": "chatcmpl-BjAcswo1SvrNPbHj9rTNX5MIwDR3W",
                "created": 1750105306,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 10 objects with first detection after MJD 60310\nWITH filtered_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd > 60310\n    -- Get objects with probability 1 of being an asteroid in stamp_classifier\n    AND oid IN (\n        SELECT oid\n        FROM probability\n        WHERE class_name = 'asteroid'\n          AND classifier_name = 'stamp_classifier'\n          AND probability = 1\n    )\n    ORDER BY firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from forced_photometry for these objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM filtered_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 10 objects with first detection after MJD 60310\nWITH filtered_objects AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd > 60310\n    -- Get objects with probability 1 of being an asteroid in stamp_classifier\n    AND oid IN (\n        SELECT oid\n        FROM probability\n        WHERE class_name = 'asteroid'\n          AND classifier_name = 'stamp_classifier'\n          AND probability = 1\n    )\n    ORDER BY firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from forced_photometry for these objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM filtered_objects);\n```"
                },
                "in_toks": 3274,
                "out_toks": 148,
                "id": "chatcmpl-BjAdYEW2YlPYtzK1YnCs0GLuvsoTx",
                "created": 1750105348,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "99",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'forced_photometry']",
                    "1": "['object', 'probability', 'forced_photometry']"
                },
                "in_toks": 799,
                "out_toks": 26,
                "id": "chatcmpl-BjAcswo1SvrNPbHj9rTNX5MIwDR3W",
                "created": 1750105306,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 10 objects with first detection after MJD 60310\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n    -- Get the object with probability=1 for 'asteroid' in 'stamp_classifier'\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n          AND p.ranking = 1\n    )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from 'forced_photometry' for these objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM filtered_objects);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 10 objects with first detection after MJD 60310\nWITH filtered_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n    -- Get the object with probability=1 for 'asteroid' in 'stamp_classifier'\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.probability = 1\n          AND p.ranking = 1\n    )\n    ORDER BY o.firstmjd\n    LIMIT 10\n)\n-- Retrieve all columns from 'forced_photometry' for these objects\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (SELECT oid FROM filtered_objects);\n```"
                },
                "in_toks": 3274,
                "out_toks": 184,
                "id": "chatcmpl-BjAdY6W4Q1ls88OjHSEzetMeIeEpg",
                "created": 1750105348,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "40": {
        "0": {
            "req_id": "40",
            "experiment_id": "run_0",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 810,
                "out_toks": 8,
                "id": "chatcmpl-BjAcsW8S4ZQwbT31bO6D4y5RyAXEN",
                "created": 1750105306,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the target coordinates and search radius in degrees (1 arcsec = 1/3600 degrees)\nWITH target AS (\n    SELECT \n        23.6488 AS ra,\n        30.7314 AS dec,\n        1.0/3600.0 AS radius -- 1 arcsecond in degrees\n)\n-- Select all ALLWISE objects within 1 arcsecond of the target coordinates\nSELECT \n    aw.oid_catalog,\n    aw.ra,\n    aw.dec,\n    aw.w1mpro,\n    aw.w1sigmpro,\n    aw.w2mpro,\n    aw.w2sigmpro,\n    aw.j_m_2mass,\n    aw.h_m_2mass,\n    aw.k_m_2mass\nFROM \n    allwise aw,\n    target t\nWHERE \n    q3c_join(aw.ra, aw.dec, t.ra, t.dec, t.radius);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the target coordinates and search radius in degrees (1 arcsec = 1/3600 degrees)\nWITH target AS (\n    SELECT \n        23.6488 AS ra,\n        30.7314 AS dec,\n        1.0/3600.0 AS radius -- 1 arcsecond in degrees\n)\n-- Select all ALLWISE objects within 1 arcsecond of the target coordinates\nSELECT \n    aw.oid_catalog,\n    aw.ra,\n    aw.dec,\n    aw.w1mpro,\n    aw.w1sigmpro,\n    aw.w2mpro,\n    aw.w2sigmpro,\n    aw.j_m_2mass,\n    aw.h_m_2mass,\n    aw.k_m_2mass\nFROM \n    allwise aw,\n    target t\nWHERE \n    q3c_join(aw.ra, aw.dec, t.ra, t.dec, t.radius);\n```"
                },
                "in_toks": 2625,
                "out_toks": 192,
                "id": "chatcmpl-BjAdZozvFvHafwvq5UtzWHg3Eb4Zq",
                "created": 1750105349,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "40",
            "experiment_id": "run_1",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 810,
                "out_toks": 8,
                "id": "chatcmpl-BjAcsW8S4ZQwbT31bO6D4y5RyAXEN",
                "created": 1750105306,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the target coordinates and search radius in degrees (1 arcsec = 1/3600 degrees)\nWITH target AS (\n    SELECT \n        23.6488 AS ra,\n        30.7314 AS dec,\n        1.0/3600.0 AS radius_deg\n)\n-- Select all ALLWISE objects within 1 arcsec of the target coordinates\nSELECT \n    aw.oid_catalog,\n    aw.ra,\n    aw.dec,\n    aw.w1mpro,\n    aw.w1sigmpro,\n    aw.w2mpro,\n    aw.w2sigmpro,\n    aw.j_m_2mass,\n    aw.j_msig_2mass\nFROM \n    allwise aw,\n    target t\nWHERE \n    q3c_join(aw.ra, aw.dec, t.ra, t.dec, t.radius_deg);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the target coordinates and search radius in degrees (1 arcsec = 1/3600 degrees)\nWITH target AS (\n    SELECT \n        23.6488 AS ra,\n        30.7314 AS dec,\n        1.0/3600.0 AS radius_deg\n)\n-- Select all ALLWISE objects within 1 arcsec of the target coordinates\nSELECT \n    aw.oid_catalog,\n    aw.ra,\n    aw.dec,\n    aw.w1mpro,\n    aw.w1sigmpro,\n    aw.w2mpro,\n    aw.w2sigmpro,\n    aw.j_m_2mass,\n    aw.j_msig_2mass\nFROM \n    allwise aw,\n    target t\nWHERE \n    q3c_join(aw.ra, aw.dec, t.ra, t.dec, t.radius_deg);\n```"
                },
                "in_toks": 2625,
                "out_toks": 180,
                "id": "chatcmpl-BjAdZlCwceAo5KjwFg1BAkxNSobI0",
                "created": 1750105349,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "80": {
        "0": {
            "req_id": "80",
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-BjAct64I3F5nDrjdfHP6dO5CE2Kox",
                "created": 1750105307,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from xmatch where the object matches are within 0.5 arcsec of the specified ZTF objects\nSELECT *\nFROM xmatch\nWHERE (oid IN ('ZTF22abcmmkz', 'ZTF18abbufof'))\n  AND dist < 0.5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from xmatch where the object matches are within 0.5 arcsec of the specified ZTF objects\nSELECT *\nFROM xmatch\nWHERE (oid IN ('ZTF22abcmmkz', 'ZTF18abbufof'))\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2027,
                "out_toks": 67,
                "id": "chatcmpl-BjAdase5joljj58SmoHNsCKnQryh0",
                "created": 1750105350,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "80",
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 798,
                "out_toks": 8,
                "id": "chatcmpl-BjAct64I3F5nDrjdfHP6dO5CE2Kox",
                "created": 1750105307,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from xmatch where the object matches are within 0.5 arcsec of the specified ZTF objects\nSELECT *\nFROM xmatch\nWHERE (oid = 'ZTF22abcmmkz' OR oid = 'ZTF18abbufof')\n  AND dist < 0.5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from xmatch where the object matches are within 0.5 arcsec of the specified ZTF objects\nSELECT *\nFROM xmatch\nWHERE (oid = 'ZTF22abcmmkz' OR oid = 'ZTF18abbufof')\n  AND dist < 0.5;\n```"
                },
                "in_toks": 2027,
                "out_toks": 70,
                "id": "chatcmpl-BjAdapJITIINvnnsrySc9YaNPxH8X",
                "created": 1750105350,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "45": {
        "0": {
            "req_id": "45",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 781,
                "out_toks": 14,
                "id": "chatcmpl-BjActi3yvQLLy0eK8w7Q6xLmNOWqU",
                "created": 1750105307,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Count the number of rows in 'dataquality' for specified objects with min 'chipsf' >= 5\nSELECT COUNT(*) \nFROM dataquality\nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n  AND chipsf >= 5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Count the number of rows in 'dataquality' for specified objects with min 'chipsf' >= 5\nSELECT COUNT(*) \nFROM dataquality\nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n  AND chipsf >= 5;\n```"
                },
                "in_toks": 3176,
                "out_toks": 63,
                "id": "chatcmpl-BjAdbrr18HAqT8IEhoxPUQZiHETm8",
                "created": 1750105351,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "45",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'dataquality']",
                    "1": "['object', 'dataquality']"
                },
                "in_toks": 781,
                "out_toks": 14,
                "id": "chatcmpl-BjActi3yvQLLy0eK8w7Q6xLmNOWqU",
                "created": 1750105307,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Count the number of rows in 'dataquality' for specified objects with min 'chipsf' >= 5\nSELECT COUNT(*) \nFROM dataquality\nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n  AND chipsf >= 5;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Count the number of rows in 'dataquality' for specified objects with min 'chipsf' >= 5\nSELECT COUNT(*) \nFROM dataquality\nWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')\n  AND chipsf >= 5;\n```"
                },
                "in_toks": 3176,
                "out_toks": 63,
                "id": "chatcmpl-BjAdbGCZG1V47m9Uervg80EBVRqwo",
                "created": 1750105351,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "63": {
        "0": {
            "req_id": "63",
            "experiment_id": "run_0",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-BjAcuKTdJelZxo2B1l1r7PoShHxUt",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve all rows from 'probability' and 'lc_classifier' tables for specified objects with ranking 1 or 2, sorted by ranking\n\nWITH target_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nSELECT p.*, lc.*\nFROM probability p\nJOIN object o ON p.oid = o.oid\nLEFT JOIN (\n    SELECT *\n    FROM (\n        SELECT *, ROW_NUMBER() OVER (PARTITION BY oid, classifier_name, classifier_version ORDER BY ranking) AS rn\n        FROM (\n            SELECT *\n            FROM (\n                SELECT * FROM probability WHERE ranking IN (1, 2)\n            ) prob\n            JOIN (\n                SELECT oid, classifier_name, classifier_version, * FROM (\n                    SELECT *, ROW_NUMBER() OVER (PARTITION BY oid, classifier_name, classifier_version ORDER BY ranking) AS rn\n                    FROM probability\n                ) prob2\n            ) prob_class ON prob.oid = prob_class.oid AND prob.classifier_name = prob_class.classifier_name AND prob.classifier_version = prob_class.classifier_version\n        ) sub\n    ) sub2 WHERE rn = 1\n) lc ON o.oid = lc.oid\nWHERE o.oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all rows from 'probability' and 'lc_classifier' tables for specified objects with ranking 1 or 2, sorted by ranking\n\nWITH target_objects AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nSELECT p.*, lc.*\nFROM probability p\nJOIN object o ON p.oid = o.oid\nLEFT JOIN (\n    SELECT *\n    FROM (\n        SELECT *, ROW_NUMBER() OVER (PARTITION BY oid, classifier_name, classifier_version ORDER BY ranking) AS rn\n        FROM (\n            SELECT *\n            FROM (\n                SELECT * FROM probability WHERE ranking IN (1, 2)\n            ) prob\n            JOIN (\n                SELECT oid, classifier_name, classifier_version, * FROM (\n                    SELECT *, ROW_NUMBER() OVER (PARTITION BY oid, classifier_name, classifier_version ORDER BY ranking) AS rn\n                    FROM probability\n                ) prob2\n            ) prob_class ON prob.oid = prob_class.oid AND prob.classifier_name = prob_class.classifier_name AND prob.classifier_version = prob_class.classifier_version\n        ) sub\n    ) sub2 WHERE rn = 1\n) lc ON o.oid = lc.oid\nWHERE o.oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') AND p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2093,
                "out_toks": 301,
                "id": "chatcmpl-BjAdcUtw2iKOuaEl7W2LMFR4DSny4",
                "created": 1750105352,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "63",
            "experiment_id": "run_1",
            "pred_tables": [
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['probability']",
                    "1": "['probability']"
                },
                "in_toks": 793,
                "out_toks": 8,
                "id": "chatcmpl-BjAcuKTdJelZxo2B1l1r7PoShHxUt",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve all probability and light curve classifier entries with ranking 1 or 2 for specified objects\nSELECT *\nFROM (\n    -- Subquery to get OIDs for the specified ZTF identifiers\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n) AS oid_sub\nJOIN probability p ON p.oid = oid_sub.oid\nWHERE p.ranking IN (1, 2)\nORDER BY p.ranking;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all probability and light curve classifier entries with ranking 1 or 2 for specified objects\nSELECT *\nFROM (\n    -- Subquery to get OIDs for the specified ZTF identifiers\n    SELECT o.oid\n    FROM object o\n    WHERE o.oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n) AS oid_sub\nJOIN probability p ON p.oid = oid_sub.oid\nWHERE p.ranking IN (1, 2)\nORDER BY p.ranking;\n```"
                },
                "in_toks": 2093,
                "out_toks": 112,
                "id": "chatcmpl-BjAdcAEZ2NPOSCPhJiAXvotbllMLt",
                "created": 1750105352,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "73": {
        "0": {
            "req_id": "73",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "ss_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf']",
                    "1": "['object', 'ss_ztf', 'reference']"
                },
                "in_toks": 780,
                "out_toks": 21,
                "id": "chatcmpl-BjAcudxcZ9nk8kGmWilsQXf71spjp",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude of the nearest known Solar System object for the specified ZTF object\nWITH target_object AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF21acitntz'\n),\nnearest_ss AS (\n    SELECT s.oid, s.ssnamenr, s.ssmagnr\n    FROM ss_ztf s\n    JOIN target_object t ON s.oid = t.oid\n)\nSELECT t.oid AS ztf_object_id, s.ssnamenr AS mpc_name, s.ssmagnr AS mpc_magnitude\nFROM target_object t\nJOIN nearest_ss s ON t.oid = s.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude of the nearest known Solar System object for the specified ZTF object\nWITH target_object AS (\n    SELECT oid\n    FROM object\n    WHERE oid = 'ZTF21acitntz'\n),\nnearest_ss AS (\n    SELECT s.oid, s.ssnamenr, s.ssmagnr\n    FROM ss_ztf s\n    JOIN target_object t ON s.oid = t.oid\n)\nSELECT t.oid AS ztf_object_id, s.ssnamenr AS mpc_name, s.ssmagnr AS mpc_magnitude\nFROM target_object t\nJOIN nearest_ss s ON t.oid = s.oid;\n```"
                },
                "in_toks": 2539,
                "out_toks": 150,
                "id": "chatcmpl-BjAddV02HzU3mXZiZfPOlWADuppyy",
                "created": 1750105353,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "73",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "ss_ztf",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ss_ztf']",
                    "1": "['object', 'ss_ztf', 'reference']"
                },
                "in_toks": 780,
                "out_toks": 21,
                "id": "chatcmpl-BjAcudxcZ9nk8kGmWilsQXf71spjp",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude for the nearest known Solar System object to the specified ZTF object\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve the object ID, MPC name, and MPC magnitude for the nearest known Solar System object to the specified ZTF object\nSELECT \n    o.oid,\n    sss.ssnamenr AS mpc_name,\n    sss.ssmagnr AS mpc_magnitude\nFROM \n    object o\nLEFT JOIN \n    ss_ztf sss ON o.oid = sss.oid\nWHERE \n    o.oid = 'ZTF21acitntz';\n```"
                },
                "in_toks": 2905,
                "out_toks": 103,
                "id": "chatcmpl-BjAddOjeQrPeqqxsMm2EsXFhbx75k",
                "created": 1750105353,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "92": {
        "0": {
            "req_id": "92",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'feature']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 807,
                "out_toks": 25,
                "id": "chatcmpl-BjAcu22HHR4AHrUZNk69E0kYYB2PK",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 10 detections in the g band and no dubious corrections\nWITH g_band_detections AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n),\nqualified_objects AS (\n    SELECT\n        o.oid,\n        o.reference_change,\n        gbd.n_detections\n    FROM\n        object o\n    JOIN\n        g_band_detections gbd ON o.oid = gbd.oid\n    WHERE\n        gbd.n_detections >= 10\n        AND o.reference_change = FALSE\n)\nSELECT\n    q.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    qualified_objects q\nJOIN\n    probability p ON q.oid = p.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\nORDER BY\n    q.oid\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 10 detections in the g band and no dubious corrections\nWITH g_band_detections AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS n_detections\n    FROM\n        detection d\n    WHERE\n        d.fid = 1 -- g band\n        AND d.dubious = FALSE\n    GROUP BY\n        d.oid\n),\nqualified_objects AS (\n    SELECT\n        o.oid,\n        o.reference_change,\n        gbd.n_detections\n    FROM\n        object o\n    JOIN\n        g_band_detections gbd ON o.oid = gbd.oid\n    WHERE\n        gbd.n_detections >= 10\n        AND o.reference_change = FALSE\n)\nSELECT\n    q.oid AS \"ZTF identifier\",\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM\n    qualified_objects q\nJOIN\n    probability p ON q.oid = p.oid\nWHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\nORDER BY\n    q.oid\nLIMIT 500;\n```"
                },
                "in_toks": 5569,
                "out_toks": 247,
                "id": "chatcmpl-BjAddmPS8EX4fwNdYFGqGChq7F8xX",
                "created": 1750105353,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "92",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'feature']",
                    "1": "['object', 'probability', 'detection']"
                },
                "in_toks": 807,
                "out_toks": 25,
                "id": "chatcmpl-BjAcu22HHR4AHrUZNk69E0kYYB2PK",
                "created": 1750105308,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with at least 10 detections in the g band (fid=1) and no dubious corrections\nWITH g_band_detections AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS detection_count\n    FROM detection d\n    WHERE d.fid = 1\n      AND d.dubious = FALSE\n    GROUP BY d.oid\n),\nfiltered_objects AS (\n    SELECT\n        o.oid\n    FROM object o\n    JOIN g_band_detections g ON o.oid = g.oid\n    WHERE g.detection_count >= 10\n)\n-- Retrieve the required information with probability ranking 1 for the light curve classifier\nSELECT\n    fo.oid AS ztf_id,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM filtered_objects fo\nJOIN probability p ON fo.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nORDER BY fo.oid\nLIMIT 500;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with at least 10 detections in the g band (fid=1) and no dubious corrections\nWITH g_band_detections AS (\n    SELECT\n        d.oid,\n        COUNT(*) AS detection_count\n    FROM detection d\n    WHERE d.fid = 1\n      AND d.dubious = FALSE\n    GROUP BY d.oid\n),\nfiltered_objects AS (\n    SELECT\n        o.oid\n    FROM object o\n    JOIN g_band_detections g ON o.oid = g.oid\n    WHERE g.detection_count >= 10\n)\n-- Retrieve the required information with probability ranking 1 for the light curve classifier\nSELECT\n    fo.oid AS ztf_id,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM filtered_objects fo\nJOIN probability p ON fo.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\nORDER BY fo.oid\nLIMIT 500;\n```"
                },
                "in_toks": 3137,
                "out_toks": 217,
                "id": "chatcmpl-BjAde4QquZpd09Al6IULjnnFabLQy",
                "created": 1750105354,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "102": {
        "0": {
            "req_id": "102",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat']",
                    "1": "['object', 'probability', 'magstat']"
                },
                "in_toks": 798,
                "out_toks": 22,
                "id": "chatcmpl-BjAcvQz5VhKwIQbNQqsDylDCtaE3O",
                "created": 1750105309,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_candidates AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_candidates)\n  AND ms.fid = 1 -- Assuming fid=1 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_candidates AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nWHERE ms.oid IN (SELECT oid FROM agn_candidates)\n  AND ms.fid = 1 -- Assuming fid=1 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13\nLIMIT 50;\n```"
                },
                "in_toks": 3297,
                "out_toks": 189,
                "id": "chatcmpl-BjAdfSsKjsy0XS7Gky9szpmz8pkoU",
                "created": 1750105355,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "102",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'magstat']",
                    "1": "['object', 'probability', 'magstat']"
                },
                "in_toks": 798,
                "out_toks": 22,
                "id": "chatcmpl-BjAcvQz5VhKwIQbNQqsDylDCtaE3O",
                "created": 1750105309,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nJOIN agn_objects ao ON ms.oid = ao.oid\nWHERE ms.fid = 1 -- Assuming fid=1 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with probability > 0.6 of being an AGN in the lc_classifier\nWITH agn_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'AGN'\n          AND p.classifier_name = 'lc_classifier'\n          AND p.probability > 0.6\n          AND p.ranking = 1\n    )\n)\n-- Select magstat entries for these objects with WISE W1 magnitude between 12 and 13\nSELECT ms.*\nFROM magstat ms\nJOIN agn_objects ao ON ms.oid = ao.oid\nWHERE ms.fid = 1 -- Assuming fid=1 corresponds to WISE W1 band\n  AND ms.magmean_corr BETWEEN 12 AND 13\nLIMIT 50;\n```"
                },
                "in_toks": 3297,
                "out_toks": 189,
                "id": "chatcmpl-BjAdfXxoT8z5vF083CiO8pSq5nvPN",
                "created": 1750105355,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "81": {
        "0": {
            "req_id": "81",
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 787,
                "out_toks": 8,
                "id": "chatcmpl-BjAcwinRrDXvbeDURO2Xz5PmhaGeJ",
                "created": 1750105310,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve ZTF object identifier and distance for the specified object matched with ALLWISE catalog\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nWHERE \n    o.oid = 'J163603.54-065228.7'\n    AND x.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve ZTF object identifier and distance for the specified object matched with ALLWISE catalog\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nWHERE \n    o.oid = 'J163603.54-065228.7'\n    AND x.catid = 'ALLWISE';\n```"
                },
                "in_toks": 2016,
                "out_toks": 92,
                "id": "chatcmpl-BjAdgLXKoGaM3efB3rTng48Y2pE3W",
                "created": 1750105356,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "81",
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 787,
                "out_toks": 8,
                "id": "chatcmpl-BjAcwinRrDXvbeDURO2Xz5PmhaGeJ",
                "created": 1750105310,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve ZTF object identifier and distance for the specified object matched with ALLWISE catalog\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nWHERE \n    o.oid = 'J163603.54-065228.7'\n    AND x.catid = 'ALLWISE';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve ZTF object identifier and distance for the specified object matched with ALLWISE catalog\nSELECT \n    o.oid AS ztf_object_id,\n    x.dist AS distance_arcsec\nFROM \n    object o\nJOIN \n    xmatch x ON o.oid = x.oid\nWHERE \n    o.oid = 'J163603.54-065228.7'\n    AND x.catid = 'ALLWISE';\n```"
                },
                "in_toks": 2016,
                "out_toks": 92,
                "id": "chatcmpl-BjAdgbpUUW1vyjMiXMPqeSrAKKs4S",
                "created": 1750105356,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "69": {
        "0": {
            "req_id": "69",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']",
                    "1": "['object', 'ps1_ztf']"
                },
                "in_toks": 803,
                "out_toks": 20,
                "id": "chatcmpl-BjAcw7S2pAGIqCEVbFnXZz1ZclaOX",
                "created": 1750105310,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Find the nearest source in PS1 for each specified object and select rows with star/galaxy score < 0.2 for that nearest source\nWITH nearest_sources AS (\n    SELECT\n        o.oid,\n        p1.sgscore1,\n        p2.sgscore2,\n        p3.sgscore3,\n        -- Determine the minimum distance among the three closest sources\n        LEAST(p1.distpsnr1, p2.distpsnr2, p3.distpsnr3) AS min_dist\n    FROM\n        object o\n    LEFT JOIN\n        ps1_ztf p1 ON o.oid = p1.oid\n    LEFT JOIN\n        ps1_ztf p2 ON o.oid = p2.oid\n    LEFT JOIN\n        ps1_ztf p3 ON o.oid = p3.oid\n    WHERE\n        o.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nSELECT\n    p.*\nFROM\n    nearest_sources ns\nJOIN\n    ps1_ztf p ON p.oid = ns.oid\nWHERE\n    -- Check if the source is the nearest among the three\n    p.distpsnr1 = ns.min_dist AND p.sgscore1 < 0.2\n    OR p.distpsnr2 = ns.min_dist AND p.sgscore2 < 0.2\n    OR p.distpsnr3 = ns.min_dist AND p.sgscore3 < 0.2;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Find the nearest source in PS1 for each specified object and select rows with star/galaxy score < 0.2 for that nearest source\nWITH nearest_sources AS (\n    SELECT\n        o.oid,\n        p1.sgscore1,\n        p2.sgscore2,\n        p3.sgscore3,\n        -- Determine the minimum distance among the three closest sources\n        LEAST(p1.distpsnr1, p2.distpsnr2, p3.distpsnr3) AS min_dist\n    FROM\n        object o\n    LEFT JOIN\n        ps1_ztf p1 ON o.oid = p1.oid\n    LEFT JOIN\n        ps1_ztf p2 ON o.oid = p2.oid\n    LEFT JOIN\n        ps1_ztf p3 ON o.oid = p3.oid\n    WHERE\n        o.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nSELECT\n    p.*\nFROM\n    nearest_sources ns\nJOIN\n    ps1_ztf p ON p.oid = ns.oid\nWHERE\n    -- Check if the source is the nearest among the three\n    p.distpsnr1 = ns.min_dist AND p.sgscore1 < 0.2\n    OR p.distpsnr2 = ns.min_dist AND p.sgscore2 < 0.2\n    OR p.distpsnr3 = ns.min_dist AND p.sgscore3 < 0.2;\n```"
                },
                "in_toks": 3155,
                "out_toks": 327,
                "id": "chatcmpl-BjAdh8N9f4XLvJixBtv4gdlQsyOLS",
                "created": 1750105357,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "69",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'ps1_ztf']",
                    "1": "['object', 'ps1_ztf']"
                },
                "in_toks": 803,
                "out_toks": 20,
                "id": "chatcmpl-BjAcw7S2pAGIqCEVbFnXZz1ZclaOX",
                "created": 1750105310,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Find the nearest source in PS1 for each specified object and select rows with star/galaxy score < 0.2 for that nearest source\nWITH nearest_sources AS (\n    SELECT\n        o.oid,\n        p1.sgscore1,\n        p2.sgscore2,\n        p3.sgscore3,\n        -- Determine the minimum distance among the three closest sources\n        LEAST(p1.distpsnr1, p2.distpsnr2, p3.distpsnr3) AS min_dist\n    FROM\n        object o\n    LEFT JOIN\n        ps1_ztf p1 ON o.oid = p1.oid\n    LEFT JOIN\n        ps1_ztf p2 ON o.oid = p2.oid\n    LEFT JOIN\n        ps1_ztf p3 ON o.oid = p3.oid\n    WHERE\n        o.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nSELECT\n    p.*\nFROM\n    nearest_sources ns\nJOIN\n    ps1_ztf p ON p.oid = ns.oid\nWHERE\n    -- Check if the source is the nearest among the three\n    (p.distpsnr1 = ns.min_dist AND p.sgscore1 < 0.2)\n    OR (p.distpsnr2 = ns.min_dist AND p.sgscore2 < 0.2)\n    OR (p.distpsnr3 = ns.min_dist AND p.sgscore3 < 0.2);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Find the nearest source in PS1 for each specified object and select rows with star/galaxy score < 0.2 for that nearest source\nWITH nearest_sources AS (\n    SELECT\n        o.oid,\n        p1.sgscore1,\n        p2.sgscore2,\n        p3.sgscore3,\n        -- Determine the minimum distance among the three closest sources\n        LEAST(p1.distpsnr1, p2.distpsnr2, p3.distpsnr3) AS min_dist\n    FROM\n        object o\n    LEFT JOIN\n        ps1_ztf p1 ON o.oid = p1.oid\n    LEFT JOIN\n        ps1_ztf p2 ON o.oid = p2.oid\n    LEFT JOIN\n        ps1_ztf p3 ON o.oid = p3.oid\n    WHERE\n        o.oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')\n)\nSELECT\n    p.*\nFROM\n    nearest_sources ns\nJOIN\n    ps1_ztf p ON p.oid = ns.oid\nWHERE\n    -- Check if the source is the nearest among the three\n    (p.distpsnr1 = ns.min_dist AND p.sgscore1 < 0.2)\n    OR (p.distpsnr2 = ns.min_dist AND p.sgscore2 < 0.2)\n    OR (p.distpsnr3 = ns.min_dist AND p.sgscore3 < 0.2);\n```"
                },
                "in_toks": 3155,
                "out_toks": 330,
                "id": "chatcmpl-BjAdhogSjU6umFAAknNBSNZiD4jUD",
                "created": 1750105357,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "61": {
        "0": {
            "req_id": "61",
            "experiment_id": "run_0",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 788,
                "out_toks": 8,
                "id": "chatcmpl-BjAcxk1vT6qzcXwfl6xfQuWix3uSQ",
                "created": 1750105311,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2632,
                "out_toks": 42,
                "id": "chatcmpl-BjAdhNV5hfPefURRN2xk2P1FIStZp",
                "created": 1750105357,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "61",
            "experiment_id": "run_1",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 788,
                "out_toks": 8,
                "id": "chatcmpl-BjAcxk1vT6qzcXwfl6xfQuWix3uSQ",
                "created": 1750105311,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM magstat \nWHERE ndet >= 10 \n  AND magmedian > 19 \n  AND maglast < 17 \nORDER BY oid \nLIMIT 30;\n```"
                },
                "in_toks": 2632,
                "out_toks": 42,
                "id": "chatcmpl-BjAdiJcX19eiXeVeKas4X45PT9alD",
                "created": 1750105358,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "104": {
        "0": {
            "req_id": "104",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "ss_ztf",
                "reference",
                "detection",
                "magstat",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ss_ztf', 'reference', 'detection', 'magstat', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ss_ztf', 'reference', 'detection', 'magstat', 'ps1_ztf']"
                },
                "in_toks": 836,
                "out_toks": 62,
                "id": "chatcmpl-BjAcxZTTRzl2BbIFEntVdQ5asKKlq",
                "created": 1750105311,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, r.magnr\n    FROM object o\n    JOIN ss_ztf s ON o.oid = s.oid\n    JOIN reference r ON o.oid = r.oid AND r.candid = s.candid\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n    )\n    LIMIT 30\n)\nSELECT\n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    r.magnr,\n    d.fid,\n    d.sigmapsf AS fwhm, -- Assuming sigmapsf as a proxy for FWHM from SExtractor\n    -- Placeholder for number of PS1 calibrators used; assuming nmtchps as the count of matches\n    so.nmtchps,\n    -- Placeholder for exposure time; assuming it can be derived or is not directly available, set as NULL\n    NULL AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid\nLEFT JOIN reference r ON so.oid = r.oid AND so.candid = r.candid\nORDER BY so.oid\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, r.magnr\n    FROM object o\n    JOIN ss_ztf s ON o.oid = s.oid\n    JOIN reference r ON o.oid = r.oid AND r.candid = s.candid\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n          AND p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n    )\n    LIMIT 30\n)\nSELECT\n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    r.magnr,\n    d.fid,\n    d.sigmapsf AS fwhm, -- Assuming sigmapsf as a proxy for FWHM from SExtractor\n    -- Placeholder for number of PS1 calibrators used; assuming nmtchps as the count of matches\n    so.nmtchps,\n    -- Placeholder for exposure time; assuming it can be derived or is not directly available, set as NULL\n    NULL AS exposure_time\nFROM selected_objects so\nJOIN detection d ON so.candid = d.candid\nLEFT JOIN reference r ON so.oid = r.oid AND so.candid = r.candid\nORDER BY so.oid\nLIMIT 30;\n```"
                },
                "in_toks": 5165,
                "out_toks": 363,
                "id": "chatcmpl-BjAdilYlqPYsDqmJDFxitPLAnwezV",
                "created": 1750105358,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "104",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "ss_ztf",
                "reference",
                "detection",
                "magstat",
                "ps1_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'ss_ztf', 'reference', 'detection', 'magstat', 'ps1_ztf']",
                    "1": "['object', 'probability', 'ss_ztf', 'reference', 'detection', 'magstat', 'ps1_ztf']"
                },
                "in_toks": 836,
                "out_toks": 62,
                "id": "chatcmpl-BjAcxZTTRzl2BbIFEntVdQ5asKKlq",
                "created": 1750105311,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, r.magnr, r.candid AS r_candid, r.ranr, r.decnr, r.mjdstartref, r.mjdendref, r.nframesref\n    FROM object o\n    JOIN ss_ztf s ON o.oid = s.oid\n    JOIN reference r ON o.oid = r.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.probability DESC\n        LIMIT 30\n    )\n)\nSELECT\n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    r.magnr,\n    r.candid AS r_candid,\n    -- Filter identifier, FWHM, number of PS1 calibrators, and exposure time\n    d.fid,\n    -- Assuming FWHM is stored in detection table as 'fwhm' (not explicitly given, so placeholder)\n    -- If FWHM is not available, this column will be omitted or set to NULL\n    NULL AS fwhm, -- Placeholder for FWHM, replace with actual column if available\n    -- Number of PS1 calibrators used\n    ps.nmtchps,\n    -- Exposure time (assuming it's stored in detection table as 'exptime' or similar; not explicitly given)\n    NULL AS exptime -- Placeholder for exposure time, replace with actual column if available\nFROM selected_objects so\nLEFT JOIN detection d ON so.candid = d.candid\nLEFT JOIN ps1_ztf ps ON so.oid = ps.oid\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select up to 30 ZTF objects with probability > 0.9 of being an asteroid in stamp_classifier version 'stamp_classifier_1.0.4'\nWITH selected_objects AS (\n    SELECT o.oid, s.candid, s.ssdistnr, s.ssnamenr, r.magnr, r.candid AS r_candid, r.ranr, r.decnr, r.mjdstartref, r.mjdendref, r.nframesref\n    FROM object o\n    JOIN ss_ztf s ON o.oid = s.oid\n    JOIN reference r ON o.oid = r.oid\n    WHERE o.oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE p.class_name = 'asteroid'\n          AND p.classifier_name = 'stamp_classifier'\n          AND p.classifier_version = 'stamp_classifier_1.0.4'\n          AND p.probability > 0.9\n        ORDER BY p.probability DESC\n        LIMIT 30\n    )\n)\nSELECT\n    so.oid,\n    so.candid,\n    so.ssdistnr,\n    so.ssnamenr,\n    r.magnr,\n    r.candid AS r_candid,\n    -- Filter identifier, FWHM, number of PS1 calibrators, and exposure time\n    d.fid,\n    -- Assuming FWHM is stored in detection table as 'fwhm' (not explicitly given, so placeholder)\n    -- If FWHM is not available, this column will be omitted or set to NULL\n    NULL AS fwhm, -- Placeholder for FWHM, replace with actual column if available\n    -- Number of PS1 calibrators used\n    ps.nmtchps,\n    -- Exposure time (assuming it's stored in detection table as 'exptime' or similar; not explicitly given)\n    NULL AS exptime -- Placeholder for exposure time, replace with actual column if available\nFROM selected_objects so\nLEFT JOIN detection d ON so.candid = d.candid\nLEFT JOIN ps1_ztf ps ON so.oid = ps.oid\nLIMIT 30;\n```"
                },
                "in_toks": 5165,
                "out_toks": 453,
                "id": "chatcmpl-BjAdj6kkWdW6wHliEiXiJMxBDBDlf",
                "created": 1750105359,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "71": {
        "0": {
            "req_id": "71",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 819,
                "out_toks": 12,
                "id": "chatcmpl-BjAcyJOZvmqDZY3pffsfwDOxdNyS2",
                "created": 1750105312,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band filter\nORDER BY \n    r.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band filter\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 2783,
                "out_toks": 119,
                "id": "chatcmpl-BjAdjVksQ03NdSUmrmhDoUy9OdYVu",
                "created": 1750105359,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "71",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 819,
                "out_toks": 12,
                "id": "chatcmpl-BjAcyJOZvmqDZY3pffsfwDOxdNyS2",
                "created": 1750105312,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band filter\nORDER BY \n    r.oid;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select reference information for specified objects in the g band, sorted by ZTF identifier\nSELECT \n    r.oid AS reference_id,\n    r.candid AS candidate_id,\n    r.magnr AS magnitude,\n    r.sigmagnr AS magnitude_uncertainty\nFROM \n    reference r\nWHERE \n    r.oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')\n    AND r.fid = 1 -- g band filter\nORDER BY \n    r.oid;\n```"
                },
                "in_toks": 2783,
                "out_toks": 119,
                "id": "chatcmpl-BjAdkNlktyZ2qAhgV1a4Pbiww7YP1",
                "created": 1750105360,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "42": {
        "0": {
            "req_id": "42",
            "experiment_id": "run_0",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 816,
                "out_toks": 8,
                "id": "chatcmpl-BjAcynhrqunbr30iZVUFCcSkeiUoq",
                "created": 1750105312,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```"
                },
                "in_toks": 2729,
                "out_toks": 115,
                "id": "chatcmpl-BjAdkLI7zE9SIvmdW59FakW6OQp3z",
                "created": 1750105360,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "42",
            "experiment_id": "run_1",
            "pred_tables": [
                "dataquality"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['dataquality']",
                    "1": "['dataquality']"
                },
                "in_toks": 816,
                "out_toks": 8,
                "id": "chatcmpl-BjAcynhrqunbr30iZVUFCcSkeiUoq",
                "created": 1750105312,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all epochs for the specified object, sorted by reduced chi-square\nSELECT \n    oid AS object,\n    candid AS candidate,\n    fid AS filter_id,\n    chipsf AS reduced_chi_square,\n    fwhm,\n    classtar,\n    nbad AS number_of_bad_pixels,\n    magzpsci AS zp_magnitude,\n    magzpsciunc AS zp_uncertainty,\n    exptime AS exposure_time\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;\n```"
                },
                "in_toks": 2729,
                "out_toks": 115,
                "id": "chatcmpl-BjAdlw5b76bxafroPA0lLK15oKNtz",
                "created": 1750105361,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "107": {
        "0": {
            "req_id": "107",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']",
                    "1": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 853,
                "out_toks": 30,
                "id": "chatcmpl-BjAczJGsHQhxnwDxIz8U0Qtsxt8qf",
                "created": 1750105313,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        d.candid,\n        x.dist,\n        x.catid,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Get the top probability class for each object from the stamp_classifier\n    WHERE\n        -- Ensure the object has more than 500 detections\n        o.ndet > 500\n        -- Join with probability table to filter by probability > 0.5 for 'asteroid' in 'stamp_classifier_1.0.4'\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'asteroid'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.probability > 0.5\n                AND p.ranking = 1\n        )\n        -- Join with detection table to get detection date and filter\n        AND EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE\n                d.oid = o.oid\n        )\n        -- Join with xmatch to filter objects within 2 arcsec of Solar System objects\n        AND EXISTS (\n            SELECT 1\n            FROM xmatch x\n            WHERE\n                x.oid = o.oid\n                AND x.dist < 2\n        )\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    ndet AS \"Number of Detections\",\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS \"First Detection Date\",\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS \"Last Detection Date\",\n    probability AS \"Probability\",\n    candid AS \"Candidate Identifier\",\n    dist AS \"Distance to MPC Object (arcsec)\",\n    catid AS \"MPC Name\",\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS \"Detection Date\",\n    fid AS \"Filter Identifier\"\nFROM\n    selected_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 10 objects with specified conditions\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        d.candid,\n        x.dist,\n        x.catid,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Get the top probability class for each object from the stamp_classifier\n    WHERE\n        -- Ensure the object has more than 500 detections\n        o.ndet > 500\n        -- Join with probability table to filter by probability > 0.5 for 'asteroid' in 'stamp_classifier_1.0.4'\n        AND EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'asteroid'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.probability > 0.5\n                AND p.ranking = 1\n        )\n        -- Join with detection table to get detection date and filter\n        AND EXISTS (\n            SELECT 1\n            FROM detection d\n            WHERE\n                d.oid = o.oid\n        )\n        -- Join with xmatch to filter objects within 2 arcsec of Solar System objects\n        AND EXISTS (\n            SELECT 1\n            FROM xmatch x\n            WHERE\n                x.oid = o.oid\n                AND x.dist < 2\n        )\n)\nSELECT\n    oid AS \"ZTF Identifier\",\n    ndet AS \"Number of Detections\",\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS \"First Detection Date\",\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS \"Last Detection Date\",\n    probability AS \"Probability\",\n    candid AS \"Candidate Identifier\",\n    dist AS \"Distance to MPC Object (arcsec)\",\n    catid AS \"MPC Name\",\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS \"Detection Date\",\n    fid AS \"Filter Identifier\"\nFROM\n    selected_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3295,
                "out_toks": 487,
                "id": "chatcmpl-BjAdlFTAEvLvQXHC3iUt39DWTpwzh",
                "created": 1750105361,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "107",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "xmatch",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'xmatch', 'detection']",
                    "1": "['object', 'probability', 'xmatch', 'detection']"
                },
                "in_toks": 853,
                "out_toks": 30,
                "id": "chatcmpl-BjAczJGsHQhxnwDxIz8U0Qtsxt8qf",
                "created": 1750105313,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 10 objects with specified conditions\nWITH filtered_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        d.candid,\n        xm.dist,\n        xm.catid AS mpc_name,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Get the most probable class with ranking=1 for stamp_classifier_1.0.4\n    WHERE\n        -- Ensure object has more than 500 detections\n        o.ndet > 500\n        AND\n        -- Subquery to get the probability of being an asteroid (assuming 'asteroid' class exists in probability table)\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'asteroid'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.ranking = 1\n                AND p.probability > 0.5\n        )\n        AND\n        -- Distance to nearest Solar System object less than 2 arcsec\n        EXISTS (\n            SELECT 1\n            FROM xmatch xm\n            WHERE\n                xm.oid = o.oid\n                AND xm.dist < 2\n        )\n)\nSELECT\n    oid AS ztf_id,\n    ndet AS number_of_detections,\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS first_detection_date,\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS last_detection_date,\n    probability,\n    candid AS candidate_id,\n    dist AS distance_arcsec,\n    mpc_name,\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS detection_date,\n    fid AS filter_id\nFROM\n    filtered_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 10 objects with specified conditions\nWITH filtered_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        o.lastmjd,\n        p.probability,\n        d.candid,\n        xm.dist,\n        xm.catid AS mpc_name,\n        d.mjd,\n        d.fid\n    FROM\n        object o\n    -- Get the most probable class with ranking=1 for stamp_classifier_1.0.4\n    WHERE\n        -- Ensure object has more than 500 detections\n        o.ndet > 500\n        AND\n        -- Subquery to get the probability of being an asteroid (assuming 'asteroid' class exists in probability table)\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE\n                p.oid = o.oid\n                AND p.class_name = 'asteroid'\n                AND p.classifier_name = 'stamp_classifier'\n                AND p.classifier_version = 'stamp_classifier_1.0.4'\n                AND p.ranking = 1\n                AND p.probability > 0.5\n        )\n        AND\n        -- Distance to nearest Solar System object less than 2 arcsec\n        EXISTS (\n            SELECT 1\n            FROM xmatch xm\n            WHERE\n                xm.oid = o.oid\n                AND xm.dist < 2\n        )\n)\nSELECT\n    oid AS ztf_id,\n    ndet AS number_of_detections,\n    to_char(to_timestamp(firstmjd * 86400), 'YYYY-MM-DD') AS first_detection_date,\n    to_char(to_timestamp(lastmjd * 86400), 'YYYY-MM-DD') AS last_detection_date,\n    probability,\n    candid AS candidate_id,\n    dist AS distance_arcsec,\n    mpc_name,\n    to_char(to_timestamp(mjd * 86400), 'YYYY-MM-DD') AS detection_date,\n    fid AS filter_id\nFROM\n    filtered_objects\nORDER BY\n    firstmjd\nLIMIT 10;\n```"
                },
                "in_toks": 3295,
                "out_toks": 429,
                "id": "chatcmpl-BjAdle1Lx2yp4LBWMb0KfR8IvDRY3",
                "created": 1750105361,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "83": {
        "0": {
            "req_id": "83",
            "experiment_id": "run_0",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 762,
                "out_toks": 8,
                "id": "chatcmpl-BjAczuLFHIvvvuOgzvONJz9txTrMY",
                "created": 1750105313,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise \nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2576,
                "out_toks": 25,
                "id": "chatcmpl-BjAdm3UqckPB9uKoDlXQvyBOgGzW9",
                "created": 1750105362,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "83",
            "experiment_id": "run_1",
            "pred_tables": [
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['allwise']",
                    "1": "['allwise']"
                },
                "in_toks": 762,
                "out_toks": 8,
                "id": "chatcmpl-BjAczuLFHIvvvuOgzvONJz9txTrMY",
                "created": 1750105313,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM allwise\nWHERE oid_catalog = 'ZTF21aazqwxv';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM allwise\nWHERE oid_catalog = 'ZTF21aazqwxv';\n```"
                },
                "in_toks": 2576,
                "out_toks": 25,
                "id": "chatcmpl-BjAdnoUZkEF6UKRrudFx2RIGQkmHM",
                "created": 1750105363,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "84": {
        "0": {
            "req_id": "84",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'allwise']",
                    "1": "['object', 'allwise']"
                },
                "in_toks": 786,
                "out_toks": 14,
                "id": "chatcmpl-BjAd0phqsWHuhBzSAXPfu8dM1SjZd",
                "created": 1750105314,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        o.oid_catalog,\n        o.ra,\n        o.dec,\n        q3c_dist(z.meanra, z.meandec, o.ra, o.dec) AS distance_deg,\n        o.w1mpro,\n        o.w2mpro,\n        o.w3mpro,\n        o.w4mpro\n    FROM allwise o\n    CROSS JOIN ztf_object z\n    WHERE q3c_join(z.meanra, z.meandec, o.ra, o.dec, 0.000277778) -- 1 arcsecond in degrees\n)\nSELECT\n    'ZTF19aascdol' AS ztf_object_identifier,\n    oid_catalog,\n    distance_deg,\n    w1mpro,\n    w2mpro,\n    w3mpro,\n    w4mpro\nFROM wise_matches;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        o.oid_catalog,\n        o.ra,\n        o.dec,\n        q3c_dist(z.meanra, z.meandec, o.ra, o.dec) AS distance_deg,\n        o.w1mpro,\n        o.w2mpro,\n        o.w3mpro,\n        o.w4mpro\n    FROM allwise o\n    CROSS JOIN ztf_object z\n    WHERE q3c_join(z.meanra, z.meandec, o.ra, o.dec, 0.000277778) -- 1 arcsecond in degrees\n)\nSELECT\n    'ZTF19aascdol' AS ztf_object_identifier,\n    oid_catalog,\n    distance_deg,\n    w1mpro,\n    w2mpro,\n    w3mpro,\n    w4mpro\nFROM wise_matches;\n```"
                },
                "in_toks": 3102,
                "out_toks": 236,
                "id": "chatcmpl-BjAdof4KGRouRwQyR4SQadMgec52d",
                "created": 1750105364,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "84",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "allwise"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'allwise']",
                    "1": "['object', 'allwise']"
                },
                "in_toks": 786,
                "out_toks": 14,
                "id": "chatcmpl-BjAd0phqsWHuhBzSAXPfu8dM1SjZd",
                "created": 1750105314,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        o.oid_catalog,\n        o.ra,\n        o.dec,\n        q3c_dist(z.meanra, z.meandec, o.ra, o.dec) AS distance_deg,\n        o.w1mpro,\n        o.w2mpro,\n        o.w3mpro,\n        o.w4mpro\n    FROM allwise o\n    CROSS JOIN ztf_object z\n    WHERE q3c_join(z.meanra, z.meandec, o.ra, o.dec, 0.000277778) -- 1 arcsecond in degrees\n)\nSELECT\n    'ZTF19aascdol' AS ztf_object_identifier,\n    oid_catalog,\n    distance_deg,\n    w1mpro,\n    w2mpro,\n    w3mpro,\n    w4mpro\nFROM wise_matches;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve information about ALLWISE matches for the specified ZTF object 'ZTF19aascdol'\nWITH ztf_object AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE oid = 'ZTF19aascdol'\n),\nwise_matches AS (\n    SELECT\n        o.oid_catalog,\n        o.ra,\n        o.dec,\n        q3c_dist(z.meanra, z.meandec, o.ra, o.dec) AS distance_deg,\n        o.w1mpro,\n        o.w2mpro,\n        o.w3mpro,\n        o.w4mpro\n    FROM allwise o\n    CROSS JOIN ztf_object z\n    WHERE q3c_join(z.meanra, z.meandec, o.ra, o.dec, 0.000277778) -- 1 arcsecond in degrees\n)\nSELECT\n    'ZTF19aascdol' AS ztf_object_identifier,\n    oid_catalog,\n    distance_deg,\n    w1mpro,\n    w2mpro,\n    w3mpro,\n    w4mpro\nFROM wise_matches;\n```"
                },
                "in_toks": 3102,
                "out_toks": 237,
                "id": "chatcmpl-BjAdntE1LROrGM9a3sLQhaUovz91i",
                "created": 1750105363,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "96": {
        "0": {
            "req_id": "96",
            "experiment_id": "run_0",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']",
                    "1": "['ss_ztf', 'detection']"
                },
                "in_toks": 824,
                "out_toks": 20,
                "id": "chatcmpl-BjAd0R3aN83TsMDefiPFMVhlPHAYF",
                "created": 1750105314,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    VALUES\n        ('2003FP134', 0.0, 0.0), -- Placeholder coordinates, replace with actual RA/Dec if known\n        ('2009UK56', 0.0, 0.0) -- Placeholder coordinates, replace with actual RA/Dec if known\n),\nsource_coords AS (\n    SELECT\n        s.column1 AS name,\n        s.column2 AS ra,\n        s.column3 AS dec\n    FROM sources s\n),\n-- Select the coordinates for the specific solar system objects\nss_coords AS (\n    SELECT\n        ss.ssnamenr AS mpc_name,\n        ss.oid,\n        ss.ra,\n        ss.dec\n    FROM ss_ztf ss\n    WHERE ss.ssnamenr IN ('2003FP134', '2009UK56')\n),\n-- Find detections within 2 arcseconds (~0.0005556 degrees) of each solar system object\ndetections_nearby AS (\n    SELECT\n        d.*\n    FROM detection d\n    JOIN ss_coords ss ON q3c_join(d.ra, d.dec, ss.ra, ss.dec, 0.0005556)\n)\n-- Final output: all columns from ss_ztf and specified detection info, sorted accordingly\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_coords ss\nJOIN detections_nearby d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the external sources with their coordinates\nWITH sources AS (\n    VALUES\n        ('2003FP134', 0.0, 0.0), -- Placeholder coordinates, replace with actual RA/Dec if known\n        ('2009UK56', 0.0, 0.0) -- Placeholder coordinates, replace with actual RA/Dec if known\n),\nsource_coords AS (\n    SELECT\n        s.column1 AS name,\n        s.column2 AS ra,\n        s.column3 AS dec\n    FROM sources s\n),\n-- Select the coordinates for the specific solar system objects\nss_coords AS (\n    SELECT\n        ss.ssnamenr AS mpc_name,\n        ss.oid,\n        ss.ra,\n        ss.dec\n    FROM ss_ztf ss\n    WHERE ss.ssnamenr IN ('2003FP134', '2009UK56')\n),\n-- Find detections within 2 arcseconds (~0.0005556 degrees) of each solar system object\ndetections_nearby AS (\n    SELECT\n        d.*\n    FROM detection d\n    JOIN ss_coords ss ON q3c_join(d.ra, d.dec, ss.ra, ss.dec, 0.0005556)\n)\n-- Final output: all columns from ss_ztf and specified detection info, sorted accordingly\nSELECT\n    ss.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM ss_coords ss\nJOIN detections_nearby d ON ss.oid = d.oid\nORDER BY ss.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2650,
                "out_toks": 366,
                "id": "chatcmpl-BjAdorHE2fBqLMdRBUot6Gyo6CQB4",
                "created": 1750105364,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "96",
            "experiment_id": "run_1",
            "pred_tables": [
                "ss_ztf",
                "detection"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['ss_ztf', 'detection']",
                    "1": "['ss_ztf', 'detection']"
                },
                "in_toks": 824,
                "out_toks": 20,
                "id": "chatcmpl-BjAd0R3aN83TsMDefiPFMVhlPHAYF",
                "created": 1750105314,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Define the solar system objects with their coordinates\nWITH ss_objects AS (\n    SELECT '2003FP134' AS mpc_name, 0.0 AS ra, 0.0 AS dec -- Placeholder coordinates for 2003FP134\n    UNION ALL\n    SELECT '2009UK56', 0.0, 0.0 -- Placeholder coordinates for 2009UK56\n),\n-- Calculate the angular distance between each detection and the solar system objects\nnear_detections AS (\n    SELECT\n        d.*\n    FROM\n        detection d\n    JOIN\n        ss_objects s ON q3c_join(d.ra, d.dec, s.ra, s.dec, 2.0/3600.0) -- 2 arcsec in degrees\n)\n-- Select required columns from ss_ztf and detection, sorted by MPC name and detection date\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM\n    ss_ztf s\nJOIN\n    near_detections d ON s.oid = d.oid\nORDER BY\n    s.ssnamenr, d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Define the solar system objects with their coordinates\nWITH ss_objects AS (\n    SELECT '2003FP134' AS mpc_name, 0.0 AS ra, 0.0 AS dec -- Placeholder coordinates for 2003FP134\n    UNION ALL\n    SELECT '2009UK56', 0.0, 0.0 -- Placeholder coordinates for 2009UK56\n),\n-- Calculate the angular distance between each detection and the solar system objects\nnear_detections AS (\n    SELECT\n        d.*\n    FROM\n        detection d\n    JOIN\n        ss_objects s ON q3c_join(d.ra, d.dec, s.ra, s.dec, 2.0/3600.0) -- 2 arcsec in degrees\n)\n-- Select required columns from ss_ztf and detection, sorted by MPC name and detection date\nSELECT\n    s.*,\n    d.mjd AS detection_date,\n    d.fid AS filter_id,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS mag_uncertainty\nFROM\n    ss_ztf s\nJOIN\n    near_detections d ON s.oid = d.oid\nORDER BY\n    s.ssnamenr, d.mjd;\n```"
                },
                "in_toks": 2650,
                "out_toks": 280,
                "id": "chatcmpl-BjAdpJx4p9YMVFtZKwUjWJvNYotyW",
                "created": 1750105365,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "67": {
        "0": {
            "req_id": "67",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']",
                    "1": "['object', 'gaia_ztf']"
                },
                "in_toks": 802,
                "out_toks": 20,
                "id": "chatcmpl-BjAd1ODAySkpbKMqPK5ks3U7JKH0I",
                "created": 1750105315,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find oids matching the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n)\nAND neargaia <= 1.5; -- neargaia is in arcseconds, filter for within 1.5 arcsec\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find oids matching the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n)\nAND neargaia <= 1.5; -- neargaia is in arcseconds, filter for within 1.5 arcsec\n```"
                },
                "in_toks": 2617,
                "out_toks": 129,
                "id": "chatcmpl-BjAdreaw96Goeewwmsv3LlfOrL17K",
                "created": 1750105367,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "67",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "gaia_ztf"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'gaia_ztf']",
                    "1": "['object', 'gaia_ztf']"
                },
                "in_toks": 802,
                "out_toks": 20,
                "id": "chatcmpl-BjAd1ODAySkpbKMqPK5ks3U7JKH0I",
                "created": 1750105315,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find oids matching the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n)\nAND neargaia <= 1.5; -- Filter for Gaia sources within 1.5 arcseconds\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all rows from gaia_ztf where the nearest Gaia source is within 1.5 arcseconds of specified ZTF objects\nSELECT *\nFROM gaia_ztf\nWHERE oid IN (\n    -- Subquery to find oids matching the specified ZTF identifiers\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')\n)\nAND neargaia <= 1.5; -- Filter for Gaia sources within 1.5 arcseconds\n```"
                },
                "in_toks": 2617,
                "out_toks": 123,
                "id": "chatcmpl-BjAdqmhRodinkzIfqC2Q5YnmSbE7X",
                "created": 1750105366,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "55": {
        "0": {
            "req_id": "55",
            "experiment_id": "run_0",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 761,
                "out_toks": 6,
                "id": "chatcmpl-BjAd14K26qr0SbGI32TUgdE9AHfP4",
                "created": 1750105315,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2358,
                "out_toks": 21,
                "id": "chatcmpl-BjAds49qlKVWCjaPy24lAyvZKZd86",
                "created": 1750105368,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "55",
            "experiment_id": "run_1",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object']",
                    "1": "['object']"
                },
                "in_toks": 761,
                "out_toks": 6,
                "id": "chatcmpl-BjAd14K26qr0SbGI32TUgdE9AHfP4",
                "created": 1750105315,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT * \nFROM object \nWHERE oid = 'ZTF20aatxryt';\n```"
                },
                "in_toks": 2358,
                "out_toks": 21,
                "id": "chatcmpl-BjAdrkCcZT9O2cwGQ37bwVpSgDFki",
                "created": 1750105367,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "47": {
        "0": {
            "req_id": "47",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'probability']",
                    "1": "['object', 'detection', 'probability']"
                },
                "in_toks": 827,
                "out_toks": 22,
                "id": "chatcmpl-BjAd2i3Yoz7dnDrglHmBI59oNl3Qv",
                "created": 1750105316,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select detections for specified objects with real/bogus score > 0.7\nSELECT\n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos AS isdiffpos_flag,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    detection d\nWHERE\n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    d.oid,\n    d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select detections for specified objects with real/bogus score > 0.7\nSELECT\n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos AS isdiffpos_flag,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    detection d\nWHERE\n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    d.oid,\n    d.mjd;\n```"
                },
                "in_toks": 3157,
                "out_toks": 168,
                "id": "chatcmpl-BjAdqyYNAHE4nhfb53XFjHVTH1XSK",
                "created": 1750105366,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "47",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'probability']",
                    "1": "['object', 'detection', 'probability']"
                },
                "in_toks": 827,
                "out_toks": 22,
                "id": "chatcmpl-BjAd2i3Yoz7dnDrglHmBI59oNl3Qv",
                "created": 1750105316,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select detections for specified objects with real/bogus score > 0.7\nSELECT\n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos AS isdiffpos_flag,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    detection d\nWHERE\n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    d.oid,\n    d.mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select detections for specified objects with real/bogus score > 0.7\nSELECT\n    d.oid AS ZTF,\n    d.candid AS candidate_id,\n    d.rfid AS filter_id,\n    d.mjd AS detection_date,\n    d.isdiffpos AS isdiffpos_flag,\n    d.ra AS detection_ra,\n    d.dec AS detection_dec,\n    d.magpsf AS diff_magnitude,\n    d.sigmapsf AS diff_magnitude_error,\n    d.drb AS real_bogus_score\nFROM\n    detection d\nWHERE\n    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')\n    AND d.drb > 0.7\nORDER BY\n    d.oid,\n    d.mjd;\n```"
                },
                "in_toks": 3157,
                "out_toks": 168,
                "id": "chatcmpl-BjAdsnm0PVvTO8LPWsfOHHmqKLEWZ",
                "created": 1750105368,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "79": {
        "0": {
            "req_id": "79",
            "experiment_id": "run_0",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 777,
                "out_toks": 8,
                "id": "chatcmpl-BjAd3B3M1beKYcnNj9YyUUWbaIbGV",
                "created": 1750105317,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```"
                },
                "in_toks": 2006,
                "out_toks": 48,
                "id": "chatcmpl-BjAdvxjH8vur1CD8GeIjFDOKIK3te",
                "created": 1750105371,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "79",
            "experiment_id": "run_1",
            "pred_tables": [
                "xmatch"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['xmatch']",
                    "1": "['xmatch']"
                },
                "in_toks": 777,
                "out_toks": 8,
                "id": "chatcmpl-BjAd3B3M1beKYcnNj9YyUUWbaIbGV",
                "created": 1750105317,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    catid AS catalog_name,\n    oid_catalog AS object_id_in_catalog,\n    dist AS distance_arcsec\nFROM \n    xmatch\nWHERE \n    oid = 'ZTF20achscch';\n```"
                },
                "in_toks": 2006,
                "out_toks": 48,
                "id": "chatcmpl-BjAdxwP25uMLkkzqJ7FYB3CDFO7Ke",
                "created": 1750105373,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "94": {
        "0": {
            "req_id": "94",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 772,
                "out_toks": 12,
                "id": "chatcmpl-BjAd32igZKXwd6D1pZySpXBRU8HRu",
                "created": 1750105317,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2736,
                "out_toks": 57,
                "id": "chatcmpl-BjAdtqHkkGgQkQ26nKaVWcdbmOZrd",
                "created": 1750105369,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "94",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'reference']",
                    "1": "['object', 'reference']"
                },
                "in_toks": 772,
                "out_toks": 12,
                "id": "chatcmpl-BjAd32igZKXwd6D1pZySpXBRU8HRu",
                "created": 1750105317,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select all columns from 'object' and 'reference' tables for objects with a change in reference\nSELECT o.*, r.*\nFROM object o\nJOIN reference r ON o.oid = r.oid\nWHERE r.reference_change = TRUE\nLIMIT 50;\n```"
                },
                "in_toks": 2736,
                "out_toks": 57,
                "id": "chatcmpl-BjAdtosCwJKlTnybb6vSSEVjbYGnB",
                "created": 1750105369,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "90": {
        "0": {
            "req_id": "90",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version']",
                    "1": "['object', 'probability', 'feature', 'feature_version']"
                },
                "in_toks": 804,
                "out_toks": 28,
                "id": "chatcmpl-BjAd4UfPvqxhUq1kqG3JPkTeFslY6",
                "created": 1750105318,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select objects with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', and rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select objects with multiband period less than 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM feature f\n        WHERE f.oid = o.oid\n          AND f.name = 'Multiband_period'\n          AND f.value < 5\n          AND f.version = '1.2.1-P'\n    )\n    LIMIT 100\n)\n-- Retrieve all probability data for these objects, classifier 'lc_classifier', and rankings 1 or 2\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2);\n```"
                },
                "in_toks": 5069,
                "out_toks": 162,
                "id": "chatcmpl-BjAduw8wAAnifde2GEGXYLy0hlOhQ",
                "created": 1750105370,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "90",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'feature', 'feature_version']",
                    "1": "['object', 'probability', 'feature', 'feature_version']"
                },
                "in_toks": 804,
                "out_toks": 28,
                "id": "chatcmpl-BjAd4UfPvqxhUq1kqG3JPkTeFslY6",
                "created": 1750105318,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select probability data for objects with multiband period < 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN feature f ON o.oid = f.oid\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = '1.2.1-P'\n)\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nLIMIT 100;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select probability data for objects with multiband period < 5 days\nWITH selected_objects AS (\n    SELECT o.oid\n    FROM object o\n    JOIN feature f ON o.oid = f.oid\n    WHERE f.name = 'Multiband_period'\n      AND f.value < 5\n      AND f.version = '1.2.1-P'\n)\nSELECT p.*\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM selected_objects)\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking IN (1, 2)\nLIMIT 100;\n```"
                },
                "in_toks": 5069,
                "out_toks": 128,
                "id": "chatcmpl-BjAduR4sbg5sIpCMuFFCh168ozhQ1",
                "created": 1750105370,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "51": {
        "0": {
            "req_id": "51",
            "experiment_id": "run_0",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 796,
                "out_toks": 12,
                "id": "chatcmpl-BjAd5jLU4sbL8SuOtdCD4efoLHMFP",
                "created": 1750105319,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from forced_photometry for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from forced_photometry for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2605,
                "out_toks": 107,
                "id": "chatcmpl-BjAduFjFC7uflYdnODtvuA6lNNNNy",
                "created": 1750105370,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "51",
            "experiment_id": "run_1",
            "pred_tables": [
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['forced_photometry']",
                    "1": "['forced_photometry']"
                },
                "in_toks": 796,
                "out_toks": 12,
                "id": "chatcmpl-BjAd5jLU4sbL8SuOtdCD4efoLHMFP",
                "created": 1750105319,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from forced_photometry for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from forced_photometry for the object 'ZTF24aaiutyh'\nSELECT \n    oid,\n    mjd AS date,\n    fid AS filter_id,\n    mag AS diff_magnitude,\n    e_mag AS diff_magnitude_error,\n    mag_corr AS corrected_magnitude,\n    e_mag_corr AS corrected_magnitude_error,\n    isdiffpos\nFROM \n    forced_photometry\nWHERE \n    oid = 'ZTF24aaiutyh'\nORDER BY \n    mjd;\n```"
                },
                "in_toks": 2605,
                "out_toks": 110,
                "id": "chatcmpl-BjAdweDtZedLuw29r1d8LQxAY2ncd",
                "created": 1750105372,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "59": {
        "0": {
            "req_id": "59",
            "experiment_id": "run_0",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 779,
                "out_toks": 8,
                "id": "chatcmpl-BjAd6kUQmvxIFJ82BfrINK2szhfEC",
                "created": 1750105320,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2612,
                "out_toks": 56,
                "id": "chatcmpl-BjAdywpQO6eShaZvRrZqKXb3HDpqF",
                "created": 1750105374,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "59",
            "experiment_id": "run_1",
            "pred_tables": [
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['magstat']",
                    "1": "['magstat']"
                },
                "in_toks": 779,
                "out_toks": 8,
                "id": "chatcmpl-BjAd6kUQmvxIFJ82BfrINK2szhfEC",
                "created": 1750105320,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    fid AS \"filter identifier\",\n    ndet AS \"number of detections\",\n    magmean AS \"mean difference magnitude\"\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';\n```"
                },
                "in_toks": 2612,
                "out_toks": 56,
                "id": "chatcmpl-BjAe1lvlPemRArMBjktCeK5gv0FcF",
                "created": 1750105377,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "100": {
        "0": {
            "req_id": "100",
            "experiment_id": "run_0",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']",
                    "1": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 836,
                "out_toks": 28,
                "id": "chatcmpl-BjAd6wmQgoAT8dcJ6haDaq9Q90ypx",
                "created": 1750105320,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "WITH object_oid AS (\n    SELECT oid FROM object WHERE oid = 'ZTF24aamtvxb'\n),\ndetections AS (\n    SELECT\n        'detection' AS table,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_unc,\n        magap AS mag_limit,\n        NULL AS magpsf_corr,\n        NULL AS magpsf_corr_unc\n    FROM detection\n    WHERE oid = (SELECT oid FROM object_oid)\n),\nnon_detections AS (\n    SELECT\n        'non_detection' AS table,\n        NULL AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_unc,\n        diffmaglim AS mag_limit,\n        NULL AS magpsf_corr,\n        NULL AS magpsf_corr_unc\n    FROM non_detection\n    WHERE oid = (SELECT oid FROM object_oid)\n),\nforced_photometry AS (\n    SELECT\n        'forced_photometry' AS table,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_unc,\n        NULL AS mag_limit,\n        mag_corr AS magpsf_corr,\n        e_mag_corr AS magpsf_corr_unc\n    FROM forced_photometry\n    WHERE oid = (SELECT oid FROM object_oid)\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;",
            "sql_response": {
                "responses": {
                    "0": "WITH object_oid AS (\n    SELECT oid FROM object WHERE oid = 'ZTF24aamtvxb'\n),\ndetections AS (\n    SELECT\n        'detection' AS table,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_unc,\n        magap AS mag_limit,\n        NULL AS magpsf_corr,\n        NULL AS magpsf_corr_unc\n    FROM detection\n    WHERE oid = (SELECT oid FROM object_oid)\n),\nnon_detections AS (\n    SELECT\n        'non_detection' AS table,\n        NULL AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_unc,\n        diffmaglim AS mag_limit,\n        NULL AS magpsf_corr,\n        NULL AS magpsf_corr_unc\n    FROM non_detection\n    WHERE oid = (SELECT oid FROM object_oid)\n),\nforced_photometry AS (\n    SELECT\n        'forced_photometry' AS table,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_unc,\n        NULL AS mag_limit,\n        mag_corr AS magpsf_corr,\n        e_mag_corr AS magpsf_corr_unc\n    FROM forced_photometry\n    WHERE oid = (SELECT oid FROM object_oid)\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;"
                },
                "in_toks": 3311,
                "out_toks": 359,
                "id": "chatcmpl-BjAdxsnxWYMtAUAUWJMB1LgQ2bD8I",
                "created": 1750105373,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "100",
            "experiment_id": "run_1",
            "pred_tables": [
                "detection",
                "non_detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['detection', 'non_detection', 'forced_photometry']",
                    "1": "['detection', 'non_detection', 'forced_photometry']"
                },
                "in_toks": 836,
                "out_toks": 28,
                "id": "chatcmpl-BjAd6wmQgoAT8dcJ6haDaq9Q90ypx",
                "created": 1750105320,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "WITH object_oid AS (\n    SELECT oid FROM object WHERE oid = 'ZTF24aamtvxb'\n),\ndetections AS (\n    SELECT\n        'detection' AS table,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_unc,\n        magap AS mag_limit,\n        NULL AS magpsf_corr,\n        NULL AS magpsf_corr_unc\n    FROM detection\n    WHERE oid = (SELECT oid FROM object_oid)\n),\nnon_detections AS (\n    SELECT\n        'non_detection' AS table,\n        NULL AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_unc,\n        diffmaglim AS mag_limit,\n        NULL AS magpsf_corr,\n        NULL AS magpsf_corr_unc\n    FROM non_detection\n    WHERE oid = (SELECT oid FROM object_oid)\n),\nforced_photometry AS (\n    SELECT\n        'forced_photometry' AS table,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_unc,\n        NULL AS mag_limit,\n        mag_corr AS magpsf_corr,\n        e_mag_corr AS magpsf_corr_unc\n    FROM forced_photometry\n    WHERE oid = (SELECT oid FROM object_oid)\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;",
            "sql_response": {
                "responses": {
                    "0": "WITH object_oid AS (\n    SELECT oid FROM object WHERE oid = 'ZTF24aamtvxb'\n),\ndetections AS (\n    SELECT\n        'detection' AS table,\n        candid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        isdiffpos,\n        magpsf AS diffmag,\n        sigmapsf AS diffmag_unc,\n        magap AS mag_limit,\n        NULL AS magpsf_corr,\n        NULL AS magpsf_corr_unc\n    FROM detection\n    WHERE oid = (SELECT oid FROM object_oid)\n),\nnon_detections AS (\n    SELECT\n        'non_detection' AS table,\n        NULL AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        NULL AS diffmag,\n        NULL AS diffmag_unc,\n        diffmaglim AS mag_limit,\n        NULL AS magpsf_corr,\n        NULL AS magpsf_corr_unc\n    FROM non_detection\n    WHERE oid = (SELECT oid FROM object_oid)\n),\nforced_photometry AS (\n    SELECT\n        'forced_photometry' AS table,\n        pid AS ztf_id,\n        mjd AS epoch_date,\n        fid AS filter_id,\n        NULL AS isdiffpos,\n        mag AS diffmag,\n        e_mag AS diffmag_unc,\n        NULL AS mag_limit,\n        mag_corr AS magpsf_corr,\n        e_mag_corr AS magpsf_corr_unc\n    FROM forced_photometry\n    WHERE oid = (SELECT oid FROM object_oid)\n)\nSELECT * FROM detections\nUNION ALL\nSELECT * FROM non_detections\nUNION ALL\nSELECT * FROM forced_photometry\nORDER BY epoch_date;"
                },
                "in_toks": 3311,
                "out_toks": 359,
                "id": "chatcmpl-BjAdyZKXBeTK92L1mSbsXpJeDOXB9",
                "created": 1750105374,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "106": {
        "0": {
            "req_id": "106",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 881,
                "out_toks": 14,
                "id": "chatcmpl-BjAd7xMaViPIISEvpVmyqud7bzvsz",
                "created": 1750105321,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier_top'\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    p_stamp_bogus AS \"prob_stamp_bogus\",\n    p_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects o\nJOIN\n    probability p_stamp_bogus ON p_stamp_bogus.oid = o.oid\n    AND p_stamp_bogus.class_name = 'bogus'\n    AND p_stamp_bogus.classifier_name = 'stamp_classifier'\n    AND p_stamp_bogus.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp_bogus.ranking = 1\nJOIN\n    probability p_lc ON p_lc.oid = o.oid\n    AND p_lc.class_name = 'Transient'\n    AND p_lc.classifier_name = 'lc_classifier_top'\n    AND p_lc.ranking = 1\nORDER BY\n    \"prob_stamp_bogus\" DESC\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nWITH selected_objects AS (\n    SELECT\n        o.oid,\n        o.ndet,\n        o.firstmjd,\n        p_stamp.probability AS prob_stamp_bogus,\n        p_top.probability AS prob_lc_transient\n    FROM\n        object o\n    WHERE\n        o.ndet > 10\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_stamp\n            WHERE\n                p_stamp.oid = o.oid\n                AND p_stamp.class_name = 'bogus'\n                AND p_stamp.classifier_name = 'stamp_classifier'\n                AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'\n                AND p_stamp.ranking = 1\n                AND p_stamp.probability > 0.7\n        )\n        AND EXISTS (\n            SELECT 1\n            FROM probability p_top\n            WHERE\n                p_top.oid = o.oid\n                AND p_top.class_name = 'Transient'\n                AND p_top.classifier_name = 'lc_classifier_top'\n                AND p_top.ranking = 1\n                AND p_top.probability > 0.9\n        )\n)\nSELECT\n    o.oid AS \"ZTF identifier\",\n    o.ndet AS \"number of detections\",\n    o.firstmjd AS \"first detection date\",\n    p_stamp_bogus AS \"prob_stamp_bogus\",\n    p_lc_transient AS \"prob_lc_transient\"\nFROM\n    selected_objects o\nJOIN\n    probability p_stamp_bogus ON p_stamp_bogus.oid = o.oid\n    AND p_stamp_bogus.class_name = 'bogus'\n    AND p_stamp_bogus.classifier_name = 'stamp_classifier'\n    AND p_stamp_bogus.classifier_version = 'stamp_classifier_1.0.4'\n    AND p_stamp_bogus.ranking = 1\nJOIN\n    probability p_lc ON p_lc.oid = o.oid\n    AND p_lc.class_name = 'Transient'\n    AND p_lc.classifier_name = 'lc_classifier_top'\n    AND p_lc.ranking = 1\nORDER BY\n    \"prob_stamp_bogus\" DESC\nLIMIT 30;\n```"
                },
                "in_toks": 2662,
                "out_toks": 468,
                "id": "chatcmpl-BjAdyApOzPRkbMlELkVeBd11ilLnz",
                "created": 1750105374,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "106",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability']",
                    "1": "['object', 'probability']"
                },
                "in_toks": 881,
                "out_toks": 14,
                "id": "chatcmpl-BjAd7xMaViPIISEvpVmyqud7bzvsz",
                "created": 1750105321,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select at most 30 objects with specified conditions\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_date,\n    p_stamp.probability AS prob_stamp_bogus,\n    p_top.probability AS prob_lc_transient\nFROM \n    object o\n-- Subquery to get the probability of being a bogus in stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier_1.0.4'\n        AND class_name = 'bogus'\n        AND ranking = 1\n) p_stamp ON o.oid = p_stamp.oid\n-- Subquery to get the probability of being a transient in the top level classifier\nJOIN (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier_top'\n        AND class_name = 'Transient'\n        AND ranking = 1\n) p_top ON o.oid = p_top.oid\nWHERE \n    o.ndet > 10\n    AND p_stamp.probability > 0.7\n    AND p_top.probability > 0.9\nORDER BY \n    p_stamp.probability DESC\nLIMIT 30;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select at most 30 objects with specified conditions\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.firstmjd AS first_detection_date,\n    p_stamp.probability AS prob_stamp_bogus,\n    p_top.probability AS prob_lc_transient\nFROM \n    object o\n-- Subquery to get the probability of being a bogus in stamp_classifier_1.0.4\nJOIN (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'stamp_classifier_1.0.4'\n        AND class_name = 'bogus'\n        AND ranking = 1\n) p_stamp ON o.oid = p_stamp.oid\n-- Subquery to get the probability of being a transient in the top level classifier\nJOIN (\n    SELECT \n        oid, \n        probability\n    FROM \n        probability\n    WHERE \n        classifier_name = 'lc_classifier_top'\n        AND class_name = 'Transient'\n        AND ranking = 1\n) p_top ON o.oid = p_top.oid\nWHERE \n    o.ndet > 10\n    AND p_stamp.probability > 0.7\n    AND p_top.probability > 0.9\nORDER BY \n    p_stamp.probability DESC\nLIMIT 30;\n```"
                },
                "in_toks": 2662,
                "out_toks": 289,
                "id": "chatcmpl-BjAdzKUdocPoNObKvLHtoBt2upofI",
                "created": 1750105375,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "56": {
        "0": {
            "req_id": "56",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "feature"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'feature']",
                    "1": "['object']"
                },
                "in_toks": 846,
                "out_toks": 13,
                "id": "chatcmpl-BjAd8WDSpD4c5IYYYNXwrxHJsgDMl",
                "created": 1750105322,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    (g_r_mean - g_r_max) AS \"diff between mean g- and r-band difference magnitudes\",\n    (g_r_mean_corr - g_r_max_corr) AS \"diff between mean g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from the object table for given ZTF identifiers\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    (g_r_mean - g_r_max) AS \"diff between mean g- and r-band difference magnitudes\",\n    (g_r_mean_corr - g_r_max_corr) AS \"diff between mean g- and r-band corrected magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```"
                },
                "in_toks": 5424,
                "out_toks": 176,
                "id": "chatcmpl-BjAe02eYteiUb5lJrnfqIfX97e3bh",
                "created": 1750105376,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "56",
            "experiment_id": "run_1",
            "pred_tables": [
                "object"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'feature']",
                    "1": "['object']"
                },
                "in_toks": 846,
                "out_toks": 13,
                "id": "chatcmpl-BjAd8WDSpD4c5IYYYNXwrxHJsgDMl",
                "created": 1750105322,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"diff between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"diff between max g- and r-band difference magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    oid AS \"ZTF identifier\",\n    ndet AS \"number of detections\",\n    meanra AS \"mean RA\",\n    meandec AS \"mean Dec\",\n    firstmjd AS \"date of first detection\",\n    lastmjd AS \"date of last detection\",\n    g_r_mean - g_r_mean_corr AS \"diff between mean g- and r-band difference magnitudes\",\n    g_r_max - g_r_max_corr AS \"diff between max g- and r-band difference magnitudes\"\nFROM \n    object\nWHERE \n    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd')\n    AND corrected = FALSE\nORDER BY \n    firstmjd;\n```"
                },
                "in_toks": 2444,
                "out_toks": 158,
                "id": "chatcmpl-BjAdzghIk4CdwrU7bLQEiKLIib4uX",
                "created": 1750105375,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "48": {
        "0": {
            "req_id": "48",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 786,
                "out_toks": 20,
                "id": "chatcmpl-BjAd8Xz412mZZVWRhsqz3fK872lRO",
                "created": 1750105322,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Retrieve all features for the specified ZTF object 'ZTF18abqyaix'\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"feature value\",\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Retrieve all features for the specified ZTF object 'ZTF18abqyaix'\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"feature value\",\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4866,
                "out_toks": 105,
                "id": "chatcmpl-BjAe08EKpCjcrSTebSxNHgbCQ1MZ3",
                "created": 1750105376,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "48",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "feature",
                "feature_version"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'feature', 'feature_version']",
                    "1": "['object', 'feature', 'feature_version']"
                },
                "in_toks": 786,
                "out_toks": 20,
                "id": "chatcmpl-BjAd8Xz412mZZVWRhsqz3fK872lRO",
                "created": 1750105322,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"value\",\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    f.oid AS \"ZTF identifier\",\n    f.name AS \"feature name\",\n    f.value AS \"value\",\n    f.fid AS \"filter identifier\",\n    f.version AS \"feature version\"\nFROM \n    feature f\nWHERE \n    f.oid = 'ZTF18abqyaix'\nORDER BY \n    f.oid, f.fid, f.version;\n```"
                },
                "in_toks": 4866,
                "out_toks": 85,
                "id": "chatcmpl-BjAe0b8pD3tWPv7otMfJIcSbfFRN6",
                "created": 1750105376,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "58": {
        "0": {
            "req_id": "58",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'magstat']",
                    "1": "['object', 'detection', 'magstat']"
                },
                "in_toks": 803,
                "out_toks": 22,
                "id": "chatcmpl-BjAd98rP3UwqR9WEuAzEz8yMpK01w",
                "created": 1750105323,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*\nFROM object o\nWHERE \n    -- Minimum number of detections greater than or equal to 30\n    (SELECT MAX(ndet) FROM magstat m WHERE m.oid = o.oid) >= 30\n    AND \n    -- Difference between minimum g- and r-band corrected magnitudes greater than 3.5\n    (\n        SELECT MAX(magmin_corr) FROM magstat m WHERE m.oid = o.oid AND m.fid = 1\n    ) - (\n        SELECT MAX(magmin_corr) FROM magstat m WHERE m.oid = o.oid AND m.fid = 2\n    ) > 3.5\n    AND \n    -- Difference between last and first detection times larger than 20 days\n    o.lastmjd - o.firstmjd > 20\nLIMIT 20;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nWHERE \n    -- Minimum number of detections greater than or equal to 30\n    (SELECT MAX(ndet) FROM magstat m WHERE m.oid = o.oid) >= 30\n    AND \n    -- Difference between minimum g- and r-band corrected magnitudes greater than 3.5\n    (\n        SELECT MAX(magmin_corr) FROM magstat m WHERE m.oid = o.oid AND m.fid = 1\n    ) - (\n        SELECT MAX(magmin_corr) FROM magstat m WHERE m.oid = o.oid AND m.fid = 2\n    ) > 3.5\n    AND \n    -- Difference between last and first detection times larger than 20 days\n    o.lastmjd - o.firstmjd > 20\nLIMIT 20;\n```"
                },
                "in_toks": 3666,
                "out_toks": 181,
                "id": "chatcmpl-BjAe21AIJznWHHg24Yn2mKFgFlTIu",
                "created": 1750105378,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "58",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "detection",
                "magstat"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'detection', 'magstat']",
                    "1": "['object', 'detection', 'magstat']"
                },
                "in_toks": 803,
                "out_toks": 22,
                "id": "chatcmpl-BjAd98rP3UwqR9WEuAzEz8yMpK01w",
                "created": 1750105323,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT o.*\nFROM object o\nWHERE \n    -- Minimum number of detections across all bands\n    (SELECT MIN(ndet) FROM magstat m WHERE m.oid = o.oid) >= 30\n    AND \n    -- Difference between minimum g- and r-band corrected magnitudes\n    (SELECT MIN(magmin_corr) FROM magstat m WHERE m.oid = o.oid AND m.fid IN (1, 2)) - \n    (SELECT MAX(magmax_corr) FROM magstat m WHERE m.oid = o.oid AND m.fid IN (1, 2)) > 3.5\n    AND \n    -- Difference between last and first detection times\n    o.lastmjd - o.firstmjd > 20\nLIMIT 20;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT o.*\nFROM object o\nWHERE \n    -- Minimum number of detections across all bands\n    (SELECT MIN(ndet) FROM magstat m WHERE m.oid = o.oid) >= 30\n    AND \n    -- Difference between minimum g- and r-band corrected magnitudes\n    (SELECT MIN(magmin_corr) FROM magstat m WHERE m.oid = o.oid AND m.fid IN (1, 2)) - \n    (SELECT MAX(magmax_corr) FROM magstat m WHERE m.oid = o.oid AND m.fid IN (1, 2)) > 3.5\n    AND \n    -- Difference between last and first detection times\n    o.lastmjd - o.firstmjd > 20\nLIMIT 20;\n```"
                },
                "in_toks": 3666,
                "out_toks": 168,
                "id": "chatcmpl-BjAe2YFmflHWnlD9pI6Ea01NeovAl",
                "created": 1750105378,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "78": {
        "0": {
            "req_id": "78",
            "experiment_id": "run_0",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']",
                    "1": "['taxonomy']"
                },
                "in_toks": 766,
                "out_toks": 6,
                "id": "chatcmpl-BjAdAS1OB6XElQx9vaOJW7zVsfsXV",
                "created": 1750105324,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```"
                },
                "in_toks": 1927,
                "out_toks": 39,
                "id": "chatcmpl-BjAe1alR8vyg3KKo9f1rha0J81brh",
                "created": 1750105377,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "78",
            "experiment_id": "run_1",
            "pred_tables": [
                "taxonomy"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['taxonomy']",
                    "1": "['taxonomy']"
                },
                "in_toks": 766,
                "out_toks": 6,
                "id": "chatcmpl-BjAdAS1OB6XElQx9vaOJW7zVsfsXV",
                "created": 1750105324,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\nSELECT \n    classifier_name AS name, \n    classifier_version AS version, \n    classes\nFROM \n    taxonomy\nWHERE \n    classifier_name LIKE 'lc_classifier%';\n```"
                },
                "in_toks": 1927,
                "out_toks": 39,
                "id": "chatcmpl-BjAe2EbnzzkqcBPbbycXOzynxeTKO",
                "created": 1750105378,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    },
    "39": {
        "0": {
            "req_id": "39",
            "experiment_id": "run_0",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "forced_photometry"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'forced_photometry']",
                    "1": "['object', 'probability', 'detection', 'reference']"
                },
                "in_toks": 859,
                "out_toks": 31,
                "id": "chatcmpl-BjAdAkNYjP6LpbAiDLjnBDhB9Nq21",
                "created": 1750105324,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns: object identifier, candidate identifier, filter id as 'f_id', coordinates, magnitude, and magnitude errors\nSELECT\n    d.oid AS object_id,\n    d.candid AS candidate_id,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf AS magnitude,\n    d.sigmapsf AS mag_error,\n    -- Corrected difference magnitude in the r-band filter\n    d.magpsf_corr AS mag_corr_r,\n    -- PSF corrected magnitude in the r-filter\n    d.magpsf AS psf_mag_r,\n    -- Maximum rise from minimum in each detection\n    (MAX(d.magpsf) OVER (PARTITION BY d.oid) - MIN(d.magpsf) OVER (PARTITION BY d.oid)) AS max_rise\nFROM\n    detection d\nWHERE\n    -- Filter objects with the highest probability class as CV/Nova by the stochastic light curve classifier\n    -- First, identify objects with ranking=1 in probability table for CV/Nova class and 'lc_classifier_stochastic'\n    -- Subquery to get object ids with CV/Nova as top class\n    oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.class_name = 'CV/Nova'\n            AND p.classifier_name = 'lc_classifier_stochastic'\n            AND p.ranking = 1\n    )\n    -- Filter objects with at most 50 detections from first to last detection\n    AND (\n        SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid\n    ) <= 50\n    -- Filter detection date range from first to last detection for each object\n    AND d.mjd BETWEEN (\n        SELECT MIN(mjd) FROM detection d2 WHERE d2.oid = d.oid\n    ) AND (\n        SELECT MAX(mjd) FROM detection d2 WHERE d2.oid = d.oid\n    )\nORDER BY\n    d.oid\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns: object identifier, candidate identifier, filter id as 'f_id', coordinates, magnitude, and magnitude errors\nSELECT\n    d.oid AS object_id,\n    d.candid AS candidate_id,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf AS magnitude,\n    d.sigmapsf AS mag_error,\n    -- Corrected difference magnitude in the r-band filter\n    d.magpsf_corr AS mag_corr_r,\n    -- PSF corrected magnitude in the r-filter\n    d.magpsf AS psf_mag_r,\n    -- Maximum rise from minimum in each detection\n    (MAX(d.magpsf) OVER (PARTITION BY d.oid) - MIN(d.magpsf) OVER (PARTITION BY d.oid)) AS max_rise\nFROM\n    detection d\nWHERE\n    -- Filter objects with the highest probability class as CV/Nova by the stochastic light curve classifier\n    -- First, identify objects with ranking=1 in probability table for CV/Nova class and 'lc_classifier_stochastic'\n    -- Subquery to get object ids with CV/Nova as top class\n    oid IN (\n        SELECT p.oid\n        FROM probability p\n        WHERE\n            p.class_name = 'CV/Nova'\n            AND p.classifier_name = 'lc_classifier_stochastic'\n            AND p.ranking = 1\n    )\n    -- Filter objects with at most 50 detections from first to last detection\n    AND (\n        SELECT COUNT(*) FROM detection d2 WHERE d2.oid = d.oid\n    ) <= 50\n    -- Filter detection date range from first to last detection for each object\n    AND d.mjd BETWEEN (\n        SELECT MIN(mjd) FROM detection d2 WHERE d2.oid = d.oid\n    ) AND (\n        SELECT MAX(mjd) FROM detection d2 WHERE d2.oid = d.oid\n    )\nORDER BY\n    d.oid\nLIMIT 1000;\n```"
                },
                "in_toks": 3881,
                "out_toks": 420,
                "id": "chatcmpl-BjAe2moldfWvWk4hRl9t16m3W0zKW",
                "created": 1750105378,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        },
        "1": {
            "req_id": "39",
            "experiment_id": "run_1",
            "pred_tables": [
                "object",
                "probability",
                "detection",
                "reference"
            ],
            "schema_linking_response": {
                "responses": {
                    "0": "['object', 'probability', 'detection', 'forced_photometry']",
                    "1": "['object', 'probability', 'detection', 'reference']"
                },
                "in_toks": 859,
                "out_toks": 31,
                "id": "chatcmpl-BjAdAkNYjP6LpbAiDLjnBDhB9Nq21",
                "created": 1750105324,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "sql_query": "```sql\n-- Select specified columns from detection, object, and probability tables\nWITH filtered_objects AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        d.magpsf_corr AS mag_corr,\n        d.magap AS mag_ap,\n        d.sigmagap AS mag_ap_err,\n        d.magpsf_corr AS mag_psf_corr,\n        MAX(d.magpsf) OVER (PARTITION BY o.oid) - MIN(d.magpsf) OVER (PARTITION BY o.oid) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for objects with at most 50 detections\n        (SELECT COUNT(*) FROM detection d2 WHERE d2.oid = o.oid) <= 50\n        -- Filter for detection date range from first to last detection\n        AND d.mjd BETWEEN o.firstmjd AND o.lastmjd\n        -- Filter for corrected difference magnitude in r-band (fid=2)\n        AND d.corrected = TRUE\n        AND d.fid = 2\n),\nprobabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier_stochastic'\n        AND p.class_name = 'CV/Nova'\n        AND p.ranking = 1\n),\n-- Filter objects where the most probable class is CV/Nova\nobjects_with_cv_nova AS (\n    SELECT\n        fo.*\n    FROM\n        filtered_objects fo\n    JOIN\n        probabilities p ON fo.oid = p.oid\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr,\n    mag_ap,\n    mag_ap_err,\n    max_rise\nFROM\n    objects_with_cv_nova\nORDER BY\n    oid\nLIMIT 1000;\n```",
            "sql_response": {
                "responses": {
                    "0": "```sql\n-- Select specified columns from detection, object, and probability tables\nWITH filtered_objects AS (\n    SELECT\n        o.oid,\n        d.candid,\n        d.rfid AS f_id,\n        d.ra,\n        d.dec,\n        d.magpsf AS mag,\n        d.sigmapsf AS mag_err,\n        d.magpsf_corr AS mag_corr,\n        d.magap AS mag_ap,\n        d.sigmagap AS mag_ap_err,\n        d.magpsf_corr AS mag_psf_corr,\n        MAX(d.magpsf) OVER (PARTITION BY o.oid) - MIN(d.magpsf) OVER (PARTITION BY o.oid) AS max_rise\n    FROM\n        detection d\n    JOIN\n        object o ON d.oid = o.oid\n    WHERE\n        -- Filter for objects with at most 50 detections\n        (SELECT COUNT(*) FROM detection d2 WHERE d2.oid = o.oid) <= 50\n        -- Filter for detection date range from first to last detection\n        AND d.mjd BETWEEN o.firstmjd AND o.lastmjd\n        -- Filter for corrected difference magnitude in r-band (fid=2)\n        AND d.corrected = TRUE\n        AND d.fid = 2\n),\nprobabilities AS (\n    SELECT\n        p.oid,\n        p.class_name,\n        p.classifier_name,\n        p.probability,\n        p.ranking\n    FROM\n        probability p\n    WHERE\n        p.classifier_name = 'lc_classifier_stochastic'\n        AND p.class_name = 'CV/Nova'\n        AND p.ranking = 1\n),\n-- Filter objects where the most probable class is CV/Nova\nobjects_with_cv_nova AS (\n    SELECT\n        fo.*\n    FROM\n        filtered_objects fo\n    JOIN\n        probabilities p ON fo.oid = p.oid\n)\nSELECT\n    oid,\n    candid,\n    f_id,\n    ra,\n    dec,\n    mag,\n    mag_err,\n    mag_corr,\n    mag_ap,\n    mag_ap_err,\n    max_rise\nFROM\n    objects_with_cv_nova\nORDER BY\n    oid\nLIMIT 1000;\n```"
                },
                "in_toks": 3554,
                "out_toks": 458,
                "id": "chatcmpl-BjAe3hj5CSgR7NZcRed8ZXoMVwHYM",
                "created": 1750105379,
                "model": "gpt-4.1-nano-2025-04-14"
            },
            "pred_diff": null,
            "diff_response": null
        }
    }
}