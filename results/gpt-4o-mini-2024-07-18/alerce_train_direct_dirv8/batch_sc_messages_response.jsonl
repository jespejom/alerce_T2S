{"id": "batch_req_683a4348b12c819082e64ff12cc34319", "custom_id": "13-0", "response": {"status_code": 200, "request_id": "0c7dc00fac68e28f95713df1595d3f05", "body": {"id": "chatcmpl-Bd3fjVI1IIkXjcHix6ACmjFmo5j4z", "object": "chat.completion", "created": 1748648607, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve all Super Nova (SNe) objects first detected between December 1, 2022, and September 1, 2023\nSELECT \n    p.class_name,  -- Return the probability class\n    o.firstmjd,    -- Return the first detection date\n    o.lastmjd,     -- Return the last detection date\n    o.oid          -- Return the object identifier\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for Super Nova classes\n    AND o.firstmjd BETWEEN 59914.0 AND 60217.0  -- Filter for first detection dates between December 1, 2022, and September 1, 2023\n    AND p.ranking = 1  -- Ensure we are selecting the most probable class\n    AND p.classifier_name = 'YourClassifierName'  -- Add a condition for classifier name\n    AND p.classifier_version = 'YourClassifierVersion'  -- Add a condition for classifier version\n    AND p.probability > 0.5;  -- Add a condition for minimum probability threshold\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1502, "completion_tokens": 269, "total_tokens": 1771, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a4348bf6c8190ba69cf75ac68349d", "custom_id": "13-1", "response": {"status_code": 200, "request_id": "16913a44a0c45e5c5000c2fb803c3e18", "body": {"id": "chatcmpl-Bd3fjsgl0BBsHa88pYxIv9kQoYI4G", "object": "chat.completion", "created": 1748648607, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve all Super Nova (SNe) objects first detected between December 1, 2022, and September 1, 2023\nSELECT \n    p.class_name,  -- Return the probability class\n    o.firstmjd,    -- Return the first detection date\n    o.lastmjd,     -- Return the last detection date\n    o.oid          -- Return the object identifier\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    o.firstmjd BETWEEN 59914.0 AND 60217.0  -- Filter for first detection dates between December 1, 2022, and September 1, 2023\n    AND p.ranking = 1  -- Ensure we are only considering the most likely class\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN');  -- Filter for Super Nova classes\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1541, "completion_tokens": 206, "total_tokens": 1747, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a4348d40481909706d585a16becf2", "custom_id": "15-0", "response": {"status_code": 200, "request_id": "c9393faa9edeeeb37bcce1147ff2fb9a", "body": {"id": "chatcmpl-Bd3fiIoDbea4zYTXRXv4cIqFBnmp7", "object": "chat.completion", "created": 1748648606, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH first_detections AS (\n    SELECT oid, MIN(mjd) AS first_mjd\n    FROM detection\n    WHERE mjd BETWEEN 60188.0 AND 60189.0\n    GROUP BY oid\n),\nfast_risers AS (\n    SELECT o.oid, \n           p.probability, \n           d.fid, \n           d.candid, \n           d.magpsf, \n           d.mjd, \n           m.fid AS magstat_fid, \n           m.dm_first, \n           m.sigmadm_first\n    FROM object o\n    JOIN probability p ON o.oid = p.oid\n    JOIN detection d ON o.oid = d.oid\n    JOIN magstat m ON o.oid = m.oid\n    JOIN first_detections fd ON o.oid = fd.oid\n    WHERE p.class_name = 'SN' \n      AND p.classifier_name = 'stamp_classifier'\n      AND p.ranking = 1  -- Ensuring we only take the highest probability class\n      AND fd.first_mjd = d.mjd  -- Ensuring we only take the first detection\n      AND (d.magpsf - m.maglast) / (d.mjd - m.lastmjd) >= 0.25  -- Fast riser condition\n)\nSELECT oid, \n       probability, \n       fid, \n       candid, \n       magstat_fid, \n       dm_first AS initial_rise_estimate\nFROM fast_risers\nORDER BY oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2761, "completion_tokens": 320, "total_tokens": 3081, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a4348e1a48190976466f92b8616b1", "custom_id": "7-0", "response": {"status_code": 200, "request_id": "2cfc11595675f5fd2136402105f8cd2d", "body": {"id": "chatcmpl-Bd3fkO6ZSd0fSEkX3vSbBYy4rwjcX", "object": "chat.completion", "created": 1748648608, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve object identifiers and probabilities for objects classified as 'SN' \n-- by the stamp classifier with first detection in January 2023\nSELECT o.oid, p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid -- Join the object table with the probability table\nWHERE o.firstmjd BETWEEN 59945.0 AND 59975.0 -- First detection in January 2023\nAND p.classifier_name = 'stamp_classifier'  -- Filter for the stamp classifier\nAND p.class_name = 'SN'                     -- Filter for the class 'SN'\nAND p.ranking = 1;                          -- Most likely class\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1301, "completion_tokens": 142, "total_tokens": 1443, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a4348f6ec81909dff1fea7ef22c50", "custom_id": "7-1", "response": {"status_code": 200, "request_id": "c7ae0e30e43ae8f612caa6a96bdfba7b", "body": {"id": "chatcmpl-Bd3fit66I0lWHUFueklcoZTzqv4FU", "object": "chat.completion", "created": 1748648606, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Retrieve object identifiers and probabilities for objects classified as 'SN' \n-- by the stamp classifier with first detection in January 2023\nSELECT o.oid, p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid -- Join the object table with the probability table\nWHERE o.firstmjd BETWEEN 59945.0 AND 59975.0 -- First detection in January 2023\nAND p.class_name = 'SN'  -- Filter for class 'SN'\nAND p.classifier_name = 'stamp_classifier'  -- Filter for the stamp classifier\nAND p.ranking = 1; -- Most likely class\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1301, "completion_tokens": 140, "total_tokens": 1441, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a434906d48190b44c18792f7e7f33", "custom_id": "23-0", "response": {"status_code": 200, "request_id": "9db60e1209e379827605bb76abeb286d", "body": {"id": "chatcmpl-Bd3fi7YritBeQj8iniTEFtf211fzA", "object": "chat.completion", "created": 1748648606, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Selecting all classification probabilities for objects classified as SNIa, SNIbc, SNII, or SLSN by the lc_classifier\n-- with a probability greater than 0.2, ensuring we only get the most likely classification (ranking = 1).\n\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for specific classes\n      AND classifier_name = 'lc_classifier'                -- Filter for the specific classifier\n      AND probability > 0.2                                 -- Filter for probability greater than 0.2\n      AND ranking = 1                                       -- Ensure we only consider the most likely classification\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1332, "completion_tokens": 161, "total_tokens": 1493, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a434926f481909d50283ad2727ab7", "custom_id": "23-1", "response": {"status_code": 200, "request_id": "49e407b697a921045cb6a87a37332f08", "body": {"id": "chatcmpl-Bd3fi35qM6iIqiDGi7CTrh1jgpwzt", "object": "chat.completion", "created": 1748648606, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Selecting all classification probabilities for objects classified as SNIa, SNIbc, SNII, or SLSN \n-- by the lc_classifier with a probability higher than 0.2 and ensuring we only get the most likely classification (ranking = 1).\n\nSELECT *\nFROM probability\nWHERE oid IN (\n    SELECT oid\n    FROM probability\n    WHERE class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for specific classes\n      AND classifier_name = 'lc_classifier'               -- Filter for the specific classifier\n      AND probability > 0.2                                 -- Filter for probability greater than 0.2\n      AND ranking = 1                                      -- Ensure we only consider the most likely classification\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1332, "completion_tokens": 161, "total_tokens": 1493, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a43494f308190a31dc974a5fd478b", "custom_id": "11-0", "response": {"status_code": 200, "request_id": "27b0cda450fe8a03715c5600c7fcc55f", "body": {"id": "chatcmpl-Bd3fjLDF6nLyyJ6AqtiLaf8p6nF5C", "object": "chat.completion", "created": 1748648607, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to obtain all Type Ia SNe whose first detection happened last September,\n-- whose peak magnitude is above 19 and whose g-r color at maximum is below 1.\nWITH type_ia_sne AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'SNIa' \n      AND p.classifier_name = 'lc_classifier'\n      AND p.ranking = 1\n),\nfiltered_objects AS (\n    SELECT o.oid, \n           m.magmax_corr AS magmax,  -- Use magmax_corr for corrected maximum magnitude\n           o.g_r_max_corr AS g_r_max  -- Use g_r_max_corr for corrected g-r color at maximum\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    WHERE o.firstmjd >= 60188.0  -- First detection in September 2022\n      AND o.firstmjd <= 60217.0\n      AND m.magmax_corr > 19      -- Check corrected maximum magnitude\n      AND o.g_r_max_corr < 1      -- Check corrected g-r color at maximum\n)\nSELECT f.oid, \n       f.g_r_max, \n       f.magmax, \n       m.fid\nFROM filtered_objects f\nJOIN magstat m ON f.oid = m.oid\nWHERE m.ndet > 0; -- Ensure there are detections in the given band\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4657, "completion_tokens": 300, "total_tokens": 4957, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a43495ea08190bf88649aead4a78c", "custom_id": "11-1", "response": {"status_code": 200, "request_id": "2bfdafc343e8c3ab25bc35b2b160bfad", "body": {"id": "chatcmpl-Bd3fiwfcsr6fTEtNu0XW1gWELF1mv", "object": "chat.completion", "created": 1748648606, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to obtain all Type Ia SNe whose first detection happened last September,\n-- whose peak magnitude is above 19 and whose g-r color at maximum is below 1.\nWITH type_ia_sne AS (\n    SELECT o.oid, \n           m.magmax_corr AS magmax,  -- Use corrected maximum magnitude\n           o.g_r_max_corr AS g_r_max, -- Use corrected g-r color at maximum\n           m.fid\n    FROM object o\n    JOIN magstat m ON o.oid = m.oid\n    JOIN probability p ON o.oid = p.oid\n    WHERE p.class_name = 'SNIa' \n      AND p.ranking = 1 \n      AND o.firstmjd >= 60188.0  -- September 2022 in MJD\n      AND o.firstmjd <= 60217.0  -- End of September 2022 in MJD\n      AND m.magmax_corr > 19      -- Check corrected maximum magnitude\n      AND o.g_r_max_corr < 1      -- Check corrected g-r color at maximum\n)\nSELECT oid, g_r_max, magmax, fid\nFROM type_ia_sne;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4562, "completion_tokens": 251, "total_tokens": 4813, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a43496eb48190bdb0e4d285709a6d", "custom_id": "9-0", "response": {"status_code": 200, "request_id": "84a1ae4ef0afc0b31d30a078a2fdaabf", "body": {"id": "chatcmpl-Bd3fjfFxtT36BZ46ewGr23gQJPZdf", "object": "chat.completion", "created": 1748648607, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH first_detection AS (\n    -- Select object identifiers and their mean coordinates for detections in July 2023\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 60126.0 AND 60156.0\n),\nprobabilities AS (\n    -- Get the maximum probability for each class from the probability table\n    SELECT oid, class_name, MAX(probability) AS max_probability\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    GROUP BY oid, class_name\n),\nfiltered_probabilities AS (\n    -- Filter out objects with the highest probability for classes Asteroid and Bogus\n    SELECT oid\n    FROM probabilities\n    WHERE max_probability IS NOT NULL\n    AND class_name NOT IN ('Asteroid', 'bogus')\n),\ncatalog AS (\n    -- Join the first detection, feature, and filtered probabilities to get the required data\n    SELECT fd.oid, fd.meanra, fd.meandec, f.value, f.name, f.version,\n           q3c_dist(fd.meanra, fd.meandec, 39.97, -1.5768) AS dist\n    FROM first_detection fd\n    JOIN feature f ON fd.oid = f.oid\n    JOIN filtered_probabilities fp ON fd.oid = fp.oid\n    -- The sgscore1 condition is applied in the feature table\n    WHERE f.name = 'sgscore1' AND f.value < 0.3\n    AND q3c_join(fd.meanra, fd.meandec, 39.97, -1.5768, 16.16667) = true\n)\n-- Select the final output columns\nSELECT oid, value, name, version, meanra, meandec, dist\nFROM catalog;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4248, "completion_tokens": 373, "total_tokens": 4621, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a434982248190bff0a86dc072ef75", "custom_id": "9-1", "response": {"status_code": 200, "request_id": "e43e3f984a2767634c4b271b221fd846", "body": {"id": "chatcmpl-Bd3flblHYxiBbRKW9fAuqnmnJnxSp", "object": "chat.completion", "created": 1748648609, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH first_detection AS (\n    -- Select object identifiers and their mean coordinates for detections in July 2023\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 60126.0 AND 60156.0\n),\nprobabilities AS (\n    -- Select object identifiers and their probabilities excluding certain classes\n    SELECT oid, class_name, probability, ranking\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier' \n      AND class_name NOT IN ('Asteroid', 'bogus')  -- Corrected 'bogus' to 'Bogus' for case sensitivity\n      AND ranking = 1\n),\nfiltered_objects AS (\n    -- Join first detections with probabilities and filter based on sgscore1\n    SELECT fd.oid, fd.meanra, fd.meandec, p.probability\n    FROM first_detection fd\n    JOIN probabilities p ON fd.oid = p.oid\n    JOIN feature f ON fd.oid = f.oid  -- Join with feature to access sgscore1\n    WHERE p.probability IS NOT NULL\n      AND f.name = 'sgscore1'  -- Filter for the sgscore1 feature\n      AND f.value < 0.3  -- Use the value of sgscore1 from the feature table\n)\nSELECT fo.oid, f.value, f.name, f.version, fo.meanra, fo.meandec, \n       q3c_dist(39.97, -1.5768, fo.meanra, fo.meandec) AS dist\nFROM filtered_objects fo\nJOIN feature f ON fo.oid = f.oid\nWHERE q3c_radial_query(fo.meanra, fo.meandec, 39.97, -1.5768, 16.16667);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4209, "completion_tokens": 380, "total_tokens": 4589, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a43498f5c819092d3906365ac9290", "custom_id": "5-0", "response": {"status_code": 200, "request_id": "4fc679fd10dd8c16983533f352aa213e", "body": {"id": "chatcmpl-Bd3fkgL5x5yIRGVbWnpuQB0hvfTpJ", "object": "chat.completion", "created": 1748648608, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve object identifier, candidate identifier, feature name and value, psf magnitudes, magnitude errors, and band identifiers\n-- for objects classified as SN II with specific conditions\nSELECT \n    o.oid, \n    d.candid, \n    f.name, \n    f.value, \n    d.magpsf, \n    d.sigmapsf, \n    f.fid AS feature_fid\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'SNII' \n    AND p.probability > 0.6 \n    AND p.ranking = 1  -- Ensuring we only consider the highest ranking for SNII\n    AND o.ndet > 50 \n    AND (SELECT MAX(f2.value) - MIN(f2.value) \n         FROM feature f2 \n         WHERE f2.oid = o.oid AND f2.fid = 1) > 2 -- Assuming fid = 1 corresponds to g-band\nORDER BY \n    o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4560, "completion_tokens": 255, "total_tokens": 4815, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a43499d78819083bb7e290853c2b1", "custom_id": "5-1", "response": {"status_code": 200, "request_id": "1b47b4e21eb265cde28b931935116f93", "body": {"id": "chatcmpl-Bd3fmlmBGjFEkn8OBRMs73LCHD65H", "object": "chat.completion", "created": 1748648610, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve object identifier, candidate identifier, feature name and value, psf magnitudes, magnitude errors, and band identifiers\n-- for objects classified as SN II with specific conditions\nSELECT \n    o.oid, \n    d.candid, \n    f.name, \n    f.value, \n    d.magpsf, \n    d.sigmapsf, \n    f.fid AS feature_fid\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nJOIN \n    detection d ON o.oid = d.oid\nJOIN \n    feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'SNII' \n    AND p.probability > 0.6 \n    AND p.ranking = 1  -- Ensuring we only consider the highest ranking class\n    AND o.ndet > 50 \n    AND (SELECT MAX(d2.magap) - MIN(d2.magap) \n         FROM detection d2 \n         WHERE d2.oid = o.oid AND d2.fid = 1) > 2\nORDER BY \n    o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 4544, "completion_tokens": 245, "total_tokens": 4789, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a4349abc08190b504a427c79396f8", "custom_id": "38-0", "response": {"status_code": 200, "request_id": "119570d0bd00ae4a74d19a84a2c92a39", "body": {"id": "chatcmpl-Bd3fjSEqmiaAmRPpr9ydppduSKRK8", "object": "chat.completion", "created": 1748648607, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve the top 1000 AGN and QSO candidates with specified conditions\nWITH agn_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN' \n      AND p.classifier_name = 'lc_classifier' \n      AND p.probability > 0.6\n      AND p.ranking = 1  -- Ensure we are only considering the top-ranked AGN\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\nqso_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO' \n      AND p.classifier_name = 'lc_classifier' \n      AND p.probability > 0.5\n      AND p.ranking = 1  -- Ensure we are only considering the top-ranked QSO\n    ORDER BY p.probability DESC\n    LIMIT 1000\n)\nSELECT o.*\nFROM object o\nWHERE (o.oid IN (SELECT oid FROM agn_candidates)\n   OR o.oid IN (SELECT oid FROM qso_candidates))\n   AND o.ndet BETWEEN 30 AND 200;  -- Ensure we only get objects with detections in the specified range\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1541, "completion_tokens": 261, "total_tokens": 1802, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a4349b9e88190ba11e0747b55bc42", "custom_id": "38-1", "response": {"status_code": 200, "request_id": "5dfdfa3e0a4c577be715ad40d219c5eb", "body": {"id": "chatcmpl-Bd3flBDqbHqN4kvVYRfwSuXoVbLtB", "object": "chat.completion", "created": 1748648609, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve the top 1000 AGN and QSO candidates with specified conditions\nWITH agn_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.6\n      AND o.ndet BETWEEN 30 AND 200\n      AND p.ranking = 1  -- Ensuring we only consider the top-ranked AGN\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\nqso_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.probability > 0.5\n      AND o.ndet BETWEEN 30 AND 200\n      AND p.ranking = 1  -- Ensuring we only consider the top-ranked QSO\n    ORDER BY p.probability DESC\n    LIMIT 1000\n)\nSELECT * FROM agn_candidates\nUNION ALL\nSELECT * FROM qso_candidates;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1573, "completion_tokens": 263, "total_tokens": 1836, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a4349ce708190a852403d055747c3", "custom_id": "24-0", "response": {"status_code": 200, "request_id": "842b19d76fcb5110f980d10b3e89c612", "body": {"id": "chatcmpl-Bd3fkYgjPeIPZmw76Bpo35cFraWg1", "object": "chat.completion", "created": 1748648608, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n    ('source_1', 160.18301441363647, 33.0164673528409),\n    ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT * \nFROM object o\nWHERE \n    EXISTS (SELECT 1 FROM catalog c WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)) -- Ensure the object is matched with the catalog\n    AND o.firstmjd >= 59976.0 -- First detection on or after February 01\n    AND o.firstmjd < 59983.0; -- First detection before February 08\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1438, "completion_tokens": 164, "total_tokens": 1602, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a4349e0788190b8e78b20175a971f", "custom_id": "24-1", "response": {"status_code": 200, "request_id": "20bba6d747022a8f6f650f2b79004ce6", "body": {"id": "chatcmpl-Bd3flDK6k51OcODDxc33jW6IvGkWZ", "object": "chat.completion", "created": 1748648609, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n    ('source_1', 160.18301441363647, 33.0164673528409),\n    ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT * \nFROM object o\nWHERE \n    EXISTS (SELECT 1 FROM catalog c WHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)) -- Ensure the object is matched with the catalog\n    AND o.firstmjd >= 59976.0 -- First detection on or after February 01\n    AND o.firstmjd <= 59982.0; -- First detection on or before February 07\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1442, "completion_tokens": 166, "total_tokens": 1608, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a4349f2048190b61b27e2d55d5bd6", "custom_id": "98-1", "response": {"status_code": 200, "request_id": "e526993da8f0b48b0d858971ad475502", "body": {"id": "chatcmpl-Bd3fmqKv14rOT4KjIGMkdAydqpXDW", "object": "chat.completion", "created": 1748648610, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Selecting distinct ZTF objects with a probability larger than 0.7 of being a QSO\nWITH filtered_objects AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE probability > 0.7\n      AND class_name = 'QSO'\n      AND classifier_name = 'lc_classifier'\n    LIMIT 200\n)\n-- Selecting all columns from xmatch for filtered objects\nSELECT x.*\nFROM xmatch x\nJOIN filtered_objects fo ON x.oid = fo.oid\nUNION ALL\n-- Selecting specific columns from allwise for filtered objects\nSELECT a.oid_catalog, a.ra, a.dec, a.w1mpro, a.w2mpro, a.w3mpro, a.w4mpro, \n       a.w1sigmpro, a.w2sigmpro, a.w3sigmpro, a.w4sigmpro, \n       a.j_m_2mass, a.h_m_2mass, a.k_m_2mass, \n       a.j_msig_2mass, a.h_msig_2mass, a.k_msig_2mass\nFROM allwise a\nJOIN filtered_objects fo ON a.oid_catalog = fo.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2092, "completion_tokens": 253, "total_tokens": 2345, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a434a02dc8190afb05f5db44376e5", "custom_id": "88-0", "response": {"status_code": 200, "request_id": "7e148e8e28dad15a674a09fd536e300d", "body": {"id": "chatcmpl-Bd3fkVU1RsgAgAYM2M7YwismWaL2F", "object": "chat.completion", "created": 1748648608, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\", \n    o.ndet AS \"number of detections\", \n    o.meanra AS \"mean RA\", \n    o.meandec AS \"mean Dec\", \n    p.classifier_version AS \"classifier version\", \n    p.probability AS \"probability\"\nFROM \n    object o \nJOIN \n    probability p ON o.oid = p.oid  -- Join the probability table to access classifier_version and probability\nWHERE \n    o.ndet >= 20 AND \n    p.class_name = 'bogus' AND \n    p.ranking = 1 AND \n    p.classifier_name = 'stamp_classifier'  -- Filter for the specific class and ranking\nLIMIT 50; \n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1904, "completion_tokens": 159, "total_tokens": 2063, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a434a12d48190aea3fcf080d685a8", "custom_id": "88-1", "response": {"status_code": 200, "request_id": "368d6d59d2dd4ad97fec46a1f2cd02b7", "body": {"id": "chatcmpl-Bd3fmnPNJJjJlFM3JkAyNdkYkmtjb", "object": "chat.completion", "created": 1748648610, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid AS \"ZTF identifier\", \n    o.ndet AS \"number of detections\", \n    o.meanra AS \"mean RA\", \n    o.meandec AS \"mean Dec\", \n    p.classifier_version AS \"classifier version\", \n    p.probability AS \"probability\"\nFROM \n    object o \nJOIN \n    probability p ON o.oid = p.oid  -- Join the probability table to access classifier_version and probability\nWHERE \n    o.ndet >= 20 AND \n    p.class_name = 'bogus' AND \n    p.ranking = 1 AND \n    p.classifier_name = 'stamp_classifier'  -- Filter for the specific class and ranking\nLIMIT 50; \n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1904, "completion_tokens": 159, "total_tokens": 2063, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a434a215c8190a9277c50c152861b", "custom_id": "105-1", "response": {"status_code": 200, "request_id": "f28340ee3b49febcded4c69974d35cb6", "body": {"id": "chatcmpl-Bd3fmoqYrKXq880VEF9QvKQVRDGqh", "object": "chat.completion", "created": 1748648610, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    -- Select objects with AGN probability greater than 0.7\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n      AND p.classifier_name = 'lc_classifier'\n      AND p.classifier_version = 'hierarchical_rf_1.1.0'\n      AND p.probability > 0.7\n),\nnearest_ps1 AS (\n    -- Select nearest PS1 sources with distance less than 2 arcsec\n    SELECT ps.oid, ps.candid, ps.sgscore1, ps.distpsnr1\n    FROM ps1_ztf ps\n    JOIN filtered_objects fo ON ps.oid = fo.oid\n    WHERE ps.distpsnr1 < 2\n)\nSELECT o.oid AS ztf_identifier, \n       p.probability,\n       n.candid,\n       n.sgscore1 AS ps1_star_galaxy_score,\n       n.distpsnr1 AS distance_to_ps1,\n       -- Corrected to use the correct table and column for SExtractor star/galaxy score\n       s.sgscore1 AS star_galaxy_score_sExtractor\nFROM object o\nJOIN filtered_objects p ON o.oid = p.oid\nJOIN nearest_ps1 n ON o.oid = n.oid\nJOIN ps1_ztf s ON n.candid = s.candid\nWHERE ABS(n.sgscore1 - s.sgscore1) < 0.5 -- Ensure we are comparing the correct star/galaxy scores\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2572, "completion_tokens": 330, "total_tokens": 2902, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a434a337c81908b78e745d9f77d04", "custom_id": "86-1", "response": {"status_code": 200, "request_id": "52a8d868011e299d67d05fb37de38880", "body": {"id": "chatcmpl-Bd3fkkGh4Dk2MGmg9Cq0upAKQL6UL", "object": "chat.completion", "created": 1748648608, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to find ZTF objects with specific probability and PS1 star/galaxy score conditions\nSELECT p.*, ps1.*\nFROM probability p\n-- Join with ps1_ztf table to access star/galaxy scores\nJOIN ps1_ztf ps1 ON p.oid = ps1.oid\n-- Filter probabilities for Cepheid, Delta Scuti, and RR Lyrae\nWHERE p.probability > 0.6 \n  AND p.class_name IN ('CEP', 'DSCT', 'RRL') \n  AND p.classifier_name = 'lc_classifier' \n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  -- Ensure the star/galaxy score is greater than 0.8 for any of the three closest sources\n  AND (ps1.sgscore1 > 0.8 OR ps1.sgscore2 > 0.8 OR ps1.sgscore3 > 0.8)\nLIMIT 100; -- Limit the result to at most 100 rows\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2222, "completion_tokens": 219, "total_tokens": 2441, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a434a4574819080be0d276c7f2d67", "custom_id": "76-0", "response": {"status_code": 200, "request_id": "a22c01b56ca5e703b8d285ccec933306", "body": {"id": "chatcmpl-Bd3fngk7hFea3aJG5yYr9LK7o1dRx", "object": "chat.completion", "created": 1748648611, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES ('115185', /* RA value */, /* DEC value */)  -- Replace with actual RA and DEC values for the solar system object\n)\nSELECT \n    o.oid AS ztf_identifier, \n    ss.ssmagnr AS mpc_archive_magnitude, \n    q3c_dist(c.ra, c.dec, o.meanra, o.meandec) AS distance  -- Corrected to use c.ra and c.dec\nFROM \n    object o\nJOIN \n    ss_ztf ss ON o.oid = ss.oid\nJOIN \n    catalog c ON q3c_join(o.meanra, o.meandec, c.ra, c.dec, 1.5/3600.0)  -- Convert arcsec to degrees\nORDER BY \n    distance;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1430, "completion_tokens": 179, "total_tokens": 1609, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683a434a53dc8190acfaebb00674a246", "custom_id": "76-1", "response": {"status_code": 200, "request_id": "637af4b7936cca69ad2b2738cff24763", "body": {"id": "chatcmpl-Bd3fm6hzU5Ug5ogOT7Awz64qF4yzi", "object": "chat.completion", "created": 1748648610, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH catalog (source_id, ra, dec) AS (\n    VALUES ('115185', /* RA value */, /* DEC value */)  -- Replace with actual RA and DEC values for the Solar System object\n)\nSELECT \n    o.oid AS ztf_identifier, \n    s.ssmagnr AS mpc_archive_magnitude, \n    q3c_dist(c.ra, c.dec, o.meanra, o.meandec) AS distance  -- Corrected to use c.ra and c.dec\nFROM \n    object o\nJOIN \n    ss_ztf s ON o.oid = s.oid\nJOIN \n    catalog c ON q3c_join(c.ra, c.dec, o.meanra, o.meandec, 1.5/3600.0)  -- 1.5 arcsec to degrees\nORDER BY \n    distance;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 1436, "completion_tokens": 182, "total_tokens": 1618, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
