{"id": "batch_req_683d30c7e278819099e53e8ce33c8407", "custom_id": "10-0", "response": {"status_code": 200, "request_id": "96d5248b9313dbb18e44cec89122c0b5", "body": {"id": "chatcmpl-BdrckjCazah3xcYTgDGQ5CBbguCyw", "object": "chat.completion", "created": 1748840622, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query to get probabilities for 'SNIa' with ranking 1\nWITH snia_prob AS (\n    SELECT oid, probability AS SN_prob\n    FROM probability\n    WHERE class_name = 'SNIa' AND ranking = 1\n),\n-- Sub-query to get probabilities for 'CV/Nova' with ranking 2\ncvnova_prob AS (\n    SELECT oid, probability AS CV_prob\n    FROM probability\n    WHERE class_name = 'CV/Nova' AND ranking = 2\n)\n-- Main query to join the two sub-queries and apply the probability difference condition\nSELECT \n    snia_prob.oid, \n    snia_prob.SN_prob, \n    cvnova_prob.CV_prob\nFROM \n    snia_prob\nINNER JOIN \n    cvnova_prob ON snia_prob.oid = cvnova_prob.oid\nWHERE \n    ABS(snia_prob.SN_prob - cvnova_prob.CV_prob) < 0.1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2910, "completion_tokens": 204, "total_tokens": 3114, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c7f114819092a088214397cd9b", "custom_id": "10-1", "response": {"status_code": 200, "request_id": "1ecf63b38a96c5f29afd53c458088172", "body": {"id": "chatcmpl-BdrckOmMDDsOnRkq1964lrGgU1fs7", "object": "chat.completion", "created": 1748840622, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query to get probabilities for 'SNIa' with ranking=1\nWITH snia_prob AS (\n    SELECT oid, probability AS SN_prob\n    FROM probability\n    WHERE class_name = 'SNIa' AND ranking = 1\n),\n-- Sub-query to get probabilities for 'CV/Nova' with ranking=2\ncvnova_prob AS (\n    SELECT oid, probability AS CV_prob\n    FROM probability\n    WHERE class_name = 'CV/Nova' AND ranking = 2\n)\n-- Final query to join the two sub-queries and filter based on probability difference\nSELECT \n    snia_prob.oid, \n    snia_prob.SN_prob, \n    cvnova_prob.CV_prob\nFROM \n    snia_prob\nINNER JOIN \n    cvnova_prob ON snia_prob.oid = cvnova_prob.oid\nWHERE \n    ABS(snia_prob.SN_prob - cvnova_prob.CV_prob) < 0.1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2963, "completion_tokens": 204, "total_tokens": 3167, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c7fe448190b31cf0572288c889", "custom_id": "15-0", "response": {"status_code": 200, "request_id": "dc80243db71223c3cebea00c2fc3867b", "body": {"id": "chatcmpl-BdrcmEF9pjWI9Wl1oqvIU6Hf1Kkw6", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH highest_probability AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'stamp_classifier'\n      AND class_name = 'SN'\n),\nfirst_detection AS (\n    SELECT oid, firstmjd\n    FROM object\n    WHERE firstmjd BETWEEN 60188.0 AND 60189.0\n),\nlast_non_detection AS (\n    SELECT d.oid, d.mjd AS last_non_detection_mjd, d.fid\n    FROM detection d\n    INNER JOIN first_detection fd ON d.oid = fd.oid\n    WHERE d.mjd < fd.firstmjd\n      AND d.candid IS NOT NULL\n),\nfast_risers AS (\n    SELECT fd.oid, \n           (fd.firstmjd - lnd.last_non_detection_mjd) / (fd.firstmjd - lnd.last_non_detection_mjd) AS initial_rise_estimate\n    FROM first_detection fd\n    INNER JOIN last_non_detection lnd ON fd.oid = lnd.oid\n    WHERE (fd.firstmjd - lnd.last_non_detection_mjd) >= 0.25\n)\nSELECT o.oid, p.*, d.fid, d.candid, m.fid AS magstat_fid, fr.initial_rise_estimate\nFROM highest_probability hp\nINNER JOIN first_detection o ON hp.oid = o.oid\nINNER JOIN fast_risers fr ON o.oid = fr.oid\nINNER JOIN detection d ON o.oid = d.oid\nINNER JOIN magstat m ON o.oid = m.oid\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3171, "completion_tokens": 337, "total_tokens": 3508, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c80dd881909b5a31b97987b81d", "custom_id": "15-1", "response": {"status_code": 200, "request_id": "c382e1f4f1d8cdc29aefb259d4e3acb0", "body": {"id": "chatcmpl-BdrckQRVeUSExgQUmonzjkAXgLLLO", "object": "chat.completion", "created": 1748840622, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter probabilities for class 'SN' in the stamp classifier\nWITH prob_filtered AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN' \n      AND classifier_name = 'stamp_classifier' \n      AND ranking = 1\n),\n-- Subquery to filter objects based on first detection date\nobject_filtered AS (\n    SELECT o.oid, o.firstmjd\n    FROM object o\n    INNER JOIN prob_filtered p ON o.oid = p.oid\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n),\n-- Subquery to find the last non-detection before the first detection\nlast_non_detection AS (\n    SELECT d.oid, MAX(d.mjd) AS last_non_det_mjd\n    FROM detection d\n    INNER JOIN object_filtered of ON d.oid = of.oid\n    WHERE d.mjd < of.firstmjd\n    GROUP BY d.oid\n),\n-- Subquery to get the first detection and last non-detection magnitudes\nmagnitude_comparison AS (\n    SELECT of.oid, \n           d_first.magpsf AS first_mag, \n           d_last.magpsf AS last_non_det_mag\n    FROM object_filtered of\n    INNER JOIN detection d_first ON of.oid = d_first.oid AND d_first.mjd = of.firstmjd\n    INNER JOIN last_non_detection lnd ON of.oid = lnd.oid\n    INNER JOIN detection d_last ON lnd.oid = d_last.oid AND d_last.mjd = lnd.last_non_det_mjd\n)\n-- Final selection of required columns\nSELECT of.oid, \n       p.class_name, \n       d.candid, \n       d.fid, \n       m.first_mag - m.last_non_det_mag AS initial_rise_estimate, \n       ms.fid AS magstat_fid\nFROM magnitude_comparison m\nINNER JOIN detection d ON m.oid = d.oid\nINNER JOIN magstat ms ON m.oid = ms.oid\nINNER JOIN probability p ON m.oid = p.oid\nWHERE (m.first_mag - m.last_non_det_mag) >= 0.25\nORDER BY of.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3159, "completion_tokens": 466, "total_tokens": 3625, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c81acc8190a2b3a369a376b058", "custom_id": "4-0", "response": {"status_code": 200, "request_id": "635cf9ace1377a7c5f1d9f622c98d322", "body": {"id": "chatcmpl-BdrckLfukE4YG6rx2bKUvtTebpG7d", "object": "chat.completion", "created": 1748840622, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid, \n    detection.candid, \n    detection.magpsf, \n    detection.sigmapsf, \n    detection.magap, \n    detection.sigmagap, \n    magstat.dmdt_first, \n    magstat.fid\nFROM \n    object\nINNER JOIN \n    (SELECT oid \n     FROM probability \n     WHERE ranking = 1 \n     AND classifier_name = 'lc_classifier' \n     AND probability > 0.6 \n     AND oid IN (SELECT oid FROM object WHERE firstmjd >= 58483 AND lastmjd <= 58849) -- 2019-2022 range\n     AND oid IN (SELECT oid FROM magstat WHERE dmdt_first > 0.5) -- initial rise rate condition\n    ) AS prob ON object.oid = prob.oid\nINNER JOIN \n    detection ON object.oid = detection.oid\nINNER JOIN \n    magstat ON object.oid = magstat.oid\nWHERE \n    object.ndet > 50 \n    AND magstat.fid IN (1, 2) -- g and r-band\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3156, "completion_tokens": 237, "total_tokens": 3393, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c828108190bcc5a3657e28eba7", "custom_id": "4-1", "response": {"status_code": 200, "request_id": "c17dd16691eb14d1947fa801d73f6838", "body": {"id": "chatcmpl-BdrckuDqtmZK1sv5ShvbuTGowd8p4", "object": "chat.completion", "created": 1748840622, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.oid, d.candid, m.magpsf, m.sigmapsf, m.magap, m.sigmagap, m.dmdt_first, d.fid\nFROM probability p\nINNER JOIN object o ON p.oid = o.oid\nINNER JOIN magstats m ON o.oid = m.oid\nINNER JOIN dataquality d ON o.oid = d.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'SN II'\n  AND p.probability > 0.6\n  AND o.firstmjd >= 58500 AND o.lastmjd <= 59800  -- Corresponding to the year 2019-2022\n  AND m.dmdt_first > 0.5\n  AND m.ndet > 50\n  AND d.fid IN (1, 2)  -- g and r-band\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3036, "completion_tokens": 202, "total_tokens": 3238, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c834ac81909789ec1056178911", "custom_id": "25-0", "response": {"status_code": 200, "request_id": "f75c113616bdac5a639370957d16ab80", "body": {"id": "chatcmpl-BdrckF8LxWoFxmvVT63J5keARcDzE", "object": "chat.completion", "created": 1748840622, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH sources AS (\n    SELECT 'source_1' AS source_name, 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 'source_2', 174.21524897555543, 44.83789535222221\n)\nSELECT *\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability > 0.4\n  AND o.firstmjd BETWEEN 59976.0 AND 59982.0\n  AND (\n      q3c_radial_query(o.meanra, o.meandec, ra, dec, 10) \n      FROM sources\n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2972, "completion_tokens": 173, "total_tokens": 3145, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c843988190a09c4b0235f5b4db", "custom_id": "25-1", "response": {"status_code": 200, "request_id": "9d48dacc85c923bd8ce005c795576b32", "body": {"id": "chatcmpl-BdrcknrfKhBs0anc4GRgEpCCi4Z3s", "object": "chat.completion", "created": 1748840622, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH sources AS (\n    SELECT 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 174.21524897555543, 44.83789535222221\n)\nSELECT *\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.probability > 0.4\n  AND o.firstmjd BETWEEN 59976.0 AND 59982.0\n  AND EXISTS (\n      SELECT 1\n      FROM sources s\n      WHERE q3c_radial_query(o.meanra, o.meandec, s.ra, s.dec, 10.0) \n  );\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2941, "completion_tokens": 171, "total_tokens": 3112, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c868fc819085231b35cd1fff41", "custom_id": "7-0", "response": {"status_code": 200, "request_id": "bb66b63233c92f463326ae325bdedd0e", "body": {"id": "chatcmpl-Bdrclr7MZBRKtm2XO7qoMAEbUPUnW", "object": "chat.completion", "created": 1748840623, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT object.oid, probability.probability\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE probability.class_name = 'SN' \n  AND probability.ranking = 1 \n  AND probability.classifier_name = 'stamp_classifier'\n  AND object.firstmjd BETWEEN 59945.0 AND 59975.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2703, "completion_tokens": 77, "total_tokens": 2780, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c878ec8190a065b5759f9eddcd", "custom_id": "7-1", "response": {"status_code": 200, "request_id": "0a2f0f35b14595e5ca1ac8151d04688e", "body": {"id": "chatcmpl-Bdrcle06zfLJamMMtsv9USEgvKQhd", "object": "chat.completion", "created": 1748840623, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.oid, p.probability\nFROM probability p\nINNER JOIN object o ON p.oid = o.oid\nWHERE p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND o.firstmjd BETWEEN 59945.0 AND 59975.0; \n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2638, "completion_tokens": 79, "total_tokens": 2717, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c886c881909823c214b2c82ab1", "custom_id": "3-0", "response": {"status_code": 200, "request_id": "246f4811612c4051b25a561ccbdf61e7", "body": {"id": "chatcmpl-BdrclUWn5ROobiB5PqvuTxRFpvZ4D", "object": "chat.completion", "created": 1748840623, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'YSO' \n  AND p.ranking = 1 \n  AND p.probability > 0.7 \n  AND p.classifier_name = 'lc_classifier'\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2516, "completion_tokens": 84, "total_tokens": 2600, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c895bc8190bd4631e8f31369d2", "custom_id": "3-1", "response": {"status_code": 200, "request_id": "b111132ee20727a111255d0369cd3a0d", "body": {"id": "chatcmpl-Bdrcld8sVfDarkm9vf4TLeM08nmXO", "object": "chat.completion", "created": 1748840623, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nINNER JOIN probability ON object.oid = probability.oid \nWHERE probability.class_name = 'YSO' \n  AND probability.classifier_name = 'lc_classifier' \n  AND probability.probability > 0.7 \n  AND object.lastmjd BETWEEN 60096.0 AND 60125.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2582, "completion_tokens": 75, "total_tokens": 2657, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c8a3ec8190a852aeb354a831cf", "custom_id": "23-0", "response": {"status_code": 200, "request_id": "06f0d9f81f0547be710bb0537e473a8b", "body": {"id": "chatcmpl-Bdrcl4tVvfxBKlDlHFE8XDwvUcU7a", "object": "chat.completion", "created": 1748840623, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') \nAND p.probability > 0.2 \nAND p.classifier_name = 'lc_classifier';\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2622, "completion_tokens": 70, "total_tokens": 2692, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c8b27c819097387a488e08c160", "custom_id": "23-1", "response": {"status_code": 200, "request_id": "952662df5555b8a0546d4c2ddd5c62e3", "body": {"id": "chatcmpl-Bdrcl5bkH7qrQYTAUWGjPICQ27raJ", "object": "chat.completion", "created": 1748840623, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.2;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2640, "completion_tokens": 70, "total_tokens": 2710, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c8c20481909cd522657c9369a8", "custom_id": "20-0", "response": {"status_code": 200, "request_id": "4efd8894338fbcb59d18a1e6dd6b7094", "body": {"id": "chatcmpl-BdrclZ3ZH7SNetWdankatLDLVk4Eq", "object": "chat.completion", "created": 1748840623, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'RRL' \n  AND p.probability > 0.55 \n  AND o.ndet >= 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2676, "completion_tokens": 54, "total_tokens": 2730, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c8cf3c8190bcfca17a26f2cafd", "custom_id": "20-1", "response": {"status_code": 200, "request_id": "d8e8eb333a049312effb2b5e4fa75d0f", "body": {"id": "chatcmpl-BdrclmC7xFbJEHu8GekV8aDk7pm7S", "object": "chat.completion", "created": 1748840623, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'RRL' \n  AND p.classifier_name = 'lc_classifier' \n  AND p.probability > 0.55 \n  AND o.ndet >= 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2583, "completion_tokens": 67, "total_tokens": 2650, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c8df8c819088afd6c93068b4eb", "custom_id": "18-0", "response": {"status_code": 200, "request_id": "b6243a0b4173f53d92e598c950fe99e9", "body": {"id": "chatcmpl-BdrcmKB7g6Faz5n5R3lezzQmxE4H0", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve probabilities for sources classified as AGN, QSO, or Blazar\n-- with specific filters for detections and time span\n\n-- Sub-query for AGN\nWITH agn_probabilities AS (\n    SELECT \n        o.oid, \n        o.meanra, \n        o.meandec, \n        o.ndet, \n        o.firstmjd, \n        o.deltajd, \n        o.g_r_mean_corr, \n        p.classifier_name, \n        p.class_name, \n        p.ranking, \n        p.probability\n    FROM \n        probability p\n    INNER JOIN \n        object o ON p.oid = o.oid\n    WHERE \n        p.class_name = 'AGN' \n        AND p.ranking = 1 \n        AND p.classifier_name = 'lc_classifier'\n        AND o.ndet >= 40 \n        AND o.deltajd >= 200 \n        AND p.probability <= 0.95\n),\n\n-- Sub-query for QSO\nqso_probabilities AS (\n    SELECT \n        o.oid, \n        o.meanra, \n        o.meandec, \n        o.ndet, \n        o.firstmjd, \n        o.deltajd, \n        o.g_r_mean_corr, \n        p.classifier_name, \n        p.class_name, \n        p.ranking, \n        p.probability\n    FROM \n        probability p\n    INNER JOIN \n        object o ON p.oid = o.oid\n    WHERE \n        p.class_name = 'QSO' \n        AND p.ranking = 1 \n        AND p.classifier_name = 'lc_classifier'\n        AND o.ndet >= 40 \n        AND o.deltajd >= 200 \n        AND p.probability <= 0.95\n),\n\n-- Sub-query for Blazar\nblazar_probabilities AS (\n    SELECT \n        o.oid, \n        o.meanra, \n        o.meandec, \n        o.ndet, \n        o.firstmjd, \n        o.deltajd, \n        o.g_r_mean_corr, \n        p.classifier_name, \n        p.class_name, \n        p.ranking, \n        p.probability\n    FROM \n        probability p\n    INNER JOIN \n        object o ON p.oid = o.oid\n    WHERE \n        p.class_name = 'Blazar' \n        AND p.ranking = 1 \n        AND p.classifier_name = 'lc_classifier'\n        AND o.ndet >= 40 \n        AND o.deltajd >= 200 \n        AND p.probability <= 0.8\n)\n\n-- Final query combining results from all classes\nSELECT * FROM agn_probabilities\nUNION ALL\nSELECT * FROM qso_probabilities\nUNION ALL\nSELECT * FROM blazar_probabilities;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3183, "completion_tokens": 609, "total_tokens": 3792, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c8ed7c8190a4856483647c79b5", "custom_id": "18-1", "response": {"status_code": 200, "request_id": "d10d777dd21b2555f7ab316ed4eb7349", "body": {"id": "chatcmpl-BdrcmFAlOYtq8NoJrRAdCLTFZfufS", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve probabilities for sources classified as AGN, QSO, or Blazar\n-- with specific detection and probability criteria\n\n-- Sub-query for AGN\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'AGN' \n    AND p.probability > 0.95 \n    AND o.ndet >= 40 \n    AND o.deltajd >= 200\n\nUNION\n\n-- Sub-query for QSO\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'QSO' \n    AND p.probability > 0.95 \n    AND o.ndet >= 40 \n    AND o.deltajd >= 200\n\nUNION\n\n-- Sub-query for Blazar\nSELECT \n    o.oid, \n    o.meanra, \n    o.meandec, \n    o.ndet, \n    o.firstmjd, \n    o.deltajd, \n    o.g_r_mean_corr, \n    p.classifier_name, \n    p.class_name, \n    p.ranking, \n    p.probability\nFROM \n    object o\nJOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'Blazar' \n    AND p.probability > 0.8 \n    AND o.ndet >= 40 \n    AND o.deltajd >= 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3094, "completion_tokens": 474, "total_tokens": 3568, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c8fc5481908703fa9ffaa94999", "custom_id": "11-0", "response": {"status_code": 200, "request_id": "0f89b6bf62cd3ac9cf280d10d2e181fd", "body": {"id": "chatcmpl-BdrcmTQtoVQJRTqMkTaN93fjqGfbX", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    m.g_r_max, \n    m.magmax, \n    m.fid \nFROM \n    object o \nINNER JOIN \n    magstats m ON o.oid = m.oid \nWHERE \n    o.firstmjd BETWEEN 60188.0 AND 60217.0 -- First detection in September\n    AND m.magmax > 19 -- Peak magnitude above 19\n    AND o.g_r_max < 1; -- g-r color at maximum below 1\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2656, "completion_tokens": 112, "total_tokens": 2768, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c90bd48190937159a3c236b3d3", "custom_id": "11-1", "response": {"status_code": 200, "request_id": "126ba2317d5efdce10ac70dcbc5a0104", "body": {"id": "chatcmpl-BdrcmtfwG2RmLMJu8A8GG13DwSPgA", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT o.oid, o.g_r_max, m.magmax, m.fid\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN magstats m ON o.oid = m.oid\nWHERE p.class_name = 'SNIa' \n  AND p.ranking = 1 \n  AND p.classifier_name = 'lc_classifier'\n  AND o.firstmjd BETWEEN 60188.0 AND 60217.0\n  AND m.magmax > 19\n  AND o.g_r_max < 1;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2680, "completion_tokens": 122, "total_tokens": 2802, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c91bec8190b34221eb432beac5", "custom_id": "9-0", "response": {"status_code": 200, "request_id": "34e75ee5f705ba35a46df2edb318455c", "body": {"id": "chatcmpl-BdrcmEoSVQgqFkCELTq6sTW04efxb", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_objects AS (\n    SELECT oid, meanra, meandec\n    FROM object\n    WHERE firstmjd BETWEEN 60126.0 AND 60156.0\n    AND q3c_radial_query(meanra, meandec, 39.97, -1.5768, 16.16667)\n),\nsgscore1_filter AS (\n    SELECT f.oid, f.value, f.name, f.version\n    FROM feature f\n    INNER JOIN filtered_objects o ON f.oid = o.oid\n    WHERE f.name = 'sgscore1' AND f.value < 0.3\n),\nprobability_filter AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.ranking = 1 AND p.classifier_name = 'stamp_classifier'\n    AND p.class_name NOT IN ('Asteroid', 'Bogus')\n)\nSELECT o.oid, s.value, s.name, s.version, o.meanra, o.meandec, \n       q3c_dist(o.meanra, o.meandec, 39.97, -1.5768) AS dist\nFROM filtered_objects o\nINNER JOIN sgscore1_filter s ON o.oid = s.oid\nINNER JOIN probability_filter p ON o.oid = p.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3326, "completion_tokens": 273, "total_tokens": 3599, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c92a888190aff4eddceede9b9a", "custom_id": "9-1", "response": {"status_code": 200, "request_id": "fad998a579505cc2969fe74334c6e3a3", "body": {"id": "chatcmpl-BdrcmCEKZupP2wLh5xebWHYpKHhWo", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH filtered_probabilities AS (\n    SELECT oid, class_name\n    FROM probability\n    WHERE ranking = 1 \n      AND classifier_name = 'stamp_classifier'\n      AND class_name NOT IN ('Asteroid', 'Bogus')\n),\nfiltered_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    INNER JOIN filtered_probabilities p ON o.oid = p.oid\n    WHERE o.firstmjd BETWEEN 60126.0 AND 60156.0\n      AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667) \n      AND o.ndet > 0\n),\nfiltered_features AS (\n    SELECT f.oid, f.value, f.name, f.version\n    FROM feature f\n    INNER JOIN filtered_objects o ON f.oid = o.oid\n    WHERE f.name = 'sgscore1' AND f.value < 0.3\n)\nSELECT o.oid, f.value, f.name, f.version, o.meanra, o.meandec, q3c_dist(o.meanra, o.meandec, 39.97, -1.5768) AS dist\nFROM filtered_objects o\nINNER JOIN filtered_features f ON o.oid = f.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3165, "completion_tokens": 284, "total_tokens": 3449, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c93aa881909b0435628f1a0178", "custom_id": "5-0", "response": {"status_code": 200, "request_id": "46308280b00eb426baa9414de7da9500", "body": {"id": "chatcmpl-BdrcmYONIB1uw7R38zOEikDj44xZt", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter objects classified as 'SN II' with probability greater than 0.6\nWITH classified_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND probability > 0.6\n)\n\n-- Subquery to filter detections with the required conditions\n, detection_conditions AS (\n    SELECT d.oid, d.candid, d.magpsf, d.sigmapsf, d.fid\n    FROM detection d\n    INNER JOIN classified_objects co ON d.oid = co.oid\n)\n\n-- Subquery to calculate the difference between min and max magnitudes in g-band\n, g_band_magnitude_diff AS (\n    SELECT oid, MAX(magpsf) - MIN(magpsf) AS delta_mag_fid\n    FROM detection\n    WHERE fid = 1\n    GROUP BY oid\n    HAVING MAX(magpsf) - MIN(magpsf) > 2\n)\n\n-- Final query to retrieve the required information\nSELECT o.oid, dc.candid, f.name AS feature_name, f.value AS feature_value, dc.magpsf, dc.sigmapsf, dc.fid AS feature_fid\nFROM object o\nINNER JOIN classified_objects co ON o.oid = co.oid\nINNER JOIN detection_conditions dc ON o.oid = dc.oid\nINNER JOIN g_band_magnitude_diff gbd ON o.oid = gbd.oid\nINNER JOIN feature f ON o.oid = f.oid\nWHERE o.ndet > 50\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3172, "completion_tokens": 337, "total_tokens": 3509, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c94a908190b1ef5106406504fe", "custom_id": "5-1", "response": {"status_code": 200, "request_id": "921d8dbe03e747fcd48587939e0f50b4", "body": {"id": "chatcmpl-Bdrcm3D0TzW3FIZzW6zgr7vNKLJzq", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Step 1: Filter the probability table for objects classified as 'SNII' with probability > 0.6 and ranking = 1\nWITH filtered_probabilities AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier' AND ranking = 1 AND probability > 0.6\n),\n\n-- Step 2: Filter the object table for the conditions on number of detections and delta magnitude\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN filtered_probabilities p ON o.oid = p.oid\n    WHERE o.ndet > 50\n),\n\n-- Step 3: Get the delta magnitude for the g-band from the feature table\ndelta_mag AS (\n    SELECT f.oid, MAX(f.value) - MIN(f.value) AS delta_mag_fid\n    FROM feature f\n    INNER JOIN filtered_objects o ON f.oid = o.oid\n    WHERE f.name = 'mag' AND f.fid = 1 -- Assuming fid = 1 corresponds to g-band\n    GROUP BY f.oid\n    HAVING (MAX(f.value) - MIN(f.value)) > 2\n)\n\n-- Step 4: Join the results to get the required information\nSELECT \n    o.oid,\n    d.candid,\n    f.name,\n    f.value,\n    det.magpsf,\n    det.sigmapsf,\n    f.fid AS feature_fid\nFROM filtered_objects o\nINNER JOIN detection det ON o.oid = det.oid\nINNER JOIN feature f ON o.oid = f.oid\nINNER JOIN delta_mag dm ON o.oid = dm.oid\nORDER BY o.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3068, "completion_tokens": 353, "total_tokens": 3421, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c957b48190a15fb595fc73bca0", "custom_id": "0-0", "response": {"status_code": 200, "request_id": "9ebd9190e57e3d94fdae7f6354b8dba6", "body": {"id": "chatcmpl-BdrcmQMJi0nyxjQ1zebJNm1mdnQQj", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query to filter for YSOs with probability greater than 0.7\nWITH yso_probabilities AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND class_name = 'YSO'\n      AND probability > 0.7\n),\n-- Sub-query for photometric period feature\nperiod_feature AS (\n    SELECT f.oid, f.value, f.name, f.fid, f.version\n    FROM feature f\n    INNER JOIN yso_probabilities y ON f.oid = y.oid\n    WHERE f.name = 'Period_band' AND f.value BETWEEN 3 AND 10\n),\n-- Sub-query for variation amplitude feature\namplitude_feature AS (\n    SELECT f.oid, f.value, f.name, f.fid, f.version\n    FROM feature f\n    INNER JOIN yso_probabilities y ON f.oid = y.oid\n    WHERE f.name = 'Amplitude' AND f.value > 0.5\n),\n-- Combine the results to find common oids that meet both feature conditions\ncombined_features AS (\n    SELECT p.oid, p.value, p.name, p.fid, p.version\n    FROM period_feature p\n    INTERSECT\n    SELECT a.oid, a.value, a.name, a.fid, a.version\n    FROM amplitude_feature a\n)\n-- Final selection of results with probabilities\nSELECT y.oid, y.probability, c.value, c.name, c.fid, c.version\nFROM combined_features c\nINNER JOIN yso_probabilities y ON c.oid = y.oid\nORDER BY y.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3120, "completion_tokens": 355, "total_tokens": 3475, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c965d48190875af178c1192418", "custom_id": "0-1", "response": {"status_code": 200, "request_id": "1a5c690bd7338bcd5b8acd3e3923f780", "body": {"id": "chatcmpl-BdrcmQV5h1sS2YD2sFDwBdHoeaOyt", "object": "chat.completion", "created": 1748840624, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query to filter for YSOs with probability greater than 0.7\nWITH prob AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'YSO' AND probability > 0.7 AND ranking = 1\n),\n-- Sub-query for Period_band feature\nperiod AS (\n    SELECT f.oid, f.value, f.name, f.fid, f.version\n    FROM feature f\n    INNER JOIN prob p ON f.oid = p.oid\n    WHERE f.name = 'Period_band' AND f.value BETWEEN 3 AND 10\n),\n-- Sub-query for Amplitude feature\namplitude AS (\n    SELECT f.oid, f.value, f.name, f.fid, f.version\n    FROM feature f\n    INNER JOIN prob p ON f.oid = p.oid\n    WHERE f.name = 'Amplitude' AND f.value > 0.5\n),\n-- Intersect to find common oids in both features\nvalid_oids AS (\n    SELECT p.oid\n    FROM period p\n    INTERSECT\n    SELECT a.oid\n    FROM amplitude a\n)\n\n-- Final selection of required columns\nSELECT p.oid, p.probability, f.value, f.name, f.fid, f.version\nFROM prob p\nINNER JOIN valid_oids v ON p.oid = v.oid\nINNER JOIN feature f ON v.oid = f.oid\nWHERE f.name IN ('Period_band', 'Amplitude')\nORDER BY p.probability DESC;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3128, "completion_tokens": 322, "total_tokens": 3450, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c974fc8190a086c245fdc041f7", "custom_id": "38-0", "response": {"status_code": 200, "request_id": "dbc1a6aa5c35bf71dea268150c710753", "body": {"id": "chatcmpl-BdrcnhkDQ0nji0HmYBlAzV7x8mh6U", "object": "chat.completion", "created": 1748840625, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select top 1000 AGN candidates with probability > 0.6\nWITH agn_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN' \n      AND p.probability > 0.6 \n      AND p.ranking = 1 \n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n-- Subquery to select top 1000 QSO candidates with probability > 0.5\nqso_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.class_name = 'QSO' \n      AND p.probability > 0.5 \n      AND p.ranking = 1 \n      AND p.classifier_name = 'lc_classifier'\n    ORDER BY p.probability DESC\n    LIMIT 1000\n)\n-- Combine results from both AGN and QSO candidates\nSELECT o.*\nFROM object o\nINNER JOIN agn_candidates a ON o.oid = a.oid\nWHERE o.ndet BETWEEN 30 AND 200\n\nUNION\n\nSELECT o.*\nFROM object o\nINNER JOIN qso_candidates q ON o.oid = q.oid\nWHERE o.ndet BETWEEN 30 AND 200\nORDER BY probability DESC; -- Order the final results by probability in descending order\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3017, "completion_tokens": 291, "total_tokens": 3308, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c98438819096df2a3ae4af0ade", "custom_id": "38-1", "response": {"status_code": 200, "request_id": "ab0dc6757fdc3bfafa38fc60d6c45c96", "body": {"id": "chatcmpl-BdrcnPrW9XH2sCE9GDVJuKEZsJ73Z", "object": "chat.completion", "created": 1748840625, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select AGN candidates with probability > 0.6\nWITH agn_candidates AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'AGN'\n      AND p.probability > 0.6\n      AND p.ranking = 1\n      AND o.ndet BETWEEN 30 AND 200\n    ORDER BY p.probability DESC\n    LIMIT 1000\n),\n\n-- Subquery to select QSO candidates with probability > 0.5\nqso_candidates AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.class_name = 'QSO'\n      AND p.probability > 0.5\n      AND p.ranking = 1\n      AND o.ndet BETWEEN 30 AND 200\n    ORDER BY p.probability DESC\n    LIMIT 1000\n)\n\n-- Combine results from both AGN and QSO candidates\nSELECT * FROM agn_candidates\nUNION\nSELECT * FROM qso_candidates;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2953, "completion_tokens": 253, "total_tokens": 3206, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c991d081909504522fb6ac2d5d", "custom_id": "24-0", "response": {"status_code": 200, "request_id": "de156b786282a605b77f87e7d0dcc634", "body": {"id": "chatcmpl-Bdrcn6zA6ER5tcBxCh8a8BDPdGGqz", "object": "chat.completion", "created": 1748840625, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH sources AS (\n    SELECT 'source_1' AS source_name, 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 'source_2', 174.21524897555543\n)\nSELECT *\nFROM object\nWHERE q3c_radial_query(meanra, meandec, \n                        (SELECT ra FROM sources WHERE source_name = 'source_1'), \n                        (SELECT dec FROM sources WHERE source_name = 'source_1'), 10)\n   OR q3c_radial_query(meanra, meandec, \n                        (SELECT ra FROM sources WHERE source_name = 'source_2'), \n                        (SELECT dec FROM sources WHERE source_name = 'source_2'), 10)\nAND firstmjd BETWEEN 59976.0 AND 59982.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2678, "completion_tokens": 183, "total_tokens": 2861, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c99f0c81908732f527c1668411", "custom_id": "24-1", "response": {"status_code": 200, "request_id": "272c1abe2449c2668878975b34a0e1db", "body": {"id": "chatcmpl-BdrcoG3sIUA2POcfccOgIBXGmuC0q", "object": "chat.completion", "created": 1748840626, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH sources AS (\n    SELECT 'source_1' AS source_name, 160.18301441363647 AS ra, 33.0164673528409 AS dec\n    UNION ALL\n    SELECT 'source_2', 174.21524897555543, 44.83789535222221\n)\nSELECT *\nFROM object\nWHERE firstmjd >= 59976.0 AND firstmjd <= 59982.0\nAND (\n    q3c_radial_query(meanra, meandec, ra, dec, 10) \n    FROM sources\n);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2682, "completion_tokens": 126, "total_tokens": 2808, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c9ac748190a5936c03c4567d5d", "custom_id": "31-0", "response": {"status_code": 200, "request_id": "7c8b6234856327055ac1633cb2be95d3", "body": {"id": "chatcmpl-BdrcnbxLCwpgiLaF4HUXI1SgomHye", "object": "chat.completion", "created": 1748840625, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve galactic coordinates, feature columns, class name, and identifiers of objects\n-- classified by the light curve classifier that were first detected between February 1 and 2 of 2023\n\nWITH classified_objects AS (\n    SELECT o.oid, o.meanra, o.meandec\n    FROM object o\n    INNER JOIN (\n        SELECT oid\n        FROM probability\n        WHERE ranking = 1\n        AND classifier_name = 'lc_classifier'\n    ) p ON o.oid = p.oid\n    WHERE o.firstmjd BETWEEN 59976.0 AND 59977.0\n),\nfeatures AS (\n    -- Example feature subquery, replace 'feature_name' with actual feature names as needed\n    SELECT f.oid, f.name, f.value\n    FROM feature f\n    INNER JOIN classified_objects co ON f.oid = co.oid\n)\n\nSELECT co.meanra, co.meandec, co.oid, f.name, f.value\nFROM classified_objects co\nLEFT JOIN features f ON co.oid = f.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3104, "completion_tokens": 224, "total_tokens": 3328, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c9bb30819097e15241c97e2c57", "custom_id": "31-1", "response": {"status_code": 200, "request_id": "ecaf1f9580dddd2ad53485ab6a947ac4", "body": {"id": "chatcmpl-Bdrcnqz3roOvwQXqqgVWn9jwaMKCQ", "object": "chat.completion", "created": 1748840625, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve galactic coordinates, feature columns, class name, and identifiers of objects\n-- classified by the light curve classifier first detected between February 1 and 2, 2023\nSELECT \n    o.meanra AS gal_l, \n    o.meandec AS gal_b, \n    f.*, \n    p.class_name, \n    o.oid\nFROM \n    object o\nINNER JOIN \n    (SELECT oid \n     FROM probability \n     WHERE ranking = 1 \n     AND classifier_name = 'lc_classifier') p ON o.oid = p.oid\nINNER JOIN \n    feature f ON o.oid = f.oid\nWHERE \n    o.firstmjd BETWEEN 59976.0 AND 59977.0;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3074, "completion_tokens": 159, "total_tokens": 3233, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c9cf748190bcaabdc1748a4b36", "custom_id": "6-0", "response": {"status_code": 200, "request_id": "5fff1359db3d5aaacef5804a9fd0b373", "body": {"id": "chatcmpl-Bdrcn2gUmHMsdCpmTs2ednE1X1ljo", "object": "chat.completion", "created": 1748840625, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter objects classified as 'SN II' with probability greater than 0.6\nWITH classified_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.ranking = 1\n      AND p.classifier_name = 'lc_classifier'\n      AND p.class_name = 'SN II'\n      AND p.probability > 0.6\n),\n-- Subquery to filter detections for the classified objects\ndetection_data AS (\n    SELECT d.oid, d.candid, d.magpsf, d.sigmapsf, d.fid, \n           (MAX(d.magpsf) - MIN(d.magpsf)) / (MAX(d.firstmjd) - MIN(d.firstmjd)) AS initial_rise_rate\n    FROM detection d\n    INNER JOIN classified_objects co ON d.oid = co.oid\n    WHERE d.fid IN (1, 2) -- g-band and r-band\n    GROUP BY d.oid, d.candid\n    HAVING COUNT(CASE WHEN d.fid = 2 THEN 1 END) >= 100 -- At least 100 days of observations in r-band\n       AND COUNT(d.candid) > 30 -- More than 30 detections\n       AND initial_rise_rate > 0.5 -- Initial rise rate greater than 0.5 mag/day\n)\n-- Final selection of required columns\nSELECT d.oid, d.candid, d.magpsf, d.sigmapsf, d.fid AS f_id\nFROM detection_data d\nINNER JOIN object o ON d.oid = o.oid\nWHERE o.firstmjd >= 58484.0 -- Start of 2019\n  AND o.lastmjd <= 59944.0; -- End of 2022\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3210, "completion_tokens": 377, "total_tokens": 3587, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c9ddd48190a62f20d2f66f5137", "custom_id": "6-1", "response": {"status_code": 200, "request_id": "775af104695d2ca7bd9826bed5c8a8e2", "body": {"id": "chatcmpl-BdrcoAqfinDcxNWRg4QzZf2Nn8B5W", "object": "chat.completion", "created": 1748840626, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter probabilities for SN II classification with probability > 0.6\nWITH filtered_probabilities AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND class_name = 'SN II'\n      AND probability > 0.6\n),\n-- Subquery to filter objects based on the conditions specified\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN filtered_probabilities p ON o.oid = p.oid\n    WHERE o.ncovhist >= 100  -- At least 100 days of observations in r-band\n      AND o.ndet > 30         -- More than 30 detections\n),\n-- Subquery to filter detections for the specified time range and conditions\nfiltered_detections AS (\n    SELECT d.candid, d.magpsf, d.sigmapsf, d.magap, d.sigmagap, d.fid,\n           (d.magpsf - lag(d.magpsf) OVER (PARTITION BY d.oid ORDER BY d.mjd)) / \n           (d.mjd - lag(d.mjd) OVER (PARTITION BY d.oid ORDER BY d.mjd) ) AS rise_rate\n    FROM detection d\n    INNER JOIN filtered_objects o ON d.oid = o.oid\n    WHERE d.mjd >= 58484.0  -- Start of 2019\n      AND d.mjd <= 59944.0  -- End of 2022\n      AND d.fid IN (1, 2)   -- g-band and r-band\n)\n-- Final selection of required columns\nSELECT o.oid, d.candid, d.magpsf, d.sigmapsf, d.magap, d.sigmagap, d.fid AS f_id\nFROM filtered_detections d\nINNER JOIN filtered_objects o ON d.oid = o.oid\nWHERE d.rise_rate > 0.5;  -- Initial rise rate greater than 0.5 mag/day\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3193, "completion_tokens": 430, "total_tokens": 3623, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c9ec6c8190b9e0e891186291bf", "custom_id": "21-0", "response": {"status_code": 200, "request_id": "b12c17c2b64f0da8a49e547a4c375f96", "body": {"id": "chatcmpl-BdrcqTiFgcbdQrVlY0S1bwws2fNr1", "object": "chat.completion", "created": 1748840628, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.ndet >= 30\n  AND (o.lastmjd - o.firstmjd) >= 200\n  AND p.probability > 0.5\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar');\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2730, "completion_tokens": 97, "total_tokens": 2827, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30c9faf88190bfeffd7f0980ea4d", "custom_id": "21-1", "response": {"status_code": 200, "request_id": "2867882d61837d0c2e1ffbc4094de666", "body": {"id": "chatcmpl-BdrcpT2KSfEvlZXea1n1MbsUNbqZR", "object": "chat.completion", "created": 1748840627, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.class_name IN ('AGN', 'QSO', 'Blazar') \n  AND p.ranking = 1 \n  AND p.classifier_name = 'lc_classifier' \n  AND p.probability > 0.5 \n  AND o.ndet >= 30 \n  AND (o.lastmjd - o.firstmjd) >= 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2668, "completion_tokens": 100, "total_tokens": 2768, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30ca0ba4819086942fa7561ad006", "custom_id": "26-0", "response": {"status_code": 200, "request_id": "5b6ce80fa845da6133787098b23a7ff5", "body": {"id": "chatcmpl-BdrcoLGbQ501clgwlw20TxeTe8r9x", "object": "chat.completion", "created": 1748840626, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM object \nINNER JOIN probability ON object.oid = probability.oid \nLEFT JOIN detection ON object.oid = detection.oid \nWHERE object.firstmjd >= 59816.0 \n  AND object.lastmjd <= 59832.0 \n  AND probability.classifier_name = 'stamp_classifier' \n  AND (probability.probability > 0.5 OR COUNT(detection.oid) > 1) \nGROUP BY object.oid, probability.oid;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2769, "completion_tokens": 106, "total_tokens": 2875, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30ca195881909c631e18336a3188", "custom_id": "26-1", "response": {"status_code": 200, "request_id": "504ad543421e2672ce825d9d617cc534", "body": {"id": "chatcmpl-BdrcoEponhPxQa3xaxSs3H86mbmfF", "object": "chat.completion", "created": 1748840626, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM object\nLEFT JOIN probability ON object.oid = probability.oid AND probability.ranking = 1 AND probability.classifier_name = 'stamp_classifier'\nLEFT JOIN detection ON object.oid = detection.oid\nWHERE object.firstmjd >= 59816.0 AND object.lastmjd <= 59832.0\nAND (probability.class_name = 'SN' AND probability.probability > 0.5 OR object.ndet > 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2842, "completion_tokens": 100, "total_tokens": 2942, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30ca287c8190bb41212429d0c144", "custom_id": "109-0", "response": {"status_code": 200, "request_id": "c4eb31b6222e7742cbb055c6210ea5c7", "body": {"id": "chatcmpl-BdrcozTxvkAfD6RvxugSEMYg3Z5zg", "object": "chat.completion", "created": 1748840626, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.classifier_version, \n    p.class_name, \n    p.probability, \n    f.value, \n    f.fid\nFROM \n    object o\nINNER JOIN \n    feature f ON o.oid = f.oid AND f.feature_name = 'LinearTrend' AND f.value > 5\nINNER JOIN \n    probability p ON o.oid = p.oid \nWHERE \n    o.deltajd > 1 AND \n    p.ranking = 1\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2716, "completion_tokens": 124, "total_tokens": 2840, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30ca378481908db9a9d061477fa6", "custom_id": "109-1", "response": {"status_code": 200, "request_id": "65b62abbd80b386444138358076e44d2", "body": {"id": "chatcmpl-BdrcoFjrS9X0Xc33LiRimvKx8Yn1Z", "object": "chat.completion", "created": 1748840626, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    p.classifier_version, \n    p.class_name, \n    p.probability, \n    f.value, \n    f.fid\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid AND p.ranking = 1 AND p.classifier_name = 'lc_classifier'\nINNER JOIN \n    feature f ON o.oid = f.oid AND f.feature_name = 'LinearTrend' AND f.value > 5\nWHERE \n    o.deltajd > 1\nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2726, "completion_tokens": 131, "total_tokens": 2857, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30ca464881909d4030644a9f6af8", "custom_id": "93-0", "response": {"status_code": 200, "request_id": "ddda25fc2cb2e9e4ad6a4bb819b9daad", "body": {"id": "chatcmpl-Bdrcp50fLzIRRY5BfTojwN5J20Rj1", "object": "chat.completion", "created": 1748840627, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM probability \nINNER JOIN magstat ON probability.oid = magstat.oid \nWHERE probability.ranking = 1 \n  AND probability.classifier_name = 'stamp_classifier' \n  AND probability.class_name = 'asteroid' \n  AND magstat.corrected = TRUE \nORDER BY probability.oid \nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2638, "completion_tokens": 74, "total_tokens": 2712, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30ca55848190a141c6dcb26cee6e", "custom_id": "93-1", "response": {"status_code": 200, "request_id": "a0bdcb7813cdcc8058e118f6b545605e", "body": {"id": "chatcmpl-BdrcpeQSqp1zvDjXjNGzP1P92fq5z", "object": "chat.completion", "created": 1748840627, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT * \nFROM probability \nINNER JOIN magstat ON probability.oid = magstat.oid \nWHERE probability.ranking = 1 \n  AND probability.classifier_name = 'stamp_classifier' \n  AND probability.class_name = 'asteroid' \n  AND magstat.corrected = TRUE \nORDER BY probability.oid \nLIMIT 10;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2650, "completion_tokens": 74, "total_tokens": 2724, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30ca65208190a0ea5841d0ed23dd", "custom_id": "95-0", "response": {"status_code": 200, "request_id": "9ea60f7613a63f8544ebc1a3613af6ae", "body": {"id": "chatcmpl-BdrcqYlljjE1ccUnD8KPSYgMPtf7U", "object": "chat.completion", "created": 1748840628, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to retrieve matches from the 'xmatch' table for specified ZTF identifiers\nWITH xmatch_results AS (\n    SELECT oid, oid_catalog, dist\n    FROM xmatch\n    WHERE oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n),\n\n-- Subquery to retrieve features from the 'feature' table for specified features and version\nfeature_results AS (\n    SELECT oid, name, value\n    FROM feature\n    WHERE name IN ('W1-W2', 'g-W2', 'r-W2') \n      AND version = 'lc_classifier_1.2.1-P'\n)\n\n-- Final query to join the results from 'xmatch' and 'feature' subqueries\nSELECT \n    x.oid AS ztf_identifier, \n    x.oid_catalog AS catalog_identifier, \n    x.dist AS distance, \n    f.name AS feature_name, \n    f.value AS feature_value\nFROM xmatch_results x\nINNER JOIN feature_results f ON x.oid = f.oid\nORDER BY x.oid_catalog, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2937, "completion_tokens": 229, "total_tokens": 3166, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30ca759c8190995c57491f72f21c", "custom_id": "95-1", "response": {"status_code": 200, "request_id": "d30ca5de0fb3b75bd2151d9765489870", "body": {"id": "chatcmpl-BdrcpvHj2OmXP6v4KxeVrUDnV5eu9", "object": "chat.completion", "created": 1748840627, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to select matches from the xmatch table for the specified ZTF identifiers\nWITH xmatch_results AS (\n    SELECT oid, oid_catalog, dist\n    FROM xmatch\n    WHERE oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n),\n\n-- Subquery to select features from the feature table for the specified features and version\nfeature_results AS (\n    SELECT oid, name, value\n    FROM feature\n    WHERE name IN ('W1-W2', 'g-W2', 'r-W2') AND version = 'lc_classifier_1.2.1-P'\n)\n\n-- Final query to join the results from xmatch and feature tables\nSELECT \n    x.oid AS identifier_in_ZTF, \n    x.oid_catalog AS identifier_in_catalog, \n    x.dist AS distance_between_counterparts, \n    f.name AS feature_name, \n    f.value AS feature_value\nFROM xmatch_results x\nINNER JOIN feature_results f ON x.oid = f.oid\nORDER BY x.oid_catalog, f.name;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3004, "completion_tokens": 225, "total_tokens": 3229, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30ca8720819086a4bd47ed9cf275", "custom_id": "85-0", "response": {"status_code": 200, "request_id": "6bd9667a11a0ed9ee8fe0737d87942d0", "body": {"id": "chatcmpl-BdrcpQ4h9gu0yMvhZo98LxyF7sESZ", "object": "chat.completion", "created": 1748840627, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT d.mjd, d.isdiffpos, d.magpsf, d.sigmapsf, dq.*\nFROM detection d\nINNER JOIN dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2914, "completion_tokens": 72, "total_tokens": 2986, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30caa10c8190a24bdac770c970cb", "custom_id": "85-1", "response": {"status_code": 200, "request_id": "a58fd874d7ed5c98456ebf54e1ef100e", "body": {"id": "chatcmpl-BdrcsZFJM6ClDNrTJZLdIjHxsocd5", "object": "chat.completion", "created": 1748840630, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    d.mjd, \n    d.isdiffpos, \n    d.magpsf, \n    d.sigmapsf, \n    dq.*  -- Select all columns from the dataquality table\nFROM \n    detection d\nINNER JOIN \n    dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid\nWHERE \n    d.oid = 'ZTF20actqnhg'  -- Filter for the specific ZTF object\nORDER BY \n    d.mjd;  -- Sort by detection date\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2897, "completion_tokens": 118, "total_tokens": 3015, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cab03c819080aaf994cb825225", "custom_id": "98-0", "response": {"status_code": 200, "request_id": "b8d1ebe88efc07740bcc95361f7d52ce", "body": {"id": "chatcmpl-BdrcpD4ybdWc79yKV6oosera8vnxK", "object": "chat.completion", "created": 1748840627, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter objects based on probability and classification\nWITH filtered_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND class_name = 'QSO'\n      AND probability > 0.7\n)\n\n-- Main query to retrieve all columns from xmatch and allwise for the filtered objects\nSELECT DISTINCT xmatch.*, allwise.*\nFROM filtered_objects\nINNER JOIN object ON filtered_objects.oid = object.oid\nINNER JOIN xmatch ON object.oid = xmatch.oid\nINNER JOIN allwise ON object.oid = allwise.oid\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2938, "completion_tokens": 139, "total_tokens": 3077, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cabfa88190a1486fd2f789803a", "custom_id": "98-1", "response": {"status_code": 200, "request_id": "7af50cdd36bde672363a3ea9e824af88", "body": {"id": "chatcmpl-Bdrcp7hA5rutatOlt80Not1pNZyeF", "object": "chat.completion", "created": 1748840627, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter objects with probability greater than 0.7 for QSO classification\nWITH filtered_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND class_name = 'QSO'\n      AND probability > 0.7\n)\n\n-- Main query to retrieve all columns from xmatch and allwise for the filtered objects\nSELECT DISTINCT xmatch.*, allwise.*\nFROM filtered_objects\nINNER JOIN object ON filtered_objects.oid = object.oid\nINNER JOIN xmatch ON object.oid = xmatch.oid\nINNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog\nLIMIT 200;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2936, "completion_tokens": 149, "total_tokens": 3085, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cacea88190b1c79a670cd91f74", "custom_id": "87-0", "response": {"status_code": 200, "request_id": "eec8d852f13032cc8bf45cbf9ab2e4a9", "body": {"id": "chatcmpl-BdrcqO2dFoC0sixFPlL7d1Xv0yBfM", "object": "chat.completion", "created": 1748840628, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter probabilities for LPV and E classifications\nWITH filtered_probabilities AS (\n    SELECT oid\n    FROM probability\n    WHERE probability > 0.7\n      AND (class_name = 'LPV' OR class_name = 'E')\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n)\n\n-- Final query to join filtered probabilities with gaia_ztf\nSELECT p.*, g.*\nFROM filtered_probabilities fp\nINNER JOIN gaia_ztf g ON fp.oid = g.oid\nWHERE g.unique1 = FALSE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2866, "completion_tokens": 127, "total_tokens": 2993, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cadd4c8190a3d549bfc3e464f7", "custom_id": "87-1", "response": {"status_code": 200, "request_id": "7e6af0b996c9cc14a3e69d089db93785", "body": {"id": "chatcmpl-BdrcqvONHGkKwfKkDUJ7Zx6CDafra", "object": "chat.completion", "created": 1748840628, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter the probability table for the specified conditions\nWITH filtered_probability AS (\n    SELECT oid\n    FROM probability\n    WHERE probability > 0.7\n      AND (class_name = 'LPV' OR class_name = 'E')\n      AND classifier_name = 'hierarchical_rf_1.1.0'\n)\n\n-- Main query to join the filtered probability with the gaia_ztf table\nSELECT *\nFROM filtered_probability fp\nINNER JOIN gaia_ztf g ON fp.oid = g.oid\nWHERE g.unique1 = FALSE\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2965, "completion_tokens": 125, "total_tokens": 3090, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30caec5c8190af1665d0187145aa", "custom_id": "108-0", "response": {"status_code": 200, "request_id": "9ba32cd18e848ae6adfc02da19473377", "body": {"id": "chatcmpl-BdrcrN7VzLk6dkZuDq2MzAFQ2jO1V", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid,  -- ZTF identifier\n    object.ndet,  -- number of detections\n    probability.probability,  -- probability\n    (asin(sin(object.meandec * pi()/180) * cos(27.12825 * pi()/180) + cos(object.meandec * pi()/180) * sin(27.12825 * pi()/180) * cos(object.meanra * pi()/180 - 3.14159)) * 180/pi()) AS gal_b  -- Galactic latitude calculation\nFROM \n    object \nINNER JOIN \n    probability ON object.oid = probability.oid  -- join on object identifier\nWHERE \n    object.ndet > 20  -- more than 20 detections\n    AND probability.probability > 0.9  -- probability larger than 0.9\n    AND probability.class_name = 'bogus'  -- class is 'bogus'\n    AND probability.classifier_name = 'stamp_classifier'  -- correct classifier\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'  -- specific version\nORDER BY \n    object.oid  -- order by object identifier\nLIMIT 15;  -- limit to at most 15 results\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2750, "completion_tokens": 266, "total_tokens": 3016, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cafbd881908d833f627a3a7cd8", "custom_id": "108-1", "response": {"status_code": 200, "request_id": "100973ed782fca1fe1237cdcafd46bd7", "body": {"id": "chatcmpl-Bdrcrwm7lW7m7zucM7HVG0iA0VjjO", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    object.oid,  -- ZTF identifier\n    object.ndet,  -- number of detections\n    probability.probability,  -- probability\n    (asin(object.meandec / 90) * 180 / pi()) AS gal_b  -- Galactic latitude derived from declination\nFROM \n    object \nINNER JOIN \n    probability ON object.oid = probability.oid  -- Join with probability table\nWHERE \n    object.ndet > 20  -- More than 20 detections\n    AND probability.probability > 0.9  -- Probability greater than 0.9\n    AND probability.class_name = 'bogus'  -- Class name is 'bogus'\n    AND probability.classifier_version = 'stamp_classifier_1.0.4'  -- Classifier version\nORDER BY \n    object.oid  -- Order by ZTF identifier\nLIMIT 15;  -- Limit to at most 15 entries\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2787, "completion_tokens": 203, "total_tokens": 2990, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cb0a388190990e519a41799c59", "custom_id": "101-0", "response": {"status_code": 200, "request_id": "7a936ae204ba93ec36b2952bc81a6d05", "body": {"id": "chatcmpl-Bdrcv2Z2euzNKphSayK4tMJslwf4O", "object": "chat.completion", "created": 1748840633, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT probability.*, xmatch.*, allwise.*\nFROM (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1\n      AND classifier_name = 'lc_classifier'\n      AND class_name = 'LPV'\n      AND probability > 0.5\n) AS prob\nINNER JOIN xmatch ON prob.oid = xmatch.oid\nINNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog\nWHERE allwise.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3067, "completion_tokens": 110, "total_tokens": 3177, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cb1e0c8190b0e2899b76847b6f", "custom_id": "101-1", "response": {"status_code": 200, "request_id": "5220bb243c54df3954d057b4c5f4b001", "body": {"id": "chatcmpl-BdrcshpbmuWfiqFwODHtXfzvSo7US", "object": "chat.completion", "created": 1748840630, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT *\nFROM (\n    SELECT p.*, x.*, a.*\n    FROM (\n        SELECT oid\n        FROM probability\n        WHERE ranking = 1 \n          AND classifier_name = 'lc_classifier' \n          AND class_name = 'LPV' \n          AND probability > 0.5\n    ) AS prob\n    INNER JOIN xmatch x ON prob.oid = x.oid\n    INNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\n    WHERE a.w1mpro BETWEEN 7 AND 8\n) AS result\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3050, "completion_tokens": 122, "total_tokens": 3172, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cb3cac8190aeb78783095a605b", "custom_id": "88-0", "response": {"status_code": 200, "request_id": "77c37b032d816f7d2f1b0c3b1d347f04", "body": {"id": "chatcmpl-Bdrcqy5fIYHPJT2gRi4bIWfbz9gMp", "object": "chat.completion", "created": 1748840628, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    o.meanra, \n    o.meandec, \n    p.classifier_version, \n    p.probability \nFROM \n    object o \nINNER JOIN \n    probability p ON o.oid = p.oid \nWHERE \n    p.class_name = 'bogus' \n    AND p.ranking = 1 \n    AND o.ndet >= 20 \nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2649, "completion_tokens": 99, "total_tokens": 2748, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cb4fc481909b01ab14028dc139", "custom_id": "88-1", "response": {"status_code": 200, "request_id": "f8c3b945d00b2fb02879279b38f0b67a", "body": {"id": "chatcmpl-Bdrcq7eCxq6ISk8uPlx3RCnX4IOa1", "object": "chat.completion", "created": 1748840628, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    o.meanra, \n    o.meandec, \n    p.classifier_version, \n    p.probability\nFROM \n    object o\nINNER JOIN \n    probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'bogus' \n    AND p.ranking = 1 \n    AND o.ndet >= 20\nLIMIT 50; \n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2665, "completion_tokens": 100, "total_tokens": 2765, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cb62bc8190a8eda1cb0919bf63", "custom_id": "105-0", "response": {"status_code": 200, "request_id": "bd3552c85eedd195ed5bddbf54a45ad4", "body": {"id": "chatcmpl-BdrcqPx4P40xcY5B1LRlTxBwvsZri", "object": "chat.completion", "created": 1748840628, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query to filter probabilities for AGN\nWITH agn_probabilities AS (\n    SELECT oid\n    FROM probability\n    WHERE probability > 0.7\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n)\n\n-- Main query to retrieve the desired information\nSELECT \n    o.oid AS ztf_identifier,\n    p.probability,\n    d.candid,\n    d.fid,\n    dq.red_chi2,\n    dq.classtar AS sgscore,\n    ps.objectidps1,\n    ps.sgscore1,\n    ps.distpsnr1\nFROM object o\nINNER JOIN agn_probabilities ap ON o.oid = ap.oid\nINNER JOIN detection d ON o.oid = d.oid\nINNER JOIN dataquality dq ON d.candid = dq.candid AND d.oid = dq.oid\nINNER JOIN ps1_ztf ps ON o.oid = ps.oid\nWHERE ps.distpsnr1 < 2\n  AND ABS(ps.sgscore1 - dq.classtar) < 0.5\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3378, "completion_tokens": 232, "total_tokens": 3610, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cb72f88190ad2d00cb3aa8d3b3", "custom_id": "105-1", "response": {"status_code": 200, "request_id": "b969dbc01ee921d848f89994519d0344", "body": {"id": "chatcmpl-BdrcrCN6DuzvQEyxSsD3mUk0vOxap", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query to filter probabilities for AGN with specified conditions\nWITH agn_probabilities AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE probability > 0.7\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n),\n-- Sub-query to get PS1 source information\nps1_sources AS (\n    SELECT candid, objectidps1, sgscore1, distpsnr1\n    FROM ps1_ztf\n    WHERE distpsnr1 < 2\n),\n-- Main query to join all relevant information\nfinal_results AS (\n    SELECT o.oid, p.probability, d.candid, d.fid, d.chipsf, d.classtar AS sgscore, \n           ps.objectidps1, ps.sgscore1, ps.distpsnr1\n    FROM agn_probabilities p\n    INNER JOIN object o ON p.oid = o.oid\n    INNER JOIN dataquality d ON o.oid = d.oid\n    INNER JOIN ps1_sources ps ON d.candid = ps.candid\n    WHERE ABS(ps.sgscore1 - d.classtar) < 0.5\n)\n-- Select the final results with a limit of 50\nSELECT *\nFROM final_results\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3275, "completion_tokens": 271, "total_tokens": 3546, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cb83408190b9b2c5ac2f42f3fd", "custom_id": "86-0", "response": {"status_code": 200, "request_id": "c46003982557898ebfb72669c25b790a", "body": {"id": "chatcmpl-BdrcrYiS8UuJ4pi6G313cwfoGoQP6", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter probabilities for Cepheid, Delta Scuti, or RR Lyrae\nWITH filtered_probabilities AS (\n    SELECT oid\n    FROM probability\n    WHERE probability > 0.6\n      AND class_name IN ('CEP', 'DSCT', 'RRL')\n      AND classifier_name = 'lc_classifier'\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n)\n\n-- Main query to join with PS1 objects\nSELECT p.*, ps.*\nFROM filtered_probabilities fp\nINNER JOIN ps1_ztf ps ON fp.oid = ps.oid\nWHERE ps.sgscore1 > 0.8 OR ps.sgscore2 > 0.8 OR ps.sgscore3 > 0.8\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3016, "completion_tokens": 161, "total_tokens": 3177, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cb93c88190a700b8bf44ff94d2", "custom_id": "86-1", "response": {"status_code": 200, "request_id": "7d58637efd804bcef74238b249f9b70e", "body": {"id": "chatcmpl-BdrcrUgtTgizGvdmGISFjBNuUAtYL", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to filter objects from the probability table based on specified conditions\nWITH filtered_probability AS (\n    SELECT oid\n    FROM probability\n    WHERE probability > 0.6\n      AND class_name IN ('CEP', 'DSCT', 'RRL')\n      AND classifier_version = 'hierarchical_rf_1.1.0'\n),\n-- Subquery to filter objects from the ps1_ztf table based on specified conditions\nfiltered_ps1 AS (\n    SELECT oid\n    FROM ps1_ztf\n    WHERE sgscore1 > 0.8 OR sgscore2 > 0.8 OR sgscore3 > 0.8\n)\n-- Final query to join the filtered results and select all columns\nSELECT probability.*, ps1_ztf.*\nFROM filtered_probability\nINNER JOIN filtered_ps1 ON filtered_probability.oid = filtered_ps1.oid\nINNER JOIN probability ON filtered_probability.oid = probability.oid\nINNER JOIN ps1_ztf ON filtered_ps1.oid = ps1_ztf.oid\nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2977, "completion_tokens": 222, "total_tokens": 3199, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cba1488190ae909b2ddeb18786", "custom_id": "41-0", "response": {"status_code": 200, "request_id": "a2b0c753d42a0407e1761788c88a8d31", "body": {"id": "chatcmpl-Bdrcr0k0VHQZiVA4mksccsbeYG8vO", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS obj_ra, 41.397 AS obj_dec, 5.0/3600 AS r_deg\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0/3600\n)\nSELECT \n    io.id, \n    io.obj_ra, \n    io.obj_dec, \n    io.r_deg, \n    aw.identifier AS allwise_id, \n    aw.ra AS allwise_ra, \n    aw.dec AS allwise_dec, \n    aw.w1mag AS w1_magnitude, \n    aw.w1mag_unc AS w1_magnitude_uncertainty\nFROM \n    input_objects io\nJOIN \n    allwise_objects aw ON \n    (q3c_radial_query(io.obj_ra, io.obj_dec, io.r_deg, aw.ra, aw.dec) = 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2957, "completion_tokens": 202, "total_tokens": 3159, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cbb16c81908929644ff51a5a8a", "custom_id": "41-1", "response": {"status_code": 200, "request_id": "a71cfb52d274509153f24fe715da65ad", "body": {"id": "chatcmpl-BdrcsJCMBgp41ZUUBg5R4NMahTTfk", "object": "chat.completion", "created": 1748840630, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH input_objects AS (\n    SELECT 'id_1' AS id, 132.961 AS obj_ra, 41.397 AS obj_dec, 5.0 / 3600 AS r_deg\n    UNION ALL\n    SELECT 'id_2', 139.01, 41.5653, 10.0 / 3600\n),\nallwise_objects AS (\n    SELECT \n        a.oid_catalog, \n        a.ra, \n        a.dec, \n        a.w1mpro, \n        a.w1sigmpro\n    FROM allwise a\n    JOIN input_objects i ON \n        (q3c_radial_query(a.ra, a.dec, i.obj_ra, i.obj_dec, i.r_deg) = 1)\n)\nSELECT \n    i.id, \n    i.obj_ra, \n    i.obj_dec, \n    i.r_deg, \n    a.oid_catalog, \n    a.ra, \n    a.dec, \n    a.w1mpro, \n    a.w1sigmpro\nFROM input_objects i\nJOIN allwise_objects a ON \n    (q3c_radial_query(a.ra, a.dec, i.obj_ra, i.obj_dec, i.r_deg) = 1);\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3100, "completion_tokens": 264, "total_tokens": 3364, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cbc1f88190ac3e6b6f3abb2960", "custom_id": "74-0", "response": {"status_code": 200, "request_id": "55127239f8397dd74a04b7cee97e3714", "body": {"id": "chatcmpl-BdrcrZJepYlWEfrobDIxdSPZfnNgO", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT oid, ssnamenr, ssmagnr  -- Selecting ZTF identifier, MPC identifier, and MPC magnitude\nFROM ss_ztf  -- From the ss_ztf table\nWHERE oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')  -- Filtering for specific ZTF objects\nAND ssmagnr < 19.2  -- Filtering for MPC objects brighter than 19.2 mag\nORDER BY ssmagnr DESC;  -- Sorting results by MPC magnitude in descending order\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2674, "completion_tokens": 125, "total_tokens": 2799, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cbd16c81908ee771b46a134c3d", "custom_id": "74-1", "response": {"status_code": 200, "request_id": "c5c159855daa746c8e654e32a3fb6fb4", "body": {"id": "chatcmpl-Bdrcr4tdXA4L7acjldPZu2SqfAWv2", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Query to retrieve ZTF objects and associated MPC objects brighter than 19.2 mag\nSELECT \n    ztf.oid AS ztf_identifier,  -- ZTF object identifier\n    mpc.mpc_identifier,         -- MPC object identifier\n    mpc.magnitude                -- MPC magnitude\nFROM \n    ss_ztf ztf                   -- Assuming ss_ztf is the table for ZTF objects\nJOIN \n    mpc_objects mpc             -- Assuming mpc_objects is the table for MPC objects\nON \n    ztf.oid = mpc.ztf_oid        -- Join condition based on ZTF identifier\nWHERE \n    ztf.oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')  -- Filter for specific ZTF objects\n    AND mpc.magnitude < 19.2     -- Filter for MPC objects brighter than 19.2 mag\nORDER BY \n    mpc.magnitude DESC;          -- Sort results by MPC magnitude in descending order\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2701, "completion_tokens": 223, "total_tokens": 2924, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cbe078819094b44b91582f4726", "custom_id": "97-0", "response": {"status_code": 200, "request_id": "a94edfff24ddd2248174412e4658121c", "body": {"id": "chatcmpl-BdrcrClrtDflNWygjFDlEH4raeZKF", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Sub-query for AGN in the stamp classifier\nWITH agn_prob AS (\n    SELECT oid, probability AS prob_stamp_agn\n    FROM probability\n    WHERE probability > 0.6\n      AND classifier_name = 'stamp_classifier'\n      AND classifier_version = 'stamp_classifier_1.0.4'\n),\n-- Sub-query for LPV in the light curve classifier\nlpv_prob AS (\n    SELECT oid, probability AS prob_lc_lpv\n    FROM probability\n    WHERE probability > 0.7\n      AND classifier_name = 'lc_classifier_periodic'\n)\n-- Final query to join both sub-queries\nSELECT a.oid, a.prob_stamp_agn, l.prob_lc_lpv\nFROM agn_prob a\nINNER JOIN lpv_prob l ON a.oid = l.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3015, "completion_tokens": 179, "total_tokens": 3194, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cbede48190a59bd844711ae0b2", "custom_id": "97-1", "response": {"status_code": 200, "request_id": "d9d434387bef4b0ec142cb5126cb64cb", "body": {"id": "chatcmpl-BdrcsBJj2o47OxgQweXqHVxoKZtt8", "object": "chat.completion", "created": 1748840630, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nWITH agn_prob AS (\n    SELECT oid, probability AS prob_stamp_agn\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier_1.0.4' \n      AND probability > 0.6 \n      AND class_name = 'AGN'\n),\nlpv_prob AS (\n    SELECT oid, probability AS prob_lc_lpv\n    FROM probability\n    WHERE classifier_name = 'lc_classifier' \n      AND probability > 0.7 \n      AND class_name = 'LPV'\n)\nSELECT o.oid, a.prob_stamp_agn, l.prob_lc_lpv\nFROM object o\nINNER JOIN agn_prob a ON o.oid = a.oid\nINNER JOIN lpv_prob l ON o.oid = l.oid\nLIMIT 50;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 3019, "completion_tokens": 167, "total_tokens": 3186, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cbfc4c8190955cc8b51bb433a1", "custom_id": "91-0", "response": {"status_code": 200, "request_id": "7afd12c56ef3fa08bf6d576280e8639e", "body": {"id": "chatcmpl-BdrcsLVVU1ho6s3JrZgVTSJR9sXgd", "object": "chat.completion", "created": 1748840630, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    MIN(f.g_mag - f.r_mag) AS g_r_difference,  -- Calculate the difference between minimum g- and r-band difference magnitudes\n    f.w1_w2 AS w1_w2,  -- Rename 'W1-W2' feature value to w1_w2\n    f.feature_version\nFROM \n    object o\nINNER JOIN \n    feature f ON o.oid = f.oid  -- Join object and feature tables on oid\nWHERE \n    f.w1_w2 < 1  -- Filter for 'W1-W2' color lower than 1\nGROUP BY \n    o.oid, o.ndet, f.w1_w2, f.feature_version  -- Group by necessary columns\nLIMIT 100;  -- Limit the results to 100 rows\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2748, "completion_tokens": 182, "total_tokens": 2930, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cc0a2c8190ad8cb65b589a6e00", "custom_id": "91-1", "response": {"status_code": 200, "request_id": "ed2957afbdc40f8c6401576392bb6f3c", "body": {"id": "chatcmpl-BdrcrvQQPGa7nXGtXc7BT7w0rZW9X", "object": "chat.completion", "created": 1748840629, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid, \n    o.ndet, \n    (SELECT MIN(fg.value) - MIN(fr.value) \n     FROM feature fg, feature fr \n     WHERE fg.oid = o.oid AND fr.oid = o.oid \n     AND fg.name = 'delta_mag_fid' AND fr.name = 'delta_mag_fid' \n     AND fg.fid = 1 AND fr.fid = 2) AS g_r_difference, \n    f.value AS w1_w2, \n    f.version \nFROM \n    object o \nINNER JOIN \n    feature f ON o.oid = f.oid \nWHERE \n    f.name = 'W1-W2' AND f.value < 1 \nLIMIT 100;\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2828, "completion_tokens": 160, "total_tokens": 2988, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cc1a308190b2ea6df415d80cd1", "custom_id": "60-0", "response": {"status_code": 200, "request_id": "516be31125afbe7213aff5442fda0ba3", "body": {"id": "chatcmpl-BdrcsENdAQ7q6pFfSgKjMKsWMywHc", "object": "chat.completion", "created": 1748840630, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT oid, ndet, dmdt_first, dm_first  -- Selecting the required columns\nFROM magstat  -- From the magstat table\nWHERE oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')  -- Filtering for specific ZTF identifiers\nAND ndubious = 0  -- Ensuring zero dubious corrections\nAND fid = 1;  -- Filtering for the g band\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2711, "completion_tokens": 102, "total_tokens": 2813, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cc2a008190b7c4c565eb668ddc", "custom_id": "60-1", "response": {"status_code": 200, "request_id": "ab03a6dd70c236d80ab82a337262968d", "body": {"id": "chatcmpl-BdrcuhqXA5kLbLoRUeQLa21XwGVx1", "object": "chat.completion", "created": 1748840632, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT oid, ndet, dmdt_first, dm_first  -- Selecting the required columns\nFROM magstat  -- From the magstat table\nWHERE oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')  -- Filtering for specific ZTF identifiers\nAND ndubious = 0  -- Ensuring zero dubious corrections\nAND fid = 1;  -- Filtering for the g band\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2677, "completion_tokens": 102, "total_tokens": 2779, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cc39148190bc2213b02134c8e4", "custom_id": "76-0", "response": {"status_code": 200, "request_id": "3265b43b0ebd2946963ca54dde25ec9e", "body": {"id": "chatcmpl-BdrcsCnaCu2fdiKVFO7yaXBZUA4pi", "object": "chat.completion", "created": 1748840630, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\n-- Subquery to get the details of the solar system object '115185'\nWITH ss_ztf AS (\n    SELECT oid, ssdistnr, ssmagnr\n    FROM object\n    WHERE oid = '115185'\n)\n\n-- Main query to find ZTF objects within 1.5 arcseconds of the solar system object\nSELECT o.oid, s.ssmagnr, s.ssdistnr\nFROM object o\nJOIN ss_ztf s ON q3c_radial_query(o.meanra, o.meandec, s.meanra, s.meandec, 1.5/3600)  -- 1.5 arcseconds to degrees\nORDER BY s.ssdistnr;  -- Sort by distance\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2819, "completion_tokens": 160, "total_tokens": 2979, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
{"id": "batch_req_683d30cc48c48190adae81c653f12c88", "custom_id": "76-1", "response": {"status_code": 200, "request_id": "b3163866b264a0e4ea8b6dea899898c5", "body": {"id": "chatcmpl-BdrcswzTYWLwPrX6Z8zrbJWSkRD6k", "object": "chat.completion", "created": 1748840630, "model": "gpt-4o-mini-2024-07-18", "choices": [{"index": 0, "message": {"role": "assistant", "content": "```sql\nSELECT \n    o.oid,  -- ZTF identifier\n    ss.ssmagnr,  -- magnitude of the Solar System object from the MPC archive\n    q3c_dist(o.meanra, o.meandec, ss.meanra, ss.meandec) AS distance  -- calculated distance\nFROM \n    object o\nJOIN \n    ss_ztf ss ON ss.name = '115185'  -- join with the Solar System object table\nWHERE \n    q3c_dist(o.meanra, o.meandec, ss.meanra, ss.meandec) <= 1.5  -- filter for distance within 1.5 arcseconds\nORDER BY \n    distance;  -- sort by distance\n```", "refusal": null, "annotations": []}, "logprobs": null, "finish_reason": "stop"}], "usage": {"prompt_tokens": 2635, "completion_tokens": 154, "total_tokens": 2789, "prompt_tokens_details": {"cached_tokens": 0, "audio_tokens": 0}, "completion_tokens_details": {"reasoning_tokens": 0, "audio_tokens": 0, "accepted_prediction_tokens": 0, "rejected_prediction_tokens": 0}}, "service_tier": "default", "system_fingerprint": "fp_34a54ae93c"}}, "error": null}
