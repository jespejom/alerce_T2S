{"custom_id": "8-0", "response": "/* Get objects first classified as SN by stamp classifier between MJD 60173-60177\n   with prob > 0.5 OR ndet >= 2 */\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND p.probability > 0.5\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n    \n    UNION\n    \n    SELECT DISTINCT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1\n    AND o.ndet >= 2\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0\n)\nSELECT *\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_objects);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 289, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "8-1", "response": "/* Get objects first classified as SN by stamp classifier in date range */\nWITH sn_candidates AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    INNER JOIN object o ON p.oid = o.oid\n    WHERE p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.ranking = 1  /* most likely class */\n    AND o.firstmjd BETWEEN 60173.0 AND 60177.0  /* between aug 17 and aug 21 */\n)\nSELECT o.*, p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.oid IN (\n    SELECT oid \n    FROM sn_candidates\n)\nAND (\n    p.probability > 0.5  /* probability condition */\n    OR o.ndet >= 2      /* at least two detections */\n)\nAND p.classifier_name = 'stamp_classifier'\nAND p.class_name = 'SN'\nAND p.ranking = 1;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 106, "output_tokens": 264, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "27-0", "response": "/* Get objects with ndet >= 100 that are most likely CEP according to lc_classifier */\nWITH cep_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       o.g_r_max,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.oid IN (SELECT oid FROM cep_objects)\n    AND o.ndet >= 100\n    AND p.classifier_name = 'lc_classifier'\nORDER BY p.probability DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 117, "output_tokens": 252, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "27-1", "response": "/* Get objects with ndet >= 100 that are most likely CEP according to lc_classifier */\nWITH cep_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       o.g_r_max,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.oid IN (SELECT oid FROM cep_objects)\n    AND o.ndet >= 100\n    AND p.classifier_name = 'lc_classifier'\nORDER BY p.probability DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 117, "output_tokens": 252, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "17-0", "response": "/* Get AGN objects from lc_classifier with highest probability */\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'AGN'\n    AND ranking = 1\n),\n/* Get magstats for r band (fid=2) with variability */\nr_band_var AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n    AND magsigma > 0\n    AND ndet > 0\n),\n/* Get magstats for g band (fid=1) with no detections or no variability */\ng_band_nonvar AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1\n    AND (ndet = 0 OR magsigma = 0)\n)\n/* Main query joining the conditions and getting features */\nSELECT f.oid, f.name, f.value\nFROM feature f\nINNER JOIN agn_objects a ON f.oid = a.oid\nINNER JOIN r_band_var r ON f.oid = r.oid\nINNER JOIN g_band_nonvar g ON f.oid = g.oid\nORDER BY f.value ASC, f.oid ASC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 6693, "cache_read_input_tokens": 0, "input_tokens": 82, "output_tokens": 311, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "17-1", "response": "/* Get AGN objects from lc_classifier with highest probability */\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'AGN'\n    AND ranking = 1\n),\n/* Get magstats for r band (fid=2) with variability */\nr_band_var AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 2\n    AND magsigma > 0\n    AND ndet > 0\n),\n/* Get magstats for g band (fid=1) with no detections or no variability */\ng_band_nonvar AS (\n    SELECT oid\n    FROM magstat\n    WHERE fid = 1\n    AND (ndet = 0 OR magsigma = 0)\n)\n/* Main query joining the conditions and getting features */\nSELECT f.oid, f.name, f.value\nFROM feature f\nINNER JOIN agn_objects a ON f.oid = a.oid\nINNER JOIN r_band_var r ON f.oid = r.oid\nINNER JOIN g_band_nonvar g ON f.oid = g.oid\nORDER BY f.value ASC, f.oid ASC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 6693, "cache_read_input_tokens": 0, "input_tokens": 82, "output_tokens": 311, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "37-0", "response": "/* Get SNIa objects from lc_classifier with ranking=1 (most probable class) */\nWITH top_snia AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'SNIa'\n    AND ranking = 1\n)\nSELECT o.*, p.probability\nFROM object o\nINNER JOIN top_snia p ON o.oid = p.oid\nORDER BY p.probability DESC\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 68, "output_tokens": 124, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "37-1", "response": "/* Get SNIa objects from lc_classifier with ranking=1 (most probable class) */\nWITH top_snia AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'SNIa'\n    AND ranking = 1\n)\nSELECT o.*, p.probability\nFROM object o\nINNER JOIN top_snia p ON o.oid = p.oid\nORDER BY p.probability DESC\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 68, "output_tokens": 124, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "34-0", "response": "WITH catalog (oid) AS (\n    VALUES ('ZTF17aaadpsi'),\n           ('ZTF19aaduncs'),\n           ('ZTF18abnvehl'),\n           ('ZTF19abrqsxy'),\n           ('ZTF19aaduodl'),\n           ('ZTF19aadovdv'),\n           ('ZTF18aammkke'),\n           ('ZTF18abtriul'),\n           ('ZTF17aabwtky'),\n           ('ZTF18abwjpfy')\n)\nSELECT f.oid,\n       f.name,\n       f.value,\n       f.fid\nFROM feature f\nINNER JOIN catalog c ON f.oid = c.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period');", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5594, "input_tokens": 186, "output_tokens": 200, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "34-1", "response": "WITH catalog (oid) AS (\n    VALUES ('ZTF17aaadpsi'),\n           ('ZTF19aaduncs'),\n           ('ZTF18abnvehl'),\n           ('ZTF19abrqsxy'),\n           ('ZTF19aaduodl'),\n           ('ZTF19aadovdv'),\n           ('ZTF18aammkke'),\n           ('ZTF18abtriul'),\n           ('ZTF17aabwtky'),\n           ('ZTF18abwjpfy')\n)\nSELECT f.oid,\n       f.name,\n       f.value,\n       f.fid\nFROM feature f\nINNER JOIN catalog c ON f.oid = c.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period');", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5594, "input_tokens": 186, "output_tokens": 200, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "1-0", "response": "/* First get the AGN objects with high probability */\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n    AND classifier_name = 'lc_classifier'\n    AND probability > 0.6\n    AND ranking = 1\n),\n/* Get objects with sufficient time coverage and detections */\nvalid_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    JOIN agn_objects a ON o.oid = a.oid\n    WHERE o.deltajd >= 365  /* at least one year coverage */\n    AND o.ndet >= 20\n),\n/* Get magnitude variations per band using corrected magnitudes */\nmag_variations AS (\n    SELECT \n        oid,\n        fid AS detection_fid,\n        MAX(magpsf_corr) - MIN(magpsf_corr) as delta_mag,\n        MAX(magpsf_corr) as max_mag,\n        MIN(magpsf_corr) as min_mag\n    FROM detection\n    WHERE corrected = true\n    GROUP BY oid, fid\n),\n/* Get objects with required magnitude variations */\nvar_objects AS (\n    SELECT v.oid\n    FROM valid_objects v\n    JOIN mag_variations m1 ON v.oid = m1.oid AND m1.detection_fid = 1  /* g band */\n    JOIN mag_variations m2 ON v.oid = m2.oid AND m2.detection_fid = 2  /* r band */\n    WHERE m1.delta_mag > 1.0  /* g band variation > 1 mag */\n    AND m2.delta_mag > 0.5    /* r band variation > 0.5 mag */\n)\nSELECT \n    v.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid AS feature_fid,\n    v.meanra,\n    v.meandec,\n    v.ndet,\n    m.max_mag,\n    m.min_mag,\n    m.delta_mag,\n    m.detection_fid\nFROM var_objects vo\nJOIN valid_objects v ON vo.oid = v.oid\nJOIN feature f ON v.oid = f.oid\nJOIN mag_variations m ON v.oid = m.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 6471, "cache_read_input_tokens": 0, "input_tokens": 197, "output_tokens": 589, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "1-1", "response": "/* First get the AGN objects with high probability */\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'AGN'\n    AND classifier_name = 'lc_classifier'\n    AND probability > 0.6\n    AND ranking = 1\n),\n/* Get objects with sufficient time coverage and detections */\nvalid_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    JOIN agn_objects a ON o.oid = a.oid\n    WHERE o.deltajd >= 365  /* at least one year coverage */\n    AND o.ndet >= 20\n),\n/* Get magnitude variations per band using corrected magnitudes */\nmag_variations AS (\n    SELECT \n        oid,\n        fid AS detection_fid,\n        MAX(magpsf_corr) - MIN(magpsf_corr) as delta_mag,\n        MAX(magpsf_corr) as max_mag,\n        MIN(magpsf_corr) as min_mag\n    FROM detection\n    WHERE corrected = true\n    GROUP BY oid, fid\n),\n/* Filter objects with required magnitude variations */\nfiltered_objects AS (\n    SELECT v.*, \n           g.delta_mag as g_delta, \n           r.delta_mag as r_delta\n    FROM valid_objects v\n    JOIN mag_variations g ON v.oid = g.oid AND g.detection_fid = 1\n    JOIN mag_variations r ON v.oid = r.oid AND r.detection_fid = 2\n    WHERE g.delta_mag > 1 \n    AND r.delta_mag > 0.5\n)\nSELECT \n    f.oid,\n    f.meanra,\n    f.meandec,\n    f.ndet,\n    feat.name,\n    feat.value,\n    feat.version,\n    feat.fid as feature_fid,\n    g.max_mag as g_max,\n    g.min_mag as g_min,\n    g.delta_mag as g_delta_mag,\n    r.max_mag as r_max,\n    r.min_mag as r_min,\n    r.delta_mag as r_delta_mag\nFROM filtered_objects f\nLEFT JOIN feature feat ON f.oid = feat.oid\nLEFT JOIN mag_variations g ON f.oid = g.oid AND g.detection_fid = 1\nLEFT JOIN mag_variations r ON f.oid = r.oid AND r.detection_fid = 2;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 6471, "input_tokens": 197, "output_tokens": 634, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "16-0", "response": "/* First get the OIDs that meet the criteria */\nWITH sn_candidates AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n), first_det_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n), fast_risers AS (\n    SELECT m.oid\n    FROM magstat m\n    WHERE m.dmdt_first >= 0.25\n)\nSELECT \n    nd.oid,\n    sc.probability,\n    nd.fid,\n    nd.diffmaglim,\n    m.fid as magstat_fid,\n    m.dmdt_first\nFROM sn_candidates sc\nINNER JOIN first_det_objects fdo ON sc.oid = fdo.oid\nINNER JOIN fast_risers fr ON sc.oid = fr.oid\nLEFT JOIN non_detection nd ON sc.oid = nd.oid\nLEFT JOIN magstat m ON sc.oid = m.oid\nORDER BY nd.oid\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3998, "cache_read_input_tokens": 0, "input_tokens": 239, "output_tokens": 305, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "16-1", "response": "/* First get the OIDs that meet the criteria */\nWITH sn_objects AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n), fast_risers AS (\n    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first\n    FROM magstat m\n    WHERE m.dmdt_first >= 0.25\n), september_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n)\n/* Main query joining the conditions and getting the required data */\nSELECT \n    s.oid,\n    s.probability,\n    fr.magstat_fid,\n    fr.dmdt_first,\n    nd.fid,\n    nd.mjd,\n    nd.diffmaglim\nFROM sn_objects s\nINNER JOIN fast_risers fr ON s.oid = fr.oid\nINNER JOIN september_objects so ON s.oid = so.oid\nLEFT JOIN non_detection nd ON s.oid = nd.oid\nORDER BY s.oid\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3998, "cache_read_input_tokens": 0, "input_tokens": 239, "output_tokens": 318, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "19-0", "response": "/* Get objects with first detection between March 1st and April 1st 2021,\n   with at most one detection, and high probability of being asteroids */\nWITH asteroid_candidates AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.7\n)\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    a.class_name,\n    a.probability\nFROM object o\nINNER JOIN asteroid_candidates a ON o.oid = a.oid\nWHERE o.firstmjd BETWEEN 59274.0 AND 59305.0\n    AND o.ndet <= 1\nORDER BY o.firstmjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 171, "output_tokens": 227, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "19-1", "response": "/* Get objects with first detection between March 1st and April 1st 2021,\n   with at most one detection, and high probability of being asteroids */\nWITH asteroid_candidates AS (\n    SELECT p.oid, p.class_name, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.7\n)\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    a.class_name,\n    a.probability\nFROM object o\nINNER JOIN asteroid_candidates a ON o.oid = a.oid\nWHERE o.firstmjd BETWEEN 59274.0 AND 59305.0\n    AND o.ndet <= 1\nORDER BY o.firstmjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 171, "output_tokens": 227, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "14-0", "response": "/* Create temporary table with the list of oids */\nWITH oid_list (oid) AS (\n    VALUES ('ZTF23aavzgjg'), ('ZTF23aaynzyk'), ('ZTF23aavqxos'), ('ZTF23aaknyni'),\n           ('ZTF23aavsdtc'), ('ZTF18aandkua'), ('ZTF23aaxfewt'), ('ZTF23aavshwi'),\n           ('ZTF22aawasao'), ('ZTF23aaxgvnt')\n)\n/* Main query joining detection and ps1_ztf tables */\nSELECT d.oid,\n       d.candid,\n       d.fid,\n       d.mjd,\n       d.magpsf_corr,\n       d.sigmapsf_corr,\n       d.has_stamp,\n       d.drb,\n       p.sgscore1,\n       p.distpsnr1\nFROM oid_list ol\nJOIN detection d ON d.oid = ol.oid\nJOIN ps1_ztf p ON p.candid = d.candid\nWHERE d.drb > 0.5\nAND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4322, "cache_read_input_tokens": 0, "input_tokens": 267, "output_tokens": 320, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "14-1", "response": "/* Create temporary table with the list of oids */\nWITH oid_list (oid) AS (\n    VALUES ('ZTF23aavzgjg'), ('ZTF23aaynzyk'), ('ZTF23aavqxos'), ('ZTF23aaknyni'),\n           ('ZTF23aavsdtc'), ('ZTF18aandkua'), ('ZTF23aaxfewt'), ('ZTF23aavshwi'),\n           ('ZTF22aawasao'), ('ZTF23aaxgvnt')\n)\n/* Main query joining detection and ps1_ztf tables */\nSELECT d.oid,\n       d.candid,\n       d.fid,\n       d.mjd,\n       d.magpsf_corr,\n       d.sigmapsf_corr,\n       d.has_stamp,\n       d.drb,\n       p.sgscore1,\n       p.distpsnr1\nFROM oid_list ol\nJOIN detection d ON d.oid = ol.oid\nJOIN ps1_ztf p ON p.candid = d.candid\nWHERE d.drb > 0.5\nAND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4322, "cache_read_input_tokens": 0, "input_tokens": 267, "output_tokens": 320, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "30-0", "response": "/* Get predicted class (ranking=1) for each object using lc_classifier */\nWITH top_predictions AS (\n    SELECT \n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n)\nSELECT \n    t.oid,\n    t.class_name,\n    t.probability\nFROM top_predictions t;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 74, "output_tokens": 114, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "30-1", "response": "/* Get predicted class (ranking=1) for each object using lc_classifier */\nWITH top_predictions AS (\n    SELECT \n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n)\nSELECT \n    t.oid,\n    t.class_name,\n    t.probability\nFROM top_predictions t;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 74, "output_tokens": 114, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "22-0", "response": "/* Get objects with first detection between June 1st and July 1st 2018 */\n/* Join with probability table to get only objects classified by lc_classifier */\n/* Use ranking = 1 to get the most probable class for each object */\nSELECT DISTINCT o.*\nFROM object o\nWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0\nAND o.oid IN (\n    SELECT p.oid \n    FROM probability p \n    WHERE p.classifier_name = 'lc_classifier' \n    AND p.ranking = 1\n);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 97, "output_tokens": 141, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "22-1", "response": "/* Get objects with first detection between June 1st and July 1st 2018 */\n/* Join with probability table to get only objects classified by lc_classifier */\n/* Use ranking = 1 to get the most probable class for each object */\nSELECT DISTINCT o.*\nFROM object o\nWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0\nAND EXISTS (\n    SELECT 1 \n    FROM probability p \n    WHERE p.oid = o.oid \n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 97, "output_tokens": 147, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "12-0", "response": "/* Get SNe objects within time range and polygon */\nWITH sne_candidates AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nSELECT o.oid, o.meanra, o.meandec\nFROM object o\nINNER JOIN sne_candidates s ON o.oid = s.oid\nWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0\nAND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 145, "output_tokens": 209, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "12-1", "response": "/* Get SNe objects within time range and polygon */\nWITH sne_candidates AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n    AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nSELECT o.oid, o.meanra, o.meandec\nFROM object o\nINNER JOIN sne_candidates s ON s.oid = o.oid\nWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0\nAND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 145, "output_tokens": 209, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "57-0", "response": "/* Define the input catalog with source coordinates and search radii */\nWITH catalog (source_id, ra, dec, radius) AS (\n    VALUES \n        ('id_1', 354.67, 15.954, 30.0/3600.0),  /* Convert 30 arcsec to degrees */\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0)  /* Convert 20 arcsec to degrees */\n)\n/* Main query using q3c_radial_query for spatial matching */\nSELECT \n    c.source_id,\n    c.ra AS input_ra,\n    c.dec AS input_dec,\n    c.radius AS search_radius,\n    o.oid AS ztf_id,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c\nCROSS JOIN object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius)\nORDER BY o.lastmjd DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2751, "cache_read_input_tokens": 0, "input_tokens": 188, "output_tokens": 274, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "57-1", "response": "/* Define the input catalog with source coordinates and search radii */\nWITH catalog (source_id, ra, dec, radius) AS (\n    VALUES \n        ('id_1', 354.67, 15.954, 30.0/3600.0),  /* Convert 30 arcsec to degrees */\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0)  /* Convert 20 arcsec to degrees */\n)\nSELECT \n    c.source_id AS input_id,\n    c.ra AS input_ra,\n    c.dec AS input_dec,\n    c.radius AS search_radius,\n    o.oid AS ztf_id,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c\nCROSS JOIN object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius)\nORDER BY o.lastmjd DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2751, "input_tokens": 188, "output_tokens": 261, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "75-0", "response": "/* Get rows where ssnamenr is not 'null' (VARCHAR) and limit to 100 results */\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr != 'null'\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2355, "input_tokens": 62, "output_tokens": 55, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "75-1", "response": "/* Get rows where ssnamenr is not 'null' (VARCHAR) and limit to 100 results */\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr != 'null'\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2355, "cache_read_input_tokens": 0, "input_tokens": 62, "output_tokens": 55, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "43-0", "response": "/* Get r-band (fid=2) data quality metrics for specified objects */\nWITH target_objects (oid) AS (\n    VALUES ('ZTF20acwrybw'),\n           ('ZTF22abugigx')\n)\nSELECT \n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nINNER JOIN target_objects t ON dq.oid = t.oid\nWHERE dq.fid = 2;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3687, "input_tokens": 109, "output_tokens": 139, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "43-1", "response": "/* Get r-band (fid=2) data quality metrics for specified objects */\nWITH target_objects (oid) AS (\n    VALUES ('ZTF20acwrybw'),\n           ('ZTF22abugigx')\n)\nSELECT \n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nINNER JOIN target_objects t ON dq.oid = t.oid\nWHERE dq.fid = 2;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3687, "cache_read_input_tokens": 0, "input_tokens": 109, "output_tokens": 139, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "89-0", "response": "/* Get objects classified as SN by stamp_classifier with prob > 0.7 */\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.probability > 0.7\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3909, "cache_read_input_tokens": 0, "input_tokens": 79, "output_tokens": 123, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "89-1", "response": "/* Get objects classified as SN by stamp_classifier with prob > 0.7 */\nWITH sn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'SN'\n    AND p.probability > 0.7\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM sn_objects);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3909, "input_tokens": 79, "output_tokens": 123, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "72-0", "response": "/* Query to retrieve all columns from reference table for a specific object and reference ID */\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\nAND rfid = 712120223;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2590, "cache_read_input_tokens": 0, "input_tokens": 67, "output_tokens": 51, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "72-1", "response": "/* Query to retrieve all columns from reference table for a specific object and reference ID */\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\nAND rfid = 712120223;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2590, "cache_read_input_tokens": 0, "input_tokens": 67, "output_tokens": 51, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "103-0", "response": "/* Get objects with PS1 distance > 5\" and high non-SN probability */\nWITH candidate_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n        AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nSELECT o.*, pr.*, ps.*\nFROM candidate_oids c\nJOIN object o ON o.oid = c.oid\nJOIN probability pr ON pr.oid = c.oid\n    AND pr.classifier_name = 'lc_classifier'\n    AND pr.ranking = 1\nJOIN ps1_ztf ps ON ps.oid = c.oid\nWHERE ps.distpsnr1 > 5\nORDER BY ps.distpsnr1\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3889, "cache_read_input_tokens": 0, "input_tokens": 136, "output_tokens": 235, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "103-1", "response": "/* Get objects with PS1 distance > 5\" and high non-SN probability */\nWITH candidate_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n        AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nSELECT o.*, pr.*, ps.*\nFROM candidate_oids c\nJOIN object o ON o.oid = c.oid\nJOIN probability pr ON pr.oid = c.oid\nJOIN ps1_ztf ps ON ps.oid = c.oid\nWHERE ps.distpsnr1 > 5\n    AND pr.classifier_name = 'lc_classifier'\n    AND pr.ranking = 1\nORDER BY ps.distpsnr1 DESC\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3889, "cache_read_input_tokens": 0, "input_tokens": 136, "output_tokens": 237, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "54-0", "response": "/* Get non-detections for specific objects with diffmaglim > 19.5 */\nWITH catalog (oid) AS (\n    VALUES ('ZTF23abtcveg'),\n           ('ZTF23abudlls')\n)\nSELECT nd.*\nFROM non_detection nd\nINNER JOIN catalog c ON nd.oid = c.oid\nWHERE nd.diffmaglim > 19.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2307, "cache_read_input_tokens": 0, "input_tokens": 113, "output_tokens": 101, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "54-1", "response": "/* Get all non-detections for specified objects with diffmaglim > 19.5 */\nWITH catalog (oid) AS (\n    VALUES ('ZTF23abtcveg'),\n           ('ZTF23abudlls')\n)\nSELECT nd.*\nFROM non_detection nd\nINNER JOIN catalog c ON nd.oid = c.oid\nWHERE nd.diffmaglim > 19.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2307, "cache_read_input_tokens": 0, "input_tokens": 113, "output_tokens": 102, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "99-0", "response": "/* Get objects with first detection after mjd=60310 and probability=1 of being asteroid */\nWITH asteroid_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n    )\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT oid\n    FROM asteroid_objects\n)\nORDER BY fp.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3787, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 172, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "99-1", "response": "/* Get objects with first detection after mjd=60310 and probability=1 of being asteroid */\nWITH asteroid_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n    )\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT oid\n    FROM asteroid_objects\n)\nORDER BY fp.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3787, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 172, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "40-0", "response": "-- Get ALLWISE objects within 1 arcsec (0.000277778 degrees) from given coordinates\nSELECT \n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 0.000277778);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2975, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 132, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "40-1", "response": "-- Get ALLWISE objects within 1 arcsec (0.000277778 degrees) from given coordinates\nSELECT \n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w1sigmpro,\n    w2mpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 0.000277778);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2975, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 132, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "80-0", "response": "/* Using a WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF22abcmmkz'),\n           ('ZTF18abbufof')\n)\nSELECT x.*\nFROM xmatch x\nINNER JOIN ztf_objects z ON z.oid = x.oid\nWHERE x.dist < 0.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2889, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 99, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "80-1", "response": "/* Using a WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF22abcmmkz'),\n           ('ZTF18abbufof')\n)\nSELECT x.*\nFROM xmatch x\nINNER JOIN ztf_objects z ON z.oid = x.oid\nWHERE x.dist < 0.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2889, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 99, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "45-0", "response": "/* Count rows in dataquality where chipsf >= 5 for specific objects */\nWITH target_objects(oid) AS (\n    VALUES \n        ('ZTF23abjikaf'),\n        ('ZTF20achlced')\n)\nSELECT COUNT(*)\nFROM dataquality d\nWHERE d.oid IN (SELECT oid FROM target_objects)\nAND d.chipsf >= 5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3095, "cache_read_input_tokens": 0, "input_tokens": 87, "output_tokens": 100, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "45-1", "response": "/* Count rows in dataquality where chipsf >= 5 for specific objects */\nWITH target_objects(oid) AS (\n    VALUES \n        ('ZTF23abjikaf'),\n        ('ZTF20achlced')\n)\nSELECT COUNT(*)\nFROM dataquality d\nWHERE d.oid IN (SELECT oid FROM target_objects)\nAND d.chipsf >= 5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3095, "cache_read_input_tokens": 0, "input_tokens": 87, "output_tokens": 100, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "63-0", "response": "WITH selected_oids AS (\n    VALUES ('ZTF21aaobkmg'), ('ZTF21aaomuka')\n)\nSELECT *\nFROM probability\nWHERE oid IN (SELECT * FROM selected_oids)\n    AND classifier_name = 'lc_classifier'  -- default classifier as per context\n    AND ranking <= 2  -- ranking 1 or 2\nORDER BY ranking;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 98, "output_tokens": 98, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "63-1", "response": "WITH oids AS (\n    SELECT oid\n    FROM object\n    WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')\n)\nSELECT *\nFROM probability\nWHERE oid IN (SELECT oid FROM oids)\n    AND classifier_name = 'lc_classifier'\n    AND ranking IN (1, 2)\nORDER BY ranking;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 98, "output_tokens": 96, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "73-0", "response": "/* Get Solar System object information for ZTF21acitntz */\nSELECT \n    oid,\n    ssnamenr AS mpc_name,\n    ssmagnr AS mpc_magnitude\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2947, "cache_read_input_tokens": 0, "input_tokens": 85, "output_tokens": 73, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "73-1", "response": "/* Get Solar System object information for ZTF21acitntz */\nSELECT \n    oid,\n    ssnamenr AS mpc_name,\n    ssmagnr AS mpc_magnitude\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2947, "cache_read_input_tokens": 0, "input_tokens": 85, "output_tokens": 73, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "92-0", "response": "/* Get objects with at least 10 g-band detections (fid=1) and no dubious corrections */\nWITH valid_objects AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    WHERE d.fid = 1 \n    AND d.dubious = false\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n)\n/* Join with probability table to get classification info */\nSELECT \n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nINNER JOIN valid_objects v ON p.oid = v.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking = 1\nORDER BY p.oid\nLIMIT 500;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 110, "output_tokens": 190, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "92-1", "response": "/* Get objects with at least 10 g-band detections (fid=1) and no dubious corrections */\nWITH valid_objects AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    WHERE d.fid = 1 \n    AND d.dubious = FALSE\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n)\n/* Join with probability table to get classification info */\nSELECT \n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nINNER JOIN valid_objects v ON p.oid = v.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking = 1\nORDER BY p.oid\nLIMIT 500;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 110, "output_tokens": 190, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "102-0", "response": "/* First get oids of AGN objects from probability table */\nWITH agn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n),\n/* Get oids of objects with WISE W1 magnitude in range */\nwise_objects AS (\n    SELECT DISTINCT x.oid\n    FROM allwise w\n    INNER JOIN agn_objects x ON w.oid_catalog = x.oid\n    WHERE w.w1mpro BETWEEN 12 AND 13\n    LIMIT 50\n)\n/* Get all magstat columns for the filtered objects */\nSELECT m.*\nFROM magstat m\nINNER JOIN wise_objects w ON m.oid = w.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4666, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 206, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "102-1", "response": "/* First get the oids of AGN objects from probability table */\nWITH agn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n),\n/* Get the oids that match with WISE W1 magnitude criteria using xmatch table */\nwise_objects AS (\n    SELECT DISTINCT a.oid_catalog\n    FROM allwise a\n    WHERE a.w1mpro BETWEEN 12 AND 13\n)\n/* Get all magstat columns for objects that satisfy both conditions */\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (\n    SELECT ao.oid \n    FROM agn_objects ao\n)\nAND m.oid IN (\n    SELECT wo.oid_catalog \n    FROM wise_objects wo\n)\nLIMIT 50;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4666, "input_tokens": 100, "output_tokens": 228, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "81-0", "response": "/* Get ZTF object id and distance from ALLWISE counterpart */\nWITH allwise_obj AS (\n    SELECT oid_catalog\n    FROM allwise\n    WHERE oid_catalog = 'J163603.54-065228.7'\n)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (SELECT oid_catalog FROM allwise_obj)\nAND x.catid = 'ALLWISE';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3705, "cache_read_input_tokens": 0, "input_tokens": 91, "output_tokens": 112, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "81-1", "response": "/* Get ZTF object id and distance from ALLWISE counterpart */\nWITH allwise_obj AS (\n    SELECT oid_catalog\n    FROM allwise\n    WHERE oid_catalog = 'J163603.54-065228.7'\n)\nSELECT x.oid, x.dist\nFROM xmatch x\nWHERE x.oid_catalog IN (SELECT oid_catalog FROM allwise_obj)\nAND x.catid = 'ALLWISE';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3705, "input_tokens": 91, "output_tokens": 112, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "69-0", "response": "/* Using a WITH clause to define the set of objects */\nWITH objects (oid) AS (\n    VALUES \n        ('ZTF21abstkhj'),\n        ('ZTF22aacqjeb'),\n        ('ZTF21aamwpdf')\n)\nSELECT p.*\nFROM ps1_ztf p\nINNER JOIN objects o ON p.oid = o.oid\nWHERE p.sgscore1 < 0.2;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3075, "cache_read_input_tokens": 0, "input_tokens": 110, "output_tokens": 111, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "69-1", "response": "/* Using a WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF21abstkhj'),\n           ('ZTF22aacqjeb'),\n           ('ZTF21aamwpdf')\n)\nSELECT *\nFROM ps1_ztf p\nWHERE p.oid IN (SELECT oid FROM ztf_objects)\n    AND p.sgscore1 < 0.2;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3075, "input_tokens": 110, "output_tokens": 117, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "61-0", "response": "/* Find objects with ndet >= 10, magmedian > 19 (fainter), maglast < 17 (brighter) */\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n    AND magmedian > 19\n    AND maglast < 17\nORDER BY oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3036, "input_tokens": 100, "output_tokens": 79, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "61-1", "response": "/* Find objects with ndet >= 10, magmedian > 19 (fainter), maglast < 17 (brighter) */\n/* Limit to 30 rows, ordered by object identifier (oid) */\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n    AND magmedian > 19\n    AND maglast < 17\nORDER BY oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3036, "input_tokens": 100, "output_tokens": 98, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "104-0", "response": "-- ERROR: The requested columns FWHM from SExtractor, number of PS1 calibrators used, and exposure time are not present in the provided schema\n-- Will return only the columns that are available in the schema\n\nWITH asteroid_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND classifier_version = 'stamp_classifier_1.0.4'\n    AND class_name = 'asteroid'\n    AND probability > 0.9\n    LIMIT 30\n)\nSELECT \n    o.oid,\n    d.candid,\n    ss.ssdistnr,\n    ss.ssmagnr,\n    ss.ssnamenr,\n    d.fid\nFROM asteroid_objects ao\nJOIN object o ON o.oid = ao.oid\nJOIN detection d ON d.oid = o.oid\nLEFT JOIN ss_ztf ss ON ss.oid = o.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3824, "input_tokens": 142, "output_tokens": 231, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "104-1", "response": "-- ERROR: The requested columns FWHM from SExtractor, number of PS1 calibrators, and exposure time are not present in the provided schema\n-- Will return only the columns that are available in the schema\n\nWITH asteroid_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND classifier_version = 'stamp_classifier_1.0.4'\n    AND class_name = 'asteroid'\n    AND probability > 0.9\n)\nSELECT \n    d.oid,\n    d.candid,\n    ss.ssdistnr,  -- distance to nearest known solar system object\n    ss.ssmagnr,   -- magnitude of nearest known solar system object\n    ss.ssnamenr,  -- name of nearest known solar system object\n    d.fid         -- filter identifier (1=g; 2=r; 3=i)\nFROM asteroid_objects ao\nJOIN detection d ON d.oid = ao.oid\nLEFT JOIN ss_ztf ss ON ss.oid = ao.oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3824, "input_tokens": 142, "output_tokens": 261, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "71-0", "response": "/* Get reference information for specific objects in g band (fid=1) */\nWITH catalog (oid) AS (\n    VALUES ('ZTF20aczxeud'),\n           ('ZTF21aappfdu'),\n           ('ZTF22aacqjeb')\n)\nSELECT \n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nINNER JOIN catalog c ON r.oid = c.oid\nWHERE r.fid = 1\nORDER BY r.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3182, "cache_read_input_tokens": 0, "input_tokens": 130, "output_tokens": 145, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "71-1", "response": "/* Get reference information for specific objects in g band (fid=1) */\nWITH catalog (oid) AS (\n    VALUES ('ZTF20aczxeud'),\n           ('ZTF21aappfdu'),\n           ('ZTF22aacqjeb')\n)\nSELECT \n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nINNER JOIN catalog c ON r.oid = c.oid\nWHERE r.fid = 1\nORDER BY r.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3182, "cache_read_input_tokens": 0, "input_tokens": 130, "output_tokens": 145, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "42-0", "response": "/* Get dataquality metrics for ZTF21aapnixl, sorted by chipsf (reduced chi-square) */\nSELECT \n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3687, "cache_read_input_tokens": 0, "input_tokens": 121, "output_tokens": 120, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "42-1", "response": "/* Get dataquality metrics for ZTF21aapnixl, sorted by chipsf (reduced chi-square) */\nSELECT \n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3687, "input_tokens": 121, "output_tokens": 120, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "107-0", "response": "/* First get OIDs that match the criteria */\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    INNER JOIN ss_ztf s ON o.oid = s.oid\n    WHERE o.ndet > 500\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'asteroid'\n    AND p.probability > 0.5\n    AND s.ssdistnr < 2\n)\n/* Then get all requested information for these OIDs */\nSELECT \n    o.oid AS ztf_id,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    p.probability,\n    s.candid,\n    s.ssdistnr,\n    s.ssnamenr,\n    d.mjd,\n    d.fid\nFROM selected_oids\nJOIN object o USING (oid)\nJOIN probability p ON o.oid = p.oid\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'asteroid'\nJOIN ss_ztf s ON o.oid = s.oid\nJOIN detection d ON o.oid = d.oid\nORDER BY o.firstmjd\nLIMIT 10;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3824, "cache_read_input_tokens": 0, "input_tokens": 161, "output_tokens": 382, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "107-1", "response": "/* First get objects with >500 detections and high asteroid probability */\nWITH asteroid_objects AS (\n    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    WHERE o.ndet > 500\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'asteroid'\n    AND p.probability > 0.5\n),\n/* Get the first detection for each object to get candid */\nfirst_detection AS (\n    SELECT d.oid, MIN(d.candid) as first_candid\n    FROM detection d\n    INNER JOIN asteroid_objects ao ON d.oid = ao.oid\n    GROUP BY d.oid\n)\n/* Join with ss_ztf to get solar system object info */\nSELECT \n    ao.oid as ztf_id,\n    ao.ndet as detections,\n    ao.firstmjd as first_detection_date,\n    ao.lastmjd as last_detection_date,\n    ao.probability as asteroid_probability,\n    ss.candid,\n    ss.ssdistnr as mpc_distance,\n    ss.ssnamenr as mpc_name,\n    d.mjd as detection_date,\n    d.fid as filter_id\nFROM asteroid_objects ao\nINNER JOIN first_detection fd ON ao.oid = fd.oid\nINNER JOIN ss_ztf ss ON fd.first_candid = ss.candid\nINNER JOIN detection d ON ss.candid = d.candid\nWHERE ss.ssdistnr < 2\nORDER BY ao.firstmjd\nLIMIT 10;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3824, "input_tokens": 161, "output_tokens": 451, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "83-0", "response": "/* First get the oid_catalog from xmatch table using the ZTF oid */\nWITH matched_allwise AS (\n    SELECT a.*\n    FROM allwise a\n    INNER JOIN xmatch x ON x.oid_catalog = a.oid_catalog\n    INNER JOIN object o ON o.oid = x.oid\n    WHERE o.oid = 'ZTF21aazqwxv'\n)\nSELECT *\nFROM matched_allwise;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3567, "cache_read_input_tokens": 0, "input_tokens": 62, "output_tokens": 116, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "83-1", "response": "/* First get the oid_catalog from xmatch table using the ZTF oid */\nWITH matched_allwise AS (\n    SELECT a.*\n    FROM allwise a\n    INNER JOIN xmatch x ON x.oid_catalog = a.oid_catalog\n    INNER JOIN object o ON o.oid = x.oid\n    WHERE o.oid = 'ZTF21aazqwxv'\n)\nSELECT *\nFROM matched_allwise;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3567, "cache_read_input_tokens": 0, "input_tokens": 62, "output_tokens": 116, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "84-0", "response": "/* Get ALLWISE data for ZTF object ZTF19aascdol through xmatch table */\nWITH matched_allwise AS (\n    SELECT x.oid,\n           x.oid_catalog,\n           x.dist,\n           a.w1mpro,\n           a.w2mpro,\n           a.w3mpro,\n           a.w4mpro\n    FROM xmatch x\n    JOIN allwise a ON x.oid_catalog = a.oid_catalog\n    WHERE x.oid = 'ZTF19aascdol'\n    AND x.catid = 'ALLWISE'\n)\nSELECT * FROM matched_allwise;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3705, "cache_read_input_tokens": 0, "input_tokens": 113, "output_tokens": 165, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "84-1", "response": "/* Get ALLWISE data for ZTF object ZTF19aascdol through xmatch table */\nWITH matched_allwise AS (\n    SELECT x.oid,\n           x.oid_catalog,\n           x.dist,\n           a.w1mpro,\n           a.w2mpro,\n           a.w3mpro,\n           a.w4mpro\n    FROM xmatch x\n    JOIN allwise a ON x.oid_catalog = a.oid_catalog\n    WHERE x.oid = 'ZTF19aascdol'\n    AND x.catid = 'ALLWISE'\n)\nSELECT * FROM matched_allwise;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3705, "cache_read_input_tokens": 0, "input_tokens": 113, "output_tokens": 165, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "96-0", "response": "WITH catalog (ssnamenr) AS (\n    VALUES ('2003FP134'),\n           ('2009UK56')\n)\nSELECT \n    /* Solar System object info */\n    ss.oid,\n    ss.candid,\n    ss.ssdistnr,\n    ss.ssmagnr,\n    ss.ssnamenr,\n    /* Detection info */\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM catalog c\nJOIN ss_ztf ss ON ss.ssnamenr = c.ssnamenr\nJOIN detection d ON d.oid = ss.oid\n/* 2 arcsec = 0.000555556 degrees */\nWHERE q3c_dist(d.ra, d.dec, \n    (SELECT meanra FROM object WHERE oid = ss.oid),\n    (SELECT meandec FROM object WHERE oid = ss.oid)) <= 0.000555556\nORDER BY ss.ssnamenr, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3602, "cache_read_input_tokens": 0, "input_tokens": 130, "output_tokens": 274, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "96-1", "response": "WITH catalog (ssnamenr) AS (\n    VALUES ('2003FP134'),\n           ('2009UK56')\n)\nSELECT \n    /* Solar System object info */\n    ss.oid,\n    ss.candid,\n    ss.ssdistnr,\n    ss.ssmagnr,\n    ss.ssnamenr,\n    /* Detection info */\n    d.mjd,\n    d.fid,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf\nFROM catalog c\nJOIN ss_ztf ss ON ss.ssnamenr = c.ssnamenr\nJOIN detection d ON d.oid = ss.oid\n/* 2 arcsec = 0.000555556 degrees */\nWHERE q3c_dist(d.ra, d.dec, \n    (SELECT meanra FROM object WHERE oid = ss.oid),\n    (SELECT meandec FROM object WHERE oid = ss.oid)) <= 0.000555556\nORDER BY ss.ssnamenr, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3602, "cache_read_input_tokens": 0, "input_tokens": 130, "output_tokens": 274, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "67-0", "response": "/* Using a WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF18acxlskz'),\n           ('ZTF22aanppbi'),\n           ('ZTF22abunrft')\n)\nSELECT g.*\nFROM gaia_ztf g\nINNER JOIN ztf_objects z ON g.oid = z.oid\nWHERE g.neargaia <= 1.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3028, "cache_read_input_tokens": 0, "input_tokens": 114, "output_tokens": 116, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "67-1", "response": "/* Create temporary table with the list of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF18acxlskz'),\n           ('ZTF22aanppbi'),\n           ('ZTF22abunrft')\n)\nSELECT g.*\nFROM gaia_ztf g\nINNER JOIN ztf_objects z ON g.oid = z.oid\nWHERE g.neargaia <= 1.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3028, "cache_read_input_tokens": 0, "input_tokens": 114, "output_tokens": 114, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "55-0", "response": "/* Query to get all information from object table for a specific ZTF object */\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2751, "input_tokens": 62, "output_tokens": 43, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "55-1", "response": "/* Query to get all information from object table for a specific ZTF object */\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2751, "input_tokens": 62, "output_tokens": 43, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "47-0", "response": "/* Get detections with rb>0.7 for specific objects, sorted by oid and mjd */\nWITH catalog (oid) AS (\n    VALUES ('ZTF23aaawbsc'),\n           ('ZTF21abxlmuw')\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.rb\nFROM detection d\nINNER JOIN catalog c ON d.oid = c.oid\nWHERE d.rb > 0.7\nORDER BY d.oid, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3406, "cache_read_input_tokens": 0, "input_tokens": 137, "output_tokens": 180, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "47-1", "response": "/* Get detections with rb>0.7 for specific objects, sorted by oid and mjd */\nWITH catalog (oid) AS (\n    VALUES ('ZTF23aaawbsc'),\n           ('ZTF21abxlmuw')\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.rb\nFROM detection d\nINNER JOIN catalog c ON d.oid = c.oid\nWHERE d.rb > 0.7\nORDER BY d.oid, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3406, "cache_read_input_tokens": 0, "input_tokens": 137, "output_tokens": 180, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "79-0", "response": "/* Get cross-match information for ZTF object 'ZTF20achscch' */\nSELECT \n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2297, "cache_read_input_tokens": 0, "input_tokens": 79, "output_tokens": 63, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "79-1", "response": "/* Get cross-match information for ZTF object 'ZTF20achscch' */\nSELECT \n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2297, "cache_read_input_tokens": 0, "input_tokens": 79, "output_tokens": 63, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "94-0", "response": "/* Get all columns from object and reference tables where reference_change is true */\nWITH oids AS (\n    SELECT oid \n    FROM object \n    WHERE reference_change = true \n    LIMIT 50\n)\nSELECT o.*, r.*\nFROM oids\nJOIN object o USING (oid)\nJOIN reference r USING (oid);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3182, "cache_read_input_tokens": 0, "input_tokens": 72, "output_tokens": 84, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "94-1", "response": "/* Get all columns from object and reference tables where reference_change is true */\nWITH oids AS (\n    SELECT oid \n    FROM object \n    WHERE reference_change = true \n    LIMIT 50\n)\nSELECT o.*, r.*\nFROM oids\nJOIN object o USING (oid)\nJOIN reference r USING (oid);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3182, "cache_read_input_tokens": 0, "input_tokens": 72, "output_tokens": 84, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "90-0", "response": "/* Get objects with multiband period < 5 days */\nWITH periodic_objects AS (\n    SELECT DISTINCT oid \n    FROM feature \n    WHERE name = 'Multiband_period'\n    AND version = 'lc_classifier_1.2.1-P'\n    AND value < 5\n    LIMIT 100\n)\n/* Get probabilities for these objects from lc_classifier with ranking 1 or 2 */\nSELECT p.* \nFROM probability p\nINNER JOIN periodic_objects po ON p.oid = po.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking IN (1, 2);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 5884, "cache_read_input_tokens": 0, "input_tokens": 107, "output_tokens": 162, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "90-1", "response": "/* Get objects with multiband period < 5 days */\nWITH periodic_objects AS (\n    SELECT DISTINCT oid \n    FROM feature \n    WHERE name = 'Multiband_period'\n    AND version = 'lc_classifier_1.2.1-P'\n    AND value < 5\n    LIMIT 100\n)\n/* Get probabilities for these objects from lc_classifier with ranking 1 or 2 */\nSELECT p.* \nFROM probability p\nINNER JOIN periodic_objects po ON p.oid = po.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking IN (1, 2);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 5884, "cache_read_input_tokens": 0, "input_tokens": 107, "output_tokens": 162, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "51-0", "response": "/* Query to get forced photometry epochs for ZTF24aaiutyh sorted by date */\nSELECT \n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 104, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "51-1", "response": "/* Query to get forced photometry epochs for ZTF object ZTF24aaiutyh */\nSELECT \n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 105, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "59-0", "response": "/* Get magstat information for ZTF18acsvogv */\nSELECT \n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3036, "cache_read_input_tokens": 0, "input_tokens": 80, "output_tokens": 61, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "59-1", "response": "/* Get basic statistics for ZTF object ZTF18acsvogv */\nSELECT \n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3036, "cache_read_input_tokens": 0, "input_tokens": 80, "output_tokens": 64, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "100-0", "response": "/* Query to get all epochs for ZTF24aamtvxb from detection, non_detection and forced_photometry tables */\nSELECT \n    oid AS ztf_id,\n    mjd AS epoch,\n    fid,\n    isdiffpos,\n    magpsf AS diff_mag,\n    sigmapsf AS diff_mag_unc,\n    diffmaglim,\n    NULL AS forced_mag,\n    NULL AS forced_mag_unc,\n    'detection' AS \"table\"\nFROM detection \nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid,\n    mjd,\n    fid,\n    NULL,\n    NULL,\n    NULL,\n    diffmaglim,\n    NULL,\n    NULL,\n    'non_detection'\nFROM non_detection\nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    NULL,\n    NULL,\n    diffmaglim,\n    mag AS forced_mag,\n    e_mag AS forced_mag_unc,\n    'forced_photometry'\nFROM forced_photometry\nWHERE oid = 'ZTF24aamtvxb'\n\nORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4368, "cache_read_input_tokens": 0, "input_tokens": 139, "output_tokens": 324, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "100-1", "response": "/* Query to get all epochs for ZTF24aamtvxb from detection, non_detection and forced_photometry tables */\nSELECT \n    oid AS ztf_id,\n    mjd AS epoch,\n    fid,\n    isdiffpos,\n    magpsf AS diff_mag,\n    sigmapsf AS diff_mag_unc,\n    diffmaglim,\n    NULL AS forced_mag,\n    NULL AS forced_mag_unc,\n    'detection' AS \"table\"\nFROM detection \nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid,\n    mjd,\n    fid,\n    NULL AS isdiffpos,\n    NULL AS diff_mag,\n    NULL AS diff_mag_unc,\n    diffmaglim,\n    NULL AS forced_mag,\n    NULL AS forced_mag_unc,\n    'non_detection' AS \"table\"\nFROM non_detection \nWHERE oid = 'ZTF24aamtvxb'\n\nUNION ALL\n\nSELECT \n    oid,\n    mjd,\n    fid,\n    isdiffpos,\n    NULL AS diff_mag,\n    NULL AS diff_mag_unc,\n    diffmaglim,\n    mag AS forced_mag,\n    e_mag AS forced_mag_unc,\n    'forced_photometry' AS \"table\"\nFROM forced_photometry \nWHERE oid = 'ZTF24aamtvxb'\nORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4368, "cache_read_input_tokens": 0, "input_tokens": 139, "output_tokens": 372, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "106-0", "response": "/* Get objects with high probability of being bogus and transient */\nWITH bogus_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND classifier_version = 'stamp_classifier_1.0.4'\n    AND class_name = 'bogus'\n    AND probability > 0.7\n    AND ranking = 1\n),\ntransient_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_top'\n    AND class_name = 'Transient'\n    AND probability > 0.9\n    AND ranking = 1\n)\nSELECT \n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p1.probability AS prob_stamp_bogus,\n    p2.probability AS prob_lc_transient\nFROM object o\nINNER JOIN bogus_objects bo ON o.oid = bo.oid\nINNER JOIN transient_objects to2 ON o.oid = to2.oid\nINNER JOIN probability p1 ON o.oid = p1.oid \n    AND p1.classifier_name = 'stamp_classifier'\n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'bogus'\nINNER JOIN probability p2 ON o.oid = p2.oid \n    AND p2.classifier_name = 'lc_classifier_top'\n    AND p2.class_name = 'Transient'\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 195, "output_tokens": 408, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "106-1", "response": "/* Get objects with high probability of being bogus and transient */\nWITH bogus_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND classifier_version = 'stamp_classifier_1.0.4'\n    AND class_name = 'bogus'\n    AND probability > 0.7\n),\ntransient_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_top'\n    AND class_name = 'Transient'\n    AND probability > 0.9\n)\nSELECT \n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p1.probability AS prob_stamp_bogus,\n    p2.probability AS prob_lc_transient\nFROM object o\nINNER JOIN bogus_objects bo ON o.oid = bo.oid\nINNER JOIN transient_objects to2 ON o.oid = to2.oid\nINNER JOIN probability p1 ON o.oid = p1.oid \n    AND p1.classifier_name = 'stamp_classifier'\n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'bogus'\nINNER JOIN probability p2 ON o.oid = p2.oid \n    AND p2.classifier_name = 'lc_classifier_top'\n    AND p2.class_name = 'Transient'\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 195, "output_tokens": 394, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "56-0", "response": "/* Get objects from a predefined list where corrected=false\n   Return basic properties sorted by first detection date */\nWITH catalog (oid) AS (\n    VALUES ('ZTF20abywydb'),\n           ('ZTF20abzpxxu'),\n           ('ZTF20acduffd')\n)\nSELECT o.oid,\n       o.ndet,\n       o.meanra,\n       o.meandec,\n       o.firstmjd,\n       o.lastmjd,\n       o.g_r_mean,\n       o.g_r_mean_corr\nFROM object o\nINNER JOIN catalog c ON o.oid = c.oid\nWHERE o.corrected = false\nORDER BY o.firstmjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3628, "input_tokens": 161, "output_tokens": 183, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "56-1", "response": "/* Get objects from a predefined list where corrected=false\n   Return basic properties sorted by first detection date */\nWITH catalog (oid) AS (\n    VALUES ('ZTF20abywydb'),\n           ('ZTF20abzpxxu'),\n           ('ZTF20acduffd')\n)\nSELECT o.oid,\n       o.ndet,\n       o.meanra,\n       o.meandec,\n       o.firstmjd,\n       o.lastmjd,\n       o.g_r_mean,\n       o.g_r_mean_corr\nFROM object o\nINNER JOIN catalog c ON o.oid = c.oid\nWHERE o.corrected = false\nORDER BY o.firstmjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 161, "output_tokens": 183, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "48-0", "response": "/* Query to get all features for ZTF18abqyaix, sorted by oid, fid and version */\nSELECT \n    oid,\n    name,\n    value,\n    fid,\n    version\nFROM feature\nWHERE oid = 'ZTF18abqyaix'\nORDER BY oid, fid, version;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 5594, "cache_read_input_tokens": 0, "input_tokens": 87, "output_tokens": 85, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "48-1", "response": "/* Query to get all features for ZTF18abqyaix, sorted by oid, fid and version */\nSELECT \n    oid,\n    name,\n    value,\n    fid,\n    version\nFROM feature\nWHERE oid = 'ZTF18abqyaix'\nORDER BY oid, fid, version;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5594, "input_tokens": 87, "output_tokens": 85, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "58-0", "response": "/* Get objects with ndet>=30, g-r color > 3.5, and time span > 20 days */\n/* g_r_max_corr is the g-r color at maximum */\nSELECT *\nFROM object\nWHERE ndet >= 30\nAND g_r_max_corr > 3.5\nAND deltajd > 20\nLIMIT 20;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3406, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 92, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "58-1", "response": "/* Get objects with ndet>=30, deltajd>20, and g-r color difference >3.5 */\n/* Using g_r_max_corr which represents the g-r color at maximum */\nSELECT *\nFROM object\nWHERE ndet >= 30\nAND deltajd > 20\nAND g_r_max_corr > 3.5\nLIMIT 20;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3406, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 93, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "78-0", "response": "/* Get taxonomy info for the light curve classifier */\nSELECT classifier_name,\n       classifier_version,\n       classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2212, "cache_read_input_tokens": 0, "input_tokens": 63, "output_tokens": 44, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "78-1", "response": "/* Get taxonomy info for the light curve classifier */\nSELECT classifier_name,\n       classifier_version,\n       classes\nFROM taxonomy\nWHERE classifier_name = 'lc_classifier';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2212, "input_tokens": 63, "output_tokens": 44, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "39-0", "response": "/* Get CV/Nova objects from stochastic classifier with ranking=1 */\nWITH nova_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_stochastic'\n    AND class_name = 'CV/Nova'\n    AND ranking = 1\n),\n/* Filter objects with ndethist <= 50 */\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN nova_objects n ON o.oid = n.oid\n    WHERE o.ndet <= 50\n),\n/* Get r-band detections and calculate rise from minimum */\nr_band_stats AS (\n    SELECT \n        d.oid,\n        d.candid,\n        d.fid as f_id,\n        d.ra,\n        d.dec,\n        d.magpsf,\n        d.sigmapsf,\n        d.magpsf_corr,\n        d.sigmapsf_corr,\n        (MAX(d.magpsf_corr) OVER (PARTITION BY d.oid) - \n         MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) as max_rise\n    FROM detection d\n    INNER JOIN filtered_objects f ON d.oid = f.oid\n    WHERE d.fid = 2  /* r-band filter */\n    AND d.corrected = true\n)\nSELECT *\nFROM r_band_stats\nORDER BY oid\nLIMIT 1000;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 166, "output_tokens": 368, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "39-1", "response": "/* Get CV/Nova objects from stochastic classifier */\nWITH nova_objects AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n    AND p.class_name = 'CV/Nova'\n    AND p.ranking = 1\n),\n/* Filter objects with ndet <= 50 */\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN nova_objects n ON o.oid = n.oid\n    WHERE o.ndet <= 50\n),\n/* Get min magnitude per object */\nmin_mag AS (\n    SELECT d.oid, MIN(d.magpsf_corr) as min_magpsf\n    FROM detection d\n    WHERE d.fid = 2  /* r-band filter */\n    AND d.corrected = true\n    GROUP BY d.oid\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid as f_id,\n    d.ra,\n    d.dec,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    (d.magpsf_corr - m.min_magpsf) as magnitude_rise\nFROM detection d\nINNER JOIN filtered_objects f ON d.oid = f.oid\nINNER JOIN min_mag m ON d.oid = m.oid\nWHERE d.fid = 2  /* r-band filter */\nAND d.corrected = true\nORDER BY d.oid\nLIMIT 1000;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 166, "output_tokens": 385, "server_tool_use": null, "service_tier": "batch"}}
