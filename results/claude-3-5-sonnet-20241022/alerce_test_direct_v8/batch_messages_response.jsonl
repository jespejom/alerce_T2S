{"custom_id": "8-2", "response": "/* Get objects first classified as SN by stamp classifier in date range */\nWITH sn_candidates AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND (\n        /* Objects with stamp classifier SN probability > 0.5 */\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'SN'\n            AND p.probability > 0.5\n        )\n        OR\n        /* Objects with at least 2 detections */\n        o.ndet >= 2\n    )\n)\nSELECT *\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_candidates);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3629, "input_tokens": 105, "output_tokens": 207, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "8-3", "response": "/* Get objects first classified as SN by stamp classifier in date range */\nWITH sn_candidates AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND (\n        /* Objects with stamp classifier SN probability > 0.5 */\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'SN'\n            AND p.probability > 0.5\n        )\n        OR\n        /* Objects with at least 2 detections */\n        o.ndet >= 2\n    )\n)\nSELECT *\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_candidates);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3629, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 207, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3629, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "8-4", "response": "/* Get objects first classified as SN by stamp classifier in date range */\nWITH sn_candidates AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60173.0 AND 60177.0\n    AND (\n        /* Objects with stamp classifier SN prob > 0.5 */\n        EXISTS (\n            SELECT 1\n            FROM probability p\n            WHERE p.oid = o.oid\n            AND p.classifier_name = 'stamp_classifier'\n            AND p.class_name = 'SN'\n            AND p.probability > 0.5\n        )\n        OR\n        /* Objects with at least 2 detections */\n        o.ndet >= 2\n    )\n)\nSELECT *\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sn_candidates);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3629, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 207, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3629, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "27-2", "response": "/* Get objects with ndet >= 100 that are most likely CEP according to lc_classifier */\nWITH cep_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       o.g_r_max,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM object o,\n     probability p,\n     cep_candidates c\nWHERE o.oid = c.oid\n    AND o.oid = p.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND o.ndet >= 100\nORDER BY p.probability DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3851, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 255, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3851, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "27-3", "response": "/* Get objects with ndet >= 100 that are most likely CEP according to lc_classifier */\nWITH cep_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       o.g_r_max,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM object o,\n     probability p,\n     cep_candidates c\nWHERE o.oid = c.oid\n    AND o.oid = p.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND o.ndet >= 100\nORDER BY p.probability DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3851, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 255, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3851, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "27-4", "response": "/* Get objects with ndet >= 100 that are most likely CEP according to lc_classifier */\nWITH cep_candidates AS (\n    SELECT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.class_name = 'CEP'\n        AND p.ranking = 1\n        AND p.probability > 0.76\n)\nSELECT o.oid,\n       o.meanra,\n       o.meandec,\n       o.ndet,\n       o.firstmjd,\n       o.deltajd,\n       o.g_r_max,\n       p.classifier_name,\n       p.class_name,\n       p.ranking,\n       p.probability\nFROM object o,\n     probability p,\n     cep_candidates c\nWHERE o.oid = c.oid\n    AND o.oid = p.oid\n    AND p.classifier_name = 'lc_classifier'\n    AND o.ndet >= 100\nORDER BY p.probability DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3851, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 255, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3851, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "17-2", "response": "/* Get AGN objects from lc_classifier with highest probability */\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'AGN'\n    AND ranking = 1\n),\n/* Get magstats for both bands */\nband_stats AS (\n    SELECT oid,\n           SUM(CASE WHEN fid = 1 THEN ndet ELSE 0 END) as g_ndet,\n           SUM(CASE WHEN fid = 1 THEN magsigma ELSE 0 END) as g_sigma,\n           SUM(CASE WHEN fid = 2 THEN ndet ELSE 0 END) as r_ndet,\n           SUM(CASE WHEN fid = 2 THEN magsigma ELSE 0 END) as r_sigma\n    FROM magstat\n    GROUP BY oid\n)\nSELECT o.*\nFROM object o\nINNER JOIN agn_objects a ON o.oid = a.oid\nINNER JOIN band_stats b ON o.oid = b.oid\nWHERE (b.g_ndet = 0 OR b.g_sigma = 0)  /* no detections or no variability in g band */\nAND b.r_ndet > 0                        /* has detections in r band */\nAND b.r_sigma > 0                       /* shows variability in r band */\nORDER BY oid ASC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4506, "input_tokens": 81, "output_tokens": 363, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "17-3", "response": "/* Get AGN objects from lc_classifier with highest probability */\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'AGN'\n    AND ranking = 1\n),\n/* Get magstats for both bands */\nband_stats AS (\n    SELECT oid,\n           SUM(CASE WHEN fid = 1 THEN ndet ELSE 0 END) as g_ndet,\n           SUM(CASE WHEN fid = 1 THEN magsigma ELSE 0 END) as g_sigma,\n           SUM(CASE WHEN fid = 2 THEN ndet ELSE 0 END) as r_ndet,\n           SUM(CASE WHEN fid = 2 THEN magsigma ELSE 0 END) as r_sigma\n    FROM magstat\n    GROUP BY oid\n)\nSELECT o.*\nFROM object o\nINNER JOIN agn_objects a ON o.oid = a.oid\nINNER JOIN band_stats b ON o.oid = b.oid\nWHERE (b.g_ndet = 0 OR b.g_sigma = 0)  /* no detections or no variability in g band */\nAND b.r_ndet > 0                        /* has detections in r band */\nAND b.r_sigma > 0                       /* shows variability in r band */\nORDER BY oid ASC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4506, "cache_read_input_tokens": 0, "input_tokens": 81, "output_tokens": 363, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 4506, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "17-4", "response": "/* Get AGN objects from lc_classifier with highest probability */\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'AGN'\n    AND ranking = 1\n),\n/* Get magstats for both bands */\nband_stats AS (\n    SELECT oid,\n           SUM(CASE WHEN fid = 1 THEN ndet ELSE 0 END) as g_ndet,\n           SUM(CASE WHEN fid = 1 THEN magsigma ELSE 0 END) as g_sigma,\n           SUM(CASE WHEN fid = 2 THEN ndet ELSE 0 END) as r_ndet,\n           SUM(CASE WHEN fid = 2 THEN magsigma ELSE 0 END) as r_sigma\n    FROM magstat\n    GROUP BY oid\n)\nSELECT o.*\nFROM object o\nINNER JOIN agn_objects a ON o.oid = a.oid\nINNER JOIN band_stats b ON o.oid = b.oid\nWHERE (b.g_ndet = 0 OR b.g_sigma = 0)  /* No detections or no variability in g band */\nAND b.r_ndet > 0                        /* Has detections in r band */\nAND b.r_sigma > 0                       /* Shows variability in r band */\nORDER BY oid ASC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4506, "input_tokens": 81, "output_tokens": 363, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "37-2", "response": "/* Get SNIa objects from lc_classifier with highest probability (ranking=1) */\nWITH top_snia AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'SNIa'\n    AND ranking = 1\n)\nSELECT o.*, p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.class_name = 'SNIa'\nAND p.oid IN (SELECT oid FROM top_snia)\nORDER BY p.probability DESC\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2974, "input_tokens": 67, "output_tokens": 163, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "37-3", "response": "/* Get SNIa objects from lc_classifier with highest probability (ranking=1) */\nWITH top_snia AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'SNIa'\n    AND ranking = 1\n)\nSELECT o.*, p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.class_name = 'SNIa'\nAND p.oid IN (SELECT oid FROM top_snia)\nORDER BY p.probability DESC\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2974, "cache_read_input_tokens": 0, "input_tokens": 67, "output_tokens": 163, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2974, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "37-4", "response": "/* Get SNIa objects from lc_classifier with highest probability (ranking=1) */\nWITH top_snia AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'SNIa'\n    AND ranking = 1\n)\nSELECT o.*, p.probability\nFROM object o\nINNER JOIN top_snia p ON o.oid = p.oid\nORDER BY p.probability DESC\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2974, "input_tokens": 67, "output_tokens": 122, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "34-2", "response": "WITH target_oids (oid) AS (\n    VALUES \n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT f.oid, f.name, f.value, f.fid\nFROM feature f\nINNER JOIN target_oids t ON f.oid = t.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period');", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5003, "input_tokens": 185, "output_tokens": 203, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "34-3", "response": "WITH target_oids (oid) AS (\n    VALUES \n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT f.oid, f.name, f.value, f.fid\nFROM feature f\nINNER JOIN target_oids t ON f.oid = t.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period');", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 5003, "cache_read_input_tokens": 0, "input_tokens": 185, "output_tokens": 203, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 5003, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "34-4", "response": "WITH target_oids (oid) AS (\n    VALUES \n        ('ZTF17aaadpsi'),\n        ('ZTF19aaduncs'),\n        ('ZTF18abnvehl'),\n        ('ZTF19abrqsxy'),\n        ('ZTF19aaduodl'),\n        ('ZTF19aadovdv'),\n        ('ZTF18aammkke'),\n        ('ZTF18abtriul'),\n        ('ZTF17aabwtky'),\n        ('ZTF18abwjpfy')\n)\nSELECT f.oid, f.name, f.value, f.fid\nFROM feature f\nINNER JOIN target_oids t ON f.oid = t.oid\nWHERE f.name IN ('Amplitude', 'Multiband_period');", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5003, "input_tokens": 185, "output_tokens": 203, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "1-2", "response": "/* First get candidate AGN objects with high probability */\nWITH agn_candidates AS (\n    SELECT oid \n    FROM probability \n    WHERE class_name = 'AGN' \n    AND classifier_name = 'lc_classifier'\n    AND probability > 0.6 \n    AND ranking = 1\n),\n/* Get objects with sufficient time coverage and detections */\nvalid_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    JOIN agn_candidates a ON o.oid = a.oid\n    WHERE o.deltajd >= 365  /* at least one year coverage */\n    AND o.ndet >= 20\n),\n/* Get magnitude variations per band from features */\nmag_variations AS (\n    SELECT f.oid, f.name, f.value, f.fid AS feature_fid, f.version\n    FROM feature f\n    JOIN valid_objects v ON f.oid = v.oid\n    WHERE f.name IN ('delta_mag_fid')\n    AND ((f.fid = 1 AND f.value > 1.0) OR  /* g-band variation > 1.0 */\n         (f.fid = 2 AND f.value > 0.5))    /* r-band variation > 0.5 */\n)\nSELECT DISTINCT \n    v.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.feature_fid,\n    v.meanra,\n    v.meandec,\n    v.ndet\nFROM valid_objects v\nJOIN mag_variations f ON v.oid = f.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 6472, "cache_read_input_tokens": 0, "input_tokens": 196, "output_tokens": 411, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 6472, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "1-3", "response": "/* First get candidate AGN objects with high probability */\nWITH agn_candidates AS (\n    SELECT oid \n    FROM probability \n    WHERE class_name = 'AGN' \n    AND classifier_name = 'lc_classifier'\n    AND probability > 0.6 \n    AND ranking = 1\n),\n/* Get objects with sufficient time coverage and detections */\nvalid_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    JOIN agn_candidates a ON o.oid = a.oid\n    WHERE o.deltajd >= 365  /* at least one year coverage */\n    AND o.ndet >= 20\n),\n/* Get magnitude variations per band from features */\nmag_variations AS (\n    SELECT f.oid, f.name, f.value, f.fid AS feature_fid, f.version\n    FROM feature f\n    JOIN valid_objects v ON f.oid = v.oid\n    WHERE f.name IN ('delta_mag_fid')\n    AND ((f.fid = 1 AND f.value > 1.0) OR  /* g-band variation > 1.0 */\n         (f.fid = 2 AND f.value > 0.5))     /* r-band variation > 0.5 */\n)\nSELECT DISTINCT \n    v.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.feature_fid,\n    v.meanra,\n    v.meandec,\n    v.ndet\nFROM valid_objects v\nJOIN mag_variations f ON v.oid = f.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 6472, "cache_read_input_tokens": 0, "input_tokens": 196, "output_tokens": 411, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 6472, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "1-4", "response": "/* First get AGN objects with prob > 0.6 */\nWITH agn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.6\n),\n/* Get objects with >1yr coverage and >20 dets */\nvalid_objects AS (\n    SELECT o.oid, o.meanra, o.meandec, o.ndet\n    FROM object o\n    JOIN agn_objects a ON a.oid = o.oid\n    WHERE o.deltajd >= 365\n    AND o.ndet >= 20\n),\n/* Get max-min magnitudes per band using corrected mags */\nmag_stats AS (\n    SELECT \n        d.oid,\n        d.fid as detection_fid,\n        MAX(d.magpsf_corr) - MIN(d.magpsf_corr) as delta_mag,\n        MAX(d.magpsf_corr) as max_mag,\n        MIN(d.magpsf_corr) as min_mag\n    FROM detection d\n    WHERE d.corrected = true\n    GROUP BY d.oid, d.fid\n)\n/* Main query combining all conditions */\nSELECT \n    v.oid,\n    f.value,\n    f.name,\n    f.version,\n    f.fid as feature_fid,\n    v.meanra,\n    v.meandec,\n    v.ndet,\n    m.max_mag,\n    m.min_mag,\n    m.delta_mag\nFROM valid_objects v\nJOIN feature f ON f.oid = v.oid\nJOIN mag_stats m ON m.oid = v.oid\nWHERE EXISTS (\n    SELECT 1 FROM mag_stats m2 \n    WHERE m2.oid = v.oid \n    AND m2.detection_fid = 1 \n    AND m2.delta_mag > 1.0\n)\nAND EXISTS (\n    SELECT 1 FROM mag_stats m3 \n    WHERE m3.oid = v.oid \n    AND m3.detection_fid = 2 \n    AND m3.delta_mag > 0.5\n);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 6472, "input_tokens": 196, "output_tokens": 564, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "16-2", "response": "/* First get the OIDs that meet the criteria */\nWITH sn_candidates AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n), first_det_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n), fast_risers AS (\n    SELECT m.oid\n    FROM magstat m\n    WHERE m.dmdt_first >= 0.25\n)\n/* Main query combining all conditions and retrieving requested data */\nSELECT \n    s.oid,\n    s.probability,\n    m.fid AS magstat_fid,\n    m.dmdt_first,\n    n.fid,\n    n.mjd,\n    n.diffmaglim\nFROM sn_candidates s\nINNER JOIN first_det_objects f ON s.oid = f.oid\nINNER JOIN fast_risers r ON s.oid = r.oid\nLEFT JOIN magstat m ON s.oid = m.oid\nLEFT JOIN non_detection n ON s.oid = n.oid\nORDER BY s.oid\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3999, "input_tokens": 238, "output_tokens": 323, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "16-3", "response": "/* First get the OIDs that meet the criteria */\nWITH sn_objects AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n), first_det_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n), fast_risers AS (\n    SELECT m.oid, m.fid, m.dmdt_first\n    FROM magstat m\n    WHERE m.dmdt_first >= 0.25\n)\n/* Main query combining all conditions and retrieving required data */\nSELECT \n    s.oid,\n    s.probability,\n    m.fid AS magstat_fid,\n    m.dmdt_first,\n    n.fid,\n    n.mjd,\n    n.diffmaglim\nFROM sn_objects s\nINNER JOIN first_det_objects f ON s.oid = f.oid\nINNER JOIN fast_risers fr ON s.oid = fr.oid\nLEFT JOIN magstat m ON s.oid = m.oid\nLEFT JOIN non_detection n ON s.oid = n.oid\nORDER BY s.oid\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3999, "cache_read_input_tokens": 0, "input_tokens": 238, "output_tokens": 335, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3999, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "16-4", "response": "/* First get the OIDs that meet the criteria */\nWITH sn_objects AS (\n    SELECT p.oid, p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'SN'\n        AND p.ranking = 1\n), first_det_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n), fast_risers AS (\n    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first\n    FROM magstat m\n    WHERE m.dmdt_first >= 0.25\n)\n/* Main query combining all conditions and retrieving required data */\nSELECT \n    s.oid,\n    s.probability,\n    m.magstat_fid,\n    m.dmdt_first,\n    n.fid,\n    n.mjd,\n    n.diffmaglim\nFROM sn_objects s\nINNER JOIN first_det_objects f ON s.oid = f.oid\nINNER JOIN fast_risers m ON s.oid = m.oid\nLEFT JOIN non_detection n ON s.oid = n.oid\nORDER BY s.oid\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3999, "cache_read_input_tokens": 0, "input_tokens": 238, "output_tokens": 322, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3999, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "19-2", "response": "/* Get objects with first detection between March 1st and April 1st 2021 */\n/* Join with probability table to get asteroid classifications from stamp classifier */\n/* Filter for single detections and high probability asteroids */\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.firstmjd BETWEEN 59274.0 AND 59305.0\n    AND o.ndet <= 1\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'asteroid'\n    AND p.probability > 0.7;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3027, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 197, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3027, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "19-3", "response": "/* Get objects with first detection between March 1st and April 1st 2021 */\n/* Join with probability table to get asteroid classifications from stamp classifier */\n/* Filter for single detections and high probability asteroids */\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.firstmjd BETWEEN 59274.0 AND 59305.0\n    AND o.ndet <= 1\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'asteroid'\n    AND p.probability > 0.7;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3027, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 197, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3027, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "19-4", "response": "/* Get objects with first detection between March 1st and April 1st 2021 */\n/* Join with probability table to get asteroid classifications from stamp classifier */\n/* Filter for single detections and high probability asteroids */\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    p.class_name,\n    p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE o.firstmjd BETWEEN 59274.0 AND 59305.0\n    AND o.ndet <= 1\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.class_name = 'asteroid'\n    AND p.probability > 0.7;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3027, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 197, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3027, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "14-2", "response": "/* First create a temporary table with the list of oids */\nWITH oid_list (oid) AS (\n    VALUES ('ZTF23aavzgjg'), ('ZTF23aaynzyk'), ('ZTF23aavqxos'), ('ZTF23aaknyni'),\n           ('ZTF23aavsdtc'), ('ZTF18aandkua'), ('ZTF23aaxfewt'), ('ZTF23aavshwi'),\n           ('ZTF22aawasao'), ('ZTF23aaxgvnt')\n)\nSELECT DISTINCT \n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    d.has_stamp,\n    d.drb,\n    p.sgscore1,\n    p.distpsnr1\nFROM oid_list o\nINNER JOIN detection d ON d.oid = o.oid\nINNER JOIN ps1_ztf p ON p.candid = d.candid\nWHERE d.drb > 0.5 \n    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)\nORDER BY d.oid, d.candid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3731, "cache_read_input_tokens": 0, "input_tokens": 266, "output_tokens": 331, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3731, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "14-3", "response": "/* First create a temporary table with the list of oids */\nWITH oids(oid) AS (\n    VALUES ('ZTF23aavzgjg'), ('ZTF23aaynzyk'), ('ZTF23aavqxos'), ('ZTF23aaknyni'),\n           ('ZTF23aavsdtc'), ('ZTF18aandkua'), ('ZTF23aaxfewt'), ('ZTF23aavshwi'),\n           ('ZTF22aawasao'), ('ZTF23aaxgvnt')\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    d.has_stamp,\n    d.drb,\n    ps.sgscore1,\n    ps.distpsnr1\nFROM oids o\nINNER JOIN detection d ON o.oid = d.oid\nINNER JOIN ps1_ztf ps ON d.oid = ps.oid AND d.candid = ps.candid\nWHERE d.drb > 0.5 \nAND (ps.sgscore1 < 0.5 OR ps.distpsnr1 < 1);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3731, "cache_read_input_tokens": 0, "input_tokens": 266, "output_tokens": 321, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3731, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "14-4", "response": "/* First create a temporary table with the list of oids */\nWITH oid_list (oid) AS (\n    VALUES ('ZTF23aavzgjg'), ('ZTF23aaynzyk'), ('ZTF23aavqxos'), ('ZTF23aaknyni'),\n           ('ZTF23aavsdtc'), ('ZTF18aandkua'), ('ZTF23aaxfewt'), ('ZTF23aavshwi'),\n           ('ZTF22aawasao'), ('ZTF23aaxgvnt')\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    d.has_stamp,\n    d.drb,\n    ps.sgscore1,\n    ps.distpsnr1\nFROM oid_list ol\nJOIN detection d ON d.oid = ol.oid\nJOIN ps1_ztf ps ON ps.candid = d.candid\nWHERE d.drb > 0.5 \nAND (ps.sgscore1 < 0.5 OR ps.distpsnr1 < 1)\nORDER BY d.oid, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3731, "cache_read_input_tokens": 0, "input_tokens": 266, "output_tokens": 324, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3731, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "30-2", "response": "/* Get predicted class (ranking=1) for each object using lc_classifier */\nWITH top_predictions AS (\n    SELECT \n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n)\nSELECT * FROM top_predictions;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3027, "input_tokens": 73, "output_tokens": 92, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "30-3", "response": "/* Get predicted class (ranking=1) for each object using lc_classifier */\nWITH top_predictions AS (\n    SELECT \n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n)\nSELECT * FROM top_predictions;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3027, "cache_read_input_tokens": 0, "input_tokens": 73, "output_tokens": 92, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3027, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "30-4", "response": "/* Get predicted class (ranking=1) for each object using lc_classifier */\nWITH top_predictions AS (\n    SELECT \n        p.oid,\n        p.class_name,\n        p.probability\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.ranking = 1\n)\nSELECT * FROM top_predictions;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3027, "input_tokens": 73, "output_tokens": 92, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "22-2", "response": "/* Get objects with first detection between June 1st and July 1st 2018 */\n/* Join with probability table to get only objects classified by lc_classifier */\n/* Use ranking = 1 to get the most probable class for each object */\nWITH classified_objects AS (\n    SELECT DISTINCT oid \n    FROM probability \n    WHERE classifier_name = 'lc_classifier' \n    AND ranking = 1\n)\nSELECT o.* \nFROM object o\nINNER JOIN classified_objects c ON o.oid = c.oid\nWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2974, "input_tokens": 96, "output_tokens": 154, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "22-3", "response": "/* Get objects with first detection between June 1st and July 1st 2018 */\n/* Join with probability table to get only objects classified by lc_classifier */\n/* Use ranking = 1 to get the most probable class for each object */\nWITH classified_objects AS (\n    SELECT DISTINCT oid \n    FROM probability \n    WHERE classifier_name = 'lc_classifier' \n    AND ranking = 1\n)\nSELECT o.* \nFROM object o\nINNER JOIN classified_objects c ON o.oid = c.oid\nWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2974, "cache_read_input_tokens": 0, "input_tokens": 96, "output_tokens": 154, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2974, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "22-4", "response": "/* Get objects with first detection between June 1st and July 1st 2018 */\n/* Join with probability table to get only objects classified by lc_classifier */\n/* Use ranking = 1 to get the most probable class for each object */\nWITH classified_objects AS (\n    SELECT DISTINCT oid \n    FROM probability \n    WHERE classifier_name = 'lc_classifier' \n    AND ranking = 1\n)\nSELECT o.* \nFROM object o\nINNER JOIN classified_objects c ON o.oid = c.oid\nWHERE o.firstmjd BETWEEN 58239.0 AND 58270.0;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2974, "input_tokens": 96, "output_tokens": 154, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "12-2", "response": "WITH sne_candidates AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND ranking = 1\n)\nSELECT o.oid, o.meanra, o.meandec\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sne_candidates)\nAND o.firstmjd BETWEEN 59988.0 AND 60197.0\nAND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2752, "input_tokens": 144, "output_tokens": 184, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "12-3", "response": "WITH sne_candidates AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND ranking = 1\n)\nSELECT \n    o.oid,\n    o.meanra,\n    o.meandec\nFROM object o\nWHERE o.oid IN (SELECT oid FROM sne_candidates)\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0  -- between Feb 13 and Sep 10\n    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)\n;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2752, "input_tokens": 144, "output_tokens": 206, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "12-4", "response": "/* Get SNe objects within time range and polygon */\nWITH sne_candidates AS (\n    SELECT DISTINCT o.oid\n    FROM object o\n    WHERE EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n        AND p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    )\n    AND o.firstmjd BETWEEN 59988.0 AND 60197.0\n)\nSELECT o.oid, o.meanra, o.meandec\nFROM object o\nINNER JOIN sne_candidates s ON s.oid = o.oid\nWHERE q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2752, "cache_read_input_tokens": 0, "input_tokens": 144, "output_tokens": 240, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2752, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "57-2", "response": "WITH catalog (source_id, ra, dec, radius) AS (\n    VALUES \n        ('id_1', 354.67, 15.954, 30.0/3600.0),  -- 30 arcsec converted to degrees\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0)  -- 20 arcsec converted to degrees\n)\nSELECT \n    c.source_id AS input_id,\n    c.ra AS input_ra,\n    c.dec AS input_dec,\n    c.radius AS search_radius,\n    o.oid AS ztf_id,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c\nCROSS JOIN object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius)\nORDER BY o.lastmjd DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2752, "cache_read_input_tokens": 0, "input_tokens": 187, "output_tokens": 245, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2752, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "57-3", "response": "WITH catalog (source_id, ra, dec, radius) AS (\n    VALUES \n        ('id_1', 354.67, 15.954, 30.0/3600.0),  -- 30 arcsec converted to degrees\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0)  -- 20 arcsec converted to degrees\n)\nSELECT \n    c.source_id AS input_id,\n    c.ra AS input_ra,\n    c.dec AS input_dec,\n    c.radius AS search_radius,\n    o.oid AS ztf_id,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c\nCROSS JOIN object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius)\nORDER BY o.lastmjd DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2752, "input_tokens": 187, "output_tokens": 245, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "57-4", "response": "WITH catalog (source_id, ra, dec, radius) AS (\n    VALUES \n        ('id_1', 354.67, 15.954, 30.0/3600.0),  -- 30 arcsec converted to degrees\n        ('id_2', 20.7993, 1.00331, 20.0/3600.0)  -- 20 arcsec converted to degrees\n)\nSELECT \n    c.source_id AS input_id,\n    c.ra AS input_ra,\n    c.dec AS input_dec,\n    c.radius AS search_radius,\n    o.oid AS ztf_id,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd\nFROM catalog c\nCROSS JOIN object o\nWHERE q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.radius)\nORDER BY o.lastmjd DESC;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2752, "cache_read_input_tokens": 0, "input_tokens": 187, "output_tokens": 245, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2752, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "75-2", "response": "/* Get rows where ssnamenr is not 'null' (VARCHAR) and limit to 100 results */\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr != 'null'\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2356, "cache_read_input_tokens": 0, "input_tokens": 61, "output_tokens": 55, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2356, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "75-3", "response": "/* Get rows where ssnamenr is not 'null' (VARCHAR) and limit to 100 results */\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr != 'null'\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2356, "cache_read_input_tokens": 0, "input_tokens": 61, "output_tokens": 55, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2356, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "75-4", "response": "/* Get rows where ssnamenr is not 'null' (VARCHAR) and limit to 100 results */\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr != 'null'\nLIMIT 100;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2356, "input_tokens": 61, "output_tokens": 55, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "43-2", "response": "/* Get r-band (fid=2) data quality metrics for specified objects */\nWITH target_objects (oid) AS (\n    VALUES \n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT \n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_objects)\n    AND dq.fid = 2  /* r-band filter */\nORDER BY dq.oid, dq.candid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3096, "cache_read_input_tokens": 0, "input_tokens": 108, "output_tokens": 162, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3096, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "43-3", "response": "/* Query to get r-band epochs from dataquality table for specific objects */\nWITH target_objects (oid) AS (\n    VALUES \n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT \n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nINNER JOIN target_objects t ON dq.oid = t.oid\nWHERE dq.fid = 2  /* fid=2 corresponds to r-band */\nORDER BY dq.oid, dq.candid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3096, "input_tokens": 108, "output_tokens": 168, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "43-4", "response": "/* Get r-band (fid=2) data quality metrics for specified objects */\nWITH target_objects (oid) AS (\n    VALUES \n        ('ZTF20acwrybw'),\n        ('ZTF22abugigx')\n)\nSELECT \n    dq.oid,\n    dq.candid,\n    dq.xpos,\n    dq.ypos,\n    dq.scorr\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM target_objects)\n    AND dq.fid = 2  /* r-band filter */\nORDER BY dq.oid, dq.candid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3096, "cache_read_input_tokens": 0, "input_tokens": 108, "output_tokens": 162, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3096, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "89-2", "response": "/* Get objects classified as supernovae by stamp_classifier with prob > 0.7 */\nWITH snobj AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND class_name = 'SN'\n    AND probability > 0.7\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM snobj);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3318, "cache_read_input_tokens": 0, "input_tokens": 78, "output_tokens": 111, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3318, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "89-3", "response": "/* Get objects classified as supernovae by stamp_classifier with prob > 0.7 */\nWITH snobj AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND class_name = 'SN'\n    AND probability > 0.7\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM snobj);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3318, "input_tokens": 78, "output_tokens": 111, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "89-4", "response": "/* Get objects classified as supernovae by stamp_classifier with prob > 0.7 */\nWITH snobj AS (\n    SELECT DISTINCT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND class_name = 'SN'\n    AND probability > 0.7\n    LIMIT 50\n)\nSELECT dq.*\nFROM dataquality dq\nWHERE dq.oid IN (SELECT oid FROM snobj);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3318, "input_tokens": 78, "output_tokens": 111, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "72-2", "response": "/* Query to get all reference table columns for a specific object and reference ID */\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\nAND rfid = 712120223;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2591, "cache_read_input_tokens": 0, "input_tokens": 66, "output_tokens": 50, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2591, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "72-3", "response": "/* Query to get all reference table columns for a specific object and reference ID */\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\nAND rfid = 712120223;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2591, "cache_read_input_tokens": 0, "input_tokens": 66, "output_tokens": 50, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2591, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "72-4", "response": "/* Query to get all reference table columns for a specific object and reference ID */\nSELECT *\nFROM reference\nWHERE oid = 'ZTF20actnuls'\nAND rfid = 712120223;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2591, "cache_read_input_tokens": 0, "input_tokens": 66, "output_tokens": 50, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2591, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "103-2", "response": "/* Get objects with PS1 distance > 5\" and high non-SN probability */\nWITH candidate_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n        AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nSELECT o.*, pr.*, ps.*\nFROM candidate_oids c\nJOIN object o ON o.oid = c.oid\nJOIN probability pr ON pr.oid = c.oid\n    AND pr.classifier_name = 'lc_classifier'\n    AND pr.ranking = 1\nJOIN ps1_ztf ps ON ps.oid = c.oid\nWHERE ps.distpsnr1 > 5\nORDER BY ps.distpsnr1\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3890, "cache_read_input_tokens": 0, "input_tokens": 135, "output_tokens": 235, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3890, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "103-3", "response": "/* Get objects with PS1 distance > 5\" and high non-SN probability */\nWITH candidate_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n        AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nSELECT o.*, pr.*, ps.*\nFROM candidate_oids c\nJOIN object o ON o.oid = c.oid\nJOIN probability pr ON pr.oid = c.oid\nJOIN ps1_ztf ps ON ps.oid = c.oid\nWHERE ps.distpsnr1 > 5\n    AND pr.classifier_name = 'lc_classifier'\n    AND pr.ranking = 1\nORDER BY ps.distpsnr1 DESC\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3890, "cache_read_input_tokens": 0, "input_tokens": 135, "output_tokens": 237, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3890, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "103-4", "response": "/* Get objects with PS1 distance > 5\" and high non-SN probability */\nWITH candidate_oids AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n        AND p.ranking = 1\n        AND p.probability > 0.7\n        AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n)\nSELECT o.*, pr.*, ps.*\nFROM candidate_oids c\nJOIN object o ON o.oid = c.oid\nJOIN probability pr ON pr.oid = c.oid\nJOIN ps1_ztf ps ON ps.oid = c.oid\nWHERE ps.distpsnr1 > 5\n    AND pr.classifier_name = 'lc_classifier'\n    AND pr.ranking = 1\nORDER BY ps.distpsnr1 DESC\nLIMIT 200;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3890, "cache_read_input_tokens": 0, "input_tokens": 135, "output_tokens": 237, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3890, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "54-2", "response": "/* Get all non-detections for specified objects where diffmaglim > 19.5 */\nWITH catalog (oid) AS (\n    VALUES \n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT nd.*\nFROM non_detection nd\nINNER JOIN catalog c ON nd.oid = c.oid\nWHERE nd.diffmaglim > 19.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2308, "cache_read_input_tokens": 0, "input_tokens": 112, "output_tokens": 105, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2308, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "54-3", "response": "/* Get all non-detections for specified objects where diffmaglim > 19.5 */\nWITH catalog (oid) AS (\n    VALUES ('ZTF23abtcveg'),\n           ('ZTF23abudlls')\n)\nSELECT nd.*\nFROM non_detection nd\nWHERE nd.oid IN (SELECT oid FROM catalog)\nAND nd.diffmaglim > 19.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2308, "input_tokens": 112, "output_tokens": 100, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "54-4", "response": "/* Get all non-detections for specified objects where diffmaglim > 19.5 */\nWITH catalog (oid) AS (\n    VALUES \n        ('ZTF23abtcveg'),\n        ('ZTF23abudlls')\n)\nSELECT nd.*\nFROM non_detection nd\nINNER JOIN catalog c ON nd.oid = c.oid\nWHERE nd.diffmaglim > 19.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2308, "input_tokens": 112, "output_tokens": 105, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "99-2", "response": "/* Get objects with first detection after mjd=60310 and probability=1 of being asteroid */\nWITH asteroid_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n    )\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT oid\n    FROM asteroid_objects\n)\nORDER BY fp.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3788, "input_tokens": 99, "output_tokens": 172, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "99-3", "response": "/* Get objects with first detection after mjd=60310 and probability=1 of being asteroid */\nWITH asteroid_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n    )\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT oid\n    FROM asteroid_objects\n)\nORDER BY fp.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3788, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 172, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3788, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "99-4", "response": "/* Get objects with first detection after mjd=60310 and probability=1 of being asteroid */\nWITH asteroid_objects AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.firstmjd > 60310\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name = 'asteroid'\n        AND p.probability = 1\n    )\n    LIMIT 10\n)\nSELECT fp.*\nFROM forced_photometry fp\nWHERE fp.oid IN (\n    SELECT oid\n    FROM asteroid_objects\n)\nORDER BY fp.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3788, "input_tokens": 99, "output_tokens": 172, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "40-2", "response": "/* Using Q3C radial_query for efficient cone search around given coordinates */\n/* Converting 1 arcsec to degrees: 1/3600 = 0.000277778 degrees */\nSELECT \n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w2mpro,\n    w1sigmpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 0.000277778);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2976, "cache_read_input_tokens": 0, "input_tokens": 115, "output_tokens": 152, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2976, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "40-3", "response": "/* Using Q3C radial_query for efficient cone search around given coordinates */\n/* Converting 1 arcsec to degrees: 1/3600 = 0.000277778 degrees */\nSELECT \n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w2mpro,\n    w1sigmpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 0.000277778);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2976, "cache_read_input_tokens": 0, "input_tokens": 115, "output_tokens": 152, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2976, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "40-4", "response": "/* Using Q3C radial_query for efficient cone search around given coordinates */\n/* Converting 1 arcsec to degrees: 1/3600 = 0.000277778 degrees */\nSELECT \n    oid_catalog,\n    ra,\n    dec,\n    w1mpro,\n    w2mpro,\n    w1sigmpro,\n    w2sigmpro,\n    j_m_2mass,\n    j_msig_2mass\nFROM allwise\nWHERE q3c_radial_query(ra, dec, 23.6488, 30.7314, 0.000277778);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2976, "cache_read_input_tokens": 0, "input_tokens": 115, "output_tokens": 152, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2976, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "80-2", "response": "/* Using WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF22abcmmkz'),\n           ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM ztf_objects)\nAND x.dist < 0.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2298, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 95, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2298, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "80-3", "response": "/* Using a WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF22abcmmkz'),\n           ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM ztf_objects)\nAND x.dist < 0.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2298, "cache_read_input_tokens": 0, "input_tokens": 105, "output_tokens": 96, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2298, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "80-4", "response": "/* Using a WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF22abcmmkz'),\n           ('ZTF18abbufof')\n)\nSELECT *\nFROM xmatch x\nWHERE x.oid IN (SELECT oid FROM ztf_objects)\nAND x.dist < 0.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2298, "input_tokens": 105, "output_tokens": 96, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "45-2", "response": "/* Count rows in dataquality where chipsf >= 5 for specific ZTF objects */\nWITH target_objects(oid) AS (\n    VALUES \n        ('ZTF23abjikaf'),\n        ('ZTF20achlced')\n)\nSELECT COUNT(*)\nFROM dataquality d\nWHERE d.oid IN (SELECT oid FROM target_objects)\nAND d.chipsf >= 5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3096, "input_tokens": 86, "output_tokens": 103, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "45-3", "response": "/* Count rows in dataquality where chipsf >= 5 for specific ZTF objects */\nWITH target_objects(oid) AS (\n    VALUES \n        ('ZTF23abjikaf'),\n        ('ZTF20achlced')\n)\nSELECT COUNT(*)\nFROM dataquality d\nWHERE d.oid IN (SELECT oid FROM target_objects)\nAND d.chipsf >= 5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3096, "cache_read_input_tokens": 0, "input_tokens": 86, "output_tokens": 103, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3096, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "45-4", "response": "/* Count rows in dataquality where chipsf >= 5 for specific ZTF objects */\nWITH target_objects(oid) AS (\n    VALUES \n        ('ZTF23abjikaf'),\n        ('ZTF20achlced')\n)\nSELECT COUNT(*)\nFROM dataquality d\nWHERE d.oid IN (SELECT oid FROM target_objects)\nAND d.chipsf >= 5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3096, "cache_read_input_tokens": 0, "input_tokens": 86, "output_tokens": 103, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3096, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "63-2", "response": "/* Get all rows from probability table for specified objects and lc_classifier */\n/* Only ranking 1 and 2, sorted by ranking */\nWITH oids AS (\n    SELECT unnest(ARRAY['ZTF21aaobkmg', 'ZTF21aaomuka']) as oid\n)\nSELECT *\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM oids)\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking IN (1, 2)\nORDER BY p.ranking;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2382, "input_tokens": 97, "output_tokens": 133, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "63-3", "response": "/* Get all rows from probability table for specified objects and lc_classifier */\n/* Only ranking 1 and 2, sorted by ranking */\nWITH oids AS (\n    SELECT unnest(ARRAY['ZTF21aaobkmg', 'ZTF21aaomuka']) as oid\n)\nSELECT *\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM oids)\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking IN (1, 2)\nORDER BY p.ranking;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2382, "cache_read_input_tokens": 0, "input_tokens": 97, "output_tokens": 133, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2382, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "63-4", "response": "/* Get all rows from probability table for specified objects and lc_classifier */\n/* Only ranking 1 and 2 are selected and results are sorted by ranking */\nWITH oids AS (\n    SELECT unnest(ARRAY['ZTF21aaobkmg', 'ZTF21aaomuka']) AS oid\n)\nSELECT *\nFROM probability p\nWHERE p.oid IN (SELECT oid FROM oids)\n    AND p.classifier_name = 'lc_classifier'\n    AND p.ranking IN (1, 2)\nORDER BY p.ranking;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2382, "input_tokens": 97, "output_tokens": 138, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "73-2", "response": "/* Query to get Solar System object information for ZTF21acitntz */\nSELECT \n    oid,\n    ssnamenr,  /* MPC name of nearest Solar System object */\n    ssmagnr    /* MPC magnitude of nearest Solar System object */\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2948, "cache_read_input_tokens": 0, "input_tokens": 84, "output_tokens": 87, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2948, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "73-3", "response": "/* Query to get Solar System object information for ZTF21acitntz */\nSELECT \n    o.oid,\n    s.ssnamenr AS mpc_name,\n    s.ssmagnr AS mpc_magnitude\nFROM object o\nINNER JOIN ss_ztf s ON o.oid = s.oid\nWHERE o.oid = 'ZTF21acitntz';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2948, "input_tokens": 84, "output_tokens": 100, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "73-4", "response": "/* Query to get Solar System object information for ZTF21acitntz */\nSELECT \n    oid,\n    ssnamenr,  /* MPC name of nearest Solar System object */\n    ssmagnr    /* MPC magnitude of nearest Solar System object */\nFROM ss_ztf\nWHERE oid = 'ZTF21acitntz';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2948, "input_tokens": 84, "output_tokens": 87, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "92-2", "response": "/* Get objects with at least 10 g-band detections (fid=1) and no dubious corrections */\nWITH valid_objects AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    WHERE d.fid = 1\n    AND d.dubious = FALSE\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n)\n/* Join with probability table to get classification info */\nSELECT \n    o.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM valid_objects vo\nJOIN object o ON o.oid = vo.oid\nJOIN probability p ON p.oid = o.oid\nWHERE p.ranking = 1\nAND p.classifier_name = 'lc_classifier'\nORDER BY o.oid\nLIMIT 500;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3682, "cache_read_input_tokens": 0, "input_tokens": 109, "output_tokens": 201, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3682, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "92-3", "response": "/* Get objects with at least 10 g-band detections (fid=1) and no dubious corrections */\nWITH valid_objects AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    WHERE d.fid = 1 \n    AND d.dubious = FALSE\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n)\n/* Join with probability table to get classification info */\nSELECT \n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nINNER JOIN valid_objects v ON p.oid = v.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking = 1\nORDER BY p.oid\nLIMIT 500;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3682, "input_tokens": 109, "output_tokens": 190, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "92-4", "response": "/* Get objects with at least 10 g-band detections (fid=1) and no dubious corrections */\nWITH valid_objects AS (\n    SELECT DISTINCT d.oid\n    FROM detection d\n    WHERE d.fid = 1\n    AND d.dubious = FALSE\n    GROUP BY d.oid\n    HAVING COUNT(*) >= 10\n)\n/* Join with probability table to get classification info */\nSELECT \n    p.oid,\n    p.classifier_version,\n    p.class_name,\n    p.probability\nFROM probability p\nINNER JOIN valid_objects v ON p.oid = v.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking = 1\nORDER BY p.oid\nLIMIT 500;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3682, "cache_read_input_tokens": 0, "input_tokens": 109, "output_tokens": 189, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3682, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "102-2", "response": "/* First get oids of objects classified as AGN with high probability */\nWITH agn_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier'\n    AND class_name = 'AGN'\n    AND probability > 0.6\n    AND ranking = 1\n),\n/* Then get oids that match WISE W1 magnitude criteria through xmatch */\nwise_objects AS (\n    SELECT DISTINCT a.oid_catalog\n    FROM allwise a\n    WHERE a.w1mpro BETWEEN 12 AND 13\n)\n/* Finally get all magstat information for matching objects */\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (\n    SELECT oid \n    FROM agn_objects\n)\nLIMIT 50;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4075, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 191, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 4075, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "102-3", "response": "/* First get oids of objects classified as AGN with prob > 0.6 */\nWITH agn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n),\n/* Then get oids of objects with WISE W1 mag between 12-13 via xmatch */\nwise_objects AS (\n    SELECT DISTINCT a.oid_catalog\n    FROM allwise a\n    WHERE a.w1mpro BETWEEN 12 AND 13\n)\n/* Finally get all magstat columns for objects satisfying both conditions */\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (\n    SELECT oid \n    FROM agn_objects\n)\nAND m.oid IN (\n    SELECT oid_catalog \n    FROM wise_objects\n)\nLIMIT 50;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4075, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 233, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 4075, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "102-4", "response": "/* First get oids of objects classified as AGN with prob > 0.6 */\nWITH agn_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'AGN'\n    AND p.probability > 0.6\n),\n/* Then get oids of objects with WISE W1 mag between 12-13 via xmatch */\nwise_objects AS (\n    SELECT DISTINCT a.oid_catalog\n    FROM allwise a\n    WHERE a.w1mpro BETWEEN 12 AND 13\n)\n/* Finally get all magstat columns for objects satisfying both conditions */\nSELECT m.*\nFROM magstat m\nWHERE m.oid IN (\n    SELECT oid \n    FROM agn_objects\n)\nAND m.oid IN (\n    SELECT oid_catalog \n    FROM wise_objects\n)\nLIMIT 50;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4075, "input_tokens": 99, "output_tokens": 233, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "81-2", "response": "/* Get xmatch info for ZTF object matched with ALLWISE catalog */\nSELECT \n    oid,\n    dist\nFROM xmatch\nWHERE catid = 'ALLWISE'\nAND oid_catalog = 'J163603.54-065228.7';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2298, "input_tokens": 90, "output_tokens": 68, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "81-3", "response": "/* Get xmatch info for ZTF object with ALLWISE match */\nSELECT \n    oid,  /* ZTF object identifier */\n    dist  /* Distance to catalog counterpart in arcsec */\nFROM xmatch \nWHERE catid = 'ALLWISE' \nAND oid_catalog = 'J163603.54-065228.7';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2298, "cache_read_input_tokens": 0, "input_tokens": 90, "output_tokens": 89, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2298, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "81-4", "response": "/* Get xmatch info for ZTF object matched with ALLWISE catalog */\nSELECT \n    oid,\n    dist\nFROM xmatch\nWHERE catid = 'ALLWISE'\nAND oid_catalog = 'J163603.54-065228.7';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2298, "cache_read_input_tokens": 0, "input_tokens": 90, "output_tokens": 68, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2298, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "69-2", "response": "/* Using a WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF21abstkhj'),\n           ('ZTF22aacqjeb'),\n           ('ZTF21aamwpdf')\n)\nSELECT *\nFROM ps1_ztf p\nWHERE p.oid IN (SELECT oid FROM ztf_objects)\nAND p.sgscore1 < 0.2;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3076, "input_tokens": 109, "output_tokens": 116, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "69-3", "response": "/* Using a WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF21abstkhj'),\n           ('ZTF22aacqjeb'),\n           ('ZTF21aamwpdf')\n)\nSELECT *\nFROM ps1_ztf p\nWHERE p.oid IN (SELECT oid FROM ztf_objects)\nAND p.sgscore1 < 0.2;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3076, "cache_read_input_tokens": 0, "input_tokens": 109, "output_tokens": 116, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3076, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "69-4", "response": "/* Using a WITH clause to define the set of ZTF objects */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF21abstkhj'),\n           ('ZTF22aacqjeb'),\n           ('ZTF21aamwpdf')\n)\nSELECT ps.*\nFROM ps1_ztf ps\nINNER JOIN ztf_objects z ON ps.oid = z.oid\nWHERE ps.sgscore1 < 0.2;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3076, "cache_read_input_tokens": 0, "input_tokens": 109, "output_tokens": 119, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3076, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "61-2", "response": "/* Find objects with ndet >= 10, magmedian > 19 (fainter), maglast < 17 (brighter) */\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n    AND magmedian > 19\n    AND maglast < 17\nORDER BY oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3037, "input_tokens": 99, "output_tokens": 79, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "61-3", "response": "/* Find objects with ndet >= 10, magmedian > 19 (fainter), maglast < 17 (brighter) */\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n    AND magmedian > 19\n    AND maglast < 17\nORDER BY oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3037, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 79, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3037, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "61-4", "response": "/* Find objects with ndet >= 10, magmedian > 19 (fainter), maglast < 17 (brighter) */\nSELECT *\nFROM magstat\nWHERE ndet >= 10\n    AND magmedian > 19\n    AND maglast < 17\nORDER BY oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3037, "cache_read_input_tokens": 0, "input_tokens": 99, "output_tokens": 79, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3037, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "104-2", "response": "-- ERROR: The requested columns related to candidates (filter, FWHM, PS1 calibrators, exposure time) \n-- are not available in the provided schema tables. Only the following tables are available:\n-- object: Contains basic object information\n-- probability: Contains classification probabilities\n-- ss_ztf: Contains Solar System object information\n-- The query below returns only the available columns from these tables\nSELECT s.oid, s.candid, s.ssdistnr, s.ssmagnr, s.ssnamenr\nFROM probability p\nINNER JOIN ss_ztf s ON p.oid = s.oid\nWHERE p.class_name = 'asteroid'\nAND p.classifier_name = 'stamp_classifier'\nAND p.classifier_version = 'stamp_classifier_1.0.4'\nAND p.probability > 0.9\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3170, "cache_read_input_tokens": 0, "input_tokens": 141, "output_tokens": 209, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3170, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "104-3", "response": "-- ERROR: The requested columns related to candidates (filter, FWHM, PS1 calibrators, exposure time) \n-- are not available in the provided schema tables. Only the following tables and columns are available:\n-- object: oid and basic statistics\n-- probability: classification probabilities\n-- ss_ztf: candid, ssdistnr, ssmagnr, ssnamenr\n\n-- Query using only available columns:\nWITH asteroid_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND classifier_version = 'stamp_classifier_1.0.4'\n    AND class_name = 'asteroid'\n    AND probability > 0.9\n)\nSELECT o.oid,\n       s.candid,\n       s.ssdistnr,\n       s.ssmagnr,\n       s.ssnamenr\nFROM asteroid_objects ao\nJOIN object o ON o.oid = ao.oid\nJOIN ss_ztf s ON s.oid = o.oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3170, "cache_read_input_tokens": 0, "input_tokens": 141, "output_tokens": 255, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3170, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "104-4", "response": "-- ERROR: The requested columns related to candidates (filter, FWHM, PS1 calibrators, exposure time) \n-- are not available in the provided schema tables\n-- Only returning the columns available in the schema\nWITH asteroid_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND classifier_version = 'stamp_classifier_1.0.4'\n    AND class_name = 'asteroid'\n    AND probability > 0.9\n    LIMIT 30\n)\nSELECT \n    o.oid,\n    s.candid,\n    s.ssdistnr,\n    s.ssmagnr,\n    s.ssnamenr\nFROM asteroid_objects ao\nJOIN object o ON o.oid = ao.oid\nLEFT JOIN ss_ztf s ON s.oid = o.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3170, "cache_read_input_tokens": 0, "input_tokens": 141, "output_tokens": 210, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3170, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "71-2", "response": "/* Get reference information for specific ZTF objects in g-band (fid=1) */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF20aczxeud'),\n           ('ZTF21aappfdu'),\n           ('ZTF22aacqjeb')\n)\nSELECT \n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nINNER JOIN ztf_objects z ON r.oid = z.oid\nWHERE r.fid = 1  /* g-band filter */\nORDER BY r.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2591, "input_tokens": 129, "output_tokens": 164, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "71-3", "response": "/* Get reference information for specific ZTF objects in g-band (fid=1) */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF20aczxeud'),\n           ('ZTF21aappfdu'),\n           ('ZTF22aacqjeb')\n)\nSELECT \n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nINNER JOIN ztf_objects z ON r.oid = z.oid\nWHERE r.fid = 1  /* g-band filter */\nORDER BY r.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2591, "cache_read_input_tokens": 0, "input_tokens": 129, "output_tokens": 164, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2591, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "71-4", "response": "/* Get reference information for specific ZTF objects in g-band (fid=1) */\nWITH ztf_objects (oid) AS (\n    VALUES ('ZTF20aczxeud'),\n           ('ZTF21aappfdu'),\n           ('ZTF22aacqjeb')\n)\nSELECT \n    r.rfid,\n    r.oid,\n    r.candid,\n    r.magnr,\n    r.sigmagnr\nFROM reference r\nINNER JOIN ztf_objects z ON r.oid = z.oid\nWHERE r.fid = 1  /* g-band filter */\nORDER BY r.oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2591, "cache_read_input_tokens": 0, "input_tokens": 129, "output_tokens": 164, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2591, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "42-2", "response": "/* Get quality metrics for ZTF21aapnixl, sorted by chi-square fit */\nSELECT \n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3096, "input_tokens": 120, "output_tokens": 113, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "42-3", "response": "/* Get quality metrics for ZTF21aapnixl, sorted by chi-square fit */\nSELECT \n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3096, "input_tokens": 120, "output_tokens": 113, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "42-4", "response": "/* Get quality metrics for ZTF21aapnixl, sorted by chi-square fit */\nSELECT \n    oid,\n    candid,\n    fid,\n    chipsf,\n    fwhm,\n    classtar,\n    nbad,\n    magzpsci,\n    magzpsciunc,\n    exptime\nFROM dataquality\nWHERE oid = 'ZTF21aapnixl'\nORDER BY chipsf;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3096, "cache_read_input_tokens": 0, "input_tokens": 120, "output_tokens": 113, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3096, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "107-2", "response": "/* First get OIDs that match the criteria */\nWITH selected_oids AS (\n    SELECT o.oid\n    FROM object o\n    WHERE o.ndet > 500\n    AND EXISTS (\n        SELECT 1\n        FROM probability p\n        WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.classifier_version = 'stamp_classifier_1.0.4'\n        AND p.class_name = 'asteroid'\n        AND p.probability > 0.5\n    )\n    AND EXISTS (\n        SELECT 1\n        FROM ss_ztf s\n        WHERE s.oid = o.oid\n        AND s.ssdistnr < 2\n    )\n)\n/* Main query using the selected OIDs */\nSELECT \n    o.oid AS ztf_id,\n    o.ndet,\n    o.firstmjd,\n    o.lastmjd,\n    p.probability,\n    s.candid,\n    s.ssdistnr,\n    s.ssnamenr,\n    d.mjd,\n    d.fid\nFROM selected_oids so\nJOIN object o ON o.oid = so.oid\nJOIN probability p ON p.oid = o.oid\nJOIN ss_ztf s ON s.oid = o.oid\nJOIN detection d ON d.oid = o.oid\nWHERE p.classifier_name = 'stamp_classifier'\nAND p.classifier_version = 'stamp_classifier_1.0.4'\nAND p.class_name = 'asteroid'\nORDER BY o.firstmjd\nLIMIT 10;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3825, "input_tokens": 160, "output_tokens": 408, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "107-3", "response": "/* First get objects with >500 detections and high asteroid probability */\nWITH asteroid_candidates AS (\n    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    WHERE o.ndet > 500\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'asteroid'\n    AND p.probability > 0.5\n),\n/* Get the first detection for each object to get candid */\nfirst_detection AS (\n    SELECT d.oid, MIN(d.candid) as first_candid\n    FROM detection d\n    INNER JOIN asteroid_candidates ac ON d.oid = ac.oid\n    GROUP BY d.oid\n)\n/* Join with ss_ztf to get solar system object info */\nSELECT \n    ac.oid as ztf_id,\n    ac.ndet as detections,\n    ac.firstmjd as first_detection_date,\n    ac.lastmjd as last_detection_date,\n    ac.probability as asteroid_probability,\n    fd.first_candid as candidate_id,\n    ss.ssdistnr as distance_to_mpc,\n    ss.ssnamenr as mpc_name,\n    d.mjd as detection_date,\n    d.fid as filter_id\nFROM asteroid_candidates ac\nINNER JOIN first_detection fd ON ac.oid = fd.oid\nINNER JOIN ss_ztf ss ON ac.oid = ss.oid\nINNER JOIN detection d ON fd.first_candid = d.candid\nWHERE ss.ssdistnr < 2\nORDER BY ac.firstmjd\nLIMIT 10;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3825, "cache_read_input_tokens": 0, "input_tokens": 160, "output_tokens": 459, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3825, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "107-4", "response": "/* First get objects with >500 detections and high asteroid probability */\nWITH asteroid_objects AS (\n    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability\n    FROM object o\n    INNER JOIN probability p ON o.oid = p.oid\n    WHERE o.ndet > 500\n    AND p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = 'stamp_classifier_1.0.4'\n    AND p.class_name = 'asteroid'\n    AND p.probability > 0.5\n),\n/* Get the first detection for each object to get candid */\nfirst_detection AS (\n    SELECT d.oid, MIN(d.candid) as first_candid\n    FROM detection d\n    INNER JOIN asteroid_objects ao ON d.oid = ao.oid\n    GROUP BY d.oid\n)\n/* Join with ss_ztf to get solar system object info */\nSELECT \n    ao.oid,\n    ao.ndet,\n    ao.firstmjd,\n    ao.lastmjd,\n    ao.probability,\n    ss.candid,\n    ss.ssdistnr,\n    ss.ssnamenr,\n    d.mjd,\n    d.fid\nFROM asteroid_objects ao\nINNER JOIN first_detection fd ON ao.oid = fd.oid\nINNER JOIN ss_ztf ss ON ao.oid = ss.oid\nINNER JOIN detection d ON ss.candid = d.candid\nWHERE ss.ssdistnr < 2\nORDER BY ao.firstmjd\nLIMIT 10;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3825, "input_tokens": 160, "output_tokens": 406, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "83-2", "response": "/* First get the oid_catalog from xmatch table using the ZTF oid */\nWITH xmatch_oid AS (\n    SELECT a.* \n    FROM allwise a\n    INNER JOIN xmatch x ON x.oid_catalog = a.oid_catalog\n    INNER JOIN object o ON o.oid = x.oid\n    WHERE o.oid = 'ZTF21aazqwxv'\n)\nSELECT * FROM xmatch_oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3568, "cache_read_input_tokens": 0, "input_tokens": 61, "output_tokens": 121, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3568, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "83-3", "response": "/* First get the oid_catalog from xmatch table using the ZTF oid */\nWITH xmatch_oid AS (\n    SELECT a.* \n    FROM allwise a\n    INNER JOIN xmatch x ON x.oid_catalog = a.oid_catalog\n    INNER JOIN object o ON o.oid = x.oid\n    WHERE o.oid = 'ZTF21aazqwxv'\n)\nSELECT * FROM xmatch_oid;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3568, "input_tokens": 61, "output_tokens": 121, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "83-4", "response": "/* First get the oid_catalog from xmatch table using the ZTF oid */\nWITH matched_allwise AS (\n    SELECT a.*\n    FROM allwise a\n    WHERE a.oid_catalog = (\n        SELECT oid_catalog\n        FROM xmatch\n        WHERE oid = 'ZTF21aazqwxv'\n    )\n)\nSELECT *\nFROM matched_allwise;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3568, "input_tokens": 61, "output_tokens": 101, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "84-2", "response": "/* Get ALLWISE data for ZTF object ZTF19aascdol through xmatch table */\nWITH matched_allwise AS (\n    SELECT x.oid,\n           x.oid_catalog,\n           x.dist,\n           a.w1mpro,\n           a.w2mpro,\n           a.w3mpro,\n           a.w4mpro\n    FROM xmatch x\n    JOIN allwise a ON x.oid_catalog = a.oid_catalog\n    WHERE x.oid = 'ZTF19aascdol'\n    AND x.catid = 'ALLWISE'\n)\nSELECT * FROM matched_allwise;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3706, "cache_read_input_tokens": 0, "input_tokens": 112, "output_tokens": 165, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3706, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "84-3", "response": "/* Get ALLWISE data for ZTF object ZTF19aascdol through xmatch table */\nWITH matched_allwise AS (\n    SELECT x.oid,\n           x.oid_catalog,\n           x.dist,\n           a.w1mpro,\n           a.w2mpro,\n           a.w3mpro,\n           a.w4mpro\n    FROM xmatch x\n    JOIN allwise a ON x.oid_catalog = a.oid_catalog\n    WHERE x.oid = 'ZTF19aascdol'\n    AND x.catid = 'ALLWISE'\n)\nSELECT * FROM matched_allwise;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3706, "cache_read_input_tokens": 0, "input_tokens": 112, "output_tokens": 165, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3706, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "84-4", "response": "/* Get ALLWISE data for ZTF object ZTF19aascdol through xmatch table */\nWITH matched_allwise AS (\n    SELECT x.oid,\n           x.oid_catalog,\n           x.dist,\n           a.w1mpro,\n           a.w2mpro,\n           a.w3mpro,\n           a.w4mpro\n    FROM xmatch x\n    JOIN allwise a ON x.oid_catalog = a.oid_catalog\n    WHERE x.oid = 'ZTF19aascdol'\n    AND x.catid = 'ALLWISE'\n)\nSELECT * FROM matched_allwise;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3706, "input_tokens": 112, "output_tokens": 165, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "96-2", "response": "WITH catalog (ssnamenr) AS (\n    VALUES ('2003FP134'),\n           ('2009UK56')\n)\nSELECT \n    ss.*, /* all columns from ss_ztf */\n    d.mjd, /* detection date */\n    d.fid, /* filter identifier */\n    d.isdiffpos, /* difference flag */\n    d.ra,\n    d.dec,\n    d.magpsf, /* difference magnitude */\n    d.sigmapsf /* difference magnitude uncertainty */\nFROM ss_ztf ss\nJOIN detection d ON d.candid = ss.candid\nWHERE ss.ssnamenr IN (SELECT ssnamenr FROM catalog)\nORDER BY ss.ssnamenr, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3011, "cache_read_input_tokens": 0, "input_tokens": 129, "output_tokens": 177, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3011, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "96-3", "response": "WITH catalog (ssnamenr) AS (\n    VALUES ('2003FP134'),\n           ('2009UK56')\n)\nSELECT \n    ss.*, /* all columns from ss_ztf */\n    d.mjd, /* detection date */\n    d.fid, /* filter identifier */\n    d.isdiffpos, /* difference flag */\n    d.ra,\n    d.dec,\n    d.magpsf, /* difference magnitude */\n    d.sigmapsf /* difference magnitude uncertainty */\nFROM catalog c\nJOIN ss_ztf ss ON ss.ssnamenr = c.ssnamenr\nJOIN detection d ON d.candid = ss.candid\nORDER BY ss.ssnamenr, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3011, "input_tokens": 129, "output_tokens": 177, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "96-4", "response": "WITH catalog (ssnamenr) AS (\n    VALUES ('2003FP134'),\n           ('2009UK56')\n)\nSELECT \n    ss.*, /* all columns from ss_ztf */\n    d.mjd, /* detection date */\n    d.fid, /* filter identifier */\n    d.isdiffpos, /* difference flag */\n    d.ra,\n    d.dec,\n    d.magpsf, /* difference magnitude */\n    d.sigmapsf /* difference magnitude uncertainty */\nFROM ss_ztf ss\nINNER JOIN detection d ON ss.candid = d.candid\nWHERE ss.ssnamenr IN (SELECT ssnamenr FROM catalog)\n    AND q3c_dist(d.ra, d.dec, \n        (SELECT d2.ra FROM detection d2 WHERE d2.candid = ss.candid),\n        (SELECT d2.dec FROM detection d2 WHERE d2.candid = ss.candid)\n    ) <= 2/3600.0 /* converting 2 arcsec to degrees */\nORDER BY ss.ssnamenr, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3011, "cache_read_input_tokens": 0, "input_tokens": 129, "output_tokens": 270, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3011, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "67-2", "response": "WITH ztf_objects (oid) AS (\n    VALUES ('ZTF18acxlskz'),\n           ('ZTF22aanppbi'),\n           ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT oid FROM ztf_objects)\n    AND g.neargaia <= 1.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2437, "input_tokens": 113, "output_tokens": 98, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "67-3", "response": "WITH ztf_objects (oid) AS (\n    VALUES ('ZTF18acxlskz'),\n           ('ZTF22aanppbi'),\n           ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT oid FROM ztf_objects)\n    AND g.neargaia <= 1.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2437, "cache_read_input_tokens": 0, "input_tokens": 113, "output_tokens": 98, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2437, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "67-4", "response": "WITH ztf_objects (oid) AS (\n    VALUES ('ZTF18acxlskz'),\n           ('ZTF22aanppbi'),\n           ('ZTF22abunrft')\n)\nSELECT *\nFROM gaia_ztf g\nWHERE g.oid IN (SELECT oid FROM ztf_objects)\n    AND g.neargaia <= 1.5;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2437, "cache_read_input_tokens": 0, "input_tokens": 113, "output_tokens": 98, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2437, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "55-2", "response": "/* Query to get all information from object table for a specific ZTF object */\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2752, "cache_read_input_tokens": 0, "input_tokens": 61, "output_tokens": 43, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2752, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "55-3", "response": "/* Query to get all information from object table for a specific ZTF object */\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2752, "cache_read_input_tokens": 0, "input_tokens": 61, "output_tokens": 43, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2752, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "55-4", "response": "/* Query to get all information from object table for a specific ZTF object */\nSELECT *\nFROM object\nWHERE oid = 'ZTF20aatxryt';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2752, "cache_read_input_tokens": 0, "input_tokens": 61, "output_tokens": 43, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2752, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "47-2", "response": "/* Get detections with rb > 0.7 for specific ZTF objects */\nWITH target_objects (oid) AS (\n    VALUES ('ZTF23aaawbsc'),\n           ('ZTF21abxlmuw')\n)\nSELECT \n    d.oid,           /* ZTF identifier */\n    d.candid,        /* candidate identifier */\n    d.fid,           /* filter identifier */\n    d.mjd,           /* detection date */\n    d.isdiffpos,     /* difference flag */\n    d.ra,            /* right ascension */\n    d.dec,           /* declination */\n    d.magpsf,        /* difference magnitude */\n    d.sigmapsf,      /* magnitude uncertainty */\n    d.rb             /* real/bogus score */\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_objects)\n    AND d.rb > 0.7\nORDER BY d.oid, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2815, "cache_read_input_tokens": 0, "input_tokens": 136, "output_tokens": 235, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2815, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "47-3", "response": "/* Get detections with rb > 0.7 for specific ZTF objects */\nWITH target_objects (oid) AS (\n    VALUES ('ZTF23aaawbsc'),\n           ('ZTF21abxlmuw')\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.rb\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_objects)\n    AND d.rb > 0.7\nORDER BY d.oid, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2815, "cache_read_input_tokens": 0, "input_tokens": 136, "output_tokens": 179, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2815, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "47-4", "response": "/* Get detections with rb > 0.7 for specific ZTF objects */\nWITH target_objects (oid) AS (\n    VALUES ('ZTF23aaawbsc'),\n           ('ZTF21abxlmuw')\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid,\n    d.mjd,\n    d.isdiffpos,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.rb\nFROM detection d\nWHERE d.oid IN (SELECT oid FROM target_objects)\n    AND d.rb > 0.7\nORDER BY d.oid, d.mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2815, "input_tokens": 136, "output_tokens": 179, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "79-2", "response": "/* Get xmatch information for ZTF object 'ZTF20achscch' */\nSELECT \n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2298, "cache_read_input_tokens": 0, "input_tokens": 78, "output_tokens": 63, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2298, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "79-3", "response": "/* Get cross-match information for ZTF object 'ZTF20achscch' */\nSELECT \n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2298, "cache_read_input_tokens": 0, "input_tokens": 78, "output_tokens": 63, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2298, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "79-4", "response": "/* Get cross-match information for ZTF object 'ZTF20achscch' */\nSELECT \n    catid,\n    oid_catalog,\n    dist\nFROM xmatch\nWHERE oid = 'ZTF20achscch';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2298, "cache_read_input_tokens": 0, "input_tokens": 78, "output_tokens": 63, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2298, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "94-2", "response": "/* Get all columns from object and reference tables where reference_change is true */\nWITH oids AS (\n    SELECT oid \n    FROM object \n    WHERE reference_change = true \n    LIMIT 50\n)\nSELECT o.*, r.*\nFROM oids\nJOIN object o USING (oid)\nJOIN reference r USING (oid);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3183, "cache_read_input_tokens": 0, "input_tokens": 71, "output_tokens": 84, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3183, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "94-3", "response": "/* Get all columns from object and reference tables where reference_change is true */\nWITH oids AS (\n    SELECT oid \n    FROM object \n    WHERE reference_change = true \n    LIMIT 50\n)\nSELECT o.*, r.*\nFROM oids\nJOIN object o USING (oid)\nJOIN reference r USING (oid);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3183, "cache_read_input_tokens": 0, "input_tokens": 71, "output_tokens": 84, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3183, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "94-4", "response": "/* Get all columns from object and reference tables where reference_change is true */\nWITH oids AS (\n    SELECT oid \n    FROM object \n    WHERE reference_change = true\n    LIMIT 50\n)\nSELECT o.*, r.*\nFROM oids\nJOIN object o USING (oid)\nJOIN reference r USING (oid);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3183, "input_tokens": 71, "output_tokens": 83, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "90-2", "response": "/* Get objects with multiband period < 5 days */\nWITH periodic_objects AS (\n    SELECT DISTINCT oid \n    FROM feature \n    WHERE name = 'Multiband_period'\n    AND version = 'lc_classifier_1.2.1-P'\n    AND value < 5\n    LIMIT 100\n)\n/* Get top 2 ranked probabilities from lc_classifier for these objects */\nSELECT p.* \nFROM probability p\nINNER JOIN periodic_objects po ON p.oid = po.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking IN (1, 2);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 5293, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 158, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 5293, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "90-3", "response": "/* Get objects with multiband period < 5 days */\nWITH periodic_objects AS (\n    SELECT DISTINCT oid \n    FROM feature \n    WHERE name = 'Multiband_period'\n    AND version = 'lc_classifier_1.2.1-P'\n    AND value < 5\n    LIMIT 100\n)\n/* Get top 2 ranked probabilities from lc_classifier for these objects */\nSELECT p.* \nFROM probability p\nINNER JOIN periodic_objects po ON p.oid = po.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking IN (1, 2);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 5293, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 158, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 5293, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "90-4", "response": "/* Get objects with multiband period < 5 days */\nWITH periodic_objects AS (\n    SELECT DISTINCT oid \n    FROM feature \n    WHERE name = 'Multiband_period'\n    AND version = 'lc_classifier_1.2.1-P'\n    AND value < 5\n    LIMIT 100\n)\n/* Get probabilities for these objects from lc_classifier with ranking 1 or 2 */\nSELECT p.* \nFROM probability p\nINNER JOIN periodic_objects po ON p.oid = po.oid\nWHERE p.classifier_name = 'lc_classifier'\nAND p.ranking IN (1, 2);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 5293, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 162, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 5293, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "51-2", "response": "/* Query to get photometry data for ZTF object ZTF24aaiutyh */\nSELECT \n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2974, "cache_read_input_tokens": 0, "input_tokens": 98, "output_tokens": 104, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2974, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "51-3", "response": "/* Query to get photometry data for ZTF object ZTF24aaiutyh */\nSELECT \n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2974, "cache_read_input_tokens": 0, "input_tokens": 98, "output_tokens": 104, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2974, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "51-4", "response": "/* Query to get forced photometry epochs for ZTF24aaiutyh sorted by date */\nSELECT \n    oid,\n    mjd,\n    fid,\n    mag,\n    e_mag,\n    mag_corr,\n    e_mag_corr,\n    isdiffpos\nFROM forced_photometry\nWHERE oid = 'ZTF24aaiutyh'\nORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2974, "cache_read_input_tokens": 0, "input_tokens": 98, "output_tokens": 104, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2974, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "59-2", "response": "/* Get basic statistics for ZTF object ZTF18acsvogv */\nSELECT \n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3037, "cache_read_input_tokens": 0, "input_tokens": 79, "output_tokens": 64, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3037, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "59-3", "response": "/* Get basic statistics for ZTF object ZTF18acsvogv */\nSELECT \n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3037, "input_tokens": 79, "output_tokens": 64, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "59-4", "response": "/* Get basic statistics for ZTF object ZTF18acsvogv */\nSELECT \n    oid,\n    fid,\n    ndet,\n    magmean\nFROM magstat\nWHERE oid = 'ZTF18acsvogv';", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3037, "input_tokens": 79, "output_tokens": 64, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "100-2", "response": "/* Query to get all epochs for ZTF24aamtvxb from detection, non_detection and forced_photometry tables */\nWITH all_epochs AS (\n    SELECT \n        oid,\n        mjd,\n        fid,\n        isdiffpos,\n        magpsf as mag,\n        sigmapsf as mag_err,\n        diffmaglim,\n        NULL as forced_mag,\n        NULL as forced_mag_err,\n        'detection' as \"table\"\n    FROM detection \n    WHERE oid = 'ZTF24aamtvxb'\n    \n    UNION ALL\n    \n    SELECT \n        oid,\n        mjd,\n        fid,\n        NULL as isdiffpos,\n        NULL as mag,\n        NULL as mag_err,\n        diffmaglim,\n        NULL as forced_mag,\n        NULL as forced_mag_err,\n        'non_detection' as \"table\"\n    FROM non_detection \n    WHERE oid = 'ZTF24aamtvxb'\n    \n    UNION ALL\n    \n    SELECT \n        oid,\n        mjd,\n        fid,\n        isdiffpos,\n        NULL as mag,\n        NULL as mag_err,\n        diffmaglim,\n        mag as forced_mag,\n        e_mag as forced_mag_err,\n        'forced_photometry' as \"table\"\n    FROM forced_photometry \n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT * FROM all_epochs ORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3777, "cache_read_input_tokens": 0, "input_tokens": 138, "output_tokens": 380, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3777, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "100-3", "response": "/* Query to get all epochs for ZTF24aamtvxb from detection, non_detection and forced_photometry tables */\nWITH all_epochs AS (\n    SELECT \n        oid,\n        mjd,\n        fid,\n        isdiffpos,\n        magpsf as mag,\n        sigmapsf as mag_err,\n        diffmaglim,\n        NULL as forced_mag,\n        NULL as forced_mag_err,\n        'detection' as \"table\"\n    FROM detection \n    WHERE oid = 'ZTF24aamtvxb'\n    \n    UNION ALL\n    \n    SELECT \n        oid,\n        mjd,\n        fid,\n        NULL as isdiffpos,\n        NULL as mag,\n        NULL as mag_err,\n        diffmaglim,\n        NULL as forced_mag,\n        NULL as forced_mag_err,\n        'non_detection' as \"table\"\n    FROM non_detection \n    WHERE oid = 'ZTF24aamtvxb'\n    \n    UNION ALL\n    \n    SELECT \n        oid,\n        mjd,\n        fid,\n        isdiffpos,\n        NULL as mag,\n        NULL as mag_err,\n        diffmaglim,\n        mag as forced_mag,\n        e_mag as forced_mag_err,\n        'forced_photometry' as \"table\"\n    FROM forced_photometry \n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT * FROM all_epochs ORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3777, "input_tokens": 138, "output_tokens": 380, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "100-4", "response": "/* Query to get all epochs for ZTF24aamtvxb from detection, non_detection and forced_photometry tables */\nWITH all_epochs AS (\n    SELECT \n        oid,\n        mjd,\n        fid,\n        isdiffpos,\n        magpsf as mag,\n        sigmapsf as mag_err,\n        diffmaglim,\n        NULL as forced_mag,\n        NULL as forced_mag_err,\n        'detection' as \"table\"\n    FROM detection \n    WHERE oid = 'ZTF24aamtvxb'\n    \n    UNION ALL\n    \n    SELECT \n        oid,\n        mjd,\n        fid,\n        NULL as isdiffpos,\n        NULL as mag,\n        NULL as mag_err,\n        diffmaglim,\n        NULL as forced_mag,\n        NULL as forced_mag_err,\n        'non_detection' as \"table\"\n    FROM non_detection \n    WHERE oid = 'ZTF24aamtvxb'\n    \n    UNION ALL\n    \n    SELECT \n        oid,\n        mjd,\n        fid,\n        isdiffpos,\n        NULL as mag,\n        NULL as mag_err,\n        diffmaglim,\n        mag as forced_mag,\n        e_mag as forced_mag_err,\n        'forced_photometry' as \"table\"\n    FROM forced_photometry \n    WHERE oid = 'ZTF24aamtvxb'\n)\nSELECT * FROM all_epochs ORDER BY mjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3777, "input_tokens": 138, "output_tokens": 380, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "106-2", "response": "/* Get objects with high probability of being bogus and transient */\nWITH bogus_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND classifier_version = 'stamp_classifier_1.0.4'\n    AND class_name = 'bogus'\n    AND probability > 0.7\n),\ntransient_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_top'\n    AND class_name = 'Transient'\n    AND probability > 0.9\n)\nSELECT \n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p1.probability AS prob_stamp_bogus,\n    p2.probability AS prob_lc_transient\nFROM object o\nINNER JOIN bogus_objects bo ON o.oid = bo.oid\nINNER JOIN transient_objects to2 ON o.oid = to2.oid\nINNER JOIN probability p1 ON o.oid = p1.oid \n    AND p1.classifier_name = 'stamp_classifier'\n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'bogus'\nINNER JOIN probability p2 ON o.oid = p2.oid \n    AND p2.classifier_name = 'lc_classifier_top'\n    AND p2.class_name = 'Transient'\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2974, "cache_read_input_tokens": 0, "input_tokens": 194, "output_tokens": 394, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2974, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "106-3", "response": "/* Get objects with high probability of being bogus and transient */\nWITH bogus_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND classifier_version = 'stamp_classifier_1.0.4'\n    AND class_name = 'bogus'\n    AND probability > 0.7\n),\ntransient_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_top'\n    AND class_name = 'Transient'\n    AND probability > 0.9\n)\nSELECT \n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p1.probability AS prob_stamp_bogus,\n    p2.probability AS prob_lc_transient\nFROM object o\nINNER JOIN bogus_objects bo ON o.oid = bo.oid\nINNER JOIN transient_objects to2 ON o.oid = to2.oid\nINNER JOIN probability p1 ON o.oid = p1.oid \n    AND p1.classifier_name = 'stamp_classifier'\n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'bogus'\nINNER JOIN probability p2 ON o.oid = p2.oid \n    AND p2.classifier_name = 'lc_classifier_top'\n    AND p2.class_name = 'Transient'\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2974, "input_tokens": 194, "output_tokens": 394, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "106-4", "response": "/* Get objects with high probability of being bogus and transient */\nWITH bogus_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'stamp_classifier'\n    AND classifier_version = 'stamp_classifier_1.0.4'\n    AND class_name = 'bogus'\n    AND probability > 0.7\n),\ntransient_objects AS (\n    SELECT oid\n    FROM probability\n    WHERE classifier_name = 'lc_classifier_top'\n    AND class_name = 'Transient'\n    AND probability > 0.9\n)\nSELECT \n    o.oid,\n    o.ndet,\n    o.firstmjd,\n    p1.probability AS prob_stamp_bogus,\n    p2.probability AS prob_lc_transient\nFROM object o\nINNER JOIN bogus_objects bo ON o.oid = bo.oid\nINNER JOIN transient_objects to2 ON o.oid = to2.oid\nINNER JOIN probability p1 ON o.oid = p1.oid \n    AND p1.classifier_name = 'stamp_classifier'\n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'bogus'\nINNER JOIN probability p2 ON o.oid = p2.oid \n    AND p2.classifier_name = 'lc_classifier_top'\n    AND p2.class_name = 'Transient'\nWHERE o.ndet > 10\nORDER BY o.oid\nLIMIT 30;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2974, "cache_read_input_tokens": 0, "input_tokens": 194, "output_tokens": 394, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2974, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "56-2", "response": "/* Get objects from a predefined list where corrected=false */\nWITH catalog (oid) AS (\n    VALUES ('ZTF20abywydb'),\n           ('ZTF20abzpxxu'),\n           ('ZTF20acduffd')\n)\nSELECT \n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd,\n    o.lastmjd,\n    o.g_r_mean,\n    o.g_r_mean_corr\nFROM object o\nINNER JOIN catalog c ON o.oid = c.oid\nWHERE o.corrected = false\nORDER BY o.firstmjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4284, "input_tokens": 160, "output_tokens": 176, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "56-3", "response": "/* Get objects from a predefined list where corrected=false */\nWITH catalog (oid) AS (\n    VALUES ('ZTF20abywydb'),\n           ('ZTF20abzpxxu'),\n           ('ZTF20acduffd')\n)\nSELECT \n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd,\n    o.lastmjd,\n    o.g_r_mean,\n    o.g_r_mean_corr\nFROM object o\nINNER JOIN catalog c ON o.oid = c.oid\nWHERE o.corrected = false\nORDER BY o.firstmjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4284, "cache_read_input_tokens": 0, "input_tokens": 160, "output_tokens": 176, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 4284, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "56-4", "response": "/* Get objects from a predefined list where corrected=false */\nWITH catalog (oid) AS (\n    VALUES ('ZTF20abywydb'),\n           ('ZTF20abzpxxu'),\n           ('ZTF20acduffd')\n)\nSELECT \n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    o.firstmjd,\n    o.lastmjd,\n    o.g_r_mean,\n    o.g_r_mean_corr\nFROM object o\nINNER JOIN catalog c ON o.oid = c.oid\nWHERE o.corrected = false\nORDER BY o.firstmjd;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4284, "cache_read_input_tokens": 0, "input_tokens": 160, "output_tokens": 176, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 4284, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "48-2", "response": "/* Get features for ZTF18abqyaix, sorted by oid, fid, version */\nSELECT \n    oid,\n    name,\n    value,\n    fid,\n    version\nFROM feature\nWHERE oid = 'ZTF18abqyaix'\nORDER BY oid, fid, version;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 5595, "cache_read_input_tokens": 0, "input_tokens": 86, "output_tokens": 82, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 5595, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "48-3", "response": "/* Get features for ZTF18abqyaix, sorted by oid, fid, version */\nSELECT \n    oid,\n    name,\n    value,\n    fid,\n    version\nFROM feature\nWHERE oid = 'ZTF18abqyaix'\nORDER BY oid, fid, version;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5595, "input_tokens": 86, "output_tokens": 82, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "48-4", "response": "/* Get features for ZTF18abqyaix, sorted by oid, fid and version */\nSELECT \n    oid,\n    name,\n    value,\n    fid,\n    version\nFROM feature\nWHERE oid = 'ZTF18abqyaix'\nORDER BY oid, fid, version;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5595, "input_tokens": 86, "output_tokens": 82, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "58-2", "response": "/* Get objects with ndet>=30, g-r color > 3.5, and time span > 20 days */\n/* g_r_max_corr represents the g-r color at maximum */\nSELECT *\nFROM object\nWHERE ndet >= 30\nAND g_r_max_corr > 3.5\nAND deltajd > 20\nLIMIT 20;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3407, "input_tokens": 104, "output_tokens": 92, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "58-3", "response": "/* Get objects with ndet>=30, g-r color > 3.5, and time span > 20 days */\n/* g_r_max_corr represents the g-r color at maximum */\nSELECT *\nFROM object\nWHERE ndet >= 30\nAND g_r_max_corr > 3.5\nAND deltajd > 20\nLIMIT 20;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3407, "cache_read_input_tokens": 0, "input_tokens": 104, "output_tokens": 92, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3407, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "58-4", "response": "/* Get objects with ndet>=30, g-r color > 3.5, and time span > 20 days */\n/* g_r_max_corr represents the g-r color at maximum */\nSELECT *\nFROM object\nWHERE ndet >= 30\nAND g_r_max_corr > 3.5\nAND deltajd > 20\nLIMIT 20;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 3407, "cache_read_input_tokens": 0, "input_tokens": 104, "output_tokens": 92, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 3407, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "78-2", "response": "/* Get taxonomy info for the light curve classifier and its variants */\nSELECT classifier_name, classifier_version, classes\nFROM taxonomy\nWHERE classifier_name IN (\n    'lc_classifier',\n    'lc_classifier_top',\n    'lc_classifier_transient',\n    'lc_classifier_stochastic',\n    'lc_classifier_periodic'\n);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2213, "cache_read_input_tokens": 0, "input_tokens": 62, "output_tokens": 90, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2213, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "78-3", "response": "/* Get taxonomy info for the light curve classifier and its variants */\nSELECT classifier_name, classifier_version, classes\nFROM taxonomy\nWHERE classifier_name IN (\n    'lc_classifier',\n    'lc_classifier_top',\n    'lc_classifier_transient',\n    'lc_classifier_stochastic',\n    'lc_classifier_periodic'\n);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2213, "cache_read_input_tokens": 0, "input_tokens": 62, "output_tokens": 90, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2213, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "78-4", "response": "/* Get taxonomy info for the light curve classifier and its variants */\nSELECT classifier_name, classifier_version, classes\nFROM taxonomy\nWHERE classifier_name IN (\n    'lc_classifier',\n    'lc_classifier_top',\n    'lc_classifier_transient',\n    'lc_classifier_stochastic',\n    'lc_classifier_periodic'\n);", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 2213, "cache_read_input_tokens": 0, "input_tokens": 62, "output_tokens": 90, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 2213, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "39-2", "response": "/* Get CV/Nova objects from stochastic classifier with specific criteria */\nWITH nova_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n    AND p.class_name = 'CV/Nova'\n    AND p.ranking = 1\n),\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN nova_objects n ON o.oid = n.oid\n    WHERE o.ndet <= 50\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    (d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise\nFROM detection d\nINNER JOIN filtered_objects f ON d.oid = f.oid\nWHERE d.fid = 2  /* r-band filter */\nAND d.corrected = true\nORDER BY d.oid\nLIMIT 1000;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4506, "input_tokens": 165, "output_tokens": 310, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "39-3", "response": "/* Get CV/Nova objects from stochastic classifier with specific criteria */\nWITH nova_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n    AND p.class_name = 'CV/Nova'\n    AND p.ranking = 1\n),\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN nova_objects n ON o.oid = n.oid\n    WHERE o.ndet <= 50\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    (d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise\nFROM detection d\nINNER JOIN filtered_objects f ON d.oid = f.oid\nWHERE d.fid = 2  /* r-band filter */\nAND d.corrected = true\nORDER BY d.oid\nLIMIT 1000;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 4506, "cache_read_input_tokens": 0, "input_tokens": 165, "output_tokens": 310, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 4506, "ephemeral_1h_input_tokens": 0}}}
{"custom_id": "39-4", "response": "/* Get CV/Nova objects from stochastic classifier with specific criteria */\nWITH nova_objects AS (\n    SELECT DISTINCT p.oid\n    FROM probability p\n    WHERE p.classifier_name = 'lc_classifier_stochastic'\n    AND p.class_name = 'CV/Nova'\n    AND p.ranking = 1\n),\nfiltered_objects AS (\n    SELECT o.oid\n    FROM object o\n    INNER JOIN nova_objects n ON o.oid = n.oid\n    WHERE o.ndet <= 50\n)\nSELECT \n    d.oid,\n    d.candid,\n    d.fid AS f_id,\n    d.ra,\n    d.dec,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    (d.magpsf_corr - MIN(d.magpsf_corr) OVER (PARTITION BY d.oid)) AS max_rise\nFROM detection d\nINNER JOIN filtered_objects f ON d.oid = f.oid\nWHERE d.fid = 2  /* r-band filter */\nAND d.corrected = true\nORDER BY d.oid\nLIMIT 1000;", "model": "claude-3-5-sonnet-20241022", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4506, "input_tokens": 165, "output_tokens": 310, "server_tool_use": null, "service_tier": "batch", "cache_creation": {"ephemeral_5m_input_tokens": 0, "ephemeral_1h_input_tokens": 0}}}
