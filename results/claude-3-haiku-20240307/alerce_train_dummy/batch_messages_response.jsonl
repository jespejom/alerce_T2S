{"custom_id": "86-0", "response": "/*\nThis query finds ZTF objects that:\n1. Have a probability greater than 0.6 of being Cepheid, Delta Scuti, or RR Lyra in the 'lc_classifier' version '1.1.0'\n2. Have a closest PS1 object with a star/galaxy score greater than 0.8\n3. Returns all columns from the 'probability' and 'ps1_ztf' tables, limiting to 100 rows\n*/\nSELECT p.*, ps1.*\nFROM probability p\nJOIN ps1_ztf ps1 ON p.oid = ps1.oid\nWHERE p.classifier_name = 'lc_classifier' \n  AND p.classifier_version = '1.1.0'\n  AND p.probability > 0.6\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND ps1.sgscore1 > 0.8\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3297, "cache_read_input_tokens": 0, "input_tokens": 126, "output_tokens": 239, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "86-1", "response": "/*\nThis query finds ZTF objects that:\n1. Have a probability greater than 0.6 of being Cepheid, Delta Scuti, or RR Lyra in the 'lc_classifier' version '1.1.0'\n2. Have a closest PS1 object with a star/galaxy score greater than 0.8\n3. Returns all columns from the 'probability' and 'ps1_ztf' tables, limiting to 100 rows\n*/\nSELECT p.*, ps1.*\nFROM probability p\nJOIN ps1_ztf ps1 ON p.oid = ps1.oid\nWHERE p.classifier_name = 'lc_classifier' \n  AND p.classifier_version = '1.1.0'\n  AND p.probability > 0.6\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND ps1.sgscore1 > 0.8\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3297, "input_tokens": 126, "output_tokens": 239, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "53-0", "response": "/*\nThis query retrieves the date, filter identifier, ZTF identifier, and 5-sigma magnitude limit for all non-detections of the ZTF object 'ZTF18adqxemz'.\nThe key steps are:\n1. Select the relevant columns from the non_detection table for the given object identifier 'ZTF18adqxemz'.\n2. The object identifier 'oid' is used to filter the non-detections for the specific object.\n*/\n\nSELECT \n    mjd, \n    fid, \n    oid, \n    diffmaglim\nFROM non_detection\nWHERE oid = 'ZTF18adqxemz';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2899, "input_tokens": 57, "output_tokens": 163, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "53-1", "response": "/*\nThis query retrieves the date, filter identifier, ZTF identifier, and 5-sigma magnitude limit for all non-detections of the ZTF object 'ZTF18adqxemz'.\nThe key steps are:\n1. Select the relevant columns from the non_detection table.\n2. Filter the results to only include the object with the ZTF identifier 'ZTF18adqxemz'.\n*/\n\nSELECT \n    mjd, \n    fid, \n    oid, \n    diffmaglim\nFROM non_detection\nWHERE oid = 'ZTF18adqxemz';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2899, "cache_read_input_tokens": 0, "input_tokens": 57, "output_tokens": 151, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "36-0", "response": "/*\nThis query retrieves the feature names and values for the light curves of the object with the oid 'ZTF20aaelulu'. It also includes the oid column in the output.\n*/\nSELECT o.oid, f.name, f.value\nFROM object o\nJOIN feature f ON o.oid = f.oid\nWHERE o.oid = 'ZTF20aaelulu';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5594, "input_tokens": 49, "output_tokens": 99, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "36-1", "response": "/*\nThis query retrieves the feature names and values for the light curves of the object with the oid 'ZTF20aaelulu'. It also includes the oid column in the output.\n*/\nSELECT o.oid, f.name, f.value\nFROM object o\nJOIN feature f ON o.oid = f.oid\nWHERE o.oid = 'ZTF20aaelulu';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5594, "cache_read_input_tokens": 0, "input_tokens": 49, "output_tokens": 99, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "91-0", "response": "/*\nThis query finds ZTF objects that have a 'W1-W2' color lower than 1, and returns the following columns:\n- ZTF identifier (oid)\n- Number of detections (ndet)\n- Difference between minimum g- and r-band difference magnitudes (g_r_max)\n- 'W1-W2' feature value (renamed to w1_w2)\n- Feature version (version)\n\nThe query uses a subquery to efficiently retrieve the OIDs, and then joins with the relevant tables to get the requested columns. The result is limited to 100 rows.\n*/\n\nSELECT \n    o.oid,\n    o.ndet,\n    o.g_r_max,\n    f.value AS w1_w2,\n    f.version\nFROM (\n    SELECT oid\n    FROM feature\n    WHERE name = 'W1-W2' AND value < 1\n    LIMIT 100\n) AS subquery\nJOIN object o ON subquery.oid = o.oid\nJOIN feature f ON o.oid = f.oid AND f.name = 'W1-W2'\nORDER BY o.ndet DESC\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 6478, "cache_read_input_tokens": 0, "input_tokens": 101, "output_tokens": 286, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "91-1", "response": "/*\nThis query finds ZTF objects that have a 'W1-W2' color lower than 1, and returns the following columns:\n- ZTF identifier (oid)\n- Number of detections (ndet)\n- Difference between minimum g- and r-band difference magnitudes (g_r_max)\n- 'W1-W2' feature value (renamed to w1_w2)\n- Feature version (version)\n\nThe query uses a subquery to efficiently retrieve the OIDs, and then joins with the relevant tables to get the requested columns. The result is limited to 100 rows.\n*/\n\nSELECT \n    o.oid,\n    o.ndet,\n    o.g_r_max,\n    f.value AS w1_w2,\n    f.version\nFROM (\n    SELECT oid\n    FROM feature\n    WHERE name = 'W1-W2' AND value < 1\n    LIMIT 100\n) AS subquery\nJOIN object o ON subquery.oid = o.oid\nJOIN feature f ON o.oid = f.oid AND f.name = 'W1-W2'\nORDER BY o.ndet DESC\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 6478, "input_tokens": 101, "output_tokens": 286, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "0-0", "response": "/*\nThis query retrieves objects that are likely to be Young Stellar Objects (YSOs) with some periodicity. The criteria are:\n- Probability of being a YSO is greater than 0.7\n- Photometric period is between 3 and 10 days\n- Variation amplitude is greater than 0.5 mag\nThe results are sorted by the YSO probability in descending order, and the returned columns are:\n- Object identifier (oid)\n- YSO probability\n- Feature value\n- Feature name\n- Filter ID (fid)\n- Feature version\n*/\n\nSELECT \n    o.oid,\n    p.probability AS yso_probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO' \n    AND p.probability > 0.7\n    AND f.name IN ('Period_band', 'delta_mag_fid')\n    AND f.value BETWEEN 3 AND 10 \n    AND f.value > 0.5\nORDER BY p.probability DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5884, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 299, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "0-1", "response": "/*\nThis query retrieves objects that are likely to be Young Stellar Objects (YSOs) with some periodicities. The criteria are:\n- Probability of being a YSO is greater than 0.7\n- Photometric period is between 3 and 10 days\n- Variation amplitude is greater than 0.5 mag\nThe results are sorted by the YSO probability in descending order, and the returned columns are:\n- Object identifier (oid)\n- YSO probability\n- Feature value\n- Feature name\n- Filter ID (fid)\n- Feature version\n*/\n\nSELECT \n    o.oid,\n    p.probability AS yso_probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO' \n    AND p.probability > 0.7\n    AND f.name IN ('Period_band', 'delta_mag_fid')\n    AND f.value BETWEEN 3 AND 10 -- Period between 3 and 10 days\n    AND f.value > 0.5 -- Variation amplitude greater than 0.5 mag\nORDER BY p.probability DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5884, "input_tokens": 106, "output_tokens": 324, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "70-0", "response": "/*\nThis query retrieves all the information available for the ZTF object 'ZTF22aayjqah' from the 'reference' table.\n*/\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3182, "cache_read_input_tokens": 0, "input_tokens": 46, "output_tokens": 64, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "70-1", "response": "/*\nThis query retrieves all the information available for the ZTF object 'ZTF22aayjqah' from the 'reference' table.\n*/\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3182, "cache_read_input_tokens": 0, "input_tokens": 46, "output_tokens": 64, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "4-0", "response": "/*\nThis query retrieves the requested information for objects classified as SN II with probability greater than 0.6, initial rise rate greater than 0.5 mag/day in ZTF g and r-band, and number of detections greater than 50, for the time period 2019-2022.\n\nThe key steps are:\n1. Join the object, probability, detection, and magstat tables to get the required information.\n2. Filter the objects classified as SN II with probability > 0.6 and number of detections > 50.\n3. Calculate the initial rise rate (dmdt_first) in g and r-band and filter for those greater than 0.5 mag/day.\n4. Select the desired columns: oid, candid, magpsf, sigmapsf, dmdt_first, fid.\n*/\n\nSELECT \n    o.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    m.dmdt_first,\n    m.fid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nJOIN magstat m ON o.oid = m.oid AND d.fid = m.fid\nWHERE \n    p.class_name = 'SNII' \n    AND p.probability > 0.6\n    AND o.ndet > 50\n    AND m.dmdt_first > 0.5\n    AND m.fid IN (1, 2) -- g (1) and r (2) bands\n    AND d.mjd BETWEEN '2019-01-01'::DOUBLE PRECISION AND '2022-12-31'::DOUBLE PRECISION\nORDER BY o.oid, d.mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 4505, "cache_read_input_tokens": 0, "input_tokens": 102, "output_tokens": 426, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "4-1", "response": "/*\nRetrieve the requested information for objects classified as SN II with probability greater than 0.6, initial rise rate greater than 0.5 mag/day in ZTF g and r-band, and number of detections greater than 50, for the time period 2019-2022.\n*/\nSELECT \n    o.oid,\n    d.candid,\n    d.magpsf,\n    d.sigmapsf,\n    m.dmdt_first,\n    d.fid\nFROM object o\nJOIN detection d ON o.oid = d.oid\nJOIN magstat m ON o.oid = m.oid AND d.fid = m.fid\nJOIN probability p ON o.oid = p.oid\nWHERE \n    p.class_name = 'SNII' \n    AND p.probability > 0.6\n    AND m.dmdt_first > 0.5\n    AND m.ndet > 50\n    AND d.mjd BETWEEN '2019-01-01'::DOUBLE PRECISION AND '2022-12-31'::DOUBLE PRECISION\n    AND (d.fid = 1 OR d.fid = 2)\nORDER BY o.oid, d.mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4505, "input_tokens": 102, "output_tokens": 300, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "46-0", "response": "/*\nThis query retrieves all the information from the 'detection' table for the ZTF object 'ZTF23aaqmddq', sorted by the detection date (mjd).\n*/\nSELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2814, "cache_read_input_tokens": 0, "input_tokens": 50, "output_tokens": 77, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "46-1", "response": "/*\nThis query retrieves all the information from the 'detection' table for the ZTF object 'ZTF23aaqmddq', sorted by the detection date (mjd).\n*/\nSELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2814, "cache_read_input_tokens": 0, "input_tokens": 50, "output_tokens": 77, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "60-0", "response": "/*\nThis query retrieves the requested information for the specified ZTF objects with zero dubious corrections in the g band.\n*/\nSELECT \n    o.oid AS ztf_id,\n    m.ndet AS num_detections,\n    m.dmdt_first AS initial_rise_estimate,\n    m.dm_first AS first_diff_mag\nFROM object o\nJOIN magstat m ON o.oid = m.oid\nWHERE o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n  AND m.fid = 1 -- g band\n  AND m.ndubious = 0\nORDER BY o.oid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3628, "input_tokens": 106, "output_tokens": 181, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "60-1", "response": "/*\nThis query retrieves the requested information for the specified ZTF objects with zero dubious corrections in the g band.\n*/\nSELECT \n    o.oid AS ztf_id,\n    m.ndet AS num_detections,\n    m.dmdt_first AS initial_rise_estimate,\n    m.dm_first AS first_diff_mag\nFROM object o\nJOIN magstat m ON o.oid = m.oid\nWHERE o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n  AND m.fid = 1 -- g band\n  AND m.ndubious = 0\nORDER BY o.oid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 106, "output_tokens": 181, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "97-0", "response": "/*\nGet at most 50 ZTF objects that satisfy the following conditions:\n- Have a probability larger than 0.6 of being an AGN in the stamp classifier version 'stamp_classifier_1.0.4'\n- Have a probability larger than 0.7 of being an LPV in the light curve classifier\nReturn the following columns:\n- ZTF identifier\n- Probability in the stamp classifier (named 'prob_stamp_agn')\n- Probability in the light curve classifier (named 'prob_lc_lpv')\n*/\nSELECT \n    o.oid AS oid,\n    p1.probability AS prob_stamp_agn,\n    p2.probability AS prob_lc_lpv\nFROM object o\nJOIN probability p1 ON o.oid = p1.oid\nJOIN probability p2 ON o.oid = p2.oid\nWHERE \n    p1.classifier_name = 'stamp_classifier' \n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'AGN'\n    AND p1.probability > 0.6\n    AND p2.classifier_name = 'lc_classifier'\n    AND p2.class_name = 'LPV'\n    AND p2.probability > 0.7\nLIMIT 50;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 135, "output_tokens": 330, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "97-1", "response": "/*\nGet at most 50 ZTF objects that satisfy the following conditions:\n- Have a probability larger than 0.6 of being an AGN in the stamp classifier version 'stamp_classifier_1.0.4'\n- Have a probability larger than 0.7 of being an LPV in the light curve classifier\nReturn the following columns:\n- ZTF identifier\n- Probability in the stamp classifier (named 'prob_stamp_agn')\n- Probability in the light curve classifier (named 'prob_lc_lpv')\n*/\nSELECT \n    o.oid AS oid,\n    p1.probability AS prob_stamp_agn,\n    p2.probability AS prob_lc_lpv\nFROM object o\nJOIN probability p1 ON o.oid = p1.oid\nJOIN probability p2 ON o.oid = p2.oid\nWHERE \n    p1.classifier_name = 'stamp_classifier' \n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'AGN'\n    AND p1.probability > 0.6\n    AND p2.classifier_name = 'lc_classifier'\n    AND p2.class_name = 'LPV'\n    AND p2.probability > 0.7\nLIMIT 50;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 135, "output_tokens": 330, "server_tool_use": null, "service_tier": "batch"}}
