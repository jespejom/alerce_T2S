{"custom_id": "13-0", "response": "/*\nThis query retrieves all the supernovae (SNe) that were first detected between December 1, 2022 and September 1, 2023. It returns the probability class, the last and first detection dates, and the object IDs (oids).\n\nThe key steps are:\n1. Use a subquery to get the oids of objects that have a 'SNIa', 'SNIbc', 'SNII', or 'SLSN' class probability with ranking 1 (most likely class).\n2. Join the subquery with the object table to get the additional information like firstmjd, lastmjd.\n3. Filter the results to only include objects with firstmjd between the given date range.\n*/\n\nSELECT \n    p.class_name,\n    o.lastmjd,\n    o.firstmjd,\n    o.oid\nFROM (\n    SELECT oid\n    FROM probability\n    WHERE class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND ranking = 1\n) AS p\nJOIN object o ON p.oid = o.oid\nWHERE o.firstmjd BETWEEN 59914.0 AND 60217.0;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 125, "output_tokens": 299, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "13-1", "response": "/*\nThis query retrieves all the supernovae (SNe) that were first detected between December 1, 2022 and September 1, 2023. It returns the probability class, the last and first detection dates, and the object IDs (oids).\n\nThe key steps are:\n1. Use a subquery to get the oids of objects that have a 'SNIa', 'SNIbc', 'SNII', or 'SLSN' class probability with ranking 1 (most likely class).\n2. Join the subquery with the object table to get the additional information like firstmjd, lastmjd.\n3. Filter the results to only include objects with firstmjd between the given date range.\n*/\n\nSELECT \n    p.class_name,\n    o.lastmjd,\n    o.firstmjd,\n    o.oid\nFROM (\n    SELECT oid\n    FROM probability\n    WHERE class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND ranking = 1\n) AS p\nJOIN object o ON p.oid = o.oid\nWHERE o.firstmjd BETWEEN 59914.0 AND 60217.0;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 125, "output_tokens": 299, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "10-0", "response": "/*\nGet the object identifiers and probabilities in the light curve classifier for objects classified in the light curve classifier as SNIa with ranking=1 and CV/Nova with ranking=2, where the difference between the probabilities at each ranking is lower than 0.1. Return the oids, and the probability for each class, naming the columns 'SN_prob' and 'CV_prob' respectively.\n*/\nSELECT \n    p1.oid,\n    p1.probability AS SN_prob,\n    p2.probability AS CV_prob\nFROM probability p1\nJOIN probability p2 ON p1.oid = p2.oid\nWHERE \n    p1.classifier_name = 'lc_classifier' \n    AND p1.class_name = 'SNIa'\n    AND p1.ranking = 1\n    AND p2.classifier_name = 'lc_classifier'\n    AND p2.class_name = 'CV/Nova' \n    AND p2.ranking = 2\n    AND ABS(p1.probability - p2.probability) < 0.1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 121, "output_tokens": 263, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "10-1", "response": "/*\nGet the object identifiers and probabilities in the light curve classifier for objects classified in the light curve classifier as SNIa with ranking=1 and CV/Nova with ranking=2, where the difference between the probabilities at each ranking is lower than 0.1. Return the oids, and the probability for each class, naming the columns 'SN_prob' and 'CV_prob' respectively.\n*/\nSELECT \n    p1.oid,\n    p1.probability AS SN_prob,\n    p2.probability AS CV_prob\nFROM probability p1\nJOIN probability p2 ON p1.oid = p2.oid\nWHERE \n    p1.classifier_name = 'lc_classifier' \n    AND p1.class_name = 'SNIa'\n    AND p1.ranking = 1\n    AND p2.classifier_name = 'lc_classifier'\n    AND p2.class_name = 'CV/Nova' \n    AND p2.ranking = 2\n    AND ABS(p1.probability - p2.probability) < 0.1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 121, "output_tokens": 263, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "15-0", "response": "/*\nGet the object identifiers, probabilities in the stamp classifier and light curves (only detections) for objects whose highest probability in the stamp classifier is obtained for class SN, that had their first detection in the first 2 days of september, and that qualify as fast risers. Also, return the filter ID and candid of the detections, and filter ID of magstat as 'magstat_fid', with the initial rise estimate.\nOrder the results by the oid.\n*/\n\nWITH fast_risers AS (\n  SELECT oid, fid, magfirst, magfirst_corr, firstmjd, dt_first, dmdt_first\n  FROM magstat\n  WHERE dt_first > 0 AND dmdt_first >= 0.25\n  AND firstmjd BETWEEN 60188.0 AND 60189.0\n)\nSELECT \n  o.oid,\n  p.probability AS stamp_probability,\n  d.fid, \n  d.candid,\n  m.magstat_fid AS fid,\n  m.dmdt_first,\n  m.dt_first\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nJOIN fast_risers m ON o.oid = m.oid AND d.fid = m.fid\nWHERE p.classifier_name = 'stamp_classifier' AND p.class_name = 'SN' AND p.ranking = 1\nORDER BY o.oid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 4505, "cache_read_input_tokens": 0, "input_tokens": 221, "output_tokens": 363, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "15-1", "response": "/*\nGet the object identifiers, probabilities in the stamp classifier and light curves (only detections) for objects whose highest probability in the stamp classifier is obtained for class SN, that had their first detection in the first 2 days of september, and that qualify as fast risers. Also, return the filter ID and candid of the detections, and filter ID of magstat as 'magstat_fid', with the initial rise estimate.\n*/\n\nWITH fast_risers AS (\n  SELECT \n    o.oid,\n    m.fid AS magstat_fid,\n    m.dmdt_first AS initial_rise\n  FROM object o\n  JOIN magstat m ON o.oid = m.oid\n  WHERE o.firstmjd BETWEEN 60188.0 AND 60189.0 -- September 1st and 2nd\n    AND m.dmdt_first >= 0.25 -- fast riser condition\n)\nSELECT\n  fr.oid,\n  p.probability AS stamp_probability,\n  p.class_name AS stamp_class,\n  d.fid,\n  d.candid,\n  fr.magstat_fid,\n  fr.initial_rise\nFROM fast_risers fr\nJOIN probability p ON fr.oid = p.oid\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.ranking = 1 -- most probable class\nJOIN detection d ON fr.oid = d.oid\nORDER BY fr.oid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 4505, "cache_read_input_tokens": 0, "input_tokens": 221, "output_tokens": 369, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "4-0", "response": "/*\nGet the object identifier, candidate identifier, magnitudes, magnitude errors, initial rise estimate, and band identifiers as a function of time of the objects classified as SN II in the year 2019-2022, with probability larger than 0.6, initial rise rate greater than 0.5 mag/day in ZTF g and r-band and number of detections greater than 50.\n*/\n\nWITH sn2_objects AS (\n  SELECT o.oid\n  FROM object o\n  INNER JOIN probability p ON o.oid = p.oid\n  WHERE p.class_name = 'SNII' \n    AND p.probability > 0.6\n    AND o.firstmjd BETWEEN '2019-01-01'::TIMESTAMP AND '2022-12-31'::TIMESTAMP\n    AND o.ndet > 50\n)\nSELECT \n  d.oid,\n  d.candid,\n  d.mjd,\n  d.fid,\n  d.magpsf,\n  d.sigmapsf,\n  m.dmdt_first,\n  m.fid\nFROM detection d\nINNER JOIN sn2_objects so ON d.oid = so.oid\nINNER JOIN magstat m ON d.oid = m.oid AND d.fid = m.fid\nWHERE m.dmdt_first > 0.5\n  AND m.fid IN (1, 2) -- g and r-band\nORDER BY d.oid, d.mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4505, "input_tokens": 119, "output_tokens": 363, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "4-1", "response": "/*\nGet the object identifier, candidate identifier, magnitudes, magnitude errors, initial rise estimate, and band identifiers as a function of time of the objects classified as SN II in the year 2019-2022, with probability larger than 0.6, initial rise rate greater than 0.5 mag/day in ZTF g and r-band and number of detections greater than 50.\n*/\n\nWITH sn2_objects AS (\n  SELECT o.oid\n  FROM object o\n  INNER JOIN probability p ON o.oid = p.oid\n  WHERE p.class_name = 'SNII' \n    AND p.probability > 0.6\n    AND o.firstmjd BETWEEN '2019-01-01'::TIMESTAMP AND '2022-12-31'::TIMESTAMP\n    AND o.ndet > 50\n)\nSELECT \n  d.oid,\n  d.candid,\n  d.mjd,\n  d.fid,\n  d.magpsf,\n  d.sigmapsf,\n  m.dmdt_first,\n  m.fid\nFROM detection d\nINNER JOIN sn2_objects so ON d.oid = so.oid\nINNER JOIN magstat m ON d.oid = m.oid AND d.fid = m.fid\nWHERE m.dmdt_first > 0.5\n  AND m.fid IN (1, 2) -- g and r-band\nORDER BY d.oid, d.mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 4505, "cache_read_input_tokens": 0, "input_tokens": 119, "output_tokens": 363, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "25-0", "response": "/*\nThis query retrieves objects that meet the following criteria:\n1. Located within 10 degrees of the specified coordinates:\n   - ('source_1', 160.18301441363647, 33.0164673528409)\n   - ('source_2', 174.21524897555543, 44.83789535222221)\n2. Had their first detection within the first 7 days of February (between mjd 59976.0 and 59982.0)\n3. Have a SN probability greater than 0.4 in the stamp classifier, with ranking=1\n*/\n\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.oid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.probability > 0.4\n  AND p.ranking = 1\n  AND o.firstmjd BETWEEN 59976.0 AND 59982.0\n  AND (\n    q3c_join(o.meanra, o.meandec, c.ra, c.dec, 10) \n    OR q3c_join(o.meanra, o.meandec, c.ra, c.dec, 10)\n  )\nFROM catalog c;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 157, "output_tokens": 380, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "25-1", "response": "/*\nThis query retrieves objects that meet the following criteria:\n1. Objects within 10 degrees of the specified coordinates:\n   - ('source_1', 160.18301441363647, 33.0164673528409)\n   - ('source_2', 174.21524897555543, 44.83789535222221)\n2. Objects with their first detection in the first 7 days of February (between mjd 59976.0 and 59982.0)\n3. Objects with SN probability > 0.4 and ranking = 1 in the stamp classifier\n*/\n\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT o.oid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier' \n  AND p.ranking = 1\n  AND p.probability > 0.4\n  AND o.firstmjd BETWEEN 59976.0 AND 59982.0\n  AND (\n    q3c_join(o.meanra, o.meandec, c.ra, c.dec, 10) \n    OR q3c_join(o.meanra, o.meandec, c.ra, c.dec, 10)\n  )\nFROM catalog c;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 157, "output_tokens": 368, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "7-0", "response": "/*\nGet the object identifiers and probabilities in the stamp classifier for objects whose most likely class according to the stamp classifier is SN, and that had their first detection in January of 2023\n*/\nSELECT \n    o.oid,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'SN'\n    AND o.firstmjd BETWEEN 59945.0 AND 59975.0;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 101, "output_tokens": 143, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "7-1", "response": "/*\nGet the object identifiers and probabilities in the stamp classifier for objects whose most likely class according to the stamp classifier is SN, and that had their first detection in January of 2023\n*/\nSELECT \n    o.oid,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'stamp_classifier'\n    AND p.ranking = 1\n    AND p.class_name = 'SN'\n    AND o.firstmjd BETWEEN 59945.0 AND 59975.0;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 101, "output_tokens": 143, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "2-0", "response": "/*\nThis query retrieves objects classified as Young Stellar Objects (YSO) by the Light Curve Classifier, with a probability greater than 0.7.\n\nThe key steps are:\n1. Select the object IDs (oid) from the probability table where the class_name is 'YSO' and the classifier_name is 'lc_classifier' and the probability is greater than 0.7.\n2. Join this subquery with the object table to get the full object details.\n*/\n\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n  SELECT p.oid\n  FROM probability p\n  WHERE p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.7\n);", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 58, "output_tokens": 189, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "2-1", "response": "/*\nThis query retrieves objects classified as Young Stellar Objects (YSO) by the Light Curve Classifier, with a probability greater than 0.7.\n\nThe key steps are:\n1. Select the object IDs (oid) from the probability table where the class_name is 'YSO' and the classifier_name is 'lc_classifier' and the probability is greater than 0.7.\n2. Join this subquery with the object table to get the full object details.\n*/\n\nSELECT o.*\nFROM object o\nWHERE o.oid IN (\n  SELECT p.oid\n  FROM probability p\n  WHERE p.class_name = 'YSO'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.probability > 0.7\n);", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 58, "output_tokens": 189, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "3-0", "response": "/*\n  This query retrieves objects classified as YSO by the lc_classifier with a probability greater than 0.7, \n  and were last detected during the specified date range in June.\n*/\nSELECT o.oid\nFROM object o\nINNER JOIN (\n  SELECT oid, probability \n  FROM probability\n  WHERE class_name = 'YSO' \n    AND classifier_name = 'lc_classifier'\n    AND probability > 0.7\n) p ON o.oid = p.oid\nWHERE o.lastmjd BETWEEN 60096.0 AND 60125.0;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 85, "output_tokens": 149, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "3-1", "response": "/*\n  This query retrieves objects classified as YSO by the lc_classifier with a probability greater than 0.7, \n  and were last detected during the specified date range in June.\n*/\nSELECT o.oid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier' \n  AND p.class_name = 'YSO'\n  AND p.probability > 0.7\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 85, "output_tokens": 139, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "23-0", "response": "/*\nThis query retrieves the objects most likely to be either \"SNIa\", \"SNIbc\", \"SNII\", or \"SLSN\" as classified by the 'lc_classifier', with a probability higher than 0.2. It returns all the classification probabilities for those objects.\n*/\nSELECT \n    p.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM probability p\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND p.probability > 0.2\nORDER BY p.oid, p.ranking;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 101, "output_tokens": 176, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "23-1", "response": "/*\nThis query retrieves the objects most likely to be either \"SNIa\", \"SNIbc\", \"SNII\", or \"SLSN\" as classified by the 'lc_classifier', with a probability higher than 0.2. It returns all the classification probabilities for those objects.\n*/\nSELECT \n    o.oid,\n    p.class_name,\n    p.probability,\n    p.ranking\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND p.probability > 0.2\nORDER BY o.oid, p.ranking;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 101, "output_tokens": 190, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "32-0", "response": "/*\nGiven the list of object identifiers (oids) provided, this query retrieves data from the ss_ztf table where the ssdistnr value is positive, and orders the results by the oid.\n*/\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqosfm', 'ZTF21aaqosfs', 'ZTF21aaqosff', \n              'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosfo', 'ZTF21aaqosly',\n              'ZTF21aaqosgi', 'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2355, "cache_read_input_tokens": 0, "input_tokens": 195, "output_tokens": 198, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "32-1", "response": "/*\nGiven the list of object identifiers (oids) provided, this query retrieves data from the ss_ztf table where the ssdistnr value is positive, and orders the results by the oid.\n*/\nSELECT *\nFROM ss_ztf\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqosfm', 'ZTF21aaqosfs', 'ZTF21aaqosff', \n              'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosfo', 'ZTF21aaqosly',\n              'ZTF21aaqosgi', 'ZTF21aaqospe')\n  AND ssdistnr > 0\nORDER BY oid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2355, "cache_read_input_tokens": 0, "input_tokens": 195, "output_tokens": 198, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "20-0", "response": "/*\nThis query retrieves objects that are most likely to be RR Lyrae (RRL) stars based on the light curve classifier, with a probability greater than 0.55 and at least 100 detections.\n\nThe key steps are:\n1. Use a subquery to get the OIDs of objects that have a probability greater than 0.55 for the 'RRL' class in the 'lc_classifier'.\n2. Join this subquery with the 'object' table to filter for objects with at least 100 detections.\n3. Select the relevant columns from the 'object' and 'probability' tables.\n*/\n\nSELECT \n  o.oid,\n  o.ndet,\n  o.meanra,\n  o.meandec,\n  p.probability\nFROM object o\nJOIN (\n  SELECT oid\n  FROM probability\n  WHERE class_name = 'RRL'\n    AND classifier_name = 'lc_classifier'\n    AND probability > 0.55\n    AND ranking = 1\n) p ON o.oid = p.oid\nWHERE o.ndet >= 100\nORDER BY p.probability DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3628, "input_tokens": 76, "output_tokens": 275, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "20-1", "response": "/*\nThis query retrieves objects that are most likely to be RR Lyrae (RRL) stars based on the light curve classifier, with a probability greater than 0.55 and at least 100 detections.\n\nThe key steps are:\n1. Use a subquery to get the OIDs of objects that have a probability greater than 0.55 for the 'RRL' class in the 'lc_classifier'.\n2. Join this subquery with the 'object' table to filter for objects with at least 100 detections.\n3. Select the relevant columns from the 'object' and 'probability' tables.\n*/\n\nSELECT \n  o.oid,\n  o.ndet,\n  o.meanra,\n  o.meandec,\n  p.probability\nFROM object o\nJOIN (\n  SELECT oid\n  FROM probability\n  WHERE class_name = 'RRL'\n    AND classifier_name = 'lc_classifier'\n    AND probability > 0.55\n    AND ranking = 1\n) p ON o.oid = p.oid\nWHERE o.ndet >= 100\nORDER BY p.probability DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 76, "output_tokens": 275, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "18-0", "response": "/*\nThis query retrieves the probabilities for all sources classified as AGN, QSO, or Blazar by the light curve classifier, with the following criteria:\n- Minimum number of detections: 40\n- Minimum time span between first and last detection: 200 days\n- Probability threshold:\n  - Blazar class: > 0.8\n  - AGN and QSO classes: > 0.95\nThe query returns the following columns:\noid, meanra, meandec, ndet, firstMJD, deltajd, g_r_mean_corr, classifier_name, class_name, ranking, probability\n*/\n\nWITH agn_qso_blazar AS (\n  SELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_mean_corr,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\n  FROM object o\n  JOIN probability p ON o.oid = p.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND (\n      (p.class_name = 'Blazar' AND p.probability > 0.8)\n      OR (p.class_name IN ('AGN', 'QSO') AND p.probability > 0.95)\n    )\n)\nSELECT * FROM agn_qso_blazar\nUNION\nSELECT * FROM agn_qso_blazar\nUNION\nSELECT * FROM agn_qso_blazar;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 226, "output_tokens": 444, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "18-1", "response": "/*\nThis query retrieves the probabilities for all sources classified as AGN, QSO, or Blazar by the light curve classifier, with the following criteria:\n- Minimum number of detections: 40\n- Minimum time span between first and last detection: 200 days\n- Probability threshold:\n  - Blazar class: > 0.8\n  - AGN and QSO classes: > 0.95\nThe query returns the following columns:\noid, meanra, meandec, ndet, firstMJD, deltajd, g_r_mean_corr, classifier_name, class_name, ranking, probability\n*/\n\nWITH agn_qso_blazar AS (\n  SELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    o.firstmjd,\n    o.deltajd,\n    o.g_r_mean_corr,\n    p.classifier_name,\n    p.class_name,\n    p.ranking,\n    p.probability\n  FROM object o\n  JOIN probability p ON o.oid = p.oid\n  WHERE p.classifier_name = 'lc_classifier'\n    AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n    AND (\n      (p.class_name = 'Blazar' AND p.probability > 0.8)\n      OR (p.class_name IN ('AGN', 'QSO') AND p.probability > 0.95)\n    )\n)\nSELECT * FROM agn_qso_blazar\nUNION\nSELECT * FROM agn_qso_blazar\nUNION\nSELECT * FROM agn_qso_blazar;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 226, "output_tokens": 444, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "35-0", "response": "SELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 50, "output_tokens": 19, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "35-1", "response": "SELECT *\nFROM probability\nORDER BY oid\nLIMIT 10;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 50, "output_tokens": 19, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "11-0", "response": "/*\nObtain all the Type Ia SNe whose first detection happened last September, whose peak magnitude is above 19 and whose g-r color at maximum is below 1. Return the object identifier, the maximum g-r difference, the maximum magnitude, and the filter id.\n*/\n\nWITH september_objects AS (\n  SELECT oid\n  FROM object\n  WHERE firstmjd BETWEEN 60188.0 AND 60217.0\n)\nSELECT \n  so.oid,\n  o.g_r_max,\n  m.magmax,\n  m.fid\nFROM september_objects so\nJOIN object o ON so.oid = o.oid\nJOIN magstat m ON o.oid = m.oid\nWHERE \n  o.g_r_max < 1\n  AND m.magmax > 19\n  AND m.fid = 1 -- g-band\n  AND (\n    (SELECT probability FROM probability WHERE oid = so.oid AND class_name = 'SNIa' AND classifier_name = 'lc_classifier' AND ranking = 1) IS NOT NULL\n  );", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3850, "cache_read_input_tokens": 0, "input_tokens": 122, "output_tokens": 266, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "11-1", "response": "/*\nObtain all the Type Ia SNe whose first detection happened last September, whose peak magnitude is above 19 and whose g-r color at maximum is below 1. Return the object identifier, the maximum g-r difference, the maximum magnitude, and the filter id.\n*/\n\nWITH september_objects AS (\n  SELECT oid\n  FROM object\n  WHERE firstmjd BETWEEN 60188.0 AND 60217.0\n)\nSELECT \n  so.oid,\n  o.g_r_max,\n  m.magmax,\n  m.fid\nFROM september_objects so\nJOIN object o ON so.oid = o.oid\nJOIN magstat m ON o.oid = m.oid\nWHERE \n  o.g_r_max < 1 \n  AND m.magmax > 19\n  AND m.fid = 1 -- g-band\n  AND (\n    (SELECT probability FROM probability WHERE oid = so.oid AND class_name = 'SNIa' AND ranking = 1) IS NOT NULL\n  );", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3850, "cache_read_input_tokens": 0, "input_tokens": 122, "output_tokens": 255, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "9-0", "response": "/*\nGet the object identifiers that had their first detection in July 2023, are within a search radius of 1000 arcmin from the center of the Abell 370 galaxy cluster (centered at RA=39.97, Dec=-1.5768), have sgscore1<0.3 and their highest probability in the stamp classifier is not obtained for class Asteroid nor class Bogus. Get the columns 'oid', 'value', 'name', 'version', 'meanra', 'meandec', the source identifier, and the distance obtained from the q3c_dist function as 'dist'.\n*/\nWITH catalog AS (\n    SELECT 39.97 AS center_ra, -1.5768 AS center_dec\n)\nSELECT \n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    o.meanra,\n    o.meandec,\n    x.oid_catalog AS source_id,\n    q3c_dist(o.meanra, o.meandec, c.center_ra, c.center_dec) AS dist\nFROM object o\nJOIN feature f ON o.oid = f.oid\nJOIN xmatch x ON o.oid = x.oid\nCROSS JOIN catalog c\nWHERE \n    o.firstmjd BETWEEN 60126.0 AND 60156.0 -- July 2023\n    AND o.sgscore1 < 0.3\n    AND NOT EXISTS (\n        SELECT 1 \n        FROM probability p\n        WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name IN ('asteroid', 'bogus')\n        AND p.ranking = 1\n    )\n    AND q3c_radial_query(o.meanra, o.meandec, c.center_ra, c.center_dec, 1000.0/16.16667) -- 1000 arcmin = 16.16667 degrees\n;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5954, "cache_read_input_tokens": 0, "input_tokens": 216, "output_tokens": 489, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "9-1", "response": "/*\nGet the object identifiers that had their first detection in July 2023, are within a search radius of 1000 arcmin from the center of the Abell 370 galaxy cluster (centered at RA=39.97, Dec=-1.5768), have sgscore1<0.3 and their highest probability in the stamp classifier is not obtained for class Asteroid nor class Bogus. Get the columns 'oid', 'value', 'name', 'version', 'meanra', 'meandec', the source identifier, and the distance obtained from the q3c_dist function as 'dist'.\n*/\nWITH catalog AS (\n    SELECT 39.97 AS center_ra, -1.5768 AS center_dec\n)\nSELECT \n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    o.meanra,\n    o.meandec,\n    x.oid_catalog AS source_id,\n    q3c_dist(o.meanra, o.meandec, c.center_ra, c.center_dec) AS dist\nFROM object o\nJOIN feature f ON o.oid = f.oid\nJOIN xmatch x ON o.oid = x.oid\nCROSS JOIN catalog c\nWHERE \n    o.firstmjd BETWEEN 60126.0 AND 60156.0 -- July 2023\n    AND o.sgscore1 < 0.3\n    AND NOT EXISTS (\n        SELECT 1 \n        FROM probability p\n        WHERE p.oid = o.oid\n        AND p.classifier_name = 'stamp_classifier'\n        AND p.class_name IN ('asteroid', 'bogus')\n        AND p.ranking = 1\n    )\n    AND q3c_radial_query(o.meanra, o.meandec, c.center_ra, c.center_dec, 1000.0/16.16667) -- 1000 arcmin = 16.16667 degrees\n;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5954, "cache_read_input_tokens": 0, "input_tokens": 216, "output_tokens": 489, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "5-0", "response": "/*\nGet the object identifier, candidate identifier of the detections, name and value of the feature, psf magnitudes, magnitude errors, and band identifiers renaming the feature fid column as 'feature_fid', as a function of time of the objects classified as SN II with probability larger than 0.6, number of detections greater than 50 and difference between minimum and maximum magnitudes in ZTF g-band greater than 2 mag. Order the results by oid.\n*/\nSELECT \n    o.oid,\n    d.candid,\n    f.name,\n    f.value,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid AS feature_fid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nJOIN feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'SNII' \n    AND p.probability > 0.6\n    AND o.ndet > 50\n    AND (SELECT MAX(magpsf) - MIN(magpsf) FROM detection WHERE oid = o.oid AND fid = 1) > 2\nORDER BY o.oid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 6471, "cache_read_input_tokens": 0, "input_tokens": 139, "output_tokens": 300, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "5-1", "response": "/*\nThis query retrieves the requested information for objects classified as SN II with probability greater than 0.6, having more than 50 detections and a g-band magnitude difference greater than 2.\n\nThe key steps are:\n1. Join the object, probability, and detection tables to get the required data.\n2. Filter the objects based on the SN II probability, number of detections, and g-band magnitude difference.\n3. Select the desired columns, renaming the 'fid' column as 'feature_fid'.\n4. Order the results by the object identifier (oid).\n*/\n\nSELECT \n    o.oid,\n    d.candid,\n    f.name,\n    f.value,\n    d.magpsf,\n    d.sigmapsf,\n    d.fid AS feature_fid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nJOIN feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'SNII' \n    AND p.probability > 0.6\n    AND o.ndet > 50\n    AND o.g_r_max - o.g_r_min > 2\nORDER BY o.oid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 6471, "input_tokens": 139, "output_tokens": 309, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "0-0", "response": "/*\nThis query retrieves objects that are likely to be Young Stellar Objects (YSOs) with some periodicities. The criteria are:\n- Probability of being a YSO is greater than 0.7\n- Photometric period is between 3 and 10 days\n- Variation amplitude is greater than 0.5 mag\nThe results are sorted by the YSO probability in descending order, and the returned columns are:\n- Object identifier (oid)\n- YSO probability\n- Feature value\n- Feature name\n- Filter ID (fid)\n- Feature version\n*/\n\nSELECT \n    o.oid,\n    p.probability AS yso_probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO' \n    AND p.probability > 0.7\n    AND f.name IN ('Period_band', 'delta_mag_fid')\n    AND f.value BETWEEN 3 AND 10 -- Period between 3 and 10 days\n    AND f.value > 0.5 -- Variation amplitude greater than 0.5 mag\nORDER BY p.probability DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5884, "cache_read_input_tokens": 0, "input_tokens": 123, "output_tokens": 324, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "0-1", "response": "/*\nThis query retrieves objects that are likely to be Young Stellar Objects (YSOs) with some periodicities. The criteria are:\n- Probability of being a YSO is greater than 0.7\n- Photometric period is between 3 and 10 days\n- Variation amplitude is greater than 0.5 mag\nThe results are sorted by the YSO probability in descending order, and the returned columns are:\n- Object identifier (oid)\n- YSO probability\n- Feature value\n- Feature name\n- Filter ID (fid)\n- Feature version\n*/\n\nSELECT \n    o.oid,\n    p.probability AS yso_probability,\n    f.value,\n    f.name,\n    f.fid,\n    f.version\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN feature f ON o.oid = f.oid\nWHERE \n    p.class_name = 'YSO' \n    AND p.probability > 0.7\n    AND f.name IN ('Period_band', 'delta_mag_fid')\n    AND f.value BETWEEN 3 AND 10 -- Period between 3 and 10 days\n    AND f.value > 0.5 -- Variation amplitude greater than 0.5 mag\nORDER BY p.probability DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5884, "cache_read_input_tokens": 0, "input_tokens": 123, "output_tokens": 324, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "28-0", "response": "SELECT table_name \nFROM information_schema.tables\nWHERE table_schema = 'alerce';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2159, "input_tokens": 63, "output_tokens": 26, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "28-1", "response": "SELECT table_name \nFROM information_schema.tables\nWHERE table_schema = 'alerce';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2159, "cache_read_input_tokens": 0, "input_tokens": 63, "output_tokens": 26, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "36-0", "response": "/*\nThis query retrieves the feature names and values, as well as the object identifier (oid), for the object with the oid 'ZTF20aaelulu' from the 'feature' table.\n*/\nSELECT o.oid, f.name, f.value\nFROM object o\nJOIN feature f ON o.oid = f.oid\nWHERE o.oid = 'ZTF20aaelulu';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5594, "input_tokens": 66, "output_tokens": 103, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "36-1", "response": "/*\nThis query retrieves the feature names and values, as well as the object identifier (oid), for the object with the oid 'ZTF20aaelulu' from the 'feature' table.\n*/\nSELECT o.oid, f.name, f.value\nFROM object o\nJOIN feature f ON o.oid = f.oid\nWHERE o.oid = 'ZTF20aaelulu';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5594, "cache_read_input_tokens": 0, "input_tokens": 66, "output_tokens": 103, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "38-0", "response": "/*\nThis query retrieves the top 1000 active galactic nuclei (AGN) and top 1000 quasi-stellar object (QSO) candidates from the ALeRCE database, ordered by their probability in descending order. The objects must have a probability greater than 0.6 for AGN and 0.5 for QSO according to the light curve classifier. Additionally, the objects must have between 30 and 200 detections.\n*/\n\nWITH agn AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'AGN' AND classifier_name = 'lc_classifier' AND probability > 0.6\n    ORDER BY probability DESC\n    LIMIT 1000\n),\nqso AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'QSO' AND classifier_name = 'lc_classifier' AND probability > 0.5\n    ORDER BY probability DESC\n    LIMIT 1000\n)\nSELECT o.oid\nFROM object o\nJOIN agn a ON o.oid = a.oid\nJOIN qso q ON o.oid = q.oid\nWHERE o.ndet BETWEEN 30 AND 200\nORDER BY a.probability DESC, q.probability DESC\nLIMIT 1000;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 108, "output_tokens": 309, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "38-1", "response": "/*\nThis query retrieves the top 1000 active galactic nuclei (AGN) and top 1000 quasi-stellar object (QSO) candidates from the ALeRCE database, ordered by their probability in descending order. The objects must have a probability greater than 0.6 for AGN and 0.5 for QSO according to the light curve classifier. Additionally, the objects must have between 30 and 200 detections.\n*/\n\nWITH agn AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'AGN' AND classifier_name = 'lc_classifier' AND probability > 0.6\n    ORDER BY probability DESC\n    LIMIT 1000\n),\nqso AS (\n    SELECT oid, probability\n    FROM probability\n    WHERE class_name = 'QSO' AND classifier_name = 'lc_classifier' AND probability > 0.5\n    ORDER BY probability DESC\n    LIMIT 1000\n)\nSELECT o.oid\nFROM object o\nJOIN agn a ON o.oid = a.oid\nJOIN qso q ON o.oid = q.oid\nWHERE o.ndet BETWEEN 30 AND 200\nORDER BY a.probability DESC, q.probability DESC\nLIMIT 1000;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 108, "output_tokens": 309, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "24-0", "response": "/*\nThis query retrieves objects within 10 degrees of the given positions ('source_1' and 'source_2') and with their first detection in the first 7 days of February.\n\nThe key steps are:\n1. Define the source positions in a CTE (WITH clause)\n2. Use the q3c_radial_query function to filter objects within 10 degrees of the source positions\n3. Filter the objects to only those with a firstmjd between 59976.0 (Feb 1) and 59982.0 (Feb 7)\n4. Select the relevant columns from the object table\n*/\n\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT \n    o.oid,\n    o.firstmjd,\n    o.lastmjd,\n    o.ndethist,\n    o.ncovhist,\n    o.g_r_max,\n    o.g_r_mean_corr,\n    o.meanra,\n    o.meandec,\n    o.sigmara,\n    o.sigmadec\nFROM object o\nJOIN catalog c ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)\nWHERE o.firstmjd BETWEEN 59976.0 AND 59982.0\nORDER BY o.firstmjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3406, "cache_read_input_tokens": 0, "input_tokens": 141, "output_tokens": 384, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "24-1", "response": "/*\nThis query retrieves objects within 10 degrees of the given positions ('source_1' and 'source_2') and with their first detection in the first 7 days of February.\n\nThe key steps are:\n1. Define the source positions in a CTE (WITH clause)\n2. Use the q3c_radial_query function to filter objects within 10 degrees of the source positions\n3. Filter the objects to only those with a firstmjd between 59976.0 (Feb 1) and 59982.0 (Feb 7)\n4. Select the relevant columns from the object table\n*/\n\nWITH catalog (source_id, ra, dec) AS (\n    VALUES \n        ('source_1', 160.18301441363647, 33.0164673528409),\n        ('source_2', 174.21524897555543, 44.83789535222221)\n)\nSELECT \n    o.oid,\n    o.firstmjd,\n    o.lastmjd,\n    o.ndethist,\n    o.ncovhist,\n    o.g_r_max,\n    o.g_r_mean_corr,\n    o.meanra,\n    o.meandec,\n    o.sigmara,\n    o.sigmadec\nFROM object o\nJOIN catalog c ON q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, 10)\nWHERE o.firstmjd BETWEEN 59976.0 AND 59982.0\nORDER BY o.firstmjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3406, "cache_read_input_tokens": 0, "input_tokens": 141, "output_tokens": 384, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "31-0", "response": "/*\nThis query retrieves the requested information for objects classified by the light curve classifier that were first detected between February 1 and 2 of 2023.\n\nThe key steps are:\n1. Filter the object table to get objects first detected in the given date range.\n2. Join with the probability table to get the class names for the 'lc_classifier'.\n3. Select the galactic coordinates, feature columns, class name, and object identifiers.\n*/\n\nSELECT \n    o.gal_l, \n    o.gal_b,\n    f.name, \n    f.value,\n    p.class_name,\n    o.oid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN feature f ON o.oid = f.oid\nWHERE p.classifier_name = 'lc_classifier' \n  AND o.firstmjd BETWEEN 59976.0 AND 59978.0\n  AND p.ranking = 1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5816, "cache_read_input_tokens": 0, "input_tokens": 145, "output_tokens": 236, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "31-1", "response": "/*\nThis query retrieves the requested information for objects classified by the light curve classifier that were first detected between February 1 and February 2, 2023.\n\nThe key steps are:\n1. Filter the object table to get objects with firstmjd between 59976.0 and 59978.0 (February 1 and 2, 2023).\n2. Join the object and probability tables to get the class name and classifier name.\n3. Select the galactic coordinates (gal_l, gal_b), feature columns, class name, and object identifier (oid).\n4. Filter the probability table to only include rows where the classifier_name is 'lc_classifier' (the light curve classifier).\n*/\n\nSELECT \n    o.gal_l, \n    o.gal_b,\n    f.name, \n    f.value,\n    p.class_name,\n    o.oid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN feature f ON o.oid = f.oid\nWHERE o.firstmjd BETWEEN 59976.0 AND 59978.0\n  AND p.classifier_name = 'lc_classifier'\nORDER BY o.oid, f.name;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5816, "cache_read_input_tokens": 0, "input_tokens": 145, "output_tokens": 299, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "33-0", "response": "/*\nThis query retrieves the requested information for the given list of object IDs (oids).\nIt selects the relevant columns from the detection table, including the oid, candid, mjd, and fid.\nThe WHERE clause filters the results to only include the specified oid values.\n*/\n\nSELECT \n    oid,\n    candid,\n    mjd,\n    fid\nFROM detection\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3406, "cache_read_input_tokens": 0, "input_tokens": 184, "output_tokens": 212, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "33-1", "response": "/*\nThis query retrieves the requested information for the given list of object IDs (oids).\nIt selects the relevant columns from the detection table, including the oid, candid, mjd, and fid.\nThe WHERE clause filters the results to only include the specified oid values.\n*/\n\nSELECT \n    oid,\n    candid,\n    mjd,\n    fid\nFROM detection\nWHERE oid IN ('ZTF21aaqosfj', 'ZTF21aaqoski', 'ZTF21aaqoskz', 'ZTF21aaqosly', 'ZTF21aaqosmj', 'ZTF21aaqosmi', 'ZTF21aaqosmk', 'ZTF21aaqosmm', 'ZTF21aaqosmp', 'ZTF21aaqosmq');", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3406, "input_tokens": 184, "output_tokens": 212, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "6-0", "response": "/*\nThis query retrieves the requested information for objects classified as SN II with probability greater than 0.6, initial rise rate greater than 0.5 mag/day in ZTF g and r-band, at least 100 days of observations in r-band, and more than 30 detections, during the years 2019-2022.\n\nThe key steps are:\n1. Use a subquery to get the OIDs of the relevant objects based on the probability and classification criteria.\n2. Join the subquery with the detection table to get the candidate IDs, magnitudes, magnitude errors, and band IDs.\n3. Filter the results to only include objects with the specified rise rate, observation duration, and number of detections.\n4. Rename the fid column as f_id.\n*/\n\nWITH sn2_objects AS (\n  SELECT oid\n  FROM probability\n  WHERE class_name = 'SNII'\n    AND probability > 0.6\n    AND classifier_name = 'lc_classifier'\n)\nSELECT\n  d.oid,\n  d.candid,\n  d.magpsf,\n  d.sigmapsf,\n  d.fid AS f_id\nFROM detection d\nJOIN sn2_objects o ON d.oid = o.oid\nWHERE d.mjd BETWEEN 58484.0 AND 59944.0\n  AND d.fid IN (1, 2)\n  AND EXISTS (\n    SELECT 1\n    FROM magstat m\n    WHERE m.oid = d.oid\n      AND m.fid = d.fid\n      AND m.dmdt_first > 0.5\n      AND m.ndet > 30\n      AND m.lastmjd - m.firstmjd > 100\n  )\nORDER BY d.oid, d.mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4505, "input_tokens": 185, "output_tokens": 437, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "6-1", "response": "/*\nThis query retrieves the requested information for objects classified as SN II with probability greater than 0.6, initial rise rate greater than 0.5 mag/day in ZTF g and r-band, at least 100 days of observations in r-band, and more than 30 detections, during the years 2019-2022.\n\nThe key steps are:\n1. Use a subquery to get the OIDs of the relevant objects based on the probability and classification criteria.\n2. Join the subquery with the detection table to get the candidate IDs, magnitudes, magnitude errors, and band IDs.\n3. Filter the results to only include objects with the desired properties (initial rise rate, observation duration, number of detections).\n4. Rename the fid column to f_id.\n*/\n\nWITH sn2_objects AS (\n  SELECT oid\n  FROM probability\n  WHERE class_name = 'SNII'\n    AND probability > 0.6\n    AND classifier_name = 'lc_classifier'\n)\nSELECT\n  d.oid,\n  d.candid,\n  d.magpsf,\n  d.sigmapsf,\n  d.fid AS f_id\nFROM detection d\nJOIN sn2_objects o ON d.oid = o.oid\nWHERE d.mjd BETWEEN 58484.0 AND 59944.0 -- 2019-2022\n  AND d.fid IN (1, 2) -- g and r-band\n  AND EXISTS (\n    SELECT 1\n    FROM magstat ms\n    WHERE ms.oid = d.oid\n      AND ms.fid = d.fid\n      AND ms.dmdt_first > 0.5 -- initial rise rate > 0.5 mag/day\n      AND ms.ndet > 30 -- more than 30 detections\n      AND ms.lastmjd - ms.firstmjd > 100 -- at least 100 days of observations in r-band\n  )\nORDER BY d.oid, d.mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4505, "input_tokens": 185, "output_tokens": 490, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "21-0", "response": "/*\nThis query retrieves sources classified as AGN, QSO, or Blazar by the ALeRCE light curve classifier, with a minimum of 30 detections, a minimum time span of 200 days between the first and last detection, and a predicted class probability greater than 0.5.\n*/\nSELECT o.oid\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n  AND p.probability > 0.5\n  AND o.ndet >= 30\n  AND o.deltajd >= 200\nORDER BY p.ranking;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 112, "output_tokens": 179, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "21-1", "response": "/*\nThis query retrieves sources classified as AGN, QSO, or Blazar by the ALeRCE light curve classifier, with a minimum of 30 detections, a minimum time span of 200 days between the first and last detection, and a predicted class probability greater than 0.5.\n*/\nSELECT o.oid\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n  AND p.probability > 0.5\n  AND o.ndet >= 30\n  AND o.deltajd >= 200\nORDER BY p.ranking;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 112, "output_tokens": 179, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "26-0", "response": "/*\nQuery objects which appeared between august 25 and september 10 of 2022, which are classified as supernova by the stamp classifier with a probability greater than 0.5 or which have more than one detection\n*/\nSELECT o.oid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.probability > 0.5\nUNION\nSELECT oid\nFROM object\nWHERE ndet > 1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 115, "output_tokens": 158, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "26-1", "response": "/*\nQuery objects which appeared between august 25 and september 10 of 2022, which are classified as supernova by the stamp classifier with a probability greater than 0.5 or which have more than one detection\n*/\nSELECT o.oid\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE o.firstmjd BETWEEN 59816.0 AND 59832.0\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.class_name = 'SN'\n  AND p.probability > 0.5\nUNION\nSELECT oid\nFROM object\nWHERE ndet > 1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 115, "output_tokens": 158, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "29-0", "response": "-- Retrieve the requested columns for the specified oids from the ps1_ztf table\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq');", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3075, "cache_read_input_tokens": 0, "input_tokens": 158, "output_tokens": 122, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "29-1", "response": "-- Query to retrieve the requested columns for the specified oids from the ps1_ztf table\nSELECT oid, sgmag1, srmag1, simag1, szmag1, sgscore1\nFROM ps1_ztf\nWHERE oid IN ('ZTF20aawwmqv', 'ZTF21aasqvza', 'ZTF19adcftfw', 'ZTF19aaxqrku', 'ZTF19adceucq');", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3075, "cache_read_input_tokens": 0, "input_tokens": 158, "output_tokens": 123, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "52-0", "response": "/*\nThis query retrieves all rows from the 'forced_photometry' table for the objects with ZTF identifiers 'ZTF23aatekmu' and 'ZTF22abpxoyy' that have a 'procstatus' value of '0'.\n*/\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3565, "cache_read_input_tokens": 0, "input_tokens": 93, "output_tokens": 116, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "52-1", "response": "/*\nThis query retrieves all rows from the 'forced_photometry' table for the objects with ZTF identifiers 'ZTF23aatekmu' and 'ZTF22abpxoyy' where the 'procstatus' column has a value of '0'.\n*/\nSELECT *\nFROM forced_photometry\nWHERE oid IN ('ZTF23aatekmu', 'ZTF22abpxoyy')\n  AND procstatus = '0';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3565, "cache_read_input_tokens": 0, "input_tokens": 93, "output_tokens": 118, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "109-0", "response": "/*\nThis query finds at most 10 cases where the 'LinearTrend' feature is larger than 5 and the difference between the last and first detection date is larger than 1 day. It returns the following columns:\n- ZTF object identifier\n- Number of detections for the ZTF object\n- Classifier version, class, and probability for the top ranked classification\n- Value and filter identifier for the 'LinearTrend' feature\n*/\nSELECT\n    o.oid,\n    o.ndet,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    f.value,\n    f.fid\nFROM\n    object o\n    JOIN feature f ON o.oid = f.oid\n    JOIN probability p ON o.oid = p.oid\nWHERE\n    f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.deltajd > 1\n    AND p.ranking = 1\nLIMIT 10;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5816, "cache_read_input_tokens": 0, "input_tokens": 134, "output_tokens": 242, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "109-1", "response": "/*\nThis query finds at most 10 cases where the 'LinearTrend' feature is larger than 5 and the difference between the last and first detection date is larger than 1 day. It returns the following columns:\n- ZTF object identifier\n- Number of detections for the ZTF object\n- Classifier version, class, and probability for the top ranked classification\n- Value and filter identifier for the 'LinearTrend' feature\n*/\nSELECT\n    o.oid,\n    o.ndet,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    f.value,\n    f.fid\nFROM\n    object o\n    JOIN feature f ON o.oid = f.oid\n    JOIN probability p ON o.oid = p.oid\nWHERE\n    f.name = 'LinearTrend'\n    AND f.value > 5\n    AND o.deltajd > 1\n    AND p.ranking = 1\nLIMIT 10;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5816, "cache_read_input_tokens": 0, "input_tokens": 134, "output_tokens": 242, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "49-0", "response": "/*\nThis query retrieves all rows from the 'feature' table for the objects with ZTF identifiers 'ZTF20abywohm' and 'ZTF20abxgxjd' where the 'fid' column indicates the g band (fid=1).\n*/\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5594, "input_tokens": 84, "output_tokens": 115, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "49-1", "response": "/*\nThis query retrieves all rows from the 'feature' table for the objects with ZTF identifiers 'ZTF20abywohm' and 'ZTF20abxgxjd' where the 'fid' column indicates the g band (fid=1).\n*/\nSELECT *\nFROM feature\nWHERE oid IN ('ZTF20abywohm', 'ZTF20abxgxjd')\n  AND fid = 1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5594, "cache_read_input_tokens": 0, "input_tokens": 84, "output_tokens": 115, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "46-0", "response": "/*\nThis query retrieves all the columns from the 'detection' table for the ZTF object 'ZTF23aaqmddq', sorted by the detection date (mjd).\n*/\nSELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2814, "cache_read_input_tokens": 0, "input_tokens": 67, "output_tokens": 77, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "46-1", "response": "/*\nThis query retrieves all the columns from the 'detection' table for the ZTF object 'ZTF23aaqmddq', sorted by the detection date (mjd).\n*/\nSELECT *\nFROM detection\nWHERE oid = 'ZTF23aaqmddq'\nORDER BY mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2814, "cache_read_input_tokens": 0, "input_tokens": 67, "output_tokens": 77, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "93-0", "response": "/*\nRetrieve all columns from the 'probability' and 'magstat' tables for ZTF objects that satisfy the following conditions:\n- The 'asteroid' class is first ranked in the stamp classifier\n- The object has a computed corrected light curve\nLimit the results to 10 rows and order by the object identifier from the 'probability' table.\n*/\nSELECT p.*, m.*\nFROM probability p\nJOIN magstat m ON p.oid = m.oid\nWHERE p.classifier_name = 'stamp_classifier' \n  AND p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND m.corrected = true\nORDER BY p.oid\nLIMIT 10;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3258, "input_tokens": 107, "output_tokens": 170, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "93-1", "response": "/*\nRetrieve all columns from the 'probability' and 'magstat' tables for ZTF objects that satisfy the following conditions:\n- The 'asteroid' class is first ranked in the stamp classifier\n- The object has a computed corrected light curve\nLimit the results to 10 rows and order by the object identifier from the 'probability' table.\n*/\nSELECT p.*, m.*\nFROM probability p\nJOIN magstat m ON p.oid = m.oid\nWHERE p.classifier_name = 'stamp_classifier' \n  AND p.class_name = 'asteroid'\n  AND p.ranking = 1\n  AND m.corrected = true\nORDER BY p.oid\nLIMIT 10;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3258, "cache_read_input_tokens": 0, "input_tokens": 107, "output_tokens": 170, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "62-0", "response": "/*\nGet the following columns from the 'probability' table for the ZTF object 'ZTF21aadoizf':\n- oid\n- classifier_name\n- classifier_version\n- class_name\n- probability\n- ranking\n\nSort the results by classifier_name in ascending order and probability in descending order.\n*/\nSELECT \n    oid,\n    classifier_name,\n    classifier_version,\n    class_name,\n    probability,\n    ranking\nFROM probability\nWHERE oid = 'ZTF21aadoizf'\nORDER BY classifier_name ASC, probability DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 95, "output_tokens": 144, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "62-1", "response": "/*\nGet the following columns from the 'probability' table for the ZTF object 'ZTF21aadoizf':\n- oid\n- classifier_name\n- classifier_version\n- class_name\n- probability\n- ranking\n\nSort the results by classifier_name in ascending order and probability in descending order.\n*/\n\nSELECT \n    oid,\n    classifier_name,\n    classifier_version,\n    class_name,\n    probability,\n    ranking\nFROM probability\nWHERE oid = 'ZTF21aadoizf'\nORDER BY classifier_name ASC, probability DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 95, "output_tokens": 144, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "95-0", "response": "/*\nThis query retrieves the requested information for the two specified ZTF objects:\n1. All matches in the 'xmatch' table\n2. The features 'W1-W2', 'g-W2', and 'r-W2' in the 'lc_classifier_1.2.1-P' version\nThe results are joined and sorted by the catalog object identifier and feature name.\n*/\n\nSELECT\n    o.oid AS ztf_id,\n    x.oid_catalog AS catalog_id,\n    x.dist AS distance,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM object o\nJOIN xmatch x ON o.oid = x.oid\nJOIN feature f ON o.oid = f.oid\nWHERE o.oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n  AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n  AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY x.oid_catalog, f.name;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5800, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 281, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "95-1", "response": "/*\nThis query retrieves the requested information for the two specified ZTF objects:\n1. All matches in the 'xmatch' table\n2. The features 'W1-W2', 'g-W2', and 'r-W2' in the 'lc_classifier_1.2.1-P' version\nThe results are joined and sorted by the catalog object identifier and feature name.\n*/\n\nSELECT\n    o.oid AS ztf_id,\n    x.oid_catalog AS catalog_id,\n    x.dist AS distance,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM object o\nJOIN xmatch x ON o.oid = x.oid\nJOIN feature f ON o.oid = f.oid\nWHERE o.oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n  AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n  AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY x.oid_catalog, f.name;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5800, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 281, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "85-0", "response": "/*\nThis query retrieves all detections for the ZTF object 'ZTF20actqnhg', sorted by the detection date (mjd). It returns the following columns:\n- mjd (detection date)\n- isdiffpos (flag indicating whether the difference is positive or negative)\n- magpsf (difference magnitude)\n- sigmapsf (difference magnitude uncertainty)\n- All columns from the 'dataquality' table for the corresponding epochs\nThe query first selects the relevant columns from the 'detection' table for the given object, and then joins with the 'dataquality' table to include the additional data quality information.\n*/\n\nSELECT \n    d.mjd,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    dq.*\nFROM detection d\nJOIN dataquality dq ON d.candid = dq.candid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 4342, "cache_read_input_tokens": 0, "input_tokens": 98, "output_tokens": 238, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "85-1", "response": "/*\nThis query retrieves all detections for the ZTF object 'ZTF20actqnhg', sorted by the detection date (mjd). It returns the following columns:\n- mjd (detection date)\n- isdiffpos (flag indicating whether the difference is positive or negative)\n- magpsf (difference magnitude)\n- sigmapsf (difference magnitude uncertainty)\n- All columns from the 'dataquality' table for the corresponding epochs\nThe query first selects the relevant columns from the 'detection' table for the given object, and then joins with the 'dataquality' table to include the additional data quality information.\n*/\n\nSELECT \n    d.mjd,\n    d.isdiffpos,\n    d.magpsf,\n    d.sigmapsf,\n    dq.*\nFROM detection d\nJOIN dataquality dq ON d.candid = dq.candid\nWHERE d.oid = 'ZTF20actqnhg'\nORDER BY d.mjd;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4342, "input_tokens": 98, "output_tokens": 238, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "98-0", "response": "/*\nThis query first finds the OIDs (object IDs) of ZTF objects that have a probability greater than 0.7 of being a QSO according to the 'lc_classifier'. It does this by querying the 'probability' table and filtering for rows where 'classifier_name' is 'lc_classifier' and 'class_name' is 'QSO' and 'probability' is greater than 0.7. The query then limits the results to at most 200 distinct OIDs.\n\nNext, the query joins the filtered OIDs with the 'xmatch' and 'allwise' tables to retrieve all columns from those tables for the matching objects. The 'xmatch' table provides additional information about the object matches, while the 'allwise' table contains data from the ALLWISE catalog.\n*/\n\nSELECT x.*, a.*\nFROM (\n  SELECT DISTINCT oid\n  FROM probability\n  WHERE classifier_name = 'lc_classifier' \n    AND class_name = 'QSO'\n    AND probability > 0.7\n  LIMIT 200\n) p\nJOIN xmatch x ON p.oid = x.oid\nJOIN allwise a ON x.oid_catalog = a.oid_catalog;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3927, "cache_read_input_tokens": 0, "input_tokens": 88, "output_tokens": 301, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "98-1", "response": "/*\nThis query first finds the OIDs (object IDs) of ZTF objects that have a probability greater than 0.7 of being a QSO according to the 'lc_classifier'. It then joins the 'xmatch' and 'allwise' tables to retrieve all columns for those objects.\n\nThe key steps are:\n1. Use a subquery to get the OIDs of objects with QSO probability > 0.7 in the 'lc_classifier'.\n2. Join the 'xmatch' and 'allwise' tables on the OID to get the desired columns.\n3. Limit the result to at most 200 rows.\n*/\n\nSELECT x.*, a.*\nFROM xmatch x\nJOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE x.oid IN (\n  SELECT oid\n  FROM probability\n  WHERE classifier_name = 'lc_classifier' AND class_name = 'QSO' AND probability > 0.7\n  LIMIT 200\n)\nLIMIT 200;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3927, "input_tokens": 88, "output_tokens": 256, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "82-0", "response": "/*\nThis query retrieves all columns from the 'xmatch' table for the two objects with the specified ALLWISE catalog identifiers, sorted by the 'dist' column (distance to the closest ZTF object).\n*/\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3113, "cache_read_input_tokens": 0, "input_tokens": 88, "output_tokens": 99, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "82-1", "response": "/*\nThis query retrieves all columns from the 'xmatch' table for the two objects with the specified ALLWISE catalog identifiers, sorted by the 'dist' column (distance to the closest ZTF object).\n*/\nSELECT *\nFROM xmatch\nWHERE oid_catalog IN ('J175005.63-141341.8', 'J072933.88+030810.4')\nORDER BY dist;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3113, "cache_read_input_tokens": 0, "input_tokens": 88, "output_tokens": 99, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "64-0", "response": "/*\nThis query retrieves up to 1000 rows from the 'probability' table that have a probability greater than 0.95 for either the 'lc_classifier_top' or 'stamp_classifier' classifiers. It returns the ZTF identifier (oid), the name and version of the classifier, and the name of the class and its probability.\n*/\nSELECT \n    oid,\n    classifier_name,\n    classifier_version,\n    class_name,\n    probability\nFROM probability\nWHERE (classifier_name = 'lc_classifier_top' OR classifier_name = 'stamp_classifier')\n  AND probability > 0.95\nLIMIT 1000;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 104, "output_tokens": 162, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "64-1", "response": "/*\nThis query retrieves up to 1000 rows from the 'probability' table that have a probability greater than 0.95 for either the 'lc_classifier_top' or 'stamp_classifier' classifiers. It returns the ZTF identifier (oid), the name and version of the classifier, and the name of the class and its probability.\n*/\nSELECT \n    oid,\n    classifier_name,\n    classifier_version,\n    class_name,\n    probability\nFROM probability\nWHERE (classifier_name = 'lc_classifier_top' OR classifier_name = 'stamp_classifier')\n  AND probability > 0.95\nLIMIT 1000;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 104, "output_tokens": 162, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "87-0", "response": "/*\nThis query finds ZTF objects that:\n1. Have a probability greater than 0.7 of being either a long period variable (LPV) or an eclipsing binary (E) according to the 'lc_classifier' with version 'hierarchical_rf_1.1.0'\n2. The closest Gaia object has not changed compared to the first alert (unique1 = true)\nThe query returns all columns from the 'probability' and 'gaia_ztf' tables, and limits the result to 50 rows.\n*/\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.classifier_name = 'lc_classifier' \n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.class_name IN ('LPV', 'E')\n  AND p.probability > 0.7\n  AND g.unique1 = true\nLIMIT 50;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2658, "cache_read_input_tokens": 0, "input_tokens": 132, "output_tokens": 246, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "87-1", "response": "/*\nThis query finds ZTF objects that:\n1. Have a probability greater than 0.7 of being either a long period variable (LPV) or an eclipsing binary (E) according to the 'lc_classifier' with version 'hierarchical_rf_1.1.0'\n2. The closest Gaia object has not changed compared to the first alert (unique1 = true)\nThe query returns all columns from the 'probability' and 'gaia_ztf' tables, and limits the result to 50 rows.\n*/\nSELECT p.*, g.*\nFROM probability p\nJOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.classifier_name = 'lc_classifier' \n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.class_name IN ('LPV', 'E')\n  AND p.probability > 0.7\n  AND g.unique1 = true\nLIMIT 50;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2658, "cache_read_input_tokens": 0, "input_tokens": 132, "output_tokens": 246, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "108-0", "response": "/*\nThis query finds at most 15 ZTF objects that have more than 20 detections and a probability larger than 0.9 of being a bogus in the stamp classifier version 'stamp_classifier_1.0.4'. It returns the ZTF identifier, number of detections, probability, and Galactic latitude, ordered by the object identifier.\n*/\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    p.probability AS probability,\n    CAST(DEGREES(ATAN2(o.meandec, o.meanra)) AS NUMERIC(10,2)) AS gal_b\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'stamp_classifier' \n    AND p.classifier_version = '1.0.4'\n    AND p.class_name = 'bogus'\n    AND p.probability > 0.9\n    AND o.ndet > 20\nORDER BY o.oid\nLIMIT 15;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 125, "output_tokens": 260, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "108-1", "response": "/*\nThis query finds at most 15 ZTF objects that have more than 20 detections and a probability larger than 0.9 of being a bogus in the stamp classifier version 'stamp_classifier_1.0.4'. It returns the ZTF identifier, number of detections, probability, and Galactic latitude, ordered by the object identifier.\n*/\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    p.probability AS probability,\n    CAST(DEGREES(ATAN2(o.meandec, o.meanra)) AS NUMERIC(10,2)) AS gal_b\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE \n    p.classifier_name = 'stamp_classifier'\n    AND p.classifier_version = '1.0.4'\n    AND p.class_name = 'bogus'\n    AND p.probability > 0.9\n    AND o.ndet > 20\nORDER BY o.oid\nLIMIT 15;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 125, "output_tokens": 259, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "65-0", "response": "/*\nFind at most 500 rows in the 'probability' table that satisfy the following conditions for the stamp classifier:\n- the class name is either 'asteroid' or 'bogus'\n- the probability is between 0.7 and 0.99\nOrder the results by the object identifier in descending order.\n*/\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 138, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "65-1", "response": "/*\nFind at most 500 rows in the 'probability' table that satisfy the following conditions for the stamp classifier:\n- the class name is either 'asteroid' or 'bogus'\n- the probability is between 0.7 and 0.99\nOrder the results by the object identifier in descending order.\n*/\nSELECT *\nFROM probability\nWHERE classifier_name = 'stamp_classifier'\n  AND class_name IN ('asteroid', 'bogus')\n  AND probability BETWEEN 0.7 AND 0.99\nORDER BY oid DESC\nLIMIT 500;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 138, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "101-0", "response": "/*\nThis query finds ZTF objects that have a probability greater than 0.5 of being a long period variable (LPV) according to the light curve classifier, and also have a WISE W1 magnitude between 7 and 8. It returns all columns from the 'probability', 'xmatch', and 'allwise' tables for these objects, limiting the result to 100 rows.\n\nThe key steps are:\n1. Use a subquery to get the OIDs of objects that have a probability > 0.5 for the 'LPV' class in the 'lc_classifier'.\n2. Join this subquery with the 'xmatch' and 'allwise' tables to get the full set of columns.\n3. Add a filter for the WISE W1 magnitude being between 7 and 8.\n4. Limit the result to 100 rows.\n*/\n\nWITH lpv_objects AS (\n  SELECT oid\n  FROM probability\n  WHERE class_name = 'LPV' \n    AND classifier_name = 'lc_classifier'\n    AND probability > 0.5\n)\nSELECT p.*, x.*, a.*\nFROM lpv_objects lo\nJOIN probability p ON lo.oid = p.oid\nJOIN xmatch x ON p.oid = x.oid\nJOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE a.w1mpro BETWEEN 7 AND 8\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3335, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 356, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "101-1", "response": "/*\nThis query finds ZTF objects that have a probability greater than 0.5 of being a long period variable (LPV) according to the light curve classifier, and also have a WISE W1 magnitude between 7 and 8. It returns all columns from the 'probability', 'xmatch', and 'allwise' tables for these objects, limiting the result to 100 rows.\n\nThe key steps are:\n1. Use a subquery to get the OIDs of objects that have a probability > 0.5 for the 'LPV' class in the 'lc_classifier'.\n2. Join this subquery with the 'xmatch' and 'allwise' tables to get the full set of columns.\n3. Add a filter for the WISE W1 magnitude being between 7 and 8.\n4. Limit the result to 100 rows.\n*/\n\nWITH lpv_objects AS (\n  SELECT oid\n  FROM probability\n  WHERE class_name = 'LPV' \n    AND classifier_name = 'lc_classifier'\n    AND probability > 0.5\n)\nSELECT p.*, x.*, a.*\nFROM lpv_objects lo\nJOIN probability p ON lo.oid = p.oid\nJOIN xmatch x ON p.oid = x.oid\nJOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE a.w1mpro BETWEEN 7 AND 8\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3335, "input_tokens": 116, "output_tokens": 356, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "88-0", "response": "/*\nThis query finds ZTF objects that have the 'bogus' class as the most likely (ranking=1) in the 'stamp_classifier', and have a minimum of 20 detections. It returns the ZTF identifier, number of detections, mean RA and Dec coordinates, classifier version, and probability.\n\nThe key steps are:\n1. Join the 'object' and 'probability' tables to get the object details and classification probabilities.\n2. Filter for objects where the 'stamp_classifier' has 'bogus' as the top ranked class (ranking=1).\n3. Add a filter for objects with at least 20 detections.\n4. Select the desired columns: oid, ndet, meanra, meandec, classifier_version, probability.\n5. Limit the result to 50 rows.\n*/\n\nSELECT \n    o.oid,\n    o.ndet,\n    o.meanra,\n    o.meandec,\n    p.classifier_version,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'stamp_classifier' \n  AND p.class_name = 'bogus'\n  AND p.ranking = 1\n  AND o.ndet >= 20\nLIMIT 50;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 106, "output_tokens": 312, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "88-1", "response": "/*\nFind ZTF objects that have the 'bogus' class as ranking 1 in the stamp classifier, as well as a minimum of 20 detections. Return the following columns: ZTF identifier, number of detections, mean RA Dec coordinates, classifier version and probability. Give at most 50 rows in the resulting table.\n*/\nSELECT \n    o.oid AS ztf_id,\n    o.ndet AS num_detections,\n    o.meanra AS mean_ra,\n    o.meandec AS mean_dec,\n    p.classifier_version,\n    p.probability\nFROM object o\nJOIN probability p ON o.oid = p.oid\nWHERE p.class_name = 'bogus' \n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND o.ndet >= 20\nLIMIT 50;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 106, "output_tokens": 217, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "70-0", "response": "/*\nThis query retrieves all the information available for the ZTF object 'ZTF22aayjqah' from the 'reference' table.\n*/\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3182, "cache_read_input_tokens": 0, "input_tokens": 63, "output_tokens": 64, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "70-1", "response": "/*\nThis query retrieves all the information available for the ZTF object 'ZTF22aayjqah' from the 'reference' table.\n*/\nSELECT *\nFROM reference\nWHERE oid = 'ZTF22aayjqah';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3182, "cache_read_input_tokens": 0, "input_tokens": 63, "output_tokens": 64, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "53-0", "response": "/*\nGet the date, filter identifier, ZTF identifier and 5-sigma magnitude limit for all non-detections of the ZTF object 'ZTF18adqxemz'\n*/\nSELECT \n    mjd, \n    fid, \n    oid, \n    diffmaglim\nFROM non_detection\nWHERE oid = 'ZTF18adqxemz';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2899, "cache_read_input_tokens": 0, "input_tokens": 74, "output_tokens": 98, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "53-1", "response": "/*\nGet the date, filter identifier, ZTF identifier and 5-sigma magnitude limit for all non-detections of the ZTF object 'ZTF18adqxemz'\n*/\nSELECT \n    mjd, \n    fid, \n    oid, \n    diffmaglim\nFROM non_detection\nWHERE oid = 'ZTF18adqxemz';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2899, "cache_read_input_tokens": 0, "input_tokens": 74, "output_tokens": 98, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "77-0", "response": "/*\nThis query retrieves all rows from the 'ss_ztf' table where the 'ssnamenr' column matches either '213673' or '49894', and the 'ssdistnr' column is zero, indicating the object is at the same location as the given solar system identifiers. The results are sorted by the 'candid' column.\n*/\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IN ('213673', '49894')\n  AND ssdistnr = 0\nORDER BY candid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2355, "cache_read_input_tokens": 0, "input_tokens": 91, "output_tokens": 130, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "77-1", "response": "/*\nThis query retrieves all rows from the 'ss_ztf' table where the 'ssnamenr' column matches either '213673' or '49894', and the 'ssdistnr' column is zero, indicating the object is at the same location as the given solar system identifiers. The results are sorted by the 'candid' column.\n*/\nSELECT *\nFROM ss_ztf\nWHERE ssnamenr IN ('213673', '49894')\n  AND ssdistnr = 0\nORDER BY candid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2355, "cache_read_input_tokens": 0, "input_tokens": 91, "output_tokens": 130, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "105-0", "response": "/*\nThis query finds at most 50 ZTF objects that satisfy the following conditions:\n- Have a probability larger than 0.7 of being an AGN in the light curve classifier version 'hierarchical_rf_1.1.0'\n- Have a distance to the nearest PS1 source lower than 2 arcsec\n- Have a difference between the star/galaxy score from PS1 and the star/galaxy score from SExtractor lower than 0.5\nThe query returns the following columns:\n- For the ZTF object: ZTF identifier and probability\n- For each epoch: candidate and filter identifier, reduced chi-square, star/galaxy score from SExtractor, and the identifier, PS1 star/galaxy score and distance of the nearest PS1 source\n*/\n\nWITH agn_objects AS (\n  SELECT p.oid\n  FROM probability p\n  WHERE p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = 'hierarchical_rf_1.1.0'\n    AND p.probability > 0.7\n  LIMIT 50\n)\nSELECT\n  ao.oid AS ztf_object_id,\n  p.probability AS agn_probability,\n  d.candid AS candidate_id,\n  d.fid AS filter_id,\n  d.rb AS reduced_chi_square,\n  d.sgscore AS sextractor_sg_score,\n  ps1.objectidps1 AS ps1_object_id,\n  ps1.sgscore1 AS ps1_sg_score,\n  ps1.distpsnr1 AS ps1_distance\nFROM agn_objects ao\nJOIN detection d ON ao.oid = d.oid\nJOIN ps1_ztf ps1 ON ao.oid = ps1.oid AND d.candid = ps1.candid\nWHERE ps1.distpsnr1 < 2 AND ABS(d.sgscore - ps1.sgscore1) < 0.5\nORDER BY ao.oid, d.candid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 4544, "input_tokens": 194, "output_tokens": 506, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "105-1", "response": "/*\nThis query finds at most 50 ZTF objects that satisfy the following conditions:\n- Have a probability larger than 0.7 of being an AGN in the light curve classifier version 'hierarchical_rf_1.1.0'\n- Have a distance to the nearest PS1 source lower than 2 arcsec\n- Have a difference between the star/galaxy score from PS1 and the star/galaxy score from SExtractor lower than 0.5\nThe query returns the following columns:\n- For the ZTF object: ZTF identifier and probability\n- For each epoch: candidate and filter identifier, reduced chi-square, star/galaxy score from SExtractor, and the identifier, PS1 star/galaxy score and distance of the nearest PS1 source\n*/\n\nWITH agn_objects AS (\n  SELECT p.oid\n  FROM probability p\n  WHERE p.class_name = 'AGN'\n    AND p.classifier_name = 'lc_classifier'\n    AND p.classifier_version = 'hierarchical_rf_1.1.0'\n    AND p.probability > 0.7\n  LIMIT 50\n)\nSELECT\n  ao.oid AS ztf_object_id,\n  p.probability AS agn_probability,\n  d.candid AS candidate_id,\n  d.fid AS filter_id,\n  d.rb AS reduced_chi_square,\n  d.sgscore AS sextractor_sg_score,\n  ps1.objectidps1 AS ps1_object_id,\n  ps1.sgscore1 AS ps1_sg_score,\n  ps1.distpsnr1 AS ps1_distance\nFROM agn_objects ao\nJOIN detection d ON ao.oid = d.oid\nJOIN ps1_ztf ps1 ON ao.oid = ps1.oid AND d.candid = ps1.candid\nWHERE ps1.distpsnr1 < 2 AND ABS(d.sgscore - ps1.sgscore1) < 0.5\nORDER BY ao.oid, d.candid;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 4544, "cache_read_input_tokens": 0, "input_tokens": 194, "output_tokens": 506, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "86-0", "response": "/*\nRetrieve ZTF objects that:\n1. Have a probability > 0.6 of being Cepheid, Delta Scuti, or RR Lyrae in the 'lc_classifier_periodic' classifier version '1.1.0'\n2. Their closest PS1 objects have a star/galaxy score > 0.8\nReturn all columns from the 'probability' and 'ps1_ztf' tables, limit to 100 rows\n*/\nSELECT p.*, pz.*\nFROM probability p\nJOIN ps1_ztf pz ON p.oid = pz.oid\nWHERE p.classifier_name = 'lc_classifier_periodic' \n  AND p.classifier_version = '1.1.0'\n  AND p.probability > 0.6\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND pz.sgscore1 > 0.8\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3297, "input_tokens": 143, "output_tokens": 237, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "86-1", "response": "/*\nRetrieve ZTF objects that have a probability greater than 0.6 of being Cepheid, Delta Scuti, or RR Lyrae in the 'lc_classifier_periodic' classifier version '1.1.0', and their closest PS1 objects have a star/galaxy score greater than 0.8. Return all columns from the 'probability' and 'ps1_ztf' tables, limiting the result to 100 rows.\n*/\nSELECT p.*, pz.*\nFROM probability p\nJOIN ps1_ztf pz ON p.oid = pz.oid\nWHERE p.classifier_name = 'lc_classifier_periodic' \n  AND p.classifier_version = '1.1.0'\n  AND p.probability > 0.6\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND pz.sgscore1 > 0.8\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3297, "cache_read_input_tokens": 0, "input_tokens": 143, "output_tokens": 236, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "41-0", "response": "/*\nFind all ALLWISE objects that lie within 5 arcsec of an object called id_1, that has coordinates (RA, Dec) = (132.961, 41.397) deg, or within 10 arcsec of an object called id_2, having coordinates (RA, Dec) = (139.01, 41.5653). Return a table that includes the following columns:\nFor the input objects: identifier as 'id', coordinates as 'obj_ra' and 'obj_dec', and search radius used for each object in degrees as 'r_deg';\nFor the output ALLWISE objects: identifier in the ALLWISE catalog, RA Dec coordinates, and magnitude (and its uncertainty) in the WISE W1 filter.\n*/\n\nWITH input_objects AS (\n    VALUES\n        ('id_1', 132.961, 41.397, 0.0139),\n        ('id_2', 139.01, 41.5653, 0.0278)\n)\nSELECT\n    i.id AS id,\n    i.obj_ra AS obj_ra,\n    i.obj_dec AS obj_dec,\n    i.r_deg AS r_deg,\n    a.oid_catalog AS allwise_id,\n    a.ra AS allwise_ra,\n    a.dec AS allwise_dec,\n    a.w1mpro AS w1_mag,\n    a.w1sigmpro AS w1_mag_err\nFROM\n    input_objects i\n    JOIN allwise a ON\n        q3c_join(i.obj_ra, i.obj_dec, a.ra, a.dec, i.r_deg);", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3567, "cache_read_input_tokens": 0, "input_tokens": 201, "output_tokens": 398, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "41-1", "response": "/*\nFind all ALLWISE objects that lie within 5 arcsec of an object called id_1, that has coordinates (RA, Dec) = (132.961, 41.397) deg, or within 10 arcsec of an object called id_2, having coordinates (RA, Dec) = (139.01, 41.5653). Return a table that includes the following columns:\nFor the input objects: identifier as 'id', coordinates as 'obj_ra' and 'obj_dec', and search radius used for each object in degrees as 'r_deg';\nFor the output ALLWISE objects: identifier in the ALLWISE catalog, RA Dec coordinates, and magnitude (and its uncertainty) in the WISE W1 filter.\n*/\n\nWITH input_objects AS (\n    VALUES\n        ('id_1', 132.961, 41.397, 0.0139),\n        ('id_2', 139.01, 41.5653, 0.0278)\n)\nSELECT\n    i.id AS id,\n    i.obj_ra AS obj_ra,\n    i.obj_dec AS obj_dec,\n    i.r_deg AS r_deg,\n    a.oid_catalog AS allwise_id,\n    a.ra AS allwise_ra,\n    a.dec AS allwise_dec,\n    a.w1mpro AS w1_mag,\n    a.w1sigmpro AS w1_mag_err\nFROM\n    input_objects i\n    JOIN allwise a ON\n        q3c_join(i.obj_ra, i.obj_dec, a.ra, a.dec, i.r_deg);", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3567, "cache_read_input_tokens": 0, "input_tokens": 201, "output_tokens": 398, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "74-0", "response": "/*\nThis query retrieves the relevant information for the specified ZTF objects, including the identifier in both ZTF and MPC, as well as the MPC magnitude, sorted in descending order by MPC magnitude.\n*/\nSELECT \n    ss_ztf.oid AS ztf_id,\n    ss_ztf.ssnamenr AS mpc_id,\n    ss_ztf.ssmagnr AS mpc_mag\nFROM ss_ztf\nWHERE ss_ztf.oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n  AND ss_ztf.ssmagnr < 19.2\nORDER BY ss_ztf.ssmagnr DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2947, "cache_read_input_tokens": 0, "input_tokens": 146, "output_tokens": 191, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "74-1", "response": "/*\nThis query retrieves the relevant information for the specified ZTF objects, including the identifier in both ZTF and MPC, as well as the MPC magnitude, sorted in descending order by MPC magnitude.\n*/\nSELECT \n    ss_ztf.oid AS ztf_id,\n    ss_ztf.ssnamenr AS mpc_id,\n    ss_ztf.ssmagnr AS mpc_mag\nFROM ss_ztf\nWHERE ss_ztf.oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n  AND ss_ztf.ssmagnr < 19.2\nORDER BY ss_ztf.ssmagnr DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2947, "cache_read_input_tokens": 0, "input_tokens": 146, "output_tokens": 191, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "97-0", "response": "/*\nGet at most 50 ZTF objects that satisfy the following conditions:\n- Have a probability larger than 0.6 of being an AGN in the stamp classifier version 'stamp_classifier_1.0.4'\n- Have a probability larger than 0.7 of being an LPV in the light curve classifier\nReturn the following columns:\n- ZTF identifier\n- Probability in the stamp classifier (named 'prob_stamp_agn')\n- Probability in the light curve classifier (named 'prob_lc_lpv')\n*/\nSELECT\n    o.oid AS oid,\n    p1.probability AS prob_stamp_agn,\n    p2.probability AS prob_lc_lpv\nFROM\n    object o\n    JOIN probability p1 ON o.oid = p1.oid\n    JOIN probability p2 ON o.oid = p2.oid\nWHERE\n    p1.classifier_name = 'stamp_classifier'\n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'AGN'\n    AND p1.probability > 0.6\n    AND p2.classifier_name = 'lc_classifier'\n    AND p2.class_name = 'LPV'\n    AND p2.probability > 0.7\nLIMIT 50;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2973, "cache_read_input_tokens": 0, "input_tokens": 152, "output_tokens": 331, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "97-1", "response": "/*\nGet at most 50 ZTF objects that satisfy the following conditions:\n- Have a probability larger than 0.6 of being an AGN in the stamp classifier version 'stamp_classifier_1.0.4'\n- Have a probability larger than 0.7 of being an LPV in the light curve classifier\nReturn the following columns:\n- ZTF identifier\n- Probability in the stamp classifier (named 'prob_stamp_agn')\n- Probability in the light curve classifier (named 'prob_lc_lpv')\n*/\nSELECT\n    o.oid AS oid,\n    p1.probability AS prob_stamp_agn,\n    p2.probability AS prob_lc_lpv\nFROM\n    object o\n    JOIN probability p1 ON o.oid = p1.oid\n    JOIN probability p2 ON o.oid = p2.oid\nWHERE\n    p1.classifier_name = 'stamp_classifier'\n    AND p1.classifier_version = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'AGN'\n    AND p1.probability > 0.6\n    AND p2.classifier_name = 'lc_classifier'\n    AND p2.class_name = 'LPV'\n    AND p2.probability > 0.7\nLIMIT 50;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2973, "input_tokens": 152, "output_tokens": 331, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "66-0", "response": "/*\nThis query retrieves the distance and Gaia magnitude of the nearest Gaia object to the ZTF object with identifier 'ZTF22abftjko', along with the ZTF object identifier.\n*/\nSELECT \n    g.oid,\n    g.neargaia,\n    g.maggaia\nFROM gaia_ztf g\nWHERE g.oid = 'ZTF22abftjko';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3028, "cache_read_input_tokens": 0, "input_tokens": 74, "output_tokens": 105, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "66-1", "response": "/*\nThis query retrieves the distance and Gaia magnitude of the nearest Gaia object to the ZTF object with identifier 'ZTF22abftjko', along with the ZTF object identifier.\n*/\nSELECT \n    g.oid,\n    g.neargaia,\n    g.maggaia\nFROM gaia_ztf g\nWHERE g.oid = 'ZTF22abftjko';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3028, "cache_read_input_tokens": 0, "input_tokens": 74, "output_tokens": 105, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "50-0", "response": "/*\nThe query first selects the required columns from the feature table for the specified ZTF identifiers and feature version. It joins with the feature_version table to get the filter identifier. The results are then sorted by the ZTF identifier and feature name.\n*/\nSELECT \n    f.oid AS ztf_id,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    fv.fid AS filter_id\nFROM feature f\nJOIN feature_version fv ON f.version = fv.version\nWHERE f.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n  AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY f.oid, f.name;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 5662, "cache_read_input_tokens": 0, "input_tokens": 120, "output_tokens": 191, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "50-1", "response": "/*\nThis query retrieves all features for the given ZTF objects that have a feature version of 'lc_classifier_1.2.1-P'. It returns the ZTF identifier, feature name, feature value, and the filter identifier, sorted by the ZTF identifier and feature name.\n*/\nSELECT \n    o.oid AS oid,\n    f.name AS feature_name,\n    f.value AS feature_value,\n    f.fid AS filter_id\nFROM object o\nJOIN feature f ON o.oid = f.oid\nWHERE o.oid IN ('ZTF21aaqytjr', 'ZTF23abkhwgb')\n  AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY o.oid, f.name;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 5662, "input_tokens": 120, "output_tokens": 196, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "91-0", "response": "/*\nThis query finds ZTF objects that have a 'W1-W2' color lower than 1, and returns the following columns:\n- oid (ZTF identifier)\n- ndet (number of detections)\n- g_r_max - g_r_max_corr (difference between minimum g- and r-band difference magnitudes)\n- w1_w2 (the 'W1-W2' feature value)\n- version (the feature version)\nThe query limits the result to at most 100 rows.\n*/\nSELECT \n    o.oid,\n    o.ndet,\n    o.g_r_max - o.g_r_max_corr AS g_r_max,\n    f.value AS w1_w2,\n    f.version\nFROM object o\nJOIN feature f ON o.oid = f.oid\nWHERE f.name = 'W1-W2' AND f.value < 1\nORDER BY o.ndet DESC\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 6478, "input_tokens": 118, "output_tokens": 244, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "91-1", "response": "/*\nThis query finds ZTF objects that have a 'W1-W2' color lower than 1, and returns the following columns:\n- oid (ZTF identifier)\n- ndet (number of detections)\n- g_r_max - g_r_max_corr (difference between minimum g- and r-band difference magnitudes)\n- w1_w2 (the 'W1-W2' feature value)\n- version (the feature version)\nThe query limits the result to at most 100 rows.\n*/\nSELECT \n    o.oid,\n    o.ndet,\n    o.g_r_max - o.g_r_max_corr AS g_r_max,\n    f.value AS w1_w2,\n    f.version\nFROM object o\nJOIN feature f ON o.oid = f.oid\nWHERE f.name = 'W1-W2' AND f.value < 1\nORDER BY o.ndet DESC\nLIMIT 100;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 6478, "cache_read_input_tokens": 0, "input_tokens": 118, "output_tokens": 244, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "68-0", "response": "/*\nThis query retrieves the requested information about the nearest Pan-STARRS (PS1) source for the ZTF object 'ZTF21abfrbnm'.\nThe key steps are:\n1. Select the relevant columns from the ps1_ztf table for the given oid ('ZTF21abfrbnm').\n2. The objectidps1, sgmag1, sgscore1, and distpsnr1 columns contain the requested information about the nearest PS1 source.\n*/\n\nSELECT \n    objectidps1,\n    sgmag1,\n    sgscore1,\n    distpsnr1\nFROM ps1_ztf\nWHERE oid = 'ZTF21abfrbnm';", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3667, "cache_read_input_tokens": 0, "input_tokens": 86, "output_tokens": 175, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "68-1", "response": "/*\nThis query retrieves the requested information about the nearest Pan-STARRS (PS1) source for the ZTF object 'ZTF21abfrbnm'.\nIt selects the objectidps1, sgmag1, sgscore1, and distpsnr1 columns from the ps1_ztf table where the oid matches the given ZTF object.\n*/\nSELECT objectidps1, sgmag1, sgscore1, distpsnr1\nFROM ps1_ztf\nWHERE oid = 'ZTF21abfrbnm'\nLIMIT 1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3667, "cache_read_input_tokens": 0, "input_tokens": 86, "output_tokens": 145, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "60-0", "response": "/*\nThis query retrieves the requested information for the specified ZTF objects from the 'magstat' table, where the number of dubious points in the g band is zero.\n*/\nSELECT \n    o.oid AS ztf_id,\n    ms.ndet AS num_detections,\n    ms.dmdt_first AS initial_rise,\n    ms.dm_first AS first_diff_mag\nFROM object o\nJOIN magstat ms ON o.oid = ms.oid\nWHERE o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n  AND ms.fid = 1 -- g band\n  AND ms.ndubious = 0;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 123, "output_tokens": 185, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "60-1", "response": "/*\nThis query retrieves the requested information for the specified ZTF objects from the 'magstat' table, where the number of dubious points in the g band is zero.\n*/\nSELECT \n    o.oid AS ztf_id,\n    ms.ndet AS num_detections,\n    ms.dmdt_first AS initial_rise,\n    ms.dm_first AS first_diff_mag\nFROM object o\nJOIN magstat ms ON o.oid = ms.oid\nWHERE o.oid IN ('ZTF20adadshh', 'ZTF21aaabvit', 'ZTF21aaabvjk')\n  AND ms.fid = 1 -- g band\n  AND ms.ndubious = 0;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3628, "cache_read_input_tokens": 0, "input_tokens": 123, "output_tokens": 185, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "76-0", "response": "/*\nThis query finds all ZTF objects that are within 1.5 arcseconds of the solar system object with MPC name '115185'. It returns the ZTF identifier, the magnitude of the MPC object, and the distance between the ZTF object detection and the MPC object.\n*/\nSELECT \n    ss_ztf.candid AS ztf_identifier,\n    ss_ztf.ssmagnr AS mpc_magnitude,\n    ss_ztf.ssdistnr AS distance\nFROM ss_ztf\nWHERE ss_ztf.ssnamenr = '115185'\nORDER BY ss_ztf.ssdistnr\nLIMIT 1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2947, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 168, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "76-1", "response": "/*\nThis query finds all ZTF objects that are within 1.5 arcseconds of the solar system object with MPC name '115185'. It returns the ZTF identifier, the magnitude of the MPC object, and the distance between the ZTF object and the MPC object, sorted by the distance.\n*/\nSELECT \n    ss_ztf.candid AS ztf_identifier,\n    ss_ztf.ssmagnr AS mpc_magnitude,\n    ss_ztf.ssdistnr AS distance\nFROM ss_ztf\nWHERE ss_ztf.ssnamenr = '115185'\nORDER BY ss_ztf.ssdistnr\nLIMIT 1;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2947, "cache_read_input_tokens": 0, "input_tokens": 100, "output_tokens": 172, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "44-0", "response": "/*\nThis query retrieves all epochs for the objects 'ZTF20abfcszi' and 'ZTF21aaqwjlz' that have a reduced chi-square value (chipsf) less than 3. It returns all columns from the 'dataquality' table, sorted first by the ZTF identifier (oid) in ascending order, and then by the peak-pixel signal-to-noise ratio (scorr) in descending order.\n*/\nSELECT *\nFROM dataquality\nWHERE oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND chipsf < 3\nORDER BY oid ASC, scorr DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3687, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 168, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "44-1", "response": "/*\nThis query retrieves all epochs for the objects 'ZTF20abfcszi' and 'ZTF21aaqwjlz' that have a reduced chi-square value (chipsf) less than 3. It returns all columns from the 'dataquality' table, sorted first by the ZTF identifier (oid) in ascending order, and then by the peak-pixel signal-to-noise ratio (scorr) in descending order.\n*/\nSELECT *\nFROM dataquality\nWHERE oid IN ('ZTF20abfcszi', 'ZTF21aaqwjlz')\n  AND chipsf < 3\nORDER BY oid ASC, scorr DESC;", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3687, "input_tokens": 116, "output_tokens": 168, "server_tool_use": null, "service_tier": "batch"}}
