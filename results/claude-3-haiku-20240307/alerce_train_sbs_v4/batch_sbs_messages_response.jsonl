{"custom_id": "13-0", "response": "```sql\nSELECT \n  object.oid,\n  object.firstmjd,\n  object.lastmjd,\n  probability.class_name,\n  probability.probability\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n  object.firstmjd BETWEEN 59914.0 AND 60217.0 -- December 1, 2022 to September 1, 2023\n  AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Supernova classes\n  AND probability.ranking = 1 -- Most likely probability\n  AND probability.classifier_name = 'lc_classifier' -- Light curve classifier\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3021, "cache_read_input_tokens": 0, "input_tokens": 125, "output_tokens": 182, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "13-1", "response": "```sql\nSELECT \n  o.oid,\n  o.firstmjd,\n  o.lastmjd,\n  p.class_name\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n  o.firstmjd BETWEEN 59914.0 AND 60217.0 -- December 1, 2022 to September 1, 2023\n  AND p.ranking = 1 -- most likely probability\n  AND p.classifier_name = 'lc_classifier' -- light curve classifier\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2905, "cache_read_input_tokens": 0, "input_tokens": 125, "output_tokens": 139, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "10-0", "response": "```sql\n-- Retrieve object identifiers and probabilities for SNIa (rank 1) and CV/Nova (rank 2) in the lc_classifier\n-- where the difference between the probabilities is less than 0.1\nSELECT\n  o.oid,\n  p1.probability AS SN_prob,\n  p2.probability AS CV_prob\nFROM\n  probability p1\n  INNER JOIN probability p2 ON p1.oid = p2.oid\n  INNER JOIN object o ON p1.oid = o.oid\nWHERE\n  p1.classifier_name = 'lc_classifier'\n  AND p1.class_name = 'SNIa'\n  AND p1.ranking = 1\n  AND p2.classifier_name = 'lc_classifier'\n  AND p2.class_name = 'CV/Nova'\n  AND p2.ranking = 2\n  AND ABS(p1.probability - p2.probability) < 0.1\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3084, "cache_read_input_tokens": 0, "input_tokens": 121, "output_tokens": 242, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "10-1", "response": "```sql\nSELECT \n  object.oid,\n  p1.probability AS SN_prob,\n  p2.probability AS CV_prob\nFROM probability p1\nINNER JOIN probability p2 ON p1.oid = p2.oid\nINNER JOIN object ON p1.oid = object.oid\nWHERE \n  p1.class_name = 'SNIa' \n  AND p1.ranking = 1\n  AND p2.class_name = 'CV/Nova'\n  AND p2.ranking = 2\n  AND p1.classifier_name = 'lc_classifier'\n  AND p2.classifier_name = 'lc_classifier'\n  AND ABS(p1.probability - p2.probability) < 0.1\nORDER BY object.oid;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3016, "cache_read_input_tokens": 0, "input_tokens": 121, "output_tokens": 198, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "15-0", "response": "```sql\nSELECT \n    object.oid,\n    probability.probability,\n    probability.classifier_name,\n    detection.fid,\n    detection.candid,\n    magstat.fid AS magstat_fid,\n    magstat.dmdt_first\nFROM probability\nINNER JOIN object ON probability.oid = object.oid\nINNER JOIN detection ON object.oid = detection.oid\nINNER JOIN magstat ON object.oid = magstat.oid\nWHERE \n    probability.ranking = 1 \n    AND probability.class_name = 'SN'\n    AND probability.classifier_name = 'stamp_classifier'\n    AND object.firstmjd BETWEEN 60188.0 AND 60189.0\n    AND magstat.dmdt_first >= 0.25\nORDER BY object.oid;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3333, "cache_read_input_tokens": 0, "input_tokens": 221, "output_tokens": 205, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "15-1", "response": "```sql\nWITH probability_filtered AS (\n  SELECT oid, class_name, probability, ranking, classifier_name\n  FROM probability\n  WHERE class_name = 'SN'\n    AND classifier_name = 'stamp_classifier'\n    AND ranking = 1\n)\nSELECT\n  o.oid,\n  p.probability,\n  p.classifier_name,\n  d.fid,\n  d.candid,\n  d.mjd,\n  d.magpsf,\n  m.dmdt_first,\n  m.fid AS magstat_fid\nFROM probability_filtered p\nJOIN object o ON p.oid = o.oid\nJOIN detection d ON o.oid = d.oid\nJOIN magstat m ON o.oid = m.oid\nWHERE o.firstmjd BETWEEN 60188.0 AND 60189.0\n  AND m.dmdt_first >= 0.25\nORDER BY o.oid;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3301, "cache_read_input_tokens": 0, "input_tokens": 221, "output_tokens": 235, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "4-0", "response": "```sql\nSELECT o.oid, d.candid, d.magpsf, d.sigmapsf, d.magpsf_corr, d.sigmapsf_corr, d.fid, m.dmdt_first\nFROM (\n  SELECT o.*\n  FROM object o\n  INNER JOIN (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SNII'\n      AND probability > 0.6\n      AND classifier_name = 'lc_classifier'\n      AND ranking = 1\n  ) p ON o.oid = p.oid\n  WHERE o.firstmjd BETWEEN '2019-01-01'::DOUBLE PRECISION AND '2022-12-31'::DOUBLE PRECISION\n    AND o.ndet > 50\n) o\nINNER JOIN detection d ON o.oid = d.oid\nINNER JOIN magstat m ON o.oid = m.oid AND d.fid = m.fid\nWHERE m.dmdt_first > 0.5 AND (m.fid = 1 OR m.fid = 2)\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3783, "cache_read_input_tokens": 0, "input_tokens": 119, "output_tokens": 272, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "4-1", "response": "```sql\n-- Query to retrieve the requested information for SNII objects\nSELECT\n    o.oid,\n    d.candid,\n    d.mjd,\n    d.fid,\n    d.magpsf,\n    d.sigmapsf,\n    d.magpsf_corr,\n    d.sigmapsf_corr,\n    m.dmdt_first\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN detection d ON o.oid = d.oid\nINNER JOIN magstat m ON o.oid = m.oid\nWHERE\n    p.class_name = 'SNII'\n    AND p.probability > 0.6\n    AND p.ranking = 1\n    AND d.mjd BETWEEN '2019-01-01' AND '2022-12-31'\n    AND m.dmdt_first > 0.5\n    AND m.fid IN (1, 2)\n    AND o.ndet > 50\nORDER BY d.mjd;\n```\n\nThe query retrieves the following information:\n\n- `o.oid`: The object identifier\n- `d.candid`: The candidate identifier\n- `d.mjd`: The modified Julian date of the detection\n- `d.fid`: The filter identifier (1 for g, 2 for r)\n- `d.magpsf`: The magnitude of the point source\n- `d.sigmapsf`: The magnitude error of the point source\n- `d.magpsf_corr`: The corrected magnitude of the point source\n- `d.sigmapsf_corr`: The corrected magnitude error of the point source\n- `m.dmdt_first`: The initial rise estimate in mag/day\n\nThe query filters the results to include only objects that:\n- Are classified as 'SNII' with a probability greater than 0.6 (using the `probability` table)\n- Have detections between '2019-01-01' and '2022-12-31' (the year range 2019-2022)\n- Have an initial rise rate greater than 0.5 mag/day in the ZTF g and r-bands (using the `magstat` table)\n- Have more than 50 detections (using the `object` table)\n\nThe results are ordered by the detection time (`d.mjd`) in chronological order.", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3334, "cache_read_input_tokens": 0, "input_tokens": 119, "output_tokens": 565, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "25-0", "response": "```sql\n-- Query objects within 10 degrees of the specified coordinates, with first detection in the first 7 days of February, and SN probability > 0.4 and ranking = 1 in the stamp classifier\n\nSELECT o.*, p.probability, p.ranking, p.classifier_name\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n  (\n    q3c_radial_query(o.meanra, o.meandec, 160.18301441363647, 33.0164673528409, 10) \n    OR q3c_radial_query(o.meanra, o.meandec, 174.21524897555543, 44.83789535222221, 10)\n  )\n  AND o.firstmjd BETWEEN 59976.0 AND 59982.0 -- first 7 days of February\n  AND p.probability > 0.4 \n  AND p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2909, "cache_read_input_tokens": 0, "input_tokens": 157, "output_tokens": 257, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "25-1", "response": "```sql\n-- Query objects within 10 degrees of the specified coordinates, with first detection in the first 7 days of February, and SN probability > 0.4 and ranking = 1 in the stamp classifier\nSELECT o.*, p.probability, p.ranking, p.classifier_name\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n  (\n    q3c_radial_query(o.meanra, o.meandec, 160.18301441363647, 33.0164673528409, 10) OR\n    q3c_radial_query(o.meanra, o.meandec, 174.21524897555543, 44.83789535222221, 10)\n  )\n  AND o.firstmjd BETWEEN 59976.0 AND 59982.0 -- first 7 days of February\n  AND p.probability > 0.4 \n  AND p.ranking = 1\n  AND p.classifier_name = 'stamp_classifier'\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2879, "cache_read_input_tokens": 0, "input_tokens": 157, "output_tokens": 256, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "7-0", "response": "```sql\nSELECT \n  object.oid,\n  probability.probability,\n  probability.classifier_name\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE\n  probability.ranking = 1\n  AND probability.class_name = 'SN'\n  AND probability.classifier_name = 'stamp_classifier'\n  AND object.firstmjd BETWEEN 59945.0 AND 59975.0;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2893, "cache_read_input_tokens": 0, "input_tokens": 101, "output_tokens": 111, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "7-1", "response": "```sql\nSELECT\n    object.oid,\n    probability.probability\nFROM\n    object\n    INNER JOIN probability ON object.oid = probability.oid\nWHERE\n    probability.classifier_name = 'stamp_classifier'\n    AND probability.ranking = 1\n    AND probability.class_name = 'SN'\n    AND object.firstmjd BETWEEN 59945.0 AND 59975.0;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2797, "cache_read_input_tokens": 0, "input_tokens": 101, "output_tokens": 105, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "3-0", "response": "```sql\n-- Retrieve objects classified as YSO by the lc_classifier with probability > 0.7 \n-- that were last detected during the specified time period in June\nSELECT o.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE p.classifier_name = 'lc_classifier' \n  AND p.class_name = 'YSO'\n  AND p.probability > 0.7\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0\nORDER BY o.ndet DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3000, "cache_read_input_tokens": 0, "input_tokens": 85, "output_tokens": 142, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "3-1", "response": "```sql\n-- Query to retrieve objects classified as YSO by the lc_classifier with probability > 0.7 and last detected in June\nSELECT \n  o.oid,\n  o.meanra,\n  o.meandec,\n  p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n  p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'YSO'\n  AND p.probability > 0.7\n  AND o.lastmjd BETWEEN 60096.0 AND 60125.0\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2842, "cache_read_input_tokens": 0, "input_tokens": 85, "output_tokens": 154, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "23-0", "response": "```sql\n-- Retrieve all classification probabilities for objects most likely to be SNIa, SNIbc, SNII, or SLSN, as classified by the lc_classifier with probability > 0.2\nSELECT \n  p.*,\n  o.oid, o.meanra, o.meandec\nFROM \n  probability p\n  INNER JOIN object o ON p.oid = o.oid\nWHERE\n  p.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') \n  AND p.classifier_name = 'lc_classifier'\n  AND p.probability > 0.2\nORDER BY\n  p.oid, p.ranking;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2955, "cache_read_input_tokens": 0, "input_tokens": 101, "output_tokens": 179, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "23-1", "response": "```sql\nSELECT \n  object.oid,\n  object.meanra,\n  object.meandec,\n  object.g_r_max,\n  object.g_r_mean_corr,\n  probability.class_name,\n  probability.probability,\n  probability.ranking\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n  probability.classifier_name = 'lc_classifier'\n  AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n  AND probability.probability >= 0.2\nORDER BY probability.ranking;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2919, "cache_read_input_tokens": 0, "input_tokens": 101, "output_tokens": 161, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "20-0", "response": "```sql\nSELECT\n    o.oid,\n    o.meanra,\n    o.meandec,\n    o.ndet,\n    p.probability\nFROM\n    object o\n    INNER JOIN probability p ON o.oid = p.oid\nWHERE\n    p.class_name = 'RRL'\n    AND p.probability > 0.55\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND o.ndet >= 100\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2840, "cache_read_input_tokens": 0, "input_tokens": 76, "output_tokens": 127, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "20-1", "response": "```sql\n-- Query objects classified by the light curve classifier that are most likely to be RRL with a probability larger than 0.55 and that have 100 or more detections.\nSELECT \n  o.oid,\n  o.meanra,\n  o.meandec,\n  o.ndet,\n  p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n  p.classifier_name = 'lc_classifier'\n  AND p.class_name = 'RRL'\n  AND p.probability > 0.55\n  AND p.ranking = 1\n  AND o.ndet >= 100\nORDER BY p.probability DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3248, "cache_read_input_tokens": 0, "input_tokens": 76, "output_tokens": 173, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "18-0", "response": "```sql\nWITH object_filtered AS (\n    SELECT \n        oid, meanra, meandec, ndet, firstMJD, deltajd, g_r_mean_corr\n    FROM object\n    WHERE ndet >= 40 AND deltajd >= 200\n),\nprobability_filtered AS (\n    SELECT \n        oid, classifier_name, class_name, ranking, probability\n    FROM probability\n    WHERE classifier_name = 'lc_classifier' \n        AND class_name IN ('AGN', 'QSO', 'Blazar')\n        AND (\n            (class_name = 'AGN' AND probability >= 0.95) \n            OR (class_name = 'QSO' AND probability >= 0.95)\n            OR (class_name = 'Blazar' AND probability >= 0.8)\n        )\n)\nSELECT\n    oid, meanra, meandec, ndet, firstMJD, deltajd, g_r_mean_corr,\n    classifier_name, class_name, ranking, probability\nFROM object_filtered\nINNER JOIN probability_filtered USING (oid)\nORDER BY oid, class_name, ranking;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3396, "cache_read_input_tokens": 0, "input_tokens": 226, "output_tokens": 292, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "18-1", "response": "```sql\nWITH agn_subquery AS (\n  SELECT \n    o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.deltajd, o.g_r_mean_corr,\n    p.classifier_name, p.class_name, p.ranking, p.probability\n  FROM object o\n  INNER JOIN probability p ON o.oid = p.oid\n  WHERE \n    p.classifier_name = 'lc_classifier' \n    AND p.class_name = 'AGN'\n    AND p.probability > 0.95\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n),\nqso_subquery AS (\n  SELECT\n    o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.deltajd, o.g_r_mean_corr,\n    p.classifier_name, p.class_name, p.ranking, p.probability\n  FROM object o\n  INNER JOIN probability p ON o.oid = p.oid\n  WHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'QSO' \n    AND p.probability > 0.95\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n),\nblazar_subquery AS (\n  SELECT\n    o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, o.deltajd, o.g_r_mean_corr,\n    p.classifier_name, p.class_name, p.ranking, p.probability\n  FROM object o\n  INNER JOIN probability p ON o.oid = p.oid\n  WHERE\n    p.classifier_name = 'lc_classifier'\n    AND p.class_name = 'Blazar'\n    AND p.probability > 0.8\n    AND o.ndet >= 40\n    AND o.deltajd >= 200\n)\nSELECT * \nFROM agn_subquery\nUNION\nSELECT *\nFROM qso_subquery\nUNION \nSELECT *\nFROM blazar_subquery\nORDER BY ranking;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3310, "cache_read_input_tokens": 0, "input_tokens": 226, "output_tokens": 558, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "11-0", "response": "```sql\nSELECT \n  object.oid,\n  object.g_r_max_corr,\n  magstat.magmax_corr,\n  magstat.fid\nFROM object\nINNER JOIN magstat ON object.oid = magstat.oid\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n  object.firstmjd BETWEEN 60188.0 AND 60217.0\n  AND object.magmax_corr > 19\n  AND object.g_r_max_corr < 1\n  AND probability.class_name = 'SNIa'\n  AND probability.ranking = 1\n  AND probability.classifier_name = 'lc_classifier'\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3046, "input_tokens": 122, "output_tokens": 177, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "11-1", "response": "```sql\nSELECT \n  object.oid,\n  object.g_r_max_corr,\n  magstat.magmax_corr,\n  magstat.fid\nFROM object\nINNER JOIN magstat ON object.oid = magstat.oid\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n  object.firstmjd BETWEEN 60188.0 AND 60217.0\n  AND object.magmax_corr > 19\n  AND object.g_r_max_corr < 1\n  AND probability.class_name = 'SNIa'\n  AND probability.ranking = 1\n  AND probability.classifier_name = 'lc_classifier'\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3046, "cache_read_input_tokens": 0, "input_tokens": 122, "output_tokens": 177, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "9-0", "response": "```sql\nSELECT \n    o.oid,\n    f.value,\n    f.name,\n    f.version,\n    o.meanra,\n    o.meandec,\n    q3c_dist(o.meanra, o.meandec, 39.97, -1.5768) AS dist\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN feature f ON o.oid = f.oid\nWHERE \n    o.firstmjd BETWEEN 60126.0 AND 60156.0\n    AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n    AND o.sgscore1 < 0.3\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\n    AND p.class_name NOT IN ('asteroid', 'bogus')\nORDER BY o.oid;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3092, "cache_read_input_tokens": 0, "input_tokens": 216, "output_tokens": 245, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "9-1", "response": "```sql\n-- FINAL QUERY\nWITH object_filtered AS (\n  SELECT o.oid, o.meanra, o.meandec\n  FROM object o\n  WHERE o.firstmjd BETWEEN 60126.0 AND 60156.0\n    AND q3c_radial_query(o.meanra, o.meandec, 39.97, -1.5768, 16.16667)\n    AND o.sgscore1 < 0.3\n),\nprobability_filtered AS (\n  SELECT of.oid, p.value, p.name, p.version\n  FROM object_filtered of\n  INNER JOIN probability p ON of.oid = p.oid\n  WHERE p.ranking = 1 \n    AND p.classifier_name = 'stamp_classifier'\n    AND p.value NOT IN ('asteroid', 'bogus')\n),\nfeatures AS (\n  SELECT pf.oid, f.value, f.name, f.version\n  FROM probability_filtered pf\n  INNER JOIN feature f ON pf.oid = f.oid\n  WHERE f.name IN ('feature1', 'feature2', 'feature3')\n)\nSELECT \n  pf.oid,\n  f.value,\n  f.name,\n  f.version,\n  of.meanra,\n  of.meandec,\n  q3c_dist(of.meanra, of.meandec, 39.97, -1.5768) AS dist\nFROM probability_filtered pf\nINNER JOIN features f ON pf.oid = f.oid\nINNER JOIN object_filtered of ON pf.oid = of.oid\nWHERE f.oid IN (\n  SELECT oid \n  FROM features\n  GROUP BY oid\n  HAVING COUNT(DISTINCT name) = 3\n);\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3068, "cache_read_input_tokens": 0, "input_tokens": 216, "output_tokens": 446, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "5-0", "response": "```sql\nWITH probability_subquery AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1 \n        AND classifier_name = 'lc_classifier'\n        AND probability > 0.6\n        AND class_name = 'SNII'\n),\nfeature_subquery AS (\n    SELECT o.oid, f.name, f.value, f.fid\n    FROM object o\n    INNER JOIN probability_subquery ps ON o.oid = ps.oid\n    INNER JOIN feature f ON o.oid = f.oid\n    WHERE f.name = 'delta_mag_fid' AND f.fid = 1 AND f.value > 2\n)\nSELECT \n    o.oid,\n    d.candid,\n    fs.name,\n    fs.value,\n    d.magpsf,\n    d.sigmapsf,\n    fs.fid AS feature_fid\nFROM object o\nINNER JOIN probability_subquery ps ON o.oid = ps.oid\nINNER JOIN feature_subquery fs ON o.oid = fs.oid\nINNER JOIN detection d ON o.oid = d.oid\nWHERE o.ndet > 50\nORDER BY o.oid;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3345, "input_tokens": 139, "output_tokens": 304, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "5-1", "response": "```sql\nWITH probability_subquery AS (\n    SELECT oid\n    FROM probability\n    WHERE ranking = 1 \n        AND classifier_name = 'lc_classifier'\n        AND probability > 0.6\n        AND class_name = 'SNII'\n),\nfeature_subquery AS (\n    SELECT object.oid, feature.name, feature.value, feature.fid\n    FROM object\n    INNER JOIN probability_subquery ON object.oid = probability_subquery.oid\n    INNER JOIN feature ON object.oid = feature.oid\n    WHERE feature.name = 'delta_mag_fid' \n        AND feature.fid = 1\n        AND feature.value > 2\n)\nSELECT \n    object.oid,\n    detection.candid,\n    feature_subquery.name,\n    feature_subquery.value,\n    detection.magpsf,\n    detection.sigmapsf,\n    detection.fid AS feature_fid\nFROM object\nINNER JOIN probability_subquery ON object.oid = probability_subquery.oid\nINNER JOIN feature_subquery ON object.oid = feature_subquery.oid\nINNER JOIN detection ON object.oid = detection.oid\nWHERE object.ndet > 50\nORDER BY object.oid;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3345, "cache_read_input_tokens": 0, "input_tokens": 139, "output_tokens": 316, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "0-0", "response": "```sql\nSELECT \n  p.oid,\n  p.probability,\n  f.name,\n  f.value,\n  f.fid,\n  f.version\nFROM probability p\nINNER JOIN object o ON p.oid = o.oid\nINNER JOIN feature f ON p.oid = f.oid\nWHERE \n  p.class_name = 'YSO' \n  AND p.probability > 0.7\n  AND f.name = 'Period_band'\n  AND f.value BETWEEN 3 AND 10\n  AND f.name = 'Amplitude'\n  AND f.value > 0.5\nORDER BY p.probability DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3053, "cache_read_input_tokens": 0, "input_tokens": 123, "output_tokens": 170, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "0-1", "response": "```sql\nSELECT \n  o.oid,\n  p.probability,\n  f.name,\n  f.value,\n  f.fid,\n  f.version\nFROM probability p\nJOIN object o ON p.oid = o.oid\nJOIN feature f ON o.oid = f.oid\nWHERE \n  p.classifier_name = 'lc_classifier' \n  AND p.ranking = 1\n  AND p.probability > 0.7\n  AND f.name IN ('Period_band', 'Amplitude')\n  AND f.value BETWEEN 3 AND 10 \n  AND f.value > 0.5\nORDER BY p.probability DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3021, "cache_read_input_tokens": 0, "input_tokens": 123, "output_tokens": 169, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "38-0", "response": "```sql\nWITH top_candidates AS (\n  SELECT oid, probability, class_name\n  FROM probability\n  WHERE class_name IN ('AGN', 'QSO')\n    AND classifier_name = 'lc_classifier'\n    AND (class_name = 'AGN' AND probability > 0.6\n         OR class_name = 'QSO' AND probability > 0.5)\n  ORDER BY probability DESC\n  LIMIT 1000\n)\nSELECT o.*\nFROM top_candidates tc\nINNER JOIN object o ON tc.oid = o.oid\nWHERE o.ndet BETWEEN 30 AND 200\nORDER BY tc.probability DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3007, "cache_read_input_tokens": 0, "input_tokens": 108, "output_tokens": 164, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "38-1", "response": "```sql\nWITH top_candidates AS (\n  SELECT oid, probability, class_name\n  FROM probability\n  WHERE class_name IN ('AGN', 'QSO')\n    AND classifier_name = 'lc_classifier'\n    AND (class_name = 'AGN' AND probability > 0.6\n         OR class_name = 'QSO' AND probability > 0.5)\n  ORDER BY probability DESC\n  LIMIT 1000\n)\nSELECT o.*\nFROM top_candidates tc\nINNER JOIN object o ON tc.oid = o.oid\nWHERE o.ndet BETWEEN 30 AND 200\nORDER BY tc.probability DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3007, "input_tokens": 108, "output_tokens": 164, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "31-0", "response": "```sql\nSELECT \n  o.gal_l,\n  o.gal_b,\n  o.oid,\n  p.class_name,\n  f.*\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN feature f ON o.oid = f.oid\nWHERE \n  o.firstmjd BETWEEN 59976.0 AND 59978.0\n  AND p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3044, "cache_read_input_tokens": 0, "input_tokens": 145, "output_tokens": 134, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "31-1", "response": "```sql\nSELECT\n    object.gal_l,\n    object.gal_b,\n    feature.*,\n    probability.class_name,\n    object.oid\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nINNER JOIN feature ON object.oid = feature.oid\nWHERE\n    object.firstmjd BETWEEN 59976.0 AND 59978.0\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.ranking = 1;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2904, "cache_read_input_tokens": 0, "input_tokens": 145, "output_tokens": 129, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "6-0", "response": "```sql\n-- Step 1: Filter the probability table to get the oids classified as 'SNII' with probability > 0.6\nWITH prob_snii AS (\n  SELECT oid, probability\n  FROM probability\n  WHERE class_name = 'SNII' AND probability > 0.6 AND ranking = 1 AND classifier_name = 'lc_classifier'\n)\n\n-- Step 2: Join the prob_snii table with the object table to get the oids that match the probability criteria\n, obj_snii AS (\n  SELECT o.oid\n  FROM prob_snii p\n  INNER JOIN object o ON p.oid = o.oid\n)\n\n-- Step 3: Filter the magstat table to get the oids with dmdt_first > 0.5 in g and r-bands, and ndet > 30 in r-band\n, mag_snii AS (\n  SELECT m.oid\n  FROM magstat m\n  WHERE m.dmdt_first > 0.5 AND m.fid IN (1, 2) AND m.ndet > 30 AND m.fid = 2\n)\n\n-- Step 4: Filter the detection table to get the oids with at least 100 days of observations in r-band, and mjd between 58484.0 and 59944.0\n, det_snii AS (\n  SELECT d.oid, d.candid, d.mjd, d.fid, d.magpsf, d.sigmapsf\n  FROM detection d\n  INNER JOIN magstat m ON d.oid = m.oid\n  WHERE m.firstmjd >= 58484.0 AND m.lastmjd <= 59944.0 AND m.fid = 2 AND m.ndet >= 100\n  AND d.mjd BETWEEN 58484.0 AND 59944.0\n)\n\n-- Step 5: Final query\nSELECT \n  det_snii.oid,\n  det_snii.candid,\n  det_snii.mjd,\n  det_snii.f_id,\n  det_snii.magpsf,\n  det_snii.sigmapsf\nFROM det_snii\nORDER BY det_snii.oid, det_snii.mjd;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 3149, "input_tokens": 185, "output_tokens": 556, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "6-1", "response": "```sql\n-- FINAL QUERY\nSELECT \n    p.oid,\n    d.candid,\n    d.mjd,\n    d.fid AS f_id,\n    d.magpsf,\n    d.sigmapsf\nFROM probability p\nINNER JOIN object o ON p.oid = o.oid\nINNER JOIN magstat m ON p.oid = m.oid\nINNER JOIN detection d ON p.oid = d.oid\nWHERE \n    p.class_name = 'SNII' \n    AND p.probability > 0.6\n    AND m.dmdt_first > 0.5 \n    AND m.ndet > 30\n    AND m.fid = 2\n    AND m.dmdt_first > 0.5\n    AND m.firstmjd >= 58484.0\n    AND m.lastmjd <= 59944.0\n    AND d.mjd BETWEEN 58484.0 AND 59944.0\nORDER BY p.oid, d.mjd;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3149, "cache_read_input_tokens": 0, "input_tokens": 185, "output_tokens": 258, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "21-0", "response": "```sql\nSELECT \n  o.oid,\n  o.ndet,\n  o.firstmjd,\n  o.lastmjd,\n  p.class_name,\n  p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE \n  p.classifier_name = 'lc_classifier' \n  AND p.ranking = 1\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n  AND o.ndet >= 30\n  AND o.lastmjd - o.firstmjd >= 200\n  AND p.probability > 0.5\nORDER BY p.probability DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3052, "cache_read_input_tokens": 0, "input_tokens": 112, "output_tokens": 176, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "21-1", "response": "```sql\n-- Query to get sources classified as AGN, QSO or Blazar by the ALeRCE light curve classifier\n-- with a minimum number of detections of 30, a minimum time span between the first and last detection of 200 days,\n-- and a predicted class probability higher than 0.5\n\nSELECT\n  o.oid,\n  o.ndet,\n  o.firstmjd,\n  o.lastmjd,\n  p.class_name,\n  p.probability\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nWHERE\n  p.classifier_name = 'lc_classifier'\n  AND p.ranking = 1\n  AND p.class_name IN ('AGN', 'QSO', 'Blazar')\n  AND o.ndet >= 30\n  AND (o.lastmjd - o.firstmjd) >= 200\n  AND p.probability > 0.5\nORDER BY p.probability DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2879, "cache_read_input_tokens": 0, "input_tokens": 112, "output_tokens": 245, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "26-0", "response": "```sql\nSELECT \n  object.oid,\n  object.firstmjd,\n  object.lastmjd,\n  object.ndet,\n  probability.probability,\n  probability.class_name\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n  object.firstmjd >= 59816.0 \n  AND object.lastmjd <= 59832.0\n  AND (\n    (probability.classifier_name = 'stamp_classifier' AND probability.probability > 0.5)\n    OR object.ndet > 1\n  )\nORDER BY object.firstmjd;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2962, "cache_read_input_tokens": 0, "input_tokens": 115, "output_tokens": 158, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "26-1", "response": "```sql\nSELECT \n    object.oid,\n    object.firstmjd,\n    object.lastmjd,\n    object.ndet,\n    probability.probability,\n    probability.class_name\nFROM object\nINNER JOIN probability ON object.oid = probability.oid\nWHERE \n    object.firstmjd >= 59816.0 \n    AND object.lastmjd <= 59832.0\n    AND (\n        (probability.classifier_name = 'stamp_classifier' AND probability.probability > 0.5)\n        OR object.ndet > 1\n    )\nORDER BY object.firstmjd;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2962, "input_tokens": 115, "output_tokens": 158, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "109-0", "response": "```sql\nSELECT\n    o.oid,\n    o.ndet,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    f.value,\n    f.fid\nFROM object o\nINNER JOIN feature f ON o.oid = f.oid\nINNER JOIN probability p ON o.oid = p.oid\nWHERE\n    o.deltajd > 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\nORDER BY f.value DESC\nLIMIT 10;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2909, "cache_read_input_tokens": 0, "input_tokens": 134, "output_tokens": 166, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "109-1", "response": "```sql\nSELECT\n    o.oid,\n    o.ndet,\n    p.classifier_version,\n    p.class_name,\n    p.probability,\n    f.value,\n    f.fid\nFROM object o\nINNER JOIN feature f ON o.oid = f.oid\nINNER JOIN probability p ON o.oid = p.oid\nWHERE\n    o.deltajd > 1\n    AND f.name = 'LinearTrend'\n    AND f.value > 5\n    AND p.ranking = 1\n    AND p.classifier_name = 'lc_classifier'\nLIMIT 10;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2906, "cache_read_input_tokens": 0, "input_tokens": 134, "output_tokens": 159, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "93-0", "response": "```sql\nSELECT *\nFROM probability p\nINNER JOIN magstat m ON p.oid = m.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'asteroid'\n  AND m.corrected = true\nORDER BY p.oid\nLIMIT 10;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2787, "cache_read_input_tokens": 0, "input_tokens": 107, "output_tokens": 89, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "93-1", "response": "```sql\nSELECT p.*, m.*\nFROM probability p\nINNER JOIN magstat m ON p.oid = m.oid\nWHERE p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\n  AND p.class_name = 'asteroid'\n  AND m.corrected = true\nORDER BY p.oid\nLIMIT 10;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3124, "cache_read_input_tokens": 0, "input_tokens": 107, "output_tokens": 93, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "95-0", "response": "```sql\nSELECT\n    o.oid AS ztf_id,\n    x.oid_catalog AS catalog_id,\n    x.dist AS distance,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM object o\nINNER JOIN xmatch x ON o.oid = x.oid\nINNER JOIN feature f ON o.oid = f.oid\nWHERE o.oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n  AND f.version = 'lc_classifier_1.2.1-P'\n  AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\nORDER BY x.oid_catalog, f.name;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2830, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 193, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "95-1", "response": "```sql\nSELECT\n    o.oid AS ztf_id,\n    x.oid_catalog AS catalog_id,\n    x.dist AS distance,\n    f.name AS feature_name,\n    f.value AS feature_value\nFROM object o\nINNER JOIN xmatch x ON o.oid = x.oid\nINNER JOIN feature f ON o.oid = f.oid\nWHERE o.oid IN ('ZTF19aazhdoy', 'ZTF17aaaqqtd')\n  AND f.name IN ('W1-W2', 'g-W2', 'r-W2')\n  AND f.version = 'lc_classifier_1.2.1-P'\nORDER BY x.oid_catalog, f.name;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2833, "cache_read_input_tokens": 0, "input_tokens": 170, "output_tokens": 193, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "98-0", "response": "```sql\n-- Find at most 200 distinct ZTF objects that have a probability larger than 0.7 of being a QSO in the light curve classifier\n-- Return all columns from the 'xmatch' and 'allwise' tables for such objects\n\nSELECT x.*, a.*\nFROM (\n  SELECT p.oid\n  FROM probability p\n  WHERE p.class_name = 'QSO' AND p.probability > 0.7 AND p.classifier_name = 'lc_classifier'\n  ORDER BY p.probability DESC\n  LIMIT 200\n) p\nINNER JOIN object o ON p.oid = o.oid\nINNER JOIN xmatch x ON o.oid = x.oid\nINNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3142, "cache_read_input_tokens": 0, "input_tokens": 88, "output_tokens": 198, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "98-1", "response": "```sql\nSELECT DISTINCT ON (o.oid) x.*, a.*\nFROM probability p\nJOIN object o ON p.oid = o.oid\nJOIN xmatch x ON o.oid = x.oid\nJOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE p.class_name = 'QSO' \n  AND p.probability > 0.7\n  AND p.ranking = 1\n  AND p.classifier_name = 'lc_classifier'\nORDER BY o.oid, p.probability DESC\nLIMIT 200;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2897, "cache_read_input_tokens": 0, "input_tokens": 88, "output_tokens": 145, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "87-0", "response": "```sql\nSELECT *\nFROM probability p\nINNER JOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.7\n  AND p.class_name IN ('LPV', 'E')\n  AND g.unique1 = true\nLIMIT 50;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3062, "cache_read_input_tokens": 0, "input_tokens": 132, "output_tokens": 117, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "87-1", "response": "```sql\nSELECT *\nFROM probability p\nINNER JOIN gaia_ztf g ON p.oid = g.oid\nWHERE p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.7\n  AND p.class_name IN ('LPV', 'E')\n  AND g.unique1 = true\nLIMIT 50;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3096, "cache_read_input_tokens": 0, "input_tokens": 132, "output_tokens": 117, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "101-0", "response": "```sql\nSELECT *\nFROM probability p\nINNER JOIN xmatch x ON p.oid = x.oid\nINNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE p.probability > 0.5\n  AND p.class_name = 'LPV'\n  AND p.classifier_name = 'lc_classifier'\n  AND a.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 0, "cache_read_input_tokens": 2917, "input_tokens": 116, "output_tokens": 117, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "101-1", "response": "```sql\nSELECT *\nFROM probability p\nINNER JOIN xmatch x ON p.oid = x.oid\nINNER JOIN allwise a ON x.oid_catalog = a.oid_catalog\nWHERE p.probability > 0.5\n  AND p.class_name = 'LPV'\n  AND p.classifier_name = 'lc_classifier'\n  AND a.w1mpro BETWEEN 7 AND 8\nLIMIT 100;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2917, "cache_read_input_tokens": 0, "input_tokens": 116, "output_tokens": 117, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "105-0", "response": "```sql\nSELECT\n  o.oid,\n  p.probability,\n  d.candid,\n  d.fid,\n  d.chipsf,\n  d.classtar,\n  ps1.objectidps1,\n  ps1.sgscore1 AS ps1_sgscore1,\n  ps1.distpsnr1\nFROM object o\nINNER JOIN probability p ON o.oid = p.oid\nINNER JOIN detection d ON o.oid = d.oid\nINNER JOIN ps1_ztf ps1 ON o.oid = ps1.oid\nWHERE\n  p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.7\n  AND ps1.distpsnr1 < 2\n  AND ABS(d.classtar - ps1.sgscore1) < 0.5\nLIMIT 50;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3231, "cache_read_input_tokens": 0, "input_tokens": 194, "output_tokens": 245, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "105-1", "response": "```sql\nSELECT\n  o.oid,\n  p.probability,\n  d.candid,\n  d.fid,\n  d.rb,\n  d.sgscore1,\n  ps1.objectidps1,\n  ps1.sgscore1 AS ps1_sgscore1,\n  ps1.distpsnr1\nFROM object o\nJOIN probability p ON o.oid = p.oid\nJOIN dataquality d ON o.oid = d.oid\nJOIN ps1_ztf ps1 ON o.oid = ps1.oid\nWHERE\n  p.classifier_name = 'lc_classifier'\n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.7\n  AND ps1.distpsnr1 < 2\n  AND ABS(ps1.sgscore1 - d.sgscore1) < 0.5\nLIMIT 50;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3236, "cache_read_input_tokens": 0, "input_tokens": 194, "output_tokens": 244, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "86-0", "response": "```sql\nSELECT p.*, ps1.*\nFROM probability p\nINNER JOIN ps1_ztf ps1 ON p.oid = ps1.oid\nWHERE p.classifier_name = 'lc_classifier' \n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.6\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND ps1.sgscore1 > 0.8\nLIMIT 100;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3063, "cache_read_input_tokens": 0, "input_tokens": 143, "output_tokens": 138, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "86-1", "response": "```sql\n-- Retrieve ZTF objects with high probability of being Cepheid, Delta Scuti, or RR Lyrae,\n-- and their closest PS1 sources have a star/galaxy score greater than 0.8.\n-- Limit the result to 100 rows.\nSELECT p.*, ps1.*\nFROM probability p\nINNER JOIN ps1_ztf ps1 ON p.oid = ps1.oid\nWHERE p.classifier_name = 'lc_classifier' \n  AND p.classifier_version = 'hierarchical_rf_1.1.0'\n  AND p.probability > 0.6\n  AND p.class_name IN ('CEP', 'DSCT', 'RRL')\n  AND (ps1.sgscore1 > 0.8 OR ps1.sgscore2 > 0.8 OR ps1.sgscore3 > 0.8)\nLIMIT 100;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3203, "cache_read_input_tokens": 0, "input_tokens": 143, "output_tokens": 234, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "41-0", "response": "```sql\n-- Create a temporary table to hold the input object information\nWITH input_objects (id, obj_ra, obj_dec, r_deg) AS (\n  VALUES\n    ('id_1', 132.961, 41.397, 0.0139),\n    ('id_2', 139.01, 41.5653, 0.0278)\n)\n\n-- Join the input objects with the ALLWISE catalog, using spatial proximity\nSELECT\n  io.id,\n  io.obj_ra,\n  io.obj_dec,\n  io.r_deg,\n  a.oid_catalog,\n  a.ra,\n  a.dec,\n  a.w1mpro,\n  a.w1sigmpro\nFROM\n  input_objects io\n  INNER JOIN allwise a ON q3c_join(a.ra, a.dec, io.obj_ra, io.obj_dec, io.r_deg)\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 3073, "cache_read_input_tokens": 0, "input_tokens": 201, "output_tokens": 229, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "41-1", "response": "```sql\nWITH input_objects AS (\n  SELECT \n    'id_1' AS id, \n    132.961 AS obj_ra, \n    41.397 AS obj_dec, \n    5.0/3600.0 AS r_deg\n  UNION ALL\n  SELECT \n    'id_2',\n    139.01,\n    41.5653,\n    10.0/3600.0\n)\nSELECT\n  io.id,\n  io.obj_ra,\n  io.obj_dec,\n  io.r_deg,\n  aw.oid_catalog,\n  aw.ra,\n  aw.dec,\n  aw.w1mpro,\n  aw.w1sigmpro\nFROM \n  input_objects io\n  INNER JOIN allwise aw\n  ON q3c_join(io.obj_ra, io.obj_dec, aw.ra, aw.dec, io.r_deg)\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2863, "cache_read_input_tokens": 0, "input_tokens": 201, "output_tokens": 240, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "74-0", "response": "```sql\nSELECT ss_ztf.oid, ss_ztf.ssnamenr, ss_ztf.ssmagnr\nFROM object\nINNER JOIN ss_ztf ON object.oid = ss_ztf.oid\nWHERE object.oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n  AND ss_ztf.ssmagnr < 19.2\nORDER BY ss_ztf.ssmagnr DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2972, "cache_read_input_tokens": 0, "input_tokens": 146, "output_tokens": 138, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "74-1", "response": "```sql\nSELECT ss_ztf.oid, ss_ztf.ssnamenr, ss_ztf.ssmagnr\nFROM object\nINNER JOIN ss_ztf ON object.oid = ss_ztf.oid\nWHERE object.oid IN ('ZTF20abmaqeh', 'ZTF18abwxduj', 'ZTF19aactlln')\n  AND ss_ztf.ssmagnr < 19.2\nORDER BY ss_ztf.ssmagnr DESC;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2972, "cache_read_input_tokens": 0, "input_tokens": 146, "output_tokens": 138, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "97-0", "response": "```sql\nSELECT \n  object.oid,\n  p1.probability AS prob_stamp_agn,\n  p2.probability AS prob_lc_lpv\nFROM object\nINNER JOIN probability p1 ON object.oid = p1.oid\n                        AND p1.classifier_name = 'stamp_classifier_1.0.4'\n                        AND p1.class_name = 'AGN'\n                        AND p1.probability > 0.6\nINNER JOIN probability p2 ON object.oid = p2.oid\n                        AND p2.classifier_name = 'lc_classifier'\n                        AND p2.class_name = 'LPV'\n                        AND p2.probability > 0.7\nLIMIT 50;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2994, "cache_read_input_tokens": 0, "input_tokens": 152, "output_tokens": 192, "server_tool_use": null, "service_tier": "batch"}}
{"custom_id": "97-1", "response": "```sql\nSELECT \n    o.oid,\n    p1.probability AS prob_stamp_agn,\n    p2.probability AS prob_lc_lpv\nFROM object o\nINNER JOIN probability p1 ON o.oid = p1.oid\n    AND p1.classifier_name = 'stamp_classifier_1.0.4'\n    AND p1.class_name = 'AGN'\nINNER JOIN probability p2 ON o.oid = p2.oid\n    AND p2.classifier_name = 'lc_classifier'\n    AND p2.class_name = 'LPV'\nWHERE p1.probability > 0.6\n  AND p2.probability > 0.7\nLIMIT 50;\n```", "model": "claude-3-haiku-20240307", "usage": {"cache_creation_input_tokens": 2942, "cache_read_input_tokens": 0, "input_tokens": 152, "output_tokens": 186, "server_tool_use": null, "service_tier": "batch"}}
